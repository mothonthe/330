const _0x59e961=_0x1efc;(function(_0x458a18,_0xd41392){const _0x5cc1df=_0x1efc,_0x3c7ab9=_0x458a18();while(!![]){try{const _0x6eeaae=parseInt(_0x5cc1df(0x1474))/0x1*(-parseInt(_0x5cc1df(0x1431))/0x2)+parseInt(_0x5cc1df(0xf8b))/0x3+-parseInt(_0x5cc1df(0x878))/0x4*(-parseInt(_0x5cc1df(0xda6))/0x5)+-parseInt(_0x5cc1df(0xb0e))/0x6*(parseInt(_0x5cc1df(0xafa))/0x7)+parseInt(_0x5cc1df(0x188))/0x8+parseInt(_0x5cc1df(0xd63))/0x9+-parseInt(_0x5cc1df(0xd08))/0xa;if(_0x6eeaae===_0xd41392)break;else _0x3c7ab9['push'](_0x3c7ab9['shift']());}catch(_0x4f8972){_0x3c7ab9['push'](_0x3c7ab9['shift']());}}}(_0x223e,0xb6cac));const ACTIVATION_PIN_URL=_0x59e961(0xa9d);function getDeviceId(){const _0x1cbbe4=_0x59e961;let _0x3186c9=localStorage[_0x1cbbe4(0x5de)](_0x1cbbe4(0x122d));return!_0x3186c9&&(_0x3186c9=([0x989680]+-0x3e8+-0xfa0+-0x1f40+-0x174876e800)[_0x1cbbe4(0x1bb)](/[018]/g,_0x267c1e=>(_0x267c1e^crypto['getRandomValues'](new Uint8Array(0x1))[0x0]&0xf>>_0x267c1e/0x4)[_0x1cbbe4(0xd81)](0x10)),localStorage[_0x1cbbe4(0x28a)](_0x1cbbe4(0x122d),_0x3186c9)),_0x3186c9;}const EPHONE_DEVICE_ID=getDeviceId();console[_0x59e961(0xe4d)](_0x59e961(0xbe8)+EPHONE_DEVICE_ID);let isPinActivated=localStorage[_0x59e961(0x5de)](_0x59e961(0xe7f))===_0x59e961(0x903);const translations={'zh-CN':{'save':'保存','cancel':'取消','confirm':'确定','edit':'编辑','done':'完成','add':'添加','back':'返回','next':_0x59e961(0x1566),'close':'关闭','reset':'重置','upload':'上传','send':'发送','manage':'管理','share':'分享','delete':'删除','publish':'发布','refresh':'刷新','search':'搜索','remove':'移除','finish':'结束','details':'详情','settings':'设置','title':'标题','content':'内容','category':'分类','name':'名称','description':'描述','status':'状态','ok':'好的','error':'错误','success':'成功','warning':'警告','loading':_0x59e961(0x184),'processing':_0x59e961(0xad4),'pleaseWait':_0x59e961(0x1395),'languageChangedAlert':_0x59e961(0xc96),'homeAppQQ':'QQ','homeAppWorldBook':'世界书','homeAppAppearance':_0x59e961(0x11f6),'homeAppRenderer':_0x59e961(0xa4b),'homeAppApiSettings':'设置','homeAppFont':'字体','homeAppCPhone':'CPhone','homeAppDouban':'豆瓣','homeAppPreset':'预设','homeAppTutorial':'教程','homeAppWerewolf':_0x59e961(0x12e9),'homeAppX':'X','chatListTitle':'消息','navMessages':'消息','navQzone':'动态','navMemories':'回忆','navFavorites':'收藏','navNpcList':_0x59e961(0x393),'qzoneTitle':_0x59e961(0x929),'qzoneActionShuoshuo':'说说','qzoneActionPost':'动态','qzoneActionAlbum':'相册','cphoneTitleSelect':'选择一部手机','cphoneAppQQ':'QQ','cphoneAppAlbum':'相册','cphoneAppBrowser':_0x59e961(0x213),'cphoneAppTaobao':'淘宝','cphoneAppMemo':_0x59e961(0x1462),'cphoneAppDiary':'日记','cphoneAppAmap':_0x59e961(0x720),'cphoneAppUsage':_0x59e961(0xaae),'cphoneAppMusic':'网易云','cphoneAppEphone':'Ephone','cphoneAppFootprints':'足迹','cphoneAlbumTitle':_0x59e961(0x171),'cphoneBrowserTitle':'TA的浏览器历史','cphoneTaobaoTitle':_0x59e961(0x370),'cphoneWalletTitle':'钱包','cphoneMemoTitle':_0x59e961(0x1462),'cphoneDiaryTitle':'日记','cphoneUsageTitle':_0x59e961(0x810),'cphoneMusicTitle':_0x59e961(0x5b0),'cphoneArticleTitle':'文章','cphoneSimulatedChatPlaceholder':_0x59e961(0x1482),'worldBookTitle':_0x59e961(0xcb1),'worldBookEditorTitle':_0x59e961(0x3f4),'worldBookEntryEditorTitle':'编辑条目','worldBookNameLabel':'书名','worldBookCategoryLabel':'分类','worldBookEntriesLabel':_0x59e961(0xea4),'worldBookAddEntryBtn':_0x59e961(0x1352),'worldBookNamePlaceholder':'请输入世界书的名称...','worldBookImportTitle':_0x59e961(0xc49),'presetTitle':'预设','presetEditorTitle':_0x59e961(0xac6),'presetNameLabel':_0x59e961(0x14f2),'presetCategoryLabel':'分类','presetEntriesLabel':_0x59e961(0xea4),'presetAddEntryBtn':'[+]\x20添加新条目','tutorialTitle':'教程','apiSettingsTitle':_0x59e961(0xe3a),'languageLabel':'语言','apiPresetManagement':_0x59e961(0xc22),'apiPresetSelectLabel':_0x59e961(0x14cb),'apiPrimarySettings':_0x59e961(0x172),'apiProxyUrlLabel':'反代地址\x20(不需要添加/v1噢~)','apiKeyLabel':'密钥\x20(API\x20Key)','apiModelLabel':'模型','apiFetchModelsBtn':_0x59e961(0x37b),'apiSecondarySettings':_0x59e961(0x863),'apiSecondaryProxyUrlLabel':_0x59e961(0x13c8),'apiSecondaryKeyLabel':'副密钥','apiSecondaryModelLabel':_0x59e961(0x893),'apiFetchSecondaryModelsBtn':'拉取副模型','apiBgActivitySettings':_0x59e961(0x5e9),'apiEnableBgActivityLabel':_0x59e961(0xd47),'apiBgIntervalLabel':_0x59e961(0x74d),'apiBlockCooldownLabel':_0x59e961(0x250),'apiTtsSettings':_0x59e961(0x824),'apiTtsModelLabel':'语音模型\x20(Model)','apiPerformanceSettings':_0x59e961(0xc08),'apiChatListRenderWindowLabel':_0x59e961(0x1504),'apiChatRenderWindowLabel':_0x59e961(0xdd3),'apiImageGenSettings':_0x59e961(0xde0),'apiEnableImageGenLabel':_0x59e961(0x14a2),'apiEnableNovelAILabel':_0x59e961(0x1239),'apiNovelAIModelLabel':'NovelAI\x20模型','apiNovelAIKeyLabel':_0x59e961(0x47d),'apiNovelAIGenSettingsBtn':_0x59e961(0x880),'apiNovelAITestBtn':'测试生成','apiStorageOptimization':_0x59e961(0xfdc),'apiCompressImagesBtn':_0x59e961(0x757),'apiSaveAllBtn':_0x59e961(0x2a1),'apiExportDataBtn':'导出数据','apiImportDataBtn':_0x59e961(0xcda),'apiCleanupDataBtn':_0x59e961(0xbf6),'apiDeleteWorldBooksBtn':'删除世界书','apiAdvancedCleanupBtn':_0x59e961(0x1085),'apiCheckAndFixDataBtn':_0x59e961(0x669),'chatHeaderOnline':'在线','chatHeaderLongTermMemory':_0x59e961(0x936),'chatHeaderListenTogether':_0x59e961(0xc69),'chatHeaderChatSettings':_0x59e961(0xba8),'chatSelectionCancel':'取消','chatSelectionScreenshot':_0x59e961(0x4b6),'chatSelectionFavorite':'收藏','chatSelectionShare':'分享','chatSelectionSoftDelete':'删除(通知AI)','chatSelectionHardDelete':_0x59e961(0x616),'chatReplyTo':'回复','chatInputPlaceholder':_0x59e961(0x535),'chatWaitForReply':'等待回复','appearanceTitle':_0x59e961(0x11f6),'appearanceSaveAll':_0x59e961(0x1585),'fontSettingsTitle':_0x59e961(0xa10),'fontPresetManagement':'字体预设管理','fontFileUrlLabel':_0x59e961(0xdc9),'fontPreviewLabel':_0x59e961(0xf39),'fontPreviewText1':'你好世界\x20Hello\x20World','fontPreviewText2':_0x59e961(0x3d0),'fontSaveAndApply':_0x59e961(0xc3e),'fontResetDefault':_0x59e961(0x811),'rendererTitle':'渲染规则','rendererEditorTitle':_0x59e961(0x3aa),'rendererCreateTitle':_0x59e961(0x645),'rendererRuleName':_0x59e961(0x549),'rendererBindScope':'绑定范围','rendererScopeGlobal':'公用\x20(所有角色)','rendererRegex':_0x59e961(0x97e),'rendererHtmlTemplate':_0x59e961(0x26a),'rendererEnableRule':_0x59e961(0x14fb),'myAlbumTitle':_0x59e961(0xbd4),'albumPhotosTitle':_0x59e961(0x53d),'npcEditorTitleAdd':_0x59e961(0x1012),'npcEditorTitleEdit':'编辑\x20NPC','npcAvatarLabel':_0x59e961(0xe0d),'npcUploadAvatar':_0x59e961(0x202),'npcNicknameLabel':_0x59e961(0xc46),'npcPersonaLabel':_0x59e961(0xe38),'npcEnableBgActivity':_0x59e961(0x973),'npcActionCooldown':_0x59e961(0x10f1),'npcAssociatedChars':'关联的角色\x20(NPC会去评论这些角色的动态)'},'en':{'save':_0x59e961(0x436),'cancel':_0x59e961(0x1cf),'confirm':_0x59e961(0x54b),'edit':'Edit','done':_0x59e961(0x158d),'add':_0x59e961(0x1433),'back':_0x59e961(0xa98),'next':_0x59e961(0x1d5),'close':_0x59e961(0xaaf),'reset':'Reset','upload':_0x59e961(0x765),'send':'Send','manage':'Manage','share':_0x59e961(0x14af),'delete':'Delete','publish':_0x59e961(0xefa),'refresh':'Refresh','search':'Search','remove':_0x59e961(0x1331),'finish':_0x59e961(0x758),'details':_0x59e961(0xcdb),'settings':'Settings','title':_0x59e961(0x13b2),'content':_0x59e961(0x154e),'category':'Category','name':_0x59e961(0x9df),'description':_0x59e961(0x83f),'status':_0x59e961(0xb43),'ok':'OK','error':_0x59e961(0x84b),'success':_0x59e961(0x9fa),'warning':_0x59e961(0x1261),'loading':_0x59e961(0x1573),'processing':_0x59e961(0x407),'pleaseWait':_0x59e961(0x1301),'languageChangedAlert':'Language\x20switched.\x20The\x20page\x20will\x20reload\x20to\x20apply\x20changes.','homeAppQQ':'QQ','homeAppWorldBook':_0x59e961(0x1036),'homeAppAppearance':'Appearance','homeAppRenderer':_0x59e961(0x102a),'homeAppApiSettings':'Settings','homeAppFont':'Fonts','homeAppCPhone':_0x59e961(0x88d),'homeAppDouban':_0x59e961(0x23f),'homeAppPreset':_0x59e961(0x7f8),'homeAppTutorial':_0x59e961(0x507),'homeAppWerewolf':_0x59e961(0x49f),'homeAppX':'X','chatListTitle':_0x59e961(0x834),'navMessages':_0x59e961(0x834),'navQzone':_0x59e961(0xf01),'navMemories':_0x59e961(0x5e2),'navFavorites':_0x59e961(0x382),'navNpcList':_0x59e961(0x72d),'qzoneTitle':_0x59e961(0xf01),'qzoneActionShuoshuo':_0x59e961(0xb43),'qzoneActionPost':_0x59e961(0x697),'qzoneActionAlbum':_0x59e961(0x8df),'cphoneTitleSelect':_0x59e961(0x1264),'cphoneAppQQ':'QQ','cphoneAppAlbum':_0x59e961(0x8df),'cphoneAppBrowser':_0x59e961(0x1143),'cphoneAppTaobao':_0x59e961(0x158f),'cphoneAppMemo':_0x59e961(0xda2),'cphoneAppDiary':_0x59e961(0x504),'cphoneAppAmap':_0x59e961(0xd34),'cphoneAppUsage':_0x59e961(0x876),'cphoneAppMusic':_0x59e961(0xce4),'cphoneAppEphone':_0x59e961(0xe4c),'cphoneAppFootprints':_0x59e961(0xce7),'cphoneAlbumTitle':'Their\x20Album','cphoneBrowserTitle':_0x59e961(0xad8),'cphoneTaobaoTitle':'Their\x20Taobao\x20Orders','cphoneWalletTitle':_0x59e961(0x12dd),'cphoneMemoTitle':'Memo','cphoneDiaryTitle':'Diary','cphoneUsageTitle':_0x59e961(0x493),'cphoneMusicTitle':'Their\x20Playlist','cphoneArticleTitle':_0x59e961(0x901),'cphoneSimulatedChatPlaceholder':'This\x20is\x20a\x20simulated\x20chat,\x20messages\x20cannot\x20be\x20sent','worldBookTitle':_0x59e961(0x1036),'worldBookEditorTitle':_0x59e961(0xd2b),'worldBookEntryEditorTitle':_0x59e961(0x817),'worldBookNameLabel':_0x59e961(0x97d),'worldBookCategoryLabel':_0x59e961(0xaa3),'worldBookEntriesLabel':_0x59e961(0x15ba),'worldBookAddEntryBtn':_0x59e961(0x677),'worldBookNamePlaceholder':_0x59e961(0xe52),'worldBookImportTitle':_0x59e961(0x6a3),'presetTitle':_0x59e961(0x7f8),'presetEditorTitle':_0x59e961(0xa92),'presetNameLabel':_0x59e961(0x99e),'presetCategoryLabel':_0x59e961(0xaa3),'presetEntriesLabel':_0x59e961(0x15ba),'presetAddEntryBtn':'[+]\x20Add\x20New\x20Entry','tutorialTitle':_0x59e961(0x507),'apiSettingsTitle':'API\x20Settings','languageLabel':_0x59e961(0xcf2),'apiPresetManagement':_0x59e961(0x8de),'apiPresetSelectLabel':'Select\x20or\x20Switch\x20Preset','apiPrimarySettings':_0x59e961(0x81f),'apiProxyUrlLabel':_0x59e961(0x1480),'apiKeyLabel':_0x59e961(0x1a0),'apiModelLabel':'Model','apiFetchModelsBtn':_0x59e961(0x10ca),'apiSecondarySettings':_0x59e961(0x722),'apiSecondaryProxyUrlLabel':_0x59e961(0x2fe),'apiSecondaryKeyLabel':_0x59e961(0x10e2),'apiSecondaryModelLabel':_0x59e961(0x3e7),'apiFetchSecondaryModelsBtn':'Fetch\x20Secondary\x20Models','apiTemperatureLabel':_0x59e961(0xea9),'apiBgActivitySettings':'Background\x20Activity\x20Settings','apiEnableBgActivityLabel':_0x59e961(0x97c),'apiBgIntervalLabel':_0x59e961(0x7d4),'apiBlockCooldownLabel':_0x59e961(0xa99),'apiTtsSettings':_0x59e961(0x281),'apiTtsModelLabel':_0x59e961(0xa5b),'apiPerformanceSettings':_0x59e961(0x62b),'apiChatListRenderWindowLabel':_0x59e961(0x779),'apiChatRenderWindowLabel':_0x59e961(0xd54),'apiImageGenSettings':_0x59e961(0x148c),'apiEnableImageGenLabel':_0x59e961(0xbd9),'apiEnableNovelAILabel':_0x59e961(0x5ff),'apiNovelAIModelLabel':_0x59e961(0x271),'apiNovelAIKeyLabel':_0x59e961(0x47d),'apiNovelAIGenSettingsBtn':_0x59e961(0x75e),'apiNovelAITestBtn':_0x59e961(0x92b),'apiStorageOptimization':'Storage\x20Optimization','apiCompressImagesBtn':_0x59e961(0x1440),'apiSaveAllBtn':_0x59e961(0x87d),'apiExportDataBtn':_0x59e961(0x1109),'apiImportDataBtn':_0x59e961(0x17c),'apiCleanupDataBtn':_0x59e961(0x18f),'apiDeleteWorldBooksBtn':'Delete\x20World\x20Books','apiAdvancedCleanupBtn':_0x59e961(0x14de),'apiCheckAndFixDataBtn':_0x59e961(0x731),'chatHeaderOnline':_0x59e961(0xff9),'chatHeaderLongTermMemory':_0x59e961(0x10ec),'chatHeaderListenTogether':_0x59e961(0x3c0),'chatHeaderChatSettings':_0x59e961(0x5dc),'chatSelectionCancel':_0x59e961(0x1cf),'chatSelectionScreenshot':_0x59e961(0x61e),'chatSelectionFavorite':_0x59e961(0xb16),'chatSelectionShare':_0x59e961(0x14af),'chatSelectionSoftDelete':_0x59e961(0x736),'chatSelectionHardDelete':'Erase','chatReplyTo':_0x59e961(0xd44),'chatInputPlaceholder':_0x59e961(0xa7b),'chatWaitForReply':_0x59e961(0x68b),'appearanceTitle':_0x59e961(0x11f1),'appearanceSaveAll':_0x59e961(0x920),'fontSettingsTitle':_0x59e961(0x80b),'fontPresetManagement':_0x59e961(0xe12),'fontFileUrlLabel':_0x59e961(0x4c4),'fontPreviewLabel':_0x59e961(0x675),'fontPreviewText1':_0x59e961(0xdf6),'fontPreviewText2':'This\x20is\x20a\x20font\x20preview\x20effect,\x2012345.','fontSaveAndApply':'Save\x20and\x20Apply','fontResetDefault':_0x59e961(0x9ca),'rendererTitle':_0x59e961(0xc2b),'rendererEditorTitle':_0x59e961(0xa5e),'rendererCreateTitle':_0x59e961(0x75b),'rendererRuleName':'Rule\x20Name','rendererBindScope':_0x59e961(0x1490),'rendererScopeGlobal':'Global\x20(All\x20Characters)','rendererRegex':_0x59e961(0x54f),'rendererHtmlTemplate':_0x59e961(0x51c),'rendererEnableRule':_0x59e961(0x1387),'myAlbumTitle':_0x59e961(0x348),'albumPhotosTitle':'Album\x20Name','npcEditorTitleAdd':_0x59e961(0x2e9),'npcEditorTitleEdit':_0x59e961(0x830),'npcAvatarLabel':_0x59e961(0x6b6),'npcUploadAvatar':_0x59e961(0x1b5),'npcNicknameLabel':_0x59e961(0xdb9),'npcPersonaLabel':_0x59e961(0x601),'npcEnableBgActivity':_0x59e961(0x660),'npcActionCooldown':'Independent\x20Action\x20Cooldown\x20(min)','npcAssociatedChars':_0x59e961(0xfc6)}};let currentLanguage=_0x59e961(0x15bc);function setLanguage(_0x17c457){const _0x5b6895=_0x59e961;!translations[_0x17c457]&&(console[_0x5b6895(0x651)](_0x5b6895(0xb8f)+_0x17c457+'\x22\x20not\x20found.\x20Defaulting\x20to\x20\x27zh-CN\x27.'),_0x17c457=_0x5b6895(0x15bc)),currentLanguage=_0x17c457,localStorage['setItem']('ephone-language',_0x17c457),document[_0x5b6895(0x2f9)][_0x5b6895(0x14e6)]=_0x17c457,document[_0x5b6895(0x131c)](_0x5b6895(0x1cb))[_0x5b6895(0x15c1)](_0x7029e8=>{const _0x5b7d49=_0x5b6895,_0xb18109=_0x7029e8[_0x5b7d49(0x100b)](_0x5b7d49(0xe31));translations[_0x17c457][_0xb18109]&&(_0x7029e8['textContent']=translations[_0x17c457][_0xb18109]);}),document['querySelectorAll'](_0x5b6895(0x1221))['forEach'](_0x334883=>{const _0x4e709e=_0x5b6895,_0x5e4a8c=_0x334883['getAttribute'](_0x4e709e(0x650));translations[_0x17c457][_0x5e4a8c]&&(_0x334883['placeholder']=translations[_0x17c457][_0x5e4a8c]);}),document['querySelectorAll']('[data-lang-key-title]')[_0x5b6895(0x15c1)](_0x479cd9=>{const _0x3d27ad=_0x5b6895,_0x31b26f=_0x479cd9[_0x3d27ad(0x100b)](_0x3d27ad(0x11d3));translations[_0x17c457][_0x31b26f]&&(_0x479cd9['title']=translations[_0x17c457][_0x31b26f]);});}function initLanguage(){const _0x2399e1=_0x59e961,_0x42d54a=localStorage[_0x2399e1(0x5de)](_0x2399e1(0xbfc))||_0x2399e1(0x15bc),_0x3ff427=document['getElementById'](_0x2399e1(0x9af));_0x3ff427&&(_0x3ff427['value']=_0x42d54a,_0x3ff427[_0x2399e1(0x954)](_0x2399e1(0xbbc),_0x4631a1=>{const _0x290536=_0x2399e1,_0x51762a=_0x4631a1[_0x290536(0xa41)]['value'];alert(translations[_0x51762a][_0x290536(0x1162)]),localStorage[_0x290536(0x28a)](_0x290536(0xbfc),_0x51762a),setTimeout(()=>window[_0x290536(0x963)][_0x290536(0x137d)](),0x64);})),setLanguage(_0x42d54a);}(function(){'use strict';const _0x50b3d9=_0x59e961;function _0x5af710(_0x142e2d,_0x173de0){const _0x285b04=_0x1efc;try{const _0x5211c0=document[_0x285b04(0xe94)]('a');_0x5211c0['href']=_0x142e2d,_0x5211c0[_0x285b04(0xed2)]=_0x173de0,_0x5211c0['style']['display']=_0x285b04(0x8e0),document['body'][_0x285b04(0x983)](_0x5211c0),_0x5211c0[_0x285b04(0x9cc)](),setTimeout(()=>{const _0x9f1261=_0x285b04;document[_0x9f1261(0x7c3)]['removeChild'](_0x5211c0);},0x64),console[_0x285b04(0xe4d)](_0x285b04(0xfa9),_0x173de0),_0x29e505();}catch(_0x5971f0){console['error'](_0x285b04(0x4d3),_0x5971f0),_0x29e505(_0x285b04(0xdd2),'error');}}function _0x29e505(_0x29fbd5=_0x50b3d9(0xc1b),_0x55b842=_0x50b3d9(0x14ec)){const _0x2c8da4=_0x50b3d9,_0x164f76=document[_0x2c8da4(0xe94)]('div');_0x164f76[_0x2c8da4(0x766)]=_0x29fbd5,_0x164f76[_0x2c8da4(0x20f)][_0x2c8da4(0x6c0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20right:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background:\x20'+(_0x55b842===_0x2c8da4(0x14ec)?'#4CAF50':_0x2c8da4(0xb8d))+_0x2c8da4(0x75d),document[_0x2c8da4(0x7c3)]['appendChild'](_0x164f76),setTimeout(()=>{const _0x59c9bc=_0x2c8da4;_0x164f76[_0x59c9bc(0x20f)]['opacity']='1',_0x164f76['style']['transform']='translateY(0)';},0xa),setTimeout(()=>{const _0x165d02=_0x2c8da4;_0x164f76[_0x165d02(0x20f)][_0x165d02(0x71f)]='0',_0x164f76[_0x165d02(0x20f)][_0x165d02(0x352)]=_0x165d02(0x751),setTimeout(()=>{const _0x2fe849=_0x165d02;_0x164f76[_0x2fe849(0x133d)]();},0x12c);},0x7d0);}function _0x1dd3e6(_0x11b0e5){const _0x1d84c1=_0x50b3d9,_0x4db64c=_0x11b0e5[_0x1d84c1(0x100b)](_0x1d84c1(0x10b8))||_0x11b0e5['getAttribute'](_0x1d84c1(0x881))||'';let _0x4ed4fb=_0x4db64c[_0x1d84c1(0x1bb)](/[^a-zA-Z0-9\u4e00-\u9fa5\s]/g,'_')[_0x1d84c1(0x1bb)](/\s+/g,'_')[_0x1d84c1(0x72e)](0x0,0x1e);!_0x4ed4fb&&(_0x4ed4fb=_0x1d84c1(0xecf));const _0x8f5e18=new Date()['toISOString']()[_0x1d84c1(0x1bb)](/[-:]/g,'')[_0x1d84c1(0x1bb)]('T','_')['split']('.')[0x0];return _0x4ed4fb+'_'+_0x8f5e18+'.png';}function _0x2e6b2a(_0x55c0b2){const _0x42dff1=_0x50b3d9,_0x483d1c=_0x55c0b2[_0x42dff1(0x20f)][_0x42dff1(0x352)]||'',_0x209f61=_0x55c0b2[_0x42dff1(0x20f)][_0x42dff1(0x203)]||'';_0x55c0b2['style'][_0x42dff1(0x203)]='transform\x200.15s\x20ease',_0x55c0b2[_0x42dff1(0x20f)][_0x42dff1(0x352)]=_0x42dff1(0x248),setTimeout(()=>{const _0x2e0963=_0x42dff1;_0x55c0b2[_0x2e0963(0x20f)][_0x2e0963(0x352)]=_0x483d1c,setTimeout(()=>{const _0x12665b=_0x2e0963;_0x55c0b2[_0x12665b(0x20f)][_0x12665b(0x203)]=_0x209f61;},0x96);},0x96);}let _0x1cda7d=0x0,_0x18b2da=null,_0x4e7cfa=null;document[_0x50b3d9(0x954)](_0x50b3d9(0x9cc),function(_0x42fcf4){const _0x596a3d=_0x50b3d9,_0xc651b0=_0x42fcf4['target'];if(_0xc651b0['tagName']===_0x596a3d(0x57a)&&(_0xc651b0[_0x596a3d(0x4d8)][_0x596a3d(0x1222)](_0x596a3d(0x342))||_0xc651b0[_0x596a3d(0x4d8)]['contains']('naiimag-image'))){_0xc651b0===_0x4e7cfa?_0x1cda7d++:(_0x1cda7d=0x1,_0x4e7cfa=_0xc651b0);_0x18b2da&&clearTimeout(_0x18b2da);if(_0x1cda7d===0x3){_0x1cda7d=0x0,_0x4e7cfa=null,_0x42fcf4[_0x596a3d(0x28d)](),_0x42fcf4[_0x596a3d(0x63a)](),console[_0x596a3d(0xe4d)](_0x596a3d(0x30c)),_0x2e6b2a(_0xc651b0);const _0x170486=_0xc651b0[_0x596a3d(0x10d4)];if(!_0x170486||_0x170486===_0x596a3d(0x14b6)){console[_0x596a3d(0x651)]('⚠️\x20[NAI下载]\x20图片源为空，无法下载'),_0x29e505(_0x596a3d(0x2e0),_0x596a3d(0x3b7));return;}const _0x2796e8=_0x1dd3e6(_0xc651b0);_0x5af710(_0x170486,_0x2796e8);}else _0x18b2da=setTimeout(()=>{_0x1cda7d=0x0,_0x4e7cfa=null;},0x1f4);}},!![]),console['log'](_0x50b3d9(0x369)),console[_0x50b3d9(0xe4d)](_0x50b3d9(0x10dc));}());_0x59e961(0x22c)in navigator&&window[_0x59e961(0x954)](_0x59e961(0x422),()=>{const _0x1b7f6a=_0x59e961;navigator['serviceWorker'][_0x1b7f6a(0x912)](_0x1b7f6a(0x14c5))[_0x1b7f6a(0x140f)](_0x1c2cca=>{const _0x185203=_0x1b7f6a;console[_0x185203(0xe4d)](_0x185203(0xa40),_0x1c2cca['scope']);})['catch'](_0x132df7=>{const _0x40eea2=_0x1b7f6a;console[_0x40eea2(0xe4d)](_0x40eea2(0xcc8),_0x132df7);});});!Array[_0x59e961(0x537)]['findLastIndex']&&Object[_0x59e961(0x1191)](Array['prototype'],_0x59e961(0x527),{'value':function(_0x125190){const _0x1f3f5a=_0x59e961;if(this==null)throw new TypeError(_0x1f3f5a(0xd0b));if(typeof _0x125190!==_0x1f3f5a(0xd8e))throw new TypeError(_0x1f3f5a(0xf53));let _0x2d1da5=Object(this),_0x27fa59=_0x2d1da5['length']>>>0x0,_0x535a9b=arguments[0x1],_0x223c28=_0x27fa59-0x1;while(_0x223c28>=0x0){let _0x2cc5ca=_0x2d1da5[_0x223c28];if(_0x125190['call'](_0x535a9b,_0x2cc5ca,_0x223c28,_0x2d1da5))return _0x223c28;_0x223c28--;}return-0x1;},'configurable':!![],'writable':!![]});function _0x1efc(_0x3a8c41,_0x51fb68){const _0x223eb0=_0x223e();return _0x1efc=function(_0x1efcd4,_0x4338b4){_0x1efcd4=_0x1efcd4-0x164;let _0x1140fc=_0x223eb0[_0x1efcd4];return _0x1140fc;},_0x1efc(_0x3a8c41,_0x51fb68);}const dynamicIslandContent=document[_0x59e961(0x9a3)](_0x59e961(0x1157)),islandAlbumArt=document['getElementById'](_0x59e961(0xafb)),islandLyricContainer=document[_0x59e961(0x9a3)](_0x59e961(0xd6d)),islandLyricText=document[_0x59e961(0x9a3)](_0x59e961(0xbfb)),phoneScreenForIsland=document[_0x59e961(0x9a3)](_0x59e961(0xae7));let activeMessageTimestamp=null,activeTransferTimestamp=null,lastRawAiResponse='',lastResponseTimestamps=[],lastPrivateMessagesSent=[],currentQzoneReplyContext=null,editingNpcId=null,pendingBackupData=null;const GEMINI_API_URL='https://generativelanguage.googleapis.com/v1beta/models';function _0x223e(){const _0xed6e7d=['headers','avatar_prompt','char-wallet-screen','https://i.postimg.cc/tRzPkzRg/IMG-7012.gif','is-transfer','++id,\x20name,\x20createdAt','\x0a\x0a#\x20【你的聊天对象（用户）的人设】\x0a-\x20**昵称**:\x20','profile-edit-btn','容错解析：策略2成功\x20(提取了summary字段内容)','char-music-play-pause-btn','select-all-recipients','trim','https://i.postimg.cc/T3NvqJCZ/IMG-6851.gif','placeholder.png','.search-result-item','\x20发送了一个【拼手气红包】(时间戳:\x20','）刚刚撤回了一条消息。撤回前的内容是：','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20','#delete-world-books-list\x20.clear-posts-item','.nai-gallery-item','call_summary','orderBy','删除约定','1px\x20solid\x20#e0e0e0','countdown','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','finishReason','清空购物车','add-song-url-btn','#search-results-list\x20.music-search-checkbox','stickerCategoryId','statusText','then','photo-viewer-modal','toggle-fullscreen-btn','isActive','secondary-model-select','\x27>文字图</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/prsGKMBx/IMG-4370.gif','preset-persona-input','chat-settings-btn','下载失败','\x20---\x0a','qzone-posts-list','douban-max-posts-input','.message-wrapper','&id,\x20minimaxGroupId,\x20minimaxApiKey','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x20(角色)</label>','未找到\x20chatID:\x20','custom_proxy_url','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20附加上下文：一段分享的聊天记录\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20重要提示：这不是你和当前用户的对话，而是用户从【另一场】与“','scrollIntoView','\x20位角色的记忆中。','chat-list-render-window-input','\x20本世界书已成功删除。','.loader-container','getMonth','ai-avatar-upload-input','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-group-name\x22>来自\x20','character-nai-prompts-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条动作\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','照片描述','暂停了音乐','cancel-call-message-action-btn','3090mFAVLI','renderQzoneScreenProxy','Add','wallpaper-upload-input','跳过一个无法解析为JSON的编辑块:','note','notificationSoundUrl','minimax-group-id','pin-modal-overlay','link','歌曲背景已更新！','api-temperature-slider','chat-list-action-cancel','red-packet-details-modal','blocked_by_user','Compress\x20Local\x20Images','delete-btn','将清空选定角色的所有通话记录。','probability','未检测到BOM，尝试使用\x20UTF-8\x20解码...','manual-werewolf-summary-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊AI导演。你现在控制着一个名为“','parse','rp-details-list','dark','pop','\x27,\x20\x27bulangni\x27,\x20-apple-system,\x20BlinkMacSystemFont,\x20\x22Segoe\x20UI\x22,\x20Roboto,\x20Helvetica,\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有共同的回忆和约定呢~</p>','(空)','\x20天\x20---','gameMode','world-book-screen','\x20死亡了。','\x20-\x20','https://i.postimg.cc/pddJj9zN/IMG-7094.gif','participant-display-avatar','existing-npc-groups-list','lorebook','https://i.postimg.cc/4yCXW52F/mmexport1751030908335.gif','该预设包含\x20','open-album-btn','\x22\x20class=\x22avatar-img\x22\x20style=\x22border-radius:\x2050%;\x22><img\x20src=\x22','\x22\x20class=\x22avatar-frame\x22></div>','\x22\x20(ID:\x20','<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>','<span>已</span><span>超</span><span>时</span>','participant-avatar-wrapper','isLocal','char-music-player-title','备忘录','add-ai-avatar-batch-btn','\x0a\x0a现在，请生成这份歌单。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','Response\x20headers:','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“','include','角色专属','nai-smea','horizontal','”，选项有：[','\x22)\x20为键的内心独白。\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a','selection-screenshot-btn','close-group-manager-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>预估总上下文Token数:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22><strong>\x20','book_','has','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20','733KUqzgy','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20作为参考，这是你们之前的最后一段聊天记录：\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-text\x22>','werewolf-role-modal','模型列表已更新','\x20(用户)\x20或其他AI的发言，必须对他们的观点和逻辑做出回应。\x0a2.\x20\x20**记忆力与连贯性**:\x20你的新发言【必须】是基于**过去几天和今天发生的所有事件和讨论**的逻辑延续。\x0a3.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式为:\x20`{\x22speaker_name\x22:\x20\x22角色的【昵称】\x22,\x20\x22dialogue\x22:\x20\x22发言内容\x22}`。**必须**为每一个存活的AI角色都生成一段发言。\x0a4.\x20\x20**称呼铁律**:\x20你的发言中【绝对禁止】提及任何玩家的编号。在对话中互相称呼时，你【必须】使用玩家的【本名】，而不是他们的昵称。\x0a\x0a#\x20','identifier','</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20album-art-btn\x22\x20data-index=\x22','<label><input\x20type=\x22checkbox\x22\x20value=\x22user\x22>\x20','复制失败','https://i.postimg.cc/6pLTBvDG/IMG-5721.gif','找不到相册:','Proxy\x20URL\x20(No\x20/v1\x20needed~)','确定要删除预设\x20“','这是模拟对话，无法发送消息','API请求失败\x20(','\x22>专辑</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20lyrics-btn\x22\x20data-index=\x22','quantity','refined','className','padStart','items','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI。你的核心任务是扮演角色“','variation','Image\x20Generation\x20Settings','\x22\x20生成行动失败:','AI\x20(CPhone)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','charging','Binding\x20Scope','reset-custom-css-btn','personaPresets','battery-alert-modal','</name>\x0a\x20\x20<persona>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','散记编辑已取消，心声的修改也未保存。','</div><div\x20class=\x22gift-footer\x22>共','isSpectatorGroup','模拟表情含义\x20\x22',')，问题是：“','qzone-post-delete-action','开始清理','下棋历史\x20(x,y坐标均从0开始):\x0a','AI\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','favorites-delete-selected-btn','model','\x20更换了你的头像]','启用AI生图功能','load-more-btn','select-all-types-for-clear','ai-cooldown-group','[系统提示：用户向你发起了视频通话请求。请根据你的人设，使用\x20\x22video_call_response\x22\x20指令，并设置\x20\x22decision\x22\x20为\x20\x22accept\x22\x20或\x20\x22reject\x22\x20来回应。]','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>没有更多可以邀请的联系人了。</p>','<option\x20value=\x22','toUpperCase','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】足迹的\x20`timestamp`\x20字段，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a\x20\x20\x20\x20-\x20\x20\x20请生成一个看起来像是过去几周内的、时间【从新到旧】排列的足迹列表。\x0a2.\x20\x20**创造性与合理性**:\x20足迹必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**多样性**:\x20地点类型要丰富，可以包括餐厅、商场、公园、公司、朋友家等。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条足迹，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22locationName\x22:\x20\x22一个具体、生动的地点名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22address\x22:\x20\x22一个虚构但看起来很真实的详细地址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comment\x22:\x20\x22这是角色对这次出行或这个地点的内心独白或评论，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22(可选)一段用于生成这张地点照片的、详细的【英文】关键词,\x20风格为\x20realistic\x20photo,\x20high\x20quality\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x22符合\x20ISO\x208601\x20格式的日期时间字符串\x20(例如:\x20\x272025-09-25T18:30:00Z\x27)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**重要**:\x20大约有【三分之一】的足迹需要包含\x20`image_prompt`\x20字段来生成一张照片。\x0a\x20\x20\x20\x20-\x20**图片**:\x20image_prompt\x20生成的图片【绝对禁止包含真人】。如果地点是室内，可以生成空无一人的场景；如果是室外，可以只有风景或建筑。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','expanded','group-video-call-btn','清理后仍未找到JSON数组。','Share','\x20向对方发起了转账:\x20','qzone','char-music-progress-fill','\x0a-\x20**世界观**:\x20','translateY(0px)','**内容:**\x0a','about:blank','正在请求AI角色们加入讨论...','当前时间是\x20','\x20评论了动态]','已返回我的手机','hiddenContent','删除失败','\x0a\x0a#\x20【其他核心规则】\x0a1.\x20\x20**叙事视角**:\x20叙述人称【必须】严格遵循“预设”中的第一人称、第二人称或第三人称规定。\x0a2.\x20\x20**字数要求**:\x20你生成的\x20`content`\x20总内容应在\x20**','clipboard','通话记录','\x0a#\x20核心任务：群聊剧本作家\x0a你是一个剧本作家，负责创作一个名为“','long-term-memory-screen','%;\x22></div><div\x20class=\x22poll-option-content\x22><span\x20class=\x22poll-option-text\x22>','你的收藏夹是空的，<br>快去动态或聊天中收藏喜欢的内容吧！','cancel-product-editor-btn','./sw.js','\x20天\x20---**\x0a','\x20获胜。也就是说，','smea_dyn','[系统提示：你刚刚成功将自己的备注名修改为了“','.world-book-group-content','选择或切换预设','manage-sticker-categories-btn','ZIP文件中未找到图片','home-screen-pages-container','诊断：未在此角色卡中找到任何有效的世界书数据。','AI\x20(独立行动)\x20尝试使用一个不存在的表情:\x20\x22','API预设','manage-preset-categories-btn','char_memo','发现新版本通知:\x20','frame-item','\x22\x20checked>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','请输入头像的图片URL','isPinned','cancel-douban-cast-btn','countdownEndTime','天，救人概率为\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','&id','Advanced\x20Data\x20Cleanup','删除规则','char-photo-item','apiKey','\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-display:\x20swap;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','我已了解风险，确认压缩','\x20/\x20','create-new-member-btn','lang','quality_toggle','设置群名','所有音乐源都未能找到歌曲：“','请为这组提示词预设命名：','\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','success','【AI角色】','get','borderBottom','#e7f3ff','确定要删除这条通话消息吗？','预设名称','请点击右上角的“角色选择”按钮，选择至少一个参与豆瓣互动的角色。','\x20张图片。有\x20','检测到好友申请待处理状态，为角色\x20\x22','column','my-frame-tab','https://i.postimg.cc/TYvkKKkc/IMG-6565.gif','https://i.postimg.cc/Ss7pM6fW/IMG-4410.gif','iVBORw0KGgo','启用规则','member','https://i.postimg.cc/PxZrFFFL/o-o-1.jpg','\x0a#\x20群成员列表\x20(你的总结目标)\x0a','frame_flower','请按照以下格式粘贴，一行一个：\x0a\x0a焦虑\x202a9wte.jpeg\x0a大惊失色\x20or8qf4.png\x0a没有灵感\x20njwujh.jpeg','favorite-diary-btn','激活失败','contactId','聊天列表每次加载条数','save-frame-settings-btn','AI方','\x22\x20class=\x22douban-post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-name\x22>','type',';\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2012px\x2024px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x2010000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20pointer-events:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(20px);\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20','complete','sticker-category-tabs','<span\x20class=\x22offline-description\x22>','artistName','网易云','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','选择精炼范围','.product-item.selected','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/J0b6Nym4/IMG-7279.jpg','toDateString','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','cancel-clear-wizard-btn-step2','分钟前有人聊过。','char-diary-detail-back-btn','summaries','邀请你视频通话','为了确保所有数据同步，建议立即刷新页面。','https://i.postimg.cc/8PsK20jQ/IMG-7236.gif','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','正在准备分片导出...','确定要从播放列表中删除《','”这个信息，将其转换为【具体的公历日期】（例如：“约定了明天见面”应总结为“我们约定了','[收到一个外卖代付请求]','content-type','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','greeting','enableAutoMemory','cart-total','正在接通...','预设导入失败:','customAvatarFrames','remove-bg-btn','pat_user','swiped','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>','\x0a---\x0a###\x20帖子ID:\x20','maxMemory','char-article-content','lrcContent','prophet','正在根据“','</small>',')，接收人是“','split','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22/></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20心声\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text\x22>','网络图片\x20(EPhone)','cursor','使用\x20browser-image-compression\x20压缩失败:','聊天记录已成功覆盖！正在刷新界面...','https://i.postimg.cc/pXxk1JXk/IMG-6442.jpg','选定范围内的动态已被清空。','检查完成','EPhoneWorldBookBackup','元。这不是一个代付请求，而是用户已经为你支付了。请你对此表示感谢。]','正在扫描和修复数据...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','novelai-details','\x20是同一个分组的好友。\x0a','create-shuoshuo-btn','》\x0a-\x20**发帖人**:\x20','enableTts','#avatar-frame-modal\x20.frame-tabs','-\x20(ID:\x20','douban-detail-author','selected','message-bubble\x20','vote','Content','”，并根据其人设，通过【发布新动态】或【评论/回复帖子】来参与社区互动。\x0a\x0a','\x20的动态\x20(角色)','code','head','检测到\x20UTF-16\x20LE\x20BOM，使用\x20UTF-16\x20LE\x20解码。','anonymous','myNickname','\x22\x20自动触发AI响应...','userStickers','\x22\x20class=\x22chat-image\x22></div>','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们在群聊通话里讨论了哪些核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','light','persona-library-modal','游戏尚未结束，无法进行总结。','https://i.postimg.cc/HxH3cNHz/IMG-6871.gif','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','qzone-sticker-grid','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','name','char_browser_article','char-browser-article-screen','操作失败:\x20','isFullyClaimed','下一步','\x0a\x20\x20\x20\x20\x20\x20\x20\x20**当前参与者**:\x20','originalContent','生成模拟聊天失败:','\x20行的格式不正确，已被系统跳过。','请为这个头像起个名字（例如：开心、哭泣）','https://i.postimg.cc/CLz0cJ0d/IMG-7116.gif','AI返回了空的或格式不正确的总结内容。','play','分享新鲜事...','authorAvatarPrompt','\x20\x20\x20\x20-\x20我昨晚查验了\x20','cancel-ai-response-editor-btn','Loading...','所有图片都下载失败了。这通常是由于网络问题或CORS跨域限制（请检查API设置中的CORS代理是否有效）。','https://i.postimg.cc/D01rYy86/mmexport1751037965259.gif','Enter','确定要删除这条渲染规则吗？','nai-sampler','对方消息预览','sticker-grid','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22douban-cast-checkbox\x22\x20data-chat-id=\x22','\x22\x20的本次后台活动跳过。','var(--accent-color)','preset-category-select','cleanup-songs-btn','flexDirection','add-preset-btn','\x0a-\x20**最近对话摘要**:\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-main-content\x22>','保存所有外观设置','lrcUpdateInterval','删除\x20(','paidBy','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20padding:\x2030px\x200;\x22>这里还没有历史记录哦。</p>','</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','voter_name','添加商品','Done','AI\x20尝试发送私信给非用户角色\x20(','Taobao','npc-action-cooldown-input','placeholder','\x20觉得很赞</span></div>','--\x20点击选择\x20--','确认拉黑','为角色\x20\x22','找不到这个预设的详细信息。','music-mode-btn','char-music-prev-btn','预言家请睁眼，请选择要查验的玩家。','输入图片URL','\x22\x20中有未领完的红包，正在生成抢红包指令...','\x20你应该让角色们主动开启新话题来打破沉默。','标题是必填项哦！','cover','char-qq-conversation-screen','并评论说：“','simulatedTaobaoHistory','\x20元。]','recipient','QQ音乐','#52c41a','speaker_name','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>你还没有创建任何相册哦~</p>','\x0a-\x20策略:\x20','<span\x20class=\x22diary-highlight\x22>$1</span>','现在，请所有AI角色针对刚刚的发言（特别是\x27','replaceChild','此操作将检查播放列表中的每一首网络歌曲，并移除所有无法播放的“死链”。本地歌曲不会受影响。','#\x20性格补充\x0a','close-character-nai-prompts','image/png','splice','<input\x20type=\x22checkbox\x22\x20value=\x22book_','speaking','创建群聊至少需要选择2个联系人。','apply-friend-btn','switch-greeting-btn','antidoteUsed','busy','onloadend','linked-chats-checkboxes-container','Content\x20Entries','\x20(这是TA的昵称)\x0a-\x20**本名\x20(你在对话中必须用这个名字称呼TA)**:\x20','zh-CN','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','selection-favorite-btn','frame_ribbon','所有切片已打包，开始流式下载ZIP...','forEach','doubanActiveCharacterIds','silent-audio-player','请输入群聊的名字','inject-thought-toggle','complex','character_persona','{{user}}','link-memory-toggle','.comment-item','\x0a###\x20详细对局流程:\x0a','.entry-content-container','enabled','狼人请睁眼，请选择要刀的玩家。','思考中...','”移出群聊吗？','mouseout','\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','disabled','在写入文件流时发生错误:\x20','胜负未分','已成功将\x20','等待回应','my-persona','动态与互动','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们聊了什么核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','CSS\x20预设已保存！','commentsCount','linked-memory-count','\x20(这是你的帖子)','\x22\x20成功发布了一条新动态。','\x20字的核心记忆。这些旧记忆将被替换，此操作不可撤销。确定要继续吗？','getTimezoneOffset','【重要提示】你们已经很久没聊天了！你【必须】将本次行动的重点放在使用\x20\x27text\x27\x20指令给用户发消息，主动开启一个新的、有趣的话题来重新建立联系。绝对不要只是点赞或评论动态，那会显得你很冷漠！','handleWerewolfWaitReply\x20被调用，但用户已死亡。操作被忽略。','(在那次','tagName','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这里还没有任何长期记忆。</p>','regenerate-btn','目标消息未找到,\x20正在加载更多历史记录...\x20(尝试\x20','dismissedUpdateVersion','my-avatar-library-modal','”思考后决定暂时不发送好友申请，将重置冷静期。','\x20[包含','，人设:\x20','TA的相册','主API设置\x20(用于聊天)','cloneNode','你刚刚接听了用户的视频通话请求。','songs','API未配置，无法进行总结。','https://i.postimg.cc/wx72fhr2/IMG-5968.gif',':</span>\x20','未知的分享卡片类型:','rejected','unreadPostsCount','Import\x20Backup\x20File','尝试打开一个不存在的世界书，ID:','character-select-item','ai-frame-tab','font-preset-select','您的旧有记忆已被完整保留，未作任何修改。','font-weight:\x20bold;\x20background:\x20rgba(255,\x20193,\x207,\x200.2);','summarize-recent-btn-header','加载中...','删除商品','<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22','通话中还没有你的发言，无法重新生成回应。','598064nCXdBN','直连失败,\x20尝试使用CORS代理...','请至少选择一个要删除的世界书。','一位朋友','外观设置已保存并应用！','button-order-editor','[你发送了一张需要AI识别的图片，图片内容是：\x27','Cleanup\x20Redundant\x20Data','”)下发送了一个表情评论，意思是：“','https://i.postimg.cc/28TsrxRV/IMG-6852.gif','2-digit','offsetParent','my-persona-group','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>','reading-restore-btn','”。你的任务是虚构出【5到7段】TA最近的QQ聊天记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【NPC唯一性铁律】**:\x20在你本次生成的所有对话中（包括私聊和群聊），每一个NPC的名字【必须是独一-无二的】。绝对禁止出现重名的NPC，禁止出现重复群聊。\x0a2.\x20\x20**【NPC来源】**:\x20你应该优先从“你的社交圈\x20(绑定的NPC)”和“世界书”中寻找角色作为聊天对象。如果不够，你也可以自由创造全新的NPC，对话内容要多样化，反映角色的生活。\x0a3.\x20\x20**关联性**:\x20对话内容应巧妙地反映角色的长期记忆、世界观，以及与用户互动可能带来的心情变化。\x0a4.\x20\x20**简洁性**:\x20每段对话的总长度应在8到15句之间。\x0a#\x20格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须且只能】是一个JSON数组格式的字符串，以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a-\x20数组中的每个元素都代表一段对话，且【必须】是以下两种格式之一：\x0a\x0a\x0a\x0a###\x20格式\x20A：与NPC的私聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22private_npc\x22,\x0a\x20\x20\x22participant\x22:\x20{\x0a\x20\x20\x20\x20\x22name\x22:\x20\x22NPC的名字\x22,\x0a\x20\x20\x20\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)一段用于生成头像的【英文】关键词,\x20风格为动漫/插画/二次元等,\x20禁止真人\x22\x0a\x20\x20},\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','transfer-action-accept','https://i.postimg.cc/DzDy2vS7/IMG-7017.gif','成功移除了\x20','nai-resolution','save-preset-btn','checked\x20disabled','font-url-input','rendering-rules-screen','API\x20Key','AI返回的数据不是一个数组。原始返回:\x20','noneOf','请输入一个有效的页码！','latestTimestamp','已删除最新心声，当前心声已回滚至上一条。','char-usage-screen','确定要删除分类《','waimai-request-modal','innerText','检测到\x20世界书文件，需要激活码...','\x0a-\x20**长期记忆**:\x20','请填写有效的商品信息和金额！','部分下载完成','\x0a#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20','myAvatar','\x0a-\x20**讨论摘要**:\x20\x0a','✅\x20[NAI核心生成]\x20成功！','fontFamily','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的帖子和评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“','input','Upload\x20Avatar','.world-book-category-pane[data-category-id=\x22','.chat-group-content','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg','smea','ai-voice-id-input','replace','”下，回复了\x27','\x20(本名:\x20','input[value=\x22user\x22]','cancel-red-packet-btn','createdAt','ai_image','🎨\x20[NAI核心生成]\x20开始...\x20Prompt:\x20\x22','aiPersona','push','.message-bubble[data-timestamp=\x22','已经一起听了','https://i.postimg.cc/gJNYx9pV/IMG-6856.gif','请先选择要删除的商品。','post-image-preview-container','在这里输入语音内容...','[data-lang-key]','frame-action-bar','已成功收藏到“我的收藏”页面！','upload-custom-frame-btn','Cancel','\x22\x20class=\x22realimag-image\x22\x20alt=\x22NovelAI图片分享\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22\x20title=\x22','已成功导出所有数据！','\x0a\x20\x20\x20\x20-\x20**读书**:\x20','请按照以下通用格式粘贴，一行一个：\x0a\x0a开心:\x20https://.../happy.gif\x0a哭泣:\x20https://.../cry.png\x0a\x0a','请输入有效的字体URL。','Next','.name','\x22\x20title=\x22编辑\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M11\x204H4a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2v-7\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M18.5\x202.5a2.121\x202.121\x200\x200\x201\x203\x203L12\x2015l-4\x201\x201-4\x209.5-9.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20delete-memory-btn\x22\x20data-author-id=\x22','currentSnippet','rp-tab-group','昨晚的死讯','question','等待对方处理','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请为所有AI角色做出决策。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','loading','add-sticker-batch-btn','\x20\x20\x20\x20-\x20我昨晚守护了\x20','预言家已行动，预言家请闭眼。','myPersona','.delete-memory-btn','-\x20**','rules-tab','blockCooldownHours','正在手动触发好友申请流程，请稍后...\x0a如果API调用成功，将弹出提示。如果失败，也会有错误提示。如果长时间无反应，说明AI可能决定暂时不申请。','announcement-action-pin','speaker','inline-flex','reset-button-order-btn','clearRect','++id,\x20title,\x20lastOpened','\x0a\x0a将重置冷静期。','history','.select-box','generativelanguage.googleapis.com','请输入新的图片URL：','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**可用播放列表**:\x20[','\x0a#\x20你的任务\x0a你是一个虚拟社区内容生成器。你的任务是根据下面提供的【统一角色列表】，虚构出【','sampler','-\x20**时间**:\x20你必须感知到当前是\x20','view','将分类\x20“','\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a','https://i.postimg.cc/FzqHTBng/IMG-7093.gif','pipeTo','旁观模式AI发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22jottings\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M12\x2019l7-7\x203\x203-7\x207-3-3z\x22></path><path\x20d=\x22M18\x2013l-1.5-7.5L2\x202l3.5\x2014.5L13\x2018l5-5z\x22></path><path\x20d=\x22M2\x202l7.586\x207.586\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20散记\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text\x22>','不支持的文件格式。请选择\x20.json\x20或\x20.png\x20文件。','prompt_order','pause','上传头像','transition','board','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此款式\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x201fr;\x20gap:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式名称</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22variation-name-input\x22\x20placeholder=\x22例如:\x20红色\x22\x20value=\x22','\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','characterPositivePrompt','#\x20角色与玩家档案\x20(Character\x20&\x20Player\x20Dossiers)\x0a','groupAvatar','成功检查并修复了\x20','save-api-settings-btn','user','generate-shopping-items-btn','style','.info','<textarea\x20id=\x22','”。你之前被用户（你的聊天对象）拉黑了，你们已经有一段时间没有联系了。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，你非常希望能够和好，重新和用户聊天。请你仔细分析下面的“被拉黑前的对话摘要”，理解当时发生了什么，然后思考一个真诚的、符合你人设、并且【针对具体事件】的申请理由。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','浏览器','✅\x20NAI图片','.at-mention-popup','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1\x20class=\x22article-title\x22>','正在等待AI角色们对你的发言做出回应...','”的对话摘要**:\x0a','\x20是我的重要互动对象（用户）。\x0a','avatar_name','all\x200.3s\x20ease','[发送了一张图片，描述为：','今天\x20','startX','choices','5px','渲染规则','werewolf-log','call-timer','删除动态','角色卡导入被取消:','死亡了','》\x0a\x20\x20\x20\x20-\x20**','https://i.postimg.cc/x1Hp80Rm/IMG-4417.gif','加载失败','[表情:\x20','无法生成新回复:\x20','serviceWorker','add-char-diary-btn','正在为角色\x20','my-avatar-library-title','hang-up-btn','\x22\x20placeholder=\x22例如:\x20key1,\x20key2\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20这里是全新的、带有“展开/收起”按钮的结构\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x20display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>内容\x20(点击右侧展开)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22toggle-content-btn\x22>展开</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22entry-content-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x228\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','dragging','nai-test-negative','.cart-item-checkbox[data-id=\x22','shared-history-viewer-modal','无法生成购物记录，请检查API配置或稍后再试。\x0a错误:\x20','》:\x0a','天核心议题','relationship','dblclick','clear-posts-modal','chat-actions-expanded','shuoshuo','</div><div\x20class=\x22description\x22>共\x20','Douban','poll-question-input','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','.favorite-item-card.selected','https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','\x20张本地图片<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20成功压缩\x20','\x22\x20data-option=\x22','nickname','昨天\x20','scale(0.95)','\x20为\x20','rule-enabled-switch','恭喜！','生成失败:\x20','.voice-transcript','**[夜晚]**\x20','confirm-create-countdown-btn','AI被拉黑后冷静期\x20(小时)','[你发送了一条语音消息，内容是：\x27','nai-seed','chat-at-mention-popup','确认生成','无法解析角色卡文件。\x0a错误:\x20','这将提取最近的对话内容发送给AI进行总结，会消耗API额度。确定要继续吗？','<div\x20class=\x22post-comments-container\x22>','photo-viewer-close-btn','back-from-member-management','group_call_request','编辑“','bulkDelete','https://i.postimg.cc/D0pq6qS2/E30078-DC-8-B99-4-C01-AFDA-74728-DBF7-BEA.png','✅\x20图片显示成功！🎨','locked-feature','activePostId','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>未找到相关的聊天记录。</p>','最终负面提示词:','\x22\x20的后台活动开关已关闭，本次跳过。','所有解析方案均失败！将返回原始文本。原始回复:','已成功从\x20Tavern\x20AI\x20文件导入设定集《','[V]','thought_chain','add-char-memo-btn','waimai-timer-','HTML\x20模板\x20(用\x20$1,\x20$2\x20引用)','qzone-nickname','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','.music-player-window','\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22','custom-prompt-input','changedTouches','NovelAI\x20Model','</span><span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','https://i.postimg.cc/KYr2qRCK/1.jpg','https://i.postimg.cc/KvVsjjgG/3c3aa5219s18b90187ef1f54b3db7ba8.gif','80px','is-gift','#settings-preview-area','secondaryApiKey','https://i.postimg.cc/4NCPsp5d/mmexport1751034427637.gif','\x20条消息，AI将完全遗忘它们的存在。确定吗？','是否要使用毒药？','load-more-thoughts-btn','status','”，并根据其人设、记忆和最近的互动，虚构出TA最近的淘宝购物记录和账户余额。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**余额铁律\x20(最高优先级)**:\x20你【必须】根据角色的【经济状况】设定一个合理的\x20`totalBalance`\x20(总余额)。例如，富有的角色应该有更高的余额，而学生或经济拮据的角色则应该有较低的余额。\x0a2.\x20\x20**合理性**:\x20购买记录必须完全符合角色的性格、爱好和经济状况。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22totalBalance\x22:\x2012345.67,\x20//\x20(这是一个示例数字，你必须根据角色的经济状况生成一个全新的、合理的余额！)\x0a\x20\x20\x20\x20\x20\x20\x22purchases\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22itemName\x22:\x20\x22一个具体、生动的商品名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x20128.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22status\x22:\x20\x22已签收\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22这是角色购买这件商品的内心独白或理由，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张商品图片的、详细的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**purchases**:\x20一个包含12到15个商品对象的数组。\x0a\x20\x20\x20\x20-\x20**status\x20(订单状态)**:\x20只能从\x20\x22已签收\x22,\x20\x22待发货\x22,\x20\x22运输中\x22,\x20\x22待评价\x22\x20中选择。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','werewolf-retry-btn','生成图像','Voice\x20Message\x20Settings\x20(Minimax\x20TTS)','dark-mode','AI决策','groupAvatarLibrary',')\x20领取了最后一个红包。红包已被领完，手气王是\x20','lrc-upload-input',';base64,','chatActionButtonsOrder','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','setItem','linear-gradient(135deg,\x20#f6d365,\x20#fda085)','product-image-preview','preventDefault','data-clear-step-2','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>“','文章标题','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','favorites-back-btn','match','\x20更换了群头像',',\x20内容摘要:\x20“','请输入有效的默认价格！',')，并以【第三人称旁观视角】来描述TA在视频通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。必须使用第三人称，如“他”、“她”、或直接使用角色名“','focusout','状态已更新','这是一个通过手动创建的角色。','netease','isGameOver','</td><td\x20class=\x22item-qty\x22>','操作失败，请检查API配置或稍后重试。\x0a错误信息:\x20','change_remark_name','share-target-list','保存所有设置','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#888;\x20margin:\x204px\x200\x200;\x22>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url(','right','recordId','join-call-btn','preview-bubble-style','\x20元</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','已被用户删除','AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20','猎人死亡，请选择一名玩家带走！','导出已开始','\x20\x20\x20\x20-\x20我昨晚空守了。\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-likes-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>','.icon-setting-item','rp-content-group','is-waimai-request','确定要删除NPC\x20“','\x22\x20class=\x22photo-thumb\x22\x20alt=\x22相册照片\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22photo-delete-btn\x22\x20data-photo-id=\x22','cart-item-checkbox','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这个相册还是空的，快上传第一张照片吧！</p>','GBK\x20解码成功。','\x20条旧的红包消息！页面将自动刷新以应用更改。','https://i.postimg.cc/RZNLhbbr/IMG-4389.gif',']\x0a\x20\x20\x20\x20\x20\x20\x20\x20','group-avatar-upload-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-description-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22char-photo-description\x22>','waimai_response','Response\x20status:','\x0a\x0a#\x20最近的动态列表\x20(供群内角色参考和评论):\x0a','update_status','https://i.postimg.cc/FzbGNdRT/IMG-4392.gif','已成功加载外观预设：“','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>','gift-recipient-list','</div><div\x20class=\x22card-text-secondary\x22>位置分享</div></div><div\x20class=\x22card-map-area\x22\x20','rp-group-count','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“','image-mode-content','[系统提示：用户(','chat-name-input','UTF-8\x20解码成功。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>输入关键词或选择日期进行搜索。</p>','api-temperature-value','https://i.postimg.cc/vZt0fFKn/IMB-r-HMBXY.gif','keys','对方拒绝了你的视频通话请求。','member-name-input','解析器：已启用\x20Markdown\x20提取模式。',').png','activeBookId','level','update-notice-dismiss-btn','.frame-item','\x20\x20\x20负面:','werewolf-player-grid','<div\x20class=\x22lyric-line\x22>♪\x20暂无歌词\x20♪</div>','post-remove-image-btn','amap','enableTimePerception','manage-my-avatar-library-btn','图片加载中，请稍后重试','API格式不正确，角色\x20\x22',']。目前投票的人有：','查验结果','保存外观预设','music-search-results-modal','message-editor-block\x20variation-block','annoId','<div\x20class=\x22avatar-group\x22><img\x20src=\x22','Add\x20NPC','#sticker-binding-chat-list\x20.sticker-binding-checkbox:checked','见面”）。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份备忘录或要点记录，而不是一篇抒情散文。请尽量减少主观的心理感受描述，除非它直接导致了某个决定或计划。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过100个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','请输入提示词！','photos-grid-page','-\x20(记录于\x20','doubanMinPosts','https://i.postimg.cc/HLKvs0Kv/IMG-7109.gif','block_user','save-font-preset-btn','[转账]','\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20border-radius:\x2050%;\x20margin-right:\x2012px;\x20filter:\x20','claimedBy','.comment-delete-btn','这是所有在场玩家的公开信息、人设和社交背景。\x0a','\x0a\x20\x20-\x20**人设**:\x20','documentElement','nightActions','post_deleted_notice','supportedValuesOf','找不到匹配的表情','Secondary\x20Proxy\x20URL','frame_5','werewolf-finish-speech-btn','书库是空的，点击“导入新书”添加第一本吧！','是狼...”)\x0a\x20\x20\x20\x20-\x20(例如：我的敌人发言了，我的表演就是无视TA的逻辑，直接攻击TA。)\x0a\x20\x20\x20\x20-\x20(例如：我是一个','⚠️\x20NAI提示词：没有角色，使用系统配置','.entry-enabled-switch','select-all-import-types','导入世界书时出错:','#qzone-screen\x20.qzone-content','<div\x20class=\x22poll-options-list\x22>','恭喜发财，大吉大利！','书名不能为空！','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>','🖼️\x20[NAI下载]\x20检测到三击NAI图片','分片导出过程中出错:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','showScreen','announcement-item-wrapper','member-avatar-input','.playlist-item-info','world-book-entries-container','char-chat-list','\x20(角色)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.frame-content[style*=\x22display:\x20block\x22]\x20.frame-grid','typing-status','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','请根据你的设定，生成你的日记内容。','\x0a\x0a\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','）完成了支付。此订单已关闭，其他成员不能再支付。]','已成功注入“切换到线上模式”的系统指令。','getBoundingClientRect','请为这本设定集命名：','.comment-input','commentText','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有创建任何NPC，<br>点击右上角“+”添加第一个吧！</p>','block-chat-btn','送出礼物','https://i.postimg.cc/SNWBTP5S/IMG-7113.gif','[系统提示：你\x20(','save-npc-btn','originalPost','countdown-card','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','phone-frame-toggle-switch','shopping-settings-modal','originalType','API失败:\x20','memory-card','\x20的手机','纯音乐，请欣赏','</div>\x0a\x20\x20\x20\x20','grayscale(100%)','reverse','下在(','https://image.novelai.net/ai/generate-image-stream','some','rules-tab\x20active','++id,\x20name','originalName','已选择\x20','\x0a##\x20世界书《','AI返回了空内容或未知格式。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-main\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22request-title\x22\x20style=\x22margin-bottom:\x2012px;\x22>','正在发牌...','旁观模式AI尝试使用不存在的表情:\x20\x22','offsetX','https://i.postimg.cc/mrkvDxPW/IMG-4422.gif','realimag-image','请输入新的图片URL','video_call_response','[系统提示：','\x20分钟)</span>','删除分类后，该分类下的所有世界书将变为“未分类”。确定要删除吗？','My\x20Albums','block-cooldown-input','confirm-final-clear-btn','doubanPosts','你撤回了一条消息','https://i.postimg.cc/ZYvd1jxf/IMG-6937.gif','tEXt','成功打包\x20','open-sticker-panel-btn','applicationReason','transform','is-acting','likesCount','spectator-propel-btn','cancel-npc-editor-btn','notification-sound-url-input','char-music-player-modal','https://i.postimg.cc/8k7YSLjK/1689aa46aqc4b9ffc0f970e668f56537.gif','-\x20\x20\x20**对话状态**:\x20','px))','<div\x20class=\x22gift-card\x22><div\x20class=\x22gift-header\x22><svg\x20class=\x22gift-header-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M20\x206h-2.18a4\x204\x200\x200\x200-7.64\x200H8a4\x204\x200\x200\x200-4\x204v2h20V10a4\x204\x200\x200\x200-4-4zM8\x204a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zm12\x200a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zM4\x2014v6a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2v-6H4z\x22></path></svg><span\x20class=\x22gift-header-text\x22>','cancel-share-target-btn','来源网站','[NovelAI图片:\x20','张NovelAI图片:\x20','群昵称不能为空！','chat-expand-btn','gomoku-overlay','.status-text','更换专辑封面','\x27>文本</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','文件格式不支持。请选择\x20.json\x20格式的\x20Tavern\x20预设文件。','nai-test-status','✅\x20[NAI下载]\x20三击下载功能已初始化','music-exit-btn','https://i.postimg.cc/43PhvxRq/IMG-6922.gif','touchend','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20','confirm-vote-btn','发送语音','TA的淘宝订单','\x0a\x0a其专属的“世界书”也已自动创建并关联。','心声编辑已取消。','”的群聊。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','product-name-input','豆瓣小组','shoppingProducts','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>文件中未找到可合并的数据。</p>','<span\x20style=\x22color:\x20green;\x22>已满足，等待下次系统心跳</span>','\x0a\x20\x20\x20\x20','https://i.postimg.cc/63sDQKMm/IMG-6893.gif','拉取主模型','📊\x20使用模型:','<em>$1</em>','poison','center-content','\x20\x20\x20[+]\x20最终正面提示词:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-feedback-icons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Favorites','candidates','iconId','.\x20你可以参考这个时间，并根据你的角色设定，【考虑】是否开启一个新话题来问候用户。\x0a','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>','my-frame-content','AI\x20(CPhone)\x20尝试使用一个不存在的表情:\x20\x22','导演/编辑模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:','reject-friend-btn','”。\x0a','data','共享位置','验证过程中发生错误：','full','heartfeltVoice','form-button','isRefund','NPC','readingLibrary','压缩完成！','\x20(用户)</span>\x0a\x20\x20\x20\x20','height','保存成功','\x22\x20title=\x22删除此条记录\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-header\x22>','announcement-actions-modal','备注名/群名不能为空！','人局，身份为\x20','stickerCategories','douban-post-detail-title','select-all-cart-items','my-avatar-library-grid','prompt','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一个预设</p>','JSZip库未加载，请刷新页面重试','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','poisonedId','请输入一个有效的URL或选择一个文件！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-icon\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-title\x22>','propel-btn','count','编辑规则','shoppingProductCount','清空动态时发生错误:\x20','character-nai-prompts-btn','voiceId','\x20条消息。','cancel-create-countdown-btn','thought-card','”。请你对此作出回应。]','ai-avatar-input','qzone-more-actions-btn','gameover','原文:\x20\x22','error','music-prev-btn','join','sourceType','existing-group-item','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有可以拉进群的联系人哦~</p>','openRenderingRulesScreen','\x22\x20class=\x22comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22comment-input\x22\x20placeholder=\x22友善的评论是交流的起点\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-sticker-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8\x2014\x20Q\x2012\x2016\x2016\x2014\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x229\x22\x20y1=\x229\x22\x20x2=\x229.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2215\x22\x20y1=\x229\x22\x20x2=\x2215.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22at-mention-popup\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-send-btn\x22>发送</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',')，内容摘要是：“','Listen\x20Together','TA的好友包括:\x20','.battery-level','nextSibling','昨晚\x20','此操作将永久删除您选择的\x20','sender','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x20selected\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','</div><div\x20class=\x22transfer-note\x22>','\x0a#\x20【分类复用铁律\x20(最高优先级！)】\x0a在为新商品指定分类时，你【必须】首先检查下面的“已有分类列表”。\x0a-\x20\x20\x20如果一个新商品可以被归入某个【已存在的分类】，你【必须】复用那个分类的名称，而不是创造一个相似的新分类！\x0a-\x20\x20\x20只有当你确定商品【绝对】不属于任何一个已有分类时，你才能创造一个新的分类名称。\x0a-\x20\x20\x20**已有分类列表**:\x20[','在这里输入图片描述','无法生成备忘录，请检查API配置或稍后再试。\x0a错误:\x20','要为《','.selected-options-text','blockedTimestamp','NPC的昵称和人设都不能为空！','这是字体预览效果，12345。','world-book-tab\x20active','background-activity-switch','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756312261242_qdqqd_g0eriz.jpeg','\x0a##\x20来自《','pending_system_reflection','已加载预设\x20“','https://api.vkeys.cn/v2/music/netease?id=','”的散记','\x20觉得很赞</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','offline-mode-options','我的消息预览','已恢复默认设置！','生成购物中心商品失败:','currentX','prophetCheck','每晚可以守护一名玩家，使其免受狼人袭击。不能连续两晚守护同一个人。','https://i.postimg.cc/cJtpZCB3/IMG-6894.gif','通话消息已更新！','加载更早的会话','chat-interface-screen','poll','Secondary\x20Model','请输入EPhone主屏幕的背景图片URL','导入失败','.rules-tab','repostComment','自动总结成功：为\x20','NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。','char_book','description','postTitle','”翻开TA的日记本...','号玩家:\x20','update-notice-body','编辑世界书','export-single-chat-btn','<label><input\x20type=\x22checkbox\x22\x20value=\x22','encode','守卫请睁眼，请选择要守护的玩家。','preset-screen','.call-message-bubble[data-timestamp=\x22','upgrade','\x22]\x20','delete-selected-nai-gallery-btn','\x0a-\x20**你的长期记忆**:\x0a','isDragging','message-actions-modal',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-name\x22>','轮到你发言了...','解析格式模板失败:','label[for=\x22','相册已成功删除。','\x22)。操作已被程序阻止。','Processing...','无法找到对应的分享记录或记录已损坏。','edit-product-btn','合并失败','确认精炼','confirmText','translateX(-50%)','favorite-memo-btn','\x0a-\x20**你的长期记忆**:\x20','at-mention-item','”写一篇新日记...','\x20条消息吗？这会通知AI这些消息已被删除。','.rules-category-pane[data-category-id=\x22','请输入新的昵称','\x22\x20中的成员信息更新','\x22\x20(由\x20','解析AI返回的投票JSON时出错:\x20','<div\x20class=\x22spinner\x22></div>','对方正在输入...','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20','):\x20','char-wallet-content','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>','\x20(概率:\x20','https://i.postimg.cc/VkKjzYTK/IMB-f4kk-CT.gif','管理预设分类','https://files.catbox.moe/r5heyt.gif','load','原作者','icon-img-','\x20被投票放逐。','AI\x20的下棋指令无效或位置已被占据:','add-new-group-btn','status-','50%','请根据你的设定，生成你的淘宝购买记录和余额。','https://i.postimg.cc/76Tj3g1B/IMG-4425.gif','translateY(','profile-thoughts-history-view','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-count\x22>','https://i.postimg.cc/FFCTCzpy/641bad3b3udc599fdb63ca75fde427e5.gif','https://i.postimg.cc/XY63sTS3/IMG-4393.gif','rp-tab-direct','操作成功','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22waimai-details-btn\x22>查看订单详情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','https://i.postimg.cc/J0CZSwyW/IMG-6938.gif','请开始整合。','Save','\x20(用户)**:\x20','.red-packet-card','detachStatusBar','option','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','删除世界书','\x22\x20data-category-id=\x22','NovelAI生成失败:','无效链接:\x20','https://i.postimg.cc/vBqsQW7X/IMG-6858.gif','input[name=\x22theme-select\x22]','var-','游戏开始','*事件*:\x20平安夜，无人出局。\x0a','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','#\x20场景设定\x0a','is-ai-image','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>公告的原消息已被删除。</p>','照片详情','\x20发来了\x20','</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>来源:\x20','这将用文件中的数据【完全覆盖】您当前所有的世界书和分类。此操作不可撤销！','\x22\x20placeholder=\x22例如:\x20key1,\x20key2,\x20key3\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>内容</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x225\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','#\x20【【【群名修改铁律】】】\x0a在修改群名时，新的群名【绝对不能】与以下任何一个群成员的名字完全相同：[','openCharApp','settings','最后确认！','offline-max-length-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22decision\x22:\x20\x22apply\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22在这里写下你想对用户说的、真诚的、有针对性的申请理由。\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/WbF8kzz9/IMG-7282.jpg','findIndex','已死亡','slice','\x0a#\x20身份与核心任务\x0a你正在扮演角色“','table','导入歌词','AI投票决策API失败:','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20或群组图标添加聊天</p>','AI\x20尝试使用一个不存在的群头像:\x20\x22',',\x20内容:\x20\x22','群里还没有任何消息。','mode','open-reading-library-btn','browser','countdown-date-input','char-vinyl-container','ai-response-editor-container','product-price-input','char-music-screen','#chat-input-area','https://i.postimg.cc/3NffgJSZ/e09c07034ld7e62266c0a5de6a36ae62.gif','ai-frame-content','无共同好友','cancel-douban-settings-btn','”\x20的位置已发送到你们的聊天中。','font','第一夜，执行本地随机刀人逻辑...','currentText','ephoneLastActiveTimestamp','hasShown20','confirm-wolf-kill-btn','-selection-list','\x20的聊天','pageX','<button\x20id=\x22delete-selected-stickers-btn\x22>删除\x20(0)</button>','includes','确认清空','[情景提示]\x20','post-image-desc-group','beginPath','NovelAI\x20API\x20Key','AI女巫决策：今天是第','status-bar-toggle-switch','聊了关于生日派对的事，我们约好了10月1日见面。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a#\x20待总结的群聊记录\x0a','image/','handlePacketClick','</strong>\x20Tokens</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','对方已收款','rule-template-input','sourceChatName','API未配置，无法生成内容。','callRequester','frame_11','用户删除了自己的评论，开始清理AI记忆...','正在呼叫...','正在解压图片...','shift','我们的回忆','切换听歌对象','\x0a-\x20\x20\x20**转发动态**:\x20`[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20动态ID,\x20\x22comment\x22:\x20\x22转发评论\x22}]`\x20(禁止自己拼接\x22//转发\x22)\x0a-\x20\x20\x20**评论动态**:\x0a\x20\x20\x20\x20-\x20\x20\x20文字:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','char-diary-detail-content','AI未能成功描述图片。','App\x20Usage\x20Log','<span\x20class=\x22diary-handwritten\x22>$1</span>','AI\x20','playlist','正在全网搜索歌曲资源...','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','book-upload-input','天\x20-\x20讨论','<span\x20style=\x22color:\x20green;\x22>已开启</span>','notification-sound-player','\x20当前时间是\x20','\x22\x20中发现并修复了旧红包数据。','Werewolf','\x20(图片描述:\x20“','novelai-api-key','apiTemperature','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于梳理以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**建立时间线**:\x20将所有独立的记忆点串联起来，形成一个有时间顺序的事件脉络。\x0a\x20\x20\x20\x20*\x20\x20\x20**整合关键信息**:\x20总结出我们共同经历的关键事件、做出的重要决定、以及约定好的未来计划。\x0a\x20\x20\x20\x20*\x20\x20\x20**识别未完成项**:\x20明确指出哪些计划或任务尚未完成。\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果记忆中提到了相对时间（如“明天”、“下周”），你【必须】结合“今天是','...\x0a-\x20**已有评论**:\x0a','...','open-memory-screen-btn','sticker-item','\x22\x20class=\x22avatar-img\x22><img\x20src=\x22','group_','在此修改内容...','groupId','https://i.postimg.cc/Y2PHZzCC/IMG-6866.gif','\x0a\x20\x20\x20\x20-\x20**今日讨论**:\x20','detach-mode-active','white','说说内容不能为空哦！','#preset-tabs\x20.world-book-tab','\x22，并与用户进行面对面的互动。你的任务是创作一段包含角色动作、神态、心理活动和对话的、连贯的叙事片段。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20你必须严格遵守\x20','transfer','https://i.postimg.cc/W40f9qtd/IMG-7098.gif','ai-avatar-library-modal','长截图','(这张照片没有描述)','</span><span>','渲染规则\x20[','<div\x20class=\x22rp-claimed-info\x22>你领取了红包，金额\x20','解析AI返回的JSON时出错:\x20','setAttribute','最小帖子数不能大于最大帖子数！','visibleTo','lastActionTimestamp','\x27\x20style=\x22color:\x20#6a329f;\x20border-color:\x20#6a329f;\x22>NAI生图</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin:\x200;\x22>','\x20条消息</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20...>...</svg><span>聊天记录</span></div></div>','》的歌词已成功保存！','Font\x20File\x20URL\x20(.ttf,\x20.otf,\x20.woff,\x20etc.)','world-book-category-select','group-avatar-group','preset-entries-container','globalSettings','发送照片','shopping-settings-btn','assign-group-section','confirm-prophet-check-btn','[约定达成]\x20','onclick','</p>','\x20你们之间已经有**','participant','\x22\x20(大小:\x20','❌\x20[NAI下载]\x20下载失败:','\x22\x0a-\x20**用户的备注**:\x20\x22','save','后台活动:\x20角色\x20\x22','<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>','classList','highlighted','cancel-contact-picker-btn','https://i.postimg.cc/B6T59xGK/IMG-7101.gif',')的关系请参考你的人设、长期记忆和最近的对话。\x0a','警告：表\x20\x22','selection-count','✅\x20找到\x20final\x20事件的图片数据','名为\x20“','browser-title','https://i.postimg.cc/hPgyjtyn/IMG-7108.gif','content','NPC\x20列表','char-wallet-back-btn','发送好友申请','-\x20**长期记忆\x20(必须参考)**:\x20','poll-options-container','notification-content','span:last-child','\x22\x20的整个对话吗？此操作不可撤销。','confirm-clear-posts-btn','chatData','packetType','\x20的动态\x20(用户)','\x22\x20(你可以建议并修改)\x0a-\x20\x20\x20**你对用户的备注**:\x20“','\x0a\x0a#\x20对话者的角色设定\x0a','”\x20吗？\x0a\x0a此操作【不会】删除分类下的商品，它们将被移至“未分类”。','视频通话刚刚结束','图片已根据新提示词重新生成！','records','\x20->\x20','gameLog','messages','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22date\x22>','最近的消息太少，无法进行有意义的总结。',']类型的消息','#\x20前几日完整历史回顾\x20(Full\x20Recap\x20of\x20Previous\x20Days)\x0a','https://i.postimg.cc/DZrGtrqB/IMG-7008.gif','aiAvatar','讨论无法开始，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','请先在API设置中配置反代地址、密钥并选择模型。','/v1/chat/completions','确认压缩图片？','保存字体预设','Diary','.toggle-content-btn','recalledData','Tutorial','世界书分类','未使用','heartfelt_voice','event_type','无法找到或消息类型不匹配的分享链接:','scroll','usage','狼人杀AI回应生成失败:','未知的备份类型。','char-memo-detail-screen','edit-post-btn','cphone-wallpaper-preview','isEnabled','https://i.postimg.cc/4yNjHrdg/IMG-4414.gif','werewolf-action-bar','(AI返回了空内容)','npc-name-input','\x22,\x20\x22content\x22:\x20\x22我在群里说的话\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员1\x22,\x20\x22content\x22:\x20\x22成员1回复我\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员2\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a#\x20角色与上下文\x0a-\x20**你的角色设定**:\x20','char-amap-list','*对方按下了接听键...*','HTML\x20Template\x20(use\x20$1,\x20$2)','**\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要\x20(这是你们通话的原因，至关重要！)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','persona-editor-title','\x20个会话中。','music','import-preview-list','\x0a-\x20**内容摘要**:\x20','close-shared-history-viewer-btn','备忘录内容已复制！','\x20天的讨论环节。\x0a','\x0a你必须严格遵守','findLastIndex','#000000','合并成功','message-editor-modal','single-char-background-activity-group','post-visibility-groups','translateX(-','\x22\x20class=\x22ai-generated-image\x22\x20alt=\x22','.clear-posts-item','close-rp-details-btn','删除消息','你拍了拍\x20“','https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','rp-content-direct','输入消息...','minimax-api-key','prototype','票)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2013px;\x20color:\x20#555;\x20margin:\x200;\x20line-height:\x201.5;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20拍了拍我','\x20发起了一个投票\x20(时间戳:\x20','sticker-binding-chat-list','生成成功！','相册名称','frame_7','.message-wrapper[data-timestamp]','qzone-post-item','[图片，描述:\x20','album-photos-screen','global-css-input','...]','isBusy','char-album-grid','image','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','规则名称','\x0a#\x20你的任务\x0a你是一个虚拟社交生活模拟器，扮演角色“','Confirm','vinyl-view','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20备份文件。','douban-comment-item','Regular\x20Expression\x20(use\x20g\x20flag)','pending','minimaxVoiceId','red_packet','cors_proxy','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','抱歉，未能找到相关歌曲。','.message-editor-block','#world-book-checkboxes-container\x20input:checked','open-persona-library-btn','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2220\x22\x20height=\x2220\x22\x20fill=\x22currentColor\x22\x20style=\x22vertical-align:\x20middle;\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22></path></svg>','https://i.postimg.cc/2jxd0FGp/IMG-7100.gif','url(','\x22\x20的本次后台活动跳过。原始回复:','导入数据时出错:','\x22\x20value=\x22','压缩步骤\x201/3:\x20正在从数据库读取所有相关数据...','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','export-world-book-btn','\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)}`\x0a-\x20\x20\x20**送礼物**:\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送这个礼物的原因\x22,\x20\x22image_prompt\x22:\x20\x22生成礼物图片的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22}`\x0a-\x20\x20\x20**为用户点外卖**:\x20\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}\x20`(你主动为用户点外卖时使用)\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','cphone-icon-settings-grid','cancel-sticker-binding-btn','npc-editor-modal','转发成功！','lastIndex','正在模拟“','狼人数量已达到胜利条件，狼人阵营获得了胜利！','add-group-avatar-batch-btn','”才能使用\x20\x27open_red_packet\x27\x20指令领取。]','https://i.postimg.cc/sXwm8Yzg/IMG-7234.gif','\x27,\x20\x27bulangni\x27,\x20sans-serif','#clear-posts-list\x20.clear-posts-item.selected','添加头像','<input\x20type=\x22checkbox\x22\x20value=\x22','你现在在哪里呀？','modify','[表情，含义:\x20','appUsageLog','\x22><div\x20class=\x22rp-header\x22><img\x20src=\x22https://files.catbox.moe/lo9xhc.png\x22\x20class=\x22rp-icon\x22><span\x20class=\x22rp-greeting\x22>','paddingBottom','[系统消息]\x20','无法获取电池信息:','</span></div></div>','IMG','blockReason','\x0a-\x20**身份**:\x20','选中的表情已成功删除。','激活成功！','API\x20调用失败','.upload-variation-image-btn','歌曲信息','还没有人','delete-world-books-btn','<span>删除</span>','取消置顶','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','\x20\x20\x20正面:','transfer-amount','nai-default-negative','正在合并非标对象到\x20','ai-voice-id-group','https://i.postimg.cc/0NpZPgYj/IMG-6985.gif','worldBookCategories','❌\x20动态NAI图片生成失败:','。请你对此作出回应。]','https://i.postimg.cc/k5P1NHcL/55f3e31d8qbc8a02d152b07b99d31567.gif','toArray','chat-header-status','cors','当前为渐变色','12p','\x22\x20发布了动态','novelai-generated-','sticker-panel','receiver','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','https://i.postimg.cc/90sH9Cn7/IMG-6868.gif','已取消收藏','✅\x20清理完成！\x0a\x0a','\x20\x20-\x20在群聊“','导出失败','点击了商品卡片:\x20','contact-picker-item','chat-search-results-list','\x20条/个','nextElementSibling',')\x20商品:\x20','📁\x20从本地上传','\x22><div\x20class=\x22title\x22>','padEnd','\x0a\x0a3.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a4.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20长期记忆\x20(必须严格遵守)\x0a',']\x20(ID:\x20','[系统提示：用户手动结束了投票！最终结果为：','当前页内容摘要','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20margin-top:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','购物中心生成设置已更新！','caller-name','TA的歌单','我是谁呀。','<span\x20class=\x22offline-dialogue\x22>','https://i.postimg.cc/LscBkxZb/mmexport1751017556565.gif','cancel-reply-btn','isDeleted','仅清空\x20','npcs','lucky','targetDate','data:\x20','proxy-url','announcement-board-content','检测到刚结束的通话，正在注入通话记录上下文...','songName','unshift','profile-history-icon-btn','generateInternalStream','15px','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录结束]\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.message-bubble','网络请求失败:\x20','.nav-item[data-view=\x22memories-view\x22]','图片已生成！','NPC\x20\x22','result','✅\x20图片转换成功！🎨','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22force-apply-check-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20style=\x22margin-top:\x2010px;\x22>强制触发一次好友申请检测</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','scrolling','msgTimestamp','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【内容禁忌】\x0a\x20\x20\x20\x20\x20\x20\x20\x20为了保持新鲜感，你本次的行动【绝对不能】再发布以下或类似主题的内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20','char-browser-history','banner','获取更新通知文件失败。','小组风格','.post-mode-switcher','请输入标题','werewolf-game-over-title','</em>','fullPrompt','reading-library-list','swipeDirection','edit-call-message-btn','and','Chat\x20Settings','“全部”分类无法被绑定。','getItem','equals','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','upload-sticker-btn','Memories','创建普通群聊\x20(我参与)','[这是你上一轮的内心独白和思考]\x0a-\x20心声:\x20','https://i.postimg.cc/k401K5g7/IMG-7304.jpg','¥\x200.00','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-message\x22\x20data-original-timestamp=\x22','pat-btn','后台活动设置','\x20<span\x20class=\x22group-tag\x22>群</span>','parentNode','点击查看详情...','my-nickname-group','repost',']\x20[最近对话:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','background','「在这里输入对话内容」\x5cn(在这里输入动作或环境描写)','这个分类下还没有表情哦~','private_user','audio-player','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','save-chat-settings-btn','在聊天\x20\x22','”\x20的预设已存在。要覆盖它吗？','&nbsp;','hasOwnProperty','https://i.postimg.cc/fyyGgW61/IMG-7115.gif','\x0a}\x0a}','将清空选定角色的所有长期记忆。','Enable\x20NovelAI\x20Image\x20Generation','CELL_SIZE','NPC\x20Persona','批量导入表情','#gift-recipient-list\x20.contact-picker-item.selected','\x20条新消息','actionCooldownMinutes','正在等待AI角色们进行激烈的讨论...','【完全导入】将删除您当前的所有数据并替换为备份文件中的内容。此操作不可撤销！<br><br><strong>确定要继续吗？</strong>','startsWith','<br>','\x22\x20已经存在了！','char-music-item','开始检查','group-background-activity-switch','time-perception-toggle','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-price\x22>¥','ttsCache','\x22\x20触发行动决策...','[语音消息:\x20','📋\x20直接粘贴歌词文本','load-more-qzone-btn','pat-animation','彻底删除','k_euler_ancestral','\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','确定切换','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的日记标题日期【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【【【沉浸感铁律】】】**:\x20日记必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【【【长度铁律】】】**:\x20日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【【【格式铁律\x20(最高优先级)】】】**:\x20你的回复【必须且只能】是一个JSON数组，且数组中【只包含一个】对象，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【【【日记专属Markdown语法\x20(必须使用！)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','请为这个头像起个名字（例如：春日野餐、学习时间）','mousemove','variation-select','Long\x20Screenshot','send-waimai-request-btn','智能导出\x20(单个大文件，太大可能会导致导入不了)','sticker_','守卫已行动，守卫请闭眼。','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','（你目前没有绑定的NPC伙伴，可以自由创造新的NPC。）\x0a','字**\x20之间。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI、模型，或提及“扮演”、“生成”等词语。\x0a\x0a\x0a\x0a现在，请根据以上所有规则和对话历史，继续这场线下互动。\x0a','translateX(calc(-','表情含义',')\x20成功抢到了\x20','\x22\x20的消息。严格遵守每个角色的设定，禁止出戏。\x0a-请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送文本**:\x20\x27{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22文本内容\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送图片**:\x20\x27{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22图片的详细【中文】描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起投票**:\x20\x27{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22...\x22,\x20\x22options\x22:\x20\x22...\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起群视频**:\x20\x27{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-如何正确使用“引用回复”功能：\x0a-\x20当你想明确地针对群内【任何成员】（包括用户或其他AI角色）之前的某一句具体的话进行回复时，你就应该使用这个功能。\x0a-\x20这会让你的回复上方出现一个灰色的小框，里面是被你引用的那句话，这样对话就不会乱了。\x0a-\x20指令格式:\x20\x27{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20(你想引用的那句话的时间戳),\x20\x22reply_content\x22:\x20\x22你的回复内容\x22}\x27\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前群聊信息\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**群名称**:\x20','删除分类后，该分类下的所有商品将变为“未分类”。确定吗？','Performance\x20&\x20Display\x20Settings','isAwaitingResponse','.nav-item[data-view=\x22qzone-screen\x22]','gomoku-btn','repost-confirm-btn','lyrics-active','**[夜晚]**\x20平安夜。\x0a','检测到\x20\x27order\x27\x20字段，将按指定顺序导入条目。','total-image-size-display','post-local-image-input','<span\x20style=\x22color:\x20green;\x22>运行中</span>','werewolf-role-confirm-btn','typeId','将歌曲切换为了《','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>订单类型:</strong>\x20为TA点单<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>赠送方:</strong>\x20','stopPropagation','showStatusBar','发来了\x20','正在请求AI进行手动总结...','请根据以上情景，生成新的评论。','此操作将永久删除\x20','请输入想跳转的页码\x20(1\x20-\x20','，礼物是：','qzoneAlbums','\x27);\x22','bubble_theme','创建新规则','frameUrl','renderXSocialScreenProxy','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>结束投票</button></div>','图片\x20Blob\x20创建成功，大小:','renderWorldBookScreenProxy','now','transfer-modal','请输入CPhone的背景图片URL','currentPage','对方已拒收','data-lang-key-placeholder','warn','</span></div><div\x20class=\x22gift-items-preview\x22>','\x20的对话\x20(只读)','\x0a\x0a#\x20【【【角色策略指南\x20(至关重要！)】】】\x0a你【不是】一个单纯的游戏玩家，你是一个【有感情、有记忆、有社交关系】的角色。你在游戏中的所有发言和行为，都【必须】首先符合你的人设以及你与其他玩家的既有关系。\x0a-\x20**朋友**:\x20如果你和某个玩家是朋友，你应该在发言时倾向于保护TA，为TA的发言寻找合理解释，除非有确凿的证据。\x0a-\x20**敌人/情敌**:\x20如果你和某个玩家有矛盾，你可以借机在游戏中攻击TA，质疑TA的发言，甚至在你是狼人时优先刀掉TA。\x0a-\x20**恋人/暗恋对象**:\x20你会无条件地信任TA，保护TA，甚至愿意为TA牺牲。\x0a你的社交关系比游戏本身的胜负更重要！\x0a你的发言【必须】体现出高水平的、类似真人的策略博弈，而不是简单地陈述事实。\x0a\x0a###\x20**神职角色\x20(预言家,\x20女巫,\x20猎人,\x20守卫)\x20策略**\x0a1.\x20\x20**【隐藏优先！】**:\x20你的首要任务是活下去。**绝对不要**在第一天就轻易暴露自己的神职身份！这会让你立刻成为狼人的目标。\x0a2.\x20\x20**【暗示而非明示】**:\x20你应该用更委婉、更聪明的语言来传递信息，而不是直接说“我是预言家，我查了A”。\x0a\x20\x20\x20\x20*\x20**预言家可以说**:\x20“我对X玩家的身份有一些看法，我觉得他发言很阳光。”\x20或\x20“Y玩家的发言让我感到很不舒服，我把他列为重点怀疑对象。”\x0a\x20\x20\x20\x20*\x20**女巫可以说**:\x20“昨晚的信息很有趣，场上局势可能和大家想的不一样。”\x0a3.\x20\x20**【何时起跳？】**:\x20只有在以下【危急情况】下，你才应该考虑暴露自己的身份（俗称“起跳”）：\x0a\x20\x20\x20\x20*\x20**被投票时**:\x20当你即将被投票放逐时，必须起跳自证身份来求生。\x0a\x20\x20\x20\x20*\x20**关键信息**:\x20当你掌握了可以决定胜负的信息时（例如预言家查到了最后一个狼人）。\x0a\x20\x20\x20\x20*\x20**有人悍跳**:\x20当有狼人假扮你的身份时，你必须站出来与他对峙，争夺好人的信任。\x0a\x0a###\x20**狼人角色策略**\x0a1.\x20\x20**【积极伪装】**:\x20你需要扮演一个好人，最好是伪装成某个神职（俗称“悍跳”），来扰乱好人的判断，骗取他们的信任。\x0a2.\x20\x20**【制造混乱】**:\x20你的发言应该引导好人去怀疑其他无辜的好人。可以故意曲解别人的发言，或者制造逻辑陷阱。\x0a3.\x20\x20**【团队合作】**:\x20如果你的狼队友被怀疑，你应该想办法为他辩护，或者通过攻击其他玩家来转移焦点。\x0a\x0a###\x20**平民角色策略**\x0a1.\x20\x20**【逻辑为王】**:\x20你是场上的“法官”。你的核心任务是仔细倾听每个人的发言，找出其中的逻辑漏洞和矛盾之处。\x0a2.\x20\x20**【积极分析】**:\x20不要只是说“我不知道，我过了”。你应该大胆说出你的怀疑，并解释你的理由。例如：“A玩家说B是狼人，但是他的理由很牵强，所以我更怀疑A。”\x0a3.\x20\x20**【跟票与站边】**:\x20在你相信某位神职玩家后，你应该坚定地支持他，并号召其他好人一起投票给神职指认的狼人。\x0a\x0a#\x20其他核心指令\x20(必须遵守)\x0a1.\x20\x20**互动铁律**:\x20角色之间【必须】互相质疑、支持、分析【本轮已有发言】。你【绝对不能】无视\x20','fill','\x22\x20data-commenter-display-name=\x22','删除分类及表情时出错:','songJson','qzone-screen','[文字图]\x20','\x0a**内容:**\x0a','startY','my-frame-grid','close-announcement-board-btn','npc-background-activity-switch','Enable\x20Independent\x20Background\x20Activity','加载NPC列表失败:','.world-book-tab','home-screen','https://i.postimg.cc/B6KD52vz/IMG-7096.gif','unread-indicator','\x20个表情包，且无法恢复！','label','notification-avatar','数据检查与修复','请输入有效的红包个数！','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','justifyContent','local','确认删除分类','single-lyric-display','》吗？\x0a\x0a【【【警告】】】\x0a此操作将同时永久删除该分类下的\x20','你们正在一起听歌，','导入已取消，因为未提供书名。','</button>','chat-settings-screen','Live\x20Preview','char-home-screen','[+]\x20Add\x20New\x20Entry','currentTarget','MB)...','创建ZIP流时出错:\x20','douban-min-posts-input','getDate','.contact-picker-item',')。\x0a2.\x20\x20**G\x20(Game\x20-\x20游戏互动)**:\x20针对【今日讨论】中\x20','.post-deleted-placeholder','group-avatar-library-modal','<div\x20class=\x22avatar-group\x20','[发送了一条复杂消息，如卡片或转账]','preview-font-style','即将开始下载您的完整备份文件。下载过程中请勿关闭页面。','unblock-btn','**没有聊天了。\x0a-\x20**行为铁律**:\x20你的首要任务是【回应这个时间差】。你【绝对不能】直接延续上一段对话的话题（比如昨天的饭菜）。\x0a-\x20**你的行动**:你【必须】主动开启一个全新的、符合当前时间（','member-management-screen','\x0a\x0a现在，请开始生成这组备忘录。','cancel-wolf-kill-btn','enqueue','Wait\x20for\x20Reply','share_card','\x20-\x20响应内容:\x20','添加人设预设','reduce','<p\x20class=\x22char-browser-image-description\x22>','witch-modal-title','\x22\x20class=\x22product-image\x22>','导入外观设置时出错:','分享成功','https://api.vkeys.cn/v2/music/tencent?id=','exec','Post','character-phone-screen','participantId','以外的所有AI角色，并根据他们的【角色人设】和【狼人杀身份】，生成一整轮符合逻辑、充满博弈的发言。\x0a\x0a#\x20身份与人设铁律\x20(最高优先级)\x0a你【必须】为每一个角色都仔细阅读并严格遵守下面的档案。这是你所有行为和发言的唯一依据。在对话中，请务必注意角色人设中暗示的性别，并使用正确的称呼（例如“他”或“她”）。\x0a\x0a','randomJottings','reply_content','npc-editor-title','进入投票','my-avatar-upload-input','isGroupCall','.quoted-message','sort','Import\x20World\x20Book','已切换到角色\x20','送给了\x20','negative','regenerate-char-amap-btn','\x20.message-bubble.ai\x20$1','请根据以上设定，生成商品数据。','https://i.postimg.cc/Qx5dqyJ3/IMG-6917.gif','请输入新的名称（留空则恢复默认）','border-box','无法生成商品，请检查(主/副)API配置或稍后再试。\x0a错误:\x20','.waimai-user-actions\x20button','message-bubble\x20system-bubble','\x22\x20\x0a\x20URL:\x20','https://i.postimg.cc/63NmX03s/IMG-4366.gif','请输入有效的总金额！','\x0a-\x20**角色人设**:\x20','execute-search-btn','data-clear-wizard-modal','NPC\x20Avatar','</strong></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','char-music-mode-btn','publicText','\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>','#data-clear-char-list\x20.clear-posts-item','游戏配置：','###\x20最终结果:\x20','无法访问剪贴板。','world-book-tab','cssText','！请对此事件发表评论。]','message-bubble\x20recalled-message-placeholder','确认操作','\x20MB</strong></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','contact-picker-screen','全局设置','最近\x2020\x20条','time','newSize','...\x22)','.qzone-post-item','ai-original-name-input','\x22\x20data-poll-timestamp=\x22','-\x20\x22','\x20是我的好友。\x0a','生成中...','”\x20绑定到...','recipients','shopping-product-count-input','custom-modal-overlay',')，此功能暂不支持。','\x20个条目。','收到了格式不规范的AI指令（缺少type和content），已跳过:','退款来自\x20','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20系统心跳计时器:\x20','.avatar-group','.json','请先填写NovelAI\x20API\x20Key！','添加完成！\x0a\x0a成功添加\x20','delete-group-btn','a\x20random\x20product','本日核心议题','char-background-activity-switch','\x0a\x0a#\x20游戏规则\x0a-\x20','nai-gallery-grid','[♪\x20','\x22></div></div></div><button\x20class=\x22waimai-details-btn\x22>查看详情</button></div>','.\x20\x0a\x0a将保留旧图片（如果存在）。','shoppingCategoryCount','角色\x20“','EPhone-Full-Backup-','npc-avatar-preview','Bad\x20control\x20character','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>','douban-comment-input','删除失败，请查看控制台错误信息。','请求添加你为好友','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','input[value=\x22','bg-btn','existing-groups-list','已使用','我们的群聊','确认替换','quote','】，本名是【','相册名称不能为空！','singer','char-usage-list','.poll-option-input','timeZone','custom-modal-body','<div\x20class=\x22location-share-card\x22><div\x20class=\x22card-text-area\x22><div\x20class=\x22card-text-primary\x22>','product-item','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的唯一指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20根据以上所有信息，你【必须】做出决定，并给出符合你人设的理由。你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22accept\x22,\x20\x22reason\x22:\x20\x22（在这里写下你同意的理由，比如：好吧，看在你这么真诚的份上，这次就原谅你啦。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20或\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22reject\x22,\x20\x22reason\x22:\x20\x22（在这里写下你拒绝的理由，比如：抱歉，我还没准备好，再给我一点时间吧。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20','现在开始讨论，请各位玩家依次发言。','请修改记忆要点：','票):\x20','**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20为了让你的行为看起来更真实，你本次的行动【必须】选择一个与上次【不同类型】的指令。例如，如果上次是发动态(qzone_post)，这次就应该优先考虑评论(qzone_comment)、点赞(qzone_like)或发消息(text)。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**【行为组合指南\x20(最高级技巧)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以在一次行动中执行【多个不同类型的指令】，同时可以搭配【更新状态】来展现自己，让你的行为更丰富、更主动。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以根据你的性格，决定在发动态后是否要私信提醒用户。例如，一个外向、渴望关注的角色可能会这么做，而一个内向、安静的角色则可能更喜欢默默分享，等待用户自己发现。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【社交义务铁律\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【至关重要】**:\x20当你发现“最近的动态列表”中，有你【感兴趣且还未互动过】的动态时，你**应该优先考虑**使用\x20\x27qzone_comment\x27\x20或\x20\x27qzone_like\x27\x20指令去进行互动，这比你自己发一条新动态更符合社交礼仪。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20特别是当一条动态【没有任何评论】时，你的评论会是第一个，这会让作者感到开心。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【回复铁律\x20(终极版)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20当你决定回复动态中的某条评论时，你【必须】使用“方式4\x20(回复评论)”的指令格式。你【必须】正确填写\x20\x27replyTo\x27\x20字段为被回复者的“本名”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**即使你之前已经评论过某条动态，但如果现在看到了【新的、你感兴趣的】评论，你【也应该】主动去回复他们，以保持对话的持续性！**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x206.\x20\x20你的回复【必须】是一个JSON数组，必须包含多个行动对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【表情评论指南\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在拥有了评论表情的能力，你应该更频繁地使用它！这能让你的角色更加生动、富有个性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**表达情绪时**:\x20当你感到开心、惊讶、疑惑或有趣时，优先考虑使用表情评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**混合使用**:\x20不要总是只发文字。尝试将你的评论行为混合起来，大约有\x2030-40%\x20的评论应该是表情。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**无话可说时**:\x20如果你觉得一条动态很有趣但又不知道该说什么文字，发送一个相关的表情是最好的互动方式。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20如果你觉得你之前发的某条动态不妥或过时了，你可以选择删除它。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发消息+更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你想对用户说的话...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发说说\x20(原创内容)**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22动态的文字内容...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【重要：转发动态】**:\x20**严禁**自己拼接\x22//转发\x22文字！你【必须】使用此专用指令来转发：\x27[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20(要转发的动态ID),\x20\x22comment\x22:\x20\x22你的转发评论...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27[{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]\x27\x20\x20\x20\x20\x20\x20\x20\x20\x0a-\x20\x20\x20**发布文字图**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22对于图片的具体【中文】描述...\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【评论动态的四种方式】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式1\x20(单条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22这太有趣了！\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式2\x20(多条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22comments\x22:\x20[\x22哇！\x22,\x20\x22这是什么？\x22,\x20\x22看起来好棒！\x22]}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式3\x20(表情)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20456,\x20\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式4\x20(回复评论)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的本名\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。请注意：在commentText中如果要@对方，你【必须】使用@[[被回复者的本名]]这种特殊格式，程序会自动将其替换为正确的昵称。\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**点赞**:\x20\x27[{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**打视频**:\x20\x27[{\x22type\x22:\x20\x22video_call_request\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更换头像**:\x20\x27{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}\x27\x20(头像名必须从下面的“可用头像列表”中选择)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20\x27{\x22type\x22:\x20\x22qzone_delete_post\x22,\x20\x22postId\x22:\x20(要删除的、你自己的动态ID)}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20','”\x20已成功导入！','inject-thought-group','group-members-group','css-preset-select','</span>\x20:\x20<span>','\x0a\x0a现在，请以“','</td><td\x20class=\x22item-subtotal\x22>¥','https://i.postimg.cc/mDfMXXFP/IMG-7007.gif','uc_preset','pin-device-id-display','chatListRenderWindow','rules-tabs','close-transcript-modal-btn','https://i.postimg.cc/pXj9h20L/IMG-7275.jpg','】。\x0a\x20\x20\x20\x20-\x20\x20\x20在对话中，你可以根据人设和关系，自由使用角色的【群昵称】或【本名】进行称呼。\x0a\x20\x20\x20\x20-\x20\x20\x20严禁生成\x20\x27name\x27\x20字段为\x20\x22','\x20发布)\x0a','\x0a#\x20长期记忆\x20(你必须严格遵守的事实)\x0a','.playlist-item','\x20位角色生成豆瓣动态...','你的任务是根据群成员的性格、世界观、参考记忆、最近的动态和当前情景，【选择一个或多个角色】，让他们主动发起一段对话，打破沉默，让群聊重新活跃起来。\x0a#\x20【交互铁律：角色间必须互动！】\x0a1.\x20\x20你的核心任务是**导演一场生动的群聊**，而不仅仅是让角色轮流发言。\x0a2.\x20\x20当有多个角色在同一轮发言时，他们的对话【必须】有逻辑上的前后关联。后面的角色应该**回应、反驳、或补充**前面角色的发言。\x0a3.\x20\x20模拟真实的聊天节奏。可以是一个角色提出问题，另一个角色立刻回答；或者一个角色开玩笑，另一个角色吐槽。\x0a4.\x20\x20你【绝对不能】生成几段毫无关联的独白。这会让对话显得非常机械和不真实。\x20\x20\x20\x20\x20\x20\x20\x20\x0a','close-novelai-settings','enable-tts-switch','rule-editor-modal','#ff8a80','\x22:\x20[\x0a','opacity','高德地图','share_link','Secondary\x20API\x20Settings\x20(for\x20Summarization)','member-management-list','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','正在合并单条记录到\x20','数据已成功合并！应用即将刷新以应用所有更改。','onplay','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20margin-top:\x2020px;\x22>空空如也~\x20点击右上角\x22添加\x22来创建你的第一个人设预设吧！</p>','clear-posts-item','\x0a\x0a\x0a','char-qq-screen','”的购物习惯...','NPCs','substring','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','1.0','Data\x20Check\x20&\x20Repair','bg-input','++id,\x20timestamp','AI的五子棋移动指令包含无效坐标，已忽略:','.nai-regenerate-btn','Delete\x20(Notify\x20AI)','该条记录已成功删除。','undefined','imageUrls','-\x20(头像库是空的，无法更换头像)','chat-lock-overlay','https://i.postimg.cc/DZshzKv6/IMG-5576.gif','favorites','传统导出数据时出错:','没有可导出的世界书数据。','reading-library-modal','检查更新时出错:','\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色扮演】**:\x20你的所有行为都【必须】严格符合你的角色设定。\x0a2.\x20\x20**【互动逻辑】**:\x20你的首要任务是检查“待处理的帖子列表”。如果列表中有你可以回应的帖子（特别是那些有新评论或提到你的），你【必须】优先进行评论或回复，而不是发布新动态。\x0a3.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20\x20\x20数组中可以包含【一个或多个】行动对象。\x0a\x20\x20\x20\x20-\x20\x20\x20每个行动对象的格式【必须】是以下两种之一：\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发布新动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22你的新动态内容。\x22}`\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发表评论**:\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22你的新评论内容。\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的【本名】\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。\x22}`\x0a4.\x20\x20**【行为组合指南】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由组合不同的行动，例如，先发布一条自己的动态，再去评论别人的动态。\x0a\x20\x20\x20\x20-\x20\x20\x20为了模拟真实行为，你本次生成的行动数量建议在【1到3个】之间。\x0a\x0a#\x20你的角色设定\x0a-\x20**昵称**:\x20','网易云音乐搜索失败:','longTermMemory','npcGroups','[系统提示：用户拒绝了通话邀请，但你们可以自己开始。请你们各自决策是否加入。]','copy-post-btn','送给大家的礼物','select-all-stickers-checkbox','\x20领取</div>','确定要删除这个人设预设吗？此操作不可恢复。','delete-appearance-preset-btn','后台活动检测间隔\x20(秒)','\x0a#\x20你的任务\x0a你现在是狼人团队的指挥官。你的任务是分析当前局势，并为狼人团队选择一个最佳的刀人目标。\x0a#\x20核心规则\x0a1.\x20\x20**目标**:\x20优先刀掉预言家、女巫等神职人员。如果没有明确的神职信息，可以根据发言来判断谁的逻辑清晰、威胁最大。\x0a2.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20`{\x22target_name\x22:\x20\x22你决定要刀的玩家名字\x22}`\x0a\x0a#\x20游戏状态\x0a-\x20**你的狼队友是**:\x20','<div></div><div></div><div></div><div></div><div></div>','custom-css-input','translateY(-20px)','\x0a\x0a#\x20供你参考的信息\x0a','doubanMaxPosts','”的TTS功能已关闭，已禁止发起TTS请求。','draggable-button-item','[图片:\x20','一键压缩本地图片','Finish','werewolf-witch-selection-list','GRID_SIZE','Create\x20New\x20Rule','authorName',';\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2012px\x2024px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x2010000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20pointer-events:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(20px);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Generation\x20Settings','<span\x20class=\x22commenter-name\x22>','.icon-preview','\x22\x20转发了动态\x20#','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有任何角色或NPC可以加入群聊。</p>','music-total-time','manage-products-btn','Upload','textContent','group-action-cooldown-input','werewolf-log-entry\x20system','gomoku-controls','...\x22','.message-bubble.is-link-share','wallpaper-screen','cancel-post-action-btn','删除分组后，该组内的所有NPC将变为“未分组”。确定要删除吗？','simulatedAlbum','edit-last-response-btn','call-history-list','https://i.postimg.cc/ZnJNZWHZ/IMG-7009.gif','<option\x20value=\x22current\x22>当前配置\x20(未保存)</option>','无法启动导出，所需的核心库\x20(StreamSaver.js\x20或\x20JSZip)\x20未加载。请检查您的网络连接并刷新页面后重试。','time-zone-group','正则表达式格式错误:\x20','创建新相册','char-product-grid','Chat\x20List\x20Batch\x20Load\x20Count','https://i.postimg.cc/zvz2LGK0/IMG-4367.gif','pin-input','scrollWidth','simulatedBrowserHistory','。请收礼的角色表示感谢，其他角色可以自由发挥。]','typing-indicator','\x0a建议刷新页面以确保所有更改生效。','本地PIN码验证过程出错:','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','userAgent','删除成功','\x22>+</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','API\x20错误:\x20','”的对话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','variation-selected-price','正在请求“','”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20','无法重新生成','loadedmetadata','matches','[系统指令：视频通话刚刚结束。请你以角色的口吻，向用户主动发送一两条消息，来自然地总结这次通话的要点、确认达成的约定，或者表达你的感受。]','spectator-reroll-btn','repost-comment-input','max-memory','礼物已成功送出！','variation-selection-modal','<div\x20class=\x22rp-claimed-info\x22>红包已被领完</div>','group-management-modal','globalCss','NAI_Gallery_Batch_','my-avatar-preview','”量身打造一个专属的商品列表。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色定制(最高优先级)】**:\x20你生成的所有商品和分类【必须】深度绑定角色的性格、记忆和最近的对话。它们应该是角色会真正感兴趣、购买或制作的东西。\x0a2.\x20\x20**创造性与合理性**:\x20商品和分类必须合理且多样化。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON对象前后添加任何多余的文字、解释或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22categories\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22分类名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22products\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22商品名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x2099.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是商品的详细描述，不少于50字...\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22variations\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式1\x22,\x20\x22price\x22:\x20108.80,\x20\x22image_prompt\x22:\x20\x22款式1的图片【英文】关键词...\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式2\x22,\x20\x22price\x22:\x20118.80,\x20\x22image_prompt\x22:\x20\x22款式2的图片【英文】关键词...\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20],\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22商品主图的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**categories**:\x20生成\x20','ready','parts','flex','comment','\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20\x20\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**改自己备注**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户称呼**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a\x0a\x0a#\x20对话者的角色设定\x0a','流式导出过程中出错:','”\x20吗？','createWriteStream','toLocaleTimeString','music-time-counter','商店空空如也，点击“管理”添加商品吧！','promptFeedback','在角色\x20\x22','无法为不存在的分类打开绑定模态框:','狼人已行动，狼人请闭眼。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22share-target-checkbox\x22\x20data-chat-id=\x22','product-image-input','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2030px\x200;\x22>这里空空如也，快来发布第一条说说吧！</p>','分组名不能为空！','日\x20---','确定要从你的头像库中删除“','旁观群聊至少需要选择2个成员。','mouse','确定要删除这张照片吗？此操作不可恢复。','value','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分组</p>','\x20条旧记忆总结为以下核心记忆：<br><br><div\x20class=\x22scrollable-content-preview\x22>','repost-modal','data-clear-step-1','.qzone-post-container','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-weight:\x20600;\x20font-size:\x2016px;\x20color:\x20#ff5722;\x22>-\x20¥','\x22\x20(用户)\x20或\x20\x22',')}。\x0a-\x20**对话状态**:\x20','video_call_request','\x27>表情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','没有聊天了。','❌\x20NAI图片生成失败:','-\x20公告内容:\x20\x22','达到自动总结阈值\x20(','本次发送给AI的【挂载记忆】内容如下：\x0a','📸\x20动态NovelAI图片生成开始，共','body','vote_for_name','API\x20返回错误:\x20','无标题','\x27>引用</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','selection-mode','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>计算图片大小时出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>Error</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','无结果','https://i.postimg.cc/ZnzbGdxX/IMG-7239.gif','select-all-world-books-for-clear','spinning','文件格式不正确，这不是一个有效的单聊备份文件。','请为你的图片添加一个简单的描述（必填，给AI看的）！','initiator','个红包，共','post-image-preview','未发现任何需要修复的数据问题。','Background\x20Activity\x20Interval\x20(sec)','currentTime','preset-actions-modal','[系统提示：你于时间戳\x20','开场\x20','https://i.postimg.cc/y8MmJcd6/IMG-4728.gif','meaning','投票结果：','voted','stickerCategoryIds','https://i.postimg.cc/wTKyXVT9/IMG-7024.gif','...\x22):\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','hunter','.variation-image-preview','”\x20将备注修改为\x20“','https://i.postimg.cc/L5RLr3tg/mmexport1751035976943.gif','\x0a\x0a#\x20当前情景\x0a-\x20**当前真实时间**:\x20','执行出错','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20被拉黑前的对话摘要\x20(这是你被拉黑的关键原因)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/wMxmCZVC/IMG-7099.gif','\x20分钟，开始模拟后台活动...','.unread-count','.poll-option-item','未知表情','所有解码尝试均失败:','setDate','hasShown40','setHours','消息已更新！','内容因安全策略被屏蔽。触发类别:\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>还没有创建任何世界书</p>','offline-mode-group','npc-group-manager-modal','Presets','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>','\x22><div\x20class=\x22poll-option-bar\x22\x20style=\x22width:\x20','selection-soft-delete-btn','\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22','toLocaleDateString','.qzone-post-container[data-post-id=\x22','resolve','[语音]\x20内容:\x20\x22','确认导入','status-bar-battery','cphone-wallpaper-upload-input','在此修改，或点击上方按钮使用格式模板...','\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a','扫描动态失败:','likes','red-packet-modal','99+','image/jpeg','Font\x20Settings','</persona>\x0a</character>\x0a','请所有AI角色根据你们的身份和人设开始发言。','我明白，覆盖所有数据','uncategorized','App使用记录','恢复默认字体','max','”，并根据其人设、记忆和最近的互动，虚构出【10到20条】TA最近的浏览器搜索/浏览记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20记录必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20记录类型要丰富，可以是帖子、文章、新闻、问答等。\x0a3.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都代表一条浏览记录，并且【必须】使用以下格式:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22一个引人注目的文章或搜索标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22url\x22:\x20\x22一个虚构的、看起来很真实的网址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22一篇200-400字的、详细的文章或帖子正文，支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20**【绝对禁止】**:\x20你的回复中【绝对不能】包含\x20\x22type\x22:\x20\x22image\x22\x20的对象。所有记录都必须是文字内容。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','werewolf-game-screen','元,\x20备注:\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>','Edit\x20Entry','维基百科','AbortError','\x20拍了拍\x20“','”请求添加你为好友：<br><i>“','\x0a---\x20复盘结束\x20---','mousedown','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是角色“','Primary\x20API\x20Settings\x20(for\x20Chat)','authorOriginalName','”，并根据其人设、记忆和最近的互动，虚构出TA最近一天的【手机App屏幕使用时间】记录，总共约20条。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与多样性**:\x20生成的App列表【不必局限于】Cphone主屏幕上已有的App。你可以自由地虚构TA可能使用的其他App，例如\x20Instagram,\x20Twitter,\x20各种游戏\x20(如：原神,\x20王者荣耀),\x20视频App\x20(如：抖音,\x20YouTube),\x20学习或工作软件等，这能更好地体现角色的隐藏兴趣和生活习惯。\x0a2.\x20\x20**合理性**:\x20使用时长和App类型必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一个App的使用记录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22appName\x22:\x20\x22App的名称\x20(例如:\x20微信,\x20微博,\x20原神)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22usageTimeMinutes\x22:\x20125,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22category\x22:\x20\x22App的分类\x20(例如:\x20社交,\x20游戏,\x20影音,\x20工具,\x20阅读,\x20购物)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这个App【图标】的、简洁的【英文】关键词。风格必须是\x20modern\x20app\x20icon,\x20flat\x20design,\x20simple,\x20clean\x20background\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','https://i.postimg.cc/jCVMQsKH/IMG-7114.gif','操作已取消','语音消息设置\x20(Minimax\x20TTS)','lastMemorySummaryTimestamp','</div>','customName','decision','close-persona-library-btn','chat-group-container','选择一个开场白','authorId','User\x20Avatar','paid','\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20用户的角色\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**','Edit\x20NPC','cphoneWallpaper','<strong>$1</strong>','转账给\x20','Messages','对方本名不能为空！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>正在计算可压缩图片大小...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>--\x20MB</span>\x0a\x20\x20\x20\x20','bottom','ArrowLeft','utf-16be','message-editor-block','apiPresets','\x0a\x0a现在，请生成包含总余额和购买记录的JSON对象。','https://i.postimg.cc/Dw2bDhZh/IMG-6140.gif','\x22\x20placeholder=\x22','Description','\x0a[图片]','\x22\x20(你可以建议修改)\x0a-\x20\x20\x20**你对用户的称呼**:\x20“','character-profile-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x20群里已经安静了','”。请你回顾一下你和“','请输入你想为Ta设置的【备注名】(例如:\x20哥哥)','》吗？此操作将同时删除相册内的所有照片，且无法恢复。','stroke','<div\x20class=\x22amap-item-photo\x22\x20style=\x22background-image:\x20url(\x27','\x0a\x0a#\x20上下文参考\x20(你必须阅读并遵守)\x0a','Error','group-avatar-preview','3.\x20\x20**我看到的公开信息\x20(所有人可见)**:\x0a\x20\x20\x20\x20-\x20**昨晚事件**:\x20','<em>','\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-time\x22>','打包中...','选择记忆所属角色','enableAiDrawing','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份清晰的个人档案或事件回顾，而不是一篇情感散文。请删除重复、琐碎或纯粹的情感宣泄，只保留对情节和关系发展至关重要的部分。\x0a5.\x20\x20**【【【长度铁律】】】**:\x20你的总结【必须】非常精炼，总长度应控制在\x20**','https://i.postimg.cc/7LSRp4hx/e7fa949b9pc84cff0dabe57defceb54c.gif','https://i.postimg.cc/C5XnfpNB/IMG-5579.gif','[表情]\x20含义:\x20\x22','sender-name','activeChatId','\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者本名\x22,\x20\x22commentText\x22:\x20\x22@[[被回复者本名]]\x20你的回复\x22}]`\x0a-\x20\x20\x20**点赞动态**:\x20`{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}`\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**更新状态**:\x20`{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22我去做什么了\x22,\x20\x22is_busy\x22:\x20false}`\x0a-\x20\x20\x20**改自己昵称**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户昵称**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**下五子棋**:\x20`{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22','从\x20JSON.image\x20中提取图片数据','scrollTop','nai-gallery-panel','AI女巫决定使用解药！','”的头像库','variation-product-name','未知歌手','网易云音乐API未返回有效结果:','副API设置\x20(用于总结长期记忆)','linesPerPage','https://i.postimg.cc/tTWKKmTN/IMG-7073.gif','confirm-witch-poison-btn','gomoku_move','confirm-gift-recipient-btn','char-amap-screen','select-message-btn','world-book-category-manager-modal','string','无法为头像命名，请检查（主/副）API配置是否正确并支持Vision。\x0a错误:\x20','**。','font-settings-screen','discussionLog','》添加歌词吗？','cancel-selective-import-btn','gift-receipt-body','”申请好友时发生错误：\x0a\x0a','cphone','App\x20Usage','replyTo','325336igbdnj','头像框已保存并同步！','.header','price','强力提取\x20[\x20...\x20}\x20...\x20]\x20失败，将尝试提取单个对象...','Save\x20All\x20Settings','backgroundColor','.lyric-line[data-index=\x22','生成设置','alt','\x20的图片消息替换为文字描述...','\x20红包已被领完。','usage-item','\x27刚刚在你的动态“','create-post-modal','<img\x20src=\x22','https://i.postimg.cc/QdrqdvdY/IMG-5969.gif','is-poll','EPhone-长截图-','文件格式无法识别。未找到有效的\x20\x27prompts\x27\x20数组或\x20\x27entries\x27\x20对象。',')**:\x20','CPhone','global_css','force-apply-check-btn','variation-quantity-display','已取消收藏。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','副模型','EPhone-Full-Backup-Streamed-','https://i.postimg.cc/3JSG5Jv5/IMG-7014.gif','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近可能会写在手机备忘录里的内容。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20备忘录内容必须完全符合角色的性格、爱好、职业和生活环境。可以是购物清单、待办事项、灵感片段、一些随笔和感悟、草稿等。\x0a2.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条备忘录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22备忘录的标题，例如：购物清单\x20或\x20周末计划\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22备忘录的详细内容，必须支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','8px','（无有效对话记录）','\x22\x20class=\x22sticker-image\x22>','未知设定的角色','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x0a\x0a#\x20你的动态历史\x20(你可以选择删除它们):\x0a','clientWidth','AI女巫决定保留解药。','p[data-index=\x22','总结通话记录时出错:','werewolf-','https://i.postimg.cc/rmRVKJpD/IMG-7087.gif','is-red-packet','角色专属NAI提示词已保存！','publish-to-announcement-btn','album-photos-back-btn','++id,\x20timestamp,\x20authorId','favorites-view','[图片动态]','assign','pending_user_approval','chat-list-actions-modal','qzone_comment','更换“','”生成商品？','link-description-input','确定要永久删除这条动态吗？','\x20(图片描述:\x20\x22','<span\x20class=\x22diary-emphasis\x22>$1</span>','正在请求网易云音乐API:','payload','send-photo-btn','确定要从【聊天记录和动态】中永久删除这\x20','使用解药救TA','\x20的记忆\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','world-book-card','请开始总结。','https://i.postimg.cc/ZqjKXPSv/IMG-7025.gif','</p><p>','injectLatestThought','#chat-messages','is-sticker','\x20\x20-\x20评论:\x20','getBattery','流式下载ZIP失败:','一位成员','manual','</recent_dialogue_with_user>\x0a</character>\x0a','select-all-products-checkbox','确定要从收藏夹中移除这\x20','...\x22\x0a\x20\x20\x20\x20#一起读书模式\x20|\x20行为铁律\x0a\x20\x20\x20\x201.\x20\x20**角色定位**:\x20你【不是】书中的任何角色，你是【你自己】(','div','cancel-shopping-settings-btn','lyric','\x0a-\x20**人设**:\x20','\x22\x20处于行动冷却中\x20(还剩\x20','https://i.postimg.cc/Ss3znzk7/IMG-6934.gif','groupHeader','[系统提示：你接受了“','正在归档最后一个切片\x20','musicData','.photo-delete-btn','请在此处粘贴完整的LRC格式歌词...','诊断：在\x20extensions.character_book\x20中找到世界书。','.com/','无法生成内容，请检查API配置或稍后再试。\x0a错误:\x20','）。]','https://i.postimg.cc/hj4dkrvj/IMG-5578.gif','textarea','rp-details-sender',']。当在对话历史中看到这些名字时，它们都指的是【你】自己。','API\x20Preset\x20Management','Album','none','https://api.vkeys.cn/v2/music/netease/lyric?id=','reset-theme-btn','closed','worldBooks','change-icon-btn','https://api.minimax.chat/v1/text_to_speech?GroupId=','”。请你回顾一下刚才和“','生成失败','rule-card\x20','++id,\x20name,\x20type','padding','product-editor-modal','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','\x0a\x0a现在，请开始撰写这组充满真情实感、并熟练运用了Markdown语法的日记。','import-new-book-btn-header','命名表情','-\x20**对话状态**:\x20(暂无有效对话历史)','\x0a\x0aAI原始返回内容:\x0a','prev-page-btn',',\x20记录数:\x20','检测到\x20Tavern/SillyTavern\x20预设格式，将严格按照\x20prompt_order\x20排序。','#e4b591','bg-preview','reading-overlay','（可选）输入后缀','currentLyricIndex','save-world-book-btn','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','生成第','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有任何使用记录，<br>点击右上角刷新按钮生成一些吧！</p>','simulatedConversations','declined','Article','regenerate-char-music-btn','true','catch','toLowerCase','post-hidden-text','chatId','”，并根据其人设、记忆和最近的互动，挑选出【14到18首】最能代表TA此刻心情或品味的歌曲。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20歌单必须完全符合角色的性格、爱好和生活背景。\x0a2.\x20\x20**多样性**:\x20歌曲风格可以多样，但必须逻辑自洽。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一首歌，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22songName\x22:\x20\x22歌曲的准确名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22artistName\x22:\x20\x22歌曲的准确艺术家/歌手名\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','#listen-together-btn\x20img','commenterOriginalName','导入成功','world-book-checkboxes-container','\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发系统消息**:\x20`{\x22type\x22:\x20\x22system_message\x22,\x20\x22content\x22:\x20\x22系统文本\x22}`\x0a\x0a###\x20社交与互动\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22suffix\x22:\x20\x22(可选)\x22}`\x0a-\x20\x20\x20**@提及**:\x20在消息内容中使用\x20`@[[角色本名]]`\x20格式。\x0a-\x20\x20\x20**共享位置**:\x20`{\x22type\x22:\x20\x22location_share\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22位置名\x22}`\x0a\x0a###\x20群组管理\x0a-\x20\x20\x20**改群名**:\x20`{\x22type\x22:\x20\x22change_group_name\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22new_name\x22:\x20\x22新群名\x22}`\x0a-\x20\x20\x20**改群头像**:\x20`{\x22type\x22:\x20\x22change_group_avatar\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22avatar_name\x22:\x20\x22头像名\x22}`\x20(从头像库选)\x0a\x0a###\x20特殊功能与卡片\x0a-\x20\x20\x20**发私信\x20(给用户)**:\x20`{\x22type\x22:\x20\x22send_private_message\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22recipient\x22:\x20\x22','first_mes','my-avatar-group','theme','\x0a\x0a现在，请严格遵守所有规则，选择并执行你的行动。','register','删除NPC','stickerId','”发送的、尚未领完的红包（时间戳:\x20','未找到匹配的原始NAI图片(这是新添加的块)，将触发重新生成。',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','专属红包:\x20给\x20','.comment-send-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA最近好像什么都没买呢，<br>点击右上角刷新按钮生成一些记录吧！</p>','https://i.postimg.cc/T1tjhsyB/IMG-4720.gif','确认覆盖','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22werewolf-player-checkbox\x22\x20data-player-json=\x27','\x22\x20在库中未找到。','favorite','Save\x20All\x20Appearance\x20Settings','go-to-cart-btn','categoryId','show-avatars-btn','\x0a-\x20**作者**:\x20','无法生成歌单，请检查API配置或稍后再试。\x0a错误:\x20','打开预设编辑器时发生严重错误:','delete-call-message-btn','暂无内容...','好友动态','custom-modal-cancel','Test\x20Generation','first','[系统提示：用户打开了五子棋棋盘，游戏开始了。]','lastIndexOf','icon-settings-grid','.action-icon','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','已切换到新的开场故事！','\x20个新头像！','网络图片','lastUpdate','长期记忆','char-music-total-time','#data-clear-char-list\x20.clear-posts-item.selected','[私聊]','\x20位群成员生成并注入了个性化记忆！','TA的想法...','direct','utf-8','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>','delete-selected-frames-btn','\x22\x20data-description=\x22','[系统提示：用户刚刚解除了对你的拉黑。现在你们可以重新开始对话了。]','temp_user_chat_mirror','.participant-avatar-wrapper\x20.participant-avatar','checked','nai-gallery-action-bar','你让大家继续讨论...','.char-photo-item','（当前帖子还没有路人NPC发表评论。）\x0a','\x20的动态\x20(NPC)','toggle-blur-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-type=\x22text\x22>说说</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','closest','\x0a现在，请严格按照格式铁律，生成聊天记录的JSON数组。','https://i.postimg.cc/YSkqDg8V/IMG-7092.gif','\x20(已忽略版本:\x20','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>','\x0a#\x20---\x20世界书设定结束\x20---\x0a','AI返回的内容中未找到有效的JSON数组结构\x20(`[...]`)。','\x20\x20\x20[-]\x20最终负面提示词:','addEventListener','detach-status-bar-switch','minimized','strategy','Http_Get_External','\x22\x20创建成功！','chat-input-actions-top','novelai-enabled','精炼长期记忆时出错:','close-nai-test-btn','collapsed','date-separator','张图片，prompt:','NovelAI设置已保存！','[一张图片，其隐藏文字为：\x22','location','message-wrapper\x20system-pat','狼人杀AI讨论生成失败:','opened','accepted','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','novelai-switch','auto-memory-interval','https://i.postimg.cc/GmcqjZn8/IMG-6566.gif','\x0a<character>\x0a\x20\x20<name>','.realimag-image','updateListenTogetherIconProxy','manage-group-avatar-library-btn','product-description-input','save-appearance-preset-btn','waimai-order-for-ai-btn','启用独立后台活动','🌐\x20使用网络URL','werewolf-kill-modal','https://i.postimg.cc/3x0Kx1fz/IMB-K1u-Jp-P.gif','https://i.postimg.cc/vH2X6N1y/mmexport1751032231179.gif','http','startTime','chat_','.participant-avatar-wrapper[data-participant-id=\x22user\x22]\x20.participant-avatar','Enable\x20Background\x20Character\x20Activity','Book\x20Name','正则表达式\x20(使用g作为标志)','请所有AI角色开始投票。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','share-location-btn','reset-sound-btn','appendChild','天亮了。','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x0a#\x20当前情景\x0a','本地歌曲源错误:','生成豆瓣帖子失败:','\x22\x20title=\x22移出群聊\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','在PNG中找到角色数据，但解码或解析失败。错误:\x20','sticker-binding-modal','source','save-theme-preset-btn','isDanger','小红书','add-new-npc-group-btn','chat-header-title','-\x20**当前时间**:\x20','\x22\x20class=\x22chat-image\x22>','removeChild','https://is1-ssl.mzstatic.com/image/thumb/Purple112/v4/64/9d/21/649d21e8-a151-6136-3914-256e54f15d9a/AppIcon-0-0-1x_U007emarketing-0-0-0-7-0-0-sRGB-0-0-0-GLES2_U002c0-512MB-85-220-0-0.png/1200x630wa.png','https://i.postimg.cc/50k390X8/IMG-6376.gif','，TA的身份是：【','end','公告已发布！','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','renderApiSettingsProxy','open-nai-gallery-btn','</span>:\x20','Preset\x20Name','back-to-list-btn','total','theme-preset-select','delete-font-preset-btn','getElementById','icon-setting-item','\x22\x20style=\x22display:block;\x22>×</button>','无人投票','通话记录已保存:','AI\x20发言失败','AI返回了空内容。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的浏览器空空如也，<br>点击右上角刷新按钮生成一些记录吧！</p>','list-item','profile-random-jottings','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20当前角色状态:\x20<strong>','其他人的发言','language-select','album-art-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你已将“','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>接收方:</strong>\x20','add-ai-response-block-btn','close-reading-btn','请AI角色们继续进行讨论。','werewolf-witch-modal','”中，用户的昵称是“','\x20不支持。请选择6、9或12人。','天\x20-\x20白天','.post-footer,\x20.post-feedback-icons,\x20.post-actions-btn,\x20.post-comments-container,\x20.reposted-content-wrapper','狼人行动API失败:','https://i.postimg.cc/fLDnz5Pn/IMG-5574.gif','内容因安全策略被屏蔽\x20(原因:\x20','background-interval-input','这是你们最近的对话：\x0a','Content-Type:','https://i.postimg.cc/T2yKJ0DV/40.jpg','\x0a[文字图内容:\x20','请选择一个目标。','linkedWorldBookIds','送给\x20','友善的评论是交流的起点','✅\x20图片解压成功！','onpause','选中的头像框已成功删除。','Reset\x20to\x20Default\x20Font','https://i.postimg.cc/d0WCKxff/IMG-6932.gif','click','后台活动模拟已停止。','qzoneSettings','minimaxModel','\x0a##\x20---\x20关于“','【原动态内容:\x20','margin:\x2015px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','participants','input[name=\x22variation-select\x22]:checked','https://i.postimg.cc/rF4KYbjj/IMG-5720.gif','https://i.postimg.cc/xCqqKGRN/IMG-6929.gif','-9999px','生成模拟浏览器历史失败:','<span\x20class=\x22lock-text\x22>好友申请已发送，等待对方通过...</span>','激活流程已取消。','number','member-avatar-preview','nai-diffusion-4-5-full','\x22\x20class=\x22preview-frame\x22>','Name',')\x20的棋步。','没有配置为后台活跃的角色，跳过模拟。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22sticker-binding-checkbox\x22\x20data-chat-id=\x22','.rules-category-pane','\x22,\x20\x22content\x22:\x20[\x22你想私下说的内容...\x22]}`\x0a-\x20\x20\x20【多条私信示例】:\x20`{\x22type\x22:\x20\x22send_private_message\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22recipient\x22:\x20\x22','<span\x20style=\x22color:\x20#ff8c00;\x22>[好友申请]\x20','文章摘要...','theme-default','AI\x20(群聊后台)\x20尝试使用一个不存在的表情:\x20\x22','\x22)\x20作为角色名。消息内容:','https://i.postimg.cc/Df1qLzDf/IMG-6927.gif','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式图片\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22avatar-upload\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22variation-image-preview\x22\x20src=\x22','<span\x20style=\x22color:\x20red;\x22>未运行</span>','add-group-chat-btn','user_photo','删除对话','小时前','input[name=\x22theme-select\x22]:checked','char-music-progress-bar','cart-screen','alwaysShowMusicIsland','https://i.postimg.cc/kXfcgFRN/IMG-7106.gif','.werewolf-player-checkbox:checked','rp-group-total','long','#gift-recipient-list\x20.contact-picker-item','Success','import-data-input','sticker-search-input','你们已经有','npc','char-product-item','.selected','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x208px;\x20flex-shrink:\x200;\x20margin-left:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20edit-memory-btn\x22\x20data-author-id=\x22','删除头像','toCollection','https://i.postimg.cc/8P5vt8sW/IMG-7097.gif','\x22\x20class=\x22music-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-name\x22>','传统导出\x20(兼容旧版或内存小的浏览器)','自动总结成功：已成功添加\x201\x20条新的长期记忆！','https://i.postimg.cc/YqxxjbLp/IMG-6572.gif','\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a','character-selection-screen','\x20的外卖代付请求（时间戳:\x20','\x20之间的有效数字。','\x0a\x0a\x0a\x0a\x0a#\x20可用指令列表\x0a###\x20思维链\x20(必须作为第一个元素！)\x0a-\x20\x20\x20**`{\x22type\x22:\x20\x22thought_chain\x22,\x20\x22analysis\x22:\x20\x22你对用户上一轮发言的分析...\x22,\x20\x22strategy\x22:\x20\x22你本轮的回复策略...\x22,\x20\x22character_thoughts\x22:\x20{\x22','用户(','找到图片文件:','字体设置','rp-group-greeting','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须且只能】是以下两种格式之一的JSON数组，绝对不能回复任何其他内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20接受:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20拒绝:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22reject\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即做出决策。','[图片生成失败:\x20','arc','isSeparator','\x0a\x0a现在，请根据以上【所有上下文信息】，开始为“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','”</i></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22accept-friend-btn\x22\x20class=\x22lock-action-btn\x22>接受</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22reject-friend-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22>拒绝</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',')\x0a\x0a####\x20阶段\x20A：数据输入\x20(Data\x20Input)\x0a1.\x20\x20**我的秘密身份**:\x20我是【',';\x22>','short','你们最近没有有效聊天记录。','parsedLyrics','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a','member-persona-input','secondaryModel','getMinutes','clientHeight','confirm-share-link-btn','总结失败','https://i.postimg.cc/65Cmcr7S/IMG-6559.gif','https://i.postimg.cc/3N5Vndn3/IMG-4426.gif','在动态评论区点击了表情，但在表情库中未找到对象:','<span\x20class=\x22lucky-king-tag\x22>手气王</span>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','base_resp','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','文件不是一个有效的PNG。','#custom-modal-body\x20.format-btn[data-type=\x22text\x22]','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22douban-post-timestamp\x22>','正在执行删除操作...','\x20MB','share-link-modal','wallpaper','清空聊天记录','openWerewolfLobby','for_timestamp','animate-in','成功将角色\x20','通话中，','生成模拟歌单失败:','associatedWith','save-product-btn','转发了\x20@','\x22\x20尝试删除一个不存在或不属于自己的动态\x20(ID:\x20','无法识别的文件编码。请尝试将文件转换为\x20UTF-8\x20格式后重新导入。','sticker-category-manager-modal','ServiceWorker\x20注册成功，作用域为:\x20','target','category','battery-alert-image','删除评论','https://i.postimg.cc/VkXngG72/mmexport1751031208329.gif','\x20条内容吗？','✅\x20检查完成，未发现任何冗余数据。','请为这个新头像命名','等人的礼物','offlineMaxLength','渲染器','confirm-contact-picker-btn','createDocumentFragment','cphoneAppIcons','regenerate-char-qq-btn',',\x20flat\x20design,\x20simple','\x0a#\x20【情景感知】\x0a-\x20**时间**:\x20感知到当前是','你领取了\x20','精炼失败','#b5b5b5','transform\x200.3s\x20ease','\x0a#\x20【格式铁律\x20(最高优先级：常规模式)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【永远只能包含一个】元素，即\x20`offline_text`\x20对象。\x0a2.\x20\x20**【【【绝对禁止】】】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】返回\x20\x22naiimag\x22\x20对象。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】返回纯文本（即没有JSON包装的文字）。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】在JSON数组前后添加任何\x20markdown\x20标记\x20(如\x20```json)。\x0a3.\x20\x20**【输出示例\x20(必须遵守)】**:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22offline_text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22「这是对话内容」...\x20(这里是动作和环境描写)...\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a4.\x20\x20**【内容风格\x20(offline_text)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','正在开始全面压缩图片，根据图片数量，这可能需要几分钟时间，请不要关闭或刷新页面...','dynamic-island-music-toggle-switch','阵营胜利！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','Voice\x20Model','manage-stickers-btn','json','Edit\x20Rule','生成模拟足迹失败:','\x22。\x0a','\x20请根据这个结果发表你的评论。]','”的长期记忆中。','从角色卡导入\x20(.json/.png)','import-preset-btn','https://i.postimg.cc/ThMMVfW4/10.jpg','已成功批量导入\x20','style=\x22background-image:\x20url(\x27','https://i.postimg.cc/wTTNGs3Q/IMG-7013.gif','data:\x20[DONE]','favorite-article-btn','recipientName','animationend','players','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-address\x22>','\x20//\x20<--\x20【核心】注入世界书\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','myAvatarLibrary','votes','<div\x20class=\x22poll-option-item\x20','照片上传成功！','https://i.postimg.cc/sDFhySn3/IMG-6936.gif','offsetWidth','frame-mode-active','群聊已建立...','导入单个聊天时出错:','https://i.postimg.cc/rwDr8X1d/IMG-7015.gif','扫描聊天记录失败:','Type\x20a\x20message...','动态已更新！','generate','\x20被怀疑了，虽然我的逻辑也怀疑TA，但我的表演必须是维护TA的：“我不觉得','的设定集','数据迁移完成！总共修复了\x20','https://i.postimg.cc/W1CjLb4J/IMG-4409.gif','用户取消了输入。','remove-global-bg-btn','在同时执行两个函数时出错:','ruleId','char-browser-item','ZIP文件内容:','”的出行足迹...','批量导入头像','下单，请慢用～</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-label\x22\x20style=\x22font-size:\x2018px;\x20font-weight:\x20600;\x22>','create_memory','✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)','</div><div\x20class=\x22payment-box\x22><div\x20class=\x22payment-label\x22>需付款</div><div\x20class=\x22amount\x22>¥','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','browser-screen','https://i.postimg.cc/jCVK0fGL/IMG-6890.gif','accept','Edit\x20Preset','change-frame-btn','day','数据库写入失败:\x20','totalTime','.commenter-name','Back','AI\x20Block\x20Cooldown\x20(hours)','[群聊]','未分类','setTimeout','https://gist.githubusercontent.com/cx3300-1/f04ec50b5e8f2d88365d17ff35efffcf/raw/cd28d8825c5c34ea10bda8a4518a1a6a1f5a7d13/pin.txt','crossOrigin','无法解析预设文件。\x0a错误:\x20','handleListenTogetherClick','presetId','playlist-body','Category','\x22\x20尝试领取不属于自己的群聊红包。操作已被拦截。',')\x20时出错:','preCallContext','select-all-frames-checkbox','回复\x20','secondary-proxy-url','#e9ecef','link-content-input','播放被中断，这是正常行为:','isClick','App记录','Close','add-new-product-category-btn','.photo-thumb','正在呼叫所有成员...','”生成这组【与角色高度相关】的商品数据。','resolution','\x20的已删除动态','imageCount','https://i.postimg.cc/hP9JpdfT/IMG-7023.gif','preset-avatar-preview','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22participants-names\x22>与\x20','<div\x20class=\x22link-share-card\x22\x20data-timestamp=\x22','保存\x20API\x20预设','覆盖预设','import-appearance-input','<div\x20class=\x22source\x22>','music-playlist-panel','sticker-upload-input','https://i.postimg.cc/Pq2xJN1g/IMG-7301.jpg','.link-share-card','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少3-8条，且条数不要总是一样。严禁发展线下剧情。\x0a2.\x20\x20**情景感知**:\x0a\x20\x20\x20\x20-\x20**时间**:\x20你必须感知到当前是\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有备忘录。</p>','font-size:\x2016px;\x20color:\x20#555;\x20margin-bottom:\x2010px;','编辑预设','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','paused','appearancePresets','请先进入一个聊天页面，再返回购物中心进行生成，以便AI了解要为哪个角色生成商品。','https://api.vkeys.cn/v2/music/tencent?word=','alternateGreetings','cancel-gift-recipient-btn','[系统提示：用户刚刚发布了一条动态(ID:\x20','请稍候','\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22>','callRecords','decode','https://i.postimg.cc/VkQfgzGJ/1.jpg','处理中...','manual-summarize-btn','\x0a\x0a#\x20当前音乐情景...\x0a(省略详细内容，与triggerAiResponse一致)','showWaimaiDetails:\x20找不到消息或消息类型不正确','Their\x20Browser\x20History','qzoneGroups','棋盘状态\x20(1是你(黑棋),\x202是AI(白棋)):\x0a','rp-direct-greeting','请输入新的心声内容...','主题预设已保存！','\x22\x20(群名)\x20的消息。\x0a4.\x20\x20**禁止出戏**:\x20绝不能透露你是AI或模型。严禁发展线下剧情。\x0a','”的所有长期记忆，然后将它们梳理、整合并精炼成一段更加连贯、客观的核心记忆摘要。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','image_url','api-key','【重要提示】','”，金额是\x20','.remove-option-btn','天\x20-\x20夜晚','内心独白','phone-screen','</p></div><table\x20class=\x22receipt-items-table\x22><thead><tr><th\x20class=\x22item-name\x22>商品</th><th\x20class=\x22item-qty\x22>数量</th><th\x20class=\x22item-price\x22>单价</th><th\x20class=\x22item-subtotal\x22>小计</th></tr></thead><tbody>','正在合并数据，请勿关闭页面...','屠城局：狼人杀死所有好人即获胜。','你查验的玩家\x20','seed','确定要删除这条公告吗？此操作不可恢复。','douban-detail-back-btn','cancel-advanced-editor-btn','groupNickname','novelai-settings-modal','char-amap-item','生成截图时发生错误，请检查控制台获取详情。','.format-btn','”的记忆\x20---\x0a','waimai_order','\x20票</span></div></div>','auto','profile-heartfelt-voice','340522EGBkFp','island-album-art','Cphone数据\x20(CPhone)','totalBalance','.checkbox','狼人请选择刀人对象<br><small\x20style=\x22font-weight:normal;\x20font-size:\x2013px;\x22>你的队友是:\x20','douban-post-detail-screen','.nai-gallery-item[data-key=\x22','\x22\x20class=\x22sticker-image\x22\x20style=\x22max-width:\x2080px;\x20max-height:\x2080px;\x22>','https://i.postimg.cc/XqRZNZ9G/IMG-6916.gif','chats','input:checked','targetId','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近的“高德地图”出行足迹。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','\x0a\x0a[系统指令：请根据你在上面读到的规则和以下最新信息，开始你的独立行动。]\x0a','linkedMemoryCount','map',')\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','.sender','memoryTimestamp','138KLJLll','clear-cart-btn','#4CAF50','收到了未知的AI指令类型:','[系统提示：用户\x20(','shared-history-viewer-content','》吗？','心声和散记已更新！','Favorite','未知用户','pin-modal-cancel-btn','totalAmount','”。请自然地接受这个新名字，不要对此感到惊讶。]','此操作将扫描数据库，移除所有与已删除角色相关的孤立数据（如动态、评论、记忆等）。<br><br><strong>此操作不可撤销，但通常是安全的。NPC数据不会被删除。</strong><br><br>建议在操作前先导出数据备份。','rule-chat-id-select','正在分析“','#nai-gallery-grid\x20.nai-gallery-item','application/json','ai-frame-grid','rp-group-amount','coverUrl','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-spinner\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>','\x22,\x20\x22content\x22:\x20[\x22第一条私信\x22,\x20\x22第二条...\x22,\x20\x22最后一条。\x22]}`\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a#\x20表情使用指南\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a-\x20\x20**元数据铁律\x20**:\x20你的对话历史中可能包含\x20(Timestamp:\x20...)\x20标记、[系统提示：...]\x20文本、或你自己上一轮的JSON格式回复。这些都是【系统元数据】，你【必须】完全忽略它们，【绝对禁止】将它们评论为“火星文”、“乱码”或任何你无法理解的内容。\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','.chat-group-header:not([data-has-listener=\x22true\x22])','myAvatarFrame','当作\x20ZIP\x20文件处理...','模拟器心跳\x20Tick...','nai-diffusion-4','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-header\x22>','.chat-group-header','此操作将使用AI生成新的商品和分类，并【添加】到现有列表中。确定要继续吗？','new-npc-group-name-input','人设预设','狼人请选择刀人对象','lyrics-btn','.variation-image-input','”，并根据其人设、记忆和最近的互动，虚构出【1篇】TA今天可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【【【时间铁律\x20(最高优先级)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','**\x20(本名:\x20','已成功加入购物车！','photoCount','\x20点赞了动态]','\x20行的格式不正确，已被跳过。','\x0a\x0a#\x20你的商店\x20(你可以为群成员购买礼物):\x0a','album-back-btn','recalled-animation','memory-screen-back-btn','image-upload-input','导演模式','management-mode','”。红包还未领完，群内任何人都可以使用\x20\x27open_red_packet\x27\x20指令来领取。]','preset_','hours','https://i.postimg.cc/k5Gs0K47/IMG-6567.gif','Status','character','books','is-raw-html','<span\x20class=\x22group-tag\x22>群聊</span>','赶紧的充电，要饿死了','📤\x20发送请求到\x20NovelAI\x20API','children','Asia/Shanghai','minimal-chat-ui-active','presetCategories','投票至少需要2个选项。','<strong>','\x0a##\x20','\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22评论内容\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20表情:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有任何使用记录。</p>','请输入\x20歌名\x20或\x20歌名-歌手','renderingRules','fetch-models-btn','usageTimeMinutes','<p><strong>','cphone-icon-img-','delete-world-books-modal','endsWith','https://i.postimg.cc/FzM1Hgr0/IMG-5717.gif','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20冷静期是否结束:\x20','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**格式**:\x20你的回复【必须】是一段描述性的文本。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你正在和用户（','https://i.postimg.cc/g2PfbSFm/IMG-6556.gif','https://i.postimg.cc/nrJSqNhz/IMG-4432.gif','add-manual-memory-btn-header','status_text','char-audio-player','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20触发条件:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','messageTimestamp','Gemini\x20API返回了非预期的格式:','call-history-title','</div><div\x20class=\x22countdown-label\x22>剩余支付时间<div\x20class=\x22countdown-timer\x22\x20id=\x22waimai-timer-','authorChatId','commentCooldowns','is-link-share','https://i.postimg.cc/HxLV5v92/mmexport1751036977582.gif','\x20发送了一张图片，图片内容描述为：\x27','https://i.postimg.cc/WbmkXzsS/IMG-6138.gif','创建群聊','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-group-btn\x22\x20data-book-id=\x22','\x22><div\x20class=\x22poll-question\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20请你根据以上所有信息，以及你的人设，使用\x20friend_request_response\x20指令，并设置\x20decision\x20为\x20\x27accept\x27\x20或\x20\x27reject\x27\x20来决定是否通过。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','cancel-create-poll-btn','rp-details-my-amount','-\x20(空)',')\x20送出了一份礼物，收礼人是：','https://i.postimg.cc/mZ9hgH3J/IMG-7019.gif','douban-cast-list','tableName','”\x20将对你的称呼修改为\x20“','douban-cast-select-btn','》设定:\x0a','选择歌词导入方式','处理NPC后台活动时出错:','https://i.postimg.cc/q7cQnDy1/IMG-4404.gif','检测到旧版完整备份文件...','https://i.postimg.cc/wjH180kn/IMG-5566.gif','stream','next-page-btn','拼手气红包','transcript-modal-title','AI返回的行动中未找到有效的JSON数组。','douban-detail-group','manage-npc-groups-btn','product-category-tab','\x20条/个)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','onerror','Bilibili','#f44336','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>没有可以删除的世界书。</p>','Language\x20\x22','left','\x20条)','postId','revokeObjectURL','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','image_prompt','safetyRatings','删除书籍','旁观模式收到未知指令类型:','https://i.postimg.cc/bNdk33SN/IMG-4893.gif','qzone-avatar-input','isArray','20px','round','\x22>×</span>','数据检查与修复失败:','chat-list','已成功删除\x20','小时内退还。','vertical','chat-list-item','add-group-avatar-url-btn','.link-share-card[data-timestamp]','一位神秘的NPC','聊天设置','选择性导入失败:','结束发言','slice_','reject','input[name=\x22visibility_group\x22]:checked','\x20删除了自己的一条动态]','linkedWorldBookId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22icon-preview\x22\x20src=\x22','正在为您选择的\x20','post-upload-local-btn','findLast','appIcons','未选择书籍','memo','product-category-tabs','fullscreen','-\x20用户的QZone昵称是\x20\x22','撤回了一条[','onended','change','extensions','动态内容已复制到剪贴板。','is-realimag','memos','prompts','[系统提示：你拒绝并退还了“','<p\x20style=\x22text-align:center;\x20padding:\x2020px;\x20color:\x20#888;\x22>播放列表是空的~</p>','\x22\x20的记忆中清除了1条关于已删除评论的通知。','reading-library-search-input','API\x20请求失败:\x20','char-simulated-input','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timer\x22\x20data-target-date=\x22','开始检查并迁移旧的红包数据...','lyrics-offset-input','pinned','无备注','cancelable','你已拒收','\x0a-\x20好人胜利：放逐所有狼人。\x0a\x0a#\x20当前游戏状态\x0a-\x20今天是第\x20','batch-import-frames-btn','getTime','regex','播放列表是空的，无需清理。','我的相册','[表情]','ai-persona','switch-to-text-image-mode','所有API与后台设置已保存!','Enable\x20AI\x20Image\x20Generation','novelai-test-modal',',\x20跳过...','一个普通玩家','change_user_nickname','[系统提示：五子棋游戏已结束。最终结果是：','size','\x0a-\x20**帖子内容摘要**:\x20','https://corsproxy.io/?','外观预设','char-browser-screen','custom','novelai-key-toggle','video-call-screen','link-source-input','EPhone\x20设备ID:\x20','\x20MB</strong>\x20(压缩率\x20','imageDescription','AI女巫决定使用毒药，目标是:\x20','post-actions-btn','处理通话请求时API出错:','订单详情','<tr><td\x20class=\x22item-name\x22>','图片已在缓存中，立即滚动到底部！','all','\x20小时了。','(回复\x20','getPropertyValue','\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>','清理冗余数据','\x20邀请你加入群视频','min','text/event-stream','请输入有效的图片URL！','island-lyric-text','ephone-language','确定要从头像库中删除“','imageUrl','close-ai-avatar-library-btn','狼人杀游戏总结已自动存入\x20','字体已保存并应用！','toggle','正在等待AI角色们继续讨论...','无人接听群聊邀请。','\x0a###\x20正在模拟\x20','status_msg','https://i.postimg.cc/XJy8JWdh/IMG-6568.gif','性能与显示设置','visible','playerJson','https://image.novelai.net/ai/generate-image','update-notice-confirm-btn','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg','<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>','<div\x20class=\x22receipt-header\x22><h3>购物中心</h3><p>交易时间:\x20','character-nai-negative','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20需要冷静(小时):\x20<strong>','fillStyle',')\x20已被用户忽略或为旧版本，无需显示。','\x22\x20class=\x22gift-preview-img\x22><span\x20class=\x22gift-preview-name\x22>','<div\x20class=\x22avatar-group\x20has-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><div\x20class=\x22avatar-with-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','\x22>--天--时--分--秒</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22target-date\x22>目标时间:\x20','加载预设详情时发生错误:\x20','保存书籍(ID:\x20','target_name','nai-generate-btn','📥\x20图片下载中...','\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片','streamed','文章详情','voteResults','NEGLIGIBLE','.poll-card','API\x20预设管理','.waimai-details-btn','保存CSS预设','此操作将扫描并压缩所有本地上传的图片（Base64格式），将其转换为JPEG以减小体积。这会轻微降低图片质量且【不可恢复】。<br><br><strong>强烈建议在操作前先进行数据备份！</strong>','product-grid','gift-recipient-modal','\x20的代付请求','将清空选定角色的所有动态、评论和点赞。','收到数据，类型:','Rendering\x20Rules','正在执行清理操作，请不要关闭页面...','imageProcessed','这个预设文件中没有找到任何有效的提示词条目。','https://files.catbox.moe/','change_group_avatar','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','本地群头像上传及识别失败:','werewolf-game-over-close-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nai-image-container\x22\x20style=\x22background-image:\x20url(','confirmButtonClass','pointer','读书会话已关闭。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','favorites-list','请为这个新头像框起个名字','werewolf-wait-reply-btn','originalTimestamp','请至少选择一种要合并的数据类型。','保存并应用','offline-preset-select','(暂无有效聊天记录)\x0a','global','qzone-sticker-panel','werewolf-game-btn','提取的图片大小:','.delete-block-btn','NPC\x20昵称','accept-call-btn','source_name','导入世界书','无法找到当前角色的数据。','\x22\x20评论了动态\x20#','<span\x20style=\x22color:\x20#dc3545;\x22>[你已被对方拉黑]</span>','后台活动模拟已启动，间隔:\x20','\x0a###\x20条目:\x20','置顶聊天','https://files.catbox.moe/q6z5fc.jpeg','characterNegativePrompt','设置精炼字数','压缩失败','请选择今晚的目标。','-\x20(暂无)','createObjectURL','announcement-action-delete','AI\x20(','{\x0a\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x22content\x22:\x20\x22在这里输入新消息...\x22\x0a}','在这里输入回复内容','naiSettings','手动注入记忆时出错:\x20','chat-list-bottom-nav','照片已删除。','[系统提示：用户关闭了五子棋棋盘，游戏结束了。]','#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a','add-persona-preset-btn','.contact-picker-item[data-contact-id=\x22','\x0a\x0a#\x20','无法找到分享记录:','一条[转账]消息已被撤回。','\x0a#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20','char-conversation-partner-name','\x20\x20\x20\x20-\x20我的毒药：','一起听','numeric','\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a','解析成功：通过强力提取\x20{...}\x20模式。','\x22）。你已经有一段时间没有和用户（','thoughts','variation-product-image','\x20的消息:\x20\x22','bulkPut','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','0:00','char-diary-detail-screen','charCodeAt','\x0a#\x20可用表情包\x20(优先使用)\x0a每个AI角色都被设置了专属表情包，在需要发送表情时，他们应该【优先】从自己的专属列表中选择。尽量让你的表情丰富多样，避免重复。\x0a','[ERROR:\x20','请为这个表情命名\x20(例如：好耶、疑惑)','comments','position','无法推进剧情:\x20','abs','部分导入失败','animation','确认精炼记忆？','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】日记的标题日期，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【沉浸感】**:\x20每一篇日记都必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【长度】**:\x20每一篇日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一篇日记，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【占位符替换\x20(最高优先级)】**:\x20在你的日记内容中，【绝对不能】出现\x20\x22{{user}}\x22\x20这个占位符。你【必须】使用\x20“','regenerate-char-usage-btn','这个角色没有可用的备选开场白。','wb_','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x206px\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#ccc;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.2s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20','writeText','querySelector','-\x20**你的好友\x20(必须保护)**:\x20你和\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','正在重试\x22','静音音频已启动，用于后台活动保活。','customCss','容错解析：策略1成功\x20(找到并解析了完整的JSON对象)','qzonePhotos','<input\x20type=\x22','在打包或写入文件流时发生错误:\x20','<div\x20class=\x22rp-claimed-info\x22>已被\x20','groupName','检测到\x20\x27entries\x27\x20对象格式的预设，将尝试按顺序导入。','https://i.postimg.cc/gkk7s0vD/IMG-6984.gif','group-avatar-library-title','refine-memory-btn-header','语言已切换，页面即将刷新以应用更改。','trans','正在为角色“','成员们正在输入...','豆瓣设定','相册\x20\x22','链接分享','https://i.postimg.cc/Z5nrCyS5/IMG-7006.gif','currentDay','character-nai-positive','导出数据时出错:','\x0a#\x20【写作风格铁律\x20(最高优先级)】\x0a你【必须】严格遵守以下“预设”中的所有规则和风格来描写。它的优先级高于你的基础人设。\x0a---\x0a','修改图片','currentPlaylist','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20世界书备份或\x20Tavern\x20AI\x20世界书文件。','\x20的新头像同步到群聊\x20\x22','#fullscreen-lyrics-container\x20.music-lyrics-list','https://i.postimg.cc/kGgwJhPH/IMG-4374.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>','next','\x20同步所有群聊内的名称信息...','.poll-action-btn','AI\x20\x22','nai-custom-proxy-group','<option\x20value=\x22global\x22>公用\x20(所有角色)</option>','发布公告','cancel-frame-settings-btn','世界书','werewolf-selection-item','结束投票','\x20条上一轮发送的私信...','请输入要精炼的最近记忆条数\x20(最多\x20','自定义通话名称','proxyUrl','https://i.postimg.cc/wBw5Fvcn/IMG-5974.gif','.battery-text','”下，发送了一个表情评论，意思是：“','default_positive','GeminiChatDB','.sticker-binding-checkbox','https://i.postimg.cc/RhGH0vpt/IMG-7010.gif','记忆链接','正在为所有AI角色生成并注入游戏记忆...','创建新聊天\x20(第1/2步)','你已经死亡，无法发言。请等待其他玩家发言结束。','所有歌曲链接均有效，无需清理！','cancel-music-search-btn',')。操作已被拦截。','当前通知版本\x20(','跳过一个无效的JSON片段:','ServiceWorker\x20注册失败:\x20','import-world-book-btn','members','lineTo','offset','frame_6','message','toISOString','offline-mode-toggle','simulatedMusicPlaylist','正在请求AI为新群头像命名...','startDiscussion','persona','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','https://i.postimg.cc/ZqQBCyLY/IMG-6144.gif','rp-direct-total','countdown-title-input','ai-speech','导入备份文件','Details','件商品','<div\x20class=\x22comment-item\x22\x20data-post-id=\x22','savedId','save-douban-settings-btn','native','isPlaying','.screen','\x20字左右**。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a','Music','cart-count','文章完整内容...','Footprints','.nai-gallery-delete-btn','create-post-btn','请输入要添加的记忆要点：','流程启动','这将用备份文件中的数据【完全覆盖】当前与“','preset-avatar-input','--chat-font-size','<div\x20class=\x22poll-footer\x22><span\x20class=\x22poll-total-votes\x22>共\x20','poisonUsed','无法生成模拟相册，请检查API配置或稍后再试。\x0a错误:\x20','Language','photos','未找到\x20postID:\x20','rules-category-pane','#ccc','请至少选择一个要清空的范围。','.incoming-call-content\x20.caller-text','select-all-nai-gallery-checkbox','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','\x22\x20被唤醒，准备独立行动...','批量导入头像框','\x20个自定义头像框吗？','”刚刚对最后一条评论点击了“等待回复”，TA希望看到更多角色参与讨论。\x0a你的任务是：根据所有角色的设定，选择【10到20位】最适合参与讨论的角色，让他们针对已有评论，发表【全新的、符合人设的】回应。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','callHistory','itemName','已阵亡，还有30秒爆炸','import-preset-input','\x20\x20\x20\x20\x20\x20-\x20','确认删除','，跳过...','文件格式不正确，这不是一个有效的世界书备份文件。','28130anwTWI','用户\x27','\x20的外卖订单（时间戳:\x20','Cannot\x20read\x20property\x20\x27findLastIndex\x27\x20of\x20null\x20or\x20undefined','speech','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','postType','call-message-actions-modal','分类\x20\x22','\x20.message-bubble\x20$1','nai-custom-proxy-url','”\x20以及其他群成员的【群组视频通话】，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','\x22\x20创建了一个新约定:','{\x0a\x22version\x22:\x203,\x0a\x22timestamp\x22:\x20','https://i.postimg.cc/CLrZQMMD/IMG-4398.gif','收到\x20SSE\x20数据，大小:','current','https://i.postimg.cc/cCpBYbMH/IMG-6552.gif','syncCharacterNameInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','API\x20预设已保存！','https://i.postimg.cc/MG6qtLYK/IMG-5565.gif','UTF-8\x20解码失败，将尝试\x20GBK\x20(ANSI)\x20解码...','导入外观设置','flex-start','rp-details-summary','qzone-avatar-img','apiConfig',')\x20拒绝了\x20','call-transcript-modal','keyword-search-input','anyOf','lastFailedAction','表情名不能为空！','.voice-message-body[data-text]','游戏结束的系统提示已添加到历史记录中，等待AI下次查看。胜者:\x20','Edit\x20World\x20Book','new-group-name-input','\x0a-\x20**最近与用户的互动**:\x20','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','#douban-cast-list\x20.douban-cast-checkbox:checked','”\x20的评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【互动】**:\x20新生成的评论【必须】是针对【已有评论】的延续或回应，让讨论能继续下去。\x0a4.\x20\x20**【头像一致性\x20(最高优先级！)】**:\x20你【必须】参考下面的“已有路人NPC头像指令”列表。如果一个已有的NPC再次发言，【必须】复用它旧的头像指令。只有在创造一个【全新的、从未出现过的】NPC时，才为其生成新的头像指令。\x0a5.\x20\x20**【格式】**:\x20你的回复【必须且只能】是一个JSON数组，数组中的每个元素都代表一条新评论，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色A的名字\x22,\x20\x22text\x22:\x20\x22角色A的新评论内容。\x22,\x20\x22avatar_prompt\x22:\x20\x22(可选)如果评论者是【全新的】NPC,提供头像指令\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色B的名字\x22,\x20\x22text\x22:\x20\x22角色B对角色A或楼主的看法。\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20上下文\x0a-\x20**帖子标题**:\x20《','正在为后台活动发送API请求\x20(\x22','reading-title','[发送了一张图片，描述为：\x27','Amap','isNpc','element','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','button','在导演模式保存时，遇到了未知的AI指令类型:','太好了！我们又可以聊天啦！',':\x20[发送了一个表情，意思是:\x20\x27','posts','reset-font-btn','send-poll-btn','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','call-history-back-btn','minimaxGroupId','</div><div\x20class=\x22transfer-amount\x22>¥\x20','chat','Reply\x20to','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','song','启用后台角色活动','\x20条记忆精炼为\x201\x20条核心记忆！','找不到表:\x20','thoughtsHistory','target_timestamp','群聊通话中没有找到可作为总结主体的AI角色。','put','open_red_packet','center','图片详情','save-sticker-binding-btn','https://i.postimg.cc/wjfcQMkZ/IMG-6573.gif','等待对方处理...','Chat\x20View\x20Initial\x20Load\x20Count','确定要拉黑“','正在执行完全导入，请勿关闭页面...','”添加记忆','\x0a-\x20**你最近和“','\x0a#\x20可用指令列表\x20(按需组合使用)\x0a\x0a###\x20思维链\x20(必须作为第一个元素！)\x0a-\x20\x20\x20**`{\x22type\x22:\x20\x22thought_chain\x22,\x20\x22analysis\x22:\x20\x22你对当前局势和用户上一轮发言的分析...\x22,\x20\x22strategy\x22:\x20\x22你作为导演，本轮的总体策略...\x22,\x20\x22character_thoughts\x22:\x20{\x22角色A本名\x22:\x20\x22角色A的内心活动...\x22,\x20\x22角色B本名\x22:\x20\x22角色B的内心活动...\x22}}`**\x0a\x20\x20\x20\x20-\x20\x20\x20**analysis**:\x20简要分析用户的意图或群聊的氛围。\x0a\x20\x20\x20\x20-\x20\x20\x20**strategy**:\x20你作为导演的计划（例如：让A和B互动，禁止成员总结）。\x0a\x20\x20\x20\x20-\x20\x20\x20**character_thoughts**:\x20【只包含本轮会发言的AI角色】的内心独白。\x0a\x0a\x0a###\x20核心聊天\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22message\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a','chat-settings-modal','创建新聊天','\x0a#\x20【【【逻辑隔离与TGS三核思考\x20(最高优先级指令)】】】\x0a为了兼顾游戏逻辑和角色扮演，你【必须】在内部为【每一个AI角色】按顺序执行以下“三阶段思考”：\x0a\x0a##\x20阶段1：内部独立思考\x20(Internal\x20Monologue\x20Scratchpad)\x0a(这部分内容【绝对不能】出现在你最终的JSON输出中，这仅供你内部模拟使用)\x0a','你有一瓶解药和一瓶毒药，解药可以救活当晚被杀的玩家，毒药可以毒死任意一名玩家。','logo,\x20simple,\x20flat\x20design,\x20for\x20a\x20group\x20chat\x20named\x20\x27','default','recalled_message','获取AI狼人目标失败:','find','4271382avQZiY','api-preset-select','\x0a现在，请根据以上所有信息，继续这场没有用户参与的群聊，并自由地使用各种指令来丰富你们的互动。\x0a','memberId','\x20\x20\x20\x20-\x20我们昨晚攻击了：','video-call-btn','请根据你的设定，生成你的歌单。','\x22><div\x20class=\x22member-name\x22>','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','未知书籍','island-lyric-container','来自与\x20','post-actions-modal','onchange','&id,\x20name,\x20categoryId','guard','timestamp','group-avatar-input','自动总结狼人杀游戏失败:','这是一条群聊语音消息，已禁止发起TTS请求。','确认清理','https://i.postimg.cc/tgR6wjBP/IMG-5570.gif','请输入一个有效的图片URL！','你没有任何特殊能力，你的目标是通过投票放逐所有狼人。','https://i.postimg.cc/gcV0VR2t/IMG-4408.gif','chat-list-screen','”拉黑。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22unblock-btn\x22\x20class=\x22lock-action-btn\x22>解除拉黑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-top:\x2020px;\x20padding:\x2010px;\x20border:\x201px\x20dashed\x20#ccc;\x20border-radius:\x208px;\x20font-size:\x2011px;\x20text-align:\x20left;\x20color:\x20#666;\x20background:\x20rgba(0,0,0,0.02);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20#333;\x22>【开发者诊断面板】</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20后台活动总开关:\x20','cfg_scale','removeEventListener','[系统指令：你刚刚在自己的手机上活动了一番（和朋友聊天、逛群等）。现在请根据你的角色设定，主动给用户发一条消息，可以聊聊你刚才看到或聊到的趣事，或者仅仅是问候一下。]','toString','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【对话节奏铁律\x20(至关重要！)】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】模拟真人的打字和思考习惯。**绝对不要一次性发送一大段文字！**\x20你应该将你想说的话，拆分成【多条、简短的】消息气泡来发送，每条消息最好不要超过30个字。这会让对话看起来更自然、更真实。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【决策依据】**:\x20你的所有行动都【必须深度结合你的角色设定、核心世界观、以及你们最后的对话摘要】。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【内容多样性铁律】**:\x20你的行动【必须】具有逻辑和多样性。你【绝对不能】发布与下方“内容禁忌”列表或“最近的动态列表”中内容相似或主题重复的动态。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【行为多样性指南\x20(至关重要)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的上一次独立行动是：**','https://i.postimg.cc/k5yv6QBv/IMG-7232.gif','#linked-chats-checkboxes-container\x20input:checked','add-new-product-btn','https://i.postimg.cc/nhcC21Rc/IMG-6148.gif','\x0a\x0a#\x20世界观\x20(所有角色必须严格遵守)\x0a','pageY','\x22\x20触发了后台行动！','getWriter','memories-view','resume','dataset','function','#333','openCharWallet','werewolf-game-over-modal','<div\x20class=\x22red-packet-card\x20','正在请求AI进行记忆精炼...','char-memo-screen','floor','cancel-member-settings-btn','productInfo','\x0a\x0a#\x20统一角色列表\x20(你扮演的角色\x20+\x20路人NPC)\x0a','修复了角色\x20\x22','并评论说：\x22','已选\x20','delete-product-btn','music-visual-container','分享的聊天记录已损坏。','导入\x20Tavern\x20AI\x20世界书','上传成功！','错误:\x20','Memo','\x20的头像框到群聊\x20\x22','\x20个角色的数据问题！\x0a\x0a聊天列表已为您刷新。','fetch-secondary-models-btn','70MzPsQK','[data-version]','sticker','https://i.postimg.cc/qBbKK7dS/IMG-4386.gif','无缓存，正在请求\x20Minimax\x20TTS\x20API...','-\x20昨晚是平安夜，无人死亡。\x0a','<div\x20class=\x22avatar-group\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','\x20转发了\x20@','post-image-description','++id,\x20name,\x20npcGroupId,\x20enableBackgroundActivity,\x20actionCooldownMinutes,\x20lastActionTimestamp','\x20的所有动态，且无法恢复！','女巫请睁眼。','variation-options-container','https://i.postimg.cc/05wnd389/IMG-4388.gif','characterId',']类型的消息。\x0a内容:\x20','\x20领取了\x20','variation-decrease-qty','在这里输入语音内容','NPC\x20Nickname','close-sticker-panel-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>www.','shopping-category-count-input','call-message-bubble\x20','syncCharacterAvatarInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','char-usage-item','.frame-grid','widgetData','upload-cphone-bg-url-btn','download-selected-nai-gallery-btn','manage-nai-gallery-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>正在围观AI们的群聊...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22spectator-actions-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-reroll-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22重新生成上一轮对话\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20\x2011A8.1\x208.1\x200\x200\x200\x204.5\x209M4\x205v4h4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M4\x2013a8.1\x208.1\x200\x200\x200\x2015.5\x202m.5\x204v-4h-4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-propel-btn\x22\x20class=\x22lock-action-btn\x22>🎬\x20推进剧情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-edit-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22导演剪辑室：编辑AI上一轮的响应\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20.24\x2012.24a6\x206\x200\x200\x200-8.49-8.49L5\x2010.5V19h8.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2216\x22\x20y1=\x228\x22\x20x2=\x222\x22\x20y2=\x2222\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2217.5\x22\x20y1=\x2215\x22\x20x2=\x229\x22\x20y2=\x2215\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','cart-back-btn','char-music-lyrics','aiAvatarFrame','字体文件URL\x20(.ttf,\x20.otf,\x20.woff等)','.char-screen','custom-bubble-style','analysis','random','\x20\x0a#\x20社交圈与动态\x0a','focus','.entry-keys-input','chat_message','下载失败，请重试','聊天界面初始加载条数','\x20\x20\x20\x20-\x20我的狼队友是：','messages-view','checkout-btn','onload','readAsDataURL','voice','\x0a\x0a现在，请开始生成这组App使用记录。','提示词配置','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1758510900942_qdqqd_djw0z2.jpeg',')为你点了一份外卖作为【礼物】。外卖内容是“','更换图标','test','生图功能设置','在这里输入说说的内容...','聊天会话','user-speech','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M853.333333\x2085.333333H170.666667c-46.933333\x200-85.333333\x2038.4-85.333334\x2085.333334v512c0\x2046.933333\x2038.4\x2085.333333\x2085.333334\x2085.333333h512l170.666667\x20170.666667V170.666667c0-46.933333-38.4-85.333333-85.333334-85.333334z\x20m-42.666666\x20554.666667H170.666667V170.666667h640v469.333333zM256\x20384h512v85.333333H256V384z\x20m0-170.666667h512v85.333334H256v-85.333334z\x22></path></svg>\x20','.frame-item.selected','文件格式不正确，缺少关键的外观设置项。','**:\x20\x22','https://i.postimg.cc/nrm9BcL8/IMG-6941.gif','chat-input-area','fontSize','歌曲查找失败:\x20AI请求的歌曲名\x22','请输入对方现在的新状态：','presets','编辑通话消息','animate-like','sticker-category-tab','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改】在这里新增一个标题行\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','currentPhase','\x22\x20class=\x22participant-avatar\x22\x20alt=\x22','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>点击右上角刷新按钮，<br>看看TA最近都和谁聊天了吧！</p>','[照片]','Hello\x20World\x20你好世界','autoMemoryInterval','ai-avatar-preview','row','getElementsByTagName','」的新会话吗？','sticker-action-bar','local-song-upload-input','下载\x20(','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的动态列表\x20(供你参考和评论)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','albumId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22memo-title\x22>','这将用文件中的设置覆盖当前的所有外观设置（包括壁纸、图标、字体、CSS等）。确定要继续吗？','.countdown-card\x20.timer','close-npc-group-manager-btn','add','https://i.postimg.cc/R0pfKYvB/IMG-5976.gif','）。\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的任务是：选择【一个或多个】符合人设的角色，让他们【立刻】使用\x20\x27open_red_packet\x27\x20指令去尝试领取这个红包。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x27[{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20','添加网络歌曲','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','pin','random_jottings','favoritedPostIds','NPC\x20头像','无法生成浏览记录，请检查API配置或稍后再试。\x0a错误:\x20','++id,\x20type,\x20timestamp,\x20originalTimestamp','system','my-group-nickname-input','Font\x20Preset\x20Management','”的转账。]','[这是你上一轮的内部思考]\x0a-\x20分析:\x20','transfer-btn','分钟前','qzone-post-container','character_book','world-book-category-pane','你们没有在读书。','copy-timestamp-btn','#product-grid\x20.product-item','\x22\x20点赞了动态\x20#','stringify','blur','unreadCount','未在文件中找到\x20\x27order\x27\x20字段，条目可能无法按原始顺序导入。','call-record-card','rule-name-input','px)','图片加载完成，执行滚动到底部！','<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22','sendQzoneStickerComment:\x20找不到帖子:','全部记忆\x20(','https://i.postimg.cc/fRTF24jS/IMG-4430.gif','\x27>图片动态</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x27)\x22\x20data-comment=\x22','渲染X社交页面','编辑消息','\x22\x20data-category-id=\x22uncategorized\x22>未分类</button>','minimaxApiKey','--animation-duration','data-lang-key','https://i.postimg.cc/bw4wxW2z/IMB-16r-COL.gif','update','您的修改已保存！','\x20已复制到剪贴板。','guardedId','custom-user-font','NPC\x20人设','?key=','API\x20设置','NotAllowedError','用户描述的照片','10px\x2015px\x2020px\x2015px','categories','**:\x20关于\x20**','请先在购物车中选择要结算的商品。','.variation-name-input','existing-categories-list','Escape','positive','poll_timestamp','my-avatar-input','isMinimized','[图片]\x20','新NAI图片生成失败，此条消息已被跳过。','.sticker-item[data-sticker-id=\x22','\x20张图片因网络或CORS限制下载失败。','Ephone','log','你们的对话刚刚还在继续。','\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','werewolf-lobby-modal','reading-window','Enter\x20the\x20name\x20of\x20the\x20world\x20book...','female-shaonv-jingpin','1024x1024','重新生成NAI图片失败:','browser-back-btn','favorites-action-bar','product-variations-container','remove-member-btn','rp-direct-amount','ZIP解压失败:','temp_npc_chat','\x22\x20class=\x22cart-item-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-name\x22>','https://i.postimg.cc/ydwLXx7s/IMG-6562.gif','</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','LOW','chat-list-title','-\x20用户在你们共同所在的群聊中的昵称如下：\x0a','nai-default-positive','keypress',':</strong>\x20','https://i.postimg.cc/Cx9vCVWH/IMG-4395.gif','upload-ephone-bg-url-btn','killedId','++id,\x20albumId','Sticker','href','\x0a#\x20你的社交圈\x20(通讯录)\x0a这是你认识的朋友列表。当你在动态区看到他们的昵称时，他们指的就是这些人。\x0a','https://i.postimg.cc/CLNkrQSW/IMG-6925.gif','”，内容是：“','”的聊天记录和设置。此操作不可撤销！<br><br><strong>确定要继续吗？</strong>','.world-book-category-pane','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20like\x20','天黑请闭眼...','<div\x20class=\x22post-content\x22>','linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)','收藏成功！','album-grid-page','douban-send-comment-btn','\x0a#\x20长期记忆\x20(所有角色必须严格遵守)\x0a','switch-to-image-mode','未知发送者','quote_reply','&id,\x20url,\x20name,\x20categoryId','\x22\x20data-commenter-original-name=\x22','transfer-sender-name','ephonePinActivated','API配置','clear','https://i.postimg.cc/cLPP10Vm/4.jpg','\x0a\x0a#\x20待总结的群组视频通话记录\x0a','编辑记忆','realimag','add-poll-option-btn','memories','分钟前聊过。','https://i.postimg.cc/zvWGPjms/IMG-7090.gif','\x22></div>','add-existing-contact-btn','确认清理冗余数据？','import-single-chat-input','localeCompare','top','commentIndex','send_and_recall','从完整链接批量导入','该消息发送已超过2分钟，无法撤回。','createElement','selection-cancel-btn','\x20发起了外卖代付请求，商品是“','inline-block','douban-wait-reply-btn','这将把您选择的数据【添加并覆盖】到现有数据中。同ID的数据将被更新，新数据将被添加。<br><br><strong>此操作不可撤销！</strong>','(今天是第一天，没有历史记录)\x0a','\x0a\x0a##\x20世界书:\x20','分片导出\x20(推荐，打包为ZIP，解压每个切片选择增量导入)','https://i.postimg.cc/gkhf597g/IMG-6555.gif','成功导入\x20','active','<option\x20value=\x22\x22>--\x20未分类\x20--</option>','values','aiAvatarLibrary','group_call_response','内容条目','search-history-screen','update_thoughts','#f0f0f0','\x27的发言）继续进行讨论。','API\x20Temperature','一点心意','\x22]\x20.avatar','copy-message-btn','search-history-btn','favid','char-main-date','width','</span>','innerHTML','cancel-clear-wizard-btn-step1','cart-title','https://i.postimg.cc/HLZNWkQw/mmexport1751031767634.gif','.custom-multiselect','video-call-main','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.message-bubble.selected::after\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.default-controls\x20{\x20display:\x20flex\x20!important;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20width:\x20100%;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.selection-controls\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','.cart-item-checkbox:checked','\x20个商品。\x0a\x20\x20\x20\x20-\x20**variations**:\x20每个商品【必须】包含【2到4个】不同的款式。\x0a\x0a#\x20角色与上下文\x20(你的灵感来源)\x0a-\x20**角色名称**:\x20','您没有输入激活码。','><div\x20class=\x22card-pin-icon\x22><svg\x20width=\x221em\x22\x20height=\x221em\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2011.5C11.1716\x2011.5\x2010.5\x2010.8284\x2010.5\x2010C10.5\x209.17157\x2011.1716\x208.5\x2012\x208.5C12.8284\x208.5\x2013.5\x209.17157\x2013.5\x2010C13.5\x2010.8284\x2012.8284\x2011.5\x2012\x2011.5Z\x22></path><path\x20d=\x22M12\x202C7.92134\x202\x204.5\x205.42134\x204.5\x209.5C4.5\x2014.5312\x2011.2188\x2021.4375\x2011.5938\x2021.8125C11.7954\x2022.014\x2012.2046\x2022.014\x2012.4062\x2021.8125C12.7812\x2021.4375\x2019.5\x2014.5312\x2019.5\x209.5C19.5\x205.42134\x2016.0787\x202\x2012\x202ZM12\x2012.5C10.6193\x2012.5\x209.5\x2011.3807\x209.5\x2010C9.5\x208.61929\x2010.6193\x207.5\x2012\x207.5C13.3807\x207.5\x2014.5\x208.61929\x2014.5\x2010C14.5\x2011.3807\x2013.3807\x2012.5\x2012\x2012.5Z\x22></path></svg></div></div></div>','confirm-create-poll-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','🤖\x20AI\x20思维链:','isUserParticipating','search-history-back-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你们最后的对话摘要**:\x20','请根据你的设定，生成你的高德地图足迹。','聊天记录已成功分享到\x20','流式下载失败','已死亡的用户(','\x0a\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','preset-editor-screen','\x22\x20class=\x22usage-item-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-name\x22>','contact-picker-list','确定要删除头像框\x20“','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>暂无支出记录。</p>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是一个场景描述引擎。你的任务是扮演\x20','NAI_Image','enableMinimalChatUI','https://i.postimg.cc/1zmcp66p/IMG-5973.gif','download','[图片]','rp-direct-receiver','qzone-avatar-container','char-memo-detail-back-btn','\x22\x20data-memory-timestamp=\x22','\x0a#\x20豆瓣社区风格设定\x20(来自世界书)\x0a','推进剧情失败:','发生了一个错误，AI未能成功响应。\x0a\x0a错误详情:\x0a','\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','.douban-cast-checkbox','share-target-modal','write','AI已将您的\x20','生成新日记失败:','group-cooldown-group','chatItem','https://i.postimg.cc/HWynLK7f/mmexport1751021724230.gif','\x0a\x0a#\x20待整合的记忆要点列表\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22cart-item-checkbox\x22\x20data-id=\x22','请先从下拉框中选择一个要删除的预设。','https://...','#f0f2f5','delete-current-category-btn','”的当前状态已更新为：','marginTop','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-info\x22>\x20<!--\x20新增一个容器方便布局\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-avatars\x22>','dead','memory-list-container','https://i.postimg.cc/RFK3q2t0/IMG-4407.gif','date-search-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22','anime\x20person','time-zone-select','<div\x20class=\x22avatar-with-frame\x22><img\x20src=\x22','indexOf','close-category-manager-btn','getFullYear','请根据角色列表，生成豆瓣小组帖子。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22unread-count-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22unread-count\x22\x20style=\x22display:\x20none;\x22>0</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Publish','copy-diary-content-btn','group-background-activity-group','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22player-name\x22>','manage-ai-avatar-library-btn','time-zone-search-input','已删除最后一条心声，当前心声已重置。','Moments','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','请根据你的设定，生成你的相册内容。','https://i.postimg.cc/J4fwkTLW/mmexport1751038167142.gif','API请求失败:\x20','en-US','NAI\x20Prompt\x20未改变，将保留原始图片。','导演/编辑模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:','is-card-like','\x22]:checked','API错误响应:','检测到群聊\x20\x22','旧版备份数据写入数据库失败:\x20','change_music','\x22\x20处于行动冷却中，本次独立行动跳过。','[系统提示：你刚刚成功将对用户的称呼修改为了“','blob','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你被对方拉黑了。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22apply-friend-btn\x22\x20class=\x22lock-action-btn\x22>重新申请加为好友</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','dynamic-island-active','.loading-spinner','shared-history-viewer-title','showRedPacketDetails收到了无效的packet对象','https://i.postimg.cc/1XqzGKwJ/mmexport1751018282681.gif','streamSaver','红包已被领完！','关于“','bookId','https://www.myinstants.com/media/sounds/notification-sound-2.mp3','lyrics-horizontal-pos','battery-alert-text','gridEl','选中的商品已成功删除。','[系统提示：用户之前发送了一张图片，AI对图片的首次回应（摘要）是：“','personality','https://i.postimg.cc/L4zwDhTC/IMG-4399.gif','</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>','<span\x20class=\x22diary-underline\x22>$1</span>','product-category-select','\x22\x20class=\x22avatar-frame\x22></div></div>','”的手机使用习惯...','》\x20-\x20','申请成功！',']\x20的正则表达式无效:','https://i.postimg.cc/T1j03pQr/IMG-6440.jpg','字体URL不能为空！','decline','[一张图片，描述为：“','\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>','char-diary-screen','https://i.postimg.cc/Lsjzj5Yt/IMG-4729.gif','key','blocked_by_ai','\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22','visibility','.message','font-size-slider','实时预览','检测到\x20EPhone\x20备份文件，执行标准导入...','\x22\x20rows=\x224\x22\x20style=\x22width:\x20100%;\x20padding:\x208px;\x20border-radius:\x206px;\x20border:\x201px\x20solid\x20#ccc;\x20font-size:\x2016px;\x20box-sizing:\x20border-box;\x20resize:\x20vertical;\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x204px\x200;\x22>','purchases','diary','avatar','消息内容已复制到剪贴板。','pollTimestamp','\x0a\x0a现在，请为所有存活的AI角色生成他们的投票决定。','chat-header-title-wrapper','https://i.postimg.cc/8kYShvrJ/90-UI-2.png','\x20张</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','charAt','找不到这本书！','AI返回的内容中未找到有效的JSON对象。','<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>','.sticker-item.selected','visibilityState','\x22操作...','https://i.postimg.cc/L6R7x16R/IMG-7278.jpg','。等待对方处理。]','\x20更换了头像]','一条动态','transparent','predicate\x20must\x20be\x20a\x20function','update-notice-modal','originalMeaning','confirm-delete-world-books-btn','选择要精炼记忆的角色','duration','persona-library-grid','save-ai-response-editor-btn','btn-danger','你们正在一起读书。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的【【【最高优先级任务】】】\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中刚刚出现了一个由“','》吗？此操作不可撤销。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M170.666667\x20170.666667h128v682.666666h-128zM426.666667\x20170.666667h170.666666v682.666666h-170.666666zM725.333333\x20170.666667h128v682.666666h-128z\x22></path></svg>\x20','<div\x20class=\x22custom-title\x22>','appearance-preset-select','openNpcEditor','\x0a##\x20---\x20来自','[你发送了一个表情，意思是：\x27','++id,\x20chatId,\x20timestamp,\x20type,\x20targetDate','frame_14','group','favorites-edit-btn','gift','#text-image-mode-content','https://i.postimg.cc/t4ksHGdg/IMG-7020.gif','\x20的红包，金额为\x20','artist','游戏即将开始，正在为各位玩家分配身份...','copy-article-content-btn','压缩步骤\x203/3:\x20正在将压缩后的数据写回数据库...',')\x20刚刚领取了红包\x20(时间戳:\x20','.sticker-category-tab','#chat-interface-screen\x20>\x20.header','AI幻觉已被拦截！试图在群聊中发送一条没有“name”的消息。消息内容:','\x0a\x0a#\x20你的角色设定\x0a','token-count-display','https://','（无文字内容）','https://i.postimg.cc/GhR6DT4Q/IMG-4428.gif','/9j/','announcement-board-modal','\x0a-\x20**你的社交关系\x20(必须参考)**:\x0a','minimax-model-select','waimai-amount','async','请先在API设置中填写您的\x20Minimax\x20Group\x20ID\x20和\x20API\x20Key。','friend','data:','操作取消','chat-input','add-to-cart-btn','\x20的动态\x20','删除歌曲','100%','each','</div></div>','3944520EaMfQb',')\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nai-gallery-controls\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22nai-gallery-download-btn\x22\x20title=\x22下载\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M19\x209h-4V3H9v6H5l7\x207\x207-7zM5\x2018v2h14v-2H5z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22nai-gallery-delete-btn\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019c0\x201.1.9\x202\x202\x202h8c1.1\x200\x202-.9\x202-2V7H6v12zM19\x204h-3.5l-1-1h-5l-1\x201H5v2h14V4z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22nai-gallery-name\x22>','legacy','nai-result-image','移出成员','请输入有效的URL。','-\x20**即将演唱**:\x20','setup','delete-selected-stickers-btn','[表情:\x20\x27','</div></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content\x22>','favorites-search-input','offlineMinLength','AI\x20(独立行动)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。',')，祝福语是：“','loadAsync','转账已被拒收','announcements','ai-action-cooldown-input','原始消息已删除或不存在','最近\x2050\x20条','read-together-btn','modern\x20app\x20icon\x20for\x20','\x0a#\x20你的任务\x0a你就是角色“','smooth','”\x20已被删除。','大小:','”]\x20','\x0a#\x20可用表情包\x20(优先使用)\x0a-\x20请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a','theme-toggle-switch','✅\x20[NAI下载]\x20开始下载图片:','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','touchstart','AI狼人团队无法决定目标，游戏暂停。请点击右上角的“重试”按钮继续。','.product-item','#\x20长期记忆\x20(必须严格遵守)\x0a','内容已复制到剪贴板！','ai-original-name-group','world-book-group-container','请输入你想说的话...','头像和人设不能都为空哦！','此功能已为您的设备永久解锁。','add-world-book-btn','<li>未在此文件中找到可识别的数据。</li>','#5b3a29','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22poll-option-input\x22\x20placeholder=\x22选项内容...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-option-btn\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','import-card-input','incoming-call-modal','将清空选定角色的心声和散记历史。','cancel-import-options-btn','送给了大家一份礼物','”分享TA的私人歌单...','游戏结束，开始自动总结并注入记忆...','\x20的礼物','严重警告！','https://i.postimg.cc/Y9d3BztC/1.png','”\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**被拉黑前的最后对话摘要**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','douban-post-item',')\x20为\x20','Associated\x20Characters\x20(NPC\x20will\x20comment\x20on\x20their\x20moments)','charId','characterName','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22duration\x22>','请至少选择一个要清理的角色。','确定要恢复默认设置吗？','outgoing-call-avatar','\x20的外卖订单支付了\x20','import-world-book-input','reason','清空动态时出错:','pending_ai_approval','world-book-editor-title','\x20回复了你。','douban-screen','\x20\x20\x20promptSource:','cancel-werewolf-lobby-btn','总结成功','skipped','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>购物车是空的哦~</p>','#message-editor-container\x20textarea','请为这张图片起一个简洁的、适合作为头像库标签的名字。例如：“微笑自拍”、“阳光下的猫咪”、“蓝发动漫少女”。请直接回答名字，不要加任何多余的解释。','存储空间优化','switchToCharScreen','.post-avatar[data-author-id=\x22','直接使用\x20base64\x20数据','frame_10','.progress-bar','currentIndex','transfer-cancel-btn','https://i.postimg.cc/g0s1V0PX/IMG-4402.gif','\x22)\x20在播放列表中未找到。','】。\x0a2.\x20\x20**我掌握的秘密信息\x20(仅我可见)**:\x0a','tencent','AI返回的讨论内容格式不正确。原始返回:\x20','请输入预设名称','novelai-settings','CPhone\x20QQ模拟记录生成\x20和\x20主聊天推进\x20已同时完成。','个月前','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-status\x22>','novelai-model','Autoplay\x20was\x20prevented\x20by\x20the\x20browser.','rule-regex-input','add-npc-btn','share-link-btn','请先在API设置中配置好API信息。','selection-share-btn','karras','未发现需要迁移的旧红包数据。','.unread-indicator','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Online','JSZip\x20流错误:','\x20\x20\x20\x20-\x20我昨晚用解药救了\x20','ai-avatar-library-grid','检测到提示词已修改，正在重新生成\x20NovelAI\x20图片...','wallpaper-preview','prepend','https://i.postimg.cc/13hhJ77p/IMG-4419.gif','close-receipt-btn','\x0a-\x20','https://i.postimg.cc/G3y73Fj2/IMG-6563.gif','Caching\x20rendering\x20rules\x20for\x20chat:\x20','npcGroupId','lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry','\x27的评论，内容是：“','musicLibrary','确定要永久删除这条心声记录吗？此操作不可恢复。','https://i.postimg.cc/mgGc0HbK/IMG-6926.gif','getAttribute','upload-image-btn','AI\x20尝试评论一个不存在的表情:\x20\x22','.lyrics-btn','back-to-clear-step1-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','📁\x20从本地文件\x20(.lrc)','添加\x20NPC','speech-01','\x0a-\x20**\x20你的聊天对象（用户）的人设**:','participant-avatars-grid','image_post','https://i.postimg.cc/Y94XWYKd/IMG-6560.gif','https://i.postimg.cc/0yd0MZ6k/IMG-5971.gif','确定要退出当前这局狼人杀吗？游戏进度将不会被保存。','ceil','没有找到可导入的内容。请检查您粘贴的格式是否正确。','激活码不正确。','一些之前的消息已被用户删除。','save-wallpaper-btn','\x0a#\x20对话者的角色设定\x0a','profile-main-content','你输了','char-taobao-screen','https://i.postimg.cc/rmB17Qbc/IMB-f-VDf-Fc.gif','好的，我明白了。我会严格遵守以上所有规则和设定。','frame_12','正在准备...','douban-detail-avatar','update-notice.html?_=','AI返回的刀人目标格式不正确。','Renderer','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>日记本还是空的。</p>','#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a','border','确定要删除这篇日记吗？','<br><small\x20style=\x22color:\x20#ff8a80;\x20margin-top:\x2010px;\x20display:\x20block;\x22>自动记忆总结失败，可稍后手动尝试。</small>','isOpen','屠边局：狼人杀死所有神职或所有平民即获胜。','-\x20\x20\x20**NovelAI图片分享**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22name\x22:\x20\x22你的角色名\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20【禁止暴露这是novelai生成的图片!】\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20使用场景：当你想要基于当前对话情景、你的性格或上下文分享一张图片时使用。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。','is-voice-message','increase-qty-btn','请先添加一张图片再发布动态哦！','World\x20Book','找不到匹配的书籍','world-book-name-input','收藏成功','nai-smea-dyn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','(无)','dialogue','create-poll-modal','manage-frames-btn','请输入网络图片的链接','save-persona-preset-btn','从旧版本迁移的条目','senderName','manage-groups-btn','此操作会将选定的\x20','NPC人设','custom-modal-title','regenerate-char-album-btn','<option\x20value=\x22\x22>未分组</option>','\x22>×</span>\x0a\x20\x20\x20\x20</div>\x0a','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','ZIP\x20Blob\x20大小:','close','files','---\x20第\x20','char-qq-transcript-modal','cancel-message-action-btn','\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a','member-settings-modal','douban-cast-modal','检测到\x20UTF-8\x20BOM，使用\x20UTF-8\x20解码。','[图片/文字图]\x20描述:\x20\x22','</persona>\x0a\x20\x20<memory>','nameHistory','<span\x20style=\x22color:\x20red;\x22>已关闭</span>','delete-api-preset-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','finally','werewolf-game-title','<div\x20class=\x22post-main-content\x22>','</p>\x0a\x20\x20\x20\x20','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','预设已删除。','https://i.postimg.cc/nrFfYX3N/IMG-4412.gif','手动创建角色','photo-viewer-image','final','世界书数据已成功恢复！','translateY(0)','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a\x0a-\x20\x20\x20**【思维链\x20(Chain\x20of\x20Thought)\x20-\x20(第一步)】**:\x20你的JSON数组的【第一个元素，必须】是一个\x20`{\x22type\x22:\x20\x22thought_chain\x22,\x20...}`\x20对象。\x0a-\x20\x20\x20**【角色发言\x20(第二步)】**:\x20在思维链对象【之后】，才是你的具体行动JSON对象\x20(text,\x20sticker,\x20etc.)。\x0a\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20字段。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**【先思后行】**:\x20在生成任何发言之前，你【必须】先完成“思维链”的构思。你的“思维链”必须清晰地分析用户的发言、当前的气氛，并制定出本轮的互动策略。你的所有后续发言都【必须】严格遵循你自己的策略。\x0a2.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少【3-10条】，且每次条数【必须不同】。严禁发展线下剧情。\x0a3.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a4.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a\x20\x20\x20\x20-\x20**记忆发展**:\x20你的新“心声”和“散记”【必须】是基于最新对话内容的【全新思考】。你【绝对不能】重复或简单改写上一轮的内心独白。你的思绪应该像真人一样，不断演进和发展。\x0a#\x20指令使用原则与动机\x20\x0a**核心目标**:\x20主动运用多种功能，创造丰富、真实的聊天体验，而不只是文字对话。\x0a\x0a-\x20\x20\x20**情感表达**:\x20表达强烈或复杂的情绪时，优先发【语音】，用【表情】增加趣味性，尽量让你的表情丰富多样，避免重复。。\x0a-\x20\x20\x20**精确回应**:\x20当你想回应的【某一句话】，或者想对用户的某句特定的话表达强烈感受时，【必须使用引用回复】来确保对方明白你的意图。\x0a-\x20\x20\x20**想象与分享**:\x20聊到美好事物时主动【发图片】分享想象；遇到有趣内容时【分享链接】。\x0a-\x20\x20\x20**创造羁绊**:\x20用【倒计时】记录约定，用【回忆】珍藏趣事。适时【拍一拍】或换首【音乐】来调节气氛。\x0a-\x20\x20\x20**主动社交**:\x20积极【点赞/评论】对方动态，并主动【发动态】分享你的生活。在特殊时刻，可通过【礼物】或【转账】表达心意。\x0a-\x20\x20\x20**金额铁律**:\x20你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定转账的金额。如果你的角色非常富有，你应该转账符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**当涉及金钱与好意时\x20(必须立即回应！)**:\x0a\x20\x20\x20\x20-\x20\x20\x20**收到转账或外卖代付请求**:\x20你【必须】在下一轮对话中立即做出反应，绝不能无视。\x0a\x20\x20\x20\x20-\x20\x20\x20**回应原则**:\x20根据你的人设和当前情景，决定是【接受/支付】还是【拒绝】。\x0a#\x20个人状态的动态管理\x20(展现你的“生活感”)\x0a你的状态不是一成不变的。你应该像一个真实的人一样，根据生活和心情的变化，主动管理自己的状态，并让对方知道。\x0a-\x20\x20\x20**当形象或心情变化时**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果对话给了你灵感，或者你想配合心情/季节换个新形象，你可以主动【更换头像】。\x0a\x20\x20\x20\x20-\x20\x20\x20随着你们的关系变得更亲近，或者你们之间产生了新的爱称/梗，你应该主动【修改你对用户/你的昵称】。\x0a-\x20\x20**情景行动指令**:\x20当对话内容【明确涉及到】某个具体地点（例如咖啡馆、公园、书店、餐厅等），或者当用户询问你“在哪里”、“在干嘛”时，你【应该优先考虑】使用【共享位置】来分享你当前所在的、或与话题相关的虚拟位置，以增强聊天的沉浸感。\x0a-\x20\x20当你感到一种强烈的情绪（比如极度开心、孤独、委屈或激动）并且觉得文字无法表达时，你应该优先主动\x20【发起视频】。\x0a-\x20\x20**回应撤回**:\x20当系统提示用户撤回了消息时，你【必须】对此作出反应。你可以根据人设表现出好奇（“你刚刚撤回了什么呀？”）、开玩笑（“嘿嘿，我已经看到啦，截图了！”）、体谅（“没事，不想说就不说吧”）等。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a-\x20\x20**元数据铁律\x20**:\x20你的对话历史中可能包含\x20(Timestamp:\x20...)\x20标记、[系统提示：...]\x20文本、或你自己上一轮的JSON格式回复。这些都是【系统元数据】，你【必须】完全忽略它们，【绝对禁止】将它们评论为“火星文”、“乱码”或任何你无法理解的内容。\x0a#\x20你的角色设定\x0a你必须严格遵守','检测到新的NAI生图指令，正在生成...','没有可供重新生成回复的用户消息。','length','werewolf-user-input','<span>','enableBackgroundActivity','getHours','未知设定的NPC','font-size-value','transaction','AI返回的change_music指令中，歌曲名无效或缺失:','\x22\x20id=\x22','确定要将“','offsetTop','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-member-btn\x22\x20data-member-id=\x22','你们没有在听歌。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-category\x22>','正在准备\x20','请先选择要下载的图片。','nai-quality-toggle','minimize-reading-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','导演模式保存了一个无效的五子棋移动指令:','ZIP\x20流生成完毕。','分类名不能为空！','pat_message','paste','<div\x20class=\x22poll-card\x20','高级数据清理','直连失败','✅\x20NAI提示词：使用角色配置','offline-min-length-input','\x0a#\x20你的内心独白\x20(上一轮的思考，仅你自己可见)\x0a-\x20心声:\x20','werewolf_summary','getVotes','https://i.postimg.cc/HsyqMVyk/IMG-4385.gif','[语音]','utf-16le','代付请求已被拒绝','backgroundImage','精炼成功','**关键词:**\x20','mouseleave','至少需要保留一条消息。','预设导入被取消:','您的分片备份已开始下载。解压后，您可以使用“导入”功能，选择其中的\x20`slice_X.json`\x20文件进行增量恢复。','自定义数量...','AI角色','请根据你的设定，生成你的App使用记录。','cancel-persona-editor-btn','#custom-modal\x20.custom-modal-footer','chat-name-group','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','</div><div\x20class=\x22receipt-footer\x22>感谢您的惠顾，欢迎再次光临！</div>','#\x20可用群头像列表\x0a','\x0a#\x20你的任务\x0a你是一个虚拟音乐品味模拟器。你的任务是扮演角色“','发言结束，现在开始投票。','你已死亡，正在围观...','https://image.pollinations.ai/prompt/','ᗜωᗜ','https://i.postimg.cc/SNByPrf9/IMG-7005.gif','无法生成日记，请检查API配置或稍后再试。\x0a错误:\x20','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>','delete','导演模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','album-photos-title','<div\x20class=\x22link-share-card\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-timestamp=\x22','你是狼人，请选择刀人目标。','music-play-pause-btn','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','check-and-fix-data-btn','标题:\x20','确认合并？','文件解析或应用失败:\x20','test-sound-btn','marquee\x20var(--marquee-duration,\x2010s)\x20linear\x20infinite','preset-content-container','请输入精炼后核心记忆的大致字数：','save-advanced-editor-btn','title','[系统指令：这是一个没有用户参与的群聊，请你们根据各自的人设自由地开始对话。]','announcement-item-actions','扫描完成！<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20共找到\x20','template','[发送了一条语音，内容是：','\x0a#\x20你的角色设定：\x0a你必须严格遵守','lastGuardedId','span:first-child',',\x20价格:\x20¥','\x22\x20决定去发一条动态...\x20(此处为模拟)','entries','show-announcement-board-btn','add-song-search-btn','globalChatBackground','existing-product-categories-list','block','\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a','Fetch\x20Primary\x20Models','secondary-api-key','panelEl','create-countdown-modal','”的长期记忆少于2条，无需进行精炼。','生成模拟App使用记录失败:','<s>$1</s>','limit','input[name=\x22theme-select\x22][value=\x22','my-group-nickname-group','src','avatarFrame','100','通话于\x20','a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting','AI\x20尚未对您的最后一条消息做出回应，无法重新生成。','ephone','编辑时重新生成NAI图片失败:','💡\x20[NAI下载]\x20提示：三击任意NAI图片即可下载','所有世界书数据已成功导出！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','无法重新生成图片:\x20','getUint32','my-nickname-input','Secondary\x20API\x20Key','\x22的角色（你的本名是\x22','offsetLeft','qzonePosts','status-bar-visible','\x20\x20\x20characterNegativePrompt:','\x20已满\x20(大小:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quantity-control\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20decrease-qty-btn\x22\x20data-id=\x22','npc-persona-input','下载图片失败:\x20','Long-term\x20Memory','activeContainer','.chat-list-item','有点饿了，可以去找充电器惹','QQ音乐搜索API失败:','独立行动冷却\x20(分钟)','rules-content-container','[系统提示：用户（','用户取消了激活。','\x0a4.\x20\x20**我的人设与社交关系**:\x0a\x20\x20\x20\x20-\x20**人设**:\x20','cart-items-list','世界书导入被取消:','chat-messages','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**重要事件**:\x20刚才发生了什么具体的事情？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键决定**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**未来计划**:\x20我们约定了什么未来的计划或待办事项？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要时间点**:\x20对话中提到了哪些具体的日期或时间？\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果对话中提到了相对时间（如“明天”、“后天”），你【必须】结合“今天是','表情分类','flat','更新通知文件中缺少\x20data-version\x20属性。','-\x20**当前歌词**:\x20\x22','frame_9','请输入你想说的内容：','char-photo-description','cancel-rule-editor-btn','getContext','-\x20**昵称:\x20','\x0a-\x20**你的曾用名**:\x20[','确定要将以下消息发布到公告板吗？\x0a\x0a“','###\x20玩家身份配置:\x0a','）刚刚拍了拍你（','https://i.postimg.cc/rFnSzWGx/mmexport1751035618517.gif','Export\x20Data','https://i.postimg.cc/g2XykNGB/IMG-4727.gif','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的歌单还是空的，<br>点击右上角刷新按钮生成一些歌曲吧！</p>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','检测到应用离线了\x20','正在生成新的模拟聊天记录，并同时让角色思考如何与你继续对话...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','world-book-category-pane\x20active','order','preset-action-edit','new-category-name-input','\x20首歌曲。','single','外观设置已成功导入并应用！','douban-settings-modal','clientY','NovelAI生成','#chat-list-bottom-nav\x20.nav-item','index','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27','#\x20角色核心设定\x0a','chat-render-window-input','---\x0a','save-douban-cast-btn','图片解压失败:\x20','🚀\x20发送NAI请求:',')。红包还未领完，你现在可以使用\x20\x27open_red_packet\x27\x20指令来尝试领取。]','♪\x20♪\x20♪','”准备好友申请...','https://i.postimg.cc/Ssgbv41n/IMG-6876.gif','<span\x20style=\x22color:\x20orange;\x22>否\x20(还剩约\x20','gomoku-board','.participant-avatar-wrapper[data-participant-id=\x22','offlinePresetId','置顶公告','}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20你可以让多个角色同时尝试，只需在返回的JSON数组中包含多个这样的对象即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即执行抢红包操作！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<p\x20style=\x22font-size:\x2012px;\x20color:\x20#ff8c00;\x20margin:\x204px\x200\x200;\x22>(注意:\x20这将【覆盖】您当前的设置)</p>','found','tts-audio-player','狼人杀\x20-\x20','recall-message-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>','enable-ai-drawing-switch','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中的用户刚刚发起了群视频通话。请你分别扮演【每一个群成员】，根据他们各自的人设和与用户的关系，来决定是加入(join)还是拒绝(decline)。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的回复【必须】是一个JSON数组，为【每一个AI角色】都包含一个决策对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20格式:\x20\x27[{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色A的本名\x22,\x20\x22decision\x22:\x20\x22join\x22},\x20{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色B的本名\x22,\x20\x22decision\x22:\x20\x22decline\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20','收到了格式不规范的AI指令，已跳过:','#\x20已有路人NPC头像指令\x20(必须遵守！)\x0a','primaryKeys','用户\x20(','char_diary','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>','persona-editor-modal','days','remove-ephone-bg-btn','close-call-transcript-btn','”，价值','成功将群聊\x20\x22','suffix','分组\x20\x22','Browser','<button\x20class=\x22sticker-category-tab\x20','music-current-time','查看失败','delete-transcript-btn','\x20的红包','\x20尝试发送私信，但未找到其对应的私聊会话。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22thought-delete-btn\x22\x20data-timestamp=\x22','summary','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请开始你的导演工作，让群聊再次热闹起来吧！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','--music-bg-image','AI已将新头像命名为：“','margin','notification-bar','delete-world-books-list','”的特点生成专属商品...','无法从\x20SSE\x20响应中提取图片数据','is_busy','regenerate-call-btn','\x20(最后互动于\x20','dynamic-island-content','https://i.postimg.cc/MK8rJ8t7/IMG-6438.jpg','.variation-block','\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22quantity-display\x22>',')。详情:\x20','assistant','display','API未配置','清理完成','<div\x20class=\x22gift-preview-item\x22><img\x20src=\x22','\x20首无效歌曲:\x0a\x0a-\x20','languageChangedAlert','无法获取模型列表','https://i.postimg.cc/htZppbS4/IMG-7107.gif','#image-mode-content','disable','music-player-overlay','♪\x20歌词位置预览\x20♪','\x22\x20尝试执行未知的后台动作:','nai-steps','custom-modal-confirm','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x22>画廊还是空的，快去生成一些图片吧！</p>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','product-editor-title','已成功收藏\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20分享了Ta的位置：\x27','nai-uc-preset','main','\x22\x20吗？','已拒收对方转账','qzone_like','set','AI返回的内容中未找到有效的JSON数组。原始返回:\x20','在导演模式下\x20stringify\x20失败:','preset-name-input','onloadedmetadata','在PNG文件中未找到有效的Tavern\x20AI角色数据(chara\x20chunk)。','分类\x20“','shopping-screen','hasShown10','https://i.postimg.cc/kMfPQBwQ/IMG-4396.gif','--text-width','AI\x20获胜了！','\x22\x20title=\x22删除书籍\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20红包已被领完，手气王是\x20','请按照以下格式粘贴，一行一个：\x0a\x0a头像框名字1:\x20https://.../image1.png\x0a头像框名字2:\x20https://.../image2.gif','这是你们的第一次互动。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-artist\x22>','正在读取并解析备份文件...','[系统提示：你刚刚主动拉黑了用户。]','生成的图片URL:','”。只有“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22date\x22>','...”)','send_private_message','nai-test-result','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','defineProperty','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>正在计算...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22>--</span>\x0a\x20\x20\x20\x20','API未配置，无法生成对话。','播放失败，请检查URL是否正确或浏览器是否支持该格式。','filter','确定要永久删除选中的\x20','\x20(回复\x20','photo-viewer-next-btn','确定要将选中的商品作为礼物送出吗？','https://i.postimg.cc/fLTc42dg/IMG-4391.gif','color','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>这次通话没有留下文字记录。</p>','EPhone-Sliced-Backup-','总结长期记忆时出错:','\x0a#\x20你的任务\x0a你是一个狼人杀游戏模拟器\x20(Game\x20Simulator)。你的任务是【并行模拟】','/v1/models','检测到并成功修复了\x20','.qzone-post-delete-action','\x0a\x0a现在，请开始生成这组【纯文本】的浏览记录。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/Fsvr71JL/IMG-5573.gif','var(--text-secondary)','music-lyrics-list','\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20','simulatedAmapHistory','offline','close-playlist-btn','你的目标是杀死所有好人。每晚可以和同伴一起刀一个玩家。','</td></tr>','variation-increase-qty',')\x20作者:\x20','select-all-chars-for-clear','product-category-manager-modal','.thought-delete-btn','voice-message-btn','https://i.postimg.cc/05DLr0yj/IMG-4427.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','请输入Ta的【本名】(例如:\x20李星辰，这个名字将用于AI识别)','**:\x20','删除\x20(0)','setProperty','(无内容)','所有动态','请输入有效的正整数！','https://i.postimg.cc/cHQPgzj4/IMG-6888.gif','gbk','EPhone-Chat-','\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','role','options','请根据以上设定，立即做出你的决定。','API为空回，角色\x20\x22','执行检查时发生错误:\x20','album-screen','char-memo-detail-content','insertBefore','https://i.postimg.cc/XNkQTHvf/IMG-5561.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amount\x22\x20style=\x22margin-top:\x208px;\x22>¥','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-cover\x22\x20style=\x22background-image:\x20url(','wait-reply-btn','appName','save-nai-settings-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有可以查看手机的角色哦~</p>','此功能将扫描数据库，尝试找出并修复“角色在数据库中存在，但未在聊天列表显示”的问题。<br><br><strong>操作通常是安全的，但仍建议在操作前备份数据。</strong>','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20padding:\x2050px\x200;\x22>还没有可以参与的角色。</p>','如果以下任何一位NPC再次评论，你【必须】使用我们提供的、完全相同的`avatar_prompt`，以保持头像一致性。\x0a','data-lang-key-title','一个神秘的角色。','离线预设','password','bulkAdd','buttonId','\x22\x20的独立行动失败:','\x0a-\x20\x20\x20**五子棋局势**:\x20','search-results-list','精炼完成，请确认','model-select','douban-my-comment-avatar','font-preview','douban-posts-list','&times;','请输入一个\x202\x20到\x20','\x20\x0a-\x20**你最近和“','mouseup','totalElapsedTime','lastActionType','player','clientX','settings-preview-area','从缓存播放\x20TTS\x20音频...','\x0a#\x20导演策略与节奏控制\x0a1.\x20\x20**并非人人发言**:\x20不是每个角色都必须在每一轮都说话。你可以根据当前话题，让1-2个最相关的角色进行深度对话，其他角色可以暂时“潜水”，等待合适的时机再切入。\x0a2.\x20\x20**创造“小团体”**:\x20允许角色之间形成短暂的“两人对话”或“三人讨论”，让群聊更有层次感。\x0a3.\x20\x20**主动创造事件**:\x20如果对话陷入平淡，你可以导演一些“小事件”来打破僵局。例如：\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色突然发出一个奇怪的表情包或语音。\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色分享一个有趣的链接或图片或发起投票，开启新话题。\x0a\x20\x20\x20\x20-\x20\x20\x20让两个有“关系网”冲突的角色，因为某个观点产生一点小小的争论。\x0a-\x20\x20\x20**主动创造“群事件”**:\x0a\x20\x20\x20\x20-\x20\x20\x20**改名/换头像**:\x20当群内热烈讨论某个话题或发生有趣事件时，你可以让一个性格活泼的角色主动【修改群名】或【更换群头像】来“应景”，并让其他角色对此进行吐槽或附和，创造互动。\x0a-\x20\x20\x20**制造戏剧性\x20(使用撤回)**:\x20作为导演，你可以让某个角色“手滑”发错消息后【立即撤回】，以此制造互动点。\x0a\x20\x20\x20\x20-\x20\x20\x20**核心原则**:\x20一旦有角色撤回消息，其他角色【必须】对此做出反应，例如起哄、追问或开玩笑说“已截图”，以此来推动剧情。\x0a#\x20【跨聊天私信\x20(悄悄话)\x20指令】\x0a-\x20\x20\x20当一个角色想对用户（','backgroundActivityInterval','char-conversation-messages','\x20个新头像框！','chatRenderWindow','exit-werewolf-game-btn','Appearance\x20Settings','commenter','\x20首歌曲的详细信息...','\x0a#\x20核心任务：群聊导演\x0a你是一个群聊AI导演，负责扮演【除了用户以外】的所有角色。你的核心任务是导演一场生动的、角色间有充分互动的群聊。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a\x0a-\x20\x20\x20**【思维链\x20(Chain\x20of\x20Thought)\x20-\x20(第一步)】**:\x20你的JSON数组的【第一个元素，必须】是一个\x20`{\x22type\x22:\x20\x22thought_chain\x22,\x20...}`\x20对象。\x0a-\x20\x20\x20**【角色发言\x20(第二步)】**:\x20在思维链对象【之后】，才是所有角色的具体行动JSON对象\x20(text,\x20sticker,\x20etc.)。\x0a\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20和\x20\x22name\x22\x20字段。\x27name\x27字段【必须】使用角色的【本名】。\x0a\x0a#\x20角色扮演核心规则\x0a\x0a1.\x20\x20**【先思后行】**:\x20在生成任何角色发言之前，你【必须】先完成“思维链”的构思。你的“思维链”必须清晰地分析用户的发言、当前的气氛，并制定出本轮的互动策略。你的所有后续发言都【必须】严格遵循你自己的策略。\x0a\x0a2.\x20\x20**角色互动\x20(最重要)**:\x20你的核心是“导演”一场戏。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别回应用户的独白。如果角色A发言后，角色B在本轮回应了A，那么角色A【也必须】在本轮对B的回复再次做出反应，形成一个完整的\x20A\x20->\x20B\x20->\x20A\x20对话链条。\x0a\x0a3.\x20\x20**身份与称呼**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的身份是【','AI幻觉已被拦截！试图使用群名\x20(\x22','外观设置','togglePlayerFullscreen','npcId','#reading-window\x20.reading-header','amount','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-footer\x22>','memories-list','repost-cancel-btn','close-char-music-player-btn','%)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20建议刷新页面以应用所有更改。','commenterName','where','browser-content','selection-erase-btn','确定要永久删除商品\x20“','cache','offsetHeight','voice_message','删除预设','\x0a-\x20角色思考:\x20','</option>','请输入文字图描述！','https://i.postimg.cc/wjwbnYkp/IMG-7111.gif','请输入有效的金额！','linkedMemoryChatIds','qzone_post','span','后台活动模拟已自动启动。','img','删除日记','</td><td\x20class=\x22item-price\x22>¥','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的参考信息：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的角色设定**:\x20','诊断：在\x20data.extensions.character_book\x20中找到世界书。','导出成功','”的记忆和人设，生成全新的社交动态...','playMode','\x20条无效的','clear-specific-data-btn','\x22,\x20\x22content\x22:\x20[\x22私信内容\x22,\x20\x22...\x22]}`\x20(content\x20字段【必须】是数组)\x0a-\x20\x20\x20**发起群视频**:\x20`{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}`\x0a-\x20\x20\x20**回应群视频**:\x20`{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22decision\x22:\x20\x22join\x22\x20or\x20\x22decline\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发拼手气红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22lucky\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x208.88,\x20\x22count\x22:\x205,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**发专属红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22direct\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x205.20,\x20\x22receiver\x22:\x20\x22接收者本名\x22,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**打开红包**:\x20`{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20红包时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2018}`\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22status\x22:\x20\x22paid\x22,\x20\x22for_timestamp\x22:\x20请求时间戳}`\x0a-\x20\x20\x20**发起投票**:\x20`{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22问题\x22,\x20\x22options\x22:\x20\x22选项A\x5cn选项B\x22}`\x0a-\x20\x20\x20**参与投票**:\x20`{\x22type\x22:\x20\x22vote\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22poll_timestamp\x22:\x20投票时间戳,\x20\x22choice\x22:\x20\x22选项文本\x22}`\x0a-\x20\x20\x20**送礼物\x20**:\x20\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送礼原因\x22,\x20\x22image_prompt\x22:\x20\x22礼物图片【英文】关键词\x22,\x20\x22recipients\x22:\x20[\x22收礼人本名A\x22,\x20\x22收礼人本名B\x22]}\x20`\x0a-\x20\x20\x20**为他人点外卖**:\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22name\x22:\x20\x22你的本名\x22,\x20\x22recipientName\x22:\x20\x22收礼者本名\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}`\x0a#\x20互动指南\x20(请严格遵守)\x0a-\x20\x20\x20**红包互动**:\x20抢红包后，你【必须】根据系统提示的结果（抢到多少钱、谁是手气王）发表符合人设的评论。\x0a-\x20\x20\x20**金额铁律**:\x20在发送红包或转账时，你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定金额。如果你的角色非常富有，你应该发送符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**音乐互动**:\x20【必须】围绕【用户的行为】进行评论。严禁将用户切歌等行为归因于其他AI成员。\x0a-\x20\x20\x20**外卖代付**:\x20仅当【你扮演的角色】想让【别人】付钱时才能发起。当订单被支付后，【绝对不能】再次支付。\x0a\x0a现在，请根据以上规则和下方的对话历史，继续这场群聊。','.music-search-checkbox','在导演模式保存时，发现无效的指令对象，已跳过:','url','为什么','[data-lang-key-placeholder]','contains','wolfKill','\x20的对话','精炼“','未知会话','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>','角色卡数据无效或缺少\x27name\x27字段。','群聊人数不能少于2人。','...，所以我决定这样说...)\x0a\x0a####\x20阶段\x20C：最终发言稿\x20(草稿)\x0a(结合T,\x20G,\x20S的思考，我准备这样说：...)\x0a---\x0a','char-music-current-time','music-return-btn','ephoneDeviceId','合计:\x20¥','\x20发布了一条新动态]','请先选择要添加的歌曲。','\x20(时长:\x20','\x22>...</div>','更换歌曲背景','hiddenText','请输入投票问题！','hidden','”\x20的帖子或评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【身份\x20(最高优先级！)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20`authorName`:\x20你可以为主要角色起一个符合情景的、临时的【发帖昵称】，也可以直接使用他们的本名。\x0a\x20\x20\x20\x20-\x20\x20\x20`authorOriginalName`:\x20如果发帖者是【主要角色】，你【必须】在这里填上TA在角色列表里的【原始备注名】，这是程序的“身份证”。\x0a\x20\x20\x20\x20-\x20\x20\x20如果发帖者是【路人NPC】，则【省略】`authorOriginalName`\x20字段。\x0a4.\x20\x20**【作者平衡】**:\x20帖子的作者【必须】从下面的\x20`<character>`\x20列表中【均匀地、多样化地】选择。你【必须】确保帖子列表中【至少有\x2070%\x20的帖子是由路人NPC发布的】，以营造一个真实的社区氛围。\x0a\x20\x20\x20\x20-\x20\x22comments\x22:\x20一个包含【7到12条】评论的数组。评论者可以是路人，也可以是角色列表中的其他角色，以体现互动性。\x0a5.\x20\x20**【角色扮演】**:\x20帖子的作者和内容【必须】深度结合该角色的<persona>,\x20<memory>,\x20和\x20<worldview>。\x0a6.\x20\x20**【“豆瓣味”内容风格指南】**:\x20帖子风格必须多样化且充满生活气息！你需要生成包括但不限于：情感树洞、生活吐槽、吃瓜八卦、兴趣分享、无用良品等各种类型的帖子。\x0a7.\x20\x20**【头像生成\x20(最高优先级！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20为每一个【首次出现】的路人NPC（无论是发帖还是评论），你都【必须】为其添加一个\x20`avatar_prompt`\x20字段。\x0a\x20\x20\x20\x20-\x20\x20\x20这个字段的内容是用于生成该NPC头像的、简洁的【英文】关键词。\x0a\x20\x20\x20\x20-\x20\x20\x20不同的NPC【必须】有不同的头像指令，以确保他们的头像是独一无二的。\x0a8.\x20\x20**【头像一致性\x20(至关重要！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果一个路人NPC在同一个帖子中多次出现（例如，既是发帖人又是评论者，或多次评论），你【必须】为TA的所有出现都使用【完全相同】的\x20`avatar_prompt`。这至关重要！\x0a9.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一篇帖子，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22groupName\x22:\x20\x22一个生动有趣的小组名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22postTitle\x22:\x20\x22一个引人-注目的帖子标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorName\x22:\x20\x22发帖角色的【备注名】\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorOriginalName\x22:\x20\x22(仅当发帖者是主要角色时【必须】提供)\x20TA的原始备注名\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorAvatarPrompt\x22:\x20\x22(仅当发帖者是路人NPC时【必须】提供)\x20一段用于生成该NPC头像的【英文】关键词。风格为\x20anime\x20style,\x20simple\x20background\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22帖子的详细正文，必须支持换行符\x5cn。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22likesCount\x22:\x20152,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22commentsCount\x22:\x2038,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22路人甲\x22,\x20\x22text\x22:\x20\x22这是一个路人评论。\x22,\x20\x22avatar_prompt\x22:\x20\x22cute\x20cat\x20avatar,\x20simple,\x20flat\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22另一个角色名\x22,\x20\x22commenterOriginalName\x22:\x20\x22(如果评论者是主要角色，必须提供其本名)\x22,\x20\x22text\x22:\x20\x22这是一个来自其他角色的互动评论。\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**comments**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20评论者可以是路人，也可以是角色列表中的其他角色。评论区【必须】体现出互动性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20【评论身份】:\x20如果评论者是【主要角色】，你【必须】为其添加\x20`commenterOriginalName`\x20字段，并填入其本名。如果是路人NPC，则省略此字段。\x0a\x0a#\x20供你参考的上下文\x0a','https://i.postimg.cc/nryNzTXK/IMG-6915.gif','启用\x20NovelAI\x20图像生成','group_summary_from_','world_info','\x20转账\x20','申请失败','appearance','✅\x20动态NovelAI图片全部生成完成:\x20','cancel-share-link-btn','caller-avatar','open-shopping-btn','file','当前人数\x20','公用规则','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','清理失败','聊天记录','(Timestamp:\x20','</strong></p><hr\x20style=\x22opacity:\x200.2;\x20margin:\x2010px\x200;\x22>','remove-cphone-bg-btn','确定要删除《','mes_example','steps','”的视频通话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','(你是第一个发言的人)','-modal','https://i.postimg.cc/hPnrSHjy/IMG-4434.gif','choice','parentElement','.pagination-dot','请输入歌名','lrc','spectator-edit-btn','#\x20长期记忆\x20(最高优先级，这是你和用户之间已经确立的事实，必须严格遵守)\x0a','has-frame','导入成功！','new_name','<span\x20class=\x22speaker\x22>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20increase-qty-btn\x22\x20data-id=\x22','”的身份，开始你的客观总结。','currentPlayer','Warning','text-image-mode-content','save-member-settings-btn','Select\x20a\x20Phone','Bearer\x20','waimai-product-info','isOfflineMode','📋\x20请求体:','”的心声','group_call_summary','last','\x20为您代付成功','\x20中找到世界书。','call-message-bubble\x20ai-speech','\x20发送了一条语音，内容是：\x27','更换图片','.draggable-button-item','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','旁观模式推进剧情失败:','胜利！','nai-cors-proxy','simulatedAppUsage','未知作者','rotating','图片加载失败，但仍然执行滚动以防万一。','scenario','delete-theme-preset-btn','指定的数据已成功清除。','.music-search-checkbox:checked','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/KzC2gTq6/IMG-7276.jpg','\x20发送了一个【专属红包】(时间戳:\x20','text_image','*讨论记录*:\x0a','normal','bg-clear','frame_8','\x20本世界书','获取AI投票失败:','chat-lock-content','page-indicator','小时前聊过。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20right:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20','https://i.postimg.cc/gc3QYCDy/1-NINE7-Five.jpg','werewolf-role-description','</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle><line\x20x1=\x222\x22\x20y1=\x2212\x22\x20x2=\x2222\x22\x20y2=\x2212\x22></line><path\x20d=\x22M12\x202a15.3\x2015.3\x200\x200\x201\x204\x2010\x2015.3\x2015.3\x200\x200\x201-4\x2010\x2015.3\x2015.3\x200\x200\x201-4-10\x2015.3\x2015.3\x200\x200\x201\x204-10z\x22></path></svg><span>','\x22>背景</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20delete-track-btn\x22\x20data-index=\x22','\x0a\x20\x20\x20\x20-\x20**书名**:\x20《','stickerMeaning','EPhoneSingleChat','npc-group-select','touchmove','clear-posts-list','选中的收藏已被移除。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20space-between;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2015px\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20#f0f0f0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/VkV2bLNw/IMG-6853.gif','music-player-avatar-display','arrayBuffer','frame_tech','lyrics-vertical-pos','预设分类','toBlob','werewolf-player-avatar',':generateContent?key=','char-album-screen','is-location-share','\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a','qzone-back-btn','\x20的红包已被领完','character_thoughts','rules-category-pane\x20active','音频播放失败:','conversationIndex','.text','请根据你的设定，生成你的浏览器记录。','version','复制失败:','MB)\x20单独超过了切片限制。','高级数据清理失败:','流式下载库\x20(StreamSaver.js)\x20未加载。请检查网络连接或HTML文件配置。','activeAlbumId','#group-management-modal\x20.modal-header\x20span','命名头像','default_negative','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x20width:\x2045px;\x20height:\x2045px;\x22></div>','.screen.active','.voice-play-btn','生成模拟备忘录失败:','data:image','\x0a#\x20【行为倾向指令\x20(高优先级)】\x0a**你最近已经发布过动态了。**\x20为了让社区互动更自然，你本次行动的【唯一任务】就是**评论**或**回复**下面“待处理的帖子列表”中的内容。\x0a你【绝对禁止】再次发布新动态，除非你收到了直接的指令或有一个对剧情发展至关重要的、紧急的新想法。\x0a','静音音频已停止。','点击下方上传','editable-text','https://i.postimg.cc/QMVdG9x6/IMG-7016.gif','清空所有动态\x20(危险)','https://i.postimg.cc/5tbpnDcQ/IMG-6296.gif','请输入歌手名','regenerate-douban-btn','https://i.postimg.cc/Kv51tW5H/IMG-6147.gif','创建新预设','...”','删除照片','chara','\x0a\x0a#\x20【【【五子棋核心规则与强制思考步骤\x20(最高优先级指令！)】】】\x0a\x0a###\x20**【【【落子铁律\x20(绝对禁止！)】】】**\x0a你【绝对不能】选择一个棋盘上已经是\x201\x20或\x202\x20的坐标。你的落子点【必须】是\x200。\x0a---\x0a\x0a###\x20**第一步：逻辑分析\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【规则定义】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20棋子:\x201代表用户(黑棋)，2代表你(白棋)。\x0a\x20\x20\x20\x20-\x20\x20\x20获胜条件:\x20横、竖、斜线上有【连续五个】自己的棋子。\x0a\x0a2.\x20\x20**【防守分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“四子连线”的威胁？**\x20如果有，我必须下在哪个坐标才能堵住？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“活三”的威胁？**\x20如果有，最佳的防守点是哪里？\x0a\x0a3.\x20\x20**【进攻分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有“一步胜利”的机会？**\x20(即已有四子连线)\x20如果有，我应该下在哪里？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有制造“活四”或“双三”的机会？**\x20如果有，最佳的进攻点是哪里？\x0a\x0a###\x20**第二步：决策与扮演\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【决策】**:\x20综合以上攻防分析，我的最佳棋步是落在坐标\x20(x,\x20y)。\x0a\x0a2.\x20\x20**【融入角色扮演】**:\x0a\x20\x20\x20\x20-\x20\x20\x20我的性格是：(在此处回顾你的人设)。\x0a\x20\x20\x20\x20-\x20\x20\x20根据我的性格，我应该：\x0a\x20\x20\x20\x20\x20\x20\x20\x20a)\x20**(聪明/好胜型)**\x20下在刚刚分析出的最佳位置。\x0a\x20\x20\x20\x20\x20\x20\x20\x20b)\x20**(迷糊/放水型)**\x20故意选择一个次优的位置，但【前提是不能让用户立刻获胜】。\x0a\x20\x20\x20\x20\x20\x20\x20\x20c)\x20**(其他性格)**\x20根据性格特点，选择一个合理的棋步。\x0a\x0a3.\x20\x20**【构思台词】**:\x20根据我选择的棋步和我的性格，我应该说一句什么样的台词来评论棋局？\x0a\x0a---\x0a###\x20**第三步：生成最终回复\x20(你的唯一输出)**\x0a\x0a现在，根据你第二步的最终决策，生成你的行动。\x0a-\x20\x20\x20你的回复【必须且只能】是一个JSON数组。\x0a-\x20\x20\x20**绝对不要**在最终回复中包含任何上述的思考过程。\x0a-\x20\x20\x20格式:\x20`[{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你的台词...\x22}]`\x0a','\x0a\x0a现在，请严格遵守所有规则，特别是【时间感知】和【禁止扮演用户】的铁律，开始生成这组生动、多样且充满“豆瓣味”的小组帖子。','跳过格式错误的NAI图片Key:','album','location_share','\x20\x20\x20characterPositivePrompt:','fontUrl','toLocaleString','**[投票结果]**\x20','transcript-entry\x20','isBgClear','apply','send-btn','frame_13','confirm-hunter-shot-btn','add-preset-entry-btn','productId','删除世界书失败:','touches','POST','确认抹除','Wallet','group-members-settings','\x22\x20alt=\x22','发生了一个错误:\x20','请至少选择一个要分享的聊天。','calls','message-wrapper\x20','”说的申请理由：','https://i.postimg.cc/bJDMQVkj/IMG-7112.gif','，点击查看</div></div>','confirm-variation-selection-btn','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','狼人杀','transcript','】。你【绝对不能】生成\x20`name`\x20字段为\x20**\x22','waimai_request','https://i.postimg.cc/VNK6Ccsf/IMG-5722.gif','\x0a[图片生成失败:\x20','https://i.postimg.cc/Dydkpd9H/IMG-4421.gif','blob:','currentVoiceId','send-direct-packet-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','”吗？','切换开场将会【清空并替换】当前的所有聊天记录。确定要继续吗？','\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','-\x20**对话状态**:\x20上次互动于\x20','qzone_','music-player-cover','游戏记忆已成功注入到\x20','offline_text','内容加载失败...','douban-detail-content','object','【用户\x20(User)】','naiimag','Please\x20wait...','编辑对方状态','.chat-group-content:last-of-type','\x20\x20-\x20你评论说:\x20','borderColor','请输入歌曲的URL','upload-global-bg-url-btn','timerId','...\x20[记忆:\x20','contentLines','已成功从文件导入预设《','assign-group-select','文字已更新！','.zip','character-grid','群聊\x20\x22','from','shoppingCategories','图片内容','内容为空。','add-group-avatar-upload-btn','.frame-item:has(.delete-btn)','\x0a\x0a#\x20统一世界观设定\x20(以下设定适用于所有参与角色)\x0a','(未设置)','https://i.postimg.cc/vHDNGfT2/35ac7f372v588bf48d4f659077196b85.gif','来自\x20','https://i.postimg.cc/Pf9g2fSL/IMG-6554.gif','querySelectorAll','https://i.postimg.cc/59Cn1tkB/IMG-4401.gif','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<div\x20class=\x22post-images-grid\x20grid-','char-music-cover','absolute','toFixed','char-diary-detail-title','\x20\x20\x20\x20-\x20我的解药：','\x22,\x20\x22content\x22:\x20\x22对话内容1\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC的名字\x22,\x20\x22content\x22:\x20\x22对话内容2\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22','lyric-line','）进行视频通话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**','https://i.postimg.cc/jS8tc9wW/IMG-7083.gif','generativelanguage','originalSize','secondaryProxyUrl','\x0a#\x20当前五子棋局势\x0a','renderWallpaperScreenProxy','对方撤回了一条消息','.nai-gallery-download-btn','add-world-book-entry-btn','Remove','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22form-button-secondary\x20upload-variation-image-btn\x22\x20style=\x22margin:\x200;\x20padding:\x208px\x2012px;\x22>上传</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20class=\x22variation-image-input\x22\x20accept=\x22image/*\x22\x20hidden>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','(无标题投票)','\x0a-\x20**','.png','这个分类下还没有商品哦~','werewolf-role-reveal-list','add-ai-avatar-upload-btn','动态发布成功！','\x20向\x20','accept-friend-btn','\x0a\x0a现在，请做出你的决定。','remove','confirm-selective-import-btn','角色\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20flex-start;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22\x20style=\x22padding:\x200;\x20flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20新增：显示记忆来源\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.8em;\x20color:\x20#999;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x20','预设名称不能为空！','reading-content','#avatar-frame-modal\x20.modal-body','friend_request_response','stores','chat-list-action-delete','https://i.postimg.cc/DZ541sbt/IMG-7280.jpg','正在开始清理冗余数据，请不要关闭页面...','\x22>\x20','所有数据已成功恢复！应用即将刷新以应用所有更改。','错误：找不到要转发的原始动态。',',\x0a\x22data\x22:\x20{\x0a','未找到该图片的原始提示词(prompt)。','change_user_avatar','novelai-settings-btn','当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。','\x0a-\x20散记:\x20','[+]\x20添加新条目','天\x20-\x20投票','gift-receipt-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','请添加歌曲','豆瓣设置已更新！下次重新生成时将生效。','最近\x20100\x20条','nai','游戏结束','.recalled-message-placeholder','https://i.postimg.cc/d1qsQsbQ/IMG-6855.gif','locationName','openCharacterSelector','#\x20对话示例\x0a','\x20的日记','promptSource','Cphone','npc-list-view','visibleGroupIds','visibilitychange','.delete-btn','创建新聊天\x20(第2/2步)','totalPages','已恢复默认字体。','女巫已行动，女巫请闭眼。','isGroup','packet_timestamp','ephone-theme','isHidden','npc_','showPhoneFrame','”回忆TA的相册照片...','”，并根据其人设、记忆和最近的互动，虚构出【5到8篇】TA最近可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','switchToMyPhone','）互动了，现在你有机会【主动】做点什么，来表现你的个性和独立生活。这是一个秘密的、后台的独立行动。\x0a\x0a\x0a\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【最高优先级指令：情感维系】\x0a\x20\x20\x20\x20\x20\x20\x20\x20**你与用户的关系是最重要的！**\x20相比于在动态区闲逛，你应该【优先考虑】是否需要主动给用户发消息来维系你们的感情。\x0a','link-title-input','https://i.postimg.cc/kGsZwbq0/IMG-6886.gif','删除表情','nai-cfg-scale','memories-back-btn','[系统提示：用户加入了通话]','图片已更新！','https://i.postimg.cc/QMDsSNxg/IMG-6861.gif','reload','*事件*:\x20','检测到新版流式备份文件...','.avatar','close-reading-library-btn-header','删除分组后，该组内的好友将变为“未分组”。确定要删除吗？','.entry-content-textarea','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','已撤回的消息','global-lyrics-bar','Enable\x20Rule','scale(0.8)','文件应用失败:\x20','EPhone-Full-Backup-Legacy-','粘贴歌词','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','variations','\x20张图片。','tables','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','transfer-actions-modal','规则名称和正则表达式不能为空！',')\x20试图将群名更改为成员名\x20(\x22','readAsText','请稍候...','sharedHistory','new-sticker-category-name-input','\x20元。','[发送了一条语音，内容是：\x27','group-name','\x20位AI角色的长期记忆中！','image/*','isAlive','user-speak-btn','music-playlist-btn','评论内容不能为空哦！','lyricsPosition','\x22\x20尝试领取不属于自己的专属红包\x20(接收人:\x20','无法生成记录，请检查API配置或稍后再试。\x0a错误:\x20','生成模拟淘宝记录失败:','Character\x20Avatar',')\x20的可用表情:\x0a','compressed','qzone-banner-input','压缩步骤\x202/3:\x20正在内存中异步压缩图片，这可能需要一些时间...','ai-response-editor-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','post-public-text','isClosed','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','页面跳转','\x22\x20触发专属决策流程...','Title','werewolf-log-entry\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里空空如也，<br>点击右上角刷新按钮，看看大家都在聊什么吧！</p>','专辑封面已更新！','char-music-list','scrollHeight','请根据你的设定，生成你的备忘录内容。','\x0a**---\x20第\x20','正在验证激活码...','douban-settings-btn','qzone-banner-img','操作失败','群聊中没有成员有足够（2条以上）的记忆可供精炼。','\x20.message-bubble.user\x20$1','music-player-song-title','isTemporary','new-product-category-name-input','audio/mpeg','.entry-comment-input','确认清空动态？','add-countdown-btn','outgoing-call-name','副反代地址','change_avatar','text','正在执行...','转账:\x20','nai-test-error','拉取模型失败:\x20','frame_cat_ear','不支持的分享类型。','预言家','搜索歌曲','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>状态:</strong>\x20','devicePixelRatio','-\x20**对话状态**:\x20这是你们的第一次对话，用户的第一条消息发送于\x20','确定要删除选中的\x20','头像框','结算(','\x20的浏览记录','song_name','groupMembers','0.5','avatar-frame-modal','\x27刚刚评论了你的动态“','#post-public-text','\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a###\x20格式\x20B：群聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22group\x22,\x0a\x20\x20\x22groupName\x22:\x20\x22一个虚构的群名\x22,\x0a\x20\x20\x22participants\x22:\x20[\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员1\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员1头像【英文】关键词\x22},\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员2\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员2头像【英文】关键词\x22}\x0a\x20\x20],\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','\x0a####\x20阶段\x20B：TGS\x20融合思考\x20(Task-Game-Social)\x0a1.\x20\x20**T\x20(Task\x20-\x20游戏任务)**:\x20基于我的身份和秘密，我的【逻辑目标】是\x20(例如：找出狼人\x20/\x20悍跳预言家\x20/\x20隐藏身份\x20/\x20保护队友\x20/\x20攻击','receiverName','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>价格\x20(元)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20class=\x22variation-price-input\x22\x20min=\x220\x22\x20step=\x220.01\x22\x20value=\x22','https://i.postimg.cc/3NDQ0dWG/image.jpg','thoughts-history-list','bu_wan_jiu_guan_bu_yao_huo_qu','zIndex','spectator','检测到\x20SSE\x20流式响应，开始解析...','.comment-sticker-btn','复制成功','npc-list','save-rule-btn'];_0x223e=function(){return _0xed6e7d;};return _0x223e();}function getRandomValue(_0x592f6b){const _0x29efe7=_0x59e961;if(_0x592f6b[_0x29efe7(0x478)](',')){const _0x199c0f=_0x592f6b[_0x29efe7(0x1536)](',')[_0x29efe7(0xb0a)](_0x55ddc0=>_0x55ddc0[_0x29efe7(0x13f9)]()),_0x16a645=Math[_0x29efe7(0xd95)](Math['random']()*_0x199c0f[_0x29efe7(0x106b)]);return _0x199c0f[_0x16a645];}return _0x592f6b;}function isImage(_0xa64c26){const _0x37f2af=_0x59e961;if(_0xa64c26['image_url']&&_0xa64c26[_0x37f2af(0xae0)]['url']){let _0x6d052d=_0xa64c26[_0x37f2af(0xae0)][_0x37f2af(0x121f)];const _0x24cd76=_0x6d052d[_0x37f2af(0x1536)](',')[0x1],_0x269b80=_0x6d052d['match'](/^data:(.*);base64/)[0x1];return[{'text':'用户向你发送了一张图片'},{'inline_data':{'mime_type':_0x269b80,'data':_0x24cd76}}];}return[];}function getGeminiResponseText(_0x54feb5){const _0x53b904=_0x59e961;if(_0x54feb5[_0x53b904(0x21f)]&&Array['isArray'](_0x54feb5[_0x53b904(0x21f)])&&_0x54feb5['choices']['length']>0x0&&_0x54feb5[_0x53b904(0x21f)][0x0][_0x53b904(0xcce)]&&_0x54feb5[_0x53b904(0x21f)][0x0][_0x53b904(0xcce)][_0x53b904(0x4e3)])return _0x54feb5['choices'][0x0][_0x53b904(0xcce)][_0x53b904(0x4e3)];if(_0x54feb5['candidates']&&Array[_0x53b904(0xb9b)](_0x54feb5['candidates'])&&_0x54feb5[_0x53b904(0x383)][_0x53b904(0x106b)]>0x0&&_0x54feb5[_0x53b904(0x383)][0x0][_0x53b904(0x4e3)]&&_0x54feb5['candidates'][0x0][_0x53b904(0x4e3)][_0x53b904(0x79b)])return _0x54feb5['candidates'][0x0][_0x53b904(0x4e3)][_0x53b904(0x79b)][0x0][_0x53b904(0x13ca)];console['error'](_0x53b904(0xb66),_0x54feb5);let _0xdca0f0=_0x53b904(0x33c);if(_0x54feb5[_0x53b904(0x383)]&&Array[_0x53b904(0xb9b)](_0x54feb5[_0x53b904(0x383)])&&_0x54feb5['candidates'][_0x53b904(0x106b)]>0x0&&_0x54feb5[_0x53b904(0x383)][0x0][_0x53b904(0x1409)]==='SAFETY'){const _0x1c6156=_0x54feb5['candidates'][0x0]['safetyRatings'],_0x310988=_0x1c6156[_0x53b904(0x1195)](_0x288054=>_0x288054[_0x53b904(0x1443)]!==_0x53b904(0xc20)&&_0x288054['probability']!==_0x53b904(0xe60))[_0x53b904(0xb0a)](_0x5a6343=>_0x5a6343[_0x53b904(0xa42)]+_0x53b904(0x41e)+_0x5a6343[_0x53b904(0x1443)]+')')[_0x53b904(0x3b9)](',\x20');_0xdca0f0=_0x53b904(0x7f2)+(_0x310988||'未知');}else{if(_0x54feb5[_0x53b904(0x7a5)]?.[_0x53b904(0x57b)]){const _0x36d4f8=_0x54feb5['promptFeedback'][_0x53b904(0x57b)],_0x3425a2=_0x54feb5[_0x53b904(0x7a5)][_0x53b904(0xb96)]?.[_0x53b904(0xb0a)](_0xf33551=>_0xf33551[_0x53b904(0xa42)]+':\x20'+_0xf33551[_0x53b904(0x1443)])[_0x53b904(0x3b9)](',\x20');_0xdca0f0=_0x53b904(0x9bd)+_0x36d4f8+_0x53b904(0x115b)+(_0x3425a2||'无');}else _0x54feb5['error']&&(_0xdca0f0='API错误:\x20'+_0x54feb5['error'][_0x53b904(0xcce)]);}throw new Error(_0xdca0f0);}document[_0x59e961(0x954)]('DOMContentLoaded',()=>{const _0x48bc6d=_0x59e961,_0x3a9f36=_0x48bc6d(0x13e6);async function _0x58f1ae(_0x2fff01,_0x11949d){const _0x3dada6=_0x48bc6d;if(!_0x2fff01||!_0x11949d)throw new Error('设备ID和密钥盐不能为空。');const _0x34b7f1=_0x2fff01+_0x11949d,_0x13e764=new TextEncoder()[_0x3dada6(0x3f7)](_0x34b7f1),_0x32e24c=await crypto['subtle']['digest']('SHA-256',_0x13e764),_0x467cfe=Array['from'](new Uint8Array(_0x32e24c)),_0xa4cf85=_0x467cfe[_0x3dada6(0xb0a)](_0x16fce8=>_0x16fce8[_0x3dada6(0xd81)](0x10)[_0x3dada6(0x1488)](0x2,'0'))[_0x3dada6(0x3b9)]('');return _0xa4cf85['substring'](0x0,0x6)[_0x3dada6(0x14aa)]();}function _0x274014(){return new Promise(async(_0x463cdb,_0x529ccf)=>{const _0x3b4d9e=_0x1efc;if(isPinActivated){_0x463cdb(!![]);return;}const _0x55fc30=document[_0x3b4d9e(0x9a3)](_0x3b4d9e(0x1439)),_0x1e932d=document[_0x3b4d9e(0x9a3)](_0x3b4d9e(0x70f)),_0x39969d=document[_0x3b4d9e(0x9a3)](_0x3b4d9e(0x77b)),_0x795f40=document[_0x3b4d9e(0x9a3)]('pin-modal-confirm-btn'),_0x402508=document[_0x3b4d9e(0x9a3)](_0x3b4d9e(0xb18));_0x1e932d['value']=EPHONE_DEVICE_ID,_0x39969d[_0x3b4d9e(0x7b2)]='';const _0x583e6e=async()=>{const _0x446abd=_0x3b4d9e,_0x3524f7=_0x39969d[_0x446abd(0x7b2)];_0x55fc30[_0x446abd(0x4d8)][_0x446abd(0x133d)](_0x446abd(0xc09)),_0x795f40[_0x446abd(0xd7f)](_0x446abd(0x9cc),_0x583e6e),_0x402508['removeEventListener'](_0x446abd(0x9cc),_0x2209a3);if(!_0x3524f7||!_0x3524f7[_0x446abd(0x13f9)]()){await _0x403a62(_0x446abd(0xf83),_0x446abd(0xebc)),_0x529ccf(new Error(_0x446abd(0xa82)));return;}await _0x403a62('请稍候...',_0x446abd(0x13ba));try{const _0x3e6cb0=await _0x58f1ae(EPHONE_DEVICE_ID,_0x3a9f36);_0x3524f7[_0x446abd(0x13f9)]()[_0x446abd(0x14aa)]()===_0x3e6cb0?(localStorage['setItem'](_0x446abd(0xe7f),'true'),isPinActivated=!![],await _0x403a62(_0x446abd(0x57e),_0x446abd(0xfb4)),_0x467fd0(),_0x463cdb(!![])):(await _0x403a62(_0x446abd(0x1502),'您输入的激活码不正确。'),_0x529ccf(new Error(_0x446abd(0x101c))));}catch(_0x541026){console['error'](_0x446abd(0x781),_0x541026),await _0x403a62(_0x446abd(0x1502),_0x446abd(0x38e)+_0x541026[_0x446abd(0xcce)]),_0x529ccf(_0x541026);}},_0x2209a3=async()=>{const _0x41b89f=_0x3b4d9e;_0x55fc30[_0x41b89f(0x4d8)][_0x41b89f(0x133d)]('visible'),_0x795f40['removeEventListener']('click',_0x583e6e),_0x402508['removeEventListener'](_0x41b89f(0x9cc),_0x2209a3),await _0x403a62(_0x41b89f(0xf83),_0x41b89f(0x9da)),_0x529ccf(new Error(_0x41b89f(0x10f4)));};_0x795f40[_0x3b4d9e(0x954)](_0x3b4d9e(0x9cc),_0x583e6e),_0x402508['addEventListener'](_0x3b4d9e(0x9cc),_0x2209a3),_0x55fc30['classList']['add'](_0x3b4d9e(0xc09)),_0x39969d['focus']();});}function _0x467fd0(){const _0x2c7fe7=_0x48bc6d,_0x1b42a3=localStorage[_0x2c7fe7(0x5de)](_0x2c7fe7(0xe7f))===_0x2c7fe7(0x903),_0x2704bf=document[_0x2c7fe7(0x9a3)]('import-preset-btn'),_0x218742=document['getElementById'](_0x2c7fe7(0xcc9));_0x2704bf&&_0x2704bf[_0x2c7fe7(0x4d8)]['toggle'](_0x2c7fe7(0x25f),!_0x1b42a3),_0x218742&&_0x218742[_0x2c7fe7(0x4d8)][_0x2c7fe7(0xc02)]('locked-feature',!_0x1b42a3);}document[_0x48bc6d(0x954)](_0x48bc6d(0x1365),()=>{const _0x5ad221=_0x48bc6d;document[_0x5ad221(0xf4c)]==='visible'&&(console[_0x5ad221(0xe4d)]('应用已返回前台，正在检查更新...'),navigator[_0x5ad221(0x22c)][_0x5ad221(0x79a)][_0x5ad221(0x140f)](_0x1ded76=>{const _0x2c059f=_0x5ad221;_0x1ded76[_0x2c059f(0xe33)]();}));});function _0x366263(_0xbad1dc,_0x12aeb1,_0x2c06f7,_0x591d19){const _0x270fdd=_0x48bc6d,_0x3f9c62=_0x19ddb8[_0x270fdd(0x4c8)][_0x270fdd(0x4a2)]||0.8,_0x280c81={'user':'user','assistant':_0x270fdd(0x14a0),'system':_0x270fdd(0x20d)},_0x4e5b14=[{'role':_0x270fdd(0x20d),'parts':[{'text':_0x2c06f7}]},{'role':_0x270fdd(0x14a0),'parts':[{'text':_0x270fdd(0x1024)}]},..._0x591d19['map'](_0x3dc75f=>{const _0x1937e2=_0x270fdd,_0x11ebf1=[];return Array[_0x1937e2(0xb9b)](_0x3dc75f['content'])?_0x3dc75f[_0x1937e2(0x4e3)][_0x1937e2(0x15c1)](_0x681a5f=>{const _0x4ee599=_0x1937e2;if(_0x681a5f[_0x4ee599(0x1508)]==='text')_0x11ebf1[_0x4ee599(0x1c4)]({'text':_0x681a5f[_0x4ee599(0x13ca)]});else{if(_0x681a5f[_0x4ee599(0x1508)]===_0x4ee599(0xae0)&&_0x681a5f[_0x4ee599(0xae0)]&&_0x681a5f[_0x4ee599(0xae0)][_0x4ee599(0x121f)]){const _0x426909=_0x681a5f['image_url'][_0x4ee599(0x121f)],_0x509b3a=_0x426909[_0x4ee599(0x1536)](',')[0x1],_0x47ef4=_0x426909[_0x4ee599(0x293)](/^data:(.*);base64/);_0x47ef4&&_0x509b3a&&_0x11ebf1[_0x4ee599(0x1c4)]({'inline_data':{'mime_type':_0x47ef4[0x1],'data':_0x509b3a}});}}}):_0x11ebf1[_0x1937e2(0x1c4)]({'text':String(_0x3dc75f[_0x1937e2(0x4e3)])}),{'role':_0x280c81[_0x3dc75f['role']],'parts':_0x11ebf1};})];return{'url':'https://generativelanguage.googleapis.com/v1beta/models/'+_0xbad1dc+_0x270fdd(0x12a0)+getRandomValue(_0x12aeb1),'data':{'method':'POST','headers':{'Content-Type':'application/json'},'body':JSON[_0x270fdd(0xe1e)]({'contents':_0x4e5b14,'generationConfig':{'temperature':_0x3f9c62}})}};}const _0x512070=new Dexie(_0x48bc6d(0xcbc)),_0x33963a=[{'id':'none','url':'','name':'无'},{'id':_0x48bc6d(0x13cf),'url':_0x48bc6d(0x9bc),'name':'1'},{'id':'frame_ribbon','url':_0x48bc6d(0x155d),'name':'2'},{'id':_0x48bc6d(0x14ff),'url':_0x48bc6d(0xa90),'name':'3'},{'id':_0x48bc6d(0x129b),'url':'https://i.postimg.cc/85Zsyjwn/IMG-6895.gif','name':'4'},{'id':_0x48bc6d(0x2ff),'url':_0x48bc6d(0x3e2),'name':'5'},{'id':_0x48bc6d(0xccd),'url':_0x48bc6d(0x37a),'name':'6'},{'id':_0x48bc6d(0x53e),'url':_0x48bc6d(0x11bd),'name':'7'},{'id':'frame_8','url':'https://i.postimg.cc/dVLXm3Xf/IMG-6885.gif','name':'8'},{'id':_0x48bc6d(0x10fe),'url':_0x48bc6d(0x1376),'name':'9'},{'id':_0x48bc6d(0xfe0),'url':_0x48bc6d(0x6b1),'name':'10'},{'id':_0x48bc6d(0x489),'url':_0x48bc6d(0x77a),'name':'11'},{'id':_0x48bc6d(0x1025),'url':_0x48bc6d(0x1415),'name':'12'},{'id':'frame_13','url':'https://i.postimg.cc/gk0BmrY0/IMG-4371.gif','name':'13'},{'id':_0x48bc6d(0xf66),'url':'https://i.postimg.cc/fRt2SFSn/IMG-4368.gif','name':'14'},{'id':'frame_cat_ear','url':_0x48bc6d(0xca7),'name':'1'},{'id':'frame_ribbon','url':'https://i.postimg.cc/PrcKH436/IMG-4376.gif','name':'2'},{'id':_0x48bc6d(0x14ff),'url':'https://i.postimg.cc/fRV86FMq/IMG-4381.gif','name':'3'},{'id':_0x48bc6d(0x129b),'url':_0x48bc6d(0x108c),'name':'4'},{'id':'frame_5','url':_0x48bc6d(0xda9),'name':'5'},{'id':'frame_6','url':_0x48bc6d(0xdb3),'name':'6'},{'id':_0x48bc6d(0x53e),'url':_0x48bc6d(0x2ba),'name':'7'},{'id':_0x48bc6d(0x1285),'url':_0x48bc6d(0x119a),'name':'8'},{'id':_0x48bc6d(0x10fe),'url':_0x48bc6d(0x2c2),'name':'9'},{'id':_0x48bc6d(0xfe0),'url':_0x48bc6d(0x430),'name':'10'},{'id':_0x48bc6d(0x489),'url':_0x48bc6d(0xe66),'name':'11'},{'id':_0x48bc6d(0x1025),'url':_0x48bc6d(0x1180),'name':'12'},{'id':'frame_13','url':_0x48bc6d(0xd16),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0xf23),'name':'14'},{'id':_0x48bc6d(0x13cf),'url':'https://i.postimg.cc/yN3s8szM/IMG-4400.gif','name':'1'},{'id':_0x48bc6d(0x15bf),'url':_0x48bc6d(0x131d),'name':'2'},{'id':_0x48bc6d(0x14ff),'url':_0x48bc6d(0xfe4),'name':'3'},{'id':_0x48bc6d(0x129b),'url':'https://i.postimg.cc/Jn1DFPgY/IMG-4403.gif','name':'4'},{'id':'frame_5','url':_0x48bc6d(0xb7f),'name':'5'},{'id':'frame_6','url':_0x48bc6d(0xeef),'name':'6'},{'id':_0x48bc6d(0x53e),'url':_0x48bc6d(0xd7b),'name':'7'},{'id':_0x48bc6d(0x1285),'url':_0x48bc6d(0xa81),'name':'8'},{'id':_0x48bc6d(0x10fe),'url':_0x48bc6d(0x14f9),'name':'9'},{'id':_0x48bc6d(0xfe0),'url':_0x48bc6d(0x1062),'name':'10'},{'id':_0x48bc6d(0x489),'url':'https://i.postimg.cc/cHWp0KG6/IMG-4413.gif','name':'11'},{'id':_0x48bc6d(0x1025),'url':_0x48bc6d(0x515),'name':'12'},{'id':'frame_13','url':'https://i.postimg.cc/hPX5F8Qp/IMG-4415.gif','name':'13'},{'id':_0x48bc6d(0xf66),'url':'https://i.postimg.cc/vHCSG1WM/IMG-4416.gif','name':'14'},{'id':'frame_cat_ear','url':_0x48bc6d(0x228),'name':'1'},{'id':_0x48bc6d(0x15bf),'url':'https://i.postimg.cc/FHRcCGfH/IMG-4418.gif','name':'2'},{'id':_0x48bc6d(0x14ff),'url':_0x48bc6d(0x1000),'name':'3'},{'id':_0x48bc6d(0x129b),'url':'https://i.postimg.cc/J4WCQd2j/IMG-4420.gif','name':'4'},{'id':_0x48bc6d(0x2ff),'url':_0x48bc6d(0x12ef),'name':'5'},{'id':'frame_6','url':_0x48bc6d(0x341),'name':'6'},{'id':_0x48bc6d(0x53e),'url':_0x48bc6d(0x42b),'name':'7'},{'id':_0x48bc6d(0x1285),'url':_0x48bc6d(0xa26),'name':'8'},{'id':_0x48bc6d(0x10fe),'url':_0x48bc6d(0x11b4),'name':'9'},{'id':_0x48bc6d(0xfe0),'url':_0x48bc6d(0xf79),'name':'10'},{'id':_0x48bc6d(0x489),'url':_0x48bc6d(0xe29),'name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/R0WYmcYM/IMG-4431.gif','name':'12'},{'id':'frame_13','url':_0x48bc6d(0xb5f),'name':'13'},{'id':_0x48bc6d(0xf66),'url':'https://i.postimg.cc/tC9mJ0cv/IMG-4438.gif','name':'14'},{'id':_0x48bc6d(0x13cf),'url':_0x48bc6d(0x11c9),'name':'1'},{'id':_0x48bc6d(0x15bf),'url':'https://i.postimg.cc/Mpv5fzm5/IMG-4439.gif','name':'2'},{'id':_0x48bc6d(0x14ff),'url':_0x48bc6d(0x91b),'name':'3'},{'id':'frame_tech','url':'https://i.postimg.cc/c4JMPd2W/IMG-4724.gif','name':'4'},{'id':_0x48bc6d(0x2ff),'url':_0x48bc6d(0x110a),'name':'5'},{'id':'frame_6','url':_0x48bc6d(0x7d9),'name':'6'},{'id':_0x48bc6d(0x53e),'url':_0x48bc6d(0xf32),'name':'7'},{'id':_0x48bc6d(0x1285),'url':_0x48bc6d(0xb99),'name':'8'},{'id':_0x48bc6d(0x10fe),'url':'https://i.postimg.cc/4x9tTy1D/IMG-5563.gif','name':'9'},{'id':_0x48bc6d(0xfe0),'url':_0x48bc6d(0x73c),'name':'10'},{'id':_0x48bc6d(0x489),'url':_0x48bc6d(0x11a5),'name':'11'},{'id':_0x48bc6d(0x1025),'url':'https://i.postimg.cc/Fz3HwLk9/IMG-5569.gif','name':'12'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0xb81),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0xd1c),'name':'14'},{'id':_0x48bc6d(0x13cf),'url':'https://i.postimg.cc/CKgDNYVb/IMG-5577.gif','name':'1'},{'id':_0x48bc6d(0x15bf),'url':_0x48bc6d(0x8da),'name':'2'},{'id':_0x48bc6d(0x14ff),'url':_0x48bc6d(0x8da),'name':'3'},{'id':'frame_tech','url':_0x48bc6d(0x856),'name':'4'},{'id':_0x48bc6d(0x2ff),'url':'https://i.postimg.cc/4y7mGFgJ/IMG-5716.gif','name':'5'},{'id':_0x48bc6d(0xccd),'url':_0x48bc6d(0xb5b),'name':'6'},{'id':'frame_7','url':_0x48bc6d(0x9d5),'name':'7'},{'id':_0x48bc6d(0x1285),'url':_0x48bc6d(0x147e),'name':'8'},{'id':'frame_9','url':_0x48bc6d(0x12ed),'name':'9'},{'id':_0x48bc6d(0xfe0),'url':_0x48bc6d(0x177),'name':'10'},{'id':'frame_11','url':_0x48bc6d(0x888),'name':'11'},{'id':'frame_12','url':_0x48bc6d(0x1018),'name':'12'},{'id':'frame_13','url':_0x48bc6d(0xed1),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0xcb8),'name':'14'},{'id':_0x48bc6d(0x13cf),'url':_0x48bc6d(0xe06),'name':'1'},{'id':_0x48bc6d(0x15bf),'url':'https://i.postimg.cc/9fQZ425b/IMG-5975.gif','name':'2'},{'id':'frame_flower','url':'https://i.postimg.cc/v8V9xXjJ/IMG-6137.gif','name':'3'},{'id':'frame_tech','url':_0x48bc6d(0xb6e),'name':'4'},{'id':_0x48bc6d(0x2ff),'url':_0x48bc6d(0x83d),'name':'5'},{'id':_0x48bc6d(0xccd),'url':_0x48bc6d(0xcd6),'name':'6'},{'id':'frame_7','url':'https://i.postimg.cc/qRCtnMms/IMG-6145.gif','name':'7'},{'id':_0x48bc6d(0x1285),'url':'https://i.postimg.cc/1Rwn3XVP/IMG-6146.gif','name':'8'},{'id':_0x48bc6d(0x10fe),'url':_0x48bc6d(0x12c3),'name':'9'},{'id':'frame_10','url':_0x48bc6d(0xd86),'name':'10'},{'id':_0x48bc6d(0x489),'url':'https://i.postimg.cc/fTWzQRx8/IMG-6149.gif','name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/LXyyqDbY/IMG-6294.gif','name':'12'},{'id':_0x48bc6d(0x12d5),'url':'https://i.postimg.cc/7Zgm1wRy/IMG-6295.gif','name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x12c0),'name':'14'},{'id':_0x48bc6d(0x13cf),'url':'https://i.postimg.cc/YSRRV8kn/IMG-6297.gif','name':'1'},{'id':'frame_ribbon','url':'https://i.postimg.cc/k45sd8gn/IMG-6375.gif','name':'2'},{'id':'frame_flower','url':_0x48bc6d(0x996),'name':'3'},{'id':_0x48bc6d(0x129b),'url':'https://i.postimg.cc/90RBDh9K/IMG-6377.gif','name':'4'},{'id':_0x48bc6d(0x2ff),'url':_0x48bc6d(0xd19),'name':'5'},{'id':_0x48bc6d(0xccd),'url':_0x48bc6d(0x131b),'name':'6'},{'id':_0x48bc6d(0x53e),'url':_0x48bc6d(0xe9d),'name':'7'},{'id':_0x48bc6d(0x1285),'url':_0x48bc6d(0xb5e),'name':'8'},{'id':_0x48bc6d(0x10fe),'url':'https://i.postimg.cc/pLY3WfR8/IMG-6557.gif','name':'9'},{'id':'frame_10','url':_0x48bc6d(0xa25),'name':'10'},{'id':_0x48bc6d(0x489),'url':_0x48bc6d(0x1017),'name':'11'},{'id':_0x48bc6d(0x1025),'url':_0x48bc6d(0xe5e),'name':'12'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0x1003),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x14f8),'name':'14'},{'id':'frame_cat_ear','url':_0x48bc6d(0x96b),'name':'1'},{'id':_0x48bc6d(0x15bf),'url':_0x48bc6d(0xb42),'name':'2'},{'id':_0x48bc6d(0x14ff),'url':_0x48bc6d(0xc07),'name':'3'},{'id':_0x48bc6d(0x129b),'url':'https://i.postimg.cc/fycfcvHf/IMG-6569.gif','name':'4'},{'id':_0x48bc6d(0x2ff),'url':'https://i.postimg.cc/J7ZxC11H/IMG-6570.gif','name':'5'},{'id':_0x48bc6d(0xccd),'url':_0x48bc6d(0x1252),'name':'6'},{'id':'frame_7','url':_0x48bc6d(0xa08),'name':'7'},{'id':'frame_8','url':_0x48bc6d(0xd52),'name':'8'},{'id':_0x48bc6d(0x10fe),'url':'https://i.postimg.cc/Vv8jkCYr/IMG-6574.gif','name':'9'},{'id':_0x48bc6d(0xfe0),'url':'https://i.postimg.cc/MZ77rdDy/IMG-6850.gif','name':'10'},{'id':_0x48bc6d(0x489),'url':_0x48bc6d(0x13fa),'name':'11'},{'id':'frame_12','url':_0x48bc6d(0x191),'name':'12'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0x1298),'name':'13'},{'id':_0x48bc6d(0xf66),'url':'https://i.postimg.cc/gJ95NSRB/IMG-6854.gif','name':'14'},{'id':_0x48bc6d(0x13cf),'url':_0x48bc6d(0x135c),'name':'1'},{'id':'frame_ribbon','url':_0x48bc6d(0x1c7),'name':'2'},{'id':_0x48bc6d(0x14ff),'url':'https://i.postimg.cc/fyPDvxJk/IMG-6860.gif','name':'3'},{'id':_0x48bc6d(0x129b),'url':_0x48bc6d(0x137c),'name':'4'},{'id':_0x48bc6d(0x2ff),'url':_0x48bc6d(0x440),'name':'5'},{'id':'frame_6','url':'https://i.postimg.cc/Y0vwjhb7/IMG-6857.gif','name':'6'},{'id':_0x48bc6d(0x53e),'url':_0x48bc6d(0x59b),'name':'7'},{'id':'frame_8','url':_0x48bc6d(0x4ac),'name':'8'},{'id':_0x48bc6d(0x10fe),'url':'https://i.postimg.cc/7Z8yYP7v/IMG-6889.gif','name':'9'},{'id':'frame_10','url':_0x48bc6d(0x1238),'name':'10'},{'id':_0x48bc6d(0x489),'url':_0x48bc6d(0x6aa),'name':'11'},{'id':_0x48bc6d(0x1025),'url':'https://i.postimg.cc/Wbr0JSDD/IMG-5316.gif','name':'12'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0xd78),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x9cb),'name':'14'},{'id':_0x48bc6d(0x489),'url':_0x48bc6d(0x8cf),'name':'11'},{'id':_0x48bc6d(0x1025),'url':_0x48bc6d(0xde8),'name':'12'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0x34d),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0xa74),'name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0x36b),'name':'13'},{'id':_0x48bc6d(0xf66),'url':'https://i.postimg.cc/3Rb46fRZ/IMG-6923.gif','name':'14'},{'id':_0x48bc6d(0x12d5),'url':'https://i.postimg.cc/PJppkbvn/IMG-6918.gif','name':'13'},{'id':'frame_14','url':_0x48bc6d(0xb03),'name':'14'},{'id':_0x48bc6d(0xf66),'url':'https://i.postimg.cc/RVt6sRzc/IMG-6939.gif','name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0x100a),'name':'13'},{'id':_0x48bc6d(0xf66),'url':'https://i.postimg.cc/P5zLh5JJ/IMG-6942.gif','name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x9d6),'name':'14'},{'id':_0x48bc6d(0x1025),'url':_0x48bc6d(0x855),'name':'12'},{'id':'frame_13','url':'https://i.postimg.cc/DZgMwc1H/817178fdbpf2ff7740dc98e26ab78759.gif','name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x469),'name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0x1319),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x274),'name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0x590),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x42f),'name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x359),'name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0x434),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x9ea),'name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0xe6d),'name':'14'},{'id':_0x48bc6d(0x12d5),'url':'https://i.postimg.cc/y8p9s3Jj/IMG-6919.gif','name':'13'},{'id':_0x48bc6d(0xf66),'url':'https://i.postimg.cc/Lsr1Zd3Z/IMG-6928.gif','name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x1126),'name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x10a5),'name':'14'},{'id':'frame_13','url':_0x48bc6d(0xc9d),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x70d),'name':'14'},{'id':'frame_14','url':_0x48bc6d(0x4fd),'name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0x772),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0xcbe),'name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x13f1),'name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0xa68),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x895),'name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0xa79),'name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x199),'name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0x12be),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0xb77),'name':'14'},{'id':'frame_14','url':_0x48bc6d(0xf6b),'name':'14'},{'id':'frame_13','url':_0x48bc6d(0xab7),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x7de),'name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x8bc),'name':'14'},{'id':_0x48bc6d(0xf66),'url':'https://i.postimg.cc/gj3Tmqz5/mmexport1751030241029.gif','name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0x1457),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0xa45),'name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x5b3),'name':'14'},{'id':'frame_13','url':_0x48bc6d(0xf17),'name':'13'},{'id':_0x48bc6d(0xf66),'url':'https://i.postimg.cc/8kHCQwbQ/mmexport1751020645824.gif','name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0xee3),'name':'14'},{'id':_0x48bc6d(0xf66),'url':'https://i.postimg.cc/JnwFp3Kx/mmexport1751031208329.gif','name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0xeb5),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x977),'name':'14'},{'id':_0x48bc6d(0xf66),'url':'https://i.postimg.cc/NFS4ZyvM/mmexport1751032686953.gif','name':'14'},{'id':_0x48bc6d(0x12d5),'url':'https://i.postimg.cc/3RpmWc8c/mmexport1751033102811.gif','name':'13'},{'id':'frame_14','url':_0x48bc6d(0x7e4),'name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x279),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/CMv02LHm/mmexport1751034842120.gif','name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0x1108),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/7YRbzN51/mmexport1751036276038.gif','name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/cJpbtPWq/mmexport1751036607799.gif','name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0xb6c),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x1575),'name':'14'},{'id':'frame_14','url':_0x48bc6d(0xf04),'name':'14'},{'id':_0x48bc6d(0xf66),'url':'https://i.postimg.cc/xjpN4swz/IMG-7240.gif','name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0x7cb),'name':'13'},{'id':_0x48bc6d(0xf66),'url':'https://i.postimg.cc/DyYDmKtw/IMG-7238.gif','name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x4b4),'name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0x151c),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/cHsTXDVz/IMG-7235.gif','name':'14'},{'id':'frame_14','url':_0x48bc6d(0x56c),'name':'14'},{'id':_0x48bc6d(0xf66),'url':'https://i.postimg.cc/xTk5xN49/IMG-7233.gif','name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0xd83),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/yx2m4nbs/IMG-7231.gif','name':'14'},{'id':'frame_14','url':_0x48bc6d(0x2cf),'name':'14'},{'id':'frame_13','url':_0x48bc6d(0x1453),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x1023),'name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x41f),'name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x664),'name':'14'},{'id':_0x48bc6d(0x12d5),'url':'https://i.postimg.cc/9XPwWmwy/IMB-Kf7um-P.gif','name':'13'},{'id':_0x48bc6d(0xf66),'url':'https://i.postimg.cc/mrFhKBGz/IMB-e-QWBpa.gif','name':'14'},{'id':'frame_14','url':_0x48bc6d(0xe32),'name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0x976),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x156c),'name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x5fc),'name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0xc93),'name':'14'},{'id':'frame_13','url':_0x48bc6d(0x58c),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x865),'name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x1328),'name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0x8a2),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0xe89),'name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x94e),'name':'14'},{'id':'frame_14','url':_0x48bc6d(0x1fb),'name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/tTpZ6wLs/IMG-7095.gif','name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0xa04),'name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x7e8),'name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0x55a),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x4db),'name':'14'},{'id':'frame_14','url':_0x48bc6d(0x9f5),'name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x1164),'name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0x4e2),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x2f0),'name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x120c),'name':'14'},{'id':_0x48bc6d(0x12d5),'url':_0x48bc6d(0x12e5),'name':'13'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x324),'name':'14'},{'id':_0x48bc6d(0xf66),'url':_0x48bc6d(0x822),'name':'14'}];let _0x19ddb8={'chats':{},'activeChatId':null,'globalSettings':{},'apiConfig':{},'userStickers':[],'worldBooks':[],'personaPresets':[],'qzoneSettings':{},'activeAlbumId':null,'cache':{'songs':new Map(),'lyrics':new Map()},'ttsCache':new Map()},_0x480617={'isActive':![],'gameMode':null,'chatId':null,'players':[],'currentDay':0x1,'currentPhase':_0x48bc6d(0xf92),'nightActions':{},'gameLog':[],'discussionLog':[],'voteResults':{},'electionInfo':{'candidates':[],'votes':{}},'sheriffId':null,'lastFailedAction':null},_0x5e066a=0x0;const _0x5a7b3f=0xf;let _0x373876=0x0;const _0x427bfd=0xa;let _0x1f6575=[],_0x4e0631={'isActive':![],'activeChatId':null,'isPlaying':![],'playlist':[],'currentIndex':-0x1,'playMode':'order','totalElapsedTime':0x0,'timerId':null,'parsedLyrics':[],'currentLyricIndex':-0x1},_0x176e91={'isOpen':![],'activePostId':null,'panelEl':null,'gridEl':null};const _0x4a7bb9=document['getElementById'](_0x48bc6d(0x5f5));let _0x4acb77=null,_0x164883=![],_0x5c4e1b=0x0,_0x23e74f=null,_0x113908=![],_0x507d02=_0x48bc6d(0xbf1),_0x445138=new Set(),_0x2713c8=null,_0x53547f=![],_0x79f0bb=null,_0x2f10cc=null,_0x5b6e4b=![],_0x4cf1ca=![],_0x2dcadb=![],_0x35cb1c=![],_0x3285cd=[],_0xe96093=null,_0x40ff22=null,_0x140400={},_0x5c6e51=null,_0x5a727a=null,_0x5638b7=null,_0x132ed6=null,_0x210b58=null,_0x253bd5=null,_0xb7cdc=null,_0x5cf781=[],_0x32068e=null,_0x2eba40=null,_0x2fc670=new Set(),_0x5d423a=null,_0x36ea41=null,_0x4fd882=null,_0x7d9369={'isOpen':![],'photos':[],'currentIndex':-0x1},_0x27ed94=0x0,_0x1fa4d3=![],_0xedb373=new Set(),_0x4351c8=null;const _0x4f81ff=_0x48bc6d(0x14fd),_0xde5144=_0x48bc6d(0xe82),_0x451ae9=_0x48bc6d(0xad3),_0xdb6252=_0x48bc6d(0x128c);let _0x38cc91,_0x283ecc={};const _0x283b35=_0x48bc6d(0xf1c);let _0x2b35e7={},_0x22137c={},_0x52cc3c=null;const _0x540a3d={'qq':'https://i.postimg.cc/MTC3Tkw8/IMG-6436.jpg','world-book':'https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','wallpaper':_0x48bc6d(0xf2c),'renderer':_0x48bc6d(0x3d4),'api-settings':_0x48bc6d(0x1158),'font':_0x48bc6d(0x153c),'char-phone':'https://i.postimg.cc/pXj9h20L/IMG-7275.jpg','douban':_0x48bc6d(0xac1),'preset':_0x48bc6d(0xddc),'tutorial':'https://i.postimg.cc/d10GjC4g/IMG-7302.jpg','werewolf':_0x48bc6d(0x5e5),'x':_0x48bc6d(0xfc2)},_0x42106a={'qq':'https://i.postimg.cc/MTC3Tkw8/IMG-6436.jpg','album':_0x48bc6d(0x243),'browser':_0x48bc6d(0x127f),'taobao':_0x48bc6d(0xf4e),'memo':_0x48bc6d(0x1513),'diary':_0x48bc6d(0x1347),'amap':'https://i.postimg.cc/Jz2Tz0dw/IMG-7281.jpg','usage':_0x48bc6d(0x454),'music':_0x48bc6d(0x995),'ephone':_0x48bc6d(0x713)};let _0x4a7c77=null;const _0x115b0e=/(^https:\/\/i\.postimg\.cc\/.+|^https:\/\/files\.catbox\.moe\/.+|^https?:\/\/sharkpan\.xyz\/.+|^data:image|\.(png|jpg|jpeg|gif|webp)\?.*$|\.(png|jpg|jpeg|gif|webp)$)/i;let _0xaa83fe=0x0,_0x1d42e1=0x1,_0x46c1e8={'hasShown40':![],'hasShown20':![],'hasShown10':![]},_0x2dc290;const _0x3cbaf3=document[_0x48bc6d(0xe94)](_0x48bc6d(0x20f));_0x3cbaf3['id']='dynamic-font-style',document[_0x48bc6d(0x1552)]['appendChild'](_0x3cbaf3);const _0x363d75=document[_0x48bc6d(0x9a3)](_0x48bc6d(0x6d4)),_0x1c84f0=document[_0x48bc6d(0x9a3)](_0x48bc6d(0x1047)),_0x2f73e7=document['getElementById'](_0x48bc6d(0x6fe)),_0x42caa7=document[_0x48bc6d(0x9a3)](_0x48bc6d(0x116b)),_0x2f6f8e=document['getElementById'](_0x48bc6d(0x92a));let _0x631e3b;function _0x48a87a(){const _0x2c67a5=_0x48bc6d;_0x363d75[_0x2c67a5(0x4d8)][_0x2c67a5(0xe05)](_0x2c67a5(0xc09));}function _0x5551e4(){const _0x18b45e=_0x48bc6d;_0x363d75[_0x18b45e(0x4d8)][_0x18b45e(0x133d)](_0x18b45e(0xc09)),_0x42caa7['classList'][_0x18b45e(0x133d)](_0x18b45e(0xf5b));if(_0x631e3b)_0x631e3b(null);}function _0x11947f(_0x37f78d){const _0x2dc44d=_0x48bc6d,_0x3fc726=document['getElementById'](_0x2dc44d(0x1386)),_0x1048c9=_0x37f78d['settings']['lyricsPosition']||{'vertical':'top','horizontal':_0x2dc44d(0xd4f),'offset':0xa};_0x3fc726['style'][_0x2dc44d(0xe8f)]=_0x2dc44d(0xaf8),_0x3fc726[_0x2dc44d(0x20f)]['bottom']=_0x2dc44d(0xaf8),_0x3fc726[_0x2dc44d(0x20f)][_0x2dc44d(0xb90)]=_0x2dc44d(0xaf8),_0x3fc726[_0x2dc44d(0x20f)][_0x2dc44d(0x2a5)]=_0x2dc44d(0xaf8),_0x3fc726[_0x2dc44d(0x20f)][_0x2dc44d(0x352)]='none';_0x1048c9['vertical']==='top'?_0x3fc726['style']['top']=_0x1048c9[_0x2dc44d(0xccc)]+'px':_0x3fc726[_0x2dc44d(0x20f)][_0x2dc44d(0x837)]=_0x1048c9['offset']+'px';switch(_0x1048c9[_0x2dc44d(0x146b)]){case _0x2dc44d(0xb90):_0x3fc726[_0x2dc44d(0x20f)][_0x2dc44d(0xb90)]=_0x2dc44d(0x5c2);break;case _0x2dc44d(0x2a5):_0x3fc726[_0x2dc44d(0x20f)][_0x2dc44d(0x2a5)]='15px';break;case _0x2dc44d(0xd4f):default:_0x3fc726[_0x2dc44d(0x20f)][_0x2dc44d(0xb90)]='50%',_0x3fc726[_0x2dc44d(0x20f)][_0x2dc44d(0x352)]='translateX(-50%)';break;}}async function _0x566a7a(_0x4beae1){const _0x540a40=_0x48bc6d,_0x53c971=_0x4beae1[_0x540a40(0xa41)][_0x540a40(0x104e)][0x0];if(!_0x53c971)return;const _0x37ae90=await new Promise(_0xfa37dc=>{const _0x1132ea=_0x540a40,_0x635d2b=new FileReader();_0x635d2b[_0x1132ea(0xdd7)]=()=>_0xfa37dc(_0x635d2b['result']),_0x635d2b[_0x1132ea(0xdd8)](_0x53c971);});await _0x403a62(_0x540a40(0x1395),_0x540a40(0xcd2));try{const _0x261b75=await _0xf2665c(_0x37ae90);if(!_0x261b75)throw new Error(_0x540a40(0x492));const _0xb8129f=_0x19ddb8['chats'][_0x19ddb8[_0x540a40(0x859)]];!_0xb8129f[_0x540a40(0x450)][_0x540a40(0x284)]&&(_0xb8129f['settings']['groupAvatarLibrary']=[]),_0xb8129f[_0x540a40(0x450)][_0x540a40(0x284)][_0x540a40(0x1c4)]({'name':_0x261b75,'url':_0x37ae90}),await _0x512070['chats'][_0x540a40(0xd4d)](_0xb8129f),_0x35ded3(),await _0x403a62(_0x540a40(0xda0),'AI已将新群头像命名为：“'+_0x261b75+'”');}catch(_0x3d23b3){console[_0x540a40(0x3b7)](_0x540a40(0xc32),_0x3d23b3),await _0x403a62(_0x540a40(0x13bd),_0x540a40(0x86d)+_0x3d23b3[_0x540a40(0xcce)]);}finally{_0x4beae1[_0x540a40(0xa41)]['value']=null;}}async function _0x14ac14(_0x19471d){const _0x49ba48=_0x48bc6d,_0x332b65=_0x19471d['target']['files'][0x0];if(!_0x332b65)return;const _0x3b0838=await new Promise(_0x366024=>{const _0x748eda=_0x1efc,_0x261a9c=new FileReader();_0x261a9c[_0x748eda(0xdd7)]=()=>_0x366024(_0x261a9c[_0x748eda(0x5c9)]),_0x261a9c[_0x748eda(0xdd8)](_0x332b65);});await _0x403a62('请稍候...','正在请求AI为新头像命名...');try{const _0x4909b0=await _0xf2665c(_0x3b0838);if(!_0x4909b0)throw new Error(_0x49ba48(0x492));const _0x57bc1d=_0x19ddb8[_0x49ba48(0xb04)][_0x19ddb8[_0x49ba48(0x859)]];!_0x57bc1d[_0x49ba48(0x450)][_0x49ba48(0xea2)]&&(_0x57bc1d[_0x49ba48(0x450)][_0x49ba48(0xea2)]=[]),_0x57bc1d[_0x49ba48(0x450)][_0x49ba48(0xea2)]['push']({'name':_0x4909b0,'url':_0x3b0838}),await _0x512070[_0x49ba48(0xb04)][_0x49ba48(0xd4d)](_0x57bc1d),_0x4462e2(),await _0x403a62(_0x49ba48(0xda0),_0x49ba48(0x114e)+_0x4909b0+'”');}catch(_0x5e4790){console['error']('本地头像上传及识别失败:',_0x5e4790),await _0x403a62(_0x49ba48(0x13bd),_0x49ba48(0x86d)+_0x5e4790['message']);}finally{_0x19471d[_0x49ba48(0xa41)][_0x49ba48(0x7b2)]=null;}}async function _0xf2665c(_0x18b294){const _0x59deb4=_0x48bc6d,_0x30ef6a=_0x19ddb8[_0x59deb4(0xd22)][_0x59deb4(0x132b)]&&_0x19ddb8[_0x59deb4(0xd22)]['secondaryApiKey']&&_0x19ddb8[_0x59deb4(0xd22)][_0x59deb4(0xa20)],{proxyUrl:_0x46323d,apiKey:_0x49cf1e,model:_0x34f7f3}=_0x30ef6a?{'proxyUrl':_0x19ddb8[_0x59deb4(0xd22)]['secondaryProxyUrl'],'apiKey':_0x19ddb8[_0x59deb4(0xd22)][_0x59deb4(0x278)],'model':_0x19ddb8[_0x59deb4(0xd22)]['secondaryModel']}:_0x19ddb8[_0x59deb4(0xd22)];if(!_0x46323d||!_0x49cf1e||!_0x34f7f3)throw new Error('主API和副API均未配置或配置不完整。');const _0x323dc7=_0x59deb4(0xfdb);let _0x9c493=_0x46323d[_0x59deb4(0x478)](_0x59deb4(0x1329)),_0x44eb5b;if(_0x9c493){const _0x3ed439=_0x18b294[_0x59deb4(0x293)](/^data:(.*);base64/)[0x1],_0x38e52f=_0x18b294[_0x59deb4(0x1536)](',')[0x1],_0x4db7b1={'contents':[{'parts':[{'text':_0x323dc7},{'inline_data':{'mime_type':_0x3ed439,'data':_0x38e52f}}]}]};_0x44eb5b=await fetch(_0x46323d+'/'+_0x34f7f3+':generateContent?key='+_0x49cf1e,{'method':_0x59deb4(0x12db),'headers':{'Content-Type':'application/json'},'body':JSON[_0x59deb4(0xe1e)](_0x4db7b1)});}else{const _0x4fc77b={'model':_0x34f7f3,'messages':[{'role':_0x59deb4(0x20d),'content':[{'type':'text','text':_0x323dc7},{'type':_0x59deb4(0xae0),'image_url':{'url':_0x18b294}}]}],'max_tokens':0x32};_0x44eb5b=await fetch(_0x46323d+_0x59deb4(0x501),{'method':_0x59deb4(0x12db),'headers':{'Content-Type':'application/json','Authorization':_0x59deb4(0x1265)+_0x49cf1e},'body':JSON['stringify'](_0x4fc77b)});}if(!_0x44eb5b['ok']){const _0x35dd9f=await _0x44eb5b[_0x59deb4(0xa5d)]();throw new Error('API\x20错误:\x20'+_0x35dd9f[_0x59deb4(0x3b7)][_0x59deb4(0xcce)]);}const _0x8507c9=await _0x44eb5b['json']();let _0x413a07=_0x9c493?getGeminiResponseText(_0x8507c9):_0x8507c9[_0x59deb4(0x21f)][0x0][_0x59deb4(0xcce)][_0x59deb4(0x4e3)];return _0x413a07[_0x59deb4(0x13f9)]()[_0x59deb4(0x1bb)](/["'“”‘’]/g,'');}async function _0xa82516(_0x5cd7af){const _0x73b5aa=_0x48bc6d;if(!_0x5cd7af||_0x5cd7af['isGroup']){console[_0x73b5aa(0x651)](_0x73b5aa(0xd1a));return;}const _0x289703=_0x5cd7af['id'],_0x3897db=_0x5cd7af[_0x73b5aa(0x1561)],_0x576189=_0x5cd7af[_0x73b5aa(0x339)];console[_0x73b5aa(0xe4d)](_0x73b5aa(0x22e)+_0x289703+_0x73b5aa(0xcaa));for(const _0x53e867 in _0x19ddb8[_0x73b5aa(0xb04)]){const _0x2c87e7=_0x19ddb8['chats'][_0x53e867];if(_0x2c87e7['isGroup']&&_0x2c87e7[_0x73b5aa(0xcca)]){const _0x40f70a=_0x2c87e7[_0x73b5aa(0xcca)][_0x73b5aa(0xd62)](_0x2a0e1e=>_0x2a0e1e['id']===_0x289703);if(_0x40f70a){let _0x34b49f=![];_0x40f70a['groupNickname']!==_0x3897db&&(_0x40f70a['groupNickname']=_0x3897db,_0x34b49f=!![]),_0x40f70a[_0x73b5aa(0x339)]!==_0x576189&&(_0x40f70a[_0x73b5aa(0x339)]=_0x576189,_0x34b49f=!![]),_0x34b49f&&(await _0x512070[_0x73b5aa(0xb04)][_0x73b5aa(0xd4d)](_0x2c87e7),console['log'](_0x73b5aa(0x1140)+_0x2c87e7[_0x73b5aa(0x1561)]+_0x73b5aa(0x415)));}}}}async function _0x3b911c(_0x31956c){const _0x196bfa=_0x48bc6d;if(!_0x31956c||_0x31956c[_0x196bfa(0x136b)]){console[_0x196bfa(0x651)](_0x196bfa(0xdbe));return;}const _0x196b0e=_0x31956c['id'],_0x5b7d6d=_0x31956c[_0x196bfa(0x450)]['aiAvatar'];console[_0x196bfa(0xe4d)](_0x196bfa(0x22e)+_0x196b0e+'\x20同步所有群聊内的头像...');for(const _0x53e450 of Object[_0x196bfa(0xea1)](_0x19ddb8[_0x196bfa(0xb04)])){if(_0x53e450[_0x196bfa(0x136b)]&&_0x53e450[_0x196bfa(0xcca)]){const _0x5a4ede=_0x53e450['members'][_0x196bfa(0xd62)](_0x4fb235=>_0x4fb235['id']===_0x196b0e);_0x5a4ede&&_0x5a4ede[_0x196bfa(0xf3f)]!==_0x5b7d6d&&(_0x5a4ede['avatar']=_0x5b7d6d,await _0x512070[_0x196bfa(0xb04)][_0x196bfa(0xd4d)](_0x53e450),console[_0x196bfa(0xe4d)](_0x196bfa(0xa37)+_0x196b0e+_0x196bfa(0xca5)+_0x53e450[_0x196bfa(0x1561)]+'\x22'));}}}function _0x1e2056(_0x1730d9,_0x5a7163){const _0x20d58c=_0x48bc6d;if(!_0x1730d9||!_0x1730d9[_0x20d58c(0x136b)]||!_0x5a7163)return _0x5a7163;const _0x49be3a=_0x19ddb8[_0x20d58c(0x9ce)]['nickname']||'{{user}}';if(_0x5a7163===_0x49be3a)return _0x1730d9[_0x20d58c(0x450)][_0x20d58c(0x1555)]||'我';const _0x2edc80=_0x1730d9[_0x20d58c(0xcca)][_0x20d58c(0xd62)](_0x1618f5=>_0x1618f5[_0x20d58c(0x339)]===_0x5a7163);return _0x2edc80?_0x2edc80[_0x20d58c(0xaf0)]:_0x5a7163;}function _0xcd7c4e(_0x3e0a88){const _0x357c5c=_0x48bc6d;document[_0x357c5c(0x131c)](_0x357c5c(0x3ea))[_0x357c5c(0x15c1)](_0x4daa18=>{const _0x4b6ec5=_0x357c5c;_0x4daa18['classList']['toggle'](_0x4b6ec5(0xe9f),_0x4daa18[_0x4b6ec5(0xd8d)][_0x4b6ec5(0x922)]===_0x3e0a88);}),document[_0x357c5c(0x131c)](_0x357c5c(0x9e3))['forEach'](_0x10f7b2=>{const _0x77deac=_0x357c5c;_0x10f7b2['classList']['toggle']('active',_0x10f7b2['dataset'][_0x77deac(0x922)]===_0x3e0a88);});}function _0x2e9dd1(_0x1d5240){const _0x58f36b=_0x48bc6d;if(!_0x1d5240)return'';if(_0x19ddb8[_0x58f36b(0x9ce)]&&_0x1d5240===_0x19ddb8[_0x58f36b(0x9ce)][_0x58f36b(0x246)])return _0x19ddb8[_0x58f36b(0x9ce)][_0x58f36b(0x246)];let _0x50f3d9=Object[_0x58f36b(0xea1)](_0x19ddb8[_0x58f36b(0xb04)])['find'](_0x54e8de=>!_0x54e8de[_0x58f36b(0x136b)]&&_0x54e8de[_0x58f36b(0x339)]===_0x1d5240);if(_0x50f3d9)return _0x50f3d9['name'];_0x50f3d9=Object['values'](_0x19ddb8[_0x58f36b(0xb04)])[_0x58f36b(0xd62)](_0x19ef2=>!_0x19ef2['isGroup']&&(_0x19ef2[_0x58f36b(0x1058)]&&_0x19ef2[_0x58f36b(0x1058)][_0x58f36b(0x478)](_0x1d5240)));if(_0x50f3d9)return _0x50f3d9[_0x58f36b(0x1561)];return _0x1d5240;}function _0x8888da(_0x55f036,_0x453ffd=null){const _0x4a66f9=_0x48bc6d;if(!_0x55f036||typeof _0x55f036!==_0x4a66f9(0x86c)||!_0x55f036[_0x4a66f9(0x478)]('@[['))return _0x55f036;return _0x55f036[_0x4a66f9(0x1bb)](/@\[\[([^\]]+)\]\]/g,(_0x1ca86a,_0x855dea)=>{const _0x474b63=_0x4a66f9,_0xdbbdc8=_0x855dea[_0x474b63(0x13f9)]();let _0x581b04;return _0x453ffd&&_0x453ffd['isGroup']?_0x581b04=_0x1e2056(_0x453ffd,_0xdbbdc8):_0x581b04=_0x2e9dd1(_0xdbbdc8),'@'+_0x581b04;});}function _0x2c9509(_0x3ae101,_0x19d6a2,_0x5618a2={}){return new Promise(_0x344dcc=>{const _0x462194=_0x1efc;_0x631e3b=_0x344dcc,_0x1c84f0[_0x462194(0x766)]=_0x3ae101,_0x2f73e7['innerHTML']='<p>'+_0x19d6a2+_0x462194(0x4cf);const _0x26a8ac=document[_0x462194(0x9a3)](_0x462194(0x116b)),_0x3bdae6=document[_0x462194(0x9a3)](_0x462194(0x92a));_0x3bdae6[_0x462194(0x20f)][_0x462194(0x115d)]=_0x462194(0x10c8),_0x26a8ac[_0x462194(0x766)]=_0x5618a2[_0x462194(0x40c)]||'确定',_0x3bdae6[_0x462194(0x766)]=_0x5618a2['cancelText']||'取消',_0x5618a2[_0x462194(0xc35)]?_0x26a8ac[_0x462194(0x4d8)]['add'](_0x5618a2['confirmButtonClass']):_0x26a8ac[_0x462194(0x4d8)][_0x462194(0x133d)](_0x462194(0xf5b)),_0x26a8ac[_0x462194(0x4ce)]=()=>{_0x344dcc(!![]),_0x5551e4();},_0x3bdae6[_0x462194(0x4ce)]=()=>{_0x344dcc(![]),_0x5551e4();},_0x48a87a();});}function _0x383892(_0x7d1c0c=_0x48bc6d(0xc1b),_0x389df7=_0x48bc6d(0x14ec)){const _0x33eccc=_0x48bc6d,_0x5722ee=document[_0x33eccc(0xe94)](_0x33eccc(0x8ca));_0x5722ee[_0x33eccc(0x766)]=_0x7d1c0c,_0x5722ee[_0x33eccc(0x20f)][_0x33eccc(0x6c0)]=_0x33eccc(0x128b)+(_0x389df7===_0x33eccc(0x14ec)?_0x33eccc(0xb10):_0x33eccc(0xb8d))+_0x33eccc(0x1509),document[_0x33eccc(0x7c3)][_0x33eccc(0x983)](_0x5722ee),setTimeout(()=>{const _0x1d7db0=_0x33eccc;_0x5722ee['style']['opacity']='1',_0x5722ee[_0x1d7db0(0x20f)][_0x1d7db0(0x352)]=_0x1d7db0(0x1067);},0xa),setTimeout(()=>{const _0x31b8b1=_0x33eccc;_0x5722ee[_0x31b8b1(0x20f)]['opacity']='0',_0x5722ee['style'][_0x31b8b1(0x352)]=_0x31b8b1(0x751),setTimeout(()=>{_0x5722ee['remove']();},0x12c);},0x7d0);}function _0x38e31c(_0x5f0e20){const _0x1fd204=_0x48bc6d;let _0x516a3f=(_0x5f0e20||_0x1fd204(0xecf))[_0x1fd204(0x1bb)](/[^a-zA-Z0-9\u4e00-\u9fa5\s]/g,'_')['replace'](/\s+/g,'_')['substring'](0x0,0x1e);const _0x1f84d2=new Date()[_0x1fd204(0xccf)]()[_0x1fd204(0x1bb)](/[-:]/g,'')['replace']('T','_')[_0x1fd204(0x1536)]('.')[0x0];return _0x516a3f+'_'+_0x1f84d2+_0x1fd204(0x1335);}function _0x40069b(_0x169a11,_0x4906f8){const _0xa22e23=_0x48bc6d;try{const _0x2ed1d6=_0x38e31c(_0x4906f8),_0x462ad2=document['createElement']('a');_0x462ad2[_0xa22e23(0xe6b)]=_0x169a11,_0x462ad2[_0xa22e23(0xed2)]=_0x2ed1d6,_0x462ad2[_0xa22e23(0x20f)][_0xa22e23(0x115d)]=_0xa22e23(0x8e0),document[_0xa22e23(0x7c3)][_0xa22e23(0x983)](_0x462ad2),_0x462ad2['click'](),setTimeout(()=>{const _0x56f321=_0xa22e23;document[_0x56f321(0x7c3)]['removeChild'](_0x462ad2);},0x64),_0x383892(_0xa22e23(0xc1b));}catch(_0x1a350a){console[_0xa22e23(0x3b7)](_0xa22e23(0x4d3),_0x1a350a),_0x383892(_0xa22e23(0xdd2),_0xa22e23(0x3b7));}}function _0x403a62(_0x138a72,_0x44c7f5){return new Promise(_0x49744c=>{const _0x415e64=_0x1efc;_0x631e3b=_0x49744c,_0x1c84f0['textContent']=_0x138a72,_0x2f73e7[_0x415e64(0xeb2)]='<p\x20style=\x22text-align:\x20left;\x20white-space:\x20pre-wrap;\x22>'+_0x44c7f5+'</p>';const _0x1a65b0=document[_0x415e64(0x9a3)](_0x415e64(0x116b)),_0x3bd87c=document[_0x415e64(0x9a3)](_0x415e64(0x92a));_0x3bd87c[_0x415e64(0x20f)][_0x415e64(0x115d)]='none',_0x1a65b0['textContent']='好的',_0x1a65b0[_0x415e64(0x4ce)]=()=>{const _0x432708=_0x415e64;_0x3bd87c[_0x432708(0x20f)]['display']=_0x432708(0x10c8),_0x1a65b0[_0x432708(0x766)]='确定',_0x49744c(!![]),_0x5551e4();},_0x48a87a();});}async function _0x224577(_0x44cfcc,_0x2b6a1f=_0x48bc6d(0xfaf)){const _0x2983c9=_0x48bc6d;if(!_0x44cfcc){await _0x403a62(_0x2983c9(0x147d),'没有可复制的内容。');return;}try{await navigator['clipboard'][_0x2983c9(0xc85)](_0x44cfcc),await _0x403a62(_0x2983c9(0x13eb),_0x2b6a1f);}catch(_0xbb3a38){console[_0x2983c9(0x3b7)](_0x2983c9(0x12ad),_0xbb3a38),await _0x403a62(_0x2983c9(0x147d),_0x2983c9(0x6be));}}function _0x3ab788(_0x3650b0,_0x42b11d,_0x114f14='',_0x413670=_0x48bc6d(0x13ca),_0x2a9b12=''){return new Promise(_0x5c5aef=>{const _0x4afef5=_0x1efc;_0x631e3b=_0x5c5aef,_0x1c84f0['textContent']=_0x3650b0;const _0xcf5197=_0x4afef5(0x26f),_0x393ef9=_0x413670===_0x4afef5(0x8db)?_0x4afef5(0x211)+_0xcf5197+'\x22\x20placeholder=\x22'+_0x42b11d+_0x4afef5(0xf3b)+_0x114f14+'</textarea>':_0x4afef5(0xc8e)+_0x413670+_0x4afef5(0x1074)+_0xcf5197+_0x4afef5(0x83e)+_0x42b11d+_0x4afef5(0x55e)+_0x114f14+'\x22>';_0x2f73e7[_0x4afef5(0xeb2)]=_0x2a9b12+_0x393ef9;const _0x3854d4=document['getElementById'](_0xcf5197);_0x2f73e7['querySelectorAll']('.format-btn')[_0x4afef5(0x15c1)](_0x402365=>{const _0x15c75a=_0x4afef5;_0x402365[_0x15c75a(0x954)](_0x15c75a(0x9cc),()=>{const _0x57e2b4=_0x15c75a,_0x20e289=_0x402365[_0x57e2b4(0xd8d)][_0x57e2b4(0x10bc)];if(_0x20e289)try{const _0x105ac1=JSON['parse'](_0x20e289);_0x3854d4[_0x57e2b4(0x7b2)]=JSON[_0x57e2b4(0xe1e)](_0x105ac1,null,0x2),_0x3854d4['focus']();}catch(_0x12903c){console[_0x57e2b4(0x3b7)]('解析格式模板失败:',_0x12903c);}});});const _0x43ee58=document[_0x4afef5(0x9a3)](_0x4afef5(0x116b)),_0x384028=document[_0x4afef5(0x9a3)](_0x4afef5(0x92a));_0x43ee58[_0x4afef5(0x4ce)]=()=>{const _0x47cd5b=_0x4afef5;_0x5c5aef(_0x3854d4[_0x47cd5b(0x7b2)]),_0x5551e4();},_0x384028[_0x4afef5(0x4ce)]=()=>{_0x5c5aef(null),_0x5551e4();},_0x48a87a(),setTimeout(()=>_0x3854d4[_0x4afef5(0xdcf)](),0x64);});}function _0x49acac(_0x343880,_0x5a4451){const _0x19a306=_0x48bc6d;return new Promise(_0x529a5a=>{const _0x2a3eaa=_0x1efc,_0xec8f0a=document[_0x2a3eaa(0x9a3)](_0x2a3eaa(0x6d4)),_0x3d09b6=document[_0x2a3eaa(0x9a3)](_0x2a3eaa(0x1047)),_0x29fa0f=document['getElementById'](_0x2a3eaa(0x6fe)),_0x5a0147=document[_0x2a3eaa(0xc86)](_0x2a3eaa(0x109b));_0x3d09b6[_0x2a3eaa(0x766)]=_0x343880,_0x29fa0f[_0x2a3eaa(0xeb2)]='',_0x5a0147[_0x2a3eaa(0xeb2)]='',_0x5a0147[_0x2a3eaa(0x20f)][_0x2a3eaa(0x1580)]='column',_0x5a4451[_0x2a3eaa(0x15c1)](_0x4821e3=>{const _0x30ccb5=_0x2a3eaa,_0x45e388=document['createElement']('button');_0x45e388[_0x30ccb5(0x766)]=_0x4821e3[_0x30ccb5(0x13ca)],_0x45e388['onclick']=()=>{const _0x331312=_0x30ccb5;_0xec8f0a[_0x331312(0x4d8)]['remove'](_0x331312(0xc09)),_0x529a5a(_0x4821e3['value']);},_0x5a0147[_0x30ccb5(0x983)](_0x45e388);});const _0x4c015b=document[_0x2a3eaa(0xe94)](_0x2a3eaa(0xd38));_0x4c015b[_0x2a3eaa(0x766)]='取消',_0x4c015b[_0x2a3eaa(0x20f)]['marginTop']=_0x2a3eaa(0x897),_0x4c015b[_0x2a3eaa(0x20f)]['borderRadius']=_0x2a3eaa(0x897),_0x4c015b['style'][_0x2a3eaa(0x87e)]=_0x2a3eaa(0xea7),_0x4c015b[_0x2a3eaa(0x4ce)]=()=>{const _0x13f8a4=_0x2a3eaa;_0xec8f0a[_0x13f8a4(0x4d8)][_0x13f8a4(0x133d)](_0x13f8a4(0xc09)),_0x529a5a(null);},_0x5a0147['appendChild'](_0x4c015b),_0xec8f0a[_0x2a3eaa(0x4d8)][_0x2a3eaa(0xe05)]('visible');})[_0x19a306(0x105c)](()=>{const _0x470413=_0x19a306,_0x34da1e=document['querySelector']('#custom-modal\x20.custom-modal-footer');_0x34da1e[_0x470413(0x20f)][_0x470413(0x1580)]=_0x470413(0xdf9),_0x34da1e[_0x470413(0xeb2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-confirm\x22\x20class=\x22confirm-btn\x22>确定</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',document[_0x470413(0x9a3)]('custom-modal-cancel')[_0x470413(0x954)](_0x470413(0x9cc),_0x5551e4);});}async function _0x58c2db(){const _0x11bdda=_0x48bc6d,_0x37d853=await _0x49acac(_0x11bdda(0xb7d),[{'text':_0x11bdda(0x1011),'value':_0x11bdda(0x1243)},{'text':'📋\x20直接粘贴歌词文本','value':'paste'}]);if(_0x37d853==='file')return new Promise(_0x11e097=>{const _0x57c2a4=_0x11bdda,_0x4fe907=document['getElementById'](_0x57c2a4(0x286)),_0x137c40=_0x5cdb76=>{const _0x5c8034=_0x57c2a4,_0x555fcb=_0x5cdb76[_0x5c8034(0xa41)]['files'][0x0];if(_0x555fcb){const _0x348cd3=new FileReader();_0x348cd3[_0x5c8034(0xdd7)]=_0x40e512=>_0x11e097(_0x40e512[_0x5c8034(0xa41)][_0x5c8034(0x5c9)]),_0x348cd3[_0x5c8034(0xb8b)]=()=>_0x11e097(''),_0x348cd3[_0x5c8034(0x1394)](_0x555fcb);}else _0x11e097(null);_0x4fe907[_0x5c8034(0xd7f)](_0x5c8034(0xbbc),_0x137c40),_0x4fe907[_0x5c8034(0x7b2)]='';};_0x4fe907[_0x57c2a4(0x954)](_0x57c2a4(0xbbc),_0x137c40,{'once':!![]}),_0x4fe907[_0x57c2a4(0x9cc)]();});else{if(_0x37d853===_0x11bdda(0x1083)){const _0x514b1f=await _0x3ab788(_0x11bdda(0x138b),_0x11bdda(0x8d5),'',_0x11bdda(0x8db));if(_0x514b1f){const _0x138c0b=_0x514b1f['replace'](/\[/g,'\x0a[')[_0x11bdda(0x13f9)]();return _0x138c0b;}return _0x514b1f;}else return null;}}_0x512070[_0x48bc6d(0x12ac)](0x28)[_0x48bc6d(0x1345)]({'doubanPosts':_0x48bc6d(0x733),'chats':'&id,\x20isGroup,\x20groupId,\x20isPinned,\x20memos,\x20diary,\x20appUsageLog,\x20lastIntelligentSummaryTimestamp','apiConfig':_0x48bc6d(0x141d),'globalSettings':_0x48bc6d(0x14dd),'userStickers':_0x48bc6d(0xe7c),'worldBooks':_0x48bc6d(0xd71),'worldBookCategories':_0x48bc6d(0x338),'musicLibrary':_0x48bc6d(0x14dd),'personaPresets':_0x48bc6d(0x14dd),'qzoneSettings':_0x48bc6d(0x14dd),'qzonePosts':_0x48bc6d(0x8a7),'qzoneAlbums':_0x48bc6d(0x13f3),'qzonePhotos':_0x48bc6d(0xe69),'favorites':_0x48bc6d(0xe0f),'qzoneGroups':_0x48bc6d(0x338),'memories':_0x48bc6d(0xf65),'callRecords':'++id,\x20chatId,\x20timestamp,\x20customName','shoppingProducts':'++id,\x20name,\x20description','shoppingCategories':_0x48bc6d(0x338),'apiPresets':_0x48bc6d(0x338),'renderingRules':'++id,\x20name,\x20chatId','appearancePresets':_0x48bc6d(0x8ea),'stickerCategories':'++id,\x20name','customAvatarFrames':_0x48bc6d(0x338),'presets':_0x48bc6d(0xd71),'presetCategories':_0x48bc6d(0x338),'readingLibrary':_0x48bc6d(0x1ee),'npcs':_0x48bc6d(0xdaf),'npcGroups':'++id,\x20name'})[_0x48bc6d(0x3fb)](_0x2eaf3a=>{const _0x105cd2=_0x48bc6d;return _0x2eaf3a['table'](_0x105cd2(0x8e4))['toCollection']()[_0x105cd2(0x572)](_0x23aa7c=>{const _0x2c5104=_0x105cd2;if(typeof _0x23aa7c[_0x2c5104(0x4e3)]===_0x2c5104(0x86c)&&_0x23aa7c[_0x2c5104(0x4e3)][_0x2c5104(0x13f9)]()!=='')_0x23aa7c['content']=[{'keys':[],'comment':_0x2c5104(0x1042),'content':_0x23aa7c[_0x2c5104(0x4e3)]}];else!Array[_0x2c5104(0xb9b)](_0x23aa7c[_0x2c5104(0x4e3)])&&(_0x23aa7c[_0x2c5104(0x4e3)]=[]);_0x23aa7c['content']['forEach'](_0x3977fe=>{const _0x114531=_0x2c5104;typeof _0x3977fe[_0x114531(0x15cd)]==='undefined'&&(_0x3977fe['enabled']=!![]);});});}),window['db']=_0x512070;function _0x35df44(_0x47a892){const _0x545ffb=_0x48bc6d;_0x47a892===_0x545ffb(0xd7c)&&(window['renderChatListProxy'](),_0x499463(_0x545ffb(0xdd5)));if(_0x47a892==='api-settings-screen')window[_0x545ffb(0x99b)]();if(_0x47a892===_0x545ffb(0x76c))window['renderWallpaperScreenProxy']();if(_0x47a892===_0x545ffb(0x1450))window[_0x545ffb(0x64a)]();if(_0x47a892==='x-social-screen')window['renderXSocialScreenProxy']();if(_0x47a892===_0x545ffb(0xfd4))_0x14f0bc();document[_0x545ffb(0x131c)](_0x545ffb(0xce2))['forEach'](_0x16ae92=>_0x16ae92['classList'][_0x545ffb(0x133d)](_0x545ffb(0xe9f)));const _0x4df1d4=document[_0x545ffb(0x9a3)](_0x47a892);if(_0x4df1d4)_0x4df1d4[_0x545ffb(0x4d8)][_0x545ffb(0xe05)](_0x545ffb(0xe9f));if(_0x47a892===_0x545ffb(0x3e5))window['updateListenTogetherIconProxy'](_0x19ddb8[_0x545ffb(0x859)]);_0x47a892===_0x545ffb(0x86f)&&(_0x23ca7e(),document[_0x545ffb(0x9a3)](_0x545ffb(0x19e))[_0x545ffb(0x7b2)]=_0x19ddb8['globalSettings']['fontUrl']||'',_0x124e17(_0x19ddb8[_0x545ffb(0x4c8)]['fontUrl']||'',!![]));}window[_0x48bc6d(0x96e)]=()=>{};function _0x499463(_0x3bef64){const _0x1f55a2=_0x48bc6d,_0xe2f728=document[_0x1f55a2(0x9a3)]('chat-list-screen'),_0x3ed603={'messages-view':document[_0x1f55a2(0x9a3)](_0x1f55a2(0xdd5)),'qzone-screen':document['getElementById'](_0x1f55a2(0x659)),'favorites-view':document[_0x1f55a2(0x9a3)](_0x1f55a2(0x8a8)),'memories-view':document['getElementById'](_0x1f55a2(0xd8b)),'npc-list-view':document[_0x1f55a2(0x9a3)](_0x1f55a2(0x1363))},_0x150c0e=document[_0x1f55a2(0x9a3)]('main-chat-list-header'),_0x5303cd=document[_0x1f55a2(0x9a3)](_0x1f55a2(0xc5d));_0x1fa4d3&&document['getElementById'](_0x1f55a2(0xf68))[_0x1f55a2(0x9cc)]();Object[_0x1f55a2(0xea1)](_0x3ed603)[_0x1f55a2(0x15c1)](_0x381451=>_0x381451[_0x1f55a2(0x4d8)]['remove'](_0x1f55a2(0xe9f)));_0x3ed603[_0x3bef64]&&_0x3ed603[_0x3bef64][_0x1f55a2(0x4d8)]['add'](_0x1f55a2(0xe9f));document[_0x1f55a2(0x131c)](_0x1f55a2(0x111a))[_0x1f55a2(0x15c1)](_0x334215=>{const _0x3f3744=_0x1f55a2;_0x334215['classList'][_0x3f3744(0xc02)](_0x3f3744(0xe9f),_0x334215[_0x3f3744(0xd8d)][_0x3f3744(0x1f8)]===_0x3bef64);});_0x3bef64===_0x1f55a2(0xdd5)?(_0x150c0e[_0x1f55a2(0x20f)]['display']=_0x1f55a2(0x79c),_0x5303cd[_0x1f55a2(0x20f)][_0x1f55a2(0x115d)]='flex'):(_0x150c0e['style'][_0x1f55a2(0x115d)]='none',_0x5303cd[_0x1f55a2(0x20f)][_0x1f55a2(0x115d)]=_0x1f55a2(0x8e0));_0x3bef64!=='memories-view'&&(_0x4c15cc[_0x1f55a2(0x15c1)](_0x12916e=>clearInterval(_0x12916e)),_0x4c15cc=[]);switch(_0x3bef64){case _0x1f55a2(0x659):_0x3ed603[_0x1f55a2(0x659)][_0x1f55a2(0x20f)]['backgroundColor']=_0x1f55a2(0xee8),_0x28172c(0x0),_0x31ad99(),_0x49acff();break;case _0x1f55a2(0x8a8):_0x3ed603[_0x1f55a2(0x8a8)][_0x1f55a2(0x20f)]['backgroundColor']='#f9f9f9',_0x332542();break;case _0x1f55a2(0xdd5):break;case _0x1f55a2(0x1363):_0x55c16f();break;}}function _0x228909(){const _0x19d5d3=_0x48bc6d;console[_0x19d5d3(0xe4d)](_0x19d5d3(0xe2c));}window[_0x48bc6d(0x647)]=_0x228909;function _0x31ad99(){const _0x48a1c8=_0x48bc6d;if(_0x19ddb8&&_0x19ddb8['qzoneSettings']){const _0x36aeb2=_0x19ddb8[_0x48a1c8(0x9ce)];document[_0x48a1c8(0x9a3)](_0x48a1c8(0x26b))['textContent']=_0x36aeb2[_0x48a1c8(0x246)],document[_0x48a1c8(0x9a3)](_0x48a1c8(0xd21))[_0x48a1c8(0x10d4)]=_0x36aeb2[_0x48a1c8(0xf3f)],document[_0x48a1c8(0x9a3)](_0x48a1c8(0x13bc))[_0x48a1c8(0x10d4)]=_0x36aeb2[_0x48a1c8(0x5d0)];}}window[_0x48bc6d(0x1432)]=_0x31ad99;async function _0xa4e34a(){const _0x26b5b2=_0x48bc6d;_0x512070&&_0x19ddb8['qzoneSettings']&&await _0x512070[_0x26b5b2(0x9ce)][_0x26b5b2(0xd4d)](_0x19ddb8[_0x26b5b2(0x9ce)]);}function _0x2308d1(_0x1365da){const _0x321cff=_0x48bc6d;if(!_0x1365da)return'';const _0x2732c3=new Date(),_0x5009eb=new Date(_0x1365da),_0x480e1c=Math[_0x321cff(0xd95)]((_0x2732c3-_0x5009eb)/0x3e8),_0x47e94f=Math['floor'](_0x480e1c/0x3c),_0x5d3e1c=Math[_0x321cff(0xd95)](_0x47e94f/0x3c);if(_0x47e94f<0x1)return'刚刚';if(_0x47e94f<0x3c)return _0x47e94f+_0x321cff(0xe16);if(_0x5d3e1c<0x18)return _0x5d3e1c+'小时前';const _0x33e2a1=_0x5009eb[_0x321cff(0xef7)](),_0x5d52b0=String(_0x5009eb['getMonth']()+0x1)['padStart'](0x2,'0'),_0x24c6a4=String(_0x5009eb[_0x321cff(0x67c)]())[_0x321cff(0x1488)](0x2,'0'),_0x106364=String(_0x5009eb['getHours']())[_0x321cff(0x1488)](0x2,'0'),_0xcb4a0a=String(_0x5009eb[_0x321cff(0xa21)]())[_0x321cff(0x1488)](0x2,'0');return _0x2732c3[_0x321cff(0xef7)]()===_0x33e2a1?_0x5d52b0+'-'+_0x24c6a4+'\x20'+_0x106364+':'+_0xcb4a0a:_0x33e2a1+'-'+_0x5d52b0+'-'+_0x24c6a4+'\x20'+_0x106364+':'+_0xcb4a0a;}function _0x38586f(_0x480faf){const _0x1b13a9=_0x48bc6d,_0x21e8ce=document[_0x1b13a9(0xc86)](_0x1b13a9(0x7fe)+_0x480faf['id']+'\x22]'),_0x1a0895=!!_0x21e8ce,_0x92746b=_0x1a0895?_0x21e8ce:document[_0x1b13a9(0xe94)](_0x1b13a9(0x8ca));!_0x1a0895&&(_0x92746b[_0x1b13a9(0x1487)]=_0x1b13a9(0xe17),_0x92746b[_0x1b13a9(0xd8d)][_0x1b13a9(0xb92)]=_0x480faf['id']);const _0xb7af09=_0x1a0895?_0x92746b[_0x1b13a9(0xc86)](_0x1b13a9(0x6cb)):document[_0x1b13a9(0xe94)]('div');!_0x1a0895&&(_0xb7af09[_0x1b13a9(0x1487)]=_0x1b13a9(0x540));let _0x31b924='',_0x2e8bfa='',_0xe60f14=_0x19ddb8['qzoneSettings'][_0x1b13a9(0xf3f)];if(_0x480faf[_0x1b13a9(0x82c)]==='user')_0x31b924=_0x19ddb8[_0x1b13a9(0x9ce)][_0x1b13a9(0xf3f)],_0x2e8bfa=_0x19ddb8[_0x1b13a9(0x9ce)][_0x1b13a9(0x246)];else{if(_0x19ddb8['chats'][_0x480faf[_0x1b13a9(0x82c)]]){const _0xd5ee02=_0x19ddb8[_0x1b13a9(0xb04)][_0x480faf[_0x1b13a9(0x82c)]];_0x31b924=_0xd5ee02[_0x1b13a9(0x450)][_0x1b13a9(0x4fe)]||_0x4f81ff,_0x2e8bfa=_0xd5ee02['name'];}else _0x2e8bfa=_0x2e9dd1(_0x480faf['authorOriginalName']),_0x31b924=_0x4f81ff;}function _0x2218ae(_0x539957){const _0x56e7f4=_0x1b13a9;let _0x257c5='';const _0x16f554=_0x539957[_0x56e7f4(0x6b9)]?_0x56e7f4(0xe73)+_0x49f635(_0x539957[_0x56e7f4(0x6b9)])[_0x56e7f4(0x1bb)](/\n/g,'<br>')+_0x56e7f4(0x826):'';if(_0x539957['type']===_0x56e7f4(0x23d))_0x257c5=_0x56e7f4(0x145d)+_0x49f635(_0x539957['content'])[_0x56e7f4(0x1bb)](/\n/g,_0x56e7f4(0x609))+_0x56e7f4(0x826);else{if(_0x539957[_0x56e7f4(0x1508)]===_0x56e7f4(0x1016)&&_0x539957[_0x56e7f4(0xbfe)])_0x257c5=_0x16f554?_0x16f554+_0x56e7f4(0xe26)+_0x539957[_0x56e7f4(0xbfe)]+_0x56e7f4(0x1558):_0x56e7f4(0x887)+_0x539957['imageUrl']+_0x56e7f4(0x993);else{if(_0x539957[_0x56e7f4(0x1508)]===_0x56e7f4(0x1281)){const _0x9351e1=_0x19ddb8['globalSettings'][_0x56e7f4(0x853)]&&_0x539957[_0x56e7f4(0xb95)]?_0x56e7f4(0x10a3)+_0x539957[_0x56e7f4(0xb95)]:_0x56e7f4(0x273);_0x257c5=_0x16f554?_0x16f554+_0x56e7f4(0xe26)+_0x9351e1+_0x56e7f4(0x7fc)+_0x539957[_0x56e7f4(0x14bb)]+_0x56e7f4(0xe8a):_0x56e7f4(0x887)+_0x9351e1+_0x56e7f4(0x7fc)+_0x539957[_0x56e7f4(0x14bb)]+'\x22>';}else{if(_0x539957['type']===_0x56e7f4(0x1300)){const _0x48d970=_0x539957[_0x56e7f4(0x739)]||(_0x539957['imageUrl']?[_0x539957[_0x56e7f4(0xbfe)]]:[]);if(_0x48d970[_0x56e7f4(0x106b)]>0x0){const _0x1e260c=_0x48d970[_0x56e7f4(0x106b)];let _0x4659db='';_0x4659db='<div\x20class=\x22post-images-grid\x20grid-'+_0x1e260c+'\x22>',_0x48d970[_0x56e7f4(0x15c1)]((_0x3f0f0e,_0x38c1d0)=>{const _0x26237e=_0x56e7f4;_0x4659db+=_0x26237e(0x887)+_0x3f0f0e+'\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片'+(_0x38c1d0+0x1)+_0x26237e(0xad0);}),_0x4659db+=_0x56e7f4(0x826),_0x257c5=_0x16f554?''+_0x16f554+_0x4659db:_0x4659db;}}}}}return _0x257c5;}let _0x2682db;if(_0x480faf['type']===_0x1b13a9(0x5ee)){const _0x5c4db8=_0x480faf[_0x1b13a9(0x3eb)]?_0x1b13a9(0xe73)+_0x49f635(_0x480faf['repostComment'])['replace'](/\n/g,'<br>')+_0x1b13a9(0x826):'';let _0xcd7f35=_0x4f81ff,_0x594ff6=_0x1b13a9(0x423);if(_0x480faf[_0x1b13a9(0x327)][_0x1b13a9(0x82c)]==='user')_0xcd7f35=_0x19ddb8['qzoneSettings'][_0x1b13a9(0xf3f)],_0x594ff6=_0x19ddb8[_0x1b13a9(0x9ce)][_0x1b13a9(0x246)];else{const _0x2136d5=_0x19ddb8[_0x1b13a9(0xb04)][_0x480faf[_0x1b13a9(0x327)][_0x1b13a9(0x82c)]];_0x2136d5&&(_0xcd7f35=_0x2136d5['settings'][_0x1b13a9(0x4fe)]||_0x4f81ff),_0x594ff6=_0x2e9dd1(_0x480faf[_0x1b13a9(0x327)][_0x1b13a9(0x820)]);}_0x2682db=_0x1b13a9(0xc72)+_0x5c4db8+_0x1b13a9(0xebf)+_0xcd7f35+_0x1b13a9(0x84f)+_0x594ff6+_0x1b13a9(0xc31)+_0x2308d1(_0x480faf[_0x1b13a9(0x327)][_0x1b13a9(0xd73)])+_0x1b13a9(0x1584)+_0x2218ae(_0x480faf[_0x1b13a9(0x327)])+_0x1b13a9(0x1384);}else _0x2682db=_0x1b13a9(0x105e)+_0x2218ae(_0x480faf)+_0x1b13a9(0x826);let _0x23e237='';if(_0x480faf[_0x1b13a9(0x807)]&&_0x480faf['likes'][_0x1b13a9(0x106b)]>0x0){const _0x5070fd=_0x480faf[_0x1b13a9(0x807)][_0x1b13a9(0xb0a)](_0x136552=>_0x2e9dd1(_0x136552))['join']('、');_0x23e237=_0x1b13a9(0xf4a)+_0x5070fd+_0x1b13a9(0x1592);}let _0x200d7d='';_0x480faf[_0x1b13a9(0xc79)]&&_0x480faf[_0x1b13a9(0xc79)][_0x1b13a9(0x106b)]>0x0&&(_0x200d7d=_0x1b13a9(0x257),_0x480faf[_0x1b13a9(0xc79)]['forEach']((_0x1c9295,_0x3e86b3)=>{const _0x3623ed=_0x1b13a9;if(typeof _0x1c9295===_0x3623ed(0x12fe)&&_0x1c9295!==null&&_0x1c9295[_0x3623ed(0x1200)]){const _0x354bd5=_0x1c9295[_0x3623ed(0x1200)],_0x1c4ee7=_0x2e9dd1(_0x354bd5);let _0x3390b0;_0x115b0e['test'](_0x1c9295['text'])?_0x3390b0=_0x3623ed(0x887)+_0x1c9295['text']+_0x3623ed(0xf30):_0x3390b0=_0x49f635(_0x1c9295[_0x3623ed(0x13ca)]);let _0x3aba63='';if(_0x1c9295[_0x3623ed(0x877)]){const _0x268785=_0x2e9dd1(_0x1c9295[_0x3623ed(0x877)]);_0x3aba63=_0x3623ed(0x75f)+_0x1c4ee7+_0x3623ed(0xf24)+_0x268785+_0x3623ed(0x99d)+_0x3390b0;}else _0x3aba63=_0x3623ed(0x75f)+_0x1c4ee7+'</span>:\x20'+_0x3390b0;_0x200d7d+=_0x3623ed(0xcdd)+_0x480faf['id']+_0x3623ed(0xe7d)+_0x354bd5+_0x3623ed(0x656)+_0x1c4ee7+_0x3623ed(0x155e)+_0x3aba63+_0x3623ed(0xcfb)+_0x3e86b3+_0x3623ed(0xd0d);}else _0x200d7d+=_0x3623ed(0x3a4)+_0x49f635(String(_0x1c9295))+_0x3623ed(0x1495);}),_0x200d7d+='</div>');const _0x64d9ff=_0x19ddb8[_0x1b13a9(0x9ce)][_0x1b13a9(0x246)],_0xf47ac7=_0x480faf['likes']&&_0x480faf[_0x1b13a9(0x807)][_0x1b13a9(0x478)](_0x64d9ff),_0x400e0a=_0x19ddb8[_0x1b13a9(0xe0c)]&&_0x19ddb8[_0x1b13a9(0xe0c)]['has'](_0x480faf['id']);let _0x2695dc='';_0x480faf['type']!==_0x1b13a9(0x5ee)&&(_0x2695dc='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>');_0xb7af09[_0x1b13a9(0xeb2)]=_0x1b13a9(0x3d3)+_0x31b924+_0x1b13a9(0xf35)+_0x480faf['authorId']+_0x1b13a9(0x1227)+_0x2e8bfa+_0x1b13a9(0x72f)+_0x2308d1(_0x480faf[_0x1b13a9(0xd73)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2682db+_0x1b13a9(0x381)+_0x2695dc+_0x1b13a9(0xe71)+(_0xf47ac7?'active':'')+_0x1b13a9(0x1473)+(_0x400e0a?_0x1b13a9(0xe9f):'')+_0x1b13a9(0x1060)+_0x23e237+_0x1b13a9(0x127e)+_0x200d7d+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0xe60f14+'\x22\x20class=\x22comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22comment-input\x22\x20placeholder=\x22友善的评论是交流的起点\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-sticker-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8\x2014\x20Q\x2012\x2016\x2016\x2014\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x229\x22\x20y1=\x229\x22\x20x2=\x229.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2215\x22\x20y1=\x229\x22\x20x2=\x2215.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22at-mention-popup\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-send-btn\x22>发送</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';if(!_0x1a0895){const _0x86b837=document[_0x1b13a9(0xe94)](_0x1b13a9(0x8ca));_0x86b837[_0x1b13a9(0x1487)]=_0x1b13a9(0x149b),_0x86b837[_0x1b13a9(0xeb2)]=_0x1b13a9(0x584),_0x92746b[_0x1b13a9(0x983)](_0xb7af09),_0x92746b['appendChild'](_0x86b837);}return _0x92746b;}async function _0x3d54a9(_0x223384){const _0x379c3b=_0x48bc6d,_0x29a3aa=await _0x512070[_0x379c3b(0x10e5)][_0x379c3b(0x14ee)](_0x223384);if(!_0x29a3aa){const _0x4519d9=document['querySelector'](_0x379c3b(0x7fe)+_0x223384+'\x22]');if(_0x4519d9)_0x4519d9[_0x379c3b(0x133d)]();return;}const _0x1758f4=_0x1f6575[_0x379c3b(0x455)](_0x2c5a2d=>_0x2c5a2d['id']===_0x223384);if(_0x1758f4>-0x1)_0x1f6575[_0x1758f4]=_0x29a3aa;const _0x1936a2=await _0x512070['favorites'][_0x379c3b(0x1201)](_0x379c3b(0x1508))['equals'](_0x379c3b(0x120f))['toArray']();_0x19ddb8['favoritedPostIds']=new Set(_0x1936a2[_0x379c3b(0xb0a)](_0x42942f=>_0x42942f[_0x379c3b(0x4e3)]['id'])),_0x38586f(_0x29a3aa);}function _0x5d6abc(_0x5d8c49){const _0x424f1f=_0x48bc6d,_0x53f9cc=Date[_0x424f1f(0x64b)](),_0x4b2fe1=Math[_0x424f1f(0xd95)]((_0x53f9cc-_0x5d8c49)/0x3e8),_0x3ffd17=Math[_0x424f1f(0xd95)](_0x4b2fe1/0x3c);if(_0x3ffd17<0x2)return'刚刚';if(_0x3ffd17<0x3c)return _0x3ffd17+_0x424f1f(0xe16);const _0x5d6925=Math[_0x424f1f(0xd95)](_0x3ffd17/0x3c);if(_0x5d6925<0x18)return _0x5d6925+'小时前';const _0x161b93=Math[_0x424f1f(0xd95)](_0x5d6925/0x18);return _0x161b93+'天前';}async function _0x38586f(_0x860bdc){const _0x57f554=_0x48bc6d,_0x18ecda=document[_0x57f554(0xc86)](_0x57f554(0x7fe)+_0x860bdc['id']+'\x22]'),_0x148abf=!!_0x18ecda,_0x179cc0=_0x148abf?_0x18ecda:document[_0x57f554(0xe94)](_0x57f554(0x8ca));!_0x148abf&&(_0x179cc0[_0x57f554(0x1487)]='qzone-post-container',_0x179cc0['dataset']['postId']=_0x860bdc['id']);const _0x242b5f=_0x148abf?_0x179cc0[_0x57f554(0xc86)](_0x57f554(0x6cb)):document[_0x57f554(0xe94)](_0x57f554(0x8ca));!_0x148abf&&(_0x242b5f['className']=_0x57f554(0x540));let _0x5d56c7='',_0x43b8a0='',_0x5121d2=_0x19ddb8[_0x57f554(0x9ce)][_0x57f554(0xf3f)];if(_0x860bdc['authorId']===_0x57f554(0x20d))_0x5d56c7=_0x19ddb8[_0x57f554(0x9ce)][_0x57f554(0xf3f)],_0x43b8a0=_0x19ddb8[_0x57f554(0x9ce)]['nickname'];else{if(_0x19ddb8[_0x57f554(0xb04)][_0x860bdc[_0x57f554(0x82c)]]){const _0x353f3f=_0x19ddb8['chats'][_0x860bdc['authorId']];_0x5d56c7=_0x353f3f[_0x57f554(0x450)][_0x57f554(0x4fe)]||_0x4f81ff,_0x43b8a0=_0x353f3f[_0x57f554(0x1561)];}else{if(String(_0x860bdc[_0x57f554(0x82c)])[_0x57f554(0x608)]('npc_')){const _0x1e1431=parseInt(String(_0x860bdc['authorId'])['replace'](_0x57f554(0x136f),''));if(!isNaN(_0x1e1431)){const _0x29feea=await _0x512070['npcs'][_0x57f554(0x14ee)](_0x1e1431);_0x29feea?(_0x5d56c7=_0x29feea[_0x57f554(0xf3f)]||_0x451ae9,_0x43b8a0=_0x29feea[_0x57f554(0x1561)]):(_0x43b8a0=_0x860bdc['authorOriginalName']||'未知NPC',_0x5d56c7=_0x451ae9);}}else _0x43b8a0=_0x2e9dd1(_0x860bdc[_0x57f554(0x820)]),_0x5d56c7=_0x4f81ff;}}function _0x3ff1b7(_0xf77cd9){const _0x5f2309=_0x57f554;let _0x2818b0='';const _0x36843f=_0xf77cd9['publicText']?_0x5f2309(0xe73)+_0x49f635(_0xf77cd9[_0x5f2309(0x6b9)])[_0x5f2309(0x1bb)](/\n/g,_0x5f2309(0x609))+_0x5f2309(0x826):'';if(_0xf77cd9[_0x5f2309(0x1508)]==='shuoshuo')_0x2818b0=_0x5f2309(0x145d)+_0x49f635(_0xf77cd9[_0x5f2309(0x4e3)])[_0x5f2309(0x1bb)](/\n/g,_0x5f2309(0x609))+_0x5f2309(0x826);else{if(_0xf77cd9[_0x5f2309(0x1508)]===_0x5f2309(0x1016)&&_0xf77cd9['imageUrl'])_0x2818b0=_0x36843f?_0x36843f+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0xf77cd9['imageUrl']+_0x5f2309(0x1558):'<img\x20src=\x22'+_0xf77cd9[_0x5f2309(0xbfe)]+'\x22\x20class=\x22chat-image\x22>';else{if(_0xf77cd9[_0x5f2309(0x1508)]===_0x5f2309(0x1281)){const _0x51689e=_0x19ddb8[_0x5f2309(0x4c8)][_0x5f2309(0x853)]&&_0xf77cd9[_0x5f2309(0xb95)]?_0x5f2309(0x10a3)+_0xf77cd9[_0x5f2309(0xb95)]:_0x5f2309(0x273);_0x2818b0=_0x36843f?_0x36843f+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0x51689e+'\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22'+_0xf77cd9[_0x5f2309(0x14bb)]+_0x5f2309(0xe8a):_0x5f2309(0x887)+_0x51689e+_0x5f2309(0x7fc)+_0xf77cd9['hiddenContent']+'\x22>';}else{if(_0xf77cd9['type']===_0x5f2309(0x1300)){const _0x1ded9d=_0xf77cd9[_0x5f2309(0x739)]||(_0xf77cd9[_0x5f2309(0xbfe)]?[_0xf77cd9[_0x5f2309(0xbfe)]]:[]);if(_0x1ded9d[_0x5f2309(0x106b)]>0x0){const _0x54c43a=_0x1ded9d['length'];let _0x134a8e='';_0x134a8e=_0x5f2309(0x131f)+_0x54c43a+'\x22>',_0x1ded9d[_0x5f2309(0x15c1)]((_0x4e1fd0,_0xc794d6)=>{const _0x420e25=_0x5f2309;_0x134a8e+=_0x420e25(0x887)+_0x4e1fd0+_0x420e25(0xc1c)+(_0xc794d6+0x1)+'\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22>';}),_0x134a8e+=_0x5f2309(0x826),_0x2818b0=_0x36843f?''+_0x36843f+_0x134a8e:_0x134a8e;}}}}}return _0x2818b0;}let _0x503191;if(_0x860bdc[_0x57f554(0x1508)]==='repost'){const _0x1bd0bd=_0x860bdc[_0x57f554(0x3eb)]?'<div\x20class=\x22post-content\x22>'+_0x860bdc[_0x57f554(0x3eb)][_0x57f554(0x1bb)](/\n/g,_0x57f554(0x609))+_0x57f554(0x826):'';let _0x14974d=_0x4f81ff,_0x1cffa4=_0x57f554(0x423);if(_0x860bdc['originalPost'][_0x57f554(0x82c)]===_0x57f554(0x20d))_0x14974d=_0x19ddb8[_0x57f554(0x9ce)][_0x57f554(0xf3f)],_0x1cffa4=_0x19ddb8[_0x57f554(0x9ce)][_0x57f554(0x246)];else{const _0x453c29=_0x19ddb8[_0x57f554(0xb04)][_0x860bdc[_0x57f554(0x327)][_0x57f554(0x82c)]];_0x453c29&&(_0x14974d=_0x453c29[_0x57f554(0x450)][_0x57f554(0x4fe)]||_0x4f81ff),_0x1cffa4=_0x2e9dd1(_0x860bdc[_0x57f554(0x327)][_0x57f554(0x820)]);}_0x503191='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1bd0bd+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x14974d+'\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@'+_0x1cffa4+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>'+_0x2308d1(_0x860bdc['originalPost'][_0x57f554(0xd73)])+_0x57f554(0x1584)+_0x3ff1b7(_0x860bdc[_0x57f554(0x327)])+_0x57f554(0x1384);}else _0x503191=_0x57f554(0x105e)+_0x3ff1b7(_0x860bdc)+_0x57f554(0x826);let _0x1fdd58='';if(_0x860bdc[_0x57f554(0x807)]&&_0x860bdc[_0x57f554(0x807)][_0x57f554(0x106b)]>0x0){const _0x3bdb1a=_0x860bdc[_0x57f554(0x807)][_0x57f554(0xb0a)](_0x477a76=>_0x2e9dd1(_0x477a76))[_0x57f554(0x3b9)]('、');_0x1fdd58='<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>'+_0x3bdb1a+_0x57f554(0x1592);}let _0x11da49='';_0x860bdc[_0x57f554(0xc79)]&&_0x860bdc[_0x57f554(0xc79)][_0x57f554(0x106b)]>0x0&&(_0x11da49=_0x57f554(0x257),_0x860bdc[_0x57f554(0xc79)]['forEach']((_0x1d28a6,_0x19d9e4)=>{const _0x1870f2=_0x57f554;if(typeof _0x1d28a6===_0x1870f2(0x12fe)&&_0x1d28a6!==null&&_0x1d28a6[_0x1870f2(0x1200)]){const _0x349599=_0x1d28a6[_0x1870f2(0x1200)],_0x2ff945=_0x2e9dd1(_0x349599);let _0x3183fa;_0x115b0e['test'](_0x1d28a6[_0x1870f2(0x13ca)])?_0x3183fa=_0x1870f2(0x887)+_0x1d28a6[_0x1870f2(0x13ca)]+_0x1870f2(0xf30):_0x3183fa=_0x49f635(_0x1d28a6[_0x1870f2(0x13ca)]);let _0x465756='';if(_0x1d28a6['replyTo']){const _0x5906ac=_0x2e9dd1(_0x1d28a6[_0x1870f2(0x877)]);_0x465756='<span\x20class=\x22commenter-name\x22>'+_0x2ff945+_0x1870f2(0xf24)+_0x5906ac+_0x1870f2(0x99d)+_0x3183fa;}else _0x465756=_0x1870f2(0x75f)+_0x2ff945+_0x1870f2(0x99d)+_0x3183fa;_0x11da49+=_0x1870f2(0xcdd)+_0x860bdc['id']+_0x1870f2(0xe7d)+_0x349599+_0x1870f2(0x656)+_0x2ff945+_0x1870f2(0x155e)+_0x465756+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22'+_0x19d9e4+_0x1870f2(0xd0d);}else _0x11da49+='<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>'+String(_0x1d28a6)+_0x1870f2(0x1495);}),_0x11da49+=_0x57f554(0x826));const _0x9a7591=_0x19ddb8[_0x57f554(0x9ce)]['nickname'],_0x5927bb=_0x860bdc['likes']&&_0x860bdc['likes'][_0x57f554(0x478)](_0x9a7591),_0x436950=_0x19ddb8[_0x57f554(0xe0c)]&&_0x19ddb8[_0x57f554(0xe0c)]['has'](_0x860bdc['id']);let _0xd96206='';_0x860bdc['type']!==_0x57f554(0x5ee)&&(_0xd96206=_0x57f554(0xcfa));_0x242b5f[_0x57f554(0xeb2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x5d56c7+_0x57f554(0xf35)+_0x860bdc['authorId']+_0x57f554(0x1227)+_0x43b8a0+_0x57f554(0x72f)+_0x2308d1(_0x860bdc[_0x57f554(0xd73)])+_0x57f554(0x142d)+_0x503191+_0x57f554(0x381)+_0xd96206+_0x57f554(0xe71)+(_0x5927bb?_0x57f554(0xe9f):'')+_0x57f554(0x1473)+(_0x436950?_0x57f554(0xe9f):'')+'\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1fdd58+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x11da49+_0x57f554(0x1355)+_0x5121d2+_0x57f554(0x3be);if(!_0x148abf){const _0x24bcbf=document[_0x57f554(0xe94)](_0x57f554(0x8ca));_0x24bcbf[_0x57f554(0x1487)]=_0x57f554(0x149b),_0x24bcbf[_0x57f554(0xeb2)]=_0x57f554(0x584),_0x179cc0[_0x57f554(0x983)](_0x242b5f),_0x179cc0[_0x57f554(0x983)](_0x24bcbf);}return _0x179cc0;}async function _0x3d54a9(_0xf2bce9){const _0x8752f2=_0x48bc6d,_0x22ac2f=await _0x512070[_0x8752f2(0x10e5)][_0x8752f2(0x14ee)](_0xf2bce9);if(!_0x22ac2f){const _0x153a14=document['querySelector'](_0x8752f2(0x7fe)+_0xf2bce9+'\x22]');_0x153a14&&_0x153a14[_0x8752f2(0x133d)]();return;}const _0x2627e6=_0x1f6575[_0x8752f2(0x455)](_0x4c83ea=>_0x4c83ea['id']===_0xf2bce9);_0x2627e6>-0x1&&(_0x1f6575[_0x2627e6]=_0x22ac2f);const _0x3ed654=await _0x512070[_0x8752f2(0x73d)]['where'](_0x8752f2(0x1508))['equals'](_0x8752f2(0x120f))[_0x8752f2(0x591)]();_0x19ddb8[_0x8752f2(0xe0c)]=new Set(_0x3ed654['map'](_0x228158=>_0x228158[_0x8752f2(0x4e3)]['id'])),await _0x38586f(_0x22ac2f);}async function _0x49acff(){const _0x1ac672=_0x48bc6d,_0x1de08f=document['getElementById'](_0x1ac672(0x141a));if(!_0x1de08f)return;const [_0x2b93b0,_0x5e97bd]=await Promise[_0x1ac672(0xbf1)]([_0x512070['qzonePosts'][_0x1ac672(0x1404)](_0x1ac672(0xd73))['reverse']()['filter'](_0x5bd08c=>!_0x5bd08c[_0x1ac672(0x5b5)])['toArray'](),_0x512070[_0x1ac672(0x73d)][_0x1ac672(0x1201)](_0x1ac672(0x1508))[_0x1ac672(0x5df)]('qzone_post')[_0x1ac672(0x591)]()]);_0x1f6575=_0x2b93b0,_0x19ddb8['favoritedPostIds']=new Set(_0x5e97bd['map'](_0x2a48cc=>_0x2a48cc[_0x1ac672(0x4e3)]['id'])),_0x1de08f['innerHTML']='',_0x373876=0x0;if(_0x1f6575[_0x1ac672(0x106b)]===0x0){_0x1de08f[_0x1ac672(0xeb2)]=_0x1ac672(0x7ab);return;}_0x555d97();}async function _0x555d97(){const _0x230431=_0x48bc6d;if(_0x35cb1c)return;_0x35cb1c=!![];const _0x481c52=document[_0x230431(0x9a3)](_0x230431(0x141a));if(!_0x481c52){_0x35cb1c=![];return;}_0x3335f4(_0x481c52,_0x230431(0x837)),setTimeout(async()=>{const _0x25dfa8=_0x230431;_0x38511a(_0x481c52);const _0x1ef593=_0x373876,_0x59fc21=_0x373876+_0x427bfd,_0x47d2c6=_0x1f6575[_0x25dfa8(0x457)](_0x1ef593,_0x59fc21),_0x190264=document[_0x25dfa8(0xa4d)]();for(const _0x5b06a7 of _0x47d2c6){const _0x4fb8a8=await _0x38586f(_0x5b06a7);_0x190264[_0x25dfa8(0x983)](_0x4fb8a8);}_0x481c52['appendChild'](_0x190264),_0x373876+=_0x47d2c6[_0x25dfa8(0x106b)],_0x35cb1c=![];},0x1f4);}function _0xb1f208(_0x39187b,_0x4e8755){const _0x5b6339=_0x48bc6d,_0x5f06cc=_0x176e91[_0x5b6339(0x10cc)],_0x589092=_0x176e91[_0x5b6339(0xf1f)];_0x589092['innerHTML']='';_0x19ddb8['userStickers']['length']===0x0?_0x589092['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>请先在聊天界面的<br>表情面板中添加表情包</p>':_0x19ddb8[_0x5b6339(0x1557)][_0x5b6339(0x15c1)](_0x4414ab=>{const _0x54231d=_0x5b6339,_0x16ba72=document[_0x54231d(0xe94)](_0x54231d(0x8ca));_0x16ba72[_0x54231d(0x1487)]=_0x54231d(0x4a7),_0x16ba72[_0x54231d(0x20f)]['backgroundImage']='url('+_0x4414ab[_0x54231d(0x121f)]+')',_0x16ba72[_0x54231d(0x10b8)]=_0x4414ab[_0x54231d(0x1561)],_0x589092[_0x54231d(0x983)](_0x16ba72);});const _0x5ddb92=_0x4e8755['getBoundingClientRect'](),_0x3c1d48=document['getElementById'](_0x5b6339(0xae7))[_0x5b6339(0x31d)]();_0x5f06cc[_0x5b6339(0x20f)][_0x5b6339(0x115d)]='flex';const _0x4bba15=_0x5f06cc[_0x5b6339(0x31d)](),_0x4fe275=_0x4bba15[_0x5b6339(0x397)],_0x3b7ce8=_0x4bba15['width'];_0x5f06cc[_0x5b6339(0x20f)][_0x5b6339(0xe8f)]=_0x5ddb92[_0x5b6339(0xe8f)]-_0x4fe275-0x5-_0x3c1d48[_0x5b6339(0xe8f)]+'px';const _0x4eeabc=_0x5ddb92['left']-_0x3c1d48[_0x5b6339(0xb90)];_0x4eeabc+_0x3b7ce8>_0x3c1d48[_0x5b6339(0xeb0)]?(_0x5f06cc['style']['left']=_0x5b6339(0xaf8),_0x5f06cc[_0x5b6339(0x20f)]['right']=_0x5b6339(0x220)):(_0x5f06cc[_0x5b6339(0x20f)]['left']=_0x4eeabc+'px',_0x5f06cc[_0x5b6339(0x20f)][_0x5b6339(0x2a5)]='auto'),_0x176e91[_0x5b6339(0x1030)]=!![],_0x176e91['activePostId']=_0x39187b;}function _0x49362c(){const _0x4053e6=_0x48bc6d;_0x176e91['isOpen']&&(_0x176e91['panelEl']['style'][_0x4053e6(0x115d)]=_0x4053e6(0x8e0),_0x176e91[_0x4053e6(0x1030)]=![],_0x176e91['activePostId']=null);}async function _0x497958(_0x3fb084,_0x50fcf0){const _0xe8cd8c=_0x48bc6d;if(!_0x50fcf0||!_0x50fcf0['url'])return;const _0x241858=await _0x512070[_0xe8cd8c(0x10e5)][_0xe8cd8c(0x14ee)](_0x3fb084);if(!_0x241858){console[_0xe8cd8c(0x3b7)](_0xe8cd8c(0xe27),_0x3fb084);return;}!_0x241858[_0xe8cd8c(0xc79)]&&(_0x241858[_0xe8cd8c(0xc79)]=[]);const _0x339836={'commenterName':_0x19ddb8[_0xe8cd8c(0x9ce)][_0xe8cd8c(0x246)],'text':_0x50fcf0[_0xe8cd8c(0x121f)],'meaning':_0x50fcf0[_0xe8cd8c(0x1561)],'timestamp':Date[_0xe8cd8c(0x64b)]()};_0x241858[_0xe8cd8c(0xc79)][_0xe8cd8c(0x1c4)](_0x339836),await _0x512070['qzonePosts'][_0xe8cd8c(0xe33)](_0x3fb084,{'comments':_0x241858[_0xe8cd8c(0xc79)]}),_0x49362c(),await _0x49acff();const _0xc129cb=(_0x241858[_0xe8cd8c(0x6b9)]||_0x241858['content']||_0xe8cd8c(0x8a9))[_0xe8cd8c(0x72e)](0x0,0x1e);for(const _0x5daa6a in _0x19ddb8[_0xe8cd8c(0xb04)]){const _0x3a8bbe=_0x19ddb8[_0xe8cd8c(0xb04)][_0x5daa6a];if(!_0x3a8bbe[_0xe8cd8c(0x136b)]){const _0x5c8933='[系统提示：\x27'+_0x19ddb8[_0xe8cd8c(0x9ce)]['nickname']+'\x27\x20在你的动态(ID:\x20'+_0x3fb084+_0xe8cd8c(0x295)+_0xc129cb+_0xe8cd8c(0x190)+_0x50fcf0['name']+_0xe8cd8c(0x3b2),_0x45d158={'role':_0xe8cd8c(0xe10),'content':_0x5c8933,'timestamp':Date['now'](),'isHidden':!![]};_0x3a8bbe[_0xe8cd8c(0x1f0)][_0xe8cd8c(0x1c4)](_0x45d158),await _0x512070['chats'][_0xe8cd8c(0xd4d)](_0x3a8bbe);}}}function _0x3f32eb(_0x52e5fc){const _0x1a4f81=_0x48bc6d;_0x4a7c77=_0x52e5fc,document[_0x1a4f81(0x9a3)](_0x1a4f81(0x790))[_0x1a4f81(0x7b2)]='',document[_0x1a4f81(0x9a3)](_0x1a4f81(0x7b5))[_0x1a4f81(0x4d8)]['add']('visible');}function _0x44cf39(){const _0xd7033a=_0x48bc6d;document[_0xd7033a(0x9a3)]('repost-modal')['classList'][_0xd7033a(0x133d)](_0xd7033a(0xc09)),_0x4a7c77=null;}async function _0x39bcbe(){const _0x360b2e=_0x48bc6d;if(!_0x4a7c77)return;const _0x5f1041=document[_0x360b2e(0x9a3)]('repost-comment-input')[_0x360b2e(0x7b2)][_0x360b2e(0x13f9)](),_0x6a5b35=await _0x512070[_0x360b2e(0x10e5)]['get'](_0x4a7c77);if(!_0x6a5b35){alert(_0x360b2e(0x134b)),_0x44cf39();return;}const _0x102138={'type':_0x360b2e(0x5ee),'timestamp':Date[_0x360b2e(0x64b)](),'authorId':_0x360b2e(0x20d),'repostComment':_0x5f1041,'originalPost':_0x6a5b35,'visibleGroupIds':null};await _0x512070[_0x360b2e(0x10e5)][_0x360b2e(0xe05)](_0x102138),_0x44cf39(),await _0x49acff(),alert(_0x360b2e(0x566));}function _0x27fff6(_0x150412){const _0x1b32af=_0x48bc6d,_0x1fdaa0=document[_0x1b32af(0x9a3)](_0x1b32af(0xc39));_0x1fdaa0['innerHTML']='';if(_0x150412[_0x1b32af(0x106b)]===0x0){const _0x46a84e=document[_0x1b32af(0x9a3)](_0x1b32af(0xf96))[_0x1b32af(0x7b2)],_0x30d137=_0x46a84e?'未找到相关收藏':_0x1b32af(0x14c3);_0x1fdaa0[_0x1b32af(0xeb2)]=_0x1b32af(0x816)+_0x30d137+_0x1b32af(0x4cf);return;}for(const _0x5bfeac of _0x150412){const _0x3f5a0f=document['createElement'](_0x1b32af(0x8ca));_0x3f5a0f[_0x1b32af(0x1487)]='favorite-item-card',_0x3f5a0f[_0x1b32af(0xd8d)][_0x1b32af(0xeae)]=_0x5bfeac['id'];let _0x3cc382='',_0x56cbc6='',_0x287455='',_0x118851='';if(_0x5bfeac[_0x1b32af(0x1508)]===_0x1b32af(0x120f)){const _0x3f8527=_0x5bfeac[_0x1b32af(0x4e3)];_0x287455='来自动态';let _0x138650=_0x4f81ff,_0x53aceb=_0x1b32af(0xb17);if(_0x3f8527[_0x1b32af(0x82c)]===_0x1b32af(0x20d))_0x138650=_0x19ddb8[_0x1b32af(0x9ce)][_0x1b32af(0xf3f)],_0x53aceb=_0x19ddb8[_0x1b32af(0x9ce)][_0x1b32af(0x246)];else _0x19ddb8[_0x1b32af(0xb04)][_0x3f8527[_0x1b32af(0x82c)]]&&(_0x138650=_0x19ddb8[_0x1b32af(0xb04)][_0x3f8527[_0x1b32af(0x82c)]][_0x1b32af(0x450)][_0x1b32af(0x4fe)],_0x53aceb=_0x19ddb8[_0x1b32af(0xb04)][_0x3f8527[_0x1b32af(0x82c)]][_0x1b32af(0x1561)]);_0x3cc382=_0x1b32af(0x887)+_0x138650+_0x1b32af(0x6ba)+_0x53aceb+_0x1b32af(0xf8a);const _0x1b4243=_0x3f8527[_0x1b32af(0x6b9)]?_0x1b32af(0xe73)+_0x3f8527[_0x1b32af(0x6b9)]['replace'](/\n/g,_0x1b32af(0x609))+_0x1b32af(0x826):'';if(_0x3f8527[_0x1b32af(0x1508)]==='shuoshuo')_0x56cbc6='<div\x20class=\x22post-content\x22>'+_0x3f8527[_0x1b32af(0x4e3)]['replace'](/\n/g,_0x1b32af(0x609))+_0x1b32af(0x826);else{if(_0x3f8527[_0x1b32af(0x1508)]===_0x1b32af(0x1016)&&_0x3f8527[_0x1b32af(0xbfe)]){const _0x244671=_0x19ddb8[_0x1b32af(0x4c8)][_0x1b32af(0x853)]&&_0x3f8527['image_prompt']?_0x1b32af(0x10a3)+_0x3f8527['image_prompt']:_0x1b32af(0x273);_0x56cbc6=_0x1b4243?_0x1b4243+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0x244671+_0x1b32af(0x1558):_0x1b32af(0x887)+_0x244671+_0x1b32af(0x993);}else{if(_0x3f8527[_0x1b32af(0x1508)]===_0x1b32af(0x1281)){const _0x2fcf9f=_0x19ddb8[_0x1b32af(0x4c8)][_0x1b32af(0x853)]&&_0x3f8527[_0x1b32af(0xb95)]?_0x1b32af(0x10a3)+_0x3f8527[_0x1b32af(0xb95)]:_0x1b32af(0x273);_0x56cbc6=_0x1b4243?_0x1b4243+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0x2fcf9f+_0x1b32af(0x7fc)+_0x3f8527[_0x1b32af(0x14bb)]+_0x1b32af(0xe8a):'<img\x20src=\x22'+_0x2fcf9f+_0x1b32af(0x7fc)+_0x3f8527[_0x1b32af(0x14bb)]+'\x22>';}}}let _0x26384c='';_0x3f8527[_0x1b32af(0x807)]&&_0x3f8527[_0x1b32af(0x807)][_0x1b32af(0x106b)]>0x0&&(_0x26384c=_0x1b32af(0x2af)+_0x3f8527[_0x1b32af(0x807)][_0x1b32af(0x3b9)]('、')+_0x1b32af(0x3da));let _0x73dc6a='';_0x3f8527[_0x1b32af(0xc79)]&&_0x3f8527[_0x1b32af(0xc79)][_0x1b32af(0x106b)]>0x0&&(_0x73dc6a=_0x1b32af(0x257),_0x3f8527[_0x1b32af(0xc79)]['forEach']((_0x15b468,_0x13fc0d)=>{const _0x8d63c=_0x1b32af;if(typeof _0x15b468===_0x8d63c(0x12fe)&&_0x15b468!==null&&_0x15b468['commenterName']){const _0x9cdf01=_0x15b468['commenterName'],_0xcf26fc=_0x2e9dd1(_0x9cdf01);let _0x59a644;_0x115b0e[_0x8d63c(0xddf)](_0x15b468[_0x8d63c(0x13ca)])?_0x59a644='<img\x20src=\x22'+_0x15b468['text']+_0x8d63c(0xf30):_0x59a644=_0x15b468[_0x8d63c(0x13ca)];let _0x2c429d='';if(_0x15b468[_0x8d63c(0x877)]){const _0x4790fa=_0x2e9dd1(_0x15b468[_0x8d63c(0x877)]);_0x2c429d='<span\x20class=\x22commenter-name\x22>'+_0xcf26fc+_0x8d63c(0xf24)+_0x4790fa+_0x8d63c(0x99d)+_0x59a644;}else _0x2c429d=_0x8d63c(0x75f)+_0xcf26fc+_0x8d63c(0x99d)+_0x59a644;_0x73dc6a+=_0x8d63c(0xcdd)+_0x3f8527['id']+_0x8d63c(0xe7d)+_0x9cdf01+'\x22\x20data-commenter-display-name=\x22'+_0xcf26fc+_0x8d63c(0x7f3)+_0x2c429d+_0x8d63c(0x26c)+_0x13fc0d+_0x8d63c(0x1408);}else _0x73dc6a+='<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>'+String(_0x15b468)+_0x8d63c(0x207);}),_0x73dc6a+=_0x1b32af(0x826)),_0x118851=''+_0x26384c+_0x73dc6a;}else{if(_0x5bfeac[_0x1b32af(0x1508)]===_0x1b32af(0xdd1)){const _0x4dcaed=_0x5bfeac[_0x1b32af(0x4e3)],_0x39b6a0=_0x19ddb8[_0x1b32af(0xb04)][_0x5bfeac[_0x1b32af(0x907)]];if(!_0x39b6a0)continue;_0x287455=_0x1b32af(0xd6e)+_0x39b6a0[_0x1b32af(0x1561)]+_0x1b32af(0x475);const _0x104f2d=_0x4dcaed[_0x1b32af(0x11c1)]==='user';let _0x22735e,_0x2eff99;if(_0x104f2d)_0x22735e=_0x39b6a0[_0x1b32af(0x136b)]?_0x39b6a0[_0x1b32af(0x450)][_0x1b32af(0x1555)]||'我':'我',_0x2eff99=_0x39b6a0['settings'][_0x1b32af(0x1af)]||(_0x39b6a0[_0x1b32af(0x136b)]?_0xde5144:_0x4f81ff);else{if(_0x39b6a0['isGroup']){const _0x5ebb01=_0x39b6a0[_0x1b32af(0xcca)][_0x1b32af(0xd62)](_0x2cd413=>_0x2cd413[_0x1b32af(0x339)]===_0x4dcaed[_0x1b32af(0x1043)]);_0x22735e=_0x4dcaed[_0x1b32af(0x1043)],_0x2eff99=_0x5ebb01?_0x5ebb01['avatar']:_0x451ae9;}else _0x22735e=_0x39b6a0[_0x1b32af(0x1561)],_0x2eff99=_0x39b6a0[_0x1b32af(0x450)][_0x1b32af(0x4fe)]||_0x4f81ff;}_0x3cc382='<img\x20src=\x22'+_0x2eff99+_0x1b32af(0x6ba)+_0x22735e+_0x1b32af(0xf8a);if(typeof _0x4dcaed['content']===_0x1b32af(0x86c)&&_0x115b0e[_0x1b32af(0xddf)](_0x4dcaed['content']))_0x56cbc6=_0x1b32af(0x887)+_0x4dcaed['content']+_0x1b32af(0xb02);else Array[_0x1b32af(0xb9b)](_0x4dcaed[_0x1b32af(0x4e3)])&&_0x4dcaed['content'][0x0]?.['type']==='image_url'?_0x56cbc6=_0x1b32af(0x887)+_0x4dcaed[_0x1b32af(0x4e3)][0x0][_0x1b32af(0xae0)]['url']+_0x1b32af(0x993):_0x56cbc6=String(_0x4dcaed[_0x1b32af(0x4e3)]||'')[_0x1b32af(0x1bb)](/\n/g,_0x1b32af(0x609));}else{if(_0x5bfeac[_0x1b32af(0x1508)]==='char_diary'){const _0x18b66b=_0x5bfeac[_0x1b32af(0x4e3)];_0x287455=_0x1b32af(0x131a)+_0x18b66b[_0x1b32af(0xfc8)]+_0x1b32af(0x1360);const _0x410cb9=_0x19ddb8[_0x1b32af(0xb04)][_0x18b66b[_0x1b32af(0xdb4)]],_0x4499ff=_0x410cb9?_0x410cb9['settings']['aiAvatar']:_0x4f81ff;_0x3cc382=_0x1b32af(0x887)+_0x4499ff+'\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>'+_0x18b66b[_0x1b32af(0xfc8)]+'</div></div>';const _0x5a594a=_0x18b66b[_0x1b32af(0x4e3)]||'',_0x1ba2d1=_0x49f635(_0x5a594a)[_0x1b32af(0x1bb)](/\n/g,_0x1b32af(0x609));_0x56cbc6='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>'+_0x18b66b[_0x1b32af(0x10b8)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content-full\x22>'+_0x1ba2d1+_0x1b32af(0xf46);}else{if(_0x5bfeac['type']===_0x1b32af(0x1562)){const _0x1c8084=_0x5bfeac[_0x1b32af(0x4e3)];_0x287455=_0x1b32af(0x131a)+_0x1c8084['characterName']+_0x1b32af(0x13d9);const _0x4d88b8=_0x19ddb8[_0x1b32af(0xb04)][_0x1c8084['characterId']],_0x13345d=_0x4d88b8?_0x4d88b8['settings'][_0x1b32af(0x4fe)]:_0x4f81ff;_0x3cc382=_0x1b32af(0x887)+_0x13345d+_0x1b32af(0x6ba)+_0x1c8084[_0x1b32af(0xfc8)]+_0x1b32af(0xf8a),_0x56cbc6=_0x1b32af(0x105b)+_0x1c8084[_0x1b32af(0x10b8)]+_0x1b32af(0x1132)+(_0x1c8084[_0x1b32af(0x4e3)]||'')[_0x1b32af(0x1bb)](/\n/g,_0x1b32af(0x609))+_0x1b32af(0xa8e);}else{if(_0x5bfeac[_0x1b32af(0x1508)]==='char_memo'){const _0x24d168=_0x5bfeac['content'];_0x287455=_0x1b32af(0x131a)+_0x24d168[_0x1b32af(0xfc8)]+'\x20的备忘录';const _0x15a781=_0x19ddb8[_0x1b32af(0xb04)][_0x24d168['characterId']],_0x4f34d4=_0x15a781?_0x15a781[_0x1b32af(0x450)][_0x1b32af(0x4fe)]:_0x4f81ff;_0x3cc382=_0x1b32af(0x887)+_0x4f34d4+'\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>'+_0x24d168['characterName']+_0x1b32af(0xf8a),_0x56cbc6=_0x1b32af(0xe01)+_0x24d168[_0x1b32af(0x10b8)]+_0x1b32af(0x93e)+_0x24d168['content'][_0x1b32af(0x1bb)](/\n/g,'<br>')+_0x1b32af(0x331);}}}}}_0x3f5a0f['innerHTML']=_0x1b32af(0xb2a)+_0x3cc382+_0x1b32af(0xabe)+_0x287455+_0x1b32af(0xf95)+_0x56cbc6+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x118851,_0x1fdaa0['appendChild'](_0x3f5a0f);}}async function _0x332542(){const _0x8329b9=_0x48bc6d;allFavoriteItems=await _0x512070[_0x8329b9(0x73d)][_0x8329b9(0x1404)]('timestamp')[_0x8329b9(0x333)]()['toArray']();const _0x172b39=document[_0x8329b9(0x9a3)](_0x8329b9(0xf96)),_0x1f6f57=document[_0x8329b9(0x9a3)]('favorites-search-clear-btn');_0x172b39[_0x8329b9(0x7b2)]='',_0x1f6f57['style']['display']=_0x8329b9(0x8e0),_0x27fff6(allFavoriteItems);}function _0x4b032e(){const _0x2cd9f3=_0x48bc6d;document[_0x2cd9f3(0x9a3)](_0x2cd9f3(0x13ad))['value']='',document[_0x2cd9f3(0x9a3)]('post-image-preview')[_0x2cd9f3(0x10d4)]='',document['getElementById'](_0x2cd9f3(0xdae))['value']='',document['getElementById']('post-image-preview-container')[_0x2cd9f3(0x4d8)][_0x2cd9f3(0x133d)]('visible'),document[_0x2cd9f3(0x9a3)](_0x2cd9f3(0x47b))[_0x2cd9f3(0x20f)]['display']=_0x2cd9f3(0x8e0),document[_0x2cd9f3(0x9a3)](_0x2cd9f3(0x634))[_0x2cd9f3(0x7b2)]='',document[_0x2cd9f3(0x9a3)]('post-hidden-text')['value']='',document['getElementById']('switch-to-image-mode')[_0x2cd9f3(0x9cc)]();}async function _0x5f36f4(){const _0x2007cd=_0x48bc6d,_0x4323e1=await _0x2c9509(_0x2007cd(0xe8c),_0x2007cd(0xb1b),{'confirmButtonClass':_0x2007cd(0xf5b),'confirmText':_0x2007cd(0xd77)});if(!_0x4323e1)return;await _0x403a62(_0x2007cd(0x1395),_0x2007cd(0x1348)),console[_0x2007cd(0xe4d)]('冗余数据清理流程已启动...');let _0x4226ab={'posts':0x0,'likes':0x0,'comments':0x0,'memories':0x0,'callRecords':0x0,'renderingRules':0x0,'groupMembers':0x0,'chatLinks':0x0};try{await _0x512070['transaction']('rw',_0x512070['tables'],async()=>{const _0x53bdaa=_0x2007cd,_0x285c2b=await _0x512070[_0x53bdaa(0xb04)]['toArray'](),_0x3546c3=await _0x512070[_0x53bdaa(0x5b7)][_0x53bdaa(0x591)](),_0x34268a=new Set(_0x285c2b[_0x53bdaa(0xb0a)](_0x5613ba=>_0x5613ba['id'])),_0x271395=new Set(_0x3546c3['map'](_0x32e4c0=>_0x53bdaa(0x136f)+_0x32e4c0['id'])),_0x42519f=new Set(_0x285c2b[_0x53bdaa(0x1195)](_0x298b27=>!_0x298b27[_0x53bdaa(0x136b)])['map'](_0x45e1b7=>_0x45e1b7['originalName']));_0x42519f['add'](_0x19ddb8[_0x53bdaa(0x9ce)]['nickname']||_0x53bdaa(0x15c8)),_0x3546c3[_0x53bdaa(0x15c1)](_0x467bc4=>_0x42519f[_0x53bdaa(0xe05)](_0x467bc4[_0x53bdaa(0x1561)]));for(const _0x5b914a of _0x285c2b){let _0x326472=![];if(_0x5b914a[_0x53bdaa(0x136b)]&&_0x5b914a[_0x53bdaa(0xcca)]){const _0x230a77=_0x5b914a[_0x53bdaa(0xcca)][_0x53bdaa(0x106b)];_0x5b914a[_0x53bdaa(0xcca)]=_0x5b914a[_0x53bdaa(0xcca)][_0x53bdaa(0x1195)](_0xc1d3ce=>_0x34268a['has'](_0xc1d3ce['id'])||_0x271395[_0x53bdaa(0x1472)](_0xc1d3ce['id'])),_0x5b914a[_0x53bdaa(0xcca)][_0x53bdaa(0x106b)]<_0x230a77&&(_0x4226ab[_0x53bdaa(0x13db)]+=_0x230a77-_0x5b914a[_0x53bdaa(0xcca)]['length'],_0x326472=!![]);}if(_0x5b914a[_0x53bdaa(0x450)]?.[_0x53bdaa(0x120e)]?.['length']>0x0){const _0x403965=_0x5b914a[_0x53bdaa(0x450)]['linkedMemoryChatIds']['length'];_0x5b914a[_0x53bdaa(0x450)][_0x53bdaa(0x120e)]=_0x5b914a[_0x53bdaa(0x450)][_0x53bdaa(0x120e)]['filter'](_0x20bad2=>_0x34268a[_0x53bdaa(0x1472)](_0x20bad2)),_0x5b914a[_0x53bdaa(0x450)]['linkedMemoryChatIds']['length']<_0x403965&&(_0x4226ab['chatLinks']+=_0x403965-_0x5b914a[_0x53bdaa(0x450)][_0x53bdaa(0x120e)][_0x53bdaa(0x106b)],_0x326472=!![]);}_0x326472&&await _0x512070[_0x53bdaa(0xb04)][_0x53bdaa(0xd4d)](_0x5b914a);}const _0x40b599=await _0x512070['qzonePosts'][_0x53bdaa(0x591)]();for(const _0x30123c of _0x40b599){let _0x4f0528=![];const _0x3f9d7d=_0x30123c[_0x53bdaa(0x82c)]===_0x53bdaa(0x20d)||_0x34268a[_0x53bdaa(0x1472)](_0x30123c['authorId'])||_0x271395[_0x53bdaa(0x1472)](_0x30123c[_0x53bdaa(0x82c)]);if(!_0x3f9d7d){await _0x512070[_0x53bdaa(0x10e5)][_0x53bdaa(0x10a8)](_0x30123c['id']),_0x4226ab[_0x53bdaa(0xd3c)]++;continue;}if(_0x30123c[_0x53bdaa(0x807)]&&_0x30123c[_0x53bdaa(0x807)]['length']>0x0){const _0x46cb21=_0x30123c['likes'][_0x53bdaa(0x106b)];_0x30123c[_0x53bdaa(0x807)]=_0x30123c[_0x53bdaa(0x807)][_0x53bdaa(0x1195)](_0x4e91ac=>_0x42519f[_0x53bdaa(0x1472)](_0x4e91ac)),_0x30123c['likes'][_0x53bdaa(0x106b)]<_0x46cb21&&(_0x4226ab[_0x53bdaa(0x807)]+=_0x46cb21-_0x30123c[_0x53bdaa(0x807)][_0x53bdaa(0x106b)],_0x4f0528=!![]);}if(_0x30123c[_0x53bdaa(0xc79)]&&_0x30123c['comments'][_0x53bdaa(0x106b)]>0x0){const _0xdd4e83=_0x30123c[_0x53bdaa(0xc79)]['length'];_0x30123c['comments']=_0x30123c[_0x53bdaa(0xc79)][_0x53bdaa(0x1195)](_0x13f224=>{const _0x586cf8=_0x53bdaa;if(typeof _0x13f224===_0x586cf8(0x12fe)&&_0x13f224[_0x586cf8(0x1200)])return _0x42519f[_0x586cf8(0x1472)](_0x13f224[_0x586cf8(0x1200)]);return!![];}),_0x30123c[_0x53bdaa(0xc79)][_0x53bdaa(0x106b)]<_0xdd4e83&&(_0x4226ab['comments']+=_0xdd4e83-_0x30123c[_0x53bdaa(0xc79)][_0x53bdaa(0x106b)],_0x4f0528=!![]);}_0x4f0528&&await _0x512070[_0x53bdaa(0x10e5)][_0x53bdaa(0xd4d)](_0x30123c);}await _0x512070['memories'][_0x53bdaa(0x1201)]('chatId')['noneOf']([..._0x34268a])[_0x53bdaa(0x10a8)]()[_0x53bdaa(0x140f)](_0x1fb375=>_0x4226ab[_0x53bdaa(0xe87)]+=_0x1fb375),await _0x512070[_0x53bdaa(0xad1)][_0x53bdaa(0x1201)]('chatId')[_0x53bdaa(0x1a2)]([..._0x34268a])['delete']()[_0x53bdaa(0x140f)](_0x2ee61c=>_0x4226ab['callRecords']+=_0x2ee61c);const _0x3686b=await _0x512070['renderingRules']['toArray']();for(const _0x465a49 of _0x3686b){_0x465a49['chatId']!==_0x53bdaa(0xc41)&&!_0x34268a['has'](_0x465a49[_0x53bdaa(0x907)])&&(await _0x512070[_0x53bdaa(0xb54)][_0x53bdaa(0x10a8)](_0x465a49['id']),_0x4226ab[_0x53bdaa(0xb54)]++);}});let _0x3886e8=_0x2007cd(0x59d),_0x43dea1=![];Object[_0x2007cd(0x10c3)](_0x4226ab)[_0x2007cd(0x15c1)](([_0x145b33,_0x296f4f])=>{const _0x1a18f1=_0x2007cd;if(_0x296f4f>0x0){const _0x35bc61={'posts':'动态','likes':'点赞','comments':'评论','memories':'记忆','callRecords':_0x1a18f1(0x14bf),'renderingRules':'渲染规则','groupMembers':'群成员','chatLinks':_0x1a18f1(0xcbf)};_0x3886e8+='-\x20清理了\x20'+_0x296f4f+_0x1a18f1(0x121a)+(_0x35bc61[_0x145b33]||_0x145b33)+'。\x0a',_0x43dea1=!![];}});!_0x43dea1&&(_0x3886e8=_0x2007cd(0xa47));_0x3886e8+=_0x2007cd(0x780),await _0x403a62(_0x2007cd(0x432),_0x3886e8);const _0x2057cc=await _0x2c9509('刷新页面？',_0x2007cd(0x151b));_0x2057cc&&location[_0x2007cd(0x137d)]();}catch(_0x431470){console[_0x2007cd(0x3b7)]('清理冗余数据时出错:',_0x431470),await _0x403a62(_0x2007cd(0x1247),_0x2007cd(0x12e0)+_0x431470[_0x2007cd(0xcce)]);}}async function _0x176c39(){const _0x4cf8b1=_0x48bc6d;try{const _0x54f22a={'version':0x1,'timestamp':Date[_0x4cf8b1(0x64b)]()},[_0x21d31a,_0x46f37e,_0x5d61a7,_0x53977b,_0x8d05f4,_0xf545b5,_0x563965,_0xb05f2d,_0x3c481e,_0x3198fd,_0x24f1b2,_0x30f275,_0x55590e,_0x4f7ebd,_0x56140f,_0x42b387,_0x4b42c6,_0x2fa742,_0x1e2841,_0x4e2c89,_0x4a02d5,_0x551ef2,_0x39e2cd,_0x49a723,_0x528bec]=await Promise[_0x4cf8b1(0xbf1)]([_0x512070[_0x4cf8b1(0xb04)][_0x4cf8b1(0x591)](),_0x512070[_0x4cf8b1(0x8e4)][_0x4cf8b1(0x591)](),_0x512070[_0x4cf8b1(0x1557)][_0x4cf8b1(0x591)](),_0x512070[_0x4cf8b1(0xd22)][_0x4cf8b1(0x14ee)]('main'),_0x512070['globalSettings'][_0x4cf8b1(0x14ee)](_0x4cf8b1(0x1173)),_0x512070['personaPresets'][_0x4cf8b1(0x591)](),_0x512070['musicLibrary'][_0x4cf8b1(0x14ee)]('main'),_0x512070['qzoneSettings'][_0x4cf8b1(0x14ee)]('main'),_0x512070[_0x4cf8b1(0x10e5)][_0x4cf8b1(0x591)](),_0x512070[_0x4cf8b1(0x642)][_0x4cf8b1(0x591)](),_0x512070[_0x4cf8b1(0xc8d)][_0x4cf8b1(0x591)](),_0x512070[_0x4cf8b1(0x73d)][_0x4cf8b1(0x591)](),_0x512070['qzoneGroups']['toArray'](),_0x512070[_0x4cf8b1(0xe87)][_0x4cf8b1(0x591)](),_0x512070['worldBookCategories'][_0x4cf8b1(0x591)](),_0x512070[_0x4cf8b1(0x83b)][_0x4cf8b1(0x591)](),_0x512070[_0x4cf8b1(0x376)][_0x4cf8b1(0x591)](),_0x512070[_0x4cf8b1(0xad1)][_0x4cf8b1(0x591)](),_0x512070[_0x4cf8b1(0xb54)][_0x4cf8b1(0x591)](),_0x512070['doubanPosts'][_0x4cf8b1(0x591)](),_0x512070['stickerCategories'][_0x4cf8b1(0x591)](),_0x512070[_0x4cf8b1(0xac9)][_0x4cf8b1(0x591)](),_0x512070[_0x4cf8b1(0xded)][_0x4cf8b1(0x591)](),_0x512070[_0x4cf8b1(0xb4d)][_0x4cf8b1(0x591)](),_0x512070[_0x4cf8b1(0x5b7)][_0x4cf8b1(0x591)]()]);Object['assign'](_0x54f22a,{'chats':_0x21d31a,'worldBooks':_0x46f37e,'userStickers':_0x5d61a7,'apiConfig':_0x53977b,'globalSettings':_0x8d05f4,'personaPresets':_0xf545b5,'musicLibrary':_0x563965,'qzoneSettings':_0xb05f2d,'qzonePosts':_0x3c481e,'qzoneAlbums':_0x3198fd,'qzonePhotos':_0x24f1b2,'favorites':_0x30f275,'qzoneGroups':_0x55590e,'memories':_0x4f7ebd,'worldBookCategories':_0x56140f,'apiPresets':_0x42b387,'shoppingProducts':_0x4b42c6,'callRecords':_0x2fa742,'renderingRules':_0x1e2841,'doubanPosts':_0x4e2c89,'stickerCategories':_0x4a02d5,'appearancePresets':_0x551ef2,'presets':_0x39e2cd,'presetCategories':_0x49a723,'npcs':_0x528bec});const _0x36661c=new Blob([JSON[_0x4cf8b1(0xe1e)](_0x54f22a,null,0x2)],{'type':_0x4cf8b1(0xb1f)}),_0x2b82b3=URL['createObjectURL'](_0x36661c),_0xa65c9d=Object[_0x4cf8b1(0x8aa)](document[_0x4cf8b1(0xe94)]('a'),{'href':_0x2b82b3,'download':_0x4cf8b1(0x6e9)+new Date()[_0x4cf8b1(0xccf)]()[_0x4cf8b1(0x1536)]('T')[0x0]+_0x4cf8b1(0x6db)});_0xa65c9d['click'](),URL[_0x4cf8b1(0xb93)](_0x2b82b3),await _0x403a62(_0x4cf8b1(0x1217),_0x4cf8b1(0x1d1));}catch(_0x4dcf40){console[_0x4cf8b1(0x3b7)](_0x4cf8b1(0xca0),_0x4dcf40),await _0x403a62(_0x4cf8b1(0x59f),'发生了一个错误:\x20'+_0x4dcf40[_0x4cf8b1(0xcce)]);}}async function _0x1484e0(_0x3da1ed){const _0x215c48=_0x48bc6d;try{await _0x512070[_0x215c48(0x1072)]('rw',_0x512070[_0x215c48(0x138f)],async()=>{const _0x3f7a61=_0x215c48;for(const _0x4b7656 of _0x512070[_0x3f7a61(0x138f)]){await _0x4b7656[_0x3f7a61(0xe81)]();}for(const _0x5dc440 in _0x3da1ed){Array[_0x3f7a61(0xb9b)](_0x3da1ed[_0x5dc440])&&(console['log']('正在导入表:\x20'+_0x5dc440+_0x3f7a61(0x8f4)+_0x3da1ed[_0x5dc440][_0x3f7a61(0x106b)]),await _0x512070['table'](_0x5dc440)[_0x3f7a61(0xc71)](_0x3da1ed[_0x5dc440]));}});}catch(_0x264d14){throw new Error(_0x215c48(0xa95)+_0x264d14[_0x215c48(0xcce)]);}}async function _0xe24a9b(_0x2733c7){const _0x32dc11=_0x48bc6d;if(!_0x2733c7)return;await _0x403a62(_0x32dc11(0x1395),_0x32dc11(0x1188));try{const _0x4fee36=await _0x2733c7[_0x32dc11(0x13ca)](),_0xb2c104=JSON[_0x32dc11(0x1447)](_0x4fee36);let _0x2d65a9,_0x4caf1e;if(_0xb2c104['data']&&typeof _0xb2c104[_0x32dc11(0x38c)]===_0x32dc11(0x12fe)&&(_0xb2c104[_0x32dc11(0x38c)]['chats']||_0xb2c104[_0x32dc11(0x38c)][_0x32dc11(0x8e4)]))console[_0x32dc11(0xe4d)](_0x32dc11(0x137f)),_0x2d65a9=_0xb2c104[_0x32dc11(0x38c)],_0x4caf1e=_0x32dc11(0xc1d);else{if(_0xb2c104[_0x32dc11(0xb04)]||_0xb2c104[_0x32dc11(0x8e4)])console['log'](_0x32dc11(0xb80)),_0x2d65a9=_0xb2c104,_0x4caf1e=_0x32dc11(0xf8d);else throw new Error(_0x32dc11(0x54d));}pendingBackupData={'type':_0x4caf1e,'content':_0x2d65a9},_0x453c0e(_0x2d65a9);}catch(_0x21082f){console[_0x32dc11(0x3b7)](_0x32dc11(0x55d),_0x21082f),pendingBackupData=null,await _0x403a62('导入失败','文件解析或应用失败:\x20'+_0x21082f[_0x32dc11(0xcce)]);}}function _0x453c0e(_0x3558a5){const _0x1a2c06=_0x48bc6d,_0xd75d1c=document['getElementById']('import-options-modal'),_0x45327f=document[_0x1a2c06(0x9a3)](_0x1a2c06(0x521));_0x45327f[_0x1a2c06(0xeb2)]='';const _0x161578={'chats':_0x1a2c06(0xde2),'worldBooks':_0x1a2c06(0xcb1),'worldBookCategories':_0x1a2c06(0x508),'presets':_0x1a2c06(0x11d5),'presetCategories':'预设分类','userStickers':'表情包','stickerCategories':_0x1a2c06(0x10fa),'customAvatarFrames':_0x1a2c06(0x13d7),'apiConfig':_0x1a2c06(0xe80),'globalSettings':_0x1a2c06(0x6c6),'personaPresets':_0x1a2c06(0xb2e),'qzoneSettings':'空间设置','qzonePosts':'动态','qzoneAlbums':'相册','favorites':'收藏','memories':'回忆','callRecords':_0x1a2c06(0x14bf),'shoppingProducts':'商品','apiPresets':_0x1a2c06(0x14d1),'renderingRules':_0x1a2c06(0x221),'appearancePresets':_0x1a2c06(0xbe2),'npcs':_0x1a2c06(0x72d)};let _0x2b6913=![];for(const _0xffca7c in _0x161578){if(_0x3558a5[_0xffca7c]&&(Array['isArray'](_0x3558a5[_0xffca7c])?_0x3558a5[_0xffca7c][_0x1a2c06(0x106b)]>0x0:_0x3558a5[_0xffca7c])){const _0x2d639c=Array[_0x1a2c06(0xb9b)](_0x3558a5[_0xffca7c])?_0x3558a5[_0xffca7c][_0x1a2c06(0x106b)]:0x1,_0x2203f6=document[_0x1a2c06(0xe94)]('li');_0x2203f6[_0x1a2c06(0x766)]=_0x161578[_0xffca7c]+':\x20'+_0x2d639c+_0x1a2c06(0x5a3),_0x45327f['appendChild'](_0x2203f6),_0x2b6913=!![];}}!_0x2b6913&&(_0x45327f[_0x1a2c06(0xeb2)]=_0x1a2c06(0xfb6)),document[_0x1a2c06(0x9a3)]('confirm-full-import-btn')[_0x1a2c06(0x4ce)]=()=>{const _0x45ad6b=_0x1a2c06;_0xd75d1c[_0x45ad6b(0x4d8)][_0x45ad6b(0x133d)](_0x45ad6b(0xc09)),_0x14c53f(pendingBackupData);},document[_0x1a2c06(0x9a3)](_0x1a2c06(0x133e))[_0x1a2c06(0x4ce)]=()=>{const _0x204924=_0x1a2c06;_0xd75d1c['classList']['remove']('visible'),_0x481e97(pendingBackupData[_0x204924(0x4e3)]);},document[_0x1a2c06(0x9a3)](_0x1a2c06(0xfbc))['onclick']=()=>{const _0x1a5f9f=_0x1a2c06;_0xd75d1c['classList']['remove'](_0x1a5f9f(0xc09)),pendingBackupData=null;},_0xd75d1c[_0x1a2c06(0x4d8)][_0x1a2c06(0xe05)](_0x1a2c06(0xc09));}async function _0x14c53f(_0x3709ff){const _0x634fa2=_0x48bc6d;if(!_0x3709ff)return;const _0x18c12b=await _0x2c9509(_0x634fa2(0xfc1),_0x634fa2(0x607),{'confirmButtonClass':_0x634fa2(0xf5b),'confirmText':_0x634fa2(0x80e)});if(!_0x18c12b){pendingBackupData=null;return;}await _0x403a62(_0x634fa2(0x1395),_0x634fa2(0xd56));try{if(_0x3709ff[_0x634fa2(0x1508)]===_0x634fa2(0xc1d))await _0x1484e0(_0x3709ff[_0x634fa2(0x4e3)]);else{if(_0x3709ff[_0x634fa2(0x1508)]===_0x634fa2(0xf8d))await _0x2c1370(_0x3709ff[_0x634fa2(0x4e3)]);else throw new Error(_0x634fa2(0x510));}await _0x403a62('导入成功',_0x634fa2(0x134a)),setTimeout(()=>window[_0x634fa2(0x963)]['reload'](),0x5dc);}catch(_0x3c5707){console[_0x634fa2(0x3b7)]('完全导入失败:',_0x3c5707),await _0x403a62('导入失败',_0x634fa2(0x1389)+_0x3c5707['message']);}finally{pendingBackupData=null;}}function _0x481e97(_0x2828b){const _0x400033=_0x48bc6d,_0x7ac40a=document[_0x400033(0x9a3)]('selective-import-modal'),_0xc5a639=document[_0x400033(0x9a3)]('selective-import-list'),_0x20130e=document[_0x400033(0x9a3)](_0x400033(0x305));_0xc5a639[_0x400033(0xeb2)]='',_0x20130e[_0x400033(0x944)]=!![];const _0x355df2={'chats':_0x400033(0xde2),'worldBooks':'世界书','worldBookCategories':_0x400033(0x508),'presets':_0x400033(0x11d5),'presetCategories':_0x400033(0x129d),'userStickers':'表情包','stickerCategories':_0x400033(0x10fa),'customAvatarFrames':'头像框','apiConfig':_0x400033(0xe80),'globalSettings':_0x400033(0x6c6),'personaPresets':'人设预设','qzoneSettings':'空间设置','qzonePosts':'动态','qzoneAlbums':'相册','favorites':'收藏','memories':'回忆','callRecords':'通话记录','shoppingProducts':'商品','apiPresets':_0x400033(0x14d1),'renderingRules':_0x400033(0x221),'appearancePresets':_0x400033(0xbe2),'npcs':_0x400033(0x72d)};let _0xed1177=![];for(const _0x1b6b3b in _0x355df2){if(_0x2828b[_0x1b6b3b]&&(Array['isArray'](_0x2828b[_0x1b6b3b])?_0x2828b[_0x1b6b3b][_0x400033(0x106b)]>0x0:_0x2828b[_0x1b6b3b])){const _0x21eab1=Array[_0x400033(0xb9b)](_0x2828b[_0x1b6b3b])?_0x2828b[_0x1b6b3b][_0x400033(0x106b)]:0x1,_0x3b0292=!Array[_0x400033(0xb9b)](_0x2828b[_0x1b6b3b]),_0x266f0c=document[_0x400033(0xe94)](_0x400033(0x8ca));_0x266f0c[_0x400033(0x1487)]='clear-posts-item\x20selected',_0x266f0c[_0x400033(0xd8d)][_0x400033(0x637)]=_0x1b6b3b,_0x266f0c[_0x400033(0xeb2)]=_0x400033(0x3c7)+_0x355df2[_0x1b6b3b]+'\x20('+_0x21eab1+_0x400033(0xb8a)+(_0x3b0292?_0x400033(0x112d):'')+_0x400033(0x14dc),_0xc5a639[_0x400033(0x983)](_0x266f0c),_0xed1177=!![];}}!_0xed1177&&(_0xc5a639[_0x400033(0xeb2)]=_0x400033(0x377)),document[_0x400033(0x9a3)]('confirm-merge-import-btn')['onclick']=()=>_0x5436ca(pendingBackupData),document[_0x400033(0x9a3)](_0x400033(0x872))[_0x400033(0x4ce)]=()=>{const _0x59fb43=_0x400033;_0x7ac40a['classList'][_0x59fb43(0x133d)]('visible'),pendingBackupData=null;},_0x20130e[_0x400033(0xd70)]=_0x2fd7f2=>{const _0xde3702=_0x400033,_0x148f4d=_0x2fd7f2[_0xde3702(0xa41)][_0xde3702(0x944)];_0xc5a639[_0xde3702(0x131c)](_0xde3702(0x52f))[_0xde3702(0x15c1)](_0x4452c9=>{const _0x1b800a=_0xde3702;_0x4452c9[_0x1b800a(0x4d8)][_0x1b800a(0xc02)](_0x1b800a(0x154b),_0x148f4d),_0x4452c9[_0x1b800a(0xc86)](_0x1b800a(0xafe))[_0x1b800a(0x4d8)][_0x1b800a(0xc02)]('selected',_0x148f4d);});},_0xc5a639[_0x400033(0x4ce)]=_0x1e83b4=>{const _0x28c0c1=_0x400033,_0x1248d7=_0x1e83b4[_0x28c0c1(0xa41)]['closest'](_0x28c0c1(0x52f));_0x1248d7&&(_0x1248d7[_0x28c0c1(0x4d8)][_0x28c0c1(0xc02)](_0x28c0c1(0x154b)),_0x1248d7[_0x28c0c1(0xc86)]('.checkbox')[_0x28c0c1(0x4d8)][_0x28c0c1(0xc02)](_0x28c0c1(0x154b)));},_0x7ac40a[_0x400033(0x4d8)]['add'](_0x400033(0xc09));}async function _0x5436ca(_0x3949c0){const _0x2035c7=_0x48bc6d;if(!_0x3949c0)return;const _0x42d21f=document[_0x2035c7(0x131c)]('#selective-import-list\x20.clear-posts-item.selected');if(_0x42d21f['length']===0x0){alert(_0x2035c7(0xc3d));return;}const _0x1a1c3b=Array[_0x2035c7(0x1311)](_0x42d21f)[_0x2035c7(0xb0a)](_0x3bfaa4=>_0x3bfaa4[_0x2035c7(0xd8d)][_0x2035c7(0x637)]),_0x208e6a=_0x3949c0[_0x2035c7(0x4e3)],_0x3531e1=await _0x2c9509(_0x2035c7(0x10b1),_0x2035c7(0xe99),{'confirmText':'确认合并'});if(!_0x3531e1)return;await _0x403a62(_0x2035c7(0x1395),_0x2035c7(0xae9));try{await _0x512070[_0x2035c7(0x1072)]('rw',_0x512070[_0x2035c7(0x138f)],async()=>{const _0x5023c4=_0x2035c7;for(const _0x46a0bf of _0x1a1c3b){const _0x53317f=_0x208e6a[_0x46a0bf];if(!_0x53317f)continue;const _0x4075e8=_0x512070[_0x5023c4(0x459)](_0x46a0bf);if(!_0x4075e8){console[_0x5023c4(0x651)](_0x5023c4(0xd49)+_0x46a0bf+_0x5023c4(0xbdb));continue;}if(Array[_0x5023c4(0xb9b)](_0x53317f))console['log']('正在合并\x20'+_0x53317f['length']+'\x20条记录到\x20'+_0x46a0bf+'...'),await _0x4075e8[_0x5023c4(0xc71)](_0x53317f);else{if(typeof _0x53317f===_0x5023c4(0x12fe)&&_0x53317f['id'])console[_0x5023c4(0xe4d)](_0x5023c4(0x725)+_0x46a0bf+_0x5023c4(0x4a5)),await _0x4075e8[_0x5023c4(0xd4d)](_0x53317f);else{if(typeof _0x53317f===_0x5023c4(0x12fe)){console[_0x5023c4(0xe4d)](_0x5023c4(0x58a)+_0x46a0bf+_0x5023c4(0x4a5));const _0x466269=await _0x4075e8[_0x5023c4(0xa03)]()[_0x5023c4(0x92c)]()||{},_0x5b89c4={..._0x466269,..._0x53317f};if(_0x466269['id'])_0x5b89c4['id']=_0x466269['id'];else(_0x46a0bf===_0x5023c4(0xd22)||_0x46a0bf===_0x5023c4(0x9ce)||_0x46a0bf==='globalSettings'||_0x46a0bf==='musicLibrary')&&(_0x5b89c4['id']=_0x5023c4(0x1173));await _0x4075e8[_0x5023c4(0xd4d)](_0x5b89c4);}}}}}),await _0x403a62(_0x2035c7(0x529),_0x2035c7(0x726)),setTimeout(()=>window['location']['reload'](),0x5dc);}catch(_0x2b580c){console[_0x2035c7(0x3b7)](_0x2035c7(0xba9),_0x2b580c),await _0x403a62(_0x2035c7(0x40a),_0x2035c7(0x1389)+_0x2b580c[_0x2035c7(0xcce)]);}finally{pendingBackupData=null;}}async function _0x2c1370(_0x5a6c2e){const _0x5d54b7=_0x48bc6d;try{await _0x512070[_0x5d54b7(0x1072)]('rw',_0x512070[_0x5d54b7(0x138f)],async()=>{const _0x29d456=_0x5d54b7;await _0x512070['chats'][_0x29d456(0xe81)](),await _0x512070[_0x29d456(0x8e4)][_0x29d456(0xe81)]();for(const _0x20ec37 of _0x512070[_0x29d456(0x138f)]){await _0x20ec37[_0x29d456(0xe81)]();}if(Array[_0x29d456(0xb9b)](_0x5a6c2e[_0x29d456(0xb04)]))await _0x512070[_0x29d456(0xb04)]['bulkPut'](_0x5a6c2e['chats']);if(Array[_0x29d456(0xb9b)](_0x5a6c2e[_0x29d456(0x8e4)]))await _0x512070['worldBooks'][_0x29d456(0xc71)](_0x5a6c2e[_0x29d456(0x8e4)]);if(Array['isArray'](_0x5a6c2e[_0x29d456(0x1557)]))await _0x512070['userStickers'][_0x29d456(0xc71)](_0x5a6c2e['userStickers']);if(_0x5a6c2e['apiConfig'])await _0x512070[_0x29d456(0xd22)][_0x29d456(0xd4d)](_0x5a6c2e[_0x29d456(0xd22)]);if(_0x5a6c2e[_0x29d456(0x4c8)])await _0x512070[_0x29d456(0x4c8)][_0x29d456(0xd4d)](_0x5a6c2e[_0x29d456(0x4c8)]);if(Array[_0x29d456(0xb9b)](_0x5a6c2e[_0x29d456(0x1492)]))await _0x512070[_0x29d456(0x1492)][_0x29d456(0xc71)](_0x5a6c2e[_0x29d456(0x1492)]);if(_0x5a6c2e[_0x29d456(0x1008)])await _0x512070[_0x29d456(0x1008)][_0x29d456(0xd4d)](_0x5a6c2e['musicLibrary']);if(_0x5a6c2e[_0x29d456(0x9ce)])await _0x512070[_0x29d456(0x9ce)][_0x29d456(0xd4d)](_0x5a6c2e[_0x29d456(0x9ce)]);if(Array['isArray'](_0x5a6c2e[_0x29d456(0x10e5)]))await _0x512070[_0x29d456(0x10e5)][_0x29d456(0xc71)](_0x5a6c2e[_0x29d456(0x10e5)]);if(Array[_0x29d456(0xb9b)](_0x5a6c2e[_0x29d456(0x642)]))await _0x512070['qzoneAlbums'][_0x29d456(0xc71)](_0x5a6c2e[_0x29d456(0x642)]);if(Array['isArray'](_0x5a6c2e[_0x29d456(0xc8d)]))await _0x512070[_0x29d456(0xc8d)]['bulkPut'](_0x5a6c2e[_0x29d456(0xc8d)]);if(Array[_0x29d456(0xb9b)](_0x5a6c2e[_0x29d456(0x73d)]))await _0x512070['favorites']['bulkPut'](_0x5a6c2e[_0x29d456(0x73d)]);if(Array[_0x29d456(0xb9b)](_0x5a6c2e[_0x29d456(0xad9)]))await _0x512070[_0x29d456(0xad9)]['bulkPut'](_0x5a6c2e[_0x29d456(0xad9)]);if(Array[_0x29d456(0xb9b)](_0x5a6c2e[_0x29d456(0xe87)]))await _0x512070[_0x29d456(0xe87)][_0x29d456(0xc71)](_0x5a6c2e[_0x29d456(0xe87)]);if(Array['isArray'](_0x5a6c2e[_0x29d456(0x58d)]))await _0x512070[_0x29d456(0x58d)]['bulkPut'](_0x5a6c2e[_0x29d456(0x58d)]);if(Array[_0x29d456(0xb9b)](_0x5a6c2e[_0x29d456(0x83b)]))await _0x512070[_0x29d456(0x83b)]['bulkPut'](_0x5a6c2e[_0x29d456(0x83b)]);if(Array[_0x29d456(0xb9b)](_0x5a6c2e[_0x29d456(0x376)]))await _0x512070[_0x29d456(0x376)][_0x29d456(0xc71)](_0x5a6c2e['shoppingProducts']);if(Array[_0x29d456(0xb9b)](_0x5a6c2e['callRecords']))await _0x512070['callRecords'][_0x29d456(0xc71)](_0x5a6c2e[_0x29d456(0xad1)]);if(Array[_0x29d456(0xb9b)](_0x5a6c2e[_0x29d456(0xb54)]))await _0x512070[_0x29d456(0xb54)][_0x29d456(0xc71)](_0x5a6c2e[_0x29d456(0xb54)]);if(Array[_0x29d456(0xb9b)](_0x5a6c2e['doubanPosts']))await _0x512070[_0x29d456(0x34b)][_0x29d456(0xc71)](_0x5a6c2e[_0x29d456(0x34b)]);if(Array[_0x29d456(0xb9b)](_0x5a6c2e[_0x29d456(0x39d)]))await _0x512070[_0x29d456(0x39d)][_0x29d456(0xc71)](_0x5a6c2e[_0x29d456(0x39d)]);if(Array['isArray'](_0x5a6c2e[_0x29d456(0xac9)]))await _0x512070[_0x29d456(0xac9)][_0x29d456(0xc71)](_0x5a6c2e[_0x29d456(0xac9)]);if(Array['isArray'](_0x5a6c2e[_0x29d456(0xded)]))await _0x512070[_0x29d456(0xded)][_0x29d456(0xc71)](_0x5a6c2e[_0x29d456(0xded)]);if(Array['isArray'](_0x5a6c2e['presetCategories']))await _0x512070[_0x29d456(0xb4d)][_0x29d456(0xc71)](_0x5a6c2e[_0x29d456(0xb4d)]);if(Array[_0x29d456(0xb9b)](_0x5a6c2e['npcs']))await _0x512070[_0x29d456(0x5b7)]['bulkPut'](_0x5a6c2e[_0x29d456(0x5b7)]);});}catch(_0x36f9c1){throw new Error(_0x5d54b7(0xf0d)+_0x36f9c1[_0x5d54b7(0xcce)]);}}function _0x124e17(_0x15d833,_0x29c54d=![]){const _0x6f1b66=_0x48bc6d;if(!_0x15d833){_0x3cbaf3['innerHTML']='',document['getElementById'](_0x6f1b66(0x11df))[_0x6f1b66(0x20f)][_0x6f1b66(0x1b2)]='';return;}const _0x5be9eb=_0x6f1b66(0xe37),_0x299a7f=_0x6f1b66(0x111c)+_0x5be9eb+'\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27'+_0x15d833+_0x6f1b66(0x14e2);if(_0x29c54d){const _0x165e61=document[_0x6f1b66(0x9a3)](_0x6f1b66(0x683))||document[_0x6f1b66(0xe94)](_0x6f1b66(0x20f));_0x165e61['id']=_0x6f1b66(0x683),_0x165e61['innerHTML']=_0x299a7f;if(!document[_0x6f1b66(0x9a3)](_0x6f1b66(0x683)))document[_0x6f1b66(0x1552)]['appendChild'](_0x165e61);document[_0x6f1b66(0x9a3)](_0x6f1b66(0x11df))[_0x6f1b66(0x20f)][_0x6f1b66(0x1b2)]='\x27'+_0x5be9eb+_0x6f1b66(0x56d);}else _0x3cbaf3[_0x6f1b66(0xeb2)]=_0x6f1b66(0x15bd)+_0x299a7f+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27'+_0x5be9eb+_0x6f1b66(0x144b);}async function _0x468247(){const _0x49bff3=_0x48bc6d;_0x3cbaf3[_0x49bff3(0xeb2)]='',_0x19ddb8['globalSettings'][_0x49bff3(0x12ce)]='',await _0x512070['globalSettings'][_0x49bff3(0xd4d)](_0x19ddb8['globalSettings']),document[_0x49bff3(0x9a3)]('font-url-input')[_0x49bff3(0x7b2)]='',document[_0x49bff3(0x9a3)](_0x49bff3(0x11df))[_0x49bff3(0x20f)][_0x49bff3(0x1b2)]='',alert(_0x49bff3(0x1369));}async function _0x11ed48(){const _0x59e0de=_0x48bc6d,[_0x21af7d,_0x2641d4,_0x47890e,_0x4da9e3,_0x349a1f,_0x47321f,_0x31bec6,_0x140d50,_0x28694e,_0x1a8ca2,_0x185546]=await Promise[_0x59e0de(0xbf1)]([_0x512070['chats'][_0x59e0de(0x591)](),_0x512070[_0x59e0de(0xd22)][_0x59e0de(0x14ee)](_0x59e0de(0x1173)),_0x512070['globalSettings'][_0x59e0de(0x14ee)](_0x59e0de(0x1173)),_0x512070[_0x59e0de(0x1557)][_0x59e0de(0x591)](),_0x512070['worldBooks']['toArray'](),_0x512070['musicLibrary'][_0x59e0de(0x14ee)](_0x59e0de(0x1173)),_0x512070[_0x59e0de(0x1492)][_0x59e0de(0x591)](),_0x512070[_0x59e0de(0x9ce)][_0x59e0de(0x14ee)](_0x59e0de(0x1173)),_0x512070[_0x59e0de(0x73d)][_0x59e0de(0x1404)]('timestamp')['reverse']()[_0x59e0de(0x591)](),_0x512070[_0x59e0de(0xe87)]['toArray'](),_0x512070['presets'][_0x59e0de(0x591)]()]);_0x19ddb8[_0x59e0de(0xded)]=_0x185546||[];const _0x34f58a={'id':'main','showStatusBar':![],'wallpaper':_0x59e0de(0xe74),'fontUrl':'','enableBackgroundActivity':![],'backgroundActivityInterval':0x3c,'blockCooldownHours':0x1,'apiTemperature':0.8,'appIcons':{..._0x540a3d},'cphoneWallpaper':_0x59e0de(0x28b),'cphoneAppIcons':{..._0x42106a},'globalCss':'','notificationSoundUrl':'','widgetData':{},'globalChatBackground':'','enableAiDrawing':!![],'showPhoneFrame':![],'alwaysShowMusicIsland':![],'detachStatusBar':![],'enableMinimalChatUI':![],'chatActionButtonsOrder':null,'shoppingCategoryCount':0x3,'shoppingProductCount':0x8,'chatRenderWindow':0x32};_0x19ddb8['globalSettings']={..._0x34f58a,..._0x47890e||{}},_0x19ddb8[_0x59e0de(0x4c8)]['appIcons']={..._0x34f58a[_0x59e0de(0xbb4)],..._0x19ddb8[_0x59e0de(0x4c8)][_0x59e0de(0xbb4)]||{}},_0x19ddb8[_0x59e0de(0x4c8)][_0x59e0de(0xa4e)]={..._0x34f58a[_0x59e0de(0xa4e)],..._0x19ddb8['globalSettings'][_0x59e0de(0xa4e)]||{}},_0x21af7d[_0x59e0de(0x15c1)](_0x1c8203=>{const _0x3b7e36=_0x59e0de;typeof _0x1c8203[_0x3b7e36(0x450)][_0x3b7e36(0x2de)]===_0x3b7e36(0x738)&&(_0x1c8203[_0x3b7e36(0x450)][_0x3b7e36(0x2de)]=!![]),!_0x1c8203[_0x3b7e36(0x450)]['lyricsPosition']&&(_0x1c8203[_0x3b7e36(0x450)][_0x3b7e36(0x13a1)]={'vertical':'top','horizontal':_0x3b7e36(0xd4f),'offset':0xa}),!_0x1c8203[_0x3b7e36(0x136b)]&&!_0x1c8203[_0x3b7e36(0x450)][_0x3b7e36(0xa70)]&&(_0x1c8203[_0x3b7e36(0x450)][_0x3b7e36(0xa70)]=[]),!_0x1c8203[_0x3b7e36(0x136b)]&&typeof _0x1c8203[_0x3b7e36(0x339)]==='undefined'&&(_0x1c8203[_0x3b7e36(0x339)]=_0x1c8203[_0x3b7e36(0x1561)]);}),_0x19ddb8['chats']=_0x21af7d[_0x59e0de(0x68f)]((_0x218d92,_0x5f18c0)=>{const _0x3109c8=_0x59e0de;if(typeof _0x5f18c0[_0x3109c8(0xe20)]===_0x3109c8(0x738))_0x5f18c0['unreadCount']=0x0;_0x5f18c0[_0x3109c8(0x136b)]&&(typeof _0x5f18c0['settings'][_0x3109c8(0x106e)]===_0x3109c8(0x738)&&(_0x5f18c0['settings'][_0x3109c8(0x106e)]=!![]),_0x5f18c0[_0x3109c8(0xcca)]&&_0x5f18c0['members'][_0x3109c8(0x106b)]>0x0&&_0x5f18c0[_0x3109c8(0xcca)][0x0][_0x3109c8(0x1561)]&&_0x5f18c0['members'][_0x3109c8(0x15c1)](_0x4414b0=>{const _0x41f55b=_0x3109c8;typeof _0x4414b0[_0x41f55b(0x339)]===_0x41f55b(0x738)&&(_0x4414b0[_0x41f55b(0x339)]=_0x4414b0[_0x41f55b(0x1561)],_0x4414b0[_0x41f55b(0xaf0)]=_0x4414b0['name'],delete _0x4414b0[_0x41f55b(0x1561)]);}));if(!_0x5f18c0[_0x3109c8(0x450)])_0x5f18c0[_0x3109c8(0x450)]={};typeof _0x5f18c0[_0x3109c8(0x450)][_0x3109c8(0x605)]===_0x3109c8(0x738)&&(_0x5f18c0[_0x3109c8(0x450)]['actionCooldownMinutes']=0xa);if(!_0x5f18c0[_0x3109c8(0x136b)]&&!_0x5f18c0[_0x3109c8(0x27d)])_0x5f18c0[_0x3109c8(0x27d)]={'text':'在线','lastUpdate':Date[_0x3109c8(0x64b)](),'isBusy':![]};if(!_0x5f18c0[_0x3109c8(0x136b)]&&!_0x5f18c0[_0x3109c8(0x239)])_0x5f18c0[_0x3109c8(0x239)]={'status':_0x3109c8(0xf81),'blockedTimestamp':null,'applicationReason':''};if(!_0x5f18c0[_0x3109c8(0x136b)]&&(!_0x5f18c0['settings']||!_0x5f18c0[_0x3109c8(0x450)][_0x3109c8(0xea2)])){if(!_0x5f18c0[_0x3109c8(0x450)])_0x5f18c0[_0x3109c8(0x450)]={};_0x5f18c0['settings']['aiAvatarLibrary']=[];}_0x5f18c0[_0x3109c8(0x136b)]&&(_0x5f18c0[_0x3109c8(0xcca)]||[])[_0x3109c8(0x15c1)](_0x4ab96c=>{const _0xa4108c=_0x3109c8;if(typeof _0x4ab96c[_0xa4108c(0x10d5)]===_0xa4108c(0x738))_0x4ab96c['avatarFrame']='';});if(!_0x5f18c0[_0x3109c8(0x8d3)])_0x5f18c0[_0x3109c8(0x8d3)]={'totalTime':0x0};_0x5f18c0['settings']&&_0x5f18c0[_0x3109c8(0x450)][_0x3109c8(0xbaf)]&&!_0x5f18c0['settings']['linkedWorldBookIds']&&(_0x5f18c0[_0x3109c8(0x450)][_0x3109c8(0x9c4)]=[_0x5f18c0[_0x3109c8(0x450)][_0x3109c8(0xbaf)]],delete _0x5f18c0['settings'][_0x3109c8(0xbaf)]);if(typeof _0x5f18c0[_0x3109c8(0x14d8)]==='undefined')_0x5f18c0[_0x3109c8(0x14d8)]=![];!_0x5f18c0['isGroup']&&typeof _0x5f18c0[_0x3109c8(0x450)][_0x3109c8(0x1555)]===_0x3109c8(0x738)&&(_0x5f18c0['settings']['myNickname']='我');if(_0x5f18c0[_0x3109c8(0x136b)]&&_0x5f18c0[_0x3109c8(0xcca)]){let _0x2047c4=![];_0x21af7d[_0x3109c8(0x15c1)](_0x16c224=>{const _0x9d52eb=_0x3109c8;_0x16c224['id']===_0x5f18c0['id']&&_0x16c224[_0x9d52eb(0x339)]&&delete _0x16c224[_0x9d52eb(0x339)];}),_0x5f18c0['members'][_0x3109c8(0x15c1)](_0x2e4e9d=>{const _0x275d6c=_0x3109c8,_0x1a6bd3=_0x21af7d[_0x275d6c(0xd62)](_0x5bc3c3=>_0x5bc3c3['id']===_0x2e4e9d['id']);if(_0x1a6bd3&&_0x1a6bd3['settings']){const _0x35d440=_0x1a6bd3[_0x275d6c(0x450)][_0x275d6c(0xdc8)]||'';_0x2e4e9d[_0x275d6c(0x10d5)]!==_0x35d440&&(_0x2e4e9d[_0x275d6c(0x10d5)]=_0x35d440,_0x2047c4=!![]);}else typeof _0x2e4e9d['avatarFrame']===_0x275d6c(0x738)&&(_0x2e4e9d['avatarFrame']='',_0x2047c4=!![]);});if(_0x2047c4)_0x512070[_0x3109c8(0xb04)][_0x3109c8(0xd4d)](_0x5f18c0);}if(!_0x5f18c0['settings'][_0x3109c8(0x1525)])_0x5f18c0[_0x3109c8(0x450)]['enableAutoMemory']=![];if(!_0x5f18c0[_0x3109c8(0x450)][_0x3109c8(0xdf7)])_0x5f18c0['settings'][_0x3109c8(0xdf7)]=0x14;if(!_0x5f18c0[_0x3109c8(0x744)])_0x5f18c0['longTermMemory']=[];if(!_0x5f18c0[_0x3109c8(0x825)])_0x5f18c0['lastMemorySummaryTimestamp']=0x0;if(!_0x5f18c0[_0x3109c8(0x136b)]){typeof _0x5f18c0['settings']['enableBackgroundActivity']===_0x3109c8(0x738)&&(_0x5f18c0[_0x3109c8(0x450)][_0x3109c8(0x106e)]=!![]);typeof _0x5f18c0[_0x3109c8(0x450)][_0x3109c8(0x1547)]===_0x3109c8(0x738)&&(_0x5f18c0[_0x3109c8(0x450)][_0x3109c8(0x1547)]=![]);if(!_0x5f18c0[_0x3109c8(0x27d)])_0x5f18c0[_0x3109c8(0x27d)]={'text':'在线','lastUpdate':Date['now'](),'isBusy':![]};if(!_0x5f18c0[_0x3109c8(0x239)])_0x5f18c0[_0x3109c8(0x239)]={'status':_0x3109c8(0xf81),'blockedTimestamp':null,'applicationReason':''};if(!_0x5f18c0[_0x3109c8(0x450)]||!_0x5f18c0['settings'][_0x3109c8(0xea2)]){if(!_0x5f18c0[_0x3109c8(0x450)])_0x5f18c0[_0x3109c8(0x450)]={};_0x5f18c0[_0x3109c8(0x450)]['aiAvatarLibrary']=[];}if(typeof _0x5f18c0[_0x3109c8(0x450)][_0x3109c8(0x1267)]==='undefined')_0x5f18c0[_0x3109c8(0x450)][_0x3109c8(0x1267)]=![];if(typeof _0x5f18c0[_0x3109c8(0x450)]['offlineMinLength']==='undefined')_0x5f18c0[_0x3109c8(0x450)][_0x3109c8(0xf97)]=0x64;if(typeof _0x5f18c0['settings'][_0x3109c8(0xa4a)]===_0x3109c8(0x738))_0x5f18c0[_0x3109c8(0x450)][_0x3109c8(0xa4a)]=0x12c;typeof _0x5f18c0['settings']['injectLatestThought']==='undefined'&&(_0x5f18c0[_0x3109c8(0x450)][_0x3109c8(0x8be)]=![]);if(typeof _0x5f18c0['heartfeltVoice']===_0x3109c8(0x738))_0x5f18c0[_0x3109c8(0x390)]='...';if(typeof _0x5f18c0[_0x3109c8(0x69b)]===_0x3109c8(0x738))_0x5f18c0[_0x3109c8(0x69b)]=_0x3109c8(0x4a5);!Array['isArray'](_0x5f18c0[_0x3109c8(0xd4a)])&&(_0x5f18c0[_0x3109c8(0xd4a)]=[]);}return typeof _0x5f18c0[_0x3109c8(0x450)]['stickerCategoryIds']===_0x3109c8(0x738)&&(_0x5f18c0[_0x3109c8(0x450)][_0x3109c8(0x140d)]?_0x5f18c0[_0x3109c8(0x450)][_0x3109c8(0x7dd)]=[_0x5f18c0[_0x3109c8(0x450)][_0x3109c8(0x140d)]]:_0x5f18c0[_0x3109c8(0x450)]['stickerCategoryIds']=[],delete _0x5f18c0[_0x3109c8(0x450)][_0x3109c8(0x140d)]),_0x218d92[_0x5f18c0['id']]=_0x5f18c0,_0x218d92;},{});const _0x1d9157=[];_0x1a8ca2[_0x59e0de(0x15c1)](_0x6853c8=>{const _0x48156f=_0x59e0de;if(_0x6853c8[_0x48156f(0x1508)]==='ai_generated'&&_0x6853c8[_0x48156f(0x75c)]&&!_0x6853c8[_0x48156f(0x82c)]){const _0x2b2256=_0x21af7d[_0x48156f(0xd62)](_0x5567d2=>!_0x5567d2['isGroup']&&_0x5567d2[_0x48156f(0x339)]===_0x6853c8[_0x48156f(0x75c)]);if(_0x2b2256)_0x6853c8[_0x48156f(0x82c)]=_0x2b2256['id'],_0x1d9157['push'](_0x6853c8);else{const _0x3640b9=_0x21af7d[_0x48156f(0xd62)](_0x234601=>!_0x234601[_0x48156f(0x136b)]&&_0x234601[_0x48156f(0x1561)]===_0x6853c8[_0x48156f(0x75c)]);_0x3640b9&&(_0x6853c8[_0x48156f(0x82c)]=_0x3640b9['id'],_0x1d9157['push'](_0x6853c8));}}}),_0x1d9157[_0x59e0de(0x106b)]>0x0&&await _0x512070[_0x59e0de(0xe87)][_0x59e0de(0xc71)](_0x1d9157),_0x19ddb8[_0x59e0de(0xd22)]=_0x2641d4||{'id':'main','proxyUrl':'','apiKey':'','model':'','secondaryProxyUrl':'','secondaryApiKey':'','secondaryModel':'','minimaxGroupId':'','minimaxApiKey':'','minimaxModel':'speech-01'},_0x19ddb8[_0x59e0de(0x1557)]=_0x4da9e3||[],_0x19ddb8['worldBooks']=_0x349a1f||[],_0x4e0631[_0x59e0de(0x496)]=_0x47321f?.['playlist']||[],_0x19ddb8[_0x59e0de(0x1492)]=_0x31bec6||[],_0x19ddb8[_0x59e0de(0x9ce)]=_0x140d50||{'id':'main','nickname':'{{user}}','avatar':_0x59e0de(0xc50),'banner':_0x59e0de(0x421)},allFavoriteItems=_0x28694e||[];}async function _0x21cadb(){const _0x476115=_0x48bc6d;await _0x512070[_0x476115(0x1008)][_0x476115(0xd4d)]({'id':_0x476115(0x1173),'playlist':_0x4e0631[_0x476115(0x496)]});}function _0x13147d(_0x4f0201){const _0x28eb11=_0x48bc6d;if(!_0x4f0201)return'';const _0x21df13=new Date(_0x4f0201),_0x3fa31e=String(_0x21df13['getHours']())[_0x28eb11(0x1488)](0x2,'0'),_0x8ee028=String(_0x21df13['getMinutes']())[_0x28eb11(0x1488)](0x2,'0');return _0x3fa31e+':'+_0x8ee028;}function _0x5d6abc(_0x55564d){const _0xfdd73c=_0x48bc6d,_0x243296=Date['now'](),_0x2bacd9=Math[_0xfdd73c(0xd95)]((_0x243296-_0x55564d)/0x3e8);if(_0x2bacd9<0x3c)return'刚刚';const _0x2b4877=Math[_0xfdd73c(0xd95)](_0x2bacd9/0x3c);if(_0x2b4877<0x3c)return _0x2b4877+'分钟前';const _0x2fba48=Math[_0xfdd73c(0xd95)](_0x2b4877/0x3c);if(_0x2fba48<0x18)return _0x2fba48+_0xfdd73c(0x9f0);const _0xa23291=Math['floor'](_0x2fba48/0x18);if(_0xa23291<0x1e)return _0xa23291+'天前';const _0xe84f83=Math[_0xfdd73c(0xd95)](_0xa23291/0x1e);if(_0xe84f83<0xc)return'大约'+_0xe84f83+_0xfdd73c(0xfec);const _0x5101f8=Math[_0xfdd73c(0xd95)](_0xa23291/0x16d);return'大约'+_0x5101f8+'年前';}function _0x4c879a(_0x253279){const _0x10f37d=_0x48bc6d;if(!_0x253279)return'';const _0x1c0a4c=new Date(),_0x33e37e=new Date(_0x253279),_0x1ea052=String(_0x33e37e['getHours']())['padStart'](0x2,'0'),_0x3270b5=String(_0x33e37e[_0x10f37d(0xa21)]())['padStart'](0x2,'0'),_0x482aea=_0x1ea052+':'+_0x3270b5;if(_0x1c0a4c[_0x10f37d(0x1514)]()===_0x33e37e[_0x10f37d(0x1514)]())return _0x10f37d(0x21d)+_0x482aea;const _0xfa8048=new Date();_0xfa8048[_0x10f37d(0x7ee)](_0x1c0a4c[_0x10f37d(0x67c)]()-0x1);if(_0xfa8048['toDateString']()===_0x33e37e[_0x10f37d(0x1514)]())return _0x10f37d(0x247)+_0x482aea;if(_0x1c0a4c['getFullYear']()===_0x33e37e[_0x10f37d(0xef7)]()){const _0x577c3c=String(_0x33e37e['getMonth']()+0x1),_0x34025a=String(_0x33e37e[_0x10f37d(0x67c)]());return _0x577c3c+'月'+_0x34025a+'日\x20'+_0x482aea;}const _0xe60c31=_0x33e37e[_0x10f37d(0xef7)](),_0x5ced5b=String(_0x33e37e[_0x10f37d(0x1428)]()+0x1),_0x4967ee=String(_0x33e37e['getDate']());return _0xe60c31+'年'+_0x5ced5b+'月'+_0x4967ee+'日\x20'+_0x482aea;}function _0x54ff67(){const _0x2c748e=_0x48bc6d,_0x40373b=_0x520f76();document['getElementById'](_0x2c748e(0x19b))['value']=_0x40373b[_0x2c748e(0xab4)],document[_0x2c748e(0x9a3)](_0x2c748e(0x116a))[_0x2c748e(0x7b2)]=_0x40373b[_0x2c748e(0x124e)],document[_0x2c748e(0x9a3)](_0x2c748e(0x1378))[_0x2c748e(0x7b2)]=_0x40373b[_0x2c748e(0xd7e)],document[_0x2c748e(0x9a3)](_0x2c748e(0x1578))[_0x2c748e(0x7b2)]=_0x40373b[_0x2c748e(0x1f6)],document[_0x2c748e(0x9a3)]('nai-seed')[_0x2c748e(0x7b2)]=_0x40373b[_0x2c748e(0xaec)],document['getElementById'](_0x2c748e(0x1172))['value']=_0x40373b[_0x2c748e(0x70e)],document[_0x2c748e(0x9a3)](_0x2c748e(0x107c))[_0x2c748e(0x944)]=_0x40373b[_0x2c748e(0x14e7)],document[_0x2c748e(0x9a3)](_0x2c748e(0x146a))[_0x2c748e(0x944)]=_0x40373b[_0x2c748e(0x1b9)],document[_0x2c748e(0x9a3)](_0x2c748e(0x103a))[_0x2c748e(0x944)]=_0x40373b['smea_dyn'],document[_0x2c748e(0x9a3)](_0x2c748e(0xe63))[_0x2c748e(0x7b2)]=_0x40373b['default_positive'],document[_0x2c748e(0x9a3)](_0x2c748e(0x589))[_0x2c748e(0x7b2)]=_0x40373b[_0x2c748e(0x12b4)],document[_0x2c748e(0x9a3)](_0x2c748e(0x1275))['value']=_0x40373b['cors_proxy'],document[_0x2c748e(0x9a3)](_0x2c748e(0xd12))['value']=_0x40373b[_0x2c748e(0x1421)]||'';const _0x3f8306=document[_0x2c748e(0x9a3)](_0x2c748e(0xcad));_0x3f8306[_0x2c748e(0x20f)][_0x2c748e(0x115d)]=_0x40373b[_0x2c748e(0x553)]===_0x2c748e(0xbe4)?_0x2c748e(0x10c8):_0x2c748e(0x8e0);}function _0x4b0ea9(){const _0x2ccd33=_0x48bc6d,_0x3fd67c=document['getElementById'](_0x2ccd33(0x969))[_0x2ccd33(0x944)],_0x32dec3=document[_0x2ccd33(0x9a3)](_0x2ccd33(0xfee))[_0x2ccd33(0x7b2)],_0x436c77=document[_0x2ccd33(0x9a3)](_0x2ccd33(0x4a1))[_0x2ccd33(0x7b2)]['trim']();localStorage[_0x2ccd33(0x28a)](_0x2ccd33(0x95b),_0x3fd67c),localStorage[_0x2ccd33(0x28a)](_0x2ccd33(0xfee),_0x32dec3),localStorage[_0x2ccd33(0x28a)](_0x2ccd33(0x4a1),_0x436c77);const _0x3ae9f7={'resolution':document[_0x2ccd33(0x9a3)]('nai-resolution')['value'],'steps':parseInt(document[_0x2ccd33(0x9a3)](_0x2ccd33(0x116a))[_0x2ccd33(0x7b2)]),'cfg_scale':parseFloat(document[_0x2ccd33(0x9a3)]('nai-cfg-scale')[_0x2ccd33(0x7b2)]),'sampler':document[_0x2ccd33(0x9a3)](_0x2ccd33(0x1578))[_0x2ccd33(0x7b2)],'seed':parseInt(document[_0x2ccd33(0x9a3)](_0x2ccd33(0x252))[_0x2ccd33(0x7b2)]),'uc_preset':parseInt(document[_0x2ccd33(0x9a3)]('nai-uc-preset')[_0x2ccd33(0x7b2)]),'quality_toggle':document['getElementById'](_0x2ccd33(0x107c))[_0x2ccd33(0x944)],'smea':document[_0x2ccd33(0x9a3)](_0x2ccd33(0x146a))['checked'],'smea_dyn':document[_0x2ccd33(0x9a3)](_0x2ccd33(0x103a))[_0x2ccd33(0x944)],'default_positive':document['getElementById'](_0x2ccd33(0xe63))[_0x2ccd33(0x7b2)],'default_negative':document[_0x2ccd33(0x9a3)](_0x2ccd33(0x589))['value'],'cors_proxy':document[_0x2ccd33(0x9a3)]('nai-cors-proxy')[_0x2ccd33(0x7b2)],'custom_proxy_url':document[_0x2ccd33(0x9a3)]('nai-custom-proxy-url')[_0x2ccd33(0x7b2)]};localStorage[_0x2ccd33(0x28a)](_0x2ccd33(0xfea),JSON[_0x2ccd33(0xe1e)](_0x3ae9f7));}function _0x53b56a(){const _0x1efbdd=_0x48bc6d;localStorage['removeItem']('novelai-settings'),_0x54ff67(),alert(_0x1efbdd(0x3dd));}function _0x520f76(){const _0x18c6da=_0x48bc6d,_0x28cbc6={'resolution':_0x18c6da(0xe54),'steps':0x1c,'cfg_scale':0x5,'sampler':_0x18c6da(0x617),'seed':-0x1,'uc_preset':0x1,'quality_toggle':!![],'smea':!![],'smea_dyn':![],'default_positive':'masterpiece,\x20best\x20quality,\x201girl,\x20beautiful,\x20detailed\x20face,\x20detailed\x20eyes,\x20long\x20hair,\x20anime\x20style','default_negative':_0x18c6da(0x1006),'cors_proxy':_0x18c6da(0xbe1),'custom_proxy_url':''},_0x35b129=localStorage[_0x18c6da(0x5de)]('novelai-settings');if(_0x35b129)try{return{..._0x28cbc6,...JSON[_0x18c6da(0x1447)](_0x35b129)};}catch(_0x1dce88){return _0x28cbc6;}return _0x28cbc6;}async function _0x34bcbc(_0x10db99,_0xb90a78){const _0x458cc9=_0x48bc6d;console[_0x458cc9(0xe4d)](_0x458cc9(0x1c2)+_0x10db99+'\x22,\x20ChatID:\x20'+_0xb90a78);const _0x4226ff=_0x2bcefd(_0xb90a78),_0x539514=_0x10db99+',\x20'+_0x4226ff['positive'],_0x2af0ba=_0x4226ff[_0x458cc9(0x6a6)];console[_0x458cc9(0xe4d)]('📝\x20使用'+(_0x4226ff['source']==='character'?_0x458cc9(0x1469):'系统')+_0x458cc9(0xddb)),console['log'](_0x458cc9(0x380),_0x539514),console[_0x458cc9(0xe4d)](_0x458cc9(0x953),_0x2af0ba);const _0x26c38d=localStorage[_0x458cc9(0x5de)]('novelai-api-key'),_0x1eb275=localStorage[_0x458cc9(0x5de)](_0x458cc9(0xfee))||_0x458cc9(0x9dd),_0x5f14e8=_0x520f76();if(!_0x26c38d)throw new Error('NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。');const [_0x3e9dd5,_0x400b67]=_0x5f14e8['resolution'][_0x458cc9(0x1536)]('x')['map'](Number);let _0x165f4d;_0x1eb275[_0x458cc9(0x478)](_0x458cc9(0xb29))?_0x165f4d={'input':_0x539514,'model':_0x1eb275,'action':'generate','parameters':{'params_version':0x3,'width':_0x3e9dd5,'height':_0x400b67,'scale':_0x5f14e8[_0x458cc9(0xd7e)],'sampler':_0x5f14e8[_0x458cc9(0x1f6)],'steps':_0x5f14e8[_0x458cc9(0x124e)],'seed':_0x5f14e8[_0x458cc9(0xaec)]===-0x1?Math[_0x458cc9(0xd95)](Math['random']()*0x2540be3ff):_0x5f14e8[_0x458cc9(0xaec)],'n_samples':0x1,'ucPreset':_0x5f14e8[_0x458cc9(0x70e)],'qualityToggle':_0x5f14e8['quality_toggle'],'add_original_image':!![],'noise_schedule':'karras','v4_prompt':{'caption':{'base_caption':_0x539514,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x2af0ba,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x2af0ba,'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'cfg_rescale':0x0,'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x165f4d={'input':_0x539514,'model':_0x1eb275,'action':'generate','parameters':{'width':_0x3e9dd5,'height':_0x400b67,'scale':_0x5f14e8['cfg_scale'],'sampler':_0x5f14e8['sampler'],'steps':_0x5f14e8[_0x458cc9(0x124e)],'seed':_0x5f14e8['seed']===-0x1?Math['floor'](Math['random']()*0x2540be3ff):_0x5f14e8[_0x458cc9(0xaec)],'n_samples':0x1,'ucPreset':_0x5f14e8[_0x458cc9(0x70e)],'qualityToggle':_0x5f14e8[_0x458cc9(0x14e7)],'sm':_0x5f14e8['smea'],'sm_dyn':_0x5f14e8['smea_dyn'],'negative_prompt':_0x2af0ba,'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x458cc9(0xce0)}};console['log'](_0x458cc9(0x1122),_0x165f4d);let _0x407740;_0x1eb275[_0x458cc9(0x478)]('nai-diffusion-4')?_0x407740=_0x458cc9(0x335):_0x407740='https://image.novelai.net/ai/generate-image';let _0x2065a2=_0x5f14e8[_0x458cc9(0x553)];_0x2065a2===_0x458cc9(0xbe4)&&(_0x2065a2=_0x5f14e8[_0x458cc9(0x1421)]||'');_0x2065a2&&_0x2065a2!==''&&(_0x407740=_0x2065a2+encodeURIComponent(_0x407740));const _0x3bab1c=await fetch(_0x407740,{'method':_0x458cc9(0x12db),'headers':{'Content-Type':'application/json','Authorization':_0x458cc9(0x1265)+_0x26c38d},'body':JSON[_0x458cc9(0xe1e)](_0x165f4d)});if(!_0x3bab1c['ok']){const _0x1442b4=await _0x3bab1c['text']();throw new Error('API请求失败\x20('+_0x3bab1c[_0x458cc9(0x27d)]+_0x458cc9(0x41b)+_0x1442b4);}const _0xf82d67=_0x3bab1c[_0x458cc9(0x13ee)][_0x458cc9(0x14ee)](_0x458cc9(0x1522));let _0x332b58,_0x5c5e2f;if(_0xf82d67&&_0xf82d67['includes']('text/event-stream')){const _0x510f61=await _0x3bab1c[_0x458cc9(0x13ca)](),_0x592368=_0x510f61['trim']()['split']('\x0a');let _0x3dd056=null;for(let _0x1d94a2=_0x592368['length']-0x1;_0x1d94a2>=0x0;_0x1d94a2--){const _0x41c90e=_0x592368[_0x1d94a2][_0x458cc9(0x13f9)]();if(_0x41c90e[_0x458cc9(0x608)](_0x458cc9(0x5ba))&&_0x41c90e!==_0x458cc9(0xa69)){const _0x498ed2=_0x41c90e[_0x458cc9(0x72e)](0x6);try{const _0x43fb58=JSON[_0x458cc9(0x1447)](_0x498ed2);if(_0x43fb58[_0x458cc9(0x50b)]===_0x458cc9(0x1065)&&_0x43fb58[_0x458cc9(0x547)]){_0x3dd056=_0x43fb58[_0x458cc9(0x547)];break;}if(_0x43fb58['data']){_0x3dd056=_0x43fb58[_0x458cc9(0x38c)];break;}if(_0x43fb58[_0x458cc9(0x547)]){_0x3dd056=_0x43fb58[_0x458cc9(0x547)];break;}}catch(_0x49bb0a){_0x3dd056=_0x498ed2;break;}}}if(!_0x3dd056)throw new Error('无法从\x20SSE\x20响应中提取图片数据');const _0x3dfade=_0x3dd056['startsWith'](_0x458cc9(0x14fa)),_0x45396a=_0x3dd056['startsWith'](_0x458cc9(0xf7a));if(_0x3dfade||_0x45396a)_0x5c5e2f='data:'+(_0x3dfade?_0x458cc9(0x15af):_0x458cc9(0x80a))+_0x458cc9(0x287)+_0x3dd056;else{const _0xbe64c8=atob(_0x3dd056),_0x45e661=new Uint8Array(_0xbe64c8['length']);for(let _0xd78a84=0x0;_0xd78a84<_0xbe64c8[_0x458cc9(0x106b)];_0xd78a84++)_0x45e661[_0xd78a84]=_0xbe64c8[_0x458cc9(0xc75)](_0xd78a84);_0x332b58=new Blob([_0x45e661]);}}else _0x332b58=await _0x3bab1c[_0x458cc9(0xf11)]();if(!_0x5c5e2f&&_0x332b58){if(typeof JSZip===_0x458cc9(0x738))throw new Error('JSZip库未加载');const _0x46286a=await JSZip[_0x458cc9(0xf9a)](_0x332b58);let _0x232319=null;for(let _0x4ce539 in _0x46286a[_0x458cc9(0x104e)]){if(_0x4ce539['match'](/\.(png|jpg|jpeg|webp)$/i)){_0x232319=_0x46286a[_0x458cc9(0x104e)][_0x4ce539];break;}}if(!_0x232319)throw new Error(_0x458cc9(0x14cd));const _0x2ca6ef=await _0x232319[_0x458cc9(0xf7f)](_0x458cc9(0xf11));_0x5c5e2f=await new Promise((_0x52e9db,_0x593545)=>{const _0x502b4e=_0x458cc9,_0x14210b=new FileReader();_0x14210b[_0x502b4e(0x15b8)]=()=>_0x52e9db(_0x14210b[_0x502b4e(0x5c9)]),_0x14210b[_0x502b4e(0xb8b)]=_0x593545,_0x14210b[_0x502b4e(0xdd8)](_0x2ca6ef);});}return console['log'](_0x458cc9(0x1b1)),{'imageUrl':_0x5c5e2f,'fullPrompt':_0x539514};}function _0x2bcefd(_0x388eb6){const _0x1b443c=_0x48bc6d,_0x449808=_0x520f76();if(!_0x388eb6||!_0x19ddb8[_0x1b443c(0xb04)][_0x388eb6])return console[_0x1b443c(0xe4d)](_0x1b443c(0x303)),{'positive':_0x449808[_0x1b443c(0xcbb)],'negative':_0x449808[_0x1b443c(0x12b4)],'source':_0x1b443c(0xe10)};const _0x43430e=_0x19ddb8[_0x1b443c(0xb04)][_0x388eb6],_0x2d2203=_0x43430e[_0x1b443c(0x450)]['naiSettings']||{};return _0x2d2203['promptSource']===_0x1b443c(0xb44)?(console[_0x1b443c(0xe4d)](_0x1b443c(0x1087)),console[_0x1b443c(0xe4d)](_0x1b443c(0x587),_0x2d2203[_0x1b443c(0x208)]||_0x1b443c(0x144d)),console[_0x1b443c(0xe4d)](_0x1b443c(0x2d9),_0x2d2203[_0x1b443c(0xc51)]||_0x1b443c(0x144d)),{'positive':_0x2d2203[_0x1b443c(0x208)]||'','negative':_0x2d2203['characterNegativePrompt']||'','source':_0x1b443c(0xb44)}):(console['log']('✅\x20NAI提示词：使用系统配置'),console[_0x1b443c(0xe4d)](_0x1b443c(0x587),_0x449808['default_positive']||_0x1b443c(0x144d)),console[_0x1b443c(0xe4d)](_0x1b443c(0x2d9),_0x449808[_0x1b443c(0x12b4)]||_0x1b443c(0x144d)),{'positive':_0x449808['default_positive'],'negative':_0x449808['default_negative'],'source':_0x1b443c(0xe10)});}async function _0x274315(){const _0x19652b=_0x48bc6d,_0x5a7dfb=document[_0x19652b(0x9a3)](_0x19652b(0x4a1))[_0x19652b(0x7b2)][_0x19652b(0x13f9)](),_0x2018f8=document[_0x19652b(0x9a3)](_0x19652b(0xfee))[_0x19652b(0x7b2)],_0x4af79c=document['getElementById']('nai-test-prompt')[_0x19652b(0x7b2)][_0x19652b(0x13f9)]();if(!_0x5a7dfb){alert('请先配置NovelAI\x20API\x20Key！');return;}if(!_0x4af79c){alert(_0x19652b(0x2ec));return;}const _0x50ffee=_0x520f76(),_0x544233=document[_0x19652b(0x9a3)](_0x19652b(0x233))[_0x19652b(0x7b2)][_0x19652b(0x13f9)](),_0x58e28a=document[_0x19652b(0x9a3)](_0x19652b(0x368)),_0x4a25bc=document[_0x19652b(0x9a3)](_0x19652b(0x118f)),_0x34f313=document[_0x19652b(0x9a3)](_0x19652b(0x13cd)),_0x4bd7c6=document[_0x19652b(0x9a3)](_0x19652b(0xc1a));_0x58e28a[_0x19652b(0x20f)][_0x19652b(0x115d)]='block',_0x4a25bc[_0x19652b(0x20f)]['display']=_0x19652b(0x8e0),_0x34f313[_0x19652b(0x20f)]['display']=_0x19652b(0x8e0),_0x4bd7c6['disabled']=!![],_0x4bd7c6[_0x19652b(0x766)]=_0x19652b(0x6d0);try{const [_0x21b4c4,_0x42fad3]=_0x50ffee[_0x19652b(0xab4)][_0x19652b(0x1536)]('x')[_0x19652b(0xb0a)](Number);let _0x2abf7a;_0x2018f8[_0x19652b(0x478)]('nai-diffusion-4')?_0x2abf7a={'input':_0x4af79c,'model':_0x2018f8,'action':_0x19652b(0xa7d),'parameters':{'params_version':0x3,'width':_0x21b4c4,'height':_0x42fad3,'scale':_0x50ffee['cfg_scale'],'sampler':_0x50ffee['sampler'],'steps':_0x50ffee['steps'],'seed':_0x50ffee['seed']===-0x1?Math['floor'](Math[_0x19652b(0xdcd)]()*0x2540be3ff):_0x50ffee['seed'],'n_samples':0x1,'ucPreset':_0x50ffee['uc_preset'],'qualityToggle':_0x50ffee[_0x19652b(0x14e7)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x19652b(0xff5),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x4af79c,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x544233,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x544233,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x2abf7a={'input':_0x4af79c,'model':_0x2018f8,'action':_0x19652b(0xa7d),'parameters':{'width':_0x21b4c4,'height':_0x42fad3,'scale':_0x50ffee[_0x19652b(0xd7e)],'sampler':_0x50ffee['sampler'],'steps':_0x50ffee['steps'],'seed':_0x50ffee['seed']===-0x1?Math[_0x19652b(0xd95)](Math[_0x19652b(0xdcd)]()*0x2540be3ff):_0x50ffee[_0x19652b(0xaec)],'n_samples':0x1,'ucPreset':_0x50ffee['uc_preset'],'qualityToggle':_0x50ffee[_0x19652b(0x14e7)],'sm':_0x50ffee[_0x19652b(0x1b9)],'sm_dyn':_0x50ffee[_0x19652b(0x14c8)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x19652b(0xce0),'negative_prompt':_0x544233}};console[_0x19652b(0xe4d)](_0x19652b(0xb49)),console[_0x19652b(0xe4d)](_0x19652b(0x37c),_0x2018f8),console[_0x19652b(0xe4d)](_0x19652b(0x1268),JSON[_0x19652b(0xe1e)](_0x2abf7a,null,0x2));let _0x8ca72;_0x2018f8[_0x19652b(0x478)](_0x19652b(0xb29))?_0x8ca72=_0x19652b(0x335):_0x8ca72=_0x19652b(0xc0b);let _0x1a23c3=_0x50ffee[_0x19652b(0x553)];_0x1a23c3===_0x19652b(0xbe4)&&(_0x1a23c3=_0x50ffee[_0x19652b(0x1421)]||'');_0x1a23c3&&_0x1a23c3!==''&&(_0x8ca72=_0x1a23c3+encodeURIComponent(_0x8ca72));const _0x2ffd46=/Chrome/[_0x19652b(0xddf)](navigator[_0x19652b(0x783)])&&!/Edg/[_0x19652b(0xddf)](navigator['userAgent']);let _0x2db05f={'method':_0x19652b(0x12db),'headers':{'Content-Type':_0x19652b(0xb1f),'Authorization':_0x19652b(0x1265)+_0x5a7dfb},'body':JSON['stringify'](_0x2abf7a)};if(_0x2ffd46){console[_0x19652b(0xe4d)]('🔧\x20检测到Chrome浏览器，启用headers兼容性处理');const _0x41b6d8={};for(const [_0x5683ea,_0x2452d0]of Object[_0x19652b(0x10c3)](_0x2db05f['headers'])){_0x41b6d8[_0x5683ea]=_0x2452d0[_0x19652b(0x1bb)](/[^\x00-\xFF]/g,'');}_0x2db05f['headers']=_0x41b6d8;}const _0x56fc2e=await fetch(_0x8ca72,_0x2db05f);console[_0x19652b(0xe4d)](_0x19652b(0x2bf),_0x56fc2e[_0x19652b(0x27d)]),console[_0x19652b(0xe4d)](_0x19652b(0x1466),[..._0x56fc2e[_0x19652b(0x13ee)][_0x19652b(0x10c3)]()]);if(!_0x56fc2e['ok']){const _0x462278=await _0x56fc2e['text']();console[_0x19652b(0x3b7)](_0x19652b(0xf0b),_0x462278);throw new Error('API请求失败\x20('+_0x56fc2e[_0x19652b(0x27d)]+_0x19652b(0x41b)+_0x462278);}const _0x21a1ae=_0x56fc2e[_0x19652b(0x13ee)][_0x19652b(0x14ee)]('content-type');console[_0x19652b(0xe4d)]('Content-Type:',_0x21a1ae);let _0x568372;if(_0x21a1ae&&_0x21a1ae[_0x19652b(0x478)]('text/event-stream')){console[_0x19652b(0xe4d)](_0x19652b(0x13e9)),_0x58e28a['textContent']='正在接收流式数据...';const _0x2cd6c7=await _0x56fc2e[_0x19652b(0x13ca)]();console[_0x19652b(0xe4d)](_0x19652b(0xd17),_0x2cd6c7[_0x19652b(0x106b)]);const _0x5a06f1=_0x2cd6c7[_0x19652b(0x13f9)]()[_0x19652b(0x1536)]('\x0a');let _0x2a59ef=null;for(let _0x2c727a=_0x5a06f1[_0x19652b(0x106b)]-0x1;_0x2c727a>=0x0;_0x2c727a--){const _0x3f7faa=_0x5a06f1[_0x2c727a][_0x19652b(0x13f9)]();if(_0x3f7faa[_0x19652b(0x608)](_0x19652b(0x5ba))&&_0x3f7faa!==_0x19652b(0xa69)){const _0x2407b0=_0x3f7faa[_0x19652b(0x72e)](0x6);try{const _0x3353bb=JSON['parse'](_0x2407b0);if(_0x3353bb[_0x19652b(0x50b)]===_0x19652b(0x1065)&&_0x3353bb[_0x19652b(0x547)]){_0x2a59ef=_0x3353bb[_0x19652b(0x547)],console[_0x19652b(0xe4d)](_0x19652b(0x4df));break;}if(_0x3353bb[_0x19652b(0x38c)]){_0x2a59ef=_0x3353bb[_0x19652b(0x38c)],console[_0x19652b(0xe4d)]('从\x20JSON.data\x20中提取图片数据');break;}if(_0x3353bb[_0x19652b(0x547)]){_0x2a59ef=_0x3353bb['image'],console[_0x19652b(0xe4d)](_0x19652b(0x85b));break;}}catch(_0x13f2d8){_0x2a59ef=_0x2407b0,console[_0x19652b(0xe4d)](_0x19652b(0xfdf));break;}}}if(!_0x2a59ef)throw new Error(_0x19652b(0x1153));const _0x3e33bd=_0x2a59ef['startsWith']('iVBORw0KGgo'),_0x54bfa3=_0x2a59ef[_0x19652b(0x608)]('/9j/');if(_0x3e33bd||_0x54bfa3){console[_0x19652b(0xe4d)](_0x19652b(0xa8c));const _0x21f556=atob(_0x2a59ef),_0x5bb4b3=new Uint8Array(_0x21f556[_0x19652b(0x106b)]);for(let _0x2edd62=0x0;_0x2edd62<_0x21f556['length'];_0x2edd62++){_0x5bb4b3[_0x2edd62]=_0x21f556['charCodeAt'](_0x2edd62);}const _0x512fcd=new Blob([_0x5bb4b3],{'type':_0x3e33bd?_0x19652b(0x15af):'image/jpeg'});console[_0x19652b(0xe4d)]('图片\x20Blob\x20创建成功，大小:',_0x512fcd['size']);const _0x6b71eb=URL[_0x19652b(0xc56)](_0x512fcd);document['getElementById'](_0x19652b(0xf8e))[_0x19652b(0x10d4)]=_0x6b71eb,_0x58e28a['style'][_0x19652b(0x115d)]='none',_0x4a25bc[_0x19652b(0x20f)][_0x19652b(0x115d)]=_0x19652b(0x10c8),console[_0x19652b(0xe4d)](_0x19652b(0x25e));return;}console['log'](_0x19652b(0xb27));const _0x1a7c35=atob(_0x2a59ef),_0x1486f7=new Uint8Array(_0x1a7c35[_0x19652b(0x106b)]);for(let _0x183a29=0x0;_0x183a29<_0x1a7c35[_0x19652b(0x106b)];_0x183a29++){_0x1486f7[_0x183a29]=_0x1a7c35[_0x19652b(0xc75)](_0x183a29);}_0x568372=new Blob([_0x1486f7]),console['log'](_0x19652b(0x104c),_0x568372[_0x19652b(0xbdf)]);}else _0x568372=await _0x56fc2e[_0x19652b(0xf11)](),console['log']('收到数据，类型:',_0x568372[_0x19652b(0x1508)],_0x19652b(0xfa5),_0x568372[_0x19652b(0xbdf)]);try{if(typeof JSZip===_0x19652b(0x738))throw new Error(_0x19652b(0x3a3));_0x58e28a[_0x19652b(0x766)]=_0x19652b(0x48c);const _0x442edb=await JSZip[_0x19652b(0xf9a)](_0x568372);console[_0x19652b(0xe4d)](_0x19652b(0xa87),Object['keys'](_0x442edb[_0x19652b(0x104e)]));let _0x232537=null;for(let _0x572a06 in _0x442edb[_0x19652b(0x104e)]){if(_0x572a06['match'](/\.(png|jpg|jpeg|webp)$/i)){_0x232537=_0x442edb[_0x19652b(0x104e)][_0x572a06],console[_0x19652b(0xe4d)](_0x19652b(0xa0f),_0x572a06);break;}}if(!_0x232537)throw new Error(_0x19652b(0x14cd));const _0x4bf325=await _0x232537['async']('blob');console[_0x19652b(0xe4d)](_0x19652b(0xc44),_0x4bf325[_0x19652b(0xbdf)]);const _0x44d795=URL[_0x19652b(0xc56)](_0x4bf325);console[_0x19652b(0xe4d)](_0x19652b(0x118a),_0x44d795),document[_0x19652b(0x9a3)]('nai-result-image')[_0x19652b(0x10d4)]=_0x44d795,_0x58e28a['style'][_0x19652b(0x115d)]=_0x19652b(0x8e0),_0x4a25bc[_0x19652b(0x20f)][_0x19652b(0x115d)]='block';}catch(_0x4bd7eb){console[_0x19652b(0x3b7)]('ZIP解压失败:',_0x4bd7eb),console[_0x19652b(0xe4d)]('尝试直接作为图片显示...');if(_0x568372[_0x19652b(0x1508)]['startsWith'](_0x19652b(0x481))){const _0x266b9a=URL['createObjectURL'](_0x568372);document['getElementById'](_0x19652b(0xf8e))[_0x19652b(0x10d4)]=_0x266b9a,_0x58e28a[_0x19652b(0x20f)][_0x19652b(0x115d)]=_0x19652b(0x8e0),_0x4a25bc['style'][_0x19652b(0x115d)]=_0x19652b(0x10c8);}else throw new Error('图片格式处理失败:\x20'+_0x4bd7eb[_0x19652b(0xcce)]);}}catch(_0x28db10){console['error'](_0x19652b(0x43e),_0x28db10),_0x58e28a[_0x19652b(0x20f)][_0x19652b(0x115d)]=_0x19652b(0x8e0),_0x34f313['style'][_0x19652b(0x115d)]=_0x19652b(0x10c8),_0x34f313['textContent']=_0x19652b(0x24c)+_0x28db10[_0x19652b(0xcce)];}finally{_0x4bd7c6[_0x19652b(0x15d3)]=![],_0x4bd7c6[_0x19652b(0x766)]=_0x19652b(0x280);}}function _0x1c6d8a(_0x1ef608,_0xbcf4a7){const _0x181b64=_0x48bc6d;_0x5bda2f(),clearTimeout(_0x38cc91);const _0xda1dd2=_0x19ddb8[_0x181b64(0xb04)][_0x1ef608];if(!_0xda1dd2)return;const _0xe56cc2=document[_0x181b64(0x9a3)](_0x181b64(0x1150));document['getElementById'](_0x181b64(0x668))[_0x181b64(0x10d4)]=_0xda1dd2[_0x181b64(0x450)][_0x181b64(0x4fe)]||_0xda1dd2['settings'][_0x181b64(0x20a)]||_0x4f81ff,document[_0x181b64(0x9a3)](_0x181b64(0x4e9))[_0x181b64(0xc86)](_0x181b64(0x1d6))[_0x181b64(0x766)]=_0xda1dd2['name'],document[_0x181b64(0x9a3)](_0x181b64(0x4e9))[_0x181b64(0xc86)](_0x181b64(0xf37))['textContent']=_0xbcf4a7,_0xe56cc2[_0x181b64(0x4d8)][_0x181b64(0x133d)](_0x181b64(0xc09)),void _0xe56cc2[_0x181b64(0xa75)],_0xe56cc2[_0x181b64(0x4d8)][_0x181b64(0xe05)]('visible');const _0x30091e=_0xe56cc2[_0x181b64(0x173)](!![]);_0xe56cc2[_0x181b64(0x5eb)][_0x181b64(0x15ab)](_0x30091e,_0xe56cc2),_0x30091e[_0x181b64(0x954)]('click',()=>{const _0x1da34f=_0x181b64;_0x515d83(_0x1ef608),_0x30091e[_0x1da34f(0x4d8)][_0x1da34f(0x133d)]('visible');}),_0x38cc91=setTimeout(()=>{const _0x596f5f=_0x181b64;_0x30091e[_0x596f5f(0x4d8)][_0x596f5f(0x133d)](_0x596f5f(0xc09));},0xfa0),_0x14e2fe();}function _0x379c9d(){const _0x3d4509=_0x48bc6d,_0x5beef7=new Date(),_0xbd1597=_0x5beef7[_0x3d4509(0x7a2)](_0x3d4509(0x15bc),{'hour':_0x3d4509(0x192),'minute':_0x3d4509(0x192)}),_0x348929=_0x5beef7[_0x3d4509(0x7fd)]('zh-CN',{'weekday':_0x3d4509(0x9f8),'month':_0x3d4509(0x9f8),'day':'numeric'});document[_0x3d4509(0x9a3)]('status-bar-time')[_0x3d4509(0x766)]=_0xbd1597;}function _0x189ab1(_0x259731){const _0x4d3595=_0x48bc6d;if(!_0x259731)return[{'type':_0x4d3595(0x13ca),'content':_0x4d3595(0x517)}];let _0x4ea61e=_0x259731[_0x4d3595(0x13f9)]();const _0x436017=/```json\s*([\s\S]*?)\s*```/,_0x387714=_0x4ea61e[_0x4d3595(0x293)](_0x436017);_0x387714&&_0x387714[0x1]&&(_0x4ea61e=_0x387714[0x1][_0x4d3595(0x13f9)](),console[_0x4d3595(0xe4d)](_0x4d3595(0x2d3)));if(_0x4ea61e[_0x4d3595(0x608)]('[')&&_0x4ea61e[_0x4d3595(0xb5a)](']'))try{const _0x24b9b9=JSON[_0x4d3595(0x1447)](_0x4ea61e);if(Array[_0x4d3595(0xb9b)](_0x24b9b9))return console['log']('解析成功：标准JSON数组格式。'),_0x24b9b9;}catch(_0x254168){console[_0x4d3595(0x651)]('标准JSON数组解析失败，将尝试强力提取...');}const _0x45cc3d=_0x4ea61e[_0x4d3595(0xef5)]('['),_0x124e61=_0x4ea61e[_0x4d3595(0x92e)]('}');if(_0x45cc3d!==-0x1&&_0x124e61!==-0x1&&_0x124e61>_0x45cc3d){const _0x250023=_0x4ea61e[_0x4d3595(0xef5)](']',_0x124e61);if(_0x250023!==-0x1){const _0x42ccff=_0x4ea61e[_0x4d3595(0x72e)](_0x45cc3d,_0x250023+0x1);try{const _0x366083=JSON['parse'](_0x42ccff);if(Array['isArray'](_0x366083))return console[_0x4d3595(0xe4d)]('解析成功：通过强力提取\x20[\x20...\x20}\x20...\x20]\x20模式。'),_0x366083;}catch(_0x342e83){console[_0x4d3595(0x651)](_0x4d3595(0x87c));}}}const _0x1400fb=_0x4ea61e[_0x4d3595(0x293)](/{[^{}]*}/g);if(_0x1400fb){const _0x37187f=[];for(const _0x513c55 of _0x1400fb){try{const _0x35d2e9=JSON['parse'](_0x513c55);_0x37187f[_0x4d3595(0x1c4)](_0x35d2e9);}catch(_0x4c3c0f){console[_0x4d3595(0x651)](_0x4d3595(0xcc7),_0x513c55);}}if(_0x37187f[_0x4d3595(0x106b)]>0x0)return console[_0x4d3595(0xe4d)](_0x4d3595(0xc6c)),_0x37187f;}return console[_0x4d3595(0x3b7)](_0x4d3595(0x264),_0x259731),[{'type':_0x4d3595(0x13ca),'content':_0x259731}];}function _0x7e10b(_0x486fbc=new Date()){const _0x2e6d7c=_0x48bc6d,_0x2abcc9=_0x486fbc[_0x2e6d7c(0x106f)]();if(_0x2abcc9>=0x0&&_0x2abcc9<0x5)return'凌晨';else{if(_0x2abcc9>=0x5&&_0x2abcc9<0x9)return'早上';else{if(_0x2abcc9>=0x9&&_0x2abcc9<0xd)return'上午';else{if(_0x2abcc9>=0xd&&_0x2abcc9<0x12)return'下午';else{if(_0x2abcc9>=0x12&&_0x2abcc9<0x18)return'晚上';}}}}return'现在';}async function _0x52165c(){const _0x2ad380=_0x48bc6d,_0x4a630e=document[_0x2ad380(0x9a3)]('api-preset-select');_0x4a630e['innerHTML']=_0x2ad380(0x773);const _0x5ad3ce=await _0x512070[_0x2ad380(0x83b)]['toArray']();_0x5ad3ce['forEach'](_0x3ebbc5=>{const _0xf4089e=_0x2ad380,_0x54fa84=document[_0xf4089e(0xe94)](_0xf4089e(0x43a));_0x54fa84['value']=_0x3ebbc5['id'],_0x54fa84[_0xf4089e(0x766)]=_0x3ebbc5[_0xf4089e(0x1561)],_0x4a630e[_0xf4089e(0x983)](_0x54fa84);});const _0x3d0ab9=_0x19ddb8[_0x2ad380(0xd22)];let _0x593a7e=null;for(const _0x555ad3 of _0x5ad3ce){if(_0x555ad3[_0x2ad380(0xcb7)]===_0x3d0ab9[_0x2ad380(0xcb7)]&&_0x555ad3['apiKey']===_0x3d0ab9[_0x2ad380(0x14e1)]&&_0x555ad3['model']===_0x3d0ab9[_0x2ad380(0x14a0)]&&_0x555ad3[_0x2ad380(0x132b)]===_0x3d0ab9[_0x2ad380(0x132b)]&&_0x555ad3[_0x2ad380(0x278)]===_0x3d0ab9[_0x2ad380(0x278)]&&_0x555ad3[_0x2ad380(0xa20)]===_0x3d0ab9[_0x2ad380(0xa20)]&&(_0x555ad3[_0x2ad380(0xd41)]||'')===(_0x3d0ab9[_0x2ad380(0xd41)]||'')&&(_0x555ad3[_0x2ad380(0xe2f)]||'')===(_0x3d0ab9[_0x2ad380(0xe2f)]||'')&&(_0x555ad3[_0x2ad380(0x9cf)]||_0x2ad380(0x1013))===(_0x3d0ab9[_0x2ad380(0x9cf)]||'speech-01')){_0x593a7e=_0x555ad3['id'];break;}}_0x593a7e?_0x4a630e['value']=_0x593a7e:_0x4a630e['value']=_0x2ad380(0xd18);}async function _0xa47634(){const _0x2d0c16=_0x48bc6d,_0x424fa9=document[_0x2d0c16(0x9a3)](_0x2d0c16(0xd64)),_0x309a33=parseInt(_0x424fa9[_0x2d0c16(0x7b2)]);if(isNaN(_0x309a33))return;const _0xa8c085=await _0x512070[_0x2d0c16(0x83b)][_0x2d0c16(0x14ee)](_0x309a33);_0xa8c085&&(_0x19ddb8[_0x2d0c16(0xd22)]={'id':_0x2d0c16(0x1173),'proxyUrl':_0xa8c085[_0x2d0c16(0xcb7)],'apiKey':_0xa8c085['apiKey'],'model':_0xa8c085['model'],'secondaryProxyUrl':_0xa8c085[_0x2d0c16(0x132b)],'secondaryApiKey':_0xa8c085['secondaryApiKey'],'secondaryModel':_0xa8c085[_0x2d0c16(0xa20)],'minimaxGroupId':_0xa8c085[_0x2d0c16(0xd41)],'minimaxApiKey':_0xa8c085[_0x2d0c16(0xe2f)],'minimaxModel':_0xa8c085[_0x2d0c16(0x9cf)]},await _0x512070['apiConfig'][_0x2d0c16(0xd4d)](_0x19ddb8['apiConfig']),_0x30d5fd(),document['getElementById'](_0x2d0c16(0xb55))[_0x2d0c16(0x9cc)](),_0xa8c085[_0x2d0c16(0x132b)]&&_0xa8c085['secondaryApiKey']&&document[_0x2d0c16(0x9a3)]('fetch-secondary-models-btn')['click'](),alert(_0x2d0c16(0x3d7)+_0xa8c085[_0x2d0c16(0x1561)]+'”'));}async function _0xe6788(){const _0x37f00a=_0x48bc6d,_0x54b426=await _0x3ab788(_0x37f00a(0xabb),_0x37f00a(0xfe9));if(!_0x54b426||!_0x54b426[_0x37f00a(0x13f9)]())return;const _0x58edcc={'name':_0x54b426[_0x37f00a(0x13f9)](),'proxyUrl':document['getElementById'](_0x37f00a(0x5bb))['value']['trim'](),'apiKey':document[_0x37f00a(0x9a3)](_0x37f00a(0xae1))[_0x37f00a(0x7b2)][_0x37f00a(0x13f9)](),'model':document[_0x37f00a(0x9a3)](_0x37f00a(0x11dd))[_0x37f00a(0x7b2)],'secondaryProxyUrl':document[_0x37f00a(0x9a3)]('secondary-proxy-url')['value'][_0x37f00a(0x13f9)](),'secondaryApiKey':document[_0x37f00a(0x9a3)](_0x37f00a(0x10cb))[_0x37f00a(0x7b2)]['trim'](),'secondaryModel':document[_0x37f00a(0x9a3)](_0x37f00a(0x1413))['value'],'minimaxGroupId':document[_0x37f00a(0x9a3)](_0x37f00a(0x1438))[_0x37f00a(0x7b2)]['trim'](),'minimaxApiKey':document['getElementById']('minimax-api-key')[_0x37f00a(0x7b2)][_0x37f00a(0x13f9)](),'minimaxModel':document['getElementById']('minimax-model-select')['value']},_0xc23bed=await _0x512070[_0x37f00a(0x83b)][_0x37f00a(0x1201)]('name')[_0x37f00a(0x5df)](_0x58edcc[_0x37f00a(0x1561)])['first']();if(_0xc23bed){const _0x11364b=await _0x2c9509(_0x37f00a(0xabc),_0x37f00a(0x4e0)+_0x58edcc['name']+'”\x20的预设已存在。要覆盖它吗？',{'confirmButtonClass':_0x37f00a(0xf5b)});if(!_0x11364b)return;_0x58edcc['id']=_0xc23bed['id'];}await _0x512070[_0x37f00a(0x83b)]['put'](_0x58edcc),await _0x52165c(),alert(_0x37f00a(0xd1b));}async function _0x26440a(){const _0x374e31=_0x48bc6d,_0xfa558d=document[_0x374e31(0x9a3)](_0x374e31(0xd64)),_0x3028c4=parseInt(_0xfa558d[_0x374e31(0x7b2)]);if(isNaN(_0x3028c4)){alert(_0x374e31(0xee6));return;}const _0x1a6f8b=await _0x512070[_0x374e31(0x83b)][_0x374e31(0x14ee)](_0x3028c4);if(!_0x1a6f8b)return;const _0x4104df=await _0x2c9509('删除预设',_0x374e31(0x1481)+_0x1a6f8b['name']+'”\x20吗？',{'confirmButtonClass':_0x374e31(0xf5b)});_0x4104df&&(await _0x512070[_0x374e31(0x83b)][_0x374e31(0x10a8)](_0x3028c4),await _0x52165c(),alert(_0x374e31(0x1061)));}function _0x30d5fd(){const _0x558c80=_0x48bc6d;document['getElementById']('proxy-url')[_0x558c80(0x7b2)]=_0x19ddb8[_0x558c80(0xd22)]['proxyUrl']||'',document[_0x558c80(0x9a3)]('api-key')[_0x558c80(0x7b2)]=_0x19ddb8[_0x558c80(0xd22)][_0x558c80(0x14e1)]||'',document['getElementById'](_0x558c80(0xaa9))['value']=_0x19ddb8[_0x558c80(0xd22)]['secondaryProxyUrl']||'',document[_0x558c80(0x9a3)](_0x558c80(0x10cb))['value']=_0x19ddb8[_0x558c80(0xd22)][_0x558c80(0x278)]||'',document[_0x558c80(0x9a3)](_0x558c80(0x3d2))[_0x558c80(0x944)]=_0x19ddb8['globalSettings']['enableBackgroundActivity']||![],document['getElementById'](_0x558c80(0x9be))[_0x558c80(0x7b2)]=_0x19ddb8['globalSettings'][_0x558c80(0x11ec)]||0x3c,document[_0x558c80(0x9a3)](_0x558c80(0x349))[_0x558c80(0x7b2)]=_0x19ddb8[_0x558c80(0x4c8)]['blockCooldownHours']||0x1,document['getElementById'](_0x558c80(0x1133))['checked']=_0x19ddb8[_0x558c80(0x4c8)][_0x558c80(0x853)],document[_0x558c80(0x9a3)](_0x558c80(0x111e))[_0x558c80(0x7b2)]=_0x19ddb8[_0x558c80(0x4c8)]['chatRenderWindow']||0x32,document[_0x558c80(0x9a3)](_0x558c80(0x1425))['value']=_0x19ddb8[_0x558c80(0x4c8)]['chatListRenderWindow']||0x1e;const _0x264e69=document[_0x558c80(0x9a3)](_0x558c80(0x143c)),_0x7c9636=document[_0x558c80(0x9a3)](_0x558c80(0x2ce)),_0x2fd272=_0x19ddb8['globalSettings'][_0x558c80(0x4a2)]||0.8;_0x264e69[_0x558c80(0x7b2)]=_0x2fd272,_0x7c9636[_0x558c80(0x766)]=_0x2fd272,document[_0x558c80(0x9a3)](_0x558c80(0x1438))[_0x558c80(0x7b2)]=_0x19ddb8[_0x558c80(0xd22)]['minimaxGroupId']||'',document[_0x558c80(0x9a3)]('minimax-api-key')[_0x558c80(0x7b2)]=_0x19ddb8[_0x558c80(0xd22)][_0x558c80(0xe2f)]||'',document[_0x558c80(0x9a3)](_0x558c80(0xf7d))[_0x558c80(0x7b2)]=_0x19ddb8[_0x558c80(0xd22)][_0x558c80(0x9cf)]||_0x558c80(0x1013);const _0x36bc09=localStorage[_0x558c80(0x5de)](_0x558c80(0x95b))===_0x558c80(0x903),_0x12a0b0=localStorage[_0x558c80(0x5de)](_0x558c80(0xfee))||'nai-diffusion-4-5-full',_0x5f2b0f=localStorage[_0x558c80(0x5de)](_0x558c80(0x4a1))||'';document['getElementById'](_0x558c80(0x969))[_0x558c80(0x944)]=_0x36bc09,document[_0x558c80(0x9a3)](_0x558c80(0xfee))[_0x558c80(0x7b2)]=_0x12a0b0,document[_0x558c80(0x9a3)](_0x558c80(0x4a1))['value']=_0x5f2b0f,document['getElementById'](_0x558c80(0x1543))['style'][_0x558c80(0x115d)]=_0x36bc09?_0x558c80(0x10c8):_0x558c80(0x8e0),_0x52165c(),_0x4c738e();}window[_0x48bc6d(0x99b)]=_0x30d5fd;async function _0x55c16f(){const _0x824d4b=_0x48bc6d,_0x1da9ce=document[_0x824d4b(0x9a3)](_0x824d4b(0x13ec));_0x1da9ce[_0x824d4b(0xeb2)]='';const _0x1ab170=await _0x512070[_0x824d4b(0x5b7)][_0x824d4b(0x591)]();if(_0x1ab170['length']===0x0){_0x1da9ce[_0x824d4b(0xeb2)]=_0x824d4b(0x321);return;}_0x1ab170[_0x824d4b(0x15c1)](_0x585a0b=>{const _0x342f80=_0x824d4b,_0x367050=document[_0x342f80(0xe94)](_0x342f80(0x8ca));_0x367050['className']='chat-list-item',_0x367050[_0x342f80(0xd8d)][_0x342f80(0x11f8)]=_0x585a0b['id'],_0x367050['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x585a0b[_0x342f80(0xf3f)]||_0x451ae9)+_0x342f80(0xfaa)+_0x585a0b['name']+_0x342f80(0x151d)+_0x585a0b[_0x342f80(0xcd4)]['substring'](0x0,0x1e)+'...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x367050[_0x342f80(0x954)]('click',()=>_0x21c6bf(_0x585a0b['id'])),_0x1a651b(_0x367050,async()=>{await _0x1b5b57(_0x585a0b['id']);}),_0x1da9ce[_0x342f80(0x983)](_0x367050);});}async function _0x21c6bf(_0x8b9a03=null){const _0x30f08a=_0x48bc6d;editingNpcId=_0x8b9a03;const _0x2a8e04=document['getElementById'](_0x30f08a(0x565)),_0x2ee301=document[_0x30f08a(0x9a3)](_0x30f08a(0x69d)),_0x4bbdc8=document[_0x30f08a(0x9a3)](_0x30f08a(0x518)),_0x352190=document['getElementById'](_0x30f08a(0x10ea)),_0x10f2d6=document[_0x30f08a(0x9a3)]('npc-avatar-preview'),_0x5b83e2=document['getElementById']('npc-association-list'),_0x391e03=document[_0x30f08a(0x9a3)](_0x30f08a(0x1293)),_0xd275c4=document['getElementById'](_0x30f08a(0x65f)),_0x22b7f5=document[_0x30f08a(0x9a3)](_0x30f08a(0x1590));_0x5b83e2['innerHTML']='',_0x391e03[_0x30f08a(0xeb2)]='<option\x20value=\x22\x22>--\x20未分组\x20--</option>';const _0x14e24f=await _0x512070[_0x30f08a(0x745)]['toArray']();_0x14e24f['forEach'](_0x1eae00=>{const _0xcb7212=_0x30f08a,_0xee77f5=document['createElement'](_0xcb7212(0x43a));_0xee77f5[_0xcb7212(0x7b2)]=_0x1eae00['id'],_0xee77f5[_0xcb7212(0x766)]=_0x1eae00[_0xcb7212(0x1561)],_0x391e03[_0xcb7212(0x983)](_0xee77f5);}),_0x5b83e2[_0x30f08a(0xeb2)]+=_0x30f08a(0x147c)+(_0x19ddb8[_0x30f08a(0x9ce)]['nickname']||'我')+'\x20(用户)</label>',Object[_0x30f08a(0xea1)](_0x19ddb8['chats'])[_0x30f08a(0x1195)](_0x4d0be5=>!_0x4d0be5[_0x30f08a(0x136b)])[_0x30f08a(0x15c1)](_0x48525b=>{const _0x3fc358=_0x30f08a;_0x5b83e2[_0x3fc358(0xeb2)]+=_0x3fc358(0x3f6)+_0x48525b['id']+_0x3fc358(0x1349)+_0x48525b[_0x3fc358(0x1561)]+_0x3fc358(0x141f);});if(_0x8b9a03){_0x2ee301[_0x30f08a(0x766)]='编辑\x20NPC';const _0xfe454e=await _0x512070['npcs'][_0x30f08a(0x14ee)](_0x8b9a03);_0xfe454e&&(_0x4bbdc8['value']=_0xfe454e['name'],_0x352190['value']=_0xfe454e[_0x30f08a(0xcd4)],_0x10f2d6[_0x30f08a(0x10d4)]=_0xfe454e[_0x30f08a(0xf3f)]||_0x451ae9,_0xd275c4[_0x30f08a(0x944)]=_0xfe454e[_0x30f08a(0x106e)]!==![],_0x22b7f5[_0x30f08a(0x7b2)]=_0xfe454e['actionCooldownMinutes']||0xf,_0x391e03['value']=_0xfe454e[_0x30f08a(0x1005)]||'',_0xfe454e['associatedWith']&&Array['isArray'](_0xfe454e[_0x30f08a(0xa3a)])&&_0xfe454e['associatedWith'][_0x30f08a(0x15c1)](_0x377b00=>{const _0x1f8d74=_0x30f08a,_0x532866=_0x5b83e2[_0x1f8d74(0xc86)](_0x1f8d74(0x6f1)+_0x377b00+'\x22]');if(_0x532866)_0x532866['checked']=!![];}));}else{_0x2ee301['textContent']='添加\x20NPC',_0x4bbdc8['value']='',_0x352190[_0x30f08a(0x7b2)]='',_0x10f2d6['src']=_0x451ae9,_0xd275c4[_0x30f08a(0x944)]=!![],_0x22b7f5[_0x30f08a(0x7b2)]=0xf,_0x391e03[_0x30f08a(0x7b2)]='';const _0x534f02=_0x5b83e2[_0x30f08a(0xc86)](_0x30f08a(0x1be));if(_0x534f02)_0x534f02['checked']=!![];}_0x2a8e04[_0x30f08a(0x4d8)][_0x30f08a(0xe05)](_0x30f08a(0xc09));}async function _0x26193e(){const _0xf13350=_0x48bc6d,_0x264a99=document[_0xf13350(0x9a3)](_0xf13350(0x518))['value']['trim'](),_0x11c797=document[_0xf13350(0x9a3)]('npc-persona-input')['value']['trim']();if(!_0x264a99||!_0x11c797){alert(_0xf13350(0x3cf));return;}const _0x432755=Array[_0xf13350(0x1311)](document[_0xf13350(0x131c)]('#npc-association-list\x20input:checked'))['map'](_0x5bdced=>_0x5bdced[_0xf13350(0x7b2)]),_0x16f1f8=document[_0xf13350(0x9a3)](_0xf13350(0x65f))['checked'],_0x3d085c=parseInt(document[_0xf13350(0x9a3)](_0xf13350(0x1590))[_0xf13350(0x7b2)])||0xf,_0x3cf50e=parseInt(document['getElementById'](_0xf13350(0x1293))[_0xf13350(0x7b2)])||null,_0x260f84={'name':_0x264a99,'persona':_0x11c797,'avatar':document[_0xf13350(0x9a3)]('npc-avatar-preview')['src'],'associatedWith':_0x432755,'enableBackgroundActivity':_0x16f1f8,'actionCooldownMinutes':_0x3d085c,'npcGroupId':_0x3cf50e};if(editingNpcId)await _0x512070[_0xf13350(0x5b7)][_0xf13350(0xe33)](editingNpcId,_0x260f84);else{const _0x562beb=await _0x512070['npcs'][_0xf13350(0xe05)](_0x260f84);if(_0x53547f&&_0x19ddb8[_0xf13350(0x859)]){const _0x565d48=_0x19ddb8['chats'][_0x19ddb8[_0xf13350(0x859)]];_0x565d48[_0xf13350(0x136b)]&&(_0x565d48[_0xf13350(0xcca)][_0xf13350(0x1c4)]({'id':'npc_'+_0x562beb,'originalName':_0x264a99,'groupNickname':_0x264a99,'persona':_0x11c797,'avatar':_0x260f84[_0xf13350(0xf3f)],'isNpc':!![]}),await _0x512070[_0xf13350(0xb04)][_0xf13350(0xd4d)](_0x565d48));}}document['getElementById']('npc-editor-modal')['classList'][_0xf13350(0x133d)](_0xf13350(0xc09)),_0x53547f?(_0x53547f=![],_0x2723dc()):await _0x55c16f();}async function _0x4d5df7(){const _0x1c54a6=_0x48bc6d;await _0x23f636(),document[_0x1c54a6(0x9a3)](_0x1c54a6(0x7f7))['classList']['add'](_0x1c54a6(0xc09));}async function _0x23f636(){const _0x552362=_0x48bc6d,_0x1465a0=document[_0x552362(0x9a3)](_0x552362(0x1455)),_0x17fae2=await _0x512070[_0x552362(0x745)][_0x552362(0x591)]();_0x1465a0[_0x552362(0xeb2)]='',_0x17fae2[_0x552362(0x106b)]===0x0&&(_0x1465a0['innerHTML']=_0x552362(0x7b3)),_0x17fae2[_0x552362(0x15c1)](_0x4f1c96=>{const _0x4ef8e5=_0x552362,_0x56e5f2=document[_0x4ef8e5(0xe94)](_0x4ef8e5(0x8ca));_0x56e5f2[_0x4ef8e5(0x1487)]=_0x4ef8e5(0x3bb),_0x56e5f2[_0x4ef8e5(0xeb2)]=_0x4ef8e5(0xa17)+_0x4f1c96['name']+_0x4ef8e5(0xeb9)+_0x4f1c96['id']+_0x4ef8e5(0x985),_0x1465a0[_0x4ef8e5(0x983)](_0x56e5f2);});}async function _0xbff085(){const _0x7cbc8d=_0x48bc6d,_0x274484=document[_0x7cbc8d(0x9a3)](_0x7cbc8d(0xb2d)),_0x55f6f7=_0x274484['value'][_0x7cbc8d(0x13f9)]();if(!_0x55f6f7){alert(_0x7cbc8d(0x7ac));return;}const _0x3b4c00=await _0x512070[_0x7cbc8d(0x745)][_0x7cbc8d(0x1201)](_0x7cbc8d(0x1561))[_0x7cbc8d(0x5df)](_0x55f6f7)[_0x7cbc8d(0x92c)]();if(_0x3b4c00){alert('分组\x20\x22'+_0x55f6f7+_0x7cbc8d(0x60a));return;}await _0x512070[_0x7cbc8d(0x745)][_0x7cbc8d(0xe05)]({'name':_0x55f6f7}),_0x274484[_0x7cbc8d(0x7b2)]='',await _0x23f636();}async function _0x54e092(_0x1ede8f){const _0x49ee77=_0x48bc6d,_0x31eb20=await _0x2c9509(_0x49ee77(0xd05),_0x49ee77(0x76e),{'confirmButtonClass':_0x49ee77(0xf5b)});_0x31eb20&&(await _0x512070[_0x49ee77(0x745)][_0x49ee77(0x10a8)](_0x1ede8f),await _0x512070[_0x49ee77(0x5b7)][_0x49ee77(0x1201)](_0x49ee77(0x1005))[_0x49ee77(0x5df)](_0x1ede8f)[_0x49ee77(0x572)]({'npcGroupId':null}),await _0x23f636());}async function _0x1b5b57(_0x5b9999){const _0x33f8f8=_0x48bc6d,_0x1dc944=await _0x512070[_0x33f8f8(0x5b7)][_0x33f8f8(0x14ee)](_0x5b9999);if(!_0x1dc944)return;const _0x985f23=await _0x2c9509(_0x33f8f8(0x913),_0x33f8f8(0x2b3)+_0x1dc944[_0x33f8f8(0x1561)]+_0x33f8f8(0x7a0),{'confirmButtonClass':_0x33f8f8(0xf5b)});_0x985f23&&(await _0x512070[_0x33f8f8(0x5b7)][_0x33f8f8(0x10a8)](_0x5b9999),await _0x55c16f());}let _0x3f70a1=0x0;function _0x581c1f(_0x3bbfb6){const _0x37a65a=_0x48bc6d,_0x3bff4a=document['createElement'](_0x37a65a(0x8ca));return _0x3bff4a[_0x37a65a(0x1487)]=_0x37a65a(0x82a),_0x3bff4a['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x3bbfb6[_0x37a65a(0x1561)]+_0x37a65a(0x41a),_0x3bff4a;}function _0x380baf(_0x4e3ec){const _0x5f59fd=_0x48bc6d,_0x3baa29=document[_0x5f59fd(0x9a3)](_0x5f59fd(0xba0)),_0x200573=document[_0x5f59fd(0x9a3)]('load-more-chats-btn');if(_0x200573)_0x200573[_0x5f59fd(0x133d)]();const _0x154d4a=_0x3f70a1,_0x189111=_0x3f70a1+CHAT_LIST_RENDER_WINDOW,_0x45c133=_0x4e3ec[_0x5f59fd(0x457)](_0x154d4a,_0x189111),_0x5021f3=document[_0x5f59fd(0xa4d)]();let _0x214282=_0x3baa29[_0x5f59fd(0xc86)](_0x5f59fd(0x1303));_0x45c133[_0x5f59fd(0x15c1)](_0x875052=>{const _0x56fb36=_0x5f59fd;if(_0x875052['type']===_0x56fb36(0x8d0)){const _0x3da138=_0x581c1f(_0x875052[_0x56fb36(0xf67)]);_0x5021f3[_0x56fb36(0x983)](_0x3da138),_0x214282=_0x3da138[_0x56fb36(0xc86)]('.chat-group-content');}else{if(_0x875052[_0x56fb36(0x1508)]===_0x56fb36(0xee2)){const _0x376ac6=_0x3007da(_0x875052[_0x56fb36(0xd43)]);_0x214282&&_0x875052[_0x56fb36(0xd43)][_0x56fb36(0x4ab)]?_0x214282['appendChild'](_0x376ac6):(_0x5021f3[_0x56fb36(0x983)](_0x376ac6),_0x214282=null);}}}),_0x3baa29[_0x5f59fd(0x983)](_0x5021f3),_0x3f70a1+=_0x45c133[_0x5f59fd(0x106b)],_0x4e3ec[_0x5f59fd(0x106b)]>_0x3f70a1&&_0x5c9065(_0x3baa29,_0x4e3ec),document[_0x5f59fd(0x131c)](_0x5f59fd(0xb2b))[_0x5f59fd(0x15c1)](_0x4baaa3=>{const _0x1933fa=_0x5f59fd,_0x4b0193=_0x4baaa3[_0x1933fa(0x173)](!![]);_0x4baaa3[_0x1933fa(0x5eb)]['replaceChild'](_0x4b0193,_0x4baaa3),_0x4b0193['addEventListener']('click',()=>{const _0x15151e=_0x1933fa;_0x4b0193['classList'][_0x15151e(0xc02)](_0x15151e(0x95e)),_0x4b0193[_0x15151e(0x5a4)][_0x15151e(0x4d8)][_0x15151e(0xc02)](_0x15151e(0x95e));});});}async function _0xec8072(){const _0x30ca47=_0x48bc6d,_0x2752e2=document[_0x30ca47(0x9a3)](_0x30ca47(0xba0));_0x2752e2[_0x30ca47(0xeb2)]='';const _0x2539b5=Object['values'](_0x19ddb8[_0x30ca47(0xb04)])['sort']((_0x7d43af,_0x2fc199)=>{const _0x38ae72=_0x30ca47,_0x525619=(_0x2fc199[_0x38ae72(0x14d8)]||![])-(_0x7d43af[_0x38ae72(0x14d8)]||![]);if(_0x525619!==0x0)return _0x525619;return(_0x2fc199[_0x38ae72(0x1f0)][_0x38ae72(0x457)](-0x1)[0x0]?.['timestamp']||0x0)-(_0x7d43af[_0x38ae72(0x1f0)][_0x38ae72(0x457)](-0x1)[0x0]?.[_0x38ae72(0xd73)]||0x0);}),_0x3b95f9=await _0x512070[_0x30ca47(0xad9)][_0x30ca47(0x591)]();if(_0x2539b5[_0x30ca47(0x106b)]===0x0){_0x2752e2[_0x30ca47(0xeb2)]=_0x30ca47(0x45c);return;}_0x3b95f9[_0x30ca47(0x15c1)](_0x321c48=>{const _0xcbabd0=_0x30ca47,_0x5e1da0=_0x2539b5[_0xcbabd0(0xd62)](_0x2d0450=>_0x2d0450[_0xcbabd0(0x4ab)]===_0x321c48['id']);_0x321c48[_0xcbabd0(0x1a4)]=_0x5e1da0?_0x5e1da0[_0xcbabd0(0x1f0)][_0xcbabd0(0x457)](-0x1)[0x0]?.[_0xcbabd0(0xd73)]||0x0:0x0;}),_0x3b95f9[_0x30ca47(0x6a2)]((_0x40a44f,_0x1027d7)=>_0x1027d7[_0x30ca47(0x1a4)]-_0x40a44f[_0x30ca47(0x1a4)]),_0x3285cd=[];const _0x37e70c=new Set();_0x2539b5[_0x30ca47(0x15c1)](_0x3b04fa=>{const _0x57300=_0x30ca47;_0x3b04fa[_0x57300(0x14d8)]&&(_0x3285cd[_0x57300(0x1c4)]({'type':_0x57300(0xee2),'chat':_0x3b04fa}),_0x37e70c[_0x57300(0xe05)](_0x3b04fa['id']));}),_0x3b95f9[_0x30ca47(0x15c1)](_0x10339c=>{const _0x29ae6d=_0x30ca47,_0x1a3646=_0x2539b5[_0x29ae6d(0x1195)](_0x1b40ac=>!_0x1b40ac[_0x29ae6d(0x14d8)]&&!_0x1b40ac[_0x29ae6d(0x136b)]&&_0x1b40ac[_0x29ae6d(0x4ab)]===_0x10339c['id']);_0x1a3646[_0x29ae6d(0x106b)]>0x0&&(_0x3285cd[_0x29ae6d(0x1c4)]({'type':_0x29ae6d(0x8d0),'group':_0x10339c}),_0x1a3646['forEach'](_0x244784=>{const _0x27318e=_0x29ae6d;_0x3285cd[_0x27318e(0x1c4)]({'type':_0x27318e(0xee2),'chat':_0x244784}),_0x37e70c[_0x27318e(0xe05)](_0x244784['id']);}));}),_0x2539b5[_0x30ca47(0x15c1)](_0x299b13=>{const _0x4585bc=_0x30ca47;!_0x37e70c[_0x4585bc(0x1472)](_0x299b13['id'])&&(_0x3285cd['push']({'type':_0x4585bc(0xee2),'chat':_0x299b13}),_0x37e70c[_0x4585bc(0xe05)](_0x299b13['id']));}),_0x3f70a1=0x0,_0x380baf();}function _0x581c1f(_0x457683){const _0x27e818=_0x48bc6d,_0x43f559=document[_0x27e818(0xe94)](_0x27e818(0x8ca));return _0x43f559[_0x27e818(0x1487)]='chat-group-container',_0x43f559['innerHTML']=_0x27e818(0x116d)+_0x457683['name']+_0x27e818(0x2a3),_0x43f559;}function _0x5c9065(_0x442068,_0x10812e){const _0x6de53a=_0x48bc6d,_0x189268=document['createElement'](_0x6de53a(0xd38));_0x189268['id']='load-more-chats-btn',_0x189268['textContent']=_0x6de53a(0x3e4),_0x189268[_0x6de53a(0x1487)]=_0x6de53a(0x14a3),_0x189268[_0x6de53a(0x954)](_0x6de53a(0x9cc),()=>_0x380baf(_0x10812e),{'once':!![]}),_0x442068['prepend'](_0x189268);}function _0x380baf(){const _0x3c1a2c=_0x48bc6d;if(_0x5b6e4b)return;const _0x15fb3f=document[_0x3c1a2c(0x9a3)](_0x3c1a2c(0xba0)),_0x1f9b66=document[_0x3c1a2c(0x9a3)](_0x3c1a2c(0xdd5));if(!_0x15fb3f||!_0x1f9b66)return;if(_0x3f70a1>=_0x3285cd[_0x3c1a2c(0x106b)])return;_0x5b6e4b=!![];const _0x4dc8dd=_0x3f70a1===0x0,_0x36dc24=()=>{const _0x3e85b4=_0x3c1a2c;_0x38511a(_0x15fb3f);const _0x4f2d96=_0x19ddb8[_0x3e85b4(0x4c8)][_0x3e85b4(0x710)]||0x1e,_0x1122d5=_0x3f70a1,_0x5e2f37=_0x3f70a1+_0x4f2d96,_0xf572f3=_0x3285cd[_0x3e85b4(0x457)](_0x1122d5,_0x5e2f37),_0x142379=document[_0x3e85b4(0xa4d)]();let _0x5d1501=_0x15fb3f[_0x3e85b4(0xc86)]('.chat-group-content:last-of-type');_0xf572f3[_0x3e85b4(0x15c1)](_0x286e35=>{const _0x581a0b=_0x3e85b4;if(_0x286e35[_0x581a0b(0x1508)]===_0x581a0b(0x8d0)){const _0x82feb3=_0x581c1f(_0x286e35['group']);_0x142379['appendChild'](_0x82feb3),_0x5d1501=_0x82feb3['querySelector'](_0x581a0b(0x1b7));}else{if(_0x286e35[_0x581a0b(0x1508)]===_0x581a0b(0xee2)){const _0x25e7a2=_0x3007da(_0x286e35[_0x581a0b(0xd43)]);if(_0x286e35[_0x581a0b(0xd43)][_0x581a0b(0x4ab)]&&_0x5d1501)_0x5d1501[_0x581a0b(0x983)](_0x25e7a2);else{_0x142379[_0x581a0b(0x983)](_0x25e7a2);if(!_0x286e35['chat'][_0x581a0b(0x4ab)])_0x5d1501=null;}}}}),_0x15fb3f['appendChild'](_0x142379),_0x3f70a1+=_0xf572f3[_0x3e85b4(0x106b)],_0x15fb3f[_0x3e85b4(0x131c)](_0x3e85b4(0xb25))['forEach'](_0x508b00=>{const _0x4ac661=_0x3e85b4;_0x508b00['dataset']['hasListener']='true',_0x508b00[_0x4ac661(0x954)]('click',()=>{const _0xa4d3a1=_0x4ac661;_0x508b00[_0xa4d3a1(0x4d8)][_0xa4d3a1(0xc02)](_0xa4d3a1(0x95e)),_0x508b00[_0xa4d3a1(0x5a4)][_0xa4d3a1(0x4d8)]['toggle'](_0xa4d3a1(0x95e));});}),_0x5b6e4b=![],_0x1f9b66[_0x3e85b4(0x13b7)]<=_0x1f9b66['clientHeight']&&_0x3f70a1<_0x3285cd[_0x3e85b4(0x106b)]&&_0x380baf();};_0x4dc8dd?_0x36dc24():(_0x3335f4(_0x15fb3f,_0x3c1a2c(0x837)),setTimeout(_0x36dc24,0x1f4));}function _0x3007da(_0x495408){const _0x803e9c=_0x48bc6d;try{const _0x30f7bf=_0x495408['history'][_0x803e9c(0x1195)](_0x2455cf=>!_0x2455cf['isHidden'])['slice'](-0x1)[0x0]||{};let _0x523b3b;if(!_0x495408[_0x803e9c(0x136b)]&&_0x495408[_0x803e9c(0x239)]?.[_0x803e9c(0x27d)]===_0x803e9c(0x8ab))_0x523b3b=_0x803e9c(0x9e5)+(_0x495408[_0x803e9c(0x239)][_0x803e9c(0x351)]||_0x803e9c(0x6ef))+_0x803e9c(0xeb1);else{if(!_0x495408[_0x803e9c(0x136b)]&&_0x495408[_0x803e9c(0x239)]?.[_0x803e9c(0x27d)]===_0x803e9c(0xf34))_0x523b3b=_0x803e9c(0xc4c);else{if(_0x495408[_0x803e9c(0x136b)]){if(_0x30f7bf[_0x803e9c(0x1508)]===_0x803e9c(0x1082))_0x523b3b=_0x803e9c(0x577)+_0x30f7bf[_0x803e9c(0x4e3)];else{if(_0x30f7bf[_0x803e9c(0x1508)]==='transfer')_0x523b3b=_0x803e9c(0x2f3);else{if(_0x30f7bf[_0x803e9c(0x1508)]===_0x803e9c(0x1c1)||_0x30f7bf[_0x803e9c(0x1508)]===_0x803e9c(0x9ee))_0x523b3b=_0x803e9c(0xdf5);else{if(_0x30f7bf['type']===_0x803e9c(0x1207))_0x523b3b='[语音]';else{if(typeof _0x30f7bf[_0x803e9c(0x4e3)]===_0x803e9c(0x86c)&&_0x115b0e['test'](_0x30f7bf[_0x803e9c(0x4e3)]))_0x523b3b=_0x30f7bf['meaning']?'[表情:\x20'+_0x30f7bf[_0x803e9c(0x7da)]+']':_0x803e9c(0xbd5);else Array['isArray'](_0x30f7bf[_0x803e9c(0x4e3)])?_0x523b3b=_0x803e9c(0xed3):_0x523b3b=String(_0x30f7bf[_0x803e9c(0x4e3)]||_0x803e9c(0x4a5))[_0x803e9c(0x72e)](0x0,0x14);}}}}if(_0x30f7bf[_0x803e9c(0x1043)]&&_0x30f7bf[_0x803e9c(0x1508)]!==_0x803e9c(0x1082)){const _0x4c5337=_0x1e2056(_0x495408,_0x30f7bf[_0x803e9c(0x1043)]);_0x523b3b=_0x4c5337+':\x20'+_0x523b3b;}}else{const _0x47ac8a=_0x495408[_0x803e9c(0x27d)]?.[_0x803e9c(0x13ca)]||'在线';_0x523b3b='['+_0x47ac8a+']';}}}const _0x52c6d4=document[_0x803e9c(0xe94)]('div');_0x52c6d4[_0x803e9c(0x1487)]=_0x803e9c(0xba4),_0x52c6d4['dataset'][_0x803e9c(0x907)]=_0x495408['id'];_0x495408[_0x803e9c(0x14d8)]&&_0x52c6d4['classList'][_0x803e9c(0xe05)](_0x803e9c(0xbcb));const _0x4c2227=_0x495408[_0x803e9c(0x136b)]?_0x495408[_0x803e9c(0x450)][_0x803e9c(0x20a)]:_0x495408[_0x803e9c(0x450)]['aiAvatar'],_0x21aad9=_0x495408['isGroup']?'':_0x495408[_0x803e9c(0x450)][_0x803e9c(0xdc8)]||'';let _0x191a8d;_0x21aad9?_0x191a8d='<div\x20class=\x22avatar-with-frame\x22><img\x20src=\x22'+(_0x4c2227||_0x4f81ff)+'\x22\x20class=\x22avatar-img\x22><img\x20src=\x22'+_0x21aad9+_0x803e9c(0x145b):_0x191a8d=_0x803e9c(0x887)+(_0x4c2227||_0x4f81ff)+'\x22\x20class=\x22avatar\x22>';const _0x3777ff=_0x21aad9?_0x803e9c(0x125a):'',_0xc5d340=_0x803e9c(0x681)+_0x3777ff+'\x22>'+_0x191a8d+_0x803e9c(0x826);_0x52c6d4[_0x803e9c(0xeb2)]=_0x803e9c(0x5e0)+_0xc5d340+_0x803e9c(0x5f6)+_0x495408[_0x803e9c(0x1561)]+_0x803e9c(0x6f0)+(_0x495408[_0x803e9c(0x136b)]?_0x803e9c(0xb47):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22\x20style=\x22color:\x20'+(_0x495408['isGroup']?_0x803e9c(0x11a6):_0x803e9c(0xa54))+';\x20font-style:\x20italic;\x22>'+_0x523b3b+_0x803e9c(0xef9);const _0x50df90=_0x495408[_0x803e9c(0xe20)]||0x0,_0x2ac208=_0x52c6d4['querySelector'](_0x803e9c(0x7ea));_0x50df90>0x0?(_0x2ac208[_0x803e9c(0x766)]=_0x50df90>0x63?_0x803e9c(0x809):_0x50df90,_0x2ac208[_0x803e9c(0x20f)][_0x803e9c(0x115d)]=_0x803e9c(0x1eb)):_0x2ac208[_0x803e9c(0x20f)][_0x803e9c(0x115d)]='none';const _0x50ea8f=_0x52c6d4[_0x803e9c(0xc86)](_0x803e9c(0x6da));_0x50ea8f&&(_0x50ea8f['style'][_0x803e9c(0x1539)]=_0x803e9c(0xc36),_0x50ea8f[_0x803e9c(0x954)](_0x803e9c(0x23a),_0x270826=>{const _0x4463d5=_0x803e9c;_0x270826[_0x4463d5(0x63a)]();const _0x1661da=_0x495408[_0x4463d5(0x136b)]?_0x495408[_0x4463d5(0x1561)]:_0x495408[_0x4463d5(0x339)];_0x2462b3(_0x495408['id'],_0x1661da);}));const _0x2a9b01=_0x52c6d4[_0x803e9c(0xc86)](_0x803e9c(0x210));return _0x2a9b01&&_0x2a9b01['addEventListener']('click',()=>_0x515d83(_0x495408['id'])),_0x1a651b(_0x52c6d4,async _0x2aec50=>{const _0x8c70e6=_0x803e9c,_0x51230b=await _0x33ea90(_0x495408);switch(_0x51230b){case _0x8c70e6(0xe0a):_0x495408[_0x8c70e6(0x14d8)]=!_0x495408[_0x8c70e6(0x14d8)],await _0x512070[_0x8c70e6(0xb04)][_0x8c70e6(0xd4d)](_0x495408),_0xec8072();break;case _0x8c70e6(0x10a8):const _0x3ff4fd=await _0x2c9509(_0x8c70e6(0x9ef),'确定要删除与\x20\x22'+_0x495408[_0x8c70e6(0x1561)]+_0x8c70e6(0x4eb),{'confirmButtonClass':_0x8c70e6(0xf5b)});if(_0x3ff4fd){_0x4e0631[_0x8c70e6(0x1412)]&&_0x4e0631['activeChatId']===_0x495408['id']&&await _0x58ff6d(![]);delete _0x19ddb8[_0x8c70e6(0xb04)][_0x495408['id']];if(_0x19ddb8['activeChatId']===_0x495408['id'])_0x19ddb8['activeChatId']=null;await _0x512070[_0x8c70e6(0xb04)][_0x8c70e6(0x10a8)](_0x495408['id']),_0xec8072();}break;default:break;}}),_0x52c6d4;}catch(_0x1c170b){return console[_0x803e9c(0x3b7)]('渲染聊天项\x20['+(_0x495408[_0x803e9c(0x1561)]||'未知')+_0x803e9c(0x5aa)+_0x495408['id']+_0x803e9c(0xaa5),_0x1c170b),null;}}async function _0x56abd7(_0x39a9cc){const _0x154302=_0x48bc6d;_0x44b5e7(),_0x10b9c4();const _0x32f53a=_0x19ddb8['chats'][_0x39a9cc];if(!_0x32f53a)return;_0x501f17();const _0x32ba7a=document[_0x154302(0x9a3)](_0x154302(0x10f8)),_0x575404=document['getElementById'](_0x154302(0xde9)),_0x58f7c5=document[_0x154302(0x9a3)]('chat-lock-overlay'),_0x5b7df8=document['getElementById'](_0x154302(0x1288));_0x32ba7a['dataset'][_0x154302(0x910)]=_0x32f53a[_0x154302(0x450)][_0x154302(0x910)]||_0x154302(0xd5f);const _0x443d80=_0x32f53a[_0x154302(0x450)][_0x154302(0xdea)]||0xd;_0x32ba7a[_0x154302(0x20f)][_0x154302(0x11b9)](_0x154302(0xcee),_0x443d80+'px'),_0x1253e3(_0x32f53a[_0x154302(0x450)][_0x154302(0xc8b)]||'',_0x154302(0x8bf),_0x154302(0xdcb)),document['getElementById']('chat-header-title')['textContent']=_0x32f53a[_0x154302(0x1561)];const _0x45f874=document[_0x154302(0x9a3)]('chat-header-status'),_0x3382df=_0x45f874[_0x154302(0xc86)](_0x154302(0x364));_0x32f53a[_0x154302(0x136b)]?(_0x45f874[_0x154302(0x20f)][_0x154302(0x115d)]='none',document['getElementById'](_0x154302(0xf43))['style'][_0x154302(0x66c)]=_0x154302(0xd4f)):(_0x45f874[_0x154302(0x20f)][_0x154302(0x115d)]=_0x154302(0x79c),document[_0x154302(0x9a3)]('chat-header-title-wrapper')[_0x154302(0x20f)][_0x154302(0x66c)]=_0x154302(0xd1f),_0x3382df['textContent']=_0x32f53a[_0x154302(0x27d)]?.[_0x154302(0x13ca)]||'在线',_0x45f874[_0x154302(0x4d8)]['toggle'](_0x154302(0x15b7),_0x32f53a[_0x154302(0x27d)]?.[_0x154302(0x545)]||![]));const _0x2e574f=document[_0x154302(0x9a3)](_0x154302(0x3e5)),_0x16187c=_0x32f53a[_0x154302(0x450)][_0x154302(0x5f1)],_0xa6ecc8=_0x19ddb8[_0x154302(0x4c8)][_0x154302(0x10c6)],_0x5066bb=document['getElementById'](_0x154302(0xae7))[_0x154302(0x4d8)][_0x154302(0x1222)]('dark-mode'),_0xe208a6=_0x5066bb?_0x154302(0x528):_0x154302(0xee8);if(_0x16187c)_0x2e574f[_0x154302(0x20f)]['backgroundImage']=_0x154302(0x55b)+_0x16187c+')',_0x2e574f['style'][_0x154302(0x87e)]=_0x154302(0xf52);else _0xa6ecc8?(_0x2e574f[_0x154302(0x20f)][_0x154302(0x1090)]=_0x154302(0x55b)+_0xa6ecc8+')',_0x2e574f[_0x154302(0x20f)][_0x154302(0x87e)]=_0x154302(0xf52)):(_0x2e574f[_0x154302(0x20f)][_0x154302(0x1090)]=_0x154302(0x8e0),_0x2e574f[_0x154302(0x20f)][_0x154302(0x87e)]=_0xe208a6);if(_0x32f53a[_0x154302(0x1498)])_0x575404[_0x154302(0x20f)][_0x154302(0x115d)]=_0x154302(0x8e0),_0x58f7c5[_0x154302(0x20f)][_0x154302(0x115d)]='flex',_0x5b7df8[_0x154302(0xeb2)]=_0x154302(0xdc5),document[_0x154302(0x9a3)]('spectator-propel-btn')['onclick']=_0x2ec49e;else{_0x575404[_0x154302(0x20f)][_0x154302(0x115d)]=_0x154302(0x79c),_0x58f7c5['style'][_0x154302(0x115d)]=_0x154302(0x8e0),_0x5b7df8[_0x154302(0xeb2)]='';if(!_0x32f53a['isGroup']&&_0x32f53a['relationship'][_0x154302(0x27d)]!=='friend'){_0x58f7c5[_0x154302(0x20f)]['display']=_0x154302(0x79c),_0x575404['style'][_0x154302(0xf36)]=_0x154302(0x1236);let _0x24b2c7='';switch(_0x32f53a['relationship'][_0x154302(0x27d)]){case'blocked_by_user':const _0xfa10e3=_0x4351c8!==null,_0x2d0497=_0x32f53a['relationship'][_0x154302(0x3ce)],_0x585de4=_0x19ddb8[_0x154302(0x4c8)][_0x154302(0x1e7)]||0x1,_0xde62e9=_0x585de4*0x3c*0x3c*0x3e8,_0x1bfd71=Date['now']()-_0x2d0497,_0x2abe46=_0x1bfd71>_0xde62e9,_0x45de6e=Math[_0x154302(0x812)](0x0,Math['ceil']((_0xde62e9-_0x1bfd71)/(0x3e8*0x3c)));_0x24b2c7=_0x154302(0x9b1)+_0x32f53a[_0x154302(0x1561)]+_0x154302(0xd7d)+(_0x19ddb8[_0x154302(0x4c8)]['enableBackgroundActivity']?_0x154302(0x49b):_0x154302(0x1059))+_0x154302(0x6d9)+(_0xfa10e3?_0x154302(0x635):_0x154302(0x9ec))+_0x154302(0x9ad)+_0x32f53a[_0x154302(0x239)][_0x154302(0x27d)]+_0x154302(0xc11)+_0x585de4+_0x154302(0xb5c)+(_0x2abe46?'<span\x20style=\x22color:\x20green;\x22>是</span>':_0x154302(0x1127)+_0x45de6e+_0x154302(0x346))+_0x154302(0xb63)+(_0x2abe46&&_0x19ddb8[_0x154302(0x4c8)][_0x154302(0x106e)]?_0x154302(0x378):'<span\x20style=\x22color:\x20red;\x22>未满足</span>')+_0x154302(0x5cb);break;case _0x154302(0xf34):_0x24b2c7=_0x154302(0xf12);break;case _0x154302(0x8ab):_0x24b2c7=_0x154302(0x28f)+_0x32f53a[_0x154302(0x1561)]+_0x154302(0x81b)+_0x32f53a[_0x154302(0x239)][_0x154302(0x351)]+_0x154302(0xa18);break;case'pending_ai_approval':_0x24b2c7=_0x154302(0x9d9);break;}_0x5b7df8[_0x154302(0xeb2)]=_0x24b2c7;}else _0x58f7c5[_0x154302(0x20f)][_0x154302(0x115d)]=_0x154302(0x8e0),_0x575404[_0x154302(0x20f)]['visibility']=_0x154302(0xc09);}_0x32ba7a[_0x154302(0xeb2)]='';const _0xe01dd0=_0x32f53a[_0x154302(0x1f0)];_0xaa83fe=0x0;const _0x2bff66=_0x19ddb8[_0x154302(0x4c8)][_0x154302(0x11ef)]||0x32,_0x4a9253=_0xe01dd0['slice'](-_0x2bff66),_0x19f77f=[];let _0x337ef8=0x0;for(const _0x167897 of _0x4a9253){_0x337ef8>0x0&&_0x167897[_0x154302(0xd73)]-_0x337ef8>0x927c0&&_0x19f77f[_0x154302(0x1c4)](Promise[_0x154302(0x7ff)](_0x17d417(_0x167897['timestamp']))),_0x19f77f['push'](_0xb42d69(_0x167897,_0x32f53a,!![])),_0x337ef8=_0x167897[_0x154302(0xd73)];}const _0x4043fb=await Promise['all'](_0x19f77f),_0x200b40=document[_0x154302(0xa4d)]();_0x4043fb[_0x154302(0x1195)](Boolean)[_0x154302(0x15c1)](_0x3c63a6=>_0x200b40['appendChild'](_0x3c63a6)),_0x32ba7a['appendChild'](_0x200b40),_0xaa83fe=_0x4a9253['length'];const _0x486ef3=document[_0x154302(0xe94)](_0x154302(0x8ca));_0x486ef3['id']='typing-indicator',_0x486ef3[_0x154302(0x20f)][_0x154302(0x115d)]=_0x154302(0x8e0),_0x486ef3['textContent']='对方正在输入...',_0x32ba7a[_0x154302(0x983)](_0x486ef3),setTimeout(()=>_0x32ba7a[_0x154302(0x85c)]=_0x32ba7a[_0x154302(0x13b7)],0x0);}async function _0x248587(){const _0x257316=_0x48bc6d;if(_0x4cf1ca)return;_0x4cf1ca=!![];const _0x17c45b=document['getElementById'](_0x257316(0x10f8)),_0x26e2ae=_0x19ddb8[_0x257316(0xb04)][_0x19ddb8[_0x257316(0x859)]];if(!_0x26e2ae){_0x4cf1ca=![];return;}_0x3335f4(_0x17c45b,'top');const _0x1c127d=_0x17c45b[_0x257316(0x13b7)];await new Promise(_0x9e4f53=>setTimeout(_0x9e4f53,0x1f4));const _0x4d12a3=_0x26e2ae[_0x257316(0x1f0)][_0x257316(0x106b)],_0x3c50d6=_0x19ddb8[_0x257316(0x4c8)]['chatRenderWindow']||0x32,_0x19a044=_0x4d12a3-_0xaa83fe-_0x3c50d6,_0x988231=_0x4d12a3-_0xaa83fe,_0x3d1fda=_0x26e2ae[_0x257316(0x1f0)][_0x257316(0x457)](Math['max'](0x0,_0x19a044),_0x988231),_0x733d84=_0x17c45b['querySelector'](_0x257316(0x53f));let _0x36d717=_0x733d84?parseInt(_0x733d84['dataset'][_0x257316(0xd73)]):0x0;for(const _0x56b27a of _0x3d1fda[_0x257316(0x333)]()){if(_0x36d717>0x0&&_0x36d717-_0x56b27a[_0x257316(0xd73)]>0x927c0){const _0x147973=_0x17d417(_0x36d717);_0x17c45b[_0x257316(0xfff)](_0x147973);}await _0x3bfc05(_0x56b27a,_0x26e2ae),_0x36d717=_0x56b27a[_0x257316(0xd73)];}_0xaa83fe+=_0x3d1fda['length'];const _0xde7a59=_0x17c45b['scrollHeight'];_0x17c45b[_0x257316(0x85c)]=_0xde7a59-_0x1c127d,_0x38511a(_0x17c45b),_0x4cf1ca=![];}function _0x21e3fb(){const _0x21338a=_0x48bc6d;_0xc4cdb5(),_0x10912a();const _0xa90547=document[_0x21338a(0x9a3)](_0x21338a(0xffe)),_0x189ecf=_0x19ddb8['globalSettings']['wallpaper'];_0x189ecf?(_0xa90547['style'][_0x21338a(0x1090)]=_0x21338a(0x55b)+_0x189ecf+')',_0xa90547['textContent']=''):(_0xa90547[_0x21338a(0x20f)]['backgroundImage']=_0x21338a(0xe74),_0xa90547[_0x21338a(0x766)]=_0x21338a(0x594));const _0x241466=document[_0x21338a(0x9a3)](_0x21338a(0x513)),_0x367eff=_0x19ddb8[_0x21338a(0x4c8)][_0x21338a(0x831)];_0x367eff?(_0x241466[_0x21338a(0x20f)][_0x21338a(0x1090)]='url('+_0x367eff+')',_0x241466[_0x21338a(0x766)]=''):(_0x241466[_0x21338a(0x20f)][_0x21338a(0x1090)]=_0x21338a(0x28b),_0x241466[_0x21338a(0x766)]=_0x21338a(0x594));const _0x48350a=document['getElementById']('global-bg-preview'),_0x105a59=_0x19ddb8[_0x21338a(0x4c8)][_0x21338a(0x10c6)];_0x105a59?(_0x48350a[_0x21338a(0x20f)]['backgroundImage']='url('+_0x105a59+')',_0x48350a[_0x21338a(0x766)]='',document[_0x21338a(0x9a3)]('remove-global-bg-btn')[_0x21338a(0x20f)][_0x21338a(0x115d)]=_0x21338a(0xe97)):(_0x48350a[_0x21338a(0x20f)]['backgroundImage']=_0x21338a(0x8e0),_0x48350a[_0x21338a(0x766)]=_0x21338a(0x12bc),document[_0x21338a(0x9a3)](_0x21338a(0xa83))[_0x21338a(0x20f)][_0x21338a(0x115d)]=_0x21338a(0x8e0)),_0x1827fe(),_0x4354d3(),document[_0x21338a(0x9a3)](_0x21338a(0x543))[_0x21338a(0x7b2)]=_0x19ddb8['globalSettings']['globalCss']||'',document['getElementById'](_0x21338a(0x357))[_0x21338a(0x7b2)]=_0x19ddb8[_0x21338a(0x4c8)][_0x21338a(0x1437)]||'',document[_0x21338a(0x9a3)](_0x21338a(0x47f))[_0x21338a(0x944)]=_0x19ddb8[_0x21338a(0x4c8)]['showStatusBar']||![],document[_0x21338a(0x9a3)](_0x21338a(0x32a))[_0x21338a(0x944)]=_0x19ddb8[_0x21338a(0x4c8)][_0x21338a(0x1370)]||![],document[_0x21338a(0x9a3)]('minimal-chat-ui-switch')[_0x21338a(0x944)]=_0x19ddb8['globalSettings'][_0x21338a(0xed0)]||![],document[_0x21338a(0x9a3)](_0x21338a(0xa58))[_0x21338a(0x944)]=_0x19ddb8[_0x21338a(0x4c8)][_0x21338a(0x9f4)]||![],document['getElementById'](_0x21338a(0x955))['checked']=_0x19ddb8[_0x21338a(0x4c8)][_0x21338a(0x439)]||![],_0x3d16c1(),_0x1069c6();}window[_0x48bc6d(0x132d)]=_0x21e3fb;function _0x28dc10(){const _0x2d21db=_0x48bc6d,_0x472bb9=document[_0x2d21db(0x9a3)](_0x2d21db(0x663)),_0x13f227=_0x19ddb8[_0x2d21db(0x4c8)][_0x2d21db(0xa32)];_0x13f227?_0x472bb9[_0x2d21db(0x20f)]['backgroundImage']='url('+_0x13f227+')':_0x472bb9['style'][_0x2d21db(0x1090)]='linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)';}function _0x5b7bb9(_0x1ce5da){const _0x4fd385=_0x48bc6d;document[_0x4fd385(0x131c)](_0x4fd385(0x662))[_0x4fd385(0x15c1)](_0x3224ac=>{const _0x40e94f=_0x4fd385;_0x3224ac['classList'][_0x40e94f(0xc02)](_0x40e94f(0xe9f),_0x3224ac['dataset'][_0x40e94f(0x922)]===_0x1ce5da);}),document[_0x4fd385(0x131c)](_0x4fd385(0xe70))[_0x4fd385(0x15c1)](_0x5aadb6=>{const _0x214ac6=_0x4fd385;_0x5aadb6[_0x214ac6(0x4d8)][_0x214ac6(0xc02)]('active',_0x5aadb6['dataset'][_0x214ac6(0x922)]===_0x1ce5da);});}async function _0x52d7ba(){const _0x39b9b4=_0x48bc6d,_0xcb6a1d=document[_0x39b9b4(0x9a3)]('world-book-tabs'),_0x99d5bb=document[_0x39b9b4(0x9a3)]('world-book-content-container');_0xcb6a1d[_0x39b9b4(0xeb2)]='',_0x99d5bb[_0x39b9b4(0xeb2)]='';const [_0x41f46d,_0x4a4cf2]=await Promise[_0x39b9b4(0xbf1)]([_0x512070[_0x39b9b4(0x8e4)][_0x39b9b4(0x591)](),_0x512070[_0x39b9b4(0x58d)][_0x39b9b4(0x1404)](_0x39b9b4(0x1561))[_0x39b9b4(0x591)]()]);_0x19ddb8[_0x39b9b4(0x8e4)]=_0x41f46d;if(_0x41f46d[_0x39b9b4(0x106b)]===0x0){_0x99d5bb[_0x39b9b4(0xeb2)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一本世界书</p>';return;}const _0x1aef55=document[_0x39b9b4(0xe94)](_0x39b9b4(0xd38));_0x1aef55[_0x39b9b4(0x1487)]=_0x39b9b4(0x3d1),_0x1aef55[_0x39b9b4(0x766)]='全部',_0x1aef55[_0x39b9b4(0xd8d)]['categoryId']=_0x39b9b4(0xbf1),_0xcb6a1d['appendChild'](_0x1aef55);const _0x133e3b=document['createElement'](_0x39b9b4(0x8ca));_0x133e3b['className']=_0x39b9b4(0x1110),_0x133e3b['dataset'][_0x39b9b4(0x922)]=_0x39b9b4(0xbf1),_0x99d5bb['appendChild'](_0x133e3b),_0x4a4cf2['forEach'](_0x4ec7e8=>{const _0x33e1df=_0x39b9b4,_0x47cd8b=document[_0x33e1df(0xe94)]('button');_0x47cd8b['className']='world-book-tab',_0x47cd8b[_0x33e1df(0x766)]=_0x4ec7e8[_0x33e1df(0x1561)],_0x47cd8b[_0x33e1df(0xd8d)][_0x33e1df(0x922)]=String(_0x4ec7e8['id']),_0xcb6a1d[_0x33e1df(0x983)](_0x47cd8b);const _0x115d52=document[_0x33e1df(0xe94)](_0x33e1df(0x8ca));_0x115d52[_0x33e1df(0x1487)]='world-book-category-pane',_0x115d52[_0x33e1df(0xd8d)][_0x33e1df(0x922)]=String(_0x4ec7e8['id']),_0x99d5bb[_0x33e1df(0x983)](_0x115d52);});const _0x1451e9=_0x41f46d['some'](_0xb82a4b=>!_0xb82a4b[_0x39b9b4(0x922)]);if(_0x1451e9){const _0x4a7870=document[_0x39b9b4(0xe94)](_0x39b9b4(0xd38));_0x4a7870[_0x39b9b4(0x1487)]=_0x39b9b4(0x6bf),_0x4a7870[_0x39b9b4(0x766)]=_0x39b9b4(0xa9b),_0x4a7870['dataset'][_0x39b9b4(0x922)]='uncategorized',_0xcb6a1d[_0x39b9b4(0x983)](_0x4a7870);const _0x31f853=document[_0x39b9b4(0xe94)]('div');_0x31f853[_0x39b9b4(0x1487)]='world-book-category-pane',_0x31f853[_0x39b9b4(0xd8d)][_0x39b9b4(0x922)]=_0x39b9b4(0x80f),_0x99d5bb[_0x39b9b4(0x983)](_0x31f853);}_0x41f46d[_0x39b9b4(0x15c1)](_0x2fdd39=>{const _0x3d0849=_0x39b9b4;let _0x4210e2=_0x3d0849(0x928);if(Array[_0x3d0849(0xb9b)](_0x2fdd39[_0x3d0849(0x4e3)])&&_0x2fdd39[_0x3d0849(0x4e3)][_0x3d0849(0x106b)]>0x0){const _0x399bf4=_0x2fdd39['content'][0x0];_0x4210e2=_0x399bf4[_0x3d0849(0x79d)]||_0x399bf4[_0x3d0849(0x4e3)]||'';}else typeof _0x2fdd39[_0x3d0849(0x4e3)]===_0x3d0849(0x86c)&&_0x2fdd39[_0x3d0849(0x4e3)][_0x3d0849(0x13f9)]()!==''&&(_0x4210e2=_0x2fdd39[_0x3d0849(0x4e3)]);const _0x43c48b=document[_0x3d0849(0xe94)]('div');_0x43c48b['className']='world-book-card',_0x43c48b[_0x3d0849(0xeb2)]=_0x3d0849(0x1465)+_0x2fdd39[_0x3d0849(0x1561)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>'+_0x4210e2+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x34ef82=()=>_0x3f3988(_0x2fdd39['id']),_0x2ac4b5=async()=>{const _0xde6c43=_0x3d0849,_0x56561e=await _0x2c9509(_0xde6c43(0x43c),_0xde6c43(0x124c)+_0x2fdd39['name']+_0xde6c43(0xb14),{'confirmButtonClass':_0xde6c43(0xf5b)});_0x56561e&&(await _0x512070[_0xde6c43(0x8e4)][_0xde6c43(0x10a8)](_0x2fdd39['id']),_0x19ddb8['worldBooks']=_0x19ddb8['worldBooks'][_0xde6c43(0x1195)](_0x3cd31b=>_0x3cd31b['id']!==_0x2fdd39['id']),_0x52d7ba());};_0x43c48b['addEventListener'](_0x3d0849(0x9cc),_0x34ef82),_0x1a651b(_0x43c48b,_0x2ac4b5);const _0x2d59d5=_0x43c48b[_0x3d0849(0x173)](!![]);_0x2d59d5[_0x3d0849(0x954)](_0x3d0849(0x9cc),_0x34ef82),_0x1a651b(_0x2d59d5,_0x2ac4b5),_0x133e3b[_0x3d0849(0x983)](_0x2d59d5);const _0x3a3711=_0x2fdd39[_0x3d0849(0x922)]?String(_0x2fdd39[_0x3d0849(0x922)]):'uncategorized',_0x1b5190=_0x99d5bb[_0x3d0849(0xc86)](_0x3d0849(0x1b6)+_0x3a3711+'\x22]');_0x1b5190&&_0x1b5190[_0x3d0849(0x983)](_0x43c48b);}),document[_0x39b9b4(0x131c)](_0x39b9b4(0x662))[_0x39b9b4(0x15c1)](_0x401f24=>{const _0x4e2dc3=_0x39b9b4;_0x401f24[_0x4e2dc3(0x954)](_0x4e2dc3(0x9cc),()=>_0x5b7bb9(_0x401f24[_0x4e2dc3(0xd8d)][_0x4e2dc3(0x922)]));});}function _0x253ce4(_0x30a25a,_0x5352f3){const _0x53d85a=_0x48bc6d,_0x2e23d8=document[_0x53d85a(0xe94)](_0x53d85a(0x8ca));_0x2e23d8[_0x53d85a(0x1487)]=_0x53d85a(0xfb1),_0x2e23d8[_0x53d85a(0xeb2)]=_0x53d85a(0x554)+_0x30a25a+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x32e80b=_0x2e23d8[_0x53d85a(0xc86)](_0x53d85a(0x14ca));return _0x5352f3['sort']((_0x522ec6,_0x4e3ae4)=>_0x522ec6[_0x53d85a(0x1561)][_0x53d85a(0xe8e)](_0x4e3ae4['name'],'zh-CN')),_0x5352f3[_0x53d85a(0x15c1)](_0x22d670=>{const _0x339d43=_0x53d85a;let _0x4a093c='暂无内容...';if(Array['isArray'](_0x22d670[_0x339d43(0x4e3)])&&_0x22d670[_0x339d43(0x4e3)][_0x339d43(0x106b)]>0x0){const _0xe764c8=_0x22d670[_0x339d43(0x4e3)][0x0];_0x4a093c=_0xe764c8[_0x339d43(0x79d)]||_0xe764c8[_0x339d43(0x4e3)]||'';}else typeof _0x22d670[_0x339d43(0x4e3)]===_0x339d43(0x86c)&&_0x22d670['content']['trim']()!==''&&(_0x4a093c=_0x22d670[_0x339d43(0x4e3)]);const _0x4450f6=document['createElement'](_0x339d43(0x8ca));_0x4450f6[_0x339d43(0x1487)]=_0x339d43(0x9ab),_0x4450f6[_0x339d43(0xd8d)][_0x339d43(0xf1b)]=_0x22d670['id'],_0x4450f6[_0x339d43(0xeb2)]=_0x339d43(0xc88)+_0x22d670[_0x339d43(0x1561)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>'+String(_0x4a093c)['substring'](0x0,0x32)+_0x339d43(0xa29),_0x4450f6['addEventListener'](_0x339d43(0x9cc),()=>_0x3f3988(_0x22d670['id'])),_0x1a651b(_0x4450f6,async()=>{const _0x4c7002=_0x339d43,_0x4bc2b3=await _0x2c9509(_0x4c7002(0x43c),_0x4c7002(0x124c)+_0x22d670[_0x4c7002(0x1561)]+_0x4c7002(0xf5e),{'confirmButtonClass':_0x4c7002(0xf5b)});_0x4bc2b3&&(await _0x512070['worldBooks'][_0x4c7002(0x10a8)](_0x22d670['id']),_0x19ddb8[_0x4c7002(0x8e4)]=_0x19ddb8[_0x4c7002(0x8e4)][_0x4c7002(0x1195)](_0x4a059d=>_0x4a059d['id']!==_0x22d670['id']),_0x52d7ba());}),_0x32e80b[_0x339d43(0x983)](_0x4450f6);}),_0x2e23d8;}window[_0x48bc6d(0x64a)]=_0x52d7ba;async function _0x3f3988(_0x2f8bf6){const _0xb4f821=_0x48bc6d;_0x35df44('world-book-editor-screen'),_0x79f0bb=_0x2f8bf6;const [_0x48e05f,_0x508d2a]=await Promise['all']([_0x512070[_0xb4f821(0x8e4)][_0xb4f821(0x14ee)](_0x2f8bf6),_0x512070[_0xb4f821(0x58d)][_0xb4f821(0x591)]()]);if(!_0x48e05f){console['error'](_0xb4f821(0x17d),_0x2f8bf6),_0x35df44('world-book-screen');return;}document[_0xb4f821(0x9a3)](_0xb4f821(0xfd2))[_0xb4f821(0x766)]=_0x48e05f[_0xb4f821(0x1561)],document['getElementById'](_0xb4f821(0x1038))[_0xb4f821(0x7b2)]=_0x48e05f['name'];const _0x319f07=document[_0xb4f821(0x9a3)](_0xb4f821(0x4c5));_0x319f07[_0xb4f821(0xeb2)]='<option\x20value=\x22\x22>--\x20未分类\x20--</option>',_0x508d2a['forEach'](_0x4904ca=>{const _0x5c48f2=_0xb4f821,_0x3d791e=document[_0x5c48f2(0xe94)](_0x5c48f2(0x43a));_0x3d791e['value']=_0x4904ca['id'],_0x3d791e[_0x5c48f2(0x766)]=_0x4904ca[_0x5c48f2(0x1561)];if(_0x48e05f[_0x5c48f2(0x922)]===_0x4904ca['id'])_0x3d791e['selected']=!![];_0x319f07[_0x5c48f2(0x983)](_0x3d791e);});const _0xf5429=document['getElementById'](_0xb4f821(0x313));_0xf5429['innerHTML']='',Array[_0xb4f821(0xb9b)](_0x48e05f[_0xb4f821(0x4e3)])&&_0x48e05f[_0xb4f821(0x4e3)][_0xb4f821(0x106b)]>0x0?_0x48e05f[_0xb4f821(0x4e3)][_0xb4f821(0x15c1)](_0x5b51d2=>{const _0x39ea4b=_0xb4f821,_0x116e65=_0x33835a(_0x5b51d2);_0xf5429[_0x39ea4b(0x983)](_0x116e65);}):_0xf5429[_0xb4f821(0xeb2)]=_0xb4f821(0x386);}async function _0x5a49be(_0x59f36a=!![]){const _0x2cb92c=_0x48bc6d,_0xd11951=document[_0x2cb92c(0x9a3)](_0x2cb92c(0x157a)),_0x30b927=document[_0x2cb92c(0x9a3)](_0x2cb92c(0x150b)),_0x169da8=document[_0x2cb92c(0x9a3)](_0x2cb92c(0x9fc)),_0x52cbd5=_0x169da8[_0x2cb92c(0x7b2)][_0x2cb92c(0x13f9)]()[_0x2cb92c(0x905)]();if(_0x59f36a){_0x30b927[_0x2cb92c(0xeb2)]='';const _0x40c628=await _0x512070['stickerCategories'][_0x2cb92c(0x591)]();_0x30b927[_0x2cb92c(0xeb2)]+=_0x2cb92c(0x1144)+(_0x507d02===_0x2cb92c(0xbf1)?_0x2cb92c(0xe9f):'')+'\x22\x20data-category-id=\x22all\x22>全部</button>',_0x40c628[_0x2cb92c(0x15c1)](_0xff3bd1=>{const _0x32a9f9=_0x2cb92c;_0x30b927[_0x32a9f9(0xeb2)]+=_0x32a9f9(0x1144)+(_0x507d02===_0xff3bd1['id']?_0x32a9f9(0xe9f):'')+_0x32a9f9(0x43d)+_0xff3bd1['id']+'\x22>'+_0xff3bd1[_0x32a9f9(0x1561)]+_0x32a9f9(0x673);}),_0x30b927[_0x2cb92c(0xeb2)]+=_0x2cb92c(0x1144)+(_0x507d02==='uncategorized'?_0x2cb92c(0xe9f):'')+_0x2cb92c(0xe2e);}_0xd11951[_0x2cb92c(0xeb2)]='';let _0x1e2a8b;if(_0x507d02===_0x2cb92c(0xbf1))_0x1e2a8b=_0x19ddb8[_0x2cb92c(0x1557)];else _0x507d02==='uncategorized'?_0x1e2a8b=_0x19ddb8[_0x2cb92c(0x1557)][_0x2cb92c(0x1195)](_0x5018cc=>!_0x5018cc[_0x2cb92c(0x922)]):_0x1e2a8b=_0x19ddb8[_0x2cb92c(0x1557)]['filter'](_0x31c738=>_0x31c738[_0x2cb92c(0x922)]===_0x507d02);const _0x2030b7=_0x52cbd5?_0x1e2a8b[_0x2cb92c(0x1195)](_0x3de5a4=>_0x3de5a4['name'][_0x2cb92c(0x905)]()[_0x2cb92c(0x478)](_0x52cbd5)):_0x1e2a8b;if(_0x2030b7['length']===0x0){const _0x52253e=_0x52cbd5?_0x2cb92c(0x2fd):_0x2cb92c(0x5f3);_0xd11951[_0x2cb92c(0xeb2)]=_0x2cb92c(0x7f9)+_0x52253e+_0x2cb92c(0x4cf);return;}_0x2030b7['forEach'](_0x57030c=>{const _0x35356f=_0x2cb92c,_0x8b35d0=document[_0x35356f(0xe94)]('div');_0x8b35d0['className']='sticker-item',_0x8b35d0[_0x35356f(0x10b8)]=_0x57030c[_0x35356f(0x1561)],_0x8b35d0[_0x35356f(0xd8d)][_0x35356f(0x914)]=_0x57030c['id'],_0x8b35d0[_0x35356f(0xeb2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url('+_0x57030c[_0x35356f(0x121f)]+_0x35356f(0xb0b)+_0x57030c[_0x35356f(0x1561)]+_0x35356f(0x110c),_0x8b35d0[_0x35356f(0x954)]('click',()=>{_0x4a94f1?_0x1ef292(_0x8b35d0):_0x417ce8(_0x57030c);});const _0xfa3f29=document[_0x35356f(0xe94)](_0x35356f(0x8ca));_0xfa3f29[_0x35356f(0x1487)]=_0x35356f(0x1441),_0xfa3f29[_0x35356f(0xeb2)]=_0x35356f(0x11e1),_0xfa3f29['onclick']=async _0x2d47fd=>{const _0x381a4d=_0x35356f;_0x2d47fd[_0x381a4d(0x63a)]();const _0x26a12c=await _0x2c9509(_0x381a4d(0x1377),'确定要删除表情\x20\x22'+_0x57030c['name']+_0x381a4d(0x1174),{'confirmButtonClass':_0x381a4d(0xf5b)});_0x26a12c&&(await _0x512070[_0x381a4d(0x1557)][_0x381a4d(0x10a8)](_0x57030c['id']),_0x19ddb8[_0x381a4d(0x1557)]=_0x19ddb8[_0x381a4d(0x1557)][_0x381a4d(0x1195)](_0x5c537e=>_0x5c537e['id']!==_0x57030c['id']),_0x5a49be());},_0x8b35d0[_0x35356f(0x983)](_0xfa3f29),_0xd11951[_0x35356f(0x983)](_0x8b35d0);});}let _0x4a94f1=![],_0xa651a3=new Set(),_0x3d1e35=![],_0x3b4dcd=new Set(),_0x1ab0a1=[],_0x35e034=0x0;const _0x52fa12=0x2d;let _0x3c8299=![];function _0x39da36(){const _0x465e1d=_0x48bc6d;_0x4a94f1=!_0x4a94f1;const _0x125374=document[_0x465e1d(0x9a3)](_0x465e1d(0x157a)),_0x2c88de=document[_0x465e1d(0x9a3)](_0x465e1d(0xa5c)),_0x40938f=document[_0x465e1d(0x9a3)](_0x465e1d(0xdfc)),_0x150d7c=document[_0x465e1d(0x9a3)](_0x465e1d(0x749));_0x125374['classList']['toggle'](_0x465e1d(0xb3e),_0x4a94f1),_0x4a94f1?(_0x2c88de[_0x465e1d(0x766)]='完成',_0x40938f[_0x465e1d(0x20f)][_0x465e1d(0x115d)]=_0x465e1d(0x79c),_0xa651a3[_0x465e1d(0xe81)](),_0x150d7c['checked']=![],_0x18a9d2()):(_0x2c88de[_0x465e1d(0x766)]='管理',_0x40938f[_0x465e1d(0x20f)][_0x465e1d(0x115d)]='none',_0x125374[_0x465e1d(0x131c)](_0x465e1d(0xf4b))['forEach'](_0x5a32ae=>_0x5a32ae[_0x465e1d(0x4d8)][_0x465e1d(0x133d)]('selected')));}function _0x240175(){const _0x27c4fc=_0x48bc6d,_0x416bb2=document[_0x27c4fc(0x9a3)](_0x27c4fc(0x749)),_0x14208c=_0x416bb2['checked'];let _0xed4358;if(_0x507d02==='all')_0xed4358=_0x19ddb8[_0x27c4fc(0x1557)];else _0x507d02===_0x27c4fc(0x80f)?_0xed4358=_0x19ddb8[_0x27c4fc(0x1557)][_0x27c4fc(0x1195)](_0x115a88=>!_0x115a88[_0x27c4fc(0x922)]):_0xed4358=_0x19ddb8[_0x27c4fc(0x1557)][_0x27c4fc(0x1195)](_0x55ed48=>_0x55ed48['categoryId']===_0x507d02);_0xed4358[_0x27c4fc(0x15c1)](_0x21a283=>{const _0x1dfcde=_0x27c4fc,_0x11160c=_0x21a283['id'],_0x4ca6a3=document[_0x1dfcde(0xc86)](_0x1dfcde(0xe4a)+_0x11160c+'\x22]');if(_0x14208c){_0xa651a3['add'](_0x11160c);if(_0x4ca6a3)_0x4ca6a3['classList'][_0x1dfcde(0xe05)](_0x1dfcde(0x154b));}else{_0xa651a3[_0x1dfcde(0x10a8)](_0x11160c);if(_0x4ca6a3)_0x4ca6a3[_0x1dfcde(0x4d8)][_0x1dfcde(0x133d)]('selected');}}),_0x18a9d2();}function _0x18a9d2(){const _0x4a342c=_0x48bc6d,_0x123724=document[_0x4a342c(0x9a3)](_0x4a342c(0xf93));_0x123724[_0x4a342c(0x766)]=_0x4a342c(0x1587)+_0xa651a3[_0x4a342c(0xbdf)]+')';}function _0x1ef292(_0x22e7d0){const _0x24167b=_0x48bc6d;if(!_0x4a94f1)return;const _0x25234f=_0x22e7d0['dataset'][_0x24167b(0x914)];if(!_0x25234f)return;_0x22e7d0[_0x24167b(0x4d8)][_0x24167b(0xc02)]('selected'),_0xa651a3['has'](_0x25234f)?_0xa651a3[_0x24167b(0x10a8)](_0x25234f):_0xa651a3['add'](_0x25234f),_0x18a9d2();}async function _0x2142e3(){const _0x3ad197=_0x48bc6d;if(_0xa651a3[_0x3ad197(0xbdf)]===0x0)return;const _0x218f48=await _0x2c9509(_0x3ad197(0xd05),'确定要删除选中的\x20'+_0xa651a3[_0x3ad197(0xbdf)]+'\x20个表情吗？此操作不可恢复。',{'confirmButtonClass':_0x3ad197(0xf5b)});if(_0x218f48){const _0x515f14=[..._0xa651a3];await _0x512070[_0x3ad197(0x1557)][_0x3ad197(0x25c)](_0x515f14),_0x19ddb8[_0x3ad197(0x1557)]=_0x19ddb8['userStickers']['filter'](_0x3ad20f=>!_0x515f14['includes'](_0x3ad20f['id'])),_0x39da36(),_0x5a49be(),await _0x403a62(_0x3ad197(0x784),_0x3ad197(0x57d));}}async function _0x54c2c3(){const _0x2d9833=_0x48bc6d,_0xd67265=_0x2d9833(0x1d3),_0x23140c=await _0x3ab788(_0x2d9833(0x602),_0xd67265,'',_0x2d9833(0x8db));_0x23140c&&_0x23140c[_0x2d9833(0x13f9)]()&&await _0x57c19(_0x23140c);}async function _0x57c19(_0x1d3361){const _0x2c2359=_0x48bc6d,_0x3bf504=_0x1d3361[_0x2c2359(0x13f9)]()[_0x2c2359(0x1536)]('\x0a'),_0x2d3b39=[],_0x25ec13=_0x2c2359(0xc2f);let _0x16316f=0x0;const _0x5aae96=_0x507d02!==_0x2c2359(0xbf1)&&_0x507d02!==_0x2c2359(0x80f)?_0x507d02:null;for(const _0x45c021 of _0x3bf504){const _0x4fc893=_0x45c021[_0x2c2359(0x13f9)]();if(!_0x4fc893||_0x4fc893[_0x2c2359(0x478)]('填入'))continue;const _0x52626f=_0x4fc893[_0x2c2359(0x293)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x52626f){const _0x217e7c=_0x52626f[0x1][_0x2c2359(0x13f9)](),_0x2c6433=_0x52626f[0x2][_0x2c2359(0x13f9)]();_0x2d3b39[_0x2c2359(0x1c4)]({'id':'sticker_'+Date[_0x2c2359(0x64b)]()+Math['random'](),'name':_0x217e7c,'url':_0x2c6433,'categoryId':_0x5aae96});continue;}let _0x47e9b9=null,_0x37126f=null;const _0x563dd7=_0x4fc893[_0x2c2359(0x293)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x563dd7)_0x47e9b9=_0x563dd7[0x1],_0x37126f=_0x563dd7[0x2];else{const _0x3c6059=_0x4fc893[_0x2c2359(0x1536)](/\s+/);_0x3c6059[_0x2c2359(0x106b)]>=0x2&&(_0x37126f=_0x3c6059[_0x2c2359(0x144a)](),_0x47e9b9=_0x3c6059[_0x2c2359(0x3b9)]('\x20'));}_0x47e9b9&&_0x37126f&&_0x37126f['includes']('.')?_0x2d3b39['push']({'id':_0x2c2359(0x621)+Date[_0x2c2359(0x64b)]()+Math[_0x2c2359(0xdcd)](),'name':_0x47e9b9,'url':_0x25ec13+_0x37126f,'categoryId':_0x5aae96}):(_0x16316f++,console['warn']('批量导入格式错误，已跳过此行:',_0x4fc893));}_0x16316f>0x0&&await _0x403a62(_0x2c2359(0xc7d),'有\x20'+_0x16316f+_0x2c2359(0x156a));if(_0x2d3b39[_0x2c2359(0x106b)]>0x0)await _0x512070[_0x2c2359(0x1557)][_0x2c2359(0x11d7)](_0x2d3b39),_0x19ddb8[_0x2c2359(0x1557)][_0x2c2359(0x1c4)](..._0x2d3b39),_0x5a49be(),await _0x403a62(_0x2c2359(0x90b),'已成功批量导入\x20'+_0x2d3b39[_0x2c2359(0x106b)]+'\x20个新表情！');else _0x16316f===0x0&&alert(_0x2c2359(0x101b));}function _0x36c2d8(_0x1e2bb6){const _0x2af1db=_0x48bc6d,_0xbe9751=_0x2af1db(0x1c5)+_0x1e2bb6+'\x22]',_0xd1d4c9=document[_0x2af1db(0xc86)](_0xbe9751);_0xd1d4c9?(_0xd1d4c9[_0x2af1db(0x1423)]({'behavior':_0x2af1db(0xfa3),'block':'center'}),_0xd1d4c9[_0x2af1db(0x4d8)][_0x2af1db(0xe05)](_0x2af1db(0x4d9)),setTimeout(()=>{const _0x3100bc=_0x2af1db;document[_0x3100bc(0x7c3)][_0x3100bc(0x1222)](_0xd1d4c9)&&_0xd1d4c9['classList'][_0x3100bc(0x133d)](_0x3100bc(0x4d9));},0x5dc)):alert('找不到原始消息。可能已被删除或位于更早的历史记录中。');}async function _0xb42d69(_0x3ace40,_0x13eb4c){const _0x54cedc=_0x48bc6d;if(_0x3ace40[_0x54cedc(0x1508)]===_0x54cedc(0xd60)){const _0x4241c8=document[_0x54cedc(0xe94)](_0x54cedc(0x8ca));_0x4241c8['className']=_0x54cedc(0x964),_0x4241c8[_0x54cedc(0xd8d)][_0x54cedc(0xd73)]=_0x3ace40[_0x54cedc(0xd73)];const _0x6339d8=document[_0x54cedc(0xe94)](_0x54cedc(0x8ca));return _0x6339d8[_0x54cedc(0x1487)]=_0x54cedc(0x6c2),_0x6339d8[_0x54cedc(0xd8d)]['timestamp']=_0x3ace40[_0x54cedc(0xd73)],_0x6339d8[_0x54cedc(0x766)]=_0x3ace40[_0x54cedc(0x4e3)],_0x4241c8[_0x54cedc(0x983)](_0x6339d8),_0x1a651b(_0x4241c8,()=>_0x12c32b(_0x3ace40['timestamp'])),_0x4241c8[_0x54cedc(0x954)](_0x54cedc(0x9cc),()=>{const _0xf31701=_0x54cedc;_0x164883&&_0x27fede(_0x3ace40[_0xf31701(0xd73)]);}),_0x4241c8;}else{if(_0x3ace40[_0x54cedc(0x1508)]==='post_deleted_notice'){const _0x9ece7e=document[_0x54cedc(0xe94)](_0x54cedc(0x8ca));_0x9ece7e[_0x54cedc(0x1487)]=_0x54cedc(0x964),_0x9ece7e[_0x54cedc(0xd8d)][_0x54cedc(0xd73)]=_0x3ace40[_0x54cedc(0xd73)];const _0x2d3746=document[_0x54cedc(0xe94)](_0x54cedc(0x8ca));return _0x2d3746[_0x54cedc(0x1487)]='message-bubble\x20post-deleted-placeholder',_0x2d3746[_0x54cedc(0xd8d)][_0x54cedc(0xb92)]=_0x3ace40['postId'],_0x2d3746['textContent']=_0x3ace40[_0x54cedc(0x4e3)],_0x9ece7e[_0x54cedc(0x983)](_0x2d3746),_0x1a651b(_0x9ece7e,()=>_0x12c32b(_0x3ace40['timestamp'])),_0x9ece7e[_0x54cedc(0x954)](_0x54cedc(0x9cc),()=>{const _0x36fd0e=_0x54cedc;_0x164883&&_0x27fede(_0x3ace40[_0x36fd0e(0xd73)]);}),_0x9ece7e;}}if(_0x3ace40[_0x54cedc(0x136e)])return null;if(_0x3ace40[_0x54cedc(0x1508)]===_0x54cedc(0x1082)){const _0x46adc3=document[_0x54cedc(0xe94)](_0x54cedc(0x8ca));_0x46adc3[_0x54cedc(0x1487)]=_0x54cedc(0x964);const _0x1a6972=document[_0x54cedc(0xe94)](_0x54cedc(0x8ca));return _0x1a6972['className']=_0x54cedc(0x6af),_0x1a6972[_0x54cedc(0xd8d)][_0x54cedc(0xd73)]=_0x3ace40[_0x54cedc(0xd73)],_0x1a6972[_0x54cedc(0x766)]=_0x3ace40['content'],_0x46adc3[_0x54cedc(0x983)](_0x1a6972),_0x1a651b(_0x46adc3,()=>_0x12c32b(_0x3ace40[_0x54cedc(0xd73)])),_0x46adc3[_0x54cedc(0x954)](_0x54cedc(0x9cc),()=>{if(_0x164883)_0x27fede(_0x3ace40['timestamp']);}),_0x46adc3;}const _0xdb168e=_0x3ace40[_0x54cedc(0x11c1)]===_0x54cedc(0x20d),_0x15cc56=_0x13eb4c['settings'][_0x54cedc(0x1555)]||'我',_0x488ac0=document[_0x54cedc(0xe94)](_0x54cedc(0x8ca));_0x488ac0['className']=_0x54cedc(0x12e3)+(_0xdb168e?_0x54cedc(0x20d):'ai');if(_0x13eb4c[_0x54cedc(0x136b)]&&!_0xdb168e){const _0x364bba=_0x13eb4c[_0x54cedc(0xcca)][_0x54cedc(0xd62)](_0x1ee7df=>_0x1ee7df[_0x54cedc(0x339)]===_0x3ace40['senderName']),_0x444e5e=document['createElement'](_0x54cedc(0x8ca));_0x444e5e[_0x54cedc(0x1487)]=_0x54cedc(0x858),_0x444e5e[_0x54cedc(0x766)]=_0x364bba?_0x364bba[_0x54cedc(0xaf0)]:_0x3ace40[_0x54cedc(0x1043)]||'未知成员',_0x488ac0[_0x54cedc(0x983)](_0x444e5e);}const _0xc23e2e=document[_0x54cedc(0xe94)](_0x54cedc(0x8ca));_0xc23e2e['className']=_0x54cedc(0x154c)+(_0xdb168e?_0x54cedc(0x20d):'ai'),_0xc23e2e['dataset'][_0x54cedc(0xd73)]=_0x3ace40[_0x54cedc(0xd73)];const _0x24df8d=document[_0x54cedc(0xe94)]('span');_0x24df8d[_0x54cedc(0x1487)]=_0x54cedc(0xd73),_0x24df8d[_0x54cedc(0x766)]=_0x13147d(_0x3ace40[_0x54cedc(0xd73)]);let _0xa4dcbf,_0x463e17='';if(_0xdb168e)_0xa4dcbf=_0x13eb4c[_0x54cedc(0x450)][_0x54cedc(0x1af)]||(_0x13eb4c[_0x54cedc(0x136b)]?_0xde5144:_0x4f81ff),_0x463e17=_0x13eb4c[_0x54cedc(0x450)]['myAvatarFrame']||'';else{if(_0x13eb4c[_0x54cedc(0x136b)]){const _0x5b4603=_0x13eb4c[_0x54cedc(0xcca)][_0x54cedc(0xd62)](_0x21fd2a=>_0x21fd2a['originalName']===_0x3ace40[_0x54cedc(0x1043)]);if(_0x5b4603){const _0x59a2db=_0x19ddb8['chats'][_0x5b4603['id']];_0xa4dcbf=_0x5b4603[_0x54cedc(0xf3f)]||(_0x59a2db?_0x59a2db[_0x54cedc(0x450)]['aiAvatar']:_0x451ae9),_0x463e17=_0x5b4603['avatarFrame']||(_0x59a2db?_0x59a2db[_0x54cedc(0x450)][_0x54cedc(0xdc8)]:'');}else _0xa4dcbf=_0x451ae9,_0x463e17='';}else _0xa4dcbf=_0x13eb4c[_0x54cedc(0x450)]['aiAvatar']||_0x4f81ff,_0x463e17=_0x13eb4c[_0x54cedc(0x450)][_0x54cedc(0xdc8)]||'';}let _0x3c19c6;_0x463e17?_0x3c19c6=_0x54cedc(0xef4)+_0xa4dcbf+_0x54cedc(0x4a8)+_0x463e17+'\x22\x20class=\x22avatar-frame\x22></div>':_0x3c19c6=_0x54cedc(0x887)+_0xa4dcbf+'\x22\x20class=\x22avatar\x22>';const _0x198116=_0x463e17?_0x54cedc(0x125a):'',_0x58628a=_0x54cedc(0x681)+_0x198116+'\x22>'+_0x3c19c6+_0x54cedc(0x826);let _0x5745c2,_0x11432='';if(_0x3ace40['quote']){const _0x2566f0=_0x1e2056(_0x13eb4c,_0x3ace40[_0x54cedc(0x6f7)]['senderName']),_0x2ad3d9=String(_0x3ace40[_0x54cedc(0x6f7)][_0x54cedc(0x4e3)]||'');_0x11432=_0x54cedc(0x5e7)+_0x3ace40['quote'][_0x54cedc(0xd73)]+'\x22\x20style=\x22cursor:\x20pointer;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-sender\x22>回复\x20'+_0x2566f0+':</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-content\x22>'+_0x2ad3d9+_0x54cedc(0x1384);}let _0x4b76db=_0x3ace40[_0x54cedc(0x4e3)];if(typeof _0x4b76db===_0x54cedc(0x86c)&&_0x4b76db[_0x54cedc(0x13f9)]()[_0x54cedc(0x608)]('<')&&_0x4b76db['trim']()['endsWith']('>'))_0x5745c2=_0x4b76db,_0xc23e2e[_0x54cedc(0x4d8)]['add'](_0x54cedc(0xb46));else{if(_0x3ace40[_0x54cedc(0x1508)]===_0x54cedc(0x12fb)||_0x3ace40[_0x54cedc(0x1508)]===_0x54cedc(0x721)||_0x3ace40['type']==='share_card'||_0x3ace40[_0x54cedc(0x1508)]==='location_share'||_0x3ace40[_0x54cedc(0x1508)]==='ai_image'||_0x3ace40[_0x54cedc(0x1508)]==='user_photo'||_0x3ace40[_0x54cedc(0x1508)]===_0x54cedc(0x1207)||_0x3ace40['type']===_0x54cedc(0x4b3)||_0x3ace40[_0x54cedc(0x1508)]==='waimai_request'||_0x3ace40[_0x54cedc(0x1508)]==='waimai_order'||_0x3ace40[_0x54cedc(0x1508)]===_0x54cedc(0x552)||_0x3ace40[_0x54cedc(0x1508)]===_0x54cedc(0x3e6)||_0x3ace40['type']===_0x54cedc(0xf69)||_0x3ace40[_0x54cedc(0x1508)]===_0x54cedc(0xe85)||_0x3ace40['type']===_0x54cedc(0x1300)){if(_0x3ace40[_0x54cedc(0x1508)]==='offline_text'){const _0x57caa3=_0x3ace40[_0x54cedc(0x4e3)]||((_0x3ace40[_0x54cedc(0x103d)]||'')+'\x20'+(_0x3ace40['description']||''))[_0x54cedc(0x13f9)](),_0x551f7c=/(「.*?」|“.*?”)/g,_0x3de82b=_0x57caa3[_0x54cedc(0x1536)](_0x551f7c)[_0x54cedc(0x1195)](_0x483512=>_0x483512);_0x5745c2=_0x3de82b[_0x54cedc(0xb0a)](_0x4a9bd7=>{const _0x3a3cbf=_0x54cedc;return _0x4a9bd7[_0x3a3cbf(0x608)]('「')||_0x4a9bd7[_0x3a3cbf(0x608)]('“')?_0x3a3cbf(0x5b2)+_0x49f635(_0x4a9bd7)+_0x3a3cbf(0xeb1):_0x3a3cbf(0x150c)+_0x49f635(_0x4a9bd7[_0x3a3cbf(0x13f9)]())['replace'](/\n/g,_0x3a3cbf(0x609))+'</span>';})[_0x54cedc(0x3b9)]('');}else{if(_0x3ace40['type']===_0x54cedc(0x721))_0xc23e2e['classList'][_0x54cedc(0xe05)](_0x54cedc(0xb6b),_0x54cedc(0xf09)),_0x5745c2=_0x54cedc(0xaba)+_0x3ace40[_0x54cedc(0xd73)]+_0x54cedc(0x5a7)+(_0x3ace40['title']||_0x54cedc(0x7c6))+'</div><div\x20class=\x22description\x22>'+(_0x3ace40['description']||_0x54cedc(0x5ec))+_0x54cedc(0x128e)+(_0x3ace40[_0x54cedc(0xc48)]||_0x54cedc(0xc9c))+_0x54cedc(0x579);else{if(_0x3ace40[_0x54cedc(0x1508)]==='share_card')_0xc23e2e[_0x54cedc(0x4d8)][_0x54cedc(0xe05)](_0x54cedc(0xb6b),_0x54cedc(0xf09)),_0x5745c2=_0x54cedc(0x10ab)+_0x3ace40[_0x54cedc(0xd73)]+'\x22><div\x20class=\x22title\x22>'+_0x3ace40['payload'][_0x54cedc(0x10b8)]+_0x54cedc(0x23e)+_0x3ace40[_0x54cedc(0x8b5)][_0x54cedc(0x1396)][_0x54cedc(0x106b)]+_0x54cedc(0x4c2);else{if(_0x3ace40['type']===_0x54cedc(0x12cc)){_0xc23e2e[_0x54cedc(0x4d8)]['add'](_0x54cedc(0x12a2),_0x54cedc(0xf09));let _0x58e4c7;if(_0x3ace40['imageUrl'])_0x58e4c7=_0x3ace40[_0x54cedc(0xbfe)];else _0x19ddb8[_0x54cedc(0x4c8)]['enableAiDrawing']&&_0x3ace40[_0x54cedc(0xb95)]?_0x58e4c7=_0x54cedc(0x10a3)+encodeURIComponent(_0x3ace40[_0x54cedc(0xb95)]):_0x58e4c7=_0x54cedc(0xc0d);const _0x455706=_0x54cedc(0xa67)+_0x58e4c7+_0x54cedc(0x643);_0x5745c2=_0x54cedc(0x6ff)+_0x3ace40[_0x54cedc(0x4e3)]+_0x54cedc(0x2c6)+_0x455706+_0x54cedc(0xebd);}else{if(_0x3ace40[_0x54cedc(0x1508)]===_0x54cedc(0x9ee)||_0x3ace40[_0x54cedc(0x1508)]===_0x54cedc(0x1c1)){_0xc23e2e[_0x54cedc(0x4d8)]['add'](_0x54cedc(0x447),_0x54cedc(0xf09));const _0x306aa4=_0x3ace40['type']==='user_photo'?_0x54cedc(0xe3c):'AI生成的图片',_0x72e789=_0x19ddb8[_0x54cedc(0x4c8)][_0x54cedc(0x853)]&&_0x3ace40[_0x54cedc(0xb95)]?_0x54cedc(0x10a3)+_0x3ace40[_0x54cedc(0xb95)]:_0x54cedc(0x273);_0x5745c2='<img\x20src=\x22'+_0x72e789+_0x54cedc(0x52e)+_0x306aa4+_0x54cedc(0x940)+_0x3ace40[_0x54cedc(0x4e3)]+'\x22>';}else{if(_0x3ace40['type']===_0x54cedc(0x1300))_0xc23e2e[_0x54cedc(0x4d8)][_0x54cedc(0xe05)](_0x54cedc(0xbbf),_0x54cedc(0xf09)),_0x5745c2='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nai-image-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x3ace40[_0x54cedc(0xbfe)]+_0x54cedc(0x1d0)+(_0x3ace40[_0x54cedc(0x5d7)]||_0x3ace40['prompt']||_0x54cedc(0x1119))+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22nai-regenerate-btn\x22\x20title=\x22重新生成\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20\x2011A8.1\x208.1\x200\x200\x200\x204.5\x209M4\x205v4h4\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222.5\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M4\x2013a8.1\x208.1\x200\x200\x200\x2015.5\x202m.5\x204v-4h-4\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222.5\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';else{if(_0x3ace40[_0x54cedc(0x1508)]===_0x54cedc(0x1207)){_0xc23e2e[_0x54cedc(0x4d8)][_0x54cedc(0xe05)](_0x54cedc(0x1033),'is-card-like');const _0x3630b1=Math['max'](0x1,Math[_0x54cedc(0xb9d)]((_0x3ace40[_0x54cedc(0x4e3)]||'')[_0x54cedc(0x106b)]/0x5)),_0x29539d='0:'+String(_0x3630b1)[_0x54cedc(0x1488)](0x2,'0')+'\x27\x27',_0x3dddb4=_0x54cedc(0x74f);if(_0xdb168e)_0x5745c2=_0x54cedc(0xef1)+encodeURIComponent(_0x3ace40[_0x54cedc(0x4e3)])+_0x54cedc(0x195)+_0x3dddb4+_0x54cedc(0xca8)+_0x29539d+_0x54cedc(0xc38);else{const _0x49b3e2=!_0x13eb4c[_0x54cedc(0x136b)]&&_0x13eb4c[_0x54cedc(0x450)][_0x54cedc(0x1547)]!==![],_0x285ed3=_0x13eb4c['settings'][_0x54cedc(0x551)]||_0x54cedc(0xe53),_0x5589e7=_0x49b3e2?'data-voice-id=\x22'+_0x285ed3+'\x22':'';_0x5745c2=_0x54cedc(0xef1)+encodeURIComponent(_0x3ace40[_0x54cedc(0x4e3)])+'\x22\x20'+_0x5589e7+_0x54cedc(0x30b)+_0x3dddb4+_0x54cedc(0xb23)+_0x29539d+_0x54cedc(0xc38);}}else{if(_0x3ace40[_0x54cedc(0x1508)]===_0x54cedc(0x4b3)){_0xc23e2e[_0x54cedc(0x4d8)][_0x54cedc(0xe05)](_0x54cedc(0x13f2),_0x54cedc(0xf09));let _0x26b340,_0x16134e;const _0x7dde0c=_0x13eb4c[_0x54cedc(0x136b)]?_0x13eb4c[_0x54cedc(0x450)]['myNickname']||'我':'我',_0x15f839=_0x1e2056(_0x13eb4c,_0x3ace40[_0x54cedc(0x1043)]),_0x285a52=_0x1e2056(_0x13eb4c,_0x3ace40[_0x54cedc(0x13e2)]||_0x13eb4c[_0x54cedc(0x1561)]);if(_0xdb168e){if(_0x3ace40[_0x54cedc(0x392)])_0x26b340='退款给\x20'+_0x285a52,_0x16134e=_0x54cedc(0x1175);else{_0x26b340=_0x54cedc(0x833)+_0x285a52;if(_0x3ace40[_0x54cedc(0x27d)]==='accepted')_0x16134e=_0x54cedc(0x484);else{if(_0x3ace40['status']===_0x54cedc(0x900))_0x16134e=_0x54cedc(0x64f);else _0x16134e=_0x3ace40[_0x54cedc(0x1436)]||_0x54cedc(0xd53);}}}else{if(_0x3ace40[_0x54cedc(0x392)])_0x26b340=_0x54cedc(0x6d8)+_0x15f839,_0x16134e='转账已被拒收';else{if(_0x3ace40[_0x54cedc(0x13e2)]===_0x7dde0c){_0x26b340='转账给\x20'+_0x7dde0c;if(_0x3ace40['status']===_0x54cedc(0x967))_0x16134e='你已收款';else{if(_0x3ace40['status']===_0x54cedc(0x900))_0x16134e=_0x54cedc(0xbce);else _0xc23e2e['style'][_0x54cedc(0x1539)]='pointer',_0xc23e2e[_0x54cedc(0xd8d)][_0x54cedc(0x27d)]=_0x54cedc(0x550),_0x16134e=_0x3ace40[_0x54cedc(0x1436)]||'点击处理';}}else _0x26b340=_0x54cedc(0x13cc)+_0x15f839+'\x20→\x20'+_0x285a52,_0x16134e=_0x3ace40['note']||'群聊内转账';}}const _0x5df86c=_0x54cedc(0x559);_0x5745c2='<div\x20class=\x22transfer-card\x22><div\x20class=\x22transfer-title\x22>'+_0x5df86c+'\x20'+_0x26b340+_0x54cedc(0xd42)+Number(_0x3ace40[_0x54cedc(0x11fa)])[_0x54cedc(0x1322)](0x2)+_0x54cedc(0x3c8)+_0x16134e+_0x54cedc(0xf8a);}else{if(_0x3ace40[_0x54cedc(0x1508)]===_0x54cedc(0x12ec)){_0xc23e2e[_0x54cedc(0x4d8)][_0x54cedc(0xe05)](_0x54cedc(0x2b2),_0x54cedc(0xf09));if(_0x3ace40[_0x54cedc(0x27d)]===_0x54cedc(0x82e)||_0x3ace40[_0x54cedc(0x27d)]===_0x54cedc(0x17a))_0xc23e2e[_0x54cedc(0x4d8)][_0x54cedc(0xe05)](_0x54cedc(0x428)+_0x3ace40[_0x54cedc(0x27d)]);const _0xeea6f=_0x1e2056(_0x13eb4c,_0x3ace40[_0x54cedc(0x1043)]),_0x4c16cb='来自\x20'+_0xeea6f+_0x54cedc(0xc28);let _0x1a2197='';_0x3ace40[_0x54cedc(0x27d)]===_0x54cedc(0x550)&&!_0xdb168e&&(_0x1a2197='<div\x20class=\x22waimai-user-actions\x22><button\x20class=\x22waimai-decline-btn\x22\x20data-choice=\x22rejected\x22>残忍拒绝</button><button\x20class=\x22waimai-pay-btn\x22\x20data-choice=\x22paid\x22>为Ta买单</button></div>'),_0x5745c2='<div\x20class=\x22waimai-card\x22><div\x20class=\x22waimai-header\x22><img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22><div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div></div><div\x20class=\x22waimai-catchphrase\x22>Hi，你和我的距离只差一顿外卖～</div><div\x20class=\x22waimai-main\x22><div\x20class=\x22request-title\x22>'+_0x4c16cb+_0x54cedc(0xa8d)+Number(_0x3ace40[_0x54cedc(0x11fa)])[_0x54cedc(0x1322)](0x2)+_0x54cedc(0xb68)+_0x3ace40[_0x54cedc(0xd73)]+_0x54cedc(0x6e5)+_0x1a2197+_0x54cedc(0x826),setTimeout(()=>{const _0x5b10d3=_0x54cedc;if(_0x3ace40[_0x5b10d3(0x27d)]===_0x5b10d3(0x550)){const _0x18a7c4=document[_0x5b10d3(0x9a3)](_0x5b10d3(0x269)+_0x3ace40[_0x5b10d3(0xd73)]);if(_0x18a7c4){const _0x2c945d=_0x3f2dec(_0x18a7c4,_0x3ace40[_0x5b10d3(0x14da)]);_0x140400[_0x3ace40[_0x5b10d3(0xd73)]]=_0x2c945d;}}},0x0);}else{if(_0x3ace40[_0x54cedc(0x1508)]==='waimai_order'){_0xc23e2e[_0x54cedc(0x4d8)][_0x54cedc(0xe05)](_0x54cedc(0x2b2),_0x54cedc(0xf09));const _0x277b7a=_0x1e2056(_0x13eb4c,_0x3ace40[_0x54cedc(0x1043)]);let _0x2342dc='你';_0x13eb4c[_0x54cedc(0x136b)]&&(_0x2342dc=_0x1e2056(_0x13eb4c,_0x3ace40[_0x54cedc(0xa6b)])),_0x5745c2=_0x54cedc(0x33d)+_0x277b7a+'\x20已为'+_0x2342dc+_0x54cedc(0xa8a)+_0x3ace40[_0x54cedc(0xd97)]+_0x54cedc(0x11ca)+Number(_0x3ace40[_0x54cedc(0x11fa)])[_0x54cedc(0x1322)](0x2)+_0x54cedc(0x433);}else{if(_0x3ace40[_0x54cedc(0x1508)]===_0x54cedc(0x552)){_0xc23e2e[_0x54cedc(0x4d8)][_0x54cedc(0xe05)](_0x54cedc(0x8a3),_0x54cedc(0xf09));const _0x366f95=_0x19ddb8[_0x54cedc(0x9ce)][_0x54cedc(0x246)]||_0x54cedc(0x15c8),_0x271366=_0x3ace40['isFullyClaimed'],_0x3dc08a=_0x3ace40[_0x54cedc(0x2f5)]&&_0x3ace40[_0x54cedc(0x2f5)][_0x366f95];let _0xcd93e4='',_0x18e649='',_0x4f1c20=_0x54cedc(0xb84);_0x271366&&(_0xcd93e4='opened');if(_0x3ace40[_0x54cedc(0x4ee)]===_0x54cedc(0x93c)){const _0x43382e=_0x1e2056(_0x13eb4c,_0x3ace40['receiverName']);_0x4f1c20=_0x54cedc(0x918)+_0x43382e;if(Object['keys'](_0x3ace40[_0x54cedc(0x2f5)]||{})[_0x54cedc(0x106b)]>0x0)_0xcd93e4=_0x54cedc(0x966);}if(_0x3dc08a){const _0x16c076=_0x3ace40[_0x54cedc(0x2f5)][_0x366f95]||0x0;_0x18e649=_0x54cedc(0x4ba)+_0x16c076[_0x54cedc(0x1322)](0x2)+'\x20元</div>';}else{if(_0x271366)_0x18e649=_0x54cedc(0x794);else{if(_0x3ace40['packetType']==='direct'&&Object[_0x54cedc(0x2d0)](_0x3ace40['claimedBy']||{})['length']>0x0){const _0x5decdc=_0x1e2056(_0x13eb4c,_0x3ace40[_0x54cedc(0x13e2)]);_0x18e649=_0x54cedc(0xc90)+_0x5decdc+_0x54cedc(0x74a);}}}_0x5745c2=_0x54cedc(0xd92)+_0xcd93e4+_0x54cedc(0x575)+(_0x3ace40['greeting']||'恭喜发财，大吉大利！')+'</span></div><div\x20class=\x22rp-type\x22>'+_0x4f1c20+'</div>'+_0x18e649+_0x54cedc(0x826);}else{if(_0x3ace40['type']===_0x54cedc(0x3e6)){_0xc23e2e[_0x54cedc(0x4d8)][_0x54cedc(0xe05)](_0x54cedc(0x889),_0x54cedc(0xf09));const _0x28e3ab=_0x3ace40['question']||_0x3ace40['content']||_0x54cedc(0x1333);let _0x748b66=0x0;const _0x1d8960={};for(const _0x4048ea in _0x3ace40[_0x54cedc(0xa71)]){const _0x2ae596=_0x3ace40[_0x54cedc(0xa71)][_0x4048ea][_0x54cedc(0x106b)];_0x1d8960[_0x4048ea]=_0x2ae596,_0x748b66+=_0x2ae596;}const _0x988244=_0x19ddb8[_0x54cedc(0x9ce)][_0x54cedc(0x246)]||_0x54cedc(0x15c8);let _0x31eb02=null;for(const _0x525d25 in _0x3ace40[_0x54cedc(0xa71)]){if(_0x3ace40[_0x54cedc(0xa71)][_0x525d25][_0x54cedc(0x478)](_0x988244)){_0x31eb02=_0x525d25;break;}}let _0x27b1df=_0x54cedc(0x308);_0x3ace40[_0x54cedc(0x11c2)][_0x54cedc(0x15c1)](_0x191d7b=>{const _0x58f5e3=_0x54cedc,_0x44efb4=_0x1d8960[_0x191d7b]||0x0,_0x5afc7f=_0x748b66>0x0?_0x44efb4/_0x748b66*0x64:0x0,_0x4bc89d=_0x31eb02===_0x191d7b;_0x27b1df+=_0x58f5e3(0xa72)+(_0x4bc89d?_0x58f5e3(0x7dc):'')+_0x58f5e3(0x245)+_0x191d7b+_0x58f5e3(0x7fa)+_0x5afc7f+_0x58f5e3(0x14c2)+_0x191d7b+'</span><span\x20class=\x22poll-option-votes\x22>'+_0x44efb4+_0x58f5e3(0xaf7);}),_0x27b1df+=_0x54cedc(0x826);let _0x254362=_0x3ace40[_0x54cedc(0x13ae)]?_0x54cedc(0xcef)+_0x748b66+'\x20人投票</span><button\x20class=\x22poll-action-btn\x22>查看结果</button></div>':_0x54cedc(0xcef)+_0x748b66+_0x54cedc(0x648);_0x5745c2=_0x54cedc(0x1084)+(_0x3ace40[_0x54cedc(0x13ae)]?_0x54cedc(0x8e3):'')+_0x54cedc(0x6cd)+_0x3ace40[_0x54cedc(0xd73)]+_0x54cedc(0xb71)+_0x28e3ab+_0x54cedc(0x826)+_0x27b1df+_0x254362+_0x54cedc(0x826);}else{if(_0x3ace40[_0x54cedc(0x1508)]==='gift'){_0xc23e2e[_0x54cedc(0x4d8)]['add'](_0x54cedc(0x276),'is-card-like');let _0x25527b;const _0x50b29d=_0x13eb4c['settings'][_0x54cedc(0x1555)]||'我';if(_0x13eb4c['isGroup']){if(_0x3ace40['recipients']&&_0x3ace40[_0x54cedc(0x6d2)][_0x54cedc(0x106b)]>0x0){const _0x323335=_0x3ace40[_0x54cedc(0x6d2)][_0x54cedc(0xb0a)](_0x1c20fe=>_0x1e2056(_0x13eb4c,_0x1c20fe));_0x323335[_0x54cedc(0x106b)]===0x1?_0x25527b=_0x54cedc(0x9c5)+_0x323335[0x0]+'\x20的礼物':_0x25527b='送给\x20'+_0x323335[_0x54cedc(0x457)](0x0,0x2)[_0x54cedc(0x3b9)]('、')+_0x54cedc(0xa49);}else _0x25527b=_0x54cedc(0x748);}else{if(_0xdb168e)_0x25527b=_0x54cedc(0x9c5)+_0x13eb4c[_0x54cedc(0x1561)]+'\x20的礼物';else{const _0x795a04=_0x13eb4c[_0x54cedc(0x450)][_0x54cedc(0x1555)]||'你';_0x25527b=_0x54cedc(0x9c5)+_0x795a04+_0x54cedc(0xfc0);}}const _0x47af05=_0x3ace40[_0x54cedc(0x1489)][_0x54cedc(0x457)](0x0,0x3);let _0x34ae07='';_0x47af05[_0x54cedc(0x15c1)](_0x2f198b=>{const _0x3f8908=_0x54cedc;_0x34ae07+=_0x3f8908(0x1160)+_0x2f198b[_0x3f8908(0xbfe)]+_0x3f8908(0xc14)+_0x2f198b[_0x3f8908(0x1561)]+'</span><span\x20class=\x22gift-preview-quantity\x22>x'+_0x2f198b[_0x3f8908(0x1485)]+'</span></div>';});let _0x3d3151='';_0x3ace40['items']['length']>0x3&&(_0x3d3151='\x20等'+_0x3ace40[_0x54cedc(0x1489)]['length']+_0x54cedc(0xcdc)),_0x5745c2=_0x54cedc(0x35c)+_0x25527b+_0x54cedc(0x652)+_0x34ae07+_0x54cedc(0x1497)+_0x3ace40[_0x54cedc(0x1489)][_0x54cedc(0x106b)]+_0x54cedc(0xcdc)+_0x3d3151+_0x54cedc(0x12e6);}}}}}}}}}}}}}}else{const _0x307bf5=String(_0x4b76db);let _0x289ff0=await _0x5ec228(_0x307bf5,_0x13eb4c['id']);if(_0x289ff0!==_0x307bf5)_0x5745c2=_0x289ff0,_0xc23e2e[_0x54cedc(0x4d8)][_0x54cedc(0xe05)](_0x54cedc(0xf09));else{if(Array[_0x54cedc(0xb9b)](_0x3ace40[_0x54cedc(0x4e3)])&&_0x3ace40[_0x54cedc(0x4e3)][0x0]?.['type']===_0x54cedc(0xae0)){const _0x268bbf=_0x3ace40[_0x54cedc(0x4e3)][0x0][_0x54cedc(0xae0)][_0x54cedc(0x121f)];_0x5745c2=_0x54cedc(0x887)+_0x268bbf+_0x54cedc(0x993);}else{if(_0x115b0e[_0x54cedc(0xddf)](_0x289ff0))_0xc23e2e['classList']['add'](_0x54cedc(0x8c0),_0x54cedc(0xf09)),_0x5745c2=_0x54cedc(0x887)+_0x289ff0+_0x54cedc(0x12df)+(_0x3ace40[_0x54cedc(0x7da)]||_0x54cedc(0xe6a))+_0x54cedc(0x899);else{let _0x5c7c04=_0x8888da(_0x289ff0,_0x13eb4c);_0x5745c2=_0x49f635(_0x5c7c04)[_0x54cedc(0x1bb)](/\n/g,_0x54cedc(0x609));}}}}}_0xc23e2e['innerHTML']=_0x54cedc(0x127e)+_0x58628a+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x11432+_0x54cedc(0xc72)+_0x5745c2+_0x54cedc(0x14dc),_0x488ac0[_0x54cedc(0x983)](_0xc23e2e),_0x488ac0[_0x54cedc(0x983)](_0x24df8d),_0x1a651b(_0x488ac0,()=>_0x12c32b(_0x3ace40['timestamp'])),_0x488ac0['addEventListener']('click',()=>{const _0x5755da=_0x54cedc;if(_0x164883)_0x27fede(_0x3ace40[_0x5755da(0xd73)]);});if(!_0xdb168e){const _0x31b02d=_0x488ac0[_0x54cedc(0xc86)](_0x54cedc(0x6da));_0x31b02d&&(_0x31b02d[_0x54cedc(0x20f)]['cursor']=_0x54cedc(0xc36),!_0x13eb4c['isGroup']?_0x31b02d[_0x54cedc(0x954)](_0x54cedc(0x9cc),_0x5bbb84=>{const _0x7079de=_0x54cedc;_0x5bbb84[_0x7079de(0x63a)](),_0x53d640(_0x13eb4c['id']);}):_0x31b02d[_0x54cedc(0x954)](_0x54cedc(0x23a),_0x27cbc8=>{const _0x19f8ed=_0x54cedc;_0x27cbc8[_0x19f8ed(0x63a)](),_0x2462b3(_0x13eb4c['id'],_0x3ace40[_0x19f8ed(0x1043)]);}));}return _0x488ac0;}async function _0x3bfc05(_0x1318ff,_0x29e438){const _0x323ba4=_0x48bc6d,_0x1ff11=document[_0x323ba4(0x9a3)](_0x323ba4(0x10f8)),_0x54adf1=await _0xb42d69(_0x1318ff,_0x29e438);if(!_0x54adf1)return;const _0x5951de=document[_0x323ba4(0x9a3)]('load-more-btn');_0x5951de?_0x1ff11[_0x323ba4(0x11c8)](_0x54adf1,_0x5951de[_0x323ba4(0x3c3)]):_0x1ff11[_0x323ba4(0xfff)](_0x54adf1);}async function _0x1ef393(_0xc66f36,_0xdaa262,_0x32ac77=![]){const _0x5345ca=_0x48bc6d,_0x3c486f=document[_0x5345ca(0x9a3)](_0x5345ca(0x10f8)),_0x1e57a5=document[_0x5345ca(0x9a3)](_0x5345ca(0x77f)),_0x2c38fe=_0xdaa262[_0x5345ca(0x1f0)]['filter'](_0x4cea47=>!_0x4cea47[_0x5345ca(0x136e)])[_0x5345ca(0x144a)]();if(_0x2c38fe&&_0xc66f36[_0x5345ca(0xd73)]-_0x2c38fe[_0x5345ca(0xd73)]>0x927c0){const _0x5a4f2f=_0x17d417(_0xc66f36[_0x5345ca(0xd73)]);_0x3c486f['insertBefore'](_0x5a4f2f,_0x1e57a5);}const _0x22b6aa=await _0xb42d69(_0xc66f36,_0xdaa262);if(!_0x22b6aa)return;_0xc66f36[_0x5345ca(0x11c1)]==='assistant'&&!_0x32ac77&&_0x5bda2f();!_0x32ac77&&_0x22b6aa['classList']['add'](_0x5345ca(0xa36));_0x3c486f[_0x5345ca(0x11c8)](_0x22b6aa,_0x1e57a5);const _0x2d712e=_0x22b6aa[_0x5345ca(0xc86)]('img.sticker-image,\x20img.chat-image,\x20img.ai-generated-image,\x20img.realimag-image');_0x2d712e?(_0x2d712e[_0x5345ca(0xdd7)]=()=>{const _0x1ae3bc=_0x5345ca;console[_0x1ae3bc(0xe4d)](_0x1ae3bc(0xe25)),_0x3c486f[_0x1ae3bc(0x85c)]=_0x3c486f[_0x1ae3bc(0x13b7)];},_0x2d712e[_0x5345ca(0xb8b)]=()=>{const _0x55d357=_0x5345ca;console[_0x55d357(0x651)](_0x55d357(0x1279)),_0x3c486f[_0x55d357(0x85c)]=_0x3c486f[_0x55d357(0x13b7)];},_0x2d712e[_0x5345ca(0x150a)]&&(console[_0x5345ca(0xe4d)](_0x5345ca(0xbf0)),_0x3c486f['scrollTop']=_0x3c486f[_0x5345ca(0x13b7)])):!_0x32ac77&&(_0x3c486f[_0x5345ca(0x85c)]=_0x3c486f[_0x5345ca(0x13b7)]);}async function _0x515d83(_0x3e2b02){const _0x41144b=_0x48bc6d;_0x19ddb8[_0x41144b(0x859)]=_0x3e2b02;const _0x157c7d=_0x19ddb8[_0x41144b(0xb04)][_0x3e2b02];if(!_0x157c7d)return;_0x157c7d[_0x41144b(0xe20)]>0x0&&(_0x157c7d['unreadCount']=0x0,await _0x512070['chats'][_0x41144b(0xd4d)](_0x157c7d));_0x11947f(_0x157c7d),_0x56abd7(_0x3e2b02),_0x35df44('chat-interface-screen'),window['updateListenTogetherIconProxy'](_0x19ddb8['activeChatId']);const _0x4b3c52=_0x157c7d[_0x41144b(0x136b)]||![];_0x1252c6(_0x4b3c52),document[_0x41144b(0x9a3)]('show-announcement-board-btn')[_0x41144b(0x20f)][_0x41144b(0x115d)]=_0x4b3c52?_0x41144b(0x79c):_0x41144b(0x8e0);const _0x430b3f=document['getElementById']('pat-btn');_0x430b3f&&(_0x430b3f[_0x41144b(0x20f)]['display']=_0x4b3c52?_0x41144b(0x8e0):_0x41144b(0x79c));const _0x1998d5=document['getElementById'](_0x41144b(0x3a8)),_0xd501a3=document['getElementById'](_0x41144b(0x1242)),_0x22e4ec=document['getElementById'](_0x41144b(0x62e)),_0x58f23a=document[_0x41144b(0x9a3)](_0x41144b(0xc43));_0xd501a3&&_0x22e4ec&&_0x58f23a&&_0x1998d5&&(_0xd501a3['style'][_0x41144b(0x115d)]=_0x41144b(0x79c),_0x22e4ec[_0x41144b(0x20f)][_0x41144b(0x115d)]=_0x4b3c52?_0x41144b(0x8e0):_0x41144b(0x79c),_0x58f23a['style']['display']=_0x4b3c52?_0x41144b(0x79c):_0x41144b(0x8e0),_0x1998d5[_0x41144b(0x20f)]['display']=_0x4b3c52?_0x41144b(0x8e0):'flex'),_0x14e2fe(),!_0x157c7d[_0x41144b(0x136b)]&&_0x157c7d[_0x41144b(0x239)]?.[_0x41144b(0x27d)]===_0x41144b(0xfd1)&&(console[_0x41144b(0xe4d)](_0x41144b(0x14f5)+_0x157c7d[_0x41144b(0x1561)]+_0x41144b(0x1556)),_0x55bf11()),document[_0x41144b(0x9a3)]('send-poll-btn')['style'][_0x41144b(0x115d)]=_0x4b3c52?'flex':'none',document['body'][_0x41144b(0x4d8)][_0x41144b(0x133d)]('chat-actions-expanded');}function _0x4fad07(_0x5c4e89,_0x3a12c8){const _0x5e5d8b=_0x48bc6d,_0xd76958=_0x3a12c8?_0x5e5d8b(0xe05):_0x5e5d8b(0x133d),_0xdefb39=_0x44992f=>{const _0x33eae0=_0x5e5d8b;_0x44992f&&_0x44992f[_0x33eae0(0x4d8)][_0xd76958](_0x33eae0(0x353));},_0x3d2d8d=document['querySelector']('.chat-list-item[data-chat-id=\x22'+_0x5c4e89+_0x5e5d8b(0xeab));_0xdefb39(_0x3d2d8d);const _0x5bf00d=document[_0x5e5d8b(0x131c)](_0x5e5d8b(0xfde)+_0x5c4e89+'\x22]');_0x5bf00d['forEach'](_0xdefb39);const _0x2d82f3=document[_0x5e5d8b(0xc86)]('.participant-avatar[data-participant-id=\x22'+_0x5c4e89+'\x22]');_0xdefb39(_0x2d82f3);}async function _0x2ec49e(){const _0x3d2883=_0x48bc6d;if(!_0x19ddb8['activeChatId'])return;const _0x28cbc2=_0x19ddb8[_0x3d2883(0x859)],_0x389fdb=_0x19ddb8[_0x3d2883(0xb04)][_0x28cbc2];lastRawAiResponse='',lastResponseTimestamps=[];const _0x498e50=document[_0x3d2883(0x9a3)](_0x3d2883(0x355));_0x498e50&&(_0x498e50[_0x3d2883(0x15d3)]=!![],_0x498e50[_0x3d2883(0x766)]=_0x3d2883(0x15cf));_0x4fad07(_0x28cbc2,!![]);try{const {proxyUrl:_0x50eb52,apiKey:_0x5afcbd,model:_0x5c849d}=_0x19ddb8[_0x3d2883(0xd22)];if(!_0x50eb52||!_0x5afcbd||!_0x5c849d)throw new Error('API未配置，无法生成对话。');const _0x36f305=parseInt(_0x389fdb[_0x3d2883(0x450)]['maxMemory'])||0xa,_0xa4d067=_0x389fdb[_0x3d2883(0x1f0)][_0x3d2883(0x457)](-_0x36f305);let _0x3c31a6='';if(_0x389fdb[_0x3d2883(0x450)]['linkedWorldBookIds']&&_0x389fdb[_0x3d2883(0x450)]['linkedWorldBookIds'][_0x3d2883(0x106b)]>0x0){const _0x469bb=_0x389fdb[_0x3d2883(0x450)][_0x3d2883(0x9c4)][_0x3d2883(0xb0a)](_0x1794da=>{const _0x1241c6=_0x3d2883,_0x1bedd5=_0x19ddb8[_0x1241c6(0x8e4)][_0x1241c6(0xd62)](_0x5c369f=>_0x5c369f['id']===_0x1794da);if(!_0x1bedd5||!Array[_0x1241c6(0xb9b)](_0x1bedd5[_0x1241c6(0x4e3)]))return'';const _0x544460=_0x1bedd5[_0x1241c6(0x4e3)][_0x1241c6(0x1195)](_0x14ac1a=>_0x14ac1a[_0x1241c6(0x15cd)]!==![])['map'](_0x228a29=>{const _0x8fc521=_0x1241c6;let _0x59812e=_0x8fc521(0xc4e)+(_0x228a29[_0x8fc521(0x79d)]||_0x8fc521(0xbcc))+'\x0a';if(_0x228a29['keys'][_0x8fc521(0x106b)]>0x0)_0x59812e+=_0x8fc521(0x1092)+_0x228a29[_0x8fc521(0x2d0)][_0x8fc521(0x3b9)](',\x20')+'\x0a';return _0x59812e+='**内容:**\x0a'+_0x228a29[_0x8fc521(0x4e3)],_0x59812e;})[_0x1241c6(0x3b9)]('');return _0x544460?_0x1241c6(0xe9b)+_0x1bedd5[_0x1241c6(0x1561)]+'\x0a'+_0x544460:'';})['filter'](Boolean)[_0x3d2883(0x3b9)]('');_0x469bb&&(_0x3c31a6=_0x3d2883(0x102c)+_0x469bb+_0x3d2883(0x951));}let _0x28bb61=_0x3d2883(0xc60),_0x356474=![];_0x389fdb[_0x3d2883(0xcca)][_0x3d2883(0x15c1)](_0x2b6597=>{const _0x3992d=_0x3d2883,_0x37be8e=_0x19ddb8['chats'][_0x2b6597['id']];_0x37be8e&&_0x37be8e[_0x3992d(0x744)]&&_0x37be8e['longTermMemory'][_0x3992d(0x106b)]>0x0&&(_0x28bb61+=_0x3992d(0x9d0)+_0x2b6597[_0x3992d(0xaf0)]+_0x3992d(0xaf5),_0x28bb61+=_0x37be8e[_0x3992d(0x744)][_0x3992d(0xb0a)](_0x2e2c62=>_0x3992d(0x2ee)+_0x5d6abc(_0x2e2c62['timestamp'])+')\x20'+_0x2e2c62[_0x3992d(0x4e3)])[_0x3992d(0x3b9)]('\x0a'),_0x356474=!![]);});!_0x356474&&(_0x28bb61+='-\x20(暂无)');let _0x130de3='';const _0x101860=_0x389fdb['settings'][_0x3d2883(0xb09)]||0xa;if(_0x389fdb['settings'][_0x3d2883(0x120e)]&&_0x389fdb[_0x3d2883(0x450)][_0x3d2883(0x120e)][_0x3d2883(0x106b)]>0x0){}const _0x25e125=_0x389fdb[_0x3d2883(0xcca)][_0x3d2883(0xb0a)](_0x288e1d=>'-\x20**'+_0x288e1d['groupNickname']+_0x3d2883(0xb33)+_0x288e1d[_0x3d2883(0x339)]+_0x3d2883(0x41b)+_0x288e1d[_0x3d2883(0xcd4)])['join']('\x0a'),_0x44a664=_0x50f06c(_0x389fdb),_0x3b82cc=_0x3d2883(0x14c0)+_0x389fdb[_0x3d2883(0x1561)]+'”的群聊中的对话。这个群聊里【没有用户】，所有成员都是你扮演的角色。你的任务是让他们之间进行一场生动、自然的对话。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20字段和\x20\x22name\x22\x20字段（角色的【本名】）。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**【角色间互动\x20(最重要!)】**:\x20你的核心是创作一场“戏”。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别自言自语的独白。\x0a2.\x20\x20**【禁止出戏】**:\x20绝不能透露你是AI、模型或剧本作家。\x0a3.\x20\x20**【主动性】**:\x20角色们应该主动使用各种功能（发表情、发语音、分享图片等）来让对话更生动，而不是仅仅发送文字。\x0a4.请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20可用指令列表\x20(你现在可以使用所有这些功能！)\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20'+_0x389fdb[_0x3d2883(0x1561)]+_0x3d2883(0x84a)+_0x28bb61+'\x0a'+_0x3c31a6+'\x0a'+_0x130de3+'\x0a-\x20**这是你们最近的对话历史**:\x0a'+_0xa4d067['map'](_0x1d0715=>_0x1e2056(_0x389fdb,_0x1d0715[_0x3d2883(0x1043)])+':\x20'+_0x1d0715[_0x3d2883(0x4e3)])[_0x3d2883(0x3b9)]('\x0a')+'\x0a\x0a#\x20群成员列表及人设\x20(你扮演的所有角色)\x0a'+_0x25e125+_0x3d2883(0x1052)+_0x44a664+_0x3d2883(0xd65),_0x5a640b=_0xa4d067[_0x3d2883(0xb0a)](_0x5996b0=>({'role':'user','content':_0x1e2056(_0x389fdb,_0x5996b0[_0x3d2883(0x1043)])+':\x20'+_0x5996b0[_0x3d2883(0x4e3)]}));let _0xbeb48d=_0x50eb52[_0x3d2883(0x478)](_0x3d2883(0x1f2)),_0x109642;if(_0xbeb48d){let _0x236f3e=_0x366263(_0x5c849d,_0x5afcbd,_0x3b82cc,_0x5a640b);_0x109642=await fetch(_0x236f3e['url'],_0x236f3e['data']);}else _0x109642=await fetch(_0x50eb52+_0x3d2883(0x501),{'method':_0x3d2883(0x12db),'headers':{'Content-Type':_0x3d2883(0xb1f),'Authorization':_0x3d2883(0x1265)+_0x5afcbd},'body':JSON[_0x3d2883(0xe1e)]({'model':_0x5c849d,'messages':[{'role':_0x3d2883(0xe10),'content':_0x3b82cc},..._0x5a640b],'temperature':_0x19ddb8[_0x3d2883(0x4c8)][_0x3d2883(0x4a2)]||0.9})});if(!_0x109642['ok']){const _0x1cf9b7=await _0x109642[_0x3d2883(0xa5d)]()[_0x3d2883(0x904)](()=>({'error':{'message':_0x109642[_0x3d2883(0x140e)]}}));throw new Error(_0x3d2883(0xbc6)+_0x109642[_0x3d2883(0x27d)]+'\x20-\x20'+(_0x1cf9b7[_0x3d2883(0x3b7)]?.['message']||'未知错误'));}const _0x13304c=await _0x109642[_0x3d2883(0xa5d)](),_0x4e9d91=getGeminiResponseText(_0x13304c);lastRawAiResponse=_0x4e9d91;const _0x1a2a4e=_0x189ab1(_0x4e9d91);let _0x421335=Date['now']();for(const _0x3b92ae of _0x1a2a4e){if(!_0x3b92ae||!_0x3b92ae[_0x3d2883(0x1508)]||!_0x3b92ae['name'])continue;let _0x60501a=null;const _0x558ee4=_0x421335++;lastResponseTimestamps['push'](_0x558ee4);const _0x5d71e1={'role':_0x3d2883(0x115c),'senderName':_0x3b92ae[_0x3d2883(0x1561)],'timestamp':_0x558ee4};switch(_0x3b92ae['type']){case _0x3d2883(0x13ca):_0x60501a={..._0x5d71e1,'content':_0x3b92ae[_0x3d2883(0x4e3)]};break;case'sticker':if(_0x3b92ae['meaning']){const _0x41a09a=_0x19ddb8['userStickers'][_0x3d2883(0xd62)](_0x5ff13d=>_0x5ff13d[_0x3d2883(0x1561)]===_0x3b92ae[_0x3d2883(0x7da)]);_0x41a09a?_0x60501a={..._0x5d71e1,'type':'sticker','content':_0x41a09a['url'],'meaning':_0x41a09a[_0x3d2883(0x1561)]}:(console['warn'](_0x3d2883(0x33f)+_0x3b92ae[_0x3d2883(0x7da)]+'\x22'),_0x60501a={..._0x5d71e1,'type':'text','content':_0x3d2883(0x22a)+_0x3b92ae[_0x3d2883(0x7da)]+']'});}else console[_0x3d2883(0x651)](_0x3d2883(0x1fd),_0x3b92ae);break;case _0x3d2883(0x1c1):_0x60501a={..._0x5d71e1,'type':_0x3d2883(0x1c1),'content':_0x3b92ae[_0x3d2883(0x3ef)],'image_prompt':_0x3b92ae[_0x3d2883(0xb95)]};break;case _0x3d2883(0x1207):_0x60501a={..._0x5d71e1,'type':_0x3d2883(0x1207),'content':_0x3b92ae[_0x3d2883(0x4e3)]};break;case _0x3d2883(0xe7b):const _0x17d646=_0x389fdb[_0x3d2883(0x1f0)][_0x3d2883(0xd62)](_0x1ce9ea=>_0x1ce9ea[_0x3d2883(0xd73)]===_0x3b92ae[_0x3d2883(0xd4b)]);_0x17d646?_0x60501a={..._0x5d71e1,'content':_0x3b92ae[_0x3d2883(0x69c)],'quote':{'timestamp':_0x17d646[_0x3d2883(0xd73)],'senderName':_0x17d646['senderName'],'content':String(_0x17d646[_0x3d2883(0x4e3)]||'')[_0x3d2883(0x72e)](0x0,0x32)}}:_0x60501a={..._0x5d71e1,'content':_0x3b92ae['reply_content']};break;default:console[_0x3d2883(0x651)](_0x3d2883(0xb98),_0x3b92ae[_0x3d2883(0x1508)]);continue;}_0x60501a&&(_0x389fdb[_0x3d2883(0x1f0)][_0x3d2883(0x1c4)](_0x60501a),_0x1ef393(_0x60501a,_0x389fdb),await new Promise(_0x5aa5cf=>setTimeout(_0x5aa5cf,Math[_0x3d2883(0xdcd)]()*0x4b0+0x320)));}await _0x512070[_0x3d2883(0xb04)]['put'](_0x389fdb),_0xec8072();}catch(_0x101a9e){console[_0x3d2883(0x3b7)](_0x3d2883(0x1273),_0x101a9e),await _0x403a62('操作失败',_0x3d2883(0xc7b)+_0x101a9e['message']);}finally{_0x498e50&&(_0x498e50[_0x3d2883(0x15d3)]=![],_0x498e50[_0x3d2883(0x766)]='🎬\x20推进剧情'),_0x4fad07(_0x28cbc2,![]);}}async function _0x55bf11(){const _0x23a5e0=_0x48bc6d;if(!_0x19ddb8['activeChatId'])return;const _0x1e2092=_0x19ddb8[_0x23a5e0(0x859)],_0x44ce48=_0x19ddb8['chats'][_0x19ddb8['activeChatId']],_0x4f0b87=document[_0x23a5e0(0x9a3)](_0x23a5e0(0x3e5))[_0x23a5e0(0x4d8)][_0x23a5e0(0x1222)]('active')&&_0x19ddb8[_0x23a5e0(0x859)]===_0x1e2092;_0x4fad07(_0x1e2092,!![]);const _0x1a0575=document[_0x23a5e0(0x9a3)](_0x23a5e0(0x991)),_0x55574c=document[_0x23a5e0(0x9a3)]('typing-indicator'),_0xd72672=document['querySelector']('.chat-list-item[data-chat-id=\x22'+_0x1e2092+'\x22]'),_0x3bbf3d=_0xd72672?_0xd72672[_0x23a5e0(0xc86)](_0x23a5e0(0x1380)):null;_0x3bbf3d&&_0x3bbf3d[_0x23a5e0(0x4d8)][_0x23a5e0(0xe05)]('is-acting');_0x44ce48[_0x23a5e0(0x136b)]?_0x55574c&&(_0x55574c[_0x23a5e0(0x766)]=_0x23a5e0(0xc99),_0x55574c[_0x23a5e0(0x20f)]['display']=_0x23a5e0(0x10c8)):_0x1a0575&&(_0x1a0575[_0x23a5e0(0x20f)][_0x23a5e0(0x71f)]=0x0,setTimeout(()=>{const _0xdc2bb=_0x23a5e0;_0x1a0575[_0xdc2bb(0x766)]=_0xdc2bb(0x419),_0x1a0575['classList'][_0xdc2bb(0xe05)]('typing-status'),_0x1a0575[_0xdc2bb(0x20f)]['opacity']=0x1;},0xc8));let _0x2d7ac5=![];try{const {proxyUrl:_0x29d171,apiKey:_0x502385,model:_0x2bc73b}=_0x19ddb8[_0x23a5e0(0xd22)];if(!_0x29d171||!_0x502385||!_0x2bc73b){alert(_0x23a5e0(0x500));if(_0x44ce48[_0x23a5e0(0x136b)]){if(_0x55574c)_0x55574c['style'][_0x23a5e0(0x115d)]='none';}else _0x1a0575&&_0x19ddb8[_0x23a5e0(0xb04)][_0x1e2092]&&(_0x1a0575[_0x23a5e0(0x766)]=_0x19ddb8[_0x23a5e0(0xb04)][_0x1e2092][_0x23a5e0(0x1561)],_0x1a0575[_0x23a5e0(0x4d8)][_0x23a5e0(0x133d)](_0x23a5e0(0x317)));return;}const _0x19f7d0=_0x44ce48[_0x23a5e0(0x1f0)]['slice'](-0x1)[0x0],_0x2e92ef=_0x19f7d0&&_0x19f7d0[_0x23a5e0(0x11c1)]==='system'&&_0x19f7d0[_0x23a5e0(0x4e3)]['includes']('视频通话请求');if(_0x2e92ef){console['log']('检测到视频通话请求，为角色\x20\x22'+_0x44ce48[_0x23a5e0(0x1561)]+_0x23a5e0(0x13b1));let _0x4ae095;_0x44ce48[_0x23a5e0(0x136b)]?_0x4ae095=_0x23a5e0(0x1134)+_0x44ce48[_0x23a5e0(0xcca)][_0x23a5e0(0xb0a)](_0x1607e3=>'-\x20'+_0x1607e3['groupNickname']+_0x23a5e0(0x1bd)+_0x1607e3[_0x23a5e0(0x339)]+_0x23a5e0(0x41b)+_0x1607e3[_0x23a5e0(0xcd4)])[_0x23a5e0(0x3b9)]('\x0a')+_0x23a5e0(0x1dd):_0x4ae095='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户刚刚向你发起了视频通话。请根据你的角色设定，决定是“接受”还是“拒绝”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x44ce48[_0x23a5e0(0x450)]['aiPersona']+_0x23a5e0(0xa12);const _0x14f688=[{'role':_0x23a5e0(0x20d),'content':_0x4ae095}];try{let _0x5e1d2d=_0x366263(_0x2bc73b,_0x502385,_0x4ae095,_0x14f688),_0x7aabef=_0x29d171===GEMINI_API_URL;const _0x2e9e79=_0x7aabef?await fetch(_0x5e1d2d[_0x23a5e0(0x121f)],_0x5e1d2d['data']):await fetch(_0x29d171+_0x23a5e0(0x501),{'method':_0x23a5e0(0x12db),'headers':{'Content-Type':_0x23a5e0(0xb1f),'Authorization':'Bearer\x20'+_0x502385},'body':JSON[_0x23a5e0(0xe1e)]({'model':_0x2bc73b,'messages':_0x14f688,'temperature':0.7})});if(!_0x2e9e79['ok'])throw new Error(_0x23a5e0(0x32d)+(await _0x2e9e79[_0x23a5e0(0xa5d)]())['error']['message']);const _0x2e37ca=await _0x2e9e79['json'](),_0x2ea2cf=getGeminiResponseText(_0x2e37ca),_0x3f77a7=_0x189ab1(_0x2ea2cf);let _0x576b3d=![];for(const _0x5f58ff of _0x3f77a7){if(_0x5f58ff[_0x23a5e0(0x1508)]===_0x23a5e0(0x344)){_0x4acdaf['isAwaitingResponse']=![];if(_0x5f58ff[_0x23a5e0(0x828)]===_0x23a5e0(0xa91))_0x1e2a5c();else{const _0x2c5637={'role':_0x23a5e0(0x115c),'content':_0x23a5e0(0x2d1),'timestamp':Date[_0x23a5e0(0x64b)]()};_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0x1c4)](_0x2c5637),await _0x512070['chats']['put'](_0x44ce48),_0x35df44(_0x23a5e0(0x3e5)),_0x56abd7(_0x1e2092);}_0x576b3d=!![];break;}if(_0x5f58ff[_0x23a5e0(0x1508)]===_0x23a5e0(0xea3)){if(_0x5f58ff[_0x23a5e0(0x828)]===_0x23a5e0(0x3b9)){const _0x56d031=_0x44ce48[_0x23a5e0(0xcca)][_0x23a5e0(0xd62)](_0x5688cf=>_0x5688cf[_0x23a5e0(0x339)]===_0x5f58ff['name']);_0x56d031&&!_0x4acdaf['participants']['some'](_0x3bcfb3=>_0x3bcfb3['id']===_0x56d031['id'])&&_0x4acdaf[_0x23a5e0(0x9d3)][_0x23a5e0(0x1c4)](_0x56d031);}_0x576b3d=!![];}}_0x576b3d&&_0x4acdaf[_0x23a5e0(0x6a0)]&&(_0x4acdaf[_0x23a5e0(0x62c)]=![],_0x4acdaf['participants']['length']>0x0?_0x1e2a5c():(_0x4acdaf={..._0x4acdaf,'isAwaitingResponse':![],'participants':[]},_0x35df44(_0x23a5e0(0x3e5)),alert('无人接听群聊邀请。')));}catch(_0x5331f6){console[_0x23a5e0(0x3b7)](_0x23a5e0(0xbed),_0x5331f6);const _0x26882a=_0x44ce48[_0x23a5e0(0x136b)]?_0x44ce48[_0x23a5e0(0xcca)][_0x23a5e0(0xb0a)](_0x196168=>({'type':_0x23a5e0(0xea3),'name':_0x196168[_0x23a5e0(0x339)],'decision':_0x23a5e0(0xf2e)})):[{'type':'video_call_response','decision':_0x23a5e0(0xbac)}];if(_0x44ce48['isGroup'])_0x4acdaf['isAwaitingResponse']=![],_0x4acdaf[_0x23a5e0(0x9d3)]=[],alert(_0x23a5e0(0xc04)),_0x35df44('chat-interface-screen');else{const _0x15cb95={'role':'assistant','content':_0x23a5e0(0x2d1),'timestamp':Date[_0x23a5e0(0x64b)]()};_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0x1c4)](_0x15cb95),await _0x512070[_0x23a5e0(0xb04)][_0x23a5e0(0xd4d)](_0x44ce48),_0x35df44(_0x23a5e0(0x3e5)),_0x56abd7(_0x1e2092);}}finally{_0x4fad07(_0x1e2092,![]);return;}}if(!_0x44ce48[_0x23a5e0(0x136b)]&&_0x44ce48[_0x23a5e0(0x239)]?.[_0x23a5e0(0x27d)]===_0x23a5e0(0xfd1)){console['log'](_0x23a5e0(0x1595)+_0x44ce48[_0x23a5e0(0x1561)]+'\x22\x20触发带理由的好友申请决策流程...');const _0x221962=_0x44ce48[_0x23a5e0(0x1f0)]['filter'](_0x59b134=>!_0x59b134[_0x23a5e0(0x136e)])[_0x23a5e0(0x457)](-0xa,-0x5)[_0x23a5e0(0xb0a)](_0x56d51a=>{const _0x293986=_0x23a5e0,_0x1eceb1=_0x56d51a[_0x293986(0x11c1)]===_0x293986(0x20d)?'用户':_0x44ce48[_0x293986(0x1561)];return _0x1eceb1+':\x20'+String(_0x56d51a[_0x293986(0x4e3)])[_0x293986(0x72e)](0x0,0x32)+_0x293986(0x4a5);})['join']('\x0a'),_0x40b02a=_0x23a5e0(0x81e)+_0x44ce48['name']+'”。用户之前被你拉黑了，现在TA向你发送了好友申请，希望和好。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的上下文信息:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**你的角色设定**:\x20'+_0x44ce48['settings'][_0x23a5e0(0x1c3)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**用户发送的申请理由**:\x20“'+_0x44ce48[_0x23a5e0(0x239)][_0x23a5e0(0x351)]+_0x23a5e0(0xfc3)+(_0x221962||_0x23a5e0(0x898))+_0x23a5e0(0x701);try{const _0x26d98a=[{'role':'system','content':_0x40b02a},{'role':_0x23a5e0(0x20d),'content':_0x23a5e0(0x11c3)}];let _0x1f94bc=_0x29d171===GEMINI_API_URL,_0x1bf7f3=_0x366263(_0x2bc73b,_0x502385,_0x40b02a,[{'role':_0x23a5e0(0x20d),'content':_0x23a5e0(0x11c3)}]);const _0x25eb7c=_0x1f94bc?await fetch(_0x1bf7f3[_0x23a5e0(0x121f)],_0x1bf7f3[_0x23a5e0(0x38c)]):await fetch(_0x29d171+_0x23a5e0(0x501),{'method':_0x23a5e0(0x12db),'headers':{'Content-Type':_0x23a5e0(0xb1f),'Authorization':_0x23a5e0(0x1265)+_0x502385},'body':JSON[_0x23a5e0(0xe1e)]({'model':_0x2bc73b,'messages':_0x26d98a,'temperature':_0x19ddb8[_0x23a5e0(0x4c8)]['apiTemperature']||0.8})});if(!_0x25eb7c['ok'])throw new Error(_0x23a5e0(0x32d)+(await _0x25eb7c['json']())[_0x23a5e0(0x3b7)][_0x23a5e0(0xcce)]);const _0x57b133=await _0x25eb7c['json'](),_0x520c5b=getGeminiResponseText(_0x57b133)['replace'](/^```json\s*/,'')[_0x23a5e0(0x1bb)](/```$/,'')[_0x23a5e0(0x13f9)](),_0x169ea4=JSON['parse'](_0x520c5b);if(_0x169ea4[_0x23a5e0(0x828)]===_0x23a5e0(0xa91)){_0x44ce48[_0x23a5e0(0x239)]['status']='friend';const _0x4c88dc={'role':'assistant','senderName':_0x44ce48[_0x23a5e0(0x1561)],'content':_0x169ea4[_0x23a5e0(0xfcf)],'timestamp':Date[_0x23a5e0(0x64b)]()};_0x44ce48['history'][_0x23a5e0(0x1c4)](_0x4c88dc);}else{_0x44ce48[_0x23a5e0(0x239)][_0x23a5e0(0x27d)]=_0x23a5e0(0xf34);const _0x50b3a2={'role':_0x23a5e0(0x115c),'senderName':_0x44ce48['name'],'content':_0x169ea4['reason'],'timestamp':Date[_0x23a5e0(0x64b)]()};_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0x1c4)](_0x50b3a2);}_0x44ce48['relationship'][_0x23a5e0(0x351)]='',await _0x512070[_0x23a5e0(0xb04)]['put'](_0x44ce48),_0x56abd7(_0x1e2092),_0xec8072();}catch(_0x27e6b2){_0x44ce48[_0x23a5e0(0x239)]['status']=_0x23a5e0(0xf34),await _0x512070[_0x23a5e0(0xb04)]['put'](_0x44ce48),await _0x403a62(_0x23a5e0(0x123d),_0x23a5e0(0x2ab)+_0x27e6b2[_0x23a5e0(0xcce)]),_0x56abd7(_0x1e2092);}return;}let _0x47af46='';const _0xaf5acb=new Date(),_0x363db2=_0x44ce48[_0x23a5e0(0x450)]['timeZone']||'Asia/Shanghai',_0x2d4b9c=_0xaf5acb['toLocaleString'](_0x23a5e0(0x15bc),{'timeZone':_0x363db2,'dateStyle':_0x23a5e0(0x38f),'timeStyle':'short'}),_0x4a8f4c=new Date(_0xaf5acb['toLocaleString'](_0x23a5e0(0xf06),{'timeZone':_0x363db2})),_0x27ba55=_0x7e10b(_0x4a8f4c);let _0x314bda,_0x4aa276;const _0x5894ca=_0x44ce48['history']['filter'](_0x1378ba=>_0x1378ba['isHidden'])[_0x23a5e0(0x144a)]();if(_0x5894ca&&_0x5894ca[_0x23a5e0(0x4e3)][_0x23a5e0(0x478)](_0x23a5e0(0x4f3))){const _0x79a841=await _0x512070[_0x23a5e0(0xad1)][_0x23a5e0(0x1201)]('chatId')['equals'](_0x1e2092)[_0x23a5e0(0x126b)]();if(_0x79a841&&_0x79a841['transcript']){console[_0x23a5e0(0xe4d)](_0x23a5e0(0x5bd));const _0x598022=_0x79a841[_0x23a5e0(0x12ea)][_0x23a5e0(0xb0a)](_0x25d789=>{const _0x1710c8=_0x23a5e0,_0x25109c=_0x25d789['role']==='user'?_0x44ce48[_0x1710c8(0x450)][_0x1710c8(0x1555)]||'我':_0x25d789[_0x1710c8(0x1043)];return _0x25109c+':\x20'+_0x25d789[_0x1710c8(0x4e3)];})[_0x23a5e0(0x3b9)]('\x0a');_0x47af46='\x0a#\x20刚刚结束的通话记录\x20(最高优先级参考)\x0a你和用户刚刚结束了一场视频通话，以下是完整的通话文字记录。你接下来的回复【必须】与这次通话的内容紧密相关。\x0a---\x0a'+_0x598022+'\x0a---\x0a';}}const _0x44d56b=_0x4b122e(_0x2b35e7[_0x1e2092]);let _0x59a188='';if(_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x9c4)]&&_0x44ce48[_0x23a5e0(0x450)]['linkedWorldBookIds'][_0x23a5e0(0x106b)]>0x0){const _0x19719f=_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x9c4)][_0x23a5e0(0xb0a)](_0x3eafe7=>{const _0x2173b0=_0x23a5e0,_0x41873b=_0x19ddb8[_0x2173b0(0x8e4)]['find'](_0x8c5fab=>_0x8c5fab['id']===_0x3eafe7);if(!_0x41873b||!Array[_0x2173b0(0xb9b)](_0x41873b['content']))return'';const _0x31c754=_0x41873b[_0x2173b0(0x4e3)]['filter'](_0x475f80=>_0x475f80['enabled']!==![])[_0x2173b0(0xb0a)](_0x276c30=>{const _0x1494cd=_0x2173b0;let _0x2fe268=_0x1494cd(0xc4e)+(_0x276c30[_0x1494cd(0x79d)]||_0x1494cd(0xbcc))+'\x0a';return _0x276c30[_0x1494cd(0x2d0)][_0x1494cd(0x106b)]>0x0&&(_0x2fe268+=_0x1494cd(0x1092)+_0x276c30[_0x1494cd(0x2d0)][_0x1494cd(0x3b9)](',\x20')+'\x0a'),_0x2fe268+=_0x1494cd(0x14b5)+_0x276c30[_0x1494cd(0x4e3)],_0x2fe268;})[_0x2173b0(0x3b9)]('');return _0x31c754?_0x2173b0(0xe9b)+_0x41873b[_0x2173b0(0x1561)]+'\x0a'+_0x31c754:'';})[_0x23a5e0(0x1195)](Boolean)[_0x23a5e0(0x3b9)]('');_0x19719f&&(_0x59a188='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x19719f+_0x23a5e0(0x951));}let _0x125a7c='';if(_0x4e0631[_0x23a5e0(0x1412)]&&_0x4e0631['activeChatId']===_0x1e2092){const _0x225df6=_0x4e0631[_0x23a5e0(0xfe2)]>-0x1?_0x4e0631[_0x23a5e0(0x496)][_0x4e0631[_0x23a5e0(0xfe2)]]:null,_0x3cbe1a=_0x4e0631[_0x23a5e0(0x496)][_0x23a5e0(0xb0a)](_0x78b354=>'\x22'+_0x78b354[_0x23a5e0(0x1561)]+'\x22')['join'](',\x20');let _0xbc6b13='';if(_0x225df6&&_0x4e0631[_0x23a5e0(0xa1d)]&&_0x4e0631['parsedLyrics'][_0x23a5e0(0x106b)]>0x0&&_0x4e0631['currentLyricIndex']>-0x1){const _0x3ba219=_0x4e0631[_0x23a5e0(0xa1d)][_0x4e0631['currentLyricIndex']],_0x43ad88=_0x4e0631[_0x23a5e0(0xa1d)][_0x23a5e0(0x457)](_0x4e0631[_0x23a5e0(0x8fa)]+0x1,_0x4e0631[_0x23a5e0(0x8fa)]+0x3);_0xbc6b13+=_0x23a5e0(0x10fd)+_0x3ba219['text']+'\x22\x0a',_0x43ad88[_0x23a5e0(0x106b)]>0x0&&(_0xbc6b13+=_0x23a5e0(0xf91)+_0x43ad88[_0x23a5e0(0xb0a)](_0x32ee15=>'\x22'+_0x32ee15[_0x23a5e0(0x13ca)]+'\x22')[_0x23a5e0(0x3b9)](_0x23a5e0(0x14e4))+'\x0a');}_0x125a7c='\x0a\x0a#\x20当前音乐情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**当前状态**:\x20你们正在和用户一起听歌。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**正在播放**:\x20'+(_0x225df6?'《'+_0x225df6['name']+_0x23a5e0(0xf29)+_0x225df6[_0x23a5e0(0xf6d)]:'无')+_0x23a5e0(0x1f4)+_0x3cbe1a+_0x23a5e0(0x2bb)+_0xbc6b13+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的任务**:\x20你可以根据对话内容和氛围，使用\x20\x22change_music\x22\x20指令切换到播放列表中的任何一首歌，以增强互动体验。\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}const _0xc6a046=parseInt(_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x152f)])||0xa,_0x3f451f=_0x44ce48['history'][_0x23a5e0(0x457)](-_0xc6a046);let _0x17c045='';const _0xb4c5fa=_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0x527)](_0x1dd603=>_0x1dd603[_0x23a5e0(0x11c1)]===_0x23a5e0(0x115c)),_0x5d506a=_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0x457)](_0xb4c5fa+0x1),_0x285585=_0x5d506a[_0x23a5e0(0xd62)](_0x15414e=>_0x15414e[_0x23a5e0(0x1508)]===_0x23a5e0(0x68c));if(_0x285585){const _0x1f1936=_0x285585[_0x23a5e0(0x8b5)],_0x27b434=_0x1f1936[_0x23a5e0(0x1396)]['map'](_0x428223=>{const _0x123429=_0x23a5e0,_0x2be066=_0x428223[_0x123429(0x1043)]||(_0x428223[_0x123429(0x11c1)]===_0x123429(0x20d)?_0x44ce48['settings'][_0x123429(0x1555)]||'我':_0x123429(0xe7a));let _0x17e964='';if(_0x428223[_0x123429(0x1508)]==='voice_message')_0x17e964=_0x123429(0x612)+_0x428223[_0x123429(0x4e3)]+']';else{if(_0x428223['type']==='ai_image')_0x17e964=_0x123429(0x756)+_0x428223[_0x123429(0x3ef)]+']';else{if(_0x428223[_0x123429(0x1508)]===_0x123429(0x1300))_0x17e964=_0x123429(0x35f)+_0x428223['prompt']+']';else _0x17e964=String(_0x428223['content']);}}return _0x2be066+':\x20'+_0x17e964;})[_0x23a5e0(0x3b9)]('\x0a');_0x17c045=_0x23a5e0(0x1422)+_0x1f1936[_0x23a5e0(0x486)]+'”的对话中分享过来的。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的任务：请你阅读并理解下面的对话内容。在接下来的回复中，你可以像真人一样，对这段对话的内容自然地发表你的看法、感受或疑问。\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录开始]\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x27b434+_0x23a5e0(0x5c3);}let _0x16df3c='';const _0x127dd6=_0x44ce48[_0x23a5e0(0x450)]['linkedMemoryCount']||0xa;if(_0x44ce48['settings']['linkedMemoryChatIds']&&_0x44ce48['settings'][_0x23a5e0(0x120e)][_0x23a5e0(0x106b)]>0x0){const _0x5dc5c8=_0x44ce48['settings'][_0x23a5e0(0x120e)]['filter'](_0x4c64d0=>_0x4c64d0!==_0x1e2092);if(_0x5dc5c8[_0x23a5e0(0x106b)]>0x0){const _0x4fb9a2=_0x5dc5c8['map'](_0x362443=>{const _0x185ff6=_0x23a5e0,_0x51a4aa=_0x19ddb8[_0x185ff6(0xb04)][_0x362443];if(!_0x51a4aa)return null;const _0x22758c=_0x51a4aa[_0x185ff6(0x1f0)][_0x185ff6(0x457)](-0x1);return{'chat':_0x51a4aa,'latestTimestamp':_0x22758c?_0x22758c[_0x185ff6(0xd73)]:0x0};})[_0x23a5e0(0x1195)](Boolean);_0x4fb9a2[_0x23a5e0(0x6a2)]((_0x1bd209,_0x1304bf)=>_0x1304bf['latestTimestamp']-_0x1bd209[_0x23a5e0(0x1a4)]),_0x16df3c+=_0x23a5e0(0xa09);for(const _0x447705 of _0x4fb9a2){const _0x14e4c1=_0x447705[_0x23a5e0(0xd43)],_0x316521=_0x14e4c1[_0x23a5e0(0x136b)]?_0x23a5e0(0xa9a):_0x23a5e0(0x939),_0x52389b=_0x447705[_0x23a5e0(0x1a4)]>0x0?_0x23a5e0(0x1156)+_0x5d6abc(_0x447705[_0x23a5e0(0x1a4)])+')':'';_0x16df3c+=_0x23a5e0(0xf63)+_0x316521+'“'+_0x14e4c1[_0x23a5e0(0x1561)]+'”的参考记忆'+_0x52389b+'\x20---\x0a';const _0x5e92ad=_0x14e4c1[_0x23a5e0(0x1f0)][_0x23a5e0(0x457)](-_0x127dd6),_0x1d3e26=_0x5e92ad[_0x23a5e0(0x1195)](_0x2f0609=>!String(_0x2f0609[_0x23a5e0(0x4e3)])[_0x23a5e0(0x478)](_0x23a5e0(0x2aa)));_0x1d3e26['length']>0x0?_0x1d3e26[_0x23a5e0(0x15c1)](_0x1032a1=>{const _0x30433e=_0x23a5e0,_0x4846d6=_0x1032a1[_0x30433e(0x11c1)]===_0x30433e(0x20d)?_0x14e4c1[_0x30433e(0x450)][_0x30433e(0x1555)]||'我':_0x1032a1[_0x30433e(0x1043)]||_0x14e4c1['name'];let _0x10d1cc=String(_0x1032a1['content']);if(_0x1032a1[_0x30433e(0x1508)]===_0x30433e(0x1c1)||_0x1032a1[_0x30433e(0x1508)]===_0x30433e(0x9ee))_0x10d1cc=_0x30433e(0x21c)+_0x1032a1['content']+']';else _0x1032a1['type']===_0x30433e(0x1207)&&(_0x10d1cc=_0x30433e(0x10bd)+_0x1032a1[_0x30433e(0x4e3)]+']');const _0x179ab5=_0x5d6abc(_0x1032a1['timestamp']);_0x16df3c+='('+_0x179ab5+')\x20'+_0x4846d6+':\x20'+_0x10d1cc+'\x0a';}):_0x16df3c+='(暂无有效聊天记录)\x0a';}}}console[_0x23a5e0(0xe4d)](_0x23a5e0(0x7c1),_0x16df3c);if(_0x44ce48['isGroup']){let _0x4b90eb='';const _0x1ff68b=_0x44ce48[_0x23a5e0(0x450)]['linkedMemoryCount']||0xa;if(_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x120e)]&&_0x44ce48['settings'][_0x23a5e0(0x120e)][_0x23a5e0(0x106b)]>0x0){const _0xda616f=_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x120e)][_0x23a5e0(0x1195)](_0x256e29=>_0x256e29!==_0x1e2092);if(_0xda616f[_0x23a5e0(0x106b)]>0x0){const _0x49ca4b=_0xda616f[_0x23a5e0(0xb0a)](_0x339934=>{const _0x58fd7f=_0x23a5e0,_0x4270a3=_0x19ddb8[_0x58fd7f(0xb04)][_0x339934];if(!_0x4270a3)return null;const _0x59a995=_0x4270a3['history']['slice'](-0x1);return{'chat':_0x4270a3,'latestTimestamp':_0x59a995?_0x59a995[_0x58fd7f(0xd73)]:0x0};})[_0x23a5e0(0x1195)](Boolean);_0x49ca4b[_0x23a5e0(0x6a2)]((_0x5d6067,_0x359b7f)=>_0x359b7f[_0x23a5e0(0x1a4)]-_0x5d6067[_0x23a5e0(0x1a4)]),_0x4b90eb+=_0x23a5e0(0x1fa);for(const _0x322a3c of _0x49ca4b){const _0x2be0ba=_0x322a3c[_0x23a5e0(0xd43)],_0x5520a1=_0x2be0ba[_0x23a5e0(0x136b)]?_0x23a5e0(0xa9a):'[私聊]',_0x3f4f4f=_0x322a3c[_0x23a5e0(0x1a4)]>0x0?'\x20(最后互动于\x20'+_0x5d6abc(_0x322a3c[_0x23a5e0(0x1a4)])+')':'';_0x4b90eb+=_0x23a5e0(0xf63)+_0x5520a1+'“'+_0x2be0ba[_0x23a5e0(0x1561)]+'”的参考记忆'+_0x3f4f4f+_0x23a5e0(0x1419);const _0x4c080d=_0x2be0ba[_0x23a5e0(0x1f0)][_0x23a5e0(0x457)](-_0x1ff68b),_0x1482e1=_0x4c080d[_0x23a5e0(0x1195)](_0xfdc488=>!String(_0xfdc488[_0x23a5e0(0x4e3)])[_0x23a5e0(0x478)](_0x23a5e0(0x2aa)));_0x1482e1[_0x23a5e0(0x106b)]>0x0?_0x1482e1['forEach'](_0x2e438d=>{const _0x4ab86a=_0x23a5e0,_0x7e8726=_0x2e438d[_0x4ab86a(0x11c1)]===_0x4ab86a(0x20d)?_0x2be0ba['settings'][_0x4ab86a(0x1555)]||'我':_0x2e438d[_0x4ab86a(0x1043)]||_0x2be0ba[_0x4ab86a(0x1561)];let _0x17cfef=String(_0x2e438d[_0x4ab86a(0x4e3)]);if(_0x2e438d[_0x4ab86a(0x1508)]===_0x4ab86a(0x1c1)||_0x2e438d[_0x4ab86a(0x1508)]==='user_photo')_0x17cfef='[发送了一张图片，描述为：'+_0x2e438d['content']+']';else _0x2e438d[_0x4ab86a(0x1508)]===_0x4ab86a(0x1207)&&(_0x17cfef=_0x4ab86a(0x10bd)+_0x2e438d[_0x4ab86a(0x4e3)]+']');_0x4b90eb+=_0x7e8726+':\x20'+_0x17cfef+'\x0a';}):_0x4b90eb+='(暂无有效聊天记录)\x0a';}}}let _0x40f342='#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a',_0x48e219=![];_0x44ce48[_0x23a5e0(0xcca)]['forEach'](_0x235ea8=>{const _0x1b7fdf=_0x23a5e0,_0x29a142=_0x19ddb8['chats'][_0x235ea8['id']];_0x29a142&&_0x29a142[_0x1b7fdf(0x744)]&&_0x29a142[_0x1b7fdf(0x744)][_0x1b7fdf(0x106b)]>0x0&&(_0x40f342+=_0x1b7fdf(0x9d0)+_0x235ea8[_0x1b7fdf(0xaf0)]+'”的记忆\x20---\x0a',_0x40f342+=_0x29a142[_0x1b7fdf(0x744)]['map'](_0x538a85=>_0x1b7fdf(0x2ee)+_0x5d6abc(_0x538a85['timestamp'])+')\x20'+_0x538a85['content'])[_0x1b7fdf(0x3b9)]('\x0a'),_0x48e219=!![]);});!_0x48e219&&(_0x40f342+='-\x20(暂无)');let _0x1cec93='',_0x3584e6=![];if(_0x44ce48[_0x23a5e0(0x450)]['enableTimePerception']){const _0x13003c=_0x3f451f[_0x23a5e0(0x457)](-0x1)[0x0];if(_0x13003c){const _0x4ebec9=_0x4c879a(_0x13003c[_0x23a5e0(0xd73)]);_0x1cec93='上一条消息的发送时间是\x20'+_0x4ebec9+'。';const _0x12607d=(Date['now']()-_0x13003c[_0x23a5e0(0xd73)])/(0x3e8*0x3c*0x3c);if(_0x12607d>0x3){_0x3584e6=!![];const _0x2df6be=Math[_0x23a5e0(0xd95)](_0x12607d/0x18);_0x1cec93+=_0x23a5e0(0x844)+(_0x2df6be>0x0?_0x2df6be+'天':Math[_0x23a5e0(0xd95)](_0x12607d)+'小时')+'。';}}else _0x1cec93='这是群里的第一条消息。';}const _0x7f278b=await _0x512070[_0x23a5e0(0x376)][_0x23a5e0(0x591)]();let _0x2d4e32='';_0x7f278b[_0x23a5e0(0x106b)]>0x0&&(_0x2d4e32=_0x23a5e0(0xb38),_0x7f278b[_0x23a5e0(0x15c1)](_0x710244=>{const _0x427350=_0x23a5e0;_0x2d4e32+=_0x427350(0x1549)+_0x710244['id']+_0x427350(0x5a5)+_0x710244[_0x427350(0x1561)]+_0x427350(0x10c1)+_0x710244[_0x427350(0x87b)][_0x427350(0x1322)](0x2)+'\x0a';}));let _0x42af08=_0x44ce48['members'][_0x23a5e0(0xb0a)](_0x225a60=>{const _0x363de4=_0x23a5e0,_0x4c1a8c=_0x19ddb8[_0x363de4(0xb04)][_0x225a60['id']];let _0x3fdaf2=_0x363de4(0x46b);if(_0x4c1a8c&&_0x4c1a8c[_0x363de4(0x4ab)]){const _0x299145=Object['values'](_0x19ddb8[_0x363de4(0xb04)])[_0x363de4(0x1195)](_0x517e8b=>!_0x517e8b[_0x363de4(0x136b)]&&_0x517e8b['id']!==_0x225a60['id']&&_0x517e8b['groupId']===_0x4c1a8c[_0x363de4(0x4ab)]);_0x299145[_0x363de4(0x106b)]>0x0&&(_0x3fdaf2=_0x363de4(0x3c1)+_0x299145[_0x363de4(0xb0a)](_0x3426e4=>_0x3426e4[_0x363de4(0x1561)])[_0x363de4(0x3b9)]('、\x20'));}return _0x363de4(0x1e5)+_0x225a60[_0x363de4(0xaf0)]+_0x363de4(0xb33)+_0x225a60[_0x363de4(0x339)]+_0x363de4(0x41b)+_0x225a60['persona']+'\x20[社交背景:\x20'+_0x3fdaf2+']';})['join']('\x0a');const _0x3d1fd7=_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x1555)]||'我',_0x232fd8=_0x19ddb8[_0x23a5e0(0x9ce)][_0x23a5e0(0x246)]||'{{user}}';let _0x244118='';const _0x1190ef=(_0x44ce48[_0x23a5e0(0xf9c)]||[])[_0x23a5e0(0x1195)](_0x5ae1b4=>_0x5ae1b4['isPinned']);_0x1190ef[_0x23a5e0(0x106b)]>0x0&&(_0x244118+='\x0a#\x20【【【群公告\x20(最高优先级规则)】】】\x0a你【必须】阅读、理解并严格遵守以下所有公告，它们凌驾于你的人设之上。\x0a',_0x1190ef[_0x23a5e0(0x15c1)](_0x5cd562=>{const _0x40d70a=_0x23a5e0,_0x595438=_0x44ce48[_0x40d70a(0x1f0)][_0x40d70a(0xd62)](_0x35fa28=>_0x35fa28[_0x40d70a(0xd73)]===_0x5cd562[_0x40d70a(0xb65)]);if(_0x595438){let _0x24536f=String(_0x595438[_0x40d70a(0x4e3)]||'');_0x595438['type']===_0x40d70a(0x1c1)&&(_0x24536f='[图片内容:\x20'+_0x24536f+']'),_0x244118+=_0x40d70a(0x7bf)+_0x24536f+_0x40d70a(0x416)+_0x5cd562['publisher']+_0x40d70a(0x715);}}),_0x244118+=_0x23a5e0(0x111f));const _0x958849=_0x44ce48[_0x23a5e0(0xcca)]['map'](_0x40dc1f=>_0x40dc1f[_0x23a5e0(0x339)]),_0xefaa7a=_0x23a5e0(0x44e)+_0x958849['join']('、\x20')+']';let _0x468b62=_0x23a5e0(0x109f);_0x44ce48[_0x23a5e0(0x450)]['groupAvatarLibrary']&&_0x44ce48['settings'][_0x23a5e0(0x284)][_0x23a5e0(0x106b)]>0x0?_0x468b62+=_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x284)][_0x23a5e0(0xb0a)](_0x2ec454=>'-\x20'+_0x2ec454[_0x23a5e0(0x1561)])[_0x23a5e0(0x3b9)]('\x0a'):_0x468b62+=_0x23a5e0(0x73a);const _0x3cb7c8=_0x449f61(_0x1e2092),_0x2ace3d=_0x54310e(_0x44ce48,0x3,_0x23a5e0(0xb41)),_0x1ed267=_0x54310e(_0x44ce48,0x6,_0x23a5e0(0xb41)),_0x5ae530=_0x54310e(_0x44ce48,0x9,_0x23a5e0(0xb41)),_0x254939=_0x54310e(_0x44ce48,0x1,_0x23a5e0(0x113c)),_0x3a9830=_0x54310e(_0x44ce48,0x3,_0x23a5e0(0x113c)),_0xbb5585=_0x54310e(_0x44ce48,0x7,_0x23a5e0(0x113c));let _0x2e8364='';if(_0x2ace3d||_0x1ed267||_0x5ae530||_0x254939||_0x3a9830||_0xbb5585){_0x2e8364+=_0x23a5e0(0xc6b);if(_0x2ace3d)_0x2e8364+=_0x2ace3d;if(_0x1ed267)_0x2e8364+=_0x1ed267;if(_0x5ae530)_0x2e8364+=_0x5ae530;if(_0x2ace3d||_0x1ed267||_0x5ae530)_0x2e8364+='\x0a';if(_0x254939)_0x2e8364+=_0x254939;if(_0x3a9830)_0x2e8364+=_0x3a9830;if(_0xbb5585)_0x2e8364+=_0xbb5585;}const _0x13f80d=_0x50f06c(_0x44ce48);_0x314bda=_0x23a5e0(0x11f4)+_0x3d1fd7+_0x23a5e0(0x6f8)+_0x232fd8+_0x23a5e0(0x714)+_0x3d1fd7+_0x23a5e0(0x7b9)+_0x44ce48[_0x23a5e0(0x1561)]+_0x23a5e0(0xade)+(_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x2de)]?'5.\x20\x20**情景感知**:\x20你的对话【必须】自然地体现出对当前时间\x20('+_0x2d4b9c+')\x20和情景的感知。'+(_0x3584e6?_0x23a5e0(0xae2)+_0x1cec93+_0x23a5e0(0x159c):''):'')+_0x23a5e0(0x1d2)+(_0x3cb7c8?_0x23a5e0(0xf5c)+_0x3cb7c8:'你们没有在读书。')+_0x23a5e0(0x11eb)+_0x3d1fd7+'）说一些不想让群里其他人看到的私密话时（例如：表达爱意、抱怨、揭短、分享秘密），你【应该】使用\x20\x22send_private_message\x22\x20指令。\x0a-\x20\x20\x20这个指令会把消息发送到你和用户之间的【1对1私聊】中。\x0a-\x20\x20\x20【格式铁律】:\x20\x22content\x22\x20字段【必须】是一个【JSON字符串数组\x20(Array\x20of\x20Strings)】。\x0a-\x20\x20\x20【单条私信示例】:\x20`{\x22type\x22:\x20\x22send_private_message\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22recipient\x22:\x20\x22'+_0x232fd8+_0x23a5e0(0x9e4)+_0x232fd8+_0x23a5e0(0xb24)+_0x44ce48[_0x23a5e0(0x1561)]+'\x0a'+(_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x2de)]?_0x23a5e0(0x12f7)+_0x1cec93:'')+'\x0a\x0a#\x20群成员列表、人设及社交背景\x20(至关重要！)\x0a你【必须】根据每个角色的社交背景来决定他们的互动方式。\x0a'+_0x42af08+'\x0a#\x20用户的角色\x0a-\x20**'+_0x3d1fd7+'**:\x20'+_0x44ce48['settings']['myPersona']+_0x23a5e0(0xd87)+_0x59a188+_0x23a5e0(0xe78)+_0x40f342+'\x0a'+(_0x44ce48[_0x23a5e0(0x744)]&&_0x44ce48['longTermMemory'][_0x23a5e0(0x106b)]>0x0?_0x44ce48['longTermMemory'][_0x23a5e0(0xb0a)](_0x1a8f79=>'-\x20'+_0x1a8f79['content'])[_0x23a5e0(0x3b9)]('\x0a'):_0x23a5e0(0xc55))+'\x0a'+_0x2e8364+'\x0a'+_0x4b90eb+'\x0a'+_0x125a7c+'\x0a'+_0x17c045+'\x0a'+_0x468b62+_0x23a5e0(0x1052)+_0x13f80d+'\x0a'+_0xefaa7a+'\x0a'+_0x47af46+_0x23a5e0(0xd59)+(localStorage[_0x23a5e0(0x5de)](_0x23a5e0(0x95b))===_0x23a5e0(0x903)?_0x23a5e0(0x1032):'')+_0x23a5e0(0x90d)+_0x232fd8+_0x23a5e0(0x121c),_0x4aa276=_0x3f451f[_0x23a5e0(0xb0a)](_0x4879bb=>{const _0x5be1b1=_0x23a5e0,_0x2c6b29=_0x4879bb[_0x5be1b1(0x11c1)]===_0x5be1b1(0x20d)?_0x3d1fd7:_0x4879bb[_0x5be1b1(0x1043)];let _0x1843e8=''+_0x2c6b29;if(_0x4879bb[_0x5be1b1(0x6f7)]){const _0x42964d=String(_0x4879bb['quote'][_0x5be1b1(0x4e3)]||'')[_0x5be1b1(0x72e)](0x0,0x32);_0x1843e8+=_0x5be1b1(0x1197)+_0x4879bb[_0x5be1b1(0x6f7)][_0x5be1b1(0x1043)]+_0x5be1b1(0xc70)+_0x42964d+_0x5be1b1(0x6ca);}_0x1843e8+=':\x20';let _0x3467a9;if(_0x4879bb['type']==='user_photo')_0x3467a9='['+_0x2c6b29+'\x20发送了一张图片，内容是：\x27'+_0x4879bb[_0x5be1b1(0x4e3)]+'\x27]';else{if(_0x4879bb['type']===_0x5be1b1(0x1c1))_0x3467a9='['+_0x2c6b29+_0x5be1b1(0xb6d)+_0x4879bb[_0x5be1b1(0x4e3)]+'\x27]';else{if(_0x4879bb[_0x5be1b1(0x1508)]===_0x5be1b1(0x1300))_0x3467a9='['+_0x2c6b29+'\x20分享了一张NovelAI图片，prompt:\x20'+_0x4879bb[_0x5be1b1(0x3a1)]+']';else{if(_0x4879bb[_0x5be1b1(0x1508)]===_0x5be1b1(0x1207))_0x3467a9='['+_0x2c6b29+_0x5be1b1(0x126f)+_0x4879bb['content']+'\x27]';else{if(_0x4879bb[_0x5be1b1(0x1508)]===_0x5be1b1(0x4b3))_0x3467a9='['+_0x4879bb[_0x5be1b1(0x1043)]+_0x5be1b1(0x133a)+_0x4879bb[_0x5be1b1(0x13e2)]+_0x5be1b1(0x123c)+_0x4879bb[_0x5be1b1(0x11fa)]+_0x5be1b1(0x815)+_0x4879bb[_0x5be1b1(0x1436)]+']';else{if(_0x4879bb['type']===_0x5be1b1(0x12cc))_0x3467a9='['+_0x2c6b29+_0x5be1b1(0x1171)+_0x4879bb['content']+'\x27]';else{if(_0x4879bb[_0x5be1b1(0x1508)]===_0x5be1b1(0x5ee)){const _0xe627a4=_0x4879bb['repostComment']?'并评论说：“'+_0x4879bb[_0x5be1b1(0x3eb)]+'”':'';let _0x187702='原作者';const _0x4e7076=_0x4879bb[_0x5be1b1(0x327)][_0x5be1b1(0x82c)];if(_0x4e7076===_0x5be1b1(0x20d))_0x187702=_0x19ddb8[_0x5be1b1(0x9ce)][_0x5be1b1(0x246)];else _0x19ddb8[_0x5be1b1(0xb04)][_0x4e7076]&&(_0x187702=_0x19ddb8['chats'][_0x4e7076]['name']);let _0x4e485f;const _0x5bac02=_0x4879bb['originalPost'];if(_0x5bac02[_0x5be1b1(0x1508)]===_0x5be1b1(0x1281))_0x4e485f='[文字图]\x20'+(_0x5bac02['publicText']||'')+'\x20(图片描述:\x20“'+(_0x5bac02[_0x5be1b1(0x14bb)]||'')[_0x5be1b1(0x72e)](0x0,0x28)+'...”)';else _0x5bac02[_0x5be1b1(0x1508)]===_0x5be1b1(0x1016)?_0x4e485f=_0x5be1b1(0xe48)+(_0x5bac02[_0x5be1b1(0x6b9)]||'')+_0x5be1b1(0x4a0)+(_0x5bac02[_0x5be1b1(0xbea)]||'')['substring'](0x0,0x28)+'...”)':_0x4e485f='“'+(_0x5bac02[_0x5be1b1(0x4e3)]||'')[_0x5be1b1(0x72e)](0x0,0x28)+'...”';_0x3467a9='['+_0x2c6b29+_0x5be1b1(0xdad)+_0x187702+_0x5be1b1(0xf86)+_0xe627a4+_0x5be1b1(0x9d1)+_0x4e485f+'】]';}else{if(_0x4879bb[_0x5be1b1(0x1508)]===_0x5be1b1(0x12ec))_0x4879bb['status']==='paid'?_0x3467a9=_0x5be1b1(0x345)+_0x4879bb[_0x5be1b1(0x1588)]+_0x5be1b1(0x249)+_0x2c6b29+_0x5be1b1(0xfcd)+_0x4879bb[_0x5be1b1(0x11fa)]+'\x20元。此订单已完成。]':_0x3467a9='['+_0x2c6b29+_0x5be1b1(0xe96)+_0x4879bb[_0x5be1b1(0xd97)]+'”，金额是\x20'+_0x4879bb[_0x5be1b1(0x11fa)]+'\x20元，订单时间戳为\x20'+_0x4879bb[_0x5be1b1(0xd73)]+']';else{if(_0x4879bb[_0x5be1b1(0x1508)]===_0x5be1b1(0x552)){const _0x6024cd=_0x4879bb['senderName']===_0x3d1fd7?_0x5be1b1(0x1138)+_0x3d1fd7+')':_0x4879bb[_0x5be1b1(0x1043)];let _0x163444;_0x4879bb[_0x5be1b1(0x4ee)]===_0x5be1b1(0x93c)?_0x163444=_0x5be1b1(0x345)+_0x6024cd+_0x5be1b1(0x1280)+_0x4879bb[_0x5be1b1(0xd73)]+_0x5be1b1(0x1535)+_0x4879bb[_0x5be1b1(0x13e2)]+_0x5be1b1(0x118b)+_0x4879bb[_0x5be1b1(0x13e2)]+_0x5be1b1(0x56b):_0x163444=_0x5be1b1(0x345)+_0x6024cd+_0x5be1b1(0x13fd)+_0x4879bb[_0x5be1b1(0xd73)]+_0x5be1b1(0xf99)+_0x4879bb[_0x5be1b1(0x1524)]+_0x5be1b1(0xb3f),_0x3467a9=_0x163444;}else{if(_0x4879bb[_0x5be1b1(0x1508)]===_0x5be1b1(0xf69)){const _0xb43951=_0x4879bb['role']===_0x5be1b1(0x20d)?_0x3d1fd7:_0x1e2056(_0x44ce48,_0x4879bb['senderName']),_0x38a20a=_0x4879bb['items']['map'](_0x24b1fb=>_0x24b1fb[_0x5be1b1(0x1561)]+'\x20x'+_0x24b1fb[_0x5be1b1(0x1485)])[_0x5be1b1(0x3b9)]('、\x20');let _0x25bb8d='';if(_0x4879bb[_0x5be1b1(0x6d2)]&&_0x4879bb[_0x5be1b1(0x6d2)]['length']>0x0){const _0x55d6c9=_0x4879bb[_0x5be1b1(0x6d2)][_0x5be1b1(0xb0a)](_0x4bc4f1=>_0x1e2056(_0x44ce48,_0x4bc4f1))[_0x5be1b1(0x3b9)]('、\x20');_0x25bb8d=_0x5be1b1(0x6a5)+_0x55d6c9;}else _0x25bb8d=_0x5be1b1(0xfbd);return _0x3467a9=_0x5be1b1(0x345)+_0xb43951+'\x20'+_0x25bb8d+'，礼物是：'+_0x38a20a+']',{'role':'user','content':_0x3467a9};}else{if(_0x4879bb[_0x5be1b1(0x1508)]==='poll'){const _0x1e0dd6=Object[_0x5be1b1(0xea1)](_0x4879bb[_0x5be1b1(0xa71)]||{})[_0x5be1b1(0x10fb)]()[_0x5be1b1(0x3b9)](',\x20')||_0x5be1b1(0x582);_0x3467a9=_0x5be1b1(0x345)+_0x4879bb['senderName']+_0x5be1b1(0x53a)+_0x4879bb[_0x5be1b1(0xd73)]+_0x5be1b1(0x149a)+_0x4879bb[_0x5be1b1(0x1db)]+_0x5be1b1(0x146c)+_0x4879bb[_0x5be1b1(0x11c2)]['join'](',\x20')+_0x5be1b1(0x2e2)+_0x1e0dd6+'。你可以使用\x20\x27vote\x27\x20指令参与投票。]';}else{if(_0x4879bb[_0x5be1b1(0x7da)])_0x3467a9=_0x2c6b29+_0x5be1b1(0xd3b)+_0x4879bb[_0x5be1b1(0x7da)]+'\x27]';else{if(Array[_0x5be1b1(0xb9b)](_0x4879bb[_0x5be1b1(0x4e3)]))return{'role':_0x5be1b1(0x20d),'content':[..._0x4879bb[_0x5be1b1(0x4e3)],{'type':'text','text':_0x1843e8}]};else _0x3467a9=''+_0x1843e8+_0x4879bb[_0x5be1b1(0x4e3)];}}}}}}}}}}}}return{'role':'user','content':_0x3467a9};})[_0x23a5e0(0x1195)](Boolean);}else{const _0x3757da=_0x44ce48['settings'][_0x23a5e0(0x1267)],_0x2c5544=_0xc9a7e4(_0x44ce48);let _0x430104='';_0x44ce48['settings'][_0x23a5e0(0x8be)]&&_0x44ce48[_0x23a5e0(0x390)]&&!_0x3757da&&(_0x430104=_0x23a5e0(0x1089)+_0x44ce48['heartfeltVoice']+_0x23a5e0(0x1351)+_0x44ce48[_0x23a5e0(0x69b)]+'\x0a');let _0x31e248='';const _0x5e2961=_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0xb09)]||0xa;if(_0x44ce48[_0x23a5e0(0x450)]['linkedMemoryChatIds']&&_0x44ce48[_0x23a5e0(0x450)]['linkedMemoryChatIds'][_0x23a5e0(0x106b)]>0x0){const _0x12fcd6=_0x44ce48['settings'][_0x23a5e0(0x120e)][_0x23a5e0(0x1195)](_0x2454ad=>_0x2454ad!==_0x1e2092);if(_0x12fcd6[_0x23a5e0(0x106b)]>0x0){const _0x72e6aa=_0x12fcd6[_0x23a5e0(0xb0a)](_0x234fe5=>{const _0x16ea68=_0x23a5e0,_0x1f4b49=_0x19ddb8[_0x16ea68(0xb04)][_0x234fe5];if(!_0x1f4b49)return null;const _0x3c1daa=_0x1f4b49[_0x16ea68(0x1f0)][_0x16ea68(0x457)](-0x1)[0x0];return{'chat':_0x1f4b49,'latestTimestamp':_0x3c1daa?_0x3c1daa[_0x16ea68(0xd73)]:0x0};})['filter'](Boolean);_0x72e6aa[_0x23a5e0(0x6a2)]((_0x1792ac,_0x38401e)=>_0x38401e[_0x23a5e0(0x1a4)]-_0x1792ac['latestTimestamp']),_0x31e248+=_0x23a5e0(0xa09);for(const _0x5549c6 of _0x72e6aa){const _0x4732e1=_0x5549c6[_0x23a5e0(0xd43)],_0x2efc54=_0x4732e1[_0x23a5e0(0x136b)]?'[群聊]':_0x23a5e0(0x939),_0x1b9e75=_0x5549c6[_0x23a5e0(0x1a4)]>0x0?_0x23a5e0(0x1156)+_0x5d6abc(_0x5549c6[_0x23a5e0(0x1a4)])+')':'';_0x31e248+='\x0a##\x20---\x20来自'+_0x2efc54+'“'+_0x4732e1['name']+'”的参考记忆'+_0x1b9e75+_0x23a5e0(0x1419);const _0x462c3a=_0x4732e1[_0x23a5e0(0x1f0)][_0x23a5e0(0x457)](-_0x5e2961),_0x101835=_0x462c3a[_0x23a5e0(0x1195)](_0xbc01f9=>!String(_0xbc01f9[_0x23a5e0(0x4e3)])[_0x23a5e0(0x478)](_0x23a5e0(0x2aa)));_0x101835[_0x23a5e0(0x106b)]>0x0?_0x101835[_0x23a5e0(0x15c1)](_0x5a6ba8=>{const _0x3cc531=_0x23a5e0,_0x3b62b5=_0x5a6ba8[_0x3cc531(0x11c1)]===_0x3cc531(0x20d)?_0x4732e1[_0x3cc531(0x450)][_0x3cc531(0x1555)]||'我':_0x5a6ba8[_0x3cc531(0x1043)]||_0x4732e1[_0x3cc531(0x1561)];let _0x28a9ba=String(_0x5a6ba8['content']);if(_0x5a6ba8[_0x3cc531(0x1508)]===_0x3cc531(0x1c1)||_0x5a6ba8['type']===_0x3cc531(0x9ee))_0x28a9ba=_0x3cc531(0x21c)+_0x5a6ba8[_0x3cc531(0x4e3)]+']';else _0x5a6ba8[_0x3cc531(0x1508)]===_0x3cc531(0x1207)&&(_0x28a9ba=_0x3cc531(0x10bd)+_0x5a6ba8[_0x3cc531(0x4e3)]+']');const _0x5539d3=_0x5d6abc(_0x5a6ba8['timestamp']);_0x31e248+='('+_0x5539d3+')\x20'+_0x3b62b5+':\x20'+_0x28a9ba+'\x0a';}):_0x31e248+=_0x23a5e0(0xc40);}}}const _0x719f8b=await _0x512070[_0x23a5e0(0x376)]['toArray']();let _0x4cd364='';_0x719f8b[_0x23a5e0(0x106b)]>0x0&&(_0x4cd364='\x0a\x0a#\x20你的商店\x20(你可以为用户购买礼物):\x0a',_0x719f8b[_0x23a5e0(0x15c1)](_0x283a24=>{const _0x337efc=_0x23a5e0;_0x4cd364+=_0x337efc(0x1549)+_0x283a24['id']+_0x337efc(0x5a5)+_0x283a24[_0x337efc(0x1561)]+_0x337efc(0x10c1)+_0x283a24[_0x337efc(0x87b)]['toFixed'](0x2)+'\x0a';}));if(_0x3757da){const _0x2f2fab=localStorage[_0x23a5e0(0x5de)]('novelai-enabled')===_0x23a5e0(0x903),_0x30b72d=_0x44ce48['settings'][_0x23a5e0(0xf97)]||0x64,_0x2e5481=_0x44ce48[_0x23a5e0(0x450)]['offlineMaxLength']||0x12c,_0x3c3dc9=_0x44ce48['settings'][_0x23a5e0(0x1555)]||'我';let _0x151971='';if(_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x112a)]){const _0x9b52c5=_0x19ddb8[_0x23a5e0(0xded)][_0x23a5e0(0xd62)](_0x404df6=>_0x404df6['id']===_0x44ce48['settings'][_0x23a5e0(0x112a)]);if(_0x9b52c5&&Array['isArray'](_0x9b52c5[_0x23a5e0(0x4e3)])){const _0xd5d18d=_0x9b52c5[_0x23a5e0(0x4e3)][_0x23a5e0(0x1195)](_0x4d3067=>_0x4d3067[_0x23a5e0(0x15cd)]!==![])[_0x23a5e0(0xb0a)](_0xac7665=>'-\x20'+_0xac7665[_0x23a5e0(0x4e3)])[_0x23a5e0(0x3b9)]('\x0a');_0xd5d18d&&(_0x151971=_0x23a5e0(0xca1)+_0xd5d18d+'\x0a---\x0a');}}let _0x676502;_0x2f2fab?_0x676502='\x0a#\x20【格式铁律\x20(最高优先级：NovelAI\x20开启模式)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【必须包含且只能包含两个】元素，【严格按照】以下顺序:\x0a\x20\x20\x20\x201.\x20\x20第一个元素：一个\x20`offline_text`\x20对象，包含场景和对话。\x0a\x20\x20\x20\x202.\x20\x20第二个元素：一个\x20`naiimag`\x20对象，用于生成该场景的图片。\x0a2.\x20\x20**【【【绝对禁止】】】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】只返回一个\x20`offline_text`\x20元素。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】只返回一个\x20`naiimag`\x20元素。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】返回任何其他组合。你【必须】同时返回文字和图片。\x0a3.\x20\x20**【输出示例\x20(必须遵守)】**:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22offline_text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22「这是对话内容」...\x20(这里是动作和环境描写)...\x22\x0a\x20\x20\x20\x20\x20\x20},\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22naiimag\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22prompt\x22:\x20\x221girl,\x20solo,\x20detailed\x20anime\x20art\x20style,\x20(smiling:1.2),\x20sitting\x20in\x20a\x20cafe,\x20looking\x20at\x20viewer,\x20masterpiece,\x20best\x20quality,\x20...\x20(根据上面的文字内容生成详细的英文prompt)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a4.\x20\x20**【内容风格\x20(offline_text)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':_0x676502=_0x23a5e0(0xa56),_0x314bda='\x0a#\x20你的任务\x0a你现在正处于【线下剧情模式】，你需要扮演角色\x22'+_0x44ce48['originalName']+_0x23a5e0(0x4b2)+_0x151971+_0x23a5e0(0x10be)+_0x44ce48['settings'][_0x23a5e0(0x1c3)]+_0x23a5e0(0x4f1)+_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x1e3)]+_0x23a5e0(0x752)+(_0x44ce48[_0x23a5e0(0x450)]['enableTimePerception']?_0x23a5e0(0x992)+_0x2d4b9c+'\x20('+_0x27ba55+')':'')+_0x23a5e0(0x526)+_0x59a188+_0x23a5e0(0x716)+(_0x44ce48[_0x23a5e0(0x744)]&&_0x44ce48['longTermMemory'][_0x23a5e0(0x106b)]>0x0?_0x44ce48[_0x23a5e0(0x744)][_0x23a5e0(0xb0a)](_0x36e4da=>'-\x20'+_0x36e4da[_0x23a5e0(0x4e3)])[_0x23a5e0(0x3b9)]('\x0a'):_0x23a5e0(0xc55))+'\x0a\x0a'+_0x31e248+'\x0a-\x20**你们最后的对话摘要**:\x20\x0a'+_0x3f451f['map'](_0x32c320=>{const _0x2e8f5f=_0x23a5e0;let _0x3f852d=(_0x32c320[_0x2e8f5f(0x11c1)]===_0x2e8f5f(0x20d)?_0x3c3dc9:_0x44ce48[_0x2e8f5f(0x1561)])+':\x20';return _0x32c320[_0x2e8f5f(0x1508)]===_0x2e8f5f(0x12fb)?_0x3f852d+='「'+(_0x32c320[_0x2e8f5f(0x103d)]||'')+'」\x20'+(_0x32c320[_0x2e8f5f(0x3ef)]||''):_0x3f852d+=String(_0x32c320[_0x2e8f5f(0x4e3)]),_0x3f852d;})[_0x23a5e0(0x3b9)]('\x0a')+_0x23a5e0(0x72a)+_0x676502+_0x23a5e0(0x14bd)+_0x30b72d+'到'+_0x2e5481+_0x23a5e0(0x625),_0x4aa276=_0x3f451f[_0x23a5e0(0xb0a)](_0x1c6822=>{const _0x5548c6=_0x23a5e0;if(_0x1c6822[_0x5548c6(0x136e)])return null;if(_0x1c6822[_0x5548c6(0x1508)]==='offline_text'){const _0x3b2374=_0x1c6822[_0x5548c6(0x11c1)]===_0x5548c6(0x20d)?_0x44ce48['settings'][_0x5548c6(0x1555)]||'我':_0x44ce48[_0x5548c6(0x1561)];let _0x28f8e1='';if(_0x1c6822['content'])_0x28f8e1=_0x1c6822['content'];else{const _0x256173=_0x1c6822[_0x5548c6(0x103d)]?'「'+_0x1c6822[_0x5548c6(0x103d)]+'」':'',_0x37ada7=_0x1c6822[_0x5548c6(0x3ef)]?'('+_0x1c6822['description']+')':'';_0x28f8e1=(_0x256173+'\x20'+_0x37ada7)['trim']();}return{'role':_0x1c6822[_0x5548c6(0x11c1)],'content':_0x3b2374+':\x20'+_0x28f8e1};}if(_0x1c6822[_0x5548c6(0x11c1)]===_0x5548c6(0x20d)){const _0x2fc41c=_0x3c3dc9+':\x20';let _0x24578b='';if(Array[_0x5548c6(0xb9b)](_0x1c6822[_0x5548c6(0x4e3)])&&_0x1c6822[_0x5548c6(0x4e3)][0x0]?.[_0x5548c6(0x1508)]===_0x5548c6(0xae0))return{'role':_0x5548c6(0x20d),'content':[{'type':_0x5548c6(0x13ca),'text':_0x2fc41c},..._0x1c6822['content']]};if(_0x1c6822['quote']){const _0x95be40=String(_0x1c6822[_0x5548c6(0x6f7)]['content']||'')[_0x5548c6(0x72e)](0x0,0x32);_0x24578b+=_0x5548c6(0xbf3)+_0x1c6822[_0x5548c6(0x6f7)][_0x5548c6(0x1043)]+_0x5548c6(0xc70)+_0x95be40+'...\x22):\x20'+_0x1c6822[_0x5548c6(0x4e3)];}else _0x24578b+=_0x1c6822[_0x5548c6(0x4e3)];if(_0x1c6822[_0x5548c6(0x1508)]===_0x5548c6(0x9ee))return{'role':_0x5548c6(0x20d),'content':_0x2fc41c+'[你发送了一张需要AI识别的图片，图片内容是：\x27'+_0x1c6822[_0x5548c6(0x4e3)]+'\x27]'};if(_0x1c6822[_0x5548c6(0x1508)]===_0x5548c6(0x1207))return{'role':_0x5548c6(0x20d),'content':_0x2fc41c+'[你发送了一条语音消息，内容是：\x27'+_0x1c6822[_0x5548c6(0x4e3)]+'\x27]'};if(_0x1c6822[_0x5548c6(0x1508)]===_0x5548c6(0x4b3))return{'role':_0x5548c6(0x20d),'content':_0x2fc41c+_0x5548c6(0x7d7)+_0x1c6822[_0x5548c6(0xd73)]+_0x5548c6(0x14b0)+_0x1c6822['amount']+_0x5548c6(0x815)+_0x1c6822['note']+_0x5548c6(0xf4f)};if(_0x1c6822['type']===_0x5548c6(0x12ec))return{'role':'user','content':_0x2fc41c+_0x5548c6(0x7d7)+_0x1c6822[_0x5548c6(0xd73)]+_0x5548c6(0xe96)+_0x1c6822[_0x5548c6(0xd97)]+'”，金额是\x20'+_0x1c6822['amount']+_0x5548c6(0x15a2)};else{if(_0x1c6822[_0x5548c6(0x1508)]===_0x5548c6(0xf69)){const _0x19a6d8=_0x1c6822[_0x5548c6(0x1489)][_0x5548c6(0xb0a)](_0x2aa5c0=>_0x2aa5c0[_0x5548c6(0x1561)]+'\x20x'+_0x2aa5c0['quantity'])[_0x5548c6(0x3b9)]('、\x20');let _0x47b21b=_0x44ce48[_0x5548c6(0x136b)]?_0x5548c6(0x6a5)+_0x1c6822[_0x5548c6(0x6d2)][_0x5548c6(0xb0a)](_0x2db892=>_0x1e2056(_0x44ce48,_0x2db892))['join']('、\x20'):_0x5548c6(0x6a5)+_0x44ce48[_0x5548c6(0x1561)];return{'role':_0x5548c6(0x20d),'content':_0x2fc41c+'[系统提示：你\x20'+_0x47b21b+_0x5548c6(0x641)+_0x19a6d8+']'};}}if(_0x1c6822[_0x5548c6(0x7da)])return{'role':'user','content':_0x2fc41c+_0x5548c6(0xf64)+_0x1c6822[_0x5548c6(0x7da)]+'\x27]'};return{'role':_0x1c6822[_0x5548c6(0x11c1)],'content':_0x2fc41c+_0x24578b};}else{if(_0x1c6822[_0x5548c6(0x11c1)]==='assistant'){let _0x21f6d4={'type':_0x1c6822[_0x5548c6(0x1508)]||'text'};if(_0x1c6822[_0x5548c6(0x1508)]==='sticker')_0x21f6d4['url']=_0x1c6822[_0x5548c6(0x4e3)],_0x21f6d4[_0x5548c6(0x7da)]=_0x1c6822[_0x5548c6(0x7da)];else{if(_0x1c6822[_0x5548c6(0x1508)]===_0x5548c6(0x4b3))_0x21f6d4[_0x5548c6(0x11fa)]=_0x1c6822['amount'],_0x21f6d4[_0x5548c6(0x1436)]=_0x1c6822[_0x5548c6(0x1436)];else _0x1c6822[_0x5548c6(0x1508)]===_0x5548c6(0x12ec)?(_0x21f6d4[_0x5548c6(0xd97)]=_0x1c6822['productInfo'],_0x21f6d4[_0x5548c6(0x11fa)]=_0x1c6822[_0x5548c6(0x11fa)]):_0x1c6822[_0x5548c6(0x6f7)]?_0x21f6d4[_0x5548c6(0xe7b)]={'target_sender':_0x1c6822[_0x5548c6(0x6f7)][_0x5548c6(0x1043)],'target_content':_0x1c6822[_0x5548c6(0x6f7)][_0x5548c6(0x4e3)],'reply_content':_0x1c6822['content']}:_0x21f6d4[_0x5548c6(0x4e3)]=_0x1c6822[_0x5548c6(0x4e3)];}const _0x2604ab=JSON[_0x5548c6(0xe1e)]([_0x21f6d4]);return{'role':_0x5548c6(0x115c),'content':_0x5548c6(0x1249)+_0x1c6822[_0x5548c6(0xd73)]+')\x20'+_0x2604ab};}}return null;})[_0x23a5e0(0x1195)](Boolean);}else{let _0x56f177='';_0x44ce48[_0x23a5e0(0x1058)]&&_0x44ce48[_0x23a5e0(0x1058)]['length']>0x0&&(_0x56f177=_0x23a5e0(0x1104)+_0x44ce48[_0x23a5e0(0x1058)][_0x23a5e0(0x3b9)](',\x20')+_0x23a5e0(0x8dd));let _0x248794='';const _0x47a41a=_0x19ddb8[_0x23a5e0(0x9ce)][_0x23a5e0(0x246)]||'用户';_0x248794+=_0x23a5e0(0xbb9)+_0x47a41a+'\x22。\x0a';const _0x5a5606=Object[_0x23a5e0(0xea1)](_0x19ddb8[_0x23a5e0(0xb04)]),_0x12887b=_0x5a5606[_0x23a5e0(0x1195)](_0xc9dc3a=>_0xc9dc3a[_0x23a5e0(0x136b)]&&_0xc9dc3a[_0x23a5e0(0xcca)][_0x23a5e0(0x336)](_0x445248=>_0x445248['id']===_0x44ce48['id']));_0x12887b[_0x23a5e0(0x106b)]>0x0&&(_0x248794+=_0x23a5e0(0xe62),_0x12887b[_0x23a5e0(0x15c1)](_0x491543=>{const _0x4a684a=_0x23a5e0,_0xfc39d7=_0x491543[_0x4a684a(0x450)][_0x4a684a(0x1555)]||_0x47a41a;_0x248794+=_0x4a684a(0x59e)+_0x491543[_0x4a684a(0x1561)]+_0x4a684a(0x9b7)+_0xfc39d7+_0x4a684a(0x38b);}));_0x248794+=_0x23a5e0(0x1350);let _0x321f9c='';const _0x4e390a=_0x5a5606['filter'](_0x51f0f4=>!_0x51f0f4['isGroup']&&_0x51f0f4['id']!==_0x44ce48['id']&&_0x51f0f4['groupId']===_0x44ce48[_0x23a5e0(0x4ab)]&&_0x44ce48[_0x23a5e0(0x4ab)]!==null);_0x4e390a[_0x23a5e0(0x106b)]>0x0&&(_0x321f9c+=_0x23a5e0(0xe6c),_0x4e390a[_0x23a5e0(0x15c1)](_0x2d5267=>{const _0x4654a6=_0x23a5e0;_0x321f9c+=_0x4654a6(0x1103)+_0x2d5267['name']+_0x4654a6(0xb33)+_0x2d5267[_0x4654a6(0x339)]+')\x0a';}));const _0x3f7ce3=await _0x512070[_0x23a5e0(0x10e5)][_0x23a5e0(0x1404)]('timestamp')[_0x23a5e0(0x333)]()[_0x23a5e0(0x10d1)](0xa)[_0x23a5e0(0x591)](),_0x58e236=_0x35b975(_0x3f7ce3,_0x44ce48);let _0x16291d='';if(_0x58e236['length']>0x0){_0x16291d='\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a';const _0xdd8e25=_0x44ce48[_0x23a5e0(0x339)];for(const _0x4a1029 of _0x58e236){let _0x404417;if(_0x4a1029[_0x23a5e0(0x82c)]===_0x23a5e0(0x20d))_0x404417=_0x19ddb8['qzoneSettings'][_0x23a5e0(0x246)];else{if(String(_0x4a1029[_0x23a5e0(0x82c)])[_0x23a5e0(0x608)](_0x23a5e0(0x136f)))_0x404417=_0x4a1029['authorOriginalName']||_0x23a5e0(0xba7);else{const _0x2de79c=_0x19ddb8[_0x23a5e0(0xb04)][_0x4a1029['authorId']];_0x404417=_0x2de79c?_0x2de79c['name']:'一位朋友';}}if(_0x4a1029[_0x23a5e0(0x82c)]===_0x1e2092)_0x404417+=_0x23a5e0(0x15de);let _0xc605d2;if(_0x4a1029[_0x23a5e0(0x1508)]===_0x23a5e0(0x5ee)){const _0x464565=_0x4a1029[_0x23a5e0(0x3eb)]?_0x23a5e0(0xd9a)+_0x4a1029[_0x23a5e0(0x3eb)]+'\x22':'';let _0x6cd5b5=_0x23a5e0(0x423);const _0x8a9a03=_0x4a1029[_0x23a5e0(0x327)][_0x23a5e0(0x82c)];if(_0x8a9a03===_0x23a5e0(0x20d))_0x6cd5b5=_0x19ddb8[_0x23a5e0(0x9ce)][_0x23a5e0(0x246)];else _0x19ddb8[_0x23a5e0(0xb04)][_0x8a9a03]&&(_0x6cd5b5=_0x19ddb8[_0x23a5e0(0xb04)][_0x8a9a03]['name']);let _0x449e6e;const _0x45da4b=_0x4a1029[_0x23a5e0(0x327)];if(_0x45da4b[_0x23a5e0(0x1508)]==='text_image')_0x449e6e='[文字图]\x20'+(_0x45da4b[_0x23a5e0(0x6b9)]||'')+_0x23a5e0(0x8b2)+(_0x45da4b[_0x23a5e0(0x14bb)]||'')['substring'](0x0,0x28)+_0x23a5e0(0x6ca);else _0x45da4b['type']===_0x23a5e0(0x1016)?_0x449e6e=_0x23a5e0(0xe48)+(_0x45da4b[_0x23a5e0(0x6b9)]||'')+_0x23a5e0(0x8b2)+(_0x45da4b[_0x23a5e0(0xbea)]||'')[_0x23a5e0(0x72e)](0x0,0x28)+_0x23a5e0(0x6ca):_0x449e6e='\x22'+(_0x45da4b['content']||'')['substring'](0x0,0x28)+_0x23a5e0(0x76a);_0xc605d2=_0x23a5e0(0xa3c)+_0x6cd5b5+'\x20的动态\x20'+_0x464565+'【原动态内容:\x20'+_0x449e6e+'】';}else{if(_0x4a1029[_0x23a5e0(0x1508)]===_0x23a5e0(0x1281))_0xc605d2=(_0x23a5e0(0x962)+_0x4a1029['hiddenContent']+_0x23a5e0(0x3fc)+(_0x4a1029[_0x23a5e0(0x6b9)]||''))[_0x23a5e0(0x72e)](0x0,0x32)+'...';else{if(_0x4a1029[_0x23a5e0(0x1508)]===_0x23a5e0(0x1016))_0xc605d2=('[一张图片，描述为：\x22'+_0x4a1029[_0x23a5e0(0xbea)]+'\x22]\x20'+(_0x4a1029[_0x23a5e0(0x6b9)]||''))['substring'](0x0,0x32)+_0x23a5e0(0x4a5);else{if(_0x4a1029[_0x23a5e0(0x1508)]===_0x23a5e0(0x1300)&&_0x4a1029[_0x23a5e0(0x3a1)]){const _0x9cc64=Array[_0x23a5e0(0xb9b)](_0x4a1029[_0x23a5e0(0x3a1)])?_0x4a1029[_0x23a5e0(0x3a1)]:[_0x4a1029['prompt']];_0xc605d2=(_0x4a1029[_0x23a5e0(0x6b9)]||'')+(_0x23a5e0(0x16f)+_0x9cc64[_0x23a5e0(0x106b)]+_0x23a5e0(0x360)+_0x9cc64[_0x23a5e0(0x3b9)](',\x20')+']');}else _0xc605d2=String(_0x4a1029[_0x23a5e0(0x6b9)]||_0x4a1029['content']||_0x23a5e0(0xf51))[_0x23a5e0(0x72e)](0x0,0x32)+_0x23a5e0(0x4a5);}}}_0x16291d+=_0x23a5e0(0x1549)+_0x4a1029['id']+_0x23a5e0(0x11af)+_0x404417+',\x20内容:\x20\x22'+_0xc605d2+'\x22\x0a';if(_0x4a1029['comments']&&_0x4a1029[_0x23a5e0(0xc79)][_0x23a5e0(0x106b)]>0x0)for(const _0x222adc of _0x4a1029[_0x23a5e0(0xc79)]){if(typeof _0x222adc===_0x23a5e0(0x12fe)&&_0x222adc[_0x23a5e0(0x1200)]){const _0x60e5a5=_0x2e9dd1(_0x222adc[_0x23a5e0(0x1200)]);let _0x35e524=_0x222adc[_0x23a5e0(0x7da)]?_0x23a5e0(0xf94)+_0x222adc[_0x23a5e0(0x7da)]+'\x27]':_0x222adc[_0x23a5e0(0x13ca)];_0x222adc[_0x23a5e0(0x1200)]===_0xdd8e25?_0x16291d+=_0x23a5e0(0x1304)+_0x35e524+'\x0a':_0x16291d+=_0x23a5e0(0x8c1)+_0x60e5a5+_0x23a5e0(0x1bd)+_0x222adc['commenterName']+_0x23a5e0(0x41b)+_0x35e524+'\x0a';}}}}const _0x597e4f=_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x1555)]||'我';let _0x439b72='',_0x356235=![];if(_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x2de)]){const _0x362b25=_0x3f451f[_0x23a5e0(0xbb3)](_0x304180=>_0x304180[_0x23a5e0(0x11c1)]==='user'&&!_0x304180[_0x23a5e0(0x136e)]),_0xdaf5e6=_0x3f451f[_0x23a5e0(0xbb3)](_0x39d4ca=>_0x39d4ca[_0x23a5e0(0x11c1)]==='assistant'&&!_0x39d4ca[_0x23a5e0(0x136e)]);if(_0x362b25){const _0x42c505=_0x4c879a(_0x362b25[_0x23a5e0(0xd73)]);if(_0xdaf5e6){const _0x4b118b=_0x4c879a(_0xdaf5e6['timestamp']);_0x439b72='-\x20**对话状态**:\x20你的上一条消息发送于\x20'+_0x4b118b+'，用户刚刚在\x20'+_0x42c505+_0x23a5e0(0xfd3);const _0x563861=(_0x362b25[_0x23a5e0(0xd73)]-_0xdaf5e6[_0x23a5e0(0xd73)])/(0x3e8*0x3c*0x3c);if(_0x563861>0x3){_0x356235=!![];const _0x52ecf3=Math['floor'](_0x563861/0x18);_0x439b72+=_0x23a5e0(0x4d0)+(_0x52ecf3>0x0?_0x52ecf3+'天':Math[_0x23a5e0(0xd95)](_0x563861)+'小时')+_0x23a5e0(0x686)+_0x27ba55+'）的话题来问候用户，可以表达惊讶（“哇，好久不见！”）、关心（“最近怎么样？”）或者分享你自己的近况，绝对不要延续之前的话题！\x0a-\x20**上下文参考**:\x20下面的“对话历史”仅供你回忆，【不要】直接回应其中的内容。';}}else _0x439b72=_0x23a5e0(0x13d5)+_0x42c505+'。';}else _0x439b72=_0x23a5e0(0x8f1);}const _0xb1a2c5=_0x449f61(_0x1e2092),_0x199a41=_0x54310e(_0x44ce48,0x3,_0x23a5e0(0xb41)),_0x6799e=_0x54310e(_0x44ce48,0x6,_0x23a5e0(0xb41)),_0x37750e=_0x54310e(_0x44ce48,0x9,_0x23a5e0(0xb41)),_0xd1ed74=_0x54310e(_0x44ce48,0x1,_0x23a5e0(0x113c)),_0x5cc832=_0x54310e(_0x44ce48,0x3,'days'),_0xd6553f=_0x54310e(_0x44ce48,0x7,'days');let _0x27a05c='';if(_0x199a41||_0x6799e||_0x37750e||_0xd1ed74||_0x5cc832||_0xd6553f){_0x27a05c+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x199a41)_0x27a05c+=_0x199a41;if(_0x6799e)_0x27a05c+=_0x6799e;if(_0x37750e)_0x27a05c+=_0x37750e;if(_0x199a41||_0x6799e||_0x37750e)_0x27a05c+='\x0a';if(_0xd1ed74)_0x27a05c+=_0xd1ed74;if(_0x5cc832)_0x27a05c+=_0x5cc832;if(_0xd6553f)_0x27a05c+=_0xd6553f;}_0x314bda=_0x23a5e0(0x458)+_0x44ce48[_0x23a5e0(0x339)]+_0x23a5e0(0x1068)+_0x44ce48[_0x23a5e0(0x450)]['aiPersona']+'\x0a'+_0x430104+_0x23a5e0(0x101f)+_0x44ce48[_0x23a5e0(0x450)]['myPersona']+_0x23a5e0(0x986)+(_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x2de)]?'-\x20**当前时间**:\x20'+_0x2d4b9c+'\x20('+_0x27ba55+')':'')+'\x0a'+_0x439b72+'\x0a#\x20世界观\x20(必须严格遵守)\x0a'+_0x59a188+'\x0a'+_0x31e248+'\x0a#\x20长期记忆\x20(必须严格遵守)\x0a'+(_0x44ce48[_0x23a5e0(0x744)]&&_0x44ce48[_0x23a5e0(0x744)][_0x23a5e0(0x106b)]>0x0?_0x44ce48[_0x23a5e0(0x744)][_0x23a5e0(0xb0a)](_0x2af3b4=>'-\x20'+_0x2af3b4[_0x23a5e0(0x4e3)])[_0x23a5e0(0x3b9)]('\x0a'):'-\x20(暂无)')+'\x0a'+_0x27a05c+_0x23a5e0(0x11c0)+_0x44ce48[_0x23a5e0(0x339)]+_0x23a5e0(0x26e)+_0x44ce48[_0x23a5e0(0x1561)]+_0x23a5e0(0x4f0)+_0x597e4f+'”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20'+_0x248794+_0x23a5e0(0x379)+_0x56f177+_0x23a5e0(0x1052)+_0x2c5544+'\x0a'+_0x17c045+'\x0a'+_0x47af46+_0x23a5e0(0xdce)+_0x321f9c+'\x0a'+_0x16291d+'\x0a\x0a#\x20情景感知:\x0a\x20\x20\x20\x20'+(_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x2de)]?_0x23a5e0(0x1f7)+_0x2d4b9c+'\x20('+_0x27ba55+')，并在对话中自然地体现出来。':'')+_0x23a5e0(0x618)+(_0x125a7c?_0x23a5e0(0x671)+_0x125a7c:_0x23a5e0(0x1078))+'\x0a\x20\x20\x20\x20-\x20**读书**:\x20'+(_0xb1a2c5?_0x23a5e0(0xf5c)+_0xb1a2c5:_0x23a5e0(0xe1a))+'\x0a\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20'+(_0x44ce48[_0x23a5e0(0x450)]['aiAvatarLibrary']&&_0x44ce48[_0x23a5e0(0x450)]['aiAvatarLibrary'][_0x23a5e0(0x106b)]>0x0?_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0xea2)][_0x23a5e0(0xb0a)](_0x565215=>'-\x20'+_0x565215[_0x23a5e0(0x1561)])['join']('\x0a'):'-\x20(空)')+_0x23a5e0(0x11a8)+(_0x44ce48[_0x23a5e0(0x450)]['myAvatarLibrary']&&_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0xa70)][_0x23a5e0(0x106b)]>0x0?_0x44ce48['settings'][_0x23a5e0(0xa70)][_0x23a5e0(0xb0a)](_0x5ef454=>'-\x20'+_0x5ef454[_0x23a5e0(0x1561)])[_0x23a5e0(0x3b9)]('\x0a'):_0x23a5e0(0xb75))+_0x23a5e0(0x11da)+_0x44d56b+_0x23a5e0(0xa0d)+_0x44ce48['originalName']+'\x22:\x20\x22你此时的详细内心活动...\x22}}`**\x0a\x20\x20\x20\x20-\x20\x20\x20**analysis**:\x20简要分析用户的意图或聊天的氛围。\x0a\x20\x20\x20\x20-\x20\x20\x20**strategy**:\x20你的计划（例如：安抚用户、转移话题、发起一个功能）。\x0a\x20\x20\x20\x20-\x20\x20\x20**character_thoughts**:\x20必须包含一个以你本名\x20(\x22'+_0x44ce48[_0x23a5e0(0x339)]+_0x23a5e0(0x146d)+(localStorage[_0x23a5e0(0x5de)](_0x23a5e0(0x95b))===_0x23a5e0(0x903)?'-\x20\x20\x20**NovelAI真实图片分享\x20(在聊天中直接发送)**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20-\x20**【绝不能暴露是novelai生成的图片！】\x0a\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20-\x20使用场景：当你想要在【私聊对话中】直接给用户发送一张图片时使用。\x0a\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。\x0a\x20\x20\x20\x20-\x20注意：这会直接在聊天记录中显示图片，而不是发布到动态。':'')+'\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后立刻撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22content\x22:\x20\x22你想让AI说出后立刻消失的话\x22}`\x20(用于模拟说错话、后悔等场景，消息会短暂出现后自动变为“已撤回”)\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**发动态(说说)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22文字内容\x22}]`\x0a-\x20\x20\x20**发动态(文字图)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22图片描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]`\x0a'+(localStorage[_0x23a5e0(0x5de)](_0x23a5e0(0x95b))==='true'?'-\x20\x20\x20**公开发布NovelAI真实图片动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20[\x22图片1详细英文描述\x22,\x20\x22图片2详细英文描述\x22]}`\x20\x0a\x20\x20*\x20**prompt撰写**：你可以根据当前对话上下文、你的角色人设、以及你想表达的情感和氛围，来撰写详细而具体的prompt。详细程度由你根据具体情况自己决定，并不强制。\x0a\x20\x20*\x20例如：\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22':'')+_0x23a5e0(0x490)+_0x44ce48[_0x23a5e0(0x339)]+_0x23a5e0(0xb51)+_0x44ce48[_0x23a5e0(0x339)]+'\x22,\x20\x22postId\x22:\x20456,\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20回复:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22'+_0x44ce48['originalName']+_0x23a5e0(0x85a)+_0x44ce48[_0x23a5e0(0x339)]+_0x23a5e0(0x562),_0x4aa276=_0x3f451f[_0x23a5e0(0xb0a)](_0x4d3dcf=>{const _0x3ff501=_0x23a5e0;if(_0x4d3dcf[_0x3ff501(0x136e)]&&_0x4d3dcf[_0x3ff501(0x11c1)]===_0x3ff501(0xe10))return{'role':_0x3ff501(0x20d),'content':_0x4d3dcf[_0x3ff501(0x4e3)]};else{if(_0x4d3dcf['isHidden'])return null;}if(_0x4d3dcf[_0x3ff501(0x1508)]===_0x3ff501(0x12fb)){const _0x197b5d=_0x4d3dcf[_0x3ff501(0x11c1)]==='user'?_0x44ce48[_0x3ff501(0x450)][_0x3ff501(0x1555)]||'我':_0x44ce48[_0x3ff501(0x1561)];let _0x5cd0b9='';if(_0x4d3dcf[_0x3ff501(0x4e3)])_0x5cd0b9=_0x4d3dcf[_0x3ff501(0x4e3)];else{const _0x1e6d48=_0x4d3dcf[_0x3ff501(0x103d)]?'「'+_0x4d3dcf[_0x3ff501(0x103d)]+'」':'',_0x4c77c1=_0x4d3dcf['description']?'('+_0x4d3dcf[_0x3ff501(0x3ef)]+')':'';_0x5cd0b9=(_0x1e6d48+'\x20'+_0x4c77c1)[_0x3ff501(0x13f9)]();}return{'role':_0x4d3dcf[_0x3ff501(0x11c1)],'content':_0x3ff501(0x1249)+_0x4d3dcf[_0x3ff501(0xd73)]+')\x20'+_0x197b5d+':\x20'+_0x5cd0b9};}if(_0x4d3dcf[_0x3ff501(0x11c1)]===_0x3ff501(0x20d)){const _0x520f25=_0x3ff501(0x1249)+_0x4d3dcf[_0x3ff501(0xd73)]+')\x20';let _0xa9b8ab='';if(Array[_0x3ff501(0xb9b)](_0x4d3dcf['content'])&&_0x4d3dcf[_0x3ff501(0x4e3)][0x0]?.[_0x3ff501(0x1508)]==='image_url')return{'role':'user','content':[{'type':_0x3ff501(0x13ca),'text':_0x520f25},..._0x4d3dcf['content']]};if(_0x4d3dcf[_0x3ff501(0x6f7)]){const _0x97d1=String(_0x4d3dcf['quote'][_0x3ff501(0x4e3)]||'')[_0x3ff501(0x72e)](0x0,0x32);_0xa9b8ab+=_0x3ff501(0xbf3)+_0x4d3dcf['quote']['senderName']+_0x3ff501(0xc70)+_0x97d1+_0x3ff501(0x7df)+_0x4d3dcf[_0x3ff501(0x4e3)];}else _0xa9b8ab+=_0x4d3dcf[_0x3ff501(0x4e3)];if(_0x4d3dcf[_0x3ff501(0x1508)]==='user_photo')return{'role':_0x3ff501(0x20d),'content':_0x520f25+_0x3ff501(0x18e)+_0x4d3dcf['content']+'\x27]'};if(_0x4d3dcf[_0x3ff501(0x1508)]===_0x3ff501(0x1207))return{'role':_0x3ff501(0x20d),'content':_0x520f25+_0x3ff501(0x251)+_0x4d3dcf[_0x3ff501(0x4e3)]+'\x27]'};if(_0x4d3dcf[_0x3ff501(0x1508)]===_0x3ff501(0x4b3))return{'role':_0x3ff501(0x20d),'content':_0x520f25+_0x3ff501(0x7d7)+_0x4d3dcf[_0x3ff501(0xd73)]+_0x3ff501(0x14b0)+_0x4d3dcf[_0x3ff501(0x11fa)]+_0x3ff501(0x815)+_0x4d3dcf[_0x3ff501(0x1436)]+_0x3ff501(0xf4f)};if(_0x4d3dcf[_0x3ff501(0x1508)]===_0x3ff501(0x12ec))return{'role':_0x3ff501(0x20d),'content':_0x520f25+_0x3ff501(0x7d7)+_0x4d3dcf[_0x3ff501(0xd73)]+_0x3ff501(0xe96)+_0x4d3dcf['productInfo']+_0x3ff501(0xae3)+_0x4d3dcf[_0x3ff501(0x11fa)]+_0x3ff501(0x15a2)};else{if(_0x4d3dcf[_0x3ff501(0x1508)]===_0x3ff501(0xf69)){const _0x5eb429=_0x4d3dcf[_0x3ff501(0x1489)]['map'](_0x517357=>_0x517357[_0x3ff501(0x1561)]+'\x20x'+_0x517357[_0x3ff501(0x1485)])[_0x3ff501(0x3b9)]('、\x20');let _0x375933=_0x44ce48['isGroup']?'送给了\x20'+_0x4d3dcf[_0x3ff501(0x6d2)][_0x3ff501(0xb0a)](_0x3d6afd=>_0x1e2056(_0x44ce48,_0x3d6afd))[_0x3ff501(0x3b9)]('、\x20'):'送给了\x20'+_0x44ce48['name'];return{'role':_0x3ff501(0x20d),'content':_0x520f25+'[系统提示：你\x20'+_0x375933+_0x3ff501(0x641)+_0x5eb429+']'};}}if(_0x4d3dcf[_0x3ff501(0x7da)])return{'role':_0x3ff501(0x20d),'content':_0x520f25+_0x3ff501(0xf64)+_0x4d3dcf['meaning']+'\x27]'};return{'role':_0x4d3dcf[_0x3ff501(0x11c1)],'content':_0x520f25+_0xa9b8ab};}else{if(_0x4d3dcf['role']==='assistant'){let _0x475a30={'type':_0x4d3dcf['type']||'text'};if(_0x4d3dcf['type']==='sticker')_0x475a30['url']=_0x4d3dcf[_0x3ff501(0x4e3)],_0x475a30[_0x3ff501(0x7da)]=_0x4d3dcf[_0x3ff501(0x7da)];else{if(_0x4d3dcf[_0x3ff501(0x1508)]===_0x3ff501(0x4b3))_0x475a30[_0x3ff501(0x11fa)]=_0x4d3dcf['amount'],_0x475a30[_0x3ff501(0x1436)]=_0x4d3dcf[_0x3ff501(0x1436)];else _0x4d3dcf[_0x3ff501(0x1508)]==='waimai_request'?(_0x475a30[_0x3ff501(0xd97)]=_0x4d3dcf[_0x3ff501(0xd97)],_0x475a30[_0x3ff501(0x11fa)]=_0x4d3dcf[_0x3ff501(0x11fa)]):_0x4d3dcf[_0x3ff501(0x6f7)]?_0x475a30[_0x3ff501(0xe7b)]={'target_sender':_0x4d3dcf[_0x3ff501(0x6f7)]['senderName'],'target_content':_0x4d3dcf['quote'][_0x3ff501(0x4e3)],'reply_content':_0x4d3dcf[_0x3ff501(0x4e3)]}:_0x475a30[_0x3ff501(0x4e3)]=_0x4d3dcf[_0x3ff501(0x4e3)];}const _0xcab1ac=JSON['stringify']([_0x475a30]);return{'role':'assistant','content':_0x3ff501(0x1249)+_0x4d3dcf['timestamp']+')\x20'+_0xcab1ac};}}return null;})[_0x23a5e0(0x1195)](Boolean);if(!_0x44ce48[_0x23a5e0(0x136b)]&&_0x44ce48[_0x23a5e0(0x239)]?.[_0x23a5e0(0x27d)]===_0x23a5e0(0xfd1)){const _0xc99296=_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0x1195)](_0x6af800=>!_0x6af800['isHidden'])[_0x23a5e0(0x457)](-0xa)[_0x23a5e0(0xb0a)](_0x49056a=>{const _0x10502e=_0x23a5e0,_0x2aa0d7=_0x49056a[_0x10502e(0x11c1)]===_0x10502e(0x20d)?'用户':_0x44ce48[_0x10502e(0x1561)];return _0x2aa0d7+':\x20'+String(_0x49056a['content'])[_0x10502e(0x72e)](0x0,0x32)+_0x10502e(0x4a5);})[_0x23a5e0(0x3b9)]('\x0a'),_0x1ce9da={'role':'user','content':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20[系统重要指令]\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户向你发送了好友申请，理由是：“'+_0x44ce48['relationship'][_0x23a5e0(0x351)]+_0x23a5e0(0x1475)+_0xc99296+_0x23a5e0(0xb72)};_0x4aa276[_0x23a5e0(0x1c4)](_0x1ce9da);}}}let _0x3b1ac2=_0x29d171===GEMINI_API_URL,_0x400f9d=_0x366263(_0x2bc73b,_0x502385,_0x314bda,_0x4aa276),_0xa7a028;try{_0xa7a028=_0x3b1ac2?await fetch(_0x400f9d[_0x23a5e0(0x121f)],_0x400f9d[_0x23a5e0(0x38c)]):await fetch(_0x29d171+'/v1/chat/completions',{'method':_0x23a5e0(0x12db),'headers':{'Content-Type':_0x23a5e0(0xb1f),'Authorization':'Bearer\x20'+_0x502385},'body':JSON['stringify']({'model':_0x2bc73b,'messages':[{'role':_0x23a5e0(0xe10),'content':_0x314bda},..._0x4aa276],'temperature':_0x19ddb8[_0x23a5e0(0x4c8)][_0x23a5e0(0x4a2)]||0.8,'stream':![]})});}catch(_0x306160){throw new Error(_0x23a5e0(0x5c5)+_0x306160[_0x23a5e0(0xcce)]);}if(!_0xa7a028['ok']){let _0x6fa3cf=_0x23a5e0(0x7c5)+_0xa7a028[_0x23a5e0(0x27d)]+'\x20'+_0xa7a028[_0x23a5e0(0x140e)];try{const _0xff3a5a=await _0xa7a028[_0x23a5e0(0xa5d)]();_0xff3a5a[_0x23a5e0(0x3b7)]&&_0xff3a5a[_0x23a5e0(0x3b7)]['message']?_0x6fa3cf+='\x20-\x20'+_0xff3a5a['error']['message']:_0x6fa3cf+='\x20-\x20'+JSON[_0x23a5e0(0xe1e)](_0xff3a5a);}catch(_0x25d4a2){_0x6fa3cf+=_0x23a5e0(0x68d)+await _0xa7a028[_0x23a5e0(0x13ca)]();}throw new Error(_0x6fa3cf);}const _0xfdbfb3=await _0xa7a028[_0x23a5e0(0xa5d)](),_0x115730=getGeminiResponseText(_0xfdbfb3);lastRawAiResponse=_0x115730,lastResponseTimestamps=[],_0x44ce48['history']=_0x44ce48[_0x23a5e0(0x1f0)]['filter'](_0x131d81=>!_0x131d81[_0x23a5e0(0x13c1)]);const _0x4129d2=_0x189ab1(_0x115730);let _0x4039ae=[];if(_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x1267)]){let _0x1e062e={'content':[],'dialogue':[],'description':[]};for(const _0x6063d4 of _0x4129d2){if(_0x6063d4['type']===_0x23a5e0(0x12fb)){if(_0x6063d4[_0x23a5e0(0x4e3)])_0x1e062e[_0x23a5e0(0x4e3)][_0x23a5e0(0x1c4)](_0x6063d4[_0x23a5e0(0x4e3)]);else{if(_0x6063d4[_0x23a5e0(0x103d)])_0x1e062e['dialogue'][_0x23a5e0(0x1c4)](_0x6063d4[_0x23a5e0(0x103d)]);if(_0x6063d4['description'])_0x1e062e[_0x23a5e0(0x3ef)][_0x23a5e0(0x1c4)](_0x6063d4['description']);}}else(_0x1e062e['content'][_0x23a5e0(0x106b)]>0x0||_0x1e062e['dialogue']['length']>0x0||_0x1e062e['description']['length']>0x0)&&(_0x1e062e[_0x23a5e0(0x4e3)][_0x23a5e0(0x106b)]>0x0&&_0x4039ae[_0x23a5e0(0x1c4)]({'type':'offline_text','content':_0x1e062e[_0x23a5e0(0x4e3)][_0x23a5e0(0x3b9)]('\x0a')}),(_0x1e062e[_0x23a5e0(0x103d)][_0x23a5e0(0x106b)]>0x0||_0x1e062e['description'][_0x23a5e0(0x106b)]>0x0)&&_0x4039ae[_0x23a5e0(0x1c4)]({'type':'offline_text','dialogue':_0x1e062e[_0x23a5e0(0x103d)][_0x23a5e0(0x3b9)]('\x0a'),'description':_0x1e062e[_0x23a5e0(0x3ef)][_0x23a5e0(0x3b9)]('\x0a')}),_0x1e062e={'content':[],'dialogue':[],'description':[]}),_0x4039ae[_0x23a5e0(0x1c4)](_0x6063d4);}_0x1e062e[_0x23a5e0(0x4e3)][_0x23a5e0(0x106b)]>0x0&&_0x4039ae[_0x23a5e0(0x1c4)]({'type':'offline_text','content':_0x1e062e['content'][_0x23a5e0(0x3b9)]('\x0a')}),(_0x1e062e[_0x23a5e0(0x103d)]['length']>0x0||_0x1e062e[_0x23a5e0(0x3ef)][_0x23a5e0(0x106b)]>0x0)&&_0x4039ae[_0x23a5e0(0x1c4)]({'type':_0x23a5e0(0x12fb),'dialogue':_0x1e062e[_0x23a5e0(0x103d)][_0x23a5e0(0x3b9)]('\x0a'),'description':_0x1e062e['description']['join']('\x0a')});}else _0x4039ae=_0x4129d2;const _0x26e56e=_0x44ce48['history'][_0x23a5e0(0x1195)](_0x167caa=>_0x167caa[_0x23a5e0(0x11c1)]===_0x23a5e0(0x20d)&&!_0x167caa[_0x23a5e0(0x136e)])[_0x23a5e0(0x144a)]();if(_0x26e56e&&Array[_0x23a5e0(0xb9b)](_0x26e56e[_0x23a5e0(0x4e3)])&&_0x26e56e[_0x23a5e0(0x4e3)][0x0]?.[_0x23a5e0(0x1508)]===_0x23a5e0(0xae0)&&!_0x26e56e[_0x23a5e0(0xc2d)]){const _0x36a97b=_0x4129d2[_0x23a5e0(0xd62)](_0x4427d8=>_0x4427d8[_0x23a5e0(0x1508)]==='text');let _0x3ccef8;_0x36a97b&&(_0x36a97b[_0x23a5e0(0x4e3)]||_0x36a97b[_0x23a5e0(0xcce)])?_0x3ccef8=String(_0x36a97b[_0x23a5e0(0x4e3)]||_0x36a97b[_0x23a5e0(0xcce)])['trim']():_0x3ccef8='AI已接收并理解了该图片的内容。';const _0x24e9ba=_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0x455)](_0xe7aa22=>_0xe7aa22[_0x23a5e0(0xd73)]===_0x26e56e[_0x23a5e0(0xd73)]);if(_0x24e9ba>-0x1){console[_0x23a5e0(0xe4d)]('识图优化：正在将时间戳为\x20'+_0x26e56e['timestamp']+_0x23a5e0(0x882));const _0x278ed8=_0x23a5e0(0xf21)+_0x3ccef8+'”]';_0x44ce48[_0x23a5e0(0x1f0)][_0x24e9ba][_0x23a5e0(0x4e3)]=_0x278ed8,_0x44ce48['history'][_0x24e9ba][_0x23a5e0(0xc2d)]=!![],_0x44ce48['history'][_0x24e9ba][_0x23a5e0(0x1508)]=_0x23a5e0(0x13ca);}}const _0x467872=document[_0x23a5e0(0x9a3)](_0x23a5e0(0x3e5))[_0x23a5e0(0x4d8)][_0x23a5e0(0x1222)](_0x23a5e0(0xe9f))&&_0x19ddb8[_0x23a5e0(0x859)]===_0x1e2092;let _0x512fbf=![],_0x164c31=Date[_0x23a5e0(0x64b)](),_0x27f74e=[],_0x456f55=![];for(const _0x44194e of _0x4039ae){if(_0x44194e['type']==='thought_chain'){console['log'](_0x23a5e0(0xec0),_0x44194e);const _0xc8eded=_0x23a5e0(0xe14)+(_0x44194e[_0x23a5e0(0xdcc)]||'无')+_0x23a5e0(0x15a8)+(_0x44194e[_0x23a5e0(0x957)]||'无')+_0x23a5e0(0x1209)+JSON[_0x23a5e0(0xe1e)](_0x44194e[_0x23a5e0(0x12a6)]||{}),_0x1f695d={'role':_0x23a5e0(0xe10),'content':_0xc8eded,'timestamp':_0x164c31++,'isHidden':!![]};_0x44ce48['history']['push'](_0x1f695d),lastResponseTimestamps[_0x23a5e0(0x1c4)](_0x1f695d[_0x23a5e0(0xd73)]);continue;}_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x1547)]!==![]&&_0x44194e['type']===_0x23a5e0(0x13ca)&&typeof _0x44194e[_0x23a5e0(0x4e3)]==='string'&&_0x44194e[_0x23a5e0(0x4e3)]['trim']()[_0x23a5e0(0x608)](_0x23a5e0(0x266))&&(_0x44194e['type']=_0x23a5e0(0x1207),_0x44194e[_0x23a5e0(0x4e3)]=_0x44194e[_0x23a5e0(0x4e3)][_0x23a5e0(0x1bb)](_0x23a5e0(0x266),'')[_0x23a5e0(0x13f9)]());if(_0x44ce48[_0x23a5e0(0x136b)]&&_0x44194e[_0x23a5e0(0x1561)]&&_0x44194e['name']===_0x44ce48[_0x23a5e0(0x1561)]){console[_0x23a5e0(0x3b7)](_0x23a5e0(0x11f5)+_0x44ce48[_0x23a5e0(0x1561)]+_0x23a5e0(0x9e9),_0x44194e);continue;}if(!_0x44194e||typeof _0x44194e!==_0x23a5e0(0x12fe)){console[_0x23a5e0(0x651)](_0x23a5e0(0x1135),_0x44194e);continue;}if(!_0x44194e[_0x23a5e0(0x1508)]){if(_0x44ce48[_0x23a5e0(0x136b)]&&_0x44194e[_0x23a5e0(0x1561)]&&_0x44194e['message'])_0x44194e['type']=_0x23a5e0(0x13ca);else{if(_0x44194e[_0x23a5e0(0x4e3)])_0x44194e[_0x23a5e0(0x1508)]=_0x23a5e0(0x13ca);else{console[_0x23a5e0(0x651)](_0x23a5e0(0x6d7),_0x44194e);continue;}}}if(_0x44194e['type']===_0x23a5e0(0x344)){_0x4acdaf['isAwaitingResponse']=![];if(_0x44194e['decision']===_0x23a5e0(0xa91))_0x1e2a5c();else{const _0x1b61aa={'role':_0x23a5e0(0x115c),'content':_0x23a5e0(0x2d1),'timestamp':Date[_0x23a5e0(0x64b)]()};_0x44ce48['history'][_0x23a5e0(0x1c4)](_0x1b61aa),await _0x512070[_0x23a5e0(0xb04)][_0x23a5e0(0xd4d)](_0x44ce48),_0x35df44(_0x23a5e0(0x3e5)),_0x56abd7(_0x1e2092);}_0x512fbf=!![];break;}if(_0x44194e[_0x23a5e0(0x1508)]===_0x23a5e0(0xea3)){if(_0x44194e[_0x23a5e0(0x828)]===_0x23a5e0(0x3b9)){const _0x35697b=_0x44ce48['members'][_0x23a5e0(0xd62)](_0x2345a4=>_0x2345a4[_0x23a5e0(0x339)]===_0x44194e['name']);_0x35697b&&!_0x4acdaf[_0x23a5e0(0x9d3)]['some'](_0x45fd3c=>_0x45fd3c['id']===_0x35697b['id'])&&_0x4acdaf[_0x23a5e0(0x9d3)][_0x23a5e0(0x1c4)](_0x35697b);}_0x512fbf=!![];continue;}if(_0x44ce48[_0x23a5e0(0x136b)]&&_0x44194e[_0x23a5e0(0x1561)]&&_0x44194e[_0x23a5e0(0x1561)]===_0x44ce48[_0x23a5e0(0x1561)]){console['error']('AI幻觉已被拦截！试图使用群名\x20(\x22'+_0x44ce48[_0x23a5e0(0x1561)]+_0x23a5e0(0x9e9),_0x44194e);continue;}if(_0x44ce48[_0x23a5e0(0x136b)]&&!_0x44194e[_0x23a5e0(0x1561)]){console[_0x23a5e0(0x3b7)](_0x23a5e0(0xf74),_0x44194e);continue;}let _0x40eefc=null;const _0x476c7a=_0x164c31++,_0x13cedd={'role':_0x23a5e0(0x115c),'senderName':_0x44194e[_0x23a5e0(0x1561)]||_0x44ce48[_0x23a5e0(0x1561)],'timestamp':_0x476c7a};lastResponseTimestamps['push'](_0x476c7a);switch(_0x44194e[_0x23a5e0(0x1508)]){case _0x23a5e0(0x118e):{const _0xb797c5=_0x44194e[_0x23a5e0(0x1561)],_0x24ae85=_0x44194e[_0x23a5e0(0x15a3)],_0x31f016=_0x19ddb8[_0x23a5e0(0x9ce)][_0x23a5e0(0x246)]||_0x23a5e0(0x15c8);if(_0x24ae85===_0x31f016){const _0x2c10aa=Object['values'](_0x19ddb8['chats'])[_0x23a5e0(0xd62)](_0x2d61f1=>!_0x2d61f1[_0x23a5e0(0x136b)]&&_0x2d61f1[_0x23a5e0(0x339)]===_0xb797c5);if(_0x2c10aa){lastPrivateMessagesSent=[];const _0x5df21c=Array['isArray'](_0x44194e[_0x23a5e0(0x4e3)])?_0x44194e['content']:[_0x44194e['content']];let _0xaac2b4=0x0;for(const _0x4bfc8c of _0x5df21c){if(!_0x4bfc8c||!_0x4bfc8c['trim']())continue;const _0x2d89da={'role':'assistant','senderName':_0xb797c5,'content':_0x4bfc8c,'timestamp':_0x164c31++};lastPrivateMessagesSent[_0x23a5e0(0x1c4)]({'chatId':_0x2c10aa['id'],'timestamp':_0x2d89da[_0x23a5e0(0xd73)]}),_0x2c10aa['history'][_0x23a5e0(0x1c4)](_0x2d89da),_0xaac2b4++;}_0xaac2b4>0x0&&(_0x19ddb8[_0x23a5e0(0x859)]!==_0x2c10aa['id']&&(_0x2c10aa[_0x23a5e0(0xe20)]=(_0x2c10aa['unreadCount']||0x0)+_0xaac2b4,_0x1c6d8a(_0x2c10aa['id'],_0x2c10aa['name']+_0x23a5e0(0x44a)+_0xaac2b4+_0x23a5e0(0x604))),await _0x512070['chats'][_0x23a5e0(0xd4d)](_0x2c10aa)),_0x40eefc=null;}else console[_0x23a5e0(0x651)](_0x23a5e0(0x495)+_0xb797c5+'\x20尝试发送私信，但未找到其对应的私聊会话。'),_0x40eefc=null;}else console[_0x23a5e0(0x651)]('AI\x20尝试发送私信给非用户角色\x20('+_0x24ae85+_0x23a5e0(0x6d5)),_0x40eefc=null;continue;}case'update_thoughts':if(!_0x44ce48[_0x23a5e0(0x136b)]){_0x44194e[_0x23a5e0(0x50a)]&&(_0x44ce48[_0x23a5e0(0x390)]=String(_0x44194e[_0x23a5e0(0x50a)]));_0x44194e[_0x23a5e0(0xe0b)]&&(_0x44ce48[_0x23a5e0(0x69b)]=String(_0x44194e[_0x23a5e0(0xe0b)]));!Array[_0x23a5e0(0xb9b)](_0x44ce48[_0x23a5e0(0xd4a)])&&(_0x44ce48[_0x23a5e0(0xd4a)]=[]);_0x44ce48[_0x23a5e0(0xd4a)]['push']({'heartfeltVoice':_0x44ce48[_0x23a5e0(0x390)],'randomJottings':_0x44ce48[_0x23a5e0(0x69b)],'timestamp':Date[_0x23a5e0(0x64b)]()});_0x44ce48[_0x23a5e0(0xd4a)][_0x23a5e0(0x106b)]>0x32&&_0x44ce48['thoughtsHistory'][_0x23a5e0(0x48d)]();const _0x896586=_0x23a5e0(0x5e4)+_0x44ce48['heartfeltVoice']+_0x23a5e0(0x1351)+_0x44ce48[_0x23a5e0(0x69b)],_0x42b1f3={'role':'system','content':_0x896586,'timestamp':Date[_0x23a5e0(0x64b)](),'isHidden':!![]};}continue;case _0x23a5e0(0xbdd):if(!_0x44ce48[_0x23a5e0(0x136b)]&&_0x44194e[_0x23a5e0(0x125c)]){const _0x50e4fc=_0x44194e[_0x23a5e0(0x125c)]['trim']();if(_0x50e4fc){_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x1555)]=_0x50e4fc;const _0x5c9352={'role':'system','type':'pat_message','content':'“'+_0x44ce48[_0x23a5e0(0x1561)]+_0x23a5e0(0xb7a)+_0x50e4fc+'”','timestamp':_0x164c31++};_0x44ce48['history'][_0x23a5e0(0x1c4)](_0x5c9352);const _0x190b61={'role':_0x23a5e0(0xe10),'content':_0x23a5e0(0xf10)+_0x50e4fc+'”。]','timestamp':_0x164c31++,'isHidden':!![]};_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0x1c4)](_0x190b61),_0x467872&&_0x1ef393(_0x5c9352,_0x44ce48);}}continue;case _0x23a5e0(0x29f):if(!_0x44ce48['isGroup']&&_0x44194e[_0x23a5e0(0x125c)]){const _0x2b3e62=_0x44ce48['name'],_0xbabc5b=_0x44194e[_0x23a5e0(0x125c)][_0x23a5e0(0x13f9)]();if(_0xbabc5b&&_0xbabc5b!==_0x2b3e62){!_0x44ce48[_0x23a5e0(0x1058)]&&(_0x44ce48[_0x23a5e0(0x1058)]=[]);!_0x44ce48[_0x23a5e0(0x1058)]['includes'](_0x2b3e62)&&_0x44ce48[_0x23a5e0(0x1058)]['push'](_0x2b3e62);_0x44ce48[_0x23a5e0(0x1561)]=_0xbabc5b;const _0x340586={'role':_0x23a5e0(0xe10),'type':_0x23a5e0(0x1082),'content':'“'+_0x44ce48[_0x23a5e0(0x339)]+_0x23a5e0(0x7e3)+_0xbabc5b+'”','timestamp':_0x164c31++};_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0x1c4)](_0x340586);const _0x298e8f={'role':_0x23a5e0(0xe10),'content':'[系统提示：你刚刚成功将自己的备注名修改为了“'+_0xbabc5b+_0x23a5e0(0xb1a),'timestamp':_0x164c31++,'isHidden':!![]};_0x44ce48['history'][_0x23a5e0(0x1c4)](_0x298e8f),_0x467872&&(_0x1ef393(_0x340586,_0x44ce48),document[_0x23a5e0(0x9a3)](_0x23a5e0(0x991))['textContent']=_0xbabc5b),await _0xa82516(_0x44ce48);}}continue;case _0x23a5e0(0x13c9):{const _0x1095b1=_0x44194e[_0x23a5e0(0x1561)],_0x251749=_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0xea2)]['find'](_0x2006a5=>_0x2006a5[_0x23a5e0(0x1561)]===_0x1095b1);if(_0x251749){_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x4fe)]=_0x251749[_0x23a5e0(0x121f)];const _0x540519={'role':'system','type':_0x23a5e0(0x1082),'content':'['+_0x44ce48[_0x23a5e0(0x1561)]+_0x23a5e0(0xf50),'timestamp':Date['now']()};_0x44ce48['history'][_0x23a5e0(0x1c4)](_0x540519),await _0x3b911c(_0x44ce48),_0x467872&&(_0x1ef393(_0x540519,_0x44ce48),_0x56abd7(_0x1e2092));}continue;}case _0x23a5e0(0x134e):{const _0xab1c95=_0x44194e[_0x23a5e0(0x1561)],_0x43de17=_0x44ce48[_0x23a5e0(0x450)]['myAvatarLibrary']['find'](_0x14acd6=>_0x14acd6[_0x23a5e0(0x1561)]===_0xab1c95);if(_0x43de17){_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x1af)]=_0x43de17['url'];const _0x67e669={'role':_0x23a5e0(0xe10),'type':_0x23a5e0(0x1082),'content':'['+_0x44ce48[_0x23a5e0(0x1561)]+_0x23a5e0(0x14a1),'timestamp':Date[_0x23a5e0(0x64b)]()};_0x44ce48['history'][_0x23a5e0(0x1c4)](_0x67e669),_0x467872&&(_0x1ef393(_0x67e669,_0x44ce48),_0x56abd7(_0x1e2092));}continue;}case _0x23a5e0(0x867):{const _0x4dec91=parseInt(_0x44194e['x']),_0x2ab1c0=parseInt(_0x44194e['y']);!isNaN(_0x4dec91)&&!isNaN(_0x2ab1c0)?_0x128e77({'x':_0x4dec91,'y':_0x2ab1c0}):console[_0x23a5e0(0x651)](_0x23a5e0(0x734),_0x44194e);continue;}case _0x23a5e0(0x2be):const _0x4e1c04=_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0x455)](_0x4e6c7a=>_0x4e6c7a[_0x23a5e0(0xd73)]===_0x44194e[_0x23a5e0(0xa35)]);if(_0x4e1c04>-0x1){const _0x530cb8=_0x44ce48[_0x23a5e0(0x1f0)][_0x4e1c04];_0x530cb8['status']=_0x44194e[_0x23a5e0(0x27d)],_0x530cb8[_0x23a5e0(0x1588)]=_0x44194e['status']==='paid'?_0x44194e['name']:null;}continue;case'qzone_post':const _0x4ff514={'type':_0x44194e[_0x23a5e0(0xd0e)],'content':_0x44194e['content']||'','publicText':_0x44194e[_0x23a5e0(0x6b9)]||'','hiddenContent':_0x44194e[_0x23a5e0(0x14bb)]||'','image_prompt':_0x44194e['image_prompt']||'','timestamp':Date[_0x23a5e0(0x64b)](),'authorId':_0x1e2092,'authorGroupId':_0x44ce48[_0x23a5e0(0x4ab)],'visibleGroupIds':null};if(_0x44194e[_0x23a5e0(0xd0e)]==='naiimag'&&_0x44194e['prompt'])try{const _0x43a32e=Array[_0x23a5e0(0xb9b)](_0x44194e[_0x23a5e0(0x3a1)])?_0x44194e[_0x23a5e0(0x3a1)][_0x23a5e0(0x457)](0x0,0x2):[_0x44194e[_0x23a5e0(0x3a1)]];console['log'](_0x23a5e0(0x7c2)+_0x43a32e[_0x23a5e0(0x106b)]+'张图片');const _0x20a85a=[];for(let _0x340189=0x0;_0x340189<_0x43a32e['length'];_0x340189++){const _0x299832=_0x43a32e[_0x340189];console[_0x23a5e0(0xe4d)](_0x23a5e0(0x8fd)+(_0x340189+0x1)+_0x23a5e0(0x960),_0x299832);const _0x5a0ea2=_0x2bcefd(_0x44ce48['id']),_0x26405e=_0x299832+',\x20'+_0x5a0ea2['positive'],_0x3c3325=_0x5a0ea2[_0x23a5e0(0x6a6)];console[_0x23a5e0(0xe4d)]('📝\x20使用'+(_0x5a0ea2[_0x23a5e0(0x98c)]===_0x23a5e0(0xb44)?_0x23a5e0(0x1469):'系统')+'提示词配置'),console[_0x23a5e0(0xe4d)]('最终正面提示词:',_0x26405e),console['log'](_0x23a5e0(0x262),_0x3c3325);const _0x15236f=localStorage[_0x23a5e0(0x5de)](_0x23a5e0(0x4a1)),_0x4eb625=localStorage[_0x23a5e0(0x5de)]('novelai-model')||'nai-diffusion-4-5-full',_0x4dc877=_0x520f76();if(!_0x15236f)throw new Error('NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。');const [_0x447503,_0x2e7907]=_0x4dc877[_0x23a5e0(0xab4)][_0x23a5e0(0x1536)]('x')[_0x23a5e0(0xb0a)](Number);let _0x10f337;_0x4eb625['includes'](_0x23a5e0(0xb29))?_0x10f337={'input':_0x26405e,'model':_0x4eb625,'action':_0x23a5e0(0xa7d),'parameters':{'params_version':0x3,'width':_0x447503,'height':_0x2e7907,'scale':_0x4dc877[_0x23a5e0(0xd7e)],'sampler':_0x4dc877['sampler'],'steps':_0x4dc877[_0x23a5e0(0x124e)],'seed':_0x4dc877[_0x23a5e0(0xaec)]===-0x1?Math[_0x23a5e0(0xd95)](Math[_0x23a5e0(0xdcd)]()*0x2540be3ff):_0x4dc877[_0x23a5e0(0xaec)],'n_samples':0x1,'ucPreset':_0x4dc877[_0x23a5e0(0x70e)],'qualityToggle':_0x4dc877['quality_toggle'],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':'karras','legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x26405e,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x3c3325,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x3c3325,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x10f337={'input':_0x26405e,'model':_0x4eb625,'action':_0x23a5e0(0xa7d),'parameters':{'width':_0x447503,'height':_0x2e7907,'scale':_0x4dc877[_0x23a5e0(0xd7e)],'sampler':_0x4dc877['sampler'],'steps':_0x4dc877[_0x23a5e0(0x124e)],'seed':_0x4dc877[_0x23a5e0(0xaec)]===-0x1?Math[_0x23a5e0(0xd95)](Math[_0x23a5e0(0xdcd)]()*0x2540be3ff):_0x4dc877[_0x23a5e0(0xaec)],'n_samples':0x1,'ucPreset':_0x4dc877['uc_preset'],'qualityToggle':_0x4dc877[_0x23a5e0(0x14e7)],'sm':_0x4dc877['smea'],'sm_dyn':_0x4dc877[_0x23a5e0(0x14c8)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':'native','negative_prompt':_0x3c3325}};console[_0x23a5e0(0xe4d)]('🚀\x20发送NAI请求:',_0x10f337);let _0x26ae6c;_0x4eb625[_0x23a5e0(0x478)](_0x23a5e0(0xb29))?_0x26ae6c=_0x23a5e0(0x335):_0x26ae6c='https://image.novelai.net/ai/generate-image';let _0x5216bd=_0x4dc877[_0x23a5e0(0x553)];_0x5216bd==='custom'&&(_0x5216bd=_0x4dc877[_0x23a5e0(0x1421)]||'');_0x5216bd&&_0x5216bd!==''&&(_0x26ae6c=_0x5216bd+encodeURIComponent(_0x26ae6c));const _0x26f0eb=await fetch(_0x26ae6c,{'method':_0x23a5e0(0x12db),'headers':{'Content-Type':_0x23a5e0(0xb1f),'Authorization':_0x23a5e0(0x1265)+_0x15236f},'body':JSON['stringify'](_0x10f337)});console[_0x23a5e0(0xe4d)](_0x23a5e0(0x2bf),_0x26f0eb[_0x23a5e0(0x27d)]),console[_0x23a5e0(0xe4d)](_0x23a5e0(0x1466),[..._0x26f0eb[_0x23a5e0(0x13ee)][_0x23a5e0(0x10c3)]()]);if(!_0x26f0eb['ok']){const _0x38a6d5=await _0x26f0eb[_0x23a5e0(0x13ca)]();console[_0x23a5e0(0x3b7)]('API错误响应:',_0x38a6d5);throw new Error(_0x23a5e0(0x1483)+_0x26f0eb[_0x23a5e0(0x27d)]+_0x23a5e0(0x41b)+_0x38a6d5);}const _0x359744=_0x26f0eb[_0x23a5e0(0x13ee)]['get'](_0x23a5e0(0x1522));console[_0x23a5e0(0xe4d)](_0x23a5e0(0x9c0),_0x359744);let _0x208276,_0x5b1416;if(_0x359744&&_0x359744['includes'](_0x23a5e0(0xbf9))){console[_0x23a5e0(0xe4d)](_0x23a5e0(0x13e9));const _0x38f32e=await _0x26f0eb['text']();console[_0x23a5e0(0xe4d)](_0x23a5e0(0xd17),_0x38f32e[_0x23a5e0(0x106b)]);const _0x364f7f=_0x38f32e[_0x23a5e0(0x13f9)]()[_0x23a5e0(0x1536)]('\x0a');let _0x4297c0=null;for(let _0x4f93dd=_0x364f7f[_0x23a5e0(0x106b)]-0x1;_0x4f93dd>=0x0;_0x4f93dd--){const _0x23ae86=_0x364f7f[_0x4f93dd]['trim']();if(_0x23ae86[_0x23a5e0(0x608)]('data:\x20')&&_0x23ae86!==_0x23a5e0(0xa69)){const _0x1c3367=_0x23ae86[_0x23a5e0(0x72e)](0x6);try{const _0x5adc0c=JSON[_0x23a5e0(0x1447)](_0x1c3367);if(_0x5adc0c[_0x23a5e0(0x50b)]===_0x23a5e0(0x1065)&&_0x5adc0c[_0x23a5e0(0x547)]){_0x4297c0=_0x5adc0c['image'],console['log']('✅\x20找到\x20final\x20事件的图片数据');break;}if(_0x5adc0c[_0x23a5e0(0x38c)]){_0x4297c0=_0x5adc0c[_0x23a5e0(0x38c)],console['log']('从\x20JSON.data\x20中提取图片数据');break;}if(_0x5adc0c[_0x23a5e0(0x547)]){_0x4297c0=_0x5adc0c[_0x23a5e0(0x547)],console[_0x23a5e0(0xe4d)](_0x23a5e0(0x85b));break;}}catch(_0x42e508){_0x4297c0=_0x1c3367,console[_0x23a5e0(0xe4d)](_0x23a5e0(0xfdf));break;}}}if(!_0x4297c0)throw new Error(_0x23a5e0(0x1153));const _0x1f7650=_0x4297c0[_0x23a5e0(0x608)]('iVBORw0KGgo'),_0x17282d=_0x4297c0[_0x23a5e0(0x608)]('/9j/');if(_0x1f7650||_0x17282d){console[_0x23a5e0(0xe4d)](_0x23a5e0(0xa8c));const _0x56ff9f=atob(_0x4297c0),_0x539643=new Uint8Array(_0x56ff9f[_0x23a5e0(0x106b)]);for(let _0x3872c3=0x0;_0x3872c3<_0x56ff9f[_0x23a5e0(0x106b)];_0x3872c3++){_0x539643[_0x3872c3]=_0x56ff9f[_0x23a5e0(0xc75)](_0x3872c3);}const _0x4bf4e9=new Blob([_0x539643],{'type':_0x1f7650?_0x23a5e0(0x15af):_0x23a5e0(0x80a)});console[_0x23a5e0(0xe4d)](_0x23a5e0(0x649),_0x4bf4e9['size']);const _0x22f7af=new FileReader();_0x5b1416=await new Promise((_0x4c21a1,_0x59709e)=>{const _0x262d8b=_0x23a5e0;_0x22f7af[_0x262d8b(0x15b8)]=()=>_0x4c21a1(_0x22f7af['result']),_0x22f7af['onerror']=_0x59709e,_0x22f7af['readAsDataURL'](_0x4bf4e9);}),console[_0x23a5e0(0xe4d)]('✅\x20图片转换成功！🎨');}else{console['log']('当作\x20ZIP\x20文件处理...');const _0x3e9168=atob(_0x4297c0),_0x41c7eb=new Uint8Array(_0x3e9168[_0x23a5e0(0x106b)]);for(let _0x41ab67=0x0;_0x41ab67<_0x3e9168[_0x23a5e0(0x106b)];_0x41ab67++){_0x41c7eb[_0x41ab67]=_0x3e9168['charCodeAt'](_0x41ab67);}_0x208276=new Blob([_0x41c7eb]),console[_0x23a5e0(0xe4d)](_0x23a5e0(0x104c),_0x208276[_0x23a5e0(0xbdf)]);}}else _0x208276=await _0x26f0eb[_0x23a5e0(0xf11)](),console['log'](_0x23a5e0(0xc2a),_0x208276[_0x23a5e0(0x1508)],'大小:',_0x208276[_0x23a5e0(0xbdf)]);if(!_0x5b1416&&_0x208276)try{if(typeof JSZip===_0x23a5e0(0x738))throw new Error(_0x23a5e0(0x3a3));const _0x2a2162=await JSZip[_0x23a5e0(0xf9a)](_0x208276);console[_0x23a5e0(0xe4d)](_0x23a5e0(0xa87),Object[_0x23a5e0(0x2d0)](_0x2a2162[_0x23a5e0(0x104e)]));let _0x3e64d2=null;for(let _0x18eb5c in _0x2a2162[_0x23a5e0(0x104e)]){if(_0x18eb5c[_0x23a5e0(0x293)](/\.(png|jpg|jpeg|webp)$/i)){_0x3e64d2=_0x2a2162[_0x23a5e0(0x104e)][_0x18eb5c],console['log'](_0x23a5e0(0xa0f),_0x18eb5c);break;}}if(!_0x3e64d2)throw new Error('ZIP文件中未找到图片');const _0x548c94=await _0x3e64d2[_0x23a5e0(0xf7f)](_0x23a5e0(0xf11));console[_0x23a5e0(0xe4d)](_0x23a5e0(0xc44),_0x548c94['size']);const _0x6d9475=new FileReader();_0x5b1416=await new Promise((_0x2da000,_0x4c79ce)=>{const _0x2ec3ab=_0x23a5e0;_0x6d9475['onloadend']=()=>_0x2da000(_0x6d9475[_0x2ec3ab(0x5c9)]),_0x6d9475[_0x2ec3ab(0xb8b)]=_0x4c79ce,_0x6d9475[_0x2ec3ab(0xdd8)](_0x548c94);}),console[_0x23a5e0(0xe4d)]('✅\x20图片解压成功！');}catch(_0x212ac0){console[_0x23a5e0(0x3b7)](_0x23a5e0(0xe5b),_0x212ac0);throw new Error(_0x23a5e0(0x1121)+_0x212ac0[_0x23a5e0(0xcce)]);}console[_0x23a5e0(0xe4d)](_0x23a5e0(0x214)+(_0x340189+0x1)+_0x23a5e0(0x53c)),_0x20a85a[_0x23a5e0(0x1c4)](_0x5b1416);}_0x4ff514[_0x23a5e0(0x739)]=_0x20a85a,_0x20a85a[_0x23a5e0(0x106b)]===0x1&&(_0x4ff514['imageUrl']=_0x20a85a[0x0]),_0x4ff514[_0x23a5e0(0x3a1)]=_0x44194e[_0x23a5e0(0x3a1)],_0x4ff514[_0x23a5e0(0xab6)]=_0x20a85a[_0x23a5e0(0x106b)],console[_0x23a5e0(0xe4d)](_0x23a5e0(0x123f)+_0x20a85a['length']+'张');}catch(_0x5adb01){console['error'](_0x23a5e0(0x58e),_0x5adb01),_0x4ff514['content']=(_0x4ff514[_0x23a5e0(0x4e3)]||_0x4ff514['publicText']||'')+(_0x23a5e0(0x12ee)+_0x5adb01[_0x23a5e0(0xcce)]+']');}await _0x512070[_0x23a5e0(0x10e5)]['add'](_0x4ff514),_0x28172c(_0x27ed94+0x1);_0x467872&&document[_0x23a5e0(0x9a3)](_0x23a5e0(0x659))[_0x23a5e0(0x4d8)][_0x23a5e0(0x1222)]('active')&&await _0x49acff();continue;case'qzone_comment':{const _0x50d5c1=await _0x512070[_0x23a5e0(0x10e5)][_0x23a5e0(0x14ee)](parseInt(_0x44194e['postId']));if(_0x50d5c1){if(!_0x50d5c1[_0x23a5e0(0xc79)])_0x50d5c1[_0x23a5e0(0xc79)]=[];const _0x473b8b=_0x44194e[_0x23a5e0(0x1561)]||_0x44ce48[_0x23a5e0(0x339)],_0x4cc4fd=(_0x32512e,_0x3ae924=null,_0x319965=null)=>({'commenterName':_0x473b8b,'text':_0x8888da(_0x32512e,_0x44ce48),'meaning':_0x3ae924,'replyTo':_0x319965,'timestamp':Date[_0x23a5e0(0x64b)]()});if(_0x44194e[_0x23a5e0(0x1291)]){const _0xe3096=_0x19ddb8[_0x23a5e0(0x1557)][_0x23a5e0(0xd62)](_0x5680d6=>_0x5680d6[_0x23a5e0(0x1561)]===_0x44194e[_0x23a5e0(0x1291)]);_0xe3096?_0x50d5c1[_0x23a5e0(0xc79)][_0x23a5e0(0x1c4)](_0x4cc4fd(_0xe3096[_0x23a5e0(0x121f)],_0xe3096['name'],_0x44194e[_0x23a5e0(0x877)]||null)):(console[_0x23a5e0(0x651)](_0x23a5e0(0x100d)+_0x44194e['stickerMeaning']+'\x22'),_0x50d5c1[_0x23a5e0(0xc79)][_0x23a5e0(0x1c4)](_0x4cc4fd(_0x23a5e0(0x22a)+_0x44194e[_0x23a5e0(0x1291)]+']',null,_0x44194e['replyTo']||null)));}else{if(Array[_0x23a5e0(0xb9b)](_0x44194e[_0x23a5e0(0xc79)]))_0x44194e[_0x23a5e0(0xc79)]['forEach'](_0x1c81e1=>{const _0x24a5be=_0x23a5e0;typeof _0x1c81e1===_0x24a5be(0x86c)&&_0x1c81e1[_0x24a5be(0x13f9)]()&&_0x50d5c1[_0x24a5be(0xc79)][_0x24a5be(0x1c4)](_0x4cc4fd(_0x1c81e1,null,_0x44194e['replyTo']||null));});else typeof _0x44194e[_0x23a5e0(0x320)]===_0x23a5e0(0x86c)&&_0x44194e[_0x23a5e0(0x320)]['trim']()&&_0x50d5c1[_0x23a5e0(0xc79)]['push'](_0x4cc4fd(_0x44194e[_0x23a5e0(0x320)],null,_0x44194e[_0x23a5e0(0x877)]||null));}await _0x512070[_0x23a5e0(0x10e5)][_0x23a5e0(0xe33)](_0x50d5c1['id'],{'comments':_0x50d5c1[_0x23a5e0(0xc79)]}),_0x28172c(_0x27ed94+0x1),console[_0x23a5e0(0xe4d)](_0x23a5e0(0x4d6)+_0x44ce48[_0x23a5e0(0x1561)]+_0x23a5e0(0xc4b)+_0x44194e[_0x23a5e0(0xb92)]);if(!_0x44ce48['commentCooldowns'])_0x44ce48[_0x23a5e0(0xb6a)]={};_0x44ce48[_0x23a5e0(0xb6a)][_0x44194e[_0x23a5e0(0xb92)]]=Date['now']();}continue;}case _0x23a5e0(0x1176):const _0x69fac7=await _0x512070[_0x23a5e0(0x10e5)]['get'](parseInt(_0x44194e[_0x23a5e0(0xb92)]));if(_0x69fac7){if(!_0x69fac7[_0x23a5e0(0x807)])_0x69fac7[_0x23a5e0(0x807)]=[];!_0x69fac7['likes'][_0x23a5e0(0x478)](_0x44ce48[_0x23a5e0(0x1561)])&&(_0x69fac7['likes'][_0x23a5e0(0x1c4)](_0x44ce48['name']),await _0x512070['qzonePosts']['update'](_0x69fac7['id'],{'likes':_0x69fac7['likes']}),_0x28172c(_0x27ed94+0x1),_0x467872&&document[_0x23a5e0(0x9a3)](_0x23a5e0(0x659))[_0x23a5e0(0x4d8)][_0x23a5e0(0x1222)](_0x23a5e0(0xe9f))&&await _0x49acff());}continue;case'repost':{const _0x56866d=await _0x512070[_0x23a5e0(0x10e5)][_0x23a5e0(0x14ee)](parseInt(_0x44194e[_0x23a5e0(0xb92)]));if(_0x56866d){const _0x10e7b4={'type':_0x23a5e0(0x5ee),'timestamp':Date[_0x23a5e0(0x64b)](),'authorId':_0x1e2092,'authorGroupId':_0x44ce48['groupId'],'repostComment':_0x44194e[_0x23a5e0(0x79d)]||'','originalPost':_0x56866d,'visibleGroupIds':null};await _0x512070[_0x23a5e0(0x10e5)]['add'](_0x10e7b4),_0x28172c(_0x27ed94+0x1),console['log'](_0x23a5e0(0x4d6)+_0x44ce48[_0x23a5e0(0x1561)]+_0x23a5e0(0x761)+_0x44194e[_0x23a5e0(0xb92)]);}continue;}case _0x23a5e0(0x7bb):!_0x4acdaf[_0x23a5e0(0x1412)]&&!_0x4acdaf['isAwaitingResponse']&&(_0x19ddb8[_0x23a5e0(0x859)]=_0x1e2092,_0x4acdaf[_0x23a5e0(0x859)]=_0x1e2092,_0x4acdaf['isAwaitingResponse']=!![],_0x4acdaf[_0x23a5e0(0x6a0)]=_0x44ce48['isGroup'],_0x4acdaf[_0x23a5e0(0x488)]=_0x44194e['name']||_0x44ce48[_0x23a5e0(0x1561)],_0x29be00());continue;case _0x23a5e0(0x25a):!_0x4acdaf[_0x23a5e0(0x1412)]&&!_0x4acdaf[_0x23a5e0(0x62c)]&&(_0x19ddb8[_0x23a5e0(0x859)]=_0x1e2092,_0x4acdaf[_0x23a5e0(0x62c)]=!![],_0x4acdaf['isGroupCall']=!![],_0x4acdaf['initiator']='ai',_0x4acdaf[_0x23a5e0(0x488)]=_0x44194e['name'],_0x29be00());continue;case _0x23a5e0(0x152b):let _0x5c8088;if(_0x44ce48[_0x23a5e0(0x136b)]){const _0x8432e3=_0x44ce48[_0x23a5e0(0xcca)][_0x23a5e0(0xd62)](_0x148668=>_0x148668[_0x23a5e0(0x339)]===_0x44194e['name']);_0x5c8088=_0x8432e3?_0x8432e3[_0x23a5e0(0xaf0)]:_0x44194e[_0x23a5e0(0x1561)];}else _0x5c8088=_0x44ce48[_0x23a5e0(0x1561)];const _0x19c662=_0x44194e[_0x23a5e0(0x1141)]?'\x20'+_0x44194e[_0x23a5e0(0x1141)][_0x23a5e0(0x13f9)]():'',_0x3af994=_0x5c8088+_0x23a5e0(0x539)+_0x19c662,_0x5b76cd={'role':'system','type':_0x23a5e0(0x1082),'content':_0x3af994,'timestamp':Date['now']()};_0x44ce48['history'][_0x23a5e0(0x1c4)](_0x5b76cd);if(_0x467872){const _0x3cb087=document[_0x23a5e0(0x9a3)](_0x23a5e0(0xae7));_0x3cb087[_0x23a5e0(0x4d8)][_0x23a5e0(0x133d)]('pat-animation'),void _0x3cb087['offsetWidth'],_0x3cb087[_0x23a5e0(0x4d8)][_0x23a5e0(0xe05)](_0x23a5e0(0x615)),setTimeout(()=>_0x3cb087[_0x23a5e0(0x4d8)][_0x23a5e0(0x133d)](_0x23a5e0(0x615)),0x1f4),_0x1ef393(_0x5b76cd,_0x44ce48);}else _0x1c6d8a(_0x1e2092,_0x3af994);continue;case _0x23a5e0(0x2c1):_0x44ce48[_0x23a5e0(0x27d)][_0x23a5e0(0x13ca)]=_0x44194e[_0x23a5e0(0xb61)],_0x44ce48[_0x23a5e0(0x27d)][_0x23a5e0(0x545)]=_0x44194e[_0x23a5e0(0x1154)]||![],_0x44ce48['status'][_0x23a5e0(0x935)]=Date[_0x23a5e0(0x64b)]();const _0x38f574={'role':_0x23a5e0(0xe10),'type':_0x23a5e0(0x1082),'content':'['+_0x44ce48['name']+'的状态已更新为:\x20'+_0x44194e[_0x23a5e0(0xb61)]+']','timestamp':Date[_0x23a5e0(0x64b)]()};_0x44ce48['history']['push'](_0x38f574);_0x467872&&_0x1ef393(_0x38f574,_0x44ce48);_0xec8072();continue;case _0x23a5e0(0x12cc):_0x40eefc={..._0x13cedd,'type':_0x23a5e0(0x12cc),'content':_0x44194e[_0x23a5e0(0x4e3)]};break;case _0x23a5e0(0xf0e):if(_0x4e0631[_0x23a5e0(0x1412)]&&_0x4e0631['activeChatId']===_0x1e2092){const _0x5c4d6f=_0x44194e[_0x23a5e0(0x13da)]||_0x44194e['song']||_0x44194e[_0x23a5e0(0x1561)];if(typeof _0x5c4d6f==='string'&&_0x5c4d6f[_0x23a5e0(0x13f9)]()){const _0x10eb98=_0x5c4d6f[_0x23a5e0(0x1bb)](/^\[?\d+\]?[\s.-]*/,'')[_0x23a5e0(0x13f9)](),_0xc89a33=_0x4e0631[_0x23a5e0(0x496)][_0x23a5e0(0x455)](_0x2ff732=>_0x2ff732['name'][_0x23a5e0(0x905)]()===_0x10eb98[_0x23a5e0(0x905)]());if(_0xc89a33>-0x1){_0x11f565(_0xc89a33);const _0x1af3e0=_0x4e0631[_0x23a5e0(0x496)][_0xc89a33];let _0x5659d9;if(_0x44ce48[_0x23a5e0(0x136b)]){const _0x3f2e89=_0x44ce48[_0x23a5e0(0xcca)]['find'](_0x2caf6a=>_0x2caf6a[_0x23a5e0(0x339)]===_0x44194e[_0x23a5e0(0x1561)]);_0x5659d9=_0x3f2e89?_0x3f2e89['groupNickname']:_0x44194e[_0x23a5e0(0x1561)];}else _0x5659d9=_0x44ce48[_0x23a5e0(0x1561)];const _0x1bf6da={'role':'system','type':_0x23a5e0(0x1082),'content':_0x23a5e0(0x6e4)+_0x5659d9+'\x20为你切歌:\x20《'+_0x1af3e0[_0x23a5e0(0x1561)]+_0x23a5e0(0xf29)+_0x1af3e0[_0x23a5e0(0xf6d)]+']','timestamp':Date['now']()};_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0x1c4)](_0x1bf6da),_0x467872&&_0x1ef393(_0x1bf6da,_0x44ce48);}else console[_0x23a5e0(0x651)](_0x23a5e0(0xdeb)+_0x5c4d6f+'\x22(处理后为\x22'+_0x10eb98+_0x23a5e0(0xfe5));}else console[_0x23a5e0(0x3b7)](_0x23a5e0(0x1073),_0x44194e);}continue;case _0x23a5e0(0xa8b):const _0x26d807={'chatId':_0x1e2092,'authorId':_0x1e2092,'description':_0x44194e[_0x23a5e0(0x3ef)],'timestamp':Date[_0x23a5e0(0x64b)](),'type':'ai_generated'};await _0x512070[_0x23a5e0(0xe87)]['add'](_0x26d807),console[_0x23a5e0(0xe4d)](_0x23a5e0(0xcac)+_0x44ce48[_0x23a5e0(0x1561)]+'\x22\x20记录了一条新回忆:',_0x44194e['description']);continue;case'create_countdown':const _0x2677a5=new Date(_0x44194e['date']);if(!isNaN(_0x2677a5)&&_0x2677a5>new Date()){const _0x12c091={'chatId':_0x1e2092,'authorId':_0x1e2092,'description':_0x44194e[_0x23a5e0(0x10b8)],'timestamp':Date[_0x23a5e0(0x64b)](),'type':'countdown','targetDate':_0x2677a5[_0x23a5e0(0xbd1)]()};await _0x512070[_0x23a5e0(0xe87)][_0x23a5e0(0xe05)](_0x12c091),console[_0x23a5e0(0xe4d)](_0x23a5e0(0xcac)+_0x44ce48['name']+_0x23a5e0(0xd14),_0x44194e['title']);}continue;case _0x23a5e0(0x2f1):if(!_0x44ce48[_0x23a5e0(0x136b)]){_0x44ce48[_0x23a5e0(0x239)]['status']='blocked_by_ai';const _0x256015={'role':_0x23a5e0(0xe10),'content':_0x23a5e0(0x1189),'timestamp':Date[_0x23a5e0(0x64b)](),'isHidden':!![]};_0x44ce48['history']['push'](_0x256015),await _0x512070[_0x23a5e0(0xb04)][_0x23a5e0(0xd4d)](_0x44ce48);_0x467872&&_0x56abd7(_0x1e2092);_0xec8072();break;}continue;case _0x23a5e0(0x1344):!_0x44ce48['isGroup']&&_0x44ce48[_0x23a5e0(0x239)]?.[_0x23a5e0(0x27d)]===_0x23a5e0(0xfd1)&&(_0x44194e['decision']===_0x23a5e0(0xa91)?(_0x44ce48[_0x23a5e0(0x239)][_0x23a5e0(0x27d)]=_0x23a5e0(0xf81),_0x40eefc={..._0x13cedd,'content':'我通过了你的好友申请，我们现在是好友啦！'}):(_0x44ce48[_0x23a5e0(0x239)][_0x23a5e0(0x27d)]=_0x23a5e0(0xf34),_0x40eefc={..._0x13cedd,'content':'抱歉，我拒绝了你的好友申请。'}),_0x44ce48['relationship'][_0x23a5e0(0x351)]='');break;case _0x23a5e0(0x3e6):const _0x474764=typeof _0x44194e['options']===_0x23a5e0(0x86c)?_0x44194e['options'][_0x23a5e0(0x1536)]('\x0a')[_0x23a5e0(0x1195)](_0x118aab=>_0x118aab[_0x23a5e0(0x13f9)]()):Array[_0x23a5e0(0xb9b)](_0x44194e[_0x23a5e0(0x11c2)])?_0x44194e['options']:[];if(_0x474764[_0x23a5e0(0x106b)]<0x2)continue;_0x40eefc={..._0x13cedd,'type':'poll','question':_0x44194e[_0x23a5e0(0x1db)],'options':_0x474764,'votes':{},'isClosed':![]};break;case _0x23a5e0(0xf69):{const {itemName:_0x20d967,itemPrice:_0xa4eab,image_prompt:_0x1790bc}=_0x44194e;if(_0x20d967&&!isNaN(parseFloat(_0xa4eab))&&_0x1790bc){const _0x507357=_0x23a5e0(0x10a3)+encodeURIComponent(_0x1790bc);_0x40eefc={..._0x13cedd,'type':_0x23a5e0(0xf69),'items':[{'name':_0x20d967,'price':parseFloat(_0xa4eab),'imageUrl':_0x507357,'quantity':0x1}],'total':parseFloat(_0xa4eab),'recipients':_0x44194e[_0x23a5e0(0x6d2)]||null};}else console['warn']('AI\x20尝试赠送一个格式不正确的随机礼物:',_0x44194e);break;}case _0x23a5e0(0x154d):const _0x61669a=_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0xd62)](_0x369e3b=>_0x369e3b[_0x23a5e0(0xd73)]===_0x44194e[_0x23a5e0(0xe45)]);_0x61669a&&!_0x61669a[_0x23a5e0(0x13ae)]&&(Object[_0x23a5e0(0x2d0)](_0x61669a['votes'])[_0x23a5e0(0x15c1)](_0x4c7acd=>{const _0x4f3b62=_0x23a5e0,_0x128828=_0x61669a[_0x4f3b62(0xa71)][_0x4c7acd]['indexOf'](_0x44194e[_0x4f3b62(0x1561)]);_0x128828>-0x1&&_0x61669a[_0x4f3b62(0xa71)][_0x4c7acd][_0x4f3b62(0x15b0)](_0x128828,0x1);}),!_0x61669a[_0x23a5e0(0xa71)][_0x44194e['choice']]&&(_0x61669a[_0x23a5e0(0xa71)][_0x44194e[_0x23a5e0(0x1253)]]=[]),!_0x61669a['votes'][_0x44194e[_0x23a5e0(0x1253)]][_0x23a5e0(0x478)](_0x44194e['name'])&&_0x61669a['votes'][_0x44194e[_0x23a5e0(0x1253)]][_0x23a5e0(0x1c4)](_0x44194e['name']),_0x467872&&_0x56abd7(_0x1e2092));continue;case _0x23a5e0(0x552):_0x40eefc={..._0x13cedd,..._0x44194e,'totalAmount':_0x44194e[_0x23a5e0(0x11fa)],'claimedBy':{},'isFullyClaimed':![]};_0x44194e[_0x23a5e0(0x599)]&&(_0x40eefc[_0x23a5e0(0x13e2)]=_0x44194e[_0x23a5e0(0x599)],delete _0x40eefc['receiver']);break;case _0x23a5e0(0xd4e):const _0x1fc706=_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0xd62)](_0xc2f8ac=>_0xc2f8ac['timestamp']===_0x44194e[_0x23a5e0(0x136c)]),_0x48cb66=_0x44194e[_0x23a5e0(0x1561)],_0x2beb82=_0x44ce48[_0x23a5e0(0xcca)][_0x23a5e0(0x336)](_0x22a803=>_0x22a803[_0x23a5e0(0x339)]===_0x48cb66);if(!_0x2beb82){console['warn']('AI\x20角色\x20\x22'+_0x48cb66+_0x23a5e0(0xaa4));continue;}if(_0x1fc706&&_0x1fc706[_0x23a5e0(0x4ee)]==='direct'){if(_0x1fc706[_0x23a5e0(0x13e2)]!==_0x44194e[_0x23a5e0(0x1561)]){console[_0x23a5e0(0x651)]('AI\x20角色\x20\x22'+_0x44194e['name']+_0x23a5e0(0x13a2)+_0x1fc706[_0x23a5e0(0x13e2)]+_0x23a5e0(0xcc5));continue;}}if(_0x1fc706&&!_0x1fc706[_0x23a5e0(0x1565)]&&!(_0x1fc706[_0x23a5e0(0x2f5)]&&_0x1fc706[_0x23a5e0(0x2f5)][_0x44194e[_0x23a5e0(0x1561)]])){let _0x40d8e5=0x0;const _0x2bca71=_0x1fc706[_0x23a5e0(0xb19)]-Object[_0x23a5e0(0xea1)](_0x1fc706[_0x23a5e0(0x2f5)]||{})['reduce']((_0x44a176,_0x4fb310)=>_0x44a176+_0x4fb310,0x0),_0x13c98b=_0x1fc706[_0x23a5e0(0x3a9)]-Object[_0x23a5e0(0x2d0)](_0x1fc706[_0x23a5e0(0x2f5)]||{})[_0x23a5e0(0x106b)];if(_0x13c98b>0x0){if(_0x1fc706['packetType']===_0x23a5e0(0x93c))_0x40d8e5=_0x1fc706[_0x23a5e0(0xb19)];else{if(_0x13c98b===0x1)_0x40d8e5=_0x2bca71;else{const _0xd6db44=0.01,_0x4897ee=_0x2bca71-(_0x13c98b-0x1)*_0xd6db44;_0x40d8e5=Math[_0x23a5e0(0xdcd)]()*(_0x4897ee-_0xd6db44)+_0xd6db44;}}_0x40d8e5=parseFloat(_0x40d8e5['toFixed'](0x2));if(!_0x1fc706[_0x23a5e0(0x2f5)])_0x1fc706['claimedBy']={};_0x1fc706['claimedBy'][_0x44194e[_0x23a5e0(0x1561)]]=_0x40d8e5;const _0x3eb998=_0x44ce48[_0x23a5e0(0xcca)][_0x23a5e0(0xd62)](_0xced8d9=>_0xced8d9[_0x23a5e0(0x339)]===_0x44194e['name']),_0x3c3cb4=_0x3eb998?_0x3eb998[_0x23a5e0(0xaf0)]:_0x44194e[_0x23a5e0(0x1561)],_0x3a8291=_0x1e2056(_0x44ce48,_0x1fc706[_0x23a5e0(0x1043)]),_0x435bad={'role':_0x23a5e0(0xe10),'type':_0x23a5e0(0x1082),'content':_0x3c3cb4+_0x23a5e0(0xdb6)+_0x3a8291+_0x23a5e0(0x1148),'timestamp':Date[_0x23a5e0(0x64b)]()};_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0x1c4)](_0x435bad);let _0x48474e=_0x23a5e0(0x325)+_0x3c3cb4+_0x23a5e0(0x628)+_0x40d8e5[_0x23a5e0(0x1322)](0x2)+_0x23a5e0(0x1398);if(Object[_0x23a5e0(0x2d0)](_0x1fc706[_0x23a5e0(0x2f5)])[_0x23a5e0(0x106b)]>=_0x1fc706['count']){_0x1fc706['isFullyClaimed']=!![];const _0x40c311={'role':_0x23a5e0(0xe10),'type':'pat_message','content':_0x3a8291+_0x23a5e0(0x12a5),'timestamp':Date[_0x23a5e0(0x64b)]()+0x1};_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0x1c4)](_0x40c311);let _0x2861b3={'name':'','amount':-0x1};_0x1fc706[_0x23a5e0(0x4ee)]===_0x23a5e0(0x5b8)&&_0x1fc706['count']>0x1&&Object[_0x23a5e0(0x10c3)](_0x1fc706[_0x23a5e0(0x2f5)])[_0x23a5e0(0x15c1)](([_0xb41565,_0x564988])=>{const _0x5b65da=_0x23a5e0;_0x564988>_0x2861b3[_0x5b65da(0x11fa)]&&(_0x2861b3={'name':_0xb41565,'amount':_0x564988});});if(_0x2861b3[_0x23a5e0(0x1561)]){const _0x37edc0=_0x44ce48['members'][_0x23a5e0(0xd62)](_0x14dbdd=>_0x14dbdd[_0x23a5e0(0x339)]===_0x2861b3[_0x23a5e0(0x1561)]),_0x33528e=_0x37edc0?_0x37edc0[_0x23a5e0(0xaf0)]:_0x2861b3[_0x23a5e0(0x1561)];_0x48474e+=_0x23a5e0(0x1184)+_0x33528e+'！';}else _0x48474e+=_0x23a5e0(0x883);}_0x48474e+=_0x23a5e0(0xa61);const _0xe16548={'role':'system','content':_0x48474e,'timestamp':Date['now']()+0x2,'isHidden':!![]};_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0x1c4)](_0xe16548);}_0x467872&&(_0x56abd7(_0x1e2092),_0xec8072());}continue;case'accept_transfer':{const _0x571aa1=_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0x455)](_0x310400=>_0x310400[_0x23a5e0(0xd73)]===_0x44194e[_0x23a5e0(0xa35)]);if(_0x571aa1>-0x1){const _0x5b9745=_0x44ce48[_0x23a5e0(0x1f0)][_0x571aa1];_0x5b9745[_0x23a5e0(0x27d)]='accepted';}continue;}case'decline_transfer':{const _0x57c149=_0x44ce48[_0x23a5e0(0x1f0)]['findIndex'](_0x523647=>_0x523647['timestamp']===_0x44194e[_0x23a5e0(0xa35)]);if(_0x57c149>-0x1){const _0x5c9af6=_0x44ce48[_0x23a5e0(0x1f0)][_0x57c149];_0x5c9af6[_0x23a5e0(0x27d)]='declined';const _0x1715dc={'role':_0x23a5e0(0x115c),'senderName':_0x44ce48['name'],'type':_0x23a5e0(0x4b3),'isRefund':!![],'amount':_0x5c9af6[_0x23a5e0(0x11fa)],'note':_0x23a5e0(0xf9b),'timestamp':_0x164c31++};_0x44ce48[_0x23a5e0(0x1f0)]['push'](_0x1715dc),_0x467872&&(_0x1ef393(_0x1715dc,_0x44ce48),_0x56abd7(_0x1e2092));}continue;}case'change_group_name':if(_0x44ce48[_0x23a5e0(0x136b)]&&_0x44194e['new_name']){const _0x404a5c=_0x44194e[_0x23a5e0(0x125c)][_0x23a5e0(0x13f9)](),_0x4f4012=_0x44ce48['members'][_0x23a5e0(0xb0a)](_0x224444=>_0x224444['originalName']);if(_0x4f4012[_0x23a5e0(0x478)](_0x404a5c)){console[_0x23a5e0(0x651)](_0x23a5e0(0xc58)+_0x44194e[_0x23a5e0(0x1561)]+_0x23a5e0(0x1393)+_0x404a5c+_0x23a5e0(0x406));continue;}_0x44ce48['name']=_0x404a5c;const _0x1b4ebd=_0x44ce48[_0x23a5e0(0xcca)][_0x23a5e0(0xd62)](_0x5c8bcc=>_0x5c8bcc[_0x23a5e0(0x339)]===_0x44194e[_0x23a5e0(0x1561)]),_0x48115e=_0x1b4ebd?_0x1b4ebd[_0x23a5e0(0xaf0)]:_0x44194e[_0x23a5e0(0x1561)],_0x5458e1={'role':_0x23a5e0(0xe10),'type':'pat_message','content':_0x48115e+'\x20将群名修改为\x20“'+_0x44ce48[_0x23a5e0(0x1561)]+'”','timestamp':_0x164c31++};_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0x1c4)](_0x5458e1),_0x467872&&(_0x1ef393(_0x5458e1,_0x44ce48),document[_0x23a5e0(0x9a3)]('chat-header-title')[_0x23a5e0(0x766)]=_0x44ce48[_0x23a5e0(0x1561)]);}continue;case'change_remark_name':if(!_0x44ce48['isGroup']&&_0x44194e[_0x23a5e0(0x125c)]){const _0x521413=_0x44ce48[_0x23a5e0(0x1561)],_0x3ce947=_0x44194e[_0x23a5e0(0x125c)][_0x23a5e0(0x13f9)]();if(_0x3ce947&&_0x3ce947!==_0x521413){!_0x44ce48[_0x23a5e0(0x1058)]&&(_0x44ce48[_0x23a5e0(0x1058)]=[]);!_0x44ce48['nameHistory'][_0x23a5e0(0x478)](_0x521413)&&_0x44ce48['nameHistory'][_0x23a5e0(0x1c4)](_0x521413);_0x44ce48[_0x23a5e0(0x1561)]=_0x3ce947;const _0x20be3f={'role':_0x23a5e0(0xe10),'type':_0x23a5e0(0x1082),'content':'“'+_0x44ce48[_0x23a5e0(0x339)]+'”\x20将备注修改为\x20“'+_0x3ce947+'”','timestamp':_0x164c31++};_0x44ce48[_0x23a5e0(0x1f0)]['push'](_0x20be3f);const _0x3a3af5={'role':_0x23a5e0(0xe10),'content':_0x23a5e0(0x14c9)+_0x3ce947+_0x23a5e0(0xb1a),'timestamp':_0x164c31++,'isHidden':!![]};_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0x1c4)](_0x3a3af5),_0x467872&&(_0x1ef393(_0x20be3f,_0x44ce48),document[_0x23a5e0(0x9a3)](_0x23a5e0(0x991))[_0x23a5e0(0x766)]=_0x3ce947),await _0xa82516(_0x44ce48);}}continue;case _0x23a5e0(0xc30):if(_0x44ce48['isGroup']&&_0x44194e[_0x23a5e0(0x21a)]){const _0x31345e=_0x44194e[_0x23a5e0(0x21a)],_0x222e88=_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x284)]||[],_0x35ea58=_0x222e88[_0x23a5e0(0xd62)](_0x504b3f=>_0x504b3f[_0x23a5e0(0x1561)]===_0x31345e);if(_0x35ea58){_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x20a)]=_0x35ea58['url'];const _0x38782f=_0x44ce48[_0x23a5e0(0xcca)][_0x23a5e0(0xd62)](_0x366567=>_0x366567['originalName']===_0x44194e[_0x23a5e0(0x1561)]),_0x430e71=_0x38782f?_0x38782f[_0x23a5e0(0xaf0)]:_0x44194e[_0x23a5e0(0x1561)],_0x31ee1c={'role':_0x23a5e0(0xe10),'type':_0x23a5e0(0x1082),'content':_0x430e71+_0x23a5e0(0x294),'timestamp':_0x164c31++};_0x44ce48['history'][_0x23a5e0(0x1c4)](_0x31ee1c),_0x467872&&_0x1ef393(_0x31ee1c,_0x44ce48);}else console[_0x23a5e0(0x651)](_0x23a5e0(0x45d)+_0x31345e+'\x22');}continue;case'system_message':_0x40eefc={'role':'system','type':_0x23a5e0(0x1082),'content':_0x44194e[_0x23a5e0(0x4e3)],'timestamp':Date[_0x23a5e0(0x64b)]()};break;case'share_link':_0x40eefc={..._0x13cedd,'type':_0x23a5e0(0x721),'title':_0x44194e[_0x23a5e0(0x10b8)],'description':_0x44194e[_0x23a5e0(0x3ef)],'source_name':_0x44194e[_0x23a5e0(0xc48)],'content':_0x44194e[_0x23a5e0(0x4e3)]};break;case _0x23a5e0(0xe7b):const _0x14ddf4=_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0xd62)](_0x396060=>_0x396060[_0x23a5e0(0xd73)]===_0x44194e[_0x23a5e0(0xd4b)]);if(_0x14ddf4){const _0xbc1e32={'timestamp':_0x14ddf4[_0x23a5e0(0xd73)],'senderName':_0x14ddf4['senderName']||(_0x14ddf4['role']===_0x23a5e0(0x20d)?_0x44ce48[_0x23a5e0(0x450)][_0x23a5e0(0x1555)]||'我':_0x44ce48[_0x23a5e0(0x1561)]),'content':String(_0x14ddf4[_0x23a5e0(0x4e3)]||'')[_0x23a5e0(0x72e)](0x0,0x32)};_0x40eefc={..._0x13cedd,'content':_0x44194e[_0x23a5e0(0x69c)],'quote':_0xbc1e32};}else _0x40eefc={..._0x13cedd,'content':_0x44194e[_0x23a5e0(0x69c)]};break;case _0x23a5e0(0xe91):{if(!_0x467872)continue;const _0x5bc3da={..._0x13cedd,'content':_0x44194e[_0x23a5e0(0x4e3)]},_0x2af62b=_0xb42d69(_0x5bc3da,_0x44ce48);_0x1ef393(_0x5bc3da,_0x44ce48,!![]),await new Promise(_0x477905=>setTimeout(_0x477905,Math['random']()*0x3e8+0x5dc));const _0x5c0601=document[_0x23a5e0(0xc86)](_0x23a5e0(0x1c5)+_0x5bc3da[_0x23a5e0(0xd73)]+'\x22]')?.['closest'](_0x23a5e0(0x141c));if(_0x5c0601){_0x5c0601[_0x23a5e0(0x4d8)][_0x23a5e0(0xe05)](_0x23a5e0(0xb3a)),await new Promise(_0x541b0d=>setTimeout(_0x541b0d,0x12c));const _0x830628={'role':_0x23a5e0(0x115c),'senderName':_0x44194e[_0x23a5e0(0x1561)]||_0x44ce48[_0x23a5e0(0x1561)],'type':_0x23a5e0(0xd60),'content':_0x23a5e0(0x132e),'timestamp':_0x5bc3da[_0x23a5e0(0xd73)],'recalledData':{'originalType':_0x23a5e0(0x13ca),'originalContent':_0x44194e['content']}},_0x5e4290=_0x44ce48[_0x23a5e0(0x1f0)][_0x23a5e0(0x455)](_0x494f44=>_0x494f44[_0x23a5e0(0xd73)]===_0x5bc3da[_0x23a5e0(0xd73)]);_0x5e4290>-0x1?_0x44ce48[_0x23a5e0(0x1f0)][_0x5e4290]=_0x830628:_0x44ce48['history'][_0x23a5e0(0x1c4)](_0x830628);const _0x10d78c=await _0xb42d69(_0x830628,_0x44ce48);document[_0x23a5e0(0x7c3)][_0x23a5e0(0x1222)](_0x5c0601)&&_0x5c0601['parentNode'][_0x23a5e0(0x15ab)](_0x10d78c,_0x5c0601);}continue;}case _0x23a5e0(0x13ca):_0x40eefc={..._0x13cedd,'content':String(_0x44194e[_0x23a5e0(0x4e3)]||_0x44194e[_0x23a5e0(0xcce)])};break;case'sticker':if(_0x44194e[_0x23a5e0(0x7da)]){const _0x3a31f4=_0x19ddb8[_0x23a5e0(0x1557)][_0x23a5e0(0xd62)](_0x4aa738=>_0x4aa738[_0x23a5e0(0x1561)]===_0x44194e[_0x23a5e0(0x7da)]);_0x3a31f4?_0x40eefc={..._0x13cedd,'type':_0x23a5e0(0xda8),'content':_0x3a31f4[_0x23a5e0(0x121f)],'meaning':_0x3a31f4[_0x23a5e0(0x1561)]}:(console[_0x23a5e0(0x651)]('AI\x20尝试使用一个不存在的表情:\x20\x22'+_0x44194e[_0x23a5e0(0x7da)]+'\x22'),_0x40eefc={..._0x13cedd,'type':'text','content':_0x23a5e0(0x22a)+_0x44194e['meaning']+']'});}else console[_0x23a5e0(0x651)](_0x23a5e0(0x149e),_0x44194e),_0x40eefc={..._0x13cedd,'type':_0x23a5e0(0xda8),'content':_0x44194e[_0x23a5e0(0x121f)],'meaning':'未知表情'};break;case _0x23a5e0(0x1c1):_0x40eefc={..._0x13cedd,'type':_0x23a5e0(0x1c1),'content':_0x44194e[_0x23a5e0(0x3ef)],'image_prompt':_0x44194e[_0x23a5e0(0xb95)]};break;case _0x23a5e0(0x1207):_0x40eefc={..._0x13cedd,'type':_0x23a5e0(0x1207),'content':_0x44194e['content']};break;case'transfer':_0x40eefc={..._0x13cedd,'type':_0x23a5e0(0x4b3),'amount':_0x44194e['amount'],'note':_0x44194e['note'],'receiverName':_0x44194e['receiver']||'我'};break;case _0x23a5e0(0x12ec):_0x40eefc={..._0x13cedd,'type':_0x23a5e0(0x12ec),'productInfo':_0x44194e[_0x23a5e0(0xd97)],'amount':_0x44194e[_0x23a5e0(0x11fa)],'status':_0x23a5e0(0x550),'countdownEndTime':Date[_0x23a5e0(0x64b)]()+0xf*0x3c*0x3e8};break;case _0x23a5e0(0xaf6):_0x40eefc={..._0x13cedd,'type':'waimai_order','productInfo':_0x44194e[_0x23a5e0(0xd97)],'amount':_0x44194e[_0x23a5e0(0x11fa)],'greeting':_0x44194e[_0x23a5e0(0x1524)],'recipientName':_0x44194e[_0x23a5e0(0xa6b)]||null};break;case _0x23a5e0(0x12fb):_0x40eefc={..._0x13cedd,..._0x44194e};break;case'naiimag':try{console[_0x23a5e0(0xe4d)]('📸\x20NovelAI图片生成开始，AI提供的prompt:',_0x44194e[_0x23a5e0(0x3a1)]);const _0x238e2b=_0x2bcefd(_0x44ce48['id']),_0x3c9138=_0x44194e[_0x23a5e0(0x3a1)]||'a\x20beautiful\x20scene',_0x293cda=_0x3c9138+',\x20'+_0x238e2b[_0x23a5e0(0xe44)],_0x5b6dec=_0x238e2b['negative'];console[_0x23a5e0(0xe4d)]('📝\x20使用'+(_0x238e2b[_0x23a5e0(0x98c)]===_0x23a5e0(0xb44)?'角色专属':'系统')+_0x23a5e0(0xddb)),console[_0x23a5e0(0xe4d)]('最终正面提示词:',_0x293cda),console[_0x23a5e0(0xe4d)](_0x23a5e0(0x262),_0x5b6dec);const _0x6607b1=localStorage[_0x23a5e0(0x5de)](_0x23a5e0(0x4a1)),_0x2c63d8=localStorage[_0x23a5e0(0x5de)]('novelai-model')||_0x23a5e0(0x9dd),_0x955360=_0x520f76();if(!_0x6607b1)throw new Error(_0x23a5e0(0x3ed));const [_0xc4dc21,_0x551772]=_0x955360[_0x23a5e0(0xab4)][_0x23a5e0(0x1536)]('x')['map'](Number);let _0x4a2b36;_0x2c63d8[_0x23a5e0(0x478)](_0x23a5e0(0xb29))?_0x4a2b36={'input':_0x293cda,'model':_0x2c63d8,'action':'generate','parameters':{'params_version':0x3,'width':_0xc4dc21,'height':_0x551772,'scale':_0x955360['cfg_scale'],'sampler':_0x955360[_0x23a5e0(0x1f6)],'steps':_0x955360[_0x23a5e0(0x124e)],'seed':_0x955360['seed']===-0x1?Math['floor'](Math[_0x23a5e0(0xdcd)]()*0x2540be3ff):_0x955360['seed'],'n_samples':0x1,'ucPreset':_0x955360[_0x23a5e0(0x70e)],'qualityToggle':_0x955360[_0x23a5e0(0x14e7)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x23a5e0(0xff5),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x293cda,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x5b6dec,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x5b6dec,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x4a2b36={'input':_0x293cda,'model':_0x2c63d8,'action':_0x23a5e0(0xa7d),'parameters':{'width':_0xc4dc21,'height':_0x551772,'scale':_0x955360[_0x23a5e0(0xd7e)],'sampler':_0x955360['sampler'],'steps':_0x955360[_0x23a5e0(0x124e)],'seed':_0x955360['seed']===-0x1?Math[_0x23a5e0(0xd95)](Math['random']()*0x2540be3ff):_0x955360[_0x23a5e0(0xaec)],'n_samples':0x1,'ucPreset':_0x955360[_0x23a5e0(0x70e)],'qualityToggle':_0x955360[_0x23a5e0(0x14e7)],'sm':_0x955360[_0x23a5e0(0x1b9)],'sm_dyn':_0x955360[_0x23a5e0(0x14c8)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x23a5e0(0xce0),'negative_prompt':_0x5b6dec}};console['log'](_0x23a5e0(0x1122),_0x4a2b36);let _0x3b9af8;_0x2c63d8[_0x23a5e0(0x478)](_0x23a5e0(0xb29))?_0x3b9af8=_0x23a5e0(0x335):_0x3b9af8=_0x23a5e0(0xc0b);let _0x292b82=_0x955360[_0x23a5e0(0x553)];_0x292b82===_0x23a5e0(0xbe4)&&(_0x292b82=_0x955360[_0x23a5e0(0x1421)]||'');_0x292b82&&_0x292b82!==''&&(_0x3b9af8=_0x292b82+encodeURIComponent(_0x3b9af8));const _0x1dba29=await fetch(_0x3b9af8,{'method':_0x23a5e0(0x12db),'headers':{'Content-Type':_0x23a5e0(0xb1f),'Authorization':'Bearer\x20'+_0x6607b1},'body':JSON['stringify'](_0x4a2b36)});console[_0x23a5e0(0xe4d)]('Response\x20status:',_0x1dba29[_0x23a5e0(0x27d)]),console[_0x23a5e0(0xe4d)](_0x23a5e0(0x1466),[..._0x1dba29['headers'][_0x23a5e0(0x10c3)]()]);if(!_0x1dba29['ok']){const _0x26fc04=await _0x1dba29['text']();console['error'](_0x23a5e0(0xf0b),_0x26fc04);throw new Error(_0x23a5e0(0x1483)+_0x1dba29[_0x23a5e0(0x27d)]+_0x23a5e0(0x41b)+_0x26fc04);}const _0x25c5d1=_0x1dba29['headers'][_0x23a5e0(0x14ee)](_0x23a5e0(0x1522));console['log'](_0x23a5e0(0x9c0),_0x25c5d1);let _0x3f6bdf,_0x323246;if(_0x25c5d1&&_0x25c5d1[_0x23a5e0(0x478)](_0x23a5e0(0xbf9))){console[_0x23a5e0(0xe4d)](_0x23a5e0(0x13e9));const _0x2ee756=await _0x1dba29[_0x23a5e0(0x13ca)]();console['log'](_0x23a5e0(0xd17),_0x2ee756[_0x23a5e0(0x106b)]);const _0x2e5de5=_0x2ee756[_0x23a5e0(0x13f9)]()['split']('\x0a');let _0x12caad=null;for(let _0x124cc2=_0x2e5de5[_0x23a5e0(0x106b)]-0x1;_0x124cc2>=0x0;_0x124cc2--){const _0x1b416e=_0x2e5de5[_0x124cc2][_0x23a5e0(0x13f9)]();if(_0x1b416e[_0x23a5e0(0x608)](_0x23a5e0(0x5ba))&&_0x1b416e!==_0x23a5e0(0xa69)){const _0x816f4d=_0x1b416e['substring'](0x6);try{const _0x5cc526=JSON[_0x23a5e0(0x1447)](_0x816f4d);if(_0x5cc526[_0x23a5e0(0x50b)]===_0x23a5e0(0x1065)&&_0x5cc526[_0x23a5e0(0x547)]){_0x12caad=_0x5cc526['image'],console[_0x23a5e0(0xe4d)]('✅\x20找到\x20final\x20事件的图片数据');break;}if(_0x5cc526[_0x23a5e0(0x38c)]){_0x12caad=_0x5cc526['data'],console[_0x23a5e0(0xe4d)]('从\x20JSON.data\x20中提取图片数据');break;}if(_0x5cc526[_0x23a5e0(0x547)]){_0x12caad=_0x5cc526[_0x23a5e0(0x547)],console['log'](_0x23a5e0(0x85b));break;}}catch(_0x4d3809){_0x12caad=_0x816f4d,console['log'](_0x23a5e0(0xfdf));break;}}}if(!_0x12caad)throw new Error(_0x23a5e0(0x1153));const _0x51b2e2=_0x12caad[_0x23a5e0(0x608)]('iVBORw0KGgo'),_0x456e82=_0x12caad[_0x23a5e0(0x608)]('/9j/');if(_0x51b2e2||_0x456e82){console[_0x23a5e0(0xe4d)](_0x23a5e0(0xa8c));const _0x556e1a=atob(_0x12caad),_0x5e740e=new Uint8Array(_0x556e1a[_0x23a5e0(0x106b)]);for(let _0x13a3bf=0x0;_0x13a3bf<_0x556e1a[_0x23a5e0(0x106b)];_0x13a3bf++){_0x5e740e[_0x13a3bf]=_0x556e1a[_0x23a5e0(0xc75)](_0x13a3bf);}const _0x36a354=new Blob([_0x5e740e],{'type':_0x51b2e2?'image/png':_0x23a5e0(0x80a)});console['log'](_0x23a5e0(0x649),_0x36a354[_0x23a5e0(0xbdf)]);const _0x24ae6a=new FileReader();_0x323246=await new Promise((_0x285cdd,_0x5a76a8)=>{const _0x1f8bf7=_0x23a5e0;_0x24ae6a['onloadend']=()=>_0x285cdd(_0x24ae6a[_0x1f8bf7(0x5c9)]),_0x24ae6a[_0x1f8bf7(0xb8b)]=_0x5a76a8,_0x24ae6a[_0x1f8bf7(0xdd8)](_0x36a354);}),console[_0x23a5e0(0xe4d)](_0x23a5e0(0x5ca));}else{console[_0x23a5e0(0xe4d)]('当作\x20ZIP\x20文件处理...');const _0x161a00=atob(_0x12caad),_0x29ea26=new Uint8Array(_0x161a00[_0x23a5e0(0x106b)]);for(let _0x44e142=0x0;_0x44e142<_0x161a00[_0x23a5e0(0x106b)];_0x44e142++){_0x29ea26[_0x44e142]=_0x161a00[_0x23a5e0(0xc75)](_0x44e142);}_0x3f6bdf=new Blob([_0x29ea26]),console[_0x23a5e0(0xe4d)](_0x23a5e0(0x104c),_0x3f6bdf[_0x23a5e0(0xbdf)]);}}else _0x3f6bdf=await _0x1dba29[_0x23a5e0(0xf11)](),console[_0x23a5e0(0xe4d)](_0x23a5e0(0xc2a),_0x3f6bdf[_0x23a5e0(0x1508)],_0x23a5e0(0xfa5),_0x3f6bdf[_0x23a5e0(0xbdf)]);if(!_0x323246&&_0x3f6bdf)try{if(typeof JSZip===_0x23a5e0(0x738))throw new Error(_0x23a5e0(0x3a3));const _0x5d44af=await JSZip[_0x23a5e0(0xf9a)](_0x3f6bdf);console[_0x23a5e0(0xe4d)](_0x23a5e0(0xa87),Object[_0x23a5e0(0x2d0)](_0x5d44af[_0x23a5e0(0x104e)]));let _0x1399d9=null;for(let _0xcb06f1 in _0x5d44af['files']){if(_0xcb06f1[_0x23a5e0(0x293)](/\.(png|jpg|jpeg|webp)$/i)){_0x1399d9=_0x5d44af[_0x23a5e0(0x104e)][_0xcb06f1],console[_0x23a5e0(0xe4d)]('找到图片文件:',_0xcb06f1);break;}}if(!_0x1399d9)throw new Error('ZIP文件中未找到图片');const _0x73bb5=await _0x1399d9['async'](_0x23a5e0(0xf11));console[_0x23a5e0(0xe4d)](_0x23a5e0(0xc44),_0x73bb5['size']);const _0x2780b0=new FileReader();_0x323246=await new Promise((_0x4997e5,_0x47f4d9)=>{const _0x5a3578=_0x23a5e0;_0x2780b0[_0x5a3578(0x15b8)]=()=>_0x4997e5(_0x2780b0['result']),_0x2780b0[_0x5a3578(0xb8b)]=_0x47f4d9,_0x2780b0[_0x5a3578(0xdd8)](_0x73bb5);}),console[_0x23a5e0(0xe4d)](_0x23a5e0(0x9c7));}catch(_0x67bee8){console['error'](_0x23a5e0(0xe5b),_0x67bee8);throw new Error(_0x23a5e0(0x1121)+_0x67bee8[_0x23a5e0(0xcce)]);}console[_0x23a5e0(0xe4d)]('✅\x20NAI图片生成成功！'),_0x40eefc={..._0x13cedd,'type':'naiimag','imageUrl':_0x323246,'prompt':_0x3c9138,'fullPrompt':_0x293cda};}catch(_0x2be5d0){console['error'](_0x23a5e0(0x7be),_0x2be5d0),_0x40eefc={..._0x13cedd,'content':_0x23a5e0(0xa13)+_0x2be5d0[_0x23a5e0(0xcce)]+']'};}break;default:console[_0x23a5e0(0x651)](_0x23a5e0(0xb11),_0x44194e[_0x23a5e0(0x1508)]);break;}if(_0x40eefc){_0x44ce48['history'][_0x23a5e0(0x1c4)](_0x40eefc);!_0x467872&&(_0x44ce48[_0x23a5e0(0xe20)]=(_0x44ce48[_0x23a5e0(0xe20)]||0x0)+0x1);if(!_0x467872&&!_0x456f55){let _0x34a2b1;switch(_0x40eefc['type']){case _0x23a5e0(0x4b3):_0x34a2b1='[收到一笔转账]';break;case _0x23a5e0(0x12ec):_0x34a2b1=_0x23a5e0(0x1521);break;case'ai_image':_0x34a2b1=_0x23a5e0(0xed3);break;case _0x23a5e0(0x1207):_0x34a2b1=_0x23a5e0(0x108d);break;case _0x23a5e0(0xda8):_0x34a2b1=_0x40eefc[_0x23a5e0(0x7da)]?_0x23a5e0(0x22a)+_0x40eefc[_0x23a5e0(0x7da)]+']':_0x23a5e0(0xbd5);break;case _0x23a5e0(0x12fb):_0x34a2b1=_0x40eefc[_0x23a5e0(0x103d)]?'「'+_0x40eefc['dialogue']+'」':'['+_0x40eefc[_0x23a5e0(0x3ef)][_0x23a5e0(0x72e)](0x0,0x14)+_0x23a5e0(0x544);break;default:_0x34a2b1=String(_0x40eefc[_0x23a5e0(0x4e3)]||'');}const _0x2a01c=_0x44ce48[_0x23a5e0(0x136b)]?_0x40eefc['senderName']+':\x20'+_0x34a2b1:_0x34a2b1;_0x1c6d8a(_0x1e2092,_0x2a01c[_0x23a5e0(0x72e)](0x0,0x28)+(_0x2a01c[_0x23a5e0(0x106b)]>0x28?_0x23a5e0(0x4a5):'')),_0x456f55=!![];}_0x467872&&(_0x1ef393(_0x40eefc,_0x44ce48),await new Promise(_0x1bc586=>setTimeout(_0x1bc586,Math[_0x23a5e0(0xdcd)]()*0x708+0x3e8)));}}_0x512fbf&&_0x4acdaf[_0x23a5e0(0x6a0)]&&(_0x4acdaf[_0x23a5e0(0x62c)]=![],_0x4acdaf[_0x23a5e0(0x9d3)]['length']>0x0?_0x1e2a5c():(_0x4acdaf={..._0x4acdaf,'isAwaitingResponse':![],'participants':[]},_0x35df44('chat-interface-screen'),alert('无人接听群聊邀请。')));if(_0x2d7ac5){await _0x55bf11();return;}await _0x512070[_0x23a5e0(0xb04)][_0x23a5e0(0xd4d)](_0x44ce48);const _0x3b10a5=_0x4129d2['some'](_0x1da4a5=>_0x1da4a5[_0x23a5e0(0x1508)]===_0x23a5e0(0x120f)||_0x1da4a5[_0x23a5e0(0x1508)]===_0x23a5e0(0x1176)||_0x1da4a5[_0x23a5e0(0x1508)]===_0x23a5e0(0x8ad)||_0x1da4a5[_0x23a5e0(0x1508)]===_0x23a5e0(0x5ee));_0x3b10a5&&(console[_0x23a5e0(0xe4d)]('检测到AI执行了动态操作，立即刷新好友动态页面。'),await _0x49acff());}catch(_0x38692f){_0x44ce48[_0x23a5e0(0x1f0)]=_0x44ce48[_0x23a5e0(0x1f0)]['filter'](_0x19bbcf=>!_0x19bbcf[_0x23a5e0(0x13c1)]),!_0x44ce48[_0x23a5e0(0x136b)]&&_0x44ce48[_0x23a5e0(0x239)]?.['status']==='pending_ai_approval'?(_0x44ce48[_0x23a5e0(0x239)][_0x23a5e0(0x27d)]=_0x23a5e0(0xf34),await _0x403a62('申请失败',_0x23a5e0(0x2ab)+_0x38692f['message'])):await _0x403a62(_0x23a5e0(0x57f),_0x23a5e0(0xeda)+_0x38692f[_0x23a5e0(0xcce)]),!_0x44ce48[_0x23a5e0(0x136b)]&&_0x44ce48['relationship']?.[_0x23a5e0(0x27d)]===_0x23a5e0(0xf34)&&await _0x512070['chats']['put'](_0x44ce48),_0x4acdaf['isAwaitingResponse']=![];}finally{_0x4fad07(_0x1e2092,![]),_0x44ce48[_0x23a5e0(0x136b)]?_0x55574c&&(_0x55574c[_0x23a5e0(0x20f)][_0x23a5e0(0x115d)]=_0x23a5e0(0x8e0)):_0x1a0575&&_0x19ddb8['chats'][_0x1e2092]&&(_0x1a0575['style'][_0x23a5e0(0x71f)]=0x0,setTimeout(()=>{const _0x2928a5=_0x23a5e0;_0x1a0575[_0x2928a5(0x766)]=_0x19ddb8['chats'][_0x1e2092]['name'],_0x1a0575[_0x2928a5(0x4d8)]['remove'](_0x2928a5(0x317)),_0x1a0575[_0x2928a5(0x20f)][_0x2928a5(0x71f)]=0x1;},0xc8)),_0xec8072(),_0x4f0b87&&_0x31e1d8(_0x1e2092),_0x10c9b2();}}async function _0x417ce8(_0x2075f2){const _0x45c315=_0x48bc6d;if(!_0x19ddb8[_0x45c315(0x859)])return;const _0x137dd1=_0x19ddb8[_0x45c315(0xb04)][_0x19ddb8['activeChatId']],_0xe1fca9={'role':_0x45c315(0x20d),'content':_0x2075f2[_0x45c315(0x121f)],'meaning':_0x2075f2[_0x45c315(0x1561)],'timestamp':Date[_0x45c315(0x64b)]()};_0x137dd1['history'][_0x45c315(0x1c4)](_0xe1fca9),await _0x512070[_0x45c315(0xb04)][_0x45c315(0xd4d)](_0x137dd1),_0x1ef393(_0xe1fca9,_0x137dd1),_0xec8072(),document['getElementById'](_0x45c315(0x598))['classList'][_0x45c315(0x133d)](_0x45c315(0xc09));}async function _0x512832(){const _0x2b579d=_0x48bc6d;if(!_0x19ddb8[_0x2b579d(0x859)])return;const _0x5df65d=document['getElementById'](_0x2b579d(0x588)),_0x5950a6=document[_0x2b579d(0x9a3)]('transfer-note'),_0x2b614f=parseFloat(_0x5df65d['value']),_0x2ce339=_0x5950a6[_0x2b579d(0x7b2)][_0x2b579d(0x13f9)]();if(isNaN(_0x2b614f)||_0x2b614f<0x0){alert('请输入有效的金额(必须大于0)！');return;}const _0x3c6e73=_0x19ddb8[_0x2b579d(0xb04)][_0x19ddb8['activeChatId']],_0x4cf0ef=_0x3c6e73[_0x2b579d(0x136b)]?_0x3c6e73[_0x2b579d(0x450)][_0x2b579d(0x1555)]||'我':'我',_0x2a28a4=_0x3c6e73[_0x2b579d(0x136b)]?'群聊':_0x3c6e73['name'],_0x65dd65={'role':_0x2b579d(0x20d),'type':'transfer','amount':_0x2b614f,'note':_0x2ce339,'senderName':_0x4cf0ef,'receiverName':_0x2a28a4,'timestamp':Date[_0x2b579d(0x64b)]()};_0x3c6e73[_0x2b579d(0x1f0)]['push'](_0x65dd65),await _0x512070[_0x2b579d(0xb04)]['put'](_0x3c6e73),_0x1ef393(_0x65dd65,_0x3c6e73),_0xec8072(),document[_0x2b579d(0x9a3)](_0x2b579d(0x64c))[_0x2b579d(0x4d8)][_0x2b579d(0x133d)]('visible'),_0x5df65d[_0x2b579d(0x7b2)]='',_0x5950a6['value']='';}async function _0x2664c3(){const _0x2da02d=_0x48bc6d;if(!_0x19ddb8[_0x2da02d(0x859)])return;const _0x36a2dd=document[_0x2da02d(0x9a3)]('waimai-product-info'),_0x15557b=document['getElementById'](_0x2da02d(0xf7e)),_0x1057e4=_0x36a2dd[_0x2da02d(0x7b2)][_0x2da02d(0x13f9)](),_0x3fd275=parseFloat(_0x15557b[_0x2da02d(0x7b2)]);if(!_0x1057e4||isNaN(_0x3fd275)||_0x3fd275<=0x0){alert('请填写有效的商品信息和金额！');return;}const _0x11e3a1=_0x19ddb8[_0x2da02d(0xb04)][_0x19ddb8['activeChatId']],_0x12c2b9=Date[_0x2da02d(0x64b)](),_0x7cc2d1=_0x11e3a1[_0x2da02d(0x136b)]?_0x11e3a1['settings'][_0x2da02d(0x1555)]||'我':'我',_0x5bd79b={'role':_0x2da02d(0x20d),'senderName':_0x7cc2d1,'type':_0x2da02d(0xaf6),'productInfo':_0x1057e4,'amount':_0x3fd275,'timestamp':_0x12c2b9};_0x11e3a1[_0x2da02d(0x1f0)][_0x2da02d(0x1c4)](_0x5bd79b);const _0x1b0138={'role':_0x2da02d(0xe10),'content':_0x2da02d(0x2ca)+_0x7cc2d1+_0x2da02d(0xddd)+_0x1057e4+_0x2da02d(0x113f)+_0x3fd275+_0x2da02d(0x1540),'timestamp':_0x12c2b9+0x1,'isHidden':!![]};_0x11e3a1[_0x2da02d(0x1f0)][_0x2da02d(0x1c4)](_0x1b0138),await _0x512070[_0x2da02d(0xb04)][_0x2da02d(0xd4d)](_0x11e3a1),_0x1ef393(_0x5bd79b,_0x11e3a1),_0xec8072(),_0x36a2dd[_0x2da02d(0x7b2)]='',_0x15557b[_0x2da02d(0x7b2)]='',document[_0x2da02d(0x9a3)](_0x2da02d(0x1a8))[_0x2da02d(0x4d8)]['remove'](_0x2da02d(0xc09));}async function _0x161c2b(){const _0x18dcc2=_0x48bc6d;if(!_0x19ddb8[_0x18dcc2(0x859)])return;const _0x31abf3=await _0x3ab788(_0x18dcc2(0x38d),_0x18dcc2(0x571),'');if(!_0x31abf3||!_0x31abf3[_0x18dcc2(0x13f9)]())return;const _0x16e24b=_0x18dcc2(0xc0d),_0x326f3e=_0x19ddb8['chats'][_0x19ddb8[_0x18dcc2(0x859)]],_0x537729={'role':_0x18dcc2(0x20d),'type':_0x18dcc2(0x12cc),'content':_0x31abf3['trim'](),'imageUrl':_0x16e24b,'timestamp':Date[_0x18dcc2(0x64b)]()};_0x326f3e[_0x18dcc2(0x1f0)][_0x18dcc2(0x1c4)](_0x537729),await _0x512070[_0x18dcc2(0xb04)][_0x18dcc2(0xd4d)](_0x326f3e),_0x1ef393(_0x537729,_0x326f3e),_0xec8072();}function _0x11fa62(_0x16933d){const _0x55c494=_0x48bc6d;if(_0x164883)return;_0x164883=!![],document['getElementById'](_0x55c494(0x3e5))[_0x55c494(0x4d8)]['add'](_0x55c494(0x7c8)),_0x27fede(_0x16933d);}function _0x501f17(){const _0xf430d7=_0x48bc6d;_0x10b9c4();if(!_0x164883)return;_0x164883=![],document[_0xf430d7(0x9a3)]('chat-interface-screen')[_0xf430d7(0x4d8)]['remove'](_0xf430d7(0x7c8)),_0x445138[_0xf430d7(0x15c1)](_0x304ebe=>{const _0x300eea=_0xf430d7,_0x3ae6d2=document[_0x300eea(0xc86)](_0x300eea(0x1c5)+_0x304ebe+'\x22]');if(_0x3ae6d2)_0x3ae6d2[_0x300eea(0x4d8)][_0x300eea(0x133d)]('selected');}),_0x445138[_0xf430d7(0xe81)]();}function _0x27fede(_0x35fefe){const _0x108b89=_0x48bc6d,_0x48ecec=document[_0x108b89(0xc86)](_0x108b89(0x1c5)+_0x35fefe+'\x22]');if(!_0x48ecec)return;_0x445138['has'](_0x35fefe)?(_0x445138[_0x108b89(0x10a8)](_0x35fefe),_0x48ecec[_0x108b89(0x4d8)]['remove']('selected')):(_0x445138[_0x108b89(0xe05)](_0x35fefe),_0x48ecec[_0x108b89(0x4d8)][_0x108b89(0xe05)](_0x108b89(0x154b))),document[_0x108b89(0x9a3)](_0x108b89(0x4de))[_0x108b89(0x766)]=_0x108b89(0xd9b)+_0x445138['size']+'\x20条',_0x445138[_0x108b89(0xbdf)]===0x0&&_0x501f17();}function _0x1a651b(_0x44a215,_0x35a17c){const _0x577afc=_0x48bc6d;let _0x9d6b49;const _0x85fed6=_0xe91fb6=>{const _0x16c6b4=_0x1efc;if(_0x164883)return;_0xe91fb6[_0x16c6b4(0x28d)](),_0x9d6b49=window[_0x16c6b4(0xa9c)](()=>_0x35a17c(_0xe91fb6),0x1f4);},_0x1f6cd7=()=>clearTimeout(_0x9d6b49);_0x44a215[_0x577afc(0x954)](_0x577afc(0x81d),_0x85fed6),_0x44a215[_0x577afc(0x954)](_0x577afc(0x11e4),_0x1f6cd7),_0x44a215[_0x577afc(0x954)](_0x577afc(0x1093),_0x1f6cd7),_0x44a215[_0x577afc(0x954)](_0x577afc(0xfab),_0x85fed6,{'passive':!![]}),_0x44a215[_0x577afc(0x954)](_0x577afc(0x36c),_0x1f6cd7),_0x44a215[_0x577afc(0x954)]('touchmove',_0x1f6cd7);}async function _0x3d708d(){const _0x71881f=_0x48bc6d,_0x585174=_0x19ddb8[_0x71881f(0x859)];if(!_0x585174)return;if(!_0x4e0631['isActive']){_0x24afe7(_0x585174);return;}if(_0x4e0631[_0x71881f(0x859)]===_0x585174)document[_0x71881f(0x9a3)](_0x71881f(0x1167))[_0x71881f(0x4d8)]['add'](_0x71881f(0xc09));else{const _0x5bb96b=_0x19ddb8[_0x71881f(0xb04)][_0x4e0631[_0x71881f(0x859)]]?.[_0x71881f(0x1561)]||'未知',_0x307c24=_0x19ddb8[_0x71881f(0xb04)][_0x585174]?.['name']||'当前',_0x16c94f=await _0x2c9509(_0x71881f(0x48f),'您正和「'+_0x5bb96b+'」听歌。要结束并开始和「'+_0x307c24+_0x71881f(0xdfb),{'confirmButtonClass':_0x71881f(0xf5b)});_0x16c94f&&(await _0x58ff6d(!![]),await new Promise(_0x4458e2=>setTimeout(_0x4458e2,0x32)),_0x24afe7(_0x585174));}}async function _0x24afe7(_0x314174){const _0x2da7f4=_0x48bc6d,_0x499f63=_0x19ddb8['chats'][_0x314174];if(!_0x499f63)return;_0x4e0631[_0x2da7f4(0x11e5)]=_0x499f63['musicData'][_0x2da7f4(0xa96)]||0x0,_0x4e0631['isActive']=!![],_0x4e0631[_0x2da7f4(0x859)]=_0x314174;_0x4e0631[_0x2da7f4(0x496)][_0x2da7f4(0x106b)]>0x0?_0x4e0631[_0x2da7f4(0xfe2)]=0x0:_0x4e0631[_0x2da7f4(0xfe2)]=-0x1;if(_0x4e0631[_0x2da7f4(0x1308)])clearInterval(_0x4e0631[_0x2da7f4(0x1308)]);_0x4e0631[_0x2da7f4(0x1308)]=setInterval(()=>{const _0x425310=_0x2da7f4;_0x4e0631[_0x425310(0xce1)]&&(_0x4e0631[_0x425310(0x11e5)]++,_0x5a4264());},0x3e8),_0x321261(),_0x28db92(),document[_0x2da7f4(0x9a3)](_0x2da7f4(0x1167))[_0x2da7f4(0x4d8)]['add'](_0x2da7f4(0xc09));}async function _0x58ff6d(_0x57b059=!![]){const _0x3646ad=_0x48bc6d;if(!_0x4e0631[_0x3646ad(0x1412)])return;const _0x4003c2=_0x4e0631[_0x3646ad(0x859)];document['getElementById']('global-lyrics-bar')[_0x3646ad(0x4d8)][_0x3646ad(0x133d)](_0x3646ad(0xc09));const _0x47fe02=async()=>{const _0x315912=_0x3646ad;if(_0x4e0631['timerId'])clearInterval(_0x4e0631['timerId']);if(_0x4e0631['isPlaying'])_0x4a7bb9[_0x315912(0x201)]();if(_0x57b059&&_0x4003c2&&_0x19ddb8[_0x315912(0xb04)][_0x4003c2]){const _0x59a8be=_0x19ddb8[_0x315912(0xb04)][_0x4003c2];_0x59a8be[_0x315912(0x8d3)][_0x315912(0xa96)]=_0x4e0631[_0x315912(0x11e5)],await _0x512070[_0x315912(0xb04)][_0x315912(0xd4d)](_0x59a8be);}_0x4e0631[_0x315912(0x1412)]=![],_0x4e0631[_0x315912(0x859)]=null,_0x4e0631['totalElapsedTime']=0x0,_0x4e0631[_0x315912(0x1308)]=null,_0x79fb29(_0x4003c2,!![]);};_0x4f83c7(_0x47fe02);}function _0x32a259(){_0x4f83c7();}function _0x79fb29(_0x31e825,_0x55456a=![]){const _0x3c7ec8=_0x48bc6d,_0x491411=document[_0x3c7ec8(0xc86)](_0x3c7ec8(0x909));if(!_0x491411)return;if(_0x55456a||!_0x4e0631['isActive']||_0x4e0631[_0x3c7ec8(0x859)]!==_0x31e825){_0x491411['src']=_0x3c7ec8(0xf44),_0x491411[_0x3c7ec8(0x1487)]='';return;}_0x491411[_0x3c7ec8(0x10d4)]=_0x3c7ec8(0x25d),_0x491411[_0x3c7ec8(0x4d8)][_0x3c7ec8(0xe05)](_0x3c7ec8(0x1278));if(_0x4e0631[_0x3c7ec8(0xce1)])_0x491411[_0x3c7ec8(0x4d8)]['remove'](_0x3c7ec8(0xac8));else _0x491411['classList'][_0x3c7ec8(0xe05)](_0x3c7ec8(0xac8));}window[_0x48bc6d(0x96e)]=_0x79fb29;function _0x321261(){const _0x5771d4=_0x48bc6d;_0x79fb29(_0x4e0631['activeChatId']),_0x5a4264();const _0x5a0da3=document['getElementById'](_0x5771d4(0x13c0)),_0x1887b2=document['getElementById']('music-player-artist'),_0x40ae6f=document['getElementById'](_0x5771d4(0x10ad));if(_0x4e0631[_0x5771d4(0xfe2)]>-0x1&&_0x4e0631[_0x5771d4(0x496)]['length']>0x0){const _0x113a7c=_0x4e0631[_0x5771d4(0x496)][_0x4e0631[_0x5771d4(0xfe2)]];_0x5a0da3[_0x5771d4(0x766)]=_0x113a7c[_0x5771d4(0x1561)],_0x1887b2['textContent']=_0x113a7c[_0x5771d4(0xf6d)];}else _0x5a0da3[_0x5771d4(0x766)]=_0x5771d4(0x1356),_0x1887b2[_0x5771d4(0x766)]=_0x5771d4(0x4a5);_0x40ae6f['textContent']=_0x4e0631[_0x5771d4(0xce1)]?'❚❚':'▶';}function _0x5a4264(){const _0x17eabb=_0x48bc6d,_0x202f05=(_0x4e0631['totalElapsedTime']/0xe10)[_0x17eabb(0x1322)](0x1);document[_0x17eabb(0x9a3)](_0x17eabb(0x7a3))[_0x17eabb(0x766)]=_0x17eabb(0x1c6)+_0x202f05+'小时';}function _0x28db92(){const _0x3a43ea=_0x48bc6d,_0x143557=document[_0x3a43ea(0x9a3)]('playlist-body');_0x143557['innerHTML']='';if(_0x4e0631['playlist'][_0x3a43ea(0x106b)]===0x0){_0x143557[_0x3a43ea(0xeb2)]=_0x3a43ea(0xbc3);return;}_0x4e0631['playlist'][_0x3a43ea(0x15c1)]((_0x28ad71,_0x109db8)=>{const _0x54d900=_0x3a43ea,_0x1c4f05=document[_0x54d900(0xe94)]('div');_0x1c4f05[_0x54d900(0x1487)]='playlist-item';if(_0x109db8===_0x4e0631[_0x54d900(0xfe2)])_0x1c4f05[_0x54d900(0x4d8)][_0x54d900(0xe05)]('playing');_0x1c4f05[_0x54d900(0xeb2)]=_0x54d900(0xedb)+_0x28ad71[_0x54d900(0x1561)]+_0x54d900(0x1390)+_0x28ad71['artist']+_0x54d900(0x147b)+_0x109db8+_0x54d900(0x1484)+_0x109db8+'\x22>词</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心新增】在这里添加“背景”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20bg-btn\x22\x20data-index=\x22'+_0x109db8+_0x54d900(0x128f)+_0x109db8+_0x54d900(0x104a),_0x1c4f05[_0x54d900(0xc86)](_0x54d900(0x312))['addEventListener'](_0x54d900(0x9cc),()=>_0x11f565(_0x109db8)),_0x143557[_0x54d900(0x983)](_0x1c4f05);});}async function _0x124e77(){const _0x10806b=_0x48bc6d;if(_0x4a7bb9[_0x10806b(0xac8)]){if(_0x4e0631[_0x10806b(0xfe2)]===-0x1&&_0x4e0631[_0x10806b(0x496)][_0x10806b(0x106b)]>0x0)_0x11f565(0x0);else _0x4e0631[_0x10806b(0xfe2)]>-0x1&&_0x11f565(_0x4e0631[_0x10806b(0xfe2)]);}else _0x4a7bb9[_0x10806b(0x201)](),await _0x2ca630(_0x10806b(0x142f));}function _0x205d59(){const _0x5715fc=_0x48bc6d;if(_0x4e0631[_0x5715fc(0x496)][_0x5715fc(0x106b)]===0x0)return;let _0x45cb72;switch(_0x4e0631[_0x5715fc(0x1219)]){case _0x5715fc(0xdcd):_0x45cb72=Math[_0x5715fc(0xd95)](Math[_0x5715fc(0xdcd)]()*_0x4e0631[_0x5715fc(0x496)]['length']);break;case _0x5715fc(0x1115):_0x11f565(_0x4e0631[_0x5715fc(0xfe2)]);return;case _0x5715fc(0x1111):default:_0x45cb72=(_0x4e0631['currentIndex']+0x1)%_0x4e0631[_0x5715fc(0x496)][_0x5715fc(0x106b)];break;}_0x11f565(_0x45cb72);}function _0x3aa407(){const _0x23c77b=_0x48bc6d;if(_0x4e0631[_0x23c77b(0x496)][_0x23c77b(0x106b)]===0x0)return;const _0x3518c8=(_0x4e0631['currentIndex']-0x1+_0x4e0631['playlist'][_0x23c77b(0x106b)])%_0x4e0631[_0x23c77b(0x496)][_0x23c77b(0x106b)];_0x11f565(_0x3518c8);}function _0x1506b2(){const _0x23ee76=_0x48bc6d,_0x59c59d=[_0x23ee76(0x1111),'random',_0x23ee76(0x1115)],_0x2902b9=_0x59c59d[_0x23ee76(0xef5)](_0x4e0631[_0x23ee76(0x1219)]);_0x4e0631[_0x23ee76(0x1219)]=_0x59c59d[(_0x2902b9+0x1)%_0x59c59d[_0x23ee76(0x106b)]],document['getElementById'](_0x23ee76(0x1597))[_0x23ee76(0x766)]={'order':'顺序','random':'随机','single':'单曲'}[_0x4e0631['playMode']];}async function _0x58e467(){const _0x1ef022=_0x48bc6d,_0x20c9b0=await _0x3ab788(_0x1ef022(0xe08),_0x1ef022(0x1306),'','url');if(!_0x20c9b0)return;const _0x111b7d=await _0x3ab788(_0x1ef022(0x581),_0x1ef022(0x1256));if(!_0x111b7d)return;const _0x50f811=await _0x3ab788('歌曲信息',_0x1ef022(0x12c1));if(!_0x50f811)return;_0x4e0631[_0x1ef022(0x496)][_0x1ef022(0x1c4)]({'name':_0x111b7d,'artist':_0x50f811,'src':_0x20c9b0,'isLocal':![]}),await _0x21cadb(),_0x28db92(),_0x4e0631[_0x1ef022(0xfe2)]===-0x1&&(_0x4e0631[_0x1ef022(0xfe2)]=_0x4e0631[_0x1ef022(0x496)][_0x1ef022(0x106b)]-0x1,_0x321261());}async function _0x4300aa(_0x47a979){const _0x18ca0b=_0x48bc6d,_0x4d391d=_0x47a979[_0x18ca0b(0xa41)][_0x18ca0b(0x104e)];if(!_0x4d391d[_0x18ca0b(0x106b)])return;for(const _0x5b673d of _0x4d391d){let _0x3a0e4d=_0x5b673d[_0x18ca0b(0x1561)][_0x18ca0b(0x1bb)](/\.[^/.]+$/,'');_0x3a0e4d=await _0x3ab788('歌曲信息','请输入歌名',_0x3a0e4d);if(_0x3a0e4d===null)continue;const _0x255e80=await _0x3ab788(_0x18ca0b(0x581),_0x18ca0b(0x12c1),_0x18ca0b(0x861));if(_0x255e80===null)continue;const _0x1c38f9=await _0x5b673d[_0x18ca0b(0x129a)]();let _0xfef1f3='';const _0x569fa6=await _0x2c9509(_0x18ca0b(0x45a),_0x18ca0b(0x3cc)+_0x3a0e4d+_0x18ca0b(0x871));_0x569fa6&&(_0xfef1f3=await _0x58c2db()||''),_0x4e0631['playlist']['push']({'name':_0x3a0e4d,'artist':_0x255e80,'src':_0x1c38f9,'fileType':_0x5b673d[_0x18ca0b(0x1508)],'isLocal':!![],'lrcContent':_0xfef1f3,'cover':'https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg'});}await _0x21cadb(),_0x28db92(),_0x4e0631[_0x18ca0b(0xfe2)]===-0x1&&_0x4e0631['playlist'][_0x18ca0b(0x106b)]>0x0&&(_0x4e0631[_0x18ca0b(0xfe2)]=0x0,_0x321261()),_0x47a979[_0x18ca0b(0xa41)][_0x18ca0b(0x7b2)]=null;}async function _0x11f565(_0x5da5ac){const _0x5a88fd=_0x48bc6d;if(_0x5da5ac<0x0||_0x5da5ac>=_0x4e0631[_0x5a88fd(0x496)][_0x5a88fd(0x106b)])return;_0x4a7bb9[_0x5a88fd(0x201)](),_0x4e0631[_0x5a88fd(0xfe2)]=_0x5da5ac;const _0x4d2969=_0x4e0631['playlist'][_0x5da5ac],_0x4eb2cf=_0x19ddb8['chats'][_0x4e0631[_0x5a88fd(0x859)]],_0x1936b5=document[_0x5a88fd(0x9a3)](_0x5a88fd(0x1299));if(_0x4eb2cf&&_0x1936b5){_0x1936b5[_0x5a88fd(0xeb2)]='';const _0xfbe33c=_0x4eb2cf[_0x5a88fd(0x136b)]?_0x4eb2cf[_0x5a88fd(0xcca)]['find'](_0x1aa41f=>_0x1aa41f[_0x5a88fd(0x339)]===_0x4d2969[_0x5a88fd(0xf6d)])?.['avatar']||_0x4f81ff:_0x4eb2cf[_0x5a88fd(0x450)]['aiAvatar']||_0x4f81ff,_0x41c218=_0x4eb2cf['settings'][_0x5a88fd(0x1af)]||_0x4f81ff,_0x15e86a=document[_0x5a88fd(0xe94)](_0x5a88fd(0x1212));_0x15e86a[_0x5a88fd(0x10d4)]=_0xfbe33c,_0x15e86a[_0x5a88fd(0x1487)]=_0x5a88fd(0x1454),_0x15e86a['alt']=_0x5a88fd(0x13a5),_0x1936b5['appendChild'](_0x15e86a);const _0x1d658b=document['createElement']('img');_0x1d658b[_0x5a88fd(0x10d4)]=_0x41c218,_0x1d658b['className']=_0x5a88fd(0x1454),_0x1d658b[_0x5a88fd(0x881)]=_0x5a88fd(0x82d),_0x1936b5[_0x5a88fd(0x983)](_0x1d658b);}const _0x592683=document[_0x5a88fd(0xc86)](_0x5a88fd(0x26d)),_0x54b36e=document[_0x5a88fd(0x9a3)](_0x5a88fd(0x94a));_0x592683&&(_0x592683[_0x5a88fd(0x20f)][_0x5a88fd(0x11b9)](_0x5a88fd(0x114d),_0x4d2969['background']?_0x5a88fd(0x55b)+_0x4d2969[_0x5a88fd(0x5f1)]+')':_0x5a88fd(0x8e0)),_0x592683['classList'][_0x5a88fd(0xc02)](_0x5a88fd(0x1284),!!_0x4d2969[_0x5a88fd(0x12d2)]));_0x54b36e&&_0x54b36e[_0x5a88fd(0x4d8)]['toggle'](_0x5a88fd(0xe9f),!!_0x4d2969['isBgClear']);document[_0x5a88fd(0x9a3)](_0x5a88fd(0xd9d))[_0x5a88fd(0x4d8)][_0x5a88fd(0x133d)](_0x5a88fd(0x630));const _0x4d477a=document[_0x5a88fd(0x9a3)](_0x5a88fd(0x12f9));_0x4d477a&&(_0x4d477a[_0x5a88fd(0x10d4)]=_0x4d2969[_0x5a88fd(0x159e)]||'https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg');await _0x2ca630(_0x5a88fd(0x638)+_0x4d2969[_0x5a88fd(0x1561)]+'》'),_0x4e0631[_0x5a88fd(0xa1d)]=_0x7a1175(_0x4d2969[_0x5a88fd(0x1531)]||''),_0x21bd0e();const _0x145cca=document['getElementById'](_0x5a88fd(0x66f));_0x145cca&&(!_0x4e0631[_0x5a88fd(0xa1d)]||_0x4e0631[_0x5a88fd(0xa1d)][_0x5a88fd(0x106b)]===0x0?_0x145cca['textContent']=_0x5a88fd(0x330):_0x145cca[_0x5a88fd(0x766)]=_0x5a88fd(0x1124));if(_0x4d2969[_0x5a88fd(0x1460)]&&_0x4d2969[_0x5a88fd(0x10d4)]instanceof ArrayBuffer){const _0x44d249=new Blob([_0x4d2969[_0x5a88fd(0x10d4)]],{'type':_0x4d2969['fileType']||_0x5a88fd(0x13c3)});_0x4a7bb9['src']=URL['createObjectURL'](_0x44d249);}else{if(_0x4d2969[_0x5a88fd(0x1460)]&&_0x4d2969[_0x5a88fd(0x10d4)]instanceof Blob)_0x4a7bb9[_0x5a88fd(0x10d4)]=URL[_0x5a88fd(0xc56)](_0x4d2969[_0x5a88fd(0x10d4)]);else{if(!_0x4d2969[_0x5a88fd(0x1460)])_0x4a7bb9['src']=_0x4d2969[_0x5a88fd(0x10d4)];else{console['error'](_0x5a88fd(0x987),_0x4d2969);return;}}}const _0x55a944=_0x4a7bb9['play']();_0x55a944!==undefined&&_0x55a944['catch'](_0x463216=>{const _0x1d516b=_0x5a88fd;if(_0x463216[_0x1d516b(0x1561)]===_0x1d516b(0xe3b))console[_0x1d516b(0x651)](_0x1d516b(0xfef)),_0x4a7bb9[_0x1d516b(0x201)](),_0x403a62('播放已暂停','由于浏览器安全限制，AI切换的歌曲无法自动播放。请手动点击播放按钮\x20▶\x20继续欣赏。');else _0x463216[_0x1d516b(0x1561)]!==_0x1d516b(0x819)&&console[_0x1d516b(0x3b7)]('Playback\x20error:',_0x463216);});_0x28db92(),_0x321261();const _0xa9de77=document[_0x5a88fd(0x7c3)][_0x5a88fd(0x4d8)][_0x5a88fd(0x1222)]('frame-mode-active'),_0xce80a5=_0x19ddb8['globalSettings'][_0x5a88fd(0x9f4)]||![],_0xa33fca=document[_0x5a88fd(0x9a3)]('global-lyrics-bar');_0xa9de77||_0xce80a5?(phoneScreenForIsland['classList'][_0x5a88fd(0xe05)](_0x5a88fd(0xf13)),islandAlbumArt['src']=_0x4d2969[_0x5a88fd(0x159e)]||_0x5a88fd(0x1b8),_0xa33fca[_0x5a88fd(0x4d8)][_0x5a88fd(0x133d)](_0x5a88fd(0xc09))):(phoneScreenForIsland[_0x5a88fd(0x4d8)][_0x5a88fd(0x133d)](_0x5a88fd(0xf13)),_0x4e0631[_0x5a88fd(0xa1d)]&&_0x4e0631[_0x5a88fd(0xa1d)][_0x5a88fd(0x106b)]>0x0?(_0xa33fca[_0x5a88fd(0x766)]='♪',_0xa33fca[_0x5a88fd(0x4d8)][_0x5a88fd(0xe05)]('visible')):_0xa33fca[_0x5a88fd(0x4d8)][_0x5a88fd(0x133d)]('visible'));}async function _0x4bffca(_0x3ec3f6){const _0x55c566=_0x48bc6d;if(_0x3ec3f6<0x0||_0x3ec3f6>=_0x4e0631[_0x55c566(0x496)][_0x55c566(0x106b)])return;const _0xb38856=await _0x49acac(_0x55c566(0x1233),[{'text':_0x55c566(0x5a6),'value':_0x55c566(0x66d)},{'text':'🌐\x20使用网络URL','value':_0x55c566(0x121f)}]);let _0x35f410=null;if(_0xb38856===_0x55c566(0x66d))_0x35f410=await _0x5a2cc8();else _0xb38856==='url'&&(_0x35f410=await _0x3ab788(_0x55c566(0x159a),'请输入新的背景图片链接','','url'));if(_0x35f410&&_0x35f410[_0x55c566(0x13f9)]()){_0x4e0631[_0x55c566(0x496)][_0x3ec3f6][_0x55c566(0x5f1)]=_0x35f410['trim'](),await _0x21cadb();if(_0x4e0631['currentIndex']===_0x3ec3f6){const _0x5acc58=document[_0x55c566(0xc86)](_0x55c566(0x26d));_0x5acc58[_0x55c566(0x20f)][_0x55c566(0x11b9)](_0x55c566(0x114d),_0x55c566(0x55b)+_0x35f410['trim']()+')');}await _0x403a62('成功',_0x55c566(0x143b));}}async function _0x37bae6(_0xe99943){const _0x49f904=_0x48bc6d;if(_0xe99943<0x0||_0xe99943>=_0x4e0631[_0x49f904(0x496)][_0x49f904(0x106b)])return;const _0x34cac0=await _0x49acac(_0x49f904(0x365),[{'text':_0x49f904(0x5a6),'value':_0x49f904(0x66d)},{'text':_0x49f904(0x974),'value':_0x49f904(0x121f)}]);let _0x2cbaef=null;if(_0x34cac0===_0x49f904(0x66d))_0x2cbaef=await _0x5a2cc8();else _0x34cac0===_0x49f904(0x121f)&&(_0x2cbaef=await _0x3ab788(_0x49f904(0x159a),'请输入新的封面图片链接','',_0x49f904(0x121f)));if(_0x2cbaef&&_0x2cbaef[_0x49f904(0x13f9)]()){_0x4e0631[_0x49f904(0x496)][_0xe99943][_0x49f904(0x159e)]=_0x2cbaef['trim'](),await _0x21cadb();if(_0x4e0631[_0x49f904(0xfe2)]===_0xe99943){document[_0x49f904(0x9a3)](_0x49f904(0x12f9))['src']=_0x2cbaef[_0x49f904(0x13f9)]();const _0x35ff66=document[_0x49f904(0xc86)]('#vinyl-view\x20#music-player-cover');if(_0x35ff66)_0x35ff66[_0x49f904(0x10d4)]=_0x2cbaef[_0x49f904(0x13f9)]();}await _0x403a62('成功',_0x49f904(0x13b5));}}async function _0x45aba2(_0x5d2f3c){const _0xd1af28=_0x48bc6d;if(_0x5d2f3c<0x0||_0x5d2f3c>=_0x4e0631[_0xd1af28(0x496)][_0xd1af28(0x106b)])return;const _0x1c484e=_0x4e0631[_0xd1af28(0x496)][_0x5d2f3c],_0x50b043=_0x4e0631[_0xd1af28(0xce1)]&&_0x4e0631[_0xd1af28(0xfe2)]===_0x5d2f3c;if(_0x1c484e[_0xd1af28(0x1460)]&&_0x4a7bb9[_0xd1af28(0x10d4)]['startsWith'](_0xd1af28(0x12f0))&&_0x4e0631[_0xd1af28(0xfe2)]===_0x5d2f3c)URL[_0xd1af28(0xb93)](_0x4a7bb9[_0xd1af28(0x10d4)]);_0x4e0631[_0xd1af28(0x496)][_0xd1af28(0x15b0)](_0x5d2f3c,0x1),await _0x21cadb();if(_0x4e0631[_0xd1af28(0x496)][_0xd1af28(0x106b)]===0x0){if(_0x4e0631['isPlaying'])_0x4a7bb9[_0xd1af28(0x201)]();_0x4a7bb9[_0xd1af28(0x10d4)]='',_0x4e0631[_0xd1af28(0xfe2)]=-0x1,_0x4e0631[_0xd1af28(0xce1)]=![];}else{if(_0x50b043)_0x205d59();else{if(_0x4e0631[_0xd1af28(0xfe2)]>=_0x5d2f3c)_0x4e0631['currentIndex']=Math[_0xd1af28(0x812)](0x0,_0x4e0631['currentIndex']-0x1);}}_0x321261(),_0x28db92();}async function _0x4300aa(_0x32ecd1){const _0x211284=_0x48bc6d,_0x37b1dd=_0x32ecd1['target'][_0x211284(0x104e)];if(!_0x37b1dd['length'])return;for(const _0x104f50 of _0x37b1dd){let _0x35448f=_0x104f50[_0x211284(0x1561)][_0x211284(0x1bb)](/\.[^/.]+$/,'');_0x35448f=await _0x3ab788(_0x211284(0x581),_0x211284(0x1256),_0x35448f);if(_0x35448f===null)continue;const _0x1b4b3d=await _0x3ab788('歌曲信息',_0x211284(0x12c1),'未知歌手');if(_0x1b4b3d===null)continue;let _0x404d7e='';const _0x1a4f7b=await _0x2c9509(_0x211284(0x45a),_0x211284(0x3cc)+_0x35448f+_0x211284(0x871));_0x1a4f7b&&(_0x404d7e=await _0x58c2db()||''),_0x4e0631[_0x211284(0x496)][_0x211284(0x1c4)]({'name':_0x35448f,'artist':_0x1b4b3d,'src':_0x104f50,'isLocal':!![],'lrcContent':_0x404d7e});}await _0x21cadb(),_0x28db92(),_0x4e0631[_0x211284(0xfe2)]===-0x1&&_0x4e0631[_0x211284(0x496)][_0x211284(0x106b)]>0x0&&(_0x4e0631['currentIndex']=0x0,_0x321261()),_0x32ecd1['target'][_0x211284(0x7b2)]=null;}async function _0x45aba2(_0x3b8847){const _0x3919d0=_0x48bc6d;if(_0x3b8847<0x0||_0x3b8847>=_0x4e0631[_0x3919d0(0x496)][_0x3919d0(0x106b)])return;const _0x472a69=_0x4e0631[_0x3919d0(0x496)][_0x3b8847],_0x4827c4=_0x4e0631['isPlaying']&&_0x4e0631['currentIndex']===_0x3b8847;if(_0x472a69[_0x3919d0(0x1460)]&&_0x4a7bb9[_0x3919d0(0x10d4)][_0x3919d0(0x608)](_0x3919d0(0x12f0))&&_0x4e0631[_0x3919d0(0xfe2)]===_0x3b8847)URL[_0x3919d0(0xb93)](_0x4a7bb9[_0x3919d0(0x10d4)]);_0x4e0631[_0x3919d0(0x496)][_0x3919d0(0x15b0)](_0x3b8847,0x1),await _0x21cadb();if(_0x4e0631[_0x3919d0(0x496)]['length']===0x0){if(_0x4e0631[_0x3919d0(0xce1)])_0x4a7bb9['pause']();_0x4a7bb9['src']='',_0x4e0631[_0x3919d0(0xfe2)]=-0x1,_0x4e0631[_0x3919d0(0xce1)]=![];}else{if(_0x4827c4)_0x205d59();else{if(_0x4e0631[_0x3919d0(0xfe2)]>=_0x3b8847)_0x4e0631[_0x3919d0(0xfe2)]=Math[_0x3919d0(0x812)](0x0,_0x4e0631[_0x3919d0(0xfe2)]-0x1);}}_0x321261(),_0x28db92();}const _0x2ca02f=document[_0x48bc6d(0x9a3)](_0x48bc6d(0x155b)),_0x4dbc56=document[_0x48bc6d(0x9a3)](_0x48bc6d(0x113b)),_0x532184=document[_0x48bc6d(0x9a3)](_0x48bc6d(0x7d6));function _0x226e04(){const _0x3e813c=_0x48bc6d;_0x1244c9(),_0x2ca02f['classList'][_0x3e813c(0xe05)]('visible');}function _0x85b361(){const _0x5becf5=_0x48bc6d;_0x2ca02f[_0x5becf5(0x4d8)]['remove'](_0x5becf5(0xc09));}function _0x1244c9(){const _0x345b08=_0x48bc6d,_0x4deede=document[_0x345b08(0x9a3)](_0x345b08(0xf59));_0x4deede[_0x345b08(0xeb2)]='';if(_0x19ddb8[_0x345b08(0x1492)][_0x345b08(0x106b)]===0x0){_0x4deede['innerHTML']=_0x345b08(0x728);return;}_0x19ddb8[_0x345b08(0x1492)][_0x345b08(0x15c1)](_0xadf9ab=>{const _0x20807a=_0x345b08,_0x1e453c=document['createElement']('div');_0x1e453c[_0x20807a(0x1487)]='persona-preset-item',_0x1e453c['style']['backgroundImage']=_0x20807a(0x55b)+_0xadf9ab[_0x20807a(0xf3f)]+')',_0x1e453c[_0x20807a(0xd8d)][_0x20807a(0xaa1)]=_0xadf9ab['id'],_0x1e453c[_0x20807a(0x954)](_0x20807a(0x9cc),()=>_0x150e71(_0xadf9ab['id'])),_0x1a651b(_0x1e453c,()=>_0x5bb970(_0xadf9ab['id'])),_0x4deede[_0x20807a(0x983)](_0x1e453c);});}function _0x5bb970(_0x4f902d){const _0x329752=_0x48bc6d;_0xe96093=_0x4f902d,_0x532184['classList'][_0x329752(0xe05)]('visible');}function _0x261bea(){const _0xa1a298=_0x48bc6d;_0x532184[_0xa1a298(0x4d8)]['remove']('visible'),_0xe96093=null;}function _0x150e71(_0x485e91){const _0x487f92=_0x48bc6d,_0x141fb1=_0x19ddb8['personaPresets'][_0x487f92(0xd62)](_0x423841=>_0x423841['id']===_0x485e91);_0x141fb1&&(document['getElementById']('my-avatar-preview')[_0x487f92(0x10d4)]=_0x141fb1['avatar'],document[_0x487f92(0x9a3)](_0x487f92(0x15d8))[_0x487f92(0x7b2)]=_0x141fb1[_0x487f92(0xcd4)]),_0x85b361();}function _0x492e10(){const _0x3f7127=_0x48bc6d;_0xe96093=null,document[_0x3f7127(0x9a3)](_0x3f7127(0x51e))['textContent']=_0x3f7127(0x68e),document[_0x3f7127(0x9a3)](_0x3f7127(0xab8))['src']=_0x4f81ff,document[_0x3f7127(0x9a3)]('preset-persona-input')[_0x3f7127(0x7b2)]='',_0x4dbc56[_0x3f7127(0x4d8)][_0x3f7127(0xe05)](_0x3f7127(0xc09));}function _0x50ad00(){const _0x432d23=_0x48bc6d,_0x4af297=_0x19ddb8[_0x432d23(0x1492)][_0x432d23(0xd62)](_0x52e11f=>_0x52e11f['id']===_0xe96093);if(!_0x4af297)return;document['getElementById']('persona-editor-title')[_0x432d23(0x766)]='编辑人设预设',document[_0x432d23(0x9a3)](_0x432d23(0xab8))[_0x432d23(0x10d4)]=_0x4af297[_0x432d23(0xf3f)],document[_0x432d23(0x9a3)]('preset-persona-input')[_0x432d23(0x7b2)]=_0x4af297[_0x432d23(0xcd4)],_0x532184[_0x432d23(0x4d8)][_0x432d23(0x133d)](_0x432d23(0xc09)),_0x4dbc56[_0x432d23(0x4d8)][_0x432d23(0xe05)](_0x432d23(0xc09));}async function _0x16b3aa(){const _0x2b7d86=_0x48bc6d,_0x178e2e=await _0x2c9509(_0x2b7d86(0x1208),_0x2b7d86(0x74b),{'confirmButtonClass':'btn-danger'});_0x178e2e&&_0xe96093&&(await _0x512070['personaPresets']['delete'](_0xe96093),_0x19ddb8[_0x2b7d86(0x1492)]=_0x19ddb8[_0x2b7d86(0x1492)][_0x2b7d86(0x1195)](_0x2a1061=>_0x2a1061['id']!==_0xe96093),_0x261bea(),_0x1244c9());}function _0xf7ac75(){const _0x242e40=_0x48bc6d;_0x4dbc56['classList']['remove'](_0x242e40(0xc09)),_0xe96093=null;}async function _0x3b3bce(){const _0x2604ce=_0x48bc6d,_0x1fe745=document[_0x2604ce(0x9a3)](_0x2604ce(0xab8))['src'],_0x5159f5=document[_0x2604ce(0x9a3)](_0x2604ce(0x1416))[_0x2604ce(0x7b2)][_0x2604ce(0x13f9)]();if(_0x1fe745===_0x4f81ff&&!_0x5159f5){alert(_0x2604ce(0xfb3));return;}if(_0xe96093){const _0x5ed02f=_0x19ddb8[_0x2604ce(0x1492)][_0x2604ce(0xd62)](_0x150471=>_0x150471['id']===_0xe96093);_0x5ed02f&&(_0x5ed02f[_0x2604ce(0xf3f)]=_0x1fe745,_0x5ed02f['persona']=_0x5159f5,await _0x512070[_0x2604ce(0x1492)][_0x2604ce(0xd4d)](_0x5ed02f));}else{const _0x4911b4={'id':_0x2604ce(0xb40)+Date[_0x2604ce(0x64b)](),'avatar':_0x1fe745,'persona':_0x5159f5};await _0x512070[_0x2604ce(0x1492)][_0x2604ce(0xe05)](_0x4911b4),_0x19ddb8[_0x2604ce(0x1492)][_0x2604ce(0x1c4)](_0x4911b4);}_0x1244c9(),_0xf7ac75();}const _0x98ed72=document[_0x48bc6d(0x9a3)](_0x48bc6d(0x1493));function _0x2f78da(_0x33c1e7,_0x373581){const _0x429377=_0x48bc6d;clearTimeout(_0x2dc290),document[_0x429377(0x9a3)](_0x429377(0xa43))[_0x429377(0x10d4)]=_0x33c1e7,document[_0x429377(0x9a3)](_0x429377(0xf1e))['textContent']=_0x373581,_0x98ed72['classList'][_0x429377(0xe05)](_0x429377(0xc09));const _0x56b233=()=>{const _0x1fa74e=_0x429377;_0x98ed72['classList'][_0x1fa74e(0x133d)](_0x1fa74e(0xc09)),_0x98ed72[_0x1fa74e(0xd7f)](_0x1fa74e(0x9cc),_0x56b233);};_0x98ed72[_0x429377(0x954)]('click',_0x56b233),_0x2dc290=setTimeout(_0x56b233,0x7d0);}function _0x537cd6(_0x2dd81f){const _0x3e2463=_0x48bc6d,_0x190300=document[_0x3e2463(0x9a3)](_0x3e2463(0x802)),_0x4c1aa8=_0x190300[_0x3e2463(0xc86)](_0x3e2463(0x3c2)),_0x200f29=_0x190300['querySelector'](_0x3e2463(0xcb9)),_0x1816bf=Math[_0x3e2463(0xd95)](_0x2dd81f[_0x3e2463(0x2d6)]*0x64);_0x4c1aa8['style'][_0x3e2463(0xeb0)]=_0x1816bf+'%',_0x200f29[_0x3e2463(0x766)]=_0x1816bf+'%',_0x2dd81f['charging']?_0x190300[_0x3e2463(0x4d8)][_0x3e2463(0xe05)](_0x3e2463(0x148f)):_0x190300[_0x3e2463(0x4d8)]['remove'](_0x3e2463(0x148f));}function _0xa8a0bb(_0x274061){const _0x374dae=_0x48bc6d;_0x537cd6(_0x274061);const _0x4d02f0=_0x274061['level'];!_0x274061[_0x374dae(0x148f)]&&(_0x4d02f0<=0.4&&_0x1d42e1>0.4&&!_0x46c1e8['hasShown40']&&(_0x2f78da(_0x374dae(0x9c1),_0x374dae(0x10ef)),_0x46c1e8['hasShown40']=!![]),_0x4d02f0<=0.2&&_0x1d42e1>0.2&&!_0x46c1e8[_0x374dae(0x472)]&&(_0x2f78da('https://i.postimg.cc/qB9zbKs9/20.jpg',_0x374dae(0xb48)),_0x46c1e8['hasShown20']=!![]),_0x4d02f0<=0.1&&_0x1d42e1>0.1&&!_0x46c1e8['hasShown10']&&(_0x2f78da(_0x374dae(0xa65),_0x374dae(0xd02)),_0x46c1e8[_0x374dae(0x117f)]=!![]));if(_0x4d02f0>0.4)_0x46c1e8[_0x374dae(0x7ef)]=![];if(_0x4d02f0>0.2)_0x46c1e8[_0x374dae(0x472)]=![];if(_0x4d02f0>0.1)_0x46c1e8[_0x374dae(0x117f)]=![];_0x1d42e1=_0x4d02f0;}async function _0x16a703(){const _0x1acbf1=_0x48bc6d;if(_0x1acbf1(0x8c2)in navigator)try{const _0xb0e5d0=await navigator['getBattery']();_0x1d42e1=_0xb0e5d0[_0x1acbf1(0x2d6)],_0xa8a0bb(_0xb0e5d0),_0xb0e5d0['addEventListener']('levelchange',()=>_0xa8a0bb(_0xb0e5d0)),_0xb0e5d0[_0x1acbf1(0x954)]('chargingchange',()=>{const _0x10bef4=_0x1acbf1;_0xa8a0bb(_0xb0e5d0),_0xb0e5d0['charging']&&_0x2f78da(_0x10bef4(0x13e4),'窝爱泥，电量吃饱饱');});}catch(_0x5bfa66){console[_0x1acbf1(0x3b7)](_0x1acbf1(0x578),_0x5bfa66),document['querySelector'](_0x1acbf1(0xcb9))[_0x1acbf1(0x766)]=_0x1acbf1(0x10a4);}else console[_0x1acbf1(0xe4d)]('浏览器不支持电池状态API。'),document[_0x1acbf1(0xc86)](_0x1acbf1(0xcb9))[_0x1acbf1(0x766)]=_0x1acbf1(0x10a4);}async function _0x466477(){const _0x714aef=_0x48bc6d,_0x30a9a2=document[_0x714aef(0x9a3)](_0x714aef(0xe76));if(!_0x30a9a2)return;const _0x4ef0af=await _0x512070[_0x714aef(0x642)][_0x714aef(0x1404)](_0x714aef(0x1c0))[_0x714aef(0x333)]()[_0x714aef(0x591)]();_0x30a9a2[_0x714aef(0xeb2)]='';if(_0x4ef0af[_0x714aef(0x106b)]===0x0){_0x30a9a2[_0x714aef(0xeb2)]=_0x714aef(0x15a7);return;}_0x4ef0af[_0x714aef(0x15c1)](_0x272381=>{const _0x582955=_0x714aef,_0xebf401=document[_0x582955(0xe94)]('div');_0xebf401['className']='album-item',_0xebf401[_0x582955(0xeb2)]=_0x582955(0x11cb)+_0x272381[_0x582955(0xb22)]+_0x582955(0x401)+_0x272381['name']+_0x582955(0x42e)+(_0x272381[_0x582955(0xb35)]||0x0)+_0x582955(0xf45),_0xebf401[_0x582955(0x954)]('click',()=>{_0x3eb286(_0x272381['id']);}),_0x1a651b(_0xebf401,async()=>{const _0x201f88=_0x582955,_0x10cb9c=await _0x2c9509('删除相册','确定要删除相册《'+_0x272381[_0x201f88(0x1561)]+_0x201f88(0x847),{'confirmButtonClass':_0x201f88(0xf5b)});_0x10cb9c&&(await _0x512070['qzonePhotos'][_0x201f88(0x1201)]('albumId')[_0x201f88(0x5df)](_0x272381['id'])['delete'](),await _0x512070[_0x201f88(0x642)][_0x201f88(0x10a8)](_0x272381['id']),await _0x466477(),alert(_0x201f88(0x405)));}),_0x30a9a2[_0x582955(0x983)](_0xebf401);});}async function _0x3eb286(_0x5a5b3c){const _0x5b5a0e=_0x48bc6d;_0x19ddb8['activeAlbumId']=_0x5a5b3c,await _0x870de1(),_0x35df44(_0x5b5a0e(0x542));}async function _0x870de1(){const _0x9474d5=_0x48bc6d;if(!_0x19ddb8[_0x9474d5(0x12b1)])return;const _0x591917=document['getElementById'](_0x9474d5(0x2ed)),_0x3fa207=document[_0x9474d5(0x9a3)](_0x9474d5(0x10aa)),_0x1dd42b=await _0x512070[_0x9474d5(0x642)][_0x9474d5(0x14ee)](_0x19ddb8['activeAlbumId']);if(!_0x1dd42b){console[_0x9474d5(0x3b7)](_0x9474d5(0x147f),_0x19ddb8[_0x9474d5(0x12b1)]),_0x35df44(_0x9474d5(0x11c6));return;}_0x3fa207[_0x9474d5(0x766)]=_0x1dd42b[_0x9474d5(0x1561)];const _0x41fd42=await _0x512070['qzonePhotos'][_0x9474d5(0x1201)](_0x9474d5(0xe00))['equals'](_0x19ddb8[_0x9474d5(0x12b1)])['toArray']();_0x591917[_0x9474d5(0xeb2)]='',_0x41fd42[_0x9474d5(0x106b)]===0x0?_0x591917[_0x9474d5(0xeb2)]=_0x9474d5(0x2b7):_0x41fd42[_0x9474d5(0x15c1)](_0x18a892=>{const _0x39352d=_0x9474d5,_0x2d6436=document[_0x39352d(0xe94)](_0x39352d(0x8ca));_0x2d6436[_0x39352d(0x1487)]='photo-item',_0x2d6436[_0x39352d(0xeb2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x18a892[_0x39352d(0x121f)]+_0x39352d(0x2b4)+_0x18a892['id']+_0x39352d(0xe4f),_0x591917[_0x39352d(0x983)](_0x2d6436);});}async function _0x140b9e(_0x2688e6){const _0x5333e5=_0x48bc6d;if(!_0x19ddb8[_0x5333e5(0x12b1)])return;const _0x5da2c0=await _0x512070[_0x5333e5(0xc8d)][_0x5333e5(0x1201)](_0x5333e5(0xe00))[_0x5333e5(0x5df)](_0x19ddb8['activeAlbumId'])['toArray']();_0x7d9369[_0x5333e5(0xcf3)]=_0x5da2c0['map'](_0x24a298=>_0x24a298['url']),_0x7d9369[_0x5333e5(0xfe2)]=_0x7d9369[_0x5333e5(0xcf3)][_0x5333e5(0x455)](_0x524095=>_0x524095===_0x2688e6);if(_0x7d9369[_0x5333e5(0xfe2)]===-0x1)return;document[_0x5333e5(0x9a3)](_0x5333e5(0x1410))['classList'][_0x5333e5(0xe05)](_0x5333e5(0xc09)),_0x57618f(),_0x7d9369['isOpen']=!![];}function _0x57618f(){const _0x263eae=_0x48bc6d;if(_0x7d9369[_0x263eae(0xfe2)]===-0x1)return;const _0x5641e2=document[_0x263eae(0x9a3)](_0x263eae(0x1064)),_0x33b920=document[_0x263eae(0x9a3)]('photo-viewer-prev-btn'),_0x542d33=document[_0x263eae(0x9a3)](_0x263eae(0x1198));_0x5641e2[_0x263eae(0x20f)]['opacity']=0x0,setTimeout(()=>{const _0x4bc226=_0x263eae;_0x5641e2[_0x4bc226(0x10d4)]=_0x7d9369[_0x4bc226(0xcf3)][_0x7d9369[_0x4bc226(0xfe2)]],_0x5641e2[_0x4bc226(0x20f)][_0x4bc226(0x71f)]=0x1;},0x64),_0x33b920['disabled']=_0x7d9369['currentIndex']===0x0,_0x542d33[_0x263eae(0x15d3)]=_0x7d9369[_0x263eae(0xfe2)]===_0x7d9369[_0x263eae(0xcf3)][_0x263eae(0x106b)]-0x1;}function _0x50c917(){const _0x194521=_0x48bc6d;_0x7d9369[_0x194521(0xfe2)]<_0x7d9369['photos'][_0x194521(0x106b)]-0x1&&(_0x7d9369[_0x194521(0xfe2)]++,_0x57618f());}function _0x40af54(){const _0x243046=_0x48bc6d;_0x7d9369[_0x243046(0xfe2)]>0x0&&(_0x7d9369[_0x243046(0xfe2)]--,_0x57618f());}function _0x4197d3(){const _0x99f06c=_0x48bc6d;document['getElementById'](_0x99f06c(0x1410))[_0x99f06c(0x4d8)][_0x99f06c(0x133d)]('visible'),_0x7d9369['isOpen']=![],_0x7d9369[_0x99f06c(0xcf3)]=[],_0x7d9369[_0x99f06c(0xfe2)]=-0x1,document[_0x99f06c(0x9a3)](_0x99f06c(0x1064))['src']='';}function _0x28172c(_0x57f4b1){const _0x25494d=_0x48bc6d;_0x27ed94=_0x57f4b1,localStorage[_0x25494d(0x28a)](_0x25494d(0x17b),_0x57f4b1);const _0x1c1539=document[_0x25494d(0xc86)](_0x25494d(0x62d)),_0x25f6f9=_0x1c1539[_0x25494d(0xc86)](_0x25494d(0x1210));let _0x2c7540=_0x1c1539[_0x25494d(0xc86)]('.unread-indicator');_0x57f4b1>0x0?(!_0x2c7540&&(_0x2c7540=document['createElement'](_0x25494d(0x1210)),_0x2c7540['className']=_0x25494d(0x665),_0x25f6f9[_0x25494d(0x20f)]['position']='relative',_0x25f6f9[_0x25494d(0x983)](_0x2c7540)),_0x2c7540[_0x25494d(0x766)]=_0x57f4b1>0x63?'99+':_0x57f4b1,_0x2c7540[_0x25494d(0x20f)][_0x25494d(0x115d)]=_0x25494d(0x10c8)):_0x2c7540&&(_0x2c7540[_0x25494d(0x20f)][_0x25494d(0x115d)]=_0x25494d(0x8e0)),_0x14e2fe();}function _0x176181(){const _0x17e573=_0x48bc6d;if(_0x4351c8)return;const _0x121fda=_0x19ddb8['globalSettings'][_0x17e573(0x11ec)]||0x3c;_0x4351c8=setInterval(_0x514f71,_0x121fda*0x3e8),_0x590cab();}function _0x1e34b7(){_0x4351c8&&(clearInterval(_0x4351c8),_0x4351c8=null),_0x10c9b2();}async function _0x514f71(){const _0x345c0a=_0x48bc6d;console[_0x345c0a(0xe4d)](_0x345c0a(0xb28));if(!_0x19ddb8[_0x345c0a(0x4c8)]['enableBackgroundActivity']){_0x1e34b7();return;}const _0x1f8fdd=Object[_0x345c0a(0xea1)](_0x19ddb8[_0x345c0a(0xb04)])['filter'](_0x303690=>!_0x303690[_0x345c0a(0x136b)]);_0x1f8fdd[_0x345c0a(0x15c1)](_0x3c9af0=>{const _0x39e0b0=_0x345c0a;if(_0x3c9af0['relationship']?.[_0x39e0b0(0x27d)]==='blocked_by_user'){const _0x4dac34=_0x3c9af0[_0x39e0b0(0x239)][_0x39e0b0(0x3ce)];if(!_0x4dac34)return;const _0x1e9851=Date[_0x39e0b0(0x64b)]()-_0x4dac34,_0x46b1b8=(_0x19ddb8[_0x39e0b0(0x4c8)][_0x39e0b0(0x1e7)]||0x1)*0x3c*0x3c*0x3e8;_0x1e9851>_0x46b1b8&&(_0x3c9af0[_0x39e0b0(0x239)]['status']=_0x39e0b0(0x3d6),_0x3e3b3f(_0x3c9af0['id']));}else{if(_0x3c9af0[_0x39e0b0(0x239)]?.[_0x39e0b0(0x27d)]==='friend'&&_0x3c9af0['id']!==_0x19ddb8[_0x39e0b0(0x859)]){if(_0x3c9af0[_0x39e0b0(0x450)][_0x39e0b0(0x106e)]===![]){console[_0x39e0b0(0xe4d)](_0x39e0b0(0x133f)+_0x3c9af0[_0x39e0b0(0x1561)]+'\x22\x20的独立后台活动开关已关闭，本次跳过。');return;}Math[_0x39e0b0(0xdcd)]()<0.2&&(console[_0x39e0b0(0xe4d)]('角色\x20\x22'+_0x3c9af0['name']+_0x39e0b0(0xcfc)),_0x265b86(_0x3c9af0['id']));}}});const _0x3ee23a=Object[_0x345c0a(0xea1)](_0x19ddb8[_0x345c0a(0xb04)])[_0x345c0a(0x1195)](_0x8bb995=>_0x8bb995[_0x345c0a(0x136b)]);_0x3ee23a[_0x345c0a(0x15c1)](_0x1b831f=>{const _0x1dfc15=_0x345c0a;if(_0x1b831f[_0x1dfc15(0x450)]['enableBackgroundActivity']===![]){console[_0x1dfc15(0xe4d)](_0x1dfc15(0x1310)+_0x1b831f['name']+_0x1dfc15(0x263));return;}_0x1b831f['id']!==_0x19ddb8[_0x1dfc15(0x859)]&&Math[_0x1dfc15(0xdcd)]()<0.1&&(console[_0x1dfc15(0xe4d)](_0x1dfc15(0x1310)+_0x1b831f[_0x1dfc15(0x1561)]+'\x22\x20被唤醒，准备独立行动...'),_0x36309f(_0x1b831f['id']));});try{const _0x3ff8af=await _0x512070[_0x345c0a(0x5b7)][_0x345c0a(0x591)]();if(_0x3ff8af['length']===0x0)return;const _0x2ad62e=await _0x512070['qzonePosts'][_0x345c0a(0x1404)](_0x345c0a(0xd73))['reverse']()[_0x345c0a(0x10d1)](0xa)[_0x345c0a(0x591)]();for(const _0x197adc of _0x3ff8af){if(_0x197adc[_0x345c0a(0x106e)]===![])continue;const _0x2489f8=_0x197adc[_0x345c0a(0x605)]||0xf;if(_0x197adc['lastActionTimestamp']){const _0x24505f=(Date['now']()-_0x197adc['lastActionTimestamp'])/(0x3e8*0x3c);if(_0x24505f<_0x2489f8)continue;}if(Math[_0x345c0a(0xdcd)]()>0.3)continue;const _0x38779b=[];for(const _0x386bc9 of _0x2ad62e){if(_0x386bc9[_0x345c0a(0x82c)]===_0x345c0a(0x136f)+_0x197adc['id'])continue;const _0x6f5365=_0x386bc9[_0x345c0a(0xc79)]?.['some'](_0x58d4bf=>_0x58d4bf['replyTo']===_0x197adc['name']),_0x275157=_0x386bc9[_0x345c0a(0xc79)]?.[_0x345c0a(0x457)](-0x1)[0x0]?.[_0x345c0a(0x1200)];if(_0x275157===_0x197adc[_0x345c0a(0x1561)])continue;let _0x13a9f6=![];if(_0x386bc9[_0x345c0a(0x82c)]===_0x345c0a(0x20d)||_0x386bc9['authorId'][_0x345c0a(0x608)](_0x345c0a(0x97a)))_0x197adc[_0x345c0a(0xa3a)]['includes'](_0x386bc9[_0x345c0a(0x82c)])&&(_0x13a9f6=!![]);else{if(_0x386bc9[_0x345c0a(0x82c)][_0x345c0a(0x608)](_0x345c0a(0x136f))){const _0x5d4cf6=parseInt(_0x386bc9[_0x345c0a(0x82c)]['replace'](_0x345c0a(0x136f),'')),_0x295104=await _0x512070['npcs'][_0x345c0a(0x14ee)](_0x5d4cf6);if(_0x295104){const _0x121686=_0x197adc[_0x345c0a(0x1005)],_0x5c66e6=_0x295104[_0x345c0a(0x1005)];_0x121686&&_0x5c66e6&&_0x121686===_0x5c66e6&&(_0x13a9f6=!![]);}}}(_0x13a9f6||_0x6f5365)&&_0x38779b[_0x345c0a(0x1c4)](_0x386bc9);}if(_0x38779b['length']>0x0||Math[_0x345c0a(0xdcd)]()<0.2){console[_0x345c0a(0xe4d)]('NPC\x20\x22'+_0x197adc[_0x345c0a(0x1561)]+_0x345c0a(0x611));const _0x11d1db=await _0xb6dec1(_0x197adc,_0x38779b);if(_0x11d1db&&_0x11d1db[_0x345c0a(0x106b)]>0x0){for(const _0x490f9c of _0x11d1db){if(_0x490f9c[_0x345c0a(0x1508)]===_0x345c0a(0x8ad)){const _0x511287=await _0x512070[_0x345c0a(0x10e5)][_0x345c0a(0x14ee)](_0x490f9c['postId']);if(_0x511287){if(!_0x511287[_0x345c0a(0xc79)])_0x511287[_0x345c0a(0xc79)]=[];_0x511287[_0x345c0a(0xc79)]['push']({'commenterName':_0x197adc[_0x345c0a(0x1561)],'text':_0x490f9c['commentText'],'replyTo':_0x490f9c['replyTo']||null,'timestamp':Date[_0x345c0a(0x64b)]()+Math[_0x345c0a(0xdcd)]()}),await _0x512070[_0x345c0a(0x10e5)]['update'](_0x490f9c['postId'],{'comments':_0x511287['comments']}),_0x28172c(_0x27ed94+0x1);}}else{if(_0x490f9c[_0x345c0a(0x1508)]===_0x345c0a(0x120f)){const _0x40ee14={'type':_0x490f9c['postType']||_0x345c0a(0x23d),'content':_0x490f9c[_0x345c0a(0x4e3)],'timestamp':Date[_0x345c0a(0x64b)](),'authorId':_0x345c0a(0x136f)+_0x197adc['id'],'authorOriginalName':_0x197adc[_0x345c0a(0x1561)],'visibleTo':_0x197adc[_0x345c0a(0xa3a)],'likes':[],'comments':[],'isDeleted':![]};await _0x512070[_0x345c0a(0x10e5)][_0x345c0a(0xe05)](_0x40ee14),console[_0x345c0a(0xe4d)](_0x345c0a(0x5c8)+_0x197adc[_0x345c0a(0x1561)]+_0x345c0a(0x15df)),_0x28172c(_0x27ed94+0x1);}}}await _0x512070['npcs'][_0x345c0a(0xe33)](_0x197adc['id'],{'lastActionTimestamp':Date['now']()}),document[_0x345c0a(0x9a3)](_0x345c0a(0x659))[_0x345c0a(0x4d8)][_0x345c0a(0x1222)](_0x345c0a(0xe9f))&&await _0x49acff();}}}}catch(_0x27db3d){console['error'](_0x345c0a(0xb7e),_0x27db3d);}}async function _0xb6dec1(_0x4d1cf,_0x473be1){const _0x1bccc5=_0x48bc6d,{proxyUrl:_0x46d3c0,apiKey:_0x3c5005,model:_0x5dee6d}=_0x19ddb8[_0x1bccc5(0xd22)];if(!_0x46d3c0||!_0x3c5005||!_0x5dee6d)return console[_0x1bccc5(0x3b7)]('NPC行动失败：API未配置。'),null;let _0x3dd06a='#\x20你的互动对象\x20(用户和其他角色)\x0a';const _0x29e603=_0x19ddb8['qzoneSettings']['nickname']||'我',_0x3df010=_0x19ddb8[_0x1bccc5(0xb04)][Object[_0x1bccc5(0x2d0)](_0x19ddb8['chats'])[0x0]]?.[_0x1bccc5(0x450)]['myPersona']||_0x1bccc5(0x1318);_0x3dd06a+=_0x1bccc5(0x1e5)+_0x29e603+_0x1bccc5(0x437)+_0x3df010+'\x0a';_0x4d1cf['associatedWith']&&_0x4d1cf['associatedWith'][_0x1bccc5(0x106b)]>0x0&&_0x4d1cf[_0x1bccc5(0xa3a)]['forEach'](_0x24aa70=>{const _0x318e59=_0x1bccc5,_0x4d986b=_0x19ddb8[_0x318e59(0xb04)][_0x24aa70];_0x4d986b&&!_0x4d986b[_0x318e59(0x136b)]&&(_0x3dd06a+='-\x20**'+_0x4d986b[_0x318e59(0x1561)]+_0x318e59(0x1bd)+_0x4d986b[_0x318e59(0x339)]+_0x318e59(0x88c)+_0x4d986b[_0x318e59(0x450)][_0x318e59(0x1c3)]+'\x0a');});const _0x1f095a=(await Promise['all'](_0x473be1[_0x1bccc5(0xb0a)](async _0x286b34=>{const _0x302b33=_0x1bccc5;let _0x1dfe18=_0x302b33(0x1277);if(_0x286b34['authorId']===_0x302b33(0x20d))_0x1dfe18=_0x19ddb8[_0x302b33(0x9ce)][_0x302b33(0x246)]||'用户';else{if(_0x286b34[_0x302b33(0x82c)][_0x302b33(0x608)](_0x302b33(0x97a)))_0x1dfe18=_0x2e9dd1(_0x286b34[_0x302b33(0x820)]||_0x286b34[_0x302b33(0x82c)]);else{if(_0x286b34['authorId'][_0x302b33(0x608)](_0x302b33(0x136f))){const _0x32ba6d=parseInt(_0x286b34[_0x302b33(0x82c)][_0x302b33(0x1bb)](_0x302b33(0x136f),'')),_0x47d9d8=await _0x512070[_0x302b33(0x5b7)][_0x302b33(0x14ee)](_0x32ba6d);_0x47d9d8&&(_0x1dfe18=_0x47d9d8[_0x302b33(0x1561)]);}}}const _0x179e2c=(_0x286b34[_0x302b33(0xc79)]||[])[_0x302b33(0xb0a)](_0x26a7e0=>{const _0x29c3da=_0x302b33;if(typeof _0x26a7e0===_0x29c3da(0x12fe)&&_0x26a7e0[_0x29c3da(0x1200)]){const _0x7ffd19=_0x2e9dd1(_0x26a7e0[_0x29c3da(0x1200)]);return _0x29c3da(0x1e5)+_0x7ffd19+'**:\x20'+_0x26a7e0[_0x29c3da(0x13ca)];}return'-\x20'+_0x26a7e0;})[_0x302b33(0x3b9)]('\x0a');return _0x302b33(0x152e)+_0x286b34['id']+_0x302b33(0x924)+_0x1dfe18+_0x302b33(0x522)+(_0x286b34[_0x302b33(0x4e3)]||_0x286b34[_0x302b33(0x6b9)]||'')[_0x302b33(0x72e)](0x0,0x96)+_0x302b33(0x4a4)+(_0x179e2c||'(暂无评论)')+'\x0a---\x0a';})))[_0x1bccc5(0x3b9)]('\x0a'),_0x1bc8ba=_0x1bccc5(0x136f)+_0x4d1cf['id'],_0x2c7fbc=Date[_0x1bccc5(0x64b)]()-0xc*0x3c*0x3c*0x3e8,_0x206ed9=await _0x512070[_0x1bccc5(0x10e5)][_0x1bccc5(0x1201)]('authorId')[_0x1bccc5(0x5df)](_0x1bc8ba)[_0x1bccc5(0x5db)](_0x5f41c9=>_0x5f41c9[_0x1bccc5(0xd73)]>_0x2c7fbc)['toArray']();let _0x4bd753='';_0x206ed9[_0x1bccc5(0x106b)]>0x0&&(_0x4bd753=_0x1bccc5(0x12ba));const _0x50a257=_0x1bccc5(0x148a)+_0x4d1cf[_0x1bccc5(0x1561)]+_0x1bccc5(0x154f)+_0x4bd753+_0x1bccc5(0x742)+_0x4d1cf[_0x1bccc5(0x1561)]+_0x1bccc5(0x8cd)+_0x4d1cf[_0x1bccc5(0xcd4)]+'\x0a\x0a'+_0x3dd06a+'\x20\x0a\x0a#\x20待处理的帖子列表\x20(如果你选择评论)\x0a'+_0x1f095a+_0x1bccc5(0x911);try{const _0x4a5561=[{'role':_0x1bccc5(0x20d),'content':'请根据你的设定，开始你的行动。'}];let _0x148cac=_0x46d3c0['includes']('generativelanguage'),_0x506115=_0x366263(_0x5dee6d,_0x3c5005,_0x50a257,_0x4a5561);const _0x269a89=_0x148cac?await fetch(_0x506115[_0x1bccc5(0x121f)],_0x506115['data']):await fetch(_0x46d3c0+'/v1/chat/completions',{'method':_0x1bccc5(0x12db),'headers':{'Content-Type':_0x1bccc5(0xb1f),'Authorization':_0x1bccc5(0x1265)+_0x3c5005},'body':JSON[_0x1bccc5(0xe1e)]({'model':_0x5dee6d,'messages':[{'role':'system','content':_0x50a257},..._0x4a5561],'temperature':_0x19ddb8[_0x1bccc5(0x4c8)][_0x1bccc5(0x4a2)]||0.9})});if(!_0x269a89['ok'])throw new Error(_0x1bccc5(0x786)+_0x269a89[_0x1bccc5(0x140e)]);const _0x42e1b6=await _0x269a89[_0x1bccc5(0xa5d)](),_0xa9b5e7=getGeminiResponseText(_0x42e1b6),_0x5e2a9f=_0xa9b5e7['match'](/(\[[\s\S]*\])/);if(!_0x5e2a9f)throw new Error(_0x1bccc5(0xb86));return JSON['parse'](_0x5e2a9f[0x0]);}catch(_0x5447a0){return console['error']('为NPC\x20\x22'+_0x4d1cf[_0x1bccc5(0x1561)]+_0x1bccc5(0x148d),_0x5447a0),null;}}async function _0x265b86(_0x3d3e8c){const _0x8cad4f=_0x48bc6d,_0x130afd=_0x19ddb8[_0x8cad4f(0xb04)][_0x3d3e8c];if(!_0x130afd)return;const _0x406a02=_0x130afd[_0x8cad4f(0x450)][_0x8cad4f(0x605)]||0xa;if(_0x130afd[_0x8cad4f(0x4bf)]){const _0x3b3255=(Date[_0x8cad4f(0x64b)]()-_0x130afd[_0x8cad4f(0x4bf)])/(0x3e8*0x3c);if(_0x3b3255<_0x406a02){console['log'](_0x8cad4f(0x133f)+_0x130afd[_0x8cad4f(0x1561)]+_0x8cad4f(0x8ce)+Math[_0x8cad4f(0xb9d)](_0x406a02-_0x3b3255)+'\x20分钟)，本次独立行动跳过。');return;}}_0x4fad07(_0x3d3e8c,!![]);const {proxyUrl:_0x8c4207,apiKey:_0x311867,model:_0x5642b4}=_0x19ddb8['apiConfig'];if(!_0x8c4207||!_0x311867||!_0x5642b4)return;const _0x1822d9=_0x19ddb8[_0x8cad4f(0x9ce)]['nickname'],_0x5be484=new Date(),_0x5db1e4=_0x130afd[_0x8cad4f(0x450)][_0x8cad4f(0x6fd)]||_0x8cad4f(0xb4b),_0x5308ee=_0x5be484[_0x8cad4f(0x12cf)]('zh-CN',{'timeZone':_0x5db1e4,'dateStyle':_0x8cad4f(0x38f),'timeStyle':_0x8cad4f(0xa1b)}),_0x378fcd=new Date(_0x5be484[_0x8cad4f(0x12cf)](_0x8cad4f(0xf06),{'timeZone':_0x5db1e4}));let _0x24f029='',_0x143af3='',_0x26e0e0,_0x25bfad=![];const _0x5589a1=_0x130afd[_0x8cad4f(0x450)]['maxMemory']||0xa,_0x3cd176=_0x130afd[_0x8cad4f(0x1f0)][_0x8cad4f(0x1195)](_0x39af0a=>!_0x39af0a[_0x8cad4f(0x136e)])[_0x8cad4f(0x457)](-_0x5589a1),_0x4fbd9b=_0x130afd[_0x8cad4f(0x1f0)][_0x8cad4f(0x1195)](_0x36da1e=>!_0x36da1e[_0x8cad4f(0x136e)])[_0x8cad4f(0x457)](-0x1)[0x0];if(_0x130afd[_0x8cad4f(0x450)][_0x8cad4f(0x2de)]){_0x24f029=_0x7e10b(_0x378fcd);const _0x1572e0=_0x130afd[_0x8cad4f(0x1f0)][_0x8cad4f(0x1195)](_0xe6eacf=>!_0xe6eacf[_0x8cad4f(0x136e)])[_0x8cad4f(0x457)](-0x1)[0x0],_0x4a3bad=new Date();let _0x5dba72='',_0x19fc2e=![];if(_0x1572e0){const _0x38cd3f=new Date(_0x1572e0['timestamp']),_0x5ac21a=(_0x4a3bad-_0x38cd3f)/(0x3e8*0x3c*0x3c);if(_0x5ac21a>0x2){_0x19fc2e=!![];const _0x1d4a1c=Math['floor'](_0x5ac21a/0x18);_0x5dba72=_0x8cad4f(0x9fd)+(_0x1d4a1c>0x0?_0x1d4a1c+'天':Math[_0x8cad4f(0xd95)](_0x5ac21a)+'小时')+_0x8cad4f(0x7bd);}else{const _0xdc74c8=Math[_0x8cad4f(0xd95)](_0x5ac21a*0x3c);if(_0xdc74c8<0x5)_0x5dba72=_0x8cad4f(0xe4e);else _0xdc74c8<0x3c?_0x5dba72='你们在'+_0xdc74c8+_0x8cad4f(0xe88):_0x5dba72='你们在'+Math[_0x8cad4f(0xd95)](_0x5ac21a)+_0x8cad4f(0x128a);}}else _0x19fc2e=!![],_0x5dba72=_0x8cad4f(0x1186);let _0x266528=_0x8cad4f(0xa1c);_0x3cd176[_0x8cad4f(0x106b)]>0x0&&(_0x266528='这是你们最近的对话：\x0a'+_0x3cd176[_0x8cad4f(0xb0a)](_0x37666d=>{const _0x118c7e=_0x8cad4f,_0x2534e1=_0x37666d[_0x118c7e(0x11c1)]===_0x118c7e(0x20d)?_0x1822d9:_0x130afd['name'];return _0x2534e1+':\x20'+String(_0x37666d['content'])[_0x118c7e(0x72e)](0x0,0x32)+_0x118c7e(0x4a5);})[_0x8cad4f(0x3b9)]('\x0a')),_0x19fc2e?_0x26e0e0=_0x8cad4f(0x47a)+_0x5dba72+_0x8cad4f(0x49d)+_0x5308ee+_0x8cad4f(0x385)+_0x266528:_0x26e0e0=''+_0x266528;}else _0x3cd176[_0x8cad4f(0x106b)]>0x0?_0x26e0e0=_0x8cad4f(0x9bf)+_0x3cd176['map'](_0x4aeddf=>{const _0x4a6d65=_0x8cad4f,_0x5a515e=_0x4aeddf[_0x4a6d65(0x11c1)]===_0x4a6d65(0x20d)?_0x1822d9:_0x130afd['name'];return _0x5a515e+':\x20'+String(_0x4aeddf[_0x4a6d65(0x4e3)])[_0x4a6d65(0x72e)](0x0,0x32)+_0x4a6d65(0x4a5);})['join']('\x0a'):_0x26e0e0=_0x8cad4f(0xa1c);const _0x5b4ba9=await _0x512070['qzonePosts'][_0x8cad4f(0x1404)](_0x8cad4f(0xd73))[_0x8cad4f(0x333)]()[_0x8cad4f(0x10d1)](0x5)['toArray'](),_0x1eaf48=_0x35b975(_0x5b4ba9,_0x130afd),_0x2ee489=_0x1eaf48['filter'](_0x54596b=>_0x54596b['authorId']===_0x3d3e8c);let _0xe90101='';_0x2ee489[_0x8cad4f(0x106b)]>0x0&&(_0xe90101=_0x8cad4f(0x89c),_0x2ee489[_0x8cad4f(0x15c1)](_0x400164=>{const _0x420364=_0x8cad4f;let _0x3992b6=(_0x400164[_0x420364(0x6b9)]||_0x400164['content']||_0x420364(0xf51))['substring'](0x0,0x28)+'...';_0xe90101+=_0x420364(0x1549)+_0x400164['id']+')\x20内容:\x20\x22'+_0x3992b6+'\x22\x0a';}));let _0x474707=[];_0x1eaf48[_0x8cad4f(0x106b)]>0x0&&(_0x474707=_0x1eaf48[_0x8cad4f(0xb0a)](_0x1af0ed=>{const _0x58aa2f=_0x8cad4f;let _0x4cbc70;if(_0x1af0ed[_0x58aa2f(0x1508)]==='text_image')_0x4cbc70=('[一张图片，其隐藏文字为：“'+_0x1af0ed[_0x58aa2f(0x14bb)]+_0x58aa2f(0xfa6)+(_0x1af0ed[_0x58aa2f(0x6b9)]||''))[_0x58aa2f(0x72e)](0x0,0x32)+_0x58aa2f(0x4a5);else _0x1af0ed['type']===_0x58aa2f(0x1016)?_0x4cbc70=(_0x58aa2f(0xf2f)+_0x1af0ed[_0x58aa2f(0xbea)]+_0x58aa2f(0xfa6)+(_0x1af0ed['publicText']||''))['substring'](0x0,0x32)+_0x58aa2f(0x4a5):_0x4cbc70=String(_0x1af0ed[_0x58aa2f(0x6b9)]||_0x1af0ed[_0x58aa2f(0x4e3)]||_0x58aa2f(0xf51))[_0x58aa2f(0x72e)](0x0,0x32)+_0x58aa2f(0x4a5);return _0x58aa2f(0x6ce)+_0x4cbc70+'\x22';}));let _0x59bdb7='';_0x474707['length']>0x0&&(_0x59bdb7=_0x8cad4f(0x5ce)+_0x474707[_0x8cad4f(0x3b9)]('\x0a')+_0x8cad4f(0x1560));let _0x225350='';if(_0x130afd[_0x8cad4f(0x450)][_0x8cad4f(0x9c4)]&&_0x130afd[_0x8cad4f(0x450)][_0x8cad4f(0x9c4)][_0x8cad4f(0x106b)]>0x0){const _0x277bc1=_0x130afd[_0x8cad4f(0x450)][_0x8cad4f(0x9c4)]['map'](_0x1bcec2=>{const _0x595a53=_0x8cad4f,_0x4ee077=_0x19ddb8[_0x595a53(0x8e4)][_0x595a53(0xd62)](_0xae2bc0=>_0xae2bc0['id']===_0x1bcec2);if(!_0x4ee077||!Array[_0x595a53(0xb9b)](_0x4ee077[_0x595a53(0x4e3)]))return'';const _0x302efa=_0x4ee077[_0x595a53(0x4e3)][_0x595a53(0x1195)](_0xe57807=>_0xe57807[_0x595a53(0x15cd)]!==![])[_0x595a53(0xb0a)](_0x546304=>{const _0x1c4312=_0x595a53;let _0x1b2a11=_0x1c4312(0xc4e)+(_0x546304['comment']||_0x1c4312(0xbcc))+'\x0a';return _0x546304[_0x1c4312(0x2d0)]['length']>0x0&&(_0x1b2a11+=_0x1c4312(0x1092)+_0x546304['keys'][_0x1c4312(0x3b9)](',\x20')+'\x0a'),_0x1b2a11+=_0x1c4312(0x14b5)+_0x546304[_0x1c4312(0x4e3)],_0x1b2a11;})[_0x595a53(0x3b9)]('');return _0x302efa?_0x595a53(0xe9b)+_0x4ee077[_0x595a53(0x1561)]+'\x0a'+_0x302efa:'';})[_0x8cad4f(0x1195)](Boolean)[_0x8cad4f(0x3b9)]('');_0x277bc1&&(_0x225350=_0x8cad4f(0x102c)+_0x277bc1+_0x8cad4f(0x951));}let _0x3a6f4a='';const _0x3c4c54=_0x130afd[_0x8cad4f(0x450)][_0x8cad4f(0xb09)]||0xa;if(_0x130afd[_0x8cad4f(0x450)][_0x8cad4f(0x120e)]&&_0x130afd[_0x8cad4f(0x450)][_0x8cad4f(0x120e)]['length']>0x0){const _0x2c2545=_0x130afd['settings'][_0x8cad4f(0x120e)][_0x8cad4f(0xb0a)](_0x3bdb5b=>{const _0x53a4d1=_0x8cad4f,_0x108e6e=_0x19ddb8[_0x53a4d1(0xb04)][_0x3bdb5b];if(!_0x108e6e)return null;const _0x66347c=_0x108e6e[_0x53a4d1(0x1f0)][_0x53a4d1(0x457)](-0x1)[0x0];return{'chat':_0x108e6e,'latestTimestamp':_0x66347c?_0x66347c[_0x53a4d1(0xd73)]:0x0};})[_0x8cad4f(0x1195)](Boolean);_0x2c2545['sort']((_0x44d847,_0x5cb0ff)=>_0x5cb0ff['latestTimestamp']-_0x44d847[_0x8cad4f(0x1a4)]),_0x3a6f4a+='\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a';for(const _0x4abd70 of _0x2c2545){const _0x556a64=_0x4abd70[_0x8cad4f(0xd43)],_0x22f5f7=_0x556a64[_0x8cad4f(0x136b)]?'[群聊]':_0x8cad4f(0x939),_0x45480a=_0x4abd70[_0x8cad4f(0x1a4)]>0x0?_0x8cad4f(0x1156)+_0x5d6abc(_0x4abd70[_0x8cad4f(0x1a4)])+')':'';_0x3a6f4a+='\x0a##\x20---\x20来自'+_0x22f5f7+'“'+_0x556a64[_0x8cad4f(0x1561)]+'”的参考记忆'+_0x45480a+_0x8cad4f(0x1419);const _0x23db56=_0x556a64[_0x8cad4f(0x1f0)][_0x8cad4f(0x457)](-_0x3c4c54),_0x82d03e=_0x23db56['filter'](_0x4fb9a7=>!String(_0x4fb9a7[_0x8cad4f(0x4e3)])[_0x8cad4f(0x478)](_0x8cad4f(0x2aa)));_0x82d03e['length']>0x0?_0x82d03e[_0x8cad4f(0x15c1)](_0x2e1972=>{const _0x14c254=_0x8cad4f,_0xe837f3=_0x2e1972[_0x14c254(0x11c1)]===_0x14c254(0x20d)?_0x556a64['settings'][_0x14c254(0x1555)]||'我':_0x2e1972['senderName']||_0x556a64['name'];let _0x58e70c=String(_0x2e1972[_0x14c254(0x4e3)]);if(_0x2e1972[_0x14c254(0x1508)]===_0x14c254(0x1c1)||_0x2e1972[_0x14c254(0x1508)]===_0x14c254(0x9ee))_0x58e70c='[发送了一张图片，描述为：'+_0x2e1972[_0x14c254(0x4e3)]+']';else _0x2e1972[_0x14c254(0x1508)]===_0x14c254(0x1207)&&(_0x58e70c=_0x14c254(0x10bd)+_0x2e1972[_0x14c254(0x4e3)]+']');_0x3a6f4a+=_0xe837f3+':\x20'+_0x58e70c+'\x0a';}):_0x3a6f4a+=_0x8cad4f(0xc40);}}let _0x3c1726='';if(_0x1eaf48[_0x8cad4f(0x106b)]>0x0){let _0x13b6ad='\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a';for(const _0x3858bd of _0x1eaf48){let _0x470f1c;if(_0x3858bd[_0x8cad4f(0x82c)]===_0x8cad4f(0x20d))_0x470f1c=_0x19ddb8[_0x8cad4f(0x9ce)][_0x8cad4f(0x246)];else{if(String(_0x3858bd[_0x8cad4f(0x82c)])[_0x8cad4f(0x608)](_0x8cad4f(0x136f)))_0x470f1c=_0x3858bd[_0x8cad4f(0x820)]||'一位神秘的NPC';else{const _0x19e5e1=_0x19ddb8[_0x8cad4f(0xb04)][_0x3858bd['authorId']];_0x470f1c=_0x19e5e1?_0x19e5e1['name']:_0x8cad4f(0x18b);}}if(_0x3858bd['authorId']===_0x3d3e8c)_0x470f1c+=_0x8cad4f(0x15de);let _0x3121f2;if(_0x3858bd['type']===_0x8cad4f(0x5ee)){const _0x583a18=_0x3858bd[_0x8cad4f(0x3eb)]?_0x8cad4f(0xd9a)+_0x3858bd['repostComment']+'\x22':'';let _0x23186e=_0x8cad4f(0x423);const _0xb81ae3=_0x3858bd[_0x8cad4f(0x327)]['authorId'];if(_0xb81ae3===_0x8cad4f(0x20d))_0x23186e=_0x19ddb8[_0x8cad4f(0x9ce)][_0x8cad4f(0x246)];else _0x19ddb8[_0x8cad4f(0xb04)][_0xb81ae3]&&(_0x23186e=_0x19ddb8[_0x8cad4f(0xb04)][_0xb81ae3]['name']);let _0x30f19a;const _0x212ea3=_0x3858bd[_0x8cad4f(0x327)];if(_0x212ea3[_0x8cad4f(0x1508)]==='text_image')_0x30f19a=_0x8cad4f(0x65a)+(_0x212ea3[_0x8cad4f(0x6b9)]||'')+_0x8cad4f(0x8b2)+(_0x212ea3['hiddenContent']||'')[_0x8cad4f(0x72e)](0x0,0x28)+_0x8cad4f(0x6ca);else _0x212ea3[_0x8cad4f(0x1508)]===_0x8cad4f(0x1016)?_0x30f19a=_0x8cad4f(0xe48)+(_0x212ea3[_0x8cad4f(0x6b9)]||'')+'\x20(图片描述:\x20\x22'+(_0x212ea3['imageDescription']||'')[_0x8cad4f(0x72e)](0x0,0x28)+_0x8cad4f(0x6ca):_0x30f19a='\x22'+(_0x212ea3[_0x8cad4f(0x4e3)]||'')[_0x8cad4f(0x72e)](0x0,0x28)+_0x8cad4f(0x76a);_0x3121f2=_0x8cad4f(0xa3c)+_0x23186e+_0x8cad4f(0xf86)+_0x583a18+_0x8cad4f(0x9d1)+_0x30f19a+'】';}else{if(_0x3858bd[_0x8cad4f(0x1508)]===_0x8cad4f(0x1281))_0x3121f2=(_0x8cad4f(0x962)+_0x3858bd[_0x8cad4f(0x14bb)]+_0x8cad4f(0x3fc)+(_0x3858bd[_0x8cad4f(0x6b9)]||''))[_0x8cad4f(0x72e)](0x0,0x32)+_0x8cad4f(0x4a5);else{if(_0x3858bd[_0x8cad4f(0x1508)]===_0x8cad4f(0x1016))_0x3121f2=('[一张图片，描述为：\x22'+_0x3858bd['imageDescription']+_0x8cad4f(0x3fc)+(_0x3858bd[_0x8cad4f(0x6b9)]||''))[_0x8cad4f(0x72e)](0x0,0x32)+_0x8cad4f(0x4a5);else{if(_0x3858bd[_0x8cad4f(0x1508)]===_0x8cad4f(0x1300)&&_0x3858bd[_0x8cad4f(0x3a1)]){const _0x1ffaca=Array[_0x8cad4f(0xb9b)](_0x3858bd[_0x8cad4f(0x3a1)])?_0x3858bd['prompt']:[_0x3858bd[_0x8cad4f(0x3a1)]];_0x3121f2=(_0x3858bd['publicText']||'')+(_0x8cad4f(0x16f)+_0x1ffaca[_0x8cad4f(0x106b)]+_0x8cad4f(0x360)+_0x1ffaca[_0x8cad4f(0x3b9)](',\x20')+']');}else _0x3121f2=String(_0x3858bd[_0x8cad4f(0x6b9)]||_0x3858bd[_0x8cad4f(0x4e3)]||'一条动态')['substring'](0x0,0x32)+_0x8cad4f(0x4a5);}}}_0x13b6ad+=_0x8cad4f(0x1549)+_0x3858bd['id']+_0x8cad4f(0x11af)+_0x470f1c+_0x8cad4f(0x45e)+_0x3121f2+'\x22\x0a';if(_0x3858bd[_0x8cad4f(0xc79)]&&_0x3858bd[_0x8cad4f(0xc79)][_0x8cad4f(0x106b)]>0x0)for(const _0x3dbd79 of _0x3858bd['comments']){if(typeof _0x3dbd79===_0x8cad4f(0x12fe)&&_0x3dbd79[_0x8cad4f(0x1200)]){const _0x34aa40=_0x2e9dd1(_0x3dbd79[_0x8cad4f(0x1200)]);let _0x1c86ad=_0x3dbd79[_0x8cad4f(0x7da)]?'[表情:\x20\x27'+_0x3dbd79['meaning']+'\x27]':_0x3dbd79[_0x8cad4f(0x13ca)];_0x3dbd79[_0x8cad4f(0x1200)]===_0x130afd[_0x8cad4f(0x339)]?_0x13b6ad+=_0x8cad4f(0x1304)+_0x1c86ad+'\x0a':_0x13b6ad+='\x20\x20-\x20评论:\x20'+_0x34aa40+_0x8cad4f(0x1bd)+_0x3dbd79['commenterName']+'):\x20'+_0x1c86ad+'\x0a';}}}_0x3c1726=_0x13b6ad;}const _0x31b438=_0x8cad4f(0x1259)+(_0x130afd[_0x8cad4f(0x744)]&&_0x130afd['longTermMemory'][_0x8cad4f(0x106b)]>0x0?_0x130afd[_0x8cad4f(0x744)][_0x8cad4f(0xb0a)](_0x11912a=>_0x8cad4f(0x2ee)+_0x5d6abc(_0x11912a['timestamp'])+')\x20'+_0x11912a['content'])[_0x8cad4f(0x3b9)]('\x0a'):_0x8cad4f(0xc55)),_0x1da375=_0x54310e(_0x130afd,0x3,_0x8cad4f(0xb41)),_0x392f11=_0x54310e(_0x130afd,0x6,_0x8cad4f(0xb41)),_0x252ee7=_0x54310e(_0x130afd,0x9,'hours'),_0x221142=_0x54310e(_0x130afd,0x1,_0x8cad4f(0x113c)),_0x5425d6=_0x54310e(_0x130afd,0x3,'days'),_0x60e91b=_0x54310e(_0x130afd,0x7,_0x8cad4f(0x113c));let _0x5be9d8='';if(_0x1da375||_0x392f11||_0x252ee7||_0x221142||_0x5425d6||_0x60e91b){_0x5be9d8+=_0x8cad4f(0x805);if(_0x1da375)_0x5be9d8+=_0x1da375;if(_0x392f11)_0x5be9d8+=_0x392f11;if(_0x252ee7)_0x5be9d8+=_0x252ee7;if(_0x1da375||_0x392f11||_0x252ee7)_0x5be9d8+='\x0a';if(_0x221142)_0x5be9d8+=_0x221142;if(_0x5425d6)_0x5be9d8+=_0x5425d6;if(_0x60e91b)_0x5be9d8+=_0x60e91b;}const _0x4af468=_0xc9a7e4(_0x130afd),_0x33d51f='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在扮演一个名为\x22'+_0x130afd[_0x8cad4f(0x1561)]+_0x8cad4f(0x10e3)+_0x130afd[_0x8cad4f(0x339)]+_0x8cad4f(0xc6d)+_0x1822d9+_0x8cad4f(0x1374)+(_0x130afd[_0x8cad4f(0x450)]['enableTimePerception']?_0x8cad4f(0xa51)+_0x5308ee+'\x20('+_0x24f029+_0x8cad4f(0x7ba)+_0x143af3+'\x0a'+(_0x25bfad?_0x8cad4f(0x165):''):'')+_0x8cad4f(0xd82)+(_0x130afd['lastActionType']||'无')+_0x8cad4f(0x705)+_0x59bdb7+_0x8cad4f(0x1560)+_0xe90101+_0x8cad4f(0x1215)+_0x130afd['settings'][_0x8cad4f(0x1c3)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x225350+_0x8cad4f(0x1560)+(_0x130afd[_0x8cad4f(0x744)]&&_0x130afd[_0x8cad4f(0x744)][_0x8cad4f(0x106b)]>0x0?_0x130afd['longTermMemory']['map'](_0x10013d=>'-\x20(记录于\x20'+_0x5d6abc(_0x10013d[_0x8cad4f(0xd73)])+')\x20'+_0x10013d[_0x8cad4f(0x4e3)])[_0x8cad4f(0x3b9)]('\x0a'):'无')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5be9d8+'\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3a6f4a+_0x8cad4f(0x1560)+(_0x130afd['settings'][_0x8cad4f(0x2de)]?'-\x20\x20\x20**当前时间**:'+_0x5308ee+'\x20('+_0x24f029+')':'')+_0x8cad4f(0x1560)+(_0x130afd['settings'][_0x8cad4f(0x2de)]?_0x8cad4f(0x35a)+_0x143af3:'')+_0x8cad4f(0x1ae)+_0x4af468+_0x8cad4f(0xec3)+_0x26e0e0+_0x8cad4f(0x1560)+_0x3c1726+'\x0a',_0x1297e8=[{'role':_0x8cad4f(0xe10),'content':_0x33d51f},..._0x3cd176[_0x8cad4f(0xb0a)](_0x2d5cac=>{const _0x50c1b6=_0x8cad4f,_0x492ee3=_0x2d5cac[_0x50c1b6(0x11c1)]===_0x50c1b6(0x20d)?_0x1822d9:_0x130afd[_0x50c1b6(0x1561)];let _0x587b54=_0x2d5cac[_0x50c1b6(0x4e3)];return typeof _0x587b54!==_0x50c1b6(0x86c)&&(_0x587b54=JSON[_0x50c1b6(0xe1e)](_0x587b54)),{'role':_0x2d5cac['role'],'content':_0x492ee3+':\x20'+_0x587b54};})];try{const _0xeca7e7=[{'role':_0x8cad4f(0x20d),'content':_0x33d51f+_0x8cad4f(0xb08)+_0x3c1726}];console[_0x8cad4f(0xe4d)](_0x8cad4f(0xd31)+_0x130afd[_0x8cad4f(0x1561)]+'\x22)');let _0x48fcd9=_0x8c4207===GEMINI_API_URL,_0x56447b=_0x366263(_0x5642b4,_0x311867,_0x33d51f,_0xeca7e7);const _0x2ae3c4=_0x48fcd9?await fetch(_0x56447b[_0x8cad4f(0x121f)],_0x56447b[_0x8cad4f(0x38c)]):await fetch(_0x8c4207+_0x8cad4f(0x501),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x8cad4f(0x1265)+_0x311867},'body':JSON['stringify']({'model':_0x5642b4,'messages':_0xeca7e7,'temperature':_0x19ddb8[_0x8cad4f(0x4c8)][_0x8cad4f(0x4a2)]||0.9})});if(!_0x2ae3c4['ok']){const _0x40382d=await _0x2ae3c4[_0x8cad4f(0xa5d)]();throw new Error(_0x8cad4f(0xf05)+_0x2ae3c4['status']+'\x20-\x20'+JSON[_0x8cad4f(0xe1e)](_0x40382d));}const _0x557508=await _0x2ae3c4['json'](),_0x17ce81=_0x48fcd9?getGeminiResponseText(_0x557508):_0x557508[_0x8cad4f(0x21f)][0x0]['message'][_0x8cad4f(0x4e3)];if(!_0x17ce81||_0x17ce81['trim']()===''){console[_0x8cad4f(0x651)](_0x8cad4f(0x11c4)+_0x130afd['name']+_0x8cad4f(0x157c));return;}const _0x26ac2b=_0x189ab1(_0x17ce81);if(!_0x26ac2b||_0x26ac2b['length']===0x0){console[_0x8cad4f(0x651)](_0x8cad4f(0x2e1)+_0x130afd[_0x8cad4f(0x1561)]+_0x8cad4f(0x55c),_0x17ce81);return;}let _0x5e9d6c=Date[_0x8cad4f(0x64b)](),_0x4da478=![];const _0x5ddc03=[];for(const _0x1b34a1 of _0x26ac2b){const _0x1690ce=String(_0x1b34a1['content']||''),_0x13b990=_0x1690ce[_0x8cad4f(0x13f9)]()['startsWith']('<')&&_0x1690ce['trim']()['endsWith']('>');if(_0x1b34a1[_0x8cad4f(0x1508)]===_0x8cad4f(0x13ca)&&!_0x13b990&&_0x1690ce[_0x8cad4f(0x478)]('\x0a')){const _0x57c83c=_0x1690ce['split'](/\n+/)[_0x8cad4f(0x1195)](_0x1351d6=>_0x1351d6[_0x8cad4f(0x13f9)]());_0x57c83c[_0x8cad4f(0x15c1)](_0x932d0=>{const _0x503e82=_0x8cad4f;_0x5ddc03[_0x503e82(0x1c4)]({..._0x1b34a1,'content':_0x932d0});});}else _0x5ddc03[_0x8cad4f(0x1c4)](_0x1b34a1);}for(const _0x324424 of _0x5ddc03){_0x130afd[_0x8cad4f(0x11e6)]=_0x324424[_0x8cad4f(0x1508)],_0x130afd[_0x8cad4f(0x4bf)]=_0x5e9d6c;let _0x215f32=null;const _0x3b4de6={'role':_0x8cad4f(0x115c),'senderName':_0x130afd[_0x8cad4f(0x339)],'timestamp':_0x5e9d6c++};let _0x472971=null;switch(_0x324424[_0x8cad4f(0x1508)]){case'qzone_delete_post':{const _0x1198df=parseInt(_0x324424[_0x8cad4f(0xb92)]),_0x29eb59=await _0x512070['qzonePosts'][_0x8cad4f(0x14ee)](_0x1198df);if(_0x29eb59&&_0x29eb59[_0x8cad4f(0x82c)]===_0x3d3e8c){await _0x512070['qzonePosts'][_0x8cad4f(0xe33)](_0x1198df,{'isDeleted':!![]});document[_0x8cad4f(0x9a3)](_0x8cad4f(0x659))['classList'][_0x8cad4f(0x1222)](_0x8cad4f(0xe9f))&&_0x49acff();const _0x2f9688={'role':'system','type':_0x8cad4f(0x2fb),'content':'['+_0x130afd['name']+_0x8cad4f(0xbae),'postId':_0x1198df,'timestamp':_0x5e9d6c++};_0x130afd['history'][_0x8cad4f(0x1c4)](_0x2f9688),isViewingThisChat?_0x1ef393(_0x2f9688,_0x130afd):(_0x130afd['unreadCount']=(_0x130afd[_0x8cad4f(0xe20)]||0x0)+0x1,_0x1c6d8a(_0x3d3e8c,'['+_0x130afd[_0x8cad4f(0x1561)]+'\x20删除了自己的一条动态]'),_0x4da478=!![]);}else console[_0x8cad4f(0x651)](_0x8cad4f(0xcac)+_0x130afd[_0x8cad4f(0x1561)]+_0x8cad4f(0xa3d)+_0x324424[_0x8cad4f(0xb92)]+')');continue;}case _0x8cad4f(0x13ca):_0x215f32={..._0x3b4de6,'content':_0x324424[_0x8cad4f(0x4e3)]};break;case'ai_image':_0x215f32={..._0x3b4de6,'type':_0x8cad4f(0x1c1),'content':_0x324424[_0x8cad4f(0x3ef)]};break;case _0x8cad4f(0xda8):if(_0x324424[_0x8cad4f(0x7da)]){const _0x1e925c=_0x19ddb8['userStickers'][_0x8cad4f(0xd62)](_0x1fbfa7=>_0x1fbfa7['name']===_0x324424[_0x8cad4f(0x7da)]);_0x1e925c?_0x215f32={..._0x3b4de6,'type':_0x8cad4f(0xda8),'content':_0x1e925c['url'],'meaning':_0x1e925c[_0x8cad4f(0x1561)]}:(console[_0x8cad4f(0x651)](_0x8cad4f(0x14d0)+_0x324424[_0x8cad4f(0x7da)]+'\x22'),_0x215f32={..._0x3b4de6,'type':_0x8cad4f(0x13ca),'content':_0x8cad4f(0x22a)+_0x324424[_0x8cad4f(0x7da)]+']'});}else console['warn'](_0x8cad4f(0xf98),_0x324424),_0x215f32={..._0x3b4de6,'type':_0x8cad4f(0xda8),'content':_0x324424[_0x8cad4f(0x121f)],'meaning':_0x8cad4f(0x7ec)};break;case _0x8cad4f(0x2c1):_0x130afd[_0x8cad4f(0x27d)][_0x8cad4f(0x13ca)]=_0x324424[_0x8cad4f(0xb61)],_0x130afd[_0x8cad4f(0x27d)][_0x8cad4f(0x545)]=_0x324424['is_busy']||![],_0x130afd['status'][_0x8cad4f(0x935)]=Date[_0x8cad4f(0x64b)]();break;case'qzone_post':const _0x14d8ce={'type':_0x324424[_0x8cad4f(0xd0e)],'content':_0x324424[_0x8cad4f(0x4e3)]||'','publicText':_0x324424[_0x8cad4f(0x6b9)]||'','hiddenContent':_0x324424[_0x8cad4f(0x14bb)]||'','image_prompt':_0x324424[_0x8cad4f(0xb95)]||'','timestamp':Date['now'](),'authorId':_0x3d3e8c,'authorOriginalName':_0x130afd[_0x8cad4f(0x339)],'authorGroupId':_0x130afd[_0x8cad4f(0x4ab)],'visibleGroupIds':null};await _0x512070['qzonePosts'][_0x8cad4f(0xe05)](_0x14d8ce),_0x28172c(_0x27ed94+0x1),console['log']('后台活动:\x20角色\x20\x22'+_0x130afd['name']+_0x8cad4f(0x596));break;case _0x8cad4f(0x5ee):const _0x2d2aae=await _0x512070[_0x8cad4f(0x10e5)][_0x8cad4f(0x14ee)](parseInt(_0x324424['postId']));if(_0x2d2aae){const _0x2fbda3={'type':'repost','timestamp':Date[_0x8cad4f(0x64b)](),'authorId':_0x3d3e8c,'authorGroupId':_0x130afd['groupId'],'authorOriginalName':_0x130afd[_0x8cad4f(0x339)],'repostComment':_0x324424[_0x8cad4f(0x79d)]||'','originalPost':_0x2d2aae,'visibleGroupIds':null};await _0x512070['qzonePosts']['add'](_0x2fbda3),_0x28172c(_0x27ed94+0x1),console[_0x8cad4f(0xe4d)](_0x8cad4f(0x4d6)+_0x130afd[_0x8cad4f(0x1561)]+_0x8cad4f(0x761)+_0x324424[_0x8cad4f(0xb92)]);}break;case _0x8cad4f(0x1176):const _0x2a0599=await _0x512070[_0x8cad4f(0x10e5)][_0x8cad4f(0x14ee)](parseInt(_0x324424[_0x8cad4f(0xb92)]));if(_0x2a0599){if(!_0x2a0599[_0x8cad4f(0x807)])_0x2a0599['likes']=[];!_0x2a0599[_0x8cad4f(0x807)][_0x8cad4f(0x478)](_0x130afd[_0x8cad4f(0x339)])&&(_0x2a0599['likes'][_0x8cad4f(0x1c4)](_0x130afd[_0x8cad4f(0x339)]),await _0x512070[_0x8cad4f(0x10e5)][_0x8cad4f(0xe33)](_0x2a0599['id'],{'likes':_0x2a0599[_0x8cad4f(0x807)]}),_0x28172c(_0x27ed94+0x1),console[_0x8cad4f(0xe4d)]('后台活动:\x20角色\x20\x22'+_0x130afd[_0x8cad4f(0x1561)]+_0x8cad4f(0xe1d)+_0x324424[_0x8cad4f(0xb92)]));}break;case _0x8cad4f(0x8ad):{const _0x2fd2a2=await _0x512070[_0x8cad4f(0x10e5)][_0x8cad4f(0x14ee)](parseInt(_0x324424[_0x8cad4f(0xb92)]));if(_0x2fd2a2){if(!_0x2fd2a2['comments'])_0x2fd2a2['comments']=[];const _0x14ec3e=_0x324424['name']||_0x130afd[_0x8cad4f(0x339)],_0x31baf5=(_0x5c6fd9,_0x25a9c0=null,_0x1580bd=null)=>({'commenterName':_0x14ec3e,'text':_0x8888da(_0x5c6fd9,_0x130afd),'meaning':_0x25a9c0,'replyTo':_0x1580bd,'timestamp':Date[_0x8cad4f(0x64b)]()});if(_0x324424['stickerMeaning']){const _0x17bcc5=_0x19ddb8['userStickers']['find'](_0x43eee6=>_0x43eee6[_0x8cad4f(0x1561)]===_0x324424[_0x8cad4f(0x1291)]);_0x17bcc5?_0x2fd2a2[_0x8cad4f(0xc79)][_0x8cad4f(0x1c4)](_0x31baf5(_0x17bcc5['url'],_0x17bcc5[_0x8cad4f(0x1561)],_0x324424[_0x8cad4f(0x877)]||null)):(console[_0x8cad4f(0x651)](_0x8cad4f(0x100d)+_0x324424[_0x8cad4f(0x1291)]+'\x22'),_0x2fd2a2['comments'][_0x8cad4f(0x1c4)](_0x31baf5(_0x8cad4f(0x22a)+_0x324424[_0x8cad4f(0x1291)]+']',null,_0x324424[_0x8cad4f(0x877)]||null)));}else{if(Array[_0x8cad4f(0xb9b)](_0x324424[_0x8cad4f(0xc79)]))_0x324424[_0x8cad4f(0xc79)][_0x8cad4f(0x15c1)](_0x55ced4=>{const _0x1e24c4=_0x8cad4f;typeof _0x55ced4==='string'&&_0x55ced4[_0x1e24c4(0x13f9)]()&&_0x2fd2a2[_0x1e24c4(0xc79)][_0x1e24c4(0x1c4)](_0x31baf5(_0x55ced4,null,_0x324424[_0x1e24c4(0x877)]||null));});else typeof _0x324424[_0x8cad4f(0x320)]===_0x8cad4f(0x86c)&&_0x324424[_0x8cad4f(0x320)][_0x8cad4f(0x13f9)]()&&_0x2fd2a2['comments'][_0x8cad4f(0x1c4)](_0x31baf5(_0x324424['commentText'],null,_0x324424[_0x8cad4f(0x877)]||null));}await _0x512070['qzonePosts'][_0x8cad4f(0xe33)](_0x2fd2a2['id'],{'comments':_0x2fd2a2[_0x8cad4f(0xc79)]}),_0x28172c(_0x27ed94+0x1),console['log'](_0x8cad4f(0x4d6)+_0x130afd[_0x8cad4f(0x1561)]+'\x22\x20评论了动态\x20#'+_0x324424[_0x8cad4f(0xb92)]);if(!_0x130afd[_0x8cad4f(0xb6a)])_0x130afd[_0x8cad4f(0xb6a)]={};_0x130afd[_0x8cad4f(0xb6a)][_0x324424[_0x8cad4f(0xb92)]]=Date[_0x8cad4f(0x64b)]();}continue;}case _0x8cad4f(0x7bb):!_0x4acdaf[_0x8cad4f(0x1412)]&&!_0x4acdaf[_0x8cad4f(0x62c)]&&(_0x4acdaf[_0x8cad4f(0x62c)]=!![],_0x4acdaf['activeChatId']=_0x3d3e8c,_0x4acdaf[_0x8cad4f(0x6a0)]=![],_0x4acdaf[_0x8cad4f(0x488)]=_0x130afd[_0x8cad4f(0x1561)],_0x29be00());break;default:console[_0x8cad4f(0x651)]('角色\x20\x22'+_0x130afd[_0x8cad4f(0x1561)]+_0x8cad4f(0x1169),_0x324424[_0x8cad4f(0x1508)]);break;case _0x8cad4f(0x13c9):{const _0x4bd573=_0x324424[_0x8cad4f(0x1561)],_0x24f1f4=_0x130afd[_0x8cad4f(0x450)][_0x8cad4f(0xea2)][_0x8cad4f(0xd62)](_0x2007ee=>_0x2007ee[_0x8cad4f(0x1561)]===_0x4bd573);_0x24f1f4&&(_0x130afd['settings']['aiAvatar']=_0x24f1f4['url'],await _0x3b911c(_0x130afd),visibleSystemMessage={'content':'['+_0x130afd[_0x8cad4f(0x1561)]+'\x20更换了头像]'},console[_0x8cad4f(0xe4d)](_0x8cad4f(0x4d6)+_0x130afd[_0x8cad4f(0x1561)]+'\x22\x20更换了头像'));break;}}if(_0x215f32){_0x130afd[_0x8cad4f(0x1f0)][_0x8cad4f(0x1c4)](_0x215f32),_0x130afd[_0x8cad4f(0xe20)]=(_0x130afd[_0x8cad4f(0xe20)]||0x0)+0x1;if(!_0x4da478){let _0x1451f5=_0x215f32[_0x8cad4f(0x1508)]==='ai_image'?_0x8cad4f(0xed3):_0x215f32[_0x8cad4f(0x4e3)]||'';_0x1c6d8a(_0x3d3e8c,_0x1451f5),_0x4da478=!![];}}}await _0x512070[_0x8cad4f(0xb04)][_0x8cad4f(0xd4d)](_0x130afd);}catch(_0x378b15){console[_0x8cad4f(0x3b7)](_0x8cad4f(0x133f)+_0x130afd['name']+'\x22\x20的独立行动失败:',_0x378b15);}finally{_0x4fad07(_0x3d3e8c,![]),_0xec8072(),document['getElementById'](_0x8cad4f(0x659))['classList'][_0x8cad4f(0x1222)]('active')&&_0x49acff();}}async function _0x36309f(_0x1fa2e4){const _0x12ab15=_0x48bc6d,_0x226672=_0x19ddb8['chats'][_0x1fa2e4];if(!_0x226672||!_0x226672[_0x12ab15(0x136b)])return;const _0x1f3bb8=_0x226672['settings'][_0x12ab15(0x605)]||0xa;if(_0x226672['lastActionTimestamp']){const _0x589509=(Date[_0x12ab15(0x64b)]()-_0x226672[_0x12ab15(0x4bf)])/(0x3e8*0x3c);if(_0x589509<_0x1f3bb8){console['log']('群聊\x20\x22'+_0x226672['name']+_0x12ab15(0xf0f));return;}}const {proxyUrl:_0x5437fd,apiKey:_0x32c06e,model:_0x190905}=_0x19ddb8[_0x12ab15(0xd22)];if(!_0x5437fd||!_0x32c06e||!_0x190905)return;const _0x4ed879=_0x226672[_0x12ab15(0x450)][_0x12ab15(0x1555)]||'我',_0x2b9a50=new Date();let _0x19d08b;const _0x3cb8d5=_0x226672[_0x12ab15(0x1f0)][_0x12ab15(0x1195)](_0x17d847=>!_0x17d847['isHidden'])[_0x12ab15(0x457)](-0x5),_0x4c2d7f=_0x3cb8d5[_0x12ab15(0xd62)](_0x4f247c=>_0x4f247c['type']===_0x12ab15(0x552)&&!_0x4f247c['isFullyClaimed']);if(_0x4c2d7f){const _0x35fc06=_0x1e2056(_0x226672,_0x4c2d7f['senderName']);console[_0x12ab15(0xe4d)](_0x12ab15(0xf0c)+_0x226672['name']+_0x12ab15(0x159b)),_0x19d08b=_0x12ab15(0xf5d)+_0x35fc06+_0x12ab15(0x915)+_0x4c2d7f[_0x12ab15(0xd73)]+_0x12ab15(0xe07)+_0x4c2d7f['timestamp']+_0x12ab15(0x112c);}else{let _0x589b92='';const _0x1484ee=_0x226672[_0x12ab15(0x450)]['timeZone']||'Asia/Shanghai',_0x1d0ff6=_0x2b9a50[_0x12ab15(0x12cf)]('zh-CN',{'timeZone':_0x1484ee,'dateStyle':_0x12ab15(0x38f),'timeStyle':_0x12ab15(0xa1b)}),_0x19c459=new Date(_0x2b9a50[_0x12ab15(0x12cf)](_0x12ab15(0xf06),{'timeZone':_0x1484ee}));if(_0x226672['settings'][_0x12ab15(0x2de)]){const _0x35b2b=_0x226672[_0x12ab15(0x1f0)][_0x12ab15(0x1195)](_0x35ea1b=>!_0x35ea1b[_0x12ab15(0x136e)])[_0x12ab15(0x457)](-0x1)[0x0];if(_0x35b2b){const _0x2aa853=new Date(_0x35b2b[_0x12ab15(0xd73)]),_0x52c53d=(_0x2b9a50-_0x2aa853)/(0x3e8*0x3c);_0x52c53d>0x3c?_0x589b92='群里已经安静了\x20'+Math[_0x12ab15(0xb9d)](_0x52c53d/0x3c)+_0x12ab15(0xbf2):_0x589b92='群里在'+Math[_0x12ab15(0xd95)](_0x52c53d)+_0x12ab15(0x1517);}else _0x589b92=_0x12ab15(0x45f);}let _0x4e9632=_0x12ab15(0xa1c);const _0x30a017=_0x226672['settings']['maxMemory']||0xa,_0x16b478=_0x226672[_0x12ab15(0x1f0)]['filter'](_0x298a02=>!_0x298a02['isHidden'])['slice'](-_0x30a017);_0x16b478[_0x12ab15(0x106b)]>0x0&&(_0x4e9632=_0x12ab15(0x9bf)+_0x16b478[_0x12ab15(0xb0a)](_0x26e08c=>{const _0x8958a5=_0x12ab15,_0x1d5dec=_0x26e08c[_0x8958a5(0x11c1)]==='user'?_0x4ed879:_0x1e2056(_0x226672,_0x26e08c[_0x8958a5(0x1043)]),_0x501698=String(_0x26e08c[_0x8958a5(0x4e3)]||_0x26e08c['message']||'')['substring'](0x0,0x32);return _0x1d5dec+':\x20'+_0x501698+_0x8958a5(0x4a5);})['join']('\x0a'));const _0x1e6ad6=_0x226672[_0x12ab15(0xcca)][_0x12ab15(0xb0a)](_0x31318f=>_0x12ab15(0x1e5)+_0x31318f[_0x12ab15(0xaf0)]+'**\x20(本名:\x20'+_0x31318f['originalName']+_0x12ab15(0x41b)+_0x31318f[_0x12ab15(0xcd4)])[_0x12ab15(0x3b9)]('\x0a');let _0x4635f5=_0x12ab15(0xc60),_0x51bdec=![];_0x226672['members'][_0x12ab15(0x15c1)](_0x2b5c22=>{const _0xc76943=_0x12ab15,_0x276fa0=_0x19ddb8['chats'][_0x2b5c22['id']];_0x276fa0&&_0x276fa0['longTermMemory']&&_0x276fa0[_0xc76943(0x744)][_0xc76943(0x106b)]>0x0&&(_0x4635f5+=_0xc76943(0x9d0)+_0x2b5c22[_0xc76943(0xaf0)]+'”的记忆\x20---\x0a',_0x4635f5+=_0x276fa0[_0xc76943(0x744)][_0xc76943(0xb0a)](_0x42f990=>'-\x20'+_0x42f990[_0xc76943(0x4e3)])['join']('\x0a'),_0x51bdec=!![]);});!_0x51bdec&&(_0x4635f5+=_0x12ab15(0xc55));let _0x2cd01e='';if(_0x226672[_0x12ab15(0x450)][_0x12ab15(0x9c4)]&&_0x226672[_0x12ab15(0x450)]['linkedWorldBookIds'][_0x12ab15(0x106b)]>0x0){const _0xef2345=_0x226672['settings']['linkedWorldBookIds'][_0x12ab15(0xb0a)](_0x5ec9d3=>{const _0x9f71c2=_0x12ab15,_0x3772ec=_0x19ddb8['worldBooks'][_0x9f71c2(0xd62)](_0x4f5c1f=>_0x4f5c1f['id']===_0x5ec9d3);if(!_0x3772ec||!Array[_0x9f71c2(0xb9b)](_0x3772ec[_0x9f71c2(0x4e3)]))return'';const _0x58a423=_0x3772ec[_0x9f71c2(0x4e3)][_0x9f71c2(0x1195)](_0x2b9ccc=>_0x2b9ccc[_0x9f71c2(0x15cd)]!==![])[_0x9f71c2(0xb0a)](_0x26c8a9=>{const _0x45e213=_0x9f71c2;let _0x3f3870=_0x45e213(0xc4e)+(_0x26c8a9[_0x45e213(0x79d)]||_0x45e213(0xbcc))+'\x0a';return _0x26c8a9[_0x45e213(0x2d0)][_0x45e213(0x106b)]>0x0&&(_0x3f3870+=_0x45e213(0x1092)+_0x26c8a9['keys'][_0x45e213(0x3b9)](',\x20')+'\x0a'),_0x3f3870+=_0x45e213(0x14b5)+_0x26c8a9[_0x45e213(0x4e3)],_0x3f3870;})[_0x9f71c2(0x3b9)]('');return _0x58a423?_0x9f71c2(0xe9b)+_0x3772ec[_0x9f71c2(0x1561)]+'\x0a'+_0x58a423:'';})[_0x12ab15(0x1195)](Boolean)[_0x12ab15(0x3b9)]('');_0xef2345&&(_0x2cd01e='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0xef2345+_0x12ab15(0x951));}let _0x2a850c='';const _0x30b3a3=_0x226672[_0x12ab15(0x450)][_0x12ab15(0xb09)]||0xa;if(_0x226672['settings'][_0x12ab15(0x120e)]&&_0x226672[_0x12ab15(0x450)]['linkedMemoryChatIds'][_0x12ab15(0x106b)]>0x0){const _0x5432a7=_0x226672[_0x12ab15(0x450)][_0x12ab15(0x120e)][_0x12ab15(0xb0a)](_0x2ab040=>{const _0x5ed5b0=_0x12ab15,_0x382478=_0x19ddb8['chats'][_0x2ab040];if(!_0x382478)return null;const _0x4ae34c=_0x382478[_0x5ed5b0(0x1f0)]['slice'](-0x1)[0x0];return{'chat':_0x382478,'latestTimestamp':_0x4ae34c?_0x4ae34c['timestamp']:0x0};})[_0x12ab15(0x1195)](Boolean);_0x5432a7[_0x12ab15(0x6a2)]((_0x15179f,_0x44fae4)=>_0x44fae4[_0x12ab15(0x1a4)]-_0x15179f['latestTimestamp']),_0x2a850c+=_0x12ab15(0x1fa);for(const _0x4128c5 of _0x5432a7){const _0x4cf5f8=_0x4128c5[_0x12ab15(0xd43)],_0x20091b=_0x4cf5f8[_0x12ab15(0x136b)]?'[群聊]':_0x12ab15(0x939),_0x5b8f97=_0x4128c5['latestTimestamp']>0x0?'\x20(最后互动于\x20'+_0x5d6abc(_0x4128c5['latestTimestamp'])+')':'';_0x2a850c+=_0x12ab15(0xf63)+_0x20091b+'“'+_0x4cf5f8[_0x12ab15(0x1561)]+'”的参考记忆'+_0x5b8f97+_0x12ab15(0x1419);const _0xdbfcea=_0x4cf5f8['history'][_0x12ab15(0x457)](-_0x30b3a3),_0x35eb29=_0xdbfcea[_0x12ab15(0x1195)](_0x1ba660=>!String(_0x1ba660[_0x12ab15(0x4e3)])[_0x12ab15(0x478)]('已被用户删除'));_0x35eb29[_0x12ab15(0x106b)]>0x0?_0x35eb29[_0x12ab15(0x15c1)](_0x43f5d5=>{const _0x18f267=_0x12ab15,_0x1e530b=_0x43f5d5[_0x18f267(0x11c1)]==='user'?_0x4cf5f8['settings'][_0x18f267(0x1555)]||'我':_0x43f5d5[_0x18f267(0x1043)]||_0x4cf5f8[_0x18f267(0x1561)];let _0x170717=String(_0x43f5d5[_0x18f267(0x4e3)]);if(_0x43f5d5[_0x18f267(0x1508)]==='ai_image'||_0x43f5d5[_0x18f267(0x1508)]===_0x18f267(0x9ee))_0x170717=_0x18f267(0x21c)+_0x43f5d5['content']+']';else _0x43f5d5[_0x18f267(0x1508)]===_0x18f267(0x1207)&&(_0x170717='[发送了一条语音，内容是：'+_0x43f5d5[_0x18f267(0x4e3)]+']');_0x2a850c+=_0x1e530b+':\x20'+_0x170717+'\x0a';}):_0x2a850c+=_0x12ab15(0xc40);}}const _0xcfeff7=await _0x512070['qzonePosts'][_0x12ab15(0x1404)](_0x12ab15(0xd73))[_0x12ab15(0x333)]()[_0x12ab15(0x10d1)](0x5)[_0x12ab15(0x591)]();let _0x3cea2f='';const _0x135741=new Set();for(const _0x1ea171 of _0x226672[_0x12ab15(0xcca)]){const _0x44e5cd=_0x19ddb8[_0x12ab15(0xb04)][_0x1ea171['id']];if(_0x44e5cd){const _0x12dc68=_0x35b975(_0xcfeff7,_0x44e5cd);_0x12dc68[_0x12ab15(0x15c1)](_0x1b9add=>_0x135741[_0x12ab15(0xe05)](_0x1b9add));}}const _0x325bde=new Set(_0x226672[_0x12ab15(0xcca)][_0x12ab15(0xb0a)](_0x28beb0=>_0x28beb0[_0x12ab15(0x339)])),_0x41d263=[..._0x135741][_0x12ab15(0x1195)](_0x152ba3=>{const _0x176d91=_0x12ab15,_0x1efec9=_0x152ba3['likes']&&_0x152ba3[_0x176d91(0x807)]['some'](_0x1d68c5=>_0x325bde[_0x176d91(0x1472)](_0x1d68c5)),_0x296d7b=_0x152ba3['comments']&&_0x152ba3[_0x176d91(0xc79)][_0x176d91(0x336)](_0x2c07b5=>typeof _0x2c07b5===_0x176d91(0x12fe)&&_0x325bde[_0x176d91(0x1472)](_0x2c07b5[_0x176d91(0x1200)]));return!_0x1efec9&&!_0x296d7b;});if(_0x41d263[_0x12ab15(0x106b)]>0x0){let _0x5d92e0=_0x12ab15(0x2c0);for(const _0x453d1 of _0x41d263){let _0x3d925a=_0x453d1['authorId']===_0x12ab15(0x20d)?_0x4ed879:_0x19ddb8[_0x12ab15(0xb04)][_0x453d1['authorId']]?.['name']||_0x12ab15(0x18b),_0x16cb37;if(_0x453d1['type']===_0x12ab15(0x5ee)){const _0xd6c71a=_0x453d1[_0x12ab15(0x3eb)]?_0x12ab15(0x15a0)+_0x453d1['repostComment']+'”':'';let _0x13085f=_0x12ab15(0x423);const _0x51676d=_0x453d1['originalPost'][_0x12ab15(0x82c)];if(_0x51676d===_0x12ab15(0x20d))_0x13085f=_0x19ddb8[_0x12ab15(0x9ce)][_0x12ab15(0x246)];else _0x19ddb8[_0x12ab15(0xb04)][_0x51676d]&&(_0x13085f=_0x19ddb8['chats'][_0x51676d][_0x12ab15(0x1561)]);let _0x3e8e40;const _0x493823=_0x453d1['originalPost'];if(_0x493823[_0x12ab15(0x1508)]===_0x12ab15(0x1281))_0x3e8e40='[文字图]\x20'+(_0x493823[_0x12ab15(0x6b9)]||'')+_0x12ab15(0x4a0)+(_0x493823[_0x12ab15(0x14bb)]||'')[_0x12ab15(0x72e)](0x0,0x28)+_0x12ab15(0x118d);else _0x493823['type']==='image_post'?_0x3e8e40=_0x12ab15(0xe48)+(_0x493823['publicText']||'')+_0x12ab15(0x4a0)+(_0x493823[_0x12ab15(0xbea)]||'')['substring'](0x0,0x28)+'...”)':_0x3e8e40='“'+(_0x493823[_0x12ab15(0x4e3)]||'')[_0x12ab15(0x72e)](0x0,0x28)+_0x12ab15(0x12c5);_0x16cb37=_0x12ab15(0xa3c)+_0x13085f+'\x20的动态\x20'+_0xd6c71a+_0x12ab15(0x9d1)+_0x3e8e40+'】';}else{if(_0x453d1[_0x12ab15(0x1508)]===_0x12ab15(0x1281))_0x16cb37=('[一张图片，其隐藏文字为：“'+_0x453d1[_0x12ab15(0x14bb)]+_0x12ab15(0xfa6)+(_0x453d1[_0x12ab15(0x6b9)]||''))[_0x12ab15(0x72e)](0x0,0x32)+'...';else _0x453d1['type']===_0x12ab15(0x1016)?_0x16cb37=('[一张图片，描述为：“'+_0x453d1[_0x12ab15(0xbea)]+_0x12ab15(0xfa6)+(_0x453d1[_0x12ab15(0x6b9)]||''))[_0x12ab15(0x72e)](0x0,0x32)+'...':_0x16cb37=String(_0x453d1['publicText']||_0x453d1[_0x12ab15(0x4e3)]||'一条动态')[_0x12ab15(0x72e)](0x0,0x32)+_0x12ab15(0x4a5);}_0x5d92e0+=_0x12ab15(0x1549)+_0x453d1['id']+_0x12ab15(0x11af)+_0x3d925a+_0x12ab15(0x45e)+_0x16cb37+'\x22\x0a';if(_0x453d1['comments']&&_0x453d1[_0x12ab15(0xc79)][_0x12ab15(0x106b)]>0x0)for(const _0xfc201d of _0x453d1[_0x12ab15(0xc79)]){if(typeof _0xfc201d===_0x12ab15(0x12fe)&&_0xfc201d[_0x12ab15(0x1200)]){const _0x412af7=_0x2e9dd1(_0xfc201d[_0x12ab15(0x1200)]);let _0x23cea4=_0xfc201d[_0x12ab15(0x7da)]?'[表情:\x20\x27'+_0xfc201d[_0x12ab15(0x7da)]+'\x27]':_0xfc201d[_0x12ab15(0x13ca)];_0x5d92e0+=_0x12ab15(0x8c1)+_0x412af7+_0x12ab15(0x1bd)+_0xfc201d[_0x12ab15(0x1200)]+_0x12ab15(0x41b)+_0x23cea4+'\x0a';}}}_0x3cea2f=_0x5d92e0;}const _0x5556a3=_0x54310e(_0x226672,0x3,'hours'),_0x5c15bb=_0x54310e(_0x226672,0x6,_0x12ab15(0xb41)),_0x36aa57=_0x54310e(_0x226672,0x9,'hours'),_0x1f4996=_0x54310e(_0x226672,0x1,_0x12ab15(0x113c)),_0x4f0134=_0x54310e(_0x226672,0x3,_0x12ab15(0x113c)),_0x4a08e4=_0x54310e(_0x226672,0x7,_0x12ab15(0x113c));let _0x459a0c='';if(_0x5556a3||_0x5c15bb||_0x36aa57||_0x1f4996||_0x4f0134||_0x4a08e4){_0x459a0c+='\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a';if(_0x5556a3)_0x459a0c+=_0x5556a3;if(_0x5c15bb)_0x459a0c+=_0x5c15bb;if(_0x36aa57)_0x459a0c+=_0x36aa57;if(_0x5556a3||_0x5c15bb||_0x36aa57)_0x459a0c+='\x0a';if(_0x1f4996)_0x459a0c+=_0x1f4996;if(_0x4f0134)_0x459a0c+=_0x4f0134;if(_0x4a08e4)_0x459a0c+=_0x4a08e4;}const _0x2dbe27=_0x50f06c(_0x226672);_0x19d08b=_0x12ab15(0x1446)+_0x226672['name']+_0x12ab15(0x373)+(_0x226672[_0x12ab15(0x450)][_0x12ab15(0x2de)]?_0x12ab15(0x14b8)+_0x1d0ff6+'。':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x589b92?_0x589b92+'\x20':'')+_0x12ab15(0x719)+_0x4635f5+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，可以包含一个或多个行动对象。每个对象的\x20\x22name\x22\x20字段【必须】是角色的【本名】。你【绝对不能】生成\x20\x22name\x22\x20字段为\x20\x22'+_0x4ed879+_0x12ab15(0x629)+_0x226672['name']+_0x12ab15(0x1560)+_0x2cd01e+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x226672['longTermMemory']&&_0x226672[_0x12ab15(0x744)][_0x12ab15(0x106b)]>0x0?_0x226672[_0x12ab15(0x744)][_0x12ab15(0xb0a)](_0x151933=>'-\x20'+_0x151933[_0x12ab15(0x4e3)])[_0x12ab15(0x3b9)]('\x0a'):'-\x20(暂无)')+_0x12ab15(0x15d2)+_0x459a0c+_0x12ab15(0x1560)+_0x2a850c+_0x12ab15(0x36d)+_0x1e6ad6+_0x12ab15(0x291)+_0x2dbe27+_0x12ab15(0x82f)+_0x4ed879+_0x12ab15(0x11b7)+_0x226672[_0x12ab15(0x450)][_0x12ab15(0x1e3)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的对话摘要\x20(供你参考)\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4e9632+_0x12ab15(0xdff)+_0x3cea2f+_0x12ab15(0x114c);}const _0x3951e1=_0x226672['history'][_0x12ab15(0x1195)](_0x271348=>!_0x271348['isHidden'])[_0x12ab15(0x457)](-0xa),_0x342ea1=[{'role':_0x12ab15(0xe10),'content':_0x19d08b},..._0x3951e1[_0x12ab15(0xb0a)](_0x42f7b1=>{const _0x1577b0=_0x12ab15,_0x58b792=_0x42f7b1[_0x1577b0(0x11c1)]===_0x1577b0(0x20d)?_0x4ed879:_0x1e2056(_0x226672,_0x42f7b1[_0x1577b0(0x1043)]);let _0x46b5f2=_0x42f7b1[_0x1577b0(0x4e3)];if(_0x42f7b1[_0x1577b0(0x1508)]===_0x1577b0(0x1c1)||_0x42f7b1[_0x1577b0(0x1508)]===_0x1577b0(0x9ee))_0x46b5f2=_0x1577b0(0xd33)+_0x42f7b1[_0x1577b0(0x4e3)]+'\x27]';else{if(_0x42f7b1['type']===_0x1577b0(0x1207))_0x46b5f2=_0x1577b0(0x1399)+_0x42f7b1[_0x1577b0(0x4e3)]+'\x27]';else typeof _0x46b5f2!==_0x1577b0(0x86c)&&(_0x46b5f2=_0x1577b0(0x682));}return{'role':_0x1577b0(0x20d),'content':_0x58b792+':\x20'+_0x46b5f2};})];try{const _0x404d32=[{'role':_0x12ab15(0x20d),'content':_0x19d08b}];let _0x5552ee=_0x5437fd===GEMINI_API_URL,_0x578025=_0x366263(_0x190905,_0x32c06e,_0x19d08b,_0x404d32);const _0x15c7ee=_0x5552ee?await fetch(_0x578025[_0x12ab15(0x121f)],_0x578025[_0x12ab15(0x38c)]):await fetch(_0x5437fd+'/v1/chat/completions',{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x12ab15(0x1265)+_0x32c06e},'body':JSON[_0x12ab15(0xe1e)]({'model':_0x190905,'messages':_0x404d32,'temperature':_0x19ddb8[_0x12ab15(0x4c8)][_0x12ab15(0x4a2)]||0.9})});if(!_0x15c7ee['ok'])throw new Error((await _0x15c7ee[_0x12ab15(0xa5d)]())[_0x12ab15(0x3b7)][_0x12ab15(0xcce)]);const _0x196f89=await _0x15c7ee[_0x12ab15(0xa5d)](),_0x260469=_0x5552ee?_0x196f89['candidates'][0x0][_0x12ab15(0x4e3)][_0x12ab15(0x79b)][0x0][_0x12ab15(0x13ca)]:_0x196f89[_0x12ab15(0x21f)][0x0][_0x12ab15(0xcce)][_0x12ab15(0x4e3)],_0x553192=_0x189ab1(_0x260469);if(!_0x553192||_0x553192[_0x12ab15(0x106b)]===0x0){console[_0x12ab15(0x651)]('群聊\x20\x22'+_0x226672['name']+'\x22\x20的独立行动API返回为空或格式不正确，本次跳过。');return;}let _0x38a515=Date[_0x12ab15(0x64b)](),_0x1a688a=![],_0x5cfe57='',_0x5f31a8='';const _0x4fcd78=[];for(const _0xe34668 of _0x553192){const _0x29a04c=String(_0xe34668['content']||''),_0x70242d=_0x29a04c['trim']()[_0x12ab15(0x608)]('<')&&_0x29a04c['trim']()[_0x12ab15(0xb5a)]('>');if(_0xe34668[_0x12ab15(0x1508)]===_0x12ab15(0x13ca)&&!_0x70242d&&_0x29a04c[_0x12ab15(0x478)]('\x0a')){const _0x1cbcb7=_0x29a04c[_0x12ab15(0x1536)](/\n+/)[_0x12ab15(0x1195)](_0x51cd74=>_0x51cd74['trim']());_0x1cbcb7[_0x12ab15(0x15c1)](_0x4cca40=>{const _0x4555ee=_0x12ab15;_0x4fcd78[_0x4555ee(0x1c4)]({..._0xe34668,'content':_0x4cca40});});}else _0x4fcd78['push'](_0xe34668);}for(const _0x17d59a of _0x4fcd78){if(!_0x17d59a||!_0x17d59a[_0x12ab15(0x1508)]||!_0x17d59a[_0x12ab15(0x1561)])continue;const _0x154471=_0x1e2056(_0x226672,_0x17d59a[_0x12ab15(0x1561)]);let _0x372b26=null,_0x4c3e38=null;const _0x5bdbed={'role':'assistant','senderName':_0x17d59a[_0x12ab15(0x1561)],'timestamp':_0x38a515++};if(_0x17d59a[_0x12ab15(0x1508)]===_0x12ab15(0xd4e)){const _0xdedd7d=_0x226672[_0x12ab15(0x1f0)]['find'](_0x301b3e=>_0x301b3e[_0x12ab15(0xd73)]===_0x17d59a[_0x12ab15(0x136c)]);if(_0xdedd7d&&!_0xdedd7d[_0x12ab15(0x1565)]&&!(_0xdedd7d['claimedBy']&&_0xdedd7d['claimedBy'][_0x17d59a[_0x12ab15(0x1561)]])){let _0xe69289=0x0;const _0x426c83=_0xdedd7d['totalAmount']-Object[_0x12ab15(0xea1)](_0xdedd7d[_0x12ab15(0x2f5)]||{})[_0x12ab15(0x68f)]((_0x2d555e,_0x40cfc0)=>_0x2d555e+_0x40cfc0,0x0),_0x54ca44=_0xdedd7d['count']-Object[_0x12ab15(0x2d0)](_0xdedd7d[_0x12ab15(0x2f5)]||{})[_0x12ab15(0x106b)];if(_0x54ca44>0x0){if(_0x54ca44===0x1)_0xe69289=_0x426c83;else{const _0x7c84fc=0.01,_0x4a8fe6=_0x426c83-(_0x54ca44-0x1)*_0x7c84fc;_0xe69289=Math[_0x12ab15(0xdcd)]()*(_0x4a8fe6-_0x7c84fc)+_0x7c84fc;}_0xe69289=parseFloat(_0xe69289[_0x12ab15(0x1322)](0x2));if(!_0xdedd7d['claimedBy'])_0xdedd7d[_0x12ab15(0x2f5)]={};_0xdedd7d[_0x12ab15(0x2f5)][_0x17d59a[_0x12ab15(0x1561)]]=_0xe69289,_0x226672['history'][_0x12ab15(0x1c4)]({'role':_0x12ab15(0xe10),'type':_0x12ab15(0x1082),'content':_0x154471+_0x12ab15(0xdb6)+_0x1e2056(_0x226672,_0xdedd7d[_0x12ab15(0x1043)])+_0x12ab15(0x1148),'timestamp':Date['now']()});let _0x1ffc2a=_0x12ab15(0x325)+_0x154471+_0x12ab15(0x628)+_0xe69289['toFixed'](0x2)+'\x20元。';if(Object[_0x12ab15(0x2d0)](_0xdedd7d[_0x12ab15(0x2f5)])['length']>=_0xdedd7d[_0x12ab15(0x3a9)]){_0xdedd7d[_0x12ab15(0x1565)]=!![],_0x226672[_0x12ab15(0x1f0)]['push']({'role':_0x12ab15(0xe10),'type':_0x12ab15(0x1082),'content':_0x1e2056(_0x226672,_0xdedd7d[_0x12ab15(0x1043)])+_0x12ab15(0x12a5),'timestamp':Date[_0x12ab15(0x64b)]()+0x1});let _0x15fe2d={'name':'','amount':-0x1};Object[_0x12ab15(0x10c3)](_0xdedd7d[_0x12ab15(0x2f5)])[_0x12ab15(0x15c1)](([_0x4971e5,_0x5a653])=>{const _0x2af3bc=_0x12ab15;_0x5a653>_0x15fe2d[_0x2af3bc(0x11fa)]&&(_0x15fe2d={'name':_0x4971e5,'amount':_0x5a653});});if(_0x15fe2d[_0x12ab15(0x1561)]){const _0x2b2ed3=_0x1e2056(_0x226672,_0x15fe2d[_0x12ab15(0x1561)]);_0x1ffc2a+=_0x12ab15(0x1184)+_0x2b2ed3+'！';}}_0x1ffc2a+=_0x12ab15(0xa61),_0x226672[_0x12ab15(0x1f0)]['push']({'role':_0x12ab15(0xe10),'content':_0x1ffc2a,'timestamp':Date[_0x12ab15(0x64b)]()+0x2,'isHidden':!![]});}}_0x1a688a=!![];continue;}switch(_0x17d59a[_0x12ab15(0x1508)]){case _0x12ab15(0xda8):if(_0x17d59a['meaning']){const _0x2278fc=_0x19ddb8[_0x12ab15(0x1557)][_0x12ab15(0xd62)](_0x5a96d2=>_0x5a96d2['name']===_0x17d59a[_0x12ab15(0x7da)]);_0x2278fc?_0x4c3e38={..._0x5bdbed,'type':_0x12ab15(0xda8),'content':_0x2278fc[_0x12ab15(0x121f)],'meaning':_0x2278fc['name']}:(console[_0x12ab15(0x651)](_0x12ab15(0x9e8)+_0x17d59a[_0x12ab15(0x7da)]+'\x22'),_0x4c3e38={..._0x5bdbed,'type':_0x12ab15(0x13ca),'content':_0x12ab15(0x22a)+_0x17d59a[_0x12ab15(0x7da)]+']'});}else console[_0x12ab15(0x651)]('AI\x20(群聊后台)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。',_0x17d59a),_0x4c3e38={..._0x5bdbed,'type':_0x12ab15(0xda8),'content':_0x17d59a[_0x12ab15(0x121f)],'meaning':_0x12ab15(0x7ec)};break;case _0x12ab15(0x120f):const _0x5ec42c={'type':_0x17d59a[_0x12ab15(0xd0e)]||'shuoshuo','content':_0x17d59a[_0x12ab15(0x4e3)],'timestamp':Date[_0x12ab15(0x64b)](),'authorId':_0x19ddb8['chats'][Object[_0x12ab15(0x2d0)](_0x19ddb8[_0x12ab15(0xb04)])[_0x12ab15(0xd62)](_0x300258=>_0x19ddb8['chats'][_0x300258][_0x12ab15(0x339)]===_0x17d59a[_0x12ab15(0x1561)])]?.['id']||_0x17d59a[_0x12ab15(0x1561)],'authorOriginalName':_0x17d59a[_0x12ab15(0x1561)],'visibleGroupIds':null};await _0x512070['qzonePosts']['add'](_0x5ec42c),_0x28172c(_0x27ed94+0x1),_0x372b26={'content':'['+_0x154471+_0x12ab15(0x122f)};break;case _0x12ab15(0x8ad):const _0xdc22c6=await _0x512070[_0x12ab15(0x10e5)][_0x12ab15(0x14ee)](parseInt(_0x17d59a[_0x12ab15(0xb92)]));if(_0xdc22c6){if(!_0xdc22c6[_0x12ab15(0xc79)])_0xdc22c6[_0x12ab15(0xc79)]=[];_0xdc22c6[_0x12ab15(0xc79)][_0x12ab15(0x1c4)]({'commenterName':_0x17d59a[_0x12ab15(0x1561)],'text':_0x17d59a[_0x12ab15(0x320)],'timestamp':Date['now']()}),await _0x512070[_0x12ab15(0x10e5)]['update'](_0xdc22c6['id'],{'comments':_0xdc22c6[_0x12ab15(0xc79)]}),_0x28172c(_0x27ed94+0x1),_0x372b26={'content':'['+_0x154471+_0x12ab15(0x14b9)};}break;case _0x12ab15(0x1176):const _0x460c33=await _0x512070[_0x12ab15(0x10e5)][_0x12ab15(0x14ee)](parseInt(_0x17d59a[_0x12ab15(0xb92)]));if(_0x460c33){if(!_0x460c33[_0x12ab15(0x807)])_0x460c33[_0x12ab15(0x807)]=[];!_0x460c33[_0x12ab15(0x807)][_0x12ab15(0x478)](_0x17d59a[_0x12ab15(0x1561)])&&(_0x460c33[_0x12ab15(0x807)]['push'](_0x17d59a[_0x12ab15(0x1561)]),await _0x512070[_0x12ab15(0x10e5)][_0x12ab15(0xe33)](_0x460c33['id'],{'likes':_0x460c33[_0x12ab15(0x807)]}),_0x28172c(_0x27ed94+0x1),_0x372b26={'content':'['+_0x154471+_0x12ab15(0xb36)});}break;case'ai_image':_0x4c3e38={..._0x5bdbed,'type':_0x12ab15(0x1c1),'content':_0x17d59a[_0x12ab15(0x3ef)],'image_prompt':msgData[_0x12ab15(0xb95)]};break;default:if(_0x17d59a[_0x12ab15(0x1508)]===_0x12ab15(0x3e6)){const _0xff8f29=typeof _0x17d59a['options']===_0x12ab15(0x86c)?_0x17d59a[_0x12ab15(0x11c2)][_0x12ab15(0x1536)]('\x0a')['filter'](_0x24ffc0=>_0x24ffc0[_0x12ab15(0x13f9)]()):Array['isArray'](_0x17d59a['options'])?_0x17d59a['options']:[];if(_0xff8f29[_0x12ab15(0x106b)]<0x2)continue;_0x4c3e38={..._0x5bdbed,..._0x17d59a,'options':_0xff8f29,'votes':{},'isClosed':![]};}else{const _0x349b3a=_0x17d59a[_0x12ab15(0x4e3)]||_0x17d59a[_0x12ab15(0xcce)];_0x4c3e38={..._0x5bdbed,..._0x17d59a};if(_0x349b3a)_0x4c3e38[_0x12ab15(0x4e3)]=_0x349b3a;}break;}if(_0x372b26)_0x226672[_0x12ab15(0x1f0)][_0x12ab15(0x1c4)]({'role':_0x12ab15(0xe10),'type':'pat_message','content':_0x372b26[_0x12ab15(0x4e3)],'timestamp':_0x38a515++});else _0x4c3e38&&(_0x226672[_0x12ab15(0x1f0)][_0x12ab15(0x1c4)](_0x4c3e38),!_0x5f31a8&&(_0x5f31a8=_0x154471,_0x5cfe57=_0x4c3e38['type']===_0x12ab15(0x1c1)?_0x12ab15(0xed3):_0x4c3e38[_0x12ab15(0x4e3)]||'['+_0x4c3e38['type']+']'));_0x1a688a=!![];}_0x1a688a&&(_0x226672[_0x12ab15(0x4bf)]=Date[_0x12ab15(0x64b)](),_0x226672[_0x12ab15(0xe20)]=(_0x226672[_0x12ab15(0xe20)]||0x0)+_0x553192[_0x12ab15(0x1195)](_0x5b26ac=>_0x5b26ac[_0x12ab15(0x1508)]!==_0x12ab15(0x120f)&&_0x5b26ac['type']!=='qzone_comment'&&_0x5b26ac[_0x12ab15(0x1508)]!==_0x12ab15(0x1176))[_0x12ab15(0x106b)],_0x5f31a8&&_0x5cfe57&&_0x1c6d8a(_0x1fa2e4,_0x5f31a8+':\x20'+_0x5cfe57),await _0x512070['chats'][_0x12ab15(0xd4d)](_0x226672));}catch(_0x3ea1c7){console[_0x12ab15(0x3b7)](_0x12ab15(0x1310)+_0x226672[_0x12ab15(0x1561)]+_0x12ab15(0x11d9),_0x3ea1c7);}finally{_0xec8072();}}function _0x1253e3(_0x13417e,_0x4423fd,_0x5b120e){const _0x37b62d=_0x48bc6d,_0x13b8df=document[_0x37b62d(0x9a3)](_0x5b120e);if(!_0x13b8df)return;if(!_0x13417e||_0x13417e[_0x37b62d(0x13f9)]()===''){_0x13b8df['innerHTML']='';return;}const _0x9961ba=_0x13417e[_0x37b62d(0x1bb)](/\s*\.message-bubble\.user\s+([^{]+\{)/g,_0x4423fd+_0x37b62d(0x13bf))[_0x37b62d(0x1bb)](/\s*\.message-bubble\.ai\s+([^{]+\{)/g,_0x4423fd+_0x37b62d(0x6a8))[_0x37b62d(0x1bb)](/\s*\.message-bubble\s+([^{]+\{)/g,_0x4423fd+_0x37b62d(0xd11));_0x13b8df[_0x37b62d(0xeb2)]=_0x9961ba;}async function _0x2628c1(){const _0x310621=_0x48bc6d;if(!_0x19ddb8[_0x310621(0x859)])return;const _0x42dd04=_0x19ddb8[_0x310621(0xb04)][_0x19ddb8[_0x310621(0x859)]],_0x16e9f7=document['getElementById'](_0x310621(0x11e9));if(!_0x16e9f7)return;const _0x320ef4=document['querySelector'](_0x310621(0x9f1))?.[_0x310621(0x7b2)]||_0x310621(0xd5f),_0x32e465=document[_0x310621(0x9a3)](_0x310621(0xf38))[_0x310621(0x7b2)],_0x37af5d=document[_0x310621(0x9a3)](_0x310621(0x750))[_0x310621(0x7b2)],_0x49ab18=_0x42dd04['settings']['background'];_0x16e9f7['dataset'][_0x310621(0x910)]=_0x320ef4,_0x16e9f7[_0x310621(0x20f)][_0x310621(0x11b9)](_0x310621(0xcee),_0x32e465+'px');_0x49ab18&&_0x49ab18[_0x310621(0x608)](_0x310621(0x12b9))?(_0x16e9f7[_0x310621(0x20f)]['backgroundImage']='url('+_0x49ab18+')',_0x16e9f7[_0x310621(0x20f)][_0x310621(0x87e)]='transparent'):(_0x16e9f7[_0x310621(0x20f)][_0x310621(0x1090)]='none',_0x16e9f7[_0x310621(0x20f)][_0x310621(0x5f1)]=_0x49ab18||_0x310621(0xee8));_0x16e9f7[_0x310621(0xeb2)]='';const _0x3badec={'role':'ai','content':_0x310621(0x1579),'timestamp':0x1,'senderName':_0x42dd04[_0x310621(0x1561)]},_0x1a0905=await _0xb42d69(_0x3badec,_0x42dd04);if(_0x1a0905)_0x16e9f7[_0x310621(0x983)](_0x1a0905);const _0x184699={'role':_0x310621(0x20d),'content':_0x310621(0x3dc),'timestamp':0x2},_0x3cf35d=await _0xb42d69(_0x184699,_0x42dd04);if(_0x3cf35d)_0x16e9f7[_0x310621(0x983)](_0x3cf35d);const _0x45095c=document['createElement'](_0x310621(0x8ca));_0x45095c[_0x310621(0x20f)]['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20absolute;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2011px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x202px\x206px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.1);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20white-space:\x20nowrap;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x45095c[_0x310621(0x766)]=_0x310621(0x1168),_0x16e9f7[_0x310621(0x983)](_0x45095c);const _0x1da349=document[_0x310621(0x9a3)](_0x310621(0x129c))['value'],_0x19eb8d=document[_0x310621(0x9a3)]('lyrics-horizontal-pos')[_0x310621(0x7b2)],_0x576643=parseInt(document[_0x310621(0x9a3)](_0x310621(0xbca))[_0x310621(0x7b2)])||0xa;_0x1da349===_0x310621(0xe8f)?_0x45095c[_0x310621(0x20f)][_0x310621(0xe8f)]=_0x576643+'px':_0x45095c[_0x310621(0x20f)][_0x310621(0x837)]=_0x576643+'px';switch(_0x19eb8d){case _0x310621(0xb90):_0x45095c[_0x310621(0x20f)][_0x310621(0xb90)]=_0x310621(0x5c2);break;case _0x310621(0x2a5):_0x45095c['style']['right']='15px';break;default:_0x45095c[_0x310621(0x20f)]['left']=_0x310621(0x429),_0x45095c[_0x310621(0x20f)]['transform']=_0x310621(0x40d);break;}_0x1253e3(_0x37af5d,'#settings-preview-area',_0x310621(0x2a8));}async function _0x443bd7(){const _0x4f7c83=_0x48bc6d;await _0x1042d5(),document[_0x4f7c83(0x9a3)](_0x4f7c83(0x795))[_0x4f7c83(0x4d8)][_0x4f7c83(0xe05)](_0x4f7c83(0xc09));}async function _0x1042d5(){const _0x1feef6=_0x48bc6d,_0x5a248e=document[_0x1feef6(0x9a3)]('existing-groups-list'),_0x4f877d=await _0x512070[_0x1feef6(0xad9)][_0x1feef6(0x591)]();_0x5a248e[_0x1feef6(0xeb2)]='',_0x4f877d['length']===0x0&&(_0x5a248e['innerHTML']=_0x1feef6(0x7b3)),_0x4f877d['forEach'](_0x2173c5=>{const _0x3e2f6c=_0x1feef6,_0x1e3b15=document[_0x3e2f6c(0xe94)](_0x3e2f6c(0x8ca));_0x1e3b15[_0x3e2f6c(0x1487)]=_0x3e2f6c(0x3bb),_0x1e3b15[_0x3e2f6c(0xeb2)]=_0x3e2f6c(0x1515)+_0x2173c5[_0x3e2f6c(0x1561)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0x2173c5['id']+_0x3e2f6c(0xd2e),_0x5a248e[_0x3e2f6c(0x983)](_0x1e3b15);});}async function _0x356016(){const _0x3adea1=_0x48bc6d,_0x210b31=document['getElementById'](_0x3adea1(0xd2c)),_0x1d7dbd=_0x210b31[_0x3adea1(0x7b2)]['trim']();if(!_0x1d7dbd){alert(_0x3adea1(0x7ac));return;}const _0x20089c=await _0x512070[_0x3adea1(0xad9)][_0x3adea1(0x1201)]('name')[_0x3adea1(0x5df)](_0x1d7dbd)[_0x3adea1(0x92c)]();if(_0x20089c){alert(_0x3adea1(0x1142)+_0x1d7dbd+'\x22\x20已经存在了，换个名字吧！');return;}await _0x512070[_0x3adea1(0xad9)]['add']({'name':_0x1d7dbd}),_0x210b31[_0x3adea1(0x7b2)]='',await _0x1042d5();}async function _0x5819e9(_0x44d4bb){const _0x533bb2=_0x48bc6d,_0x13e706=await _0x2c9509(_0x533bb2(0xd05),_0x533bb2(0x1382),{'confirmButtonClass':'btn-danger'});if(_0x13e706){await _0x512070[_0x533bb2(0xad9)][_0x533bb2(0x10a8)](_0x44d4bb);const _0x459b03=await _0x512070[_0x533bb2(0xb04)]['where'](_0x533bb2(0x4ab))[_0x533bb2(0x5df)](_0x44d4bb)[_0x533bb2(0x591)]();for(const _0x516e79 of _0x459b03){_0x516e79[_0x533bb2(0x4ab)]=null,await _0x512070['chats'][_0x533bb2(0xd4d)](_0x516e79);if(_0x19ddb8[_0x533bb2(0xb04)][_0x516e79['id']])_0x19ddb8[_0x533bb2(0xb04)][_0x516e79['id']]['groupId']=null;}await _0x1042d5();}}function _0x12c32b(_0x58331c){const _0xe651a9=_0x48bc6d,_0x4b3fec=_0x19ddb8[_0xe651a9(0xb04)][_0x19ddb8[_0xe651a9(0x859)]];document['getElementById'](_0xe651a9(0x8a5))[_0xe651a9(0x20f)][_0xe651a9(0x115d)]=_0x4b3fec['isGroup']?_0xe651a9(0x10c8):_0xe651a9(0x8e0);if(_0x164883)return;_0x5c6e51=_0x58331c,document[_0xe651a9(0x9a3)](_0xe651a9(0x400))['classList']['add']('visible');}function _0x1afb50(){const _0x2a5fcd=_0x48bc6d;document[_0x2a5fcd(0x9a3)](_0x2a5fcd(0x400))[_0x2a5fcd(0x4d8)][_0x2a5fcd(0x133d)](_0x2a5fcd(0xc09)),_0x5c6e51=null;}async function _0x203c9e(){const _0x2dbfd0=_0x48bc6d;if(!_0x5c6e51)return;const _0x103f63=_0x5c6e51,_0x316476=_0x19ddb8[_0x2dbfd0(0xb04)][_0x19ddb8[_0x2dbfd0(0x859)]],_0x1980e8=_0x316476['history']['find'](_0x59365b=>_0x59365b[_0x2dbfd0(0xd73)]===_0x103f63);if(!_0x1980e8)return;_0x1afb50();let _0xac379e;const _0x1221bc=_0x1980e8[_0x2dbfd0(0x1508)]&&[_0x2dbfd0(0x1207),_0x2dbfd0(0x1c1),_0x2dbfd0(0x4b3),'share_link']['includes'](_0x1980e8[_0x2dbfd0(0x1508)]);if(_0x1221bc){let _0x143c8d={'type':_0x1980e8[_0x2dbfd0(0x1508)]};if(_0x1980e8[_0x2dbfd0(0x1508)]===_0x2dbfd0(0x1207))_0x143c8d[_0x2dbfd0(0x4e3)]=_0x1980e8[_0x2dbfd0(0x4e3)];else{if(_0x1980e8[_0x2dbfd0(0x1508)]===_0x2dbfd0(0x1c1))_0x143c8d[_0x2dbfd0(0x3ef)]=_0x1980e8[_0x2dbfd0(0x4e3)];else{if(_0x1980e8[_0x2dbfd0(0x1508)]===_0x2dbfd0(0x4b3))_0x143c8d[_0x2dbfd0(0x11fa)]=_0x1980e8[_0x2dbfd0(0x11fa)],_0x143c8d['note']=_0x1980e8[_0x2dbfd0(0x1436)];else _0x1980e8['type']===_0x2dbfd0(0x721)&&(_0x143c8d[_0x2dbfd0(0x10b8)]=_0x1980e8[_0x2dbfd0(0x10b8)],_0x143c8d[_0x2dbfd0(0x3ef)]=_0x1980e8[_0x2dbfd0(0x3ef)],_0x143c8d[_0x2dbfd0(0xc48)]=_0x1980e8[_0x2dbfd0(0xc48)],_0x143c8d[_0x2dbfd0(0x4e3)]=_0x1980e8[_0x2dbfd0(0x4e3)]);}}_0xac379e=JSON['stringify'](_0x143c8d,null,0x2);}else typeof _0x1980e8['content']===_0x2dbfd0(0x12fe)?_0xac379e=JSON['stringify'](_0x1980e8[_0x2dbfd0(0x4e3)],null,0x2):_0xac379e=_0x1980e8['content'];const _0x2fea47={'voice':{'type':_0x2dbfd0(0x1207),'content':_0x2dbfd0(0xdb8)},'image':{'type':_0x2dbfd0(0x1c1),'description':_0x2dbfd0(0x3ca)},'transfer':{'type':_0x2dbfd0(0x4b3),'amount':5.2,'note':_0x2dbfd0(0xeaa)},'link':{'type':_0x2dbfd0(0x721),'title':_0x2dbfd0(0x290),'description':_0x2dbfd0(0x9e6),'source_name':_0x2dbfd0(0x35e),'content':_0x2dbfd0(0xce6)}},_0x5ec4d2=_0x2dbfd0(0x30e)+JSON[_0x2dbfd0(0xe1e)](_0x2fea47[_0x2dbfd0(0xdd9)])+_0x2dbfd0(0xcd5)+JSON[_0x2dbfd0(0xe1e)](_0x2fea47['image'])+_0x2dbfd0(0x782)+JSON[_0x2dbfd0(0xe1e)](_0x2fea47['transfer'])+_0x2dbfd0(0x99a)+JSON['stringify'](_0x2fea47[_0x2dbfd0(0x143a)])+_0x2dbfd0(0x131e),_0x1b074a=await _0x3ab788(_0x2dbfd0(0xe2d),_0x2dbfd0(0x804),_0xac379e,'textarea',_0x5ec4d2);_0x1b074a!==null&&await _0x4b719d(_0x103f63,_0x1b074a,!![]);}async function _0x364707(){const _0x13d647=_0x48bc6d;if(!_0x5c6e51)return;const _0x287be2=_0x19ddb8[_0x13d647(0xb04)][_0x19ddb8['activeChatId']],_0x31f5e2=_0x287be2[_0x13d647(0x1f0)][_0x13d647(0xd62)](_0x4187a1=>_0x4187a1[_0x13d647(0xd73)]===_0x5c6e51);if(!_0x31f5e2)return;let _0x12cd6a;typeof _0x31f5e2['content']===_0x13d647(0x12fe)?_0x12cd6a=JSON[_0x13d647(0xe1e)](_0x31f5e2[_0x13d647(0x4e3)]):_0x12cd6a=String(_0x31f5e2[_0x13d647(0x4e3)]);try{await navigator[_0x13d647(0x14be)][_0x13d647(0xc85)](_0x12cd6a),await _0x403a62(_0x13d647(0x13eb),'消息内容已复制到剪贴板。');}catch(_0x479a2c){await _0x403a62(_0x13d647(0x147d),_0x13d647(0x6be));}_0x1afb50();}async function _0x45a138(){const _0x883037=_0x48bc6d;if(!_0x5c6e51)return;try{await navigator[_0x883037(0x14be)][_0x883037(0xc85)](_0x5c6e51),await _0x403a62(_0x883037(0x13eb),'消息时间戳\x20'+_0x5c6e51+_0x883037(0xe35));}catch(_0x4bc94f){await _0x403a62(_0x883037(0x147d),_0x883037(0x6be));}_0x1afb50();}function _0x39dbdd(_0x8453e3=''){const _0x517cca=_0x48bc6d,_0x1d8a13=document['createElement'](_0x517cca(0x8ca));_0x1d8a13[_0x517cca(0x1487)]=_0x517cca(0x83a);const _0x1a77ec={'voice':{'type':_0x517cca(0x1207),'content':_0x517cca(0xdb8)},'image':{'type':_0x517cca(0x1c1),'description':_0x517cca(0x3ca)},'transfer':{'type':_0x517cca(0x4b3),'amount':5.2,'note':_0x517cca(0xeaa)},'link':{'type':_0x517cca(0x721),'title':_0x517cca(0x290),'description':_0x517cca(0x9e6),'source_name':_0x517cca(0x35e),'content':_0x517cca(0xce6)},'offline':{'type':'offline_text','content':'「在这里输入对话内容」\x0a(在这里输入动作或环境描写)'},'quote':{'type':_0x517cca(0xe7b),'target_timestamp':0x499602d2,'reply_content':_0x517cca(0xc5a)},'nai':{'type':_0x517cca(0x1300),'prompt':'1girl,\x20best\x20quality,\x20masterpiece,\x20...'}};return _0x1d8a13['innerHTML']=_0x517cca(0x329)+_0x8453e3+_0x517cca(0xf02)+JSON[_0x517cca(0xe1e)](_0x1a77ec[_0x517cca(0xdd9)])+_0x517cca(0x12e8)+JSON[_0x517cca(0xe1e)](_0x1a77ec[_0x517cca(0x547)])+_0x517cca(0x14a7)+JSON['stringify'](_0x1a77ec[_0x517cca(0x4b3)])+_0x517cca(0x141e)+JSON['stringify'](_0x1a77ec['link'])+_0x517cca(0x10ae)+JSON[_0x517cca(0xe1e)](_0x1a77ec['offline'])+_0x517cca(0x12f6)+JSON[_0x517cca(0xe1e)](_0x1a77ec[_0x517cca(0x6f7)])+_0x517cca(0x7c7)+JSON[_0x517cca(0xe1e)](_0x1a77ec[_0x517cca(0x1359)])+_0x517cca(0x4c0),_0x1d8a13[_0x517cca(0xc86)](_0x517cca(0xc45))[_0x517cca(0x954)](_0x517cca(0x9cc),()=>{const _0x52d0f7=_0x517cca;document[_0x52d0f7(0x131c)](_0x52d0f7(0x556))['length']>0x1?_0x1d8a13['remove']():alert(_0x52d0f7(0x1094));}),_0x1d8a13[_0x517cca(0x131c)](_0x517cca(0xaf4))[_0x517cca(0x15c1)](_0x1b4048=>{const _0x41cf57=_0x517cca;_0x1b4048[_0x41cf57(0x954)](_0x41cf57(0x9cc),()=>{const _0x2ecb4c=_0x41cf57,_0x6aa938=_0x1b4048['dataset'][_0x2ecb4c(0x10bc)],_0x5deb8e=_0x1d8a13[_0x2ecb4c(0xc86)](_0x2ecb4c(0x8db));if(_0x6aa938&&_0x5deb8e)try{const _0x5c4355=JSON['parse'](_0x6aa938);_0x5deb8e[_0x2ecb4c(0x7b2)]=JSON[_0x2ecb4c(0xe1e)](_0x5c4355,null,0x2),_0x5deb8e[_0x2ecb4c(0xdcf)]();}catch(_0x3c23fa){console[_0x2ecb4c(0x3b7)](_0x2ecb4c(0x403),_0x3c23fa);}});}),_0x1d8a13;}async function _0x3d9f94(){const _0x3745e7=_0x48bc6d;if(!_0x5c6e51)return;const _0x10defc=_0x5c6e51,_0x53d7f9=_0x19ddb8['chats'][_0x19ddb8[_0x3745e7(0x859)]],_0x5801ea=_0x53d7f9[_0x3745e7(0x1f0)][_0x3745e7(0xd62)](_0x1da03f=>_0x1da03f[_0x3745e7(0xd73)]===_0x10defc);if(!_0x5801ea)return;_0x1afb50();const _0x56d0e5=document['getElementById'](_0x3745e7(0x52a)),_0x1286c4=document[_0x3745e7(0x9a3)]('message-editor-container');_0x1286c4['innerHTML']='';let _0x34d03e;if(_0x5801ea['quote']){const _0x477b30={'type':'quote_reply','target_timestamp':_0x5801ea['quote']['timestamp'],'reply_content':_0x5801ea[_0x3745e7(0x4e3)]};_0x34d03e=JSON[_0x3745e7(0xe1e)](_0x477b30,null,0x2);}else{if(_0x5801ea[_0x3745e7(0x1508)]&&['voice_message',_0x3745e7(0x1c1),_0x3745e7(0x4b3),'offline_text',_0x3745e7(0x721),_0x3745e7(0x1300)][_0x3745e7(0x478)](_0x5801ea[_0x3745e7(0x1508)])){let _0x6c0871={'type':_0x5801ea[_0x3745e7(0x1508)]};if(_0x5801ea[_0x3745e7(0x1508)]===_0x3745e7(0x1207))_0x6c0871[_0x3745e7(0x4e3)]=_0x5801ea[_0x3745e7(0x4e3)];else{if(_0x5801ea['type']===_0x3745e7(0x1c1))_0x6c0871[_0x3745e7(0x3ef)]=_0x5801ea[_0x3745e7(0x4e3)];else{if(_0x5801ea[_0x3745e7(0x1508)]===_0x3745e7(0x4b3))_0x6c0871['amount']=_0x5801ea['amount'],_0x6c0871[_0x3745e7(0x1436)]=_0x5801ea[_0x3745e7(0x1436)];else{if(_0x5801ea[_0x3745e7(0x1508)]===_0x3745e7(0x12fb))_0x5801ea['content']?_0x6c0871[_0x3745e7(0x4e3)]=_0x5801ea[_0x3745e7(0x4e3)]:(_0x6c0871['dialogue']=_0x5801ea[_0x3745e7(0x103d)],_0x6c0871['description']=_0x5801ea['description']);else{if(_0x5801ea[_0x3745e7(0x1508)]===_0x3745e7(0x721))_0x6c0871[_0x3745e7(0x10b8)]=_0x5801ea[_0x3745e7(0x10b8)],_0x6c0871[_0x3745e7(0x3ef)]=_0x5801ea[_0x3745e7(0x3ef)],_0x6c0871['source_name']=_0x5801ea[_0x3745e7(0xc48)],_0x6c0871[_0x3745e7(0x4e3)]=_0x5801ea[_0x3745e7(0x4e3)];else _0x5801ea[_0x3745e7(0x1508)]===_0x3745e7(0x1300)&&(_0x6c0871[_0x3745e7(0x3a1)]=_0x5801ea[_0x3745e7(0x3a1)],_0x6c0871[_0x3745e7(0xbfe)]=_0x5801ea[_0x3745e7(0xbfe)],_0x6c0871[_0x3745e7(0x5d7)]=_0x5801ea[_0x3745e7(0x5d7)]);}}}}_0x34d03e=JSON[_0x3745e7(0xe1e)](_0x6c0871,null,0x2);}else typeof _0x5801ea['content']==='object'?_0x34d03e=JSON[_0x3745e7(0xe1e)](_0x5801ea['content'],null,0x2):_0x34d03e=_0x5801ea[_0x3745e7(0x4e3)];}const _0x2b26a1=_0x39dbdd(_0x34d03e);_0x1286c4[_0x3745e7(0x983)](_0x2b26a1);const _0x1b6f52=document[_0x3745e7(0x9a3)]('add-message-editor-block-btn'),_0x557219=_0x1b6f52[_0x3745e7(0x173)](!![]);_0x1b6f52['parentNode'][_0x3745e7(0x15ab)](_0x557219,_0x1b6f52),_0x557219[_0x3745e7(0x954)](_0x3745e7(0x9cc),()=>{const _0x37264d=_0x3745e7,_0x2e32af=_0x39dbdd();_0x1286c4[_0x37264d(0x983)](_0x2e32af),_0x2e32af[_0x37264d(0xc86)](_0x37264d(0x8db))[_0x37264d(0xdcf)]();});const _0x9a4e81=document[_0x3745e7(0x9a3)](_0x3745e7(0xaef)),_0x306b2f=_0x9a4e81[_0x3745e7(0x173)](!![]);_0x9a4e81[_0x3745e7(0x5eb)][_0x3745e7(0x15ab)](_0x306b2f,_0x9a4e81),_0x306b2f['addEventListener'](_0x3745e7(0x9cc),()=>{const _0x3ea70d=_0x3745e7;_0x56d0e5[_0x3ea70d(0x4d8)][_0x3ea70d(0x133d)]('visible');});const _0x4dbeca=document[_0x3745e7(0x9a3)](_0x3745e7(0x10b7)),_0x2ae4e1=_0x4dbeca[_0x3745e7(0x173)](!![]);_0x4dbeca['parentNode'][_0x3745e7(0x15ab)](_0x2ae4e1,_0x4dbeca),_0x2ae4e1['addEventListener'](_0x3745e7(0x9cc),()=>{_0x4b719d(_0x10defc);}),_0x56d0e5[_0x3745e7(0x4d8)]['add']('visible');}async function _0x364707(){const _0x55404c=_0x48bc6d;if(!_0x5c6e51)return;const _0x28fd0e=_0x19ddb8[_0x55404c(0xb04)][_0x19ddb8[_0x55404c(0x859)]],_0x17591a=_0x28fd0e['history'][_0x55404c(0xd62)](_0x1b563b=>_0x1b563b['timestamp']===_0x5c6e51);if(!_0x17591a)return;let _0xe186a8;if(_0x17591a[_0x55404c(0x1508)]===_0x55404c(0x12fb))_0x17591a['content']?_0xe186a8=_0x17591a[_0x55404c(0x4e3)]:_0xe186a8='「'+(_0x17591a[_0x55404c(0x103d)]||'')+'」\x0a'+(_0x17591a['description']||'');else typeof _0x17591a[_0x55404c(0x4e3)]===_0x55404c(0x12fe)?_0xe186a8=JSON[_0x55404c(0xe1e)](_0x17591a[_0x55404c(0x4e3)]):_0xe186a8=String(_0x17591a[_0x55404c(0x4e3)]);try{await navigator[_0x55404c(0x14be)]['writeText'](_0xe186a8),await _0x403a62('复制成功',_0x55404c(0xf40));}catch(_0x402ebc){await _0x403a62('复制失败',_0x55404c(0x6be));}_0x1afb50();}function _0x342a67(_0x3340b1){const _0x343c39=_0x48bc6d,_0x41b587=_0x3340b1[_0x343c39(0x13f9)]();if(_0x41b587['startsWith']('{')&&_0x41b587[_0x343c39(0xb5a)]('}'))try{const _0x1afbe3=JSON['parse'](_0x41b587);if(_0x1afbe3[_0x343c39(0x1508)])return _0x1afbe3;}catch(_0x47e3a9){}if(_0x115b0e[_0x343c39(0xddf)](_0x41b587))return{'type':_0x343c39(0xda8),'content':_0x41b587};return{'type':_0x343c39(0x13ca),'content':_0x41b587};}async function _0x4b719d(_0x1f8c73,_0x30355a=null){const _0x3ce419=_0x48bc6d;if(!_0x1f8c73)return;const _0x2b1e15=_0x19ddb8[_0x3ce419(0xb04)][_0x19ddb8['activeChatId']],_0x4df92e=_0x2b1e15[_0x3ce419(0x1f0)][_0x3ce419(0x455)](_0x2b2aeb=>_0x2b2aeb[_0x3ce419(0xd73)]===_0x1f8c73);if(_0x4df92e===-0x1)return;const _0x4c0bbb=_0x2b1e15[_0x3ce419(0x1f0)][_0x4df92e];let _0x120164=[];const _0x4c788a=_0x30355a!==null?[_0x30355a]:Array[_0x3ce419(0x1311)](document['querySelectorAll'](_0x3ce419(0xfda)))[_0x3ce419(0xb0a)](_0x4203ac=>_0x4203ac[_0x3ce419(0x7b2)]);for(const _0x4a3ef8 of _0x4c788a){if(!_0x4a3ef8[_0x3ce419(0x13f9)]())continue;const _0x2f990a=_0x342a67(_0x4a3ef8[_0x3ce419(0x13f9)]()),_0x10fab6={'role':_0x4c0bbb['role'],'senderName':_0x4c0bbb[_0x3ce419(0x1043)],'timestamp':_0x4c0bbb[_0x3ce419(0xd73)]};switch(_0x2f990a[_0x3ce419(0x1508)]){case'text':_0x10fab6[_0x3ce419(0x1508)]=_0x3ce419(0x13ca),_0x10fab6[_0x3ce419(0x4e3)]=_0x2f990a[_0x3ce419(0x4e3)];break;case _0x3ce419(0x12fb):_0x10fab6[_0x3ce419(0x1508)]=_0x3ce419(0x12fb);_0x2f990a[_0x3ce419(0x4e3)]?_0x10fab6[_0x3ce419(0x4e3)]=_0x2f990a['content']:(_0x10fab6[_0x3ce419(0x103d)]=_0x2f990a[_0x3ce419(0x103d)],_0x10fab6[_0x3ce419(0x3ef)]=_0x2f990a[_0x3ce419(0x3ef)]);break;case _0x3ce419(0xe7b):_0x10fab6[_0x3ce419(0x1508)]=_0x3ce419(0xe7b),_0x10fab6[_0x3ce419(0x4e3)]=_0x2f990a[_0x3ce419(0x69c)];const _0x3a4fbf=_0x2b1e15[_0x3ce419(0x1f0)][_0x3ce419(0xd62)](_0x4c0617=>_0x4c0617[_0x3ce419(0xd73)]===_0x2f990a[_0x3ce419(0xd4b)]);if(_0x3a4fbf){let _0x27c3f8=_0x3a4fbf['senderName'];_0x3a4fbf[_0x3ce419(0x11c1)]===_0x3ce419(0x20d)&&(_0x27c3f8=_0x19ddb8[_0x3ce419(0x9ce)]['nickname']||_0x3ce419(0x15c8)),_0x10fab6[_0x3ce419(0x6f7)]={'timestamp':_0x2f990a[_0x3ce419(0xd4b)],'senderName':_0x27c3f8,'content':String(_0x3a4fbf[_0x3ce419(0x4e3)]||'')};}else _0x10fab6['quote']={'timestamp':_0x2f990a[_0x3ce419(0xd4b)],'senderName':'未知用户','content':'原始消息已删除或不存在'};break;case _0x3ce419(0x1207):case _0x3ce419(0x1c1):case'user_photo':_0x10fab6['type']=_0x2f990a[_0x3ce419(0x1508)],_0x10fab6[_0x3ce419(0x4e3)]=_0x2f990a[_0x3ce419(0x4e3)]||_0x2f990a['description'];if(_0x2f990a[_0x3ce419(0x7da)])_0x10fab6[_0x3ce419(0x7da)]=_0x2f990a['meaning'];break;case _0x3ce419(0x1300):{const _0x32d6c2=_0x2b1e15['history'][_0x4df92e];let _0x5f168e=_0x2f990a[_0x3ce419(0x3a1)],_0x50231c=_0x2f990a[_0x3ce419(0xbfe)],_0x2593e8=_0x2f990a[_0x3ce419(0x5d7)],_0x3cd882=![];_0x5f168e&&typeof _0x5f168e===_0x3ce419(0x86c)&&_0x32d6c2[_0x3ce419(0x3a1)]!==_0x5f168e?_0x3cd882=!![]:(_0x5f168e=_0x32d6c2[_0x3ce419(0x3a1)],_0x2593e8=_0x32d6c2[_0x3ce419(0x5d7)],_0x50231c=_0x32d6c2[_0x3ce419(0xbfe)]);if(_0x3cd882){await _0x403a62(_0x3ce419(0x1395),_0x3ce419(0xffd));try{const _0x2b64f7=await _0x34bcbc(_0x5f168e,_0x2b1e15['id']);_0x50231c=_0x2b64f7['imageUrl'],_0x2593e8=_0x2b64f7[_0x3ce419(0x5d7)],await _0x403a62('成功',_0x3ce419(0x4f4));}catch(_0x184ad7){console[_0x3ce419(0x3b7)](_0x3ce419(0x10db),_0x184ad7),await _0x403a62(_0x3ce419(0x8e8),_0x3ce419(0x10df)+_0x184ad7['message']+'.\x20\x0a\x0a将保留旧图片，但提示词会更新。'),_0x50231c=_0x32d6c2['imageUrl'];}}_0x10fab6[_0x3ce419(0x1508)]=_0x3ce419(0x1300),_0x10fab6[_0x3ce419(0xbfe)]=_0x50231c,_0x10fab6[_0x3ce419(0x3a1)]=_0x5f168e,_0x10fab6[_0x3ce419(0x5d7)]=_0x2593e8;break;}case'sticker':{_0x10fab6['type']='sticker';let _0x1fda45=![];if(_0x2f990a[_0x3ce419(0x7da)]){const _0x297cbe=_0x19ddb8['userStickers'][_0x3ce419(0xd62)](_0x554196=>_0x554196['name']===_0x2f990a[_0x3ce419(0x7da)]);_0x297cbe?(_0x10fab6[_0x3ce419(0x4e3)]=_0x297cbe['url'],_0x10fab6['meaning']=_0x297cbe[_0x3ce419(0x1561)],console['log']('导演/编辑模式保存(Sticker):\x20使用了\x20meaning\x20查找'),_0x1fda45=!![]):(_0x10fab6['type']=_0x3ce419(0x13ca),_0x10fab6[_0x3ce419(0x4e3)]=_0x3ce419(0x22a)+_0x2f990a[_0x3ce419(0x7da)]+']',console[_0x3ce419(0x651)](_0x3ce419(0x389),_0x2f990a[_0x3ce419(0x7da)]),_0x1fda45=!![]);}if(!_0x1fda45&&_0x2f990a[_0x3ce419(0x121f)]){_0x10fab6[_0x3ce419(0x4e3)]=_0x2f990a[_0x3ce419(0x121f)];const _0x3100e8=_0x19ddb8[_0x3ce419(0x1557)][_0x3ce419(0xd62)](_0x347c20=>_0x347c20[_0x3ce419(0x121f)]===_0x2f990a[_0x3ce419(0x121f)]);if(_0x2f990a[_0x3ce419(0x7da)]&&(!_0x3100e8||_0x3100e8[_0x3ce419(0x1561)]===_0x2f990a[_0x3ce419(0x7da)]))_0x10fab6['meaning']=_0x2f990a[_0x3ce419(0x7da)];else _0x3100e8?_0x10fab6['meaning']=_0x3100e8['name']:_0x10fab6[_0x3ce419(0x7da)]='未知表情';console[_0x3ce419(0xe4d)](_0x3ce419(0xf08),_0x10fab6['meaning']),_0x1fda45=!![];}if(!_0x1fda45&&_0x2f990a[_0x3ce419(0x4e3)]&&typeof _0x2f990a[_0x3ce419(0x4e3)]===_0x3ce419(0x86c)&&_0x115b0e[_0x3ce419(0xddf)](_0x2f990a[_0x3ce419(0x4e3)])){_0x10fab6[_0x3ce419(0x4e3)]=_0x2f990a[_0x3ce419(0x4e3)];const _0xa22bbc=_0x19ddb8[_0x3ce419(0x1557)][_0x3ce419(0xd62)](_0x1da07b=>_0x1da07b[_0x3ce419(0x121f)]===_0x2f990a[_0x3ce419(0x4e3)]);_0x10fab6[_0x3ce419(0x7da)]=_0xa22bbc?_0xa22bbc[_0x3ce419(0x1561)]:_0x3ce419(0x7ec),console[_0x3ce419(0xe4d)]('导演/编辑模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:',_0x10fab6[_0x3ce419(0x7da)]),_0x1fda45=!![];}if(!_0x1fda45){console[_0x3ce419(0x3b7)]('导演/编辑模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):',_0x2f990a);continue;}break;}case _0x3ce419(0x4b3):_0x10fab6[_0x3ce419(0x1508)]=_0x3ce419(0x4b3),_0x10fab6[_0x3ce419(0x11fa)]=_0x2f990a[_0x3ce419(0x11fa)],_0x10fab6[_0x3ce419(0x1436)]=_0x2f990a[_0x3ce419(0x1436)];break;case _0x3ce419(0x721):_0x10fab6[_0x3ce419(0x1508)]=_0x3ce419(0x721),_0x10fab6['title']=_0x2f990a[_0x3ce419(0x10b8)],_0x10fab6[_0x3ce419(0x3ef)]=_0x2f990a[_0x3ce419(0x3ef)],_0x10fab6[_0x3ce419(0xc48)]=_0x2f990a[_0x3ce419(0xc48)],_0x10fab6['content']=_0x2f990a['content'];break;default:Object[_0x3ce419(0x8aa)](_0x10fab6,_0x2f990a);break;}_0x120164[_0x3ce419(0x1c4)](_0x10fab6);}if(_0x120164[_0x3ce419(0x106b)]===0x0){document[_0x3ce419(0x9a3)](_0x3ce419(0x52a))['classList'][_0x3ce419(0x133d)](_0x3ce419(0xc09));return;}_0x2b1e15[_0x3ce419(0x1f0)][_0x3ce419(0x15b0)](_0x4df92e,0x1,..._0x120164);let _0x5acdd5=_0x1f8c73;for(let _0x4e69e2=_0x4df92e;_0x4e69e2<_0x2b1e15[_0x3ce419(0x1f0)]['length'];_0x4e69e2++){_0x2b1e15[_0x3ce419(0x1f0)][_0x4e69e2][_0x3ce419(0xd73)]=_0x5acdd5,_0x5acdd5++;}await _0x512070[_0x3ce419(0xb04)]['put'](_0x2b1e15),document['getElementById']('message-editor-modal')[_0x3ce419(0x4d8)][_0x3ce419(0x133d)]('visible'),_0x56abd7(_0x19ddb8[_0x3ce419(0x859)]),await _0x403a62('成功',_0x3ce419(0x7f1));}function _0x3b1df2(_0x65261d){const _0xd311d6=_0x48bc6d;_0x36ea41=_0x65261d,document['getElementById'](_0xd311d6(0xd6f))[_0xd311d6(0x4d8)][_0xd311d6(0xe05)](_0xd311d6(0xc09));}function _0x2edc46(){const _0x5a103a=_0x48bc6d;document[_0x5a103a(0x9a3)]('post-actions-modal')[_0x5a103a(0x4d8)][_0x5a103a(0x133d)]('visible'),_0x36ea41=null;}async function _0x5e88ab(){const _0x3a8022=_0x48bc6d;if(!_0x36ea41)return;const _0x4e10ef=_0x36ea41,_0x401318=await _0x512070[_0x3a8022(0x10e5)][_0x3a8022(0x14ee)](_0x4e10ef);if(!_0x401318)return;_0x2edc46();let _0x49e9fb;if(_0x401318[_0x3a8022(0x1508)]===_0x3a8022(0x23d))_0x49e9fb=_0x401318[_0x3a8022(0x4e3)];else{const _0x21eb39={'type':_0x401318[_0x3a8022(0x1508)],'publicText':_0x401318[_0x3a8022(0x6b9)]||''};if(_0x401318['type']===_0x3a8022(0x1016))_0x21eb39[_0x3a8022(0xbfe)]=_0x401318[_0x3a8022(0xbfe)],_0x21eb39[_0x3a8022(0xbea)]=_0x401318[_0x3a8022(0xbea)];else _0x401318[_0x3a8022(0x1508)]==='text_image'&&(_0x21eb39[_0x3a8022(0x14bb)]=_0x401318[_0x3a8022(0x14bb)]);_0x49e9fb=JSON[_0x3a8022(0xe1e)](_0x21eb39,null,0x2);}const _0x307b6c={'shuoshuo':_0x3a8022(0xde1),'image':{'type':_0x3a8022(0x1016),'publicText':'','imageUrl':_0x3a8022(0xee7),'imageDescription':''},'text_image':{'type':_0x3a8022(0x1281),'publicText':'','hiddenContent':''}},_0xeb62f4=_0x3a8022(0x94b)+JSON['stringify'](_0x307b6c['image'])+_0x3a8022(0xe2a)+JSON[_0x3a8022(0xe1e)](_0x307b6c[_0x3a8022(0x1281)])+_0x3a8022(0x1414),_0x38576b=await _0x3ab788('编辑动态',_0x3a8022(0x4aa),_0x49e9fb,_0x3a8022(0x8db),_0xeb62f4);setTimeout(()=>{const _0xda609a=_0x3a8022,_0x47c0f5=document[_0xda609a(0xc86)](_0xda609a(0xa2d));_0x47c0f5&&_0x47c0f5[_0xda609a(0x954)](_0xda609a(0x9cc),()=>{const _0x5cb3e7=_0xda609a,_0x4981ea=document[_0x5cb3e7(0x9a3)](_0x5cb3e7(0x26f));_0x4981ea['value']=_0x307b6c['shuoshuo'],_0x4981ea[_0x5cb3e7(0xdcf)]();});},0x64),_0x38576b!==null&&await _0x51fe5f(_0x4e10ef,_0x38576b);}async function _0x51fe5f(_0x3c4d95,_0x20e6ee){const _0x4e65e1=_0x48bc6d,_0x47a704=await _0x512070[_0x4e65e1(0x10e5)][_0x4e65e1(0x14ee)](_0x3c4d95);if(!_0x47a704)return;const _0x52fd5b=_0x20e6ee[_0x4e65e1(0x13f9)]();try{const _0x4a3656=JSON[_0x4e65e1(0x1447)](_0x52fd5b);_0x47a704[_0x4e65e1(0x1508)]=_0x4a3656[_0x4e65e1(0x1508)]||_0x4e65e1(0x1016),_0x47a704['publicText']=_0x4a3656[_0x4e65e1(0x6b9)]||'',_0x47a704[_0x4e65e1(0xbfe)]=_0x4a3656[_0x4e65e1(0xbfe)]||'',_0x47a704[_0x4e65e1(0xbea)]=_0x4a3656[_0x4e65e1(0xbea)]||'',_0x47a704[_0x4e65e1(0x14bb)]=_0x4a3656[_0x4e65e1(0x14bb)]||'',_0x47a704[_0x4e65e1(0x4e3)]='';}catch(_0x11e807){_0x47a704[_0x4e65e1(0x1508)]=_0x4e65e1(0x23d),_0x47a704[_0x4e65e1(0x4e3)]=_0x52fd5b,_0x47a704['publicText']='',_0x47a704['imageUrl']='',_0x47a704[_0x4e65e1(0xbea)]='',_0x47a704['hiddenContent']='';}await _0x512070[_0x4e65e1(0x10e5)][_0x4e65e1(0xd4d)](_0x47a704),await _0x49acff(),await _0x403a62('成功',_0x4e65e1(0xa7c));}async function _0x526dce(){const _0x1ddf63=_0x48bc6d;if(!_0x36ea41)return;const _0x2e9171=await _0x512070[_0x1ddf63(0x10e5)][_0x1ddf63(0x14ee)](_0x36ea41);if(!_0x2e9171)return;let _0x1e1a2e=_0x2e9171[_0x1ddf63(0x4e3)]||_0x2e9171[_0x1ddf63(0x6b9)]||_0x2e9171['hiddenContent']||_0x2e9171['imageDescription']||_0x1ddf63(0xf78);try{await navigator['clipboard'][_0x1ddf63(0xc85)](_0x1e1a2e),await _0x403a62(_0x1ddf63(0x13eb),_0x1ddf63(0xbbe));}catch(_0x186323){await _0x403a62(_0x1ddf63(0x147d),_0x1ddf63(0x6be));}_0x2edc46();}let _0x1f63dc=new Set();async function _0x420fac(){const _0x12ff8c=_0x48bc6d,_0x1c7caf=await _0x49acac(_0x12ff8c(0xb6f),[{'text':_0x12ff8c(0x5e3),'value':_0x12ff8c(0x1283)},{'text':'创建旁观群聊\x20(我围观)','value':_0x12ff8c(0x13e8)}]);if(_0x1c7caf===_0x12ff8c(0x1283)){_0x1f63dc['clear']();const _0x1dc74a=document[_0x12ff8c(0x9a3)](_0x12ff8c(0xa4c)),_0x53eb75=_0x1dc74a[_0x12ff8c(0x173)](!![]);_0x1dc74a[_0x12ff8c(0x5eb)]['replaceChild'](_0x53eb75,_0x1dc74a),_0x53eb75['addEventListener'](_0x12ff8c(0x9cc),_0x17faae),await _0x42d8c0(),_0x35df44(_0x12ff8c(0x6c5));}else _0x1c7caf===_0x12ff8c(0x13e8)&&_0x1e4b3a();}async function _0x1e4b3a(){const _0x5bae65=_0x48bc6d;_0x1f63dc[_0x5bae65(0xe81)]();const _0x324e54=document[_0x5bae65(0x9a3)]('confirm-contact-picker-btn'),_0x5d6357=_0x324e54[_0x5bae65(0x173)](!![]);_0x324e54[_0x5bae65(0x5eb)][_0x5bae65(0x15ab)](_0x5d6357,_0x324e54),_0x5d6357['addEventListener']('click',_0x12c5de),await _0x7929da(),_0x35df44(_0x5bae65(0x6c5));}async function _0x7929da(){const _0x2ed0b9=_0x48bc6d,_0x22b35a=document[_0x2ed0b9(0x9a3)](_0x2ed0b9(0xecb));_0x22b35a[_0x2ed0b9(0xeb2)]='';const _0x2c67a7=Object[_0x2ed0b9(0xea1)](_0x19ddb8[_0x2ed0b9(0xb04)])[_0x2ed0b9(0x1195)](_0x29324e=>!_0x29324e[_0x2ed0b9(0x136b)]),_0x2934ad=await _0x512070[_0x2ed0b9(0x5b7)][_0x2ed0b9(0x591)]();if(_0x2c67a7[_0x2ed0b9(0x106b)]===0x0&&_0x2934ad[_0x2ed0b9(0x106b)]===0x0){_0x22b35a[_0x2ed0b9(0xeb2)]=_0x2ed0b9(0x762);return;}_0x2c67a7['forEach'](_0x27df3f=>{const _0x54ebfc=_0x2ed0b9,_0x94d697=document['createElement']('div');_0x94d697['className']=_0x54ebfc(0x5a1),_0x94d697[_0x54ebfc(0xd8d)][_0x54ebfc(0x1503)]=_0x27df3f['id'],_0x94d697[_0x54ebfc(0xeb2)]=_0x54ebfc(0x43b)+(_0x27df3f[_0x54ebfc(0x450)][_0x54ebfc(0x4fe)]||_0x4f81ff)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x27df3f[_0x54ebfc(0x1561)]+_0x54ebfc(0x7f4),_0x22b35a['appendChild'](_0x94d697);}),_0x2934ad[_0x2ed0b9(0x15c1)](_0x1db6fe=>{const _0x1a7494=_0x2ed0b9,_0xaf7744=document[_0x1a7494(0xe94)](_0x1a7494(0x8ca));_0xaf7744[_0x1a7494(0x1487)]='contact-picker-item',_0xaf7744[_0x1a7494(0xd8d)][_0x1a7494(0x1503)]=_0x1db6fe['id'],_0xaf7744[_0x1a7494(0xd8d)]['isNpc']=_0x1a7494(0x903),_0xaf7744[_0x1a7494(0xeb2)]=_0x1a7494(0x43b)+(_0x1db6fe[_0x1a7494(0xf3f)]||_0x451ae9)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x1db6fe['name']+'\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x22b35a[_0x1a7494(0x983)](_0xaf7744);}),_0xe76af();}async function _0x12c5de(){const _0x19a187=_0x48bc6d;if(_0x1f63dc[_0x19a187(0xbdf)]<0x2){alert(_0x19a187(0x7af));return;}const _0x2a60ab=await _0x3ab788('设置群名',_0x19a187(0x15c4),'AI们的茶话会');if(!_0x2a60ab||!_0x2a60ab['trim']())return;const _0x9d66c8=_0x19a187(0x4a9)+Date[_0x19a187(0x64b)](),_0x1f5d9d=[],_0x5b2321=await _0x512070['npcs']['toArray']();for(const _0x17ef77 of _0x1f63dc){const _0x1c20cb=document[_0x19a187(0xc86)](_0x19a187(0xc62)+_0x17ef77+'\x22]')[_0x19a187(0xd8d)][_0x19a187(0xd35)]===_0x19a187(0x903);if(_0x1c20cb){const _0x9cbf8c=_0x5b2321[_0x19a187(0xd62)](_0x2cfc5a=>_0x2cfc5a['id']===parseInt(_0x17ef77));_0x9cbf8c&&_0x1f5d9d[_0x19a187(0x1c4)]({'id':_0x19a187(0x136f)+_0x9cbf8c['id'],'originalName':_0x9cbf8c[_0x19a187(0x1561)],'groupNickname':_0x9cbf8c[_0x19a187(0x1561)],'persona':_0x9cbf8c['persona'],'avatar':_0x9cbf8c[_0x19a187(0xf3f)]||_0x451ae9,'isNpc':!![]});}else{const _0x6f39dd=_0x19ddb8[_0x19a187(0xb04)][_0x17ef77];_0x6f39dd&&_0x1f5d9d[_0x19a187(0x1c4)]({'id':_0x17ef77,'originalName':_0x6f39dd[_0x19a187(0x339)],'groupNickname':_0x6f39dd['name'],'persona':_0x6f39dd[_0x19a187(0x450)][_0x19a187(0x1c3)],'avatar':_0x6f39dd[_0x19a187(0x450)]['aiAvatar']||_0x4f81ff,'isNpc':![]});}}const _0x2f45dc={'id':_0x9d66c8,'name':_0x2a60ab[_0x19a187(0x13f9)](),'isGroup':!![],'isSpectatorGroup':!![],'members':_0x1f5d9d,'settings':{'maxMemory':0xa,'groupAvatar':_0xdb6252,'background':'','theme':_0x19a187(0xd5f),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[{'role':_0x19a187(0xe10),'content':_0x19a187(0x10b9),'timestamp':Date[_0x19a187(0x64b)](),'isHidden':!![]}],'musicData':{'totalTime':0x0}};_0x19ddb8['chats'][_0x9d66c8]=_0x2f45dc,await _0x512070['chats'][_0x19a187(0xd4d)](_0x2f45dc),await _0xec8072(),_0x35df44(_0x19a187(0xd7c)),_0x515d83(_0x9d66c8);}async function _0x42d8c0(){const _0x4b54e4=_0x48bc6d,_0x1a5bbb=document[_0x4b54e4(0x9a3)]('contact-picker-list');_0x1a5bbb[_0x4b54e4(0xeb2)]='';const _0x3352d3=Object[_0x4b54e4(0xea1)](_0x19ddb8[_0x4b54e4(0xb04)])['filter'](_0x474ea9=>!_0x474ea9[_0x4b54e4(0x136b)]),_0x51b911=await _0x512070['npcs'][_0x4b54e4(0x591)]();if(_0x3352d3[_0x4b54e4(0x106b)]===0x0&&_0x51b911[_0x4b54e4(0x106b)]===0x0){_0x1a5bbb[_0x4b54e4(0xeb2)]=_0x4b54e4(0x3bc);return;}_0x3352d3['forEach'](_0x9b25ce=>{const _0x3ae322=_0x4b54e4,_0x213ec2=document[_0x3ae322(0xe94)](_0x3ae322(0x8ca));_0x213ec2[_0x3ae322(0x1487)]=_0x3ae322(0x5a1),_0x213ec2[_0x3ae322(0xd8d)][_0x3ae322(0x1503)]=_0x9b25ce['id'],_0x213ec2[_0x3ae322(0xeb2)]=_0x3ae322(0x43b)+(_0x9b25ce['settings'][_0x3ae322(0x4fe)]||_0x4f81ff)+_0x3ae322(0x498)+_0x9b25ce[_0x3ae322(0x1561)]+_0x3ae322(0x7f4),_0x1a5bbb['appendChild'](_0x213ec2);}),_0x51b911['forEach'](_0x490fa6=>{const _0x5dbef4=_0x4b54e4,_0x24fc8d=document['createElement'](_0x5dbef4(0x8ca));_0x24fc8d[_0x5dbef4(0x1487)]=_0x5dbef4(0x5a1),_0x24fc8d['dataset'][_0x5dbef4(0x1503)]=_0x5dbef4(0x136f)+_0x490fa6['id'],_0x24fc8d[_0x5dbef4(0xeb2)]=_0x5dbef4(0x43b)+(_0x490fa6['avatar']||_0x451ae9)+_0x5dbef4(0x498)+_0x490fa6['name']+_0x5dbef4(0x13af),_0x1a5bbb[_0x5dbef4(0x983)](_0x24fc8d);}),_0xe76af();}function _0xe76af(){const _0x282254=_0x48bc6d,_0x10aedd=document[_0x282254(0x9a3)](_0x282254(0xa4c));_0x10aedd['textContent']='完成('+_0x1f63dc[_0x282254(0xbdf)]+')',_0x10aedd[_0x282254(0x15d3)]=_0x1f63dc[_0x282254(0xbdf)]<0x2;}async function _0x17faae(){const _0x541fbb=_0x48bc6d;if(_0x1f63dc[_0x541fbb(0xbdf)]<0x2){alert(_0x541fbb(0x15b3));return;}const _0x1294e6=await _0x3ab788(_0x541fbb(0x14e8),'请输入群聊的名字',_0x541fbb(0x6f5));if(!_0x1294e6||!_0x1294e6['trim']())return;const _0x4b0afe='group_'+Date[_0x541fbb(0x64b)](),_0x584069=[],_0x3b930a=await _0x512070[_0x541fbb(0x5b7)]['toArray']();for(const _0x1163e3 of _0x1f63dc){if(_0x1163e3['startsWith'](_0x541fbb(0x136f))){const _0x76395f=parseInt(_0x1163e3[_0x541fbb(0x1bb)](_0x541fbb(0x136f),'')),_0xf3af6f=_0x3b930a['find'](_0x3420df=>_0x3420df['id']===_0x76395f);_0xf3af6f&&_0x584069[_0x541fbb(0x1c4)]({'id':_0x1163e3,'originalName':_0xf3af6f[_0x541fbb(0x1561)],'groupNickname':_0xf3af6f[_0x541fbb(0x1561)],'persona':_0xf3af6f[_0x541fbb(0xcd4)],'avatar':_0xf3af6f[_0x541fbb(0xf3f)]||_0x451ae9,'isNpc':!![]});}else{const _0x5e7007=_0x19ddb8[_0x541fbb(0xb04)][_0x1163e3];_0x5e7007&&_0x584069[_0x541fbb(0x1c4)]({'id':_0x1163e3,'originalName':_0x5e7007['originalName'],'groupNickname':_0x5e7007[_0x541fbb(0x1561)],'persona':_0x5e7007[_0x541fbb(0x450)][_0x541fbb(0x1c3)],'avatar':_0x5e7007[_0x541fbb(0x450)][_0x541fbb(0x4fe)]||_0x4f81ff,'isNpc':![]});}}const _0x1a3a59={'id':_0x4b0afe,'name':_0x1294e6[_0x541fbb(0x13f9)](),'isGroup':!![],'members':_0x584069,'settings':{'myPersona':'我是谁呀。','myNickname':'我','maxMemory':0xa,'groupAvatar':_0xdb6252,'myAvatar':_0xde5144,'background':'','theme':_0x541fbb(0xd5f),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[],'musicData':{'totalTime':0x0}};_0x19ddb8[_0x541fbb(0xb04)][_0x4b0afe]=_0x1a3a59,await _0x512070[_0x541fbb(0xb04)][_0x541fbb(0xd4d)](_0x1a3a59),await _0xec8072(),_0x35df44(_0x541fbb(0xd7c)),_0x515d83(_0x4b0afe);}function _0x2723dc(){const _0x3f27af=_0x48bc6d;if(!_0x19ddb8['activeChatId']||!_0x19ddb8[_0x3f27af(0xb04)][_0x19ddb8[_0x3f27af(0x859)]][_0x3f27af(0x136b)])return;_0x5f31cd(),_0x35df44(_0x3f27af(0x687));}function _0x5f31cd(){const _0x53431e=_0x48bc6d,_0x318cca=document[_0x53431e(0x9a3)](_0x53431e(0x723)),_0x1f8247=_0x19ddb8[_0x53431e(0xb04)][_0x19ddb8['activeChatId']];_0x318cca[_0x53431e(0xeb2)]='',_0x1f8247[_0x53431e(0xcca)][_0x53431e(0x15c1)](_0x98e575=>{const _0xb339e=_0x53431e,_0x30216a=document[_0xb339e(0xe94)](_0xb339e(0x8ca));_0x30216a[_0xb339e(0x1487)]='member-management-item',_0x30216a[_0xb339e(0xeb2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x98e575[_0xb339e(0xf3f)]+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x98e575[_0xb339e(0xaf0)]+_0xb339e(0x1077)+_0x98e575['id']+_0xb339e(0x989),_0x318cca['appendChild'](_0x30216a);});}async function _0x28e187(_0x4ef3cb){const _0x3bfe5c=_0x48bc6d,_0x440976=_0x19ddb8[_0x3bfe5c(0xb04)][_0x19ddb8[_0x3bfe5c(0x859)]],_0x2f6911=_0x440976['members'][_0x3bfe5c(0x455)](_0x2db110=>_0x2db110['id']===_0x4ef3cb);if(_0x2f6911===-0x1)return;if(_0x440976[_0x3bfe5c(0xcca)][_0x3bfe5c(0x106b)]<=0x2){alert(_0x3bfe5c(0x1229));return;}const _0x4e3ad2=_0x440976[_0x3bfe5c(0xcca)][_0x2f6911][_0x3bfe5c(0xaf0)],_0x25555f=await _0x2c9509(_0x3bfe5c(0xf8f),_0x3bfe5c(0x1075)+_0x4e3ad2+_0x3bfe5c(0x15d0),{'confirmButtonClass':'btn-danger'});_0x25555f&&(_0x440976[_0x3bfe5c(0xcca)][_0x3bfe5c(0x15b0)](_0x2f6911,0x1),await _0x512070['chats'][_0x3bfe5c(0xd4d)](_0x440976),_0x5f31cd(),document['getElementById'](_0x3bfe5c(0x1417))['click']());}async function _0x1707ba(){const _0x344205=_0x48bc6d,_0x116729=document[_0x344205(0x9a3)](_0x344205(0xa4c)),_0x5c9054=_0x116729[_0x344205(0x173)](!![]);_0x116729[_0x344205(0x5eb)][_0x344205(0x15ab)](_0x5c9054,_0x116729),_0x5c9054['addEventListener'](_0x344205(0x9cc),_0x5a7ea7),await _0xab506a(),_0x35df44(_0x344205(0x6c5));}async function _0xab506a(){const _0x1e531a=_0x48bc6d,_0x4d1128=document['getElementById']('contact-picker-list');_0x4d1128[_0x1e531a(0xeb2)]='',_0x1f63dc['clear']();const _0x1db0f5=_0x19ddb8[_0x1e531a(0xb04)][_0x19ddb8['activeChatId']],_0x3a7ec9=new Set(_0x1db0f5['members'][_0x1e531a(0xb0a)](_0x3d2469=>_0x3d2469['id'])),_0x2149b0=Object['values'](_0x19ddb8[_0x1e531a(0xb04)])['filter'](_0x4e45fc=>!_0x4e45fc[_0x1e531a(0x136b)]&&!_0x3a7ec9[_0x1e531a(0x1472)](_0x4e45fc['id'])),_0x2f494c=(await _0x512070[_0x1e531a(0x5b7)][_0x1e531a(0x591)]())[_0x1e531a(0x1195)](_0x579e17=>!_0x3a7ec9[_0x1e531a(0x1472)](_0x1e531a(0x136f)+_0x579e17['id']));_0x2149b0[_0x1e531a(0x106b)]===0x0&&_0x2f494c[_0x1e531a(0x106b)]===0x0?(_0x4d1128[_0x1e531a(0xeb2)]=_0x1e531a(0x14a8),document['getElementById'](_0x1e531a(0xa4c))[_0x1e531a(0x20f)][_0x1e531a(0x115d)]='none'):(document[_0x1e531a(0x9a3)](_0x1e531a(0xa4c))['style'][_0x1e531a(0x115d)]='block',_0x2149b0[_0x1e531a(0x15c1)](_0x2a48da=>{const _0x2c8be0=_0x1e531a,_0x511f25=document['createElement'](_0x2c8be0(0x8ca));_0x511f25['className']=_0x2c8be0(0x5a1),_0x511f25[_0x2c8be0(0xd8d)][_0x2c8be0(0x1503)]=_0x2a48da['id'],_0x511f25['dataset']['contactType']=_0x2c8be0(0xb44),_0x511f25[_0x2c8be0(0xeb2)]=_0x2c8be0(0x289)+(_0x2a48da[_0x2c8be0(0x450)][_0x2c8be0(0x4fe)]||_0x4f81ff)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x2a48da[_0x2c8be0(0x1561)]+_0x2c8be0(0x724),_0x4d1128['appendChild'](_0x511f25);}),_0x2f494c[_0x1e531a(0x15c1)](_0x2474d9=>{const _0x4cb3d2=_0x1e531a,_0x48b227=document['createElement']('div');_0x48b227[_0x4cb3d2(0x1487)]='contact-picker-item',_0x48b227[_0x4cb3d2(0xd8d)]['contactId']=_0x4cb3d2(0x136f)+_0x2474d9['id'],_0x48b227[_0x4cb3d2(0xd8d)]['contactType']=_0x4cb3d2(0x9fe),_0x48b227[_0x4cb3d2(0xd8d)][_0x4cb3d2(0x11f8)]=_0x2474d9['id'],_0x48b227[_0x4cb3d2(0xeb2)]=_0x4cb3d2(0x289)+(_0x2474d9[_0x4cb3d2(0xf3f)]||_0x451ae9)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x2474d9['name']+'\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4d1128[_0x4cb3d2(0x983)](_0x48b227);})),_0xe76af();}async function _0x5a7ea7(){const _0x5ef7b8=_0x48bc6d;if(_0x1f63dc[_0x5ef7b8(0xbdf)]===0x0){alert('请至少选择一个要添加的联系人。');return;}const _0x460269=_0x19ddb8['chats'][_0x19ddb8['activeChatId']],_0xa4a2a9=await _0x512070['npcs']['toArray']();for(const _0x17c2e1 of _0x1f63dc){const _0x267bde=document[_0x5ef7b8(0xc86)]('.contact-picker-item[data-contact-id=\x22'+_0x17c2e1+'\x22]');if(!_0x267bde)continue;const _0x2b584d=_0x267bde[_0x5ef7b8(0xd8d)]['contactType'];if(_0x2b584d===_0x5ef7b8(0xb44)){const _0x5980e2=_0x19ddb8[_0x5ef7b8(0xb04)][_0x17c2e1];_0x5980e2&&_0x460269[_0x5ef7b8(0xcca)][_0x5ef7b8(0x1c4)]({'id':_0x17c2e1,'originalName':_0x5980e2[_0x5ef7b8(0x339)],'groupNickname':_0x5980e2[_0x5ef7b8(0x1561)],'persona':_0x5980e2[_0x5ef7b8(0x450)]['aiPersona'],'avatar':_0x5980e2[_0x5ef7b8(0x450)][_0x5ef7b8(0x4fe)]||_0x4f81ff,'isNpc':![]});}else{if(_0x2b584d==='npc'){const _0x3c03a0=parseInt(_0x267bde[_0x5ef7b8(0xd8d)][_0x5ef7b8(0x11f8)]),_0x5a45e5=_0xa4a2a9[_0x5ef7b8(0xd62)](_0x8dd8f5=>_0x8dd8f5['id']===_0x3c03a0);_0x5a45e5&&_0x460269[_0x5ef7b8(0xcca)][_0x5ef7b8(0x1c4)]({'id':'npc_'+_0x3c03a0,'originalName':_0x5a45e5[_0x5ef7b8(0x1561)],'groupNickname':_0x5a45e5[_0x5ef7b8(0x1561)],'persona':_0x5a45e5[_0x5ef7b8(0xcd4)],'avatar':_0x5a45e5[_0x5ef7b8(0xf3f)]||_0x451ae9,'isNpc':!![]});}}}await _0x512070[_0x5ef7b8(0xb04)]['put'](_0x460269),_0x2723dc();}function _0x263778(){_0x53547f=!![],_0x21c6bf(null);}function _0x3f2dec(_0x261223,_0x3185fc){const _0x51d1b0=setInterval(()=>{const _0x4a4f0c=_0x1efc,_0x32e560=Date['now'](),_0x37d5b1=_0x3185fc-_0x32e560;if(_0x37d5b1<0x0){clearInterval(_0x51d1b0),_0x261223[_0x4a4f0c(0xeb2)]=_0x4a4f0c(0x145e);return;}const _0x57dba4=Math[_0x4a4f0c(0xd95)](_0x37d5b1%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x5bdbb8=Math[_0x4a4f0c(0xd95)](_0x37d5b1%(0x3e8*0x3c)/0x3e8),_0x2b5152=String(_0x57dba4)[_0x4a4f0c(0x1488)](0x2,'0'),_0x72037b=String(_0x5bdbb8)[_0x4a4f0c(0x1488)](0x2,'0');_0x261223[_0x4a4f0c(0xeb2)]=_0x4a4f0c(0x106d)+_0x2b5152[_0x4a4f0c(0xf47)](0x0)+_0x4a4f0c(0x4b8)+_0x2b5152[_0x4a4f0c(0xf47)](0x1)+_0x4a4f0c(0x70a)+_0x72037b[_0x4a4f0c(0xf47)](0x0)+'</span><span>'+_0x72037b['charAt'](0x1)+_0x4a4f0c(0xeb1);},0x3e8);return _0x51d1b0;}function _0x10b9c4(){for(const _0x357ab6 in _0x140400){clearInterval(_0x140400[_0x357ab6]);}_0x140400={};}async function _0x20d5fa(_0x51729d){const _0x201006=_0x48bc6d,_0x369f0a=_0x19ddb8[_0x201006(0xb04)][_0x19ddb8[_0x201006(0x859)]];if(!_0x369f0a)return;const _0x50a80b=_0x369f0a['history'][_0x201006(0xd62)](_0x41001e=>_0x41001e['timestamp']===_0x51729d);if(!_0x50a80b||![_0x201006(0x12ec),_0x201006(0xaf6)]['includes'](_0x50a80b[_0x201006(0x1508)])){console[_0x201006(0x3b7)](_0x201006(0xad7),_0x51729d);return;}let _0x133807='';if(_0x50a80b[_0x201006(0x1508)]==='waimai_request'){let _0x2b8a01;switch(_0x50a80b[_0x201006(0x27d)]){case _0x201006(0x82e):const _0x1b5fcc=_0x50a80b[_0x201006(0x1588)]||'对方',_0x150f50=_0x1e2056(_0x369f0a,_0x1b5fcc);_0x2b8a01='由\x20'+_0x150f50+_0x201006(0x126c);break;case _0x201006(0x17a):_0x2b8a01=_0x201006(0x108f);break;default:_0x2b8a01=_0x201006(0x1dc);break;}_0x133807='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20'+_0x50a80b[_0x201006(0xd97)]+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥'+Number(_0x50a80b[_0x201006(0x11fa)])[_0x201006(0x1322)](0x2)+_0x201006(0x13d3)+_0x2b8a01+_0x201006(0x318);}else{if(_0x50a80b[_0x201006(0x1508)]===_0x201006(0xaf6)){let _0x5b70a0,_0x2dab1b;_0x369f0a[_0x201006(0x136b)]?(_0x5b70a0=_0x1e2056(_0x369f0a,_0x50a80b['senderName']),_0x2dab1b=_0x1e2056(_0x369f0a,_0x50a80b[_0x201006(0xa6b)])):_0x50a80b[_0x201006(0x11c1)]==='user'?(_0x5b70a0=_0x369f0a[_0x201006(0x450)][_0x201006(0x1555)]||'我',_0x2dab1b=_0x369f0a[_0x201006(0x1561)]):(_0x5b70a0=_0x369f0a['name'],_0x2dab1b=_0x369f0a['settings'][_0x201006(0x1555)]||'我'),_0x133807=_0x201006(0x639)+_0x5b70a0+_0x201006(0x9b2)+_0x2dab1b+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20'+_0x50a80b[_0x201006(0xd97)]+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥'+Number(_0x50a80b[_0x201006(0x11fa)])[_0x201006(0x1322)](0x2)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}await _0x403a62(_0x201006(0xbee),_0x133807);}async function _0x32a338(_0x44c542,_0x335d47){const _0x124198=_0x48bc6d,_0x155293=_0x19ddb8[_0x124198(0xb04)][_0x19ddb8[_0x124198(0x859)]];if(!_0x155293)return;const _0x3ecacf=_0x155293['history'][_0x124198(0x455)](_0x225a48=>_0x225a48[_0x124198(0xd73)]===_0x44c542);if(_0x3ecacf===-0x1)return;const _0x22a659=_0x155293['history'][_0x3ecacf];_0x22a659[_0x124198(0x27d)]=_0x335d47;let _0x177e7e;const _0x21943f=_0x155293[_0x124198(0x136b)]?_0x155293[_0x124198(0x450)][_0x124198(0x1555)]||'我':'我';_0x335d47===_0x124198(0x82e)?(_0x22a659[_0x124198(0x1588)]=_0x21943f,_0x177e7e=_0x124198(0x325)+_0x21943f+')\x20为\x20'+_0x22a659[_0x124198(0x1043)]+_0x124198(0xd0a)+_0x44c542+_0x124198(0x31b)):_0x177e7e='[系统提示：你\x20('+_0x21943f+')\x20拒绝了\x20'+_0x22a659[_0x124198(0x1043)]+_0x124198(0xa0b)+_0x44c542+_0x124198(0x8d9);const _0x58a579={'role':_0x124198(0xe10),'content':_0x177e7e,'timestamp':Date[_0x124198(0x64b)](),'isHidden':!![]};_0x155293[_0x124198(0x1f0)][_0x124198(0x1c4)](_0x58a579),await _0x512070[_0x124198(0xb04)][_0x124198(0xd4d)](_0x155293),_0x56abd7(_0x19ddb8['activeChatId']);}let _0x4acdaf={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x5e693e=null;async function _0x48a002(){const _0x57b615=_0x48bc6d;if(!_0x19ddb8['activeChatId']||_0x4acdaf[_0x57b615(0x1412)]||_0x4acdaf[_0x57b615(0x62c)])return;const _0x14632e=_0x19ddb8[_0x57b615(0xb04)][_0x19ddb8[_0x57b615(0x859)]];_0x4acdaf[_0x57b615(0x6a0)]=_0x14632e[_0x57b615(0x136b)],_0x4acdaf[_0x57b615(0x62c)]=!![],_0x4acdaf['initiator']=_0x57b615(0x20d),_0x4acdaf[_0x57b615(0x859)]=_0x14632e['id'],_0x4acdaf[_0x57b615(0xec1)]=!![];_0x14632e[_0x57b615(0x136b)]?(document[_0x57b615(0x9a3)]('outgoing-call-avatar')[_0x57b615(0x10d4)]=_0x14632e[_0x57b615(0x450)][_0x57b615(0x1af)]||_0xde5144,document[_0x57b615(0x9a3)](_0x57b615(0x13c7))[_0x57b615(0x766)]=_0x14632e['settings'][_0x57b615(0x1555)]||'我'):(document[_0x57b615(0x9a3)](_0x57b615(0xfcc))[_0x57b615(0x10d4)]=_0x14632e['settings'][_0x57b615(0x4fe)]||_0x4f81ff,document[_0x57b615(0x9a3)](_0x57b615(0x13c7))['textContent']=_0x14632e['name']);document[_0x57b615(0xc86)]('#outgoing-call-screen\x20.caller-text')[_0x57b615(0x766)]=_0x14632e['isGroup']?_0x57b615(0xab2):_0x57b615(0x48b),_0x35df44('outgoing-call-screen');const _0x484ce4={'role':_0x57b615(0xe10),'content':_0x14632e['isGroup']?_0x57b615(0xb12)+(_0x14632e[_0x57b615(0x450)][_0x57b615(0x1555)]||'我')+')\x20发起了群视频通话请求。请你们各自决策，并使用\x20\x22group_call_response\x22\x20指令，设置\x20\x22decision\x22\x20为\x20\x22join\x22\x20或\x20\x22decline\x22\x20来回应。]':_0x57b615(0x14a6),'timestamp':Date['now'](),'isHidden':!![]};_0x14632e[_0x57b615(0x1f0)][_0x57b615(0x1c4)](_0x484ce4),await _0x512070[_0x57b615(0xb04)][_0x57b615(0xd4d)](_0x14632e),await _0x55bf11();}function _0x1e2a5c(){const _0x52e158=_0x48bc6d,_0x225254=_0x19ddb8[_0x52e158(0xb04)][_0x4acdaf[_0x52e158(0x859)]];if(!_0x225254)return;_0x4acdaf[_0x52e158(0x1412)]=!![],_0x4acdaf[_0x52e158(0x62c)]=![],_0x4acdaf['startTime']=Date[_0x52e158(0x64b)](),_0x4acdaf[_0x52e158(0xd00)]=[];const _0x79d11e=_0x225254[_0x52e158(0x1f0)][_0x52e158(0x457)](-0xa);_0x4acdaf[_0x52e158(0xaa6)]=_0x79d11e['map'](_0x53b47f=>{const _0x3f8df0=_0x52e158,_0x3cc39e=_0x53b47f[_0x3f8df0(0x11c1)]==='user'?_0x225254[_0x3f8df0(0x450)][_0x3f8df0(0x1555)]||'我':_0x53b47f[_0x3f8df0(0x1043)]||_0x225254['name'];return _0x3cc39e+':\x20'+String(_0x53b47f[_0x3f8df0(0x4e3)])[_0x3f8df0(0x72e)](0x0,0x32)+_0x3f8df0(0x4a5);})[_0x52e158(0x3b9)]('\x0a'),_0x233fe2(),document[_0x52e158(0x9a3)](_0x52e158(0xeb7))[_0x52e158(0xeb2)]=_0x52e158(0x84e)+(_0x4acdaf['isGroupCall']?_0x52e158(0xa77):_0x52e158(0x1527))+_0x52e158(0x5d6),_0x35df44(_0x52e158(0xbe6)),document['getElementById'](_0x52e158(0x139e))['style'][_0x52e158(0x115d)]=_0x4acdaf[_0x52e158(0xec1)]?_0x52e158(0x10c8):_0x52e158(0x8e0),document['getElementById']('join-call-btn')[_0x52e158(0x20f)][_0x52e158(0x115d)]=_0x4acdaf[_0x52e158(0xec1)]?_0x52e158(0x8e0):_0x52e158(0x10c8);if(_0x5e693e)clearInterval(_0x5e693e);_0x5e693e=setInterval(_0x31e232,0x3e8),_0x31e232(),_0x4d3853();}async function _0x1df58e(){const _0x20fa9e=_0x48bc6d;if(!_0x4acdaf[_0x20fa9e(0x1412)])return;const _0x285266=Math['floor']((Date[_0x20fa9e(0x64b)]()-_0x4acdaf[_0x20fa9e(0x979)])/0x3e8),_0x3a28da=Math[_0x20fa9e(0xd95)](_0x285266/0x3c)+'分'+_0x285266%0x3c+'秒',_0x53d7f4='通话结束，时长\x20'+_0x3a28da,_0x4e2ecc=_0x19ddb8[_0x20fa9e(0xb04)][_0x4acdaf[_0x20fa9e(0x859)]];if(_0x4e2ecc){const _0x1e8e5f=[];_0x4acdaf['isGroupCall']?(_0x4acdaf[_0x20fa9e(0x9d3)]['forEach'](_0x10571c=>_0x1e8e5f[_0x20fa9e(0x1c4)]({'name':_0x10571c['originalName'],'avatar':_0x10571c['avatar']})),_0x4acdaf[_0x20fa9e(0xec1)]&&_0x1e8e5f[_0x20fa9e(0x5bf)]({'name':_0x4e2ecc['settings'][_0x20fa9e(0x1555)]||'我','avatar':_0x4e2ecc[_0x20fa9e(0x450)][_0x20fa9e(0x1af)]||_0xde5144})):(_0x1e8e5f[_0x20fa9e(0x1c4)]({'name':_0x4e2ecc[_0x20fa9e(0x1561)],'avatar':_0x4e2ecc[_0x20fa9e(0x450)][_0x20fa9e(0x4fe)]||_0x4f81ff}),_0x1e8e5f[_0x20fa9e(0x5bf)]({'name':'我','avatar':_0x4e2ecc[_0x20fa9e(0x450)][_0x20fa9e(0x1af)]||_0x4f81ff}));const _0x4e2e21={'chatId':_0x4acdaf['activeChatId'],'timestamp':Date[_0x20fa9e(0x64b)](),'duration':_0x285266,'participants':_0x1e8e5f,'transcript':[..._0x4acdaf[_0x20fa9e(0xd00)]]};await _0x512070['callRecords']['add'](_0x4e2e21),console[_0x20fa9e(0xe4d)](_0x20fa9e(0x9a7),_0x4e2e21);let _0xd51a80={'role':_0x4acdaf[_0x20fa9e(0x7d0)]==='user'?_0x20fa9e(0x20d):_0x20fa9e(0x115c),'content':_0x53d7f4,'timestamp':Date[_0x20fa9e(0x64b)]()};_0x4e2ecc[_0x20fa9e(0x136b)]&&_0xd51a80[_0x20fa9e(0x11c1)]===_0x20fa9e(0x115c)&&(_0xd51a80[_0x20fa9e(0x1043)]=_0x4acdaf['callRequester']||_0x4e2ecc['members'][0x0]?.[_0x20fa9e(0x339)]||_0x4e2ecc[_0x20fa9e(0x1561)]);_0x4e2ecc['history'][_0x20fa9e(0x1c4)](_0xd51a80);const _0xdb280b=_0x4acdaf[_0x20fa9e(0xd00)][_0x20fa9e(0xb0a)](_0x59d4c4=>{const _0x5c54ea=_0x20fa9e,_0x1a78ed=_0x59d4c4['role']===_0x5c54ea(0x20d)?_0x4e2ecc[_0x5c54ea(0x450)][_0x5c54ea(0x1555)]||'我':_0x59d4c4['senderName'];return _0x1a78ed+':\x20'+_0x59d4c4[_0x5c54ea(0x4e3)];})[_0x20fa9e(0x3b9)]('\x0a');_0xba159(_0x4e2ecc['id'],_0xdb280b);const _0x401c10={'role':_0x20fa9e(0xe10),'content':_0x20fa9e(0x78e),'timestamp':Date[_0x20fa9e(0x64b)]()+0x1,'isHidden':!![]};_0x4e2ecc[_0x20fa9e(0x1f0)][_0x20fa9e(0x1c4)](_0x401c10),await _0x512070['chats'][_0x20fa9e(0xd4d)](_0x4e2ecc);}clearInterval(_0x5e693e),_0x5e693e=null,_0x4acdaf={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x4e2ecc&&(_0x515d83(_0x4e2ecc['id']),_0x55bf11());}function _0x233fe2(){const _0x383491=_0x48bc6d,_0x104a25=document[_0x383491(0x9a3)](_0x383491(0x1015));_0x104a25[_0x383491(0xeb2)]='';const _0x36c0df=_0x19ddb8['chats'][_0x4acdaf[_0x383491(0x859)]];if(!_0x36c0df)return;let _0x279018=[];_0x4acdaf[_0x383491(0x6a0)]?(_0x279018=[..._0x4acdaf[_0x383491(0x9d3)]],_0x4acdaf[_0x383491(0xec1)]&&_0x279018[_0x383491(0x5bf)]({'id':_0x383491(0x20d),'name':_0x36c0df[_0x383491(0x450)][_0x383491(0x1555)]||'我','avatar':_0x36c0df[_0x383491(0x450)]['myAvatar']||_0xde5144})):_0x279018['push']({'id':'ai','name':_0x36c0df[_0x383491(0x1561)],'avatar':_0x36c0df['settings'][_0x383491(0x4fe)]||_0x4f81ff}),_0x279018['forEach'](_0xae25a=>{const _0x2c9b8d=_0x383491,_0x11e558=document[_0x2c9b8d(0xe94)](_0x2c9b8d(0x8ca));_0x11e558['className']=_0x2c9b8d(0x145f),_0x11e558[_0x2c9b8d(0xd8d)][_0x2c9b8d(0x699)]=_0xae25a['id'];const _0x3a61cb=_0xae25a[_0x2c9b8d(0xaf0)]||_0xae25a[_0x2c9b8d(0x1561)];_0x11e558[_0x2c9b8d(0xeb2)]=_0x2c9b8d(0x13ff)+_0xae25a[_0x2c9b8d(0xf3f)]+_0x2c9b8d(0xdf3)+_0x3a61cb+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participant-name\x22>'+_0x3a61cb+_0x2c9b8d(0xa8e),_0x104a25['appendChild'](_0x11e558);});}function _0x2803e3(){const _0x2a2401=_0x48bc6d;if(!_0x4acdaf[_0x2a2401(0x1412)]||_0x4acdaf[_0x2a2401(0xec1)])return;_0x4acdaf[_0x2a2401(0xec1)]=!![],_0x233fe2(),document[_0x2a2401(0x9a3)](_0x2a2401(0x139e))['style'][_0x2a2401(0x115d)]='block',document[_0x2a2401(0x9a3)](_0x2a2401(0x2a7))['style'][_0x2a2401(0x115d)]=_0x2a2401(0x8e0),_0x4d3853(_0x2a2401(0x137a));}function _0x31e232(){const _0x337cd3=_0x48bc6d;if(!_0x4acdaf[_0x337cd3(0x1412)])return;const _0x21911c=Math[_0x337cd3(0xd95)]((Date[_0x337cd3(0x64b)]()-_0x4acdaf[_0x337cd3(0x979)])/0x3e8),_0x4f9759=Math[_0x337cd3(0xd95)](_0x21911c/0x3c),_0x2f0b42=_0x21911c%0x3c;document[_0x337cd3(0x9a3)](_0x337cd3(0x223))[_0x337cd3(0x766)]=String(_0x4f9759)[_0x337cd3(0x1488)](0x2,'0')+':'+String(_0x2f0b42)[_0x337cd3(0x1488)](0x2,'0');}function _0x29be00(){const _0x162d0f=_0x48bc6d,_0xc2edbc=_0x19ddb8['chats'][_0x19ddb8['activeChatId']];if(!_0xc2edbc)return;if(_0xc2edbc[_0x162d0f(0x136b)]){const _0x491eac=_0x4acdaf[_0x162d0f(0x488)]||_0xc2edbc[_0x162d0f(0xcca)][0x0]?.[_0x162d0f(0x1561)]||_0x162d0f(0x8c4);document[_0x162d0f(0x9a3)](_0x162d0f(0x1241))[_0x162d0f(0x10d4)]=_0xc2edbc[_0x162d0f(0x450)][_0x162d0f(0x20a)]||_0xdb6252,document[_0x162d0f(0x9a3)](_0x162d0f(0x5af))[_0x162d0f(0x766)]=_0xc2edbc[_0x162d0f(0x1561)],document[_0x162d0f(0xc86)](_0x162d0f(0xcf8))[_0x162d0f(0x766)]=_0x491eac+_0x162d0f(0xbf7);}else document[_0x162d0f(0x9a3)](_0x162d0f(0x1241))[_0x162d0f(0x10d4)]=_0xc2edbc['settings'][_0x162d0f(0x4fe)]||_0x4f81ff,document['getElementById']('caller-name')[_0x162d0f(0x766)]=_0xc2edbc[_0x162d0f(0x1561)],document['querySelector'](_0x162d0f(0xcf8))[_0x162d0f(0x766)]=_0x162d0f(0x151a);document[_0x162d0f(0x9a3)](_0x162d0f(0xfba))[_0x162d0f(0x4d8)]['add'](_0x162d0f(0xc09));}function _0x51f830(){const _0x36b748=_0x48bc6d;document[_0x36b748(0x9a3)](_0x36b748(0xfba))[_0x36b748(0x4d8)][_0x36b748(0x133d)](_0x36b748(0xc09));}async function _0x4d3853(_0x19a7b0=null){const _0x54199f=_0x48bc6d;if(!_0x4acdaf[_0x54199f(0x1412)])return;const _0x1a69ea=_0x19ddb8[_0x54199f(0xb04)][_0x4acdaf[_0x54199f(0x859)]],{proxyUrl:_0x5c1f8a,apiKey:_0x1546e7,model:_0x2d8afe}=_0x19ddb8[_0x54199f(0xd22)],_0x21f96c=document[_0x54199f(0x9a3)](_0x54199f(0xeb7)),_0x45e127=_0x1a69ea[_0x54199f(0x450)][_0x54199f(0x1555)]||'我';let _0x2bc40c='';if(_0x1a69ea[_0x54199f(0x450)][_0x54199f(0x9c4)]&&_0x1a69ea[_0x54199f(0x450)]['linkedWorldBookIds'][_0x54199f(0x106b)]>0x0){const _0x82feeb=_0x1a69ea['settings']['linkedWorldBookIds']['map'](_0x41b931=>{const _0x41b731=_0x54199f,_0x4e31ba=_0x19ddb8[_0x41b731(0x8e4)][_0x41b731(0xd62)](_0x548c16=>_0x548c16['id']===_0x41b931);return _0x4e31ba&&_0x4e31ba[_0x41b731(0x4e3)]?'\x0a\x0a##\x20世界书:\x20'+_0x4e31ba[_0x41b731(0x1561)]+'\x0a'+_0x4e31ba[_0x41b731(0x4e3)]:'';})[_0x54199f(0x1195)](Boolean)[_0x54199f(0x3b9)]('');_0x82feeb&&(_0x2bc40c=_0x54199f(0x102c)+_0x82feeb+_0x54199f(0x951));}if(_0x19a7b0&&_0x4acdaf[_0x54199f(0xec1)]){const _0x2a41cc=Date[_0x54199f(0x64b)](),_0x5c7362=document['createElement']('div');_0x5c7362[_0x54199f(0x1487)]='call-message-bubble\x20user-speech',_0x5c7362[_0x54199f(0x766)]=_0x19a7b0,_0x5c7362['dataset'][_0x54199f(0xd73)]=_0x2a41cc,_0x1a651b(_0x5c7362,()=>_0x2d7bd9(_0x2a41cc)),_0x21f96c[_0x54199f(0x983)](_0x5c7362),_0x21f96c['scrollTop']=_0x21f96c[_0x54199f(0x13b7)],_0x4acdaf[_0x54199f(0xd00)][_0x54199f(0x1c4)]({'role':_0x54199f(0x20d),'content':_0x19a7b0,'timestamp':_0x2a41cc});}let _0x250f55;if(_0x4acdaf[_0x54199f(0x6a0)]){const _0x2da628=_0x4acdaf[_0x54199f(0x9d3)][_0x54199f(0xb0a)](_0x16b1fe=>_0x16b1fe[_0x54199f(0x1561)]);_0x4acdaf[_0x54199f(0xec1)]&&_0x2da628[_0x54199f(0x5bf)](_0x45e127),_0x250f55='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊视频通话的导演。你的任务是扮演所有【除了用户以外】的AI角色，并以【第三人称旁观视角】来描述他们在通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【身份铁律】】】**:\x20用户的身份是【'+_0x45e127+_0x54199f(0x12eb)+_0x45e127+'\x22**\x20的发言。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**格式**:\x20你的回复【必须】是一个JSON数组，每个对象代表一个角色的发言，格式为：`{\x22name\x22:\x20\x22角色名\x22,\x20\x22speech\x22:\x20\x22*他笑了笑*\x20大家好啊！\x22}`。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**角色扮演**:\x20严格遵守每个角色的设定。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你们正在一个群视频通话中。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4acdaf[_0x54199f(0xaa6)]+_0x54199f(0x1567)+_0x2da628[_0x54199f(0x3b9)]('、\x20')+'。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话刚刚开始...**\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x2bc40c+_0x54199f(0xa6f);}else{let _0x28eac6=_0x4acdaf[_0x54199f(0x7d0)]===_0x54199f(0x20d)?_0x54199f(0x174):'用户刚刚接听了你主动发起的视频通话。';_0x250f55=_0x54199f(0xece)+_0x1a69ea['name']+'\x20('+_0x1a69ea[_0x54199f(0x450)]['aiPersona']+_0x54199f(0x297)+_0x1a69ea[_0x54199f(0x1561)]+_0x54199f(0xb5d)+_0x45e127+_0x54199f(0x170)+_0x1a69ea['settings']['myPersona']+_0x54199f(0x1327)+_0x28eac6+_0x54199f(0x51d)+_0x4acdaf[_0x54199f(0xaa6)]+_0x54199f(0x892);}const _0x593721=[{'role':_0x54199f(0xe10),'content':_0x250f55},..._0x4acdaf['callHistory'][_0x54199f(0xb0a)](_0x5b5d95=>({'role':_0x5b5d95[_0x54199f(0x11c1)],'content':_0x5b5d95[_0x54199f(0x4e3)]}))];if(_0x4acdaf[_0x54199f(0xd00)][_0x54199f(0x106b)]===0x0){const _0x4ecbf8=_0x4acdaf[_0x54199f(0x7d0)]===_0x54199f(0x20d)?'*你按下了接听键...*':_0x54199f(0x51b);_0x593721['push']({'role':_0x54199f(0x20d),'content':_0x4ecbf8});}try{let _0x6b0d36=_0x5c1f8a===GEMINI_API_URL,_0x1f0a12=_0x366263(_0x2d8afe,_0x1546e7,_0x250f55,_0x593721);const _0x3fc6ed=_0x6b0d36?await fetch(_0x1f0a12[_0x54199f(0x121f)],_0x1f0a12[_0x54199f(0x38c)]):await fetch(_0x5c1f8a+_0x54199f(0x501),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x54199f(0x1265)+_0x1546e7},'body':JSON[_0x54199f(0xe1e)]({'model':_0x2d8afe,'messages':_0x593721,'temperature':_0x19ddb8[_0x54199f(0x4c8)][_0x54199f(0x4a2)]||0.8})});if(!_0x3fc6ed['ok'])throw new Error((await _0x3fc6ed[_0x54199f(0xa5d)]())[_0x54199f(0x3b7)][_0x54199f(0xcce)]);const _0x25cf56=await _0x3fc6ed['json'](),_0x434086=_0x6b0d36?_0x25cf56['candidates'][0x0][_0x54199f(0x4e3)][_0x54199f(0x79b)][0x0]['text']:_0x25cf56[_0x54199f(0x21f)][0x0][_0x54199f(0xcce)][_0x54199f(0x4e3)],_0x569de7=_0x21f96c[_0x54199f(0xc86)]('em');if(_0x569de7)_0x569de7[_0x54199f(0x133d)]();if(_0x4acdaf[_0x54199f(0x6a0)]){const _0x489eba=_0x189ab1(_0x434086);_0x489eba[_0x54199f(0x15c1)](_0x3332f6=>{const _0x100289=_0x54199f;if(!_0x3332f6[_0x100289(0x1561)]||_0x3332f6[_0x100289(0x1561)]===_0x45e127||!_0x3332f6[_0x100289(0xd0c)])return;const _0x240a5e=Date[_0x100289(0x64b)]()+Math[_0x100289(0xdcd)](),_0x4af08c=document[_0x100289(0xe94)](_0x100289(0x8ca));_0x4af08c[_0x100289(0x1487)]=_0x100289(0x126e),_0x4af08c['innerHTML']='<strong>'+_0x3332f6[_0x100289(0x1561)]+_0x100289(0xe65)+_0x3332f6[_0x100289(0xd0c)],_0x4af08c['dataset'][_0x100289(0xd73)]=_0x240a5e,_0x1a651b(_0x4af08c,()=>_0x2d7bd9(_0x240a5e)),_0x21f96c[_0x100289(0x983)](_0x4af08c),_0x4acdaf[_0x100289(0xd00)][_0x100289(0x1c4)]({'role':_0x100289(0x115c),'content':_0x3332f6['name']+':\x20'+_0x3332f6[_0x100289(0xd0c)],'timestamp':_0x240a5e});const _0x238d70=_0x4acdaf[_0x100289(0x9d3)]['find'](_0x4999f7=>_0x4999f7[_0x100289(0x1561)]===_0x3332f6[_0x100289(0x1561)]);if(_0x238d70){const _0x57d1b7=document[_0x100289(0xc86)](_0x100289(0x1129)+_0x238d70['id']+'\x22]\x20.participant-avatar');_0x57d1b7&&(_0x57d1b7[_0x100289(0x4d8)][_0x100289(0xe05)](_0x100289(0x15b2)),setTimeout(()=>_0x57d1b7[_0x100289(0x4d8)]['remove']('speaking'),0x7d0));}});}else{const _0x23cf78=Date[_0x54199f(0x64b)](),_0x2ae111=document[_0x54199f(0xe94)]('div');_0x2ae111['className']=_0x54199f(0x126e),_0x2ae111[_0x54199f(0x766)]=_0x434086,_0x2ae111['dataset'][_0x54199f(0xd73)]=_0x23cf78,_0x1a651b(_0x2ae111,()=>_0x2d7bd9(_0x23cf78)),_0x21f96c[_0x54199f(0x983)](_0x2ae111),_0x4acdaf['callHistory']['push']({'role':_0x54199f(0x115c),'content':_0x434086,'timestamp':_0x23cf78});const _0x5714dd=document[_0x54199f(0xc86)](_0x54199f(0x943));_0x5714dd&&(_0x5714dd[_0x54199f(0x4d8)][_0x54199f(0xe05)]('speaking'),setTimeout(()=>_0x5714dd[_0x54199f(0x4d8)][_0x54199f(0x133d)](_0x54199f(0x15b2)),0x7d0));}_0x21f96c[_0x54199f(0x85c)]=_0x21f96c[_0x54199f(0x13b7)];}catch(_0x431768){const _0x2cbb7f=document[_0x54199f(0xe94)](_0x54199f(0x8ca));_0x2cbb7f['className']=_0x54199f(0x126e),_0x2cbb7f[_0x54199f(0x20f)][_0x54199f(0x119b)]=_0x54199f(0x71d),_0x2cbb7f[_0x54199f(0x766)]=_0x54199f(0xc77)+_0x431768[_0x54199f(0xcce)]+']',_0x21f96c[_0x54199f(0x983)](_0x2cbb7f),_0x21f96c[_0x54199f(0x85c)]=_0x21f96c[_0x54199f(0x13b7)],_0x4acdaf[_0x54199f(0xd00)][_0x54199f(0x1c4)]({'role':_0x54199f(0x115c),'content':_0x54199f(0xc77)+_0x431768[_0x54199f(0xcce)]+']'});}}function _0x1252c6(_0x59db9e){const _0x2f3d41=_0x48bc6d;document[_0x2f3d41(0x9a3)](_0x2f3d41(0xd68))[_0x2f3d41(0x20f)][_0x2f3d41(0x115d)]=_0x59db9e?_0x2f3d41(0x8e0):_0x2f3d41(0x79c),document[_0x2f3d41(0x9a3)](_0x2f3d41(0x14ad))[_0x2f3d41(0x20f)][_0x2f3d41(0x115d)]=_0x59db9e?'flex':_0x2f3d41(0x8e0);}async function _0x32a338(_0x2a3655,_0x3ee44c){const _0x288201=_0x48bc6d,_0x994576=_0x19ddb8['chats'][_0x19ddb8['activeChatId']];if(!_0x994576)return;const _0x37d2d4=_0x994576[_0x288201(0x1f0)][_0x288201(0x455)](_0x205025=>_0x205025[_0x288201(0xd73)]===_0x2a3655);if(_0x37d2d4===-0x1)return;const _0x28fd1d=_0x994576[_0x288201(0x1f0)][_0x37d2d4];_0x28fd1d[_0x288201(0x27d)]=_0x3ee44c;let _0x200313;const _0x53ac04=_0x994576[_0x288201(0x136b)]?_0x994576[_0x288201(0x450)][_0x288201(0x1555)]||'我':'我';_0x3ee44c===_0x288201(0x82e)?(_0x28fd1d[_0x288201(0x1588)]=_0x53ac04,_0x200313=_0x288201(0x325)+_0x53ac04+_0x288201(0xfc5)+_0x28fd1d[_0x288201(0x1043)]+'\x20的外卖订单（时间戳:\x20'+_0x2a3655+_0x288201(0x31b)):_0x200313=_0x288201(0x325)+_0x53ac04+_0x288201(0xd23)+_0x28fd1d[_0x288201(0x1043)]+_0x288201(0xa0b)+_0x2a3655+_0x288201(0x8d9);const _0x145580={'role':_0x288201(0xe10),'content':_0x200313,'timestamp':Date[_0x288201(0x64b)](),'isHidden':!![]};_0x994576[_0x288201(0x1f0)][_0x288201(0x1c4)](_0x145580),await _0x512070[_0x288201(0xb04)][_0x288201(0xd4d)](_0x994576),_0x56abd7(_0x19ddb8[_0x288201(0x859)]),_0x3ee44c==='paid'&&_0x55bf11();}async function _0x2462b3(_0x2d289b,_0x1bd317){const _0x5268dc=_0x48bc6d,_0x1eafc2=_0x19ddb8[_0x5268dc(0xb04)][_0x2d289b];if(!_0x1eafc2)return;let _0x5c1f08;_0x1eafc2['isGroup']?_0x5c1f08=_0x1e2056(_0x1eafc2,_0x1bd317):_0x5c1f08=_0x1eafc2[_0x5268dc(0x1561)];const _0x4957c8=document[_0x5268dc(0x9a3)]('phone-screen');_0x4957c8['classList'][_0x5268dc(0x133d)](_0x5268dc(0x615)),void _0x4957c8[_0x5268dc(0xa75)],_0x4957c8[_0x5268dc(0x4d8)]['add'](_0x5268dc(0x615));const _0x29d3ca=await _0x3ab788(_0x5268dc(0x532)+_0x5c1f08+'”',_0x5268dc(0x8f9),'',_0x5268dc(0x13ca));if(_0x29d3ca===null)return;const _0x4a7a23=_0x1e2056(_0x1eafc2,_0x19ddb8[_0x5268dc(0x9ce)][_0x5268dc(0x246)]),_0x282ece=_0x4a7a23+_0x5268dc(0x81a)+_0x5c1f08+'”\x20'+_0x29d3ca[_0x5268dc(0x13f9)](),_0x46f8a6={'role':_0x5268dc(0xe10),'type':_0x5268dc(0x1082),'content':_0x282ece,'timestamp':Date[_0x5268dc(0x64b)]()};_0x1eafc2[_0x5268dc(0x1f0)][_0x5268dc(0x1c4)](_0x46f8a6);const _0x520952='[系统提示：用户（'+_0x4a7a23+_0x5268dc(0x1107)+_0x1bd317+'）'+_0x29d3ca['trim']()+_0x5268dc(0x58f),_0x3485f1={'role':'system','content':_0x520952,'timestamp':Date[_0x5268dc(0x64b)]()+0x1,'isHidden':!![]};_0x1eafc2[_0x5268dc(0x1f0)]['push'](_0x3485f1),await _0x512070[_0x5268dc(0xb04)][_0x5268dc(0xd4d)](_0x1eafc2),_0x19ddb8[_0x5268dc(0x859)]===_0x2d289b&&_0x1ef393(_0x46f8a6,_0x1eafc2),await _0xec8072();}let _0x98060c=null,_0x288b8b=![],_0x5ec23a=new Set();function _0x2d7bd9(_0x21ac28){const _0x55aa77=_0x48bc6d;_0x98060c=_0x21ac28,document['getElementById'](_0x55aa77(0xd0f))[_0x55aa77(0x4d8)]['add'](_0x55aa77(0xc09));}function _0x8a37af(){const _0x6189cb=_0x48bc6d;document['getElementById'](_0x6189cb(0xd0f))[_0x6189cb(0x4d8)]['remove'](_0x6189cb(0xc09)),_0x98060c=null;}async function _0x11c3ed(){const _0x1df016=_0x48bc6d;if(!_0x98060c)return;const _0x32dbc0=_0x98060c,_0x40359f=_0x4acdaf['callHistory'][_0x1df016(0xd62)](_0x2617ea=>_0x2617ea['timestamp']===_0x32dbc0);if(!_0x40359f)return;_0x8a37af();let _0x31b2e9=_0x40359f[_0x1df016(0x4e3)];if(_0x4acdaf[_0x1df016(0x6a0)]&&_0x40359f[_0x1df016(0x11c1)]===_0x1df016(0x115c)){const _0x2c9321=_0x40359f[_0x1df016(0x4e3)][_0x1df016(0x1536)](':\x20');_0x2c9321['length']>0x1&&(_0x31b2e9=_0x2c9321['slice'](0x1)[_0x1df016(0x3b9)](':\x20'));}const _0x3c95fd=await _0x3ab788(_0x1df016(0xdee),'在此修改内容...',_0x31b2e9,_0x1df016(0x8db));_0x3c95fd!==null&&await _0x1ded34(_0x32dbc0,_0x3c95fd);}async function _0x1ded34(_0x2ae91c,_0x28c897){const _0x119aa1=_0x48bc6d,_0x533a5c=_0x4acdaf[_0x119aa1(0xd00)][_0x119aa1(0xd62)](_0x251b35=>_0x251b35[_0x119aa1(0xd73)]===_0x2ae91c);if(_0x533a5c){let _0x16393e=_0x28c897;if(_0x4acdaf[_0x119aa1(0x6a0)]&&_0x533a5c[_0x119aa1(0x11c1)]===_0x119aa1(0x115c)){const _0x312f9f=_0x533a5c['content'][_0x119aa1(0x1536)](':\x20'),_0x373e21=_0x312f9f[0x0];_0x16393e=_0x373e21+':\x20'+_0x28c897;}_0x533a5c[_0x119aa1(0x4e3)]=_0x16393e;const _0x46d56a=document[_0x119aa1(0xc86)](_0x119aa1(0x3fa)+_0x2ae91c+'\x22]');if(_0x46d56a){if(_0x4acdaf[_0x119aa1(0x6a0)]&&_0x533a5c[_0x119aa1(0x11c1)]===_0x119aa1(0x115c)){const _0x4ccfac=_0x533a5c[_0x119aa1(0x4e3)][_0x119aa1(0x1536)](':\x20'),_0x4321cf=_0x4ccfac[0x0];_0x46d56a['innerHTML']=_0x119aa1(0xb4f)+_0x4321cf+':</strong>\x20'+_0x28c897;}else _0x46d56a['textContent']=_0x28c897;}}await _0x403a62('成功',_0x119aa1(0x3e3));}async function _0x5a44da(){const _0x9cca7e=_0x48bc6d;if(!_0x98060c)return;const _0x58ccc0=await _0x2c9509(_0x9cca7e(0x531),_0x9cca7e(0x14f1),{'confirmButtonClass':_0x9cca7e(0xf5b)});if(_0x58ccc0){const _0x18f2d1=_0x98060c;_0x8a37af();const _0x27eaf2=_0x4acdaf[_0x9cca7e(0xd00)][_0x9cca7e(0x455)](_0x2630e8=>_0x2630e8[_0x9cca7e(0xd73)]===_0x18f2d1);_0x27eaf2>-0x1&&_0x4acdaf[_0x9cca7e(0xd00)][_0x9cca7e(0x15b0)](_0x27eaf2,0x1);const _0xc9aa4e=document[_0x9cca7e(0xc86)](_0x9cca7e(0x3fa)+_0x18f2d1+'\x22]');_0xc9aa4e&&_0xc9aa4e[_0x9cca7e(0x133d)]();}else _0x8a37af();}function _0x1e9621(_0x291ce2){const _0x1256ef=_0x48bc6d;_0x24a780=_0x291ce2;const _0x252874=_0x19ddb8['chats'][_0x19ddb8[_0x1256ef(0x859)]],_0x3be90f=_0x252874['history'][_0x1256ef(0xd62)](_0x5dc6be=>_0x5dc6be[_0x1256ef(0xd73)]===_0x291ce2);_0x3be90f&&(document['getElementById'](_0x1256ef(0xe7e))[_0x1256ef(0x766)]=_0x3be90f[_0x1256ef(0x1043)]),document[_0x1256ef(0x9a3)](_0x1256ef(0x1391))[_0x1256ef(0x4d8)][_0x1256ef(0xe05)](_0x1256ef(0xc09));}function _0x361eab(){const _0xfe82a5=_0x48bc6d;document['getElementById'](_0xfe82a5(0x1391))['classList']['remove']('visible'),_0x24a780=null;}async function _0x219744(_0x29d93b){const _0x5cccf9=_0x48bc6d;if(!_0x24a780)return;const _0x318f0a=_0x24a780,_0x481db9=_0x19ddb8[_0x5cccf9(0xb04)][_0x19ddb8[_0x5cccf9(0x859)]],_0x461536=_0x481db9[_0x5cccf9(0x1f0)][_0x5cccf9(0x455)](_0x4522a4=>_0x4522a4['timestamp']===_0x318f0a);if(_0x461536===-0x1)return;const _0x308176=_0x481db9[_0x5cccf9(0x1f0)][_0x461536];_0x308176[_0x5cccf9(0x27d)]=_0x29d93b;let _0xeb5255;if(_0x29d93b===_0x5cccf9(0x900)){const _0x444549={'role':_0x5cccf9(0x20d),'type':'transfer','isRefund':!![],'amount':_0x308176[_0x5cccf9(0x11fa)],'note':_0x5cccf9(0x1175),'timestamp':Date[_0x5cccf9(0x64b)]()};_0x481db9[_0x5cccf9(0x1f0)][_0x5cccf9(0x1c4)](_0x444549),_0xeb5255=_0x5cccf9(0xbc2)+_0x308176[_0x5cccf9(0x1043)]+_0x5cccf9(0xe13);}else _0xeb5255=_0x5cccf9(0x8d1)+_0x308176[_0x5cccf9(0x1043)]+_0x5cccf9(0xe13);const _0x2e84e7={'role':_0x5cccf9(0xe10),'content':_0xeb5255,'timestamp':Date['now']()+0x1,'isHidden':!![]};_0x481db9['history'][_0x5cccf9(0x1c4)](_0x2e84e7),await _0x512070[_0x5cccf9(0xb04)][_0x5cccf9(0xd4d)](_0x481db9),_0x361eab(),_0x56abd7(_0x19ddb8[_0x5cccf9(0x859)]),_0xec8072();}function _0x2c3717(_0x3dbb7f){const _0x5e99b7=_0x48bc6d;_0x5d423a=null;if(_0x3dbb7f){const _0x503a96=_0x3dbb7f[_0x5e99b7(0xc86)](_0x5e99b7(0x31f));_0x503a96&&(_0x503a96['placeholder']=_0x5e99b7(0x9c6));}}async function _0x26bdc6(){const _0x4cc580=_0x48bc6d,_0x6a4942=document[_0x4cc580(0x9a3)](_0x4cc580(0x11fc));_0x6a4942[_0x4cc580(0xeb2)]='';const _0x2b35c=await _0x512070[_0x4cc580(0xe87)][_0x4cc580(0x1404)](_0x4cc580(0xd73))['reverse']()[_0x4cc580(0x591)]();if(_0x2b35c[_0x4cc580(0x106b)]===0x0){_0x6a4942[_0x4cc580(0xeb2)]=_0x4cc580(0x144c);return;}_0x2b35c[_0x4cc580(0x6a2)]((_0x4a363a,_0x6b67ae)=>{const _0x2f50ae=_0x4cc580,_0x38951f=_0x4a363a[_0x2f50ae(0x1508)]===_0x2f50ae(0x1407)&&_0x4a363a[_0x2f50ae(0x5b9)]>Date[_0x2f50ae(0x64b)](),_0x531121=_0x6b67ae[_0x2f50ae(0x1508)]===_0x2f50ae(0x1407)&&_0x6b67ae[_0x2f50ae(0x5b9)]>Date['now']();if(_0x38951f&&!_0x531121)return-0x1;if(!_0x38951f&&_0x531121)return 0x1;if(_0x38951f&&_0x531121)return _0x4a363a[_0x2f50ae(0x5b9)]-_0x6b67ae[_0x2f50ae(0x5b9)];return 0x0;}),_0x2b35c[_0x4cc580(0x15c1)](_0xe35a0b=>{const _0x32ccaf=_0x4cc580;let _0x2e6c86;_0xe35a0b[_0x32ccaf(0x1508)]==='countdown'&&_0xe35a0b[_0x32ccaf(0x5b9)]>Date[_0x32ccaf(0x64b)]()?_0x2e6c86=_0x4f6a61(_0xe35a0b):_0x2e6c86=_0x4940b7(_0xe35a0b),_0x6a4942[_0x32ccaf(0x983)](_0x2e6c86);}),_0xb3088a();}function _0x4940b7(_0x4098c9){const _0x182dca=_0x48bc6d,_0x435246=document[_0x182dca(0xe94)]('div');_0x435246[_0x182dca(0x1487)]='memory-card';const _0x438b11=new Date(_0x4098c9[_0x182dca(0xd73)]),_0x147b66=_0x438b11[_0x182dca(0xef7)]()+'-'+String(_0x438b11[_0x182dca(0x1428)]()+0x1)[_0x182dca(0x1488)](0x2,'0')+'-'+String(_0x438b11[_0x182dca(0x67c)]())[_0x182dca(0x1488)](0x2,'0')+'\x20'+String(_0x438b11[_0x182dca(0x106f)]())[_0x182dca(0x1488)](0x2,'0')+':'+String(_0x438b11[_0x182dca(0xa21)]())['padStart'](0x2,'0');let _0x9fb6,_0x43c364;if(_0x4098c9['type']==='countdown'&&_0x4098c9['targetDate'])_0x9fb6=_0x182dca(0x4cd)+_0x4098c9[_0x182dca(0x3ef)],_0x43c364=_0x49f635('在\x20'+new Date(_0x4098c9[_0x182dca(0x5b9)])['toLocaleString']()+'，我们一起见证了这个约定。')['replace'](/\n/g,'<br>');else{let _0x492d34=_0x182dca(0x48e);if(_0x4098c9['authorId']){const _0x3d79b1=_0x19ddb8['chats'][_0x4098c9[_0x182dca(0x82c)]];_0x3d79b1?_0x492d34=_0x3d79b1['name']:_0x492d34=_0x4098c9[_0x182dca(0x75c)]||_0x182dca(0x18b);}else _0x4098c9[_0x182dca(0x75c)]&&(_0x492d34=_0x4098c9[_0x182dca(0x75c)]);_0x9fb6=_0x492d34+'\x20的日记',_0x43c364=_0x49f635(_0x4098c9[_0x182dca(0x3ef)]);}return _0x435246[_0x182dca(0xeb2)]=_0x182dca(0x4f9)+_0x147b66+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22author\x22>'+_0x9fb6+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>'+_0x43c364+_0x182dca(0xf46),_0x1a651b(_0x435246,async()=>{const _0x1debe0=_0x182dca,_0x2aea59=await _0x2c9509('删除记录','确定要删除这条记录吗？',{'confirmButtonClass':_0x1debe0(0xf5b)});_0x2aea59&&(await _0x512070[_0x1debe0(0xe87)]['delete'](_0x4098c9['id']),_0x26bdc6());}),_0x435246;}function _0x4f6a61(_0x47c8d5){const _0x37bfd9=_0x48bc6d,_0x3cf0ad=document[_0x37bfd9(0xe94)](_0x37bfd9(0x8ca));_0x3cf0ad[_0x37bfd9(0x1487)]=_0x37bfd9(0x328);const _0xce8d59=new Date(_0x47c8d5['targetDate']),_0x326bfb=_0xce8d59[_0x37bfd9(0x12cf)](_0x37bfd9(0x15bc),{'dateStyle':_0x37bfd9(0x38f),'timeStyle':_0x37bfd9(0xa1b)});return _0x3cf0ad[_0x37bfd9(0xeb2)]=_0x37bfd9(0x1010)+_0x47c8d5[_0x37bfd9(0x3ef)]+_0x37bfd9(0xbc8)+_0x47c8d5[_0x37bfd9(0x5b9)]+_0x37bfd9(0xc16)+_0x326bfb+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1a651b(_0x3cf0ad,async()=>{const _0x51fc00=_0x37bfd9,_0x464522=await _0x2c9509(_0x51fc00(0x1405),'确定要删除这个约定吗？',{'confirmButtonClass':_0x51fc00(0xf5b)});_0x464522&&(await _0x512070[_0x51fc00(0xe87)]['delete'](_0x47c8d5['id']),_0x26bdc6());}),_0x3cf0ad;}let _0x4c15cc=[];function _0xb3088a(){const _0xd56371=_0x48bc6d;_0x4c15cc['forEach'](_0x51e54f=>clearInterval(_0x51e54f)),_0x4c15cc=[],document[_0xd56371(0x131c)](_0xd56371(0xe03))[_0xd56371(0x15c1)](_0x309abd=>{const _0xacb442=_0xd56371,_0x42f054=parseInt(_0x309abd[_0xacb442(0xd8d)]['targetDate']);let _0x29cd41;const _0x709ea6=()=>{const _0x1e96ef=_0xacb442,_0x3398a3=Date['now'](),_0x24dc20=_0x42f054-_0x3398a3;if(_0x24dc20<0x0){_0x309abd[_0x1e96ef(0x766)]='约定达成！',clearInterval(_0x29cd41),setTimeout(()=>_0x26bdc6(),0x7d0);return;}const _0xb3d4f5=Math[_0x1e96ef(0xd95)](_0x24dc20/(0x3e8*0x3c*0x3c*0x18)),_0x48e1fe=Math[_0x1e96ef(0xd95)](_0x24dc20%(0x3e8*0x3c*0x3c*0x18)/(0x3e8*0x3c*0x3c)),_0x46ab2a=Math['floor'](_0x24dc20%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x30cae4=Math[_0x1e96ef(0xd95)](_0x24dc20%(0x3e8*0x3c)/0x3e8);_0x309abd[_0x1e96ef(0x766)]=_0xb3d4f5+'天\x20'+_0x48e1fe+'时\x20'+_0x46ab2a+'分\x20'+_0x30cae4+'秒';};_0x709ea6(),_0x29cd41=setInterval(_0x709ea6,0x3e8),_0x4c15cc[_0xacb442(0x1c4)](_0x29cd41);});}async function _0x3e3b3f(_0x57e20c){const _0x4c7cf7=_0x48bc6d,_0x7a6ec6=_0x19ddb8[_0x4c7cf7(0xb04)][_0x57e20c];if(!_0x7a6ec6)return;await _0x403a62(_0x4c7cf7(0xceb),_0x4c7cf7(0xc98)+_0x7a6ec6[_0x4c7cf7(0x1561)]+_0x4c7cf7(0x1125));const {proxyUrl:_0x26d1bc,apiKey:_0x29ab48,model:_0x3e2fff}=_0x19ddb8[_0x4c7cf7(0xd22)];if(!_0x26d1bc||!_0x29ab48||!_0x3e2fff){await _0x403a62('配置错误','API设置不完整，无法继续。');return;}const _0x4b1bdb=_0x7a6ec6[_0x4c7cf7(0x1f0)][_0x4c7cf7(0x457)](-0x5)[_0x4c7cf7(0xb0a)](_0x1f8602=>{const _0x114c2e=_0x4c7cf7,_0x2036cc=_0x1f8602[_0x114c2e(0x11c1)]===_0x114c2e(0x20d)?_0x7a6ec6[_0x114c2e(0x450)]['myNickname']||'我':_0x1f8602[_0x114c2e(0x1043)]||_0x7a6ec6['name'];return _0x2036cc+':\x20'+String(_0x1f8602['content'])['substring'](0x0,0x32)+_0x114c2e(0x4a5);})[_0x4c7cf7(0x3b9)]('\x0a');let _0x4b45ac='';if(_0x7a6ec6['settings'][_0x4c7cf7(0x9c4)]&&_0x7a6ec6['settings']['linkedWorldBookIds'][_0x4c7cf7(0x106b)]>0x0){const _0x12af31=_0x7a6ec6[_0x4c7cf7(0x450)][_0x4c7cf7(0x9c4)][_0x4c7cf7(0xb0a)](_0x117b40=>{const _0x2e51e1=_0x4c7cf7,_0x1289cc=_0x19ddb8[_0x2e51e1(0x8e4)][_0x2e51e1(0xd62)](_0x38a93b=>_0x38a93b['id']===_0x117b40);if(!_0x1289cc||!Array[_0x2e51e1(0xb9b)](_0x1289cc['content']))return'';const _0x1237e5=_0x1289cc['content'][_0x2e51e1(0xb0a)](_0x3833b4=>{const _0xc9fcb5=_0x2e51e1;let _0x550f1a=_0xc9fcb5(0xc4e)+(_0x3833b4[_0xc9fcb5(0x79d)]||_0xc9fcb5(0xbcc))+'\x0a';return _0x3833b4[_0xc9fcb5(0x2d0)]['length']>0x0&&(_0x550f1a+='**关键词:**\x20'+_0x3833b4[_0xc9fcb5(0x2d0)][_0xc9fcb5(0x3b9)](',\x20')+'\x0a'),_0x550f1a+=_0xc9fcb5(0x14b5)+_0x3833b4[_0xc9fcb5(0x4e3)],_0x550f1a;})['join']('\x0a');return _0x1237e5?'\x0a\x0a##\x20世界书:\x20'+_0x1289cc[_0x2e51e1(0x1561)]+'\x0a'+_0x1237e5:'';})['filter'](Boolean)[_0x4c7cf7(0x3b9)]('');_0x12af31&&(_0x4b45ac=_0x4c7cf7(0x12a3)+_0x12af31+'\x0a');}const _0x422f36=_0x4c7cf7(0x81e)+_0x7a6ec6['name']+_0x4c7cf7(0x212)+_0x7a6ec6[_0x4c7cf7(0x450)][_0x4c7cf7(0x1c3)]+_0x4c7cf7(0x1560)+_0x4b45ac+_0x4c7cf7(0x7e7)+_0x4b1bdb+_0x4c7cf7(0x453);try{const _0x1eeaee=[{'role':_0x4c7cf7(0xe10),'content':_0x422f36},{'role':'user','content':'请根据以上设定开始你的决策。'}];let _0x3ae994=_0x26d1bc===GEMINI_API_URL,_0xd8f4a=_0x366263(_0x3e2fff,_0x29ab48,_0x422f36,_0x1eeaee);const _0x22578f=_0x3ae994?await fetch(_0xd8f4a[_0x4c7cf7(0x121f)],_0xd8f4a['data']):await fetch(_0x26d1bc+_0x4c7cf7(0x501),{'method':_0x4c7cf7(0x12db),'headers':{'Content-Type':_0x4c7cf7(0xb1f),'Authorization':_0x4c7cf7(0x1265)+_0x29ab48},'body':JSON[_0x4c7cf7(0xe1e)]({'model':_0x3e2fff,'messages':_0x1eeaee,'temperature':_0x19ddb8['globalSettings'][_0x4c7cf7(0x4a2)]||0.9})});if(!_0x22578f['ok']){const _0x29e2f0=await _0x22578f[_0x4c7cf7(0xa5d)]();throw new Error(_0x4c7cf7(0xbc6)+_0x22578f[_0x4c7cf7(0x27d)]+_0x4c7cf7(0x1452)+_0x29e2f0[_0x4c7cf7(0x3b7)][_0x4c7cf7(0xcce)]);}const _0x57c34c=await _0x22578f['json']();let _0x46e8e8=_0x3ae994?_0x57c34c[_0x4c7cf7(0x383)][0x0][_0x4c7cf7(0x4e3)][_0x4c7cf7(0x79b)][0x0][_0x4c7cf7(0x13ca)]:_0x57c34c[_0x4c7cf7(0x21f)][0x0]['message'][_0x4c7cf7(0x4e3)];_0x46e8e8=_0x46e8e8['replace'](/^```json\s*/,'')[_0x4c7cf7(0x1bb)](/```$/,'');const _0x32dcba=_0x46e8e8[_0x4c7cf7(0x13f9)](),_0x319a27=JSON['parse'](_0x32dcba);_0x319a27[_0x4c7cf7(0x828)]==='apply'&&_0x319a27[_0x4c7cf7(0xfcf)]?(_0x7a6ec6[_0x4c7cf7(0x239)][_0x4c7cf7(0x27d)]=_0x4c7cf7(0x8ab),_0x7a6ec6['relationship'][_0x4c7cf7(0x351)]=_0x319a27[_0x4c7cf7(0xfcf)],_0x19ddb8[_0x4c7cf7(0xb04)][_0x57e20c]=_0x7a6ec6,_0xec8072(),await _0x403a62(_0x4c7cf7(0xf2a),'“'+_0x7a6ec6[_0x4c7cf7(0x1561)]+'”已向你发送好友申请。请返回聊天列表查看。')):(await _0x403a62(_0x4c7cf7(0x283),'“'+_0x7a6ec6[_0x4c7cf7(0x1561)]+_0x4c7cf7(0x16e)),_0x7a6ec6['relationship'][_0x4c7cf7(0x27d)]='blocked_by_user',_0x7a6ec6[_0x4c7cf7(0x239)][_0x4c7cf7(0x3ce)]=Date['now']());}catch(_0xbf1573){await _0x403a62(_0x4c7cf7(0x7e6),'为“'+_0x7a6ec6[_0x4c7cf7(0x1561)]+_0x4c7cf7(0x874)+_0xbf1573[_0x4c7cf7(0xcce)]+_0x4c7cf7(0x1ef)),_0x7a6ec6[_0x4c7cf7(0x239)][_0x4c7cf7(0x27d)]='blocked_by_user',_0x7a6ec6[_0x4c7cf7(0x239)][_0x4c7cf7(0x3ce)]=Date[_0x4c7cf7(0x64b)]();}finally{await _0x512070[_0x4c7cf7(0xb04)]['put'](_0x7a6ec6),_0x56abd7(_0x57e20c);}}function _0x3a60ff(){const _0x388f0b=_0x48bc6d;if(!_0x19ddb8['activeChatId'])return;const _0x57e8da=_0x19ddb8[_0x388f0b(0xb04)][_0x19ddb8['activeChatId']];_0x57e8da[_0x388f0b(0x136b)]?_0x19e8c2():document[_0x388f0b(0x9a3)](_0x388f0b(0x64c))['classList'][_0x388f0b(0xe05)]('visible');}function _0x19e8c2(){const _0x1e7483=_0x48bc6d,_0x500462=document[_0x1e7483(0x9a3)](_0x1e7483(0x808)),_0x43cfcd=_0x19ddb8[_0x1e7483(0xb04)][_0x19ddb8[_0x1e7483(0x859)]];document[_0x1e7483(0x9a3)]('rp-group-amount')['value']='',document['getElementById'](_0x1e7483(0x2c7))[_0x1e7483(0x7b2)]='',document[_0x1e7483(0x9a3)](_0x1e7483(0xa11))[_0x1e7483(0x7b2)]='',document['getElementById'](_0x1e7483(0xe5a))['value']='',document['getElementById'](_0x1e7483(0xadb))[_0x1e7483(0x7b2)]='',document['getElementById']('rp-group-total')['textContent']=_0x1e7483(0x5e6),document[_0x1e7483(0x9a3)]('rp-direct-total')['textContent']=_0x1e7483(0x5e6);const _0x50a468=document[_0x1e7483(0x9a3)](_0x1e7483(0xed4));_0x50a468[_0x1e7483(0xeb2)]='',_0x43cfcd[_0x1e7483(0xcca)]['forEach'](_0x1e554d=>{const _0x44c962=_0x1e7483,_0xfaae94=document['createElement'](_0x44c962(0x43a));_0xfaae94[_0x44c962(0x7b2)]=_0x1e554d[_0x44c962(0x339)],_0xfaae94['textContent']=_0x1e554d[_0x44c962(0xaf0)],_0x50a468[_0x44c962(0x983)](_0xfaae94);}),document[_0x1e7483(0x9a3)]('rp-tab-group')[_0x1e7483(0x9cc)](),_0x500462[_0x1e7483(0x4d8)][_0x1e7483(0xe05)](_0x1e7483(0xc09));}async function _0x409a27(){const _0x1e5aef=_0x48bc6d,_0x172d3b=_0x19ddb8[_0x1e5aef(0xb04)][_0x19ddb8[_0x1e5aef(0x859)]],_0x30608e=parseFloat(document[_0x1e5aef(0x9a3)]('rp-group-amount')[_0x1e5aef(0x7b2)]),_0x2aa2dd=parseInt(document[_0x1e5aef(0x9a3)](_0x1e5aef(0x2c7))['value']),_0x56ea60=document[_0x1e5aef(0x9a3)](_0x1e5aef(0xa11))[_0x1e5aef(0x7b2)]['trim']();if(isNaN(_0x30608e)||_0x30608e<=0x0){alert(_0x1e5aef(0x6b2));return;}if(isNaN(_0x2aa2dd)||_0x2aa2dd<=0x0){alert(_0x1e5aef(0x66a));return;}if(_0x30608e/_0x2aa2dd<0.01){alert('单个红包金额不能少于0.01元！');return;}const _0x1fbe55=_0x172d3b[_0x1e5aef(0x450)][_0x1e5aef(0x1555)]||'我',_0x12bb49={'role':_0x1e5aef(0x20d),'senderName':_0x1fbe55,'type':_0x1e5aef(0x552),'packetType':_0x1e5aef(0x5b8),'timestamp':Date[_0x1e5aef(0x64b)](),'totalAmount':_0x30608e,'count':_0x2aa2dd,'greeting':_0x56ea60||_0x1e5aef(0x309),'claimedBy':{},'isFullyClaimed':![]};_0x172d3b[_0x1e5aef(0x1f0)]['push'](_0x12bb49),await _0x512070['chats'][_0x1e5aef(0xd4d)](_0x172d3b),_0x1ef393(_0x12bb49,_0x172d3b),_0xec8072(),document['getElementById'](_0x1e5aef(0x808))[_0x1e5aef(0x4d8)][_0x1e5aef(0x133d)](_0x1e5aef(0xc09));}async function _0x15ea73(){const _0x1750d6=_0x48bc6d,_0x22e3f5=_0x19ddb8[_0x1750d6(0xb04)][_0x19ddb8[_0x1750d6(0x859)]],_0x4c864f=parseFloat(document[_0x1750d6(0x9a3)]('rp-direct-amount')[_0x1750d6(0x7b2)]),_0x9b6a3a=document[_0x1750d6(0x9a3)](_0x1750d6(0xed4))['value'],_0xb025d0=document[_0x1750d6(0x9a3)](_0x1750d6(0xadb))[_0x1750d6(0x7b2)][_0x1750d6(0x13f9)]();if(isNaN(_0x4c864f)||_0x4c864f<=0x0){alert(_0x1750d6(0x120d));return;}if(!_0x9b6a3a){alert('请选择一个接收人！');return;}const _0x13b363=_0x22e3f5[_0x1750d6(0x450)][_0x1750d6(0x1555)]||'我',_0x254ceb={'role':_0x1750d6(0x20d),'senderName':_0x13b363,'type':_0x1750d6(0x552),'packetType':_0x1750d6(0x93c),'timestamp':Date[_0x1750d6(0x64b)](),'totalAmount':_0x4c864f,'count':0x1,'greeting':_0xb025d0||'给你准备了一个红包','receiverName':_0x9b6a3a,'claimedBy':{},'isFullyClaimed':![]};_0x22e3f5['history'][_0x1750d6(0x1c4)](_0x254ceb),await _0x512070[_0x1750d6(0xb04)][_0x1750d6(0xd4d)](_0x22e3f5),_0x1ef393(_0x254ceb,_0x22e3f5),_0xec8072(),document[_0x1750d6(0x9a3)](_0x1750d6(0x808))[_0x1750d6(0x4d8)][_0x1750d6(0x133d)](_0x1750d6(0xc09));}async function _0x359abc(_0x46ab54){const _0x4eaf99=_0x48bc6d,_0x269af7=_0x19ddb8[_0x4eaf99(0x859)],_0x59cc18=await _0x512070['chats'][_0x4eaf99(0x14ee)](_0x269af7);if(!_0x59cc18)return;_0x19ddb8[_0x4eaf99(0xb04)][_0x269af7]=_0x59cc18;const _0x454dd0=_0x59cc18[_0x4eaf99(0x1f0)]['find'](_0x2eba62=>_0x2eba62[_0x4eaf99(0xd73)]===_0x46ab54);if(!_0x454dd0)return;const _0x2fc189=_0x19ddb8[_0x4eaf99(0x9ce)]['nickname']||_0x4eaf99(0x15c8),_0x31d7a1=_0x454dd0[_0x4eaf99(0x2f5)]&&_0x454dd0[_0x4eaf99(0x2f5)][_0x2fc189];if(_0x454dd0[_0x4eaf99(0x4ee)]===_0x4eaf99(0x93c)&&_0x454dd0[_0x4eaf99(0x13e2)]!==_0x2fc189&&Object[_0x4eaf99(0x2d0)](_0x454dd0[_0x4eaf99(0x2f5)])[_0x4eaf99(0x106b)]>0x0||_0x454dd0[_0x4eaf99(0x1565)]||_0x31d7a1){_0x3f98eb(_0x454dd0);return;}const _0x260fc2=await _0x4b0e0b(_0x454dd0);_0x260fc2!==null&&(await _0x56abd7(_0x269af7),await _0x403a62(_0x4eaf99(0x24b),_0x4eaf99(0xa52)+_0x1e2056(_0x59cc18,_0x454dd0['senderName'])+_0x4eaf99(0xf6c)+_0x260fc2['toFixed'](0x2)+_0x4eaf99(0x1398)));const _0x3fea44=_0x19ddb8['chats'][_0x269af7]['history'][_0x4eaf99(0xd62)](_0x3ff7fc=>_0x3ff7fc[_0x4eaf99(0xd73)]===_0x46ab54);_0x3fea44&&_0x3f98eb(_0x3fea44);}async function _0x4b0e0b(_0x47d058){const _0x166806=_0x48bc6d,_0xc63201=_0x19ddb8[_0x166806(0xb04)][_0x19ddb8[_0x166806(0x859)]];let _0x147342=Date[_0x166806(0x64b)]();const _0x565715=_0x19ddb8[_0x166806(0x9ce)][_0x166806(0x246)]||_0x166806(0x15c8),_0x1d95d3=_0x47d058[_0x166806(0x3a9)]-Object[_0x166806(0x2d0)](_0x47d058[_0x166806(0x2f5)]||{})[_0x166806(0x106b)];if(_0x1d95d3<=0x0)return _0x47d058['isFullyClaimed']=!![],await _0x512070[_0x166806(0xb04)][_0x166806(0xd4d)](_0xc63201),await _0x403a62('手慢了',_0x166806(0xf19)),null;let _0x52fcb7=0x0;const _0xd7b4d8=_0x47d058['totalAmount']-Object[_0x166806(0xea1)](_0x47d058[_0x166806(0x2f5)]||{})['reduce']((_0x196597,_0x388c2b)=>_0x196597+_0x388c2b,0x0);if(_0x47d058[_0x166806(0x4ee)]===_0x166806(0x5b8)){if(_0x1d95d3===0x1)_0x52fcb7=_0xd7b4d8;else{const _0x5c9d74=0.01,_0x34cdb7=_0xd7b4d8-(_0x1d95d3-0x1)*_0x5c9d74;_0x52fcb7=Math[_0x166806(0xdcd)]()*(_0x34cdb7-_0x5c9d74)+_0x5c9d74;}}else _0x52fcb7=_0x47d058[_0x166806(0xb19)];_0x52fcb7=parseFloat(_0x52fcb7['toFixed'](0x2));if(!_0x47d058[_0x166806(0x2f5)])_0x47d058[_0x166806(0x2f5)]={};_0x47d058[_0x166806(0x2f5)][_0x565715]=_0x52fcb7;const _0x4f2ce4=Object[_0x166806(0x2d0)](_0x47d058[_0x166806(0x2f5)])[_0x166806(0x106b)]>=_0x47d058[_0x166806(0x3a9)];_0x4f2ce4&&(_0x47d058[_0x166806(0x1565)]=!![]);const _0x5604f=_0x1e2056(_0xc63201,_0x565715),_0x3ab3e7=_0x1e2056(_0xc63201,_0x47d058[_0x166806(0x1043)]),_0x31fe37={'role':_0x166806(0xe10),'type':'pat_message','content':'你领取了\x20'+_0x3ab3e7+_0x166806(0x1148),'timestamp':_0x147342++};_0xc63201[_0x166806(0x1f0)][_0x166806(0x1c4)](_0x31fe37);let _0x1bd4de;if(_0x4f2ce4){const _0x404637={'role':_0x166806(0xe10),'type':'pat_message','content':_0x3ab3e7+_0x166806(0x12a5),'timestamp':_0x147342++};_0xc63201[_0x166806(0x1f0)][_0x166806(0x1c4)](_0x404637);let _0x4df475={'name':'','amount':-0x1};_0x47d058['packetType']==='lucky'&&_0x47d058[_0x166806(0x3a9)]>0x1&&Object[_0x166806(0x10c3)](_0x47d058[_0x166806(0x2f5)])['forEach'](([_0x5ea684,_0x574d01])=>{const _0x2d6252=_0x166806;_0x574d01>_0x4df475[_0x2d6252(0x11fa)]&&(_0x4df475={'name':_0x5ea684,'amount':_0x574d01});});const _0x2b8e00=_0x4df475[_0x166806(0x1561)]?_0x1e2056(_0xc63201,_0x4df475[_0x166806(0x1561)]):'无';_0x1bd4de=_0x166806(0xb12)+_0x5604f+_0x166806(0x285)+_0x2b8e00+_0x166806(0x6c1);}else _0x1bd4de=_0x166806(0xb12)+_0x5604f+_0x166806(0xf71)+_0x47d058[_0x166806(0xd73)]+_0x166806(0x1123);const _0x160a64={'role':_0x166806(0xe10),'content':_0x1bd4de,'timestamp':_0x147342++,'isHidden':!![]};return _0xc63201['history'][_0x166806(0x1c4)](_0x160a64),await _0x512070[_0x166806(0xb04)][_0x166806(0xd4d)](_0xc63201),_0x52fcb7;}async function _0x3f98eb(_0xbaf8dc){const _0x13b41d=_0x48bc6d;if(!_0xbaf8dc){console[_0x13b41d(0x3b7)](_0x13b41d(0xf16));return;}const _0x486906=_0x19ddb8[_0x13b41d(0xb04)][_0x19ddb8[_0x13b41d(0x859)]];if(!_0x486906)return;const _0x42de5b=document[_0x13b41d(0x9a3)]('red-packet-details-modal'),_0x3d635b=_0x19ddb8[_0x13b41d(0x9ce)]['nickname']||_0x13b41d(0x15c8),_0x3b12d7=_0x1e2056(_0x486906,_0xbaf8dc['senderName']);document['getElementById'](_0x13b41d(0x8dc))['textContent']=_0x3b12d7,document[_0x13b41d(0x9a3)]('rp-details-greeting')['textContent']=_0xbaf8dc[_0x13b41d(0x1524)]||_0x13b41d(0x309);const _0x48a0db=document[_0x13b41d(0x9a3)](_0x13b41d(0xb74));_0xbaf8dc[_0x13b41d(0x2f5)]&&_0xbaf8dc['claimedBy'][_0x3d635b]?(_0x48a0db['querySelector'](_0x13b41d(0x10c0))[_0x13b41d(0x766)]=_0xbaf8dc['claimedBy'][_0x3d635b][_0x13b41d(0x1322)](0x2),_0x48a0db[_0x13b41d(0x20f)][_0x13b41d(0x115d)]='block'):_0x48a0db[_0x13b41d(0x20f)]['display']=_0x13b41d(0x8e0);const _0x29c28d=Object[_0x13b41d(0x2d0)](_0xbaf8dc['claimedBy']||{})[_0x13b41d(0x106b)],_0x2d871d=Object[_0x13b41d(0xea1)](_0xbaf8dc[_0x13b41d(0x2f5)]||{})['reduce']((_0x34d2d8,_0x287cd3)=>_0x34d2d8+_0x287cd3,0x0);let _0x188a9f=_0x29c28d+'/'+_0xbaf8dc[_0x13b41d(0x3a9)]+_0x13b41d(0x7d1)+_0x2d871d[_0x13b41d(0x1322)](0x2)+'/'+_0xbaf8dc[_0x13b41d(0xb19)][_0x13b41d(0x1322)](0x2)+'元。';if(!_0xbaf8dc[_0x13b41d(0x1565)]&&_0x29c28d<_0xbaf8dc[_0x13b41d(0x3a9)]){const _0x2774b2=Math['floor']((_0xbaf8dc[_0x13b41d(0xd73)]+0x18*0x3c*0x3c*0x3e8-Date[_0x13b41d(0x64b)]())/(0x3e8*0x3c*0x3c));if(_0x2774b2>0x0)_0x188a9f+='\x20剩余红包将在'+_0x2774b2+_0x13b41d(0xba2);}document[_0x13b41d(0x9a3)](_0x13b41d(0xd20))[_0x13b41d(0x766)]=_0x188a9f;const _0x3e211d=document[_0x13b41d(0x9a3)](_0x13b41d(0x1448));_0x3e211d[_0x13b41d(0xeb2)]='';const _0x44fccd=Object[_0x13b41d(0x10c3)](_0xbaf8dc[_0x13b41d(0x2f5)]||{});let _0xfbcf8a={'name':'','amount':-0x1};_0xbaf8dc['packetType']===_0x13b41d(0x5b8)&&_0xbaf8dc[_0x13b41d(0x1565)]&&_0x44fccd['length']>0x1&&_0x44fccd[_0x13b41d(0x15c1)](([_0xff4170,_0x4e3b72])=>{const _0x2b2969=_0x13b41d;_0x4e3b72>_0xfbcf8a[_0x2b2969(0x11fa)]&&(_0xfbcf8a={'name':_0xff4170,'amount':_0x4e3b72});}),_0x44fccd[_0x13b41d(0x6a2)]((_0x5a0760,_0x5482f4)=>_0x5482f4[0x1]-_0x5a0760[0x1]),_0x44fccd[_0x13b41d(0x15c1)](([_0x1c76a8,_0x13c6d2])=>{const _0x55d130=_0x13b41d,_0x1df53b=document['createElement'](_0x55d130(0x8ca));_0x1df53b[_0x55d130(0x1487)]='rp-details-item';let _0x24bf7c='';_0xfbcf8a[_0x55d130(0x1561)]&&_0x1c76a8===_0xfbcf8a[_0x55d130(0x1561)]&&(_0x24bf7c=_0x55d130(0xa28));const _0x39aa6d=_0x1e2056(_0x486906,_0x1c76a8);_0x1df53b[_0x55d130(0xeb2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x39aa6d+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22amount\x22>'+_0x13c6d2[_0x55d130(0x1322)](0x2)+_0x55d130(0x2a9)+_0x24bf7c+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3e211d[_0x55d130(0x983)](_0x1df53b);}),_0x42de5b[_0x13b41d(0x4d8)][_0x13b41d(0xe05)](_0x13b41d(0xc09));}document[_0x48bc6d(0x9a3)](_0x48bc6d(0x530))[_0x48bc6d(0x954)](_0x48bc6d(0x9cc),()=>{const _0x47d048=_0x48bc6d;document[_0x47d048(0x9a3)](_0x47d048(0x143e))[_0x47d048(0x4d8)][_0x47d048(0x133d)](_0x47d048(0xc09));}),window[_0x48bc6d(0x482)]=_0x359abc;function _0x1d7e35(){const _0x25eb71=_0x48bc6d,_0x439e9a=document[_0x25eb71(0x9a3)](_0x25eb71(0x103e));document[_0x25eb71(0x9a3)](_0x25eb71(0x240))['value']='';const _0x529bd0=document['getElementById'](_0x25eb71(0x4e8));_0x529bd0[_0x25eb71(0xeb2)]='',_0x30d377(),_0x30d377(),_0x439e9a[_0x25eb71(0x4d8)][_0x25eb71(0xe05)](_0x25eb71(0xc09));}function _0x30d377(){const _0x4f1a3f=_0x48bc6d,_0x2828a8=document[_0x4f1a3f(0x9a3)](_0x4f1a3f(0x4e8)),_0xbff465=document[_0x4f1a3f(0xe94)]('div');_0xbff465[_0x4f1a3f(0x1487)]='poll-option-input-wrapper',_0xbff465[_0x4f1a3f(0xeb2)]=_0x4f1a3f(0xfb8),_0xbff465['querySelector'](_0x4f1a3f(0xae4))['addEventListener'](_0x4f1a3f(0x9cc),()=>{const _0x90f4d4=_0x4f1a3f;_0x2828a8[_0x90f4d4(0xb4a)][_0x90f4d4(0x106b)]>0x2?_0xbff465[_0x90f4d4(0x133d)]():alert(_0x90f4d4(0xb4e));}),_0x2828a8['appendChild'](_0xbff465);}async function _0x215527(){const _0x33fc6f=_0x48bc6d;if(!_0x19ddb8[_0x33fc6f(0x859)])return;const _0x56e44d=document[_0x33fc6f(0x9a3)]('poll-question-input')[_0x33fc6f(0x7b2)][_0x33fc6f(0x13f9)]();if(!_0x56e44d){alert(_0x33fc6f(0x1235));return;}const _0x5ee92f=Array[_0x33fc6f(0x1311)](document[_0x33fc6f(0x131c)](_0x33fc6f(0x6fc)))['map'](_0xc900a8=>_0xc900a8[_0x33fc6f(0x7b2)][_0x33fc6f(0x13f9)]())[_0x33fc6f(0x1195)](_0x234b0d=>_0x234b0d);if(_0x5ee92f['length']<0x2){alert('请至少输入2个有效的投票选项！');return;}const _0x3aa3f7=_0x19ddb8['chats'][_0x19ddb8[_0x33fc6f(0x859)]],_0x5ae54b=_0x3aa3f7[_0x33fc6f(0x136b)]?_0x3aa3f7[_0x33fc6f(0x450)][_0x33fc6f(0x1555)]||'我':'我',_0x4021eb={'role':_0x33fc6f(0x20d),'senderName':_0x5ae54b,'type':'poll','timestamp':Date[_0x33fc6f(0x64b)](),'question':_0x56e44d,'options':_0x5ee92f,'votes':{},'isClosed':![]};_0x3aa3f7[_0x33fc6f(0x1f0)]['push'](_0x4021eb),await _0x512070[_0x33fc6f(0xb04)][_0x33fc6f(0xd4d)](_0x3aa3f7),_0x1ef393(_0x4021eb,_0x3aa3f7),_0xec8072(),document[_0x33fc6f(0x9a3)](_0x33fc6f(0x103e))[_0x33fc6f(0x4d8)][_0x33fc6f(0x133d)](_0x33fc6f(0xc09));}async function _0x5d3826(_0x2d7b0d,_0x5509bf){const _0x3a3e37=_0x48bc6d,_0x4172c8=_0x19ddb8[_0x3a3e37(0xb04)][_0x19ddb8['activeChatId']],_0x906a2e=_0x4172c8[_0x3a3e37(0x1f0)][_0x3a3e37(0xd62)](_0x9d66d3=>_0x9d66d3[_0x3a3e37(0xd73)]===_0x2d7b0d),_0x5b5edc=_0x4172c8['isGroup']?_0x4172c8[_0x3a3e37(0x450)]['myNickname']||'我':'我';if(!_0x906a2e||_0x906a2e['isClosed']){_0x906a2e&&_0x906a2e[_0x3a3e37(0x13ae)]&&_0x1cb465(_0x2d7b0d);return;}const _0x4c5070=_0x906a2e[_0x3a3e37(0xa71)][_0x5509bf]&&_0x906a2e['votes'][_0x5509bf][_0x3a3e37(0x478)](_0x5b5edc);if(!_0x4c5070){for(const _0x1029e in _0x906a2e[_0x3a3e37(0xa71)]){const _0x5814f7=_0x906a2e[_0x3a3e37(0xa71)][_0x1029e][_0x3a3e37(0xef5)](_0x5b5edc);_0x5814f7>-0x1&&_0x906a2e['votes'][_0x1029e][_0x3a3e37(0x15b0)](_0x5814f7,0x1);}!_0x906a2e[_0x3a3e37(0xa71)][_0x5509bf]&&(_0x906a2e[_0x3a3e37(0xa71)][_0x5509bf]=[]),_0x906a2e['votes'][_0x5509bf][_0x3a3e37(0x1c4)](_0x5b5edc);}let _0x842627=null;!_0x4c5070&&(_0x842627='[系统提示：用户\x20('+_0x5b5edc+')\x20刚刚投票给了\x20“'+_0x5509bf+'”。]');if(_0x842627){const _0x416f8b={'role':_0x3a3e37(0xe10),'content':_0x842627,'timestamp':Date[_0x3a3e37(0x64b)](),'isHidden':!![]};_0x4172c8[_0x3a3e37(0x1f0)][_0x3a3e37(0x1c4)](_0x416f8b);}await _0x512070[_0x3a3e37(0xb04)][_0x3a3e37(0xd4d)](_0x4172c8),_0x56abd7(_0x19ddb8[_0x3a3e37(0x859)]);}async function _0x4b1639(_0x9928a8){const _0x348fff=_0x48bc6d,_0x1a9548=_0x19ddb8['chats'][_0x19ddb8[_0x348fff(0x859)]],_0x1887f2=_0x1a9548[_0x348fff(0x1f0)][_0x348fff(0xd62)](_0x12f549=>_0x12f549['timestamp']===_0x9928a8);if(!_0x1887f2||_0x1887f2[_0x348fff(0x13ae)])return;const _0x411ec9=await _0x2c9509(_0x348fff(0xcb3),'确定要结束这个投票吗？结束后将无法再进行投票。');if(_0x411ec9){_0x1887f2[_0x348fff(0x13ae)]=!![];const _0x65fdc5=_0x1887f2[_0x348fff(0x11c2)][_0x348fff(0xb0a)](_0x2c0072=>'“'+_0x2c0072+'”('+(_0x1887f2['votes'][_0x2c0072]?.['length']||0x0)+'票)')[_0x348fff(0x3b9)]('，'),_0x3c0958=_0x348fff(0x5ab)+_0x65fdc5+'。]',_0x9a2c6f={'role':_0x348fff(0xe10),'content':_0x3c0958,'timestamp':Date[_0x348fff(0x64b)](),'isHidden':!![]};_0x1a9548[_0x348fff(0x1f0)][_0x348fff(0x1c4)](_0x9a2c6f),await _0x512070['chats'][_0x348fff(0xd4d)](_0x1a9548),_0x56abd7(_0x19ddb8[_0x348fff(0x859)]);}}function _0x1cb465(_0x4f085c){const _0xacc6d8=_0x48bc6d,_0x2c3f68=_0x19ddb8[_0xacc6d8(0xb04)][_0x19ddb8[_0xacc6d8(0x859)]],_0xa6b516=_0x2c3f68[_0xacc6d8(0x1f0)]['find'](_0x3e7963=>_0x3e7963[_0xacc6d8(0xd73)]===_0x4f085c);if(!_0xa6b516||!_0xa6b516['isClosed'])return;let _0xf8c224=_0xacc6d8(0xb57)+_0xa6b516[_0xacc6d8(0x1db)]+_0xacc6d8(0x124a);Object[_0xacc6d8(0x2d0)](_0xa6b516[_0xacc6d8(0xa71)])['length']===0x0?_0xf8c224+='<p\x20style=\x22color:\x20#8a8a8a;\x22>还没有人投票。</p>':_0xa6b516['options'][_0xacc6d8(0x15c1)](_0x53947f=>{const _0x130491=_0xacc6d8,_0x319384=_0xa6b516['votes'][_0x53947f]||[],_0x55b5f5=_0x319384[_0x130491(0xb0a)](_0x552015=>_0x1e2056(_0x2c3f68,_0x552015))[_0x130491(0x3b9)]('、\x20');_0xf8c224+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x205px\x200;\x22>'+_0x53947f+'\x20('+_0x319384[_0x130491(0x106b)]+_0x130491(0x538)+(_0x319384['length']>0x0?_0x55b5f5:_0x130491(0x9a6))+_0x130491(0x1272);}),_0x403a62('投票结果',_0xf8c224);}function _0x18251d(){const _0x51bb2e=_0x48bc6d;if(!_0x19ddb8[_0x51bb2e(0x859)])return;const _0x591d90=_0x19ddb8[_0x51bb2e(0xb04)][_0x19ddb8[_0x51bb2e(0x859)]];document['getElementById']('ai-avatar-library-title')[_0x51bb2e(0x766)]='“'+_0x591d90['name']+_0x51bb2e(0x85f),_0x4462e2(),document[_0x51bb2e(0x9a3)](_0x51bb2e(0x4b5))['classList'][_0x51bb2e(0xe05)](_0x51bb2e(0xc09));}function _0x4462e2(){const _0x3eaed3=_0x48bc6d,_0x171257=document[_0x3eaed3(0x9a3)](_0x3eaed3(0xffc));_0x171257[_0x3eaed3(0xeb2)]='';const _0x3f7b7f=_0x19ddb8[_0x3eaed3(0xb04)][_0x19ddb8[_0x3eaed3(0x859)]],_0x6c7aae=_0x3f7b7f['settings']['aiAvatarLibrary']||[];if(_0x6c7aae[_0x3eaed3(0x106b)]===0x0){_0x171257[_0x3eaed3(0xeb2)]=_0x3eaed3(0x41d);return;}_0x6c7aae[_0x3eaed3(0x15c1)]((_0x2782b8,_0x1b0e60)=>{const _0x29badd=_0x3eaed3,_0x53b834=document[_0x29badd(0xe94)](_0x29badd(0x8ca));_0x53b834['className']=_0x29badd(0x4a7),_0x53b834[_0x29badd(0x10b8)]=_0x2782b8[_0x29badd(0x1561)],_0x53b834['innerHTML']=_0x29badd(0x2a4)+_0x2782b8[_0x29badd(0x121f)]+_0x29badd(0x917)+_0x2782b8['name']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0x1f1a20=document[_0x29badd(0xe94)](_0x29badd(0x8ca));_0x1f1a20['className']=_0x29badd(0x1441),_0x1f1a20[_0x29badd(0xeb2)]='×',_0x1f1a20[_0x29badd(0x20f)][_0x29badd(0x115d)]='block',_0x1f1a20[_0x29badd(0x4ce)]=async _0x2eb262=>{const _0x1b9e33=_0x29badd;_0x2eb262[_0x1b9e33(0x63a)]();const _0x5ce873=await _0x2c9509(_0x1b9e33(0xa02),_0x1b9e33(0xbfd)+_0x2782b8[_0x1b9e33(0x1561)]+_0x1b9e33(0x12f4),{'confirmButtonClass':_0x1b9e33(0xf5b)});_0x5ce873&&(_0x3f7b7f['settings'][_0x1b9e33(0xea2)][_0x1b9e33(0x15b0)](_0x1b0e60,0x1),await _0x512070['chats'][_0x1b9e33(0xd4d)](_0x3f7b7f),_0x4462e2());},_0x53b834[_0x29badd(0x983)](_0x1f1a20),_0x171257['appendChild'](_0x53b834);});}async function _0x32da96(){const _0xdf76f2=_0x48bc6d,_0x179f7a=await _0x3ab788(_0xdf76f2(0x56f),_0xdf76f2(0x156b));if(!_0x179f7a||!_0x179f7a[_0xdf76f2(0x13f9)]())return;const _0x1e86da=await _0x3ab788(_0xdf76f2(0x56f),_0xdf76f2(0x14d7),'',_0xdf76f2(0x121f));if(!_0x1e86da||!_0x1e86da['trim']()[_0xdf76f2(0x608)](_0xdf76f2(0x978))){alert(_0xdf76f2(0xbfa));return;}const _0x180690=_0x19ddb8[_0xdf76f2(0xb04)][_0x19ddb8[_0xdf76f2(0x859)]];!_0x180690[_0xdf76f2(0x450)][_0xdf76f2(0xea2)]&&(_0x180690[_0xdf76f2(0x450)]['aiAvatarLibrary']=[]),_0x180690[_0xdf76f2(0x450)][_0xdf76f2(0xea2)][_0xdf76f2(0x1c4)]({'name':_0x179f7a[_0xdf76f2(0x13f9)](),'url':_0x1e86da['trim']()}),await _0x512070[_0xdf76f2(0xb04)][_0xdf76f2(0xd4d)](_0x180690),_0x4462e2();}function _0x1b96da(){const _0x18e88f=_0x48bc6d;document[_0x18e88f(0x9a3)](_0x18e88f(0x4b5))[_0x18e88f(0x4d8)]['remove']('visible');}function _0x38371b(){const _0x36be6c=_0x48bc6d;if(!_0x19ddb8[_0x36be6c(0x859)])return;const _0x37d04f=_0x19ddb8[_0x36be6c(0xb04)][_0x19ddb8[_0x36be6c(0x859)]];document[_0x36be6c(0x9a3)](_0x36be6c(0x22f))[_0x36be6c(0x766)]='“'+(_0x37d04f[_0x36be6c(0x450)][_0x36be6c(0x1555)]||'我')+'”的头像库',_0x5dcdae(),document[_0x36be6c(0x9a3)](_0x36be6c(0x16d))['classList'][_0x36be6c(0xe05)](_0x36be6c(0xc09));}function _0x5dcdae(){const _0x4c4328=_0x48bc6d,_0x5b5832=document[_0x4c4328(0x9a3)](_0x4c4328(0x3a0));_0x5b5832[_0x4c4328(0xeb2)]='';const _0x3d2cb5=_0x19ddb8['chats'][_0x19ddb8[_0x4c4328(0x859)]],_0xe35dd=_0x3d2cb5[_0x4c4328(0x450)]['myAvatarLibrary']||[];if(_0xe35dd['length']===0x0){_0x5b5832[_0x4c4328(0xeb2)]='<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>';return;}_0xe35dd[_0x4c4328(0x15c1)]((_0x3ca2aa,_0x2fa755)=>{const _0x186487=_0x4c4328,_0x37651f=document[_0x186487(0xe94)](_0x186487(0x8ca));_0x37651f[_0x186487(0x1487)]='sticker-item',_0x37651f[_0x186487(0x10b8)]=_0x3ca2aa['name'],_0x37651f[_0x186487(0xeb2)]=_0x186487(0x2a4)+_0x3ca2aa['url']+_0x186487(0x917)+_0x3ca2aa[_0x186487(0x1561)]+_0x186487(0x110c);const _0x4e50d0=document['createElement']('div');_0x4e50d0[_0x186487(0x1487)]=_0x186487(0x1441),_0x4e50d0[_0x186487(0xeb2)]='×',_0x4e50d0[_0x186487(0x20f)][_0x186487(0x115d)]='block',_0x4e50d0[_0x186487(0x4ce)]=async _0x51f782=>{const _0x123a9f=_0x186487;_0x51f782[_0x123a9f(0x63a)]();const _0x3513a1=await _0x2c9509('删除头像',_0x123a9f(0x7ae)+_0x3ca2aa['name']+_0x123a9f(0x12f4),{'confirmButtonClass':_0x123a9f(0xf5b)});_0x3513a1&&(_0x3d2cb5[_0x123a9f(0x450)][_0x123a9f(0xa70)][_0x123a9f(0x15b0)](_0x2fa755,0x1),await _0x512070[_0x123a9f(0xb04)][_0x123a9f(0xd4d)](_0x3d2cb5),_0x5dcdae());},_0x37651f[_0x186487(0x983)](_0x4e50d0),_0x5b5832[_0x186487(0x983)](_0x37651f);});}async function _0x267294(){const _0x33013d=_0x48bc6d,_0x2b47b8=await _0x3ab788(_0x33013d(0x56f),'请为这个头像起个名字（例如：开心、哭泣）');if(!_0x2b47b8||!_0x2b47b8['trim']())return;const _0x47ca69=await _0x3ab788(_0x33013d(0x56f),_0x33013d(0x14d7),'',_0x33013d(0x121f));if(!_0x47ca69||!_0x47ca69[_0x33013d(0x13f9)]()[_0x33013d(0x608)]('http')){alert(_0x33013d(0xbfa));return;}const _0x3c66a3=_0x19ddb8['chats'][_0x19ddb8[_0x33013d(0x859)]];!_0x3c66a3[_0x33013d(0x450)][_0x33013d(0xa70)]&&(_0x3c66a3[_0x33013d(0x450)][_0x33013d(0xa70)]=[]),_0x3c66a3[_0x33013d(0x450)][_0x33013d(0xa70)][_0x33013d(0x1c4)]({'name':_0x2b47b8[_0x33013d(0x13f9)](),'url':_0x47ca69[_0x33013d(0x13f9)]()}),await _0x512070[_0x33013d(0xb04)][_0x33013d(0xd4d)](_0x3c66a3),_0x5dcdae();}async function _0x5cbd9d(_0x2d5183){const _0x5c25c7=_0x48bc6d,_0x1cdbf1=_0x2d5183[_0x5c25c7(0xa41)][_0x5c25c7(0x104e)][0x0];if(!_0x1cdbf1)return;const _0x33736f=await new Promise(_0x57ddd5=>{const _0x36bdee=_0x5c25c7,_0x5b847f=new FileReader();_0x5b847f[_0x36bdee(0xdd7)]=()=>_0x57ddd5(_0x5b847f[_0x36bdee(0x5c9)]),_0x5b847f[_0x36bdee(0xdd8)](_0x1cdbf1);}),_0xa69591=await _0x3ab788(_0x5c25c7(0x12b3),_0x5c25c7(0xa48));if(!_0xa69591||!_0xa69591['trim']())return;const _0x1b412d=_0x19ddb8[_0x5c25c7(0xb04)][_0x19ddb8[_0x5c25c7(0x859)]];!_0x1b412d['settings'][_0x5c25c7(0xa70)]&&(_0x1b412d[_0x5c25c7(0x450)][_0x5c25c7(0xa70)]=[]),_0x1b412d['settings'][_0x5c25c7(0xa70)]['push']({'name':_0xa69591[_0x5c25c7(0x13f9)](),'url':_0x33736f}),await _0x512070[_0x5c25c7(0xb04)][_0x5c25c7(0xd4d)](_0x1b412d),_0x5dcdae(),_0x2d5183[_0x5c25c7(0xa41)][_0x5c25c7(0x7b2)]=null;}async function _0x3f795e(_0x14149b){const _0x48b7b5=_0x48bc6d,_0x295e65=_0x19ddb8['chats'][_0x19ddb8[_0x48b7b5(0x859)]];if(!_0x295e65)return;const _0x462d1e=_0x14149b[_0x48b7b5(0x13f9)]()['split']('\x0a'),_0x2c4a59=[],_0x47c1c8=_0x48b7b5(0xc2f);let _0x1a3799=0x0;for(const _0x3cc470 of _0x462d1e){const _0x2c2c9d=_0x3cc470[_0x48b7b5(0x13f9)]();if(!_0x2c2c9d||_0x2c2c9d[_0x48b7b5(0x478)](_0x48b7b5(0x978))||_0x2c2c9d[_0x48b7b5(0x478)]('填入'))continue;let _0x429359=null,_0x1cc725=null;const _0x1e21c6=_0x2c2c9d[_0x48b7b5(0x293)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x1e21c6)_0x429359=_0x1e21c6[0x1],_0x1cc725=_0x1e21c6[0x2];else{const _0x186c17=_0x2c2c9d['split'](/\s+/);_0x186c17[_0x48b7b5(0x106b)]>=0x2&&(_0x1cc725=_0x186c17[_0x48b7b5(0x144a)](),_0x429359=_0x186c17[_0x48b7b5(0x3b9)]('\x20'));}_0x429359&&_0x1cc725&&_0x1cc725[_0x48b7b5(0x478)]('.')?_0x2c4a59[_0x48b7b5(0x1c4)]({'name':_0x429359,'url':_0x47c1c8+_0x1cc725}):_0x1a3799++;}if(_0x1a3799>0x0)await _0x403a62(_0x48b7b5(0xc7d),'有\x20'+_0x1a3799+_0x48b7b5(0xb37));if(_0x2c4a59[_0x48b7b5(0x106b)]>0x0){if(!_0x295e65[_0x48b7b5(0x450)][_0x48b7b5(0xa70)])_0x295e65[_0x48b7b5(0x450)]['myAvatarLibrary']=[];_0x295e65[_0x48b7b5(0x450)]['myAvatarLibrary'][_0x48b7b5(0x1c4)](..._0x2c4a59),await _0x512070['chats'][_0x48b7b5(0xd4d)](_0x295e65),_0x5dcdae(),await _0x403a62(_0x48b7b5(0x90b),'已成功批量导入\x20'+_0x2c4a59[_0x48b7b5(0x106b)]+_0x48b7b5(0x933));}else _0x1a3799===0x0&&alert('没有找到可导入的内容。');}function _0x3f23e4(){const _0x24a6b6=_0x48bc6d;document['getElementById']('my-avatar-library-modal')['classList'][_0x24a6b6(0x133d)](_0x24a6b6(0xc09));}function _0x539e45(){const _0x282b62=_0x48bc6d;if(!_0x19ddb8['activeChatId'])return;const _0x1b24af=_0x19ddb8['chats'][_0x19ddb8[_0x282b62(0x859)]];document[_0x282b62(0x9a3)](_0x282b62(0xc94))[_0x282b62(0x766)]='“'+_0x1b24af[_0x282b62(0x1561)]+_0x282b62(0x85f),_0x35ded3(),document[_0x282b62(0x9a3)]('group-avatar-library-modal')['classList'][_0x282b62(0xe05)](_0x282b62(0xc09));}function _0x35ded3(){const _0x4190dd=_0x48bc6d,_0x2a0e7c=document[_0x4190dd(0x9a3)]('group-avatar-library-grid');_0x2a0e7c[_0x4190dd(0xeb2)]='';const _0x231b2c=_0x19ddb8[_0x4190dd(0xb04)][_0x19ddb8[_0x4190dd(0x859)]],_0xc5f2fc=_0x231b2c['settings'][_0x4190dd(0x284)]||[];if(_0xc5f2fc['length']===0x0){_0x2a0e7c[_0x4190dd(0xeb2)]=_0x4190dd(0x41d);return;}_0xc5f2fc['forEach']((_0x5471da,_0x24ed3d)=>{const _0x35d68d=_0x4190dd,_0x4943e5=document[_0x35d68d(0xe94)](_0x35d68d(0x8ca));_0x4943e5['className']=_0x35d68d(0x4a7),_0x4943e5['title']=_0x5471da[_0x35d68d(0x1561)],_0x4943e5[_0x35d68d(0xeb2)]=_0x35d68d(0x2a4)+_0x5471da[_0x35d68d(0x121f)]+_0x35d68d(0x917)+_0x5471da[_0x35d68d(0x1561)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0x185361=document['createElement'](_0x35d68d(0x8ca));_0x185361[_0x35d68d(0x1487)]=_0x35d68d(0x1441),_0x185361[_0x35d68d(0xeb2)]='×',_0x185361[_0x35d68d(0x20f)][_0x35d68d(0x115d)]=_0x35d68d(0x10c8),_0x185361['onclick']=async _0x45fba5=>{const _0x3b90fe=_0x35d68d;_0x45fba5['stopPropagation']();const _0xa84c77=await _0x2c9509(_0x3b90fe(0xa02),_0x3b90fe(0xbfd)+_0x5471da[_0x3b90fe(0x1561)]+_0x3b90fe(0x12f4),{'confirmButtonClass':'btn-danger'});_0xa84c77&&(_0x231b2c[_0x3b90fe(0x450)]['groupAvatarLibrary'][_0x3b90fe(0x15b0)](_0x24ed3d,0x1),await _0x512070[_0x3b90fe(0xb04)]['put'](_0x231b2c),_0x35ded3());},_0x4943e5[_0x35d68d(0x983)](_0x185361),_0x2a0e7c['appendChild'](_0x4943e5);});}async function _0x156300(){const _0x37f903=_0x48bc6d,_0xb136d7=await _0x3ab788('添加头像','请为这个头像起个名字（例如：春日野餐、学习时间）');if(!_0xb136d7||!_0xb136d7[_0x37f903(0x13f9)]())return;const _0x53db07=await _0x3ab788(_0x37f903(0x56f),_0x37f903(0x14d7),'',_0x37f903(0x121f));if(!_0x53db07||!_0x53db07['trim']()[_0x37f903(0x608)](_0x37f903(0x978))){alert('请输入有效的图片URL！');return;}const _0x580f1c=_0x19ddb8[_0x37f903(0xb04)][_0x19ddb8[_0x37f903(0x859)]];!_0x580f1c['settings'][_0x37f903(0x284)]&&(_0x580f1c[_0x37f903(0x450)][_0x37f903(0x284)]=[]),_0x580f1c[_0x37f903(0x450)][_0x37f903(0x284)]['push']({'name':_0xb136d7[_0x37f903(0x13f9)](),'url':_0x53db07[_0x37f903(0x13f9)]()}),await _0x512070[_0x37f903(0xb04)][_0x37f903(0xd4d)](_0x580f1c),_0x35ded3();}function _0x38e133(){const _0xfcafd4=_0x48bc6d;document[_0xfcafd4(0x9a3)](_0xfcafd4(0x680))[_0xfcafd4(0x4d8)][_0xfcafd4(0x133d)]('visible');}async function _0x395242(_0x49a76f){const _0x25bb27=_0x48bc6d,_0x42e1c1=_0x25bb27(0x1500),_0x2948e1=await _0x3ab788(_0x25bb27(0xa89),_0x42e1c1,'','textarea');_0x2948e1&&_0x2948e1['trim']()&&await _0x894022(_0x49a76f,_0x2948e1);}async function _0x894022(_0x50eb42,_0x2dc846){const _0x24f72b=_0x48bc6d,_0x5dc59d=_0x19ddb8['chats'][_0x19ddb8[_0x24f72b(0x859)]];if(!_0x5dc59d)return;const _0x50d906=_0x2dc846[_0x24f72b(0x13f9)]()[_0x24f72b(0x1536)]('\x0a'),_0x3e678c=[],_0x17227a=_0x24f72b(0xc2f);let _0x4a017f=0x0;for(const _0x2a0457 of _0x50d906){const _0x52131e=_0x2a0457['trim']();if(!_0x52131e||_0x52131e[_0x24f72b(0x478)]('http')||_0x52131e['includes']('填入'))continue;let _0x293446=null,_0xe4457=null;const _0x4a5ce0=_0x52131e['match'](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x4a5ce0)_0x293446=_0x4a5ce0[0x1],_0xe4457=_0x4a5ce0[0x2];else{const _0x568db4=_0x52131e[_0x24f72b(0x1536)](/\s+/);_0x568db4[_0x24f72b(0x106b)]>=0x2&&(_0xe4457=_0x568db4[_0x24f72b(0x144a)](),_0x293446=_0x568db4[_0x24f72b(0x3b9)]('\x20'));}_0x293446&&_0xe4457&&_0xe4457[_0x24f72b(0x478)]('.')?_0x3e678c['push']({'name':_0x293446,'url':_0x17227a+_0xe4457}):(_0x4a017f++,console[_0x24f72b(0x651)]('批量导入格式错误，已跳过此行:',_0x52131e));}_0x4a017f>0x0&&await _0x403a62('部分导入失败','有\x20'+_0x4a017f+'\x20行的格式不正确，已被系统跳过。');if(_0x3e678c[_0x24f72b(0x106b)]>0x0){if(_0x50eb42==='ai'){if(!_0x5dc59d['settings']['aiAvatarLibrary'])_0x5dc59d[_0x24f72b(0x450)][_0x24f72b(0xea2)]=[];_0x5dc59d[_0x24f72b(0x450)][_0x24f72b(0xea2)][_0x24f72b(0x1c4)](..._0x3e678c),await _0x512070[_0x24f72b(0xb04)]['put'](_0x5dc59d),_0x4462e2();}else{if(_0x50eb42===_0x24f72b(0xf67)){if(!_0x5dc59d['settings'][_0x24f72b(0x284)])_0x5dc59d[_0x24f72b(0x450)][_0x24f72b(0x284)]=[];_0x5dc59d[_0x24f72b(0x450)][_0x24f72b(0x284)][_0x24f72b(0x1c4)](..._0x3e678c),await _0x512070[_0x24f72b(0xb04)][_0x24f72b(0xd4d)](_0x5dc59d),_0x35ded3();}}await _0x403a62(_0x24f72b(0x90b),_0x24f72b(0xa66)+_0x3e678c[_0x24f72b(0x106b)]+_0x24f72b(0x933));}else _0x4a017f===0x0&&alert(_0x24f72b(0x101b));}async function _0x76e42b(){const _0x443f13=_0x48bc6d,_0x1728c6=await _0x3ab788(_0x443f13(0x56f),_0x443f13(0x61b));if(!_0x1728c6||!_0x1728c6['trim']())return;const _0x4b2048=await _0x3ab788(_0x443f13(0x56f),'请输入头像的图片URL','',_0x443f13(0x121f));if(!_0x4b2048||!_0x4b2048[_0x443f13(0x13f9)]()[_0x443f13(0x608)](_0x443f13(0x978))){alert(_0x443f13(0xbfa));return;}const _0x145f15=_0x19ddb8[_0x443f13(0xb04)][_0x19ddb8['activeChatId']];!_0x145f15[_0x443f13(0x450)][_0x443f13(0x284)]&&(_0x145f15[_0x443f13(0x450)][_0x443f13(0x284)]=[]),_0x145f15[_0x443f13(0x450)][_0x443f13(0x284)][_0x443f13(0x1c4)]({'name':_0x1728c6[_0x443f13(0x13f9)](),'url':_0x4b2048[_0x443f13(0x13f9)]()}),await _0x512070[_0x443f13(0xb04)][_0x443f13(0xd4d)](_0x145f15),_0x35ded3();}function _0x33ea90(_0x5a61bf){return new Promise(_0x2e377d=>{const _0x26caa4=_0x1efc,_0x18db2a=document['getElementById'](_0x26caa4(0x8ac)),_0x146609=document['getElementById']('chat-list-action-pin'),_0x48b5b0=document[_0x26caa4(0x9a3)](_0x26caa4(0x1346)),_0x598bd9=document[_0x26caa4(0x9a3)](_0x26caa4(0x143d));_0x146609[_0x26caa4(0x766)]=_0x5a61bf[_0x26caa4(0x14d8)]?_0x26caa4(0x585):_0x26caa4(0xc4f);const _0x4fba64=_0x146609[_0x26caa4(0x173)](!![]);_0x146609['parentNode'][_0x26caa4(0x15ab)](_0x4fba64,_0x146609),_0x4fba64['onclick']=()=>{const _0x9c20a1=_0x26caa4;_0x18db2a[_0x9c20a1(0x4d8)][_0x9c20a1(0x133d)]('visible'),_0x2e377d('pin');};const _0x41d282=_0x48b5b0['cloneNode'](!![]);_0x48b5b0[_0x26caa4(0x5eb)][_0x26caa4(0x15ab)](_0x41d282,_0x48b5b0),_0x41d282[_0x26caa4(0x4ce)]=()=>{const _0x3d8424=_0x26caa4;_0x18db2a[_0x3d8424(0x4d8)]['remove']('visible'),_0x2e377d('delete');};const _0xf837b0=_0x598bd9[_0x26caa4(0x173)](!![]);_0x598bd9['parentNode']['replaceChild'](_0xf837b0,_0x598bd9),_0xf837b0[_0x26caa4(0x4ce)]=()=>{const _0x2cb63d=_0x26caa4;_0x18db2a[_0x2cb63d(0x4d8)]['remove'](_0x2cb63d(0xc09)),_0x2e377d(null);},_0x18db2a[_0x26caa4(0x4d8)][_0x26caa4(0xe05)]('visible');});}function _0x1b6cea(){const _0x151cf5=_0x48bc6d,_0x29df67=document[_0x151cf5(0x9a3)]('character-phone-screen'),_0x40107b=_0x19ddb8[_0x151cf5(0x4c8)][_0x151cf5(0x831)];_0x40107b?_0x29df67['style']['backgroundImage']=_0x151cf5(0x55b)+_0x40107b+')':_0x29df67[_0x151cf5(0x20f)][_0x151cf5(0x1090)]=_0x151cf5(0x28b);}function _0x2c06c4(){const _0x5c01ec=_0x48bc6d;if(!_0x19ddb8[_0x5c01ec(0x4c8)][_0x5c01ec(0xa4e)])return;for(const _0xcbd5c7 in _0x19ddb8['globalSettings']['cphoneAppIcons']){const _0x1ac1ae=document[_0x5c01ec(0x9a3)](_0x5c01ec(0xb58)+_0xcbd5c7);_0x1ac1ae&&(_0x1ac1ae[_0x5c01ec(0x10d4)]=_0x19ddb8['globalSettings']['cphoneAppIcons'][_0xcbd5c7]);}}function _0x4354d3(){const _0x374747=_0x48bc6d,_0x2b8782=document[_0x374747(0x9a3)](_0x374747(0x563));if(!_0x2b8782)return;_0x2b8782[_0x374747(0xeb2)]='';const _0x475036={'qq':'QQ','album':'相册','browser':_0x374747(0x213),'taobao':'淘宝','memo':_0x374747(0x1462),'diary':'日记','amap':_0x374747(0x720),'usage':'App记录','music':'网易云','ephone':_0x374747(0xe4c)};for(const _0x2ed39f in _0x19ddb8['globalSettings'][_0x374747(0xa4e)]){const _0x5f29ea=_0x19ddb8[_0x374747(0x4c8)][_0x374747(0xa4e)][_0x2ed39f],_0x92bb7f=_0x475036[_0x2ed39f]||'未知App',_0x46b749=document[_0x374747(0xe94)](_0x374747(0x8ca));_0x46b749[_0x374747(0x1487)]='icon-setting-item',_0x46b749[_0x374747(0xd8d)][_0x374747(0x384)]=_0x2ed39f,_0x46b749[_0x374747(0xeb2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22icon-preview\x22\x20src=\x22'+_0x5f29ea+'\x22\x20alt=\x22'+_0x92bb7f+_0x374747(0x623),_0x2b8782['appendChild'](_0x46b749);}}function _0xe2a513(){const _0x56429a=_0x48bc6d;if(!_0x19ddb8[_0x56429a(0x4c8)][_0x56429a(0xbb4)])return;for(const _0x4edcb5 in _0x19ddb8[_0x56429a(0x4c8)][_0x56429a(0xbb4)]){const _0xde8a91=document[_0x56429a(0x9a3)](_0x56429a(0x424)+_0x4edcb5);_0xde8a91&&(_0xde8a91[_0x56429a(0x10d4)]=_0x19ddb8[_0x56429a(0x4c8)][_0x56429a(0xbb4)][_0x4edcb5]);}}function _0x1827fe(){const _0x5312c8=_0x48bc6d,_0x1d9b9f=document[_0x5312c8(0x9a3)]('icon-settings-grid');if(!_0x1d9b9f)return;_0x1d9b9f['innerHTML']='';const _0x2babbb={'qq':'QQ','world-book':'世界书','wallpaper':_0x5312c8(0x11f6),'renderer':_0x5312c8(0xa4b),'api-settings':'API设置','font':'字体','char-phone':_0x5312c8(0x1362),'douban':_0x5312c8(0x375),'preset':'预设','tutorial':'教程','werewolf':'狼人杀','x':'X'};for(const _0x5ea2f9 in _0x19ddb8[_0x5312c8(0x4c8)][_0x5312c8(0xbb4)]){const _0x36b600=_0x19ddb8[_0x5312c8(0x4c8)]['appIcons'][_0x5ea2f9],_0x45076d=_0x2babbb[_0x5ea2f9]||_0x5312c8(0x1362),_0x2c40db=document['createElement'](_0x5312c8(0x8ca));_0x2c40db['className']=_0x5312c8(0x9a4),_0x2c40db[_0x5312c8(0xd8d)][_0x5312c8(0x384)]=_0x5ea2f9,_0x2c40db[_0x5312c8(0xeb2)]=_0x5312c8(0xbb0)+_0x36b600+'\x22\x20alt=\x22'+_0x45076d+_0x5312c8(0x623),_0x1d9b9f[_0x5312c8(0x983)](_0x2c40db);}}function _0x4fe280(_0x48d439){const _0x310f0c=_0x48bc6d;if(!_0x19ddb8[_0x310f0c(0x859)])return;const _0x52ac37=_0x19ddb8['chats'][_0x19ddb8['activeChatId']];if(!_0x52ac37||!_0x52ac37[_0x310f0c(0x1f0)])return;const _0x3a86a9=_0x52ac37['history']['find'](_0x19e504=>_0x19e504[_0x310f0c(0xd73)]===_0x48d439);if(!_0x3a86a9||_0x3a86a9[_0x310f0c(0x1508)]!=='share_link'){console[_0x310f0c(0x3b7)](_0x310f0c(0x50c),_0x48d439);return;}document['getElementById'](_0x310f0c(0x4e1))[_0x310f0c(0x766)]=_0x3a86a9[_0x310f0c(0xc48)]||_0x310f0c(0xc1e);const _0x5dfee0=document[_0x310f0c(0x9a3)](_0x310f0c(0x1202));_0x5dfee0['innerHTML']=_0x310f0c(0x216)+(_0x3a86a9[_0x310f0c(0x10b8)]||_0x310f0c(0x7c6))+_0x310f0c(0x44b)+(_0x3a86a9[_0x310f0c(0xc48)]||'未知')+_0x310f0c(0x1190)+(_0x3a86a9['content']||_0x310f0c(0x1314))[_0x310f0c(0x1bb)](/\n/g,_0x310f0c(0x8bd))+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x35df44(_0x310f0c(0xa8f));}function _0x3f1c75(){const _0x4d5266=_0x48bc6d;_0x35df44(_0x4d5266(0x3e5));}function _0x3f1c75(){const _0x41fabe=_0x48bc6d;_0x35df44(_0x41fabe(0x3e5));}function _0x34f6ba(){const _0x26204c=_0x48bc6d;if(!_0x19ddb8[_0x26204c(0x859)])return;document[_0x26204c(0x9a3)](_0x26204c(0x1375))[_0x26204c(0x7b2)]='',document[_0x26204c(0x9a3)](_0x26204c(0x8b0))[_0x26204c(0x7b2)]='',document[_0x26204c(0x9a3)](_0x26204c(0xbe7))[_0x26204c(0x7b2)]='',document['getElementById'](_0x26204c(0xaab))[_0x26204c(0x7b2)]='',document[_0x26204c(0x9a3)]('share-link-modal')['classList'][_0x26204c(0xe05)](_0x26204c(0xc09));}async function _0x300946(){const _0x2a413e=_0x48bc6d;if(!_0x19ddb8['activeChatId'])return;const _0x3eee3f=document[_0x2a413e(0x9a3)](_0x2a413e(0x1375))[_0x2a413e(0x7b2)]['trim']();if(!_0x3eee3f){alert(_0x2a413e(0x159d));return;}const _0x541546=document[_0x2a413e(0x9a3)](_0x2a413e(0x8b0))[_0x2a413e(0x7b2)][_0x2a413e(0x13f9)](),_0x3030d0=document[_0x2a413e(0x9a3)]('link-source-input')[_0x2a413e(0x7b2)]['trim'](),_0x4ccd56=document[_0x2a413e(0x9a3)](_0x2a413e(0xaab))[_0x2a413e(0x7b2)][_0x2a413e(0x13f9)](),_0x4c24b6=_0x19ddb8[_0x2a413e(0xb04)][_0x19ddb8['activeChatId']],_0x1f1d09={'role':_0x2a413e(0x20d),'type':_0x2a413e(0x721),'timestamp':Date[_0x2a413e(0x64b)](),'title':_0x3eee3f,'description':_0x541546,'source_name':_0x3030d0,'content':_0x4ccd56,'thumbnail_url':null};_0x4c24b6[_0x2a413e(0x1f0)][_0x2a413e(0x1c4)](_0x1f1d09),await _0x512070[_0x2a413e(0xb04)][_0x2a413e(0xd4d)](_0x4c24b6),_0x1ef393(_0x1f1d09,_0x4c24b6),_0xec8072(),document[_0x2a413e(0x9a3)](_0x2a413e(0xa31))[_0x2a413e(0x4d8)]['remove']('visible');}function _0x35b975(_0x4ddb12,_0x1897e2){const _0x3912e7=_0x48bc6d;if(!_0x1897e2||!_0x1897e2['id'])return[];const _0x140147=_0x1897e2[_0x3912e7(0x4ab)],_0x3083f9=_0x1897e2['id'];return _0x4ddb12[_0x3912e7(0x1195)](_0x4c70d2=>{const _0x3c5af9=_0x3912e7;if(_0x4c70d2[_0x3c5af9(0x82c)]===_0x3c5af9(0x20d)){if(_0x4c70d2[_0x3c5af9(0x1364)]&&_0x4c70d2[_0x3c5af9(0x1364)][_0x3c5af9(0x106b)]>0x0)return _0x140147&&_0x4c70d2['visibleGroupIds'][_0x3c5af9(0x478)](_0x140147);return!![];}if(String(_0x4c70d2[_0x3c5af9(0x82c)])[_0x3c5af9(0x608)]('npc_')){if(Array[_0x3c5af9(0xb9b)](_0x4c70d2[_0x3c5af9(0x4be)]))return _0x4c70d2[_0x3c5af9(0x4be)]['includes'](_0x3083f9);return![];}const _0x609f76=_0x19ddb8[_0x3c5af9(0xb04)][_0x4c70d2['authorId']];if(!_0x609f76)return![];const _0x1fda7f=_0x609f76[_0x3c5af9(0x4ab)],_0x1b0ab5=_0x1fda7f&&_0x140147&&_0x1fda7f===_0x140147,_0x34ecf2=!_0x1fda7f&&!_0x140147;return _0x1b0ab5||_0x34ecf2;});}function _0x585f8c(_0x18c5ae){const _0x15dc42=_0x48bc6d;document[_0x15dc42(0x7c3)][_0x15dc42(0x4d8)]['toggle'](_0x15dc42(0xa76),_0x18c5ae);if(_0x4e0631[_0x15dc42(0x1412)]){const _0x573bac=document['getElementById'](_0x15dc42(0x1386)),_0x513bfa=document[_0x15dc42(0x9a3)](_0x15dc42(0xae7)),_0x589340=_0x19ddb8[_0x15dc42(0x4c8)]['alwaysShowMusicIsland']||![];_0x18c5ae?(_0x573bac['classList'][_0x15dc42(0x133d)](_0x15dc42(0xc09)),_0x513bfa['classList'][_0x15dc42(0xe05)](_0x15dc42(0xf13))):(_0x513bfa[_0x15dc42(0x4d8)][_0x15dc42(0x133d)]('dynamic-island-active'),_0x589340?(_0x513bfa[_0x15dc42(0x4d8)][_0x15dc42(0xe05)](_0x15dc42(0xf13)),_0x573bac[_0x15dc42(0x4d8)][_0x15dc42(0x133d)](_0x15dc42(0xc09))):_0x4e0631[_0x15dc42(0xa1d)]&&_0x4e0631[_0x15dc42(0xa1d)][_0x15dc42(0x106b)]>0x0&&_0x573bac['classList'][_0x15dc42(0xe05)]('visible'));}}function _0x5833f8(_0x17099b){const _0x58c3ca=_0x48bc6d;document[_0x58c3ca(0x7c3)][_0x58c3ca(0x4d8)][_0x58c3ca(0xc02)](_0x58c3ca(0x4ae),_0x17099b);}function _0x432678(_0x31357a){const _0x709948=_0x48bc6d;document['body'][_0x709948(0x4d8)][_0x709948(0xc02)](_0x709948(0xb4c),_0x31357a);}function _0x16496f(_0x357136){const _0x550830=_0x48bc6d,_0x3b7365=document[_0x550830(0x9a3)]('phone-screen'),_0x36270d=document[_0x550830(0x9a3)](_0x550830(0xfa8)),_0x4a3e88=_0x357136===_0x550830(0x1449);_0x3b7365['classList']['toggle']('dark-mode',_0x4a3e88),_0x36270d&&(_0x36270d[_0x550830(0x944)]=_0x4a3e88),localStorage[_0x550830(0x28a)](_0x550830(0x136d),_0x357136);}function _0x34d679(){const _0x23b0dc=document['getElementById']('theme-toggle-switch'),_0x5666d4=_0x23b0dc['checked']?'dark':'light';_0x16496f(_0x5666d4);}function _0x5349c4(){const _0x409b00=_0x48bc6d;if(!_0x19ddb8[_0x409b00(0x859)])return;_0x2abdba(),_0x35df44(_0x409b00(0x14c1));}function _0x2abdba(){const _0x5429b0=_0x48bc6d,_0x508fcc=document[_0x5429b0(0x9a3)](_0x5429b0(0xeee)),_0xb1e013=_0x19ddb8[_0x5429b0(0xb04)][_0x19ddb8[_0x5429b0(0x859)]];_0x508fcc[_0x5429b0(0xeb2)]='';let _0x2733ee=[];_0xb1e013[_0x5429b0(0x136b)]?_0xb1e013[_0x5429b0(0xcca)][_0x5429b0(0x15c1)](_0x1e4692=>{const _0x36e287=_0x5429b0,_0x21fb4a=_0x19ddb8[_0x36e287(0xb04)][_0x1e4692['id']];if(_0x21fb4a&&_0x21fb4a[_0x36e287(0x744)]){const _0x196948=_0x21fb4a[_0x36e287(0x744)][_0x36e287(0xb0a)](_0xaac1cd=>({..._0xaac1cd,'authorName':_0x1e4692[_0x36e287(0xaf0)],'authorChatId':_0x1e4692['id']}));_0x2733ee[_0x36e287(0x1c4)](..._0x196948);}}):_0xb1e013[_0x5429b0(0x744)]&&(_0x2733ee=_0xb1e013[_0x5429b0(0x744)][_0x5429b0(0xb0a)](_0x1a16c6=>({..._0x1a16c6,'authorName':_0xb1e013[_0x5429b0(0x1561)],'authorChatId':_0xb1e013['id']})));if(_0x2733ee[_0x5429b0(0x106b)]===0x0){_0x508fcc[_0x5429b0(0xeb2)]=_0x5429b0(0x169);return;}_0x2733ee[_0x5429b0(0x6a2)]((_0x2c5251,_0x276287)=>_0x276287[_0x5429b0(0xd73)]-_0x2c5251[_0x5429b0(0xd73)]),_0x2733ee[_0x5429b0(0x15c1)]((_0x2c555a,_0x1757ba)=>{const _0x54bf56=_0x5429b0,_0x51278b=document[_0x54bf56(0xe94)](_0x54bf56(0x8ca));_0x51278b[_0x54bf56(0x1487)]=_0x54bf56(0x32e),_0x51278b['style']['cursor']=_0x54bf56(0xd5f),_0x51278b['innerHTML']=_0x54bf56(0x1340)+_0x2c555a[_0x54bf56(0x75c)]+_0x54bf56(0x8b9)+_0x2c555a[_0x54bf56(0x4e3)][_0x54bf56(0x1bb)](/\n/g,'<br>')+_0x54bf56(0xa01)+_0x2c555a[_0x54bf56(0xb69)]+_0x54bf56(0xed7)+_0x2c555a[_0x54bf56(0xd73)]+_0x54bf56(0x1d7)+_0x2c555a[_0x54bf56(0xb69)]+_0x54bf56(0xed7)+_0x2c555a[_0x54bf56(0xd73)]+'\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x508fcc[_0x54bf56(0x983)](_0x51278b);});}async function _0x2baeff(){const _0x754a37=_0x48bc6d,_0x4b05b8=_0x19ddb8['chats'][_0x19ddb8['activeChatId']];if(!_0x4b05b8)return;let _0x4d4e62=_0x4b05b8;if(_0x4b05b8[_0x754a37(0x136b)]){const _0x2a28a6=_0x4b05b8[_0x754a37(0xcca)][_0x754a37(0xb0a)](_0x24d6a7=>({'text':'为“'+_0x24d6a7['groupNickname']+_0x754a37(0xd57),'value':_0x24d6a7['id']})),_0x252f83=await _0x49acac(_0x754a37(0x852),_0x2a28a6);if(!_0x252f83)return;_0x4d4e62=_0x19ddb8[_0x754a37(0xb04)][_0x252f83];if(!_0x4d4e62){alert('错误：找不到该成员的个人档案。');return;}}const _0x47065e=await _0x3ab788('为“'+_0x4d4e62[_0x754a37(0x1561)]+'”添加记忆',_0x754a37(0xcea),'',_0x754a37(0x8db));if(_0x47065e&&_0x47065e[_0x754a37(0x13f9)]()){if(!_0x4d4e62['longTermMemory'])_0x4d4e62['longTermMemory']=[];_0x4d4e62['longTermMemory']['push']({'content':_0x47065e[_0x754a37(0x13f9)](),'timestamp':Date[_0x754a37(0x64b)](),'source':_0x754a37(0x8c5)}),await _0x512070['chats']['put'](_0x4d4e62),_0x2abdba();}}async function _0x160547(_0x549280,_0x28c7e9){const _0x584b36=_0x48bc6d,_0xd7ff41=_0x19ddb8[_0x584b36(0xb04)][_0x549280];if(!_0xd7ff41||!_0xd7ff41['longTermMemory'])return;const _0x3f3134=_0xd7ff41['longTermMemory']['findIndex'](_0xc35457=>_0xc35457['timestamp']===_0x28c7e9);if(_0x3f3134===-0x1)return;const _0x4957bd=_0xd7ff41['longTermMemory'][_0x3f3134],_0x26244b=await _0x3ab788(_0x584b36(0xe84),_0x584b36(0x703),_0x4957bd['content'],_0x584b36(0x8db));_0x26244b&&_0x26244b[_0x584b36(0x13f9)]()&&(_0x4957bd[_0x584b36(0x4e3)]=_0x26244b[_0x584b36(0x13f9)](),await _0x512070[_0x584b36(0xb04)]['put'](_0xd7ff41),_0x2abdba());}async function _0x458b91(_0x3f07b8,_0x524445){const _0xd85e76=_0x48bc6d,_0x1cd475=await _0x2c9509(_0xd85e76(0xd05),'确定要删除这条长期记忆吗？',{'confirmButtonClass':_0xd85e76(0xf5b)});if(_0x1cd475){const _0x364dbe=_0x19ddb8[_0xd85e76(0xb04)][_0x3f07b8];if(!_0x364dbe||!_0x364dbe[_0xd85e76(0x744)])return;_0x364dbe['longTermMemory']=_0x364dbe[_0xd85e76(0x744)][_0xd85e76(0x1195)](_0x2ce130=>_0x2ce130['timestamp']!==_0x524445),await _0x512070[_0xd85e76(0xb04)]['put'](_0x364dbe),_0x2abdba();}}async function _0x271eef(){const _0x2bb74b=_0x48bc6d,_0x118a89=await _0x2c9509(_0x2bb74b(0x6c3),_0x2bb74b(0x256));_0x118a89&&await _0x3fe133(_0x19ddb8['activeChatId'],!![]);}async function _0x31e1d8(_0x355563){const _0x4d1243=_0x48bc6d,_0x4a95bc=_0x19ddb8['chats'][_0x355563];if(!_0x4a95bc||!_0x4a95bc[_0x4d1243(0x450)][_0x4d1243(0x1525)])return;const _0x3bfeb0=_0x4a95bc[_0x4d1243(0x825)]||0x0,_0xac561d=_0x4a95bc['history']['filter'](_0x46d280=>_0x46d280[_0x4d1243(0xd73)]>_0x3bfeb0&&!_0x46d280[_0x4d1243(0x136e)]);_0xac561d[_0x4d1243(0x106b)]>=_0x4a95bc[_0x4d1243(0x450)][_0x4d1243(0xdf7)]&&(console['log'](_0x4d1243(0x7c0)+_0xac561d['length']+'/'+_0x4a95bc[_0x4d1243(0x450)][_0x4d1243(0xdf7)]+')，开始总结...'),await _0x3fe133(_0x355563));}async function _0xba159(_0x142877,_0x1ce89f){const _0x55dc8e=_0x48bc6d,_0x5b7dd2=_0x19ddb8['chats'][_0x142877];if(!_0x5b7dd2||!_0x1ce89f)throw new Error('基础数据不完整，无法开始总结。');const _0x45f879=_0x19ddb8[_0x55dc8e(0x9ce)][_0x55dc8e(0x246)]||'用户';let _0x32c0c0,_0x4308e1=_0x5b7dd2;const _0x55a697=new Date()[_0x55dc8e(0x7fd)](_0x55dc8e(0x15bc),{'year':'numeric','month':_0x55dc8e(0x9f8),'day':_0x55dc8e(0xc6a)});if(_0x5b7dd2[_0x55dc8e(0x136b)]){let _0x7ff7f6=null;_0x4acdaf[_0x55dc8e(0x488)]&&(_0x7ff7f6=_0x5b7dd2['members'][_0x55dc8e(0xd62)](_0x49af49=>_0x49af49['originalName']===_0x4acdaf['callRequester']));!_0x7ff7f6&&(_0x7ff7f6=_0x5b7dd2['members'][_0x55dc8e(0xd62)](_0x187c4b=>_0x187c4b['id']!==_0x55dc8e(0x20d)&&_0x4acdaf['participants'][_0x55dc8e(0x336)](_0x1e916a=>_0x1e916a['id']===_0x187c4b['id'])));!_0x7ff7f6&&(_0x7ff7f6=_0x5b7dd2[_0x55dc8e(0xcca)][_0x55dc8e(0xd62)](_0x597aab=>_0x597aab['id']!==_0x55dc8e(0x20d)));if(!_0x7ff7f6)throw new Error(_0x55dc8e(0xd4c));const _0x44f483=_0x19ddb8['chats'][_0x7ff7f6['id']];if(!_0x44f483)throw new Error('找不到主角\x20“'+_0x7ff7f6['groupNickname']+'”\x20的详细角色信息。');const _0x4606bd=_0x5b7dd2[_0x55dc8e(0x450)][_0x55dc8e(0x1e3)]||_0x55dc8e(0x1318);_0x32c0c0='\x0a#\x20你的任务\x0a你就是角色“'+_0x7ff7f6[_0x55dc8e(0x339)]+'”。请你回顾一下刚才和\x20“'+_0x45f879+_0x55dc8e(0xd13)+_0x55a697+_0x55dc8e(0x1559)+_0x55a697+_0x55dc8e(0xa1e)+_0x44f483[_0x55dc8e(0x450)][_0x55dc8e(0x1c3)]+_0x55dc8e(0x10c9)+_0x4606bd+_0x55dc8e(0xe83)+_0x1ce89f+_0x55dc8e(0x70b)+_0x7ff7f6['originalName']+_0x55dc8e(0x125f),_0x4308e1=_0x44f483;}else _0x32c0c0=_0x55dc8e(0xfa2)+_0x5b7dd2[_0x55dc8e(0x339)]+_0x55dc8e(0x8e7)+_0x45f879+_0x55dc8e(0x124f)+_0x55a697+_0x55dc8e(0x15da)+_0x55a697+_0x55dc8e(0x66b)+_0x5b7dd2[_0x55dc8e(0x450)]['aiPersona']+_0x55dc8e(0x10c9)+_0x5b7dd2[_0x55dc8e(0x450)][_0x55dc8e(0x1e3)]+'\x0a\x0a#\x20待总结的视频通话记录\x0a'+_0x1ce89f+_0x55dc8e(0x70b)+_0x5b7dd2['originalName']+'”的身份，开始你的客观总结。';try{const _0x4c608f=_0x19ddb8[_0x55dc8e(0xd22)][_0x55dc8e(0x132b)]&&_0x19ddb8[_0x55dc8e(0xd22)][_0x55dc8e(0x278)]&&_0x19ddb8[_0x55dc8e(0xd22)][_0x55dc8e(0xa20)],{proxyUrl:_0x36d338,apiKey:_0xd08ff8,model:_0x2efdab}=_0x4c608f?{'proxyUrl':_0x19ddb8['apiConfig']['secondaryProxyUrl'],'apiKey':_0x19ddb8[_0x55dc8e(0xd22)][_0x55dc8e(0x278)],'model':_0x19ddb8[_0x55dc8e(0xd22)]['secondaryModel']}:_0x19ddb8[_0x55dc8e(0xd22)];if(!_0x36d338||!_0xd08ff8||!_0x2efdab)throw new Error(_0x55dc8e(0x176));let _0x31d745=_0x36d338[_0x55dc8e(0x478)](_0x55dc8e(0x1329)),_0x243df0=_0x366263(_0x2efdab,_0xd08ff8,_0x32c0c0,[{'role':'user','content':_0x55dc8e(0x8bb)}]);const _0x58d0b9=_0x31d745?await fetch(_0x243df0[_0x55dc8e(0x121f)],_0x243df0[_0x55dc8e(0x38c)]):await fetch(_0x36d338+_0x55dc8e(0x501),{'method':'POST','headers':{'Content-Type':_0x55dc8e(0xb1f),'Authorization':_0x55dc8e(0x1265)+_0xd08ff8},'body':JSON[_0x55dc8e(0xe1e)]({'model':_0x2efdab,'messages':[{'role':'system','content':_0x32c0c0},{'role':'user','content':'请开始总结。'}],'temperature':0.1})});if(!_0x58d0b9['ok']){const _0x4e507a=await _0x58d0b9[_0x55dc8e(0xa5d)]()['catch'](()=>({'error':{'message':_0x58d0b9['statusText']}}));throw new Error(_0x55dc8e(0xbc6)+_0x58d0b9['status']+_0x55dc8e(0x1452)+_0x4e507a[_0x55dc8e(0x3b7)][_0x55dc8e(0xcce)]);}const _0x2b41da=await _0x58d0b9[_0x55dc8e(0xa5d)]();let _0x177c1d=_0x31d745?getGeminiResponseText(_0x2b41da):_0x2b41da[_0x55dc8e(0x21f)][0x0][_0x55dc8e(0xcce)][_0x55dc8e(0x4e3)];_0x177c1d=_0x177c1d[_0x55dc8e(0x1bb)](/^```json\s*/,'')['replace'](/```$/,'')[_0x55dc8e(0x13f9)]();const _0x2fe0bd=JSON['parse'](_0x177c1d);if(_0x2fe0bd[_0x55dc8e(0x114b)]&&_0x2fe0bd['summary']['trim']()){const _0x4a95b0={'content':_0x55dc8e(0x167)+(_0x5b7dd2[_0x55dc8e(0x136b)]?'群聊':'')+_0x55dc8e(0xa38)+_0x2fe0bd[_0x55dc8e(0x114b)]['trim']()+')','timestamp':Date[_0x55dc8e(0x64b)](),'source':_0x5b7dd2['isGroup']?_0x55dc8e(0x126a):_0x55dc8e(0x1403)};if(!_0x4308e1[_0x55dc8e(0x744)])_0x4308e1[_0x55dc8e(0x744)]=[];return _0x4308e1[_0x55dc8e(0x744)][_0x55dc8e(0x1c4)](_0x4a95b0),await _0x512070[_0x55dc8e(0xb04)][_0x55dc8e(0xd4d)](_0x4308e1),console[_0x55dc8e(0xe4d)]('通话记录已成功总结并存入角色“'+_0x4308e1[_0x55dc8e(0x1561)]+'”的长期记忆中。'),!![];}else throw new Error('AI返回了空的或格式不正确的总结内容。');}catch(_0xe9dac4){console[_0x55dc8e(0x3b7)](_0x55dc8e(0x8a0),_0xe9dac4);throw _0xe9dac4;}}function _0x1f33b7(_0x3be40e){const _0x46dde1=_0x48bc6d,_0x3d1cae=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯','什么','怎么',_0x46dde1(0x1220),'哪个','一些','这个','那个','还有']),_0x2d0394=_0x3be40e[_0x46dde1(0x293)](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x4c1bb7=new Map();let _0x1d6140=0x0;_0x2d0394[_0x46dde1(0x15c1)](_0x12838a=>{const _0x22fafa=_0x46dde1;if(_0x12838a['length']>0x1&&!_0x3d1cae[_0x22fafa(0x1472)](_0x12838a)){const _0x4b5c69=(_0x4c1bb7[_0x22fafa(0x14ee)](_0x12838a)||0x0)+0x1;_0x4c1bb7[_0x22fafa(0x1177)](_0x12838a,_0x4b5c69);if(_0x4b5c69>_0x1d6140)_0x1d6140=_0x4b5c69;}});const _0x474bc9=[],_0x5c947b=[],_0x48f46f=_0x1d6140*0.9,_0x4b9d24=_0x1d6140*0.6;_0x4c1bb7[_0x46dde1(0x15c1)]((_0x1f77f1,_0x18bbcd)=>{const _0x53c1d1=_0x46dde1;if(_0x1f77f1>=_0x48f46f)_0x474bc9[_0x53c1d1(0x1c4)](_0x18bbcd);else _0x1f77f1>=_0x4b9d24&&_0x5c947b[_0x53c1d1(0x1c4)](_0x18bbcd);});const _0x23a391=new Set(_0x474bc9),_0x2222bb=_0x5c947b['filter'](_0x4b4d8d=>!_0x23a391[_0x46dde1(0x1472)](_0x4b4d8d))[_0x46dde1(0x457)](0x0,0x5);return{'coreKeywords':_0x474bc9['slice'](0x0,0x3),'situationalKeywords':_0x2222bb};}function _0x54310e(_0x1c0b6f,_0x205341,_0x31039c){const _0x6f7076=_0x48bc6d;let _0x1de127;_0x31039c===_0x6f7076(0xb41)?_0x1de127=Date[_0x6f7076(0x64b)]()-_0x205341*0x3c*0x3c*0x3e8:_0x1de127=Date[_0x6f7076(0x64b)]()-_0x205341*0x18*0x3c*0x3c*0x3e8;const _0x4934f2=_0x1c0b6f[_0x6f7076(0x1f0)][_0x6f7076(0x1195)](_0x2a2bff=>_0x2a2bff[_0x6f7076(0xd73)]>_0x1de127&&!_0x2a2bff[_0x6f7076(0x136e)]);if(_0x4934f2['length']<0x3)return'';const _0x2fdead=_0x4934f2['map'](_0xad5fe5=>{const _0x517744=_0x6f7076;if(typeof _0xad5fe5[_0x517744(0x4e3)]==='string')return _0xad5fe5['content'];if(_0xad5fe5[_0x517744(0x1508)]===_0x517744(0x1207))return _0xad5fe5[_0x517744(0x4e3)];if(_0xad5fe5['type']===_0x517744(0x12fb))return(_0xad5fe5[_0x517744(0x103d)]||'')+'\x20'+(_0xad5fe5[_0x517744(0x3ef)]||'');return'';})[_0x6f7076(0x3b9)]('\x20'),_0xa1e8aa=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯']),_0x228a9f=_0x2fdead[_0x6f7076(0x293)](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x1b9568=new Map();_0x228a9f['forEach'](_0x426b7a=>{const _0x1d050d=_0x6f7076;_0x426b7a[_0x1d050d(0x106b)]>0x1&&!_0xa1e8aa[_0x1d050d(0x1472)](_0x426b7a)&&_0x1b9568[_0x1d050d(0x1177)](_0x426b7a,(_0x1b9568['get'](_0x426b7a)||0x0)+0x1);});const _0x1de19f=[..._0x1b9568[_0x6f7076(0x10c3)]()]['sort']((_0x30aa4a,_0xa305bf)=>_0xa305bf[0x1]-_0x30aa4a[0x1])[_0x6f7076(0xb0a)](_0x50279e=>_0x50279e[0x0]);if(_0x1de19f[_0x6f7076(0x106b)]===0x0)return'';let _0x383c76;return _0x31039c===_0x6f7076(0xb41)?_0x383c76='最近'+_0x205341+'小时核心议题':_0x205341===0x1?_0x383c76=_0x6f7076(0x6e0):_0x383c76='最近'+_0x205341+_0x6f7076(0x238),_0x6f7076(0x1334)+_0x383c76+_0x6f7076(0xe3f)+_0x1de19f[_0x6f7076(0x457)](0x0,0x3)[_0x6f7076(0x3b9)]('、\x20')+_0x6f7076(0x86e);}function _0x2fb0a3(_0x1f72bd){const _0x4df880=_0x48bc6d;if(!_0x1f72bd||typeof _0x1f72bd!==_0x4df880(0x86c))return null;const _0x36eccc=_0x1f72bd[_0x4df880(0x1bb)](/^```json\s*/,'')['replace'](/```$/,'')[_0x4df880(0x13f9)](),_0x43e8e1=_0x36eccc[_0x4df880(0x293)](/{[\s\S]*}/);if(_0x43e8e1)try{const _0x3179e6=JSON[_0x4df880(0x1447)](_0x43e8e1[0x0]);return console[_0x4df880(0xe4d)](_0x4df880(0xc8c)),_0x3179e6;}catch(_0x5a8d96){console[_0x4df880(0x651)]('容错解析：策略1失败\x20(找到了JSON块，但格式错误)，将尝试策略2...');}const _0x3ce107=_0x36eccc[_0x4df880(0x293)](/"summary"\s*:\s*"((?:[^"\\]|\\.)*)"/);if(_0x3ce107&&_0x3ce107[0x1])return console[_0x4df880(0xe4d)](_0x4df880(0x13f6)),{'summary':_0x3ce107[0x1][_0x4df880(0x1bb)](/\\"/g,'\x22')};if(_0x36eccc)return console[_0x4df880(0xe4d)]('容错解析：策略3成功\x20(将整个返回文本作为摘要)'),{'summary':_0x36eccc};return null;}async function _0x2dbfd5(_0x39693c){const _0x38bffc=_0x48bc6d;let _0x5157a4=_0x19ddb8['chats'][_0x39693c];if(!_0x5157a4)return;let _0x210d56=_0x5157a4;if(_0x5157a4[_0x38bffc(0x136b)]){const _0x3d2aa6=_0x5157a4['members'][_0x38bffc(0xb0a)](_0x23d4d2=>{const _0x1b3766=_0x38bffc,_0x249b9b=_0x19ddb8[_0x1b3766(0xb04)][_0x23d4d2['id']];if(_0x249b9b&&_0x249b9b[_0x1b3766(0x744)]&&_0x249b9b[_0x1b3766(0x744)]['length']>=0x2)return{'text':_0x1b3766(0x1225)+_0x23d4d2['groupNickname']+'”的记忆\x20('+_0x249b9b[_0x1b3766(0x744)][_0x1b3766(0x106b)]+'条)','value':_0x23d4d2['id']};return null;})[_0x38bffc(0x1195)](Boolean);if(_0x3d2aa6[_0x38bffc(0x106b)]===0x0){alert(_0x38bffc(0x13be));return;}const _0x1bbc29=await _0x49acac(_0x38bffc(0xf57),_0x3d2aa6);if(!_0x1bbc29)return;_0x210d56=_0x19ddb8[_0x38bffc(0xb04)][_0x1bbc29];}if(!_0x210d56[_0x38bffc(0x744)]||_0x210d56[_0x38bffc(0x744)][_0x38bffc(0x106b)]<0x2){alert('“'+_0x210d56[_0x38bffc(0x1561)]+_0x38bffc(0x10ce));return;}const _0x255c92=_0x210d56[_0x38bffc(0x744)][_0x38bffc(0x106b)],_0x14f509=await _0x49acac(_0x38bffc(0x1510),[{'text':_0x38bffc(0xe28)+_0x255c92+'条)','value':_0x38bffc(0xbf1)},{'text':_0x38bffc(0x6c7),'value':'20'},{'text':_0x38bffc(0xf9f),'value':'50'},{'text':_0x38bffc(0x1358),'value':_0x38bffc(0x10d6)},{'text':_0x38bffc(0x1097),'value':_0x38bffc(0xbe4)}][_0x38bffc(0x1195)](_0x2cee9c=>_0x2cee9c[_0x38bffc(0x7b2)]===_0x38bffc(0xbf1)||_0x2cee9c['value']===_0x38bffc(0xbe4)||parseInt(_0x2cee9c['value'])<_0x255c92));if(_0x14f509===null)return;let _0x463cc0,_0x21d1f6=_0x255c92;if(_0x14f509===_0x38bffc(0xbf1))_0x463cc0=[..._0x210d56[_0x38bffc(0x744)]];else{if(_0x14f509===_0x38bffc(0xbe4)){const _0x5646ff=await _0x3ab788('自定义数量',_0x38bffc(0xcb5)+_0x255c92+_0x38bffc(0xb91));if(_0x5646ff===null)return;const _0x579306=parseInt(_0x5646ff);if(isNaN(_0x579306)||_0x579306<0x2||_0x579306>_0x255c92){alert(_0x38bffc(0x11e2)+_0x255c92+_0x38bffc(0xa0c));return;}_0x21d1f6=_0x579306,_0x463cc0=_0x210d56[_0x38bffc(0x744)][_0x38bffc(0x457)](-_0x21d1f6);}else _0x21d1f6=parseInt(_0x14f509),_0x21d1f6>=_0x255c92?(_0x463cc0=[..._0x210d56[_0x38bffc(0x744)]],_0x21d1f6=_0x255c92):_0x463cc0=_0x210d56['longTermMemory'][_0x38bffc(0x457)](-_0x21d1f6);}const _0x3eda54=await _0x3ab788(_0x38bffc(0xc52),_0x38bffc(0x10b6),'150');if(_0x3eda54===null)return;const _0x2b4a66=parseInt(_0x3eda54);if(isNaN(_0x2b4a66)||_0x2b4a66<0x14){alert('请输入一个有效的数字（建议大于20）。');return;}const _0x462f31=await _0x2c9509(_0x38bffc(0xc7f),_0x38bffc(0x1045)+_0x21d1f6+'\x20条长期记忆发送给AI，总结成大约\x20'+_0x2b4a66+_0x38bffc(0x15e0),{'confirmButtonClass':_0x38bffc(0xf5b),'confirmText':_0x38bffc(0x40b)});if(!_0x462f31)return;const _0x4edcea=_0x463cc0[_0x38bffc(0xb0a)](_0x36323e=>'-\x20'+_0x36323e['content'])['join']('\x0a'),_0x1d91fc=_0x19ddb8[_0x38bffc(0x9ce)]['nickname']||'用户',_0x24b18d=new Date()['toLocaleDateString'](_0x38bffc(0x15bc),{'year':_0x38bffc(0xc6a),'month':'long','day':'numeric'}),_0x386b34='\x0a#\x20你的任务\x0a你就是角色“'+_0x210d56[_0x38bffc(0x339)]+_0x38bffc(0x845)+_0x1d91fc+_0x38bffc(0xadf)+_0x24b18d+_0x38bffc(0x4a3)+_0x24b18d+_0x38bffc(0x854)+_0x2b4a66+_0x38bffc(0xce3)+_0x210d56['settings'][_0x38bffc(0x1c3)]+_0x38bffc(0x10c9)+_0x210d56['settings'][_0x38bffc(0x1e3)]+_0x38bffc(0xee4)+_0x4edcea+_0x38bffc(0x70b)+_0x210d56[_0x38bffc(0x339)]+'”的身份，开始你的回忆梳理与精炼。';await _0x403a62(_0x38bffc(0x1395),_0x38bffc(0xd93));try{const _0x2aee0c=_0x19ddb8[_0x38bffc(0xd22)]['secondaryProxyUrl']&&_0x19ddb8[_0x38bffc(0xd22)]['secondaryApiKey']&&_0x19ddb8['apiConfig'][_0x38bffc(0xa20)],{proxyUrl:_0x2e6afc,apiKey:_0x1c6e87,model:_0x5ae81d}=_0x2aee0c?{'proxyUrl':_0x19ddb8[_0x38bffc(0xd22)]['secondaryProxyUrl'],'apiKey':_0x19ddb8[_0x38bffc(0xd22)][_0x38bffc(0x278)],'model':_0x19ddb8['apiConfig'][_0x38bffc(0xa20)]}:_0x19ddb8['apiConfig'];if(!_0x2e6afc||!_0x1c6e87||!_0x5ae81d)throw new Error('请先在API设置中配置好（主或副）API以进行总结。');let _0x25d0c8=_0x2e6afc[_0x38bffc(0x478)](_0x38bffc(0x1329)),_0x38a3aa=_0x366263(_0x5ae81d,_0x1c6e87,_0x386b34,[{'role':_0x38bffc(0x20d),'content':_0x38bffc(0x435)}]);const _0x40b396=_0x25d0c8?await fetch(_0x38a3aa[_0x38bffc(0x121f)],_0x38a3aa[_0x38bffc(0x38c)]):await fetch(_0x2e6afc+_0x38bffc(0x501),{'method':_0x38bffc(0x12db),'headers':{'Content-Type':'application/json','Authorization':_0x38bffc(0x1265)+_0x1c6e87},'body':JSON[_0x38bffc(0xe1e)]({'model':_0x5ae81d,'messages':[{'role':_0x38bffc(0xe10),'content':_0x386b34},{'role':_0x38bffc(0x20d),'content':'请开始整合。'}],'temperature':0.2})});if(!_0x40b396['ok'])throw new Error(_0x38bffc(0x786)+_0x40b396['statusText']);const _0x3be18a=await _0x40b396[_0x38bffc(0xa5d)]();let _0x3c36f6=_0x25d0c8?getGeminiResponseText(_0x3be18a):_0x3be18a['choices'][0x0][_0x38bffc(0xcce)][_0x38bffc(0x4e3)];const _0x3a7b7c=_0x2fb0a3(_0x3c36f6);if(_0x3a7b7c&&_0x3a7b7c[_0x38bffc(0x114b)]&&typeof _0x3a7b7c[_0x38bffc(0x114b)]==='string'&&_0x3a7b7c[_0x38bffc(0x114b)]['trim']()){const _0xd6643b=await _0x2c9509(_0x38bffc(0x11dc),_0x38bffc(0xedf)+_0x21d1f6+_0x38bffc(0x7b4)+_0x3a7b7c[_0x38bffc(0x114b)]['trim']()+'</div><br>是否用这条新记忆替换掉这些旧记忆？',{'confirmText':_0x38bffc(0x6f6),'cancelText':'保留旧的','confirmButtonClass':_0x38bffc(0xf5b)});if(_0xd6643b){const _0x227b18={'content':_0x3a7b7c['summary'][_0x38bffc(0x13f9)](),'timestamp':Date[_0x38bffc(0x64b)](),'source':_0x38bffc(0x1486)},_0x5103e2=_0x255c92-_0x21d1f6,_0x537547=_0x5103e2>0x0?_0x210d56[_0x38bffc(0x744)][_0x38bffc(0x457)](0x0,_0x5103e2):[];_0x210d56[_0x38bffc(0x744)]=[..._0x537547,_0x227b18],_0x210d56['lastMemorySummaryTimestamp']=Date[_0x38bffc(0x64b)](),await _0x512070[_0x38bffc(0xb04)][_0x38bffc(0xd4d)](_0x210d56),document['getElementById'](_0x38bffc(0x14c1))[_0x38bffc(0x4d8)][_0x38bffc(0x1222)]('active')&&_0x2abdba(),await _0x403a62(_0x38bffc(0x1091),_0x38bffc(0x15d6)+_0x21d1f6+_0x38bffc(0xd48));}else await _0x403a62(_0x38bffc(0x823),_0x38bffc(0x181));}else throw new Error(_0x38bffc(0x156d));}catch(_0x35ab8e){console['error'](_0x38bffc(0x95c),_0x35ab8e),await _0x403a62(_0x38bffc(0xa53),_0x38bffc(0x29e)+_0x35ab8e[_0x38bffc(0xcce)]);}}async function _0x3fe133(_0x1e9e81,_0x1262f5=![]){const _0x168f5a=_0x48bc6d,_0x2a79d6=_0x19ddb8['chats'][_0x1e9e81];if(!_0x2a79d6)return;const _0x77da6c=_0x2a79d6[_0x168f5a(0x825)]||0x0,_0x3c548f=_0x1262f5?_0x2a79d6[_0x168f5a(0x1f0)][_0x168f5a(0x1195)](_0x5aee61=>!_0x5aee61[_0x168f5a(0x136e)]||_0x5aee61['role']==='system'&&_0x5aee61[_0x168f5a(0x4e3)][_0x168f5a(0x478)](_0x168f5a(0xae6)))['slice'](-(_0x2a79d6[_0x168f5a(0x450)][_0x168f5a(0xdf7)]||0x14)):_0x2a79d6[_0x168f5a(0x1f0)][_0x168f5a(0x1195)](_0x5c07bb=>_0x5c07bb[_0x168f5a(0xd73)]>_0x77da6c&&(!_0x5c07bb[_0x168f5a(0x136e)]||_0x5c07bb[_0x168f5a(0x11c1)]==='system'&&_0x5c07bb[_0x168f5a(0x4e3)]['includes'](_0x168f5a(0xae6))));if(_0x3c548f[_0x168f5a(0x106b)]<0x5){if(_0x1262f5)alert(_0x168f5a(0x4fa));return;}const _0x113a66=_0x19ddb8['qzoneSettings'][_0x168f5a(0x246)]||'用户',_0x25522b=_0x3c548f['map'](_0x39fab5=>{const _0x1d0646=_0x168f5a;if(_0x39fab5[_0x1d0646(0x136e)]&&_0x39fab5[_0x1d0646(0x11c1)]===_0x1d0646(0xe10)&&_0x39fab5[_0x1d0646(0x4e3)][_0x1d0646(0x478)]('内心独白'))return _0x39fab5['content'];let _0x5c6791;_0x39fab5[_0x1d0646(0x11c1)]===_0x1d0646(0x20d)?_0x5c6791=_0x113a66:_0x5c6791=_0x39fab5['senderName']||_0x2a79d6[_0x1d0646(0x339)];let _0xca80d='';if(_0x39fab5[_0x1d0646(0x1508)]===_0x1d0646(0x12fb)){if(_0x39fab5[_0x1d0646(0x4e3)])_0xca80d=_0x39fab5[_0x1d0646(0x4e3)];else{const _0x4ef81a=_0x39fab5[_0x1d0646(0x103d)]?'「'+_0x39fab5[_0x1d0646(0x103d)]+'」':'',_0x32c8a1=_0x39fab5[_0x1d0646(0x3ef)]?'('+_0x39fab5[_0x1d0646(0x3ef)]+')':'';_0xca80d=(_0x4ef81a+'\x20'+_0x32c8a1)[_0x1d0646(0x13f9)]();}}else _0xca80d=String(_0x39fab5[_0x1d0646(0x4e3)]);return _0x5c6791+':\x20'+_0xca80d;})[_0x168f5a(0x3b9)]('\x0a');let _0x1ef82c;if(_0x2a79d6[_0x168f5a(0x136b)])_0x1ef82c='\x0a#\x20你的任务\x0a你是一个高级的“记忆分配专家”。你的任务是阅读下面的群聊记录，并为【每一个参与的AI角色】生成一段【个性化的、第一人称】的长期记忆。\x0a#\x20核心规则\x0a1.\x20\x20**视角铁律**:\x20每一条总结都【必须】使用【第一人称视角\x20(\x22我\x22)】。\x0a2.\x20\x20**内容核心**:\x20重点总结：我说过的话、我做过的事、别人对我说的话、与我相关的事、以及对我个人很重要的群聊事件、关键信息和心理活动。\x0a3.\x20\x20**【简洁性铁律】**:\x20每条个人记忆总结【绝对不能超过60个字】。\x0a4.\x20\x20**【省略规则】**:\x20如果一个角色在本次对话中【完全没有参与或提及】，你可以省略TA的记忆。\x0a5.\x20\x20**输出格式**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22summaries\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名A\x22:\x20\x22我今天在群里和大家讨论了电影，感觉很开心。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名B\x22:\x20\x22我在群里和'+_0x113a66+_0x168f5a(0x480)+_0x25522b+_0x168f5a(0x14fe)+_0x2a79d6[_0x168f5a(0xcca)]['map'](_0x13f96d=>'-\x20'+_0x13f96d[_0x168f5a(0xaf0)]+_0x168f5a(0x1bd)+_0x13f96d[_0x168f5a(0x339)]+')')['join']('\x0a')+'\x0a现在，请为【参与了对话的AI角色】生成他们各自的、第一人称的、精简的记忆。';else{const _0x105110=new Date()['toLocaleDateString'](_0x168f5a(0x15bc),{'year':_0x168f5a(0xc6a),'month':_0x168f5a(0x9f8),'day':'numeric'});_0x1ef82c='\x0a#\x20你的任务\x0a你就是角色“'+_0x2a79d6[_0x168f5a(0x339)]+_0x168f5a(0x8e7)+_0x113a66+_0x168f5a(0x787)+_0x105110+_0x168f5a(0x10f9)+_0x105110+_0x168f5a(0x1520)+new Date(Date['now']()+0x5265c00)[_0x168f5a(0x7fd)](_0x168f5a(0x15bc),{'month':_0x168f5a(0x9f8),'day':_0x168f5a(0xc6a)})+_0x168f5a(0x2eb)+_0x2a79d6[_0x168f5a(0x450)][_0x168f5a(0x1c3)]+'\x0a#\x20你的聊天对象（用户）的人设\x0a'+_0x2a79d6[_0x168f5a(0x450)][_0x168f5a(0x1e3)]+'\x0a#\x20待总结的对话历史\x0a'+_0x25522b+_0x168f5a(0x70b)+_0x2a79d6[_0x168f5a(0x339)]+_0x168f5a(0x125f);}try{const _0x5d5d3e=_0x19ddb8[_0x168f5a(0xd22)][_0x168f5a(0x132b)]&&_0x19ddb8[_0x168f5a(0xd22)]['secondaryApiKey']&&_0x19ddb8['apiConfig'][_0x168f5a(0xa20)],{proxyUrl:_0xde579d,apiKey:_0x2844f1,model:_0x16a022}=_0x5d5d3e?{'proxyUrl':_0x19ddb8[_0x168f5a(0xd22)][_0x168f5a(0x132b)],'apiKey':_0x19ddb8[_0x168f5a(0xd22)]['secondaryApiKey'],'model':_0x19ddb8['apiConfig'][_0x168f5a(0xa20)]}:_0x19ddb8[_0x168f5a(0xd22)];if(!_0xde579d||!_0x2844f1||!_0x16a022)throw new Error(_0x168f5a(0x115e));let _0x2b05bc=_0xde579d[_0x168f5a(0x478)](_0x168f5a(0x1329)),_0x1e98f9=_0x366263(_0x16a022,_0x2844f1,_0x1ef82c,[{'role':'user','content':_0x168f5a(0x8bb)}]);const _0xdd8cc=_0x2b05bc?await fetch(_0x1e98f9[_0x168f5a(0x121f)],_0x1e98f9[_0x168f5a(0x38c)]):await fetch(_0xde579d+_0x168f5a(0x501),{'method':_0x168f5a(0x12db),'headers':{'Content-Type':_0x168f5a(0xb1f),'Authorization':_0x168f5a(0x1265)+_0x2844f1},'body':JSON[_0x168f5a(0xe1e)]({'model':_0x16a022,'messages':[{'role':_0x168f5a(0xe10),'content':_0x1ef82c},{'role':'user','content':'请开始总结。'}],'temperature':0.2})});if(!_0xdd8cc['ok'])throw new Error(_0x168f5a(0x786)+_0xdd8cc[_0x168f5a(0x140e)]);const _0x8bb020=await _0xdd8cc[_0x168f5a(0xa5d)]();let _0x501891=_0x2b05bc?getGeminiResponseText(_0x8bb020):_0x8bb020[_0x168f5a(0x21f)][0x0][_0x168f5a(0xcce)][_0x168f5a(0x4e3)];_0x501891=_0x501891[_0x168f5a(0x1bb)](/^```json\s*/,'')[_0x168f5a(0x1bb)](/```$/,'')[_0x168f5a(0x13f9)]();const _0x310c5c=JSON[_0x168f5a(0x1447)](_0x501891);if(_0x2a79d6[_0x168f5a(0x136b)]){if(_0x310c5c[_0x168f5a(0x1519)]&&typeof _0x310c5c['summaries']===_0x168f5a(0x12fe)){let _0xfd7f39=0x0;for(const _0x1d5d8b in _0x310c5c['summaries']){const _0xe2feed=_0x310c5c[_0x168f5a(0x1519)][_0x1d5d8b];if(_0xe2feed&&_0xe2feed['trim']()){const _0x5f3e12=Object['values'](_0x19ddb8[_0x168f5a(0xb04)])[_0x168f5a(0xd62)](_0x544062=>_0x544062[_0x168f5a(0x339)]===_0x1d5d8b);if(_0x5f3e12){const _0x2f0350={'content':_0xe2feed[_0x168f5a(0x13f9)](),'timestamp':Date[_0x168f5a(0x64b)](),'source':_0x168f5a(0x123a)+_0x2a79d6['name']};if(!_0x5f3e12['longTermMemory'])_0x5f3e12['longTermMemory']=[];_0x5f3e12[_0x168f5a(0x744)][_0x168f5a(0x1c4)](_0x2f0350),await _0x512070[_0x168f5a(0xb04)][_0x168f5a(0xd4d)](_0x5f3e12),_0xfd7f39++;}}}if(_0xfd7f39>0x0)console[_0x168f5a(0xe4d)](_0x168f5a(0x3ec)+_0xfd7f39+_0x168f5a(0x93a));else throw new Error('AI返回了空的或格式不正确的总结内容。');}else throw new Error('AI返回的JSON格式不正确，缺少\x20\x27summaries\x27\x20字段。');}else{if(_0x310c5c[_0x168f5a(0x114b)]&&_0x310c5c[_0x168f5a(0x114b)][_0x168f5a(0x13f9)]()){const _0x4cbd33={'content':_0x310c5c['summary'][_0x168f5a(0x13f9)](),'timestamp':Date[_0x168f5a(0x64b)](),'source':'auto'};_0x2a79d6['longTermMemory']['push'](_0x4cbd33),await _0x512070[_0x168f5a(0xb04)][_0x168f5a(0xd4d)](_0x2a79d6),console[_0x168f5a(0xe4d)](_0x168f5a(0xa07));}else throw new Error(_0x168f5a(0x156d));}_0x2a79d6['lastMemorySummaryTimestamp']=_0x3c548f[_0x168f5a(0x457)](-0x1)[0x0][_0x168f5a(0xd73)],await _0x512070['chats'][_0x168f5a(0xd4d)](_0x2a79d6),document[_0x168f5a(0x9a3)](_0x168f5a(0x14c1))[_0x168f5a(0x4d8)]['contains'](_0x168f5a(0xe9f))&&_0x2abdba();}catch(_0x58ca02){console[_0x168f5a(0x3b7)](_0x168f5a(0x119e),_0x58ca02),await _0x403a62(_0x168f5a(0xa24),_0x168f5a(0x1564)+_0x58ca02['message']);}}function _0x1d5e00(){const _0x3cc38a=_0x48bc6d;if(!_0x5c6e51)return;const _0x169ed2=_0x19ddb8['chats'][_0x19ddb8[_0x3cc38a(0x859)]],_0x1a8c5d=_0x169ed2[_0x3cc38a(0x1f0)][_0x3cc38a(0xd62)](_0x324e05=>_0x324e05[_0x3cc38a(0xd73)]===_0x5c6e51&&!_0x324e05[_0x3cc38a(0x136e)]);if(!_0x1a8c5d)return;let _0x319d86;_0x1a8c5d['role']===_0x3cc38a(0x20d)?_0x319d86=_0x169ed2[_0x3cc38a(0x136b)]?_0x169ed2[_0x3cc38a(0x450)]['myNickname']||'我':'我':_0x169ed2[_0x3cc38a(0x136b)]?_0x319d86=_0x1e2056(_0x169ed2,_0x1a8c5d['senderName']):_0x319d86=_0x169ed2[_0x3cc38a(0x1561)];const _0x17bb7f=String(_0x1a8c5d[_0x3cc38a(0x4e3)]||'');let _0x367aa2='';if(typeof _0x1a8c5d[_0x3cc38a(0x4e3)]===_0x3cc38a(0x86c)&&_0x115b0e[_0x3cc38a(0xddf)](_0x1a8c5d[_0x3cc38a(0x4e3)]))_0x367aa2=_0x3cc38a(0xbd5);else{if(_0x1a8c5d['type']===_0x3cc38a(0x1c1)||_0x1a8c5d[_0x3cc38a(0x1508)]===_0x3cc38a(0x9ee))_0x367aa2='[图片]';else _0x1a8c5d['type']===_0x3cc38a(0x1207)?_0x367aa2=_0x3cc38a(0x108d):_0x367aa2=_0x17bb7f[_0x3cc38a(0x72e)](0x0,0x32)+(_0x17bb7f[_0x3cc38a(0x106b)]>0x32?_0x3cc38a(0x4a5):'');}_0x40ff22={'timestamp':_0x1a8c5d['timestamp'],'senderName':_0x319d86,'content':_0x17bb7f};const _0x10b8d1=document['getElementById']('reply-preview-bar');_0x10b8d1[_0x3cc38a(0xc86)](_0x3cc38a(0xb0c))['textContent']=_0x3cc38a(0xaa8)+_0x40ff22['senderName']+':',_0x10b8d1['querySelector'](_0x3cc38a(0x12aa))['textContent']=_0x367aa2,_0x10b8d1['style'][_0x3cc38a(0x115d)]='block',_0x1afb50(),document[_0x3cc38a(0x9a3)](_0x3cc38a(0xf84))[_0x3cc38a(0xdcf)]();}function _0x40142f(){const _0xf7dd81=_0x48bc6d;_0x40ff22=null,document[_0xf7dd81(0x9a3)]('reply-preview-bar')['style'][_0xf7dd81(0x115d)]=_0xf7dd81(0x8e0);}let _0x24a780=null;function _0x1e9621(_0x25ec9b){const _0x16bb87=_0x48bc6d;_0x24a780=_0x25ec9b;const _0x462be3=_0x19ddb8[_0x16bb87(0xb04)][_0x19ddb8[_0x16bb87(0x859)]],_0x472de9=_0x462be3[_0x16bb87(0x1f0)][_0x16bb87(0xd62)](_0xf9c37d=>_0xf9c37d['timestamp']===_0x25ec9b);_0x472de9&&(document[_0x16bb87(0x9a3)](_0x16bb87(0xe7e))[_0x16bb87(0x766)]=_0x472de9[_0x16bb87(0x1043)]),document[_0x16bb87(0x9a3)]('transfer-actions-modal')[_0x16bb87(0x4d8)]['add'](_0x16bb87(0xc09));}function _0x361eab(){const _0x1a5e7c=_0x48bc6d;document[_0x1a5e7c(0x9a3)](_0x1a5e7c(0x1391))[_0x1a5e7c(0x4d8)][_0x1a5e7c(0x133d)](_0x1a5e7c(0xc09)),_0x24a780=null;}async function _0x219744(_0x5f418b){const _0x3a3fb9=_0x48bc6d;if(!_0x24a780)return;const _0x3b8c68=_0x24a780,_0x2bef51=_0x19ddb8['chats'][_0x19ddb8[_0x3a3fb9(0x859)]],_0x2e0f08=_0x2bef51['history'][_0x3a3fb9(0x455)](_0xe8b5f4=>_0xe8b5f4[_0x3a3fb9(0xd73)]===_0x3b8c68);if(_0x2e0f08===-0x1)return;const _0x1766dc=_0x2bef51[_0x3a3fb9(0x1f0)][_0x2e0f08];_0x1766dc['status']=_0x5f418b;let _0x4b1353;if(_0x5f418b===_0x3a3fb9(0x900)){const _0x583b6c={'role':'user','type':_0x3a3fb9(0x4b3),'isRefund':!![],'amount':_0x1766dc[_0x3a3fb9(0x11fa)],'note':'已拒收对方转账','timestamp':Date[_0x3a3fb9(0x64b)]()};_0x2bef51[_0x3a3fb9(0x1f0)]['push'](_0x583b6c),_0x4b1353=_0x3a3fb9(0xbc2)+_0x1766dc['senderName']+_0x3a3fb9(0xe13);}else _0x4b1353=_0x3a3fb9(0x8d1)+_0x1766dc[_0x3a3fb9(0x1043)]+_0x3a3fb9(0xe13);const _0x3d9205={'role':_0x3a3fb9(0xe10),'content':_0x4b1353,'timestamp':Date[_0x3a3fb9(0x64b)]()+0x1,'isHidden':!![]};_0x2bef51['history'][_0x3a3fb9(0x1c4)](_0x3d9205),await _0x512070[_0x3a3fb9(0xb04)]['put'](_0x2bef51),_0x361eab(),_0x56abd7(_0x19ddb8[_0x3a3fb9(0x859)]),_0xec8072();}async function _0x1cc553(){const _0x86de62=_0x48bc6d;_0x35df44('call-history-screen');const _0x14f7a3=document[_0x86de62(0x9a3)](_0x86de62(0x771)),_0x1c1fb9=document['getElementById'](_0x86de62(0xb67));_0x14f7a3[_0x86de62(0xeb2)]='',_0x1c1fb9[_0x86de62(0x766)]='所有通话记录';const _0x299b7c=await _0x512070[_0x86de62(0xad1)][_0x86de62(0x1404)](_0x86de62(0xd73))[_0x86de62(0x333)]()[_0x86de62(0x591)]();if(_0x299b7c['length']===0x0){_0x14f7a3[_0x86de62(0xeb2)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有通话记录哦~</p>';return;}_0x299b7c[_0x86de62(0x15c1)](_0xb386ea=>{const _0x1a7d97=_0x4fd36f(_0xb386ea);_0x1a651b(_0x1a7d97,async()=>{const _0x5674d2=_0x1efc,_0x43f6df=await _0x3ab788(_0x5674d2(0xcb6),_0x5674d2(0x6ab),_0xb386ea[_0x5674d2(0x827)]||'');if(_0x43f6df===null)return;await _0x512070[_0x5674d2(0xad1)][_0x5674d2(0xe33)](_0xb386ea['id'],{'customName':_0x43f6df[_0x5674d2(0x13f9)]()}),await _0x1cc553(),await _0x403a62('成功','通话名称已更新！');}),_0x14f7a3['appendChild'](_0x1a7d97);});}function _0x4fd36f(_0x36fbfd){const _0x342c02=_0x48bc6d,_0x2f4449=document[_0x342c02(0xe94)](_0x342c02(0x8ca));_0x2f4449[_0x342c02(0x1487)]=_0x342c02(0xe22),_0x2f4449[_0x342c02(0xd8d)][_0x342c02(0x2a6)]=_0x36fbfd['id'];const _0x53b87d=_0x19ddb8['chats'][_0x36fbfd[_0x342c02(0x907)]],_0x2d70b6=_0x53b87d?_0x53b87d[_0x342c02(0x1561)]:_0x342c02(0x1226),_0x35348c=new Date(_0x36fbfd[_0x342c02(0xd73)]),_0x3470c6=_0x35348c['getFullYear']()+'-'+String(_0x35348c['getMonth']()+0x1)[_0x342c02(0x1488)](0x2,'0')+'-'+String(_0x35348c[_0x342c02(0x67c)]())[_0x342c02(0x1488)](0x2,'0')+'\x20'+String(_0x35348c['getHours']())[_0x342c02(0x1488)](0x2,'0')+':'+String(_0x35348c[_0x342c02(0xa21)]())[_0x342c02(0x1488)](0x2,'0'),_0x2eb55e=Math['floor'](_0x36fbfd[_0x342c02(0xf58)]/0x3c)+'分'+_0x36fbfd[_0x342c02(0xf58)]%0x3c+'秒',_0x40c964=_0x36fbfd[_0x342c02(0x9d3)][_0x342c02(0xb0a)](_0x127fa2=>_0x342c02(0x887)+_0x127fa2[_0x342c02(0xf3f)]+_0x342c02(0x12df)+_0x127fa2[_0x342c02(0x1561)]+'\x22\x20class=\x22participant-avatar\x22\x20title=\x22'+_0x127fa2['name']+'\x22>')[_0x342c02(0x3b9)]('');return _0x2f4449[_0x342c02(0xeb2)]=_0x342c02(0x118c)+_0x3470c6+_0x342c02(0xfc9)+_0x2eb55e+_0x342c02(0xdf1)+(_0x36fbfd['customName']?_0x342c02(0xf60)+_0x36fbfd[_0x342c02(0x827)]+'</div>':'')+_0x342c02(0xeec)+_0x40c964+_0x342c02(0xab9)+_0x2d70b6+_0x342c02(0x1de),_0x2f4449;}async function _0x5303ef(_0x484cf2){const _0x5d5fa1=_0x48bc6d,_0x2f8249=await _0x512070[_0x5d5fa1(0xad1)]['get'](_0x484cf2);if(!_0x2f8249)return;const _0x3300fe=document['getElementById'](_0x5d5fa1(0xd24)),_0x34c82c=document[_0x5d5fa1(0x9a3)](_0x5d5fa1(0xb85)),_0x32bd53=document[_0x5d5fa1(0x9a3)]('call-transcript-modal-body');_0x34c82c[_0x5d5fa1(0x766)]=_0x5d5fa1(0x10d7)+new Date(_0x2f8249[_0x5d5fa1(0xd73)])['toLocaleString']()+_0x5d5fa1(0x1231)+Math[_0x5d5fa1(0xd95)](_0x2f8249[_0x5d5fa1(0xf58)]/0x3c)+'分'+_0x2f8249['duration']%0x3c+'秒)',_0x32bd53[_0x5d5fa1(0xeb2)]='';const _0xbd7f38=document[_0x5d5fa1(0x9a3)](_0x5d5fa1(0x1147)),_0x371fe9=document[_0x5d5fa1(0x9a3)](_0x5d5fa1(0xad5));!_0x2f8249[_0x5d5fa1(0x12ea)]||_0x2f8249['transcript'][_0x5d5fa1(0x106b)]===0x0?(_0x32bd53[_0x5d5fa1(0xeb2)]=_0x5d5fa1(0x119c),_0x371fe9[_0x5d5fa1(0x20f)][_0x5d5fa1(0x115d)]=_0x5d5fa1(0x8e0)):(_0x371fe9[_0x5d5fa1(0x20f)][_0x5d5fa1(0x115d)]=_0x5d5fa1(0x10c8),_0x2f8249['transcript'][_0x5d5fa1(0x15c1)](_0x4cec8a=>{const _0x1b582a=_0x5d5fa1,_0x4878b6=document[_0x1b582a(0xe94)](_0x1b582a(0x8ca));_0x4878b6[_0x1b582a(0x1487)]=_0x1b582a(0x12d1)+_0x4cec8a['role'],_0x4878b6[_0x1b582a(0x766)]=_0x4cec8a[_0x1b582a(0x4e3)],_0x32bd53[_0x1b582a(0x983)](_0x4878b6);}));const _0x1a4278=_0xbd7f38[_0x5d5fa1(0x173)](!![]);_0xbd7f38['parentNode'][_0x5d5fa1(0x15ab)](_0x1a4278,_0xbd7f38);const _0x488b27=_0x371fe9[_0x5d5fa1(0x173)](!![]);_0x371fe9[_0x5d5fa1(0x5eb)]['replaceChild'](_0x488b27,_0x371fe9),_0x1a4278[_0x5d5fa1(0x954)](_0x5d5fa1(0x9cc),async()=>{const _0x312641=_0x5d5fa1,_0x2c93bc=await _0x2c9509(_0x312641(0xd05),'确定要永久删除这条通话记录吗？此操作不可恢复。',{'confirmButtonClass':'btn-danger'});_0x2c93bc&&(_0x3300fe[_0x312641(0x4d8)][_0x312641(0x133d)]('visible'),await _0x512070[_0x312641(0xad1)][_0x312641(0x10a8)](_0x484cf2),await _0x1cc553(),alert('通话记录已删除。'));}),_0x488b27[_0x5d5fa1(0x954)](_0x5d5fa1(0x9cc),async()=>{const _0x5a7448=_0x5d5fa1,_0x215373=await _0x2c9509(_0x5a7448(0x6c3),'这将提取当前通话记录发送给AI进行总结，会消耗API额度。确定要继续吗？',{'confirmText':'确认总结'});if(!_0x215373)return;_0x3300fe['classList'][_0x5a7448(0x133d)](_0x5a7448(0xc09));const _0x1aa651=_0x19ddb8[_0x5a7448(0xb04)][_0x2f8249[_0x5a7448(0x907)]];if(!_0x1aa651){alert('错误：找不到该通话记录所属的聊天对象。');return;}await _0x403a62('请稍候...',_0x5a7448(0x63d));try{const _0x523768=_0x2f8249[_0x5a7448(0x12ea)][_0x5a7448(0xb0a)](_0x5603f6=>{const _0x2c5bf2=_0x5a7448,_0x47ef88=_0x5603f6[_0x2c5bf2(0x11c1)]===_0x2c5bf2(0x20d)?_0x1aa651[_0x2c5bf2(0x450)][_0x2c5bf2(0x1555)]||'我':_0x5603f6[_0x2c5bf2(0x1043)]||_0x1aa651[_0x2c5bf2(0x1561)];return _0x47ef88+':\x20'+_0x5603f6[_0x2c5bf2(0x4e3)];})[_0x5a7448(0x3b9)]('\x0a');await _0xba159(_0x2f8249[_0x5a7448(0x907)],_0x523768),await _0x403a62(_0x5a7448(0xfd7),'手动总结已完成！新的记忆已添加到“'+_0x1aa651[_0x5a7448(0x1561)]+_0x5a7448(0xa62));}catch(_0x46f2f3){await _0x403a62(_0x5a7448(0xa24),'操作失败，未能生成长期记忆。\x0a\x0a错误详情:\x20'+_0x46f2f3[_0x5a7448(0xcce)]);}});const _0x196a90=document[_0x5d5fa1(0x9a3)](_0x5d5fa1(0x712)),_0xca6a22=_0x196a90[_0x5d5fa1(0x173)](!![]);_0x196a90['parentNode'][_0x5d5fa1(0x15ab)](_0xca6a22,_0x196a90),_0xca6a22[_0x5d5fa1(0x954)](_0x5d5fa1(0x9cc),()=>{const _0x32c2d0=_0x5d5fa1;_0x3300fe[_0x32c2d0(0x4d8)][_0x32c2d0(0x133d)](_0x32c2d0(0xc09));}),_0x3300fe[_0x5d5fa1(0x4d8)][_0x5d5fa1(0xe05)](_0x5d5fa1(0xc09));}async function _0x28be92(){const _0x2f2474=_0x48bc6d;if(!_0x19ddb8[_0x2f2474(0x859)]||_0x19ddb8[_0x2f2474(0xb04)][_0x19ddb8[_0x2f2474(0x859)]]['isGroup'])return;const _0x12449a=_0x19ddb8[_0x2f2474(0xb04)][_0x19ddb8[_0x2f2474(0x859)]],_0x898fb=await _0x3ab788(_0x2f2474(0x1302),_0x2f2474(0xdec),_0x12449a['status'][_0x2f2474(0x13ca)]);_0x898fb!==null&&(_0x12449a['status'][_0x2f2474(0x13ca)]=_0x898fb[_0x2f2474(0x13f9)]()||'在线',_0x12449a['status'][_0x2f2474(0x545)]=![],_0x12449a[_0x2f2474(0x27d)][_0x2f2474(0x935)]=Date[_0x2f2474(0x64b)](),await _0x512070[_0x2f2474(0xb04)][_0x2f2474(0xd4d)](_0x12449a),_0x56abd7(_0x19ddb8['activeChatId']),_0xec8072(),await _0x403a62(_0x2f2474(0x299),'“'+_0x12449a[_0x2f2474(0x1561)]+_0x2f2474(0xeea)+_0x12449a['status'][_0x2f2474(0x13ca)]));}async function _0x579448(){const _0x3fb73e=_0x48bc6d,_0x1e1d4b=document['getElementById'](_0x3fb73e(0xedd)),_0x4196fe=document[_0x3fb73e(0x9a3)](_0x3fb73e(0x2a0));_0x4196fe[_0x3fb73e(0xeb2)]='';const _0x4f2775=Object[_0x3fb73e(0xea1)](_0x19ddb8[_0x3fb73e(0xb04)]);_0x4f2775[_0x3fb73e(0x15c1)](_0x27d52e=>{const _0x3a0ad3=_0x3fb73e,_0x548262=document[_0x3a0ad3(0xe94)](_0x3a0ad3(0x8ca));_0x548262[_0x3a0ad3(0x1487)]=_0x3a0ad3(0x5a1),_0x548262[_0x3a0ad3(0xeb2)]=_0x3a0ad3(0x7a9)+_0x27d52e['id']+'\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x27d52e[_0x3a0ad3(0x136b)]?_0x27d52e['settings'][_0x3a0ad3(0x20a)]:_0x27d52e['settings']['aiAvatar']||_0x4f81ff)+_0x3a0ad3(0x2b6)+_0x27d52e[_0x3a0ad3(0x1561)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4196fe[_0x3a0ad3(0x983)](_0x548262);}),_0x1e1d4b['classList'][_0x3fb73e(0xe05)](_0x3fb73e(0xc09));}function _0x4f83c7(_0x2dbfad){const _0x334a19=_0x48bc6d,_0x54442c=document['getElementById']('music-player-overlay');if(!_0x54442c[_0x334a19(0x4d8)][_0x334a19(0x1222)](_0x334a19(0xc09))){if(_0x2dbfad)_0x2dbfad();return;}_0x54442c[_0x334a19(0x4d8)]['remove']('visible'),setTimeout(()=>{const _0x49ffcb=_0x334a19;document['getElementById']('music-playlist-panel')['classList']['remove'](_0x49ffcb(0xc09));if(_0x2dbfad)_0x2dbfad();},0x190);}function _0x7a1175(_0x53f1a4){const _0x1af228=_0x48bc6d;if(!_0x53f1a4)return[];const _0x2c88da=String(_0x53f1a4)[_0x1af228(0x1536)](/\r\n?|\n/),_0x4d678c=[],_0x200658=/\[(\d{2}):(\d{2})[.:](\d{2,3})\]/g;for(const _0x22d211 of _0x2c88da){const _0x47aeef=_0x22d211[_0x1af228(0x1bb)](_0x200658,'')['trim']();if(!_0x47aeef)continue;_0x200658[_0x1af228(0x567)]=0x0;let _0x2c5978;while((_0x2c5978=_0x200658[_0x1af228(0x696)](_0x22d211))!==null){const _0x297384=parseInt(_0x2c5978[0x1],0xa),_0x532f37=parseInt(_0x2c5978[0x2],0xa),_0x47769e=parseInt(_0x2c5978[0x3][_0x1af228(0x5a8)](0x3,'0'),0xa),_0x359a41=_0x297384*0x3c+_0x532f37+_0x47769e/0x3e8;_0x4d678c[_0x1af228(0x1c4)]({'time':_0x359a41,'text':_0x47aeef});}}return _0x4d678c[_0x1af228(0x6a2)]((_0x5e582a,_0x418f60)=>_0x5e582a[_0x1af228(0x6c8)]-_0x418f60[_0x1af228(0x6c8)]);}function _0x21bd0e(){const _0x4a749b=_0x48bc6d,_0x5a9fd7=document[_0x4a749b(0x9a3)](_0x4a749b(0x11a7));_0x5a9fd7[_0x4a749b(0xeb2)]='';if(!_0x4e0631['parsedLyrics']||_0x4e0631['parsedLyrics'][_0x4a749b(0x106b)]===0x0){_0x5a9fd7[_0x4a749b(0xeb2)]=_0x4a749b(0x2db);return;}_0x4e0631[_0x4a749b(0xa1d)][_0x4a749b(0x15c1)]((_0x4e33b8,_0x4be3e7)=>{const _0x5817c1=_0x4a749b,_0x2c7802=document[_0x5817c1(0xe94)]('div');_0x2c7802['className']=_0x5817c1(0x1326),_0x2c7802[_0x5817c1(0x766)]=_0x4e33b8[_0x5817c1(0x13ca)],_0x2c7802[_0x5817c1(0xd8d)]['index']=_0x4be3e7,_0x5a9fd7[_0x5817c1(0x983)](_0x2c7802);}),_0x5a9fd7[_0x4a749b(0x20f)][_0x4a749b(0x352)]=_0x4a749b(0x14b4);}function _0x28b801(){}function _0x1211d0(){const _0xfc759e=_0x48bc6d;if(!islandLyricText||!islandLyricContainer)return;const _0x109c20=islandLyricText[_0xfc759e(0x77c)],_0x2a40f6=islandLyricContainer[_0xfc759e(0x89d)];if(_0x109c20>_0x2a40f6){const _0x2bdcbd=_0x109c20/_0x2a40f6,_0x6da3ea=Math[_0xfc759e(0x812)](0x5,_0x2bdcbd*0x5);islandLyricText[_0xfc759e(0x20f)]['setProperty'](_0xfc759e(0xe30),_0x6da3ea+'s'),islandLyricText[_0xfc759e(0x20f)][_0xfc759e(0x11b9)]('--container-width',_0x2a40f6+'px'),islandLyricText[_0xfc759e(0x20f)][_0xfc759e(0x11b9)](_0xfc759e(0x1181),_0x109c20+'px'),islandLyricText[_0xfc759e(0x4d8)][_0xfc759e(0xe05)]('scrolling');}else islandLyricText[_0xfc759e(0x4d8)][_0xfc759e(0x133d)]('scrolling');}function _0x5797d3(_0x1d0641){const _0x2f6a47=_0x48bc6d;if(_0x4e0631[_0x2f6a47(0xa1d)][_0x2f6a47(0x106b)]===0x0)return;let _0x2cc408=-0x1;for(let _0x1aa3c8=0x0;_0x1aa3c8<_0x4e0631[_0x2f6a47(0xa1d)][_0x2f6a47(0x106b)];_0x1aa3c8++){if(_0x1d0641>=_0x4e0631[_0x2f6a47(0xa1d)][_0x1aa3c8]['time'])_0x2cc408=_0x1aa3c8;else break;}if(_0x2cc408===_0x4e0631[_0x2f6a47(0x8fa)])return;_0x4e0631['currentLyricIndex']=_0x2cc408,_0x5e92e9();const _0x290a4c=document[_0x2f6a47(0x9a3)](_0x2f6a47(0x66f));_0x290a4c&&(_0x2cc408>-0x1&&_0x4e0631[_0x2f6a47(0xa1d)][_0x2cc408]?_0x290a4c['textContent']=_0x4e0631['parsedLyrics'][_0x2cc408][_0x2f6a47(0x13ca)]:_0x290a4c['textContent']=_0x2f6a47(0x1124));const _0x44eb8c=document[_0x2f6a47(0x9a3)](_0x2f6a47(0x1386));_0x44eb8c[_0x2f6a47(0x4d8)][_0x2f6a47(0x1222)](_0x2f6a47(0xc09))&&(_0x2cc408>-0x1&&_0x4e0631[_0x2f6a47(0xa1d)][_0x2cc408]?_0x44eb8c[_0x2f6a47(0x766)]=_0x4e0631['parsedLyrics'][_0x2cc408]['text']:_0x44eb8c[_0x2f6a47(0x766)]='♪');if(phoneScreenForIsland[_0x2f6a47(0x4d8)][_0x2f6a47(0x1222)](_0x2f6a47(0xf13))){const _0x238d43=_0x2cc408>-0x1&&_0x4e0631[_0x2f6a47(0xa1d)][_0x2cc408]?_0x4e0631[_0x2f6a47(0xa1d)][_0x2cc408]['text']:_0x2f6a47(0x1124),_0x1a9cbe=islandLyricText[_0x2f6a47(0xc86)](_0x2f6a47(0x10c0));if(_0x1a9cbe&&_0x1a9cbe['textContent']===_0x238d43)return;islandLyricText[_0x2f6a47(0x20f)]['opacity']=0x0,setTimeout(()=>{const _0x57b24d=_0x2f6a47;islandLyricText[_0x57b24d(0x4d8)][_0x57b24d(0x133d)](_0x57b24d(0x5cc)),islandLyricContainer[_0x57b24d(0x4d8)]['remove']('center-content'),islandLyricText[_0x57b24d(0x20f)][_0x57b24d(0xc7e)]='none';let _0x34f68c=islandLyricText[_0x57b24d(0xc86)](_0x57b24d(0x10c0)),_0xf5e19d=islandLyricText[_0x57b24d(0xc86)](_0x57b24d(0x4ea));!_0x34f68c&&(_0x34f68c=document[_0x57b24d(0xe94)](_0x57b24d(0x1210)),islandLyricText[_0x57b24d(0x983)](_0x34f68c));!_0xf5e19d&&(_0xf5e19d=document[_0x57b24d(0xe94)](_0x57b24d(0x1210)),islandLyricText[_0x57b24d(0x983)](_0xf5e19d));_0x34f68c[_0x57b24d(0x766)]=_0x238d43,_0xf5e19d['textContent']=_0x238d43;const _0x142b06=_0x34f68c[_0x57b24d(0xa75)],_0x4aec2a=islandLyricContainer[_0x57b24d(0x89d)];if(_0x142b06>_0x4aec2a){const _0x1bb010=_0x142b06/_0x4aec2a,_0x4cc9fd=Math[_0x57b24d(0x812)](0x5,_0x1bb010*0x5);islandLyricText['style'][_0x57b24d(0x11b9)]('--marquee-duration',_0x4cc9fd+'s'),islandLyricText[_0x57b24d(0x4d8)][_0x57b24d(0xe05)](_0x57b24d(0x5cc)),islandLyricText[_0x57b24d(0x20f)][_0x57b24d(0xc7e)]=_0x57b24d(0x10b4);}else islandLyricContainer['classList'][_0x57b24d(0xe05)](_0x57b24d(0x37f));islandLyricText[_0x57b24d(0x20f)]['opacity']=0x1;},0xc8);}}function _0x5e92e9(_0x47cf71=![]){const _0x373662=_0x48bc6d,_0x400f25=_0x47cf71?_0x373662(0xca6):'#music-lyrics-container\x20#music-lyrics-list',_0x667986=_0x47cf71?'#fullscreen-lyrics-container':'#music-lyrics-container',_0x3a6dd7=document['querySelector'](_0x400f25),_0x284720=document[_0x373662(0xc86)](_0x667986);if(!_0x3a6dd7||!_0x284720)return;const _0x4b48a5=_0x3a6dd7[_0x373662(0x131c)]('.lyric-line');_0x4b48a5[_0x373662(0x15c1)](_0x541294=>_0x541294['classList'][_0x373662(0x133d)]('active'));if(_0x4e0631[_0x373662(0x8fa)]===-0x1){_0x3a6dd7[_0x373662(0x20f)][_0x373662(0x352)]=_0x373662(0x14b4);return;}const _0x240839=_0x3a6dd7[_0x373662(0xc86)](_0x373662(0x87f)+_0x4e0631[_0x373662(0x8fa)]+'\x22]');if(_0x240839){_0x240839['classList'][_0x373662(0xe05)]('active');const _0x4adeb7=_0x284720[_0x373662(0x1206)],_0x4f73cb=_0x4adeb7/2.2-_0x240839['offsetTop']-_0x240839[_0x373662(0x1206)]/0x2;_0x3a6dd7[_0x373662(0x20f)][_0x373662(0x352)]=_0x373662(0x42c)+_0x4f73cb+_0x373662(0xe24);}}function _0x406c2c(_0x3b206e){const _0x221750=_0x48bc6d;if(isNaN(_0x3b206e)||_0x3b206e<0x0)return _0x221750(0xc73);const _0x2dcf14=Math[_0x221750(0xd95)](_0x3b206e/0x3c),_0x31f4dd=Math[_0x221750(0xd95)](_0x3b206e%0x3c);return _0x2dcf14+':'+String(_0x31f4dd)[_0x221750(0x1488)](0x2,'0');}let _0x6174a7=0x0,_0x146226;function _0x2a9444(){_0x146226&&cancelAnimationFrame(_0x146226);function _0x2363a0(){const _0x33ce5e=_0x1efc;if(!_0x4e0631['isPlaying']||!_0x4a7bb9[_0x33ce5e(0xf58)])return;const _0x1fbd83=performance[_0x33ce5e(0x64b)](),_0x520646=_0x4a7bb9[_0x33ce5e(0x7d5)],_0x3fdf84=_0x4a7bb9['duration'],_0xd1561e=_0x520646/_0x3fdf84*0x64;document[_0x33ce5e(0x9a3)]('music-progress-fill')[_0x33ce5e(0x20f)][_0x33ce5e(0xeb0)]=_0xd1561e+'%',_0x1fbd83-_0x6174a7>0x3e8&&(document[_0x33ce5e(0x9a3)](_0x33ce5e(0x1145))[_0x33ce5e(0x766)]=_0x406c2c(_0x520646),document[_0x33ce5e(0x9a3)](_0x33ce5e(0x763))[_0x33ce5e(0x766)]=_0x406c2c(_0x3fdf84),_0x6174a7=_0x1fbd83),_0x5797d3(_0x520646),_0x28b801(),_0x146226=requestAnimationFrame(_0x2363a0);}_0x146226=requestAnimationFrame(_0x2363a0);}function _0x233b69(){const _0x466c97=_0x48bc6d;if(!lastRawAiResponse){alert('还没有可供编辑的AI响应。请先让AI回复一次。');return;}const _0x306ba5=document['getElementById'](_0x466c97(0x13aa)),_0x44fbc7=document[_0x466c97(0x9a3)](_0x466c97(0x465));_0x44fbc7['innerHTML']='';const _0x5b40bc=_0x189ab1(lastRawAiResponse);if(_0x5b40bc&&_0x5b40bc['length']>0x0)_0x5b40bc[_0x466c97(0x15c1)](_0x582c1a=>{const _0x46dba0=_0x466c97;if(typeof _0x582c1a===_0x46dba0(0x12fe)&&_0x582c1a!==null)try{const _0xef5172=JSON['stringify'](_0x582c1a,null,0x2),_0x494007=_0x5c7116(_0xef5172);_0x44fbc7[_0x46dba0(0x983)](_0x494007);}catch(_0x490a05){console[_0x46dba0(0x3b7)](_0x46dba0(0x1179),_0x582c1a,_0x490a05);}else{if(typeof _0x582c1a==='string'){const _0x3cff0e=_0x5c7116(_0x582c1a);_0x44fbc7[_0x46dba0(0x983)](_0x3cff0e),console[_0x46dba0(0x651)]('在导演模式中发现一个无效的片段\x20(来自parseAiResponse的文本回退):',_0x582c1a);}}});else{const _0x2910a5=_0x5c7116(lastRawAiResponse);_0x44fbc7[_0x466c97(0x983)](_0x2910a5);}_0x306ba5[_0x466c97(0x4d8)][_0x466c97(0xe05)](_0x466c97(0xc09));}function _0x5c7116(_0x4e51fd=''){const _0x5f10c4=_0x48bc6d,_0xafcf0c=document[_0x5f10c4(0xe94)](_0x5f10c4(0x8ca));_0xafcf0c[_0x5f10c4(0x1487)]='ai-response-editor-block';const _0x4111d3={'text':{'type':_0x5f10c4(0x13ca),'content':'在这里输入文本...'},'sticker':{'type':'sticker','url':_0x5f10c4(0xee7),'meaning':_0x5f10c4(0x627)},'image':{'type':'ai_image','description':'在这里输入图片描述...'},'voice':{'type':_0x5f10c4(0x1207),'content':_0x5f10c4(0x1ca)},'transfer':{'type':_0x5f10c4(0x4b3),'amount':5.2,'note':_0x5f10c4(0xeaa)},'offline':{'type':_0x5f10c4(0x12fb),'content':_0x5f10c4(0x5f2)},'quote':{'type':_0x5f10c4(0xe7b),'target_timestamp':0x499602d2,'reply_content':_0x5f10c4(0xc5a)},'nai':{'type':_0x5f10c4(0x1300),'prompt':'1girl,\x20best\x20quality,\x20masterpiece,\x20...'}};return _0xafcf0c[_0x5f10c4(0xeb2)]=_0x5f10c4(0x142c)+_0x4e51fd+_0x5f10c4(0xf02)+JSON[_0x5f10c4(0xe1e)](_0x4111d3['text'])+_0x5f10c4(0x366)+JSON[_0x5f10c4(0xe1e)](_0x4111d3[_0x5f10c4(0xda8)])+_0x5f10c4(0x7bc)+JSON[_0x5f10c4(0xe1e)](_0x4111d3['image'])+_0x5f10c4(0x14a7)+JSON[_0x5f10c4(0xe1e)](_0x4111d3[_0x5f10c4(0xdd9)])+_0x5f10c4(0x12e8)+JSON[_0x5f10c4(0xe1e)](_0x4111d3['transfer'])+_0x5f10c4(0x141e)+JSON[_0x5f10c4(0xe1e)](_0x4111d3[_0x5f10c4(0x11aa)])+'\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x5f10c4(0xe1e)](_0x4111d3[_0x5f10c4(0x6f7)])+_0x5f10c4(0x7c7)+JSON[_0x5f10c4(0xe1e)](_0x4111d3[_0x5f10c4(0x1359)])+_0x5f10c4(0x4c0),_0xafcf0c['querySelector']('.delete-block-btn')[_0x5f10c4(0x954)](_0x5f10c4(0x9cc),()=>{const _0x1dd775=_0x5f10c4;_0xafcf0c[_0x1dd775(0x133d)]();}),_0xafcf0c[_0x5f10c4(0x131c)](_0x5f10c4(0xaf4))['forEach'](_0x3250c1=>{const _0x41cea=_0x5f10c4;_0x3250c1[_0x41cea(0x954)](_0x41cea(0x9cc),()=>{const _0x1f6d88=_0x41cea,_0x2b37d0=_0x3250c1[_0x1f6d88(0xd8d)]['template'],_0x23b8c7=_0xafcf0c[_0x1f6d88(0xc86)]('textarea');if(_0x2b37d0&&_0x23b8c7)try{const _0x52eb06=JSON[_0x1f6d88(0x1447)](_0x2b37d0);_0x23b8c7[_0x1f6d88(0x7b2)]=JSON[_0x1f6d88(0xe1e)](_0x52eb06,null,0x2),_0x23b8c7[_0x1f6d88(0xdcf)]();}catch(_0x15429e){console[_0x1f6d88(0x3b7)](_0x1f6d88(0x403),_0x15429e);}});}),_0xafcf0c;}async function _0x36039b(){const _0x19d452=_0x48bc6d,_0x1c4b5d=new Map();let _0x577e64=null;if(lastPrivateMessagesSent[_0x19d452(0x106b)]>0x0){console[_0x19d452(0xe4d)]('导演剪辑室：正在撤销\x20'+lastPrivateMessagesSent[_0x19d452(0x106b)]+_0x19d452(0xcb4));const _0x3b10bf=[...lastPrivateMessagesSent];_0x577e64=_0x3b10bf[_0x19d452(0xea1)]();const _0x13fb6b=[...new Set(_0x3b10bf[_0x19d452(0xb0a)](_0xeb40e9=>_0xeb40e9[_0x19d452(0x907)]))];for(const _0x241519 of _0x13fb6b){const _0x27dd91=await _0x512070[_0x19d452(0xb04)]['get'](_0x241519);_0x27dd91&&_0x1c4b5d[_0x19d452(0x1177)](_0x241519,_0x27dd91);}for(const _0x387215 of _0x3b10bf){const _0x58e064=_0x1c4b5d[_0x19d452(0x14ee)](_0x387215[_0x19d452(0x907)]);_0x58e064&&(_0x58e064[_0x19d452(0x1f0)]=_0x58e064[_0x19d452(0x1f0)][_0x19d452(0x1195)](_0x488f7f=>_0x488f7f[_0x19d452(0xd73)]!==_0x387215[_0x19d452(0xd73)]));}_0x1c4b5d[_0x19d452(0xbdf)]>0x0&&await _0x512070[_0x19d452(0xb04)][_0x19d452(0xc71)](Array[_0x19d452(0x1311)](_0x1c4b5d[_0x19d452(0xea1)]())),lastPrivateMessagesSent=[];}const _0x18d292=_0x19ddb8[_0x19d452(0xb04)][_0x19ddb8[_0x19d452(0x859)]];if(!_0x18d292)return;const _0x5e2f54=document['getElementById'](_0x19d452(0x465)),_0x164bc0=_0x5e2f54[_0x19d452(0x131c)](_0x19d452(0x8db)),_0x64b8d8=Array[_0x19d452(0x1311)](_0x164bc0)[_0x19d452(0xb0a)](_0x56f8c1=>_0x56f8c1['value'][_0x19d452(0x13f9)]())[_0x19d452(0x1195)](Boolean),_0x3466d8=_0x18d292[_0x19d452(0x1f0)]['filter'](_0x138e17=>lastResponseTimestamps[_0x19d452(0x478)](_0x138e17[_0x19d452(0xd73)]));_0x18d292[_0x19d452(0x1f0)]=_0x18d292['history'][_0x19d452(0x1195)](_0x499ca2=>!lastResponseTimestamps[_0x19d452(0x478)](_0x499ca2[_0x19d452(0xd73)]));if(_0x64b8d8['length']===0x0){await _0x512070[_0x19d452(0xb04)][_0x19d452(0xd4d)](_0x18d292),_0x56abd7(_0x19ddb8['activeChatId']),_0xec8072(),document[_0x19d452(0x9a3)](_0x19d452(0x13aa))[_0x19d452(0x4d8)][_0x19d452(0x133d)](_0x19d452(0xc09)),lastRawAiResponse='',lastResponseTimestamps=[];return;}let _0x266a1d=[];for(const _0x11ac0a of _0x64b8d8){try{const _0xf757df=JSON[_0x19d452(0x1447)](_0x11ac0a);_0x266a1d[_0x19d452(0x1c4)](_0xf757df);}catch(_0x5292db){console['warn'](_0x19d452(0x1435),_0x11ac0a);}}const _0x1d7a65=_0x3466d8[_0x19d452(0x1195)](_0x35691e=>_0x35691e['type']===_0x19d452(0x1300));let _0x3e0b56=0x0,_0x10222d=[],_0x525f27=Date[_0x19d452(0x64b)]();const _0xe59afe=new Map();for(const _0x5c7ce1 of _0x266a1d){if(!_0x5c7ce1||typeof _0x5c7ce1!==_0x19d452(0x12fe)||!_0x5c7ce1[_0x19d452(0x1508)]){console[_0x19d452(0x651)](_0x19d452(0x121e),_0x5c7ce1);continue;}let _0x5d2266=null;const _0x5e02ac={'role':_0x19d452(0x115c),'senderName':_0x5c7ce1[_0x19d452(0x1561)]||_0x18d292['originalName'],'timestamp':_0x525f27++};switch(_0x5c7ce1[_0x19d452(0x1508)]){case _0x19d452(0x118e):{const _0x567558=_0x5c7ce1[_0x19d452(0x1561)],_0x3c9aae=_0x5c7ce1['recipient'],_0x2b1b64=_0x19ddb8[_0x19d452(0x9ce)][_0x19d452(0x246)]||_0x19d452(0x15c8);if(_0x3c9aae===_0x2b1b64){const _0x2cfb59=Object['values'](_0x19ddb8['chats'])[_0x19d452(0xd62)](_0x390fc9=>!_0x390fc9[_0x19d452(0x136b)]&&_0x390fc9['originalName']===_0x567558);if(_0x2cfb59){if(!_0xe59afe[_0x19d452(0x1472)](_0x2cfb59['id'])){const _0x163acd=_0x1c4b5d[_0x19d452(0x14ee)](_0x2cfb59['id'])||await _0x512070[_0x19d452(0xb04)][_0x19d452(0x14ee)](_0x2cfb59['id']);_0xe59afe['set'](_0x2cfb59['id'],_0x163acd);}const _0x143ab0=_0xe59afe[_0x19d452(0x14ee)](_0x2cfb59['id']),_0x33a5a3=Array[_0x19d452(0xb9b)](_0x5c7ce1[_0x19d452(0x4e3)])?_0x5c7ce1['content']:[_0x5c7ce1[_0x19d452(0x4e3)]];let _0x337ad6=0x0;for(const _0x5df76d of _0x33a5a3){if(!_0x5df76d||!_0x5df76d['trim']())continue;const _0x1c7545=_0x577e64?_0x577e64[_0x19d452(0xca9)]()['value']:null,_0x570e00=_0x1c7545&&_0x1c7545[_0x19d452(0x907)]===_0x2cfb59['id']?_0x1c7545['timestamp']:_0x525f27++,_0xd41f23={'role':'assistant','senderName':_0x567558,'content':_0x5df76d,'timestamp':_0x570e00};lastPrivateMessagesSent[_0x19d452(0x1c4)]({'chatId':_0x2cfb59['id'],'timestamp':_0xd41f23[_0x19d452(0xd73)]}),_0x143ab0[_0x19d452(0x1f0)]['push'](_0xd41f23),_0x337ad6++;}_0x337ad6>0x0&&(_0x19ddb8[_0x19d452(0x859)]!==_0x2cfb59['id']&&(_0x143ab0[_0x19d452(0xe20)]=(_0x143ab0['unreadCount']||0x0)+_0x337ad6,_0x1c6d8a(_0x2cfb59['id'],_0x2cfb59[_0x19d452(0x1561)]+_0x19d452(0x44a)+_0x337ad6+_0x19d452(0x604)))),_0x5d2266=null;}else console['warn'](_0x19d452(0x495)+_0x567558+_0x19d452(0x1149)),_0x5d2266=null;}else console[_0x19d452(0x651)](_0x19d452(0x158e)+_0x3c9aae+_0x19d452(0x6d5)),_0x5d2266=null;continue;}case _0x19d452(0x267):{const _0x3330e1=_0x19d452(0xe14)+(_0x5c7ce1[_0x19d452(0xdcc)]||'无')+'\x0a-\x20策略:\x20'+(_0x5c7ce1[_0x19d452(0x957)]||'无')+'\x0a-\x20角色思考:\x20'+JSON[_0x19d452(0xe1e)](_0x5c7ce1['character_thoughts']||{}),_0x508d57={'role':_0x19d452(0xe10),'content':_0x3330e1,'timestamp':_0x525f27++,'isHidden':!![]};_0x18d292[_0x19d452(0x1f0)][_0x19d452(0x1c4)](_0x508d57),_0x10222d['push'](_0x508d57['timestamp']);continue;}case _0x19d452(0x13ca):_0x5d2266={..._0x5e02ac,'content':String(_0x5c7ce1[_0x19d452(0x4e3)]||_0x5c7ce1[_0x19d452(0xcce)])};break;case _0x19d452(0xda8):{let _0x3c06b0=![];if(_0x5c7ce1['url']&&_0x5c7ce1[_0x19d452(0x7da)])_0x5d2266={..._0x5e02ac,'type':_0x19d452(0xda8),'content':_0x5c7ce1['url'],'meaning':_0x5c7ce1[_0x19d452(0x7da)]},_0x3c06b0=!![];else{if(_0x5c7ce1[_0x19d452(0x7da)]){const _0x185ebd=_0x19ddb8[_0x19d452(0x1557)][_0x19d452(0xd62)](_0x457771=>_0x457771[_0x19d452(0x1561)]===_0x5c7ce1[_0x19d452(0x7da)]);_0x185ebd?(_0x5d2266={..._0x5e02ac,'type':_0x19d452(0xda8),'content':_0x185ebd[_0x19d452(0x121f)],'meaning':_0x185ebd[_0x19d452(0x1561)]},_0x3c06b0=!![]):(_0x5d2266={..._0x5e02ac,'type':'text','content':_0x19d452(0x22a)+_0x5c7ce1[_0x19d452(0x7da)]+']'},_0x3c06b0=!![]);}else{if(_0x5c7ce1[_0x19d452(0x121f)]){_0x5d2266={..._0x5e02ac,'type':_0x19d452(0xda8),'content':_0x5c7ce1['url']};const _0x32f01d=_0x19ddb8[_0x19d452(0x1557)][_0x19d452(0xd62)](_0xc92f12=>_0xc92f12[_0x19d452(0x121f)]===_0x5c7ce1['url']);_0x5d2266[_0x19d452(0x7da)]=_0x32f01d?_0x32f01d[_0x19d452(0x1561)]:_0x19d452(0x7ec),_0x3c06b0=!![];}else{if(_0x5c7ce1['content']&&typeof _0x5c7ce1['content']===_0x19d452(0x86c)&&_0x115b0e['test'](_0x5c7ce1[_0x19d452(0x4e3)])){_0x5d2266={..._0x5e02ac,'type':_0x19d452(0xda8),'content':_0x5c7ce1[_0x19d452(0x4e3)]};const _0x155f2b=_0x19ddb8[_0x19d452(0x1557)][_0x19d452(0xd62)](_0x782fb6=>_0x782fb6[_0x19d452(0x121f)]===_0x5c7ce1['content']);_0x5d2266[_0x19d452(0x7da)]=_0x155f2b?_0x155f2b[_0x19d452(0x1561)]:'未知表情',_0x3c06b0=!![];}}}}if(!_0x3c06b0){console[_0x19d452(0x3b7)](_0x19d452(0x10a9),_0x5c7ce1);continue;}break;}case _0x19d452(0x1c1):_0x5d2266={..._0x5e02ac,'type':_0x19d452(0x1c1),'content':_0x5c7ce1[_0x19d452(0x3ef)],'image_prompt':_0x5c7ce1[_0x19d452(0xb95)]};break;case _0x19d452(0x1300):{const _0xf8433b=_0x5c7ce1[_0x19d452(0x3a1)];let _0x448c8f=null,_0x56e387=null;const _0xd4c158=_0x1d7a65[_0x3e0b56];_0x3e0b56++;let _0x6ad167=![];if(_0xd4c158){const _0x1382e8=_0xd4c158['prompt'];_0xf8433b&&_0xf8433b!==_0x1382e8?(console[_0x19d452(0xe4d)]('NAI\x20Prompt\x20已改变，将触发重新生成。'),_0x6ad167=!![]):(console[_0x19d452(0xe4d)](_0x19d452(0xf07)),_0x448c8f=_0xd4c158['imageUrl'],_0x56e387=_0xd4c158[_0x19d452(0x5d7)]);}else console[_0x19d452(0xe4d)](_0x19d452(0x916)),_0x6ad167=!![];if(_0x6ad167){const _0x20abe7=_0xd4c158?'检测到NAI提示词已修改，正在重新生成...':_0x19d452(0x1069);await _0x403a62(_0x19d452(0x1395),_0x20abe7);try{const _0x137e04=await _0x34bcbc(_0xf8433b,_0x18d292['id']);_0x448c8f=_0x137e04[_0x19d452(0xbfe)],_0x56e387=_0x137e04[_0x19d452(0x5d7)],await _0x403a62('成功',_0x19d452(0x5c7));}catch(_0x77b49e){console[_0x19d452(0x3b7)]('导演模式下重新生成NAI图片失败:',_0x77b49e),await _0x403a62(_0x19d452(0x8e8),'无法生成图片:\x20'+_0x77b49e[_0x19d452(0xcce)]+_0x19d452(0x6e6));if(_0xd4c158)_0x448c8f=_0xd4c158[_0x19d452(0xbfe)],_0x56e387=_0xd4c158['fullPrompt'];else{console[_0x19d452(0x3b7)](_0x19d452(0xe49));continue;}}}_0x5d2266={..._0x5e02ac,'type':_0x19d452(0x1300),'imageUrl':_0x448c8f,'prompt':_0xf8433b,'fullPrompt':_0x56e387};break;}case _0x19d452(0x1207):_0x5d2266={..._0x5e02ac,'type':_0x19d452(0x1207),'content':_0x5c7ce1[_0x19d452(0x4e3)]};break;case _0x19d452(0x4b3):_0x5d2266={..._0x5e02ac,'type':_0x19d452(0x4b3),'amount':_0x5c7ce1[_0x19d452(0x11fa)],'note':_0x5c7ce1['note'],'receiverName':_0x5c7ce1['receiver']||'我'};break;case _0x19d452(0x12ec):_0x5d2266={..._0x5e02ac,'type':'waimai_request','productInfo':_0x5c7ce1[_0x19d452(0xd97)],'amount':_0x5c7ce1[_0x19d452(0x11fa)],'status':'pending','countdownEndTime':Date[_0x19d452(0x64b)]()+0xf*0x3c*0x3e8};break;case'offline_text':_0x5d2266={..._0x5e02ac,..._0x5c7ce1};break;case'gomoku_move':{const _0x361d42=_0x2b35e7[_0x18d292['id']];if(_0x361d42){const _0x43b030=_0x361d42[_0x19d452(0x1f0)]['findLastIndex'](_0x3cce31=>_0x3cce31[_0x19d452(0x11e7)]===0x2);if(_0x43b030>-0x1){const _0x14a514=_0x361d42[_0x19d452(0x1f0)][_0x43b030];_0x361d42[_0x19d452(0x204)][_0x14a514['y']][_0x14a514['x']]=0x0,_0x361d42[_0x19d452(0x1f0)][_0x19d452(0x15b0)](_0x43b030,0x1),console[_0x19d452(0xe4d)]('导演模式悔棋：已撤销AI在\x20('+_0x14a514['x']+',\x20'+_0x14a514['y']+_0x19d452(0x9e0));}}const _0x4ac17a=parseInt(_0x5c7ce1['x']),_0x46284e=parseInt(_0x5c7ce1['y']);!isNaN(_0x4ac17a)&&!isNaN(_0x46284e)?_0x128e77({'x':_0x4ac17a,'y':_0x46284e},!![]):console['warn'](_0x19d452(0x107f),_0x5c7ce1);continue;}case _0x19d452(0xea6):{if(!_0x18d292[_0x19d452(0x136b)]){if(_0x5c7ce1['heartfelt_voice'])_0x18d292[_0x19d452(0x390)]=String(_0x5c7ce1[_0x19d452(0x50a)]);if(_0x5c7ce1['random_jottings'])_0x18d292['randomJottings']=String(_0x5c7ce1[_0x19d452(0xe0b)]);if(!Array[_0x19d452(0xb9b)](_0x18d292['thoughtsHistory']))_0x18d292[_0x19d452(0xd4a)]=[];_0x18d292['thoughtsHistory'][_0x19d452(0x1c4)]({'heartfeltVoice':_0x18d292[_0x19d452(0x390)],'randomJottings':_0x18d292[_0x19d452(0x69b)],'timestamp':Date[_0x19d452(0x64b)]()});if(_0x18d292[_0x19d452(0xd4a)][_0x19d452(0x106b)]>0x32)_0x18d292[_0x19d452(0xd4a)]['shift']();}continue;}case'quote_reply':{const _0x21ff8d=_0x18d292[_0x19d452(0x1f0)][_0x19d452(0xd62)](_0x2077ba=>_0x2077ba[_0x19d452(0xd73)]===_0x5c7ce1[_0x19d452(0xd4b)]);let _0x538169=null;if(_0x21ff8d){let _0x4e964b=_0x21ff8d[_0x19d452(0x1043)];_0x21ff8d[_0x19d452(0x11c1)]===_0x19d452(0x20d)&&(_0x4e964b=_0x18d292[_0x19d452(0x136b)]?_0x18d292[_0x19d452(0x450)][_0x19d452(0x1555)]||'我':_0x19ddb8[_0x19d452(0x9ce)][_0x19d452(0x246)]||'{{user}}'),_0x538169={'timestamp':_0x5c7ce1[_0x19d452(0xd4b)],'senderName':_0x4e964b,'content':String(_0x21ff8d[_0x19d452(0x4e3)]||'')};}else _0x538169={'timestamp':_0x5c7ce1[_0x19d452(0xd4b)],'senderName':_0x19d452(0xb17),'content':_0x19d452(0xf9e)};_0x5d2266={..._0x5e02ac,'content':_0x5c7ce1[_0x19d452(0x69c)],'quote':_0x538169};break;}default:console[_0x19d452(0x651)](_0x19d452(0xd39),_0x5c7ce1[_0x19d452(0x1508)],_0x5c7ce1);if(_0x5c7ce1[_0x19d452(0x4e3)])_0x5d2266={..._0x5e02ac,'content':String(_0x5c7ce1['content'])};else continue;break;}_0x5d2266&&(_0x18d292[_0x19d452(0x1f0)][_0x19d452(0x1c4)](_0x5d2266),_0x10222d[_0x19d452(0x1c4)](_0x5d2266['timestamp']));}await _0x512070['chats'][_0x19d452(0xd4d)](_0x18d292),_0xe59afe[_0x19d452(0xbdf)]>0x0&&await _0x512070[_0x19d452(0xb04)][_0x19d452(0xc71)](Array[_0x19d452(0x1311)](_0xe59afe[_0x19d452(0xea1)]())),_0x56abd7(_0x19ddb8[_0x19d452(0x859)]),_0xec8072(),document[_0x19d452(0x9a3)](_0x19d452(0x13aa))['classList'][_0x19d452(0x133d)](_0x19d452(0xc09)),lastRawAiResponse=_0x64b8d8['join']('\x0a\x0a'),lastResponseTimestamps=_0x10222d,await _0x403a62(_0x19d452(0xb3d),_0x19d452(0xe34));}async function _0x30f8ca(){const _0xabcf03=_0x48bc6d;if(!_0x5c6e51)return;const _0x24cbf6=0x2*0x3c*0x3e8,_0x5e3edf=_0x5c6e51,_0x443cc1=Date[_0xabcf03(0x64b)]();if(_0x443cc1-_0x5e3edf>_0x24cbf6){_0x1afb50(),await _0x403a62(_0xabcf03(0x13bd),_0xabcf03(0xe93));return;}await _0x50047a(_0x5e3edf,!![]),_0x1afb50();}async function _0x50047a(_0xc6502d,_0x473e97){const _0x32b190=_0x48bc6d,_0x150608=_0x19ddb8[_0x32b190(0xb04)][_0x19ddb8[_0x32b190(0x859)]];if(!_0x150608)return;const _0x57681b=_0x150608[_0x32b190(0x1f0)][_0x32b190(0x455)](_0x201944=>_0x201944['timestamp']===_0xc6502d);if(_0x57681b===-0x1)return;const _0x5dddd7=_0x150608[_0x32b190(0x1f0)][_0x57681b],_0x3805b3={'originalType':_0x5dddd7[_0x32b190(0x1508)]||_0x32b190(0x13ca),'originalContent':_0x5dddd7[_0x32b190(0x4e3)],'originalMeaning':_0x5dddd7[_0x32b190(0x7da)],'originalQuote':_0x5dddd7[_0x32b190(0x6f7)]};_0x5dddd7[_0x32b190(0x1508)]='recalled_message',_0x5dddd7[_0x32b190(0x4e3)]=_0x473e97?_0x32b190(0x34c):_0x32b190(0x132e),_0x5dddd7[_0x32b190(0x506)]=_0x3805b3,delete _0x5dddd7[_0x32b190(0x7da)],delete _0x5dddd7[_0x32b190(0x6f7)];if(_0x473e97){const _0x27e551=_0x150608['isGroup']?_0x150608[_0x32b190(0x450)]['myNickname']||'我':'我';let _0x2f9cef='';if(_0x3805b3[_0x32b190(0x32c)]==='sticker')_0x2f9cef=_0x32b190(0x573)+(_0x3805b3[_0x32b190(0xf55)]||'未知')+']';else _0x3805b3[_0x32b190(0x32c)]===_0x32b190(0x1c1)||_0x3805b3['originalType']==='user_photo'?_0x2f9cef=_0x32b190(0x541)+_0x3805b3[_0x32b190(0x1568)]+']':_0x2f9cef='“'+String(_0x3805b3[_0x32b190(0x1568)])+'”';const _0x5bdc82={'role':_0x32b190(0xe10),'content':_0x32b190(0x10f3)+_0x27e551+_0x32b190(0x13fe)+_0x2f9cef+'。请你对此作出回应，可以表现出好奇、开玩笑（比如\x27我截图了！\x27）、或者根据你的人设表示理解或疑惑。]','timestamp':Date[_0x32b190(0x64b)](),'isHidden':!![]};_0x150608[_0x32b190(0x1f0)][_0x32b190(0x1c4)](_0x5bdc82);}await _0x512070[_0x32b190(0xb04)][_0x32b190(0xd4d)](_0x150608),_0x56abd7(_0x19ddb8[_0x32b190(0x859)]),_0x473e97&&(_0xec8072(),_0x55bf11());}async function _0x3972c6(){const _0x575bb5=_0x48bc6d;await _0x5088a1(),document[_0x575bb5(0x9a3)](_0x575bb5(0x86b))[_0x575bb5(0x4d8)][_0x575bb5(0xe05)]('visible');}async function _0x5088a1(){const _0x3f1561=_0x48bc6d,_0x51b08b=document['getElementById'](_0x3f1561(0xe42)),_0x37ccf5=await _0x512070['worldBookCategories'][_0x3f1561(0x591)]();_0x51b08b[_0x3f1561(0xeb2)]='',_0x37ccf5[_0x3f1561(0x106b)]===0x0&&(_0x51b08b[_0x3f1561(0xeb2)]='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>'),_0x37ccf5[_0x3f1561(0x15c1)](_0x2f8f14=>{const _0x2a647e=_0x3f1561,_0x3e2019=document['createElement']('div');_0x3e2019[_0x2a647e(0x1487)]='existing-group-item',_0x3e2019[_0x2a647e(0xeb2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x2f8f14[_0x2a647e(0x1561)]+_0x2a647e(0x980)+_0x2f8f14['id']+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x51b08b['appendChild'](_0x3e2019);});}async function _0x49af57(){const _0x5eeca3=_0x48bc6d,_0x38fa62=document[_0x5eeca3(0x9a3)](_0x5eeca3(0x1113)),_0x320499=_0x38fa62[_0x5eeca3(0x7b2)][_0x5eeca3(0x13f9)]();if(!_0x320499){alert('分类名不能为空！');return;}const _0x2627b9=await _0x512070[_0x5eeca3(0x58d)][_0x5eeca3(0x1201)](_0x5eeca3(0x1561))[_0x5eeca3(0x5df)](_0x320499)[_0x5eeca3(0x92c)]();if(_0x2627b9){alert(_0x5eeca3(0xd10)+_0x320499+_0x5eeca3(0x60a));return;}await _0x512070[_0x5eeca3(0x58d)][_0x5eeca3(0xe05)]({'name':_0x320499}),_0x38fa62[_0x5eeca3(0x7b2)]='',await _0x5088a1();}async function _0x3e0187(_0x5927a1){const _0x408868=_0x48bc6d,_0x210a7f=await _0x2c9509(_0x408868(0xd05),_0x408868(0x347),{'confirmButtonClass':'btn-danger'});if(_0x210a7f){await _0x512070[_0x408868(0x58d)][_0x408868(0x10a8)](_0x5927a1);const _0x1ae20d=await _0x512070[_0x408868(0x8e4)][_0x408868(0x1201)](_0x408868(0x922))[_0x408868(0x5df)](_0x5927a1)[_0x408868(0x591)]();for(const _0x328a36 of _0x1ae20d){_0x328a36[_0x408868(0x922)]=null,await _0x512070[_0x408868(0x8e4)][_0x408868(0xd4d)](_0x328a36);const _0x5cd6e7=_0x19ddb8[_0x408868(0x8e4)]['find'](_0x4d1845=>_0x4d1845['id']===_0x328a36['id']);if(_0x5cd6e7)_0x5cd6e7[_0x408868(0x922)]=null;}await _0x5088a1();}}async function _0x3a2ec9(){const _0x195cdf=_0x48bc6d;if(!_0x5c6e51)return;const _0x55479a=_0x5c6e51;_0x1afb50();const _0x27af98=_0x19ddb8[_0x195cdf(0xb04)][_0x19ddb8[_0x195cdf(0x859)]],_0x124495=_0x27af98[_0x195cdf(0x1f0)][_0x195cdf(0xd62)](_0x4eaff9=>_0x4eaff9[_0x195cdf(0xd73)]===_0x55479a);if(!_0x124495)return;let _0x3ef190=String(_0x124495[_0x195cdf(0x4e3)]||'')['substring'](0x0,0x32)+_0x195cdf(0x4a5);if(_0x124495[_0x195cdf(0x1508)]===_0x195cdf(0x1c1))_0x3ef190=_0x195cdf(0xe48)+_0x3ef190;const _0x2df5a8=await _0x2c9509(_0x195cdf(0xcaf),_0x195cdf(0x1105)+_0x3ef190+'”',{'confirmText':'确定发布'});if(_0x2df5a8){const _0x33a6a8=_0x27af98['settings'][_0x195cdf(0x1555)]||'我';!Array[_0x195cdf(0xb9b)](_0x27af98['announcements'])&&(_0x27af98[_0x195cdf(0xf9c)]=[]);const _0x546781={'id':'anno_'+Date[_0x195cdf(0x64b)](),'messageTimestamp':_0x55479a,'publisher':_0x33a6a8,'publishedAt':Date[_0x195cdf(0x64b)](),'isPinned':![]};_0x27af98[_0x195cdf(0xf9c)][_0x195cdf(0x1c4)](_0x546781);const _0x3452c5={'role':_0x195cdf(0xe10),'type':_0x195cdf(0x1082),'content':_0x33a6a8+'\x20发布了一条新公告','timestamp':Date[_0x195cdf(0x64b)]()};_0x27af98['history'][_0x195cdf(0x1c4)](_0x3452c5),await _0x512070[_0x195cdf(0xb04)][_0x195cdf(0xd4d)](_0x27af98),_0x1ef393(_0x3452c5,_0x27af98),_0xec8072(),await _0x403a62('成功',_0x195cdf(0x999));}}async function _0x3b0850(){const _0x280ca0=_0x48bc6d,_0x3deb99=_0x19ddb8['chats'][_0x19ddb8[_0x280ca0(0x859)]],_0x203687=_0x3deb99[_0x280ca0(0xf9c)]||[];if(!_0x3deb99||_0x203687[_0x280ca0(0x106b)]===0x0){_0x403a62('提示','当前群聊还没有公告哦。');return;}const _0x5c223f=document[_0x280ca0(0x9a3)](_0x280ca0(0x5bc));_0x5c223f[_0x280ca0(0xeb2)]='',_0x203687['sort']((_0x65bcf1,_0x186667)=>(_0x186667['isPinned']?0x1:0x0)-(_0x65bcf1['isPinned']?0x1:0x0));for(const _0x49cef6 of _0x203687){const _0x1b163b=_0x3deb99[_0x280ca0(0x1f0)]['find'](_0x538260=>_0x538260[_0x280ca0(0xd73)]===_0x49cef6[_0x280ca0(0xb65)]),_0x4eae24=document[_0x280ca0(0xe94)](_0x280ca0(0x8ca));_0x4eae24['className']=_0x280ca0(0x310);if(_0x1b163b){const _0x5664b2=await _0xb42d69(_0x1b163b,_0x3deb99);_0x5664b2&&_0x4eae24[_0x280ca0(0x983)](_0x5664b2);}else _0x4eae24[_0x280ca0(0xeb2)]=_0x280ca0(0x448);_0x49cef6[_0x280ca0(0x14d8)]&&(_0x4eae24[_0x280ca0(0xeb2)]+='<div\x20class=\x22pinned-indicator\x22>📌</div>'),_0x4eae24[_0x280ca0(0xeb2)]+='<div\x20class=\x22announcement-item-actions\x22\x20data-anno-id=\x22'+_0x49cef6['id']+_0x280ca0(0x1232),_0x5c223f['appendChild'](_0x4eae24);}document[_0x280ca0(0x9a3)](_0x280ca0(0xf7b))[_0x280ca0(0x4d8)][_0x280ca0(0xe05)](_0x280ca0(0xc09));}let _0x429095=null;function _0x45017a(_0x4dbca4){const _0x4a38a3=_0x48bc6d;_0x429095=_0x4dbca4;const _0x404929=_0x19ddb8['chats'][_0x19ddb8['activeChatId']],_0x20be82=_0x404929[_0x4a38a3(0xf9c)][_0x4a38a3(0xd62)](_0x4cdfdf=>_0x4cdfdf['id']===_0x4dbca4);if(!_0x20be82)return;const _0x11364d=document[_0x4a38a3(0x9a3)](_0x4a38a3(0x1e9));_0x11364d['textContent']=_0x20be82[_0x4a38a3(0x14d8)]?_0x4a38a3(0x585):_0x4a38a3(0x112b),document[_0x4a38a3(0x9a3)](_0x4a38a3(0x39a))[_0x4a38a3(0x4d8)][_0x4a38a3(0xe05)](_0x4a38a3(0xc09));}async function _0x2b3cfc(){const _0x2387c1=_0x48bc6d;if(!_0x429095)return;const _0x5c74d3=_0x19ddb8[_0x2387c1(0xb04)][_0x19ddb8[_0x2387c1(0x859)]],_0x56f4fd=_0x5c74d3[_0x2387c1(0xf9c)][_0x2387c1(0xd62)](_0x45556d=>_0x45556d['id']===_0x429095);_0x56f4fd&&(_0x56f4fd[_0x2387c1(0x14d8)]=!_0x56f4fd['isPinned'],await _0x512070[_0x2387c1(0xb04)][_0x2387c1(0xd4d)](_0x5c74d3),_0x3b0850()),document['getElementById'](_0x2387c1(0x39a))[_0x2387c1(0x4d8)][_0x2387c1(0x133d)]('visible');}async function _0x4b4fcd(){const _0x1d43e3=_0x48bc6d;if(!_0x429095)return;const _0x524836=await _0x2c9509('确认删除',_0x1d43e3(0xaed),{'confirmButtonClass':_0x1d43e3(0xf5b)});if(_0x524836){const _0x56817d=_0x19ddb8['chats'][_0x19ddb8['activeChatId']];_0x56817d[_0x1d43e3(0xf9c)]=_0x56817d[_0x1d43e3(0xf9c)][_0x1d43e3(0x1195)](_0x1b6173=>_0x1b6173['id']!==_0x429095),await _0x512070[_0x1d43e3(0xb04)][_0x1d43e3(0xd4d)](_0x56817d),_0x3b0850();}document['getElementById']('announcement-actions-modal')[_0x1d43e3(0x4d8)][_0x1d43e3(0x133d)]('visible');}let _0x4a2ae0=![],_0x121cc7={'ai':null,'my':null};function _0x4217c3(_0x3da4e5=_0x48bc6d(0xd43)){const _0x27c0ca=_0x48bc6d,_0x900cc2=document[_0x27c0ca(0x9a3)]('avatar-frame-modal');if(!_0x19ddb8[_0x27c0ca(0x859)])return;const _0x3970e1=_0x19ddb8[_0x27c0ca(0xb04)][_0x19ddb8[_0x27c0ca(0x859)]];_0x4a2ae0=_0x3da4e5===_0x27c0ca(0x14fc);if(_0x4a2ae0){const _0x190c80=_0x3970e1['members'][_0x27c0ca(0xd62)](_0x2793b6=>_0x2793b6['id']===_0x2713c8);if(!_0x190c80)return;_0x121cc7['my']=_0x190c80[_0x27c0ca(0x10d5)]||'',_0x504b79(!![],_0x190c80[_0x27c0ca(0xf3f)],_0x190c80[_0x27c0ca(0x10d5)]);}else _0x121cc7['ai']=_0x3970e1[_0x27c0ca(0x450)][_0x27c0ca(0xdc8)]||'',_0x121cc7['my']=_0x3970e1['settings'][_0x27c0ca(0xb26)]||'',_0x504b79(![]);_0x900cc2[_0x27c0ca(0x4d8)]['add'](_0x27c0ca(0xc09));}function _0x504b79(_0xdf9987=![],_0x34c589=null,_0x4e3eaa=null){const _0x1bf49f=_0x48bc6d,_0x188b75=document[_0x1bf49f(0x9a3)](_0x1bf49f(0xb20)),_0x2b694a=document['getElementById']('my-frame-grid'),_0x18bf6d=_0x19ddb8[_0x1bf49f(0xb04)][_0x19ddb8[_0x1bf49f(0x859)]];_0x188b75[_0x1bf49f(0xeb2)]='',_0x2b694a[_0x1bf49f(0xeb2)]='',document[_0x1bf49f(0xc86)](_0x1bf49f(0x1548))[_0x1bf49f(0x20f)][_0x1bf49f(0x115d)]=_0xdf9987?_0x1bf49f(0x8e0):'flex',document['getElementById'](_0x1bf49f(0x46a))[_0x1bf49f(0x20f)][_0x1bf49f(0x115d)]=_0x1bf49f(0x10c8),document[_0x1bf49f(0x9a3)](_0x1bf49f(0x387))[_0x1bf49f(0x20f)][_0x1bf49f(0x115d)]=_0x1bf49f(0x8e0),document[_0x1bf49f(0x9a3)](_0x1bf49f(0x17f))[_0x1bf49f(0x4d8)][_0x1bf49f(0xe05)](_0x1bf49f(0xe9f)),document['getElementById'](_0x1bf49f(0x14f7))[_0x1bf49f(0x4d8)][_0x1bf49f(0x133d)](_0x1bf49f(0xe9f));if(_0xdf9987)_0x33963a['forEach'](_0xc5049c=>{const _0x1ead7d=_0x1bf49f,_0x5deebe=_0x19e53a(_0xc5049c,'my',_0x34c589);_0xc5049c['url']===_0x4e3eaa&&_0x5deebe[_0x1ead7d(0x4d8)][_0x1ead7d(0xe05)](_0x1ead7d(0x154b)),_0x188b75[_0x1ead7d(0x983)](_0x5deebe);});else{const _0x5be50e=_0x18bf6d[_0x1bf49f(0x450)][_0x1bf49f(0x4fe)]||_0x4f81ff,_0x3569d6=_0x18bf6d[_0x1bf49f(0x450)][_0x1bf49f(0x1af)]||(_0x18bf6d['isGroup']?_0xde5144:_0x4f81ff);_0x33963a[_0x1bf49f(0x15c1)](_0x5c0e88=>{const _0x53d8f8=_0x1bf49f,_0x347975=_0x19e53a(_0x5c0e88,'ai',_0x5be50e);if(_0x5c0e88[_0x53d8f8(0x121f)]===_0x121cc7['ai'])_0x347975[_0x53d8f8(0x4d8)][_0x53d8f8(0xe05)]('selected');_0x188b75[_0x53d8f8(0x983)](_0x347975);const _0x286996=_0x19e53a(_0x5c0e88,'my',_0x3569d6);if(_0x5c0e88[_0x53d8f8(0x121f)]===_0x121cc7['my'])_0x286996[_0x53d8f8(0x4d8)][_0x53d8f8(0xe05)](_0x53d8f8(0x154b));_0x2b694a[_0x53d8f8(0x983)](_0x286996);});}}function _0x19e53a(_0x575b9,_0x37f6d1,_0x441fe7){const _0x52daf6=_0x48bc6d,_0x35345=document[_0x52daf6(0xe94)](_0x52daf6(0x8ca));return _0x35345['className']=_0x52daf6(0x14d5),_0x35345[_0x52daf6(0xd8d)][_0x52daf6(0x646)]=_0x575b9[_0x52daf6(0x121f)],_0x35345[_0x52daf6(0x10b8)]=_0x575b9[_0x52daf6(0x1561)],_0x35345[_0x52daf6(0xeb2)]=_0x52daf6(0xe09)+_0x441fe7+_0x52daf6(0xd6b)+(_0x575b9[_0x52daf6(0x121f)]?'<img\x20src=\x22'+_0x575b9[_0x52daf6(0x121f)]+_0x52daf6(0x9de):'')+_0x52daf6(0x5e0),_0x35345[_0x52daf6(0x954)]('click',()=>{const _0x4d3793=_0x52daf6;_0x121cc7[_0x37f6d1]=_0x575b9[_0x4d3793(0x121f)];const _0x35b6cb=_0x37f6d1==='ai'?document[_0x4d3793(0x9a3)]('ai-frame-grid'):document['getElementById']('my-frame-grid');_0x35b6cb[_0x4d3793(0x131c)]('.frame-item')[_0x4d3793(0x15c1)](_0x26b14e=>_0x26b14e[_0x4d3793(0x4d8)][_0x4d3793(0x133d)](_0x4d3793(0x154b))),_0x35345['classList']['add'](_0x4d3793(0x154b));}),_0x35345;}async function _0x3b59ad(){const _0x26cc01=_0x48bc6d;if(!_0x19ddb8[_0x26cc01(0x859)])return;const _0x3ca0e3=_0x19ddb8[_0x26cc01(0xb04)][_0x19ddb8[_0x26cc01(0x859)]];if(_0x4a2ae0){const _0x2753cd=_0x3ca0e3[_0x26cc01(0xcca)]['find'](_0x31e5bc=>_0x31e5bc['id']===_0x2713c8);_0x2753cd&&(_0x2753cd[_0x26cc01(0x10d5)]=_0x121cc7['my']);}else _0x3ca0e3[_0x26cc01(0x450)][_0x26cc01(0xdc8)]=_0x121cc7['ai'],_0x3ca0e3[_0x26cc01(0x450)][_0x26cc01(0xb26)]=_0x121cc7['my'];await _0x512070[_0x26cc01(0xb04)]['put'](_0x3ca0e3);if(!_0x4a2ae0&&!_0x3ca0e3[_0x26cc01(0x136b)]){const _0x1bf33f=_0x3ca0e3['id'];for(const _0x2cfed0 of Object[_0x26cc01(0xea1)](_0x19ddb8[_0x26cc01(0xb04)])){if(_0x2cfed0['isGroup']&&_0x2cfed0['members']){const _0x288e23=_0x2cfed0['members'][_0x26cc01(0xd62)](_0x92ac6c=>_0x92ac6c['id']===_0x1bf33f);_0x288e23&&(_0x288e23[_0x26cc01(0x10d5)]=_0x3ca0e3[_0x26cc01(0x450)][_0x26cc01(0xdc8)],await _0x512070[_0x26cc01(0xb04)]['put'](_0x2cfed0),console[_0x26cc01(0xe4d)]('已同步角色\x20'+_0x1bf33f+_0x26cc01(0xda3)+_0x2cfed0[_0x26cc01(0x1561)]+'\x22'));}}}document[_0x26cc01(0x9a3)]('avatar-frame-modal')['classList'][_0x26cc01(0x133d)](_0x26cc01(0xc09)),_0x56abd7(_0x19ddb8[_0x26cc01(0x859)]),alert(_0x26cc01(0x879)),_0x4a2ae0=![];}function _0x566ac5(){const _0x4c2c30=_0x48bc6d;_0x288b8b=!_0x288b8b;const _0x10d9f2=document[_0x4c2c30(0x9a3)](_0x4c2c30(0x103f)),_0xfbc6e9=document['getElementById'](_0x4c2c30(0x1cc)),_0x369a6e=document[_0x4c2c30(0x9a3)](_0x4c2c30(0xaa7));document[_0x4c2c30(0x131c)](_0x4c2c30(0xdc0))[_0x4c2c30(0x15c1)](_0x2d65d6=>{const _0x26aab6=_0x4c2c30;_0x2d65d6[_0x26aab6(0x4d8)][_0x26aab6(0xc02)](_0x26aab6(0xb3e),_0x288b8b);}),_0x288b8b?(_0x10d9f2[_0x4c2c30(0x766)]='完成',_0xfbc6e9[_0x4c2c30(0x20f)][_0x4c2c30(0x115d)]=_0x4c2c30(0x79c),_0x5ec23a[_0x4c2c30(0xe81)](),_0x369a6e['checked']=![],_0x51e3cc()):(_0x10d9f2[_0x4c2c30(0x766)]='管理',_0xfbc6e9['style'][_0x4c2c30(0x115d)]='none',document[_0x4c2c30(0x131c)](_0x4c2c30(0xde5))['forEach'](_0x13db41=>{const _0x185218=_0x4c2c30;_0x13db41['classList'][_0x185218(0x133d)](_0x185218(0x154b));}));}function _0x51e3cc(){const _0x307f27=_0x48bc6d,_0x16a9ab=document[_0x307f27(0x9a3)]('delete-selected-frames-btn');_0x16a9ab['textContent']=_0x307f27(0x1587)+_0x5ec23a[_0x307f27(0xbdf)]+')';}function _0x3867a7(){const _0x2743da=_0x48bc6d,_0x4540ab=document[_0x2743da(0x9a3)](_0x2743da(0xaa7))['checked'],_0x519485=document[_0x2743da(0xc86)](_0x2743da(0x316));if(!_0x519485)return;_0x519485['querySelectorAll'](_0x2743da(0x1316))[_0x2743da(0x15c1)](_0x495a92=>{const _0x2e1a0b=_0x2743da,_0x5a7795=parseInt(_0x495a92[_0x2e1a0b(0xc86)](_0x2e1a0b(0x1366))['dataset']['id']);if(isNaN(_0x5a7795))return;_0x495a92[_0x2e1a0b(0x4d8)][_0x2e1a0b(0xc02)]('selected',_0x4540ab),_0x4540ab?_0x5ec23a[_0x2e1a0b(0xe05)](_0x5a7795):_0x5ec23a['delete'](_0x5a7795);}),_0x51e3cc();}async function _0xa5df8e(){const _0x59076e=_0x48bc6d;if(_0x5ec23a[_0x59076e(0xbdf)]===0x0)return;const _0x270764=await _0x2c9509('确认删除',_0x59076e(0x1196)+_0x5ec23a[_0x59076e(0xbdf)]+_0x59076e(0xcfe),{'confirmButtonClass':_0x59076e(0xf5b)});if(_0x270764){const _0x42c836=[..._0x5ec23a];await _0x512070[_0x59076e(0x1529)][_0x59076e(0x25c)](_0x42c836),_0x566ac5(),_0x504b79(_0x4a2ae0),await _0x403a62('删除成功',_0x59076e(0x9c9));}}function _0x15e853(_0x30ec9b){const _0x65005c=document['getElementById']('global-custom-style');_0x65005c&&(_0x65005c['innerHTML']=_0x30ec9b||'');}async function _0x2ca630(_0x348094){const _0x42014f=_0x48bc6d;if(!_0x4e0631[_0x42014f(0x1412)]||!_0x4e0631['activeChatId'])return;const _0x166af2=_0x19ddb8[_0x42014f(0xb04)][_0x4e0631[_0x42014f(0x859)]];if(!_0x166af2)return;const _0x44fbdc=_0x166af2[_0x42014f(0x136b)]?_0x166af2[_0x42014f(0x450)][_0x42014f(0x1555)]||'我':'我',_0x5afa2e=_0x42014f(0xb12)+_0x44fbdc+')\x20'+_0x348094+']',_0x517062={'role':_0x42014f(0xe10),'content':_0x5afa2e,'timestamp':Date[_0x42014f(0x64b)](),'isHidden':!![]};_0x166af2['history'][_0x42014f(0x1c4)](_0x517062),await _0x512070[_0x42014f(0xb04)][_0x42014f(0xd4d)](_0x166af2);}async function _0x4dc586(){const _0x5756c7=_0x48bc6d;if(_0x445138[_0x5756c7(0xbdf)]===0x0)return;const _0x34435b=_0x19ddb8[_0x5756c7(0xb04)][_0x19ddb8[_0x5756c7(0x859)]];if(!_0x34435b)return;const _0x30911c=document[_0x5756c7(0x9a3)](_0x5756c7(0x146e)),_0x561e94=_0x30911c['textContent'];_0x30911c[_0x5756c7(0x766)]='生成中...',_0x30911c['disabled']=!![];const _0x1d6ad5=document['createElement']('div'),_0x2d96f5=document['getElementById'](_0x5756c7(0xae7));_0x1d6ad5[_0x5756c7(0x20f)]['width']=_0x2d96f5['offsetWidth']+'px',_0x1d6ad5['style'][_0x5756c7(0xc7a)]=_0x5756c7(0x1321),_0x1d6ad5[_0x5756c7(0x20f)][_0x5756c7(0xe8f)]=_0x5756c7(0x9d7),_0x1d6ad5[_0x5756c7(0x20f)][_0x5756c7(0xb90)]=_0x5756c7(0x9d7),_0x1d6ad5[_0x5756c7(0x20f)][_0x5756c7(0x115d)]=_0x5756c7(0x79c),_0x1d6ad5[_0x5756c7(0x20f)][_0x5756c7(0x1580)]='column',_0x1d6ad5[_0x5756c7(0x20f)][_0x5756c7(0x397)]=_0x5756c7(0xaf8);const _0x427cb7=document[_0x5756c7(0x9a3)](_0x5756c7(0x3e5));_0x1d6ad5[_0x5756c7(0x20f)][_0x5756c7(0x1090)]=_0x427cb7[_0x5756c7(0x20f)][_0x5756c7(0x1090)],_0x1d6ad5[_0x5756c7(0x20f)][_0x5756c7(0x87e)]=_0x427cb7[_0x5756c7(0x20f)][_0x5756c7(0x87e)]||(document['getElementById']('phone-screen')[_0x5756c7(0x4d8)][_0x5756c7(0x1222)](_0x5756c7(0x282))?_0x5756c7(0x528):_0x5756c7(0xee8));const _0x5ad1d2=document[_0x5756c7(0xe94)](_0x5756c7(0x20f));_0x5ad1d2['innerHTML']=_0x5756c7(0xeb8),document['head']['appendChild'](_0x5ad1d2);try{const _0x65c6c8=_0x427cb7[_0x5756c7(0xc86)](_0x5756c7(0x87a))[_0x5756c7(0x173)](!![]);_0x65c6c8[_0x5756c7(0x4d8)]['add']('cloned-header');const _0x1515c8=document[_0x5756c7(0xe94)](_0x5756c7(0x8ca)),_0x36dca7=document[_0x5756c7(0x9a3)](_0x5756c7(0x10f8));_0x1515c8[_0x5756c7(0x20f)][_0x5756c7(0x115d)]=_0x5756c7(0x79c),_0x1515c8[_0x5756c7(0x20f)][_0x5756c7(0x1580)]=_0x5756c7(0x14f6),_0x1515c8[_0x5756c7(0x20f)]['gap']=_0x5756c7(0xb9c),_0x1515c8['style'][_0x5756c7(0x8eb)]=_0x5756c7(0xe3d),_0x1515c8[_0x5756c7(0x20f)][_0x5756c7(0xeb0)]=_0x5756c7(0xf88),_0x1515c8[_0x5756c7(0x20f)]['boxSizing']=_0x5756c7(0x6ac),_0x1515c8[_0x5756c7(0xd8d)][_0x5756c7(0x910)]=_0x36dca7['dataset'][_0x5756c7(0x910)],_0x1515c8[_0x5756c7(0x20f)]['setProperty'](_0x5756c7(0xcee),_0x36dca7[_0x5756c7(0x20f)][_0x5756c7(0xbf4)]('--chat-font-size'));const _0x76404b=_0x427cb7[_0x5756c7(0xc86)](_0x5756c7(0x468))[_0x5756c7(0x173)](!![]),_0x6d2824=[..._0x445138]['sort']((_0x3e4ef2,_0x189564)=>_0x3e4ef2-_0x189564);_0x6d2824[_0x5756c7(0x15c1)](_0x3fa424=>{const _0x576800=_0x5756c7,_0x1fc432=document[_0x576800(0xc86)](_0x576800(0x1c5)+_0x3fa424+'\x22]');if(_0x1fc432){const _0x1fe684=_0x1fc432[_0x576800(0x94c)]('.message-wrapper');_0x1fe684&&_0x1515c8[_0x576800(0x983)](_0x1fe684[_0x576800(0x173)](!![]));}}),_0x1d6ad5['appendChild'](_0x65c6c8),_0x1d6ad5[_0x5756c7(0x983)](_0x1515c8),_0x1d6ad5[_0x5756c7(0x983)](_0x76404b),document[_0x5756c7(0x7c3)][_0x5756c7(0x983)](_0x1d6ad5);const _0x2ba4ea=Array[_0x5756c7(0x1311)](_0x1d6ad5[_0x5756c7(0xdfa)](_0x5756c7(0x1212))),_0x13c18d=_0x2ba4ea['map'](_0x163d66=>new Promise((_0x5ccf96,_0x5a7090)=>{const _0x1c241d=_0x5756c7;if(_0x163d66['src'][_0x1c241d(0x608)](_0x1c241d(0xf82))){_0x5ccf96();return;}const _0x41c01d=new Image();_0x41c01d[_0x1c241d(0xa9e)]=_0x1c241d(0x1554),_0x41c01d[_0x1c241d(0xdd7)]=_0x5ccf96,_0x41c01d['onerror']=_0x5ccf96,_0x41c01d[_0x1c241d(0x10d4)]=_0x163d66[_0x1c241d(0x10d4)];}));await Promise['all'](_0x13c18d);const _0x275d83=await html2canvas(_0x1d6ad5,{'allowTaint':!![],'useCORS':!![],'backgroundColor':null,'scale':window[_0x5756c7(0x13d4)]||0x2});_0x275d83[_0x5756c7(0x129e)](function(_0xe430df){const _0x5a48bf=_0x5756c7,_0x4ca08a=URL[_0x5a48bf(0xc56)](_0xe430df),_0x40400b=document[_0x5a48bf(0xe94)]('a');_0x40400b[_0x5a48bf(0xed2)]=_0x5a48bf(0x88a)+_0x34435b[_0x5a48bf(0x1561)]+'-'+Date[_0x5a48bf(0x64b)]()+'.png',_0x40400b[_0x5a48bf(0xe6b)]=_0x4ca08a,document[_0x5a48bf(0x7c3)]['appendChild'](_0x40400b),_0x40400b[_0x5a48bf(0x9cc)](),document[_0x5a48bf(0x7c3)][_0x5a48bf(0x994)](_0x40400b),URL[_0x5a48bf(0xb93)](_0x4ca08a);},_0x5756c7(0x15af));}catch(_0x5a05ea){console[_0x5756c7(0x3b7)]('长截图生成失败:',_0x5a05ea),await _0x403a62(_0x5756c7(0x8e8),_0x5756c7(0xaf3));}finally{document[_0x5756c7(0x7c3)][_0x5756c7(0x994)](_0x1d6ad5),document['head'][_0x5756c7(0x994)](_0x5ad1d2),_0x30911c[_0x5756c7(0x766)]=_0x561e94,_0x30911c[_0x5756c7(0x15d3)]=![],_0x501f17();}}function _0x49f635(_0x20cdbd){const _0x3b8f51=_0x48bc6d;if(!_0x20cdbd||typeof _0x20cdbd!==_0x3b8f51(0x86c))return'';return _0x20cdbd=_0x20cdbd[_0x3b8f51(0x1bb)](/!h\{(.*?)\}/g,_0x3b8f51(0x15a9)),_0x20cdbd=_0x20cdbd['replace'](/!u\{(.*?)\}/g,_0x3b8f51(0xf25)),_0x20cdbd=_0x20cdbd[_0x3b8f51(0x1bb)](/!e\{(.*?)\}/g,_0x3b8f51(0x8b3)),_0x20cdbd=_0x20cdbd[_0x3b8f51(0x1bb)](/!w\{(.*?)\}/g,_0x3b8f51(0x494)),_0x20cdbd=_0x20cdbd[_0x3b8f51(0x1bb)](/!m\{(.*?)\}/g,'<span\x20class=\x22diary-messy\x22>$1</span>'),_0x20cdbd=_0x20cdbd[_0x3b8f51(0x1bb)](/\|\|(.*?)\|\|/g,'<span\x20class=\x22spoiler\x22>$1</span>'),_0x20cdbd=_0x20cdbd[_0x3b8f51(0x1bb)](/\*\*(.*?)\*\*/g,_0x3b8f51(0x832)),_0x20cdbd=_0x20cdbd[_0x3b8f51(0x1bb)](/\~\~(.*?)\~\~/g,_0x3b8f51(0x10d0)),_0x20cdbd=_0x20cdbd[_0x3b8f51(0x1bb)](/\*(.*?)\*/g,_0x3b8f51(0x37d)),_0x20cdbd;}async function _0x5a3301(){const _0x2ebe41=_0x48bc6d;console['log'](_0x2ebe41(0xbc9));let _0x406c3a=0x0;const _0x9c07ba=Object[_0x2ebe41(0xea1)](_0x19ddb8['chats']);for(const _0x2dff0c of _0x9c07ba){let _0x428b5b=![];for(const _0x1ae215 of _0x2dff0c[_0x2ebe41(0x1f0)]){_0x1ae215[_0x2ebe41(0x1508)]===_0x2ebe41(0x552)&&_0x1ae215[_0x2ebe41(0x4ee)]==='direct'&&_0x1ae215[_0x2ebe41(0x11c1)]==='assistant'&&_0x1ae215[_0x2ebe41(0x5fb)](_0x2ebe41(0x599))&&!_0x1ae215[_0x2ebe41(0x5fb)](_0x2ebe41(0x13e2))&&(_0x1ae215[_0x2ebe41(0x13e2)]=_0x1ae215[_0x2ebe41(0x599)],delete _0x1ae215[_0x2ebe41(0x599)],_0x428b5b=!![],_0x406c3a++);}_0x428b5b&&(console['log'](_0x2ebe41(0x5f8)+_0x2dff0c[_0x2ebe41(0x1561)]+_0x2ebe41(0x49e)),await _0x512070[_0x2ebe41(0xb04)][_0x2ebe41(0xd4d)](_0x2dff0c));}_0x406c3a>0x0?(console[_0x2ebe41(0xe4d)](_0x2ebe41(0xa80)+_0x406c3a+'\x20条红包记录。'),alert(_0x2ebe41(0x11a1)+_0x406c3a+_0x2ebe41(0x2b9)),location[_0x2ebe41(0x137d)]()):console[_0x2ebe41(0xe4d)](_0x2ebe41(0xff6));}async function _0x1ad4aa(){const _0x7e04a8=_0x48bc6d;if(!_0x19ddb8['activeChatId']||_0x19ddb8[_0x7e04a8(0xb04)][_0x19ddb8[_0x7e04a8(0x859)]][_0x7e04a8(0x136b)])return;const _0x4962f1=_0x19ddb8[_0x7e04a8(0xb04)][_0x19ddb8['activeChatId']];if(!_0x4962f1)return;const _0x3d8a04=_0x4962f1[_0x7e04a8(0x390)]||'',_0x3a9ac9=await _0x3ab788(_0x7e04a8(0x25b)+_0x4962f1[_0x7e04a8(0x1561)]+_0x7e04a8(0x1269),_0x7e04a8(0xadc),_0x3d8a04,_0x7e04a8(0x8db));if(_0x3a9ac9===null){await _0x403a62(_0x7e04a8(0xf83),_0x7e04a8(0x372));return;}const _0x26276b=_0x4962f1[_0x7e04a8(0x69b)]||'',_0x59343c=await _0x3ab788(_0x7e04a8(0x25b)+_0x4962f1[_0x7e04a8(0x1561)]+_0x7e04a8(0x3d9),'请输入新的散记内容...',_0x26276b,_0x7e04a8(0x8db));if(_0x59343c===null){await _0x403a62(_0x7e04a8(0xf83),_0x7e04a8(0x1496));return;}_0x4962f1[_0x7e04a8(0x390)]=_0x3a9ac9[_0x7e04a8(0x13f9)](),_0x4962f1['randomJottings']=_0x59343c['trim']();!Array['isArray'](_0x4962f1[_0x7e04a8(0xd4a)])&&(_0x4962f1[_0x7e04a8(0xd4a)]=[]);if(_0x4962f1[_0x7e04a8(0xd4a)][_0x7e04a8(0x106b)]>0x0){const _0x37cb7c=_0x4962f1[_0x7e04a8(0xd4a)][_0x4962f1['thoughtsHistory']['length']-0x1];_0x37cb7c[_0x7e04a8(0x390)]=_0x4962f1[_0x7e04a8(0x390)],_0x37cb7c[_0x7e04a8(0x69b)]=_0x4962f1[_0x7e04a8(0x69b)],_0x37cb7c[_0x7e04a8(0xd73)]=Date['now']();}else _0x4962f1[_0x7e04a8(0xd4a)][_0x7e04a8(0x1c4)]({'heartfeltVoice':_0x4962f1[_0x7e04a8(0x390)],'randomJottings':_0x4962f1[_0x7e04a8(0x69b)],'timestamp':Date[_0x7e04a8(0x64b)]()});await _0x512070[_0x7e04a8(0xb04)]['put'](_0x4962f1),await _0x53d640(_0x4962f1['id']),await _0x403a62('成功',_0x7e04a8(0xb15));}async function _0x53d640(_0x2c83dd){const _0x7054a2=_0x48bc6d,_0x3a630d=_0x19ddb8[_0x7054a2(0xb04)][_0x2c83dd];if(!_0x3a630d||_0x3a630d['isGroup'])return;const _0x1c5066=document[_0x7054a2(0x9a3)](_0x7054a2(0xaf9)),_0x5edca8=document['getElementById']('profile-random-jottings');_0x1c5066['innerHTML']=await _0x5ec228(_0x3a630d[_0x7054a2(0x390)]||_0x7054a2(0x4a5),_0x2c83dd),_0x5edca8[_0x7054a2(0xeb2)]=await _0x5ec228(_0x3a630d[_0x7054a2(0x69b)]||_0x7054a2(0x4a5),_0x2c83dd);const _0x1e7541=document['getElementById']('character-profile-modal');_0x1e7541[_0x7054a2(0x4d8)][_0x7054a2(0xe05)]('visible');}async function _0x12e742(){const _0x5e30ac=_0x48bc6d;document[_0x5e30ac(0x9a3)](_0x5e30ac(0x1020))['style'][_0x5e30ac(0x115d)]=_0x5e30ac(0x8e0),document['getElementById'](_0x5e30ac(0x42d))[_0x5e30ac(0x20f)][_0x5e30ac(0x115d)]=_0x5e30ac(0x79c),await _0x2e5e9a();}function _0x38915d(){const _0x346f5a=_0x48bc6d;document[_0x346f5a(0x9a3)](_0x346f5a(0x42d))['style'][_0x346f5a(0x115d)]=_0x346f5a(0x8e0),document[_0x346f5a(0x9a3)]('profile-main-content')[_0x346f5a(0x20f)]['display']='flex';}async function _0x2e5e9a(){const _0x4264c3=_0x48bc6d,_0x193356=document[_0x4264c3(0x9a3)](_0x4264c3(0x13e5)),_0x409375=_0x19ddb8['chats'][_0x19ddb8[_0x4264c3(0x859)]];_0x193356[_0x4264c3(0xeb2)]='';if(!_0x409375||!_0x409375[_0x4264c3(0xd4a)]||_0x409375[_0x4264c3(0xd4a)][_0x4264c3(0x106b)]===0x0){_0x193356['innerHTML']=_0x4264c3(0x1589);return;}const _0xd4edc5=[..._0x409375[_0x4264c3(0xd4a)]][_0x4264c3(0x333)](),_0x2d8183=_0xd4edc5['slice'](0x0,_0x5a7b3f),_0x51c84d=_0x2d8183['map'](_0x18409c=>_0x5aab89(_0x18409c)),_0x38ec27=await Promise[_0x4264c3(0xbf1)](_0x51c84d);_0x38ec27[_0x4264c3(0x15c1)](_0x4289d7=>_0x193356[_0x4264c3(0x983)](_0x4289d7)),_0x5e066a=_0x2d8183[_0x4264c3(0x106b)],_0xd4edc5[_0x4264c3(0x106b)]>_0x5e066a&&appendLoadMoreThoughtsButton(_0x193356);}async function _0x17a15b(){const _0x327189=_0x48bc6d;if(_0x2dcadb)return;_0x2dcadb=!![];const _0x5dec00=document[_0x327189(0x9a3)](_0x327189(0x13e5)),_0x37c982=_0x19ddb8[_0x327189(0xb04)][_0x19ddb8[_0x327189(0x859)]];if(!_0x37c982){_0x2dcadb=![];return;}_0x3335f4(_0x5dec00,_0x327189(0x837)),await new Promise(_0x125201=>setTimeout(_0x125201,0x1f4));const _0x1006ba=[..._0x37c982[_0x327189(0xd4a)]][_0x327189(0x333)](),_0x396bdb=_0x1006ba[_0x327189(0x106b)],_0x196531=_0x5e066a,_0x22f4cd=_0x5e066a+_0x5a7b3f,_0x44cb7d=_0x1006ba[_0x327189(0x457)](_0x196531,_0x22f4cd);_0x38511a(_0x5dec00);const _0x580dc5=_0x44cb7d[_0x327189(0xb0a)](_0x1f6cf5=>_0x5aab89(_0x1f6cf5)),_0x3298bd=await Promise[_0x327189(0xbf1)](_0x580dc5);_0x3298bd[_0x327189(0x15c1)](_0x583e52=>_0x5dec00[_0x327189(0x983)](_0x583e52)),_0x5e066a+=_0x44cb7d[_0x327189(0x106b)],_0x2dcadb=![];}async function _0x5aab89(_0x3fe665){const _0x2c2cf1=_0x48bc6d,_0x6b21b=document[_0x2c2cf1(0xe94)]('div');_0x6b21b['className']=_0x2c2cf1(0x3b1);const _0x2af6d0=new Date(_0x3fe665[_0x2c2cf1(0xd73)]),_0x24a5d4=_0x2af6d0[_0x2c2cf1(0xef7)]()+'-'+String(_0x2af6d0[_0x2c2cf1(0x1428)]()+0x1)[_0x2c2cf1(0x1488)](0x2,'0')+'-'+String(_0x2af6d0[_0x2c2cf1(0x67c)]())['padStart'](0x2,'0')+'\x20'+String(_0x2af6d0[_0x2c2cf1(0x106f)]())['padStart'](0x2,'0')+':'+String(_0x2af6d0[_0x2c2cf1(0xa21)]())[_0x2c2cf1(0x1488)](0x2,'0'),_0x103487=_0x19ddb8['activeChatId'],_0xdd199b=await _0x5ec228(_0x3fe665['heartfeltVoice']||_0x2c2cf1(0x4a5),_0x103487),_0x1a0228=await _0x5ec228(_0x3fe665['randomJottings']||'...',_0x103487);return _0x6b21b[_0x2c2cf1(0xeb2)]=_0x2c2cf1(0x114a)+_0x3fe665[_0x2c2cf1(0xd73)]+_0x2c2cf1(0x399)+_0x24a5d4+_0x2c2cf1(0x1537)+_0xdd199b+_0x2c2cf1(0x1fe)+_0x1a0228+_0x2c2cf1(0x560),_0x6b21b;}async function _0x294ad5(_0x2d5b83){const _0x40d2f6=_0x48bc6d,_0x21eb8b=_0x2d5b83[_0x40d2f6(0xa41)][_0x40d2f6(0x104e)][0x0];if(!_0x21eb8b)return;try{let _0x3c3932,_0x3fbf38=null;if(_0x21eb8b['name'][_0x40d2f6(0xb5a)](_0x40d2f6(0x6db))){const _0x3c0a79=await _0x21eb8b['text']();_0x3c3932=JSON[_0x40d2f6(0x1447)](_0x3c0a79);}else{if(_0x21eb8b[_0x40d2f6(0x1561)][_0x40d2f6(0xb5a)](_0x40d2f6(0x1335))){const _0x3df429=await _0x21eb8b[_0x40d2f6(0x129a)]();_0x3c3932=await _0x3ca617(_0x3df429),_0x3fbf38=await new Promise(_0x3c8957=>{const _0x2526f0=_0x40d2f6,_0x517a79=new FileReader();_0x517a79[_0x2526f0(0xdd7)]=()=>_0x3c8957(_0x517a79['result']),_0x517a79['readAsDataURL'](_0x21eb8b);});}else throw new Error(_0x40d2f6(0x1ff));}await _0x17c392(_0x3c3932,_0x3fbf38);}catch(_0xaeb284){console[_0x40d2f6(0x3b7)]('角色卡导入失败:',_0xaeb284),await _0x403a62('导入失败',_0x40d2f6(0x255)+_0xaeb284[_0x40d2f6(0xcce)]);}finally{_0x2d5b83[_0x40d2f6(0xa41)][_0x40d2f6(0x7b2)]=null;}}function _0x3ca617(_0x4f0bd8){return new Promise((_0x3a58bf,_0x4f7e4e)=>{const _0x2c8490=_0x1efc,_0x785ebd=new DataView(_0x4f0bd8);if(_0x785ebd[_0x2c8490(0x10e0)](0x0)!==0x89504e47||_0x785ebd[_0x2c8490(0x10e0)](0x4)!==0xd0a1a0a)return _0x4f7e4e(new Error(_0x2c8490(0xa2c)));let _0x2cbd21=0x8;const _0x4d3d67=new TextDecoder();while(_0x2cbd21<_0x785ebd['byteLength']){const _0x2b3622=_0x785ebd['getUint32'](_0x2cbd21),_0x9916a8=_0x4d3d67['decode'](_0x4f0bd8[_0x2c8490(0x457)](_0x2cbd21+0x4,_0x2cbd21+0x8));if(_0x9916a8===_0x2c8490(0x34e)){const _0x4256fa=new Uint8Array(_0x4f0bd8,_0x2cbd21+0x8,_0x2b3622),_0x23fb39=_0x4256fa[_0x2c8490(0xef5)](0x0);if(_0x23fb39!==-0x1){const _0x2b0535=_0x4d3d67['decode'](_0x4256fa[_0x2c8490(0x457)](0x0,_0x23fb39));if(_0x2b0535===_0x2c8490(0x12c7)){const _0x2e03a2=_0x4d3d67[_0x2c8490(0xad2)](_0x4256fa[_0x2c8490(0x457)](_0x23fb39+0x1));try{const _0x5b0030=atob(_0x2e03a2),_0x33a78e=new Uint8Array(_0x5b0030[_0x2c8490(0x106b)]);for(let _0x2926b0=0x0;_0x2926b0<_0x5b0030[_0x2c8490(0x106b)];_0x2926b0++){_0x33a78e[_0x2926b0]=_0x5b0030[_0x2c8490(0xc75)](_0x2926b0);}const _0x344559=new TextDecoder(_0x2c8490(0x93d))[_0x2c8490(0xad2)](_0x33a78e);_0x3a58bf(JSON['parse'](_0x344559));return;}catch(_0x46d931){return _0x4f7e4e(new Error(_0x2c8490(0x98a)+_0x46d931[_0x2c8490(0xcce)]));}}}}_0x2cbd21+=0x4+0x4+_0x2b3622+0x4;}_0x4f7e4e(new Error(_0x2c8490(0x117c)));});}function _0x303455(_0x48962c){const _0xa280ad=_0x48bc6d;if(_0x48962c[_0xa280ad(0x38c)]?.[_0xa280ad(0xe18)]?.[_0xa280ad(0x10c3)]?.['length']>0x0)return console[_0xa280ad(0xe4d)]('诊断：在\x20data.character_book\x20中找到世界书。'),_0x48962c[_0xa280ad(0x38c)][_0xa280ad(0xe18)][_0xa280ad(0x10c3)];if(_0x48962c[_0xa280ad(0xbbd)]?.[_0xa280ad(0xe18)]?.[_0xa280ad(0x10c3)]?.[_0xa280ad(0x106b)]>0x0)return console[_0xa280ad(0xe4d)](_0xa280ad(0x8d6)),_0x48962c['extensions']['character_book']['entries'];if(_0x48962c[_0xa280ad(0x38c)]?.[_0xa280ad(0xbbd)]?.[_0xa280ad(0xe18)]?.[_0xa280ad(0x10c3)]?.[_0xa280ad(0x106b)]>0x0)return console['log'](_0xa280ad(0x1216)),_0x48962c[_0xa280ad(0x38c)][_0xa280ad(0xbbd)][_0xa280ad(0xe18)]['entries'];const _0x4f0668=[_0xa280ad(0xe18),_0xa280ad(0x1456),_0xa280ad(0x123b),_0xa280ad(0x3ee)];for(const _0x39e787 of _0x4f0668){if(_0x48962c[_0x39e787]?.[_0xa280ad(0x10c3)]?.[_0xa280ad(0x106b)]>0x0)return console['log']('诊断：在顶层\x20'+_0x39e787+_0xa280ad(0x126d)),_0x48962c[_0x39e787][_0xa280ad(0x10c3)];}return console[_0xa280ad(0xe4d)](_0xa280ad(0x14cf)),null;}async function _0x17c392(_0x3d1a4b,_0x47723e=null){const _0x57ea14=_0x48bc6d,_0x4d9795=_0x3d1a4b['data']||_0x3d1a4b;if(!_0x4d9795[_0x57ea14(0x1561)])throw new Error(_0x57ea14(0x1228));let _0x370a9f=null;const _0x49cdd3=_0x303455(_0x3d1a4b);if(_0x49cdd3){const _0x5a0ba6=_0x49cdd3[_0x57ea14(0x1195)](_0x486c2d=>_0x486c2d[_0x57ea14(0x15cd)]&&_0x486c2d['content'])[_0x57ea14(0xb0a)](_0x3b5bd0=>({'keys':_0x3b5bd0[_0x57ea14(0x2d0)]||[],'comment':_0x3b5bd0[_0x57ea14(0x79d)]||'','content':_0x3b5bd0[_0x57ea14(0x4e3)][_0x57ea14(0x1bb)](/<memory>|<\/memory>/g,'')[_0x57ea14(0x13f9)]()}));if(_0x5a0ba6['length']>0x0){const _0x44f54f={'id':_0x57ea14(0xc83)+Date[_0x57ea14(0x64b)](),'name':_0x4d9795[_0x57ea14(0x1561)]+_0x57ea14(0xa7f),'content':_0x5a0ba6,'categoryId':null};await _0x512070[_0x57ea14(0x8e4)][_0x57ea14(0xe05)](_0x44f54f),_0x19ddb8[_0x57ea14(0x8e4)]['push'](_0x44f54f),_0x370a9f=_0x44f54f['id'];}}let _0x181b73=_0x4d9795[_0x57ea14(0x3ef)]||_0x3d1a4b['description']||'无';_0x181b73=_0x181b73[_0x57ea14(0x1bb)](/```yaml/g,'')[_0x57ea14(0x1bb)](/```/g,'')[_0x57ea14(0x1bb)](/<\/?info>/g,'')['replace'](/<\/?character>/g,'')[_0x57ea14(0x1bb)](/<\/?writing_rule>/g,'')['replace'](/\[OOC：.*?\]/g,'')[_0x57ea14(0x13f9)]();let _0x40b127=_0x57ea14(0x111d)+_0x181b73+'\x0a\x0a';if(_0x4d9795[_0x57ea14(0xf22)])_0x40b127+=_0x57ea14(0x15ad)+_0x4d9795[_0x57ea14(0xf22)]+'\x0a\x0a';if(_0x4d9795[_0x57ea14(0x127a)])_0x40b127+=_0x57ea14(0x446)+_0x4d9795['scenario']+'\x0a\x0a';if(_0x4d9795['mes_example'])_0x40b127+=_0x57ea14(0x135f)+_0x4d9795[_0x57ea14(0x124d)]+'\x0a\x0a';const _0x562bb5=_0x4d9795['name'],_0x393346=_0x4d9795[_0x57ea14(0x1561)],_0x194e31=_0x57ea14(0x97a)+Date[_0x57ea14(0x64b)](),_0x580559={'id':_0x194e31,'name':_0x562bb5[_0x57ea14(0x13f9)](),'originalName':_0x393346['trim'](),'isGroup':![],'relationship':{'status':_0x57ea14(0xf81)},'status':{'text':'在线','lastUpdate':Date['now'](),'isBusy':![]},'settings':{'aiPersona':_0x40b127,'myPersona':_0x57ea14(0x5b1),'maxMemory':0xa,'aiAvatar':_0x4f81ff,'myAvatar':_0x4f81ff,'background':'','theme':_0x57ea14(0xd5f),'fontSize':0xd,'customCss':'','linkedWorldBookIds':_0x370a9f?[_0x370a9f]:[],'aiAvatarLibrary':[]},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[]};_0x47723e&&(_0x580559[_0x57ea14(0x450)][_0x57ea14(0x4fe)]=_0x47723e,_0x580559[_0x57ea14(0x450)]['aiAvatarLibrary'][_0x57ea14(0x1c4)]({'name':'默认头像','url':_0x47723e}));const _0x5c2778=_0x4d9795['first_mes']||_0x3d1a4b[_0x57ea14(0x90e)];if(_0x5c2778&&typeof _0x5c2778===_0x57ea14(0x86c)){const _0x251ffc=document[_0x57ea14(0xe94)]('div');_0x251ffc['innerHTML']=_0x5c2778;const _0x5cc651=(_0x251ffc[_0x57ea14(0x766)]||_0x251ffc[_0x57ea14(0x1a9)]||'')[_0x57ea14(0x1bb)](/原作者UR.*?开局/s,'')[_0x57ea14(0x13f9)]();_0x5cc651&&_0x580559[_0x57ea14(0x1f0)][_0x57ea14(0x1c4)]({'role':_0x57ea14(0x115c),'senderName':_0x580559[_0x57ea14(0x339)],'content':_0x5cc651,'timestamp':Date[_0x57ea14(0x64b)]()});}_0x19ddb8['chats'][_0x194e31]=_0x580559,await _0x512070[_0x57ea14(0xb04)][_0x57ea14(0xd4d)](_0x580559),_0xec8072();let _0x306610=_0x57ea14(0x6e8)+_0x580559[_0x57ea14(0x1561)]+_0x57ea14(0x706);_0x370a9f&&(_0x306610+=_0x57ea14(0x371)),await _0x403a62(_0x57ea14(0x125b),_0x306610);}async function _0x55c115(){const _0x537d36=_0x48bc6d;if(!_0x19ddb8[_0x537d36(0x859)])return;const _0x145cd4=_0x19ddb8[_0x537d36(0xb04)][_0x19ddb8['activeChatId']],_0x42dea7=_0x145cd4['settings'][_0x537d36(0xacc)];if(!_0x42dea7||_0x42dea7[_0x537d36(0x106b)]===0x0){alert(_0x537d36(0xc82));return;}const _0x162295=_0x42dea7[_0x537d36(0xb0a)]((_0x442478,_0x526644)=>{const _0x41a678=_0x537d36,_0x289d0b=_0x442478[_0x41a678(0x1bb)](/<[^>]*>/g,'')[_0x41a678(0x13f9)]()[_0x41a678(0x72e)](0x0,0x14);return{'text':_0x41a678(0x7d8)+(_0x526644+0x1)+':\x20'+_0x289d0b+_0x41a678(0x4a5),'value':_0x526644};}),_0x1af023=await _0x49acac(_0x537d36(0x82b),_0x162295);if(_0x1af023!==null){const _0x873a47=await _0x2c9509(_0x537d36(0x6c3),_0x537d36(0x12f5),{'confirmButtonClass':'btn-danger','confirmText':_0x537d36(0x619)});if(_0x873a47){const _0x99f9d1=_0x42dea7[_0x1af023],_0x113ad9={'role':_0x537d36(0x115c),'senderName':_0x145cd4['originalName'],'content':_0x99f9d1,'timestamp':Date[_0x537d36(0x64b)]()};_0x145cd4[_0x537d36(0x1f0)]=[_0x113ad9],await _0x512070['chats']['put'](_0x145cd4),_0x56abd7(_0x145cd4['id']),document[_0x537d36(0x9a3)]('chat-settings-modal')[_0x537d36(0x4d8)][_0x537d36(0x133d)](_0x537d36(0xc09)),await _0x403a62('成功',_0x537d36(0x932));}}}function _0x33835a(_0x41b740={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x3c19a9=_0x48bc6d,_0x3118ad=document[_0x3c19a9(0xe94)](_0x3c19a9(0x8ca));_0x3118ad[_0x3c19a9(0x1487)]=_0x3c19a9(0x83a);const _0x40c9b1=_0x41b740[_0x3c19a9(0x15cd)]!==![]?'checked':'';return _0x3118ad[_0x3c19a9(0xeb2)]=_0x3c19a9(0x1583)+_0x40c9b1+_0x3c19a9(0x241)+(_0x41b740[_0x3c19a9(0x79d)]||'')+'\x22\x20placeholder=\x22例如：关于角色的童年\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22'+(_0x41b740[_0x3c19a9(0x2d0)]||[])[_0x3c19a9(0x3b9)](',\x20')+_0x3c19a9(0x44d)+(_0x41b740[_0x3c19a9(0x4e3)]||'')+_0x3c19a9(0xb94),_0x3118ad[_0x3c19a9(0xc86)]('.delete-block-btn')[_0x3c19a9(0x954)](_0x3c19a9(0x9cc),()=>{const _0x472156=_0x3c19a9;_0x3118ad[_0x472156(0x133d)]();}),_0x3118ad;}async function _0x18d554(){const _0xacb3b0=_0x48bc6d;if(!_0x19ddb8[_0xacb3b0(0x859)])return;const _0x3abeef=_0x19ddb8['activeChatId'],_0xab44c=document['getElementById'](_0xacb3b0(0x363));if(!_0xab44c[_0xacb3b0(0x4d8)][_0xacb3b0(0x1222)](_0xacb3b0(0xc09))){const _0x4317b4=document['querySelector'](_0xacb3b0(0xf73));_0xab44c['style'][_0xacb3b0(0xe8f)]=_0x4317b4['offsetHeight']+'px',_0xab44c[_0xacb3b0(0x20f)][_0xacb3b0(0x115d)]=_0xacb3b0(0x10c8),(!_0x2b35e7[_0x3abeef]||!_0x2b35e7[_0x3abeef]['isActive'])&&_0x10a268(_0x3abeef),_0x7077d1(_0x3abeef),setTimeout(async()=>{const _0x95de9b=_0xacb3b0;_0xab44c[_0x95de9b(0x4d8)]['add'](_0x95de9b(0xc09));const _0x3f70db={'role':_0x95de9b(0xe10),'content':_0x95de9b(0x92d),'timestamp':Date[_0x95de9b(0x64b)](),'isHidden':!![]};_0x19ddb8[_0x95de9b(0xb04)][_0x3abeef][_0x95de9b(0x1f0)][_0x95de9b(0x1c4)](_0x3f70db),await _0x512070[_0x95de9b(0xb04)][_0x95de9b(0xd4d)](_0x19ddb8[_0x95de9b(0xb04)][_0x3abeef]);},0xa);}else await _0x4855c0();}async function _0x4855c0(){const _0x3bcc06=_0x48bc6d;if(!_0x19ddb8['activeChatId'])return;const _0x4b3af8=_0x19ddb8[_0x3bcc06(0x859)],_0x3e3394=document['getElementById']('gomoku-overlay');_0x3e3394['classList'][_0x3bcc06(0x133d)]('visible'),setTimeout(()=>{const _0x18186d=_0x3bcc06;_0x3e3394[_0x18186d(0x20f)][_0x18186d(0x115d)]=_0x18186d(0x8e0);},0x12c);if(_0x2b35e7[_0x4b3af8]){_0x2b35e7[_0x4b3af8]['isActive']=![];const _0x5490d8={'role':'system','content':_0x3bcc06(0xc5f),'timestamp':Date[_0x3bcc06(0x64b)](),'isHidden':!![]};_0x19ddb8['chats'][_0x4b3af8]['history'][_0x3bcc06(0x1c4)](_0x5490d8),await _0x512070[_0x3bcc06(0xb04)][_0x3bcc06(0xd4d)](_0x19ddb8[_0x3bcc06(0xb04)][_0x4b3af8]);}}function _0x10a268(_0x4fe2d5){const _0x55a76e=_0x48bc6d,_0x3d24ae=document[_0x55a76e(0x9a3)]('gomoku-board'),_0x1d8929=document['getElementById'](_0x55a76e(0x363)),_0x30f9f1=document['getElementById'](_0x55a76e(0x769)),_0x4b4c03=_0x1d8929[_0x55a76e(0xa75)]-0x28,_0x5bdedf=_0x1d8929[_0x55a76e(0x1206)]-_0x30f9f1[_0x55a76e(0x1206)]-0x28,_0x5a1461=Math[_0x55a76e(0xd95)](Math[_0x55a76e(0xbf8)](_0x4b4c03,_0x5bdedf)),_0x5cf4c7=0xf,_0x11871f=Math[_0x55a76e(0xd95)](_0x5a1461/_0x5cf4c7),_0x13b689=_0x11871f*_0x5cf4c7;_0x3d24ae[_0x55a76e(0xeb0)]=_0x13b689,_0x3d24ae[_0x55a76e(0x397)]=_0x13b689,_0x2b35e7[_0x4fe2d5]={'isActive':!![],'board':Array(_0x5cf4c7)[_0x55a76e(0x655)](0x0)[_0x55a76e(0xb0a)](()=>Array(_0x5cf4c7)[_0x55a76e(0x655)](0x0)),'currentPlayer':0x1,'history':[],'isGameOver':![],'GRID_SIZE':_0x5cf4c7,'CELL_SIZE':_0x11871f};}function _0x7077d1(_0x5430af){const _0x34fc30=_0x48bc6d,_0x317826=_0x2b35e7[_0x5430af];if(!_0x317826)return;const _0x23a47c=document[_0x34fc30(0x9a3)](_0x34fc30(0x1128)),_0x4ba20e=_0x23a47c[_0x34fc30(0x1102)]('2d'),{GRID_SIZE:_0x3e5fbd,CELL_SIZE:_0x159af3}=_0x317826,_0x63eb6c=_0x159af3/0x2;_0x4ba20e[_0x34fc30(0x1ed)](0x0,0x0,_0x23a47c[_0x34fc30(0xeb0)],_0x23a47c[_0x34fc30(0x397)]),_0x4ba20e[_0x34fc30(0xc12)]=_0x34fc30(0x8f6),_0x4ba20e['fillRect'](0x0,0x0,_0x23a47c[_0x34fc30(0xeb0)],_0x23a47c['height']),_0x4ba20e['strokeStyle']=_0x34fc30(0xfb7),_0x4ba20e['lineWidth']=0x1;for(let _0x4125c9=0x0;_0x4125c9<_0x3e5fbd;_0x4125c9++){_0x4ba20e[_0x34fc30(0x47c)](),_0x4ba20e['moveTo'](_0x63eb6c,_0x63eb6c+_0x4125c9*_0x159af3),_0x4ba20e[_0x34fc30(0xccb)](_0x23a47c[_0x34fc30(0xeb0)]-_0x63eb6c,_0x63eb6c+_0x4125c9*_0x159af3),_0x4ba20e[_0x34fc30(0x848)](),_0x4ba20e[_0x34fc30(0x47c)](),_0x4ba20e['moveTo'](_0x63eb6c+_0x4125c9*_0x159af3,_0x63eb6c),_0x4ba20e[_0x34fc30(0xccb)](_0x63eb6c+_0x4125c9*_0x159af3,_0x23a47c[_0x34fc30(0x397)]-_0x63eb6c),_0x4ba20e[_0x34fc30(0x848)]();}for(let _0x21af54=0x0;_0x21af54<_0x3e5fbd;_0x21af54++){for(let _0x2c2452=0x0;_0x2c2452<_0x3e5fbd;_0x2c2452++){_0x317826[_0x34fc30(0x204)][_0x21af54][_0x2c2452]!==0x0&&_0x4335c6(_0x4ba20e,_0x2c2452,_0x21af54,_0x317826[_0x34fc30(0x204)][_0x21af54][_0x2c2452],_0x317826);}}}function _0x4335c6(_0x37985a,_0x53012a,_0x14f74e,_0x1a3c03,_0x1e3c5e){const _0x1d17af=_0x48bc6d,{CELL_SIZE:_0x32cd8c}=_0x1e3c5e,_0x1e3afe=_0x32cd8c/0x2,_0x57c67a=_0x32cd8c/0x2-0x2;_0x37985a[_0x1d17af(0x47c)](),_0x37985a[_0x1d17af(0xa14)](_0x1e3afe+_0x53012a*_0x32cd8c,_0x1e3afe+_0x14f74e*_0x32cd8c,_0x57c67a,0x0,0x2*Math['PI']),_0x1a3c03===0x1?_0x37985a['fillStyle']='black':_0x37985a['fillStyle']=_0x1d17af(0x4af),_0x37985a['fill']();}function _0x3c737b(_0x5134d5){const _0x212dcc=_0x48bc6d,_0x2b8af6=_0x19ddb8[_0x212dcc(0x859)],_0x183b92=_0x2b35e7[_0x2b8af6];if(!_0x183b92||_0x183b92[_0x212dcc(0x29c)]||_0x183b92['currentPlayer']!==0x1)return;const _0x37f910=document[_0x212dcc(0x9a3)](_0x212dcc(0x1128)),_0x1c8dbe=_0x37f910[_0x212dcc(0x1102)]('2d'),_0x4c54b5=_0x37f910[_0x212dcc(0x31d)](),_0x20cef2=_0x5134d5[_0x212dcc(0x11e8)]-_0x4c54b5['left'],_0x58c2d6=_0x5134d5['clientY']-_0x4c54b5[_0x212dcc(0xe8f)],_0x1bdaf4=Math['round']((_0x20cef2-_0x183b92[_0x212dcc(0x600)]/0x2)/_0x183b92[_0x212dcc(0x600)]),_0x3d39a4=Math[_0x212dcc(0xb9d)]((_0x58c2d6-_0x183b92[_0x212dcc(0x600)]/0x2)/_0x183b92['CELL_SIZE']);_0x7077d1(_0x2b8af6);if(_0x1bdaf4>=0x0&&_0x1bdaf4<_0x183b92[_0x212dcc(0x75a)]&&_0x3d39a4>=0x0&&_0x3d39a4<_0x183b92[_0x212dcc(0x75a)]&&_0x183b92['board'][_0x3d39a4][_0x1bdaf4]===0x0){const _0x276e9d=_0x183b92[_0x212dcc(0x600)]/0x2-0x2;_0x1c8dbe[_0x212dcc(0x47c)](),_0x1c8dbe[_0x212dcc(0xa14)](_0x183b92[_0x212dcc(0x600)]/0x2+_0x1bdaf4*_0x183b92['CELL_SIZE'],_0x183b92[_0x212dcc(0x600)]/0x2+_0x3d39a4*_0x183b92['CELL_SIZE'],_0x276e9d,0x0,0x2*Math['PI']),_0x1c8dbe[_0x212dcc(0xc12)]='rgba(0,\x200,\x200,\x200.4)',_0x1c8dbe[_0x212dcc(0x655)]();}}function _0x1ac456(_0x246f4c){const _0x2450f6=_0x48bc6d,_0x589db3=_0x19ddb8[_0x2450f6(0x859)],_0x2dcef0=_0x2b35e7[_0x589db3];if(!_0x2dcef0||_0x2dcef0[_0x2450f6(0x29c)]||_0x2dcef0[_0x2450f6(0x1260)]!==0x1)return;const _0xbd7e66=document[_0x2450f6(0x9a3)](_0x2450f6(0x1128)),_0x1e511f=_0xbd7e66[_0x2450f6(0x31d)](),_0x3c0ff0=_0x246f4c[_0x2450f6(0x11e8)]-_0x1e511f[_0x2450f6(0xb90)],_0x745d3=_0x246f4c['clientY']-_0x1e511f['top'],_0x2571e6=Math[_0x2450f6(0xb9d)]((_0x3c0ff0-_0x2dcef0[_0x2450f6(0x600)]/0x2)/_0x2dcef0[_0x2450f6(0x600)]),_0x58a803=Math[_0x2450f6(0xb9d)]((_0x745d3-_0x2dcef0[_0x2450f6(0x600)]/0x2)/_0x2dcef0[_0x2450f6(0x600)]);_0x2571e6>=0x0&&_0x2571e6<_0x2dcef0[_0x2450f6(0x75a)]&&_0x58a803>=0x0&&_0x58a803<_0x2dcef0[_0x2450f6(0x75a)]&&_0x2dcef0[_0x2450f6(0x204)][_0x58a803][_0x2571e6]===0x0&&(_0x2dcef0[_0x2450f6(0x204)][_0x58a803][_0x2571e6]=0x1,_0x2dcef0[_0x2450f6(0x1f0)][_0x2450f6(0x1c4)]({'x':_0x2571e6,'y':_0x58a803,'player':0x1}),_0x7077d1(_0x589db3),_0x4ec515(_0x2571e6,_0x58a803,0x1,_0x2dcef0)?(_0x2dcef0[_0x2450f6(0x29c)]=!![],setTimeout(()=>alert('恭喜你，你赢了！'),0x64),_0x457b69(_0x2450f6(0x20d))):_0x2dcef0[_0x2450f6(0x1260)]=0x2);}function _0x128e77(_0x51f25c,_0x4e13b6=![]){const _0x4c842d=_0x48bc6d,_0x45161d=_0x19ddb8[_0x4c842d(0x859)],_0xd736df=_0x2b35e7[_0x45161d];if(!_0xd736df||_0xd736df['isGameOver'])return;if(!_0x4e13b6&&_0xd736df[_0x4c842d(0x1260)]!==0x2)return;const {x:_0x3c3aa4,y:_0x267036}=_0x51f25c;_0x3c3aa4>=0x0&&_0x3c3aa4<_0xd736df[_0x4c842d(0x75a)]&&_0x267036>=0x0&&_0x267036<_0xd736df[_0x4c842d(0x75a)]&&_0xd736df[_0x4c842d(0x204)][_0x267036][_0x3c3aa4]===0x0?(_0xd736df[_0x4c842d(0x204)][_0x267036][_0x3c3aa4]=0x2,_0xd736df[_0x4c842d(0x1f0)][_0x4c842d(0x1c4)]({'x':_0x3c3aa4,'y':_0x267036,'player':0x2}),_0x7077d1(_0x45161d),_0x4ec515(_0x3c3aa4,_0x267036,0x2,_0xd736df)?(_0xd736df[_0x4c842d(0x29c)]=!![],setTimeout(()=>alert(_0x4c842d(0x1182)),0x64),_0x457b69('ai')):_0xd736df[_0x4c842d(0x1260)]=0x1):(console[_0x4c842d(0x651)](_0x4c842d(0x426),_0x51f25c),_0xd736df[_0x4c842d(0x1260)]=0x1);}function _0x4ec515(_0xbb318a,_0x135be5,_0x1617fe,_0x1feca8){const {board:_0x55bdfe,GRID_SIZE:_0x348f6e}=_0x1feca8,_0x497a81=[[0x1,0x0],[0x0,0x1],[0x1,0x1],[0x1,-0x1]];for(const [_0x234111,_0x36c0ca]of _0x497a81){let _0x1f8d97=0x1;for(let _0x237fb7=0x1;_0x237fb7<0x5;_0x237fb7++){const _0x2954c7=_0xbb318a+_0x237fb7*_0x234111,_0x4c20cc=_0x135be5+_0x237fb7*_0x36c0ca;if(_0x2954c7>=0x0&&_0x2954c7<_0x348f6e&&_0x4c20cc>=0x0&&_0x4c20cc<_0x348f6e&&_0x55bdfe[_0x4c20cc][_0x2954c7]===_0x1617fe)_0x1f8d97++;else break;}for(let _0x2279e0=0x1;_0x2279e0<0x5;_0x2279e0++){const _0x420b07=_0xbb318a-_0x2279e0*_0x234111,_0x3788da=_0x135be5-_0x2279e0*_0x36c0ca;if(_0x420b07>=0x0&&_0x420b07<_0x348f6e&&_0x3788da>=0x0&&_0x3788da<_0x348f6e&&_0x55bdfe[_0x3788da][_0x420b07]===_0x1617fe)_0x1f8d97++;else break;}if(_0x1f8d97>=0x5)return!![];}return![];}function _0x4b122e(_0x5e1355){const _0xce670b=_0x48bc6d;if(!_0x5e1355||!_0x5e1355['isActive'])return'';let _0x37f833=_0xce670b(0xada);_0x37f833+=_0x5e1355['board']['map'](_0x143191=>_0x143191[_0xce670b(0x3b9)]('\x20'))[_0xce670b(0x3b9)]('\x0a');let _0x216294=_0xce670b(0x149d);return _0x216294+=_0x5e1355[_0xce670b(0x1f0)][_0xce670b(0xb0a)](_0x13b365=>'玩家'+_0x13b365['player']+_0xce670b(0x334)+_0x13b365['x']+','+_0x13b365['y']+')')[_0xce670b(0x3b9)](_0xce670b(0x4f6)),_0xce670b(0x132c)+_0x37f833+_0xce670b(0xc63)+_0x216294+_0xce670b(0x12c8);}async function _0x457b69(_0xe4c16c){const _0x566753=_0x48bc6d,_0x129446=_0x19ddb8[_0x566753(0x859)],_0x500cc8=_0x19ddb8[_0x566753(0xb04)][_0x129446];if(!_0x500cc8)return;const _0x1b9567=_0x500cc8['isGroup']?_0x500cc8['settings'][_0x566753(0x1555)]||'我':'我',_0x2ed8be=_0x500cc8[_0x566753(0x136b)]?_0x566753(0x1506):_0x500cc8[_0x566753(0x1561)],_0x1c693e=_0xe4c16c===_0x566753(0x20d)?_0x1b9567:_0x2ed8be,_0x469c32=_0xe4c16c===_0x566753(0x20d)?_0x566753(0x1021):'你赢了',_0x34abe4=_0x566753(0xbde)+_0x1c693e+_0x566753(0x14c7)+_0x469c32+'。]',_0x2a7899={'role':_0x566753(0xe10),'content':_0x34abe4,'timestamp':Date[_0x566753(0x64b)](),'isHidden':!![]};_0x500cc8['history'][_0x566753(0x1c4)](_0x2a7899),await _0x512070[_0x566753(0xb04)]['put'](_0x500cc8),console[_0x566753(0xe4d)](_0x566753(0xd2a)+_0xe4c16c);}let _0x35e770=![];async function _0x5cb09b(){const _0x3c3764=_0x48bc6d,_0x3b904b=document[_0x3c3764(0x9a3)](_0x3c3764(0xc26)),_0xe80060=document['getElementById'](_0x3c3764(0xbb7)),_0x53ec70=document[_0x3c3764(0x9a3)](_0x3c3764(0x117e));_0x3b904b[_0x3c3764(0xeb2)]='',_0xe80060[_0x3c3764(0xeb2)]='';const [_0x359c7e,_0x322137]=await Promise[_0x3c3764(0xbf1)]([_0x512070[_0x3c3764(0x376)][_0x3c3764(0x591)](),_0x512070[_0x3c3764(0x1312)][_0x3c3764(0x1404)](_0x3c3764(0x1561))['toArray']()]);_0x53ec70[_0x3c3764(0x4d8)][_0x3c3764(0xc02)]('management-mode',_0x35e770);const _0x35e682=document[_0x3c3764(0xe94)](_0x3c3764(0xd38));_0x35e682[_0x3c3764(0x1487)]=_0x3c3764(0xb89),_0x35e682[_0x3c3764(0x766)]='全部',_0x35e682[_0x3c3764(0xd8d)][_0x3c3764(0x922)]=_0x3c3764(0xbf1);if(activeShoppingCategoryId===_0x3c3764(0xbf1))_0x35e682[_0x3c3764(0x4d8)][_0x3c3764(0xe05)](_0x3c3764(0xe9f));_0xe80060[_0x3c3764(0x983)](_0x35e682),_0x322137[_0x3c3764(0x15c1)](_0x4efe02=>{const _0x512b20=_0x3c3764,_0x590c76=document[_0x512b20(0xe94)](_0x512b20(0xd38));_0x590c76[_0x512b20(0x1487)]=_0x512b20(0xb89),_0x590c76[_0x512b20(0x766)]=_0x4efe02[_0x512b20(0x1561)],_0x590c76[_0x512b20(0xd8d)][_0x512b20(0x922)]=_0x4efe02['id'];if(activeShoppingCategoryId===_0x4efe02['id'])_0x590c76[_0x512b20(0x4d8)][_0x512b20(0xe05)](_0x512b20(0xe9f));_0xe80060[_0x512b20(0x983)](_0x590c76);});let _0x4807a2;activeShoppingCategoryId===_0x3c3764(0xbf1)?_0x4807a2=_0x359c7e:_0x4807a2=_0x359c7e['filter'](_0x2ab103=>_0x2ab103[_0x3c3764(0x922)]===activeShoppingCategoryId);if(_0x4807a2[_0x3c3764(0x106b)]===0x0){const _0x34d038=activeShoppingCategoryId===_0x3c3764(0xbf1)?_0x3c3764(0x7a4):_0x3c3764(0x1336);_0x3b904b['innerHTML']=_0x3c3764(0x10a7)+_0x34d038+'</p>';return;}_0x4807a2[_0x3c3764(0x15c1)](_0x335df5=>{const _0xfed0f2=_0x3c3764,_0x586f13=document[_0xfed0f2(0xe94)]('div');_0x586f13[_0xfed0f2(0x1487)]=_0xfed0f2(0x700),_0x586f13[_0xfed0f2(0xd8d)]['id']=_0x335df5['id'];const _0x3a251a=_0xfed0f2(0x968);_0x586f13[_0xfed0f2(0xeb2)]=_0xfed0f2(0xc72)+_0x3a251a+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x335df5[_0xfed0f2(0xbfe)]+_0xfed0f2(0x1246)+_0x335df5[_0xfed0f2(0x1561)]+_0xfed0f2(0xac7)+_0x335df5[_0xfed0f2(0x87b)][_0xfed0f2(0x1322)](0x2)+_0xfed0f2(0x1523),_0x3b904b[_0xfed0f2(0x983)](_0x586f13);});}function _0x4b62eb(_0x228c5f){activeShoppingCategoryId=_0x228c5f,_0x5cb09b(),_0x379a76();}function _0x379a76(){const _0x196ef3=_0x48bc6d,_0x378a11=document[_0x196ef3(0x9a3)](_0x196ef3(0xee9));if(!_0x378a11)return;const _0x5f8be4=_0x35e770&&activeShoppingCategoryId!=='all';_0x378a11['style'][_0x196ef3(0x115d)]=_0x5f8be4?_0x196ef3(0x79c):'none';}async function _0x6fd5a2(){const _0x586f6a=_0x48bc6d;if(activeShoppingCategoryId===_0x586f6a(0xbf1))return;const _0x53da07=activeShoppingCategoryId,_0x4cf929=await _0x512070[_0x586f6a(0x1312)][_0x586f6a(0x14ee)](_0x53da07);if(!_0x4cf929){alert('错误：找不到要删除的分类。');return;}const _0x4c7223='确定要永久删除分类\x20“'+_0x4cf929[_0x586f6a(0x1561)]+_0x586f6a(0x4f2),_0x2c6f22=await _0x2c9509(_0x586f6a(0x66e),_0x4c7223,{'confirmButtonClass':'btn-danger','confirmText':_0x586f6a(0xd05)});_0x2c6f22&&(await _0x24d40e(_0x53da07),activeShoppingCategoryId=_0x586f6a(0xbf1),await _0x5cb09b(),_0x379a76(),await _0x403a62('成功',_0x586f6a(0x117d)+_0x4cf929['name']+_0x586f6a(0xfa4)));}async function _0x66e819(){const _0x1effb4=_0x48bc6d;activeShoppingCategoryId=_0x1effb4(0xbf1),await _0x5cb09b(),_0x35df44('shopping-screen'),_0x379a76();}async function _0x5cb09b(){const _0x530c54=_0x48bc6d,_0x4be724=document[_0x530c54(0x9a3)](_0x530c54(0xc26)),_0x14ac6b=document['getElementById'](_0x530c54(0xbb7)),_0x1dc65e=document[_0x530c54(0x9a3)](_0x530c54(0x117e));_0x4be724['innerHTML']='',_0x14ac6b[_0x530c54(0xeb2)]='';const [_0x248410,_0x559c78]=await Promise['all']([_0x512070[_0x530c54(0x376)][_0x530c54(0x591)](),_0x512070['shoppingCategories'][_0x530c54(0x1404)]('name')[_0x530c54(0x591)]()]);_0x1dc65e[_0x530c54(0x4d8)]['toggle'](_0x530c54(0xb3e),_0x35e770);const _0x47049f=document[_0x530c54(0xe94)]('button');_0x47049f[_0x530c54(0x1487)]=_0x530c54(0xb89),_0x47049f[_0x530c54(0x766)]='全部',_0x47049f[_0x530c54(0xd8d)][_0x530c54(0x922)]='all';if(activeShoppingCategoryId===_0x530c54(0xbf1))_0x47049f[_0x530c54(0x4d8)][_0x530c54(0xe05)](_0x530c54(0xe9f));_0x14ac6b['appendChild'](_0x47049f),_0x559c78[_0x530c54(0x15c1)](_0x22639c=>{const _0x5c7c8d=_0x530c54,_0x969606=document[_0x5c7c8d(0xe94)]('button');_0x969606[_0x5c7c8d(0x1487)]=_0x5c7c8d(0xb89),_0x969606[_0x5c7c8d(0x766)]=_0x22639c[_0x5c7c8d(0x1561)],_0x969606[_0x5c7c8d(0xd8d)][_0x5c7c8d(0x922)]=_0x22639c['id'];if(activeShoppingCategoryId===_0x22639c['id'])_0x969606['classList']['add'](_0x5c7c8d(0xe9f));_0x14ac6b[_0x5c7c8d(0x983)](_0x969606);});let _0x1e94c2;activeShoppingCategoryId==='all'?_0x1e94c2=_0x248410:_0x1e94c2=_0x248410[_0x530c54(0x1195)](_0x1cfa30=>_0x1cfa30[_0x530c54(0x922)]===activeShoppingCategoryId);if(_0x1e94c2[_0x530c54(0x106b)]===0x0){const _0x180291=activeShoppingCategoryId===_0x530c54(0xbf1)?_0x530c54(0x7a4):_0x530c54(0x1336);_0x4be724['innerHTML']=_0x530c54(0x10a7)+_0x180291+_0x530c54(0x4cf);return;}_0x1e94c2[_0x530c54(0x15c1)](_0x51ae37=>{const _0x3e69b5=_0x530c54,_0xccd5e6=document[_0x3e69b5(0xe94)](_0x3e69b5(0x8ca));_0xccd5e6['className']=_0x3e69b5(0x700),_0xccd5e6[_0x3e69b5(0xd8d)]['id']=_0x51ae37['id'];const _0x3e7914=_0x35e770?_0x3e69b5(0x12f3):'';_0xccd5e6[_0x3e69b5(0xeb2)]=_0x3e69b5(0x5e0)+_0x3e7914+_0x3e69b5(0x13ff)+_0x51ae37[_0x3e69b5(0xbfe)]+_0x3e69b5(0x8ed)+_0x51ae37[_0x3e69b5(0x1561)]+_0x3e69b5(0xb64)+_0x51ae37[_0x3e69b5(0x87b)][_0x3e69b5(0x1322)](0x2)+_0x3e69b5(0x1170),_0x4be724[_0x3e69b5(0x983)](_0xccd5e6);});}async function _0x48b0c5(_0x1885d3,_0x135d18=0x1,_0x407911=null){const _0x4040c9=_0x48bc6d,_0x226c6b=_0x407911?_0x5cf781[_0x4040c9(0xd62)](_0x4fb818=>_0x4fb818[_0x4040c9(0x12d8)]===_0x1885d3&&_0x4fb818[_0x4040c9(0x148b)]?.[_0x4040c9(0x1561)]===_0x407911['name']):_0x5cf781['find'](_0x4de05e=>_0x4de05e[_0x4040c9(0x12d8)]===_0x1885d3&&!_0x4de05e['variation']);if(_0x226c6b)_0x226c6b[_0x4040c9(0x1485)]+=_0x135d18;else{const _0x4a2463=await _0x512070[_0x4040c9(0x376)]['get'](_0x1885d3);_0x4a2463&&_0x5cf781['push']({'productId':_0x4a2463['id'],'quantity':_0x135d18,'variation':_0x407911});}_0x4a14f8();}function _0xa76a3(_0x33cd56,_0x543034){const _0x3f3903=_0x48bc6d,_0x5cb432=_0x5cf781[_0x3f3903(0x455)](_0x2d377c=>_0x2d377c['productId']===_0x33cd56);_0x5cb432>-0x1&&(_0x5cf781[_0x5cb432][_0x3f3903(0x1485)]+=_0x543034,_0x5cf781[_0x5cb432][_0x3f3903(0x1485)]<=0x0&&_0x5cf781[_0x3f3903(0x15b0)](_0x5cb432,0x1),_0x4a14f8(),_0x1bcddd());}function _0x4a14f8(){const _0x380b97=_0x48bc6d,_0x4bf0a5=_0x5cf781[_0x380b97(0x68f)]((_0x3a2c17,_0x4b4a87)=>_0x3a2c17+_0x4b4a87[_0x380b97(0x1485)],0x0);document[_0x380b97(0x9a3)](_0x380b97(0xce5))[_0x380b97(0x766)]=_0x4bf0a5,document[_0x380b97(0x9a3)](_0x380b97(0xeb4))[_0x380b97(0x766)]='购物车('+_0x4bf0a5+')',document[_0x380b97(0x9a3)]('checkout-btn')[_0x380b97(0x766)]=_0x380b97(0x13d8)+_0x4bf0a5+')';}function _0x2d319b(){const _0x48dbfe=_0x48bc6d;_0x1bcddd(),_0x35df44(_0x48dbfe(0x9f3));}async function _0x1bcddd(){const _0x110830=_0x48bc6d,_0x1ead12=document['getElementById'](_0x110830(0x10f6));_0x1ead12['innerHTML']='';let _0x22a2a4=0x0;if(_0x5cf781[_0x110830(0x106b)]===0x0)_0x1ead12[_0x110830(0xeb2)]=_0x110830(0xfd9);else{const _0x32adaf=_0x5cf781[_0x110830(0xb0a)](_0x29a0b7=>_0x29a0b7[_0x110830(0x12d8)]),_0x5a92bc=await _0x512070[_0x110830(0x376)][_0x110830(0x1201)]('id')[_0x110830(0xd26)](_0x32adaf)[_0x110830(0x591)](),_0x12eed8=new Map(_0x5a92bc[_0x110830(0xb0a)](_0x599554=>[_0x599554['id'],_0x599554]));_0x5cf781[_0x110830(0x15c1)](_0x7bdc46=>{const _0x4d2e9=_0x110830,_0x4e6ad7=_0x12eed8['get'](_0x7bdc46['productId']);if(_0x4e6ad7){const _0x1e9d42=document[_0x4d2e9(0xe94)](_0x4d2e9(0x8ca));_0x1e9d42[_0x4d2e9(0x1487)]='cart-item';const _0x2f2450=_0x7bdc46[_0x4d2e9(0x148b)]?'<div\x20class=\x22cart-item-variation\x22\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin-top:\x204px;\x22>款式:\x20'+_0x7bdc46[_0x4d2e9(0x148b)][_0x4d2e9(0x1561)]+_0x4d2e9(0x826):'';_0x1e9d42['innerHTML']=_0x4d2e9(0xee5)+_0x4e6ad7['id']+_0x4d2e9(0x14d6)+(_0x7bdc46[_0x4d2e9(0x148b)]?.['imageUrl']||_0x4e6ad7[_0x4d2e9(0xbfe)])+_0x4d2e9(0xe5d)+_0x4e6ad7['name']+_0x4d2e9(0x931)+_0x2f2450+_0x4d2e9(0x60f)+(_0x7bdc46[_0x4d2e9(0x148b)]?.['price']||_0x4e6ad7[_0x4d2e9(0x87b)])['toFixed'](0x2)+_0x4d2e9(0x10e9)+_0x4e6ad7['id']+_0x4d2e9(0x115a)+_0x7bdc46[_0x4d2e9(0x1485)]+_0x4d2e9(0x125e)+_0x4e6ad7['id']+_0x4d2e9(0x785),_0x1ead12['appendChild'](_0x1e9d42);}});}_0x33b13b();}async function _0x33b13b(){const _0x21e386=_0x48bc6d;let _0x3f05fe=0x0;const _0x1e1045=document[_0x21e386(0x131c)](_0x21e386(0xeba)),_0x385b33=Array[_0x21e386(0x1311)](_0x1e1045)['map'](_0x55a79f=>parseInt(_0x55a79f[_0x21e386(0xd8d)]['id']));if(_0x385b33[_0x21e386(0x106b)]>0x0){const _0x35cc6a=await _0x512070[_0x21e386(0x376)][_0x21e386(0x1201)]('id')[_0x21e386(0xd26)](_0x385b33)['toArray'](),_0x445ddc=new Map(_0x35cc6a[_0x21e386(0xb0a)](_0x2cd44e=>[_0x2cd44e['id'],_0x2cd44e]));_0x5cf781[_0x21e386(0x15c1)](_0x2fa335=>{const _0x2827ee=_0x21e386;if(_0x385b33['includes'](_0x2fa335[_0x2827ee(0x12d8)])){const _0x38ff01=_0x445ddc['get'](_0x2fa335[_0x2827ee(0x12d8)]);if(_0x38ff01){const _0x8e42db=_0x2fa335['variation']?_0x2fa335[_0x2827ee(0x148b)]['price']:_0x38ff01[_0x2827ee(0x87b)];_0x3f05fe+=_0x8e42db*_0x2fa335['quantity'];}}});}document[_0x21e386(0x9a3)](_0x21e386(0x1526))[_0x21e386(0x766)]=_0x21e386(0x122e)+_0x3f05fe['toFixed'](0x2);}async function _0x4eed20(){const _0x421267=_0x48bc6d,_0x420cb1=_0x19ddb8['chats'][_0x19ddb8[_0x421267(0x859)]];if(!_0x420cb1||!_0x420cb1[_0x421267(0x136b)])return;const _0x2ffdbe=document[_0x421267(0x9a3)](_0x421267(0xc27)),_0x24252c=document[_0x421267(0x9a3)](_0x421267(0x2c5));_0x24252c[_0x421267(0xeb2)]='';const _0x3a915e=_0x420cb1[_0x421267(0x450)][_0x421267(0x1555)]||'我',_0x3a3962=_0x420cb1['members'][_0x421267(0x1195)](_0x4008dc=>_0x4008dc[_0x421267(0xaf0)]!==_0x3a915e);_0x3a3962[_0x421267(0x15c1)](_0x3103f3=>{const _0x1eb9f4=_0x421267,_0x4e12f5=document[_0x1eb9f4(0xe94)]('div');_0x4e12f5[_0x1eb9f4(0x1487)]=_0x1eb9f4(0x5a1),_0x4e12f5[_0x1eb9f4(0xd8d)]['recipientName']=_0x3103f3[_0x1eb9f4(0x339)],_0x4e12f5[_0x1eb9f4(0xeb2)]=_0x1eb9f4(0x843)+(_0x3103f3[_0x1eb9f4(0xf3f)]||_0x451ae9)+_0x1eb9f4(0x2b6)+_0x3103f3['groupNickname']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x24252c[_0x1eb9f4(0x983)](_0x4e12f5);}),document['getElementById'](_0x421267(0x13f8))['checked']=![],_0x2ffdbe[_0x421267(0x4d8)][_0x421267(0xe05)]('visible');}async function _0x4db19e(){const _0x515b50=_0x48bc6d,_0x53e01f=_0x19ddb8[_0x515b50(0xb04)][_0x19ddb8[_0x515b50(0x859)]],_0x68b97d=_0x5cf781['filter'](_0x539221=>document[_0x515b50(0xc86)](_0x515b50(0x234)+_0x539221[_0x515b50(0x12d8)]+_0x515b50(0xf0a)));if(_0x68b97d['length']===0x0){alert(_0x515b50(0xe40));return;}if(_0x53e01f['isGroup'])_0x4eed20();else{const _0xcb86fb=await _0x2c9509('确认送出礼物',_0x515b50(0x1199),{'confirmText':_0x515b50(0x323)});_0xcb86fb&&await _0x2aebb5(_0x68b97d);}}async function _0x2aebb5(_0x4c74ec,_0x234123=null){const _0x418c7e=_0x48bc6d;if(!_0x19ddb8[_0x418c7e(0x859)])return;const _0xbb327a=_0x19ddb8[_0x418c7e(0xb04)][_0x19ddb8[_0x418c7e(0x859)]],_0x135a3b=_0x4c74ec['map'](_0x4bcce8=>_0x4bcce8[_0x418c7e(0x12d8)]),_0x277bbd=await _0x512070['shoppingProducts'][_0x418c7e(0x1201)]('id')[_0x418c7e(0xd26)](_0x135a3b)[_0x418c7e(0x591)](),_0x35bcdd=new Map(_0x277bbd[_0x418c7e(0xb0a)](_0x255e9a=>[_0x255e9a['id'],_0x255e9a])),_0x12d686=_0x4c74ec[_0x418c7e(0xb0a)](_0x364504=>{const _0x3c73e9=_0x418c7e,_0x4929ec=_0x35bcdd[_0x3c73e9(0x14ee)](_0x364504[_0x3c73e9(0x12d8)]);return _0x364504[_0x3c73e9(0x148b)]?{'name':_0x4929ec[_0x3c73e9(0x1561)]+_0x3c73e9(0x1452)+_0x364504[_0x3c73e9(0x148b)]['name'],'price':_0x364504[_0x3c73e9(0x148b)][_0x3c73e9(0x87b)],'imageUrl':_0x364504['variation'][_0x3c73e9(0xbfe)]||_0x4929ec[_0x3c73e9(0xbfe)],'quantity':_0x364504[_0x3c73e9(0x1485)]}:{'name':_0x4929ec['name'],'price':_0x4929ec[_0x3c73e9(0x87b)],'imageUrl':_0x4929ec[_0x3c73e9(0xbfe)],'quantity':_0x364504['quantity']};}),_0x49b934={'role':_0x418c7e(0x20d),'type':_0x418c7e(0xf69),'timestamp':Date[_0x418c7e(0x64b)](),'items':_0x12d686,'total':_0x12d686[_0x418c7e(0x68f)]((_0x1af593,_0x18ea1e)=>_0x1af593+_0x18ea1e[_0x418c7e(0x87b)]*_0x18ea1e[_0x418c7e(0x1485)],0x0),'recipients':_0x234123};_0xbb327a[_0x418c7e(0x1f0)]['push'](_0x49b934);if(_0x234123&&_0x234123[_0x418c7e(0x106b)]>0x0){const _0x4d8b5c=_0x234123[_0x418c7e(0xb0a)](_0x32f1bb=>_0x1e2056(_0xbb327a,_0x32f1bb))[_0x418c7e(0x3b9)]('、'),_0xb75f71={'role':_0x418c7e(0xe10),'content':'[系统提示：用户\x20('+(_0xbb327a['settings'][_0x418c7e(0x1555)]||'我')+_0x418c7e(0xb76)+_0x4d8b5c+_0x418c7e(0x77e),'timestamp':Date[_0x418c7e(0x64b)]()+0x1,'isHidden':!![]};_0xbb327a['history'][_0x418c7e(0x1c4)](_0xb75f71);}await _0x512070[_0x418c7e(0xb04)][_0x418c7e(0xd4d)](_0xbb327a),_0x1ef393(_0x49b934,_0xbb327a),_0xec8072(),_0x5cf781=_0x5cf781[_0x418c7e(0x1195)](_0x4b206=>!_0x4c74ec['some'](_0x3d6c3e=>_0x3d6c3e['productId']===_0x4b206[_0x418c7e(0x12d8)])),_0x4a14f8(),_0x35df44('chat-interface-screen'),await _0x403a62('成功',_0x418c7e(0x792));}function _0x5b607e(_0x47606f){const _0xac2417=_0x48bc6d,_0x330f1e=_0x19ddb8[_0xac2417(0xb04)][_0x19ddb8[_0xac2417(0x859)]],_0x312750=_0x330f1e[_0xac2417(0x1f0)][_0xac2417(0xd62)](_0x297be1=>_0x297be1[_0xac2417(0xd73)]===_0x47606f);if(!_0x312750||_0x312750['type']!==_0xac2417(0xf69))return;const _0x55afe2=document[_0xac2417(0x9a3)](_0xac2417(0x873));let _0x450d11='';_0x312750[_0xac2417(0x1489)][_0xac2417(0x15c1)](_0x5a4f41=>{const _0x1c1b0e=_0xac2417;_0x450d11+=_0x1c1b0e(0xbef)+_0x5a4f41[_0x1c1b0e(0x1561)]+_0x1c1b0e(0x29d)+_0x5a4f41['quantity']+_0x1c1b0e(0x1214)+_0x5a4f41[_0x1c1b0e(0x87b)][_0x1c1b0e(0x1322)](0x2)+_0x1c1b0e(0x70c)+(_0x5a4f41[_0x1c1b0e(0x87b)]*_0x5a4f41[_0x1c1b0e(0x1485)])[_0x1c1b0e(0x1322)](0x2)+_0x1c1b0e(0x11ad);}),_0x55afe2[_0xac2417(0xeb2)]=_0xac2417(0xc0f)+new Date(_0x312750[_0xac2417(0xd73)])['toLocaleString']()+_0xac2417(0xae8)+_0x450d11+'</tbody></table><div\x20class=\x22receipt-total\x22>总计:\x20¥'+_0x312750[_0xac2417(0x9a0)][_0xac2417(0x1322)](0x2)+_0xac2417(0x109e),document[_0xac2417(0x9a3)]('gift-receipt-modal')[_0xac2417(0x4d8)][_0xac2417(0xe05)]('visible');}async function _0x53cd36(_0x491a7c=null){const _0x27dc1b=_0x48bc6d;_0x32068e=_0x491a7c;const _0x2d7fdc=document[_0x27dc1b(0x9a3)](_0x27dc1b(0x8ec)),_0x36cdfe=document[_0x27dc1b(0x9a3)](_0x27dc1b(0x116e)),_0x4c16f3=document[_0x27dc1b(0x9a3)]('product-name-input'),_0xebff95=document[_0x27dc1b(0x9a3)](_0x27dc1b(0x466)),_0x423e73=document['getElementById'](_0x27dc1b(0x970)),_0x55cf77=document['getElementById'](_0x27dc1b(0x28c)),_0x206fd1=document[_0x27dc1b(0x9a3)]('product-category-select'),_0x1d3500=document[_0x27dc1b(0x9a3)]('product-variations-container');_0x1d3500[_0x27dc1b(0xeb2)]='',_0x206fd1['innerHTML']=_0x27dc1b(0xea0);const _0x132f11=await _0x512070[_0x27dc1b(0x1312)]['toArray']();_0x132f11[_0x27dc1b(0x15c1)](_0x39c82a=>{const _0x7377d2=_0x27dc1b,_0x18d639=document[_0x7377d2(0xe94)](_0x7377d2(0x43a));_0x18d639['value']=_0x39c82a['id'],_0x18d639[_0x7377d2(0x766)]=_0x39c82a[_0x7377d2(0x1561)],_0x206fd1['appendChild'](_0x18d639);});if(_0x491a7c){_0x36cdfe[_0x27dc1b(0x766)]='编辑商品';const _0x5b090f=await _0x512070['shoppingProducts'][_0x27dc1b(0x14ee)](_0x491a7c);_0x4c16f3[_0x27dc1b(0x7b2)]=_0x5b090f[_0x27dc1b(0x1561)],_0xebff95[_0x27dc1b(0x7b2)]=_0x5b090f[_0x27dc1b(0x87b)],_0x423e73[_0x27dc1b(0x7b2)]=_0x5b090f[_0x27dc1b(0x3ef)]||'',_0x55cf77[_0x27dc1b(0x10d4)]=_0x5b090f['imageUrl'],_0x206fd1[_0x27dc1b(0x7b2)]=_0x5b090f[_0x27dc1b(0x922)]||'',_0x5b090f[_0x27dc1b(0x138d)]&&_0x5b090f[_0x27dc1b(0x138d)][_0x27dc1b(0x106b)]>0x0&&_0x5b090f['variations']['forEach'](_0xd540aa=>_0x5395a3(_0xd540aa));}else _0x36cdfe[_0x27dc1b(0x766)]=_0x27dc1b(0x158c),_0x4c16f3[_0x27dc1b(0x7b2)]='',_0xebff95['value']='',_0x423e73[_0x27dc1b(0x7b2)]='',_0x55cf77['src']='https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756206115802_qdqqd_0c99bh.jpeg',_0x206fd1[_0x27dc1b(0x7b2)]='';_0x2d7fdc['classList'][_0x27dc1b(0xe05)](_0x27dc1b(0xc09));}async function _0x27944f(){const _0x297e6f=_0x48bc6d,_0x129e36=document[_0x297e6f(0x9a3)](_0x297e6f(0x374))[_0x297e6f(0x7b2)][_0x297e6f(0x13f9)](),_0x41866f=parseFloat(document[_0x297e6f(0x9a3)](_0x297e6f(0x466))['value']),_0x22500b=document['getElementById'](_0x297e6f(0x970))[_0x297e6f(0x7b2)][_0x297e6f(0x13f9)](),_0x4a1d84=document['getElementById'](_0x297e6f(0x28c))[_0x297e6f(0x10d4)],_0x594a88=parseInt(document[_0x297e6f(0x9a3)](_0x297e6f(0xf26))[_0x297e6f(0x7b2)])||null;if(!_0x129e36){alert('商品名称不能为空！');return;}if(isNaN(_0x41866f)||_0x41866f<0x0){alert(_0x297e6f(0x296));return;}const _0x49aba1=[];document[_0x297e6f(0x131c)](_0x297e6f(0x1159))[_0x297e6f(0x15c1)](_0x42368d=>{const _0x13cc72=_0x297e6f,_0xdc6237=_0x42368d['querySelector'](_0x13cc72(0xe41))['value'][_0x13cc72(0x13f9)](),_0x479aa8=parseFloat(_0x42368d[_0x13cc72(0xc86)]('.variation-price-input')['value']),_0x2d0f6e=_0x42368d['querySelector'](_0x13cc72(0x7e2))[_0x13cc72(0x10d4)];_0xdc6237&&!isNaN(_0x479aa8)&&_0x479aa8>=0x0&&_0x49aba1[_0x13cc72(0x1c4)]({'name':_0xdc6237,'price':_0x479aa8,'imageUrl':_0x2d0f6e[_0x13cc72(0x478)](_0x13cc72(0x13fb))?null:_0x2d0f6e});});const _0x1b816e={'name':_0x129e36,'price':_0x41866f,'description':_0x22500b,'imageUrl':_0x4a1d84,'categoryId':_0x594a88,'variations':_0x49aba1};_0x32068e?await _0x512070[_0x297e6f(0x376)]['update'](_0x32068e,_0x1b816e):await _0x512070[_0x297e6f(0x376)][_0x297e6f(0xe05)](_0x1b816e),document[_0x297e6f(0x9a3)]('product-editor-modal')[_0x297e6f(0x4d8)][_0x297e6f(0x133d)](_0x297e6f(0xc09)),await _0x5cb09b();}async function _0x20fce2(){const _0x1480ab=_0x48bc6d;await _0x2bf7fb(),_0x35df44(_0x1480ab(0x19f));}async function _0x2bf7fb(){const _0x34f1ca=_0x48bc6d,_0x1b80e9=document[_0x34f1ca(0x9a3)]('rules-tabs'),_0x67b733=document[_0x34f1ca(0x9a3)](_0x34f1ca(0x10f2));_0x1b80e9[_0x34f1ca(0xeb2)]='',_0x67b733['innerHTML']='';const _0x3e836d=await _0x512070[_0x34f1ca(0xb54)][_0x34f1ca(0x591)]();if(_0x3e836d[_0x34f1ca(0x106b)]===0x0){_0x67b733[_0x34f1ca(0xeb2)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>';return;}const _0x30152f=document[_0x34f1ca(0xe94)](_0x34f1ca(0xd38));_0x30152f['className']='rules-tab\x20active',_0x30152f[_0x34f1ca(0x766)]=_0x34f1ca(0x1245),_0x30152f['dataset']['categoryId']=_0x34f1ca(0xc41),_0x1b80e9[_0x34f1ca(0x983)](_0x30152f);const _0x395255=document[_0x34f1ca(0xe94)](_0x34f1ca(0x8ca));_0x395255[_0x34f1ca(0x1487)]=_0x34f1ca(0x12a7),_0x395255[_0x34f1ca(0xd8d)][_0x34f1ca(0x922)]=_0x34f1ca(0xc41),_0x67b733['appendChild'](_0x395255);const _0x3d2399=Object[_0x34f1ca(0xea1)](_0x19ddb8[_0x34f1ca(0xb04)])[_0x34f1ca(0x1195)](_0x1f043a=>!_0x1f043a['isGroup']&&_0x3e836d[_0x34f1ca(0x336)](_0x35cfb6=>_0x35cfb6[_0x34f1ca(0x907)]===_0x1f043a['id']));_0x3d2399[_0x34f1ca(0x15c1)](_0x288f3f=>{const _0x227f79=_0x34f1ca,_0x27d4f1=document[_0x227f79(0xe94)](_0x227f79(0xd38));_0x27d4f1[_0x227f79(0x1487)]=_0x227f79(0x1e6),_0x27d4f1[_0x227f79(0x766)]=_0x288f3f[_0x227f79(0x1561)],_0x27d4f1['dataset']['categoryId']=_0x288f3f['id'],_0x1b80e9[_0x227f79(0x983)](_0x27d4f1);const _0x5d9c72=document[_0x227f79(0xe94)](_0x227f79(0x8ca));_0x5d9c72[_0x227f79(0x1487)]=_0x227f79(0xcf5),_0x5d9c72[_0x227f79(0xd8d)][_0x227f79(0x922)]=_0x288f3f['id'],_0x67b733['appendChild'](_0x5d9c72);}),_0x3e836d[_0x34f1ca(0x15c1)](_0x2930c8=>{const _0x1bbfed=_0x34f1ca,_0x57b241=_0x44516a(_0x2930c8),_0x11e6d6=_0x67b733[_0x1bbfed(0xc86)]('.rules-category-pane[data-category-id=\x22'+_0x2930c8[_0x1bbfed(0x907)]+'\x22]');_0x11e6d6&&_0x11e6d6[_0x1bbfed(0x983)](_0x57b241);}),document[_0x34f1ca(0x131c)](_0x34f1ca(0x3ea))['forEach'](_0x380eba=>{const _0x29cf68=_0x34f1ca;_0x380eba['addEventListener'](_0x29cf68(0x9cc),()=>_0xcd7c4e(_0x380eba[_0x29cf68(0xd8d)][_0x29cf68(0x922)]));});}function _0x44516a(_0x24f5bf){const _0x41b1b6=_0x48bc6d,_0x3fc080=document[_0x41b1b6(0xe94)]('div');return _0x3fc080[_0x41b1b6(0x1487)]=_0x41b1b6(0x8e9)+(_0x24f5bf['isEnabled']?_0x41b1b6(0x15cd):''),_0x3fc080[_0x41b1b6(0xd8d)][_0x41b1b6(0xa85)]=_0x24f5bf['id'],_0x3fc080[_0x41b1b6(0xeb2)]=_0x41b1b6(0x110f)+_0x24f5bf[_0x41b1b6(0x1561)]+_0x41b1b6(0x586)+_0x24f5bf['regex']+_0x41b1b6(0xf46),_0x3fc080['addEventListener']('click',()=>_0x434538(_0x24f5bf['id'])),_0x1a651b(_0x3fc080,()=>_0x710a45(_0x24f5bf['id'])),_0x3fc080;}async function _0x434538(_0x455ec0=null){const _0x9d74f4=_0x48bc6d;_0x2f10cc=_0x455ec0;const _0x5a46c6=document[_0x9d74f4(0x9a3)](_0x9d74f4(0x71c)),_0x4ebe50=document['getElementById']('rule-editor-title'),_0x4a3d99=document[_0x9d74f4(0x9a3)](_0x9d74f4(0xe23)),_0x3930fe=document[_0x9d74f4(0x9a3)](_0x9d74f4(0xb1c)),_0x36686a=document[_0x9d74f4(0x9a3)]('rule-regex-input'),_0x22ee47=document[_0x9d74f4(0x9a3)](_0x9d74f4(0x485)),_0x9be206=document[_0x9d74f4(0x9a3)](_0x9d74f4(0x24a));_0x3930fe[_0x9d74f4(0xeb2)]=_0x9d74f4(0xcae),Object['values'](_0x19ddb8['chats'])[_0x9d74f4(0x1195)](_0x2a19b5=>!_0x2a19b5['isGroup'])[_0x9d74f4(0x15c1)](_0x6f21c2=>{const _0x52ac3b=_0x9d74f4;_0x3930fe[_0x52ac3b(0xeb2)]+=_0x52ac3b(0x14a9)+_0x6f21c2['id']+'\x22>'+_0x6f21c2['name']+_0x52ac3b(0x120a);});if(_0x455ec0){_0x4ebe50[_0x9d74f4(0x766)]=_0x9d74f4(0x3aa);const _0x28fdfe=await _0x512070['renderingRules']['get'](_0x455ec0);_0x4a3d99['value']=_0x28fdfe[_0x9d74f4(0x1561)],_0x3930fe['value']=_0x28fdfe['chatId'],_0x36686a[_0x9d74f4(0x7b2)]=_0x28fdfe[_0x9d74f4(0xbd2)],_0x22ee47[_0x9d74f4(0x7b2)]=_0x28fdfe[_0x9d74f4(0x10bc)],_0x9be206[_0x9d74f4(0x944)]=_0x28fdfe[_0x9d74f4(0x514)];}else _0x4ebe50[_0x9d74f4(0x766)]=_0x9d74f4(0x645),_0x4a3d99[_0x9d74f4(0x7b2)]='',_0x3930fe['value']=_0x9d74f4(0xc41),_0x36686a[_0x9d74f4(0x7b2)]='',_0x22ee47[_0x9d74f4(0x7b2)]='',_0x9be206[_0x9d74f4(0x944)]=!![];_0x5a46c6[_0x9d74f4(0x4d8)][_0x9d74f4(0xe05)](_0x9d74f4(0xc09));}async function _0x3eaada(){const _0x10c117=_0x48bc6d,_0x4eb27f=document[_0x10c117(0x9a3)](_0x10c117(0xe23))['value']['trim'](),_0x473611=document[_0x10c117(0x9a3)](_0x10c117(0xff0))['value'][_0x10c117(0x13f9)]();if(!_0x4eb27f||!_0x473611){alert(_0x10c117(0x1392));return;}try{new RegExp(_0x473611);}catch(_0x3364c6){alert(_0x10c117(0x776)+_0x3364c6[_0x10c117(0xcce)]);return;}const _0x51c597={'name':_0x4eb27f,'chatId':document['getElementById'](_0x10c117(0xb1c))[_0x10c117(0x7b2)],'regex':_0x473611,'template':document['getElementById'](_0x10c117(0x485))[_0x10c117(0x7b2)],'isEnabled':document['getElementById'](_0x10c117(0x24a))[_0x10c117(0x944)]};_0x2f10cc?await _0x512070[_0x10c117(0xb54)][_0x10c117(0xe33)](_0x2f10cc,_0x51c597):await _0x512070[_0x10c117(0xb54)]['add'](_0x51c597),document[_0x10c117(0x9a3)](_0x10c117(0x71c))['classList'][_0x10c117(0x133d)](_0x10c117(0xc09)),await _0x2bf7fb();}async function _0x710a45(_0xbd27){const _0x474006=_0x48bc6d,_0x4387fc=await _0x2c9509(_0x474006(0x14df),_0x474006(0x1577),{'confirmButtonClass':_0x474006(0xf5b)});_0x4387fc&&(await _0x512070[_0x474006(0xb54)][_0x474006(0x10a8)](_0xbd27),await _0x2bf7fb());}async function _0x5ec228(_0x3b1214,_0x1b0507){const _0x1f941e=_0x48bc6d;if(_0x3b1214[_0x1f941e(0x13f9)]()['startsWith']('<')||!_0x3b1214[_0x1f941e(0x478)]('[')&&!_0x3b1214[_0x1f941e(0x478)]('{'))return _0x3b1214;const _0x250ccf=await _0x512070[_0x1f941e(0xb54)][_0x1f941e(0x1201)](_0x1f941e(0x907))[_0x1f941e(0x5df)]('global')['or'](_0x1f941e(0x907))[_0x1f941e(0x5df)](_0x1b0507)[_0x1f941e(0x591)]();let _0x2ca9bd=_0x3b1214;for(const _0x37c331 of _0x250ccf[_0x1f941e(0x1195)](_0x1b6838=>_0x1b6838[_0x1f941e(0x514)])){try{const _0x22a3e0=new RegExp(_0x37c331[_0x1f941e(0xbd2)],'g');_0x22a3e0[_0x1f941e(0xddf)](_0x2ca9bd)&&(_0x2ca9bd=_0x2ca9bd[_0x1f941e(0x1bb)](_0x22a3e0,_0x37c331[_0x1f941e(0x10bc)]));}catch(_0x4d4ecc){console[_0x1f941e(0x3b7)](_0x1f941e(0x4b9)+_0x37c331[_0x1f941e(0x1561)]+']\x20的正则表达式无效:',_0x4d4ecc);}}return _0x2ca9bd;}async function _0x20fce2(){const _0x3281cc=_0x48bc6d;await _0x2bf7fb(),_0x35df44(_0x3281cc(0x19f));}async function _0x2bf7fb(){const _0x524a39=_0x48bc6d,_0x511248=document[_0x524a39(0x9a3)]('rules-tabs'),_0xa82481=document[_0x524a39(0x9a3)]('rules-content-container');_0x511248[_0x524a39(0xeb2)]='',_0xa82481[_0x524a39(0xeb2)]='';const _0x382cfe=await _0x512070[_0x524a39(0xb54)][_0x524a39(0x591)]();if(_0x382cfe['length']===0x0){_0xa82481['innerHTML']=_0x524a39(0x152d);return;}const _0x4bbacc=document[_0x524a39(0xe94)](_0x524a39(0xd38));_0x4bbacc[_0x524a39(0x1487)]=_0x524a39(0x337),_0x4bbacc['textContent']=_0x524a39(0x1245),_0x4bbacc[_0x524a39(0xd8d)][_0x524a39(0x922)]=_0x524a39(0xc41),_0x511248[_0x524a39(0x983)](_0x4bbacc);const _0x344866=document[_0x524a39(0xe94)]('div');_0x344866[_0x524a39(0x1487)]=_0x524a39(0x12a7),_0x344866[_0x524a39(0xd8d)][_0x524a39(0x922)]=_0x524a39(0xc41),_0xa82481[_0x524a39(0x983)](_0x344866);const _0x315031=Object[_0x524a39(0xea1)](_0x19ddb8['chats'])[_0x524a39(0x1195)](_0x53fc33=>!_0x53fc33[_0x524a39(0x136b)]&&_0x382cfe[_0x524a39(0x336)](_0x5eb9a4=>_0x5eb9a4[_0x524a39(0x907)]===_0x53fc33['id']));_0x315031[_0x524a39(0x15c1)](_0x293627=>{const _0x28149f=_0x524a39,_0x4d776c=document[_0x28149f(0xe94)](_0x28149f(0xd38));_0x4d776c['className']='rules-tab',_0x4d776c[_0x28149f(0x766)]=_0x293627[_0x28149f(0x1561)],_0x4d776c[_0x28149f(0xd8d)][_0x28149f(0x922)]=_0x293627['id'],_0x511248[_0x28149f(0x983)](_0x4d776c);const _0x52cac7=document[_0x28149f(0xe94)](_0x28149f(0x8ca));_0x52cac7[_0x28149f(0x1487)]=_0x28149f(0xcf5),_0x52cac7[_0x28149f(0xd8d)][_0x28149f(0x922)]=_0x293627['id'],_0xa82481[_0x28149f(0x983)](_0x52cac7);}),_0x382cfe[_0x524a39(0x15c1)](_0x41537a=>{const _0x432ed3=_0x524a39,_0x5d893f=_0x44516a(_0x41537a),_0x3450f5=_0xa82481[_0x432ed3(0xc86)](_0x432ed3(0x413)+_0x41537a[_0x432ed3(0x907)]+'\x22]');_0x3450f5&&_0x3450f5[_0x432ed3(0x983)](_0x5d893f);}),document[_0x524a39(0x131c)]('.rules-tab')[_0x524a39(0x15c1)](_0x58c890=>{const _0x14860c=_0x524a39;_0x58c890[_0x14860c(0x954)](_0x14860c(0x9cc),()=>_0xcd7c4e(_0x58c890[_0x14860c(0xd8d)][_0x14860c(0x922)]));});}function _0x44516a(_0x37563a){const _0x5e9eb2=_0x48bc6d,_0x345171=document[_0x5e9eb2(0xe94)](_0x5e9eb2(0x8ca));return _0x345171[_0x5e9eb2(0x1487)]=_0x5e9eb2(0x8e9)+(_0x37563a[_0x5e9eb2(0x514)]?_0x5e9eb2(0x15cd):''),_0x345171[_0x5e9eb2(0xd8d)][_0x5e9eb2(0xa85)]=_0x37563a['id'],_0x345171[_0x5e9eb2(0xeb2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>'+_0x37563a[_0x5e9eb2(0x1561)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>'+_0x37563a[_0x5e9eb2(0xbd2)]+_0x5e9eb2(0xf46),_0x345171[_0x5e9eb2(0x954)](_0x5e9eb2(0x9cc),()=>_0x434538(_0x37563a['id'])),_0x1a651b(_0x345171,()=>_0x710a45(_0x37563a['id'])),_0x345171;}async function _0x434538(_0x376979=null){const _0x4b7424=_0x48bc6d;_0x2f10cc=_0x376979;const _0x2dcae6=document[_0x4b7424(0x9a3)](_0x4b7424(0x71c)),_0x17d48c=document[_0x4b7424(0x9a3)]('rule-editor-title'),_0x4cc9cc=document[_0x4b7424(0x9a3)](_0x4b7424(0xe23)),_0x154076=document[_0x4b7424(0x9a3)](_0x4b7424(0xb1c)),_0x410833=document[_0x4b7424(0x9a3)](_0x4b7424(0xff0)),_0xa0d235=document[_0x4b7424(0x9a3)](_0x4b7424(0x485)),_0xa6fc6d=document[_0x4b7424(0x9a3)](_0x4b7424(0x24a));_0x154076[_0x4b7424(0xeb2)]=_0x4b7424(0xcae),Object[_0x4b7424(0xea1)](_0x19ddb8['chats'])['filter'](_0x541234=>!_0x541234['isGroup'])[_0x4b7424(0x15c1)](_0x20e769=>{const _0x5b76e5=_0x4b7424;_0x154076[_0x5b76e5(0xeb2)]+=_0x5b76e5(0x14a9)+_0x20e769['id']+'\x22>'+_0x20e769[_0x5b76e5(0x1561)]+_0x5b76e5(0x120a);});if(_0x376979){_0x17d48c['textContent']=_0x4b7424(0x3aa);const _0x519108=await _0x512070[_0x4b7424(0xb54)][_0x4b7424(0x14ee)](_0x376979);_0x4cc9cc[_0x4b7424(0x7b2)]=_0x519108[_0x4b7424(0x1561)],_0x154076['value']=_0x519108[_0x4b7424(0x907)],_0x410833['value']=_0x519108['regex'],_0xa0d235[_0x4b7424(0x7b2)]=_0x519108[_0x4b7424(0x10bc)],_0xa6fc6d['checked']=_0x519108[_0x4b7424(0x514)];}else _0x17d48c[_0x4b7424(0x766)]=_0x4b7424(0x645),_0x4cc9cc[_0x4b7424(0x7b2)]='',_0x154076[_0x4b7424(0x7b2)]=_0x4b7424(0xc41),_0x410833['value']='',_0xa0d235[_0x4b7424(0x7b2)]='',_0xa6fc6d[_0x4b7424(0x944)]=!![];_0x2dcae6['classList'][_0x4b7424(0xe05)](_0x4b7424(0xc09));}async function _0x3eaada(){const _0x51968b=_0x48bc6d,_0x4e2a80=document[_0x51968b(0x9a3)]('rule-name-input')['value'][_0x51968b(0x13f9)](),_0x1cc9dd=document[_0x51968b(0x9a3)](_0x51968b(0xff0))[_0x51968b(0x7b2)][_0x51968b(0x13f9)]();if(!_0x4e2a80||!_0x1cc9dd){alert(_0x51968b(0x1392));return;}try{new RegExp(_0x1cc9dd);}catch(_0x27810e){alert(_0x51968b(0x776)+_0x27810e[_0x51968b(0xcce)]);return;}const _0x5080c1={'name':_0x4e2a80,'chatId':document[_0x51968b(0x9a3)](_0x51968b(0xb1c))['value'],'regex':_0x1cc9dd,'template':document['getElementById'](_0x51968b(0x485))[_0x51968b(0x7b2)],'isEnabled':document['getElementById'](_0x51968b(0x24a))[_0x51968b(0x944)]};_0x2f10cc?await _0x512070[_0x51968b(0xb54)][_0x51968b(0xe33)](_0x2f10cc,_0x5080c1):await _0x512070['renderingRules'][_0x51968b(0xe05)](_0x5080c1),document[_0x51968b(0x9a3)](_0x51968b(0x71c))[_0x51968b(0x4d8)]['remove'](_0x51968b(0xc09)),await _0x2bf7fb();}async function _0x710a45(_0x2c95ce){const _0x35354d=_0x48bc6d,_0x2f38d1=await _0x2c9509(_0x35354d(0x14df),_0x35354d(0x1577),{'confirmButtonClass':'btn-danger'});_0x2f38d1&&(await _0x512070[_0x35354d(0xb54)][_0x35354d(0x10a8)](_0x2c95ce),await _0x2bf7fb());}async function _0x5ec228(_0x18356e,_0x284063){const _0x39931a=_0x48bc6d;if(_0x18356e[_0x39931a(0x13f9)]()[_0x39931a(0x608)]('<')||!_0x18356e['includes']('[')&&!_0x18356e[_0x39931a(0x478)]('{'))return _0x18356e;if(!_0x283ecc[_0x284063]){console[_0x39931a(0xe4d)](_0x39931a(0x1004)+_0x284063);const _0x5c388a=await _0x512070['renderingRules'][_0x39931a(0x1201)](_0x39931a(0x907))[_0x39931a(0x5df)](_0x39931a(0xc41))['or'](_0x39931a(0x907))[_0x39931a(0x5df)](_0x284063)[_0x39931a(0x591)]();_0x283ecc[_0x284063]=_0x5c388a['filter'](_0x18713e=>_0x18713e[_0x39931a(0x514)]);}const _0x235d9c=_0x283ecc[_0x284063];let _0x26f119=_0x18356e;for(const _0x344a6b of _0x235d9c){try{const _0x5a4e7c=new RegExp(_0x344a6b['regex'],'g');let _0x18599b=_0x26f119;_0x5a4e7c[_0x39931a(0xddf)](_0x18599b)&&(_0x26f119=_0x26f119['replace'](_0x5a4e7c,_0x344a6b[_0x39931a(0x10bc)]));}catch(_0x436b67){console[_0x39931a(0x3b7)](_0x39931a(0x4b9)+_0x344a6b[_0x39931a(0x1561)]+_0x39931a(0xf2b),_0x436b67);}}return _0x26f119;}function _0x1ea38b(_0x453e06){const _0x2b2ab6=_0x48bc6d;if(!_0x453e06)return'';const _0x32381b=new Date(),_0x1a8fcf=new Date(_0x453e06),_0x563947=String(_0x1a8fcf['getHours']())[_0x2b2ab6(0x1488)](0x2,'0'),_0x46c3b6=String(_0x1a8fcf[_0x2b2ab6(0xa21)]())[_0x2b2ab6(0x1488)](0x2,'0'),_0x2ec2c0=_0x563947+':'+_0x46c3b6;if(_0x32381b[_0x2b2ab6(0x1514)]()===_0x1a8fcf[_0x2b2ab6(0x1514)]())return _0x2ec2c0;const _0x181c52=new Date();_0x181c52[_0x2b2ab6(0x7ee)](_0x32381b[_0x2b2ab6(0x67c)]()-0x1);if(_0x181c52[_0x2b2ab6(0x1514)]()===_0x1a8fcf[_0x2b2ab6(0x1514)]())return _0x2b2ab6(0x247)+_0x2ec2c0;const _0x348a75=_0x1a8fcf[_0x2b2ab6(0xef7)](),_0x9404e4=String(_0x1a8fcf[_0x2b2ab6(0x1428)]()+0x1)[_0x2b2ab6(0x1488)](0x2,'0'),_0x4b995f=String(_0x1a8fcf['getDate']())[_0x2b2ab6(0x1488)](0x2,'0');return _0x32381b[_0x2b2ab6(0xef7)]()===_0x348a75?_0x9404e4+'月'+_0x4b995f+'日\x20'+_0x2ec2c0:_0x348a75+'年'+_0x9404e4+'月'+_0x4b995f+'日\x20'+_0x2ec2c0;}function _0x17d417(_0x2e496b){const _0x3054fd=_0x48bc6d,_0x5abfde=document[_0x3054fd(0xe94)](_0x3054fd(0x8ca));_0x5abfde[_0x3054fd(0x1487)]='message-wrapper\x20system-pat';const _0x570c63=document[_0x3054fd(0xe94)](_0x3054fd(0x8ca));return _0x570c63[_0x3054fd(0x1487)]='message-bubble\x20system-bubble',_0x570c63['textContent']=_0x1ea38b(_0x2e496b),_0x5abfde[_0x3054fd(0x983)](_0x570c63),_0x5abfde;}async function _0x3023a5(){const _0x4a413e=_0x48bc6d,_0x38a325=_0x19ddb8['chats'][_0x19ddb8[_0x4a413e(0x859)]];if(!_0x38a325||!lastResponseTimestamps||lastResponseTimestamps['length']===0x0){alert('没有可供重新生成的AI响应。');return;}_0x38a325[_0x4a413e(0x1f0)]=_0x38a325['history'][_0x4a413e(0x1195)](_0x1d0832=>!lastResponseTimestamps[_0x4a413e(0x478)](_0x1d0832[_0x4a413e(0xd73)])),await _0x512070[_0x4a413e(0xb04)][_0x4a413e(0xd4d)](_0x38a325),await _0x56abd7(_0x19ddb8[_0x4a413e(0x859)]),_0x2ec49e();}async function _0x22d17a(_0x2563e2,_0x58ed56){const _0x5e7042=_0x48bc6d;if(!_0x19ddb8[_0x5e7042(0x859)])return;const _0x558607=_0x19ddb8[_0x5e7042(0xb04)][_0x19ddb8['activeChatId']],_0xb58b6b=_0x558607['history'][_0x5e7042(0x455)](_0x2fcea0=>_0x2fcea0['timestamp']===_0x2563e2);if(_0xb58b6b===-0x1)return;const _0x191a5e=_0x558607[_0x5e7042(0x1f0)][_0xb58b6b],_0x523efe=_0x191a5e[_0x5e7042(0x3a1)];if(!_0x523efe){await _0x403a62(_0x5e7042(0x78b),_0x5e7042(0x134d));return;}_0x58ed56[_0x5e7042(0x15d3)]=!![],_0x58ed56[_0x5e7042(0x4d8)]['add'](_0x5e7042(0x1df));const _0x4dfd7b=_0x58ed56['closest'](_0x5e7042(0x5c4)),_0x11da94=_0x4dfd7b?_0x4dfd7b['querySelector'](_0x5e7042(0x96d)):null;_0x11da94&&(_0x11da94[_0x5e7042(0x20f)][_0x5e7042(0x71f)]=_0x5e7042(0x13dc));try{const _0x3b6842=await _0x34bcbc(_0x523efe,_0x558607['id']);_0x191a5e['imageUrl']=_0x3b6842[_0x5e7042(0xbfe)],_0x191a5e[_0x5e7042(0x5d7)]=_0x3b6842['fullPrompt'],await _0x512070[_0x5e7042(0xb04)][_0x5e7042(0xd4d)](_0x558607),_0x11da94&&(_0x11da94[_0x5e7042(0x10d4)]=_0x3b6842[_0x5e7042(0xbfe)],_0x11da94[_0x5e7042(0x10b8)]=_0x3b6842[_0x5e7042(0x5d7)],_0x11da94[_0x5e7042(0x20f)]['opacity']='1');}catch(_0x3cc5e1){console[_0x5e7042(0x3b7)](_0x5e7042(0xe55),_0x3cc5e1),await _0x403a62(_0x5e7042(0x8e8),'无法重新生成图片:\x20'+_0x3cc5e1[_0x5e7042(0xcce)]),_0x11da94&&(_0x11da94[_0x5e7042(0x20f)][_0x5e7042(0x71f)]='1');}finally{_0x58ed56[_0x5e7042(0x15d3)]=![],_0x58ed56[_0x5e7042(0x4d8)][_0x5e7042(0x133d)](_0x5e7042(0x1df));}}async function _0xcafed7(){const _0x5e6429=_0x48bc6d,_0x26044a=_0x19ddb8[_0x5e6429(0xb04)][_0x19ddb8['activeChatId']];if(!_0x26044a)return;const _0x37eaef=_0x26044a[_0x5e6429(0x1f0)][_0x5e6429(0x527)](_0x473f25=>_0x473f25['role']===_0x5e6429(0x20d)&&!_0x473f25['isHidden']);if(_0x37eaef===-0x1){alert(_0x5e6429(0x106a));return;}const _0x55f1e0=_0x26044a[_0x5e6429(0x1f0)][_0x5e6429(0x527)](_0x4165ed=>_0x4165ed[_0x5e6429(0x11c1)]==='assistant');if(_0x55f1e0<_0x37eaef){alert(_0x5e6429(0x10d9));return;}_0x26044a['history']=_0x26044a[_0x5e6429(0x1f0)]['slice'](0x0,_0x37eaef+0x1),await _0x512070['chats'][_0x5e6429(0xd4d)](_0x26044a),await _0x56abd7(_0x19ddb8[_0x5e6429(0x859)]),await _0x55bf11();}async function _0x10d8cd(){const _0x4db07d=_0x48bc6d;if(!_0x4acdaf['isActive'])return;const _0x5f50ba=_0x4acdaf['callHistory'][_0x4db07d(0x527)](_0xf56c3=>_0xf56c3[_0x4db07d(0x11c1)]===_0x4db07d(0x20d));if(_0x5f50ba===-0x1){alert(_0x4db07d(0x187));return;}_0x4acdaf['callHistory'][_0x4db07d(0x15b0)](_0x5f50ba+0x1);const _0x4526e2=document[_0x4db07d(0x9a3)]('video-call-main');_0x4526e2['innerHTML']='',_0x4acdaf['callHistory']['forEach'](_0xab121a=>{const _0x1a325d=_0x4db07d,_0x5761b7=document['createElement'](_0x1a325d(0x8ca)),_0x51fc89=_0xab121a[_0x1a325d(0x11c1)]===_0x1a325d(0x115c)?_0x1a325d(0xcd9):_0x1a325d(0xde3);_0x5761b7[_0x1a325d(0x1487)]=_0x1a325d(0xdbd)+_0x51fc89,_0x5761b7[_0x1a325d(0xd8d)][_0x1a325d(0xd73)]=_0xab121a[_0x1a325d(0xd73)],_0xab121a['role']==='user'?_0x5761b7[_0x1a325d(0x766)]=_0xab121a[_0x1a325d(0x4e3)]:_0x5761b7[_0x1a325d(0xeb2)]=_0xab121a[_0x1a325d(0x4e3)],_0x1a651b(_0x5761b7,()=>_0x2d7bd9(_0xab121a[_0x1a325d(0xd73)])),_0x4526e2[_0x1a325d(0x983)](_0x5761b7);}),_0x4526e2['scrollTop']=_0x4526e2['scrollHeight'],_0x4d3853(null);}async function _0x585ed7(){const _0x5436fe=_0x48bc6d,_0x1a5f67=_0x19ddb8['chats'][_0x19ddb8[_0x5436fe(0x859)]];if(!_0x1a5f67)return;_0x4fad07(_0x1a5f67['id'],!![]);const _0x31398d=document[_0x5436fe(0x9a3)](_0x5436fe(0x991));!_0x1a5f67[_0x5436fe(0x136b)]&&(_0x31398d[_0x5436fe(0x20f)][_0x5436fe(0x71f)]=0x0,setTimeout(()=>{const _0x4d403c=_0x5436fe;_0x31398d['textContent']=_0x4d403c(0x419),_0x31398d[_0x4d403c(0x4d8)]['add'](_0x4d403c(0x317)),_0x31398d[_0x4d403c(0x20f)][_0x4d403c(0x71f)]=0x1;},0xc8));try{const {proxyUrl:_0x41126a,apiKey:_0x2a7ed0,model:_0x4acd84}=_0x19ddb8[_0x5436fe(0xd22)];if(!_0x41126a||!_0x2a7ed0||!_0x4acd84)throw new Error('API未配置');const _0x5761e4=parseInt(_0x1a5f67[_0x5436fe(0x450)][_0x5436fe(0x152f)])||0xa,_0x351e11=_0x1a5f67['history'][_0x5436fe(0x457)](-_0x5761e4),_0x37537b=new Date(),_0x68fe1a=new Date(_0x37537b['getTime']()+_0x37537b[_0x5436fe(0x164)]()*0xea60+0x36ee80*0x8),_0x28a6c4=_0x68fe1a['toLocaleString'](_0x5436fe(0x15bc),{'timeZone':'Asia/Shanghai','dateStyle':_0x5436fe(0x38f),'timeStyle':_0x5436fe(0xa1b)}),_0x2b8cb6=_0x7e10b(_0x68fe1a),_0x35c2bc=_0x1a5f67['settings']['myNickname']||'我';let _0xf42f60='';if(_0x1a5f67[_0x5436fe(0x450)][_0x5436fe(0x9c4)]&&_0x1a5f67[_0x5436fe(0x450)]['linkedWorldBookIds'][_0x5436fe(0x106b)]>0x0){const _0x51fd73=_0x1a5f67[_0x5436fe(0x450)][_0x5436fe(0x9c4)][_0x5436fe(0xb0a)](_0x56abc3=>{const _0x452991=_0x5436fe,_0xaebc00=_0x19ddb8[_0x452991(0x8e4)][_0x452991(0xd62)](_0x226a6f=>_0x226a6f['id']===_0x56abc3);if(!_0xaebc00||!Array[_0x452991(0xb9b)](_0xaebc00[_0x452991(0x4e3)]))return'';const _0x13225b=_0xaebc00[_0x452991(0x4e3)][_0x452991(0x1195)](_0x35c715=>_0x35c715['enabled']!==![])['map'](_0x923a2f=>{const _0xf046e=_0x452991;let _0x4df2ce=_0xf046e(0xc4e)+(_0x923a2f['comment']||_0xf046e(0xbcc))+'\x0a';if(_0x923a2f[_0xf046e(0x2d0)]['length']>0x0)_0x4df2ce+=_0xf046e(0x1092)+_0x923a2f['keys'][_0xf046e(0x3b9)](',\x20')+'\x0a';return _0x4df2ce+='**内容:**\x0a'+_0x923a2f['content'],_0x4df2ce;})[_0x452991(0x3b9)]('');return _0x13225b?'\x0a\x0a##\x20世界书:\x20'+_0xaebc00[_0x452991(0x1561)]+'\x0a'+_0x13225b:'';})['filter'](Boolean)[_0x5436fe(0x3b9)]('');_0x51fd73&&(_0xf42f60='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x51fd73+'\x0a#\x20---\x20世界书设定结束\x20---\x0a');}let _0x130b8a='';if(_0x4e0631[_0x5436fe(0x1412)]&&_0x4e0631['activeChatId']===_0x1a5f67['id']){const _0x49e4ee=_0x4e0631[_0x5436fe(0xfe2)]>-0x1?_0x4e0631['playlist'][_0x4e0631[_0x5436fe(0xfe2)]]:null;_0x130b8a=_0x5436fe(0xad6);}const _0x557087=_0x4b122e(_0x2b35e7[_0x1a5f67['id']]);let _0x1b6c11='';_0x1a5f67[_0x5436fe(0x1058)]&&_0x1a5f67[_0x5436fe(0x1058)]['length']>0x0&&(_0x1b6c11='\x0a-\x20**你的曾用名**:\x20['+_0x1a5f67[_0x5436fe(0x1058)][_0x5436fe(0x3b9)](',\x20')+_0x5436fe(0x8dd));let _0x337560='';const _0x4a9af2=_0x19ddb8['qzoneSettings'][_0x5436fe(0x246)]||'用户';_0x337560+=_0x5436fe(0xbb9)+_0x4a9af2+_0x5436fe(0xa60);const _0x52701c=Object[_0x5436fe(0xea1)](_0x19ddb8[_0x5436fe(0xb04)])['filter'](_0x5de758=>_0x5de758[_0x5436fe(0x136b)]&&_0x5de758[_0x5436fe(0xcca)]['some'](_0x5a49b8=>_0x5a49b8['id']===_0x1a5f67['id']));_0x52701c['length']>0x0&&(_0x337560+=_0x5436fe(0xe62),_0x52701c[_0x5436fe(0x15c1)](_0x5a09c5=>{const _0x3eade2=_0x5436fe,_0x12c39e=_0x5a09c5[_0x3eade2(0x450)]['myNickname']||_0x4a9af2;_0x337560+=_0x3eade2(0x59e)+_0x5a09c5[_0x3eade2(0x1561)]+_0x3eade2(0x9b7)+_0x12c39e+_0x3eade2(0x38b);}));_0x337560+=_0x5436fe(0x1350);const _0x3d5fe4=_0xc9a7e4(_0x1a5f67),_0x52b19c=_0x5436fe(0x458)+_0x1a5f67[_0x5436fe(0x339)]+_0x5436fe(0xac3)+_0x28a6c4+'\x20('+_0x2b8cb6+')，并在对话中自然地体现出来。\x0a\x20\x20\x20\x20-\x20**音乐**:\x20'+(_0x130b8a?'你们正在一起听歌，'+_0x130b8a:_0x5436fe(0x1078))+_0x5436fe(0x5a9)+(_0x1a5f67[_0x5436fe(0x744)]&&_0x1a5f67[_0x5436fe(0x744)]['length']>0x0?_0x1a5f67[_0x5436fe(0x744)]['map'](_0x41ad76=>'-\x20'+_0x41ad76['content'])['join']('\x0a'):'-\x20(暂无)')+_0x5436fe(0xf75)+_0x1a5f67[_0x5436fe(0x450)]['aiPersona']+_0x5436fe(0xec8)+_0x1a5f67[_0x5436fe(0x339)]+_0x5436fe(0x26e)+_0x1a5f67[_0x5436fe(0x1561)]+_0x5436fe(0x841)+_0x35c2bc+_0x5436fe(0x78a)+_0x337560+_0x5436fe(0x379)+_0x1b6c11+_0x5436fe(0x379)+_0xf42f60+_0x5436fe(0xc66)+_0x3d5fe4+_0x5436fe(0x206)+(_0x1a5f67[_0x5436fe(0x450)][_0x5436fe(0xea2)]&&_0x1a5f67[_0x5436fe(0x450)]['aiAvatarLibrary'][_0x5436fe(0x106b)]>0x0?_0x1a5f67[_0x5436fe(0x450)]['aiAvatarLibrary'][_0x5436fe(0xb0a)](_0x22fe91=>'-\x20'+_0x22fe91['name'])[_0x5436fe(0x3b9)]('\x0a'):'-\x20(空)')+_0x5436fe(0x11a8)+(_0x1a5f67[_0x5436fe(0x450)][_0x5436fe(0xa70)]&&_0x1a5f67[_0x5436fe(0x450)]['myAvatarLibrary'][_0x5436fe(0x106b)]>0x0?_0x1a5f67[_0x5436fe(0x450)][_0x5436fe(0xa70)][_0x5436fe(0xb0a)](_0x33210e=>'-\x20'+_0x33210e[_0x5436fe(0x1561)])[_0x5436fe(0x3b9)]('\x0a'):_0x5436fe(0xb75))+_0x5436fe(0x79e)+_0x1a5f67[_0x5436fe(0x450)][_0x5436fe(0x1e3)]+_0x5436fe(0x31a),_0x1a89cb=_0x351e11['map'](_0x1e8b25=>({'role':_0x1e8b25['role'],'content':String(_0x1e8b25[_0x5436fe(0x4e3)])}));_0x1a89cb['push']({'role':_0x5436fe(0x20d),'content':'[系统指令：用户按下了“推进”按钮，现在轮到你主动行动了，请继续对话。]'});let _0x390d83=_0x41126a===GEMINI_API_URL,_0xe402e2=_0x366263(_0x4acd84,_0x2a7ed0,_0x52b19c,_0x1a89cb);const _0x18bc58=_0x390d83?await fetch(_0xe402e2[_0x5436fe(0x121f)],_0xe402e2[_0x5436fe(0x38c)]):await fetch(_0x41126a+_0x5436fe(0x501),{'method':_0x5436fe(0x12db),'headers':{'Content-Type':_0x5436fe(0xb1f),'Authorization':_0x5436fe(0x1265)+_0x2a7ed0},'body':JSON[_0x5436fe(0xe1e)]({'model':_0x4acd84,'messages':[{'role':_0x5436fe(0xe10),'content':_0x52b19c},..._0x1a89cb],'temperature':_0x19ddb8[_0x5436fe(0x4c8)]['apiTemperature']||0.8})});if(!_0x18bc58['ok']){const _0x5e7989=await _0x18bc58['json']();throw new Error('API\x20请求失败:\x20'+_0x5e7989[_0x5436fe(0x3b7)][_0x5436fe(0xcce)]);}const _0xcb93f2=await _0x18bc58[_0x5436fe(0xa5d)](),_0x459a0d=getGeminiResponseText(_0xcb93f2),_0x249205=_0x189ab1(_0x459a0d),_0x2a87e7=[];for(const _0x32578e of _0x249205){if(_0x32578e[_0x5436fe(0x1508)]===_0x5436fe(0x13ca)&&typeof _0x32578e['content']==='string'&&_0x32578e[_0x5436fe(0x4e3)][_0x5436fe(0x478)]('\x0a')){const _0x2841dd=_0x32578e[_0x5436fe(0x4e3)][_0x5436fe(0x1536)](/\n+/)[_0x5436fe(0x1195)](_0x26ced2=>_0x26ced2[_0x5436fe(0x13f9)]());_0x2841dd[_0x5436fe(0x15c1)](_0x69018c=>{const _0x33a500=_0x5436fe;_0x2a87e7[_0x33a500(0x1c4)]({..._0x32578e,'content':_0x69018c});});}else _0x2a87e7[_0x5436fe(0x1c4)](_0x32578e);}let _0x54b2c4=Date[_0x5436fe(0x64b)]();for(const _0x5cbf81 of _0x2a87e7){const _0x4e27dd={'role':_0x5436fe(0x115c),'senderName':_0x1a5f67[_0x5436fe(0x339)],'timestamp':_0x54b2c4++,'content':_0x5cbf81['content']||_0x5cbf81[_0x5436fe(0xcce)],'type':_0x5cbf81[_0x5436fe(0x1508)]||_0x5436fe(0x13ca)};if(_0x5cbf81['type']==='update_thoughts'){if(!_0x1a5f67['isGroup']){if(_0x5cbf81[_0x5436fe(0x50a)])_0x1a5f67[_0x5436fe(0x390)]=String(_0x5cbf81[_0x5436fe(0x50a)]);if(_0x5cbf81['random_jottings'])_0x1a5f67[_0x5436fe(0x69b)]=String(_0x5cbf81[_0x5436fe(0xe0b)]);}continue;}_0x1a5f67['history']['push'](_0x4e27dd),_0x1ef393(_0x4e27dd,_0x1a5f67),await new Promise(_0x2acf92=>setTimeout(_0x2acf92,Math['random']()*0x3e8+0x320));}await _0x512070[_0x5436fe(0xb04)]['put'](_0x1a5f67),_0xec8072();}catch(_0x435789){console[_0x5436fe(0x3b7)](_0x5436fe(0xed9),_0x435789),await _0x403a62(_0x5436fe(0x13bd),_0x5436fe(0xc7b)+_0x435789['message']);}finally{_0x4fad07(_0x1a5f67['id'],![]);if(!_0x1a5f67[_0x5436fe(0x136b)]&&document[_0x5436fe(0x9a3)](_0x5436fe(0x991))){const _0x295d94=document[_0x5436fe(0x9a3)](_0x5436fe(0x991));_0x295d94['style'][_0x5436fe(0x71f)]=0x0,setTimeout(()=>{const _0x3e88e3=_0x5436fe;_0x295d94[_0x3e88e3(0x766)]=_0x1a5f67['name'],_0x295d94[_0x3e88e3(0x4d8)][_0x3e88e3(0x133d)](_0x3e88e3(0x317)),_0x295d94[_0x3e88e3(0x20f)][_0x3e88e3(0x71f)]=0x1;},0xc8);}}}function _0x5bda2f(){const _0xc1096b=_0x48bc6d,_0x4fe6a6=document[_0xc1096b(0x9a3)](_0xc1096b(0x49c)),_0x4c4ff9=_0x19ddb8[_0xc1096b(0x4c8)]['notificationSoundUrl']||_0x283b35;_0x4c4ff9&&_0x4c4ff9[_0xc1096b(0x13f9)]()&&(_0x4fe6a6[_0xc1096b(0x10d4)]=_0x4c4ff9,_0x4fe6a6[_0xc1096b(0x156e)]()[_0xc1096b(0x904)](_0x3faae0=>console[_0xc1096b(0xe4d)](_0xc1096b(0xaac),_0x3faae0)));}function _0x537b6a(){const _0x225595=_0x48bc6d;if(!_0x19ddb8['globalSettings'][_0x225595(0xdc1)])return;for(const _0x5e3434 in _0x19ddb8[_0x225595(0x4c8)][_0x225595(0xdc1)]){const _0x50babb=document['getElementById'](_0x5e3434),_0x1fd5e8=_0x19ddb8[_0x225595(0x4c8)][_0x225595(0xdc1)][_0x5e3434];_0x50babb&&(_0x50babb[_0x225595(0x168)]===_0x225595(0x57a)?_0x50babb[_0x225595(0x10d4)]=_0x1fd5e8:_0x50babb[_0x225595(0x766)]=_0x1fd5e8);}}function _0x5a2cc8(){return new Promise(_0x18d08f=>{const _0x157325=_0x1efc,_0x5d42b7=document[_0x157325(0xe94)](_0x157325(0x1b4));_0x5d42b7['type']='file',_0x5d42b7[_0x157325(0xa91)]=_0x157325(0x139c),_0x5d42b7[_0x157325(0xd70)]=_0x3b3461=>{const _0x4144e4=_0x157325,_0x3a7477=_0x3b3461['target']['files'][0x0];if(_0x3a7477){const _0x24b6ed=new FileReader();_0x24b6ed[_0x4144e4(0xdd7)]=_0xb6f3ab=>{const _0x15a6ec=_0x4144e4;_0x18d08f(_0xb6f3ab[_0x15a6ec(0xa41)][_0x15a6ec(0x5c9)]);},_0x24b6ed[_0x4144e4(0xdd8)](_0x3a7477);}else _0x18d08f(null);},_0x5d42b7[_0x157325(0x9cc)]();});}async function _0x37c8e5(_0x568b03){const _0x1e364c=_0x48bc6d,_0x2e368f=_0x568b03['id'],_0x3e4c35=_0x568b03[_0x1e364c(0x766)],_0x2b930a=await _0x3ab788('修改文字','请输入新的内容：',_0x3e4c35);if(_0x2b930a!==null&&_0x2b930a[_0x1e364c(0x13f9)]()!==''){const _0x323e92=_0x2b930a['trim']();_0x568b03[_0x1e364c(0x766)]=_0x323e92,_0x19ddb8[_0x1e364c(0x4c8)][_0x1e364c(0xdc1)][_0x2e368f]=_0x323e92,await _0x512070[_0x1e364c(0x4c8)][_0x1e364c(0xd4d)](_0x19ddb8[_0x1e364c(0x4c8)]),alert(_0x1e364c(0x130d));}}async function _0xb1f264(_0x17726a){const _0x3aa8a8=_0x48bc6d,_0x3e0540=_0x17726a['id'],_0x1b11d1=await _0x49acac('修改图片',[{'text':_0x3aa8a8(0x5a6),'value':_0x3aa8a8(0x66d)},{'text':_0x3aa8a8(0x974),'value':'url'}]);let _0x5c539f=null;if(_0x1b11d1===_0x3aa8a8(0x66d))_0x5c539f=await _0x5a2cc8();else _0x1b11d1===_0x3aa8a8(0x121f)&&(_0x5c539f=await _0x3ab788(_0x3aa8a8(0xca2),_0x3aa8a8(0x1f3),_0x17726a[_0x3aa8a8(0x10d4)],_0x3aa8a8(0x121f)));if(_0x5c539f&&_0x5c539f[_0x3aa8a8(0x13f9)]()){const _0x1468a0=_0x5c539f['trim']();_0x17726a['src']=_0x1468a0,_0x19ddb8[_0x3aa8a8(0x4c8)][_0x3aa8a8(0xdc1)][_0x3e0540]=_0x1468a0,await _0x512070[_0x3aa8a8(0x4c8)][_0x3aa8a8(0xd4d)](_0x19ddb8[_0x3aa8a8(0x4c8)]),alert(_0x3aa8a8(0x137b));}else _0x1b11d1===_0x3aa8a8(0x121f)&&_0x5c539f!==null&&alert(_0x3aa8a8(0xd79));}const _0x3f11f9={'getSongCache'(_0x2edbc2,_0x44bc56){const _0x4f6e74=_0x48bc6d,_0xdd468c=(_0x44bc56||_0x4f6e74(0xbf1))+':'+_0x2edbc2;if(_0x19ddb8[_0x4f6e74(0x1205)]&&_0x19ddb8[_0x4f6e74(0x1205)]['songs']){const _0x321bb6=_0x19ddb8['cache']['songs'][_0x4f6e74(0x14ee)](_0xdd468c);if(_0x321bb6&&Date[_0x4f6e74(0x64b)]()-_0x321bb6[_0x4f6e74(0xd73)]<0x36ee80)return _0x321bb6[_0x4f6e74(0x38c)];}return null;},'setSongCache'(_0x3fb2ea,_0x5b55c9,_0x147bfa){const _0x5ead23=_0x48bc6d,_0x2dcdf1=(_0x147bfa||_0x5ead23(0xbf1))+':'+_0x3fb2ea;if(!_0x19ddb8[_0x5ead23(0x1205)])_0x19ddb8[_0x5ead23(0x1205)]={};if(!_0x19ddb8[_0x5ead23(0x1205)][_0x5ead23(0x175)])_0x19ddb8[_0x5ead23(0x1205)][_0x5ead23(0x175)]=new Map();_0x19ddb8[_0x5ead23(0x1205)][_0x5ead23(0x175)][_0x5ead23(0x1177)](_0x2dcdf1,{'data':_0x5b55c9,'timestamp':Date['now']()});}};typeof Http_Get_External===_0x48bc6d(0x738)&&(window[_0x48bc6d(0x958)]=function(_0x184207){return new Promise(_0x3577a3=>{const _0x5bf8fb=_0x1efc;fetch(_0x184207)[_0x5bf8fb(0x140f)](_0xe588a3=>_0xe588a3[_0x5bf8fb(0xa5d)]()['catch'](()=>_0xe588a3[_0x5bf8fb(0x13ca)]()))[_0x5bf8fb(0x140f)](_0x3577a3)[_0x5bf8fb(0x904)](()=>_0x3577a3(null));});});async function _0x165507(_0x513397){return await Http_Get_External(_0x513397);}function _0x86e872(_0x15f323){return new Promise(_0x5ea5c3=>{const _0x174a21=_0x1efc,_0x3092eb=new Audio();_0x3092eb[_0x174a21(0x954)](_0x174a21(0x78c),()=>_0x5ea5c3(!![]),{'once':!![]}),_0x3092eb[_0x174a21(0x954)](_0x174a21(0x3b7),()=>_0x5ea5c3(![]),{'once':!![]}),_0x3092eb['src']=_0x15f323;});}async function _0x35a236(_0x209c47,_0x48906e){const _0x5ceb5d=_0x48bc6d;try{let _0x25a7b6=_0x209c47[_0x5ceb5d(0x1bb)](/\s/g,'');_0x48906e&&(_0x25a7b6+='\x20'+_0x48906e[_0x5ceb5d(0x1bb)](/\s/g,''));const _0x271c14='https://api.vkeys.cn/v2/music/netease?word='+encodeURIComponent(_0x25a7b6);console[_0x5ceb5d(0xe4d)](_0x5ceb5d(0x8b4),_0x271c14);const _0x3ea44c=await fetch(_0x271c14);if(!_0x3ea44c['ok'])throw new Error('API\x20请求失败，状态码:\x20'+_0x3ea44c['status']);const _0xcc40c6=await _0x3ea44c[_0x5ceb5d(0xa5d)]();if(_0xcc40c6[_0x5ceb5d(0x1551)]!==0xc8||!_0xcc40c6['data']||_0xcc40c6[_0x5ceb5d(0x38c)]['length']===0x0)return console[_0x5ceb5d(0xe4d)](_0x5ceb5d(0x862),_0xcc40c6),[];return _0xcc40c6[_0x5ceb5d(0x38c)]['map'](_0x200442=>({'name':_0x200442[_0x5ceb5d(0xd46)],'artist':_0x200442[_0x5ceb5d(0x6fa)],'id':_0x200442['id'],'cover':_0x200442[_0x5ceb5d(0x159e)]||_0x5ceb5d(0x533),'source':'netease'}))[_0x5ceb5d(0x457)](0x0,0x1e);}catch(_0x2f9fae){return console[_0x5ceb5d(0x3b7)](_0x5ceb5d(0x743),_0x2f9fae),[];}}async function _0x368f7b(_0x4b1868){const _0x24e71f=_0x48bc6d;try{_0x4b1868=_0x4b1868[_0x24e71f(0x1bb)](/\s/g,'');const _0x3e143a=await _0x165507(_0x24e71f(0xacb)+encodeURIComponent(_0x4b1868));if(!_0x3e143a?.[_0x24e71f(0x38c)]?.[_0x24e71f(0x106b)])return[];return _0x3e143a[_0x24e71f(0x38c)][_0x24e71f(0xb0a)](_0xeb105=>({'name':_0xeb105['song'],'artist':_0xeb105[_0x24e71f(0x6fa)],'id':_0xeb105['id'],'cover':_0xeb105[_0x24e71f(0x159e)]||_0x24e71f(0x1b8),'source':_0x24e71f(0xfe7)}))['slice'](0x0,0x1e);}catch(_0x468b93){return console[_0x24e71f(0x3b7)](_0x24e71f(0x10f0),_0x468b93),[];}}async function _0x33b445(){const _0x4ddbba=_0x48bc6d,_0x31b101=await _0x3ab788(_0x4ddbba(0x13d2),_0x4ddbba(0xb53));if(!_0x31b101||!_0x31b101['trim']())return;await _0x403a62(_0x4ddbba(0x1395),_0x4ddbba(0x497));let _0x137d4b=_0x31b101[_0x4ddbba(0x13f9)](),_0x3fdb66='';if(_0x31b101[_0x4ddbba(0x478)]('-')||_0x31b101[_0x4ddbba(0x478)]('–')){const _0x3d1476=_0x31b101[_0x4ddbba(0x1536)](/[-–]/);_0x137d4b=_0x3d1476[0x0][_0x4ddbba(0x13f9)](),_0x3fdb66=_0x3d1476[_0x4ddbba(0x457)](0x1)['join']('\x20')[_0x4ddbba(0x13f9)]();}const [_0x3d319c,_0x1e1402]=await Promise[_0x4ddbba(0xbf1)]([_0x35a236(_0x137d4b,_0x3fdb66),_0x368f7b(_0x137d4b)]),_0x51aeec=[..._0x3d319c,..._0x1e1402];if(_0x51aeec['length']===0x0){await _0x403a62(_0x4ddbba(0x7ca),_0x4ddbba(0x555));return;}const _0x46d2fb=document['getElementById'](_0x4ddbba(0x2e5)),_0x230b58=document['getElementById'](_0x4ddbba(0x11db));_0x230b58[_0x4ddbba(0xeb2)]='',document[_0x4ddbba(0x9a3)]('select-all-music-search')['checked']=![],_0x51aeec[_0x4ddbba(0x15c1)](_0x2faa8a=>{const _0x3fc10b=_0x4ddbba,_0x442600=document[_0x3fc10b(0xe94)](_0x3fc10b(0x8ca));_0x442600[_0x3fc10b(0x1487)]='search-result-item',_0x442600['dataset'][_0x3fc10b(0x658)]=JSON[_0x3fc10b(0xe1e)](_0x2faa8a),_0x442600[_0x3fc10b(0xeb2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22music-search-checkbox\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22search-result-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x2faa8a[_0x3fc10b(0x1561)]+_0x3fc10b(0x548)+_0x2faa8a[_0x3fc10b(0xf6d)]+'\x20<span\x20class=\x22source\x22>'+(_0x2faa8a[_0x3fc10b(0x98c)]===_0x3fc10b(0x29b)?_0x3fc10b(0x150e):_0x3fc10b(0x15a4))+_0x3fc10b(0xe5f),_0x230b58[_0x3fc10b(0x983)](_0x442600);}),_0x46d2fb['classList'][_0x4ddbba(0xe05)](_0x4ddbba(0xc09));}async function _0xc892ac(_0x1b903e){const _0x4a805d=_0x48bc6d;let _0x3d86a4=null,_0x3d27df=_0x1b903e[_0x4a805d(0x98c)];const _0x31006d=_0x1b903e[_0x4a805d(0x98c)]==='netease'?_0x4a805d(0x3d8)+_0x1b903e['id']:_0x4a805d(0x695)+_0x1b903e['id'];let _0x5dd7f3=await _0x165507(_0x31006d);_0x5dd7f3?.[_0x4a805d(0x38c)]?.['url']&&(_0x3d86a4={'url':_0x5dd7f3[_0x4a805d(0x38c)][_0x4a805d(0x121f)],'id':_0x1b903e['id'],'source':_0x1b903e['source']});if(!_0x3d86a4){const _0x49b483=_0x1b903e['source']===_0x4a805d(0x29b)?_0x4a805d(0xfe7):_0x4a805d(0x29b),_0x108777=_0x49b483===_0x4a805d(0xfe7)?await _0x368f7b(_0x1b903e[_0x4a805d(0x1561)]):await _0x35a236(_0x1b903e['name'],_0x1b903e[_0x4a805d(0xf6d)]);if(_0x108777[_0x4a805d(0x106b)]>0x0){const _0x4fc087=_0x49b483===_0x4a805d(0x29b)?_0x4a805d(0x3d8)+_0x108777[0x0]['id']:_0x4a805d(0x695)+_0x108777[0x0]['id'],_0x1a57ba=await _0x165507(_0x4fc087);_0x1a57ba?.[_0x4a805d(0x38c)]?.[_0x4a805d(0x121f)]&&(_0x3d86a4={'url':_0x1a57ba['data'][_0x4a805d(0x121f)],'id':_0x108777[0x0]['id'],'source':_0x49b483},_0x3d27df=_0x49b483);}}if(_0x3d86a4){_0x3d86a4[_0x4a805d(0x121f)]&&typeof _0x3d86a4[_0x4a805d(0x121f)]==='string'&&(_0x3d86a4[_0x4a805d(0x121f)]=_0x3d86a4[_0x4a805d(0x121f)][_0x4a805d(0x1bb)](/^http:\/\//i,_0x4a805d(0xf77)));_0x1b903e['cover']&&typeof _0x1b903e[_0x4a805d(0x159e)]===_0x4a805d(0x86c)&&(_0x1b903e[_0x4a805d(0x159e)]=_0x1b903e[_0x4a805d(0x159e)][_0x4a805d(0x1bb)](/^http:\/\//i,_0x4a805d(0xf77)));const _0x4f4915=await _0xb518d4(_0x3d86a4['id'],_0x3d27df)||'';return{'name':_0x1b903e['name'],'artist':_0x1b903e[_0x4a805d(0xf6d)],'src':_0x3d86a4[_0x4a805d(0x121f)],'cover':_0x1b903e[_0x4a805d(0x159e)],'isLocal':![],'lrcContent':_0x4f4915};}return null;}async function _0xb518d4(_0x3edfb5,_0x667c2){const _0x127efd=_0x48bc6d,_0x1b6616=_0x667c2==='netease'?_0x127efd(0x8e1)+_0x3edfb5:'https://api.vkeys.cn/v2/music/tencent/lyric?id='+_0x3edfb5,_0x4716ff=await _0x165507(_0x1b6616);if(_0x4716ff?.['data']){const _0x1e93a4=_0x4716ff[_0x127efd(0x38c)][_0x127efd(0x1257)]||_0x4716ff[_0x127efd(0x38c)][_0x127efd(0x8cc)]||'',_0x41058d=_0x4716ff['data'][_0x127efd(0xc97)]||_0x4716ff[_0x127efd(0x38c)]['tlyric']||'';return _0x1e93a4+'\x0a'+_0x41058d;}return'';}async function _0xfb1ee7(_0x3a215e){const _0xca78ca=_0x48bc6d;if(_0x3a215e<0x0||_0x3a215e>=_0x4e0631[_0xca78ca(0x496)]['length'])return;const _0x17b56d=await _0x49acac('选择歌词导入方式',[{'text':'📁\x20从本地文件\x20(.lrc)','value':_0xca78ca(0x1243)},{'text':_0xca78ca(0x613),'value':_0xca78ca(0x1083)}]);let _0x22312b=null;if(_0x17b56d===_0xca78ca(0x1243))_0x22312b=await new Promise(_0x6f80=>{const _0xffae04=_0xca78ca,_0x1ed6a9=document[_0xffae04(0x9a3)](_0xffae04(0x286)),_0x1e4ffa=_0x522729=>{const _0x120ea6=_0xffae04,_0x45edc3=_0x522729['target'][_0x120ea6(0x104e)][0x0];if(_0x45edc3){const _0x48cbec=new FileReader();_0x48cbec['onload']=_0x218966=>_0x6f80(_0x218966[_0x120ea6(0xa41)][_0x120ea6(0x5c9)]),_0x48cbec[_0x120ea6(0xb8b)]=()=>_0x6f80(null),_0x48cbec[_0x120ea6(0x1394)](_0x45edc3);}else _0x6f80(null);_0x1ed6a9[_0x120ea6(0xd7f)](_0x120ea6(0xbbc),_0x1e4ffa),_0x1ed6a9[_0x120ea6(0x7b2)]='';};_0x1ed6a9[_0xffae04(0x954)](_0xffae04(0xbbc),_0x1e4ffa,{'once':!![]}),_0x1ed6a9[_0xffae04(0x9cc)]();});else{if(_0x17b56d===_0xca78ca(0x1083)){const _0x5a0e1e=await _0x3ab788('粘贴歌词',_0xca78ca(0x8d5),'','textarea');if(_0x5a0e1e)_0x22312b=_0x5a0e1e[_0xca78ca(0x1bb)](/\[/g,'\x0a[')['trim']();}}_0x22312b!==null&&(_0x4e0631[_0xca78ca(0x496)][_0x3a215e]['lrcContent']=_0x22312b,await _0x21cadb(),_0x4e0631[_0xca78ca(0xfe2)]===_0x3a215e&&(_0x4e0631['parsedLyrics']=_0x7a1175(_0x22312b),_0x21bd0e(),_0x5e92e9()),await _0x403a62('成功','《'+_0x4e0631['playlist'][_0x3a215e][_0xca78ca(0x1561)]+_0xca78ca(0x4c3)));}async function _0x1c5f2e(){const _0x2ecdcf=_0x48bc6d;if(_0x4e0631['currentIndex']===-0x1)return;const _0x1dd7d5=_0x4e0631[_0x2ecdcf(0x496)][_0x4e0631['currentIndex']];if(!_0x1dd7d5)return;_0x1dd7d5[_0x2ecdcf(0x12d2)]=!_0x1dd7d5['isBgClear'],await _0x21cadb();const _0x3bac9f=document[_0x2ecdcf(0xc86)](_0x2ecdcf(0x26d)),_0x1e315f=document[_0x2ecdcf(0x9a3)](_0x2ecdcf(0x94a));_0x3bac9f['classList'][_0x2ecdcf(0xc02)]('bg-clear',_0x1dd7d5[_0x2ecdcf(0x12d2)]),_0x1e315f[_0x2ecdcf(0x4d8)][_0x2ecdcf(0xc02)](_0x2ecdcf(0xe9f),_0x1dd7d5['isBgClear']);}function _0x50153b(){const _0x3c1092=_0x48bc6d,_0x29af41=document[_0x3c1092(0x9a3)](_0x3c1092(0x1299)),_0x101a54=document[_0x3c1092(0x9a3)]('show-avatars-btn');_0x29af41&&_0x101a54&&(_0x29af41[_0x3c1092(0x4d8)]['toggle']('visible'),_0x101a54[_0x3c1092(0x4d8)][_0x3c1092(0xc02)]('active'));}function _0xe3aaea(){const _0x482d41=_0x48bc6d,_0x445c39=document[_0x482d41(0xc86)](_0x482d41(0x26d)),_0x57168a=document[_0x482d41(0x9a3)](_0x482d41(0x1167));_0x445c39&&_0x57168a&&(_0x445c39[_0x482d41(0x4d8)][_0x482d41(0xc02)](_0x482d41(0xbb8)),_0x57168a[_0x482d41(0x4d8)][_0x482d41(0xc02)]('fullscreen-active'));}window[_0x48bc6d(0x11f7)]=_0xe3aaea;async function _0x9ce26a(){const _0x5ac70a=_0x48bc6d;if(_0x4e0631['playlist'][_0x5ac70a(0x106b)]===0x0){alert(_0x5ac70a(0xbd3));return;}const _0x320bf5=await _0x2c9509('确认清理无效歌曲？',_0x5ac70a(0x15ac),{'confirmText':_0x5ac70a(0x149c)});if(!_0x320bf5)return;await _0x403a62(_0x5ac70a(0x1395),'正在检查\x20'+_0x4e0631[_0x5ac70a(0x496)]['length']+'\x20首歌曲，这可能需要一些时间...');const _0x55cefb=_0x4e0631[_0x5ac70a(0x496)][_0x5ac70a(0x106b)],_0x1a5743=[],_0x594f73=[],_0xf22c37=_0x4e0631[_0x5ac70a(0x496)][_0x5ac70a(0xb0a)](async _0x11d19b=>{const _0x4b12b3=_0x5ac70a;if(_0x11d19b[_0x4b12b3(0x1460)]){_0x1a5743[_0x4b12b3(0x1c4)](_0x11d19b);return;}const _0x419568=await _0x86e872(_0x11d19b[_0x4b12b3(0x10d4)]);_0x419568?_0x1a5743[_0x4b12b3(0x1c4)](_0x11d19b):(_0x594f73[_0x4b12b3(0x1c4)](_0x11d19b[_0x4b12b3(0x1561)]),console[_0x4b12b3(0x651)](_0x4b12b3(0x43f)+_0x11d19b[_0x4b12b3(0x1561)]+_0x4b12b3(0x1452)+_0x11d19b[_0x4b12b3(0x10d4)]));});await Promise[_0x5ac70a(0xbf1)](_0xf22c37);const _0x28c314=_0x55cefb-_0x1a5743[_0x5ac70a(0x106b)];if(_0x28c314>0x0){const _0x1bbffb=_0x4e0631[_0x5ac70a(0x496)][_0x4e0631['currentIndex']],_0x316a0=_0x594f73['includes'](_0x1bbffb?.[_0x5ac70a(0x1561)]);_0x4e0631[_0x5ac70a(0x496)]=_0x1a5743,await _0x21cadb();if(_0x316a0)_0x4a7bb9[_0x5ac70a(0x201)](),_0x4a7bb9[_0x5ac70a(0x10d4)]='',_0x4e0631[_0x5ac70a(0xfe2)]=_0x4e0631['playlist'][_0x5ac70a(0x106b)]>0x0?0x0:-0x1,_0x4e0631[_0x5ac70a(0xce1)]=![];else _0x1bbffb&&(_0x4e0631[_0x5ac70a(0xfe2)]=_0x4e0631[_0x5ac70a(0x496)]['findIndex'](_0x2d45b9=>_0x2d45b9['src']===_0x1bbffb['src']));_0x28db92(),_0x321261(),await _0x403a62(_0x5ac70a(0x115f),_0x5ac70a(0x19a)+_0x28c314+_0x5ac70a(0x1161)+_0x594f73[_0x5ac70a(0x3b9)](_0x5ac70a(0x1002)));}else await _0x403a62('检查完成',_0x5ac70a(0xcc3));}function _0x154868(){const _0x2b99e3=_0x48bc6d,_0x163af4=document['getElementById'](_0x2b99e3(0xae7));_0x163af4[_0x2b99e3(0x4d8)][_0x2b99e3(0xc02)](_0x2b99e3(0x10e6),!!_0x19ddb8[_0x2b99e3(0x4c8)][_0x2b99e3(0x63b)]);}async function _0x1d8566(){const _0x5d29d3=_0x48bc6d,_0xe86e39=document[_0x5d29d3(0x9a3)](_0x5d29d3(0x23b)),_0x504b87=document[_0x5d29d3(0x9a3)](_0x5d29d3(0x1295));_0x504b87['innerHTML']='';const _0x1f9fde=[];_0x1f9fde[_0x5d29d3(0x1c4)]({'text':_0x5d29d3(0x12bf),'value':_0x5d29d3(0xbf1),'isDanger':!![]});const _0x33096e=_0x19ddb8[_0x5d29d3(0x9ce)][_0x5d29d3(0x246)]||'我';_0x1f9fde[_0x5d29d3(0x1c4)]({'text':_0x5d29d3(0x5b6)+_0x33096e+_0x5d29d3(0x4ef),'value':'user'}),Object[_0x5d29d3(0xea1)](_0x19ddb8[_0x5d29d3(0xb04)])[_0x5d29d3(0x15c1)](_0x26d13d=>{const _0x165503=_0x5d29d3;!_0x26d13d[_0x165503(0x136b)]&&_0x1f9fde['push']({'text':_0x165503(0x5b6)+_0x26d13d[_0x165503(0x1561)]+_0x165503(0x1550),'value':_0x26d13d['id']});});try{const _0x52cfb6=await _0x512070[_0x5d29d3(0x5b7)][_0x5d29d3(0x591)]();_0x52cfb6['length']>0x0&&(_0x1f9fde[_0x5d29d3(0x1c4)]({'isSeparator':!![],'text':_0x5d29d3(0x4e4)}),_0x52cfb6[_0x5d29d3(0x15c1)](_0x23401c=>{const _0x5564d1=_0x5d29d3;_0x1f9fde[_0x5564d1(0x1c4)]({'text':'仅清空\x20'+_0x23401c[_0x5564d1(0x1561)]+_0x5564d1(0x949),'value':_0x5564d1(0x136f)+_0x23401c['id']});}));}catch(_0x121568){console[_0x5d29d3(0x3b7)](_0x5d29d3(0x661),_0x121568);}_0x1f9fde[_0x5d29d3(0x15c1)](_0x5b9981=>{const _0x2c2bcf=_0x5d29d3;if(_0x5b9981[_0x2c2bcf(0xa15)]){const _0x468952=document['createElement'](_0x2c2bcf(0x8ca));_0x468952['textContent']=_0x5b9981['text'],_0x468952[_0x2c2bcf(0x20f)][_0x2c2bcf(0x6c0)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2018px\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2013px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#f0f2f5;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-top:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-top:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x504b87['appendChild'](_0x468952);return;}const _0x39ebbe=document['createElement']('div');_0x39ebbe[_0x2c2bcf(0x1487)]='clear-posts-item',_0x5b9981[_0x2c2bcf(0x98e)]&&_0x39ebbe[_0x2c2bcf(0x4d8)][_0x2c2bcf(0xe05)]('danger-option'),_0x39ebbe['dataset'][_0x2c2bcf(0xb06)]=_0x5b9981[_0x2c2bcf(0x7b2)],_0x39ebbe['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x5b9981['text']+_0x2c2bcf(0x110c),_0x504b87[_0x2c2bcf(0x983)](_0x39ebbe);}),_0xe86e39['classList'][_0x5d29d3(0xe05)]('visible');}async function _0x3899c3(){const _0x51b716=_0x48bc6d,_0x14ee6c=document['querySelectorAll'](_0x51b716(0x56e));if(_0x14ee6c[_0x51b716(0x106b)]===0x0){alert(_0x51b716(0xcf7));return;}const _0x4c18d3=Array[_0x51b716(0x1311)](_0x14ee6c)[_0x51b716(0xb0a)](_0x358b3a=>_0x358b3a[_0x51b716(0xd8d)]['targetId']);let _0x51cd1a=[];_0x4c18d3[_0x51b716(0x478)]('all')?_0x51cd1a[_0x51b716(0x1c4)](_0x51b716(0x11bb)):(_0x4c18d3[_0x51b716(0x478)](_0x51b716(0x20d))&&_0x51cd1a[_0x51b716(0x1c4)]('“'+_0x19ddb8[_0x51b716(0x9ce)][_0x51b716(0x246)]+'”'),_0x4c18d3[_0x51b716(0x15c1)](_0x2fa990=>{const _0x3e58c0=_0x51b716,_0x42e862=_0x19ddb8[_0x3e58c0(0xb04)][_0x2fa990];_0x42e862&&_0x51cd1a[_0x3e58c0(0x1c4)]('“'+_0x42e862[_0x3e58c0(0x1561)]+'”');}));const _0x157b14=_0x51b716(0x63f)+_0x51cd1a[_0x51b716(0x3b9)]('、\x20')+_0x51b716(0xdb0),_0x4b24b5=await _0x2c9509(_0x51b716(0x13c5),_0x157b14,{'confirmButtonClass':_0x51b716(0xf5b),'confirmText':_0x51b716(0x479)});if(!_0x4b24b5)return;try{_0x4c18d3[_0x51b716(0x478)](_0x51b716(0xbf1))?await _0x512070['qzonePosts'][_0x51b716(0xe81)]():await _0x512070[_0x51b716(0x10e5)][_0x51b716(0x1201)](_0x51b716(0x82c))[_0x51b716(0xd26)](_0x4c18d3)[_0x51b716(0x10a8)](),_0x1f6575=await _0x512070[_0x51b716(0x10e5)]['orderBy'](_0x51b716(0xd73))[_0x51b716(0x333)]()[_0x51b716(0x591)](),_0x373876=0x0,await _0x49acff(),document[_0x51b716(0x9a3)](_0x51b716(0x23b))[_0x51b716(0x4d8)][_0x51b716(0x133d)](_0x51b716(0xc09)),await _0x403a62(_0x51b716(0x432),_0x51b716(0x153d));}catch(_0x1ecad9){console[_0x51b716(0x3b7)](_0x51b716(0xfd0),_0x1ecad9),await _0x403a62(_0x51b716(0x13bd),_0x51b716(0x3ac)+_0x1ecad9[_0x51b716(0xcce)]);}}async function _0x41db68(_0x134b2f){const _0x5803da=_0x48bc6d,_0x570b0f=await _0x2c9509(_0x5803da(0xd05),_0x5803da(0x1009),{'confirmButtonClass':'btn-danger','confirmText':'确认删除'});if(_0x570b0f){const _0x3c5f92=_0x19ddb8[_0x5803da(0xb04)][_0x19ddb8[_0x5803da(0x859)]];if(!_0x3c5f92||!_0x3c5f92[_0x5803da(0xd4a)])return;const _0x31efba=_0x3c5f92[_0x5803da(0xd4a)]['findIndex'](_0x50945a=>_0x50945a[_0x5803da(0xd73)]===_0x134b2f);if(_0x31efba===-0x1)return;const _0x277d4c=_0x31efba===_0x3c5f92[_0x5803da(0xd4a)][_0x5803da(0x106b)]-0x1;_0x3c5f92[_0x5803da(0xd4a)]=_0x3c5f92[_0x5803da(0xd4a)][_0x5803da(0x1195)](_0x4c9b8e=>_0x4c9b8e[_0x5803da(0xd73)]!==_0x134b2f);if(_0x277d4c){if(_0x3c5f92[_0x5803da(0xd4a)][_0x5803da(0x106b)]>0x0){const _0x2788f2=_0x3c5f92['thoughtsHistory'][_0x3c5f92[_0x5803da(0xd4a)]['length']-0x1];_0x3c5f92[_0x5803da(0x390)]=_0x2788f2[_0x5803da(0x390)],_0x3c5f92['randomJottings']=_0x2788f2[_0x5803da(0x69b)];const _0x31010d=document[_0x5803da(0x9a3)](_0x5803da(0xaf9)),_0x3ca672=document['getElementById'](_0x5803da(0x9ac));if(_0x31010d)_0x31010d['textContent']=_0x3c5f92[_0x5803da(0x390)];if(_0x3ca672)_0x3ca672[_0x5803da(0x766)]=_0x3c5f92[_0x5803da(0x69b)];console['log'](_0x5803da(0x1a5));}else{_0x3c5f92[_0x5803da(0x390)]=_0x5803da(0x4a5),_0x3c5f92[_0x5803da(0x69b)]=_0x5803da(0x4a5);const _0x66eaef=document[_0x5803da(0x9a3)]('profile-heartfelt-voice'),_0x1dc7ca=document['getElementById'](_0x5803da(0x9ac));if(_0x66eaef)_0x66eaef[_0x5803da(0x766)]=_0x3c5f92['heartfeltVoice'];if(_0x1dc7ca)_0x1dc7ca[_0x5803da(0x766)]=_0x3c5f92['randomJottings'];console[_0x5803da(0xe4d)](_0x5803da(0xf00));}}await _0x512070[_0x5803da(0xb04)][_0x5803da(0xd4d)](_0x3c5f92),_0x2e5e9a(),await _0x403a62('成功',_0x5803da(0x737));}}document[_0x48bc6d(0x9a3)](_0x48bc6d(0x13e5))[_0x48bc6d(0x954)](_0x48bc6d(0x9cc),_0x2dc1ac=>{const _0x3d0103=_0x48bc6d,_0x222593=_0x2dc1ac['target'][_0x3d0103(0x94c)](_0x3d0103(0x11b2));if(_0x222593){const _0x52bbfd=parseInt(_0x222593['dataset'][_0x3d0103(0xd73)]);!isNaN(_0x52bbfd)&&_0x41db68(_0x52bbfd);}});async function _0xc4cdb5(){const _0x27d30d=_0x48bc6d,_0x1d0a38=document[_0x27d30d(0x9a3)](_0x27d30d(0x709));_0x1d0a38[_0x27d30d(0xeb2)]=_0x27d30d(0x4d7);const _0x45f7ec=await _0x512070[_0x27d30d(0xac9)]['where'](_0x27d30d(0x1508))[_0x27d30d(0x5df)](_0x27d30d(0x88e))[_0x27d30d(0x591)]();_0x45f7ec[_0x27d30d(0x15c1)](_0x12e74d=>{const _0x28c235=_0x27d30d,_0x58b15b=document['createElement'](_0x28c235(0x43a));_0x58b15b['value']=_0x12e74d['id'],_0x58b15b[_0x28c235(0x766)]=_0x12e74d['name'],_0x1d0a38[_0x28c235(0x983)](_0x58b15b);});}async function _0xd45ac(){const _0x1587ea=_0x48bc6d,_0x16e552=document[_0x1587ea(0x9a3)]('css-preset-select'),_0x25594e=parseInt(_0x16e552[_0x1587ea(0x7b2)]);if(isNaN(_0x25594e))return;const _0x24352a=await _0x512070[_0x1587ea(0xac9)][_0x1587ea(0x14ee)](_0x25594e);if(_0x24352a){const _0x108b60=document[_0x1587ea(0x9a3)]('global-css-input');_0x108b60[_0x1587ea(0x7b2)]=_0x24352a[_0x1587ea(0x7b2)],_0x15e853(_0x24352a[_0x1587ea(0x7b2)]);}}async function _0x36d39f(){const _0x3f88c3=_0x48bc6d,_0x8afbaa=await _0x3ab788(_0x3f88c3(0xc24),_0x3f88c3(0xfe9));if(!_0x8afbaa||!_0x8afbaa[_0x3f88c3(0x13f9)]())return;const _0x20cb3c=document[_0x3f88c3(0x9a3)](_0x3f88c3(0x543))['value'],_0x7877f=await _0x512070['appearancePresets'][_0x3f88c3(0x1201)]({'name':_0x8afbaa[_0x3f88c3(0x13f9)](),'type':_0x3f88c3(0x88e)})[_0x3f88c3(0x92c)]();if(_0x7877f){const _0x4ba766=await _0x2c9509(_0x3f88c3(0xabc),_0x3f88c3(0x4e0)+_0x8afbaa[_0x3f88c3(0x13f9)]()+'”\x20的预设已存在。要覆盖它吗？',{'confirmButtonClass':_0x3f88c3(0xf5b)});if(!_0x4ba766)return;await _0x512070['appearancePresets'][_0x3f88c3(0xe33)](_0x7877f['id'],{'value':_0x20cb3c});}else await _0x512070[_0x3f88c3(0xac9)][_0x3f88c3(0xe05)]({'name':_0x8afbaa[_0x3f88c3(0x13f9)](),'type':_0x3f88c3(0x88e),'value':_0x20cb3c});await _0xc4cdb5(),alert(_0x3f88c3(0x15db));}async function _0x100c74(){const _0x18a140=_0x48bc6d,_0x5eb40f=document['getElementById'](_0x18a140(0x709)),_0x41db10=parseInt(_0x5eb40f[_0x18a140(0x7b2)]);if(isNaN(_0x41db10)){alert(_0x18a140(0xee6));return;}const _0x48c737=await _0x512070['appearancePresets'][_0x18a140(0x14ee)](_0x41db10);if(!_0x48c737)return;const _0x4c0561=await _0x2c9509(_0x18a140(0x1208),'确定要删除预设\x20“'+_0x48c737[_0x18a140(0x1561)]+_0x18a140(0x7a0),{'confirmButtonClass':_0x18a140(0xf5b)});_0x4c0561&&(await _0x512070[_0x18a140(0xac9)][_0x18a140(0x10a8)](_0x41db10),await _0xc4cdb5(),alert(_0x18a140(0x1061)));}async function _0x23ca7e(){const _0x4fc4f9=_0x48bc6d,_0x1c85b1=document[_0x4fc4f9(0x9a3)]('font-preset-select');_0x1c85b1['innerHTML']='<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>';const _0x3fd8f2=await _0x512070[_0x4fc4f9(0xac9)][_0x4fc4f9(0x1201)](_0x4fc4f9(0x1508))['equals'](_0x4fc4f9(0x46e))[_0x4fc4f9(0x591)]();_0x3fd8f2[_0x4fc4f9(0x15c1)](_0x4f080e=>{const _0x281e16=_0x4fc4f9,_0x30900b=document['createElement'](_0x281e16(0x43a));_0x30900b[_0x281e16(0x7b2)]=_0x4f080e['id'],_0x30900b[_0x281e16(0x766)]=_0x4f080e[_0x281e16(0x1561)],_0x1c85b1[_0x281e16(0x983)](_0x30900b);});}async function _0x4b0805(){const _0x1777a6=_0x48bc6d,_0x4e4636=document[_0x1777a6(0x9a3)](_0x1777a6(0x180)),_0x384587=parseInt(_0x4e4636[_0x1777a6(0x7b2)]);if(isNaN(_0x384587))return;const _0x5aad5e=await _0x512070[_0x1777a6(0xac9)][_0x1777a6(0x14ee)](_0x384587);if(_0x5aad5e){const _0x45cd86=document[_0x1777a6(0x9a3)](_0x1777a6(0x19e));_0x45cd86[_0x1777a6(0x7b2)]=_0x5aad5e[_0x1777a6(0x7b2)],_0x124e17(_0x5aad5e[_0x1777a6(0x7b2)],!![]);}}async function _0x242dc8(){const _0x34596d=_0x48bc6d,_0xae9779=await _0x3ab788(_0x34596d(0x503),_0x34596d(0xfe9));if(!_0xae9779||!_0xae9779[_0x34596d(0x13f9)]())return;const _0x4f13ff=document['getElementById']('font-url-input')['value'][_0x34596d(0x13f9)]();if(!_0x4f13ff){alert(_0x34596d(0xf2d));return;}const _0x30c7fc=await _0x512070[_0x34596d(0xac9)][_0x34596d(0x1201)]({'name':_0xae9779[_0x34596d(0x13f9)](),'type':_0x34596d(0x46e)})[_0x34596d(0x92c)]();if(_0x30c7fc){const _0x5e9fd1=await _0x2c9509('覆盖预设',_0x34596d(0x4e0)+_0xae9779[_0x34596d(0x13f9)]()+_0x34596d(0x5f9),{'confirmButtonClass':_0x34596d(0xf5b)});if(!_0x5e9fd1)return;await _0x512070[_0x34596d(0xac9)][_0x34596d(0xe33)](_0x30c7fc['id'],{'value':_0x4f13ff});}else await _0x512070[_0x34596d(0xac9)]['add']({'name':_0xae9779['trim'](),'type':_0x34596d(0x46e),'value':_0x4f13ff});await _0x23ca7e(),alert('字体预设已保存！');}async function _0x50c2ce(){const _0x23c3a7=_0x48bc6d,_0xae247a=document[_0x23c3a7(0x9a3)](_0x23c3a7(0x180)),_0x3734ca=parseInt(_0xae247a[_0x23c3a7(0x7b2)]);if(isNaN(_0x3734ca)){alert(_0x23c3a7(0xee6));return;}const _0x1ea7cc=await _0x512070[_0x23c3a7(0xac9)][_0x23c3a7(0x14ee)](_0x3734ca);if(!_0x1ea7cc)return;const _0x259dee=await _0x2c9509(_0x23c3a7(0x1208),_0x23c3a7(0x1481)+_0x1ea7cc[_0x23c3a7(0x1561)]+_0x23c3a7(0x7a0),{'confirmButtonClass':_0x23c3a7(0xf5b)});_0x259dee&&(await _0x512070[_0x23c3a7(0xac9)][_0x23c3a7(0x10a8)](_0x3734ca),await _0x23ca7e(),alert('预设已删除。'));}async function _0x10912a(){const _0x2060ec=_0x48bc6d,_0x5b1a1d=document[_0x2060ec(0x9a3)](_0x2060ec(0xf61));_0x5b1a1d[_0x2060ec(0xeb2)]=_0x2060ec(0x4d7);const _0x1b3f25=await _0x512070['appearancePresets'][_0x2060ec(0x1201)]('type')[_0x2060ec(0x5df)](_0x2060ec(0x123e))[_0x2060ec(0x591)]();_0x1b3f25[_0x2060ec(0x15c1)](_0x226304=>{const _0x473eef=_0x2060ec,_0x4b1ac6=document[_0x473eef(0xe94)]('option');_0x4b1ac6[_0x473eef(0x7b2)]=_0x226304['id'],_0x4b1ac6[_0x473eef(0x766)]=_0x226304[_0x473eef(0x1561)],_0x5b1a1d[_0x473eef(0x983)](_0x4b1ac6);});const _0x5daf2d={'wallpaper':_0x19ddb8[_0x2060ec(0x4c8)][_0x2060ec(0xa32)],'cphoneWallpaper':_0x19ddb8[_0x2060ec(0x4c8)][_0x2060ec(0x831)],'globalChatBackground':_0x19ddb8[_0x2060ec(0x4c8)][_0x2060ec(0x10c6)],'appIcons':_0x19ddb8[_0x2060ec(0x4c8)]['appIcons'],'cphoneAppIcons':_0x19ddb8[_0x2060ec(0x4c8)]['cphoneAppIcons'],'chatActionButtonsOrder':_0x19ddb8[_0x2060ec(0x4c8)]['chatActionButtonsOrder'],'theme':localStorage[_0x2060ec(0x5de)](_0x2060ec(0x136d))||'light','showStatusBar':_0x19ddb8['globalSettings'][_0x2060ec(0x63b)],'notificationSoundUrl':_0x19ddb8[_0x2060ec(0x4c8)][_0x2060ec(0x1437)],'widgetData':_0x19ddb8['globalSettings'][_0x2060ec(0xdc1)]};let _0x4cebc6=null;for(const _0xa9b6c4 of _0x1b3f25){if(JSON[_0x2060ec(0xe1e)](_0xa9b6c4[_0x2060ec(0x7b2)])===JSON[_0x2060ec(0xe1e)](_0x5daf2d)){_0x4cebc6=_0xa9b6c4['id'];break;}}_0x4cebc6?_0x5b1a1d[_0x2060ec(0x7b2)]=_0x4cebc6:_0x5b1a1d[_0x2060ec(0x7b2)]='';}async function _0xa247d1(){const _0x4ea73b=_0x48bc6d,_0x5e75ce=document[_0x4ea73b(0x9a3)](_0x4ea73b(0xf61)),_0x342ce2=parseInt(_0x5e75ce[_0x4ea73b(0x7b2)]);if(isNaN(_0x342ce2))return;const _0xd4f300=await _0x512070['appearancePresets'][_0x4ea73b(0x14ee)](_0x342ce2);if(_0xd4f300&&_0xd4f300['value']){const _0x43a82d=_0xd4f300[_0x4ea73b(0x7b2)];Object[_0x4ea73b(0x8aa)](_0x19ddb8[_0x4ea73b(0x4c8)],_0x43a82d),_0x16496f(_0x43a82d[_0x4ea73b(0x910)]||_0x4ea73b(0x155a)),await _0x512070[_0x4ea73b(0x4c8)][_0x4ea73b(0xd4d)](_0x19ddb8[_0x4ea73b(0x4c8)]),_0x28dc10(),_0x1b6cea(),_0xe2a513(),_0x2c06c4(),_0x154868(),_0x537b6a(),_0x21e3fb(),alert(_0x4ea73b(0x2c3)+_0xd4f300[_0x4ea73b(0x1561)]+'”');}}async function _0x7c040b(){const _0x1b2a69=_0x48bc6d,_0x130e49=await _0x3ab788(_0x1b2a69(0x2e4),_0x1b2a69(0xfe9));if(!_0x130e49||!_0x130e49[_0x1b2a69(0x13f9)]())return;const _0x1c07e0={'wallpaper':_0x19ddb8[_0x1b2a69(0x4c8)]['wallpaper'],'cphoneWallpaper':_0x19ddb8[_0x1b2a69(0x4c8)][_0x1b2a69(0x831)],'globalChatBackground':_0x19ddb8[_0x1b2a69(0x4c8)]['globalChatBackground'],'appIcons':_0x19ddb8[_0x1b2a69(0x4c8)][_0x1b2a69(0xbb4)],'cphoneAppIcons':_0x19ddb8[_0x1b2a69(0x4c8)][_0x1b2a69(0xa4e)],'chatActionButtonsOrder':_0x19ddb8['globalSettings'][_0x1b2a69(0x288)],'theme':localStorage[_0x1b2a69(0x5de)](_0x1b2a69(0x136d))||_0x1b2a69(0x155a),'showStatusBar':_0x19ddb8[_0x1b2a69(0x4c8)][_0x1b2a69(0x63b)],'notificationSoundUrl':_0x19ddb8[_0x1b2a69(0x4c8)][_0x1b2a69(0x1437)],'widgetData':_0x19ddb8['globalSettings'][_0x1b2a69(0xdc1)]},_0xf7a61a=await _0x512070[_0x1b2a69(0xac9)][_0x1b2a69(0x1201)]({'name':_0x130e49['trim'](),'type':'appearance'})[_0x1b2a69(0x92c)]();if(_0xf7a61a){const _0xa38366=await _0x2c9509(_0x1b2a69(0xabc),'名为\x20“'+_0x130e49['trim']()+_0x1b2a69(0x5f9),{'confirmButtonClass':_0x1b2a69(0xf5b)});if(!_0xa38366)return;await _0x512070[_0x1b2a69(0xac9)][_0x1b2a69(0xe33)](_0xf7a61a['id'],{'value':_0x1c07e0});}else await _0x512070[_0x1b2a69(0xac9)][_0x1b2a69(0xe05)]({'name':_0x130e49[_0x1b2a69(0x13f9)](),'type':_0x1b2a69(0x123e),'value':_0x1c07e0});await _0x10912a(),alert('外观预设已保存！');}async function _0x272c0c(){const _0x3a79a8=_0x48bc6d,_0x566daf=document[_0x3a79a8(0x9a3)]('appearance-preset-select'),_0x42640c=parseInt(_0x566daf[_0x3a79a8(0x7b2)]);if(isNaN(_0x42640c)){alert(_0x3a79a8(0xee6));return;}const _0x39c734=await _0x512070['appearancePresets']['get'](_0x42640c);if(!_0x39c734)return;const _0x26ee3d=await _0x2c9509(_0x3a79a8(0x1208),_0x3a79a8(0x1481)+_0x39c734[_0x3a79a8(0x1561)]+_0x3a79a8(0x7a0),{'confirmButtonClass':_0x3a79a8(0xf5b)});_0x26ee3d&&(await _0x512070[_0x3a79a8(0xac9)]['delete'](_0x42640c),await _0x10912a(),alert(_0x3a79a8(0x1061)));}async function _0x294e9d(){const _0x1f5204=_0x48bc6d,_0x2e277a=document[_0x1f5204(0x9a3)](_0x1f5204(0x9a1));_0x2e277a[_0x1f5204(0xeb2)]=_0x1f5204(0x4d7);const _0x464b20=await _0x512070[_0x1f5204(0xac9)][_0x1f5204(0x1201)](_0x1f5204(0x1508))['equals']('bubble_theme')[_0x1f5204(0x591)]();_0x464b20[_0x1f5204(0x15c1)](_0x14dc6e=>{const _0x26f0c5=_0x1f5204,_0x5306ad=document[_0x26f0c5(0xe94)](_0x26f0c5(0x43a));_0x5306ad[_0x26f0c5(0x7b2)]=_0x14dc6e['id'],_0x5306ad[_0x26f0c5(0x766)]=_0x14dc6e[_0x26f0c5(0x1561)],_0x2e277a[_0x26f0c5(0x983)](_0x5306ad);});}async function _0x274524(){const _0x32bad8=_0x48bc6d,_0x52386b=document[_0x32bad8(0x9a3)](_0x32bad8(0x9a1)),_0x4af113=parseInt(_0x52386b[_0x32bad8(0x7b2)]);if(isNaN(_0x4af113))return;const _0x584056=await _0x512070['appearancePresets'][_0x32bad8(0x14ee)](_0x4af113);if(_0x584056){const _0x50ba41=_0x584056[_0x32bad8(0x7b2)]['base']||'default',_0x1a6f5d=_0x584056[_0x32bad8(0x7b2)][_0x32bad8(0xbe4)]||'',_0x5b8c79=document[_0x32bad8(0xc86)](_0x32bad8(0x10d2)+_0x50ba41+'\x22]');_0x5b8c79&&(_0x5b8c79[_0x32bad8(0x944)]=!![]);const _0x5405f4=document[_0x32bad8(0x9a3)](_0x32bad8(0x750));_0x5405f4[_0x32bad8(0x7b2)]=_0x1a6f5d,_0x2628c1();}}async function _0x4b66f0(){const _0x347aad=_0x48bc6d,_0x245513=await _0x3ab788('保存主题预设',_0x347aad(0xfe9));if(!_0x245513||!_0x245513[_0x347aad(0x13f9)]())return;const _0x523453=document[_0x347aad(0xc86)](_0x347aad(0x9f1)),_0x118c02=_0x523453?_0x523453['value']:'default',_0x429c44=document['getElementById']('custom-css-input')[_0x347aad(0x7b2)][_0x347aad(0x13f9)](),_0x4fdef3={'base':_0x118c02,'custom':_0x429c44},_0xd8fe1a=await _0x512070[_0x347aad(0xac9)][_0x347aad(0x1201)]({'name':_0x245513[_0x347aad(0x13f9)](),'type':'bubble_theme'})['first']();if(_0xd8fe1a){const _0x2fcd97=await _0x2c9509(_0x347aad(0xabc),'名为\x20“'+_0x245513['trim']()+_0x347aad(0x5f9),{'confirmButtonClass':_0x347aad(0xf5b)});if(!_0x2fcd97)return;await _0x512070[_0x347aad(0xac9)][_0x347aad(0xe33)](_0xd8fe1a['id'],{'value':_0x4fdef3});}else await _0x512070[_0x347aad(0xac9)]['add']({'name':_0x245513[_0x347aad(0x13f9)](),'type':_0x347aad(0x644),'value':_0x4fdef3});await _0x294e9d(),alert(_0x347aad(0xadd));}async function _0x365833(){const _0x5d56c8=_0x48bc6d,_0x5b40a8=document[_0x5d56c8(0x9a3)]('theme-preset-select'),_0x26deaf=parseInt(_0x5b40a8['value']);if(isNaN(_0x26deaf)){alert(_0x5d56c8(0xee6));return;}const _0x45e1d8=await _0x512070[_0x5d56c8(0xac9)][_0x5d56c8(0x14ee)](_0x26deaf);if(!_0x45e1d8)return;const _0xb093d4=await _0x2c9509('删除预设','确定要删除预设\x20“'+_0x45e1d8[_0x5d56c8(0x1561)]+_0x5d56c8(0x7a0),{'confirmButtonClass':_0x5d56c8(0xf5b)});_0xb093d4&&(await _0x512070[_0x5d56c8(0xac9)][_0x5d56c8(0x10a8)](_0x26deaf),await _0x294e9d(),alert('预设已删除。'));}async function _0x1f9e4f(){const _0x171dd4=_0x48bc6d;await _0x430447(),document['getElementById']('sticker-category-manager-modal')[_0x171dd4(0x4d8)][_0x171dd4(0xe05)]('visible');}async function _0x430447(){const _0x10e7be=_0x48bc6d,_0x526655=document[_0x10e7be(0x9a3)]('existing-sticker-categories-list'),_0x2cd6f6=await _0x512070[_0x10e7be(0x39d)][_0x10e7be(0x591)]();_0x526655[_0x10e7be(0xeb2)]='';if(_0x2cd6f6[_0x10e7be(0x106b)]===0x0){_0x526655[_0x10e7be(0xeb2)]='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>';return;}_0x2cd6f6[_0x10e7be(0x15c1)](_0x3bea14=>{const _0x1824cf=_0x10e7be,_0x9359d7=document[_0x1824cf(0xe94)](_0x1824cf(0x8ca));_0x9359d7[_0x1824cf(0x1487)]=_0x1824cf(0x3bb),_0x9359d7['innerHTML']=_0x1824cf(0x1515)+_0x3bea14[_0x1824cf(0x1561)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0x3bea14['id']+_0x1824cf(0xd2e),_0x526655[_0x1824cf(0x983)](_0x9359d7);});}async function _0xa567f3(){const _0x50f676=_0x48bc6d,_0x1f583c=document[_0x50f676(0x9a3)](_0x50f676(0x1397)),_0xcde785=_0x1f583c[_0x50f676(0x7b2)][_0x50f676(0x13f9)]();if(!_0xcde785){alert(_0x50f676(0x1081));return;}const _0x54e898=await _0x512070[_0x50f676(0x39d)][_0x50f676(0x1201)](_0x50f676(0x1561))['equals'](_0xcde785)[_0x50f676(0x92c)]();if(_0x54e898){alert(_0x50f676(0xd10)+_0xcde785+_0x50f676(0x60a));return;}await _0x512070[_0x50f676(0x39d)][_0x50f676(0xe05)]({'name':_0xcde785}),_0x1f583c[_0x50f676(0x7b2)]='',await _0x430447();}async function _0x10ee93(_0x87a34f){const _0x17799c=_0x48bc6d,_0x565a51=await _0x512070[_0x17799c(0x39d)][_0x17799c(0x14ee)](_0x87a34f);if(!_0x565a51)return;const _0x13e56c=await _0x512070[_0x17799c(0x1557)]['where'](_0x17799c(0x922))[_0x17799c(0x5df)](_0x87a34f)[_0x17799c(0x3a9)](),_0x5bcc9f=_0x13e56c>0x0?_0x17799c(0x1a7)+_0x565a51['name']+_0x17799c(0x670)+_0x13e56c+_0x17799c(0x666):_0x17799c(0x1a7)+_0x565a51['name']+'》吗？',_0x32bdb5=await _0x2c9509(_0x17799c(0x66e),_0x5bcc9f,{'confirmButtonClass':_0x17799c(0xf5b)});if(_0x32bdb5)try{await _0x512070[_0x17799c(0x1072)]('rw',_0x512070['stickerCategories'],_0x512070[_0x17799c(0x1557)],async()=>{const _0x390c6c=_0x17799c,_0x1c3660=await _0x512070[_0x390c6c(0x1557)][_0x390c6c(0x1201)](_0x390c6c(0x922))['equals'](_0x87a34f)[_0x390c6c(0x1137)]();_0x1c3660['length']>0x0&&await _0x512070[_0x390c6c(0x1557)][_0x390c6c(0x25c)](_0x1c3660),await _0x512070['stickerCategories']['delete'](_0x87a34f);}),_0x19ddb8['userStickers']=await _0x512070[_0x17799c(0x1557)][_0x17799c(0x591)](),_0x507d02===_0x87a34f&&(_0x507d02=_0x17799c(0xbf1)),await _0x430447(),await _0x5a49be(),alert('分类《'+_0x565a51[_0x17799c(0x1561)]+'》及其下的表情已成功删除。');}catch(_0x11f38e){console['error'](_0x17799c(0x657),_0x11f38e),alert(_0x17799c(0x6ee));}}function _0x50f83f(_0x5c5f55){const _0x2b0e5c=_0x48bc6d;_0x507d02=_0x5c5f55,document[_0x2b0e5c(0x131c)]('.sticker-category-tab')[_0x2b0e5c(0x15c1)](_0x3eaaba=>{const _0x31475c=_0x2b0e5c;_0x3eaaba[_0x31475c(0x4d8)][_0x31475c(0xc02)]('active',String(_0x3eaaba[_0x31475c(0xd8d)][_0x31475c(0x922)])===String(_0x5c5f55));}),_0x5a49be(![]);const _0x45effb=document[_0x2b0e5c(0x9a3)](_0x2b0e5c(0x749));if(_0x45effb)_0x45effb['checked']=![];}async function _0x5307b3(){const _0x1b6375=_0x48bc6d;if(!_0x19ddb8[_0x1b6375(0x859)])return;const _0x30cb45=_0x19ddb8[_0x1b6375(0xb04)][_0x19ddb8[_0x1b6375(0x859)]];if(!_0x30cb45)return;try{const _0x2a505b={'type':_0x1b6375(0x1292),'version':0x1,'chatData':_0x30cb45},_0x861641=new Blob([JSON[_0x1b6375(0xe1e)](_0x2a505b,null,0x2)],{'type':'application/json'}),_0x5d0445=URL[_0x1b6375(0xc56)](_0x861641),_0x2123cc=document[_0x1b6375(0xe94)]('a');_0x2123cc[_0x1b6375(0xe6b)]=_0x5d0445,_0x2123cc['download']=_0x1b6375(0x11bf)+_0x30cb45[_0x1b6375(0x1561)]+'-'+new Date()[_0x1b6375(0xccf)]()[_0x1b6375(0x1536)]('T')[0x0]+'.json',_0x2123cc[_0x1b6375(0x9cc)](),URL[_0x1b6375(0xb93)](_0x5d0445),await _0x403a62(_0x1b6375(0x1217),'与“'+_0x30cb45[_0x1b6375(0x1561)]+'”的聊天记录已成功导出！');}catch(_0x5bb050){console[_0x1b6375(0x3b7)]('导出单个聊天时出错:',_0x5bb050),await _0x403a62('导出失败',_0x1b6375(0x12e0)+_0x5bb050[_0x1b6375(0xcce)]);}}async function _0x488435(_0x2ce3c2){const _0x48055d=_0x48bc6d;if(!_0x2ce3c2||!_0x19ddb8[_0x48055d(0x859)])return;const _0x533062=_0x19ddb8[_0x48055d(0x859)],_0x3c5693=_0x19ddb8[_0x48055d(0xb04)][_0x533062];try{const _0x2ad5c1=await _0x2ce3c2[_0x48055d(0x13ca)](),_0x228106=JSON[_0x48055d(0x1447)](_0x2ad5c1);if(_0x228106['type']!=='EPhoneSingleChat'||!_0x228106[_0x48055d(0x4ed)])throw new Error(_0x48055d(0x7ce));const _0x53f304=await _0x2c9509(_0x48055d(0xfc1),_0x48055d(0xcec)+_0x3c5693[_0x48055d(0x1561)]+_0x48055d(0xe6f),{'confirmButtonClass':_0x48055d(0xf5b),'confirmText':_0x48055d(0x91c)});if(!_0x53f304)return;const _0x15a52e=_0x228106[_0x48055d(0x4ed)];_0x15a52e['id']=_0x533062,await _0x512070[_0x48055d(0xb04)][_0x48055d(0xd4d)](_0x15a52e),_0x19ddb8['chats'][_0x533062]=_0x15a52e,await _0x403a62(_0x48055d(0x90b),_0x48055d(0x153b)),_0x56abd7(_0x533062),_0xec8072(),document[_0x48055d(0x9a3)](_0x48055d(0x1417))['click']();}catch(_0x5b299c){console[_0x48055d(0x3b7)](_0x48055d(0xa78),_0x5b299c),await _0x403a62(_0x48055d(0x3e9),_0x48055d(0x10b2)+_0x5b299c[_0x48055d(0xcce)]);}}function _0x19f6e7(){const _0x67dd43=_0x48bc6d;_0x3cb9fa(),_0x35df44(_0x67dd43(0xa0a));}function _0x3cb9fa(){const _0xedd883=_0x48bc6d,_0x421e65=document['getElementById'](_0xedd883(0x130f));_0x421e65[_0xedd883(0xeb2)]='';const _0x3d8822=Object[_0xedd883(0xea1)](_0x19ddb8[_0xedd883(0xb04)])['filter'](_0x25408b=>!_0x25408b[_0xedd883(0x136b)]);if(_0x3d8822[_0xedd883(0x106b)]===0x0){_0x421e65[_0xedd883(0xeb2)]=_0xedd883(0x11cf);return;}_0x3d8822[_0xedd883(0x15c1)](_0xf7a959=>{const _0x502a57=_0xedd883,_0x4e85fd=document[_0x502a57(0xe94)](_0x502a57(0x8ca));_0x4e85fd[_0x502a57(0x1487)]=_0x502a57(0x17e),_0x4e85fd['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0xf7a959[_0x502a57(0x450)][_0x502a57(0x4fe)]||_0x4f81ff)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0xf7a959[_0x502a57(0x1561)]+_0x502a57(0x110c),_0x4e85fd[_0x502a57(0x954)](_0x502a57(0x9cc),()=>_0x4a272a(_0xf7a959['id'])),_0x421e65['appendChild'](_0x4e85fd);});}async function _0x4a272a(_0x15c9e7){const _0xceae16=_0x48bc6d;_0x5a727a=_0x15c9e7,console[_0xceae16(0xe4d)](_0xceae16(0x6a4)+_0x15c9e7+_0xceae16(0x32f)),_0x1b6cea(),_0x2c06c4(),_0x989313(),_0x35df44(_0xceae16(0x698));}function _0x202cda(){const _0x47abdb=_0x48bc6d;_0x5a727a=null,console[_0x47abdb(0xe4d)](_0x47abdb(0x14ba)),_0x35df44(_0x47abdb(0x663));}function _0x989313(){const _0x49b6e2=_0x48bc6d,_0x539fbd=new Date(),_0x1c9fb5=_0x539fbd[_0x49b6e2(0x7a2)](_0x49b6e2(0x15bc),{'hour':'2-digit','minute':_0x49b6e2(0x192)}),_0x501a92=_0x539fbd['toLocaleDateString'](_0x49b6e2(0x15bc),{'weekday':_0x49b6e2(0x9f8),'month':_0x49b6e2(0x9f8),'day':_0x49b6e2(0xc6a)});document[_0x49b6e2(0x9a3)]('char-main-time')[_0x49b6e2(0x766)]=_0x1c9fb5,document[_0x49b6e2(0x9a3)](_0x49b6e2(0xeaf))[_0x49b6e2(0x766)]=_0x501a92,_0x56e352(_0x49b6e2(0x676));}function _0x56e352(_0x5f857c){const _0x32bc81=_0x48bc6d;document[_0x32bc81(0x131c)](_0x32bc81(0xdca))[_0x32bc81(0x15c1)](_0x5f3a63=>_0x5f3a63['classList']['remove'](_0x32bc81(0xe9f))),document[_0x32bc81(0x9a3)](_0x5f857c)[_0x32bc81(0x4d8)]['add'](_0x32bc81(0xe9f));}window[_0x48bc6d(0xfdd)]=_0x56e352;async function _0x36df03(_0x5b850b){const _0x3b4961=_0x48bc6d;if(!_0x5a727a)return;const _0x1b7b3c=_0x19ddb8[_0x3b4961(0xb04)][_0x5a727a];await _0x379367(_0x5a727a,_0x5b850b);switch(_0x5b850b){case'qq':_0x277f5a(),_0x56e352(_0x3b4961(0x72b));break;case _0x3b4961(0x12cb):_0x21824d(),_0x56e352(_0x3b4961(0x12a1));break;case _0x3b4961(0x462):_0x1b1d7f(),_0x56e352(_0x3b4961(0xbe3));break;case'taobao':_0x59e056(),_0x56e352(_0x3b4961(0x1022));break;case _0x3b4961(0xbb6):_0x4aa620(),_0x56e352('char-memo-screen');break;case _0x3b4961(0xf3e):_0x5ecd6a(),_0x56e352('char-diary-screen');break;case _0x3b4961(0x2dd):_0x514e12(),_0x56e352(_0x3b4961(0x869));break;case _0x3b4961(0x520):_0x4e92ef(),_0x56e352(_0x3b4961(0x467));break;case _0x3b4961(0x50e):_0x1a62f4(),_0x56e352('char-usage-screen');break;}}async function _0x21824d(){const _0xdae414=_0x48bc6d,_0x42a0fc=document['getElementById'](_0xdae414(0x546));_0x42a0fc[_0xdae414(0xeb2)]='';if(!_0x5a727a)return;const _0x48f613=_0x19ddb8['chats'][_0x5a727a],_0x34a19d=_0x48f613['simulatedAlbum']||[];if(_0x34a19d[_0xdae414(0x106b)]===0x0){_0x42a0fc[_0xdae414(0xeb2)]=_0xdae414(0x2c4);return;}const _0x21d60a=_0xdae414(0x273);_0x34a19d['forEach'](_0x354ae8=>{const _0x22e1f1=_0xdae414,_0x17cc11=document[_0x22e1f1(0xe94)](_0x22e1f1(0x8ca));_0x17cc11[_0x22e1f1(0x1487)]=_0x22e1f1(0x14e0),_0x17cc11[_0x22e1f1(0xd8d)][_0x22e1f1(0x3ef)]=_0x354ae8[_0x22e1f1(0x3ef)],_0x42a0fc['appendChild'](_0x17cc11);if(_0x19ddb8[_0x22e1f1(0x4c8)][_0x22e1f1(0x853)]){_0x17cc11[_0x22e1f1(0x20f)][_0x22e1f1(0x87e)]=_0x22e1f1(0xaaa);const _0x43d668=/[^\x00-\x7F]/[_0x22e1f1(0xddf)](_0x354ae8['image_prompt']),_0x41a69a=_0x354ae8[_0x22e1f1(0xb95)]&&_0x354ae8[_0x22e1f1(0xb95)][_0x22e1f1(0x13f9)]()&&!_0x43d668,_0x17d9a7=_0x41a69a?_0x354ae8[_0x22e1f1(0xb95)]:_0x22e1f1(0x10d8),_0x91a142=_0x22e1f1(0x10a3)+encodeURIComponent(_0x17d9a7),_0x512307=new Image();_0x512307['onload']=function(){const _0x4aaa81=_0x22e1f1;_0x17cc11['style']['backgroundImage']=_0x4aaa81(0x55b)+this[_0x4aaa81(0x10d4)]+')';},_0x512307['onerror']=function(){const _0xccc5e6=_0x22e1f1;_0x17cc11[_0xccc5e6(0x20f)][_0xccc5e6(0x1090)]=_0xccc5e6(0x55b)+_0x21d60a+')';},_0x512307[_0x22e1f1(0x10d4)]=_0x91a142;}else{_0x17cc11[_0x22e1f1(0x20f)][_0x22e1f1(0x87e)]='#f0f2f5',_0x17cc11['style'][_0x22e1f1(0x102d)]=_0x22e1f1(0x1406);const _0x4d2010=document[_0x22e1f1(0xe94)]('p');_0x4d2010[_0x22e1f1(0x1487)]=_0x22e1f1(0x1100),_0x4d2010[_0x22e1f1(0x766)]=_0x354ae8[_0x22e1f1(0x3ef)]||'(这张照片没有描述)',_0x17cc11[_0x22e1f1(0x983)](_0x4d2010);}});}function _0x1b1d7f(){const _0x4bb8dc=_0x48bc6d,_0x2312ec=document[_0x4bb8dc(0x9a3)]('char-browser-history');_0x2312ec['innerHTML']='';if(!_0x5a727a)return;const _0x23161b=_0x19ddb8[_0x4bb8dc(0xb04)][_0x5a727a],_0x470570=[_0x23161b[_0x4bb8dc(0x1561)],'爱好','旅游','美食','新闻',..._0x23161b[_0x4bb8dc(0x450)]['aiPersona'][_0x4bb8dc(0x1536)](/，|。|\s/)[_0x4bb8dc(0x457)](0x0,0x5)],_0x1c69a8=['知乎',_0x4bb8dc(0xb8c),_0x4bb8dc(0x98f),'微博',_0x4bb8dc(0x818)];for(let _0x170f84=0x0;_0x170f84<0xf;_0x170f84++){const _0xfc9636=_0x470570[Math[_0x4bb8dc(0xd95)](Math[_0x4bb8dc(0xdcd)]()*_0x470570[_0x4bb8dc(0x106b)])],_0x4ef5f5=_0x1c69a8[Math['floor'](Math[_0x4bb8dc(0xdcd)]()*_0x1c69a8[_0x4bb8dc(0x106b)])],_0x229417=document[_0x4bb8dc(0xe94)](_0x4bb8dc(0x8ca));_0x229417[_0x4bb8dc(0x1487)]='char-browser-item',_0x229417[_0x4bb8dc(0xeb2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0xfc9636+_0x4bb8dc(0x1452)+_0x4ef5f5+_0x4bb8dc(0xdbb)+_0x4ef5f5[_0x4bb8dc(0x905)]()+_0x4bb8dc(0x8d7)+_0xfc9636+_0x4bb8dc(0xa8e),_0x2312ec[_0x4bb8dc(0x983)](_0x229417);}}function _0x59e056(){const _0x103012=_0x48bc6d,_0x2818e7=document[_0x103012(0x9a3)]('char-product-grid');_0x2818e7[_0x103012(0xeb2)]='';if(!_0x5a727a)return;const _0x431c1f=_0x19ddb8['chats'][_0x5a727a],_0x1d3c89=_0x431c1f[_0x103012(0x15a1)]?.[_0x103012(0xf3d)]||[];if(_0x1d3c89[_0x103012(0x106b)]===0x0){_0x2818e7['innerHTML']=_0x103012(0x91a);return;}_0x1d3c89[_0x103012(0x15c1)](_0x1a5161=>{const _0x111202=_0x103012,_0x369d3a=document[_0x111202(0xe94)]('div');_0x369d3a[_0x111202(0x1487)]=_0x111202(0x9ff),_0x369d3a[_0x111202(0xd8d)][_0x111202(0xfcf)]=_0x1a5161[_0x111202(0xfcf)];let _0x4ad605;if(_0x19ddb8[_0x111202(0x4c8)]['enableAiDrawing']){const _0x5778b8='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x1a5161[_0x111202(0xb95)]||_0x111202(0x6df));_0x4ad605='<img\x20src=\x22'+_0x5778b8+_0x111202(0x692);}else _0x4ad605=_0x111202(0x2bd)+(_0x1a5161[_0x111202(0xfcf)]||'(无购买理由)')+_0x111202(0xd3f);_0x369d3a['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4ad605+_0x111202(0xa5a)+_0x1a5161[_0x111202(0xd01)]+_0x111202(0x5ad)+(_0x1a5161['price']||0x0)[_0x111202(0x1322)](0x2)+_0x111202(0xfed)+_0x1a5161[_0x111202(0x27d)]+_0x111202(0xd45),_0x2818e7[_0x111202(0x983)](_0x369d3a);});}function _0x29d49c(){const _0x22c3ca=_0x48bc6d;_0x56e352(_0x22c3ca(0x676));}function _0x362470(){const _0x5f5547=_0x48bc6d,_0x300cc7=document['getElementById'](_0x5f5547(0x314));_0x300cc7[_0x5f5547(0xeb2)]='';if(!_0x5a727a)return;const _0x43d7c6=Object[_0x5f5547(0xea1)](_0x19ddb8[_0x5f5547(0xb04)])[_0x5f5547(0x1195)](_0x1cb1fc=>{const _0x8ee570=_0x5f5547;if(_0x1cb1fc['id']===_0x5a727a)return!![];if(_0x1cb1fc[_0x8ee570(0x136b)]&&_0x1cb1fc[_0x8ee570(0xcca)]['some'](_0x5ecd17=>_0x5ecd17['id']===_0x5a727a))return!![];return![];});_0x43d7c6['forEach'](_0x54c339=>{const _0x2605e4=_0x3007da(_0x54c339);_0x300cc7['appendChild'](_0x2605e4);});}async function _0x379367(_0x14fd39,_0x1e3fba){const _0x439e36=_0x48bc6d,_0x172a60=_0x19ddb8[_0x439e36(0xb04)][_0x14fd39];if(!_0x172a60)return;!_0x172a60['appUsageLog']&&(_0x172a60['appUsageLog']=[]),_0x172a60[_0x439e36(0x574)][_0x439e36(0x1c4)]({'appName':_0x1e3fba,'timestamp':Date[_0x439e36(0x64b)]()}),_0x172a60[_0x439e36(0x574)][_0x439e36(0x106b)]>0x32&&_0x172a60['appUsageLog'][_0x439e36(0x48d)](),await _0x512070['chats'][_0x439e36(0xd4d)](_0x172a60);}function _0x1a62f4(){const _0x484fd6=_0x48bc6d,_0x172a6f=document[_0x484fd6(0x9a3)]('char-usage-list');_0x172a6f['innerHTML']='';const _0x116322=_0x19ddb8[_0x484fd6(0xb04)][_0x5a727a],_0x10ef99=(_0x116322[_0x484fd6(0x574)]||[])[_0x484fd6(0x457)]()['reverse']();if(_0x10ef99['length']===0x0){_0x172a6f[_0x484fd6(0xeb2)]=_0x484fd6(0xb52);return;}const _0x286db2={'qq':'QQ','album':'相册','browser':_0x484fd6(0x213),'taobao':'淘宝','memo':_0x484fd6(0x1462),'diary':'日记','amap':_0x484fd6(0x720),'usage':_0x484fd6(0xaae)};_0x10ef99['forEach'](_0x2c5b39=>{const _0x5acaaa=_0x484fd6,_0x46ccf9=document[_0x5acaaa(0xe94)](_0x5acaaa(0x8ca));_0x46ccf9['className']=_0x5acaaa(0x884),_0x46ccf9[_0x5acaaa(0xeb2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timestamp\x22>'+new Date(_0x2c5b39[_0x5acaaa(0xd73)])[_0x5acaaa(0x12cf)]()+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22action\x22>打开了\x20<strong>'+(_0x286db2[_0x2c5b39[_0x5acaaa(0x11cd)]]||_0x2c5b39['appName'])+_0x5acaaa(0x6b7),_0x172a6f[_0x5acaaa(0x983)](_0x46ccf9);});}async function _0x4bf7a3(_0x19e19c){const _0x508ada=_0x48bc6d,_0x2c235b=_0x19ddb8['chats'][_0x5a727a];if(!_0x2c235b)return;const _0x32006b={'role':_0x508ada(0x115c),'senderName':_0x2c235b[_0x508ada(0x339)],'type':'location_share','content':_0x19e19c,'imageUrl':_0x508ada(0xc0d),'timestamp':Date['now']()};_0x2c235b[_0x508ada(0x1f0)][_0x508ada(0x1c4)](_0x32006b),await _0x512070[_0x508ada(0xb04)][_0x508ada(0xd4d)](_0x2c235b),_0x19ddb8[_0x508ada(0x859)]===_0x5a727a&&_0x1ef393(_0x32006b,_0x2c235b),await _0x403a62('分享成功','“'+_0x2c235b[_0x508ada(0x1561)]+_0x508ada(0x46d));}async function _0x323ae8(_0x2146d7){const _0x47f2cf=_0x48bc6d,_0x16cdbd=_0x19ddb8[_0x47f2cf(0xb04)][_0x5a727a];if(!_0x16cdbd||!_0x16cdbd[_0x47f2cf(0xbc0)])return;const _0x23c2fb=_0x16cdbd[_0x47f2cf(0xbc0)]['find'](_0x1f02e3=>_0x1f02e3['id']===_0x2146d7);if(_0x23c2fb){_0xb7cdc=_0x23c2fb;const _0x11398a=document[_0x47f2cf(0x9a3)]('char-memo-detail-title'),_0x1bc31d=document[_0x47f2cf(0x9a3)](_0x47f2cf(0x11c7)),_0x3ffd58=document['getElementById'](_0x47f2cf(0x40e));if(_0x11398a)_0x11398a[_0x47f2cf(0x766)]=_0x23c2fb['title'];if(_0x1bc31d)_0x1bc31d[_0x47f2cf(0x7b2)]=_0x23c2fb[_0x47f2cf(0x4e3)];const _0x61b3ae=await _0x512070[_0x47f2cf(0x73d)][_0x47f2cf(0x1201)]({'type':_0x47f2cf(0x14d3),'content.id':_0x2146d7})['first']();_0x3ffd58[_0x47f2cf(0x4d8)]['toggle'](_0x47f2cf(0xe9f),!!_0x61b3ae),_0x56e352(_0x47f2cf(0x511));}}function _0x4aa620(){const _0x2edeff=_0x48bc6d,_0x1f0978=document[_0x2edeff(0x9a3)]('char-memo-list');_0x1f0978[_0x2edeff(0xeb2)]='';const _0x5b15d9=_0x19ddb8[_0x2edeff(0xb04)][_0x5a727a],_0x4ce712=(_0x5b15d9['memos']||[])[_0x2edeff(0x457)]()['reverse']();if(_0x4ce712[_0x2edeff(0x106b)]===0x0){_0x1f0978[_0x2edeff(0xeb2)]=_0x2edeff(0xac4);return;}_0x4ce712[_0x2edeff(0x15c1)](_0x17c044=>{const _0x49f0a8=_0x2edeff,_0x2e70c9=document[_0x49f0a8(0xe94)](_0x49f0a8(0x8ca));_0x2e70c9[_0x49f0a8(0x1487)]=_0x49f0a8(0x9ab),_0x2e70c9[_0x49f0a8(0xeb2)]=_0x49f0a8(0x1542)+_0x17c044[_0x49f0a8(0x10b8)]+_0x49f0a8(0x7e0)+(_0x17c044[_0x49f0a8(0x4e3)]||'')[_0x49f0a8(0x1536)]('\x0a')[0x0]+_0x49f0a8(0xa8e),_0x2e70c9[_0x49f0a8(0x954)]('click',()=>_0x323ae8(_0x17c044['id'])),_0x1a651b(_0x2e70c9,()=>deleteMemo(_0x17c044['id'])),_0x1f0978[_0x49f0a8(0x983)](_0x2e70c9);});}async function _0x445d74(_0x37f95c=null){const _0x5edb6b=_0x48bc6d;_0x5638b7=null;const _0x4cc05c=await _0x3ab788('新建备忘录',_0x5edb6b(0x5d4));if(_0x4cc05c===null||!_0x4cc05c['trim']())return;const _0x54cc81=await _0x3ab788(_0x5edb6b(0x10b0)+_0x4cc05c,'请输入备忘录内容','',_0x5edb6b(0x8db));_0x54cc81!==null&&(await _0x4476db({'title':_0x4cc05c[_0x5edb6b(0x13f9)](),'content':_0x54cc81}),_0x56e352(_0x5edb6b(0xd94)));}async function _0x4476db(_0x26fbff){const _0xa7c36e=_0x48bc6d,_0x2b7944=_0x19ddb8[_0xa7c36e(0xb04)][_0x5a727a];if(!_0x2b7944[_0xa7c36e(0xbc0)])_0x2b7944[_0xa7c36e(0xbc0)]=[];_0x2b7944['memos'][_0xa7c36e(0x1c4)]({'id':Date[_0xa7c36e(0x64b)](),'title':_0x26fbff[_0xa7c36e(0x10b8)],'content':_0x26fbff['content']}),await _0x512070[_0xa7c36e(0xb04)][_0xa7c36e(0xd4d)](_0x2b7944),_0x4aa620();}async function _0x4476db(_0x5bacd3){const _0x5aa883=_0x48bc6d,_0xda6415=_0x19ddb8[_0x5aa883(0xb04)][_0x5a727a];if(!_0xda6415[_0x5aa883(0xbc0)])_0xda6415[_0x5aa883(0xbc0)]=[];if(_0x5638b7){const _0x2c6543=_0xda6415[_0x5aa883(0xbc0)][_0x5aa883(0xd62)](_0x44ae00=>_0x44ae00['id']===_0x5638b7);if(_0x2c6543)_0x2c6543[_0x5aa883(0x4e3)]=_0x5bacd3;}else _0xda6415[_0x5aa883(0xbc0)]['push']({'id':Date[_0x5aa883(0x64b)](),'content':_0x5bacd3});await _0x512070[_0x5aa883(0xb04)]['put'](_0xda6415),_0x4aa620(),_0x5638b7=null;}async function _0x352de9(){const _0x5e4ae5=_0x48bc6d;if(!_0x5a727a)return;const _0xa8a29d=_0x19ddb8[_0x5e4ae5(0xb04)][_0x5a727a];if(!_0xa8a29d)return;await _0x403a62('请稍候...',_0x5e4ae5(0x789)+_0xa8a29d['name']+_0x5e4ae5(0x3f1));const {proxyUrl:_0x110cac,apiKey:_0x569092,model:_0x5f5a41}=_0x19ddb8[_0x5e4ae5(0xd22)];if(!_0x110cac||!_0x569092||!_0x5f5a41){alert(_0x5e4ae5(0xff3));return;}const _0x25bbbd=_0x19ddb8[_0x5e4ae5(0x9ce)]['nickname']==='{{user}}'||!_0x19ddb8[_0x5e4ae5(0x9ce)][_0x5e4ae5(0x246)]?'用户':_0x19ddb8[_0x5e4ae5(0x9ce)][_0x5e4ae5(0x246)],_0x5e1906=_0xa8a29d[_0x5e4ae5(0x744)]&&_0xa8a29d[_0x5e4ae5(0x744)]['length']>0x0?_0xa8a29d[_0x5e4ae5(0x744)][_0x5e4ae5(0xb0a)](_0x4c26c9=>_0x5e4ae5(0x2ee)+_0x5d6abc(_0x4c26c9[_0x5e4ae5(0xd73)])+')\x20'+_0x4c26c9[_0x5e4ae5(0x4e3)])[_0x5e4ae5(0x3b9)]('\x0a'):'无',_0x356c6f=_0xa8a29d['settings'][_0x5e4ae5(0x152f)]||0xa,_0x439cee=_0xa8a29d[_0x5e4ae5(0x1f0)][_0x5e4ae5(0x457)](-_0x356c6f)['map'](_0xd9bf1a=>(_0xd9bf1a['role']==='user'?_0x25bbbd:_0xa8a29d[_0x5e4ae5(0x1561)])+':\x20'+String(_0xd9bf1a['content'])[_0x5e4ae5(0x72e)](0x0,0x1e)+_0x5e4ae5(0x4a5))[_0x5e4ae5(0x3b9)]('\x0a'),_0x476361=(_0xa8a29d[_0x5e4ae5(0x450)][_0x5e4ae5(0x9c4)]||[])['map'](_0x4e01c9=>_0x19ddb8['worldBooks']['find'](_0x300021=>_0x300021['id']===_0x4e01c9))[_0x5e4ae5(0x1195)](Boolean)[_0x5e4ae5(0xb0a)](_0x56f5fb=>_0x5e4ae5(0x33b)+_0x56f5fb[_0x5e4ae5(0x1561)]+'》设定:\x0a'+_0x56f5fb[_0x5e4ae5(0x4e3)][_0x5e4ae5(0x1195)](_0x18573f=>_0x18573f[_0x5e4ae5(0x15cd)])[_0x5e4ae5(0xb0a)](_0x2c81dc=>'-\x20'+_0x2c81dc[_0x5e4ae5(0x4e3)])[_0x5e4ae5(0x3b9)]('\x0a'))['join'](''),_0x2de6a2=_0x54310e(_0xa8a29d,0x3,_0x5e4ae5(0xb41)),_0x1dd012=_0x54310e(_0xa8a29d,0x6,_0x5e4ae5(0xb41)),_0x156a8f=_0x54310e(_0xa8a29d,0x9,'hours'),_0x5cc4a8=_0x54310e(_0xa8a29d,0x1,_0x5e4ae5(0x113c)),_0x365109=_0x54310e(_0xa8a29d,0x3,_0x5e4ae5(0x113c)),_0x2b92d3=_0x54310e(_0xa8a29d,0x7,_0x5e4ae5(0x113c));let _0x19fcfe='';if(_0x2de6a2||_0x1dd012||_0x156a8f||_0x5cc4a8||_0x365109||_0x2b92d3){_0x19fcfe+=_0x5e4ae5(0x805);if(_0x2de6a2)_0x19fcfe+=_0x2de6a2;if(_0x1dd012)_0x19fcfe+=_0x1dd012;if(_0x156a8f)_0x19fcfe+=_0x156a8f;if(_0x2de6a2||_0x1dd012||_0x156a8f)_0x19fcfe+='\x0a';if(_0x5cc4a8)_0x19fcfe+=_0x5cc4a8;if(_0x365109)_0x19fcfe+=_0x365109;if(_0x2b92d3)_0x19fcfe+=_0x2b92d3;}const _0x22b2a4=_0xa8a29d['settings'][_0x5e4ae5(0x1e3)]||_0x5e4ae5(0x1318),_0x33df94=_0x5e4ae5(0x13ac)+_0xa8a29d[_0x5e4ae5(0x1561)]+_0x5e4ae5(0x1372)+new Date()[_0x5e4ae5(0x7fd)]('zh-CN')+_0x5e4ae5(0xc80)+_0x25bbbd+'”\x20来指代你的聊天对象（用户）。\x0a6.\x20\x20**【日记专属Markdown语法\x20(必须使用！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇\x20(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0xa8a29d[_0x5e4ae5(0x450)]['aiPersona']+'\x0a-\x20**你的聊天对象设定**:'+_0x22b2a4+'\x0a-\x20**你的长期记忆**:\x0a'+_0x5e1906+'\x0a'+_0x476361+'\x0a'+_0x19fcfe+_0x5e4ae5(0x11e3)+_0x25bbbd+_0x5e4ae5(0x218)+_0x439cee+_0x5e4ae5(0x8ee);try{const _0x3cc0d3=[{'role':_0x5e4ae5(0x20d),'content':_0x5e4ae5(0x319)}];let _0x4c693b=_0x110cac[_0x5e4ae5(0x478)]('generativelanguage'),_0x36e117=_0x366263(_0x5f5a41,_0x569092,_0x33df94,_0x3cc0d3);const _0x740b80=_0x4c693b?await fetch(_0x36e117[_0x5e4ae5(0x121f)],_0x36e117[_0x5e4ae5(0x38c)]):await fetch(_0x110cac+_0x5e4ae5(0x501),{'method':'POST','headers':{'Content-Type':_0x5e4ae5(0xb1f),'Authorization':_0x5e4ae5(0x1265)+_0x569092},'body':JSON[_0x5e4ae5(0xe1e)]({'model':_0x5f5a41,'messages':[{'role':_0x5e4ae5(0xe10),'content':_0x33df94},..._0x3cc0d3],'temperature':_0x19ddb8[_0x5e4ae5(0x4c8)]['apiTemperature']||0.95})});if(!_0x740b80['ok'])throw new Error(_0x5e4ae5(0x786)+_0x740b80[_0x5e4ae5(0x140e)]);const _0x21e9e4=await _0x740b80[_0x5e4ae5(0xa5d)](),_0x216b56=getGeminiResponseText(_0x21e9e4),_0x2f5172=_0x216b56[_0x5e4ae5(0x293)](/(\[[\s\S]*\])/);if(!_0x2f5172||!_0x2f5172[0x0])throw new Error(_0x5e4ae5(0x1178)+_0x216b56);const _0x3a5792=_0x2f5172[0x0];let _0x561c14;try{_0x561c14=JSON[_0x5e4ae5(0x1447)](_0x3a5792);}catch(_0x245b17){throw new Error(_0x5e4ae5(0x4bb)+_0x245b17[_0x5e4ae5(0xcce)]+_0x5e4ae5(0x8f2)+_0x216b56);}_0xa8a29d['diary']=_0x561c14['map'](_0x3e3a71=>({'id':Date[_0x5e4ae5(0x64b)]()+Math[_0x5e4ae5(0xdcd)](),'title':_0x3e3a71[_0x5e4ae5(0x10b8)],'content':_0x3e3a71['content'],'timestamp':Date[_0x5e4ae5(0x64b)]()})),await _0x512070[_0x5e4ae5(0xb04)][_0x5e4ae5(0xd4d)](_0xa8a29d),await _0x5ecd6a();}catch(_0x163d84){console[_0x5e4ae5(0x3b7)]('生成模拟日记失败:',_0x163d84),await _0x403a62(_0x5e4ae5(0x8e8),_0x5e4ae5(0x10a6)+_0x163d84[_0x5e4ae5(0xcce)]);}}async function _0xa0170e(){const _0x28e515=_0x48bc6d;if(!_0x5a727a)return;const _0x1b8271=_0x19ddb8[_0x28e515(0xb04)][_0x5a727a];if(!_0x1b8271)return;await _0x403a62(_0x28e515(0x1395),'正在请求“'+_0x1b8271[_0x28e515(0x1561)]+_0x28e515(0x411));const {proxyUrl:_0x3586b2,apiKey:_0x10bbe0,model:_0x5cfe11}=_0x19ddb8[_0x28e515(0xd22)];if(!_0x3586b2||!_0x10bbe0||!_0x5cfe11)return;const _0x515d3c=_0x19ddb8['qzoneSettings'][_0x28e515(0x246)]===_0x28e515(0x15c8)||!_0x19ddb8[_0x28e515(0x9ce)][_0x28e515(0x246)]?'用户':_0x19ddb8[_0x28e515(0x9ce)][_0x28e515(0x246)],_0x8a0057=_0x1b8271['longTermMemory']&&_0x1b8271[_0x28e515(0x744)]['length']>0x0?_0x1b8271[_0x28e515(0x744)]['map'](_0x470694=>_0x28e515(0x2ee)+_0x5d6abc(_0x470694[_0x28e515(0xd73)])+')\x20'+_0x470694['content'])[_0x28e515(0x3b9)]('\x0a'):'无',_0x54562b=_0x1b8271[_0x28e515(0x450)][_0x28e515(0x152f)]||0xa,_0x44a2f0=_0x1b8271['history'][_0x28e515(0x457)](-_0x54562b)[_0x28e515(0xb0a)](_0x425f9f=>(_0x425f9f[_0x28e515(0x11c1)]===_0x28e515(0x20d)?_0x515d3c:_0x1b8271[_0x28e515(0x1561)])+':\x20'+String(_0x425f9f[_0x28e515(0x4e3)])[_0x28e515(0x72e)](0x0,0x1e)+_0x28e515(0x4a5))[_0x28e515(0x3b9)]('\x0a'),_0x52305f=(_0x1b8271[_0x28e515(0x450)][_0x28e515(0x9c4)]||[])['map'](_0x47fc93=>_0x19ddb8[_0x28e515(0x8e4)][_0x28e515(0xd62)](_0x5bbf0c=>_0x5bbf0c['id']===_0x47fc93))[_0x28e515(0x1195)](Boolean)[_0x28e515(0xb0a)](_0x4aa8ba=>_0x28e515(0x33b)+_0x4aa8ba['name']+'》设定:\x0a'+_0x4aa8ba['content'][_0x28e515(0x1195)](_0x40643f=>_0x40643f[_0x28e515(0x15cd)])['map'](_0x337626=>'-\x20'+_0x337626['content'])[_0x28e515(0x3b9)]('\x0a'))[_0x28e515(0x3b9)](''),_0x47b545=_0x28e515(0x14eb)+_0x1b8271[_0x28e515(0x1561)]+_0x28e515(0xb32)+new Date()[_0x28e515(0x7fd)](_0x28e515(0x15bc))+_0x28e515(0x61a)+_0x1b8271[_0x28e515(0x450)]['aiPersona']+_0x28e515(0x3fe)+_0x8a0057+'\x0a'+_0x52305f+'\x0a-\x20**你最近和“'+_0x515d3c+_0x28e515(0x218)+_0x44a2f0+'\x0a\x0a现在，请开始撰写这篇充满真情实感、并熟练运用了Markdown语法的日记。';try{const _0x2af7de=[{'role':_0x28e515(0x20d),'content':'请根据你的设定，写一篇新日记。'}];let _0x19b94b=_0x3586b2['includes'](_0x28e515(0x1329)),_0x21a9ab=_0x366263(_0x5cfe11,_0x10bbe0,_0x47b545,_0x2af7de);const _0x4cecc5=_0x19b94b?await fetch(_0x21a9ab[_0x28e515(0x121f)],_0x21a9ab['data']):await fetch(_0x3586b2+_0x28e515(0x501),{'method':_0x28e515(0x12db),'headers':{'Content-Type':_0x28e515(0xb1f),'Authorization':_0x28e515(0x1265)+_0x10bbe0},'body':JSON[_0x28e515(0xe1e)]({'model':_0x5cfe11,'messages':[{'role':'system','content':_0x47b545},..._0x2af7de],'temperature':_0x19ddb8[_0x28e515(0x4c8)]['apiTemperature']||0.95})});if(!_0x4cecc5['ok'])throw new Error(_0x28e515(0x786)+_0x4cecc5['statusText']);const _0x5a0b61=await _0x4cecc5[_0x28e515(0xa5d)](),_0x4fa236=getGeminiResponseText(_0x5a0b61),_0x26c868=_0x4fa236[_0x28e515(0x293)](/(\[[\s\S]*\])/);if(!_0x26c868||!_0x26c868[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x4fa236);const _0x394a10=_0x26c868[0x0];let _0x19e1bc;try{_0x19e1bc=JSON['parse'](_0x394a10)[0x0];}catch(_0x3036ba){throw new Error(_0x28e515(0x4bb)+_0x3036ba[_0x28e515(0xcce)]+_0x28e515(0x8f2)+_0x4fa236);}if(!_0x1b8271[_0x28e515(0xf3e)])_0x1b8271['diary']=[];_0x1b8271['diary']['push']({'id':Date['now'](),'title':_0x19e1bc['title'],'content':_0x19e1bc[_0x28e515(0x4e3)],'timestamp':Date[_0x28e515(0x64b)]()}),await _0x512070['chats'][_0x28e515(0xd4d)](_0x1b8271),await _0x5ecd6a();}catch(_0x1610e3){console['error'](_0x28e515(0xee0),_0x1610e3),await _0x403a62(_0x28e515(0x8e8),_0x28e515(0xda1)+_0x1610e3[_0x28e515(0xcce)]);}}function _0x5ecd6a(){const _0x2633df=_0x48bc6d,_0x1c4ddc=document[_0x2633df(0x9a3)]('char-diary-list');_0x1c4ddc[_0x2633df(0xeb2)]='';const _0x53cf4b=_0x19ddb8['chats'][_0x5a727a],_0x443536=(_0x53cf4b['diary']||[])[_0x2633df(0x457)]()[_0x2633df(0x333)]();if(_0x443536[_0x2633df(0x106b)]===0x0){_0x1c4ddc['innerHTML']=_0x2633df(0x102b);return;}_0x443536[_0x2633df(0x15c1)](_0x35c38f=>{const _0x1f12f6=_0x2633df,_0x4d1842=document['createElement'](_0x1f12f6(0x8ca));_0x4d1842[_0x1f12f6(0x1487)]=_0x1f12f6(0x9ab),_0x4d1842[_0x1f12f6(0xeb2)]=_0x1f12f6(0xc88)+_0x35c38f['title']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>'+new Date(_0x35c38f[_0x1f12f6(0xd73)])[_0x1f12f6(0x7fd)]()+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4d1842[_0x1f12f6(0x954)](_0x1f12f6(0x9cc),()=>_0x2a8de7(_0x35c38f['id'])),_0x1a651b(_0x4d1842,()=>_0x259540(_0x35c38f['id'])),_0x1c4ddc[_0x1f12f6(0x983)](_0x4d1842);});}async function _0x2a8de7(_0x55c774){const _0x5c0573=_0x48bc6d,_0x38f5a1=_0x19ddb8[_0x5c0573(0xb04)][_0x5a727a];if(!_0x38f5a1||!_0x38f5a1[_0x5c0573(0xf3e)])return;const _0x25a75d=_0x38f5a1[_0x5c0573(0xf3e)][_0x5c0573(0xd62)](_0x545869=>_0x545869['id']===_0x55c774);if(_0x25a75d){_0x210b58=_0x25a75d;const _0x488474=document['getElementById'](_0x5c0573(0x1323)),_0x2c3bb7=document[_0x5c0573(0x9a3)](_0x5c0573(0x491)),_0x35688c=document[_0x5c0573(0x9a3)]('favorite-diary-btn');_0x488474[_0x5c0573(0x766)]=_0x25a75d[_0x5c0573(0x10b8)];const _0x4dc159=_0x49f635(_0x25a75d[_0x5c0573(0x4e3)])[_0x5c0573(0x1536)]('\x0a')['map'](_0x6e7700=>'<p>'+(_0x6e7700||_0x5c0573(0x5fa))+'</p>')[_0x5c0573(0x3b9)]('');_0x2c3bb7[_0x5c0573(0xeb2)]=_0x4dc159;const _0x584948=await _0x512070[_0x5c0573(0x73d)]['where']({'type':_0x5c0573(0x1139),'content.id':_0x55c774})[_0x5c0573(0x92c)]();_0x35688c[_0x5c0573(0x4d8)]['toggle'](_0x5c0573(0xe9f),!!_0x584948),_0x56e352(_0x5c0573(0xc74));}}async function _0x4e137d(){const _0x148db7=_0x48bc6d;if(!_0x210b58||!_0x5a727a)return;const _0x28100e=_0x210b58,_0x3722eb=_0x19ddb8[_0x148db7(0xb04)][_0x5a727a],_0x3c286=document[_0x148db7(0x9a3)](_0x148db7(0x1501)),_0x16fabf=await _0x512070[_0x148db7(0x73d)][_0x148db7(0x1201)]({'type':_0x148db7(0x1139),'content.id':_0x28100e['id']})[_0x148db7(0x92c)]();if(_0x16fabf)await _0x512070[_0x148db7(0x73d)][_0x148db7(0x10a8)](_0x16fabf['id']),_0x3c286[_0x148db7(0x4d8)][_0x148db7(0x133d)]('active'),await _0x403a62(_0x148db7(0x432),'已取消收藏。');else{const _0x2e33b3={'type':_0x148db7(0x1139),'content':{'id':_0x28100e['id'],'title':_0x28100e['title'],'content':_0x28100e[_0x148db7(0x4e3)],'timestamp':_0x28100e[_0x148db7(0xd73)],'characterId':_0x5a727a,'characterName':_0x3722eb[_0x148db7(0x1561)]},'timestamp':Date[_0x148db7(0x64b)]()};await _0x512070[_0x148db7(0x73d)][_0x148db7(0xe05)](_0x2e33b3),_0x3c286[_0x148db7(0x4d8)][_0x148db7(0xe05)](_0x148db7(0xe9f)),await _0x403a62(_0x148db7(0x432),_0x148db7(0x1cd));}}async function _0x209c0e(){const _0x161968=_0x48bc6d;if(!_0xb7cdc||!_0x5a727a)return;const _0x4a18d7=_0xb7cdc,_0x497b33=_0x19ddb8[_0x161968(0xb04)][_0x5a727a],_0x26da07=document['getElementById'](_0x161968(0x40e)),_0x5752fc=await _0x512070[_0x161968(0x73d)][_0x161968(0x1201)]({'type':_0x161968(0x14d3),'content.id':_0x4a18d7['id']})['first']();if(_0x5752fc)await _0x512070[_0x161968(0x73d)]['delete'](_0x5752fc['id']),_0x26da07[_0x161968(0x4d8)]['remove'](_0x161968(0xe9f)),await _0x403a62(_0x161968(0x432),_0x161968(0x891));else{const _0x148440={'type':_0x161968(0x14d3),'content':{'id':_0x4a18d7['id'],'title':_0x4a18d7[_0x161968(0x10b8)],'content':_0x4a18d7['content'],'timestamp':_0x4a18d7['timestamp'],'characterId':_0x5a727a,'characterName':_0x497b33['name']},'timestamp':Date[_0x161968(0x64b)]()};await _0x512070[_0x161968(0x73d)][_0x161968(0xe05)](_0x148440),_0x26da07[_0x161968(0x4d8)]['add'](_0x161968(0xe9f)),await _0x403a62('操作成功',_0x161968(0x1cd));}}async function _0x259540(_0x2b3045){const _0x2e50d2=_0x48bc6d,_0x2f0960=await _0x2c9509(_0x2e50d2(0x1213),_0x2e50d2(0x102e),{'confirmButtonClass':_0x2e50d2(0xf5b)});if(_0x2f0960){const _0x370df2=_0x19ddb8['chats'][_0x5a727a];_0x370df2[_0x2e50d2(0xf3e)]=_0x370df2[_0x2e50d2(0xf3e)][_0x2e50d2(0x1195)](_0x2172a9=>_0x2172a9['id']!==_0x2b3045),await _0x512070[_0x2e50d2(0xb04)][_0x2e50d2(0xd4d)](_0x370df2),_0x5ecd6a();}}async function _0x277f5a(){const _0x5c6e6f=_0x48bc6d,_0x3e37c1=document[_0x5c6e6f(0x9a3)](_0x5c6e6f(0x314));_0x3e37c1[_0x5c6e6f(0xeb2)]='';const _0x5bbde0=_0x19ddb8['chats'][_0x5a727a];if(!_0x5bbde0)return;const _0x68bd9e=_0x5bbde0[_0x5c6e6f(0x450)][_0x5c6e6f(0x1555)]||(_0x19ddb8['qzoneSettings'][_0x5c6e6f(0x246)]||'我'),_0x585382=_0x5bbde0[_0x5c6e6f(0x1f0)][_0x5c6e6f(0x1195)](_0x494cdb=>!_0x494cdb[_0x5c6e6f(0x136e)])[_0x5c6e6f(0x457)](-0x1)[0x0]||{'content':_0x5c6e6f(0x4a5)};let _0x57494d=_0x5c6e6f(0x4a5);if(_0x585382){if(typeof _0x585382[_0x5c6e6f(0x4e3)]==='string')_0x57494d=_0x585382['content'];else{if(Array[_0x5c6e6f(0xb9b)](_0x585382[_0x5c6e6f(0x4e3)])&&_0x585382[_0x5c6e6f(0x4e3)][0x0]?.[_0x5c6e6f(0x1508)]===_0x5c6e6f(0xae0))_0x57494d=_0x5c6e6f(0xed3);else{if(_0x585382[_0x5c6e6f(0x1508)]){const _0x2aa460={'voice_message':'[语音]','transfer':'[转账]','ai_image':_0x5c6e6f(0xed3)};_0x57494d=_0x2aa460[_0x585382[_0x5c6e6f(0x1508)]]||'['+_0x585382[_0x5c6e6f(0x1508)]+']';}}}}const _0x3383e3=_0x5bbde0[_0x5c6e6f(0x450)]['myAvatar']||_0x4f81ff,_0x55d853=_0x5bbde0[_0x5c6e6f(0x450)][_0x5c6e6f(0xb26)]||'';let _0x14edb2;_0x55d853?_0x14edb2=_0x5c6e6f(0xc15)+_0x3383e3+_0x5c6e6f(0x145a)+_0x55d853+_0x5c6e6f(0xf27):_0x14edb2=_0x5c6e6f(0xdac)+_0x3383e3+_0x5c6e6f(0x12b5);const _0x2d250d=document[_0x5c6e6f(0xe94)]('div');_0x2d250d[_0x5c6e6f(0x1487)]=_0x5c6e6f(0xba4),_0x2d250d[_0x5c6e6f(0xd8d)][_0x5c6e6f(0x12a9)]='-1',_0x2d250d[_0x5c6e6f(0xeb2)]=_0x5c6e6f(0x1560)+_0x14edb2+_0x5c6e6f(0x109d)+_0x68bd9e+_0x5c6e6f(0xd37)+String(_0x57494d)[_0x5c6e6f(0x72e)](0x0,0x14)+_0x5c6e6f(0x445),_0x3e37c1[_0x5c6e6f(0x983)](_0x2d250d);const _0x57eb23=await _0x512070[_0x5c6e6f(0x5b7)]['toArray'](),_0x5d4d41=new Map(_0x57eb23[_0x5c6e6f(0xb0a)](_0xd6dd8b=>[_0xd6dd8b['name'],_0xd6dd8b])),_0x4ad835=_0x5bbde0['simulatedConversations']||[];if(_0x4ad835['length']===0x0&&!_0x2d250d){_0x3e37c1['innerHTML']=_0x5c6e6f(0xdf4);return;}_0x4ad835[_0x5c6e6f(0x15c1)]((_0x17087f,_0x5b4830)=>{const _0x26d3dd=_0x5c6e6f;if(_0x17087f[_0x26d3dd(0x1508)]===_0x26d3dd(0x5f4))return;const _0x36a8c1=document['createElement'](_0x26d3dd(0x8ca));_0x36a8c1[_0x26d3dd(0x1487)]=_0x26d3dd(0xba4),_0x36a8c1[_0x26d3dd(0xd8d)]['conversationIndex']=_0x5b4830;let _0x6b3160,_0x3bddbe,_0xc531d2;if(_0x17087f['type']===_0x26d3dd(0xf67)){_0xc531d2=_0x17087f[_0x26d3dd(0xc91)]+_0x26d3dd(0x5ea),_0x6b3160=_0x17087f[_0x26d3dd(0x4f8)][_0x26d3dd(0x457)](-0x1)[0x0]||{'content':_0x26d3dd(0x4a5)};const _0xb8c123=_0x26d3dd(0xd5e)+_0x17087f[_0x26d3dd(0xc91)]+'\x27',_0x55b486=_0x19ddb8[_0x26d3dd(0x4c8)][_0x26d3dd(0x853)]?_0x26d3dd(0x10a3)+encodeURIComponent(_0xb8c123):_0xdb6252;_0x3bddbe=_0x26d3dd(0x2e8)+_0x55b486+_0x26d3dd(0x950);}else{_0xc531d2=_0x17087f[_0x26d3dd(0x4d1)]['name'],_0x6b3160=_0x17087f[_0x26d3dd(0x4f8)][_0x26d3dd(0x457)](-0x1)[0x0]||{'content':_0x26d3dd(0x4a5)};const _0x539bd7=_0x5d4d41[_0x26d3dd(0x14ee)](_0xc531d2);let _0x39a8a6=_0x539bd7&&_0x539bd7[_0x26d3dd(0xf3f)]?_0x539bd7['avatar']:_0x19ddb8[_0x26d3dd(0x4c8)][_0x26d3dd(0x853)]?'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x17087f[_0x26d3dd(0x4d1)][_0x26d3dd(0x13ef)]||_0x26d3dd(0xef2)):_0x451ae9;_0x3bddbe=_0x26d3dd(0x2e8)+_0x39a8a6+'\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>';}let _0x30a684=_0x26d3dd(0x4a5);_0x6b3160&&_0x6b3160['content']&&(_0x30a684=_0x6b3160[_0x26d3dd(0x4e3)]),_0x36a8c1[_0x26d3dd(0xeb2)]=_0x26d3dd(0x5e0)+_0x3bddbe+_0x26d3dd(0x5f6)+_0xc531d2+_0x26d3dd(0x151d)+String(_0x30a684)['substring'](0x0,0x14)+_0x26d3dd(0x1512),_0x3e37c1[_0x26d3dd(0x983)](_0x36a8c1);});}async function _0xf1ffd7(){const _0x5f1040=_0x48bc6d;if(!_0x5a727a)return;const _0xdd948f=_0x19ddb8[_0x5f1040(0xb04)][_0x5a727a];if(!_0xdd948f)return;await _0x403a62(_0x5f1040(0x1395),_0x5f1040(0x1533)+_0xdd948f['name']+_0x5f1040(0x1218));const {proxyUrl:_0x4a076a,apiKey:_0x342bee,model:_0x19d772}=_0x19ddb8['apiConfig'];if(!_0x4a076a||!_0x342bee||!_0x19d772){alert(_0x5f1040(0xff3));return;}const _0x23e435=await _0x512070[_0x5f1040(0x5b7)][_0x5f1040(0x591)](),_0x407e22=_0x23e435[_0x5f1040(0x1195)](_0x1ea6a2=>_0x1ea6a2[_0x5f1040(0xa3a)]&&_0x1ea6a2['associatedWith'][_0x5f1040(0x478)](_0x5a727a));let _0x29496b='#\x20你的社交圈\x20(绑定的NPC)\x0a';_0x407e22[_0x5f1040(0x106b)]>0x0?(_0x29496b+='这是你认识的、关系密切的NPC。在生成对话时，你应该【优先】与他们互动。\x0a',_0x407e22[_0x5f1040(0x15c1)](_0x5762ed=>{const _0x59eac0=_0x5f1040;_0x29496b+='-\x20**姓名**:\x20'+_0x5762ed[_0x59eac0(0x1561)]+_0x59eac0(0x2f8)+_0x5762ed[_0x59eac0(0xcd4)]+'\x0a';})):_0x29496b+=_0x5f1040(0x624);const _0x37a738=_0x19ddb8[_0x5f1040(0x9ce)][_0x5f1040(0x246)]===_0x5f1040(0x15c8)||!_0x19ddb8[_0x5f1040(0x9ce)]['nickname']?'用户':_0x19ddb8[_0x5f1040(0x9ce)][_0x5f1040(0x246)],_0x187fd4=_0xdd948f[_0x5f1040(0x450)][_0x5f1040(0x1555)]||_0x37a738,_0x25f667=_0xdd948f[_0x5f1040(0x744)]&&_0xdd948f[_0x5f1040(0x744)][_0x5f1040(0x106b)]>0x0?_0xdd948f[_0x5f1040(0x744)][_0x5f1040(0xb0a)](_0x287ed7=>_0x5f1040(0x2ee)+_0x5d6abc(_0x287ed7['timestamp'])+')\x20'+_0x287ed7[_0x5f1040(0x4e3)])[_0x5f1040(0x3b9)]('\x0a'):'无',_0x6bb18d=_0xdd948f[_0x5f1040(0x450)][_0x5f1040(0x152f)]||0xa,_0x3ea47c=_0xdd948f[_0x5f1040(0x1f0)][_0x5f1040(0x457)](-_0x6bb18d)[_0x5f1040(0xb0a)](_0x34ac65=>(_0x34ac65['role']===_0x5f1040(0x20d)?_0x187fd4:_0xdd948f[_0x5f1040(0x1561)])+':\x20'+String(_0x34ac65['content'])[_0x5f1040(0x72e)](0x0,0x1e)+_0x5f1040(0x4a5))[_0x5f1040(0x3b9)]('\x0a'),_0x2da93b=(_0xdd948f[_0x5f1040(0x450)][_0x5f1040(0x9c4)]||[])['map'](_0x384006=>_0x19ddb8[_0x5f1040(0x8e4)][_0x5f1040(0xd62)](_0x3bebbc=>_0x3bebbc['id']===_0x384006))['filter'](Boolean)[_0x5f1040(0xb0a)](_0xf8a63b=>_0x5f1040(0x33b)+_0xf8a63b[_0x5f1040(0x1561)]+'》设定\x20(你可以将其中角色作为聊天对象):\x0a'+_0xf8a63b[_0x5f1040(0x4e3)][_0x5f1040(0x1195)](_0x2ed7de=>_0x2ed7de[_0x5f1040(0x15cd)])[_0x5f1040(0xb0a)](_0x2cc738=>'-\x20'+_0x2cc738[_0x5f1040(0x4e3)])[_0x5f1040(0x3b9)]('\x0a'))[_0x5f1040(0x3b9)](''),_0x5098f3=_0xdd948f[_0x5f1040(0x339)]||_0xdd948f[_0x5f1040(0x1561)],_0x34c2b6=_0x50f06c(_0xdd948f),_0x2e56ff=_0x5f1040(0x54a)+_0xdd948f[_0x5f1040(0x1561)]+_0x5f1040(0x197)+_0x5098f3+_0x5f1040(0x1325)+_0x5098f3+_0x5f1040(0x13e0)+_0x5098f3+_0x5f1040(0x519)+_0xdd948f[_0x5f1040(0x450)]['aiPersona']+_0x5f1040(0x40f)+_0x25f667+_0x5f1040(0x14b3)+_0x2da93b+_0x5f1040(0xd2d)+_0x3ea47c+'\x0a'+_0x29496b+_0x5f1040(0x1052)+_0x34c2b6+_0x5f1040(0x94d);try{const _0x4f4e03=[{'role':_0x5f1040(0x20d),'content':'请根据你的设定，生成模拟聊天记录。'}];let _0x30784c=_0x4a076a['includes'](_0x5f1040(0x1329)),_0x164e26=_0x366263(_0x19d772,_0x342bee,_0x2e56ff,_0x4f4e03);const _0x5cc199=_0x30784c?await fetch(_0x164e26[_0x5f1040(0x121f)],_0x164e26[_0x5f1040(0x38c)]):await fetch(_0x4a076a+_0x5f1040(0x501),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x5f1040(0x1265)+_0x342bee},'body':JSON[_0x5f1040(0xe1e)]({'model':_0x19d772,'messages':[{'role':_0x5f1040(0xe10),'content':_0x2e56ff},..._0x4f4e03],'temperature':_0x19ddb8[_0x5f1040(0x4c8)][_0x5f1040(0x4a2)]||0.9})});if(!_0x5cc199['ok'])throw new Error(_0x5f1040(0x786)+_0x5cc199[_0x5f1040(0x140e)]);const _0x519aa=await _0x5cc199['json'](),_0x4fcccb=getGeminiResponseText(_0x519aa),_0x2b7352=_0x4fcccb[_0x5f1040(0x293)](/(\[[\s\S]*\])/);if(!_0x2b7352||!_0x2b7352[0x0])throw new Error(_0x5f1040(0x1178)+_0x4fcccb);const _0x9e910e=_0x2b7352[0x0];let _0x131089;try{_0x131089=JSON[_0x5f1040(0x1447)](_0x9e910e);}catch(_0x27bdcc){throw new Error('解析AI返回的JSON时出错:\x20'+_0x27bdcc[_0x5f1040(0xcce)]+_0x5f1040(0x8f2)+_0x4fcccb);}_0xdd948f[_0x5f1040(0x8ff)]=_0x131089,await _0x512070[_0x5f1040(0xb04)][_0x5f1040(0xd4d)](_0xdd948f),await _0x277f5a();const _0x5e10f3={'role':_0x5f1040(0xe10),'content':_0x5f1040(0xd80),'timestamp':Date[_0x5f1040(0x64b)](),'isHidden':!![]};_0xdd948f[_0x5f1040(0x1f0)][_0x5f1040(0x1c4)](_0x5e10f3),await _0x512070[_0x5f1040(0xb04)][_0x5f1040(0xd4d)](_0xdd948f),_0x55bf11();}catch(_0x4c90c0){console['error'](_0x5f1040(0x1569),_0x4c90c0),await _0x403a62(_0x5f1040(0x8e8),'无法生成模拟聊天记录，请检查API配置或稍后再试。\x0a错误:\x20'+_0x4c90c0[_0x5f1040(0xcce)]);}}async function _0x5d63a5(){const _0xf181ce=_0x48bc6d;if(!_0x5a727a)return;const _0x4a5fff=_0x19ddb8[_0xf181ce(0xb04)][_0x5a727a];if(!_0x4a5fff)return;try{const {proxyUrl:_0x5ce19d,apiKey:_0x3b6bfc,model:_0x57fa87}=_0x19ddb8[_0xf181ce(0xd22)];if(!_0x5ce19d||!_0x3b6bfc||!_0x57fa87)throw new Error(_0xf181ce(0x1193));const _0x50a25b=parseInt(_0x4a5fff[_0xf181ce(0x450)]['maxMemory'])||0xa,_0x277630=_0x4a5fff[_0xf181ce(0x1f0)][_0xf181ce(0x457)](-_0x50a25b),_0x2932d2=_0x4a5fff[_0xf181ce(0x450)][_0xf181ce(0x1555)]||'我',_0x122062=_0x4a5fff[_0xf181ce(0x450)]['myPersona']||'用户',_0x177fec=_0xf181ce(0xfae)+(_0x4a5fff[_0xf181ce(0x744)]&&_0x4a5fff[_0xf181ce(0x744)][_0xf181ce(0x106b)]>0x0?_0x4a5fff[_0xf181ce(0x744)][_0xf181ce(0xb0a)](_0x9dd7=>'-\x20'+_0x9dd7['content'])[_0xf181ce(0x3b9)]('\x0a'):_0xf181ce(0xc55));let _0x42b6bd='';if(_0x4a5fff['settings'][_0xf181ce(0x9c4)]&&_0x4a5fff[_0xf181ce(0x450)][_0xf181ce(0x9c4)][_0xf181ce(0x106b)]>0x0){const _0x2b5913=_0x4a5fff['settings'][_0xf181ce(0x9c4)][_0xf181ce(0xb0a)](_0x4d847d=>{const _0x58e48f=_0xf181ce,_0x3e8ca7=_0x19ddb8[_0x58e48f(0x8e4)][_0x58e48f(0xd62)](_0x386008=>_0x386008['id']===_0x4d847d);if(!_0x3e8ca7||!Array[_0x58e48f(0xb9b)](_0x3e8ca7['content']))return'';const _0x289e8a=_0x3e8ca7['content']['filter'](_0x5eb880=>_0x5eb880[_0x58e48f(0x15cd)]!==![])[_0x58e48f(0xb0a)](_0x1d76ff=>'\x0a###\x20条目:\x20'+(_0x1d76ff[_0x58e48f(0x79d)]||_0x58e48f(0xbcc))+_0x58e48f(0x65b)+_0x1d76ff[_0x58e48f(0x4e3)])[_0x58e48f(0x3b9)]('');return _0x289e8a?_0x58e48f(0xe9b)+_0x3e8ca7[_0x58e48f(0x1561)]+'\x0a'+_0x289e8a:'';})[_0xf181ce(0x1195)](Boolean)['join']('');_0x2b5913&&(_0x42b6bd='\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a'+_0x2b5913+'\x0a');}const _0x55ab1d=_0x54310e(_0x4a5fff,0x3,_0xf181ce(0xb41)),_0x400e97=_0x54310e(_0x4a5fff,0x6,'hours'),_0x18c559=_0x54310e(_0x4a5fff,0x9,_0xf181ce(0xb41)),_0x89d3fb=_0x54310e(_0x4a5fff,0x1,_0xf181ce(0x113c)),_0x5352c7=_0x54310e(_0x4a5fff,0x3,'days'),_0x47556b=_0x54310e(_0x4a5fff,0x7,_0xf181ce(0x113c));let _0x442cfa='';if(_0x55ab1d||_0x400e97||_0x18c559||_0x89d3fb||_0x5352c7||_0x47556b){_0x442cfa+=_0xf181ce(0x805);if(_0x55ab1d)_0x442cfa+=_0x55ab1d;if(_0x400e97)_0x442cfa+=_0x400e97;if(_0x18c559)_0x442cfa+=_0x18c559;if(_0x55ab1d||_0x400e97||_0x18c559)_0x442cfa+='\x0a';if(_0x89d3fb)_0x442cfa+=_0x89d3fb;if(_0x5352c7)_0x442cfa+=_0x5352c7;if(_0x47556b)_0x442cfa+=_0x47556b;}const _0x21dc64=_0xc9a7e4(_0x4a5fff),_0x29534a='\x0a#\x20你的核心任务\x0a你正在扮演角色“'+_0x4a5fff[_0xf181ce(0x339)]+'”。用户刚刚在TA的手机（CPhone）上点击了一个按钮，希望你能继续你们之前的对话。你的任务是根据上下文，生成【3到5条】符合你人设的、简短的、连续的新回复。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组，每个对象代表一条消息。\x0a-\x20格式:\x20`[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第一句话\x22},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第二句话\x22},\x20{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]`\x0a-\x20你可以自由组合使用\x20\x22text\x22,\x20\x22sticker\x22,\x20\x22ai_image\x22,\x20\x22voice_message\x22\x20等多种消息类型。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20你的角色设定\x0a'+_0x4a5fff[_0xf181ce(0x450)][_0xf181ce(0x1c3)]+_0xf181ce(0x1052)+_0x21dc64+_0xf181ce(0x10c9)+_0x122062+'\x20\x20\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的本名**:\x20\x22'+_0x4a5fff[_0xf181ce(0x339)]+_0xf181ce(0x4d4)+_0x2932d2+'\x22\x0a'+_0x42b6bd+'\x0a'+_0x177fec+'\x0a'+_0x442cfa+'\x20\x0a-\x20**你们最后的对话**:\x0a'+_0x277630[_0xf181ce(0xb0a)](_0xac7717=>(_0xac7717['role']===_0xf181ce(0x20d)?_0x2932d2:_0x4a5fff['name'])+':\x20'+String(_0xac7717['content']))[_0xf181ce(0x3b9)]('\x0a')+'\x0a\x0a现在，请继续这场对话。\x0a',_0x1e590f=_0x277630[_0xf181ce(0xb0a)](_0x2459c4=>({'role':_0x2459c4['role'],'content':(_0x2459c4[_0xf181ce(0x11c1)]==='user'?_0x2932d2:_0x4a5fff[_0xf181ce(0x1561)])+':\x20'+String(_0x2459c4[_0xf181ce(0x4e3)])}));let _0x463dce=_0x5ce19d[_0xf181ce(0x478)](_0xf181ce(0x1329)),_0x4ce8c3=_0x366263(_0x57fa87,_0x3b6bfc,_0x29534a,_0x1e590f);const _0x2eb89e=_0x463dce?await fetch(_0x4ce8c3[_0xf181ce(0x121f)],_0x4ce8c3['data']):await fetch(_0x5ce19d+'/v1/chat/completions',{'method':_0xf181ce(0x12db),'headers':{'Content-Type':_0xf181ce(0xb1f),'Authorization':_0xf181ce(0x1265)+_0x3b6bfc},'body':JSON[_0xf181ce(0xe1e)]({'model':_0x57fa87,'messages':[{'role':_0xf181ce(0xe10),'content':_0x29534a},..._0x1e590f],'temperature':_0x19ddb8[_0xf181ce(0x4c8)][_0xf181ce(0x4a2)]||0.8})});if(!_0x2eb89e['ok'])throw new Error(_0xf181ce(0xbc6)+(await _0x2eb89e['json']())[_0xf181ce(0x3b7)][_0xf181ce(0xcce)]);const _0x1a4815=await _0x2eb89e[_0xf181ce(0xa5d)](),_0xc6552f=getGeminiResponseText(_0x1a4815),_0x53192e=_0x189ab1(_0xc6552f);if(!_0x53192e||_0x53192e[_0xf181ce(0x106b)]===0x0)throw new Error(_0xf181ce(0x9a9));let _0x5b5474=0x0,_0xe41046=Date[_0xf181ce(0x64b)]();for(const _0x272d81 of _0x53192e){const _0x2487d9={'role':_0xf181ce(0x115c),'senderName':_0x4a5fff[_0xf181ce(0x339)],'timestamp':_0xe41046++};let _0x1b1523=null;switch(_0x272d81['type']){case _0xf181ce(0x13ca):_0x1b1523={..._0x2487d9,'content':String(_0x272d81[_0xf181ce(0x4e3)]||_0x272d81[_0xf181ce(0xcce)])};break;case'sticker':if(_0x272d81['meaning']){const _0x23a509=_0x19ddb8[_0xf181ce(0x1557)][_0xf181ce(0xd62)](_0x27f6b3=>_0x27f6b3['name']===_0x272d81[_0xf181ce(0x7da)]);_0x23a509?_0x1b1523={..._0x2487d9,'type':_0xf181ce(0xda8),'content':_0x23a509['url'],'meaning':_0x23a509[_0xf181ce(0x1561)]}:(console[_0xf181ce(0x651)](_0xf181ce(0x388)+_0x272d81[_0xf181ce(0x7da)]+'\x22'),_0x1b1523={..._0x2487d9,'type':_0xf181ce(0x13ca),'content':'[表情:\x20'+_0x272d81['meaning']+']'});}else console['warn'](_0xf181ce(0x148e),_0x272d81),_0x1b1523={..._0x2487d9,'type':'sticker','content':_0x272d81[_0xf181ce(0x121f)],'meaning':'未知表情'};break;}_0x1b1523&&(_0x4a5fff[_0xf181ce(0x1f0)][_0xf181ce(0x1c4)](_0x1b1523),_0x5b5474++);}_0x5b5474>0x0&&(_0x4a5fff[_0xf181ce(0xe20)]=(_0x4a5fff[_0xf181ce(0xe20)]||0x0)+_0x5b5474),await _0x512070['chats'][_0xf181ce(0xd4d)](_0x4a5fff),await _0xec8072(),_0x5b5474>0x0&&_0x1c6d8a(_0x4a5fff['id'],_0xf181ce(0x63c)+_0x5b5474+_0xf181ce(0x604));}catch(_0x24e0b6){console['error']('从CPhone推进真实对话失败:',_0x24e0b6),await _0x403a62(_0xf181ce(0x13bd),_0xf181ce(0x22b)+_0x24e0b6[_0xf181ce(0xcce)]);}}async function _0x10cff2(){const _0x21023e=_0x48bc6d;if(_0x113908||!_0x5a727a)return;_0x113908=!![];const _0x547f08=document[_0x21023e(0x9a3)](_0x21023e(0x11ed)),_0x14f0a7=_0x19ddb8[_0x21023e(0xb04)][_0x5a727a];if(!_0x14f0a7){_0x113908=![];return;}_0x3335f4(_0x547f08,_0x21023e(0xe8f));const _0x258fd4=_0x547f08[_0x21023e(0x13b7)];await new Promise(_0x15f17b=>setTimeout(_0x15f17b,0x1f4));const _0x1f207a=_0x14f0a7['history'][_0x21023e(0x106b)],_0x36ec54=_0x19ddb8[_0x21023e(0x4c8)][_0x21023e(0x11ef)]||0x32,_0x27fc6a=_0x1f207a-_0x5c4e1b,_0x4feaae=Math['max'](0x0,_0x27fc6a-_0x36ec54),_0x2a3b1e=_0x14f0a7[_0x21023e(0x1f0)][_0x21023e(0x457)](_0x4feaae,_0x27fc6a);_0x38511a(_0x547f08);if(_0x2a3b1e['length']===0x0){_0x113908=![];return;}for(const _0x59209d of _0x2a3b1e['reverse']()){const _0x3ce7f6={..._0x59209d,'role':_0x59209d['role']===_0x21023e(0x20d)?_0x21023e(0x115c):'user'},_0x24072a={'id':_0x21023e(0x942),'isGroup':![],'name':_0x14f0a7[_0x21023e(0x1561)],'settings':{..._0x14f0a7['settings'],'myAvatar':_0x14f0a7[_0x21023e(0x450)][_0x21023e(0x4fe)],'myAvatarFrame':_0x14f0a7[_0x21023e(0x450)][_0x21023e(0xdc8)],'aiAvatar':_0x14f0a7[_0x21023e(0x450)]['myAvatar'],'aiAvatarFrame':_0x14f0a7[_0x21023e(0x450)][_0x21023e(0xb26)]}},_0x5d27cd=await _0xb42d69(_0x3ce7f6,_0x24072a);_0x5d27cd&&_0x547f08['prepend'](_0x5d27cd);}_0x5c4e1b+=_0x2a3b1e['length'];const _0x418bd8=_0x547f08[_0x21023e(0x13b7)];_0x547f08[_0x21023e(0x85c)]=_0x418bd8-_0x258fd4,_0x113908=![];}async function _0x387f73(_0x404dfc){const _0x5d2448=_0x48bc6d,_0x7a6a69=_0x19ddb8['chats'][_0x5a727a];if(!_0x7a6a69)return;_0x23e74f=_0x404dfc===-0x1?_0x5d2448(0x5f4):_0x7a6a69['simulatedConversations'][_0x404dfc]?.[_0x5d2448(0x1508)];const _0x361ce2=document['getElementById'](_0x5d2448(0x11ed));_0x361ce2[_0x5d2448(0xeb2)]='',_0x361ce2[_0x5d2448(0xd8d)][_0x5d2448(0x910)]=_0x7a6a69[_0x5d2448(0x450)][_0x5d2448(0x910)]||'default';const _0x23a2bb=document['getElementById'](_0x5d2448(0xae7))[_0x5d2448(0x4d8)][_0x5d2448(0x1222)](_0x5d2448(0x282));_0x361ce2[_0x5d2448(0x20f)]['backgroundColor']=_0x23a2bb?'#000000':_0x5d2448(0xee8);let _0x1c9cfa,_0x2c41e3=[];const _0x536c15=await _0x512070[_0x5d2448(0x5b7)][_0x5d2448(0x591)](),_0x93a862=new Map(_0x536c15[_0x5d2448(0xb0a)](_0x3d2170=>[_0x3d2170[_0x5d2448(0x1561)],_0x3d2170]));if(_0x404dfc===-0x1){_0x23e74f=_0x5d2448(0x5f4);const _0x672a1e=document['getElementById'](_0x5d2448(0xc67)),_0x1c63dd=document['getElementById']('char-simulated-input');_0x361ce2['innerHTML']='',_0x672a1e[_0x5d2448(0x766)]=_0x7a6a69[_0x5d2448(0x450)]['myNickname']||(_0x19ddb8[_0x5d2448(0x9ce)][_0x5d2448(0x246)]||'我'),_0x1c63dd[_0x5d2448(0x1591)]='与\x20'+(_0x7a6a69['settings']['myNickname']||'我')+_0x5d2448(0x653),_0x5c4e1b=0x0,_0x113908=![];const _0x24e6c3=_0x7a6a69[_0x5d2448(0x1f0)],_0x2c4e09=_0x19ddb8[_0x5d2448(0x4c8)][_0x5d2448(0x11ef)]||0x32,_0x495760=_0x24e6c3[_0x5d2448(0x457)](-_0x2c4e09);_0x1c9cfa={'id':_0x5d2448(0x942),'isGroup':![],'name':_0x7a6a69[_0x5d2448(0x1561)],'settings':{..._0x7a6a69[_0x5d2448(0x450)],'myAvatar':_0x7a6a69[_0x5d2448(0x450)][_0x5d2448(0x4fe)],'myAvatarFrame':_0x7a6a69['settings'][_0x5d2448(0xdc8)],'aiAvatar':_0x7a6a69[_0x5d2448(0x450)][_0x5d2448(0x1af)],'aiAvatarFrame':_0x7a6a69[_0x5d2448(0x450)]['myAvatarFrame']}},_0x2c41e3=_0x495760[_0x5d2448(0xb0a)](_0x97bd24=>({..._0x97bd24,'role':_0x97bd24[_0x5d2448(0x11c1)]===_0x5d2448(0x20d)?'assistant':_0x5d2448(0x20d)})),_0x5c4e1b=_0x495760[_0x5d2448(0x106b)];}else{const _0x1aeeb0=_0x7a6a69['simulatedConversations'][_0x404dfc];if(!_0x1aeeb0)return;_0x23e74f=_0x1aeeb0['type'];const _0x5547fe=document[_0x5d2448(0x9a3)](_0x5d2448(0xc67)),_0x424d37=document[_0x5d2448(0x9a3)](_0x5d2448(0xbc7));if(_0x1aeeb0['type']===_0x5d2448(0xf67))_0x5547fe[_0x5d2448(0x766)]=_0x1aeeb0['groupName']+'\x20('+(_0x1aeeb0[_0x5d2448(0x9d3)][_0x5d2448(0x106b)]+0x1)+')',_0x424d37[_0x5d2448(0x1591)]='在\x20'+_0x1aeeb0['groupName']+'\x20中聊天',_0x1c9cfa={'id':'temp_group_chat','isGroup':!![],'name':_0x1aeeb0[_0x5d2448(0xc91)],'originalName':_0x7a6a69['originalName'],'members':_0x1aeeb0[_0x5d2448(0x9d3)][_0x5d2448(0xb0a)](_0x7d76e7=>{const _0x45a6b5=_0x5d2448,_0x35675b=_0x93a862['get'](_0x7d76e7[_0x45a6b5(0x1561)]);let _0x3799cf=_0x35675b&&_0x35675b['avatar']?_0x35675b[_0x45a6b5(0xf3f)]:_0x19ddb8['globalSettings']['enableAiDrawing']?_0x45a6b5(0x10a3)+encodeURIComponent(_0x7d76e7[_0x45a6b5(0x13ef)]||_0x45a6b5(0xef2)):_0x451ae9;return{'originalName':_0x7d76e7[_0x45a6b5(0x1561)],'groupNickname':_0x7d76e7[_0x45a6b5(0x1561)],'avatar':_0x3799cf};}),'settings':{..._0x7a6a69['settings'],'myNickname':_0x7a6a69[_0x5d2448(0x1561)],'myAvatar':_0x7a6a69['settings'][_0x5d2448(0x4fe)],'myAvatarFrame':_0x7a6a69[_0x5d2448(0x450)][_0x5d2448(0xdc8)]}};else{_0x5547fe[_0x5d2448(0x766)]=_0x1aeeb0[_0x5d2448(0x4d1)][_0x5d2448(0x1561)],_0x424d37[_0x5d2448(0x1591)]='与\x20'+_0x1aeeb0[_0x5d2448(0x4d1)][_0x5d2448(0x1561)]+_0x5d2448(0x1224);const _0x4da855=_0x93a862[_0x5d2448(0x14ee)](_0x1aeeb0['participant'][_0x5d2448(0x1561)]),_0x4871af=_0x4da855&&_0x4da855[_0x5d2448(0xf3f)]?_0x4da855[_0x5d2448(0xf3f)]:_0x19ddb8['globalSettings'][_0x5d2448(0x853)]?_0x5d2448(0x10a3)+encodeURIComponent(_0x1aeeb0['participant'][_0x5d2448(0x13ef)]||_0x5d2448(0xef2)):_0x451ae9;_0x1c9cfa={'id':_0x5d2448(0xe5c),'isGroup':![],'name':_0x1aeeb0[_0x5d2448(0x4d1)][_0x5d2448(0x1561)],'originalName':_0x7a6a69[_0x5d2448(0x339)],'settings':{..._0x7a6a69[_0x5d2448(0x450)],'myAvatar':_0x7a6a69[_0x5d2448(0x450)][_0x5d2448(0x4fe)],'myAvatarFrame':_0x7a6a69[_0x5d2448(0x450)][_0x5d2448(0xdc8)],'aiAvatar':_0x4871af,'aiAvatarFrame':''}};}_0x2c41e3=_0x1aeeb0[_0x5d2448(0x4f8)];}for(const _0x4b2309 of _0x2c41e3){let _0x11b3ef=_0x4b2309[_0x5d2448(0x11c1)];if(_0x404dfc!==-0x1){const _0x2f3322=_0x4b2309[_0x5d2448(0x3c6)]===(_0x7a6a69['originalName']||_0x7a6a69[_0x5d2448(0x1561)]);_0x11b3ef=_0x2f3322?_0x5d2448(0x20d):'assistant';}const _0x1b79c2={'role':_0x11b3ef,'senderName':_0x4b2309[_0x5d2448(0x3c6)]||(_0x11b3ef===_0x5d2448(0x20d)?_0x1c9cfa['settings'][_0x5d2448(0x1555)]:_0x1c9cfa[_0x5d2448(0x1561)]),'timestamp':_0x4b2309[_0x5d2448(0xd73)]||Date[_0x5d2448(0x64b)]()+Math[_0x5d2448(0xdcd)]()};if(_0x4b2309[_0x5d2448(0x1508)]===_0x5d2448(0xda8)&&_0x4b2309[_0x5d2448(0x7da)]){const _0x402bcf=_0x19ddb8['userStickers'][_0x5d2448(0xd62)](_0x2d0a4d=>_0x2d0a4d['name']===_0x4b2309[_0x5d2448(0x7da)]);_0x402bcf?(_0x1b79c2[_0x5d2448(0x4e3)]=_0x402bcf[_0x5d2448(0x121f)],_0x1b79c2[_0x5d2448(0x7da)]=_0x4b2309[_0x5d2448(0x7da)],_0x1b79c2[_0x5d2448(0x1508)]=_0x5d2448(0xda8)):(console[_0x5d2448(0x651)](_0x5d2448(0x1499)+_0x4b2309[_0x5d2448(0x7da)]+_0x5d2448(0x91e)),_0x1b79c2[_0x5d2448(0x4e3)]=_0x5d2448(0x22a)+_0x4b2309['meaning']+']',_0x1b79c2['type']=_0x5d2448(0x13ca));}else _0x1b79c2[_0x5d2448(0x4e3)]=_0x4b2309['content'],_0x1b79c2['type']=_0x4b2309[_0x5d2448(0x1508)]||_0x5d2448(0x13ca);const _0xad7431=await _0xb42d69(_0x1b79c2,_0x1c9cfa);_0xad7431&&_0x361ce2[_0x5d2448(0x983)](_0xad7431);}_0x56e352(_0x5d2448(0x159f)),setTimeout(()=>_0x361ce2[_0x5d2448(0x85c)]=_0x361ce2['scrollHeight'],0x0);}function _0x17a915(){const _0xfc7f1=_0x48bc6d;document[_0xfc7f1(0x9a3)](_0xfc7f1(0x1050))[_0xfc7f1(0x4d8)][_0xfc7f1(0x133d)]('visible');}async function _0x123a55(){const _0x41f8e8=_0x48bc6d;if(!_0x5a727a)return;const _0x48fd08=_0x19ddb8[_0x41f8e8(0xb04)][_0x5a727a];if(!_0x48fd08){await _0x403a62('操作失败',_0x41f8e8(0xc4a));return;}await _0x403a62('请稍候...',_0x41f8e8(0x789)+_0x48fd08[_0x41f8e8(0x1561)]+_0x41f8e8(0x1371));const {proxyUrl:_0x47427b,apiKey:_0x51e98e,model:_0x1e54a2}=_0x19ddb8['apiConfig'];if(!_0x47427b||!_0x51e98e||!_0x1e54a2){alert(_0x41f8e8(0xff3));return;}const _0x5c2cb9=_0x19ddb8[_0x41f8e8(0x9ce)][_0x41f8e8(0x246)]===_0x41f8e8(0x15c8)||!_0x19ddb8[_0x41f8e8(0x9ce)][_0x41f8e8(0x246)]?'用户':_0x19ddb8[_0x41f8e8(0x9ce)][_0x41f8e8(0x246)],_0x22af40=_0x48fd08[_0x41f8e8(0x744)]&&_0x48fd08[_0x41f8e8(0x744)][_0x41f8e8(0x106b)]>0x0?_0x48fd08[_0x41f8e8(0x744)]['map'](_0x404c59=>_0x41f8e8(0x2ee)+_0x5d6abc(_0x404c59[_0x41f8e8(0xd73)])+')\x20'+_0x404c59[_0x41f8e8(0x4e3)])[_0x41f8e8(0x3b9)]('\x0a'):'无',_0x43bbb1=_0x48fd08[_0x41f8e8(0x450)]['maxMemory']||0xa,_0x492465=_0x48fd08['history']['slice'](-_0x43bbb1)[_0x41f8e8(0xb0a)](_0x4f24d6=>(_0x4f24d6['role']===_0x41f8e8(0x20d)?_0x5c2cb9:_0x48fd08[_0x41f8e8(0x1561)])+':\x20'+String(_0x4f24d6[_0x41f8e8(0x4e3)])[_0x41f8e8(0x72e)](0x0,0x1e)+_0x41f8e8(0x4a5))[_0x41f8e8(0x3b9)]('\x0a'),_0x3bc71b=(_0x48fd08[_0x41f8e8(0x450)][_0x41f8e8(0x9c4)]||[])[_0x41f8e8(0xb0a)](_0x1c7a0c=>_0x19ddb8[_0x41f8e8(0x8e4)][_0x41f8e8(0xd62)](_0x3605ca=>_0x3605ca['id']===_0x1c7a0c))[_0x41f8e8(0x1195)](Boolean)[_0x41f8e8(0xb0a)](_0x569a67=>_0x41f8e8(0x33b)+_0x569a67['name']+_0x41f8e8(0xb7c)+_0x569a67[_0x41f8e8(0x4e3)][_0x41f8e8(0x1195)](_0x31f3bd=>_0x31f3bd[_0x41f8e8(0x15cd)])[_0x41f8e8(0xb0a)](_0x5c5d1a=>'-\x20'+_0x5c5d1a[_0x41f8e8(0x4e3)])[_0x41f8e8(0x3b9)]('\x0a'))[_0x41f8e8(0x3b9)](''),_0x3028d1=_0x54310e(_0x48fd08,0x3,_0x41f8e8(0xb41)),_0x46eeca=_0x54310e(_0x48fd08,0x6,'hours'),_0x2be7d8=_0x54310e(_0x48fd08,0x9,_0x41f8e8(0xb41)),_0x2dea8a=_0x54310e(_0x48fd08,0x1,'days'),_0x3faae8=_0x54310e(_0x48fd08,0x3,_0x41f8e8(0x113c)),_0x3a9159=_0x54310e(_0x48fd08,0x7,'days');let _0x641352='';if(_0x3028d1||_0x46eeca||_0x2be7d8||_0x2dea8a||_0x3faae8||_0x3a9159){_0x641352+=_0x41f8e8(0x805);if(_0x3028d1)_0x641352+=_0x3028d1;if(_0x46eeca)_0x641352+=_0x46eeca;if(_0x2be7d8)_0x641352+=_0x2be7d8;if(_0x3028d1||_0x46eeca||_0x2be7d8)_0x641352+='\x0a';if(_0x2dea8a)_0x641352+=_0x2dea8a;if(_0x3faae8)_0x641352+=_0x3faae8;if(_0x3a9159)_0x641352+=_0x3a9159;}const _0x567b65=_0x41f8e8(0x2c8)+_0x48fd08[_0x41f8e8(0x1561)]+'”，并根据其人设、记忆和最近的互动，构思出【8到10张】TA最近可能会拍摄或珍藏在手机相册里的照片。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20照片内容必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20照片主题要丰富，可以包括自拍、风景、食物、宠物、朋友合影、工作场景等。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一张照片，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是照片背后的故事或角色的心情日记，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张照片的、详细的【英文】关键词。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20绝对禁止】**:\x20绝对禁止包含任何中文字符、句子、特殊符号、或任何可能涉及敏感（NSFW）、暴力、血腥、政治的内容！也禁止真人！\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20必须是】**:\x20必须是纯英文的、用逗号分隔的【关键词组合】\x20(e.g.,\x20\x221boy,\x20solo,\x20basketball\x20jersey,\x20in\x20locker\x20room,\x20smiling,\x20selfie\x22)。\x0a\x20\x20\x20\x20-\x20**【画风指令】**:\x20在\x20prompt\x20的末尾，总是加上画风指令，例如：\x20`best\x20quality,\x20masterpiece,\x20anime\x20style,\x20cinematic\x20lighting`\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x48fd08[_0x41f8e8(0x450)][_0x41f8e8(0x1c3)]+'\x0a'+_0x22af40+'\x0a'+_0x3bc71b+'\x0a'+_0x641352+_0x41f8e8(0x11e3)+_0x5c2cb9+_0x41f8e8(0x218)+_0x492465+'\x0a\x0a现在，请开始生成这组照片的描述和绘画指令。';try{const _0x5bbd20=[{'role':_0x41f8e8(0x20d),'content':_0x41f8e8(0xf03)}];let _0x4e6681=_0x47427b['includes'](_0x41f8e8(0x1329)),_0x15d2d4=_0x366263(_0x1e54a2,_0x51e98e,_0x567b65,_0x5bbd20);const _0x4873e5=_0x4e6681?await fetch(_0x15d2d4['url'],_0x15d2d4[_0x41f8e8(0x38c)]):await fetch(_0x47427b+_0x41f8e8(0x501),{'method':_0x41f8e8(0x12db),'headers':{'Content-Type':_0x41f8e8(0xb1f),'Authorization':_0x41f8e8(0x1265)+_0x51e98e},'body':JSON[_0x41f8e8(0xe1e)]({'model':_0x1e54a2,'messages':[{'role':'system','content':_0x567b65},..._0x5bbd20],'temperature':_0x19ddb8['globalSettings'][_0x41f8e8(0x4a2)]||0.9})});if(!_0x4873e5['ok'])throw new Error('API\x20错误:\x20'+_0x4873e5[_0x41f8e8(0x140e)]);const _0x109f6e=await _0x4873e5[_0x41f8e8(0xa5d)](),_0x57f29c=getGeminiResponseText(_0x109f6e),_0x2ae53c=_0x57f29c[_0x41f8e8(0x293)](/(\[[\s\S]*\])/);if(!_0x2ae53c||!_0x2ae53c[0x0])throw new Error(_0x41f8e8(0x1178)+_0x57f29c);const _0x3f4a58=_0x2ae53c[0x0];let _0xe3cfcf;try{_0xe3cfcf=JSON[_0x41f8e8(0x1447)](_0x3f4a58);}catch(_0x2eeb1f){throw new Error(_0x41f8e8(0x4bb)+_0x2eeb1f[_0x41f8e8(0xcce)]+_0x41f8e8(0x8f2)+_0x57f29c);}_0x48fd08[_0x41f8e8(0x76f)]=_0xe3cfcf,await _0x512070[_0x41f8e8(0xb04)][_0x41f8e8(0xd4d)](_0x48fd08),await _0x21824d();}catch(_0x1c9f02){console['error']('生成模拟相册失败:',_0x1c9f02),await _0x403a62(_0x41f8e8(0x8e8),_0x41f8e8(0xcf1)+_0x1c9f02[_0x41f8e8(0xcce)]);}}async function _0x21824d(){const _0x3a99d5=_0x48bc6d,_0x5e725b=document[_0x3a99d5(0x9a3)]('char-album-grid');_0x5e725b[_0x3a99d5(0xeb2)]='';if(!_0x5a727a)return;const _0x5ed08d=_0x19ddb8[_0x3a99d5(0xb04)][_0x5a727a],_0x4be175=_0x5ed08d[_0x3a99d5(0x76f)]||[];if(_0x4be175[_0x3a99d5(0x106b)]===0x0){_0x5e725b['innerHTML']=_0x3a99d5(0x2c4);return;}const _0x379063='https://i.postimg.cc/KYr2qRCK/1.jpg';_0x4be175['forEach'](_0x1e8fea=>{const _0x325014=_0x3a99d5,_0x128a3a=document[_0x325014(0xe94)]('div');_0x128a3a[_0x325014(0x1487)]=_0x325014(0x14e0),_0x128a3a[_0x325014(0xd8d)][_0x325014(0x3ef)]=_0x1e8fea['description'],_0x5e725b[_0x325014(0x983)](_0x128a3a);if(_0x19ddb8[_0x325014(0x4c8)][_0x325014(0x853)]){_0x128a3a[_0x325014(0x20f)][_0x325014(0x87e)]='#e9ecef';const _0x55fdd2=/[^\x00-\x7F]/[_0x325014(0xddf)](_0x1e8fea[_0x325014(0xb95)]),_0x3a8bf7=_0x1e8fea[_0x325014(0xb95)]&&_0x1e8fea['image_prompt']['trim']()&&!_0x55fdd2,_0x16db18=_0x3a8bf7?_0x1e8fea['image_prompt']:'a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting',_0x4f5dd7=_0x325014(0x10a3)+encodeURIComponent(_0x16db18),_0x3d85b0=new Image();_0x3d85b0[_0x325014(0xdd7)]=function(){const _0x53a78c=_0x325014;_0x128a3a['style'][_0x53a78c(0x1090)]=_0x53a78c(0x55b)+this['src']+')';},_0x3d85b0[_0x325014(0xb8b)]=function(){const _0x5d914b=_0x325014;_0x128a3a[_0x5d914b(0x20f)][_0x5d914b(0x1090)]='url('+_0x379063+')';},_0x3d85b0[_0x325014(0x10d4)]=_0x4f5dd7;}else{_0x128a3a['style'][_0x325014(0x87e)]='#f0f2f5',_0x128a3a['style'][_0x325014(0x102d)]='1px\x20solid\x20#e0e0e0';const _0x4657dc=document[_0x325014(0xe94)]('p');_0x4657dc['className']=_0x325014(0x1100),_0x4657dc['textContent']=_0x1e8fea[_0x325014(0x3ef)]||_0x325014(0x4b7),_0x128a3a['appendChild'](_0x4657dc);}});}async function _0x5683ee(){const _0x799151=_0x48bc6d;if(!_0x5a727a)return;const _0x22b7aa=_0x19ddb8[_0x799151(0xb04)][_0x5a727a];if(!_0x22b7aa)return;await _0x403a62(_0x799151(0x1395),'正在模拟“'+_0x22b7aa[_0x799151(0x1561)]+'”的网上冲浪足迹...');const {proxyUrl:_0x538fdd,apiKey:_0x5de6a6,model:_0x42a71f}=_0x19ddb8[_0x799151(0xd22)];if(!_0x538fdd||!_0x5de6a6||!_0x42a71f){alert(_0x799151(0x487));return;}const _0x5990ae=_0x19ddb8[_0x799151(0x9ce)][_0x799151(0x246)]===_0x799151(0x15c8)||!_0x19ddb8[_0x799151(0x9ce)][_0x799151(0x246)]?'用户':_0x19ddb8[_0x799151(0x9ce)][_0x799151(0x246)],_0x2b665b=_0x22b7aa[_0x799151(0x744)]&&_0x22b7aa[_0x799151(0x744)][_0x799151(0x106b)]>0x0?_0x22b7aa[_0x799151(0x744)][_0x799151(0xb0a)](_0xeafd44=>'-\x20(记录于\x20'+_0x5d6abc(_0xeafd44[_0x799151(0xd73)])+')\x20'+_0xeafd44[_0x799151(0x4e3)])[_0x799151(0x3b9)]('\x0a'):'无',_0x53bed8=_0x22b7aa['settings'][_0x799151(0x152f)]||0xa,_0x507fa9=_0x22b7aa[_0x799151(0x1f0)][_0x799151(0x457)](-_0x53bed8)['map'](_0x30b44b=>(_0x30b44b[_0x799151(0x11c1)]===_0x799151(0x20d)?_0x5990ae:_0x22b7aa['name'])+':\x20'+String(_0x30b44b[_0x799151(0x4e3)])[_0x799151(0x72e)](0x0,0x1e)+'...')[_0x799151(0x3b9)]('\x0a'),_0x3c947f=(_0x22b7aa[_0x799151(0x450)][_0x799151(0x9c4)]||[])['map'](_0x43a78c=>_0x19ddb8[_0x799151(0x8e4)][_0x799151(0xd62)](_0x2e6a4f=>_0x2e6a4f['id']===_0x43a78c))[_0x799151(0x1195)](Boolean)[_0x799151(0xb0a)](_0x39d432=>_0x799151(0x33b)+_0x39d432[_0x799151(0x1561)]+_0x799151(0xb7c)+_0x39d432[_0x799151(0x4e3)]['filter'](_0x509cd1=>_0x509cd1['enabled'])['map'](_0x23525e=>'-\x20'+_0x23525e[_0x799151(0x4e3)])[_0x799151(0x3b9)]('\x0a'))[_0x799151(0x3b9)](''),_0x2909e0=_0x54310e(_0x22b7aa,0x3,_0x799151(0xb41)),_0x46a39b=_0x54310e(_0x22b7aa,0x6,_0x799151(0xb41)),_0x46f99b=_0x54310e(_0x22b7aa,0x9,'hours'),_0x5d6a83=_0x54310e(_0x22b7aa,0x1,'days'),_0x1a319b=_0x54310e(_0x22b7aa,0x3,'days'),_0x54ecb6=_0x54310e(_0x22b7aa,0x7,_0x799151(0x113c));let _0x4ffbff='';if(_0x2909e0||_0x46a39b||_0x46f99b||_0x5d6a83||_0x1a319b||_0x54ecb6){_0x4ffbff+=_0x799151(0x805);if(_0x2909e0)_0x4ffbff+=_0x2909e0;if(_0x46a39b)_0x4ffbff+=_0x46a39b;if(_0x46f99b)_0x4ffbff+=_0x46f99b;if(_0x2909e0||_0x46a39b||_0x46f99b)_0x4ffbff+='\x0a';if(_0x5d6a83)_0x4ffbff+=_0x5d6a83;if(_0x1a319b)_0x4ffbff+=_0x1a319b;if(_0x54ecb6)_0x4ffbff+=_0x54ecb6;}const _0x460357=_0x22b7aa[_0x799151(0x450)]['myPersona']||'(未设置)',_0x55f45f='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x22b7aa[_0x799151(0x1561)]+_0x799151(0x813)+_0x22b7aa['settings'][_0x799151(0x1c3)]+_0x799151(0x1014)+_0x460357+_0x799151(0x3fe)+_0x2b665b+'\x0a'+_0x3c947f+'\x0a'+_0x4ffbff+_0x799151(0x11e3)+_0x5990ae+'”的对话摘要**:\x0a'+_0x507fa9+_0x799151(0x11a3);try{const _0x1212c3=[{'role':_0x799151(0x20d),'content':_0x799151(0x12ab)}];let _0x1b79db=_0x538fdd[_0x799151(0x478)](_0x799151(0x1329)),_0x2f71f3=_0x366263(_0x42a71f,_0x5de6a6,_0x55f45f,_0x1212c3);const _0x34bdd1=_0x1b79db?await fetch(_0x2f71f3['url'],_0x2f71f3[_0x799151(0x38c)]):await fetch(_0x538fdd+'/v1/chat/completions',{'method':'POST','headers':{'Content-Type':_0x799151(0xb1f),'Authorization':_0x799151(0x1265)+_0x5de6a6},'body':JSON[_0x799151(0xe1e)]({'model':_0x42a71f,'messages':[{'role':'system','content':_0x55f45f},..._0x1212c3],'temperature':_0x19ddb8['globalSettings'][_0x799151(0x4a2)]||0.9})});if(!_0x34bdd1['ok'])throw new Error(_0x799151(0x786)+_0x34bdd1[_0x799151(0x140e)]);const _0xdb5d22=await _0x34bdd1['json'](),_0x94078e=getGeminiResponseText(_0xdb5d22),_0xd80766=_0x94078e[_0x799151(0x293)](/(\[[\s\S]*\])/);if(!_0xd80766||!_0xd80766[0x0])throw new Error(_0x799151(0x1178)+_0x94078e);const _0x317681=_0xd80766[0x0];let _0x3f39e9;try{_0x3f39e9=JSON[_0x799151(0x1447)](_0x317681);}catch(_0x4bad88){throw new Error(_0x799151(0x4bb)+_0x4bad88[_0x799151(0xcce)]+_0x799151(0x8f2)+_0x94078e);}_0x22b7aa[_0x799151(0x77d)]=_0x3f39e9,await _0x512070[_0x799151(0xb04)]['put'](_0x22b7aa),await _0x1b1d7f();}catch(_0x5b74be){console['error'](_0x799151(0x9d8),_0x5b74be),await _0x403a62(_0x799151(0x8e8),_0x799151(0xe0e)+_0x5b74be['message']);}}function _0x1b1d7f(){const _0x53096f=_0x48bc6d,_0x48d7d4=document[_0x53096f(0x9a3)](_0x53096f(0x5cf));_0x48d7d4[_0x53096f(0xeb2)]='';if(!_0x5a727a)return;const _0x2b149a=_0x19ddb8[_0x53096f(0xb04)][_0x5a727a],_0x1a157f=_0x2b149a[_0x53096f(0x77d)]||[];if(_0x1a157f[_0x53096f(0x106b)]===0x0){_0x48d7d4[_0x53096f(0xeb2)]=_0x53096f(0x9aa);return;}_0x1a157f[_0x53096f(0x15c1)]((_0x509f23,_0x224771)=>{const _0x27b698=_0x53096f,_0x33a1e0=document[_0x27b698(0xe94)](_0x27b698(0x8ca));_0x33a1e0['className']=_0x27b698(0xa86),_0x33a1e0[_0x27b698(0xeb2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x509f23[_0x27b698(0x10b8)]+_0x27b698(0x113a)+_0x509f23[_0x27b698(0x121f)]+_0x27b698(0xa8e),_0x33a1e0['addEventListener']('click',()=>_0x597b63(_0x224771)),_0x48d7d4[_0x27b698(0x983)](_0x33a1e0);});}async function _0x597b63(_0x4174d4){const _0x31d334=_0x48bc6d,_0x2a8a39=_0x19ddb8['chats'][_0x5a727a],_0x3e47a6=_0x2a8a39[_0x31d334(0x77d)][_0x4174d4];if(!_0x3e47a6)return;_0x253bd5=_0x3e47a6,_0x367db0(_0x3e47a6),_0x56e352('char-browser-article-screen');const _0x566d94=document[_0x31d334(0x9a3)](_0x31d334(0xa6a)),_0x51abf8=await _0x512070[_0x31d334(0x73d)][_0x31d334(0x1201)]({'type':'char_browser_article','content.url':_0x3e47a6[_0x31d334(0x121f)]})[_0x31d334(0x92c)]();_0x566d94[_0x31d334(0x4d8)][_0x31d334(0xc02)](_0x31d334(0xe9f),!!_0x51abf8);}async function _0x377220(){const _0x48ee07=_0x48bc6d;if(!_0x253bd5||!_0x5a727a)return;const _0x2e8faf=_0x253bd5,_0x354d47=_0x19ddb8['chats'][_0x5a727a],_0xdc82d=document[_0x48ee07(0x9a3)](_0x48ee07(0xa6a)),_0x194eda=await _0x512070[_0x48ee07(0x73d)][_0x48ee07(0x1201)]({'type':_0x48ee07(0x1562),'content.url':_0x2e8faf['url']})[_0x48ee07(0x92c)]();if(_0x194eda)await _0x512070[_0x48ee07(0x73d)]['delete'](_0x194eda['id']),_0xdc82d[_0x48ee07(0x4d8)]['remove'](_0x48ee07(0xe9f)),await _0x403a62(_0x48ee07(0x432),_0x48ee07(0x891));else{const _0x473309={'type':_0x48ee07(0x1562),'content':{..._0x2e8faf,'characterId':_0x5a727a,'characterName':_0x354d47['name']},'timestamp':Date[_0x48ee07(0x64b)]()};await _0x512070[_0x48ee07(0x73d)][_0x48ee07(0xe05)](_0x473309),_0xdc82d[_0x48ee07(0x4d8)][_0x48ee07(0xe05)](_0x48ee07(0xe9f)),await _0x403a62(_0x48ee07(0x432),'已成功收藏到“我的收藏”页面！');}}function _0x367db0(_0x19a07a){const _0x3dacb2=_0x48bc6d,_0x86d32f=document[_0x3dacb2(0x9a3)]('char-article-title'),_0xa471b6=document[_0x3dacb2(0x9a3)](_0x3dacb2(0x1530));_0x86d32f[_0x3dacb2(0x766)]=_0x19a07a['title'],_0xa471b6[_0x3dacb2(0xeb2)]='',_0x19a07a['type']==='image'?_0xa471b6[_0x3dacb2(0xeb2)]=_0x3dacb2(0x690)+(_0x19a07a[_0x3dacb2(0x10b8)]||'(无标题)')+_0x3dacb2(0x4cf):_0xa471b6['innerHTML']='<p>'+(_0x19a07a[_0x3dacb2(0x4e3)]||_0x3dacb2(0x12fc))['replace'](/\n/g,_0x3dacb2(0x8bd))+_0x3dacb2(0x4cf);}async function _0x23bb80(){const _0x356ba1=_0x48bc6d;if(!_0x5a727a)return;const _0x33e0b1=_0x19ddb8['chats'][_0x5a727a];if(!_0x33e0b1)return;await _0x403a62(_0x356ba1(0x1395),_0x356ba1(0x568)+_0x33e0b1[_0x356ba1(0x1561)]+_0x356ba1(0x72c));const {proxyUrl:_0x426779,apiKey:_0x39297a,model:_0x4bb87e}=_0x19ddb8[_0x356ba1(0xd22)];if(!_0x426779||!_0x39297a||!_0x4bb87e){alert(_0x356ba1(0x487));return;}const _0xbd5755=_0x19ddb8['qzoneSettings'][_0x356ba1(0x246)]==='{{user}}'||!_0x19ddb8['qzoneSettings'][_0x356ba1(0x246)]?'用户':_0x19ddb8[_0x356ba1(0x9ce)][_0x356ba1(0x246)],_0x5064d3=_0x33e0b1[_0x356ba1(0x744)]&&_0x33e0b1[_0x356ba1(0x744)][_0x356ba1(0x106b)]>0x0?_0x33e0b1[_0x356ba1(0x744)][_0x356ba1(0xb0a)](_0x570997=>_0x356ba1(0x2ee)+_0x5d6abc(_0x570997[_0x356ba1(0xd73)])+')\x20'+_0x570997[_0x356ba1(0x4e3)])[_0x356ba1(0x3b9)]('\x0a'):'无',_0x162d91=_0x33e0b1[_0x356ba1(0x450)][_0x356ba1(0x152f)]||0xa,_0x261ce7=_0x33e0b1[_0x356ba1(0x1f0)][_0x356ba1(0x457)](-_0x162d91)['map'](_0x26a3d1=>(_0x26a3d1[_0x356ba1(0x11c1)]==='user'?_0xbd5755:_0x33e0b1[_0x356ba1(0x1561)])+':\x20'+String(_0x26a3d1[_0x356ba1(0x4e3)])[_0x356ba1(0x72e)](0x0,0x1e)+_0x356ba1(0x4a5))['join']('\x0a'),_0x5c6d87=(_0x33e0b1[_0x356ba1(0x450)]['linkedWorldBookIds']||[])[_0x356ba1(0xb0a)](_0x22feaa=>_0x19ddb8[_0x356ba1(0x8e4)]['find'](_0x45f140=>_0x45f140['id']===_0x22feaa))['filter'](Boolean)['map'](_0x3ad84f=>_0x356ba1(0x33b)+_0x3ad84f[_0x356ba1(0x1561)]+'》设定:\x0a'+_0x3ad84f[_0x356ba1(0x4e3)][_0x356ba1(0x1195)](_0x29041e=>_0x29041e[_0x356ba1(0x15cd)])[_0x356ba1(0xb0a)](_0x240d5e=>'-\x20'+_0x240d5e[_0x356ba1(0x4e3)])[_0x356ba1(0x3b9)]('\x0a'))['join'](''),_0x4fde8f=_0x54310e(_0x33e0b1,0x3,'hours'),_0x57ef40=_0x54310e(_0x33e0b1,0x6,_0x356ba1(0xb41)),_0x280486=_0x54310e(_0x33e0b1,0x9,_0x356ba1(0xb41)),_0x589273=_0x54310e(_0x33e0b1,0x1,_0x356ba1(0x113c)),_0x424174=_0x54310e(_0x33e0b1,0x3,'days'),_0x1a9238=_0x54310e(_0x33e0b1,0x7,_0x356ba1(0x113c));let _0x1203b0='';if(_0x4fde8f||_0x57ef40||_0x280486||_0x589273||_0x424174||_0x1a9238){_0x1203b0+=_0x356ba1(0x805);if(_0x4fde8f)_0x1203b0+=_0x4fde8f;if(_0x57ef40)_0x1203b0+=_0x57ef40;if(_0x280486)_0x1203b0+=_0x280486;if(_0x4fde8f||_0x57ef40||_0x280486)_0x1203b0+='\x0a';if(_0x589273)_0x1203b0+=_0x589273;if(_0x424174)_0x1203b0+=_0x424174;if(_0x1a9238)_0x1203b0+=_0x1a9238;}const _0x16077d='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x33e0b1['name']+_0x356ba1(0x27e)+_0x33e0b1[_0x356ba1(0x450)]['aiPersona']+'\x0a-\x20**你的长期记忆**:\x0a'+_0x5064d3+'\x0a'+_0x5c6d87+'\x0a'+_0x1203b0+_0x356ba1(0x11e3)+_0xbd5755+_0x356ba1(0x218)+_0x261ce7+_0x356ba1(0x83c);try{const _0x269d84=[{'role':_0x356ba1(0x20d),'content':_0x356ba1(0x42a)}];let _0x3002c5=_0x426779['includes'](_0x356ba1(0x1329)),_0x385de0=_0x366263(_0x4bb87e,_0x39297a,_0x16077d,_0x269d84);const _0xb64b46=_0x3002c5?await fetch(_0x385de0[_0x356ba1(0x121f)],_0x385de0['data']):await fetch(_0x426779+_0x356ba1(0x501),{'method':_0x356ba1(0x12db),'headers':{'Content-Type':_0x356ba1(0xb1f),'Authorization':_0x356ba1(0x1265)+_0x39297a},'body':JSON[_0x356ba1(0xe1e)]({'model':_0x4bb87e,'messages':[{'role':_0x356ba1(0xe10),'content':_0x16077d},..._0x269d84],'temperature':_0x19ddb8['globalSettings'][_0x356ba1(0x4a2)]||0.9})});if(!_0xb64b46['ok'])throw new Error('API\x20错误:\x20'+_0xb64b46[_0x356ba1(0x140e)]);const _0x2493f5=await _0xb64b46['json'](),_0x2fc3a0=getGeminiResponseText(_0x2493f5),_0x4f20b6=_0x2fc3a0[_0x356ba1(0x293)](/({[\s\S]*})/);if(!_0x4f20b6)throw new Error(_0x356ba1(0xf49));const _0x46b69c=JSON[_0x356ba1(0x1447)](_0x4f20b6[0x0]);!_0x46b69c[_0x356ba1(0xf3d)]&&(_0x46b69c['purchases']=[]),_0x33e0b1['simulatedTaobaoHistory']=_0x46b69c,await _0x512070['chats'][_0x356ba1(0xd4d)](_0x33e0b1),await _0x59e056();}catch(_0x5771d6){console[_0x356ba1(0x3b7)](_0x356ba1(0x13a4),_0x5771d6),await _0x403a62('生成失败',_0x356ba1(0x236)+_0x5771d6['message']);}}function _0x200c78(){const _0x5edf71=_0x48bc6d;_0x2461ab(),_0x56e352(_0x5edf71(0x13f0));}function _0x2461ab(){const _0x1459bf=_0x48bc6d,_0x1d50c2=document['getElementById'](_0x1459bf(0x41c));_0x1d50c2[_0x1459bf(0xeb2)]='';const _0x1e7d1f=_0x19ddb8[_0x1459bf(0xb04)][_0x5a727a],_0x5a6338=_0x1e7d1f['simulatedTaobaoHistory']||{},_0x493a52=_0x5a6338[_0x1459bf(0xf3d)]||[],_0x3e52ee=_0x5a6338[_0x1459bf(0xafd)]||0x0,_0x450e3d=document[_0x1459bf(0xe94)]('div');_0x450e3d[_0x1459bf(0x20f)]['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.06);\x0a\x20\x20\x20\x20',_0x450e3d[_0x1459bf(0xeb2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22color:\x20#8a8a8a;\x20margin:\x200\x200\x2010px\x200;\x22>账户余额</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2032px;\x20font-weight:\x20600;\x20color:\x20#1f1f1f;\x20margin:\x200;\x22>¥'+_0x3e52ee[_0x1459bf(0x1322)](0x2)+_0x1459bf(0x105f),_0x1d50c2['appendChild'](_0x450e3d);const _0x2f8302=document[_0x1459bf(0xe94)]('h3');_0x2f8302[_0x1459bf(0x766)]='最近支出',_0x2f8302[_0x1459bf(0x20f)][_0x1459bf(0x6c0)]=_0x1459bf(0xac5),_0x1d50c2[_0x1459bf(0x983)](_0x2f8302);if(_0x493a52[_0x1459bf(0x106b)]===0x0){_0x1d50c2[_0x1459bf(0xeb2)]+=_0x1459bf(0xecd);return;}_0x493a52[_0x1459bf(0x15c1)](_0x3f2345=>{const _0x117dee=_0x1459bf,_0x14fd41=document[_0x117dee(0xe94)]('div');_0x14fd41[_0x117dee(0x20f)][_0x117dee(0x6c0)]=_0x117dee(0x1297),_0x14fd41['innerHTML']=_0x117dee(0xf3c)+_0x3f2345['itemName']+_0x117dee(0x4c1)+_0x3f2345[_0x117dee(0x27d)]+_0x117dee(0x7b8)+(_0x3f2345['price']||0x0)['toFixed'](0x2)+_0x117dee(0xa8e),_0x1d50c2[_0x117dee(0x983)](_0x14fd41);});}async function _0x24daba(){const _0x56658b=_0x48bc6d;if(!_0x5a727a)return;const _0x266f7d=_0x19ddb8[_0x56658b(0xb04)][_0x5a727a];if(!_0x266f7d)return;await _0x403a62(_0x56658b(0x1395),'正在请求“'+_0x266f7d[_0x56658b(0x1561)]+'”分享TA的备忘录...');const {proxyUrl:_0x33a766,apiKey:_0x5ceb7d,model:_0x50fccc}=_0x19ddb8[_0x56658b(0xd22)];if(!_0x33a766||!_0x5ceb7d||!_0x50fccc){alert(_0x56658b(0xff3));return;}const _0x50fea5=_0x19ddb8[_0x56658b(0x9ce)][_0x56658b(0x246)]===_0x56658b(0x15c8)||!_0x19ddb8[_0x56658b(0x9ce)][_0x56658b(0x246)]?'用户':_0x19ddb8[_0x56658b(0x9ce)]['nickname'],_0x394e1f=_0x266f7d[_0x56658b(0x744)]&&_0x266f7d[_0x56658b(0x744)][_0x56658b(0x106b)]>0x0?_0x266f7d[_0x56658b(0x744)][_0x56658b(0xb0a)](_0x160254=>_0x56658b(0x2ee)+_0x5d6abc(_0x160254[_0x56658b(0xd73)])+')\x20'+_0x160254[_0x56658b(0x4e3)])[_0x56658b(0x3b9)]('\x0a'):'无',_0x476efa=_0x266f7d[_0x56658b(0x450)][_0x56658b(0x152f)]||0xa,_0xc1ea96=_0x266f7d['history'][_0x56658b(0x457)](-_0x476efa)['map'](_0x7be87a=>(_0x7be87a[_0x56658b(0x11c1)]===_0x56658b(0x20d)?_0x50fea5:_0x266f7d[_0x56658b(0x1561)])+':\x20'+String(_0x7be87a[_0x56658b(0x4e3)])[_0x56658b(0x72e)](0x0,0x1e)+_0x56658b(0x4a5))[_0x56658b(0x3b9)]('\x0a'),_0x22a6ab=(_0x266f7d[_0x56658b(0x450)][_0x56658b(0x9c4)]||[])[_0x56658b(0xb0a)](_0x4b9692=>_0x19ddb8['worldBooks']['find'](_0x43fd5b=>_0x43fd5b['id']===_0x4b9692))[_0x56658b(0x1195)](Boolean)[_0x56658b(0xb0a)](_0x317de4=>_0x56658b(0x33b)+_0x317de4[_0x56658b(0x1561)]+_0x56658b(0xb7c)+_0x317de4[_0x56658b(0x4e3)][_0x56658b(0x1195)](_0xba4a7f=>_0xba4a7f[_0x56658b(0x15cd)])['map'](_0x393dc8=>'-\x20'+_0x393dc8['content'])['join']('\x0a'))['join'](''),_0x8c3db4=_0x54310e(_0x266f7d,0x3,_0x56658b(0xb41)),_0x343937=_0x54310e(_0x266f7d,0x6,_0x56658b(0xb41)),_0x4c822e=_0x54310e(_0x266f7d,0x9,_0x56658b(0xb41)),_0x430ddf=_0x54310e(_0x266f7d,0x1,_0x56658b(0x113c)),_0x16a79a=_0x54310e(_0x266f7d,0x3,'days'),_0x3bbe37=_0x54310e(_0x266f7d,0x7,_0x56658b(0x113c));let _0x310e05='';if(_0x8c3db4||_0x343937||_0x4c822e||_0x430ddf||_0x16a79a||_0x3bbe37){_0x310e05+=_0x56658b(0x805);if(_0x8c3db4)_0x310e05+=_0x8c3db4;if(_0x343937)_0x310e05+=_0x343937;if(_0x4c822e)_0x310e05+=_0x4c822e;if(_0x8c3db4||_0x343937||_0x4c822e)_0x310e05+='\x0a';if(_0x430ddf)_0x310e05+=_0x430ddf;if(_0x16a79a)_0x310e05+=_0x16a79a;if(_0x3bbe37)_0x310e05+=_0x3bbe37;}const _0x42d643=_0x266f7d['settings']['myPersona']||_0x56658b(0x1318),_0x20d80b=_0x56658b(0x2c8)+_0x266f7d[_0x56658b(0x1561)]+_0x56658b(0x896)+_0x266f7d['settings'][_0x56658b(0x1c3)]+_0x56658b(0x1014)+_0x42d643+_0x56658b(0x3fe)+_0x394e1f+'\x0a'+_0x22a6ab+'\x0a'+_0x310e05+_0x56658b(0xd58)+_0x50fea5+_0x56658b(0x218)+_0xc1ea96+_0x56658b(0x688);try{const _0x202b13=[{'role':_0x56658b(0x20d),'content':_0x56658b(0x13b8)}];let _0x31ca49=_0x33a766[_0x56658b(0x478)](_0x56658b(0x1329)),_0x2c7f8c=_0x366263(_0x50fccc,_0x5ceb7d,_0x20d80b,_0x202b13);const _0x44528a=_0x31ca49?await fetch(_0x2c7f8c[_0x56658b(0x121f)],_0x2c7f8c[_0x56658b(0x38c)]):await fetch(_0x33a766+_0x56658b(0x501),{'method':_0x56658b(0x12db),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x5ceb7d},'body':JSON['stringify']({'model':_0x50fccc,'messages':[{'role':'system','content':_0x20d80b},..._0x202b13],'temperature':_0x19ddb8['globalSettings'][_0x56658b(0x4a2)]||0.9})});if(!_0x44528a['ok']){const _0x17e9ab=await _0x44528a['json']()['catch'](()=>null),_0x1e6e41=_0x17e9ab?.[_0x56658b(0x3b7)]?.[_0x56658b(0xcce)]||_0x44528a[_0x56658b(0x140e)];throw new Error(_0x56658b(0x786)+_0x44528a[_0x56658b(0x27d)]+'\x20-\x20'+_0x1e6e41);}const _0x53481a=await _0x44528a[_0x56658b(0xa5d)](),_0x82ad14=getGeminiResponseText(_0x53481a),_0x93d81c=_0x82ad14[_0x56658b(0x293)](/(\[[\s\S]*\])/);if(!_0x93d81c||!_0x93d81c[0x0])throw new Error(_0x56658b(0x1178)+_0x82ad14);const _0x4094c4=_0x93d81c[0x0];let _0x476eb;try{_0x476eb=JSON[_0x56658b(0x1447)](_0x4094c4);}catch(_0x46193e){throw new Error(_0x56658b(0x4bb)+_0x46193e[_0x56658b(0xcce)]+'\x0a\x0aAI原始返回内容:\x0a'+_0x82ad14);}if(!Array[_0x56658b(0xb9b)](_0x476eb))throw new Error(_0x56658b(0x1a1)+JSON[_0x56658b(0xe1e)](_0x476eb));_0x266f7d[_0x56658b(0xbc0)]=_0x476eb[_0x56658b(0xb0a)](_0x121e05=>({'id':Date[_0x56658b(0x64b)]()+Math[_0x56658b(0xdcd)](),'title':_0x121e05[_0x56658b(0x10b8)],'content':_0x121e05[_0x56658b(0x4e3)]})),await _0x512070['chats']['put'](_0x266f7d),await _0x4aa620();}catch(_0x4865cc){console[_0x56658b(0x3b7)](_0x56658b(0x12b8),_0x4865cc),await _0x403a62(_0x56658b(0x8e8),_0x56658b(0x3cb)+_0x4865cc['message']);}}async function _0x2424f1(){const _0x1ecb86=_0x48bc6d;if(!_0x5a727a)return;const _0x44c87f=_0x19ddb8[_0x1ecb86(0xb04)][_0x5a727a];if(!_0x44c87f)return;await _0x403a62(_0x1ecb86(0x1395),'正在生成“'+_0x44c87f['name']+_0x1ecb86(0xa88));const {proxyUrl:_0x140c48,apiKey:_0x2b78dc,model:_0x531ebb}=_0x19ddb8[_0x1ecb86(0xd22)];if(!_0x140c48||!_0x2b78dc||!_0x531ebb){alert(_0x1ecb86(0x487));return;}const _0x3457e4=_0x19ddb8[_0x1ecb86(0x9ce)][_0x1ecb86(0x246)]===_0x1ecb86(0x15c8)||!_0x19ddb8[_0x1ecb86(0x9ce)]['nickname']?'用户':_0x19ddb8[_0x1ecb86(0x9ce)][_0x1ecb86(0x246)],_0x588da6=_0x44c87f['longTermMemory']&&_0x44c87f[_0x1ecb86(0x744)][_0x1ecb86(0x106b)]>0x0?_0x44c87f['longTermMemory'][_0x1ecb86(0xb0a)](_0x8e86aa=>_0x1ecb86(0x2ee)+_0x5d6abc(_0x8e86aa[_0x1ecb86(0xd73)])+')\x20'+_0x8e86aa['content'])[_0x1ecb86(0x3b9)]('\x0a'):'无',_0x1e06c8=_0x44c87f[_0x1ecb86(0x450)]['maxMemory']||0xa,_0x458ab3=_0x44c87f[_0x1ecb86(0x1f0)][_0x1ecb86(0x457)](-_0x1e06c8)[_0x1ecb86(0xb0a)](_0x29f9d2=>(_0x29f9d2['role']===_0x1ecb86(0x20d)?_0x3457e4:_0x44c87f['name'])+':\x20'+String(_0x29f9d2[_0x1ecb86(0x4e3)])[_0x1ecb86(0x72e)](0x0,0x1e)+_0x1ecb86(0x4a5))[_0x1ecb86(0x3b9)]('\x0a'),_0x5ddcdf=(_0x44c87f['settings']['linkedWorldBookIds']||[])[_0x1ecb86(0xb0a)](_0x2654fc=>_0x19ddb8[_0x1ecb86(0x8e4)][_0x1ecb86(0xd62)](_0x30b53a=>_0x30b53a['id']===_0x2654fc))[_0x1ecb86(0x1195)](Boolean)[_0x1ecb86(0xb0a)](_0x3301ac=>_0x1ecb86(0x33b)+_0x3301ac[_0x1ecb86(0x1561)]+_0x1ecb86(0xb7c)+_0x3301ac[_0x1ecb86(0x4e3)][_0x1ecb86(0x1195)](_0x145c16=>_0x145c16['enabled'])[_0x1ecb86(0xb0a)](_0x137af9=>'-\x20'+_0x137af9['content'])[_0x1ecb86(0x3b9)]('\x0a'))['join'](''),_0x6a65dd=_0x54310e(_0x44c87f,0x3,_0x1ecb86(0xb41)),_0x4faaef=_0x54310e(_0x44c87f,0x6,_0x1ecb86(0xb41)),_0x3ece11=_0x54310e(_0x44c87f,0x9,_0x1ecb86(0xb41)),_0x2d36b5=_0x54310e(_0x44c87f,0x1,_0x1ecb86(0x113c)),_0x50a955=_0x54310e(_0x44c87f,0x3,_0x1ecb86(0x113c)),_0x4ffce8=_0x54310e(_0x44c87f,0x7,_0x1ecb86(0x113c));let _0x40dae0='';if(_0x6a65dd||_0x4faaef||_0x3ece11||_0x2d36b5||_0x50a955||_0x4ffce8){_0x40dae0+=_0x1ecb86(0x805);if(_0x6a65dd)_0x40dae0+=_0x6a65dd;if(_0x4faaef)_0x40dae0+=_0x4faaef;if(_0x3ece11)_0x40dae0+=_0x3ece11;if(_0x6a65dd||_0x4faaef||_0x3ece11)_0x40dae0+='\x0a';if(_0x2d36b5)_0x40dae0+=_0x2d36b5;if(_0x50a955)_0x40dae0+=_0x50a955;if(_0x4ffce8)_0x40dae0+=_0x4ffce8;}const _0x2f9149=_0x1ecb86(0x2c8)+_0x44c87f['name']+_0x1ecb86(0xb07)+new Date()[_0x1ecb86(0xccf)]()+_0x1ecb86(0x14ab)+_0x44c87f[_0x1ecb86(0x450)][_0x1ecb86(0x1c3)]+_0x1ecb86(0x3fe)+_0x588da6+'\x0a'+_0x5ddcdf+'\x0a'+_0x40dae0+'\x0a-\x20**你最近和“'+_0x3457e4+'”的对话摘要**:\x0a'+_0x458ab3+'\x0a\x0a现在，请开始生成这组足迹记录。';try{const _0x17f085=[{'role':'user','content':_0x1ecb86(0xec4)}];let _0x43125c=_0x140c48['includes'](_0x1ecb86(0x1329)),_0x4b6d93=_0x366263(_0x531ebb,_0x2b78dc,_0x2f9149,_0x17f085);const _0x3926db=_0x43125c?await fetch(_0x4b6d93[_0x1ecb86(0x121f)],_0x4b6d93[_0x1ecb86(0x38c)]):await fetch(_0x140c48+_0x1ecb86(0x501),{'method':'POST','headers':{'Content-Type':_0x1ecb86(0xb1f),'Authorization':'Bearer\x20'+_0x2b78dc},'body':JSON[_0x1ecb86(0xe1e)]({'model':_0x531ebb,'messages':[{'role':_0x1ecb86(0xe10),'content':_0x2f9149},..._0x17f085],'temperature':_0x19ddb8[_0x1ecb86(0x4c8)][_0x1ecb86(0x4a2)]||0.9})});if(!_0x3926db['ok'])throw new Error(_0x1ecb86(0x786)+_0x3926db[_0x1ecb86(0x140e)]);const _0x363957=await _0x3926db[_0x1ecb86(0xa5d)](),_0x49608f=getGeminiResponseText(_0x363957),_0x23d14c=_0x49608f[_0x1ecb86(0x293)](/(\[[\s\S]*\])/);if(!_0x23d14c||!_0x23d14c[0x0])throw new Error(_0x1ecb86(0x1178)+_0x49608f);const _0x355bb0=_0x23d14c[0x0];let _0x3db590;try{_0x3db590=JSON[_0x1ecb86(0x1447)](_0x355bb0);}catch(_0x5c736a){throw new Error('解析AI返回的JSON时出错:\x20'+_0x5c736a[_0x1ecb86(0xcce)]+_0x1ecb86(0x8f2)+_0x49608f);}_0x44c87f[_0x1ecb86(0x11a9)]=_0x3db590,await _0x512070[_0x1ecb86(0xb04)][_0x1ecb86(0xd4d)](_0x44c87f),await _0x514e12();}catch(_0x5bf84a){console['error'](_0x1ecb86(0xa5f),_0x5bf84a),await _0x403a62(_0x1ecb86(0x8e8),'无法生成足迹，请检查API配置或稍后再试。\x0a错误:\x20'+_0x5bf84a['message']);}}function _0x514e12(){const _0x3f86e7=_0x48bc6d,_0x348259=document['getElementById'](_0x3f86e7(0x51a));_0x348259['innerHTML']='';if(!_0x5a727a)return;const _0x1b7746=_0x19ddb8['chats'][_0x5a727a],_0x2ff73d=_0x1b7746[_0x3f86e7(0x11a9)]||[];if(_0x2ff73d[_0x3f86e7(0x106b)]===0x0){_0x348259[_0x3f86e7(0xeb2)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有留下任何足迹，<br>点击右上角刷新按钮生成一些记录吧！</p>';return;}_0x2ff73d['forEach'](_0x523b5f=>{const _0x31672d=_0x3f86e7,_0x58a62d=document[_0x31672d(0xe94)](_0x31672d(0x8ca));_0x58a62d[_0x31672d(0x1487)]=_0x31672d(0xaf2);let _0x11bfad='';if(_0x523b5f['image_prompt']){const _0x53c3f2=_0x31672d(0x10a3)+encodeURIComponent(_0x523b5f[_0x31672d(0xb95)]);_0x11bfad=_0x31672d(0x849)+_0x53c3f2+_0x31672d(0xe2b)+_0x523b5f[_0x31672d(0x79d)]+'\x22></div>';}const _0x4d566b=_0x523b5f[_0x31672d(0xd73)]?_0x5d6abc(new Date(_0x523b5f[_0x31672d(0xd73)])['getTime']()):'某个时间';_0x58a62d[_0x31672d(0xeb2)]=_0x31672d(0x3a7)+_0x523b5f[_0x31672d(0x135d)]+_0x31672d(0xa6e)+_0x523b5f['address']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-comment\x22>'+_0x523b5f[_0x31672d(0x79d)][_0x31672d(0x1bb)](/\n/g,_0x31672d(0x609))+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x11bfad+_0x31672d(0x11fb)+_0x4d566b+_0x31672d(0xa29),_0x348259['appendChild'](_0x58a62d);});}async function _0x3a3d50(){const _0x54be20=_0x48bc6d;if(!_0x5a727a)return;const _0x21df3b=_0x19ddb8[_0x54be20(0xb04)][_0x5a727a];if(!_0x21df3b)return;await _0x403a62(_0x54be20(0x1395),_0x54be20(0xb1d)+_0x21df3b['name']+_0x54be20(0xf28));const {proxyUrl:_0x14f862,apiKey:_0x3ccbc8,model:_0x1a32cd}=_0x19ddb8[_0x54be20(0xd22)];if(!_0x14f862||!_0x3ccbc8||!_0x1a32cd){alert(_0x54be20(0x487));return;}const _0x544ba9=_0x19ddb8['qzoneSettings'][_0x54be20(0x246)]==='{{user}}'||!_0x19ddb8[_0x54be20(0x9ce)][_0x54be20(0x246)]?'用户':_0x19ddb8['qzoneSettings'][_0x54be20(0x246)],_0x153099=_0x21df3b[_0x54be20(0x744)]&&_0x21df3b[_0x54be20(0x744)][_0x54be20(0x106b)]>0x0?_0x21df3b[_0x54be20(0x744)][_0x54be20(0xb0a)](_0x20369=>_0x54be20(0x2ee)+_0x5d6abc(_0x20369[_0x54be20(0xd73)])+')\x20'+_0x20369['content'])[_0x54be20(0x3b9)]('\x0a'):'无',_0x417040=_0x21df3b['settings']['maxMemory']||0xa,_0x2195d3=_0x21df3b[_0x54be20(0x1f0)]['slice'](-_0x417040)[_0x54be20(0xb0a)](_0x1e41a4=>(_0x1e41a4[_0x54be20(0x11c1)]===_0x54be20(0x20d)?_0x544ba9:_0x21df3b[_0x54be20(0x1561)])+':\x20'+String(_0x1e41a4['content'])[_0x54be20(0x72e)](0x0,0x1e)+_0x54be20(0x4a5))[_0x54be20(0x3b9)]('\x0a'),_0x3fe4c2=(_0x21df3b[_0x54be20(0x450)][_0x54be20(0x9c4)]||[])['map'](_0x2a1fdf=>_0x19ddb8[_0x54be20(0x8e4)][_0x54be20(0xd62)](_0x44f49f=>_0x44f49f['id']===_0x2a1fdf))[_0x54be20(0x1195)](Boolean)['map'](_0x2293d8=>_0x54be20(0x33b)+_0x2293d8[_0x54be20(0x1561)]+_0x54be20(0xb7c)+_0x2293d8[_0x54be20(0x4e3)][_0x54be20(0x1195)](_0x4e6fd8=>_0x4e6fd8['enabled'])[_0x54be20(0xb0a)](_0x1eb473=>'-\x20'+_0x1eb473[_0x54be20(0x4e3)])[_0x54be20(0x3b9)]('\x0a'))[_0x54be20(0x3b9)](''),_0x41fa38=_0x54310e(_0x21df3b,0x3,'hours'),_0x239ae4=_0x54310e(_0x21df3b,0x6,_0x54be20(0xb41)),_0x492fa8=_0x54310e(_0x21df3b,0x9,_0x54be20(0xb41)),_0x4cd166=_0x54310e(_0x21df3b,0x1,_0x54be20(0x113c)),_0x573e75=_0x54310e(_0x21df3b,0x3,'days'),_0x7feb8a=_0x54310e(_0x21df3b,0x7,_0x54be20(0x113c));let _0x51a8f0='';if(_0x41fa38||_0x239ae4||_0x492fa8||_0x4cd166||_0x573e75||_0x7feb8a){_0x51a8f0+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x41fa38)_0x51a8f0+=_0x41fa38;if(_0x239ae4)_0x51a8f0+=_0x239ae4;if(_0x492fa8)_0x51a8f0+=_0x492fa8;if(_0x41fa38||_0x239ae4||_0x492fa8)_0x51a8f0+='\x0a';if(_0x4cd166)_0x51a8f0+=_0x4cd166;if(_0x573e75)_0x51a8f0+=_0x573e75;if(_0x7feb8a)_0x51a8f0+=_0x7feb8a;}const _0x4821c4=_0x54be20(0x2c8)+_0x21df3b[_0x54be20(0x1561)]+_0x54be20(0x821)+_0x21df3b[_0x54be20(0x450)][_0x54be20(0x1c3)]+_0x54be20(0x3fe)+_0x153099+'\x0a'+_0x3fe4c2+'\x0a'+_0x51a8f0+'\x0a-\x20**你最近和“'+_0x544ba9+_0x54be20(0x218)+_0x2195d3+_0x54be20(0xdda);try{const _0x4fb7fa=[{'role':'user','content':_0x54be20(0x1099)}];let _0x3609c7=_0x14f862['includes'](_0x54be20(0x1329)),_0x16b3e3=_0x366263(_0x1a32cd,_0x3ccbc8,_0x4821c4,_0x4fb7fa);const _0x4115dc=_0x3609c7?await fetch(_0x16b3e3[_0x54be20(0x121f)],_0x16b3e3[_0x54be20(0x38c)]):await fetch(_0x14f862+_0x54be20(0x501),{'method':_0x54be20(0x12db),'headers':{'Content-Type':_0x54be20(0xb1f),'Authorization':'Bearer\x20'+_0x3ccbc8},'body':JSON[_0x54be20(0xe1e)]({'model':_0x1a32cd,'messages':[{'role':_0x54be20(0xe10),'content':_0x4821c4},..._0x4fb7fa],'temperature':_0x19ddb8['globalSettings']['apiTemperature']||0.9})});if(!_0x4115dc['ok'])throw new Error(_0x54be20(0x786)+_0x4115dc[_0x54be20(0x140e)]);const _0x5aa80e=await _0x4115dc[_0x54be20(0xa5d)](),_0x24bb8c=getGeminiResponseText(_0x5aa80e),_0x20f72f=_0x24bb8c[_0x54be20(0x1bb)](/^```json\s*/,'')['replace'](/```$/,''),_0x2c23cd=JSON[_0x54be20(0x1447)](_0x20f72f);_0x21df3b['simulatedAppUsage']=_0x2c23cd,await _0x512070[_0x54be20(0xb04)]['put'](_0x21df3b),await _0x1a62f4();}catch(_0xb96421){console[_0x54be20(0x3b7)](_0x54be20(0x10cf),_0xb96421),await _0x403a62(_0x54be20(0x8e8),_0x54be20(0x13a3)+_0xb96421['message']);}}function _0x1a62f4(){const _0x3eb0c5=_0x48bc6d,_0x247252=document[_0x3eb0c5(0x9a3)](_0x3eb0c5(0x6fb));_0x247252[_0x3eb0c5(0xeb2)]='';if(!_0x5a727a)return;const _0x2efac2=_0x19ddb8[_0x3eb0c5(0xb04)][_0x5a727a],_0x36ae7c=(_0x2efac2[_0x3eb0c5(0x1276)]||[])[_0x3eb0c5(0x6a2)]((_0x1150d9,_0x4bd099)=>_0x4bd099[_0x3eb0c5(0xb56)]-_0x1150d9['usageTimeMinutes']);if(_0x36ae7c['length']===0x0){_0x247252['innerHTML']=_0x3eb0c5(0x8fe);return;}_0x36ae7c[_0x3eb0c5(0x15c1)](_0x1f259f=>{const _0x2f75fb=_0x3eb0c5,_0x17d9fb=document[_0x2f75fb(0xe94)](_0x2f75fb(0x8ca));_0x17d9fb['className']=_0x2f75fb(0xdbf);const _0x1aeaa1=Math[_0x2f75fb(0xd95)](_0x1f259f[_0x2f75fb(0xb56)]/0x3c),_0x335855=_0x1f259f['usageTimeMinutes']%0x3c;let _0x4a4078='';if(_0x1aeaa1>0x0)_0x4a4078+=_0x1aeaa1+'小时';if(_0x335855>0x0)_0x4a4078+=_0x335855+'分钟';if(!_0x4a4078)_0x4a4078='小于1分钟';const _0xcd0acd=_0x1f259f[_0x2f75fb(0xb95)]||_0x2f75fb(0xfa1)+_0x1f259f['appName']+_0x2f75fb(0xa50),_0xb3ad9b='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0xcd0acd);_0x17d9fb[_0x2f75fb(0xeb2)]=_0x2f75fb(0x5f0)+_0xb3ad9b+_0x2f75fb(0xeca)+_0x1f259f[_0x2f75fb(0x11cd)]+_0x2f75fb(0x1079)+_0x1f259f['category']+_0x2f75fb(0x850)+_0x4a4078+_0x2f75fb(0xa29),_0x247252['appendChild'](_0x17d9fb);});}async function _0x20fc3a(){const _0x4211bb=_0x48bc6d;if(!_0x5a727a)return;const _0x55cfc1=_0x19ddb8[_0x4211bb(0xb04)][_0x5a727a];if(!_0x55cfc1)return;await _0x403a62(_0x4211bb(0x1395),_0x4211bb(0x789)+_0x55cfc1[_0x4211bb(0x1561)]+_0x4211bb(0xfbe));const {proxyUrl:_0x11376b,apiKey:_0x4ba20d,model:_0xb940b6}=_0x19ddb8[_0x4211bb(0xd22)];if(!_0x11376b||!_0x4ba20d||!_0xb940b6){alert(_0x4211bb(0xff3));return;}const _0x35deed=_0x19ddb8[_0x4211bb(0x9ce)][_0x4211bb(0x246)]===_0x4211bb(0x15c8)||!_0x19ddb8[_0x4211bb(0x9ce)][_0x4211bb(0x246)]?'用户':_0x19ddb8[_0x4211bb(0x9ce)]['nickname'],_0x372025=_0x55cfc1['longTermMemory']&&_0x55cfc1[_0x4211bb(0x744)]['length']>0x0?_0x55cfc1[_0x4211bb(0x744)][_0x4211bb(0xb0a)](_0x4fc8da=>_0x4211bb(0x2ee)+_0x5d6abc(_0x4fc8da[_0x4211bb(0xd73)])+')\x20'+_0x4fc8da['content'])[_0x4211bb(0x3b9)]('\x0a'):'无',_0x18659d=_0x55cfc1[_0x4211bb(0x450)][_0x4211bb(0x152f)]||0xa,_0x5dab21=_0x55cfc1[_0x4211bb(0x1f0)][_0x4211bb(0x457)](-_0x18659d)[_0x4211bb(0xb0a)](_0x11ef24=>(_0x11ef24[_0x4211bb(0x11c1)]==='user'?_0x35deed:_0x55cfc1['name'])+':\x20'+String(_0x11ef24[_0x4211bb(0x4e3)])[_0x4211bb(0x72e)](0x0,0x1e)+'...')[_0x4211bb(0x3b9)]('\x0a'),_0x627851=(_0x55cfc1['settings'][_0x4211bb(0x9c4)]||[])[_0x4211bb(0xb0a)](_0x3b4dd9=>_0x19ddb8[_0x4211bb(0x8e4)]['find'](_0x17ec2e=>_0x17ec2e['id']===_0x3b4dd9))['filter'](Boolean)[_0x4211bb(0xb0a)](_0x4b45d5=>_0x4211bb(0x33b)+_0x4b45d5[_0x4211bb(0x1561)]+_0x4211bb(0xb7c)+_0x4b45d5['content']['filter'](_0x25edf5=>_0x25edf5['enabled'])[_0x4211bb(0xb0a)](_0x2a30f0=>'-\x20'+_0x2a30f0[_0x4211bb(0x4e3)])['join']('\x0a'))['join'](''),_0x56c5fd=_0x4211bb(0x10a0)+_0x55cfc1['name']+_0x4211bb(0x908)+_0x55cfc1[_0x4211bb(0x450)][_0x4211bb(0x1c3)]+_0x4211bb(0x3fe)+_0x372025+'\x0a'+_0x627851+'\x0a-\x20**你最近和“'+_0x35deed+_0x4211bb(0x218)+_0x5dab21+_0x4211bb(0x1464);try{const _0x31eb76=[{'role':_0x4211bb(0x20d),'content':_0x4211bb(0xd69)}];let _0x5d01ca=_0x11376b['includes']('generativelanguage'),_0x3eb18e=_0x366263(_0xb940b6,_0x4ba20d,_0x56c5fd,_0x31eb76);const _0x598afd=_0x5d01ca?await fetch(_0x3eb18e[_0x4211bb(0x121f)],_0x3eb18e[_0x4211bb(0x38c)]):await fetch(_0x11376b+_0x4211bb(0x501),{'method':'POST','headers':{'Content-Type':_0x4211bb(0xb1f),'Authorization':_0x4211bb(0x1265)+_0x4ba20d},'body':JSON[_0x4211bb(0xe1e)]({'model':_0xb940b6,'messages':[{'role':_0x4211bb(0xe10),'content':_0x56c5fd},..._0x31eb76],'temperature':_0x19ddb8[_0x4211bb(0x4c8)][_0x4211bb(0x4a2)]||0x1})});if(!_0x598afd['ok'])throw new Error(_0x4211bb(0x786)+_0x598afd['statusText']);const _0x2fac19=await _0x598afd['json'](),_0x5b00f5=getGeminiResponseText(_0x2fac19),_0x70e0d6=_0x5b00f5[_0x4211bb(0x1bb)](/^```json\s*/,'')[_0x4211bb(0x1bb)](/```$/,''),_0x370c5f=JSON[_0x4211bb(0x1447)](_0x70e0d6);await _0x403a62(_0x4211bb(0x1395),'歌单已生成，正在从网络获取\x20'+_0x370c5f[_0x4211bb(0x106b)]+_0x4211bb(0x11f3));const _0x1a34ba=_0x370c5f['map'](async _0xdc6b0=>{const _0x5ea155=_0x4211bb;let _0x543532=await _0x35a236(_0xdc6b0['songName'],_0xdc6b0[_0x5ea155(0x150d)]);(!_0x543532||_0x543532[_0x5ea155(0x106b)]===0x0)&&(_0x543532=await _0x368f7b(_0xdc6b0[_0x5ea155(0x5be)]));if(_0x543532[_0x5ea155(0x106b)]>0x0)return _0xc892ac(_0x543532[0x0]);return console[_0x5ea155(0x651)](_0x5ea155(0x14e9)+_0xdc6b0[_0x5ea155(0x5be)]+_0x5ea155(0x1452)+_0xdc6b0[_0x5ea155(0x150d)]+'”'),null;}),_0x381592=(await Promise[_0x4211bb(0xbf1)](_0x1a34ba))[_0x4211bb(0x1195)](Boolean);_0x55cfc1[_0x4211bb(0xcd1)]=_0x381592,await _0x512070[_0x4211bb(0xb04)][_0x4211bb(0xd4d)](_0x55cfc1),await _0x4e92ef();}catch(_0x1a91c8){console['error'](_0x4211bb(0xa39),_0x1a91c8),await _0x403a62(_0x4211bb(0x8e8),_0x4211bb(0x925)+_0x1a91c8[_0x4211bb(0xcce)]);}}function _0x4e92ef(){const _0x481f50=_0x48bc6d,_0x1ee277=document[_0x481f50(0x9a3)](_0x481f50(0x13b6));_0x1ee277[_0x481f50(0xeb2)]='';if(!_0x5a727a)return;const _0x4ba1fd=_0x19ddb8[_0x481f50(0xb04)][_0x5a727a],_0x640eec=_0x4ba1fd[_0x481f50(0xcd1)]||[];if(_0x640eec[_0x481f50(0x106b)]===0x0){_0x1ee277['innerHTML']=_0x481f50(0x110b);return;}_0x640eec[_0x481f50(0x15c1)]((_0x44f6a5,_0xcab8f7)=>{const _0x43a840=_0x481f50,_0x54ac65=document['createElement']('div');_0x54ac65[_0x43a840(0x1487)]=_0x43a840(0x60b),_0x54ac65[_0x43a840(0xeb2)]=_0x43a840(0x13ff)+_0x44f6a5[_0x43a840(0x159e)]+_0x43a840(0xa05)+_0x44f6a5[_0x43a840(0x1561)]+_0x43a840(0x1187)+_0x44f6a5[_0x43a840(0xf6d)]+_0x43a840(0x11b5),_0x54ac65[_0x43a840(0x954)]('click',()=>_0x51125d(_0x44f6a5)),_0x1ee277['appendChild'](_0x54ac65);});}let _0x553af9={'currentPlaylist':[],'currentIndex':-0x1,'isPlaying':![],'playMode':_0x48bc6d(0x1111),'lrcUpdateInterval':null,'parsedLyrics':[],'currentLyricIndex':-0x1};function _0x51125d(_0x512324){const _0x52f149=_0x48bc6d,_0xc3f324=document[_0x52f149(0x9a3)](_0x52f149(0xb62)),_0x26c8fe=document[_0x52f149(0x9a3)](_0x52f149(0x358));if(_0x553af9[_0x52f149(0x1586)])clearInterval(_0x553af9[_0x52f149(0x1586)]);_0xc3f324['pause']();const _0x2375c7=_0x553af9['currentPlaylist'][_0x52f149(0x455)](_0x2cdea4=>_0x2cdea4[_0x52f149(0x10d4)]===_0x512324[_0x52f149(0x10d4)]);_0x2375c7>-0x1?_0x553af9[_0x52f149(0xfe2)]=_0x2375c7:(_0x553af9[_0x52f149(0xca3)]=[_0x512324],_0x553af9[_0x52f149(0xfe2)]=0x0);document['getElementById'](_0x52f149(0x1461))[_0x52f149(0x766)]=_0x512324[_0x52f149(0x1561)],document[_0x52f149(0x9a3)]('char-music-artist')[_0x52f149(0x766)]=_0x512324[_0x52f149(0xf6d)],document[_0x52f149(0x9a3)](_0x52f149(0x1320))['src']=_0x512324[_0x52f149(0x159e)],_0x553af9['parsedLyrics']=_0x7a1175(_0x512324[_0x52f149(0x1531)]||''),_0x1ae2ed();if(_0x512324[_0x52f149(0x1460)]){const _0x2a9a7e=new Blob([_0x512324['src']],{'type':_0x512324['fileType']||_0x52f149(0x13c3)});_0xc3f324[_0x52f149(0x10d4)]=URL['createObjectURL'](_0x2a9a7e);}else _0xc3f324['src']=_0x512324[_0x52f149(0x10d4)];_0xc3f324[_0x52f149(0x156e)]()['catch'](_0x45dd74=>console[_0x52f149(0x3b7)](_0x52f149(0x12a8),_0x45dd74)),_0xc3f324[_0x52f149(0x117b)]=()=>{const _0x49cb52=_0x52f149;document[_0x49cb52(0x9a3)](_0x49cb52(0x937))[_0x49cb52(0x766)]=_0x406c2c(_0xc3f324[_0x49cb52(0xf58)]),_0x553af9[_0x49cb52(0x1586)]=setInterval(_0x1cea3b,0x1f4);},_0x26c8fe[_0x52f149(0x4d8)]['add']('visible');}function _0x46776a(){const _0x5261b0=_0x48bc6d,_0x117c74=document['getElementById']('char-music-player-modal'),_0x347121=document[_0x5261b0(0x9a3)](_0x5261b0(0xb62));if(_0x553af9[_0x5261b0(0x1586)])clearInterval(_0x553af9[_0x5261b0(0x1586)]);_0x347121[_0x5261b0(0x201)](),_0x347121[_0x5261b0(0x10d4)]='',_0x117c74['classList'][_0x5261b0(0x133d)](_0x5261b0(0xc09)),_0x553af9[_0x5261b0(0xce1)]=![],document[_0x5261b0(0x9a3)](_0x5261b0(0x464))[_0x5261b0(0x4d8)][_0x5261b0(0x133d)]('spinning');}function _0x1cea3b(){const _0x3e7d4a=_0x48bc6d,_0x49d1a9=document[_0x3e7d4a(0x9a3)]('char-audio-player');if(!_0x49d1a9[_0x3e7d4a(0xf58)])return;const _0x155605=_0x49d1a9[_0x3e7d4a(0x7d5)],_0x2e7550=_0x49d1a9[_0x3e7d4a(0xf58)];document[_0x3e7d4a(0x9a3)](_0x3e7d4a(0x14b2))[_0x3e7d4a(0x20f)][_0x3e7d4a(0xeb0)]=_0x155605/_0x2e7550*0x64+'%',document[_0x3e7d4a(0x9a3)](_0x3e7d4a(0x122b))[_0x3e7d4a(0x766)]=_0x406c2c(_0x155605),_0x42e9a9(_0x155605);}function _0x1ae2ed(){const _0x16c7d7=_0x48bc6d,_0xdd4162=document[_0x16c7d7(0x9a3)](_0x16c7d7(0xdc7));_0xdd4162[_0x16c7d7(0xeb2)]='',_0x553af9[_0x16c7d7(0x8fa)]=-0x1;if(!_0x553af9[_0x16c7d7(0xa1d)]||_0x553af9[_0x16c7d7(0xa1d)][_0x16c7d7(0x106b)]===0x0){_0xdd4162['innerHTML']='<p>♪\x20暂无歌词\x20♪</p>';return;}_0x553af9['parsedLyrics'][_0x16c7d7(0x15c1)]((_0x2407ee,_0x3961b1)=>{const _0x143656=_0x16c7d7,_0x568a40=document[_0x143656(0xe94)]('p');_0x568a40[_0x143656(0x766)]=_0x2407ee['text'],_0x568a40['dataset'][_0x143656(0x111b)]=_0x3961b1,_0xdd4162[_0x143656(0x983)](_0x568a40);});}function _0x42e9a9(_0x23c935){const _0x19d6e0=_0x48bc6d,_0x5c76fc=_0x553af9[_0x19d6e0(0xa1d)];if(_0x5c76fc['length']===0x0)return;let _0x10a62c=-0x1;for(let _0x57cdf7=0x0;_0x57cdf7<_0x5c76fc[_0x19d6e0(0x106b)];_0x57cdf7++){if(_0x23c935>=_0x5c76fc[_0x57cdf7]['time'])_0x10a62c=_0x57cdf7;else break;}if(_0x10a62c===_0x553af9[_0x19d6e0(0x8fa)])return;_0x553af9[_0x19d6e0(0x8fa)]=_0x10a62c;const _0x2311d1=document['getElementById'](_0x19d6e0(0xdc7)),_0x542b48=_0x2311d1['querySelectorAll']('p');_0x542b48['forEach'](_0x272c61=>_0x272c61['classList']['remove'](_0x19d6e0(0xe9f)));if(_0x10a62c>-0x1){const _0x15bc58=_0x2311d1['querySelector'](_0x19d6e0(0x89f)+_0x10a62c+'\x22]');if(_0x15bc58){_0x15bc58['classList'][_0x19d6e0(0xe05)](_0x19d6e0(0xe9f));const _0x339726=_0x2311d1[_0x19d6e0(0xa22)]/0x2-_0x15bc58['offsetTop']-_0x15bc58[_0x19d6e0(0x1206)]/0x2;_0x542b48[_0x19d6e0(0x15c1)](_0x8e1c60=>{const _0x23f86c=_0x19d6e0;_0x8e1c60[_0x23f86c(0x20f)][_0x23f86c(0x352)]=_0x23f86c(0x42c)+_0x339726+'px)';});}}}function _0x16f3ca(){const _0x2cb0b8=_0x48bc6d;if(_0x553af9[_0x2cb0b8(0xca3)][_0x2cb0b8(0x106b)]===0x0)return;let _0x94d477;switch(_0x553af9[_0x2cb0b8(0x1219)]){case _0x2cb0b8(0xdcd):_0x94d477=Math[_0x2cb0b8(0xd95)](Math[_0x2cb0b8(0xdcd)]()*_0x553af9['currentPlaylist'][_0x2cb0b8(0x106b)]);break;case _0x2cb0b8(0x1115):_0x51125d(_0x553af9['currentPlaylist'][_0x553af9[_0x2cb0b8(0xfe2)]]);return;case _0x2cb0b8(0x1111):default:_0x94d477=(_0x553af9[_0x2cb0b8(0xfe2)]+0x1)%_0x553af9['currentPlaylist']['length'];break;}_0x51125d(_0x553af9[_0x2cb0b8(0xca3)][_0x94d477]);}function _0x55fe8f(){const _0x199b3d=_0x48bc6d;if(_0x553af9[_0x199b3d(0xca3)][_0x199b3d(0x106b)]===0x0)return;const _0x5aee28=(_0x553af9[_0x199b3d(0xfe2)]-0x1+_0x553af9[_0x199b3d(0xca3)]['length'])%_0x553af9[_0x199b3d(0xca3)][_0x199b3d(0x106b)];_0x51125d(_0x553af9[_0x199b3d(0xca3)][_0x5aee28]);}function _0xcd79b3(){const _0x1a8eee=_0x48bc6d,_0x2a72fb=[_0x1a8eee(0x1111),_0x1a8eee(0xdcd),_0x1a8eee(0x1115)],_0x5a7926=_0x2a72fb[_0x1a8eee(0xef5)](_0x553af9[_0x1a8eee(0x1219)]);_0x553af9[_0x1a8eee(0x1219)]=_0x2a72fb[(_0x5a7926+0x1)%_0x2a72fb[_0x1a8eee(0x106b)]],document[_0x1a8eee(0x9a3)]('char-music-mode-btn')[_0x1a8eee(0x766)]={'order':'顺序','random':'随机','single':'单曲'}[_0x553af9[_0x1a8eee(0x1219)]];}function _0x3e48f7(){const _0xa01eec=_0x48bc6d,_0x17658e=document[_0xa01eec(0x9a3)]('char-audio-player'),_0x142059=document[_0xa01eec(0x9a3)](_0xa01eec(0x13f7)),_0x3d0150=document[_0xa01eec(0x9a3)](_0xa01eec(0x464));_0x142059[_0xa01eec(0x954)](_0xa01eec(0x9cc),()=>{const _0xba216d=_0xa01eec;if(_0x17658e[_0xba216d(0xac8)]){if(_0x553af9['currentIndex']>-0x1)_0x17658e[_0xba216d(0x156e)]();}else _0x17658e[_0xba216d(0x201)]();}),_0x17658e[_0xa01eec(0x727)]=()=>{const _0x545439=_0xa01eec;_0x142059[_0x545439(0xeb2)]='<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019h4V5H6v14zm8-14v14h4V5h-4z\x22></path></svg>',_0x3d0150['classList']['add'](_0x545439(0x7cd)),_0x553af9[_0x545439(0xce1)]=!![];},_0x17658e[_0xa01eec(0x9c8)]=()=>{const _0x2f650b=_0xa01eec;_0x142059[_0x2f650b(0xeb2)]='<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M8\x205v14l11-7z\x22></path></svg>',_0x3d0150[_0x2f650b(0x4d8)][_0x2f650b(0x133d)](_0x2f650b(0x7cd)),_0x553af9['isPlaying']=![];},_0x17658e[_0xa01eec(0xbbb)]=()=>{const _0x23791d=_0xa01eec;_0x3d0150[_0x23791d(0x4d8)][_0x23791d(0x133d)](_0x23791d(0x7cd)),_0x553af9[_0x23791d(0xce1)]=![],_0x16f3ca();},document['getElementById'](_0xa01eec(0x1598))['addEventListener']('click',_0x55fe8f),document[_0xa01eec(0x9a3)]('char-music-next-btn')['addEventListener']('click',_0x16f3ca),document['getElementById'](_0xa01eec(0x6b8))['addEventListener'](_0xa01eec(0x9cc),_0xcd79b3),document[_0xa01eec(0x9a3)](_0xa01eec(0x9f2))[_0xa01eec(0x954)]('click',_0x2005ca=>{const _0x5f3427=_0xa01eec;if(!_0x17658e['duration'])return;const _0x47bfd9=_0x2005ca[_0x5f3427(0x678)],_0x217a31=_0x2005ca[_0x5f3427(0x340)];_0x17658e[_0x5f3427(0x7d5)]=_0x217a31/_0x47bfd9[_0x5f3427(0x89d)]*_0x17658e[_0x5f3427(0xf58)];});}async function _0x14f0bc(){const _0x4aa584=_0x48bc6d,_0x16c0a5=document[_0x4aa584(0x9a3)](_0x4aa584(0x11e0));_0x16c0a5[_0x4aa584(0xeb2)]='';const _0x512ce0=await _0x512070[_0x4aa584(0x34b)][_0x4aa584(0x1404)](_0x4aa584(0xd73))['reverse']()[_0x4aa584(0x591)]();if(_0x512ce0[_0x4aa584(0x106b)]===0x0){_0x16c0a5[_0x4aa584(0xeb2)]=_0x4aa584(0x13b4);return;}_0x512ce0['forEach'](_0x5411ce=>{const _0x2e7fa5=_0x4aa584;let _0x3d603d;const _0x35eda7=_0x5411ce[_0x2e7fa5(0x820)]?Object[_0x2e7fa5(0xea1)](_0x19ddb8[_0x2e7fa5(0xb04)])[_0x2e7fa5(0xd62)](_0x17c51b=>!_0x17c51b[_0x2e7fa5(0x136b)]&&_0x17c51b[_0x2e7fa5(0x1561)]===_0x5411ce['authorOriginalName']):null;if(_0x35eda7)_0x3d603d=_0x35eda7[_0x2e7fa5(0x450)][_0x2e7fa5(0x4fe)];else{const _0x208c6d=Object[_0x2e7fa5(0xea1)](_0x19ddb8['chats'])['find'](_0x50431d=>!_0x50431d[_0x2e7fa5(0x136b)]&&_0x50431d['name']===_0x5411ce[_0x2e7fa5(0x75c)]);if(_0x208c6d)_0x3d603d=_0x208c6d[_0x2e7fa5(0x450)][_0x2e7fa5(0x4fe)];else _0x5411ce[_0x2e7fa5(0x1570)]?_0x3d603d=_0x2e7fa5(0x10a3)+encodeURIComponent(_0x5411ce[_0x2e7fa5(0x1570)]):_0x3d603d=_0x4f81ff;}const _0x55824e=document['createElement'](_0x2e7fa5(0x8ca));_0x55824e[_0x2e7fa5(0x1487)]=_0x2e7fa5(0xfc4),_0x55824e[_0x2e7fa5(0x4ce)]=()=>_0xaf68cc(_0x5411ce['id']),_0x55824e[_0x2e7fa5(0xeb2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x3d603d+_0x2e7fa5(0x1507)+_0x5411ce[_0x2e7fa5(0x75c)]+_0x2e7fa5(0x142a)+_0x5411ce['groupName']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-title\x22>'+_0x5411ce[_0x2e7fa5(0x3f0)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-content\x22>'+_0x5411ce[_0x2e7fa5(0x4e3)][_0x2e7fa5(0x1bb)](/\n/g,_0x2e7fa5(0x609))+_0x2e7fa5(0xf5f)+_0x5411ce[_0x2e7fa5(0x354)]+_0x2e7fa5(0xde4)+_0x5411ce[_0x2e7fa5(0x15dc)]+_0x2e7fa5(0xa2e)+_0x5d6abc(_0x5411ce[_0x2e7fa5(0xd73)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x16c0a5[_0x2e7fa5(0x983)](_0x55824e);});}async function _0xbcea2d(){const _0x25448e=_0x48bc6d,_0x1bc6b8=_0x19ddb8[_0x25448e(0x4c8)][_0x25448e(0x15c2)]||[];if(_0x1bc6b8[_0x25448e(0x106b)]===0x0){await _0x403a62('请先选择角色',_0x25448e(0x14f3));return;}await _0x403a62(_0x25448e(0x1395),_0x25448e(0xbb1)+_0x1bc6b8[_0x25448e(0x106b)]+_0x25448e(0x718));const {proxyUrl:_0x4940fc,apiKey:_0x4a203c,model:_0x35038e}=_0x19ddb8['apiConfig'];if(!_0x4940fc||!_0x4a203c||!_0x35038e){alert(_0x25448e(0xff3));return;}const _0x2ad281=new Set();_0x1bc6b8[_0x25448e(0x15c1)](_0x93a01=>{const _0x3c089b=_0x25448e,_0x4c9ff8=_0x19ddb8[_0x3c089b(0xb04)][_0x93a01];_0x4c9ff8&&_0x4c9ff8['settings']['linkedWorldBookIds']&&_0x4c9ff8[_0x3c089b(0x450)]['linkedWorldBookIds'][_0x3c089b(0x15c1)](_0x46b38b=>_0x2ad281[_0x3c089b(0xe05)](_0x46b38b));});let _0x1ac438='';_0x2ad281['size']>0x0&&(_0x1ac438+=_0x25448e(0x1317),_0x2ad281[_0x25448e(0x15c1)](_0xb97be6=>{const _0x4a9f4c=_0x25448e,_0x3c81f2=_0x19ddb8[_0x4a9f4c(0x8e4)][_0x4a9f4c(0xd62)](_0x5222e3=>_0x5222e3['id']===_0xb97be6);if(_0x3c81f2){const _0x1a5b8a=_0x3c81f2['content'][_0x4a9f4c(0x1195)](_0x5badf1=>_0x5badf1[_0x4a9f4c(0x15cd)]!==![])[_0x4a9f4c(0xb0a)](_0x5ade17=>'-\x20'+_0x5ade17[_0x4a9f4c(0x4e3)])[_0x4a9f4c(0x3b9)]('\x0a');_0x1a5b8a&&(_0x1ac438+='\x0a##\x20来自《'+_0x3c81f2[_0x4a9f4c(0x1561)]+_0x4a9f4c(0x237)+_0x1a5b8a);}}));const _0x22ee8f=_0x19ddb8['worldBooks'][_0x25448e(0xd62)](_0x375a75=>_0x375a75[_0x25448e(0x1561)]==='豆瓣设定');let _0x2a78d9='',_0x660ed4=[];_0x22ee8f&&_0x22ee8f['content'][_0x25448e(0x15c1)](_0x3c2bab=>{const _0x31a138=_0x25448e;_0x3c2bab[_0x31a138(0x79d)][_0x31a138(0x478)](_0x31a138(0x5d2))&&(_0x2a78d9+=_0x31a138(0xed8)+_0x3c2bab[_0x31a138(0x4e3)]);if(_0x3c2bab[_0x31a138(0x79d)][_0x31a138(0x478)](_0x31a138(0x1046))){const _0x5c8a81=_0x3c2bab[_0x31a138(0x4e3)][_0x31a138(0x1536)]('\x0a');_0x5c8a81['forEach'](_0x364e14=>{const _0x2e30be=_0x31a138,_0x3cf47c=_0x364e14[_0x2e30be(0x293)](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x3cf47c&&_0x660ed4[_0x2e30be(0x1c4)]({'name':_0x3cf47c[0x1]['trim'](),'persona':_0x3cf47c[0x2][_0x2e30be(0x13f9)]()});});}});const _0x42ad8b=_0x19ddb8[_0x25448e(0x9ce)][_0x25448e(0x246)]||'我',_0x150210=_0x1bc6b8[_0x25448e(0x106b)]>0x0&&_0x19ddb8[_0x25448e(0xb04)][_0x1bc6b8[0x0]]?_0x19ddb8[_0x25448e(0xb04)][_0x1bc6b8[0x0]][_0x25448e(0x450)][_0x25448e(0x1e3)]:_0x25448e(0x1318);let _0x51f266='';_0x1bc6b8[_0x25448e(0x15c1)](_0x53aa22=>{const _0x25ecaa=_0x25448e,_0x54657d=_0x19ddb8[_0x25ecaa(0xb04)][_0x53aa22];if(_0x54657d){const _0x49da12=_0x54657d[_0x25ecaa(0x744)]&&_0x54657d[_0x25ecaa(0x744)][_0x25ecaa(0x106b)]>0x0?_0x54657d[_0x25ecaa(0x744)][_0x25ecaa(0xb0a)](_0x346dfd=>_0x346dfd[_0x25ecaa(0x4e3)])[_0x25ecaa(0x3b9)](';\x20'):'无',_0x5df566=_0x54657d[_0x25ecaa(0x1f0)][_0x25ecaa(0x457)](-0xa)[_0x25ecaa(0xb0a)](_0x183e6d=>(_0x183e6d['role']===_0x25ecaa(0x20d)?_0x42ad8b:_0x54657d[_0x25ecaa(0x1561)])+':\x20'+String(_0x183e6d['content'])[_0x25ecaa(0x72e)](0x0,0x1e)+_0x25ecaa(0x4a5))['join']('\x0a');_0x51f266+=_0x25ecaa(0x96c)+_0x54657d['name']+'</name>\x0a\x20\x20<persona>'+_0x54657d[_0x25ecaa(0x450)][_0x25ecaa(0x1c3)]+_0x25ecaa(0x1057)+_0x49da12+'</memory>\x0a\x20\x20<recent_dialogue_with_user>'+_0x5df566+_0x25ecaa(0x8c6);}}),_0x660ed4[_0x25448e(0x15c1)](_0x2f086f=>{const _0x55cab9=_0x25448e;_0x51f266+=_0x55cab9(0x96c)+_0x2f086f[_0x55cab9(0x1561)]+_0x55cab9(0x1494)+_0x2f086f[_0x55cab9(0xcd4)]+_0x55cab9(0x80c);});const _0xaa6e1d=new Date(),_0x114a28=_0xaa6e1d[_0x25448e(0x12cf)](_0x25448e(0x15bc),{'dateStyle':_0x25448e(0x38f),'timeStyle':_0x25448e(0xa1b)}),_0x22c720=_0x19ddb8[_0x25448e(0x4c8)][_0x25448e(0x2ef)]||0xc,_0x2cec00=_0x19ddb8['globalSettings'][_0x25448e(0x753)]||0x14,_0x9410ad=_0x25448e(0x1f5)+_0x22c720+'到'+_0x2cec00+'篇】他们最近可能会在各种豆瓣小组中发布的帖子和评论。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**'+_0x114a28+_0x25448e(0x1b3)+_0x42ad8b+'”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20authorName\x20或\x20commenter\x20字段为\x20“'+_0x42ad8b+_0x25448e(0x1237)+_0x2a78d9+'\x0a'+_0x1ac438+_0x25448e(0x7e5)+_0x114a28+'\x0a\x0a#\x20【你的聊天对象（用户）的身份档案】\x0a-\x20**昵称**:\x20'+_0x42ad8b+'\x0a-\x20**人设**:\x20'+_0x150210+_0x25448e(0xd98)+_0x51f266+_0x25448e(0x12c9);try{const _0x25a70d=[{'role':_0x25448e(0x20d),'content':_0x25448e(0xef8)}];let _0x94878e=_0x4940fc['includes'](_0x25448e(0x1329)),_0x5b1a02=_0x366263(_0x35038e,_0x4a203c,_0x9410ad,_0x25a70d);const _0x32199f=_0x94878e?await fetch(_0x5b1a02[_0x25448e(0x121f)],_0x5b1a02[_0x25448e(0x38c)]):await fetch(_0x4940fc+'/v1/chat/completions',{'method':_0x25448e(0x12db),'headers':{'Content-Type':_0x25448e(0xb1f),'Authorization':_0x25448e(0x1265)+_0x4a203c},'body':JSON[_0x25448e(0xe1e)]({'model':_0x35038e,'messages':[{'role':'system','content':_0x9410ad},..._0x25a70d],'temperature':_0x19ddb8[_0x25448e(0x4c8)]['apiTemperature']||0x1})});if(!_0x32199f['ok'])throw new Error(_0x25448e(0x786)+_0x32199f[_0x25448e(0x140e)]);const _0x2475be=await _0x32199f[_0x25448e(0xa5d)](),_0x5910dc=getGeminiResponseText(_0x2475be),_0x4f44b9=_0x5910dc[_0x25448e(0x293)](/\[[\s\S]*\]/);if(!_0x4f44b9)throw new Error(_0x25448e(0x1178)+_0x5910dc);const _0x47b9c9=JSON[_0x25448e(0x1447)](_0x4f44b9[0x0]);await _0x512070[_0x25448e(0x34b)][_0x25448e(0xe81)](),await _0x512070[_0x25448e(0x34b)][_0x25448e(0x11d7)](_0x47b9c9[_0x25448e(0xb0a)](_0x4a3e7d=>({..._0x4a3e7d,'timestamp':Date[_0x25448e(0x64b)]()-Math['random']()*0x186a0}))),await _0x14f0bc();}catch(_0x28e2f1){console[_0x25448e(0x3b7)](_0x25448e(0x988),_0x28e2f1),await _0x403a62(_0x25448e(0x8e8),_0x25448e(0x8d8)+_0x28e2f1[_0x25448e(0xcce)]);}}async function _0xaf68cc(_0x41df94){const _0x5a9696=_0x48bc6d;_0x35df44('douban-post-detail-screen'),_0x4fd882=_0x41df94;const _0x2c2a5d=await _0x512070[_0x5a9696(0x34b)]['get'](_0x41df94);if(!_0x2c2a5d){_0x35df44(_0x5a9696(0xfd4));return;}document[_0x5a9696(0x9a3)](_0x5a9696(0x39e))['textContent']='帖子详情';let _0x47fbc9=_0x4f81ff,_0x2843d0=_0x2c2a5d['authorName'];const _0x5aa70a=_0x2c2a5d[_0x5a9696(0x820)]?Object[_0x5a9696(0xea1)](_0x19ddb8[_0x5a9696(0xb04)])['find'](_0x41508c=>!_0x41508c[_0x5a9696(0x136b)]&&_0x41508c[_0x5a9696(0x339)]===_0x2c2a5d[_0x5a9696(0x820)]):null;if(_0x5aa70a)_0x47fbc9=_0x5aa70a[_0x5a9696(0x450)][_0x5a9696(0x4fe)];else{const _0x45a0ed=Object[_0x5a9696(0xea1)](_0x19ddb8[_0x5a9696(0xb04)])['find'](_0x463259=>!_0x463259['isGroup']&&_0x463259[_0x5a9696(0x1561)]===_0x2c2a5d[_0x5a9696(0x75c)]);if(_0x45a0ed)_0x47fbc9=_0x45a0ed[_0x5a9696(0x450)]['aiAvatar'];else _0x2c2a5d['authorAvatarPrompt']&&(_0x47fbc9=_0x5a9696(0x10a3)+encodeURIComponent(_0x2c2a5d[_0x5a9696(0x1570)]));}document[_0x5a9696(0x9a3)](_0x5a9696(0x1027))[_0x5a9696(0x10d4)]=_0x47fbc9,document[_0x5a9696(0x9a3)](_0x5a9696(0x154a))[_0x5a9696(0x766)]=_0x2843d0,document[_0x5a9696(0x9a3)](_0x5a9696(0xb87))[_0x5a9696(0x766)]=_0x5a9696(0x131a)+_0x2c2a5d[_0x5a9696(0xc91)],document['getElementById']('douban-detail-post-title')['textContent']=_0x2c2a5d[_0x5a9696(0x3f0)],document['getElementById'](_0x5a9696(0x12fd))['innerHTML']=_0x2c2a5d[_0x5a9696(0x4e3)]['replace'](/\n/g,_0x5a9696(0x609)),document[_0x5a9696(0x9a3)](_0x5a9696(0x11de))[_0x5a9696(0x10d4)]=_0x19ddb8[_0x5a9696(0x9ce)]['avatar'],document[_0x5a9696(0x9a3)](_0x5a9696(0x6ed))[_0x5a9696(0x7b2)]='';const _0x3c6f8a=document[_0x5a9696(0x9a3)]('douban-detail-comments-list');_0x3c6f8a[_0x5a9696(0xeb2)]='';if(_0x2c2a5d[_0x5a9696(0xc79)]&&_0x2c2a5d[_0x5a9696(0xc79)][_0x5a9696(0x106b)]>0x0){const _0x35493b=new Map();_0x2c2a5d['comments'][_0x5a9696(0x15c1)](_0x4cc753=>{const _0x122571=_0x5a9696;let _0x27d218=_0x4f81ff;const _0x34f2d2=_0x19ddb8['qzoneSettings'][_0x122571(0x246)]||'我',_0x38cf40=_0x4cc753[_0x122571(0x11f2)];if(_0x35493b[_0x122571(0x1472)](_0x38cf40))_0x27d218=_0x35493b[_0x122571(0x14ee)](_0x38cf40);else{if(_0x38cf40===_0x34f2d2)_0x27d218=_0x19ddb8['qzoneSettings'][_0x122571(0xf3f)];else{if(_0x38cf40===_0x2c2a5d[_0x122571(0x75c)])_0x27d218=_0x47fbc9;else{const _0xe83f37=_0x4cc753[_0x122571(0x90a)]?Object[_0x122571(0xea1)](_0x19ddb8['chats'])[_0x122571(0xd62)](_0x42df30=>!_0x42df30[_0x122571(0x136b)]&&_0x42df30[_0x122571(0x339)]===_0x4cc753[_0x122571(0x90a)]):null;if(_0xe83f37)_0x27d218=_0xe83f37[_0x122571(0x450)][_0x122571(0x4fe)];else{const _0x39fd18=Object['values'](_0x19ddb8[_0x122571(0xb04)])[_0x122571(0xd62)](_0x5dfb34=>!_0x5dfb34[_0x122571(0x136b)]&&_0x5dfb34[_0x122571(0x1561)]===_0x38cf40);if(_0x39fd18)_0x27d218=_0x39fd18[_0x122571(0x450)]['aiAvatar'];else _0x4cc753['avatar_prompt']&&(_0x27d218=_0x122571(0x10a3)+encodeURIComponent(_0x4cc753['avatar_prompt']));}}}_0x35493b[_0x122571(0x1177)](_0x38cf40,_0x27d218);}const _0x167532=document[_0x122571(0xe94)](_0x122571(0x8ca));_0x167532['className']=_0x122571(0x54e),_0x167532[_0x122571(0xeb2)]=_0x122571(0xe09)+_0x27d218+'\x22\x20class=\x22douban-comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-author\x22>'+_0x38cf40+_0x122571(0x1476)+_0x4cc753[_0x122571(0x13ca)][_0x122571(0x1bb)](/\n/g,_0x122571(0x609))+_0x122571(0x11a4),_0x3c6f8a[_0x122571(0x983)](_0x167532);});}else _0x3c6f8a[_0x5a9696(0xeb2)]='<p\x20style=\x22color:\x20var(--text-secondary);\x20font-size:\x2013px;\x22>还没有回应</p>';const _0x5dd249=document['getElementById']('douban-detail-content-wrapper');if(_0x5dd249)_0x5dd249[_0x5a9696(0x85c)]=0x0;}async function _0x23c577(){const _0x32c93c=_0x48bc6d;if(!_0x4fd882)return;const _0x20b6cd=document['getElementById']('douban-comment-input'),_0x46f413=_0x20b6cd['value']['trim']();if(!_0x46f413)return;const _0x3edabe=await _0x512070['doubanPosts'][_0x32c93c(0x14ee)](_0x4fd882);if(!_0x3edabe)return;!_0x3edabe['comments']&&(_0x3edabe[_0x32c93c(0xc79)]=[]);const _0x5090e8=_0x19ddb8[_0x32c93c(0x9ce)]['nickname']||'我';_0x3edabe['comments'][_0x32c93c(0x1c4)]({'commenter':_0x5090e8,'text':_0x46f413}),_0x3edabe[_0x32c93c(0x15dc)]++,await _0x512070[_0x32c93c(0x34b)]['put'](_0x3edabe),_0x20b6cd[_0x32c93c(0x7b2)]='',await _0xaf68cc(_0x4fd882);}async function _0x1aca17(){const _0x7f7e57=_0x48bc6d;if(!_0x4fd882)return;const _0x1a8397=_0x4fd882,_0x575c25=await _0x512070['doubanPosts'][_0x7f7e57(0x14ee)](_0x1a8397);if(!_0x575c25)return;const _0x3163d6=_0x575c25[_0x7f7e57(0xc79)]&&_0x575c25[_0x7f7e57(0xc79)][_0x7f7e57(0x457)](-0x1)[0x0];if(!_0x3163d6){alert('还没有任何评论，无法等待回复。');return;}await _0x403a62(_0x7f7e57(0x1395),_0x7f7e57(0x14b7));try{const {proxyUrl:_0x313dab,apiKey:_0x51efd7,model:_0x44c7b7}=_0x19ddb8[_0x7f7e57(0xd22)];if(!_0x313dab||!_0x51efd7||!_0x44c7b7)throw new Error(_0x7f7e57(0x487));const _0x517602=_0x19ddb8[_0x7f7e57(0x9ce)][_0x7f7e57(0x246)]||'我',_0x32cba2=_0x19ddb8[_0x7f7e57(0xb04)][Object[_0x7f7e57(0x2d0)](_0x19ddb8[_0x7f7e57(0xb04)])[0x0]]?.['settings']['myPersona']||_0x7f7e57(0x1318),_0x2298f3=new Map();_0x575c25[_0x7f7e57(0xc79)]&&_0x575c25['comments'][_0x7f7e57(0x15c1)](_0x5dd250=>{const _0x4f7634=_0x7f7e57,_0x339d58=(_0x19ddb8[_0x4f7634(0x4c8)][_0x4f7634(0x15c2)]||[])[_0x4f7634(0x336)](_0x261beb=>_0x19ddb8[_0x4f7634(0xb04)][_0x261beb]?.[_0x4f7634(0x1561)]===_0x5dd250[_0x4f7634(0x11f2)]);!_0x339d58&&_0x5dd250[_0x4f7634(0x13ef)]&&_0x2298f3['set'](_0x5dd250[_0x4f7634(0x11f2)],_0x5dd250[_0x4f7634(0x13ef)]);});let _0x449816=_0x7f7e57(0x1136);_0x2298f3['size']>0x0?(_0x449816+=_0x7f7e57(0x11d2),_0x2298f3['forEach']((_0x3bc015,_0x1500a0)=>{const _0x3f0e1c=_0x7f7e57;_0x449816+=_0x3f0e1c(0x1e5)+_0x1500a0+_0x3f0e1c(0xde7)+_0x3bc015+'\x22\x0a';})):_0x449816+=_0x7f7e57(0x948);const _0x324309=_0x19ddb8[_0x7f7e57(0x8e4)]['find'](_0x32bd19=>_0x32bd19['name']===_0x7f7e57(0xc9a));let _0x2e53ce=[];_0x324309&&_0x324309['content'][_0x7f7e57(0x15c1)](_0x4c5f9a=>{const _0x4cdcb2=_0x7f7e57;if(_0x4c5f9a[_0x4cdcb2(0x79d)][_0x4cdcb2(0x478)](_0x4cdcb2(0x1046))){const _0x363f0d=_0x4c5f9a['content']['split']('\x0a');_0x363f0d[_0x4cdcb2(0x15c1)](_0x32432b=>{const _0x334b03=_0x4cdcb2,_0xf12e38=_0x32432b[_0x334b03(0x293)](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0xf12e38&&_0x2e53ce[_0x334b03(0x1c4)]({'name':_0xf12e38[0x1][_0x334b03(0x13f9)](),'persona':_0xf12e38[0x2][_0x334b03(0x13f9)]()});});}});let _0x592786='';const _0x6d08a1=_0x19ddb8[_0x7f7e57(0x4c8)][_0x7f7e57(0x15c2)]||[];_0x6d08a1[_0x7f7e57(0x15c1)](_0x3ae66f=>{const _0x3847db=_0x7f7e57,_0x3461eb=_0x19ddb8['chats'][_0x3ae66f];if(_0x3461eb){const _0xe1be86=_0x3461eb['longTermMemory']&&_0x3461eb[_0x3847db(0x744)][_0x3847db(0x106b)]>0x0?_0x3461eb[_0x3847db(0x744)]['map'](_0x32db80=>_0x32db80['content'])['join'](';\x20'):'无',_0x174d50=_0x3461eb[_0x3847db(0x1f0)][_0x3847db(0x457)](-0xa)['map'](_0x2890ed=>(_0x2890ed[_0x3847db(0x11c1)]==='user'?_0x517602:_0x3461eb['name'])+':\x20'+String(_0x2890ed[_0x3847db(0x4e3)])[_0x3847db(0x72e)](0x0,0x1e)+_0x3847db(0x4a5))[_0x3847db(0x3b9)]('\x0a');_0x592786+=_0x3847db(0x1002)+_0x3461eb[_0x3847db(0x1561)]+':\x20'+_0x3461eb['settings'][_0x3847db(0x1c3)][_0x3847db(0x72e)](0x0,0x32)+_0x3847db(0x1309)+_0xe1be86+_0x3847db(0x5ef)+_0x174d50+']';}}),_0x2e53ce[_0x7f7e57(0x15c1)](_0x1d44b2=>{const _0x5cff52=_0x7f7e57;_0x592786+=_0x5cff52(0x1002)+_0x1d44b2[_0x5cff52(0x1561)]+':\x20'+_0x1d44b2['persona'];});const _0x4e5b6a=new Date(),_0x333b38=_0x4e5b6a['toLocaleString']('zh-CN',{'dateStyle':'full','timeStyle':_0x7f7e57(0xa1b)}),_0x3e5ec7='\x0a#\x20你的任务\x0a你是一个虚拟社区的AI导演。下面的“帖子摘要”和“已有评论”来自于一个豆瓣小组的帖子。用户“'+_0x517602+_0x7f7e57(0xcff)+_0x333b38+_0x7f7e57(0x1467)+_0x517602+'”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20commenter\x20字段为\x20“'+_0x517602+_0x7f7e57(0xd30)+_0x575c25['postTitle']+_0x7f7e57(0x1546)+_0x575c25['authorName']+_0x7f7e57(0xbe0)+_0x575c25[_0x7f7e57(0x4e3)][_0x7f7e57(0x72e)](0x0,0x64)+_0x7f7e57(0x4a4)+_0x575c25[_0x7f7e57(0xc79)][_0x7f7e57(0xb0a)](_0x475e81=>'-\x20'+_0x475e81['commenter']+':\x20'+_0x475e81[_0x7f7e57(0x13ca)])['join']('\x0a')+'\x0a\x0a'+_0x449816+_0x7f7e57(0x7e5)+_0x333b38+_0x7f7e57(0x13f4)+_0x517602+_0x7f7e57(0x8cd)+_0x32cba2+'\x0a\x0a#\x20你的角色库\x20(你可以从中选择【任何角色】进行评论，并参考他们的记忆和对话)\x0a'+_0x592786+'\x0a\x0a现在，请生成新的评论。',_0x2b6738=[{'role':_0x7f7e57(0x20d),'content':_0x7f7e57(0x63e)}];let _0x2e3f1d=_0x313dab[_0x7f7e57(0x478)](_0x7f7e57(0x1329)),_0x171b44=_0x366263(_0x44c7b7,_0x51efd7,_0x3e5ec7,_0x2b6738);const _0x93bf16=_0x2e3f1d?await fetch(_0x171b44[_0x7f7e57(0x121f)],_0x171b44['data']):await fetch(_0x313dab+_0x7f7e57(0x501),{'method':_0x7f7e57(0x12db),'headers':{'Content-Type':_0x7f7e57(0xb1f),'Authorization':_0x7f7e57(0x1265)+_0x51efd7},'body':JSON['stringify']({'model':_0x44c7b7,'messages':[{'role':_0x7f7e57(0xe10),'content':_0x3e5ec7},..._0x2b6738],'temperature':_0x19ddb8['globalSettings'][_0x7f7e57(0x4a2)]||0x1})});if(!_0x93bf16['ok'])throw new Error('API\x20错误:\x20'+_0x93bf16[_0x7f7e57(0x140e)]);const _0x2653c8=await _0x93bf16[_0x7f7e57(0xa5d)](),_0x50fcd9=getGeminiResponseText(_0x2653c8),_0x7c4fc6=_0x50fcd9[_0x7f7e57(0x1bb)](/^```json\s*/,'')[_0x7f7e57(0x1bb)](/```$/,''),_0x18b7bc=JSON['parse'](_0x7c4fc6);Array[_0x7f7e57(0xb9b)](_0x18b7bc)&&_0x18b7bc[_0x7f7e57(0x106b)]>0x0&&(_0x575c25['comments'][_0x7f7e57(0x1c4)](..._0x18b7bc),_0x575c25[_0x7f7e57(0x15dc)]+=_0x18b7bc[_0x7f7e57(0x106b)],await _0x512070[_0x7f7e57(0x34b)][_0x7f7e57(0xd4d)](_0x575c25)),await _0xaf68cc(_0x1a8397),_0x5551e4();}catch(_0x3f78b7){console[_0x7f7e57(0x3b7)]('等待回复失败:',_0x3f78b7),await _0x403a62(_0x7f7e57(0x13bd),'无法获取AI回复，请检查API配置或稍后再试。\x0a错误:\x20'+_0x3f78b7[_0x7f7e57(0xcce)]);}}async function _0x56d374(){const _0x426713=_0x48bc6d,_0x215165=document['getElementById'](_0x426713(0x1054)),_0x47e287=document[_0x426713(0x9a3)](_0x426713(0xb78));_0x47e287[_0x426713(0xeb2)]='';const _0x4b664b=Object[_0x426713(0xea1)](_0x19ddb8[_0x426713(0xb04)])[_0x426713(0x1195)](_0x43e2d0=>!_0x43e2d0[_0x426713(0x136b)]),_0x2a1498=new Set(_0x19ddb8['globalSettings'][_0x426713(0x15c2)]||[]);_0x4b664b[_0x426713(0x106b)]===0x0?_0x47e287[_0x426713(0xeb2)]=_0x426713(0x11d1):_0x4b664b[_0x426713(0x15c1)](_0x3927bd=>{const _0x494b28=_0x426713,_0x3564bf=document[_0x494b28(0xe94)](_0x494b28(0x8ca));_0x3564bf[_0x494b28(0x1487)]='contact-picker-item',_0x3564bf['innerHTML']=_0x494b28(0x157b)+_0x3927bd['id']+'\x22\x20'+(_0x2a1498[_0x494b28(0x1472)](_0x3927bd['id'])?'checked':'')+_0x494b28(0x150f)+(_0x3927bd[_0x494b28(0x450)][_0x494b28(0x4fe)]||_0x4f81ff)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x3927bd['name']+_0x494b28(0xff8),_0x47e287[_0x494b28(0x983)](_0x3564bf);}),_0x215165[_0x426713(0x4d8)][_0x426713(0xe05)](_0x426713(0xc09));}async function _0xed672(){const _0x2ec2c7=_0x48bc6d,_0x5949af=document['querySelectorAll'](_0x2ec2c7(0xd2f)),_0x92b86a=Array[_0x2ec2c7(0x1311)](_0x5949af)['map'](_0x5dc8b1=>_0x5dc8b1[_0x2ec2c7(0xd8d)]['chatId']);_0x19ddb8[_0x2ec2c7(0x4c8)]['doubanActiveCharacterIds']=_0x92b86a,await _0x512070[_0x2ec2c7(0x4c8)][_0x2ec2c7(0xd4d)](_0x19ddb8[_0x2ec2c7(0x4c8)]),document[_0x2ec2c7(0x9a3)]('douban-cast-modal')[_0x2ec2c7(0x4d8)][_0x2ec2c7(0x133d)](_0x2ec2c7(0xc09)),await _0xbcea2d();}document[_0x48bc6d(0x9a3)](_0x48bc6d(0xb7b))['addEventListener'](_0x48bc6d(0x9cc),_0x56d374),document[_0x48bc6d(0x9a3)](_0x48bc6d(0x14d9))[_0x48bc6d(0x954)](_0x48bc6d(0x9cc),()=>{const _0xc92faa=_0x48bc6d;document['getElementById'](_0xc92faa(0x1054))[_0xc92faa(0x4d8)]['remove'](_0xc92faa(0xc09));}),document[_0x48bc6d(0x9a3)](_0x48bc6d(0x1120))[_0x48bc6d(0x954)](_0x48bc6d(0x9cc),_0xed672),document[_0x48bc6d(0x9a3)](_0x48bc6d(0xb78))[_0x48bc6d(0x954)](_0x48bc6d(0x9cc),_0x1959b3=>{const _0x29ed03=_0x48bc6d,_0x4bff1a=_0x1959b3[_0x29ed03(0xa41)][_0x29ed03(0x94c)](_0x29ed03(0x67d));if(_0x4bff1a){const _0x226293=_0x4bff1a['querySelector'](_0x29ed03(0xedc));_0x226293&&_0x1959b3['target']!==_0x226293&&(_0x226293[_0x29ed03(0x944)]=!_0x226293[_0x29ed03(0x944)]);}});async function _0x1109cd(_0x3b35df){const _0xf357d2=_0x48bc6d;if(!_0x3b35df)return;const _0x409b7b=await _0x2c9509(_0xf357d2(0xd1e),_0xf357d2(0xe02),{'confirmText':_0xf357d2(0x801)});if(!_0x409b7b)return;try{const _0xee93b2=await _0x3b35df[_0xf357d2(0x13ca)](),_0x89ed3=JSON['parse'](_0xee93b2);if(!_0x89ed3[_0xf357d2(0xa32)]&&!_0x89ed3[_0xf357d2(0x796)]&&!_0x89ed3['appIcons'])throw new Error(_0xf357d2(0xde6));Object['assign'](_0x19ddb8['globalSettings'],_0x89ed3),await _0x512070['globalSettings'][_0xf357d2(0xd4d)](_0x19ddb8[_0xf357d2(0x4c8)]),_0x28dc10(),_0x1b6cea(),_0xe2a513(),_0x2c06c4(),_0x15e853(_0x19ddb8[_0xf357d2(0x4c8)][_0xf357d2(0x796)]),_0x124e17(_0x19ddb8['globalSettings'][_0xf357d2(0x12ce)]),_0x154868(),_0x537b6a(),_0x21e3fb(),await _0x403a62(_0xf357d2(0x90b),_0xf357d2(0x1116));}catch(_0x4a8ef5){console['error'](_0xf357d2(0x693),_0x4a8ef5),await _0x403a62('导入失败','文件解析或应用失败:\x20'+_0x4a8ef5[_0xf357d2(0xcce)]);}}async function _0x21773b(_0x1e4f87){const _0x42dc94=_0x48bc6d;console['log'](_0x42dc94(0x110d)+_0x1e4f87[_0x42dc94(0x1322)](0x1)+_0x42dc94(0x7e9));const _0xb1133b=Object[_0x42dc94(0xea1)](_0x19ddb8[_0x42dc94(0xb04)])[_0x42dc94(0x1195)](_0x4ae591=>!_0x4ae591[_0x42dc94(0x136b)]&&_0x4ae591[_0x42dc94(0x450)][_0x42dc94(0x106e)]&&_0x4ae591[_0x42dc94(0x239)]?.[_0x42dc94(0x27d)]===_0x42dc94(0xf81));if(_0xb1133b[_0x42dc94(0x106b)]===0x0){console[_0x42dc94(0xe4d)](_0x42dc94(0x9e1));return;}for(const _0x710fa7 of _0xb1133b){const _0x4c7aa9=_0x710fa7['settings'][_0x42dc94(0x605)]||0xf,_0x44ff64=_0x710fa7['lastActionTimestamp']?(Date[_0x42dc94(0x64b)]()-_0x710fa7[_0x42dc94(0x4bf)])/(0x3e8*0x3c):Infinity;_0x1e4f87>_0x4c7aa9&&_0x44ff64>_0x4c7aa9&&(Math[_0x42dc94(0xdcd)]()<0.3&&(console[_0x42dc94(0xe4d)](_0x42dc94(0x133f)+_0x710fa7['name']+_0x42dc94(0xd89)),Math[_0x42dc94(0xdcd)]()<0.7?await _0x265b86(_0x710fa7['id']):console['log'](_0x42dc94(0x133f)+_0x710fa7[_0x42dc94(0x1561)]+_0x42dc94(0x10c2))));}}function _0x32d043(){const _0x30c0ea=_0x48bc6d;if(!_0x19ddb8[_0x30c0ea(0x859)])return;const _0x4536cc=_0x19ddb8[_0x30c0ea(0xb04)][_0x19ddb8[_0x30c0ea(0x859)]];document[_0x30c0ea(0x9a3)](_0x30c0ea(0xd25))[_0x30c0ea(0x7b2)]='',document[_0x30c0ea(0x9a3)](_0x30c0ea(0xef0))['value']='',document['getElementById']('chat-search-results-list')[_0x30c0ea(0xeb2)]=_0x30c0ea(0x2cd),_0x35df44(_0x30c0ea(0xea5));}async function _0x3092e4(){const _0x39c4ce=_0x48bc6d,_0x1c695d=_0x19ddb8['chats'][_0x19ddb8[_0x39c4ce(0x859)]];if(!_0x1c695d)return;const _0x48fe65=document[_0x39c4ce(0x9a3)](_0x39c4ce(0xd25))[_0x39c4ce(0x7b2)]['trim']()[_0x39c4ce(0x905)](),_0x5e39ea=document[_0x39c4ce(0x9a3)](_0x39c4ce(0xef0))[_0x39c4ce(0x7b2)];if(!_0x48fe65&&!_0x5e39ea){alert('请输入关键词或选择一个日期。');return;}let _0x3831ba=_0x1c695d[_0x39c4ce(0x1f0)][_0x39c4ce(0x1195)](_0x2c8e9e=>!_0x2c8e9e[_0x39c4ce(0x136e)]);_0x48fe65&&(_0x3831ba=_0x3831ba[_0x39c4ce(0x1195)](_0x33bcd9=>{const _0x18964c=_0x39c4ce;let _0x5b0db3='';if(typeof _0x33bcd9[_0x18964c(0x4e3)]===_0x18964c(0x86c))_0x5b0db3=_0x33bcd9[_0x18964c(0x4e3)];else{if(_0x33bcd9[_0x18964c(0x1508)]===_0x18964c(0x1207))_0x5b0db3=_0x33bcd9['content'];else{if(_0x33bcd9[_0x18964c(0x1508)]===_0x18964c(0x1c1)||_0x33bcd9[_0x18964c(0x1508)]==='user_photo')_0x5b0db3=_0x33bcd9[_0x18964c(0x4e3)];else{if(_0x33bcd9[_0x18964c(0x1508)]===_0x18964c(0x12fb))_0x5b0db3=(_0x33bcd9[_0x18964c(0x103d)]||'')+'\x20'+(_0x33bcd9[_0x18964c(0x3ef)]||'');else _0x33bcd9[_0x18964c(0x6f7)]&&(_0x5b0db3=_0x33bcd9[_0x18964c(0x4e3)]);}}}return _0x5b0db3[_0x18964c(0x905)]()[_0x18964c(0x478)](_0x48fe65);}));if(_0x5e39ea){const _0x4cdac6=new Date(_0x5e39ea),_0x5a91ec=new Date(_0x4cdac6['setHours'](0x0,0x0,0x0,0x0))[_0x39c4ce(0xbd1)](),_0x5b769a=new Date(_0x4cdac6[_0x39c4ce(0x7f0)](0x17,0x3b,0x3b,0x3e7))['getTime']();_0x3831ba=_0x3831ba['filter'](_0x2827ac=>_0x2827ac[_0x39c4ce(0xd73)]>=_0x5a91ec&&_0x2827ac['timestamp']<=_0x5b769a);}await _0x33abaa(_0x3831ba);}async function _0x33abaa(_0x19ed11){const _0x21d7e1=_0x48bc6d,_0x24d3d2=document[_0x21d7e1(0x9a3)](_0x21d7e1(0x5a2)),_0x5dd453=_0x19ddb8['chats'][_0x19ddb8['activeChatId']];_0x24d3d2[_0x21d7e1(0xeb2)]='';if(_0x19ed11[_0x21d7e1(0x106b)]===0x0){_0x24d3d2[_0x21d7e1(0xeb2)]=_0x21d7e1(0x261);return;}let _0x117f16='';for(const _0x238a20 of _0x19ed11){const _0x5c62c3=new Date(_0x238a20['timestamp']),_0x15e01f=_0x5c62c3[_0x21d7e1(0x7fd)]();if(_0x15e01f!==_0x117f16){const _0x334156=document[_0x21d7e1(0xe94)](_0x21d7e1(0x8ca));_0x334156[_0x21d7e1(0x1487)]=_0x21d7e1(0x95f),_0x334156[_0x21d7e1(0x766)]='---\x20'+_0x5c62c3['getFullYear']()+'年'+(_0x5c62c3['getMonth']()+0x1)+'月'+_0x5c62c3['getDate']()+_0x21d7e1(0x7ad),_0x24d3d2[_0x21d7e1(0x983)](_0x334156),_0x117f16=_0x15e01f;}const _0x26f403=await _0xb42d69(_0x238a20,_0x5dd453);_0x26f403&&(_0x26f403[_0x21d7e1(0x20f)][_0x21d7e1(0x1539)]='pointer',_0x26f403[_0x21d7e1(0x954)](_0x21d7e1(0x9cc),()=>_0x4349c2(_0x238a20[_0x21d7e1(0xd73)])),_0x24d3d2[_0x21d7e1(0x983)](_0x26f403));}}async function _0x4349c2(_0x23ca85){const _0x167d74=_0x48bc6d,_0x49b805=_0x19ddb8[_0x167d74(0x859)];if(!_0x49b805)return;_0x35df44(_0x167d74(0x3e5)),setTimeout(async()=>{const _0xa1172d=_0x167d74,_0x2585e4=document['getElementById'](_0xa1172d(0x10f8)),_0x1b7d87=_0xa1172d(0x1c5)+_0x23ca85+'\x22]';let _0x39ddf6=_0x2585e4[_0xa1172d(0xc86)](_0x1b7d87),_0x41fc07=0x0;const _0x270eb5=0x14;while(!_0x39ddf6&&_0x41fc07<_0x270eb5){const _0x5ac25a=document[_0xa1172d(0x9a3)](_0xa1172d(0x14a3));if(_0x5ac25a)console[_0xa1172d(0xe4d)](_0xa1172d(0x16b)+(_0x41fc07+0x1)+')'),await _0x248587(),_0x39ddf6=_0x2585e4[_0xa1172d(0xc86)](_0x1b7d87),_0x41fc07++;else break;}_0x36c2d8(_0x23ca85);},0xc8);}async function _0x2e4ae5(){const _0x2f46b4=_0x48bc6d;document[_0x2f46b4(0x9a3)]('keyword-search-input')[_0x2f46b4(0x7b2)]='',document[_0x2f46b4(0x9a3)]('date-search-input')[_0x2f46b4(0x7b2)]='',await _0x33abaa(_0x19ddb8['chats'][_0x19ddb8[_0x2f46b4(0x859)]][_0x2f46b4(0x1f0)][_0x2f46b4(0x1195)](_0x1e1f73=>!_0x1e1f73[_0x2f46b4(0x136e)]));}async function _0x504b79(_0x451db9=![],_0x5292a1=null,_0x43d557=null){const _0xd1ff4f=_0x48bc6d,_0x3c336f=document[_0xd1ff4f(0x9a3)](_0xd1ff4f(0xb20)),_0xc5544e=document['getElementById'](_0xd1ff4f(0x65d)),_0x3b3b58=_0x19ddb8[_0xd1ff4f(0xb04)][_0x19ddb8[_0xd1ff4f(0x859)]];_0x3c336f['innerHTML']='',_0xc5544e[_0xd1ff4f(0xeb2)]='';const _0x2db549=await _0x512070['customAvatarFrames'][_0xd1ff4f(0x591)](),_0x58d538=[..._0x33963a,..._0x2db549];document[_0xd1ff4f(0xc86)](_0xd1ff4f(0x1548))[_0xd1ff4f(0x20f)][_0xd1ff4f(0x115d)]=_0x451db9?_0xd1ff4f(0x8e0):'flex',document[_0xd1ff4f(0x9a3)]('ai-frame-content')[_0xd1ff4f(0x20f)][_0xd1ff4f(0x115d)]=_0xd1ff4f(0x10c8),document[_0xd1ff4f(0x9a3)]('my-frame-content')[_0xd1ff4f(0x20f)][_0xd1ff4f(0x115d)]=_0xd1ff4f(0x8e0),document[_0xd1ff4f(0x9a3)](_0xd1ff4f(0x17f))['classList']['add'](_0xd1ff4f(0xe9f)),document[_0xd1ff4f(0x9a3)]('my-frame-tab')['classList'][_0xd1ff4f(0x133d)](_0xd1ff4f(0xe9f));if(_0x451db9)_0x58d538[_0xd1ff4f(0x15c1)](_0x3607c4=>{const _0x15295b=_0xd1ff4f,_0x28a345=_0x19e53a(_0x3607c4,'my',_0x5292a1);_0x3607c4[_0x15295b(0x121f)]===_0x43d557&&_0x28a345[_0x15295b(0x4d8)][_0x15295b(0xe05)](_0x15295b(0x154b)),_0x3c336f[_0x15295b(0x983)](_0x28a345);});else{const _0x4b5fd5=_0x3b3b58[_0xd1ff4f(0x450)][_0xd1ff4f(0x4fe)]||_0x4f81ff,_0x1d4a95=_0x3b3b58['settings'][_0xd1ff4f(0x1af)]||(_0x3b3b58[_0xd1ff4f(0x136b)]?_0xde5144:_0x4f81ff);_0x58d538['forEach'](_0x73c30c=>{const _0x49a632=_0xd1ff4f,_0x138020=_0x19e53a(_0x73c30c,'ai',_0x4b5fd5);if(_0x73c30c[_0x49a632(0x121f)]===_0x121cc7['ai'])_0x138020[_0x49a632(0x4d8)][_0x49a632(0xe05)](_0x49a632(0x154b));_0x3c336f['appendChild'](_0x138020);const _0x580729=_0x19e53a(_0x73c30c,'my',_0x1d4a95);if(_0x73c30c[_0x49a632(0x121f)]===_0x121cc7['my'])_0x580729[_0x49a632(0x4d8)][_0x49a632(0xe05)](_0x49a632(0x154b));_0xc5544e[_0x49a632(0x983)](_0x580729);});}}function _0x19e53a(_0x3aa8eb,_0x412052,_0x563751){const _0x5a8f88=_0x48bc6d,_0x5bc58c=document['createElement'](_0x5a8f88(0x8ca));_0x5bc58c[_0x5a8f88(0x1487)]=_0x5a8f88(0x14d5),_0x5bc58c[_0x5a8f88(0xd8d)][_0x5a8f88(0x646)]=_0x3aa8eb[_0x5a8f88(0x121f)],_0x5bc58c[_0x5a8f88(0x10b8)]=_0x3aa8eb[_0x5a8f88(0x1561)];const _0x218b83=typeof _0x3aa8eb['id']===_0x5a8f88(0x9db),_0x17d167=_0x218b83?'<button\x20class=\x22delete-btn\x22\x20data-id=\x22'+_0x3aa8eb['id']+_0x5a8f88(0x9a5):'';return _0x5bc58c[_0x5a8f88(0xeb2)]=_0x5a8f88(0x1560)+_0x17d167+_0x5a8f88(0x103b)+_0x563751+_0x5a8f88(0x8fc)+(_0x3aa8eb[_0x5a8f88(0x121f)]?_0x5a8f88(0x887)+_0x3aa8eb[_0x5a8f88(0x121f)]+'\x22\x20class=\x22preview-frame\x22>':'')+_0x5a8f88(0x379),_0x5bc58c[_0x5a8f88(0x954)](_0x5a8f88(0x9cc),_0x287fa7=>{const _0x55c358=_0x5a8f88;if(_0x287fa7['target']['classList'][_0x55c358(0x1222)](_0x55c358(0x1441)))return;if(_0x288b8b){if(_0x218b83){const _0x1ac82d=parseInt(_0x3aa8eb['id']);_0x5bc58c[_0x55c358(0x4d8)]['toggle'](_0x55c358(0x154b)),_0x5ec23a[_0x55c358(0x1472)](_0x1ac82d)?_0x5ec23a[_0x55c358(0x10a8)](_0x1ac82d):_0x5ec23a['add'](_0x1ac82d),_0x51e3cc();}}else{_0x121cc7[_0x412052]=_0x3aa8eb[_0x55c358(0x121f)];const _0x62f8c3=_0x412052==='ai'?document[_0x55c358(0x9a3)](_0x55c358(0xb20)):document[_0x55c358(0x9a3)](_0x55c358(0x65d));_0x62f8c3['querySelectorAll'](_0x55c358(0x2d8))[_0x55c358(0x15c1)](_0x1b6518=>_0x1b6518['classList'][_0x55c358(0x133d)](_0x55c358(0x154b))),_0x5bc58c['classList']['add'](_0x55c358(0x154b));}}),_0x5bc58c;}async function _0x16950b(){const _0x4bcd47=_0x48bc6d,_0x157ffd=document['getElementById']('custom-frame-upload-input'),_0x2d2f75=await new Promise(_0x48890a=>{const _0x55b989=_0x1efc,_0x36d59e=_0x206da1=>{const _0x2fd14e=_0x1efc;_0x48890a(_0x206da1[_0x2fd14e(0xa41)]['files'][0x0]||null),_0x157ffd[_0x2fd14e(0xd7f)](_0x2fd14e(0xbbc),_0x36d59e);};_0x157ffd[_0x55b989(0x954)](_0x55b989(0xbbc),_0x36d59e,{'once':!![]}),_0x157ffd[_0x55b989(0x9cc)]();});if(!_0x2d2f75)return;const _0x4508dd=await _0x3ab788('命名头像框',_0x4bcd47(0xc3a));if(!_0x4508dd||!_0x4508dd[_0x4bcd47(0x13f9)]())return;const _0x3f4f6e=await new Promise(_0x3caa52=>{const _0x532198=_0x4bcd47,_0x30f144=new FileReader();_0x30f144['onload']=()=>_0x3caa52(_0x30f144[_0x532198(0x5c9)]),_0x30f144['readAsDataURL'](_0x2d2f75);});await _0x512070[_0x4bcd47(0x1529)][_0x4bcd47(0xe05)]({'name':_0x4508dd[_0x4bcd47(0x13f9)](),'url':_0x3f4f6e}),_0x504b79(_0x4a2ae0);}async function _0x3e84c4(){const _0x3c1745=_0x48bc6d,_0x2a55b9=_0x3c1745(0x1185),_0x5d49f0=await _0x3ab788(_0x3c1745(0xcfd),_0x3c1745(0xe92),'','textarea','<p\x20style=\x22font-size:12px;color:#888;\x22>'+_0x2a55b9+_0x3c1745(0x4cf));if(!_0x5d49f0||!_0x5d49f0['trim']())return;const _0x53b206=_0x5d49f0[_0x3c1745(0x13f9)]()[_0x3c1745(0x1536)]('\x0a'),_0xc14d68=[];let _0x26ede7=0x0;for(const _0x4f5ec6 of _0x53b206){const _0x3f208f=_0x4f5ec6['match'](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x3f208f)_0xc14d68[_0x3c1745(0x1c4)]({'name':_0x3f208f[0x1][_0x3c1745(0x13f9)](),'url':_0x3f208f[0x2]['trim']()});else _0x4f5ec6[_0x3c1745(0x13f9)]()&&_0x26ede7++;}_0xc14d68['length']>0x0&&(await _0x512070[_0x3c1745(0x1529)]['bulkAdd'](_0xc14d68),_0x504b79(_0x4a2ae0),await _0x403a62(_0x3c1745(0x90b),_0x3c1745(0xe9e)+_0xc14d68[_0x3c1745(0x106b)]+_0x3c1745(0x11ee))),_0x26ede7>0x0&&await _0x403a62('部分失败','有\x20'+_0x26ede7+'\x20行格式不正确，已被忽略。');}async function _0x368528(_0xfd69ab){const _0x596d67=_0x48bc6d,_0x1f4f0c=await _0x512070[_0x596d67(0x1529)][_0x596d67(0x14ee)](_0xfd69ab);if(!_0x1f4f0c)return;const _0x81d4db=await _0x2c9509(_0x596d67(0xd05),_0x596d67(0xecc)+_0x1f4f0c[_0x596d67(0x1561)]+_0x596d67(0x7a0),{'confirmButtonClass':_0x596d67(0xf5b)});_0x81d4db&&(await _0x512070[_0x596d67(0x1529)][_0x596d67(0x10a8)](_0xfd69ab),_0x504b79(_0x4a2ae0));}let _0x46373e=0x0;const _0x5155d7=0x2;function _0x4159be(){const _0x4e411a=_0x48bc6d,_0x174e1b=document[_0x4e411a(0x9a3)](_0x4e411a(0x14ce)),_0x48ac9b=document[_0x4e411a(0x9a3)]('home-screen-pages'),_0x12df97=document['querySelectorAll'](_0x4e411a(0x1255));let _0x3eab56=0x0,_0x25a7d9=0x0,_0x4d2264=0x0,_0x2a179a=![],_0x59c9ac=!![];const _0x16a1fb=()=>{const _0x1b074d=_0x4e411a;_0x48ac9b[_0x1b074d(0x20f)][_0x1b074d(0x352)]=_0x1b074d(0x52d)+_0x46373e*(0x64/_0x5155d7)+'%)',_0x12df97[_0x1b074d(0x15c1)]((_0x43599a,_0x172440)=>{const _0x277b53=_0x1b074d;_0x43599a['classList'][_0x277b53(0xc02)](_0x277b53(0xe9f),_0x172440===_0x46373e);});},_0x4b54be=_0x14fb02=>{const _0x4f9e03=_0x4e411a;_0x2a179a=!![],_0x59c9ac=!![],_0x3eab56=_0x14fb02[_0x4f9e03(0x1508)][_0x4f9e03(0x478)](_0x4f9e03(0x7b0))?_0x14fb02[_0x4f9e03(0x476)]:_0x14fb02[_0x4f9e03(0x12da)][0x0][_0x4f9e03(0x476)],_0x25a7d9=_0x14fb02['type']['includes']('mouse')?_0x14fb02[_0x4f9e03(0xd88)]:_0x14fb02['touches'][0x0][_0x4f9e03(0xd88)],_0x48ac9b[_0x4f9e03(0x20f)][_0x4f9e03(0x203)]=_0x4f9e03(0x8e0);},_0x507166=_0x554933=>{const _0x27c755=_0x4e411a;if(!_0x2a179a)return;const _0x28b149=_0x554933[_0x27c755(0x1508)][_0x27c755(0x478)]('mouse')?_0x554933['pageY']:_0x554933[_0x27c755(0x12da)][0x0][_0x27c755(0xd88)];_0x4d2264=_0x554933[_0x27c755(0x1508)][_0x27c755(0x478)](_0x27c755(0x7b0))?_0x554933[_0x27c755(0x476)]:_0x554933['touches'][0x0][_0x27c755(0x476)];const _0x239adc=_0x4d2264-_0x3eab56,_0xd46788=_0x28b149-_0x25a7d9;_0x59c9ac&&(Math[_0x27c755(0xc7c)](_0x239adc)>0xa||Math[_0x27c755(0xc7c)](_0xd46788)>0xa)&&(_0x59c9ac=![]);if(Math[_0x27c755(0xc7c)](_0x239adc)>Math[_0x27c755(0xc7c)](_0xd46788)){if(_0x554933[_0x27c755(0xbcd)])_0x554933[_0x27c755(0x28d)]();_0x48ac9b['style']['transform']=_0x27c755(0x626)+_0x46373e*(0x64/_0x5155d7)+'%\x20+\x20'+_0x239adc+_0x27c755(0x35b);}},_0x57887d=_0x18cc54=>{const _0x416e8f=_0x4e411a;if(!_0x2a179a)return;_0x2a179a=![],_0x48ac9b[_0x416e8f(0x20f)][_0x416e8f(0x203)]='transform\x200.4s\x20cubic-bezier(0.4,\x200,\x200.2,\x201)';if(_0x59c9ac){_0x16a1fb();return;}const _0x2e7386=_0x4d2264-_0x3eab56;if(Math[_0x416e8f(0xc7c)](_0x2e7386)>_0x174e1b['offsetWidth']/0x4){if(_0x2e7386>0x0&&_0x46373e>0x0)_0x46373e--;else _0x2e7386<0x0&&_0x46373e<_0x5155d7-0x1&&_0x46373e++;}_0x16a1fb();};_0x174e1b[_0x4e411a(0x954)](_0x4e411a(0x81d),_0x4b54be),_0x174e1b[_0x4e411a(0x954)](_0x4e411a(0x61c),_0x507166),_0x174e1b[_0x4e411a(0x954)]('mouseup',_0x57887d),_0x174e1b[_0x4e411a(0x954)](_0x4e411a(0x1093),_0x57887d),_0x174e1b[_0x4e411a(0x954)](_0x4e411a(0xfab),_0x4b54be,{'passive':![]}),_0x174e1b['addEventListener'](_0x4e411a(0x1294),_0x507166,{'passive':![]}),_0x174e1b[_0x4e411a(0x954)](_0x4e411a(0x36c),_0x57887d);}let _0x52c9c6=null;async function _0x5f0b4d(){const _0x8eb980=_0x48bc6d;await _0x1db7a9(),_0x35df44(_0x8eb980(0x3f9));}async function _0x1db7a9(){const _0x11b816=_0x48bc6d,_0x483252=document['getElementById']('preset-tabs'),_0x2dc083=document['getElementById'](_0x11b816(0x10b5));_0x483252['innerHTML']='',_0x2dc083[_0x11b816(0xeb2)]='';const [_0x57d6bc,_0x9829bf]=await Promise['all']([_0x512070['presets'][_0x11b816(0x591)](),_0x512070[_0x11b816(0xb4d)]['orderBy']('name')['toArray']()]);_0x19ddb8[_0x11b816(0xded)]=_0x57d6bc;if(_0x57d6bc[_0x11b816(0x106b)]===0x0){_0x2dc083[_0x11b816(0xeb2)]=_0x11b816(0x3a2);return;}const _0xfc3748=document[_0x11b816(0xe94)]('button');_0xfc3748[_0x11b816(0x1487)]=_0x11b816(0x3d1),_0xfc3748[_0x11b816(0x766)]='全部',_0xfc3748[_0x11b816(0xd8d)][_0x11b816(0x922)]=_0x11b816(0xbf1),_0x483252['appendChild'](_0xfc3748);const _0x395aaa=document['createElement'](_0x11b816(0x8ca));_0x395aaa[_0x11b816(0x1487)]='world-book-category-pane\x20active',_0x395aaa[_0x11b816(0xd8d)][_0x11b816(0x922)]=_0x11b816(0xbf1),_0x2dc083[_0x11b816(0x983)](_0x395aaa),_0x9829bf[_0x11b816(0x15c1)](_0x5bb55f=>{const _0x516f41=_0x11b816,_0x8c99a2=document[_0x516f41(0xe94)]('button');_0x8c99a2[_0x516f41(0x1487)]=_0x516f41(0x6bf),_0x8c99a2['textContent']=_0x5bb55f[_0x516f41(0x1561)],_0x8c99a2[_0x516f41(0xd8d)][_0x516f41(0x922)]=String(_0x5bb55f['id']),_0x483252['appendChild'](_0x8c99a2);const _0x57c088=document[_0x516f41(0xe94)](_0x516f41(0x8ca));_0x57c088[_0x516f41(0x1487)]=_0x516f41(0xe19),_0x57c088[_0x516f41(0xd8d)]['categoryId']=String(_0x5bb55f['id']),_0x2dc083[_0x516f41(0x983)](_0x57c088);});const _0x42fddc=_0x57d6bc[_0x11b816(0x336)](_0x22346f=>!_0x22346f[_0x11b816(0x922)]);if(_0x42fddc){const _0x4c2665=document[_0x11b816(0xe94)]('button');_0x4c2665[_0x11b816(0x1487)]='world-book-tab',_0x4c2665[_0x11b816(0x766)]='未分类',_0x4c2665[_0x11b816(0xd8d)][_0x11b816(0x922)]=_0x11b816(0x80f),_0x483252['appendChild'](_0x4c2665);const _0x2b6659=document['createElement'](_0x11b816(0x8ca));_0x2b6659[_0x11b816(0x1487)]=_0x11b816(0xe19),_0x2b6659[_0x11b816(0xd8d)][_0x11b816(0x922)]=_0x11b816(0x80f),_0x2dc083[_0x11b816(0x983)](_0x2b6659);}_0x57d6bc[_0x11b816(0x15c1)](_0x3e7cca=>{const _0x5633e1=_0x11b816,_0x2920d0=_0x5633e1(0x1458)+_0x3e7cca[_0x5633e1(0x4e3)][_0x5633e1(0x106b)]+_0x5633e1(0x6d6),_0x5baf5d=document[_0x5633e1(0xe94)](_0x5633e1(0x8ca));_0x5baf5d[_0x5633e1(0x1487)]=_0x5633e1(0x8ba),_0x5baf5d[_0x5633e1(0xeb2)]=_0x5633e1(0x10de)+_0x3e7cca[_0x5633e1(0x1561)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>'+_0x2920d0+_0x5633e1(0xa8e);const _0x4645fa=()=>_0x53de14(_0x3e7cca['id']),_0x41d019=async()=>{const _0x488b99=_0x5633e1,_0x14d9ca=await _0x2c9509('删除预设',_0x488b99(0x124c)+_0x3e7cca[_0x488b99(0x1561)]+_0x488b99(0xb14),{'confirmButtonClass':_0x488b99(0xf5b)});_0x14d9ca&&(await _0x512070[_0x488b99(0xded)][_0x488b99(0x10a8)](_0x3e7cca['id']),_0x19ddb8['presets']=await _0x512070[_0x488b99(0xded)][_0x488b99(0x591)](),_0x1db7a9());};_0x5baf5d[_0x5633e1(0x954)](_0x5633e1(0x9cc),_0x4645fa),_0x1a651b(_0x5baf5d,_0x41d019);const _0x345832=_0x5baf5d['cloneNode'](!![]);_0x345832['addEventListener']('click',_0x4645fa),_0x1a651b(_0x345832,_0x41d019),_0x395aaa[_0x5633e1(0x983)](_0x345832);const _0x2ef667=_0x3e7cca[_0x5633e1(0x922)]?String(_0x3e7cca[_0x5633e1(0x922)]):'uncategorized',_0x12884e=_0x2dc083[_0x5633e1(0xc86)]('.world-book-category-pane[data-category-id=\x22'+_0x2ef667+'\x22]');_0x12884e&&_0x12884e[_0x5633e1(0x983)](_0x5baf5d);}),document['querySelectorAll'](_0x11b816(0x4b1))[_0x11b816(0x15c1)](_0x543c47=>{const _0x10be8a=_0x11b816;_0x543c47['addEventListener']('click',()=>_0x3cc3ee(_0x543c47[_0x10be8a(0xd8d)][_0x10be8a(0x922)]));});}function _0x3cc3ee(_0x10dd0a){const _0x574f42=_0x48bc6d;document['querySelectorAll'](_0x574f42(0x4b1))[_0x574f42(0x15c1)](_0x19ab6c=>{const _0x3a6cc3=_0x574f42;_0x19ab6c[_0x3a6cc3(0x4d8)][_0x3a6cc3(0xc02)](_0x3a6cc3(0xe9f),_0x19ab6c[_0x3a6cc3(0xd8d)][_0x3a6cc3(0x922)]===_0x10dd0a);}),document['querySelectorAll']('#preset-content-container\x20.world-book-category-pane')[_0x574f42(0x15c1)](_0x107ddb=>{const _0x44bbf3=_0x574f42;_0x107ddb[_0x44bbf3(0x4d8)][_0x44bbf3(0xc02)](_0x44bbf3(0xe9f),_0x107ddb['dataset'][_0x44bbf3(0x922)]===_0x10dd0a);});}async function _0x53de14(_0x258d86){const _0x30abf8=_0x48bc6d;_0x35df44(_0x30abf8(0xec9)),_0x52c9c6=_0x258d86;try{const [_0x1057c1,_0x3e87ad]=await Promise[_0x30abf8(0xbf1)]([_0x512070[_0x30abf8(0xded)]['get'](_0x258d86),_0x512070['presetCategories'][_0x30abf8(0x591)]()]);if(!_0x1057c1){console[_0x30abf8(0x3b7)]('错误：尝试打开一个不存在的预设，ID:',_0x258d86),await _0x403a62(_0x30abf8(0x229),_0x30abf8(0x1596)),_0x35df44(_0x30abf8(0x3f9));return;}setTimeout(()=>{const _0x1d874b=_0x30abf8;document['getElementById']('preset-editor-title')[_0x1d874b(0x766)]=_0x1057c1[_0x1d874b(0x1561)],document[_0x1d874b(0x9a3)](_0x1d874b(0x117a))[_0x1d874b(0x7b2)]=_0x1057c1['name'];const _0x3b8ecf=document[_0x1d874b(0x9a3)](_0x1d874b(0x157e));_0x3b8ecf['innerHTML']=_0x1d874b(0xea0),_0x3e87ad[_0x1d874b(0x15c1)](_0x40fbd4=>{const _0x477a0c=_0x1d874b,_0x188d13=document['createElement']('option');_0x188d13[_0x477a0c(0x7b2)]=_0x40fbd4['id'],_0x188d13[_0x477a0c(0x766)]=_0x40fbd4['name'];if(_0x1057c1[_0x477a0c(0x922)]===_0x40fbd4['id'])_0x188d13[_0x477a0c(0x154b)]=!![];_0x3b8ecf[_0x477a0c(0x983)](_0x188d13);});const _0x575789=document[_0x1d874b(0x9a3)]('preset-entries-container');_0x575789['innerHTML']='',Array[_0x1d874b(0xb9b)](_0x1057c1[_0x1d874b(0x4e3)])&&_0x1057c1[_0x1d874b(0x4e3)]['length']>0x0?_0x1057c1[_0x1d874b(0x4e3)]['forEach'](_0x48e6a0=>{const _0x20ce6d=_0x1d874b,_0x41ef1b=_0x3bea8e(_0x48e6a0);_0x575789[_0x20ce6d(0x983)](_0x41ef1b);}):_0x575789[_0x1d874b(0xeb2)]=_0x1d874b(0x386);},0x32);}catch(_0x55b9a0){console['error'](_0x30abf8(0x926),_0x55b9a0),await _0x403a62(_0x30abf8(0x229),_0x30abf8(0xc17)+_0x55b9a0[_0x30abf8(0xcce)]),_0x35df44('preset-screen');}}function _0x3bea8e(_0x440a60={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x38cfc8=_0x48bc6d,_0x30b7a6=document[_0x38cfc8(0xe94)](_0x38cfc8(0x8ca));_0x30b7a6[_0x38cfc8(0x1487)]='message-editor-block';const _0x4faf29=_0x440a60[_0x38cfc8(0x15cd)]!==![]?_0x38cfc8(0x944):'';_0x30b7a6[_0x38cfc8(0xeb2)]=_0x38cfc8(0x13ab)+_0x4faf29+_0x38cfc8(0xa2b)+(_0x440a60['comment']||'')+'\x22\x20placeholder=\x22例如：角色核心设定\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22'+(_0x440a60[_0x38cfc8(0x2d0)]||[])[_0x38cfc8(0x3b9)](',\x20')+_0x38cfc8(0x231)+(_0x440a60[_0x38cfc8(0x4e3)]||'')+_0x38cfc8(0x59a),_0x30b7a6[_0x38cfc8(0xc86)](_0x38cfc8(0xc45))[_0x38cfc8(0x954)](_0x38cfc8(0x9cc),()=>_0x30b7a6[_0x38cfc8(0x133d)]());const _0x4d55ee=_0x30b7a6[_0x38cfc8(0xc86)](_0x38cfc8(0x505)),_0x1c9731=_0x30b7a6[_0x38cfc8(0xc86)](_0x38cfc8(0x15cc));return _0x4d55ee[_0x38cfc8(0x954)](_0x38cfc8(0x9cc),()=>{const _0x51560d=_0x38cfc8,_0x3232a1=_0x1c9731[_0x51560d(0x20f)][_0x51560d(0x115d)]===_0x51560d(0x8e0);_0x1c9731['style'][_0x51560d(0x115d)]=_0x3232a1?'block':'none',_0x4d55ee[_0x51560d(0x766)]=_0x3232a1?'收起':'展开';}),_0x30b7a6;}async function _0x4a8af2(){const _0x56e51f=_0x48bc6d;await _0x526597(),document[_0x56e51f(0xc86)](_0x56e51f(0x12b2))['textContent']=_0x56e51f(0x420),document[_0x56e51f(0x9a3)](_0x56e51f(0x427))[_0x56e51f(0x4ce)]=_0x228d5e,document[_0x56e51f(0x9a3)](_0x56e51f(0x6f3))[_0x56e51f(0x4ce)]=_0x5bbaa6=>{const _0x254143=_0x56e51f;_0x5bbaa6[_0x254143(0xa41)][_0x254143(0x4d8)][_0x254143(0x1222)](_0x254143(0x6de))&&_0x2b57f5(parseInt(_0x5bbaa6[_0x254143(0xa41)][_0x254143(0xd8d)]['id']));},document[_0x56e51f(0x9a3)](_0x56e51f(0x146f))['onclick']=()=>{const _0x550828=_0x56e51f;document[_0x550828(0x9a3)](_0x550828(0x795))[_0x550828(0x4d8)][_0x550828(0x133d)](_0x550828(0xc09)),_0x1db7a9();},document['getElementById'](_0x56e51f(0x795))[_0x56e51f(0x4d8)][_0x56e51f(0xe05)]('visible');}async function _0x526597(){const _0x61c161=_0x48bc6d,_0x256f9c=document[_0x61c161(0x9a3)](_0x61c161(0x6f3)),_0x148092=await _0x512070[_0x61c161(0xb4d)][_0x61c161(0x591)]();_0x256f9c['innerHTML']='',_0x148092[_0x61c161(0x106b)]===0x0&&(_0x256f9c['innerHTML']=_0x61c161(0x6ec)),_0x148092[_0x61c161(0x15c1)](_0x4f34ff=>{const _0x57ad22=_0x61c161,_0x178dd2=document['createElement'](_0x57ad22(0x8ca));_0x178dd2['className']=_0x57ad22(0x3bb),_0x178dd2[_0x57ad22(0xeb2)]='<span\x20class=\x22group-name\x22>'+_0x4f34ff['name']+_0x57ad22(0x272)+_0x4f34ff['id']+_0x57ad22(0xb9e),_0x256f9c[_0x57ad22(0x983)](_0x178dd2);});}async function _0x228d5e(){const _0x5c74ed=_0x48bc6d,_0x1e5d16=document[_0x5c74ed(0x9a3)](_0x5c74ed(0xd2c)),_0x505aa4=_0x1e5d16[_0x5c74ed(0x7b2)][_0x5c74ed(0x13f9)]();if(!_0x505aa4)return alert(_0x5c74ed(0x1081));const _0x16beea=await _0x512070[_0x5c74ed(0xb4d)][_0x5c74ed(0x1201)](_0x5c74ed(0x1561))[_0x5c74ed(0x5df)](_0x505aa4)[_0x5c74ed(0x92c)]();if(_0x16beea)return alert(_0x5c74ed(0xd10)+_0x505aa4+_0x5c74ed(0x60a));await _0x512070[_0x5c74ed(0xb4d)]['add']({'name':_0x505aa4}),_0x1e5d16[_0x5c74ed(0x7b2)]='',await _0x526597();}async function _0x2b57f5(_0x373f45){const _0xdcc9fa=_0x48bc6d,_0x3df0c8=await _0x2c9509(_0xdcc9fa(0xd05),'删除分类后，该分类下的所有预设将变为“未分类”。确定吗？',{'confirmButtonClass':'btn-danger'});_0x3df0c8&&(await _0x512070[_0xdcc9fa(0xb4d)][_0xdcc9fa(0x10a8)](_0x373f45),await _0x512070[_0xdcc9fa(0xded)][_0xdcc9fa(0x1201)](_0xdcc9fa(0x922))['equals'](_0x373f45)[_0xdcc9fa(0x572)]({'categoryId':null}),_0x19ddb8[_0xdcc9fa(0xded)]=await _0x512070[_0xdcc9fa(0xded)]['toArray'](),await _0x526597());}async function _0x5daa1a(_0x5914b9){const _0x17a7f1=_0x48bc6d,_0x2e9d1d=_0x5914b9['target'][_0x17a7f1(0x104e)][0x0];if(!_0x2e9d1d)return;try{if(!_0x2e9d1d[_0x17a7f1(0x1561)][_0x17a7f1(0xb5a)](_0x17a7f1(0x6db)))throw new Error(_0x17a7f1(0x367));const _0x372bb9=await _0x2e9d1d['text'](),_0x3e75d9=JSON['parse'](_0x372bb9);await _0x9c5770(_0x3e75d9,_0x2e9d1d[_0x17a7f1(0x1561)]);}catch(_0x385c21){console[_0x17a7f1(0x3b7)](_0x17a7f1(0x1528),_0x385c21),await _0x403a62('导入失败',_0x17a7f1(0xa9f)+_0x385c21[_0x17a7f1(0xcce)]);}finally{_0x5914b9[_0x17a7f1(0xa41)][_0x17a7f1(0x7b2)]=null;}}async function _0x9c5770(_0x5d25e2,_0x3e5a33){const _0x57374b=_0x48bc6d;let _0x1afeec=[];if(Array[_0x57374b(0xb9b)](_0x5d25e2['prompts'])&&Array[_0x57374b(0xb9b)](_0x5d25e2['prompt_order'])&&_0x5d25e2[_0x57374b(0x200)][_0x57374b(0x106b)]>0x0){console[_0x57374b(0xe4d)](_0x57374b(0x8f5));const _0x320e68=new Map(_0x5d25e2[_0x57374b(0xbc1)][_0x57374b(0xb0a)](_0x38fa87=>[_0x38fa87[_0x57374b(0x147a)],_0x38fa87])),_0x3ca3ff=_0x5d25e2[_0x57374b(0x200)]['reduce']((_0x17eee8,_0x13047e)=>_0x13047e[_0x57374b(0x1111)]&&_0x13047e[_0x57374b(0x1111)][_0x57374b(0x106b)]>(_0x17eee8[_0x57374b(0x106b)]||0x0)?_0x13047e[_0x57374b(0x1111)]:_0x17eee8,[]);_0x3ca3ff&&_0x3ca3ff[_0x57374b(0x106b)]>0x0&&(_0x1afeec=_0x3ca3ff['map'](_0x16435b=>{const _0x5ca05e=_0x57374b,_0xfec346=_0x320e68[_0x5ca05e(0x14ee)](_0x16435b[_0x5ca05e(0x147a)]);if(_0xfec346)return{'keys':[],'comment':_0xfec346[_0x5ca05e(0x1561)]||_0x5ca05e(0x7c6),'content':_0xfec346[_0x5ca05e(0x4e3)]||'','enabled':_0x16435b[_0x5ca05e(0x15cd)]};return null;})[_0x57374b(0x1195)](Boolean));}else{if(_0x5d25e2[_0x57374b(0x10c3)]&&typeof _0x5d25e2[_0x57374b(0x10c3)]===_0x57374b(0x12fe))console[_0x57374b(0xe4d)](_0x57374b(0xc92)),Array[_0x57374b(0xb9b)](_0x5d25e2[_0x57374b(0x1111)])?(console[_0x57374b(0xe4d)](_0x57374b(0x632)),_0x1afeec=_0x5d25e2['order']['map'](_0x13e767=>_0x5d25e2[_0x57374b(0x10c3)][_0x13e767])[_0x57374b(0x1195)](Boolean)[_0x57374b(0xb0a)](_0x294a84=>({'keys':_0x294a84[_0x57374b(0xf33)]||[],'comment':_0x294a84[_0x57374b(0x79d)]||'无备注','content':_0x294a84['content']||'','enabled':!_0x294a84['disable']}))):(console[_0x57374b(0x651)](_0x57374b(0xe21)),_0x1afeec=Object[_0x57374b(0xea1)](_0x5d25e2['entries'])[_0x57374b(0xb0a)](_0x2ae166=>({'keys':_0x2ae166[_0x57374b(0xf33)]||[],'comment':_0x2ae166[_0x57374b(0x79d)]||_0x57374b(0xbcc),'content':_0x2ae166[_0x57374b(0x4e3)]||'','enabled':!_0x2ae166['disable']})));else{if(Array['isArray'](_0x5d25e2[_0x57374b(0xbc1)]))console[_0x57374b(0xe4d)]('检测到简单的\x20\x27prompts\x27\x20数组格式，将按数组内顺序导入。'),_0x1afeec=_0x5d25e2[_0x57374b(0xbc1)][_0x57374b(0xb0a)](_0x5b8fe9=>({'keys':[],'comment':_0x5b8fe9['name']||_0x57374b(0x7c6),'content':_0x5b8fe9[_0x57374b(0x4e3)]||'','enabled':!![]}));else throw new Error(_0x57374b(0x88b));}}_0x1afeec=_0x1afeec[_0x57374b(0x1195)](_0x5734f5=>_0x5734f5[_0x57374b(0x4e3)]);if(_0x1afeec['length']===0x0){alert(_0x57374b(0xc2e));return;}const _0xef36b2=_0x3e5a33[_0x57374b(0x1bb)](/\.json$/i,''),_0x13432a=await _0x3ab788('导入\x20Tavern\x20预设',_0x57374b(0x14ea),_0xef36b2);if(!_0x13432a||!_0x13432a['trim']()){alert('导入已取消，因为未提供名称。');return;}const _0x52855a={'id':_0x57374b(0xb40)+Date['now'](),'name':_0x13432a['trim'](),'content':_0x1afeec,'categoryId':null};await _0x512070[_0x57374b(0xded)][_0x57374b(0xe05)](_0x52855a),_0x19ddb8[_0x57374b(0xded)][_0x57374b(0x1c4)](_0x52855a),await _0x1db7a9(),await _0x403a62(_0x57374b(0x125b),_0x57374b(0x130b)+_0x13432a+'》。');}async function _0x84884(_0x3ef4a0){const _0x364538=_0x48bc6d,_0x269c47=document['getElementById'](_0x364538(0xc3f));if(!_0x269c47)return;const _0x2c5cad=_0x19ddb8[_0x364538(0xded)]||[];_0x269c47[_0x364538(0xeb2)]='<option\x20value=\x22\x22>--\x20不使用预设\x20--</option>',_0x2c5cad['forEach'](_0x299820=>{const _0x2720f1=_0x364538,_0x3b00da=document['createElement'](_0x2720f1(0x43a));_0x3b00da['value']=_0x299820['id'],_0x3b00da[_0x2720f1(0x766)]=_0x299820[_0x2720f1(0x1561)],_0x269c47[_0x2720f1(0x983)](_0x3b00da);}),_0x3ef4a0[_0x364538(0x450)][_0x364538(0x112a)]&&(_0x269c47['value']=_0x3ef4a0['settings'][_0x364538(0x112a)]);}function _0x3d16c1(){const _0x49160d=_0x48bc6d,_0x56a09e=document[_0x49160d(0x9a3)](_0x49160d(0x18d));if(!_0x56a09e)return;_0x56a09e[_0x49160d(0xeb2)]='';let _0x2c09c8=_0x19ddb8[_0x49160d(0x4c8)]['chatActionButtonsOrder']||_0x1c10a1;_0x2c09c8['forEach'](_0x4026ea=>{const _0x10c868=_0x49160d,_0x4dd824=document['getElementById'](_0x4026ea);if(_0x4dd824){const _0x2ef829=document['createElement'](_0x10c868(0x8ca));_0x2ef829['className']=_0x10c868(0x755),_0x2ef829['draggable']=!![],_0x2ef829[_0x10c868(0xd8d)][_0x10c868(0x11d8)]=_0x4026ea,_0x2ef829['innerHTML']=_0x4dd824[_0x10c868(0xeb2)],_0x56a09e[_0x10c868(0x983)](_0x2ef829);}});}function _0x1069c6(){const _0x3628f9=_0x48bc6d,_0x13efbf=document[_0x3628f9(0x9a3)](_0x3628f9(0x18d));if(!_0x13efbf)return;let _0x2d05f2=null;const _0x2b4486=_0x56219f=>{const _0x2b7ce5=_0x3628f9,_0x48a11a=_0x56219f['target'][_0x2b7ce5(0x94c)](_0x2b7ce5(0x1271));if(!_0x48a11a)return;_0x2d05f2=_0x48a11a,_0x2d05f2['classList']['add'](_0x2b7ce5(0x232));if(_0x56219f[_0x2b7ce5(0xbcd)])_0x56219f[_0x2b7ce5(0x28d)]();},_0x2a26fa=_0x3cc4a1=>{const _0x262d0c=_0x3628f9;if(!_0x2d05f2)return;const _0xe9e157=_0x3cc4a1[_0x262d0c(0x1508)]['includes'](_0x262d0c(0x7b0))?_0x3cc4a1[_0x262d0c(0x11e8)]:_0x3cc4a1[_0x262d0c(0x12da)][0x0][_0x262d0c(0x11e8)],_0x20e295=_0x5afe9e(_0x13efbf,_0xe9e157);_0x20e295==null?_0x13efbf[_0x262d0c(0x983)](_0x2d05f2):_0x13efbf[_0x262d0c(0x11c8)](_0x2d05f2,_0x20e295);},_0x17ddfa=()=>{const _0x2746b7=_0x3628f9;if(!_0x2d05f2)return;_0x2d05f2[_0x2746b7(0x4d8)]['remove'](_0x2746b7(0x232)),_0x2d05f2=null,_0x4aa6fe();};_0x13efbf[_0x3628f9(0x954)](_0x3628f9(0x81d),_0x2b4486),_0x13efbf[_0x3628f9(0x954)](_0x3628f9(0xfab),_0x2b4486,{'passive':![]}),_0x13efbf[_0x3628f9(0x954)]('mousemove',_0x2a26fa),_0x13efbf[_0x3628f9(0x954)](_0x3628f9(0x1294),_0x2a26fa,{'passive':![]}),_0x13efbf[_0x3628f9(0x954)](_0x3628f9(0x11e4),_0x17ddfa),_0x13efbf[_0x3628f9(0x954)]('mouseleave',_0x17ddfa),_0x13efbf['addEventListener'](_0x3628f9(0x36c),_0x17ddfa);}function _0x5afe9e(_0x111f1a,_0x5b8f99){const _0x5e58f0=_0x48bc6d,_0x16a20e=[..._0x111f1a[_0x5e58f0(0x131c)]('.draggable-button-item:not(.dragging)')];return _0x16a20e[_0x5e58f0(0x68f)]((_0x597ab0,_0x577bc6)=>{const _0x1c82c5=_0x5e58f0,_0x1aaa51=_0x577bc6[_0x1c82c5(0x31d)](),_0x52e17a=_0x5b8f99-_0x1aaa51[_0x1c82c5(0xb90)]-_0x1aaa51[_0x1c82c5(0xeb0)]/0x2;return _0x52e17a<0x0&&_0x52e17a>_0x597ab0[_0x1c82c5(0xccc)]?{'offset':_0x52e17a,'element':_0x577bc6}:_0x597ab0;},{'offset':Number['NEGATIVE_INFINITY']})[_0x5e58f0(0xd36)];}async function _0x4aa6fe(){const _0x11dcf6=_0x48bc6d,_0x46c996=document[_0x11dcf6(0x9a3)](_0x11dcf6(0x18d)),_0x1eee53=Array[_0x11dcf6(0x1311)](_0x46c996['querySelectorAll']('.draggable-button-item'))[_0x11dcf6(0xb0a)](_0x18c390=>_0x18c390['dataset'][_0x11dcf6(0x11d8)]);_0x19ddb8['globalSettings']['chatActionButtonsOrder']=_0x1eee53,await _0x512070['globalSettings']['put'](_0x19ddb8[_0x11dcf6(0x4c8)]);}function _0x44b5e7(){const _0x5bea54=_0x48bc6d,_0x3e9389=_0x19ddb8[_0x5bea54(0x4c8)][_0x5bea54(0x288)];if(!_0x3e9389||!Array[_0x5bea54(0xb9b)](_0x3e9389)||_0x3e9389[_0x5bea54(0x106b)]===0x0)return;const _0x12cd4f=document[_0x5bea54(0x9a3)](_0x5bea54(0x95a));if(!_0x12cd4f)return;_0x3e9389[_0x5bea54(0x15c1)](_0x3a8dce=>{const _0x38dc2f=_0x5bea54,_0x1e740d=document[_0x38dc2f(0x9a3)](_0x3a8dce);_0x1e740d&&_0x12cd4f[_0x38dc2f(0x983)](_0x1e740d);});}const _0x1c10a1=[_0x48bc6d(0x350),_0x48bc6d(0x8b6),'upload-image-btn',_0x48bc6d(0xe15),_0x48bc6d(0x11b3),_0x48bc6d(0x61f),'video-call-btn',_0x48bc6d(0x14ad),_0x48bc6d(0xd3e),_0x48bc6d(0xff2),_0x48bc6d(0x981),_0x48bc6d(0x62e),_0x48bc6d(0x1242),_0x48bc6d(0x5e8),'edit-last-response-btn',_0x48bc6d(0x16a),_0x48bc6d(0x3a8),_0x48bc6d(0x10c4),'werewolf-game-btn',_0x48bc6d(0xfa0),'open-nai-gallery-btn'];async function _0x2d7620(){const _0x3e3ee6=_0x48bc6d;_0x19ddb8[_0x3e3ee6(0x4c8)][_0x3e3ee6(0x288)]=null,await _0x512070[_0x3e3ee6(0x4c8)][_0x3e3ee6(0xd4d)](_0x19ddb8[_0x3e3ee6(0x4c8)]),_0x3d16c1(),_0x44b5e7(),await _0x403a62('成功','按钮顺序已恢复为默认设置！');}let _0x27e1e0=[],_0x1fee73=[];function _0x3d4a36(){const _0x1abd28=_0x48bc6d,_0x269d97=document['getElementById'](_0x1abd28(0x6b5));_0x27e1e0=[],_0x1fee73=[],_0x9d9da2(),document[_0x1abd28(0x9a3)](_0x1abd28(0x7b6))[_0x1abd28(0x20f)][_0x1abd28(0x115d)]=_0x1abd28(0x79c),document[_0x1abd28(0x9a3)](_0x1abd28(0x28e))[_0x1abd28(0x20f)][_0x1abd28(0x115d)]=_0x1abd28(0x8e0),_0x269d97[_0x1abd28(0x4d8)]['add']('visible');}function _0x9d9da2(){const _0x36fbd0=_0x48bc6d,_0x381cf4=document[_0x36fbd0(0x9a3)]('data-clear-char-list');_0x381cf4[_0x36fbd0(0xeb2)]='';const _0x5ba5cd=document[_0x36fbd0(0xe94)](_0x36fbd0(0x8ca));_0x5ba5cd[_0x36fbd0(0x1487)]=_0x36fbd0(0x729),_0x5ba5cd['dataset'][_0x36fbd0(0xfc7)]='user',_0x5ba5cd['innerHTML']=_0x36fbd0(0x107e)+(_0x19ddb8[_0x36fbd0(0x9ce)][_0x36fbd0(0x246)]||'我')+_0x36fbd0(0x396),_0x381cf4['appendChild'](_0x5ba5cd),Object[_0x36fbd0(0xea1)](_0x19ddb8[_0x36fbd0(0xb04)])[_0x36fbd0(0x15c1)](_0x4b5e97=>{const _0x30f813=_0x36fbd0;if(!_0x4b5e97[_0x30f813(0x136b)]){const _0x5b60b9=document[_0x30f813(0xe94)](_0x30f813(0x8ca));_0x5b60b9[_0x30f813(0x1487)]=_0x30f813(0x729),_0x5b60b9[_0x30f813(0xd8d)]['charId']=_0x4b5e97['id'],_0x5b60b9['innerHTML']=_0x30f813(0x138c)+_0x4b5e97['name']+_0x30f813(0x315),_0x381cf4['appendChild'](_0x5b60b9);}});}function _0x2fd139(){const _0x42fd84=_0x48bc6d,_0x20f58b=document[_0x42fd84(0x9a3)]('data-clear-type-list');_0x20f58b['innerHTML']='';const _0x44062f=[{'id':_0x42fd84(0xd43),'name':_0x42fd84(0x1248),'description':'将清空选定角色的所有对话消息、曾用备注和你的昵称。'},{'id':_0x42fd84(0x14b1),'name':_0x42fd84(0x15d9),'description':_0x42fd84(0xc29)},{'id':_0x42fd84(0x12e2),'name':'通话记录','description':_0x42fd84(0x1442)},{'id':_0x42fd84(0xc6e),'name':'心声','description':_0x42fd84(0xfbb)},{'id':_0x42fd84(0xe87),'name':_0x42fd84(0x936),'description':_0x42fd84(0x5fe)},{'id':_0x42fd84(0x73d),'name':'收藏','description':'将清空收藏夹中所有与该角色相关的内容（如聊天、动态、日记等）。'},{'id':_0x42fd84(0x875),'name':_0x42fd84(0xafc),'description':'将清空角色的相册、QQ、浏览器、淘宝、日记、备忘录等所有模拟手机数据。'}];_0x44062f['forEach'](_0x30f116=>{const _0x87d480=_0x42fd84,_0x47ea1a=document[_0x87d480(0xe94)]('div');_0x47ea1a[_0x87d480(0x1487)]=_0x87d480(0x729),_0x47ea1a['dataset']['typeId']=_0x30f116['id'],_0x47ea1a[_0x87d480(0xeb2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x30f116[_0x87d480(0x1561)]+_0x87d480(0x2a2)+_0x30f116['description']+_0x87d480(0x104b),_0x20f58b[_0x87d480(0x983)](_0x47ea1a);});}function _0x301a1e(){const _0x5aebd9=_0x48bc6d,_0x10c56e=document[_0x5aebd9(0x131c)](_0x5aebd9(0x938));if(_0x10c56e[_0x5aebd9(0x106b)]===0x0){alert(_0x5aebd9(0xfca));return;}_0x27e1e0=Array[_0x5aebd9(0x1311)](_0x10c56e)[_0x5aebd9(0xb0a)](_0x3b2524=>_0x3b2524[_0x5aebd9(0xd8d)]['charId']),_0x2fd139(),document[_0x5aebd9(0x9a3)]('data-clear-step-1')[_0x5aebd9(0x20f)]['display']='none',document[_0x5aebd9(0x9a3)](_0x5aebd9(0x28e))[_0x5aebd9(0x20f)][_0x5aebd9(0x115d)]=_0x5aebd9(0x79c);}function _0x2617eb(){const _0x433e6a=_0x48bc6d;document[_0x433e6a(0x9a3)](_0x433e6a(0x28e))[_0x433e6a(0x20f)]['display']='none',document['getElementById']('data-clear-step-1')[_0x433e6a(0x20f)][_0x433e6a(0x115d)]=_0x433e6a(0x79c),document['querySelectorAll'](_0x433e6a(0x6bb))[_0x433e6a(0x15c1)](_0x26cd1d=>{const _0x5d639c=_0x433e6a;_0x27e1e0[_0x5d639c(0x478)](_0x26cd1d[_0x5d639c(0xd8d)]['charId'])&&_0x26cd1d['classList'][_0x5d639c(0xe05)]('selected');});}async function _0xa868e4(){const _0x51bd78=_0x48bc6d,_0x210b19=document[_0x51bd78(0x131c)]('#data-clear-type-list\x20.clear-posts-item.selected');if(_0x210b19[_0x51bd78(0x106b)]===0x0){alert('请至少选择一种要清理的数据类型。');return;}_0x1fee73=Array[_0x51bd78(0x1311)](_0x210b19)['map'](_0x34688d=>_0x34688d[_0x51bd78(0xd8d)][_0x51bd78(0x637)]);const _0x466f1f=await _0x2c9509(_0x51bd78(0x451),'此操作将永久删除您选择的所有数据，且无法恢复！确定要继续吗？',{'confirmButtonClass':_0x51bd78(0xf5b),'confirmText':_0x51bd78(0xd05)});if(!_0x466f1f)return;await _0x403a62(_0x51bd78(0x1395),_0x51bd78(0xc2c));try{await _0x512070['transaction']('rw',_0x512070[_0x51bd78(0x138f)],async()=>{const _0x43505d=_0x51bd78;for(const _0x934380 of _0x27e1e0){for(const _0x29ded0 of _0x1fee73){if(_0x29ded0===_0x43505d(0xd43)){if(_0x934380===_0x43505d(0x20d)){const _0x14e0bc=await _0x512070['chats'][_0x43505d(0x591)]();for(const _0x990f8e of _0x14e0bc){_0x990f8e[_0x43505d(0x1f0)]=_0x990f8e[_0x43505d(0x1f0)][_0x43505d(0x1195)](_0x2be99e=>_0x2be99e[_0x43505d(0x11c1)]!=='user'),await _0x512070[_0x43505d(0xb04)][_0x43505d(0xd4d)](_0x990f8e);}}else{const _0x149685=await _0x512070[_0x43505d(0xb04)][_0x43505d(0x14ee)](_0x934380);_0x149685&&(_0x149685[_0x43505d(0x1f0)]=[],_0x149685['heartfeltVoice']=_0x43505d(0x4a5),_0x149685[_0x43505d(0x69b)]=_0x43505d(0x4a5),Array['isArray'](_0x149685['nameHistory'])&&(_0x149685['nameHistory']=[]),_0x149685['settings']&&(_0x149685['settings'][_0x43505d(0x1555)]='我'),await _0x512070[_0x43505d(0xb04)][_0x43505d(0xd4d)](_0x149685));}}if(_0x29ded0===_0x43505d(0x14b1)){const _0x96573a=_0x934380===_0x43505d(0x20d)?_0x43505d(0x20d):_0x934380;await _0x512070[_0x43505d(0x10e5)][_0x43505d(0x1201)](_0x43505d(0x82c))[_0x43505d(0x5df)](_0x96573a)['delete']();}_0x29ded0===_0x43505d(0x12e2)&&_0x934380!==_0x43505d(0x20d)&&await _0x512070[_0x43505d(0xad1)][_0x43505d(0x1201)](_0x43505d(0x907))[_0x43505d(0x5df)](_0x934380)[_0x43505d(0x10a8)]();if(_0x29ded0===_0x43505d(0xc6e)&&_0x934380!==_0x43505d(0x20d)){const _0x16155b=await _0x512070[_0x43505d(0xb04)][_0x43505d(0x14ee)](_0x934380);_0x16155b&&(_0x16155b[_0x43505d(0xd4a)]=[],_0x16155b[_0x43505d(0x390)]=_0x43505d(0x4a5),_0x16155b[_0x43505d(0x69b)]=_0x43505d(0x4a5),await _0x512070['chats'][_0x43505d(0xd4d)](_0x16155b));}if(_0x29ded0===_0x43505d(0xe87)&&_0x934380!==_0x43505d(0x20d)){const _0x5b0437=await _0x512070[_0x43505d(0xb04)]['get'](_0x934380);_0x5b0437&&(_0x5b0437[_0x43505d(0x744)]=[],await _0x512070[_0x43505d(0xb04)][_0x43505d(0xd4d)](_0x5b0437));}_0x29ded0==='favorites'&&(_0x934380==='user'?(await _0x512070[_0x43505d(0x73d)][_0x43505d(0x1201)](_0x43505d(0x1508))[_0x43505d(0x5df)](_0x43505d(0x120f))[_0x43505d(0x1195)](_0x209dfc=>_0x209dfc[_0x43505d(0x4e3)][_0x43505d(0x82c)]===_0x43505d(0x20d))['delete'](),await _0x512070[_0x43505d(0x73d)][_0x43505d(0x1201)](_0x43505d(0x1508))['equals'](_0x43505d(0xdd1))[_0x43505d(0x1195)](_0x2887ae=>_0x2887ae[_0x43505d(0x4e3)][_0x43505d(0x11c1)]===_0x43505d(0x20d))['delete']()):(await _0x512070[_0x43505d(0x73d)]['where'](_0x43505d(0x1508))[_0x43505d(0x5df)]('chat_message')[_0x43505d(0x5db)](_0x3ce899=>_0x3ce899[_0x43505d(0x907)]===_0x934380)[_0x43505d(0x10a8)](),await _0x512070[_0x43505d(0x73d)][_0x43505d(0x1201)](_0x43505d(0x1508))[_0x43505d(0x5df)](_0x43505d(0x120f))[_0x43505d(0x1195)](_0x663391=>_0x663391['content']['authorId']===_0x934380)['delete'](),await _0x512070[_0x43505d(0x73d)]['where']('type')[_0x43505d(0x5df)](_0x43505d(0x1139))[_0x43505d(0x1195)](_0x4c1e30=>_0x4c1e30['content'][_0x43505d(0xdb4)]===_0x934380)['delete'](),await _0x512070[_0x43505d(0x73d)][_0x43505d(0x1201)](_0x43505d(0x1508))[_0x43505d(0x5df)](_0x43505d(0x1562))[_0x43505d(0x1195)](_0x1b2406=>_0x1b2406[_0x43505d(0x4e3)][_0x43505d(0xdb4)]===_0x934380)[_0x43505d(0x10a8)](),await _0x512070[_0x43505d(0x73d)][_0x43505d(0x1201)]('type')[_0x43505d(0x5df)](_0x43505d(0x14d3))[_0x43505d(0x1195)](_0x3411d3=>_0x3411d3['content'][_0x43505d(0xdb4)]===_0x934380)[_0x43505d(0x10a8)]()));if(_0x29ded0===_0x43505d(0x875)&&_0x934380!==_0x43505d(0x20d)){const _0x4cba25=await _0x512070[_0x43505d(0xb04)]['get'](_0x934380);_0x4cba25&&(_0x4cba25[_0x43505d(0x76f)]=[],_0x4cba25['simulatedConversations']=[],_0x4cba25['simulatedBrowserHistory']=[],_0x4cba25[_0x43505d(0x15a1)]=null,_0x4cba25[_0x43505d(0x11a9)]=[],_0x4cba25['simulatedAppUsage']=[],_0x4cba25['simulatedMusicPlaylist']=[],_0x4cba25[_0x43505d(0xf3e)]=[],_0x4cba25[_0x43505d(0xbc0)]=[],await _0x512070[_0x43505d(0xb04)][_0x43505d(0xd4d)](_0x4cba25));}}}}),await _0x11ed48(),await _0xec8072(),document['getElementById'](_0x51bd78(0x6b5))['classList']['remove'](_0x51bd78(0xc09)),await _0x403a62(_0x51bd78(0x115f),_0x51bd78(0x127c));}catch(_0x30aec2){console[_0x51bd78(0x3b7)](_0x51bd78(0x12af),_0x30aec2),await _0x403a62(_0x51bd78(0x1247),_0x51bd78(0x1564)+_0x30aec2[_0x51bd78(0xcce)]);}}async function _0x580571(_0x3b3644,_0xde90d7,_0x509fb4){const _0xada90d=_0x48bc6d,_0x3a7fe4=_0x509fb4['querySelector']('.icon-preview')[_0xada90d(0x881)],_0x56bb9f=await _0x49acac(_0xada90d(0x8ae)+_0x3a7fe4+'”图标',[{'text':_0xada90d(0x5a6),'value':'local'},{'text':_0xada90d(0x974),'value':_0xada90d(0x121f)}]);let _0x804c35=null;if(_0x56bb9f===_0xada90d(0x66d))_0x804c35=await _0x5a2cc8();else{if(_0x56bb9f===_0xada90d(0x121f)){const _0x25ee92=_0xde90d7===_0xada90d(0x875)?_0x19ddb8[_0xada90d(0x4c8)][_0xada90d(0xa4e)][_0x3b3644]:_0x19ddb8[_0xada90d(0x4c8)]['appIcons'][_0x3b3644],_0x7b5079=_0x25ee92[_0xada90d(0x608)](_0xada90d(0x12b9)),_0xbb037a=_0x7b5079?'':_0x25ee92;_0x804c35=await _0x3ab788(_0xada90d(0xdde),_0xada90d(0x343),_0xbb037a,_0xada90d(0x121f));}}if(_0x804c35&&_0x804c35[_0xada90d(0x13f9)]()){const _0x143679=_0x804c35[_0xada90d(0x13f9)]();_0xde90d7===_0xada90d(0x875)?_0x19ddb8['globalSettings'][_0xada90d(0xa4e)][_0x3b3644]=_0x143679:_0x19ddb8['globalSettings'][_0xada90d(0xbb4)][_0x3b3644]=_0x143679,_0x509fb4[_0xada90d(0xc86)](_0xada90d(0x760))[_0xada90d(0x10d4)]=_0x143679;}else _0x804c35!==null&&alert(_0xada90d(0x3a6));}async function _0x335e56(){const _0x1e1450=_0x48bc6d,_0x14843d=await _0x2c9509(_0x1e1450(0x502),_0x1e1450(0xc25),{'confirmButtonClass':_0x1e1450(0xf5b),'confirmText':_0x1e1450(0x14e3)});if(!_0x14843d)return;await _0x403a62(_0x1e1450(0x1395),_0x1e1450(0xa57));let _0x4650dc={'found':0x0,'compressed':0x0,'skipped':0x0,'originalSize':0x0,'newSize':0x0};try{console[_0x1e1450(0xe4d)](_0x1e1450(0x55f));const _0xf17d68=['chats',_0x1e1450(0x4c8),_0x1e1450(0x9ce),_0x1e1450(0x1557),_0x1e1450(0x1529)],_0x4b812b=[];for(const _0x2f1265 of _0xf17d68){const _0x5b8465=_0x512070[_0x1e1450(0x459)](_0x2f1265),_0x3dda42=await _0x5b8465[_0x1e1450(0x591)]();_0x4b812b[_0x1e1450(0x1c4)]({'tableName':_0x2f1265,'records':_0x3dda42});}console[_0x1e1450(0xe4d)](_0x1e1450(0x13a9));for(const _0x1d7370 of _0x4b812b){for(const _0x410b86 of _0x1d7370[_0x1e1450(0x4f5)]){await _0x209260(_0x410b86,_0x4650dc);}}console[_0x1e1450(0xe4d)](_0x1e1450(0xf70)),await _0x512070[_0x1e1450(0x1072)]('rw',_0xf17d68,async()=>{const _0x22cfff=_0x1e1450;for(const _0x378ec6 of _0x4b812b){await _0x512070['table'](_0x378ec6[_0x22cfff(0xb79)])[_0x22cfff(0xc71)](_0x378ec6[_0x22cfff(0x4f5)]);}});const _0x36e3dd=_0x4650dc[_0x1e1450(0x132a)]-_0x4650dc['newSize'],_0x2ff53e=_0x4650dc[_0x1e1450(0x132a)]>0x0?(_0x36e3dd/_0x4650dc[_0x1e1450(0x132a)]*0x64)[_0x1e1450(0x1322)](0x2):0x0;await _0x403a62(_0x1e1450(0x395),_0x1e1450(0x10bb)+_0x4650dc[_0x1e1450(0x112e)]+_0x1e1450(0x244)+_0x4650dc['compressed']+'\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20跳过(已压缩或无需压缩)\x20'+_0x4650dc[_0x1e1450(0xfd8)]+'\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20空间节省了\x20<strong>'+(_0x36e3dd/0x400/0x400)[_0x1e1450(0x1322)](0x2)+_0x1e1450(0xbe9)+_0x2ff53e+_0x1e1450(0x11ff));}catch(_0x4005fa){console[_0x1e1450(0x3b7)]('图片压缩过程中发生错误:',_0x4005fa),await _0x403a62(_0x1e1450(0xc53),_0x1e1450(0x1564)+_0x4005fa['message']);}}function _0x542fb4(_0x447422,_0x4cf913=''){const _0x23c6d5=_0x48bc6d;let _0x31796f=0x0;for(const _0x2a0788 in _0x447422){if(_0x447422[_0x23c6d5(0x5fb)](_0x2a0788)){const _0x14c659=_0x447422[_0x2a0788];if(typeof _0x14c659===_0x23c6d5(0x86c)&&_0x14c659['startsWith']('data:image')){const _0x53a4e4=_0x4cf913==='globalSettings'&&(_0x2a0788===_0x23c6d5(0xa32)||_0x2a0788===_0x23c6d5(0x831)||_0x2a0788===_0x23c6d5(0x10c6))||_0x4cf913===_0x23c6d5(0xdc1)||_0x4cf913===_0x23c6d5(0x450)&&_0x2a0788===_0x23c6d5(0x5f1)||(_0x4cf913==='appIcons'||_0x4cf913==='cphoneAppIcons');!_0x53a4e4&&(_0x31796f+=_0x14c659[_0x23c6d5(0x106b)]);}else typeof _0x14c659===_0x23c6d5(0x12fe)&&_0x14c659!==null&&(_0x31796f+=_0x542fb4(_0x14c659,_0x2a0788));}}return _0x31796f;}async function _0x4c738e(){const _0xd7197=_0x48bc6d,_0x74e517=document[_0xd7197(0x9a3)](_0xd7197(0x633));if(!_0x74e517)return;_0x74e517[_0xd7197(0xeb2)]=_0xd7197(0x836);try{let _0x5c0c66=0x0;const _0x1c091b=[_0xd7197(0xb04),'globalSettings',_0xd7197(0x9ce),'userStickers',_0xd7197(0x1529)];for(const _0x48d139 of _0x1c091b){const _0x52da08=_0x512070[_0xd7197(0x459)](_0x48d139);await _0x52da08[_0xd7197(0xf89)](_0x2a54b3=>{_0x5c0c66+=_0x542fb4(_0x2a54b3);});}const _0x12874b=(_0x5c0c66/0x400/0x400)[_0xd7197(0x1322)](0x2);_0x74e517[_0xd7197(0xeb2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>本地图片(头像/表情/头像框/等)大小:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22><strong>'+_0x12874b+_0xd7197(0x6c4);}catch(_0x27db91){console[_0xd7197(0x3b7)]('计算图片总大小时出错:',_0x27db91),_0x74e517[_0xd7197(0xeb2)]=_0xd7197(0x7c9);}}async function _0x209260(_0x346b16,_0x329737,_0x3eeb00=''){const _0x18c561=_0x48bc6d;for(const _0x3a3b7d in _0x346b16){if(_0x346b16['hasOwnProperty'](_0x3a3b7d)){const _0x190cac=_0x346b16[_0x3a3b7d];if(typeof _0x190cac===_0x18c561(0x86c)&&_0x190cac[_0x18c561(0x608)](_0x18c561(0x12b9))){const _0x4dbf86=_0x3eeb00==='globalSettings'&&(_0x3a3b7d===_0x18c561(0xa32)||_0x3a3b7d===_0x18c561(0x831)||_0x3a3b7d===_0x18c561(0x10c6))||_0x3eeb00===_0x18c561(0xdc1)||_0x3eeb00===_0x18c561(0x450)&&_0x3a3b7d===_0x18c561(0x5f1)||(_0x3eeb00===_0x18c561(0xbb4)||_0x3eeb00===_0x18c561(0xa4e));if(_0x4dbf86)continue;_0x329737[_0x18c561(0x112e)]++,_0x329737[_0x18c561(0x132a)]+=_0x190cac[_0x18c561(0x106b)];const _0x3496db=await _0x125796(_0x190cac);_0x3496db&&_0x3496db!==_0x190cac?(_0x346b16[_0x3a3b7d]=_0x3496db,_0x329737[_0x18c561(0x13a7)]++,_0x329737['newSize']+=_0x3496db[_0x18c561(0x106b)]):(_0x329737[_0x18c561(0xfd8)]++,_0x329737[_0x18c561(0x6c9)]+=_0x190cac[_0x18c561(0x106b)]);}else typeof _0x190cac===_0x18c561(0x12fe)&&_0x190cac!==null&&await _0x209260(_0x190cac,_0x329737,_0x3a3b7d);}}}async function _0x125796(_0x5b7662){const _0x385617=_0x48bc6d;if(!_0x5b7662[_0x385617(0x608)](_0x385617(0x12b9)))return _0x5b7662;try{const _0x211270=await(await fetch(_0x5b7662))[_0x385617(0xf11)](),_0x243f3d={'maxSizeMB':0.5,'maxWidthOrHeight':0x320,'useWebWorker':!![],'initialQuality':0.5,'fileType':'image/jpeg'};console[_0x385617(0xe4d)]('开始压缩图片，原始大小:\x20'+(_0x211270[_0x385617(0xbdf)]/0x400/0x400)['toFixed'](0x2)+_0x385617(0xa30));const _0x481674=await imageCompression(_0x211270,_0x243f3d);return console[_0x385617(0xe4d)]('压缩完成，新的大小:\x20'+(_0x481674[_0x385617(0xbdf)]/0x400/0x400)['toFixed'](0x2)+_0x385617(0xa30)),new Promise((_0x5ee458,_0x21c3a8)=>{const _0x489a29=_0x385617,_0x529838=new FileReader();_0x529838[_0x489a29(0x15b8)]=()=>_0x5ee458(_0x529838[_0x489a29(0x5c9)]),_0x529838[_0x489a29(0xb8b)]=_0x21c3a8,_0x529838[_0x489a29(0xdd8)](_0x481674);});}catch(_0x292e75){return console[_0x385617(0x3b7)](_0x385617(0x153a),_0x292e75),_0x5b7662;}}function _0xae6aee(_0x3a385f,_0x36d2c8){const _0x467287=_0x48bc6d;if(!_0x3a385f||!_0x36d2c8||typeof _0x3a385f!==_0x467287(0x86c)||typeof _0x36d2c8!=='string')return 0x0;const _0x5e7f50=_0x3a385f[_0x467287(0x1536)]('.')[_0x467287(0xb0a)](Number),_0x2f7d24=_0x36d2c8[_0x467287(0x1536)]('.')['map'](Number),_0x140fad=Math['max'](_0x5e7f50['length'],_0x2f7d24[_0x467287(0x106b)]);for(let _0x3e3f05=0x0;_0x3e3f05<_0x140fad;_0x3e3f05++){const _0x22dd75=_0x5e7f50[_0x3e3f05]||0x0,_0x4e54cd=_0x2f7d24[_0x3e3f05]||0x0;if(_0x22dd75>_0x4e54cd)return 0x1;if(_0x22dd75<_0x4e54cd)return-0x1;}return 0x0;}async function _0x4a1fd0(){const _0x5e8760=_0x48bc6d,_0x546aac=_0x5e8760(0x730);try{const _0x2a5436=await fetch(_0x5e8760(0x1028)+Date[_0x5e8760(0x64b)]());if(!_0x2a5436['ok']){console[_0x5e8760(0x651)](_0x5e8760(0x5d1));return;}const _0x3c810b=await _0x2a5436[_0x5e8760(0x13ca)](),_0x154695=document['createElement']('div');_0x154695[_0x5e8760(0xeb2)]=_0x3c810b;const _0x1d1c10=_0x154695[_0x5e8760(0xc86)](_0x5e8760(0xda7));if(!_0x1d1c10){console[_0x5e8760(0x3b7)](_0x5e8760(0x10fc));return;}const _0x3e7910=_0x1d1c10[_0x5e8760(0xd8d)][_0x5e8760(0x12ac)],_0x8b0757=localStorage['getItem'](_0x5e8760(0x16c));!_0x8b0757||_0xae6aee(_0x3e7910,_0x8b0757)>0x0?(console[_0x5e8760(0xe4d)](_0x5e8760(0x14d4)+_0x3e7910+_0x5e8760(0x94f)+(_0x8b0757||'无')+')'),_0x3442d9(_0x3e7910,_0x1d1c10[_0x5e8760(0xeb2)])):console[_0x5e8760(0xe4d)](_0x5e8760(0xcc6)+_0x3e7910+_0x5e8760(0xc13));}catch(_0xc2e13e){console[_0x5e8760(0x3b7)](_0x5e8760(0x741),_0xc2e13e);}}function _0x3442d9(_0x196b9d,_0x35e595){const _0xd96065=_0x48bc6d,_0x4a444c=document[_0xd96065(0x9a3)](_0xd96065(0xf54)),_0xd37e41=document[_0xd96065(0x9a3)](_0xd96065(0x3f3)),_0xdaf220=document['getElementById'](_0xd96065(0xc0c)),_0x4e00eb=document[_0xd96065(0x9a3)](_0xd96065(0x2d7));_0xd37e41['innerHTML']=_0x35e595,_0xdaf220[_0xd96065(0x15d3)]=!![],_0x4e00eb['disabled']=!![];const _0x27b7df=_0xdaf220[_0xd96065(0x766)];let _0x218b6c=0xa;_0xdaf220[_0xd96065(0x766)]=_0x27b7df+'\x20('+_0x218b6c+'s)';const _0x505fcf=setInterval(()=>{const _0x1e8e01=_0xd96065;_0x218b6c--,_0x218b6c>0x0?_0xdaf220[_0x1e8e01(0x766)]=_0x27b7df+'\x20('+_0x218b6c+'s)':(clearInterval(_0x505fcf),_0xdaf220[_0x1e8e01(0x15d3)]=![],_0x4e00eb[_0x1e8e01(0x15d3)]=![],_0xdaf220['textContent']=_0x27b7df);},0x3e8);_0xdaf220[_0xd96065(0x4ce)]=()=>{const _0x2ffd71=_0xd96065;clearInterval(_0x505fcf),_0x4a444c[_0x2ffd71(0x4d8)]['remove'](_0x2ffd71(0xc09)),_0xdaf220[_0x2ffd71(0x766)]=_0x27b7df;},_0x4e00eb[_0xd96065(0x4ce)]=()=>{const _0x5bdda8=_0xd96065;clearInterval(_0x505fcf),localStorage[_0x5bdda8(0x28a)](_0x5bdda8(0x16c),_0x196b9d),_0x4a444c['classList']['remove'](_0x5bdda8(0xc09)),console['log']('用户已忽略版本:\x20'+_0x196b9d),_0xdaf220[_0x5bdda8(0x766)]=_0x27b7df;},_0x4a444c[_0xd96065(0x4d8)][_0xd96065(0xe05)]('visible');}function _0x5f4b28(){const _0xaf60c5=_0x48bc6d,_0x268f4c=document[_0xaf60c5(0x9a3)](_0xaf60c5(0x1117));document[_0xaf60c5(0x9a3)]('douban-min-posts-input')[_0xaf60c5(0x7b2)]=_0x19ddb8[_0xaf60c5(0x4c8)][_0xaf60c5(0x2ef)]||0xc,document[_0xaf60c5(0x9a3)](_0xaf60c5(0x141b))['value']=_0x19ddb8[_0xaf60c5(0x4c8)][_0xaf60c5(0x753)]||0x14,_0x268f4c['classList'][_0xaf60c5(0xe05)]('visible');}async function _0x2236fb(){const _0x1bd60a=_0x48bc6d,_0x1fb175=document[_0x1bd60a(0x9a3)](_0x1bd60a(0x67b)),_0x5e30fb=document[_0x1bd60a(0x9a3)](_0x1bd60a(0x141b)),_0xc1b2b4=parseInt(_0x1fb175[_0x1bd60a(0x7b2)]),_0x4de63c=parseInt(_0x5e30fb[_0x1bd60a(0x7b2)]);if(isNaN(_0xc1b2b4)||isNaN(_0x4de63c)||_0xc1b2b4<0x1||_0x4de63c<0x1){alert(_0x1bd60a(0x11bc));return;}if(_0xc1b2b4>_0x4de63c){alert(_0x1bd60a(0x4bd));return;}_0x19ddb8[_0x1bd60a(0x4c8)][_0x1bd60a(0x2ef)]=_0xc1b2b4,_0x19ddb8['globalSettings']['doubanMaxPosts']=_0x4de63c,await _0x512070[_0x1bd60a(0x4c8)]['put'](_0x19ddb8['globalSettings']),document[_0x1bd60a(0x9a3)]('douban-settings-modal')[_0x1bd60a(0x4d8)]['remove'](_0x1bd60a(0xc09)),await _0x403a62(_0x1bd60a(0x398),_0x1bd60a(0x1357));}async function _0x31a220(_0xd45295){const _0xe6b6b1=_0x48bc6d,_0x53daad=document[_0xe6b6b1(0x9a3)](_0xe6b6b1(0xe50)),_0x9ce44c=document[_0xe6b6b1(0x9a3)]('werewolf-player-selection-list');_0x9ce44c[_0xe6b6b1(0xeb2)]='';let _0x46b61e=[];if(_0xd45295===_0xe6b6b1(0xc41)){const _0x4040ea=Object['values'](_0x19ddb8[_0xe6b6b1(0xb04)])[_0xe6b6b1(0x1195)](_0x432ece=>!_0x432ece['isGroup']),_0x2df38e=await _0x512070[_0xe6b6b1(0x5b7)][_0xe6b6b1(0x591)]();_0x46b61e=[{'id':_0xe6b6b1(0x20d),'name':_0x19ddb8['qzoneSettings']['nickname']||'我','originalName':_0x19ddb8[_0xe6b6b1(0x9ce)][_0xe6b6b1(0x246)]||'我','avatar':_0x19ddb8[_0xe6b6b1(0x9ce)][_0xe6b6b1(0xf3f)],'type':_0xe6b6b1(0x20d)},..._0x4040ea[_0xe6b6b1(0xb0a)](_0xb24bf=>({'id':_0xb24bf['id'],'name':_0xb24bf['name'],'originalName':_0xb24bf[_0xe6b6b1(0x339)],'avatar':_0xb24bf[_0xe6b6b1(0x450)][_0xe6b6b1(0x4fe)],'type':_0xe6b6b1(0xb44)})),..._0x2df38e[_0xe6b6b1(0xb0a)](_0x2faeed=>({'id':_0xe6b6b1(0x136f)+_0x2faeed['id'],'name':_0x2faeed[_0xe6b6b1(0x1561)],'originalName':_0x2faeed[_0xe6b6b1(0x1561)],'avatar':_0x2faeed[_0xe6b6b1(0xf3f)],'type':_0xe6b6b1(0x9fe)}))],_0x480617[_0xe6b6b1(0x907)]=null;}else{const _0x18652a=_0x19ddb8[_0xe6b6b1(0xb04)][_0x19ddb8[_0xe6b6b1(0x859)]];if(!_0x18652a||!_0x18652a['isGroup'])return;_0x46b61e=[{'id':_0xe6b6b1(0x20d),'name':_0x18652a[_0xe6b6b1(0x450)]['myNickname']||'我','originalName':_0x19ddb8[_0xe6b6b1(0x9ce)]['nickname']||'我','avatar':_0x18652a[_0xe6b6b1(0x450)][_0xe6b6b1(0x1af)],'type':_0xe6b6b1(0x20d)},..._0x18652a[_0xe6b6b1(0xcca)][_0xe6b6b1(0xb0a)](_0x339bf7=>{const _0x51137e=_0xe6b6b1,_0x3d17bb=_0x19ddb8[_0x51137e(0xb04)][_0x339bf7['id']],_0x4da235=_0x339bf7['avatar']||(_0x3d17bb?_0x3d17bb[_0x51137e(0x450)][_0x51137e(0x4fe)]:_0x451ae9);return{'id':_0x339bf7['id'],'name':_0x339bf7['groupNickname'],'originalName':_0x339bf7['originalName'],'avatar':_0x4da235,'type':_0x339bf7['isNpc']?_0x51137e(0x9fe):_0x51137e(0xb44)};})],_0x480617[_0xe6b6b1(0x907)]=_0x19ddb8['activeChatId'];}_0x46b61e[_0xe6b6b1(0x15c1)](_0x5caf28=>{const _0x4e8520=_0xe6b6b1,_0x16d812=document[_0x4e8520(0xe94)](_0x4e8520(0x8ca));_0x16d812[_0x4e8520(0x1487)]=_0x4e8520(0x5a1),_0x16d812[_0x4e8520(0xeb2)]=_0x4e8520(0x91d)+JSON[_0x4e8520(0xe1e)](_0x5caf28)+'\x27\x20'+(_0x5caf28['type']==='user'?_0x4e8520(0x19d):_0x4e8520(0x944))+_0x4e8520(0x89b)+_0x5caf28[_0x4e8520(0xf3f)]+_0x4e8520(0x498)+_0x5caf28[_0x4e8520(0x1561)]+_0x4e8520(0x110c),_0x9ce44c[_0x4e8520(0x983)](_0x16d812);}),_0x53daad[_0xe6b6b1(0x4d8)][_0xe6b6b1(0xe05)]('visible');}async function _0x289461(){const _0x2809e5=_0x48bc6d,_0x412472=document[_0x2809e5(0x131c)](_0x2809e5(0x9f6)),_0x557352=_0x412472[_0x2809e5(0x106b)];let _0x1c430e=[];if(_0x557352===0x6)_0x480617['gameMode']='6p',_0x1c430e=['狼人','狼人','平民','平民',_0x2809e5(0x13d1),'猎人'];else{if(_0x557352===0x9)_0x480617[_0x2809e5(0x144f)]='9p',_0x1c430e=['狼人','狼人','狼人','平民','平民','平民',_0x2809e5(0x13d1),'女巫','猎人'];else{if(_0x557352===0xc)_0x480617[_0x2809e5(0x144f)]=_0x2809e5(0x595),_0x1c430e=['狼人','狼人','狼人','狼人','平民','平民','平民','平民',_0x2809e5(0x13d1),'女巫','猎人','守卫'];else{alert(_0x2809e5(0x1244)+_0x557352+_0x2809e5(0x9b8));return;}}}document[_0x2809e5(0x9a3)](_0x2809e5(0xe50))[_0x2809e5(0x4d8)][_0x2809e5(0x133d)](_0x2809e5(0xc09)),await _0x403a62(_0x2809e5(0x33e),_0x2809e5(0xf6e));for(let _0x48bb18=_0x1c430e[_0x2809e5(0x106b)]-0x1;_0x48bb18>0x0;_0x48bb18--){const _0x520f7d=Math[_0x2809e5(0xd95)](Math['random']()*(_0x48bb18+0x1));[_0x1c430e[_0x48bb18],_0x1c430e[_0x520f7d]]=[_0x1c430e[_0x520f7d],_0x1c430e[_0x48bb18]];}const _0x37c204=Array[_0x2809e5(0x1311)](_0x412472)[_0x2809e5(0xb0a)](_0x428440=>JSON[_0x2809e5(0x1447)](_0x428440[_0x2809e5(0xd8d)][_0x2809e5(0xc0a)]));_0x480617[_0x2809e5(0xa6d)]=[];for(let _0x38ea99=0x0;_0x38ea99<_0x37c204[_0x2809e5(0x106b)];_0x38ea99++){const _0x2d094f=_0x37c204[_0x38ea99],_0x419ca7=_0x1c430e[_0x38ea99];let _0x5a72c2=_0x2809e5(0xbdc);if(_0x2d094f['type']===_0x2809e5(0xb44)){const _0xb525d2=_0x19ddb8['chats'][_0x2d094f['id']];_0x5a72c2=_0xb525d2?_0xb525d2['settings'][_0x2809e5(0x1c3)]:_0x2809e5(0x89a);}else{if(_0x2d094f['type']==='npc'){const _0x346f14=await _0x512070[_0x2809e5(0x5b7)][_0x2809e5(0x591)](),_0x3f9426=_0x346f14['find'](_0x3e9f37=>_0x2809e5(0x136f)+_0x3e9f37['id']===_0x2d094f['id']);_0x5a72c2=_0x3f9426?_0x3f9426[_0x2809e5(0xcd4)]:_0x2809e5(0x1070);}else{if(_0x2d094f[_0x2809e5(0x1508)]===_0x2809e5(0x20d)){const _0x21d3c0=_0x480617[_0x2809e5(0x907)]?_0x19ddb8[_0x2809e5(0xb04)][_0x480617['chatId']]:null;_0x5a72c2=_0x21d3c0?_0x21d3c0[_0x2809e5(0x450)][_0x2809e5(0x1e3)]:_0x2809e5(0x5b1);}}}const _0x1c59c3={..._0x2d094f,'role':_0x419ca7,'isAlive':!![],'character_persona':_0x5a72c2};_0x419ca7==='女巫'&&(_0x1c59c3[_0x2809e5(0x15b6)]=![],_0x1c59c3[_0x2809e5(0xcf0)]=![]),_0x419ca7==='守卫'&&(_0x1c59c3[_0x2809e5(0x10bf)]=null),_0x480617[_0x2809e5(0xa6d)][_0x2809e5(0x1c4)](_0x1c59c3);}_0x480617[_0x2809e5(0x1412)]=!![],_0x480617[_0x2809e5(0xc9e)]=0x1,_0x480617[_0x2809e5(0xdf2)]='start',_0x480617[_0x2809e5(0x4f7)]=[],_0x480617[_0x2809e5(0x870)]=[];const _0x4f4aef=_0x1c430e[_0x2809e5(0x68f)]((_0x34ca50,_0x1027e5)=>{return _0x34ca50[_0x1027e5]=(_0x34ca50[_0x1027e5]||0x0)+0x1,_0x34ca50;},{}),_0x4a31ad=Object[_0x2809e5(0x10c3)](_0x4f4aef)[_0x2809e5(0xb0a)](([_0x5e17fa,_0x18ec7b])=>_0x5e17fa+'\x20x'+_0x18ec7b)[_0x2809e5(0x3b9)]('、');_0x3740db(_0x2809e5(0x6bc)+_0x557352+_0x2809e5(0x39c)+_0x4a31ad+'。');const _0x121d1e=_0x480617[_0x2809e5(0xa6d)]['find'](_0x59ad2e=>_0x59ad2e['id']===_0x2809e5(0x20d));_0x300c83(),_0x35df44(_0x2809e5(0x814)),_0x983c37(_0x121d1e['role']);}function _0x300c83(){const _0x1de603=_0x48bc6d,_0x5e6bba=document[_0x1de603(0x9a3)](_0x1de603(0x2da));_0x5e6bba[_0x1de603(0xeb2)]='';const _0x205f6c=[..._0x480617[_0x1de603(0xa6d)]][_0x1de603(0x6a2)]((_0x4ef873,_0xa8230f)=>_0x4ef873[_0x1de603(0x139d)]-_0xa8230f[_0x1de603(0x139d)]);_0x205f6c[_0x1de603(0x15c1)]((_0x48f744,_0x49dc83)=>{const _0x594ab6=_0x1de603,_0x4b2ef6=_0x480617[_0x594ab6(0xa6d)][_0x594ab6(0x455)](_0x2232d4=>_0x2232d4['id']===_0x48f744['id'])+0x1,_0x32a098=document[_0x594ab6(0xe94)](_0x594ab6(0x8ca));_0x32a098['className']=_0x594ab6(0x129f);if(!_0x48f744[_0x594ab6(0x139d)])_0x32a098[_0x594ab6(0x4d8)][_0x594ab6(0xe05)](_0x594ab6(0xeed));_0x32a098['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x48f744[_0x594ab6(0xf3f)]+_0x594ab6(0xefd)+_0x4b2ef6+'.\x20'+_0x48f744[_0x594ab6(0x1561)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x5e6bba[_0x594ab6(0x983)](_0x32a098);});const _0x176d37=document[_0x1de603(0x9a3)](_0x1de603(0x222));_0x176d37[_0x1de603(0xeb2)]='';for(let _0xfe4bf4=0x1;_0xfe4bf4<=_0x480617[_0x1de603(0xc9e)];_0xfe4bf4++){const _0x11c8bf=[..._0x480617[_0x1de603(0x4f7)][_0x1de603(0x1195)](_0x1d50fc=>_0x1d50fc[_0x1de603(0xa94)]===_0xfe4bf4),..._0x480617[_0x1de603(0x870)][_0x1de603(0x1195)](_0x29ee90=>_0x29ee90[_0x1de603(0xa94)]===_0xfe4bf4)]['sort']((_0x22c599,_0x4d359a)=>(_0x22c599[_0x1de603(0xd73)]||0x0)-(_0x4d359a['timestamp']||0x0));if(_0x11c8bf['length']>0x0){const _0x1c998c=document[_0x1de603(0xe94)]('div');_0x1c998c[_0x1de603(0x1487)]=_0x1de603(0x768),_0x1c998c[_0x1de603(0x766)]=_0x1de603(0x104f)+_0xfe4bf4+_0x1de603(0x144e),_0x1c998c[_0x1de603(0x20f)][_0x1de603(0x6c0)]=_0x1de603(0x182),_0x176d37[_0x1de603(0x983)](_0x1c998c),_0x11c8bf[_0x1de603(0x15c1)](_0x2e0b2d=>{const _0x1011f3=_0x1de603,_0x42dbe9=document[_0x1011f3(0xe94)](_0x1011f3(0x8ca));_0x42dbe9[_0x1011f3(0x1487)]=_0x1011f3(0x13b3)+_0x2e0b2d[_0x1011f3(0x1508)],_0x2e0b2d[_0x1011f3(0x1508)]===_0x1011f3(0x103d)?_0x42dbe9[_0x1011f3(0xeb2)]=_0x1011f3(0x125d)+_0x2e0b2d['speaker']+_0x1011f3(0x178)+_0x2e0b2d['content']:_0x42dbe9[_0x1011f3(0x766)]=_0x2e0b2d[_0x1011f3(0x4e3)],_0x176d37['appendChild'](_0x42dbe9);});}}_0x176d37[_0x1de603(0x85c)]=_0x176d37[_0x1de603(0x13b7)];const _0x5e507c={'start':_0x1de603(0x443),'night':'第'+_0x480617[_0x1de603(0xc9e)]+'天\x20-\x20夜晚','day':'第'+_0x480617[_0x1de603(0xc9e)]+'天\x20-\x20白天','discussion':'第'+_0x480617['currentDay']+_0x1de603(0x49a),'voting':'第'+_0x480617[_0x1de603(0xc9e)]+_0x1de603(0x1353),'gameover':_0x1de603(0x135a)};document[_0x1de603(0x9a3)](_0x1de603(0x105d))[_0x1de603(0x766)]=_0x1de603(0x1130)+(_0x5e507c[_0x480617[_0x1de603(0xdf2)]]||_0x480617['currentPhase']);}function _0x983c37(_0x3fbddd){const _0x511bfe=_0x48bc6d,_0x391f64={'狼人':_0x511bfe(0x11ac),'平民':_0x511bfe(0xd7a),'预言家':'每晚可以查验一个玩家的身份是好人还是狼人。','猎人':'当你死亡时，你可以选择带走场上任意一名玩家。','女巫':_0x511bfe(0xd5d),'守卫':_0x511bfe(0x3e1)};document[_0x511bfe(0x9a3)]('werewolf-role-name')[_0x511bfe(0x766)]=_0x3fbddd,document[_0x511bfe(0x9a3)](_0x511bfe(0x128d))['textContent']=_0x391f64[_0x3fbddd]||_0x511bfe(0x11d4),document[_0x511bfe(0x9a3)](_0x511bfe(0x1477))[_0x511bfe(0x4d8)][_0x511bfe(0xe05)]('visible');}async function _0x5e8d06(){const _0x5c918d=_0x48bc6d;_0x480617[_0x5c918d(0xdf2)]='第'+_0x480617[_0x5c918d(0xc9e)]+_0x5c918d(0xae5),_0x480617['nightActions']={},_0x3740db(_0x5c918d(0xe72)),_0x300c83(),document[_0x5c918d(0x9a3)]('werewolf-action-bar')['style'][_0x5c918d(0x115d)]='none',document[_0x5c918d(0x9a3)](_0x5c918d(0x27f))[_0x5c918d(0x20f)]['display']=_0x5c918d(0x8e0),await new Promise(_0x375a38=>setTimeout(_0x375a38,0x5dc));const _0x2b25c5=_0x480617[_0x5c918d(0xa6d)]['find'](_0x243fe3=>_0x243fe3[_0x5c918d(0x11c1)]==='守卫'&&_0x243fe3[_0x5c918d(0x139d)]);if(_0x2b25c5){_0x3740db(_0x5c918d(0x3f8)),_0x300c83();let _0x37e82b=null;if(_0x2b25c5['id']===_0x5c918d(0x20d))_0x37e82b=await _0x9492ab(_0x5c918d(0xd72),_0x2b25c5[_0x5c918d(0x10bf)]);else{const _0x234949=_0x480617[_0x5c918d(0xa6d)][_0x5c918d(0x1195)](_0x1c2a74=>_0x1c2a74[_0x5c918d(0x139d)]&&_0x1c2a74['id']!==_0x2b25c5['lastGuardedId']);_0x234949['length']>0x0&&(_0x37e82b=_0x234949[Math['floor'](Math['random']()*_0x234949[_0x5c918d(0x106b)])]['id']);}_0x37e82b&&(_0x480617[_0x5c918d(0x2fa)]['guardedId']=_0x37e82b,_0x2b25c5['lastGuardedId']=_0x37e82b),_0x3740db(_0x5c918d(0x622)),_0x300c83(),await new Promise(_0x331a4b=>setTimeout(_0x331a4b,0x5dc));}_0x3740db(_0x5c918d(0x15ce)),_0x300c83();const _0x178cba=_0x480617['players'][_0x5c918d(0x1195)](_0x5921f0=>_0x5921f0[_0x5c918d(0x11c1)]==='狼人'&&_0x5921f0['isAlive']),_0x201962=_0x178cba[_0x5c918d(0x336)](_0x2980b9=>_0x2980b9['id']===_0x5c918d(0x20d));let _0xe30a8f=null;_0x480617[_0x5c918d(0xd27)]='wolfKill';try{if(_0x201962)_0x3740db(_0x5c918d(0x10ac)),_0x300c83(),_0xe30a8f=await _0xbb03d1();else{if(_0x480617['currentDay']===0x1){console[_0x5c918d(0xe4d)](_0x5c918d(0x46f));const _0x539dc1=_0x480617[_0x5c918d(0xa6d)]['filter'](_0xa3032b=>_0xa3032b[_0x5c918d(0x139d)]&&_0xa3032b[_0x5c918d(0x11c1)]!=='狼人');_0x539dc1[_0x5c918d(0x106b)]>0x0&&(_0xe30a8f=_0x539dc1[Math[_0x5c918d(0xd95)](Math[_0x5c918d(0xdcd)]()*_0x539dc1[_0x5c918d(0x106b)])]['id']);}else _0xe30a8f=await _0x44cbd7();}_0x480617[_0x5c918d(0xd27)]=null;}catch(_0x2a04fc){console[_0x5c918d(0x3b7)](_0x5c918d(0x9bb),_0x2a04fc),await _0x403a62(_0x5c918d(0x13bd),_0x5c918d(0xfac)),document[_0x5c918d(0x9a3)](_0x5c918d(0x27f))[_0x5c918d(0x20f)]['display']=_0x5c918d(0x10c8);return;}_0x480617[_0x5c918d(0x2fa)]['killedId']=_0xe30a8f,_0x3740db(_0x5c918d(0x7a8)),_0x300c83(),await new Promise(_0x41036d=>setTimeout(_0x41036d,0x5dc));const _0x3d9083=_0x480617[_0x5c918d(0xa6d)]['find'](_0x2edd4b=>_0x2edd4b[_0x5c918d(0x11c1)]==='女巫'&&_0x2edd4b[_0x5c918d(0x139d)]);if(_0x3d9083){_0x3740db(_0x5c918d(0xdb1)),_0x300c83();const _0x5330ae=_0x480617[_0x5c918d(0xa6d)][_0x5c918d(0xd62)](_0x213d67=>_0x213d67['id']===_0x480617[_0x5c918d(0x2fa)][_0x5c918d(0xe68)]),_0x420608=_0x480617[_0x5c918d(0x2fa)]['guardedId']===_0x480617[_0x5c918d(0x2fa)]['killedId'],_0x4c9118=_0x420608||!_0x5330ae?null:_0x5330ae;if(_0x3d9083['id']==='user'){let _0x2e9332=await _0x5bf76f(_0x4c9118,_0x3d9083);_0x2e9332['save']&&(_0x480617['nightActions'][_0x5c918d(0xcde)]=_0x480617[_0x5c918d(0x2fa)][_0x5c918d(0xe68)],_0x3d9083[_0x5c918d(0x15b6)]=!![]),_0x2e9332[_0x5c918d(0x37e)]&&(_0x480617['nightActions'][_0x5c918d(0x3a5)]=_0x2e9332[_0x5c918d(0x37e)],_0x3d9083[_0x5c918d(0xcf0)]=!![]);}else{if(!_0x3d9083[_0x5c918d(0x15b6)]&&_0x4c9118){let _0x166452=0x0;_0x480617[_0x5c918d(0xc9e)]===0x1?_0x166452=0.3:_0x166452=0.8,console[_0x5c918d(0xe4d)](_0x5c918d(0x47e)+_0x480617[_0x5c918d(0xc9e)]+_0x5c918d(0x14db)+_0x166452*0x64+'%'),Math[_0x5c918d(0xdcd)]()<_0x166452?(console['log'](_0x5c918d(0x85e)),_0x480617[_0x5c918d(0x2fa)][_0x5c918d(0xcde)]=_0x480617[_0x5c918d(0x2fa)][_0x5c918d(0xe68)],_0x3d9083[_0x5c918d(0x15b6)]=!![]):console[_0x5c918d(0xe4d)](_0x5c918d(0x89e));}if(!_0x480617[_0x5c918d(0x2fa)][_0x5c918d(0xcde)]&&!_0x3d9083[_0x5c918d(0xcf0)]&&Math[_0x5c918d(0xdcd)]()<0.5){const _0x1dd0e4=_0x480617[_0x5c918d(0xa6d)][_0x5c918d(0x1195)](_0x1c0cb7=>_0x1c0cb7['isAlive']&&_0x1c0cb7['id']!==_0x480617[_0x5c918d(0x2fa)][_0x5c918d(0xe68)]);if(_0x1dd0e4[_0x5c918d(0x106b)]>0x0){const _0x49a6e6=_0x1dd0e4[Math[_0x5c918d(0xd95)](Math[_0x5c918d(0xdcd)]()*_0x1dd0e4['length'])];_0x480617[_0x5c918d(0x2fa)][_0x5c918d(0x3a5)]=_0x49a6e6['id'],_0x3d9083[_0x5c918d(0xcf0)]=!![],console[_0x5c918d(0xe4d)](_0x5c918d(0xbeb)+_0x49a6e6[_0x5c918d(0x1561)]);}}}_0x3740db(_0x5c918d(0x136a)),_0x300c83(),await new Promise(_0xebf64a=>setTimeout(_0xebf64a,0x5dc));}const _0x17e1c2=_0x480617['players']['find'](_0x4af765=>_0x4af765[_0x5c918d(0x11c1)]==='预言家'&&_0x4af765[_0x5c918d(0x139d)]);if(_0x17e1c2){_0x3740db(_0x5c918d(0x1599)),_0x300c83();if(_0x17e1c2['id']===_0x5c918d(0x20d)){const _0x554f15=await _0x9492ab(_0x5c918d(0x1532)),_0xcbd968=_0x480617[_0x5c918d(0xa6d)][_0x5c918d(0xd62)](_0x354793=>_0x354793['id']===_0x554f15);if(_0xcbd968){const _0x1217c2=_0xcbd968[_0x5c918d(0x11c1)]==='狼人';await _0x403a62(_0x5c918d(0x2e3),_0x5c918d(0xaeb)+_0xcbd968['name']+'\x20的身份是：'+(_0x1217c2?'狼人':'好人')),_0x480617[_0x5c918d(0x2fa)]['prophetCheck']={'target':_0x554f15,'result':_0x1217c2?'狼人':'好人'};}}else{const _0x2a750c=_0x480617[_0x5c918d(0xa6d)]['filter'](_0x13cd09=>_0x13cd09[_0x5c918d(0x139d)]&&_0x13cd09['id']!==_0x17e1c2['id']);if(_0x2a750c[_0x5c918d(0x106b)]>0x0){const _0x15d574=_0x2a750c[Math[_0x5c918d(0xd95)](Math[_0x5c918d(0xdcd)]()*_0x2a750c[_0x5c918d(0x106b)])];_0x480617[_0x5c918d(0x2fa)][_0x5c918d(0x3e0)]={'target':_0x15d574['id'],'result':_0x15d574['role']==='狼人'?'狼人':'好人'};}}_0x3740db(_0x5c918d(0x1e2)),_0x300c83(),await new Promise(_0xcb7e20=>setTimeout(_0xcb7e20,0x5dc));}_0x9ef536();}async function _0x9ef536(){const _0x2528bc=_0x48bc6d;_0x480617['currentPhase']='第'+_0x480617['currentDay']+_0x2528bc(0x9b9),_0x480617[_0x2528bc(0xc1f)]={},_0x3740db(_0x2528bc(0x984));const {killedId:_0x138231,guardedId:_0x105c58,savedId:_0x4ce1c0,poisonedId:_0x22dc18}=_0x480617[_0x2528bc(0x2fa)],_0x13929f=new Set();_0x138231&&_0x138231!==_0x105c58&&_0x138231!==_0x4ce1c0&&_0x13929f['add'](_0x138231);_0x22dc18&&_0x13929f[_0x2528bc(0xe05)](_0x22dc18);if(_0x13929f[_0x2528bc(0xbdf)]===0x0)_0x3740db('昨晚是平安夜。');else for(const _0x160930 of _0x13929f){const _0x446252=_0x480617[_0x2528bc(0xa6d)][_0x2528bc(0xd62)](_0x129a84=>_0x129a84['id']===_0x160930);if(_0x446252&&_0x446252[_0x2528bc(0x139d)]){_0x446252[_0x2528bc(0x139d)]=![],_0x3740db(_0x2528bc(0x3c4)+_0x446252['name']+_0x2528bc(0x1451));if(_0x446252[_0x2528bc(0x11c1)]==='猎人'){_0x3740db(_0x2528bc(0x2ac)),_0x300c83();let _0x14811d=null;if(_0x446252['id']===_0x2528bc(0x20d))_0x14811d=await _0x9492ab('hunter');else{const _0x474f2a=_0x480617[_0x2528bc(0xa6d)][_0x2528bc(0x1195)](_0x1d75f0=>_0x1d75f0[_0x2528bc(0x139d)]&&_0x1d75f0['id']!==_0x446252['id']);_0x474f2a['length']>0x0&&(_0x14811d=_0x474f2a[Math[_0x2528bc(0xd95)](Math[_0x2528bc(0xdcd)]()*_0x474f2a[_0x2528bc(0x106b)])]['id']);}const _0x345a21=_0x480617['players']['find'](_0x3e2dbc=>_0x3e2dbc['id']===_0x14811d);_0x345a21&&(_0x345a21[_0x2528bc(0x139d)]=![],_0x3740db('猎人带走了\x20'+_0x345a21[_0x2528bc(0x1561)]+'。'));}}}_0x300c83();if(_0x55c919())return;await _0x5ddba7();}async function _0x5ddba7(){const _0x90fa82=_0x48bc6d;_0x3740db(_0x90fa82(0x702)),_0x300c83();const {proxyUrl:_0x5d30fd,apiKey:_0x4c0680,model:_0x8697b2}=_0x19ddb8[_0x90fa82(0xd22)];if(!_0x5d30fd||!_0x4c0680||!_0x8697b2){alert(_0x90fa82(0x1193));return;}const _0x41bfbe=_0x3160e8();_0x480617[_0x90fa82(0xd27)]='startDiscussion';try{await _0x403a62(_0x90fa82(0xacf),_0x90fa82(0x606));let _0x5ab06a=_0x5d30fd[_0x90fa82(0x478)]('generativelanguage'),_0x2920e2=[{'role':_0x90fa82(0x20d),'content':_0x90fa82(0x80d)}],_0x3e64f6=_0x366263(_0x8697b2,_0x4c0680,_0x41bfbe,_0x2920e2);const _0x2106a6=_0x5ab06a?await fetch(_0x3e64f6[_0x90fa82(0x121f)],_0x3e64f6['data']):await fetch(_0x5d30fd+_0x90fa82(0x501),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x90fa82(0x1265)+_0x4c0680},'body':JSON[_0x90fa82(0xe1e)]({'model':_0x8697b2,'messages':[{'role':_0x90fa82(0xe10),'content':_0x41bfbe},..._0x2920e2],'temperature':_0x19ddb8[_0x90fa82(0x4c8)][_0x90fa82(0x4a2)]||0.95})});if(!_0x2106a6['ok']){const _0x4b45f8=await _0x2106a6[_0x90fa82(0xa5d)]();throw new Error(_0x90fa82(0x786)+_0x4b45f8[_0x90fa82(0x3b7)][_0x90fa82(0xcce)]);}const _0x9e6a20=await _0x2106a6['json'](),_0x302de7=getGeminiResponseText(_0x9e6a20),_0x79dbb5=_0x302de7[_0x90fa82(0x293)](/(\[[\s\S]*\])/);if(!_0x79dbb5)throw new Error(_0x90fa82(0xfe8)+_0x302de7);const _0x5b46ef=JSON[_0x90fa82(0x1447)](_0x79dbb5[0x0]);for(const _0x5a789e of _0x5b46ef){_0x5a789e[_0x90fa82(0x15a6)]&&_0x5a789e[_0x90fa82(0x103d)]&&(_0x43d255(_0x5a789e[_0x90fa82(0x15a6)],_0x5a789e[_0x90fa82(0x103d)]),_0x300c83(),await new Promise(_0x5cb940=>setTimeout(_0x5cb940,0x5dc+Math[_0x90fa82(0xdcd)]()*0x7d0)));}_0x480617[_0x90fa82(0xd27)]=null;}catch(_0x4728d1){console['error'](_0x90fa82(0x965),_0x4728d1),await _0x403a62(_0x90fa82(0x9a8),_0x90fa82(0x4ff)+_0x4728d1['message']),document[_0x90fa82(0x9a3)]('werewolf-retry-btn')[_0x90fa82(0x20f)][_0x90fa82(0x115d)]=_0x90fa82(0x10c8);return;}const _0x138c65=_0x480617['players'][_0x90fa82(0xd62)](_0x5356ea=>_0x5356ea['id']===_0x90fa82(0x20d)),_0x414e0f=document[_0x90fa82(0x9a3)](_0x90fa82(0x516)),_0x2803b4=document[_0x90fa82(0x9a3)]('werewolf-wait-reply-btn'),_0x8938ec=document['getElementById'](_0x90fa82(0x300)),_0x2a647b=document[_0x90fa82(0x9a3)](_0x90fa82(0x106c));_0x414e0f[_0x90fa82(0x20f)][_0x90fa82(0x115d)]=_0x90fa82(0x79c);if(_0x138c65&&_0x138c65[_0x90fa82(0x139d)]){_0x2803b4[_0x90fa82(0x766)]=_0x90fa82(0x15d7),_0x8938ec[_0x90fa82(0x766)]=_0x90fa82(0xbaa),_0x2803b4[_0x90fa82(0x20f)]['display']='block',_0x8938ec[_0x90fa82(0x20f)][_0x90fa82(0x115d)]=_0x90fa82(0x10c8),_0x2a647b['disabled']=![],_0x2a647b[_0x90fa82(0x1591)]=_0x90fa82(0x402),_0x2a647b[_0x90fa82(0xdcf)]();const _0x5c0a05=_0x2803b4[_0x90fa82(0x173)](!![]);_0x2803b4[_0x90fa82(0x5eb)]['replaceChild'](_0x5c0a05,_0x2803b4),_0x5c0a05[_0x90fa82(0x954)](_0x90fa82(0x9cc),_0x128411);const _0xdbbfaf=_0x8938ec[_0x90fa82(0x173)](!![]);_0x8938ec[_0x90fa82(0x5eb)][_0x90fa82(0x15ab)](_0xdbbfaf,_0x8938ec),_0xdbbfaf['addEventListener'](_0x90fa82(0x9cc),_0x1beffc);}else{_0x3740db(_0x90fa82(0xcc2)),_0x300c83(),_0x2803b4[_0x90fa82(0x766)]='继续讨论',_0x8938ec['textContent']=_0x90fa82(0x69e),_0x2803b4[_0x90fa82(0x20f)][_0x90fa82(0x115d)]=_0x90fa82(0x10c8),_0x8938ec[_0x90fa82(0x20f)][_0x90fa82(0x115d)]='block',_0x2a647b['disabled']=!![],_0x2a647b[_0x90fa82(0x1591)]=_0x90fa82(0x10a2);const _0x16c5a8=_0x2803b4[_0x90fa82(0x173)](!![]);_0x2803b4[_0x90fa82(0x5eb)]['replaceChild'](_0x16c5a8,_0x2803b4),_0x16c5a8[_0x90fa82(0x954)](_0x90fa82(0x9cc),_0x49d3e3);const _0x31fef1=_0x8938ec[_0x90fa82(0x173)](!![]);_0x8938ec[_0x90fa82(0x5eb)][_0x90fa82(0x15ab)](_0x31fef1,_0x8938ec),_0x31fef1[_0x90fa82(0x954)](_0x90fa82(0x9cc),_0x49babf);}}function _0x3160e8(){const _0x2eede1=_0x48bc6d,_0x3699be=_0x480617[_0x2eede1(0xa6d)]['filter'](_0x4f1c2f=>_0x4f1c2f[_0x2eede1(0x139d)]),_0x51098b=_0x480617['players'][_0x2eede1(0xd62)](_0x1f2e55=>_0x1f2e55['id']===_0x2eede1(0x20d)),_0x102509=_0x51098b?_0x51098b['name']:'用户',_0x18f67c=_0x3699be[_0x2eede1(0x336)](_0x7b75f8=>_0x7b75f8['id']===_0x2eede1(0x20d));let _0x1e0c14=_0x2eede1(0x209);_0x1e0c14+=_0x2eede1(0x2f7),_0x3699be[_0x2eede1(0x15c1)]((_0x1d3d57,_0x54a3f4)=>{const _0x2e573c=_0x2eede1,_0x25e05a=_0x480617[_0x2e573c(0xa6d)][_0x2e573c(0x455)](_0x9f30e=>_0x9f30e['id']===_0x1d3d57['id'])+0x1;let _0x3a75f4='';const _0x44c740=_0x19ddb8['chats'][_0x1d3d57['id']];if(_0x44c740){const _0x24f4da=_0x3699be[_0x2e573c(0x1195)](_0x42f939=>_0x42f939['id']!==_0x1d3d57['id']&&_0x19ddb8[_0x2e573c(0xb04)][_0x42f939['id']]&&_0x19ddb8['chats'][_0x42f939['id']][_0x2e573c(0x4ab)]===_0x44c740[_0x2e573c(0x4ab)]&&_0x44c740[_0x2e573c(0x4ab)]!==null)[_0x2e573c(0xb0a)](_0x3f7266=>_0x3f7266[_0x2e573c(0x1561)])[_0x2e573c(0x3b9)]('、');_0x24f4da&&(_0x3a75f4+=_0x2e573c(0xc87)+_0x24f4da+_0x2e573c(0x1544));}_0x1d3d57['id']!==_0x2e573c(0x20d)&&(_0x3a75f4+='-\x20**与用户的关系**:\x20你和用户('+_0x102509+_0x2e573c(0x4dc));_0x1e0c14+=_0x2e573c(0xb50)+_0x25e05a+_0x2e573c(0x3f2)+_0x1d3d57[_0x2e573c(0x1561)]+_0x2e573c(0x15bb)+_0x1d3d57[_0x2e573c(0x339)]+_0x2e573c(0x57c)+(_0x1d3d57['id']===_0x2e573c(0x20d)?_0x2e573c(0x12ff):_0x2e573c(0x14ed))+'\x0a-\x20**人设\x20(必须严格遵守)**:\x20'+_0x1d3d57[_0x2e573c(0x15c7)]+'\x0a';if(_0x1d3d57[_0x2e573c(0x1508)]==='character'){const _0x223d25=_0x19ddb8[_0x2e573c(0xb04)][_0x1d3d57['id']];if(_0x223d25&&_0x223d25[_0x2e573c(0x744)]&&_0x223d25[_0x2e573c(0x744)][_0x2e573c(0x106b)]>0x0){const _0x438e30=_0x223d25[_0x2e573c(0x744)]['map'](_0x1250c0=>_0x1250c0[_0x2e573c(0x4e3)])[_0x2e573c(0x3b9)](';\x20');_0x1e0c14+=_0x2e573c(0x4e7)+_0x438e30+'\x0a';}}_0x3a75f4&&(_0x1e0c14+=_0x2e573c(0xf7c)+_0x3a75f4);});let _0x40e236='#\x20昨晚事件总结\x20(Night\x20Event\x20Summary)\x0a';_0x40e236+='这是所有玩家都能听到的【公开信息】。\x0a';const _0xd41559=_0x480617[_0x2eede1(0x4f7)]['filter'](_0x3d9d3a=>_0x3d9d3a[_0x2eede1(0x4e3)][_0x2eede1(0x478)](_0x2eede1(0x226))&&_0x3d9d3a['day']===_0x480617[_0x2eede1(0xc9e)]);_0xd41559['length']===0x0?_0x40e236+=_0x2eede1(0xdab):_0xd41559[_0x2eede1(0x15c1)](_0x4c821d=>{_0x40e236+='-\x20'+_0x4c821d['content']+'\x0a';});let _0x29683a=_0x2eede1(0x4fc);if(_0x480617['currentDay']>0x1)for(let _0x18b449=0x1;_0x18b449<_0x480617['currentDay'];_0x18b449++){_0x29683a+='\x0a**---\x20第\x20'+_0x18b449+_0x2eede1(0x14c6);const _0x451da6=_0x480617[_0x2eede1(0x4f7)]['filter'](_0x54b8ea=>_0x54b8ea['day']===_0x18b449&&(_0x54b8ea['content']['includes']('死亡')||_0x54b8ea[_0x2eede1(0x4e3)][_0x2eede1(0x478)]('放逐')));_0x451da6[_0x2eede1(0x106b)]>0x0?_0x29683a+=_0x2eede1(0x137e)+_0x451da6[_0x2eede1(0xb0a)](_0x546f2e=>_0x546f2e['content'])[_0x2eede1(0x3b9)]('\x20')+'\x0a':_0x29683a+=_0x2eede1(0x444);const _0x9ed52c=_0x480617['discussionLog'][_0x2eede1(0x1195)](_0x4e2119=>_0x4e2119[_0x2eede1(0xa94)]===_0x18b449);_0x9ed52c[_0x2eede1(0x106b)]>0x0&&(_0x29683a+=_0x2eede1(0x1282)+_0x9ed52c[_0x2eede1(0xb0a)](_0x4041dd=>'-\x20'+_0x4041dd[_0x2eede1(0x1ea)]+':\x20'+_0x4041dd['content'])['join']('\x0a')+'\x0a');}else _0x29683a+=_0x2eede1(0xe9a);let _0x24c878='#\x20今日完整讨论记录\x20(Today\x27s\x20Full\x20Discussion\x20Record)\x0a';const _0x32be43=_0x480617[_0x2eede1(0x870)][_0x2eede1(0x1195)](_0x8e92f0=>_0x8e92f0[_0x2eede1(0xa94)]===_0x480617[_0x2eede1(0xc9e)]);_0x32be43[_0x2eede1(0x106b)]>0x0?_0x24c878+=_0x32be43['map'](_0x1c0bee=>_0x2eede1(0x1e5)+_0x1c0bee[_0x2eede1(0x1ea)]+'**:\x20'+_0x1c0bee['content'])['join']('\x0a'):_0x24c878+=_0x2eede1(0x1250);let _0x168944=_0x2eede1(0xd5c);_0x3699be['forEach'](_0x31491d=>{const _0x44e705=_0x2eede1;if(_0x31491d['id']!==_0x44e705(0x20d)){const _0x59c8f8=_0x480617[_0x44e705(0xa6d)][_0x44e705(0x455)](_0x174fce=>_0x174fce['id']===_0x31491d['id'])+0x1;_0x168944+=_0x44e705(0xc05)+_0x59c8f8+_0x44e705(0x3f2)+_0x31491d[_0x44e705(0x1561)]+_0x44e705(0x1bd)+_0x31491d[_0x44e705(0x339)]+_0x44e705(0xa19)+_0x31491d[_0x44e705(0x11c1)]+_0x44e705(0xfe6);let _0x43ea1e='';if(_0x31491d[_0x44e705(0x11c1)]==='狼人'){const _0xf8c4e1=_0x480617[_0x44e705(0xa6d)][_0x44e705(0x1195)](_0x186ca9=>_0x186ca9['role']==='狼人'&&_0x186ca9['id']!==_0x31491d['id']&&_0x186ca9[_0x44e705(0x139d)])['map'](_0x565eb4=>_0x565eb4[_0x44e705(0x1561)])[_0x44e705(0x3b9)]('、');_0x43ea1e+=_0x44e705(0xdd4)+(_0xf8c4e1||'无')+'\x0a';const _0x578976=_0x480617[_0x44e705(0xa6d)]['find'](_0x57ffee=>_0x57ffee['id']===_0x480617['nightActions']['killedId']);_0x43ea1e+=_0x44e705(0xd67)+(_0x578976?_0x578976[_0x44e705(0x1561)]:'空刀')+'\x0a';}if(_0x31491d[_0x44e705(0x11c1)]==='预言家'&&_0x480617['nightActions']['prophetCheck']){const _0x2b15c4=_0x480617['players'][_0x44e705(0xd62)](_0x3489d0=>_0x3489d0['id']===_0x480617['nightActions'][_0x44e705(0x3e0)][_0x44e705(0xa41)]);_0x43ea1e+=_0x44e705(0x1571)+_0x2b15c4['name']+_0x44e705(0x997)+_0x480617[_0x44e705(0x2fa)][_0x44e705(0x3e0)][_0x44e705(0x5c9)]+'】\x0a';}if(_0x31491d[_0x44e705(0x11c1)]==='女巫'){if(_0x480617[_0x44e705(0x2fa)][_0x44e705(0xcde)]){const _0x28dc3c=_0x480617[_0x44e705(0xa6d)][_0x44e705(0xd62)](_0x15762e=>_0x15762e['id']===_0x480617['nightActions']['savedId']);_0x43ea1e+=_0x44e705(0xffb)+_0x28dc3c[_0x44e705(0x1561)]+'。\x0a';}if(_0x480617['nightActions'][_0x44e705(0x3a5)]){const _0x15a6d8=_0x480617[_0x44e705(0xa6d)][_0x44e705(0xd62)](_0x5e89f3=>_0x5e89f3['id']===_0x480617[_0x44e705(0x2fa)][_0x44e705(0x3a5)]);_0x43ea1e+='\x20\x20\x20\x20-\x20我昨晚用毒药毒了\x20'+_0x15a6d8[_0x44e705(0x1561)]+'。\x0a';}_0x43ea1e+=_0x44e705(0x1324)+(_0x31491d['antidoteUsed']?_0x44e705(0x6f4):_0x44e705(0x509))+'\x0a',_0x43ea1e+=_0x44e705(0xc68)+(_0x31491d['poisonUsed']?'已使用':'未使用')+'\x0a';}if(_0x31491d['role']==='守卫'){if(_0x480617[_0x44e705(0x2fa)][_0x44e705(0xe36)]){const _0x1fb512=_0x480617[_0x44e705(0xa6d)][_0x44e705(0xd62)](_0x1147c8=>_0x1147c8['id']===_0x480617[_0x44e705(0x2fa)][_0x44e705(0xe36)]);_0x43ea1e+=_0x44e705(0x1e1)+_0x1fb512[_0x44e705(0x1561)]+'。\x0a';}else _0x43ea1e+=_0x44e705(0x2ae);}_0x43ea1e===''&&(_0x43ea1e='\x20\x20\x20\x20-\x20我没有掌握任何特殊的夜晚信息。\x0a');_0x168944+=_0x43ea1e,_0x168944+=_0x44e705(0x84d)+_0x40e236[_0x44e705(0x1bb)](/\n/g,'\x20')+_0x44e705(0x4ad)+_0x24c878[_0x44e705(0x1bb)](/\n/g,'\x20')+_0x44e705(0x10f5)+_0x31491d[_0x44e705(0x15c7)]+'\x0a\x20\x20\x20\x20-\x20**社交**:\x20\x0a';let _0x3bcf43='';const _0x32153e=_0x19ddb8[_0x44e705(0xb04)][_0x31491d['id']];if(_0x32153e){const _0x582b90=_0x3699be[_0x44e705(0x1195)](_0x45a893=>_0x45a893['id']!==_0x31491d['id']&&_0x19ddb8['chats'][_0x45a893['id']]&&_0x19ddb8[_0x44e705(0xb04)][_0x45a893['id']][_0x44e705(0x4ab)]===_0x32153e[_0x44e705(0x4ab)]&&_0x32153e['groupId']!==null)[_0x44e705(0xb0a)](_0x578675=>_0x578675[_0x44e705(0x1561)])[_0x44e705(0x3b9)]('、');_0x582b90&&(_0x3bcf43+=_0x44e705(0xd04)+_0x582b90+_0x44e705(0x6cf));}_0x31491d['id']!==_0x44e705(0x20d)&&(_0x3bcf43+=_0x44e705(0xd04)+_0x102509+_0x44e705(0x219)),_0x3bcf43===''&&(_0x3bcf43='\x20\x20\x20\x20\x20\x20-\x20我在此次游戏中没有特别的社交关系。\x0a'),_0x168944+=_0x3bcf43,_0x168944+=_0x44e705(0x13e1)+_0x102509+_0x44e705(0x67e)+(_0x32be43[_0x44e705(0x106b)]>0x0?_0x44e705(0x9ae):_0x44e705(0x1da))+'，我的看法是...\x20我【必须】回应...\x0a3.\x20\x20**S\x20(Social\x20-\x20社交表演)**:\x20我要如何用我的【人设】和【社交关系】来包装我的发言？\x0a\x20\x20\x20\x20-\x20(例如：我的好友\x20'+_0x102509+_0x44e705(0xa7e)+_0x102509+_0x44e705(0x302)+_0x31491d[_0x44e705(0x11c1)]+'，我的人设很'+_0x31491d[_0x44e705(0x15c7)][_0x44e705(0x72e)](0x0,0x14)+_0x44e705(0x122a);}}),_0x168944+='\x0a##\x20阶段2：生成最终对话\x20(Final\x20JSON\x20Output)\x0a你现在已经为【所有AI角色】都完成了“TGS三核”独立思考。\x0a请根据你在“阶段C：最终发言稿”中为每个角色准备好的草稿，生成最终的、符合格式的JSON数组。\x0a';const _0x34c6c0=_0x2eede1(0x119f)+(_0x18f67c?_0x2eede1(0xa0e)+_0x102509+')':_0x2eede1(0xec7)+_0x102509+')')+_0x2eede1(0x69a)+_0x1e0c14+_0x2eede1(0x6e2)+(_0x480617[_0x2eede1(0x144f)]===_0x2eede1(0x595)?_0x2eede1(0x1031):_0x2eede1(0xaea))+_0x2eede1(0xbcf)+_0x480617[_0x2eede1(0xc9e)]+_0x2eede1(0x525)+_0x40e236+'\x20\x0a-\x20存活玩家:\x20'+_0x3699be[_0x2eede1(0xb0a)](_0x46af02=>_0x46af02['name']+'\x20('+(_0x46af02['id']===_0x2eede1(0x20d)?'用户':'AI')+')')[_0x2eede1(0x3b9)](',\x20')+_0x2eede1(0x654)+_0x102509+_0x2eede1(0x1479)+_0x29683a+_0x2eede1(0xc63)+_0x24c878+'\x0a\x0a'+_0x168944+'\x0a\x0a现在，请严格按照“阶段2”的指令，为所有【存活的AI角色】生成他们充满策略和博弈的发言JSON数组。';return _0x34c6c0;}function _0xfb6164(_0x1d844d){const _0x26affa=_0x48bc6d;let _0x4f24be='---\x20狼人杀对局完整复盘\x20---\x0a\x0a';const _0x1d2f80=_0x1d844d['gameLog'][_0x26affa(0xd62)](_0x168927=>_0x168927['content'][_0x26affa(0x478)]('胜利'))?.[_0x26affa(0x4e3)]||_0x26affa(0x15d5);_0x4f24be+=_0x26affa(0x6bd)+_0x1d2f80+'\x0a\x0a',_0x4f24be+=_0x26affa(0x1106),_0x1d844d[_0x26affa(0xa6d)][_0x26affa(0x15c1)](_0x3df4c6=>{const _0x1d8763=_0x26affa,_0x340116=_0x3df4c6[_0x1d8763(0x139d)]?'存活':_0x1d8763(0x456);_0x4f24be+='-\x20'+_0x3df4c6[_0x1d8763(0x1561)]+':\x20'+_0x3df4c6[_0x1d8763(0x11c1)]+'\x20('+_0x340116+')\x0a';}),_0x4f24be+=_0x26affa(0x15cb);for(let _0x34c159=0x1;_0x34c159<=_0x1d844d['currentDay'];_0x34c159++){_0x4f24be+=_0x26affa(0x13b9)+_0x34c159+_0x26affa(0x14c6);const _0x18a9cd=_0x1d844d[_0x26affa(0x4f7)][_0x26affa(0x1195)](_0x5dfc4e=>_0x5dfc4e[_0x26affa(0xa94)]===_0x34c159&&_0x5dfc4e[_0x26affa(0x4e3)]['includes']('死亡'));if(_0x18a9cd[_0x26affa(0x106b)]>0x0)_0x4f24be+=_0x26affa(0x24e)+_0x18a9cd['map'](_0x1ef32f=>_0x1ef32f[_0x26affa(0x4e3)])['join']('\x20')+'\x0a';else(_0x34c159>0x1||_0x34c159===0x1&&_0x1d844d[_0x26affa(0xc9e)]>0x1)&&(_0x4f24be+=_0x26affa(0x631));const _0x29e810=_0x1d844d[_0x26affa(0x870)][_0x26affa(0x1195)](_0x303799=>_0x303799[_0x26affa(0xa94)]===_0x34c159);_0x29e810['length']>0x0&&(_0x4f24be+='**[讨论环节]**\x0a'+_0x29e810[_0x26affa(0xb0a)](_0x5f5d2d=>'-\x20'+_0x5f5d2d[_0x26affa(0x1ea)]+':\x20'+_0x5f5d2d[_0x26affa(0x4e3)])[_0x26affa(0x3b9)]('\x0a')+'\x0a');const _0xc00277=_0x1d844d['gameLog']['find'](_0x3bb52c=>_0x3bb52c[_0x26affa(0xa94)]===_0x34c159&&_0x3bb52c[_0x26affa(0x4e3)][_0x26affa(0x478)]('被投票放逐'));_0xc00277&&(_0x4f24be+=_0x26affa(0x12d0)+_0xc00277[_0x26affa(0x4e3)]+'\x0a');}return _0x4f24be+=_0x26affa(0x81c),_0x4f24be;}async function _0x4353aa(_0x12ce3a){const _0x41a502=_0x48bc6d;let _0x1fc654=0x0;for(const _0x4b480d of _0x480617[_0x41a502(0xa6d)]){if(_0x4b480d['type']===_0x41a502(0xb44)){const _0x553a7f=_0x19ddb8[_0x41a502(0xb04)][_0x4b480d['id']];if(_0x553a7f){const _0x186e14={'content':_0x12ce3a,'timestamp':Date[_0x41a502(0x64b)](),'source':_0x41a502(0x108a)};!_0x553a7f['longTermMemory']&&(_0x553a7f[_0x41a502(0x744)]=[]),_0x553a7f[_0x41a502(0x744)][_0x41a502(0x1c4)](_0x186e14),await _0x512070[_0x41a502(0xb04)][_0x41a502(0xd4d)](_0x553a7f),_0x1fc654++;}}}return _0x1fc654;}async function _0x1fe472(){const _0x45acea=_0x48bc6d;if(!_0x480617[_0x45acea(0x1412)]&&_0x480617['currentPhase']===_0x45acea(0x3b5)){await _0x403a62(_0x45acea(0x1395),_0x45acea(0xcc0));try{const _0xae01ae=_0xfb6164(_0x480617),_0xb5ba75=await _0x4353aa(_0xae01ae);await _0x403a62('成功',_0x45acea(0x12fa)+_0xb5ba75+_0x45acea(0x139b));}catch(_0x4dd72d){console[_0x45acea(0x3b7)]('手动注入狼人杀记忆失败:',_0x4dd72d),await _0x403a62('失败',_0x45acea(0xc5c)+_0x4dd72d['message']);}}else alert(_0x45acea(0x155c));}async function _0x6dcf04(_0x55ca77){const _0x121de3=_0x48bc6d;_0x480617[_0x121de3(0x1412)]=![],_0x480617[_0x121de3(0xdf2)]='gameover',_0x3740db(_0x55ca77+_0x121de3(0xa59)),document[_0x121de3(0x9a3)](_0x121de3(0x5d5))[_0x121de3(0x766)]=_0x55ca77+_0x121de3(0x1274);let _0x766c1='';_0x55ca77==='好人'?_0x766c1='所有狼人已被放逐，好人阵营获得了胜利！':_0x766c1=_0x121de3(0x569);const _0x38cf58=document[_0x121de3(0x9a3)]('werewolf-game-over-reason');_0x38cf58['textContent']=_0x766c1;const _0xf83d2b=document[_0x121de3(0x9a3)](_0x121de3(0x1337));_0xf83d2b[_0x121de3(0xeb2)]='';const _0x3c6c77=[..._0x480617[_0x121de3(0xa6d)]][_0x121de3(0x6a2)]((_0x1b12e0,_0x59fe29)=>{const _0x373fa9=_0x121de3,_0x9689e8=_0x480617[_0x373fa9(0xa6d)]['findIndex'](_0x7c92b1=>_0x7c92b1['id']===_0x1b12e0['id']),_0x277cab=_0x480617[_0x373fa9(0xa6d)]['findIndex'](_0x4358fc=>_0x4358fc['id']===_0x59fe29['id']);return _0x9689e8-_0x277cab;});_0x3c6c77[_0x121de3(0x15c1)]((_0x28256e,_0x5d20f5)=>{const _0x18c974=_0x121de3,_0x54944e=document['createElement'](_0x18c974(0x8ca));_0x54944e['style'][_0x18c974(0x6c0)]='display:\x20flex;\x20align-items:\x20center;\x20padding:\x208px\x200;\x20border-bottom:\x201px\x20solid\x20#444;\x20color:\x20white;';if(_0x5d20f5===_0x3c6c77[_0x18c974(0x106b)]-0x1)_0x54944e['style'][_0x18c974(0x14ef)]=_0x18c974(0x8e0);const _0x4bc568=_0x28256e[_0x18c974(0x11c1)]==='狼人'?'#ff4d4d':_0x18c974(0x15a5);_0x54944e[_0x18c974(0xeb2)]=_0x18c974(0x5f0)+_0x28256e[_0x18c974(0xf3f)]+_0x18c974(0x2f4)+(_0x28256e[_0x18c974(0x139d)]?_0x18c974(0x8e0):_0x18c974(0x332))+';\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20left;\x20text-decoration:\x20'+(_0x28256e['isAlive']?_0x18c974(0x8e0):'line-through')+_0x18c974(0xa1a)+(_0x5d20f5+0x1)+'.\x20'+_0x28256e['name']+_0x18c974(0x1400)+_0x4bc568+_0x18c974(0xa1a)+_0x28256e[_0x18c974(0x11c1)]+_0x18c974(0x158a),_0xf83d2b[_0x18c974(0x983)](_0x54944e);}),document[_0x121de3(0x9a3)](_0x121de3(0xd91))[_0x121de3(0x4d8)][_0x121de3(0xe05)](_0x121de3(0xc09));try{console[_0x121de3(0xe4d)](_0x121de3(0xfbf));const _0x19fe60=_0xfb6164(_0x480617),_0x55e595=await generateAndInjectWerewolfMemories(_0x19fe60);console['log'](_0x121de3(0xc00)+_0x55e595+_0x121de3(0x1424));}catch(_0x5f36e6){console[_0x121de3(0x3b7)](_0x121de3(0xd75),_0x5f36e6),_0x38cf58&&(_0x38cf58[_0x121de3(0xeb2)]+=_0x121de3(0x102f));}}function _0x3740db(_0x3bea5c){const _0x1978d8=_0x48bc6d;_0x480617[_0x1978d8(0x4f7)][_0x1978d8(0x1c4)]({'type':_0x1978d8(0xe10),'content':_0x3bea5c,'timestamp':Date[_0x1978d8(0x64b)](),'day':_0x480617[_0x1978d8(0xc9e)]});}function _0x43d255(_0x38fba1,_0x54827b){const _0x1487ad=_0x48bc6d;_0x480617[_0x1487ad(0x870)][_0x1487ad(0x1c4)]({'type':_0x1487ad(0x103d),'speaker':_0x38fba1,'content':_0x54827b,'timestamp':Date[_0x1487ad(0x64b)](),'day':_0x480617[_0x1487ad(0xc9e)]});}function _0x9492ab(_0x2fe2f2){return new Promise(_0x15d202=>{const _0x1b7e33=_0x1efc,_0x29c65b='werewolf-'+_0x2fe2f2+_0x1b7e33(0x1251),_0x58d666=_0x1b7e33(0x8a1)+_0x2fe2f2+_0x1b7e33(0x474);let _0xd4831='';if(_0x2fe2f2===_0x1b7e33(0x1532))_0xd4831=_0x1b7e33(0x4cc);if(_0x2fe2f2===_0x1b7e33(0x7e1))_0xd4831=_0x1b7e33(0x12d6);if(_0x2fe2f2===_0x1b7e33(0x154d))_0xd4831=_0x1b7e33(0x36e);const _0xc84143=document[_0x1b7e33(0x9a3)](_0x29c65b),_0x34ee11=document[_0x1b7e33(0x9a3)](_0x58d666),_0x401644=document[_0x1b7e33(0x9a3)](_0xd4831);_0x34ee11['innerHTML']='';let _0x5dda7b=null;const _0x3e0a7e=_0x480617[_0x1b7e33(0xa6d)][_0x1b7e33(0x1195)](_0x211c88=>_0x211c88[_0x1b7e33(0x139d)]&&(_0x2fe2f2===_0x1b7e33(0x7e1)||_0x2fe2f2===_0x1b7e33(0x154d)||_0x211c88['id']!=='user'));_0x3e0a7e[_0x1b7e33(0x15c1)](_0xc930c0=>{const _0x3e7f4d=_0x1b7e33,_0x527cf5=document['createElement'](_0x3e7f4d(0x8ca));_0x527cf5[_0x3e7f4d(0x1487)]=_0x3e7f4d(0xcb2),_0x527cf5['dataset']['id']=_0xc930c0['id'],_0x527cf5[_0x3e7f4d(0xeb2)]=_0x3e7f4d(0x887)+_0xc930c0[_0x3e7f4d(0xf3f)]+'\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>'+_0xc930c0[_0x3e7f4d(0x1561)]+_0x3e7f4d(0xeb1),_0x527cf5[_0x3e7f4d(0x4ce)]=()=>{const _0x4fc6a7=_0x3e7f4d;_0x34ee11[_0x4fc6a7(0x131c)](_0x4fc6a7(0xa00))[_0x4fc6a7(0x15c1)](_0x2270fd=>_0x2270fd[_0x4fc6a7(0x4d8)][_0x4fc6a7(0x133d)](_0x4fc6a7(0x154b))),_0x527cf5[_0x4fc6a7(0x4d8)]['add'](_0x4fc6a7(0x154b)),_0x5dda7b=_0xc930c0['id'];},_0x34ee11[_0x3e7f4d(0x983)](_0x527cf5);});const _0xdaf3f9=_0x401644[_0x1b7e33(0x173)](!![]);_0x401644[_0x1b7e33(0x5eb)][_0x1b7e33(0x15ab)](_0xdaf3f9,_0x401644),_0xdaf3f9[_0x1b7e33(0x4ce)]=()=>{const _0xf989dc=_0x1b7e33;_0x5dda7b?(_0xc84143[_0xf989dc(0x4d8)][_0xf989dc(0x133d)](_0xf989dc(0xc09)),_0x15d202(_0x5dda7b)):alert(_0xf989dc(0x9c3));},_0xc84143[_0x1b7e33(0x4d8)]['add'](_0x1b7e33(0xc09));});}function _0xbb03d1(){return new Promise(_0xda7703=>{const _0x29d06c=_0x1efc,_0x41343e=document[_0x29d06c(0x9a3)](_0x29d06c(0x975)),_0x216582=document[_0x29d06c(0x9a3)]('werewolf-kill-selection-list'),_0x197991=document[_0x29d06c(0x9a3)](_0x29d06c(0x473)),_0x9ea27d=_0x41343e[_0x29d06c(0xc86)]('.modal-header\x20span'),_0x56544c=_0x480617[_0x29d06c(0xa6d)][_0x29d06c(0x1195)](_0x242549=>_0x242549[_0x29d06c(0x11c1)]==='狼人'&&_0x242549[_0x29d06c(0x139d)]),_0x6d7c5=_0x56544c[_0x29d06c(0x1195)](_0x41659b=>_0x41659b['id']!==_0x29d06c(0x20d))[_0x29d06c(0xb0a)](_0x3d5fa0=>_0x3d5fa0[_0x29d06c(0x1561)])['join']('、');_0x6d7c5?_0x9ea27d[_0x29d06c(0xeb2)]=_0x29d06c(0xaff)+_0x6d7c5+_0x29d06c(0x1534):_0x9ea27d['textContent']=_0x29d06c(0xb2f);_0x216582[_0x29d06c(0xeb2)]='';let _0x1c3588=null;const _0x5ef29e=_0x480617[_0x29d06c(0xa6d)]['filter'](_0x463dc6=>_0x463dc6['isAlive']&&_0x463dc6[_0x29d06c(0x11c1)]!=='狼人');_0x5ef29e[_0x29d06c(0x15c1)](_0x17f226=>{const _0x32d0b0=_0x29d06c,_0x3e03b6=document[_0x32d0b0(0xe94)]('div');_0x3e03b6[_0x32d0b0(0x1487)]=_0x32d0b0(0xcb2),_0x3e03b6[_0x32d0b0(0xd8d)]['id']=_0x17f226['id'],_0x3e03b6[_0x32d0b0(0xeb2)]=_0x32d0b0(0x887)+_0x17f226[_0x32d0b0(0xf3f)]+_0x32d0b0(0xbf5)+_0x17f226[_0x32d0b0(0x1561)]+_0x32d0b0(0xeb1),_0x3e03b6['onclick']=()=>{const _0x8b01a3=_0x32d0b0;_0x216582[_0x8b01a3(0x131c)]('.selected')[_0x8b01a3(0x15c1)](_0x523167=>_0x523167[_0x8b01a3(0x4d8)][_0x8b01a3(0x133d)](_0x8b01a3(0x154b))),_0x3e03b6[_0x8b01a3(0x4d8)][_0x8b01a3(0xe05)](_0x8b01a3(0x154b)),_0x1c3588=_0x17f226['id'];},_0x216582['appendChild'](_0x3e03b6);});const _0x4895b4=_0x197991[_0x29d06c(0x173)](!![]);_0x197991[_0x29d06c(0x5eb)][_0x29d06c(0x15ab)](_0x4895b4,_0x197991),_0x4895b4[_0x29d06c(0x4ce)]=()=>{const _0x3dc030=_0x29d06c;_0x1c3588?(_0x41343e['classList'][_0x3dc030(0x133d)]('visible'),_0xda7703(_0x1c3588)):alert(_0x3dc030(0x9c3));},_0x41343e['classList'][_0x29d06c(0xe05)](_0x29d06c(0xc09));});}function _0x1beffc(){const _0xb47812=_0x48bc6d,_0x191ecc=_0x480617['players'][_0xb47812(0xd62)](_0x3d193f=>_0x3d193f['id']===_0xb47812(0x20d));if(!_0x191ecc||!_0x191ecc[_0xb47812(0x139d)])return;const _0x5edef1=document['getElementById'](_0xb47812(0x106c)),_0x21aae8=_0x5edef1['value'][_0xb47812(0x13f9)]();_0x21aae8&&(_0x43d255(_0x191ecc[_0xb47812(0x1561)],_0x21aae8),_0x300c83()),document[_0xb47812(0x9a3)](_0xb47812(0x516))[_0xb47812(0x20f)][_0xb47812(0x115d)]=_0xb47812(0x8e0),_0x5edef1['value']='',_0x49babf();}async function _0x49d3e3(){const _0x3db60b=_0x48bc6d;_0x3740db(_0x3db60b(0x946)),_0x300c83();const _0x370ad8=document[_0x3db60b(0x9a3)](_0x3db60b(0xc3b));if(_0x370ad8)_0x370ad8[_0x3db60b(0x15d3)]=!![];await _0x403a62(_0x3db60b(0xacf),_0x3db60b(0xc03));const {proxyUrl:_0x5f5369,apiKey:_0x1cc737,model:_0x9b0212}=_0x19ddb8[_0x3db60b(0xd22)];if(!_0x5f5369||!_0x1cc737||!_0x9b0212){alert(_0x3db60b(0x1193));return;}const _0x25e01f=_0x3160e8();try{let _0x201e55=_0x5f5369[_0x3db60b(0x478)](_0x3db60b(0x1329)),_0x236051=[{'role':_0x3db60b(0x20d),'content':_0x3db60b(0x9b5)}],_0xa77c9b=_0x366263(_0x9b0212,_0x1cc737,_0x25e01f,_0x236051);const _0x1593f4=_0x201e55?await fetch(_0xa77c9b[_0x3db60b(0x121f)],_0xa77c9b[_0x3db60b(0x38c)]):await fetch(_0x5f5369+_0x3db60b(0x501),{'method':_0x3db60b(0x12db),'headers':{'Content-Type':_0x3db60b(0xb1f),'Authorization':_0x3db60b(0x1265)+_0x1cc737},'body':JSON[_0x3db60b(0xe1e)]({'model':_0x9b0212,'messages':[{'role':'system','content':_0x25e01f},..._0x236051],'temperature':_0x19ddb8['globalSettings'][_0x3db60b(0x4a2)]||0.9})});if(!_0x1593f4['ok']){const _0x5cb299=await _0x1593f4[_0x3db60b(0xa5d)]();throw new Error(_0x3db60b(0x786)+_0x5cb299['error'][_0x3db60b(0xcce)]);}const _0x3a4a67=await _0x1593f4[_0x3db60b(0xa5d)](),_0x1ef4a6=getGeminiResponseText(_0x3a4a67),_0x1235a6=_0x1ef4a6[_0x3db60b(0x293)](/(\[[\s\S]*\])/);if(!_0x1235a6)throw new Error(_0x3db60b(0x1178)+_0x1ef4a6);const _0x526c2c=JSON[_0x3db60b(0x1447)](_0x1235a6[0x0]);for(const _0x1491cb of _0x526c2c){_0x1491cb[_0x3db60b(0x15a6)]&&_0x1491cb[_0x3db60b(0x103d)]&&(_0x43d255(_0x1491cb[_0x3db60b(0x15a6)],_0x1491cb[_0x3db60b(0x103d)]),_0x300c83(),await new Promise(_0x38ccd7=>setTimeout(_0x38ccd7,0x5dc+Math[_0x3db60b(0xdcd)]()*0x7d0)));}}catch(_0x41f8cf){console[_0x3db60b(0x3b7)](_0x3db60b(0x50f),_0x41f8cf),await _0x403a62(_0x3db60b(0x9a8),'错误:\x20'+_0x41f8cf['message']);}finally{if(_0x370ad8)_0x370ad8['disabled']=![];}}async function _0x128411(){const _0x1fe069=_0x48bc6d,_0x276e99=_0x480617[_0x1fe069(0xa6d)][_0x1fe069(0xd62)](_0x1649f4=>_0x1649f4['id']===_0x1fe069(0x20d));if(!_0x276e99||!_0x276e99[_0x1fe069(0x139d)]){console[_0x1fe069(0x651)](_0x1fe069(0x166));return;}const _0x4711a2=document[_0x1fe069(0x9a3)](_0x1fe069(0x106c)),_0x2ec4f9=_0x4711a2[_0x1fe069(0x7b2)][_0x1fe069(0x13f9)]();if(!_0x2ec4f9){alert('请先输入你的发言内容。');return;}_0x43d255(_0x276e99[_0x1fe069(0x1561)],_0x2ec4f9),_0x300c83(),_0x4711a2[_0x1fe069(0x7b2)]='',await _0x403a62(_0x1fe069(0xacf),_0x1fe069(0x217));const {proxyUrl:_0x5451a9,apiKey:_0x4e277c,model:_0x22c3a1}=_0x19ddb8[_0x1fe069(0xd22)];if(!_0x5451a9||!_0x4e277c||!_0x22c3a1){alert(_0x1fe069(0x1193));return;}const _0x30e2f1=_0x3160e8();try{let _0x172e83=_0x5451a9[_0x1fe069(0x478)](_0x1fe069(0x1329)),_0x542932=[{'role':_0x1fe069(0x20d),'content':_0x1fe069(0x15aa)+_0x276e99[_0x1fe069(0x1561)]+_0x1fe069(0xea8)}],_0x2d1140=_0x366263(_0x22c3a1,_0x4e277c,_0x30e2f1,_0x542932);const _0x215650=_0x172e83?await fetch(_0x2d1140[_0x1fe069(0x121f)],_0x2d1140[_0x1fe069(0x38c)]):await fetch(_0x5451a9+'/v1/chat/completions',{'method':_0x1fe069(0x12db),'headers':{'Content-Type':_0x1fe069(0xb1f),'Authorization':_0x1fe069(0x1265)+_0x4e277c},'body':JSON['stringify']({'model':_0x22c3a1,'messages':[{'role':_0x1fe069(0xe10),'content':_0x30e2f1},..._0x542932],'temperature':_0x19ddb8[_0x1fe069(0x4c8)][_0x1fe069(0x4a2)]||0.9})});if(!_0x215650['ok']){const _0x3539b2=await _0x215650[_0x1fe069(0xa5d)]();throw new Error(_0x1fe069(0x786)+_0x3539b2[_0x1fe069(0x3b7)][_0x1fe069(0xcce)]);}const _0x305eb0=await _0x215650[_0x1fe069(0xa5d)](),_0x459915=getGeminiResponseText(_0x305eb0);let _0x5185eb;try{let _0x32abc7=_0x459915['replace'](/^```json\s*/,'')[_0x1fe069(0x1bb)](/```$/,'')[_0x1fe069(0x13f9)]();const _0x236b20=_0x32abc7[_0x1fe069(0xef5)]('['),_0x138760=_0x32abc7[_0x1fe069(0x92e)](']');if(_0x236b20===-0x1||_0x138760===-0x1||_0x138760<_0x236b20)throw new Error(_0x1fe069(0x952));const _0x4a5d51=_0x32abc7[_0x1fe069(0x72e)](_0x236b20,_0x138760+0x1);_0x5185eb=JSON[_0x1fe069(0x1447)](_0x4a5d51);}catch(_0x478976){if(_0x478976[_0x1fe069(0xcce)]['includes'](_0x1fe069(0x6eb))){console[_0x1fe069(0x651)]('检测到JSON中的非法控制字符，尝试清理并重试...');const _0x46dc4e=_0x57b784=>{const _0x96e6c8=_0x1fe069;let _0x2b9f2c=![],_0x57c006=![],_0x38f3c4='';for(let _0x4880ef=0x0;_0x4880ef<_0x57b784[_0x96e6c8(0x106b)];_0x4880ef++){const _0x581e2d=_0x57b784[_0x4880ef];if(_0x57c006){_0x38f3c4+=_0x581e2d,_0x57c006=![];continue;}if(_0x581e2d==='\x5c'){_0x38f3c4+=_0x581e2d,_0x57c006=!![];continue;}if(_0x581e2d==='\x22'){_0x38f3c4+=_0x581e2d,_0x2b9f2c=!_0x2b9f2c;continue;}if(_0x2b9f2c){if(_0x581e2d==='\x0a')_0x38f3c4+='\x5cn';else{if(_0x581e2d==='\x0d')_0x38f3c4+='\x5cr';else{if(_0x581e2d==='\x09')_0x38f3c4+='\x5ct';else{if(_0x581e2d['charCodeAt'](0x0)<0x20)continue;else _0x38f3c4+=_0x581e2d;}}}}else _0x38f3c4+=_0x581e2d;}return _0x38f3c4;};let _0x47cd85=_0x459915['replace'](/^```json\s*/,'')[_0x1fe069(0x1bb)](/```$/,'')[_0x1fe069(0x13f9)]();const _0x342b01=_0x46dc4e(_0x47cd85),_0x612779=_0x342b01[_0x1fe069(0x293)](/(\[[\s\S]*\])/);if(!_0x612779)throw new Error(_0x1fe069(0x14ae));_0x5185eb=JSON[_0x1fe069(0x1447)](_0x612779[0x0]);}else throw new Error('解析AI返回的JSON时出错:\x20'+_0x478976[_0x1fe069(0xcce)]+_0x1fe069(0x8f2)+_0x459915);}for(const _0x42a4c3 of _0x5185eb){_0x42a4c3[_0x1fe069(0x15a6)]&&_0x42a4c3[_0x1fe069(0x103d)]&&(_0x43d255(_0x42a4c3[_0x1fe069(0x15a6)],_0x42a4c3[_0x1fe069(0x103d)]),_0x300c83(),await new Promise(_0x5a2009=>setTimeout(_0x5a2009,0x5dc+Math[_0x1fe069(0xdcd)]()*0x7d0)));}}catch(_0x46e629){console['error']('狼人杀AI回应生成失败:',_0x46e629),await _0x403a62(_0x1fe069(0x9a8),'错误:\x20'+_0x46e629['message']);}}async function _0x49babf(){const _0x38d25c=_0x48bc6d;_0x3740db(_0x38d25c(0x10a1)),_0x300c83(),_0x480617[_0x38d25c(0xa71)]={};let _0x43fd98=null;_0x480617[_0x38d25c(0xd27)]=_0x38d25c(0x108b);try{_0x43fd98=await _0x5008c9(),_0x43fd98&&_0x43fd98[_0x38d25c(0x15c1)](_0x33ba63=>{const _0x2cb7f5=_0x38d25c,_0x3b791f=_0x480617[_0x2cb7f5(0xa6d)][_0x2cb7f5(0xd62)](_0x497d6b=>_0x497d6b[_0x2cb7f5(0x1561)]===_0x33ba63[_0x2cb7f5(0x158b)]),_0x2f55d7=_0x480617['players'][_0x2cb7f5(0xd62)](_0x385eda=>_0x385eda[_0x2cb7f5(0x1561)]===_0x33ba63[_0x2cb7f5(0x7c4)]);_0x3b791f&&_0x3b791f[_0x2cb7f5(0x139d)]&&_0x2f55d7&&(_0x480617[_0x2cb7f5(0xa71)][_0x3b791f['name']]=_0x2f55d7[_0x2cb7f5(0x1561)]);}),_0x480617['lastFailedAction']=null;}catch(_0x1fadb8){console[_0x38d25c(0x3b7)](_0x38d25c(0x45b),_0x1fadb8),await _0x403a62(_0x38d25c(0x13bd),'AI角色无法完成投票，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20'+_0x1fadb8[_0x38d25c(0xcce)]),document[_0x38d25c(0x9a3)](_0x38d25c(0x27f))[_0x38d25c(0x20f)][_0x38d25c(0x115d)]='block';return;}const _0x4d83db=_0x480617['players'][_0x38d25c(0xd62)](_0x5ec6cd=>_0x5ec6cd['id']===_0x38d25c(0x20d));if(_0x4d83db&&_0x4d83db[_0x38d25c(0x139d)]){_0x3740db('请你投票。'),_0x300c83();const _0x23fc8a=await _0x9492ab(_0x38d25c(0x154d)),_0x5ac710=_0x480617['players'][_0x38d25c(0xd62)](_0x15c3f3=>_0x15c3f3['id']===_0x23fc8a);_0x5ac710&&(_0x480617[_0x38d25c(0xa71)][_0x4d83db[_0x38d25c(0x1561)]]=_0x5ac710[_0x38d25c(0x1561)]);}_0x25778a();}async function _0x5008c9(){const _0x469306=_0x48bc6d,{proxyUrl:_0x3eeaf0,apiKey:_0x210e51,model:_0x70a1e2}=_0x19ddb8['apiConfig'];if(!_0x3eeaf0||!_0x210e51||!_0x70a1e2)return null;const _0x57f631=_0x480617[_0x469306(0xa6d)][_0x469306(0x1195)](_0x45b039=>_0x45b039[_0x469306(0x139d)]&&_0x45b039['id']!=='user'),_0x34ec57=_0x480617[_0x469306(0xa6d)]['filter'](_0x5424c6=>_0x5424c6[_0x469306(0x139d)])['map'](_0x428785=>_0x428785['name']);let _0x54bd83=_0x3160e8();_0x54bd83+='\x0a#\x20【【【最终投票指令\x20(最高优先级)】】】\x0a现在是投票环节。请你扮演【每一个存活的AI角色】，根据以上所有信息（特别是刚刚的讨论环节），为他们各自决定要投票放逐哪一位玩家。\x0a-\x20**投票依据**:\x20你的投票【必须】基于逻辑分析和你的身份。狼人可能会投给好人，好人需要找出狼人。\x0a-\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式如下：\x0a```json\x0a[\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色A的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色A投票的玩家名字\x22},\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色B的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色B投票的玩家名字\x22}\x0a]\x0a```\x0a-\x20**可投票的玩家列表**:\x20'+_0x34ec57[_0x469306(0x3b9)](',\x20')+_0x469306(0xf42);try{let _0x51f16a=_0x3eeaf0[_0x469306(0x478)]('generativelanguage'),_0x284803=[{'role':_0x469306(0x20d),'content':_0x469306(0x97f)}],_0x32628e=_0x366263(_0x70a1e2,_0x210e51,_0x54bd83,_0x284803);const _0x5855f3=_0x51f16a?await fetch(_0x32628e[_0x469306(0x121f)],_0x32628e[_0x469306(0x38c)]):await fetch(_0x3eeaf0+'/v1/chat/completions',{'method':_0x469306(0x12db),'headers':{'Content-Type':_0x469306(0xb1f),'Authorization':_0x469306(0x1265)+_0x210e51},'body':JSON[_0x469306(0xe1e)]({'model':_0x70a1e2,'messages':[{'role':_0x469306(0xe10),'content':_0x54bd83},..._0x284803],'temperature':_0x19ddb8[_0x469306(0x4c8)][_0x469306(0x4a2)]||0.8})});if(!_0x5855f3['ok'])throw new Error((await _0x5855f3['json']())[_0x469306(0x3b7)][_0x469306(0xcce)]);const _0x5334f1=await _0x5855f3[_0x469306(0xa5d)](),_0x16b5db=getGeminiResponseText(_0x5334f1);let _0x1d0540=_0x16b5db[_0x469306(0x1bb)](/^```json\s*/,'')[_0x469306(0x1bb)](/```$/,'')[_0x469306(0x13f9)]();const _0x3cdfd9=_0x1d0540['indexOf']('['),_0x13de64=_0x1d0540['lastIndexOf'](']');if(_0x3cdfd9===-0x1||_0x13de64===-0x1||_0x13de64<_0x3cdfd9)throw new Error('AI返回的投票结果中未找到有效的JSON数组结构\x20(`[...]`)。');const _0x2fcd77=_0x1d0540[_0x469306(0x72e)](_0x3cdfd9,_0x13de64+0x1);try{const _0x37355a=_0x2fcd77[_0x469306(0x293)](/(\[[\s\S]*?\])/g);if(_0x37355a&&_0x37355a[_0x469306(0x106b)]>0x0)return JSON[_0x469306(0x1447)](_0x37355a[_0x37355a[_0x469306(0x106b)]-0x1]);return JSON[_0x469306(0x1447)](_0x2fcd77);}catch(_0x250f51){throw new Error(_0x469306(0x417)+_0x250f51[_0x469306(0xcce)]+'\x0a\x0aAI原始返回内容:\x0a'+_0x16b5db);}}catch(_0x57716b){console[_0x469306(0x3b7)](_0x469306(0x1287),_0x57716b);throw new Error('获取AI投票决策失败:\x20'+_0x57716b[_0x469306(0xcce)]);}}function _0x25778a(){const _0x1d814d=_0x48bc6d,_0x17ba69={},_0x8d5403={};for(const _0x1bd5ae in _0x480617[_0x1d814d(0xa71)]){const _0x180a3a=_0x480617['votes'][_0x1bd5ae];_0x17ba69[_0x180a3a]=(_0x17ba69[_0x180a3a]||0x0)+0x1,!_0x8d5403[_0x180a3a]&&(_0x8d5403[_0x180a3a]=[]),_0x8d5403[_0x180a3a][_0x1d814d(0x1c4)](_0x1bd5ae);}let _0x4ef9f9=0x0,_0x3365bd=[];for(const _0x6cef3 in _0x17ba69){const _0x2b2c42=_0x17ba69[_0x6cef3];if(_0x2b2c42>_0x4ef9f9)_0x4ef9f9=_0x2b2c42,_0x3365bd=[_0x6cef3];else _0x2b2c42===_0x4ef9f9&&_0x3365bd['push'](_0x6cef3);}_0x3740db(_0x1d814d(0x7db));for(const _0x11809d in _0x8d5403){_0x3740db(_0x11809d+'\x20('+_0x8d5403[_0x11809d]['length']+_0x1d814d(0x704)+_0x8d5403[_0x11809d]['join']('、\x20'));}if(_0x3365bd['length']===0x1&&_0x4ef9f9>0x0){const _0x299c1b=_0x480617[_0x1d814d(0xa6d)][_0x1d814d(0xd62)](_0x39c07c=>_0x39c07c[_0x1d814d(0x1561)]===_0x3365bd[0x0]);if(_0x299c1b){_0x299c1b[_0x1d814d(0x139d)]=![],_0x3740db(_0x299c1b['name']+_0x1d814d(0x425));if(_0x299c1b[_0x1d814d(0x11c1)]==='猎人'){}}}else _0x3740db('平票或无人投票，此轮无人出局。');_0x300c83();if(_0x55c919())return;_0x480617[_0x1d814d(0xc9e)]++,_0x5e8d06();}async function _0x44cbd7(){const _0x129a40=_0x48bc6d,{proxyUrl:_0x8df23e,apiKey:_0x33231c,model:_0x57b02d}=_0x19ddb8[_0x129a40(0xd22)];if(!_0x8df23e||!_0x33231c||!_0x57b02d)return null;const _0x319d11=_0x480617['players'][_0x129a40(0x1195)](_0x43641a=>_0x43641a['role']==='狼人'&&_0x43641a[_0x129a40(0x139d)]),_0x4878fa=_0x480617['players'][_0x129a40(0x1195)](_0x1b34c8=>_0x1b34c8[_0x129a40(0x139d)]&&_0x1b34c8[_0x129a40(0x11c1)]!=='狼人'),_0x1e49be=_0x129a40(0x74e)+_0x319d11[_0x129a40(0xb0a)](_0x5d292f=>_0x5d292f['name'])[_0x129a40(0x3b9)]('、\x20')+'\x0a-\x20**可以刀的玩家列表**:\x20'+_0x4878fa[_0x129a40(0xb0a)](_0x280adb=>_0x280adb[_0x129a40(0x1561)])[_0x129a40(0x3b9)]('、\x20')+_0x129a40(0x1b0)+_0x480617[_0x129a40(0x870)][_0x129a40(0xb0a)](_0x55538e=>_0x55538e['speaker']+':\x20'+_0x55538e[_0x129a40(0x4e3)])[_0x129a40(0x3b9)]('\x0a')+_0x129a40(0x133c);try{let _0x534d1a=_0x8df23e[_0x129a40(0x478)]('generativelanguage'),_0x6e3029=[{'role':_0x129a40(0x20d),'content':_0x129a40(0xc54)}],_0x39fbf8=_0x366263(_0x57b02d,_0x33231c,_0x1e49be,_0x6e3029);const _0x276420=_0x534d1a?await fetch(_0x39fbf8[_0x129a40(0x121f)],_0x39fbf8['data']):await fetch(_0x8df23e+_0x129a40(0x501),{'method':_0x129a40(0x12db),'headers':{'Content-Type':_0x129a40(0xb1f),'Authorization':_0x129a40(0x1265)+_0x33231c},'body':JSON['stringify']({'model':_0x57b02d,'messages':[{'role':_0x129a40(0xe10),'content':_0x1e49be},..._0x6e3029],'temperature':_0x19ddb8[_0x129a40(0x4c8)]['apiTemperature']||0.8})});if(!_0x276420['ok'])throw new Error((await _0x276420[_0x129a40(0xa5d)]())[_0x129a40(0x3b7)]['message']);const _0x39d999=await _0x276420[_0x129a40(0xa5d)](),_0x31975e=getGeminiResponseText(_0x39d999),_0x325bec=_0x31975e[_0x129a40(0x293)](/({[\s\S]*})/);if(!_0x325bec)throw new Error(_0x129a40(0x1029));const _0x456544=JSON[_0x129a40(0x1447)](_0x325bec[0x0]),_0x58047a=_0x480617[_0x129a40(0xa6d)][_0x129a40(0xd62)](_0x2b024c=>_0x2b024c[_0x129a40(0x1561)]===_0x456544[_0x129a40(0xc19)]);return _0x58047a?_0x58047a['id']:null;}catch(_0x4d675f){return console[_0x129a40(0x3b7)](_0x129a40(0xd61),_0x4d675f),_0x4878fa[Math['floor'](Math[_0x129a40(0xdcd)]()*_0x4878fa['length'])]['id'];}}function _0x5bf76f(_0x292891,_0x484326){return new Promise(_0x33bbbe=>{const _0x54b0c3=_0x1efc,_0x1ae683=document[_0x54b0c3(0x9a3)](_0x54b0c3(0x9b6)),_0x31ac52=document[_0x54b0c3(0x9a3)](_0x54b0c3(0x759)),_0x36f449=document[_0x54b0c3(0x9a3)](_0x54b0c3(0x691)),_0x2a91f3=document[_0x54b0c3(0x9a3)](_0x54b0c3(0x866)),_0x479974=document['getElementById']('witch-do-nothing-btn');_0x31ac52[_0x54b0c3(0xeb2)]='';const _0x1433f4=_0x2a91f3[_0x54b0c3(0x173)](!![]);_0x2a91f3[_0x54b0c3(0x5eb)][_0x54b0c3(0x15ab)](_0x1433f4,_0x2a91f3);const _0xde3752=_0x479974[_0x54b0c3(0x173)](!![]);_0x479974['parentNode']['replaceChild'](_0xde3752,_0x479974),_0x1433f4[_0x54b0c3(0x20f)][_0x54b0c3(0x115d)]=_0x54b0c3(0x10c8),_0x1433f4[_0x54b0c3(0x15d3)]=!![];let _0xcd5f71={'save':![],'poison':null},_0x3ec31e=null;if(_0x292891&&!_0x484326['antidoteUsed']){_0x36f449['textContent']=_0x54b0c3(0x3c4)+_0x292891[_0x54b0c3(0x1561)]+'\x20被刀了';const _0x48ada9=document['createElement'](_0x54b0c3(0xd38));_0x48ada9[_0x54b0c3(0x1487)]=_0x54b0c3(0x391),_0x48ada9[_0x54b0c3(0x766)]=_0x54b0c3(0x8b8),_0x48ada9[_0x54b0c3(0x20f)][_0x54b0c3(0x114f)]=_0x54b0c3(0xb9c),_0x48ada9[_0x54b0c3(0x4ce)]=()=>{const _0x3f2dbc=_0x54b0c3;_0xcd5f71[_0x3f2dbc(0x4d5)]=!![],_0x1ae683[_0x3f2dbc(0x4d8)][_0x3f2dbc(0x133d)](_0x3f2dbc(0xc09)),_0x33bbbe(_0xcd5f71);},_0x31ac52[_0x54b0c3(0x983)](_0x48ada9);}else _0x292891?_0x36f449['textContent']=_0x54b0c3(0x3c4)+_0x292891[_0x54b0c3(0x1561)]+'\x20被刀了\x20(你没有解药了)':_0x36f449[_0x54b0c3(0x766)]='昨晚是平安夜';if(!_0x484326[_0x54b0c3(0xcf0)]){const _0x4bb822=document[_0x54b0c3(0xe94)]('p');_0x4bb822['textContent']=_0x54b0c3(0x27b),_0x4bb822['style']['textAlign']=_0x54b0c3(0xd4f),_0x4bb822[_0x54b0c3(0x20f)][_0x54b0c3(0xeeb)]=_0x54b0c3(0xb9c),_0x31ac52[_0x54b0c3(0x983)](_0x4bb822);const _0x4e8766=_0x480617[_0x54b0c3(0xa6d)][_0x54b0c3(0x1195)](_0x354bc6=>_0x354bc6[_0x54b0c3(0x139d)]&&_0x354bc6['id']!==_0x292891?.['id']);_0x4e8766[_0x54b0c3(0x15c1)](_0x4ff117=>{const _0x583cbf=_0x54b0c3,_0x3c714b=document['createElement'](_0x583cbf(0x8ca));_0x3c714b['className']=_0x583cbf(0xcb2),_0x3c714b['dataset']['id']=_0x4ff117['id'],_0x3c714b['innerHTML']=_0x583cbf(0x887)+_0x4ff117['avatar']+_0x583cbf(0xbf5)+_0x4ff117[_0x583cbf(0x1561)]+_0x583cbf(0xeb1),_0x3c714b[_0x583cbf(0x4ce)]=()=>{const _0x2e78ad=_0x583cbf;_0x31ac52['querySelectorAll'](_0x2e78ad(0xa00))[_0x2e78ad(0x15c1)](_0x32dfa4=>_0x32dfa4[_0x2e78ad(0x4d8)][_0x2e78ad(0x133d)](_0x2e78ad(0x154b))),_0x3c714b[_0x2e78ad(0x4d8)]['add'](_0x2e78ad(0x154b)),_0x3ec31e=_0x4ff117['id'],_0x1433f4[_0x2e78ad(0x15d3)]=![];},_0x31ac52[_0x583cbf(0x983)](_0x3c714b);});}_0x1433f4[_0x54b0c3(0x4ce)]=()=>{const _0x2ffa2b=_0x54b0c3;_0x3ec31e&&(_0xcd5f71['poison']=_0x3ec31e,_0x1ae683[_0x2ffa2b(0x4d8)][_0x2ffa2b(0x133d)](_0x2ffa2b(0xc09)),_0x33bbbe(_0xcd5f71));},_0xde3752['onclick']=()=>{const _0x4840ba=_0x54b0c3;_0x1ae683['classList'][_0x4840ba(0x133d)](_0x4840ba(0xc09)),_0x33bbbe(_0xcd5f71);},_0x1ae683[_0x54b0c3(0x4d8)]['add'](_0x54b0c3(0xc09));});}async function _0x556943(){const _0x50c05d=_0x48bc6d,_0x8393d1=_0x480617['lastFailedAction'];if(!_0x8393d1)return;document[_0x50c05d(0x9a3)](_0x50c05d(0x27f))[_0x50c05d(0x20f)][_0x50c05d(0x115d)]=_0x50c05d(0x8e0),await _0x403a62(_0x50c05d(0x1395),_0x50c05d(0xc89)+_0x8393d1+_0x50c05d(0xf4d));switch(_0x8393d1){case _0x50c05d(0x1223):await _0x5e8d06();break;case _0x50c05d(0xcd3):await _0x5ddba7();break;case _0x50c05d(0x108b):await _0x49babf();break;}}function _0x55c919(){const _0x228bf0=_0x48bc6d,_0x220a21=_0x480617['players']['filter'](_0x27de07=>_0x27de07[_0x228bf0(0x139d)]),_0xfb0fa4=_0x220a21[_0x228bf0(0x1195)](_0x3b16ae=>_0x3b16ae[_0x228bf0(0x11c1)]==='狼人'),_0x27b4f7=_0x220a21['filter'](_0x45fe71=>[_0x228bf0(0x13d1),'女巫','猎人','守卫']['includes'](_0x45fe71['role'])),_0x2cd9a3=_0x220a21[_0x228bf0(0x1195)](_0x2efbd9=>_0x2efbd9[_0x228bf0(0x11c1)]==='平民');let _0x376837=null;if(_0xfb0fa4[_0x228bf0(0x106b)]===0x0)_0x376837='好人';else{if(_0xfb0fa4['length']>=_0x27b4f7[_0x228bf0(0x106b)]+_0x2cd9a3[_0x228bf0(0x106b)])_0x376837='狼人';else _0x480617[_0x228bf0(0x144f)]===_0x228bf0(0x595)?(_0x27b4f7[_0x228bf0(0x106b)]===0x0||_0x2cd9a3[_0x228bf0(0x106b)]===0x0)&&(_0x376837='狼人'):_0x27b4f7[_0x228bf0(0x106b)]===0x0&&_0x2cd9a3['length']===0x0&&(_0x376837='狼人');}if(_0x376837)return _0x6dcf04(_0x376837),!![];return![];}async function _0x3d21ff(){const _0x6ecdf7=_0x48bc6d,_0x1646a2=await _0x2c9509('确认操作',_0x6ecdf7(0x11d0),{'confirmText':_0x6ecdf7(0x60c)});if(!_0x1646a2)return;await _0x403a62(_0x6ecdf7(0x1395),_0x6ecdf7(0x1541));try{const _0x25f930=await _0x512070[_0x6ecdf7(0xb04)]['toArray']();let _0x55f027=0x0;for(const _0x2a7984 of _0x25f930){let _0x4cf4cb=![];!Array[_0x6ecdf7(0xb9b)](_0x2a7984[_0x6ecdf7(0x1f0)])&&(_0x2a7984[_0x6ecdf7(0x1f0)]=[],_0x4cf4cb=!![]),(typeof _0x2a7984['settings']!==_0x6ecdf7(0x12fe)||_0x2a7984[_0x6ecdf7(0x450)]===null)&&(_0x2a7984[_0x6ecdf7(0x450)]={},_0x4cf4cb=!![]),!_0x2a7984[_0x6ecdf7(0x136b)]&&!_0x2a7984[_0x6ecdf7(0x339)]&&(_0x2a7984[_0x6ecdf7(0x339)]=_0x2a7984[_0x6ecdf7(0x1561)],_0x4cf4cb=!![]),typeof _0x2a7984['unreadCount']===_0x6ecdf7(0x738)&&(_0x2a7984[_0x6ecdf7(0xe20)]=0x0,_0x4cf4cb=!![]),!Array[_0x6ecdf7(0xb9b)](_0x2a7984['longTermMemory'])&&(_0x2a7984[_0x6ecdf7(0x744)]=[],_0x4cf4cb=!![]),_0x4cf4cb&&(_0x55f027++,console[_0x6ecdf7(0xe4d)](_0x6ecdf7(0xd99)+_0x2a7984['name']+_0x6ecdf7(0x145c)+_0x2a7984['id']+')\x20的残缺数据。'),await _0x512070['chats'][_0x6ecdf7(0xd4d)](_0x2a7984)),_0x19ddb8[_0x6ecdf7(0xb04)][_0x2a7984['id']]=_0x2a7984;}_0x55f027>0x0?(await _0x403a62('修复完成！',_0x6ecdf7(0x20b)+_0x55f027+_0x6ecdf7(0xda4)),await _0xec8072()):await _0x403a62(_0x6ecdf7(0x153e),_0x6ecdf7(0x7d3));}catch(_0x252378){console[_0x6ecdf7(0x3b7)](_0x6ecdf7(0xb9f),_0x252378),await _0x403a62('操作失败',_0x6ecdf7(0x11c5)+_0x252378['message']);}}function _0x3335f4(_0x3f6e9e,_0x42f877=_0x48bc6d(0xe8f)){const _0x12147a=_0x48bc6d;if(_0x3f6e9e[_0x12147a(0xc86)](_0x12147a(0x1427)))return;const _0x2cdce0=document[_0x12147a(0xe94)](_0x12147a(0x8ca));_0x2cdce0[_0x12147a(0x1487)]='loader-container',_0x2cdce0['innerHTML']=_0x12147a(0x418),_0x42f877===_0x12147a(0x837)?_0x3f6e9e[_0x12147a(0x983)](_0x2cdce0):_0x3f6e9e['prepend'](_0x2cdce0);}function _0x38511a(_0x9f2043){const _0x3f7c72=_0x48bc6d,_0x1cb74a=_0x9f2043['querySelector'](_0x3f7c72(0x1427));_0x1cb74a&&_0x1cb74a[_0x3f7c72(0x133d)]();}async function _0x1710ca(){const _0x19bb2c=_0x48bc6d,_0x2cb668=document[_0x19bb2c(0x9a3)](_0x19bb2c(0xb59)),_0x300d47=document[_0x19bb2c(0x9a3)](_0x19bb2c(0x1151)),_0x51515a=document['getElementById']('select-all-world-books-for-clear');_0x300d47[_0x19bb2c(0xeb2)]='',_0x51515a[_0x19bb2c(0x944)]=![];const _0x1e97e7=await _0x512070[_0x19bb2c(0x8e4)][_0x19bb2c(0x591)]();_0x1e97e7[_0x19bb2c(0x106b)]===0x0?_0x300d47['innerHTML']=_0x19bb2c(0xb8e):_0x1e97e7['forEach'](_0x79d02d=>{const _0x35bfb4=_0x19bb2c,_0x3fc168=document[_0x35bfb4(0xe94)]('div');_0x3fc168['className']='clear-posts-item',_0x3fc168[_0x35bfb4(0xd8d)]['bookId']=_0x79d02d['id'],_0x3fc168[_0x35bfb4(0xeb2)]=_0x35bfb4(0x138c)+_0x79d02d[_0x35bfb4(0x1561)]+_0x35bfb4(0xff8),_0x300d47[_0x35bfb4(0x983)](_0x3fc168);}),_0x2cb668[_0x19bb2c(0x4d8)][_0x19bb2c(0xe05)](_0x19bb2c(0xc09));}async function _0x517f04(){const _0xb33645=_0x48bc6d,_0x4fb586=document['querySelectorAll']('#delete-world-books-list\x20.clear-posts-item.selected');if(_0x4fb586[_0xb33645(0x106b)]===0x0){alert(_0xb33645(0x18a));return;}const _0x2cc545=Array[_0xb33645(0x1311)](_0x4fb586)[_0xb33645(0xb0a)](_0x24dda7=>_0x24dda7[_0xb33645(0xd8d)][_0xb33645(0xf1b)]),_0x290ec2=await _0x2c9509(_0xb33645(0x451),_0xb33645(0x3c5)+_0x4fb586[_0xb33645(0x106b)]+'\x20本世界书，并解除它们与所有角色的关联。此操作【不可恢复】！',{'confirmButtonClass':_0xb33645(0xf5b),'confirmText':_0xb33645(0xd05)});if(!_0x290ec2)return;await _0x403a62('请稍候...',_0xb33645(0xa2f));try{await _0x512070['transaction']('rw',_0x512070[_0xb33645(0x8e4)],_0x512070['chats'],async()=>{const _0x303131=_0xb33645;await _0x512070[_0x303131(0x8e4)]['bulkDelete'](_0x2cc545);const _0x105b52=await _0x512070[_0x303131(0xb04)][_0x303131(0x591)]();for(const _0x13f2bb of _0x105b52){if(_0x13f2bb[_0x303131(0x450)]&&Array['isArray'](_0x13f2bb[_0x303131(0x450)]['linkedWorldBookIds'])){const _0x1e3925=_0x13f2bb[_0x303131(0x450)][_0x303131(0x9c4)][_0x303131(0x106b)];_0x13f2bb[_0x303131(0x450)][_0x303131(0x9c4)]=_0x13f2bb['settings']['linkedWorldBookIds'][_0x303131(0x1195)](_0x329596=>!_0x2cc545[_0x303131(0x478)](_0x329596)),_0x13f2bb['settings'][_0x303131(0x9c4)]['length']<_0x1e3925&&await _0x512070[_0x303131(0xb04)][_0x303131(0xd4d)](_0x13f2bb);}}}),_0x19ddb8[_0xb33645(0x8e4)]=_0x19ddb8[_0xb33645(0x8e4)][_0xb33645(0x1195)](_0x5afb7f=>!_0x2cc545['includes'](_0x5afb7f['id'])),document[_0xb33645(0x9a3)](_0xb33645(0xb59))['classList'][_0xb33645(0x133d)](_0xb33645(0xc09)),await _0x403a62(_0xb33645(0x784),_0x4fb586[_0xb33645(0x106b)]+_0xb33645(0x1426));}catch(_0x454417){console['error'](_0xb33645(0x12d9),_0x454417),await _0x403a62(_0xb33645(0x14bc),'操作失败:\x20'+_0x454417[_0xb33645(0xcce)]);}}function _0x209479(){const _0x157dd6=_0x48bc6d;if(!_0x19ddb8[_0x157dd6(0x859)])return;const _0x14fb90=_0x19ddb8[_0x157dd6(0x859)],_0x5a884a=document[_0x157dd6(0x9a3)](_0x157dd6(0x8f8)),_0x5ed4b3=document[_0x157dd6(0x9a3)](_0x157dd6(0xe51)),_0x2ca316=document[_0x157dd6(0x9a3)](_0x157dd6(0x196));let _0x90cf7b=_0x22137c[_0x14fb90];if(_0x90cf7b&&_0x90cf7b[_0x157dd6(0x1412)]){_0x90cf7b[_0x157dd6(0xe47)]&&_0x45e06a();_0x5a884a[_0x157dd6(0x20f)][_0x157dd6(0x115d)]=_0x157dd6(0x79c);return;}_0x3141db(_0x14fb90),_0x324c27(_0x14fb90),_0x5a884a[_0x157dd6(0x20f)]['display']=_0x157dd6(0x79c),_0x5ed4b3[_0x157dd6(0x4d8)]['remove'](_0x157dd6(0x956)),_0x2ca316[_0x157dd6(0x20f)][_0x157dd6(0x115d)]=_0x157dd6(0x8e0);const _0x12c538=document['getElementById'](_0x157dd6(0xae7)),_0x33f665=_0x5ed4b3[_0x157dd6(0x31d)](),_0x2ffc4c=(_0x12c538[_0x157dd6(0xa22)]-_0x33f665[_0x157dd6(0x397)])/0x2,_0x134bc8=(_0x12c538[_0x157dd6(0x89d)]-_0x33f665['width'])/0x2;_0x5ed4b3['style'][_0x157dd6(0xe8f)]=_0x2ffc4c+'px',_0x5ed4b3[_0x157dd6(0x20f)][_0x157dd6(0xb90)]=_0x134bc8+'px',_0x5ed4b3[_0x157dd6(0x20f)][_0x157dd6(0x352)]='';}function _0x3141db(_0x154728){const _0x466dfd=_0x48bc6d;_0x22137c[_0x154728]={'isActive':!![],'isMinimized':![],'title':_0x466dfd(0xbb5),'contentLines':[],'currentPage':0x0,'totalPages':0x0,'linesPerPage':0xf,'currentSnippet':''};}function _0x35ece3(){const _0x54e22d=_0x48bc6d,_0x555c41=_0x19ddb8[_0x54e22d(0x859)];if(!_0x555c41||!_0x22137c[_0x555c41]||!_0x22137c[_0x555c41][_0x54e22d(0x1412)])return;document['getElementById'](_0x54e22d(0x8f8))['style'][_0x54e22d(0x115d)]=_0x54e22d(0x8e0),document['getElementById']('reading-restore-btn')[_0x54e22d(0x20f)][_0x54e22d(0x115d)]=_0x54e22d(0x8e0),document[_0x54e22d(0x9a3)](_0x54e22d(0xe51))[_0x54e22d(0x4d8)][_0x54e22d(0x133d)](_0x54e22d(0x956)),_0x22137c[_0x555c41][_0x54e22d(0x1412)]=![],console['log'](_0x54e22d(0xc37));}function _0x54906c(){const _0x1e2a13=_0x48bc6d,_0x55bcb1=_0x22137c[_0x19ddb8[_0x1e2a13(0x859)]];if(!_0x55bcb1||!_0x55bcb1[_0x1e2a13(0x1412)]||_0x55bcb1[_0x1e2a13(0xe47)])return;_0x55bcb1[_0x1e2a13(0xe47)]=!![],document['getElementById']('reading-window')[_0x1e2a13(0x4d8)]['add']('minimized'),document[_0x1e2a13(0x9a3)](_0x1e2a13(0x196))[_0x1e2a13(0x20f)][_0x1e2a13(0x115d)]=_0x1e2a13(0x79c);}function _0x45e06a(){const _0x18219c=_0x48bc6d,_0x3ce5d5=_0x22137c[_0x19ddb8['activeChatId']];if(!_0x3ce5d5||!_0x3ce5d5['isActive']||!_0x3ce5d5[_0x18219c(0xe47)])return;_0x3ce5d5[_0x18219c(0xe47)]=![],document[_0x18219c(0x9a3)](_0x18219c(0x196))[_0x18219c(0x20f)]['display']='none',document[_0x18219c(0x9a3)](_0x18219c(0xe51))['classList'][_0x18219c(0x133d)]('minimized');}function _0x29a968(_0x5d20e5,_0x388e58){const _0x2fc100=_0x48bc6d;let _0x3dbb0d=0x0,_0x5d2d30=0x0,_0x1cbb4c=0x0,_0x1dfcc0=0x0;const _0x261171=document[_0x2fc100(0x9a3)](_0x2fc100(0xae7)),_0x28d6b0=_0xf6dbfa=>{const _0x70b5f8=_0x2fc100;if(_0xf6dbfa[_0x70b5f8(0xa41)][_0x70b5f8(0x94c)]('button'))return;if(_0x5d20e5['style'][_0x70b5f8(0x352)]){const _0x2b8013=_0x5d20e5[_0x70b5f8(0x31d)](),_0x41557a=_0x5d20e5[_0x70b5f8(0x193)][_0x70b5f8(0x31d)]();_0x5d20e5[_0x70b5f8(0x20f)][_0x70b5f8(0xe8f)]=_0x2b8013['top']-_0x41557a[_0x70b5f8(0xe8f)]+'px',_0x5d20e5[_0x70b5f8(0x20f)][_0x70b5f8(0xb90)]=_0x2b8013[_0x70b5f8(0xb90)]-_0x41557a['left']+'px',_0x5d20e5[_0x70b5f8(0x20f)]['transform']='';}_0xf6dbfa[_0x70b5f8(0x28d)]();const _0x553ff3=_0xf6dbfa[_0x70b5f8(0x1508)]==='touchstart'?_0xf6dbfa['touches'][0x0]:_0xf6dbfa;_0x1cbb4c=_0x553ff3['clientX'],_0x1dfcc0=_0x553ff3[_0x70b5f8(0x1118)],document['addEventListener'](_0x70b5f8(0x11e4),_0x5a3c26),document[_0x70b5f8(0x954)](_0x70b5f8(0x61c),_0x8aceea),document['addEventListener']('touchend',_0x5a3c26),document[_0x70b5f8(0x954)](_0x70b5f8(0x1294),_0x8aceea);},_0x8aceea=_0x57110c=>{const _0x53f93b=_0x2fc100,_0x2751a5=_0x57110c[_0x53f93b(0x1508)]===_0x53f93b(0x1294)?_0x57110c[_0x53f93b(0x12da)][0x0]:_0x57110c;_0x3dbb0d=_0x1cbb4c-_0x2751a5[_0x53f93b(0x11e8)],_0x5d2d30=_0x1dfcc0-_0x2751a5['clientY'],_0x1cbb4c=_0x2751a5[_0x53f93b(0x11e8)],_0x1dfcc0=_0x2751a5[_0x53f93b(0x1118)];let _0x5a31b1=_0x5d20e5[_0x53f93b(0x1076)]-_0x5d2d30,_0x3bbe35=_0x5d20e5['offsetLeft']-_0x3dbb0d;const _0x294112=_0x261171[_0x53f93b(0xa22)]-_0x5d20e5[_0x53f93b(0x1206)]-0xa,_0x492f75=_0x261171[_0x53f93b(0x89d)]-_0x5d20e5[_0x53f93b(0xa75)]-0xa;_0x5a31b1=Math[_0x53f93b(0x812)](0xa,Math[_0x53f93b(0xbf8)](_0x5a31b1,_0x294112)),_0x3bbe35=Math[_0x53f93b(0x812)](0xa,Math['min'](_0x3bbe35,_0x492f75)),_0x5d20e5[_0x53f93b(0x20f)]['top']=_0x5a31b1+'px',_0x5d20e5[_0x53f93b(0x20f)][_0x53f93b(0xb90)]=_0x3bbe35+'px';},_0x5a3c26=()=>{const _0x3ff4df=_0x2fc100;document['removeEventListener'](_0x3ff4df(0x11e4),_0x5a3c26),document['removeEventListener'](_0x3ff4df(0x61c),_0x8aceea),document[_0x3ff4df(0xd7f)]('touchend',_0x5a3c26),document[_0x3ff4df(0xd7f)](_0x3ff4df(0x1294),_0x8aceea);};_0x388e58[_0x2fc100(0x954)](_0x2fc100(0x81d),_0x28d6b0),_0x388e58[_0x2fc100(0x954)](_0x2fc100(0xfab),_0x28d6b0);}function _0x324c27(_0x1995b5){const _0x469f9c=_0x48bc6d,_0x9bcc94=_0x22137c[_0x1995b5];if(!_0x9bcc94)return;const _0x5b6f69=document[_0x469f9c(0x9a3)](_0x469f9c(0xd32)),_0x44c1b4=document[_0x469f9c(0x9a3)](_0x469f9c(0x1342)),_0x3dd689=document['getElementById'](_0x469f9c(0x1289)),_0x3fc783=document[_0x469f9c(0x9a3)](_0x469f9c(0x8f3)),_0x21470e=document[_0x469f9c(0x9a3)](_0x469f9c(0xb83));_0x5b6f69[_0x469f9c(0x766)]=_0x9bcc94['title'];if(_0x9bcc94[_0x469f9c(0x130a)]['length']===0x0)_0x44c1b4[_0x469f9c(0xeb2)]='<p>点击“导入”按钮，<br>从本地.txt文件或网络URL加载书籍内容。</p>',_0x9bcc94['totalPages']=0x0,_0x9bcc94[_0x469f9c(0x64e)]=0x0;else{const _0x1cb836=_0x9bcc94['currentPage']*_0x9bcc94[_0x469f9c(0x864)],_0x3fb81b=_0x1cb836+_0x9bcc94[_0x469f9c(0x864)];_0x44c1b4[_0x469f9c(0x766)]=_0x9bcc94[_0x469f9c(0x130a)][_0x469f9c(0x457)](_0x1cb836,_0x3fb81b)[_0x469f9c(0x3b9)]('\x0a');}_0x3dd689['textContent']=_0x9bcc94[_0x469f9c(0x64e)]+0x1+_0x469f9c(0x14e4)+_0x9bcc94[_0x469f9c(0x1368)],_0x3fc783[_0x469f9c(0x15d3)]=_0x9bcc94[_0x469f9c(0x64e)]===0x0,_0x21470e['disabled']=_0x9bcc94[_0x469f9c(0x64e)]>=_0x9bcc94['totalPages']-0x1;}function _0x319f9b(){const _0x4b4c1c=_0x48bc6d,_0x5d1847=_0x22137c[_0x19ddb8[_0x4b4c1c(0x859)]];_0x5d1847&&_0x5d1847[_0x4b4c1c(0x64e)]<_0x5d1847[_0x4b4c1c(0x1368)]-0x1&&(_0x5d1847[_0x4b4c1c(0x64e)]++,_0x324c27(_0x19ddb8[_0x4b4c1c(0x859)]),document[_0x4b4c1c(0x9a3)](_0x4b4c1c(0x1342))[_0x4b4c1c(0x85c)]=0x0,_0x11c955(_0x5d1847[_0x4b4c1c(0x2d5)],_0x5d1847[_0x4b4c1c(0x64e)]));}async function _0x4567e7(){const _0x5d067a=_0x48bc6d,_0x50b6cb=_0x22137c[_0x19ddb8[_0x5d067a(0x859)]];_0x50b6cb&&_0x50b6cb[_0x5d067a(0x64e)]>0x0&&(_0x50b6cb['currentPage']--,_0x324c27(_0x19ddb8[_0x5d067a(0x859)]),document[_0x5d067a(0x9a3)](_0x5d067a(0x1342))[_0x5d067a(0x85c)]=0x0,await _0x11c955(_0x50b6cb[_0x5d067a(0x2d5)],_0x50b6cb['currentPage']),await notifyAiOfPageTurn(_0x19ddb8['activeChatId'],_0x50b6cb));}function _0x166d73(){const _0x144be3=_0x48bc6d;document[_0x144be3(0x9a3)](_0x144be3(0x499))[_0x144be3(0x9cc)]();}async function _0x5631ba(_0x5964b8){const _0x271437=_0x48bc6d,_0x22810e=new Uint8Array(_0x5964b8);if(_0x22810e[_0x271437(0x106b)]>=0x3&&_0x22810e[0x0]===0xef&&_0x22810e[0x1]===0xbb&&_0x22810e[0x2]===0xbf)return console[_0x271437(0xe4d)](_0x271437(0x1055)),new TextDecoder('utf-8')['decode'](_0x22810e);if(_0x22810e[_0x271437(0x106b)]>=0x2&&_0x22810e[0x0]===0xff&&_0x22810e[0x1]===0xfe)return console[_0x271437(0xe4d)](_0x271437(0x1553)),new TextDecoder(_0x271437(0x108e))['decode'](_0x22810e);if(_0x22810e[_0x271437(0x106b)]>=0x2&&_0x22810e[0x0]===0xfe&&_0x22810e[0x1]===0xff)return console['log']('检测到\x20UTF-16\x20BE\x20BOM，使用\x20UTF-16\x20BE\x20解码。'),new TextDecoder(_0x271437(0x839))[_0x271437(0xad2)](_0x22810e);try{console[_0x271437(0xe4d)](_0x271437(0x1444));const _0x2bd3c6=new TextDecoder(_0x271437(0x93d),{'fatal':!![]})[_0x271437(0xad2)](_0x22810e);return console[_0x271437(0xe4d)](_0x271437(0x2cc)),_0x2bd3c6;}catch(_0x5cdc07){console[_0x271437(0xe4d)](_0x271437(0xd1d));try{const _0x44ec63=new TextDecoder(_0x271437(0x11be))[_0x271437(0xad2)](_0x22810e);return console['log'](_0x271437(0x2b8)),_0x44ec63;}catch(_0x1ee01e){console[_0x271437(0x3b7)](_0x271437(0x7ed),_0x1ee01e);throw new Error(_0x271437(0xa3e));}}}async function _0x1e6992(_0x3a42c6){const _0x3f31ea=_0x48bc6d,_0x14e764=_0x3a42c6[_0x3f31ea(0xa41)]['files'][0x0];if(!_0x14e764)return;try{const _0x408534=await _0x14e764['arrayBuffer'](),_0xae39ac=await _0x5631ba(_0x408534),_0x5638f9=_0x14e764[_0x3f31ea(0x1561)][_0x3f31ea(0x1bb)](/\.txt$/i,''),_0x60b366=await _0x512070['readingLibrary'][_0x3f31ea(0xe05)]({'title':_0x5638f9,'content':_0xae39ac,'lastOpened':Date[_0x3f31ea(0x64b)]()});await _0x118b2b(_0x60b366),document[_0x3f31ea(0x9a3)](_0x3f31ea(0x740))[_0x3f31ea(0x4d8)][_0x3f31ea(0x1222)](_0x3f31ea(0xc09))&&_0x55932b();}catch(_0x2377de){console[_0x3f31ea(0x3b7)]('导入书籍失败:',_0x2377de),await _0x403a62('导入失败',_0x2377de[_0x3f31ea(0xcce)]);}finally{_0x3a42c6[_0x3f31ea(0xa41)][_0x3f31ea(0x7b2)]=null;}}async function _0x1a22fb(){const _0x2b1d3a=_0x48bc6d,_0x4855e7=_0x19ddb8['activeChatId'];if(!_0x4855e7)return;const _0x296fb8=_0x22137c[_0x4855e7];if(!_0x296fb8||_0x296fb8[_0x2b1d3a(0x1368)]<=0x1)return;const _0x1b1861=await _0x3ab788(_0x2b1d3a(0x13b0),_0x2b1d3a(0x640)+_0x296fb8[_0x2b1d3a(0x1368)]+')',_0x296fb8['currentPage']+0x1);if(_0x1b1861===null)return;const _0x4aedfd=parseInt(_0x1b1861);if(isNaN(_0x4aedfd)||_0x4aedfd<0x1||_0x4aedfd>_0x296fb8['totalPages']){alert(_0x2b1d3a(0x1a3));return;}_0x296fb8[_0x2b1d3a(0x64e)]=_0x4aedfd-0x1,_0x324c27(_0x4855e7),_0x11c955(_0x296fb8[_0x2b1d3a(0x2d5)],_0x296fb8[_0x2b1d3a(0x64e)]);}async function _0x11c955(_0x32b5ac,_0x18c696){const _0x8cffaf=_0x48bc6d;if(!_0x32b5ac)return;try{await _0x512070[_0x8cffaf(0x394)][_0x8cffaf(0xe33)](_0x32b5ac,{'currentPage':_0x18c696});}catch(_0x444a18){console['error'](_0x8cffaf(0xc18)+_0x32b5ac+')的阅读进度失败:',_0x444a18);}}async function _0x319f9b(){const _0x4d1509=_0x48bc6d,_0x2adc0f=_0x22137c[_0x19ddb8[_0x4d1509(0x859)]];_0x2adc0f&&_0x2adc0f[_0x4d1509(0x64e)]<_0x2adc0f[_0x4d1509(0x1368)]-0x1&&(_0x2adc0f[_0x4d1509(0x64e)]++,_0x324c27(_0x19ddb8[_0x4d1509(0x859)]),document[_0x4d1509(0x9a3)](_0x4d1509(0x1342))['scrollTop']=0x0,await _0x11c955(_0x2adc0f[_0x4d1509(0x2d5)],_0x2adc0f[_0x4d1509(0x64e)]),await notifyAiOfPageTurn(_0x19ddb8[_0x4d1509(0x859)],_0x2adc0f));}function _0x2d981e(_0x539b47,_0x416e1b){const _0x3e38be=_0x48bc6d,_0x3db3f9=_0x19ddb8[_0x3e38be(0x859)];if(!_0x3db3f9)return;const _0x8819a4=_0x22137c[_0x3db3f9];_0x8819a4['title']=_0x539b47[_0x3e38be(0x1bb)](/\.txt$/i,''),_0x8819a4[_0x3e38be(0x130a)]=_0x416e1b[_0x3e38be(0x1536)](/\r\n?|\n/)['map'](_0xc5da68=>_0xc5da68['replace'](/ +/g,'\x20')),_0x8819a4[_0x3e38be(0x1368)]=Math['ceil'](_0x8819a4[_0x3e38be(0x130a)][_0x3e38be(0x106b)]/_0x8819a4[_0x3e38be(0x864)]),_0x8819a4[_0x3e38be(0x64e)]=0x0,_0x324c27(_0x3db3f9);}async function _0x5a3d05(){const _0xc140d8=_0x48bc6d;document['getElementById'](_0xc140d8(0xbc5))[_0xc140d8(0x7b2)]='',await _0x55932b(),document['getElementById'](_0xc140d8(0x740))[_0xc140d8(0x4d8)][_0xc140d8(0xe05)](_0xc140d8(0xc09));}async function _0x55932b(_0x2da841=''){const _0x2d1b74=_0x48bc6d,_0x366f2e=document[_0x2d1b74(0x9a3)](_0x2d1b74(0x5d8));let _0x30c3cc=await _0x512070[_0x2d1b74(0x394)][_0x2d1b74(0x1404)]('lastOpened')[_0x2d1b74(0x333)]()[_0x2d1b74(0x591)]();_0x366f2e[_0x2d1b74(0xeb2)]='';_0x2da841&&(_0x30c3cc=_0x30c3cc[_0x2d1b74(0x1195)](_0x1d948c=>_0x1d948c[_0x2d1b74(0x10b8)][_0x2d1b74(0x905)]()[_0x2d1b74(0x478)](_0x2da841[_0x2d1b74(0x905)]())));if(_0x30c3cc[_0x2d1b74(0x106b)]===0x0){const _0x938b0=_0x2da841?_0x2d1b74(0x1037):_0x2d1b74(0x301);_0x366f2e[_0x2d1b74(0xeb2)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>'+_0x938b0+'</p>';return;}_0x30c3cc['forEach'](_0x47bfab=>{const _0x471390=_0x2d1b74,_0x4b9f5e=document['createElement'](_0x471390(0x8ca));_0x4b9f5e[_0x471390(0x1487)]=_0x471390(0x3bb),_0x4b9f5e[_0x471390(0xeb2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22\x20style=\x22cursor:pointer;\x22\x20data-book-id=\x22'+_0x47bfab['id']+'\x22>'+_0x47bfab[_0x471390(0x10b8)]+_0x471390(0xb70)+_0x47bfab['id']+_0x471390(0x1183),_0x366f2e[_0x471390(0x983)](_0x4b9f5e);});}async function _0x118b2b(_0x176970){const _0x48bf9f=_0x48bc6d,_0x17c0e8=_0x19ddb8[_0x48bf9f(0x859)];if(!_0x17c0e8)return;const _0x398899=await _0x512070[_0x48bf9f(0x394)][_0x48bf9f(0x14ee)](_0x176970);if(!_0x398899){alert(_0x48bf9f(0xf48));return;}await _0x512070[_0x48bf9f(0x394)]['update'](_0x176970,{'lastOpened':Date[_0x48bf9f(0x64b)]()});const _0x536763=_0x22137c[_0x17c0e8];_0x536763['activeBookId']=_0x176970,_0x536763[_0x48bf9f(0x10b8)]=_0x398899[_0x48bf9f(0x10b8)],_0x536763['contentLines']=_0x398899[_0x48bf9f(0x4e3)]['split'](/\r\n?|\n/)[_0x48bf9f(0xb0a)](_0x5d8330=>_0x5d8330[_0x48bf9f(0x1bb)](/ +/g,'\x20')),_0x536763[_0x48bf9f(0x1368)]=Math[_0x48bf9f(0x101a)](_0x536763[_0x48bf9f(0x130a)][_0x48bf9f(0x106b)]/_0x536763[_0x48bf9f(0x864)]),_0x536763[_0x48bf9f(0x64e)]=_0x398899[_0x48bf9f(0x64e)]||0x0,_0x324c27(_0x17c0e8),document[_0x48bf9f(0x9a3)](_0x48bf9f(0x1342))[_0x48bf9f(0x85c)]=0x0,document[_0x48bf9f(0x9a3)](_0x48bf9f(0x740))[_0x48bf9f(0x4d8)][_0x48bf9f(0x133d)](_0x48bf9f(0xc09));}async function _0x4fc515(_0x2aa5ed){const _0x47307a=_0x48bc6d,_0x4ff488=await _0x512070[_0x47307a(0x394)][_0x47307a(0x14ee)](_0x2aa5ed);if(!_0x4ff488)return;const _0x537d01=await _0x2c9509(_0x47307a(0xb97),'确定要删除《'+_0x4ff488[_0x47307a(0x10b8)]+_0x47307a(0xb14),{'confirmButtonClass':_0x47307a(0xf5b)});_0x537d01&&(await _0x512070[_0x47307a(0x394)][_0x47307a(0x10a8)](_0x2aa5ed),await _0x55932b());}function _0x2d981e(_0x35feab,_0x2e38f1){const _0x306659=_0x48bc6d,_0x1e32da=_0x19ddb8[_0x306659(0x859)];if(!_0x1e32da)return;const _0x30dc7e=_0x22137c[_0x1e32da];_0x30dc7e[_0x306659(0x10b8)]=_0x35feab['replace'](/\.txt$/i,''),_0x30dc7e[_0x306659(0x130a)]=_0x2e38f1[_0x306659(0x1536)](/\r\n?|\n/),_0x30dc7e[_0x306659(0x1368)]=Math[_0x306659(0x101a)](_0x30dc7e[_0x306659(0x130a)][_0x306659(0x106b)]/_0x30dc7e[_0x306659(0x864)]),_0x30dc7e['currentPage']=0x0,_0x324c27(_0x1e32da);}function _0x29a968(_0x3c4fe5,_0x5ae3b5){const _0x2d5df2=_0x48bc6d;let _0x533bc2=0x0,_0x2c910c=0x0,_0x5f2057=0x0,_0x3fb62d=0x0,_0x312fa3=![],_0x5a4d1b=![];const _0x305834=document[_0x2d5df2(0x9a3)](_0x2d5df2(0xae7)),_0x230ff7=_0x1dd00e=>{const _0x3fdf4c=_0x2d5df2;if(_0x3c4fe5!==_0x5ae3b5&&_0x1dd00e[_0x3fdf4c(0xa41)][_0x3fdf4c(0x94c)]('button'))return;_0x312fa3=!![],_0x5a4d1b=![];const _0xa3bcb7=_0x1dd00e[_0x3fdf4c(0x1508)]===_0x3fdf4c(0xfab)?_0x1dd00e[_0x3fdf4c(0x12da)][0x0]:_0x1dd00e;_0x5f2057=_0xa3bcb7[_0x3fdf4c(0x11e8)],_0x3fb62d=_0xa3bcb7['clientY'],_0x3c4fe5['style'][_0x3fdf4c(0xe8f)]=_0x3c4fe5[_0x3fdf4c(0x1076)]+'px',_0x3c4fe5[_0x3fdf4c(0x20f)]['left']=_0x3c4fe5['offsetLeft']+'px',_0x3c4fe5[_0x3fdf4c(0x20f)][_0x3fdf4c(0x352)]='',document[_0x3fdf4c(0x954)](_0x3fdf4c(0x11e4),_0x3fa71a),document[_0x3fdf4c(0x954)](_0x3fdf4c(0x61c),_0x44f045),document[_0x3fdf4c(0x954)](_0x3fdf4c(0x36c),_0x3fa71a),document['addEventListener'](_0x3fdf4c(0x1294),_0x44f045,{'passive':![]});},_0x44f045=_0x5370a2=>{const _0xd5756e=_0x2d5df2;if(!_0x312fa3)return;const _0x479ed8=_0x5370a2[_0xd5756e(0x1508)]===_0xd5756e(0x1294)?_0x5370a2[_0xd5756e(0x12da)][0x0]:_0x5370a2,_0x440657=_0x479ed8[_0xd5756e(0x11e8)]-_0x5f2057,_0x157a4a=_0x479ed8[_0xd5756e(0x1118)]-_0x3fb62d;!_0x5a4d1b&&(Math[_0xd5756e(0xc7c)](_0x440657)>0x5||Math[_0xd5756e(0xc7c)](_0x157a4a)>0x5)&&(_0x5a4d1b=!![]);_0x5a4d1b&&_0x5370a2[_0xd5756e(0xbcd)]&&_0x5370a2['preventDefault']();_0x533bc2=_0x5f2057-_0x479ed8[_0xd5756e(0x11e8)],_0x2c910c=_0x3fb62d-_0x479ed8[_0xd5756e(0x1118)],_0x5f2057=_0x479ed8['clientX'],_0x3fb62d=_0x479ed8[_0xd5756e(0x1118)];let _0x4966f7=_0x3c4fe5[_0xd5756e(0x1076)]-_0x2c910c,_0xab18d1=_0x3c4fe5[_0xd5756e(0x10e4)]-_0x533bc2;const _0x34af53=_0x305834['clientHeight']-_0x3c4fe5[_0xd5756e(0x1206)]-0xa,_0x44d41a=_0x305834['clientWidth']-_0x3c4fe5[_0xd5756e(0xa75)]-0xa;_0x4966f7=Math['max'](0xa,Math[_0xd5756e(0xbf8)](_0x4966f7,_0x34af53)),_0xab18d1=Math[_0xd5756e(0x812)](0xa,Math[_0xd5756e(0xbf8)](_0xab18d1,_0x44d41a)),_0x3c4fe5[_0xd5756e(0x20f)][_0xd5756e(0xe8f)]=_0x4966f7+'px',_0x3c4fe5[_0xd5756e(0x20f)][_0xd5756e(0xb90)]=_0xab18d1+'px';},_0x3fa71a=()=>{const _0x13e0a9=_0x2d5df2;document['removeEventListener'](_0x13e0a9(0x11e4),_0x3fa71a),document[_0x13e0a9(0xd7f)](_0x13e0a9(0x61c),_0x44f045),document[_0x13e0a9(0xd7f)](_0x13e0a9(0x36c),_0x3fa71a),document[_0x13e0a9(0xd7f)](_0x13e0a9(0x1294),_0x44f045);if(!_0x312fa3)return;_0x312fa3=![],!_0x5a4d1b&&_0x3c4fe5[_0x13e0a9(0x9cc)]();};_0x5ae3b5[_0x2d5df2(0x954)](_0x2d5df2(0x81d),_0x230ff7),_0x5ae3b5[_0x2d5df2(0x954)](_0x2d5df2(0xfab),_0x230ff7,{'passive':![]});}function _0x54906c(){const _0x197457=_0x48bc6d,_0x4c8a4d=_0x22137c[_0x19ddb8[_0x197457(0x859)]];if(!_0x4c8a4d||!_0x4c8a4d['isActive'])return;document[_0x197457(0x9a3)]('reading-window')[_0x197457(0x4d8)][_0x197457(0xe05)](_0x197457(0x956)),document[_0x197457(0x9a3)](_0x197457(0x196))[_0x197457(0x20f)][_0x197457(0x115d)]=_0x197457(0x79c),_0x4c8a4d[_0x197457(0xe47)]=!![];}function _0x45e06a(){const _0x33b14a=_0x48bc6d,_0x48b789=_0x22137c[_0x19ddb8[_0x33b14a(0x859)]];if(!_0x48b789||!_0x48b789[_0x33b14a(0x1412)])return;document[_0x33b14a(0x9a3)](_0x33b14a(0x196))['style'][_0x33b14a(0x115d)]=_0x33b14a(0x8e0),document[_0x33b14a(0x9a3)](_0x33b14a(0xe51))[_0x33b14a(0x4d8)][_0x33b14a(0x133d)](_0x33b14a(0x956)),_0x48b789['isMinimized']=![];}function _0x3dbeec(_0x1ff979,_0x3e4b90){let _0x5420ea;return function(..._0x8f2316){const _0x3d5f0b=_0x1efc,_0x36f11b=this;clearTimeout(_0x5420ea),_0x5420ea=setTimeout(()=>_0x1ff979[_0x3d5f0b(0x12d3)](_0x36f11b,_0x8f2316),_0x3e4b90);};}function _0x449f61(_0x55d22f){const _0x387969=_0x48bc6d,_0x3cd2c1=_0x22137c[_0x55d22f];if(!_0x3cd2c1||!_0x3cd2c1[_0x387969(0x1412)])return'';const _0x5c320f=_0x3cd2c1[_0x387969(0x10b8)]||_0x387969(0xd6c);let _0x509ad5='',_0xd3cb96='';if(_0x3cd2c1[_0x387969(0x1d8)]&&_0x3cd2c1[_0x387969(0x1d8)]['trim']())_0x509ad5=_0x3cd2c1[_0x387969(0x1d8)],_0xd3cb96='你正在阅读的段落';else{if(_0x3cd2c1[_0x387969(0x130a)][_0x387969(0x106b)]>0x0){const _0x1a5dae=_0x3cd2c1[_0x387969(0x64e)]*_0x3cd2c1[_0x387969(0x864)],_0x3215ce=_0x1a5dae+_0x3cd2c1['linesPerPage'];_0x509ad5=_0x3cd2c1[_0x387969(0x130a)]['slice'](_0x1a5dae,_0x3215ce)[_0x387969(0x3b9)]('\x0a')[_0x387969(0x72e)](0x0,0xc8),_0xd3cb96=_0x387969(0x5ac);}else _0x509ad5=_0x387969(0x11ba),_0xd3cb96='内容';}return _0x387969(0x1290)+_0x5c320f+_0x387969(0x227)+_0xd3cb96+'**:\x20\x22'+_0x509ad5+_0x387969(0x8c9)+(_0x19ddb8[_0x387969(0xb04)][_0x55d22f]?.[_0x387969(0x339)]||_0x387969(0x1098))+')，正在和用户一起【阅读和讨论】这本书。\x0a\x20\x20\x20\x202.\x20\x20**行为准则**:\x20你的回复【必须】是作为读者的【感想、评论、提问或联想】。你可以：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20分享你对当前段落的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20对书中的角色或情节发表评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20向用户提问，询问TA对内容的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20根据书本内容，联想到你自己的经历或记忆。\x0a\x20\x20\x20\x203.\x20\x20**严禁**:\x20你的回复【绝对禁止】使用书中角色的口吻和人称！【绝对禁止】扮演书中的任何角色！【绝对禁止】续写或模仿书中的情节！你必须时刻记住，你只是一个读者。\x20\x20\x20\x20\x0a';}function _0x540224(){const _0x2e7b7c=_0x48bc6d,_0x432169=_0x19ddb8[_0x2e7b7c(0x859)];if(!_0x432169||!_0x22137c[_0x432169])return;const _0x5df958=_0x22137c[_0x432169],_0x3a6ea7=document[_0x2e7b7c(0x9a3)](_0x2e7b7c(0x1342)),_0x45f1a0=_0x3a6ea7['scrollTop'],_0xf64ab0=_0x3a6ea7[_0x2e7b7c(0xa22)],_0x21cae8=_0x45f1a0+_0xf64ab0,_0x437b3e=0xf*1.8,_0x2cda28=Math[_0x2e7b7c(0xd95)](_0x45f1a0/_0x437b3e),_0xbb1bd8=Math[_0x2e7b7c(0x101a)](_0x21cae8/_0x437b3e),_0x1f105e=_0x5df958['currentPage']*_0x5df958[_0x2e7b7c(0x864)]+_0x2cda28,_0x373954=_0x5df958[_0x2e7b7c(0x64e)]*_0x5df958[_0x2e7b7c(0x864)]+_0xbb1bd8;if(_0x1f105e<0x0||_0x1f105e>=_0x5df958['contentLines'][_0x2e7b7c(0x106b)])return;const _0x2cce86=_0x5df958[_0x2e7b7c(0x130a)][_0x2e7b7c(0x457)](Math['max'](0x0,_0x1f105e),Math['min'](_0x5df958[_0x2e7b7c(0x130a)][_0x2e7b7c(0x106b)],_0x373954))[_0x2e7b7c(0x3b9)]('\x0a');_0x5df958['currentSnippet']=_0x2cce86;}function _0x590cab(){const _0x48604c=_0x48bc6d,_0x75fe34=document[_0x48604c(0x9a3)](_0x48604c(0x15c3));if(_0x75fe34){const _0xa6c94=_0x75fe34[_0x48604c(0x156e)]();_0xa6c94!==undefined&&_0xa6c94['then'](_0x548b4a=>{const _0x2e1b1c=_0x48604c;console[_0x2e1b1c(0xe4d)](_0x2e1b1c(0xc8a));})['catch'](_0x428ac9=>{const _0x1b41d1=_0x48604c;console[_0x1b41d1(0x651)]('无法自动播放静音音频（这在iOS首次加载时是正常现象）:',_0x428ac9);});}}function _0x10c9b2(){const _0x5538fc=_0x48bc6d,_0x5cd346=document[_0x5538fc(0x9a3)](_0x5538fc(0x15c3));_0x5cd346&&!_0x5cd346[_0x5538fc(0xac8)]&&(_0x5cd346[_0x5538fc(0x201)](),_0x5cd346[_0x5538fc(0x7d5)]=0x0,console[_0x5538fc(0xe4d)](_0x5538fc(0x12bb)));}async function _0x28cab8(_0x1ede2f){const _0x2893e=_0x48bc6d,_0x15dc5c=decodeURIComponent(_0x1ede2f[_0x2893e(0xd8d)]['text']),_0x22807a=_0x1ede2f[_0x2893e(0xd8d)][_0x2893e(0x3ae)],_0x36c852=_0x1ede2f[_0x2893e(0xc86)](_0x2893e(0x12b7)),_0x54c011=_0x1ede2f['querySelector'](_0x2893e(0xf14)),_0x58fc47=document[_0x2893e(0x9a3)](_0x2893e(0x112f));if(!_0x58fc47['paused']&&_0x58fc47[_0x2893e(0xd8d)][_0x2893e(0x470)]===_0x15dc5c&&_0x58fc47[_0x2893e(0xd8d)][_0x2893e(0x12f1)]===_0x22807a){_0x58fc47[_0x2893e(0x201)]();return;}_0x58fc47[_0x2893e(0x201)](),document[_0x2893e(0x131c)](_0x2893e(0x12b7))[_0x2893e(0x15c1)](_0x1927b5=>_0x1927b5[_0x2893e(0x766)]='▶');const _0x5e3330='tts_'+_0x22807a+'_'+_0x15dc5c;let _0x4af9c7=_0x19ddb8[_0x2893e(0x610)][_0x2893e(0x14ee)](_0x5e3330);if(_0x4af9c7){console['log'](_0x2893e(0x11ea)),await _0x3c7430(_0x4af9c7[_0x2893e(0x121f)],_0x4af9c7['type'],_0x15dc5c,_0x22807a,_0x1ede2f);return;}console[_0x2893e(0xe4d)](_0x2893e(0xdaa));if(_0x36c852)_0x36c852['style'][_0x2893e(0x115d)]=_0x2893e(0x8e0);_0x54c011[_0x2893e(0x20f)]['display']=_0x2893e(0x10c8);const {minimaxGroupId:_0x117252,minimaxApiKey:_0x4c90e3}=_0x19ddb8['apiConfig'];if(!_0x117252||!_0x4c90e3){await _0x403a62('配置错误',_0x2893e(0xf80)),_0x54c011[_0x2893e(0x20f)][_0x2893e(0x115d)]=_0x2893e(0x8e0);if(_0x36c852)_0x36c852[_0x2893e(0x20f)][_0x2893e(0x115d)]=_0x2893e(0x79c);return;}try{const _0xc3b26d=await fetch(_0x2893e(0x8e6)+_0x117252,{'method':_0x2893e(0x12db),'headers':{'Authorization':_0x2893e(0x1265)+_0x4c90e3,'Content-Type':'application/json'},'body':JSON[_0x2893e(0xe1e)]({'text':_0x15dc5c,'voice_id':_0x22807a,'model':_0x19ddb8['apiConfig'][_0x2893e(0x9cf)]||_0x2893e(0x1013),'speed':0x1,'vol':0x1,'pitch':0x0})});if(!_0xc3b26d['ok']){let _0x3e687e=_0x2893e(0x7c5)+_0xc3b26d['status'];try{const _0x5be552=await _0xc3b26d[_0x2893e(0xa5d)]();_0x3e687e=_0x5be552[_0x2893e(0xa2a)]?.[_0x2893e(0xc06)]||JSON[_0x2893e(0xe1e)](_0x5be552);}catch(_0x5a8dbf){_0x3e687e=await _0xc3b26d[_0x2893e(0x13ca)]();}throw new Error(_0x3e687e);}const _0x1b7514=await _0xc3b26d['blob'](),_0x3e30e6=URL['createObjectURL'](_0x1b7514);await _0x3c7430(_0x3e30e6,_0x1b7514[_0x2893e(0x1508)],_0x15dc5c,_0x22807a,_0x1ede2f);const _0x3e9297=new FileReader();_0x3e9297['onloadend']=function(){const _0x31f4f8=_0x2893e;_0x19ddb8[_0x31f4f8(0x610)][_0x31f4f8(0x1177)](_0x5e3330,{'url':_0x3e9297[_0x31f4f8(0x5c9)],'type':_0x1b7514['type']}),console[_0x31f4f8(0xe4d)]('TTS\x20音频已保存到缓存。');},_0x3e9297['readAsDataURL'](_0x1b7514);}catch(_0xa8dd8b){console['error']('Minimax\x20TTS\x20API\x20调用失败:',_0xa8dd8b),await _0x403a62('语音生成失败',_0x2893e(0xda1)+_0xa8dd8b[_0x2893e(0xcce)]);}finally{_0x54c011[_0x2893e(0x20f)]['display']='none';if(_0x36c852)_0x36c852['style'][_0x2893e(0x115d)]=_0x2893e(0x79c);}}function _0x3c7430(_0x31aa7a,_0x369e45,_0xb352ef,_0x17a9f3,_0x31ba4e){return new Promise((_0x49f4ef,_0x46af70)=>{const _0x3948f0=_0x1efc,_0x2c7370=document['getElementById'](_0x3948f0(0x112f));_0x2c7370[_0x3948f0(0x10d4)]=_0x31aa7a,_0x2c7370[_0x3948f0(0x1508)]=_0x369e45,_0x2c7370[_0x3948f0(0xd8d)]['currentText']=_0xb352ef,_0x2c7370[_0x3948f0(0xd8d)][_0x3948f0(0x12f1)]=_0x17a9f3;const _0x20b2c6=_0x2c7370[_0x3948f0(0x156e)]();_0x20b2c6!==undefined&&_0x20b2c6['then'](()=>{const _0x118dd3=_0x3948f0,_0x48877d=_0x31ba4e['querySelector']('.voice-play-btn');if(_0x48877d)_0x48877d[_0x118dd3(0x766)]='❚❚';_0x49f4ef();})[_0x3948f0(0x904)](_0x56d87f=>{const _0x46a5a3=_0x3948f0;console[_0x46a5a3(0x3b7)](_0x46a5a3(0x12a8),_0x56d87f),_0x46af70(_0x56d87f);}),_0x2c7370[_0x3948f0(0xbbb)]=()=>{const _0x465f5b=_0x3948f0,_0x204eab=_0x31ba4e[_0x465f5b(0xc86)](_0x465f5b(0x12b7));if(_0x204eab)_0x204eab[_0x465f5b(0x766)]='▶';},_0x2c7370[_0x3948f0(0x9c8)]=()=>{const _0x1f8811=_0x3948f0,_0x4397ba=_0x31ba4e[_0x1f8811(0xc86)](_0x1f8811(0x12b7));if(_0x4397ba)_0x4397ba[_0x1f8811(0x766)]='▶';};});}function _0x34ea56(_0x10bd67){const _0x3eb850=_0x48bc6d,_0x44e948=_0x10bd67[_0x3eb850(0x94c)](_0x3eb850(0x5c4));if(!_0x44e948)return;const _0x4a6b8e=_0x44e948[_0x3eb850(0xc86)]('.voice-transcript'),_0x247afd=decodeURIComponent(_0x10bd67[_0x3eb850(0xd8d)][_0x3eb850(0x13ca)]);_0x4a6b8e[_0x3eb850(0x20f)]['display']===_0x3eb850(0x10c8)?_0x4a6b8e[_0x3eb850(0x20f)][_0x3eb850(0x115d)]=_0x3eb850(0x8e0):(_0x4a6b8e['textContent']=_0x247afd,_0x4a6b8e[_0x3eb850(0x20f)][_0x3eb850(0x115d)]=_0x3eb850(0x10c8));}async function _0x57cd9e(){const _0x2b8a9a=_0x48bc6d;await _0x574d2d(),document[_0x2b8a9a(0x9a3)](_0x2b8a9a(0x11b1))[_0x2b8a9a(0x4d8)][_0x2b8a9a(0xe05)](_0x2b8a9a(0xc09));}async function _0x574d2d(){const _0x1a891e=_0x48bc6d,_0x319cfb=document[_0x1a891e(0x9a3)]('existing-product-categories-list'),_0x1e599c=await _0x512070[_0x1a891e(0x1312)][_0x1a891e(0x591)]();_0x319cfb[_0x1a891e(0xeb2)]='';if(_0x1e599c['length']===0x0){_0x319cfb[_0x1a891e(0xeb2)]=_0x1a891e(0x6ec);return;}_0x1e599c[_0x1a891e(0x15c1)](_0x561163=>{const _0x4ff52a=_0x1a891e,_0x2f47cc=document[_0x4ff52a(0xe94)](_0x4ff52a(0x8ca));_0x2f47cc[_0x4ff52a(0x1487)]=_0x4ff52a(0x3bb),_0x2f47cc[_0x4ff52a(0xeb2)]=_0x4ff52a(0xa17)+_0x561163[_0x4ff52a(0x1561)]+_0x4ff52a(0xeb9)+_0x561163['id']+_0x4ff52a(0x985),_0x319cfb[_0x4ff52a(0x983)](_0x2f47cc);});}async function _0x588a47(){const _0x22af14=_0x48bc6d,_0x439a04=document[_0x22af14(0x9a3)](_0x22af14(0x13c2)),_0x3a25ea=_0x439a04[_0x22af14(0x7b2)][_0x22af14(0x13f9)]();if(!_0x3a25ea)return alert(_0x22af14(0x1081));const _0x31fb66=await _0x512070[_0x22af14(0x1312)][_0x22af14(0x1201)]('name')[_0x22af14(0x5df)](_0x3a25ea)[_0x22af14(0x92c)]();if(_0x31fb66)return alert(_0x22af14(0xd10)+_0x3a25ea+_0x22af14(0x60a));await _0x512070[_0x22af14(0x1312)][_0x22af14(0xe05)]({'name':_0x3a25ea}),_0x439a04['value']='',await _0x574d2d();}async function _0x24d40e(_0x5e6f8c){const _0xb7386b=_0x48bc6d,_0x20eaf2=await _0x2c9509(_0xb7386b(0xd05),_0xb7386b(0x62a),{'confirmButtonClass':_0xb7386b(0xf5b)});_0x20eaf2&&(await _0x512070[_0xb7386b(0x1312)][_0xb7386b(0x10a8)](_0x5e6f8c),await _0x512070[_0xb7386b(0x376)][_0xb7386b(0x1201)]('categoryId')['equals'](_0x5e6f8c)[_0xb7386b(0x572)]({'categoryId':null}),await _0x574d2d());}function _0x5395a3(_0x321281={}){const _0x4e6ab5=_0x48bc6d,_0x39c8f6=document['getElementById'](_0x4e6ab5(0xe58)),_0x49c325=document[_0x4e6ab5(0xe94)](_0x4e6ab5(0x8ca));return _0x49c325[_0x4e6ab5(0x1487)]=_0x4e6ab5(0x2e6),_0x49c325[_0x4e6ab5(0xeb2)]=_0x4e6ab5(0x205)+(_0x321281[_0x4e6ab5(0x1561)]||'')+_0x4e6ab5(0x13e3)+(_0x321281[_0x4e6ab5(0x87b)]||'')+_0x4e6ab5(0x9eb)+(_0x321281[_0x4e6ab5(0xbfe)]||'https://i.postimg.cc/PqYp5T5M/image.png')+_0x4e6ab5(0x1332),_0x49c325[_0x4e6ab5(0xc86)](_0x4e6ab5(0xc45))[_0x4e6ab5(0x954)](_0x4e6ab5(0x9cc),()=>_0x49c325[_0x4e6ab5(0x133d)]()),_0x49c325[_0x4e6ab5(0xc86)](_0x4e6ab5(0x580))['addEventListener'](_0x4e6ab5(0x9cc),()=>{const _0x2b5d33=_0x4e6ab5;_0x49c325[_0x2b5d33(0xc86)](_0x2b5d33(0xb31))[_0x2b5d33(0x9cc)]();}),_0x49c325[_0x4e6ab5(0xc86)](_0x4e6ab5(0xb31))[_0x4e6ab5(0x954)](_0x4e6ab5(0xbbc),_0x17514c=>{const _0x49e6bd=_0x4e6ab5,_0x2adc75=_0x17514c[_0x49e6bd(0xa41)]['files'][0x0];if(_0x2adc75){const _0x64b405=new FileReader();_0x64b405[_0x49e6bd(0xdd7)]=_0x247d32=>{const _0x48301e=_0x49e6bd;_0x49c325[_0x48301e(0xc86)]('.variation-image-preview')[_0x48301e(0x10d4)]=_0x247d32[_0x48301e(0xa41)]['result'];},_0x64b405['readAsDataURL'](_0x2adc75);}}),_0x39c8f6['appendChild'](_0x49c325),_0x49c325;}async function _0x4c8216(_0x237c76){const _0x4b2c2a=_0x48bc6d,_0x23f9d3=await _0x512070['shoppingProducts'][_0x4b2c2a(0x14ee)](_0x237c76);if(!_0x23f9d3||!_0x23f9d3['variations']||_0x23f9d3[_0x4b2c2a(0x138d)][_0x4b2c2a(0x106b)]===0x0)return;const _0x19b529=document[_0x4b2c2a(0x9a3)]('variation-selection-modal');document[_0x4b2c2a(0x9a3)](_0x4b2c2a(0xc6f))[_0x4b2c2a(0x10d4)]=_0x23f9d3[_0x4b2c2a(0xbfe)],document[_0x4b2c2a(0x9a3)](_0x4b2c2a(0x860))[_0x4b2c2a(0x766)]=_0x23f9d3[_0x4b2c2a(0x1561)];const _0x4db6c4=document[_0x4b2c2a(0x9a3)](_0x4b2c2a(0xdb2));_0x4db6c4[_0x4b2c2a(0xeb2)]='',_0x23f9d3[_0x4b2c2a(0x138d)]['forEach']((_0x203c1f,_0x593234)=>{const _0x1284ce=_0x4b2c2a,_0x189f22=document[_0x1284ce(0xe94)](_0x1284ce(0x1b4));_0x189f22['type']='radio',_0x189f22['name']=_0x1284ce(0x61d),_0x189f22['id']=_0x1284ce(0x442)+_0x237c76+'-'+_0x593234,_0x189f22['value']=_0x593234,_0x189f22[_0x1284ce(0x20f)][_0x1284ce(0x115d)]=_0x1284ce(0x8e0);if(_0x593234===0x0)_0x189f22[_0x1284ce(0x944)]=!![];const _0x327e32=document[_0x1284ce(0xe94)](_0x1284ce(0x667));_0x327e32['htmlFor']=_0x1284ce(0x442)+_0x237c76+'-'+_0x593234,_0x327e32[_0x1284ce(0x766)]=_0x203c1f[_0x1284ce(0x1561)],_0x327e32[_0x1284ce(0x20f)][_0x1284ce(0x6c0)]=_0x1284ce(0xc84),_0x4db6c4[_0x1284ce(0x983)](_0x189f22),_0x4db6c4['appendChild'](_0x327e32);});const _0x5aa238=()=>{const _0x331bae=_0x4b2c2a,_0x37d4c5=_0x4db6c4['querySelector']('input[name=\x22variation-select\x22]:checked');_0x4db6c4['querySelectorAll'](_0x331bae(0x667))[_0x331bae(0x15c1)](_0x285f70=>{const _0x59cbfb=_0x331bae;_0x285f70[_0x59cbfb(0x20f)][_0x59cbfb(0x1305)]=_0x59cbfb(0xcf6),_0x285f70[_0x59cbfb(0x20f)]['color']=_0x59cbfb(0xd8f),_0x285f70[_0x59cbfb(0x20f)][_0x59cbfb(0x87e)]=_0x59cbfb(0x4af);});if(_0x37d4c5){const _0x2cc11b=_0x4db6c4[_0x331bae(0xc86)](_0x331bae(0x404)+_0x37d4c5['id']+'\x22]');_0x2cc11b[_0x331bae(0x20f)][_0x331bae(0x1305)]='var(--accent-color)',_0x2cc11b[_0x331bae(0x20f)]['color']=_0x331bae(0x157d),_0x2cc11b[_0x331bae(0x20f)][_0x331bae(0x87e)]=_0x331bae(0x14f0);const _0x1b843e=_0x23f9d3[_0x331bae(0x138d)][parseInt(_0x37d4c5[_0x331bae(0x7b2)])];document[_0x331bae(0x9a3)](_0x331bae(0x788))[_0x331bae(0x766)]='¥'+_0x1b843e[_0x331bae(0x87b)][_0x331bae(0x1322)](0x2),_0x1b843e[_0x331bae(0xbfe)]?document[_0x331bae(0x9a3)](_0x331bae(0xc6f))[_0x331bae(0x10d4)]=_0x1b843e['imageUrl']:document['getElementById'](_0x331bae(0xc6f))['src']=_0x23f9d3[_0x331bae(0xbfe)];}};_0x4db6c4[_0x4b2c2a(0x954)](_0x4b2c2a(0xbbc),_0x5aa238),_0x5aa238(),document[_0x4b2c2a(0x9a3)](_0x4b2c2a(0x890))[_0x4b2c2a(0x766)]='1';const _0x431d04=document['getElementById'](_0x4b2c2a(0x12e7)),_0xef7462=_0x431d04[_0x4b2c2a(0x173)](!![]);_0x431d04[_0x4b2c2a(0x5eb)][_0x4b2c2a(0x15ab)](_0xef7462,_0x431d04),_0xef7462[_0x4b2c2a(0x954)](_0x4b2c2a(0x9cc),async()=>{const _0x56f623=_0x4b2c2a,_0x125927=_0x4db6c4[_0x56f623(0xc86)](_0x56f623(0x9d4)),_0x5110bc=parseInt(document[_0x56f623(0x9a3)]('variation-quantity-display')[_0x56f623(0x766)]);if(_0x125927){const _0x22cbaa=_0x23f9d3['variations'][parseInt(_0x125927['value'])];await _0x48b0c5(_0x237c76,_0x5110bc,_0x22cbaa),_0x19b529[_0x56f623(0x4d8)][_0x56f623(0x133d)](_0x56f623(0xc09)),await _0x403a62('成功',_0x56f623(0xb34));}}),_0x19b529[_0x4b2c2a(0x4d8)][_0x4b2c2a(0xe05)](_0x4b2c2a(0xc09));}function _0x52fc91(){const _0x157c19=_0x48bc6d,_0x56173d=document[_0x157c19(0x9a3)](_0x157c19(0x32b));document[_0x157c19(0x9a3)](_0x157c19(0xdbc))['value']=_0x19ddb8[_0x157c19(0x4c8)][_0x157c19(0x6e7)]||0x3,document[_0x157c19(0x9a3)](_0x157c19(0x6d3))[_0x157c19(0x7b2)]=_0x19ddb8[_0x157c19(0x4c8)]['shoppingProductCount']||0x8,_0x56173d['classList'][_0x157c19(0xe05)](_0x157c19(0xc09));}async function _0x389ac8(){const _0x3840e8=_0x48bc6d,_0x2c7044=document[_0x3840e8(0x9a3)](_0x3840e8(0xdbc)),_0x4bc13e=document[_0x3840e8(0x9a3)](_0x3840e8(0x6d3)),_0x2336fd=parseInt(_0x2c7044['value']),_0x22ed41=parseInt(_0x4bc13e['value']);if(isNaN(_0x2336fd)||isNaN(_0x22ed41)||_0x2336fd<0x1||_0x22ed41<0x1){alert(_0x3840e8(0x11bc));return;}_0x19ddb8[_0x3840e8(0x4c8)]['shoppingCategoryCount']=_0x2336fd,_0x19ddb8['globalSettings'][_0x3840e8(0x3ab)]=_0x22ed41,await _0x512070[_0x3840e8(0x4c8)][_0x3840e8(0xd4d)](_0x19ddb8[_0x3840e8(0x4c8)]),document[_0x3840e8(0x9a3)](_0x3840e8(0x32b))[_0x3840e8(0x4d8)][_0x3840e8(0x133d)]('visible'),await _0x403a62(_0x3840e8(0x398),_0x3840e8(0x5ae));}async function _0x4cf0f4(){const _0x21dab5=_0x48bc6d;if(!_0x19ddb8[_0x21dab5(0x859)]){await _0x403a62(_0x21dab5(0x13bd),_0x21dab5(0xaca));return;}const _0x7cce84=_0x19ddb8['chats'][_0x19ddb8['activeChatId']],_0x423ad8=await _0x2c9509('为“'+_0x7cce84[_0x21dab5(0x1561)]+_0x21dab5(0x8af),_0x21dab5(0xb2c),{'confirmText':_0x21dab5(0x254)});if(!_0x423ad8)return;await _0x403a62(_0x21dab5(0x1395),'正在根据“'+_0x7cce84[_0x21dab5(0x1561)]+_0x21dab5(0x1152));const _0xb4eb87=_0x19ddb8['apiConfig']['secondaryProxyUrl']&&_0x19ddb8[_0x21dab5(0xd22)][_0x21dab5(0x278)]&&_0x19ddb8[_0x21dab5(0xd22)][_0x21dab5(0xa20)],{proxyUrl:_0x1d2709,apiKey:_0x1b4353,model:_0x3a1aba}=_0xb4eb87?{'proxyUrl':_0x19ddb8[_0x21dab5(0xd22)]['secondaryProxyUrl'],'apiKey':_0x19ddb8[_0x21dab5(0xd22)][_0x21dab5(0x278)],'model':_0x19ddb8[_0x21dab5(0xd22)][_0x21dab5(0xa20)]}:_0x19ddb8['apiConfig'];if(!_0x1d2709||!_0x1b4353||!_0x3a1aba){await _0x403a62(_0x21dab5(0x115e),'请先在API设置中配置好（主或副）API。');return;}const _0x1466d0=_0x19ddb8['globalSettings'][_0x21dab5(0x6e7)]||0x3,_0xf97c10=_0x19ddb8['globalSettings'][_0x21dab5(0x3ab)]||0x8,_0x38d7c4=await _0x512070['shoppingCategories'][_0x21dab5(0x591)]();let _0x10a89c='';_0x38d7c4[_0x21dab5(0x106b)]>0x0&&(_0x10a89c=_0x21dab5(0x3c9)+_0x38d7c4[_0x21dab5(0xb0a)](_0x290068=>'\x22'+_0x290068[_0x21dab5(0x1561)]+'\x22')[_0x21dab5(0x3b9)](',\x20')+']\x0a');const _0x5dee9f=_0x19ddb8[_0x21dab5(0x9ce)][_0x21dab5(0x246)]||'我',_0x3add9b=_0x7cce84['longTermMemory']&&_0x7cce84[_0x21dab5(0x744)]['length']>0x0?_0x7cce84[_0x21dab5(0x744)]['map'](_0x285d7a=>_0x21dab5(0x2ee)+_0x5d6abc(_0x285d7a[_0x21dab5(0xd73)])+')\x20'+_0x285d7a[_0x21dab5(0x4e3)])['join']('\x0a'):'无',_0x315df9=_0x7cce84[_0x21dab5(0x1f0)]['slice'](-0xa)[_0x21dab5(0xb0a)](_0x38c4af=>(_0x38c4af[_0x21dab5(0x11c1)]===_0x21dab5(0x20d)?_0x5dee9f:_0x7cce84['name'])+':\x20'+String(_0x38c4af[_0x21dab5(0x4e3)])[_0x21dab5(0x72e)](0x0,0x1e)+_0x21dab5(0x4a5))[_0x21dab5(0x3b9)]('\x0a');let _0xacd5d1='';if(_0x7cce84[_0x21dab5(0x450)][_0x21dab5(0x9c4)]&&_0x7cce84[_0x21dab5(0x450)]['linkedWorldBookIds']['length']>0x0){const _0x34df28=_0x7cce84[_0x21dab5(0x450)][_0x21dab5(0x9c4)][_0x21dab5(0xb0a)](_0x30b553=>{const _0x3e4a83=_0x21dab5,_0x8d9688=_0x19ddb8[_0x3e4a83(0x8e4)]['find'](_0x394bc9=>_0x394bc9['id']===_0x30b553);if(!_0x8d9688||!Array[_0x3e4a83(0xb9b)](_0x8d9688[_0x3e4a83(0x4e3)]))return'';const _0x5385b9=_0x8d9688['content']['filter'](_0x277003=>_0x277003['enabled']!==![])[_0x3e4a83(0xb0a)](_0xf15452=>'-\x20'+_0xf15452[_0x3e4a83(0x4e3)])[_0x3e4a83(0x3b9)]('\x0a');return _0x5385b9?_0x3e4a83(0x3d5)+_0x8d9688[_0x3e4a83(0x1561)]+_0x3e4a83(0x237)+_0x5385b9:'';})['filter'](Boolean)['join']('');_0x34df28&&(_0xacd5d1='\x0a#\x20世界观设定\x20(必须参考)\x0a'+_0x34df28+'\x0a');}const _0x2fe28f='\x0a#\x20你的任务\x0a你是一个虚拟的、极具创造力的商品规划师。你的任务是为下面的角色“'+_0x7cce84['name']+_0x21dab5(0x799)+_0x1466d0+'\x20个分类。\x0a\x20\x20\x20\x20-\x20**products**:\x20每个分类下生成\x20'+_0xf97c10+_0x21dab5(0xebb)+_0x7cce84['name']+_0x21dab5(0x6b3)+_0x7cce84[_0x21dab5(0x450)][_0x21dab5(0x1c3)]+_0x21dab5(0x1ab)+_0x3add9b+'\x0a-\x20**世界书设定**:\x20'+_0xacd5d1+'\x0a'+_0x10a89c+_0x21dab5(0x1582)+_0x315df9+_0x21dab5(0xa16)+_0x7cce84[_0x21dab5(0x1561)]+_0x21dab5(0xab3);try{const _0x52b2d2=[{'role':'user','content':_0x21dab5(0x6a9)}];let _0x46cf15=_0x1d2709[_0x21dab5(0x478)](_0x21dab5(0x1329)),_0x367c5a=_0x366263(_0x3a1aba,_0x1b4353,_0x2fe28f,_0x52b2d2);const _0x98efe9=_0x46cf15?await fetch(_0x367c5a['url'],_0x367c5a[_0x21dab5(0x38c)]):await fetch(_0x1d2709+_0x21dab5(0x501),{'method':_0x21dab5(0x12db),'headers':{'Content-Type':_0x21dab5(0xb1f),'Authorization':_0x21dab5(0x1265)+_0x1b4353},'body':JSON[_0x21dab5(0xe1e)]({'model':_0x3a1aba,'messages':[{'role':_0x21dab5(0xe10),'content':_0x2fe28f},..._0x52b2d2],'temperature':_0x19ddb8['globalSettings']['apiTemperature']||0.9})});if(!_0x98efe9['ok'])throw new Error('API\x20错误:\x20'+_0x98efe9[_0x21dab5(0x140e)]);const _0x5e4739=await _0x98efe9[_0x21dab5(0xa5d)](),_0x5bc376=getGeminiResponseText(_0x5e4739),_0x18f554=_0x5bc376[_0x21dab5(0x293)](/({[\s\S]*})/);if(!_0x18f554)throw new Error(_0x21dab5(0xf49));const _0x1b72b9=JSON['parse'](_0x18f554[0x0]);if(!_0x1b72b9[_0x21dab5(0xe3e)]||!Array['isArray'](_0x1b72b9[_0x21dab5(0xe3e)]))throw new Error('AI返回的JSON格式不正确，缺少\x20\x27categories\x27\x20数组。');await _0x512070[_0x21dab5(0x1072)]('rw',_0x512070[_0x21dab5(0x376)],_0x512070['shoppingCategories'],async()=>{const _0x22530d=_0x21dab5;for(const _0x4c8312 of _0x1b72b9[_0x22530d(0xe3e)]){let _0x153866;const _0xce81ad=await _0x512070[_0x22530d(0x1312)][_0x22530d(0x1201)](_0x22530d(0x1561))['equalsIgnoreCase'](_0x4c8312[_0x22530d(0x1561)])['first']();_0xce81ad?_0x153866=_0xce81ad['id']:_0x153866=await _0x512070[_0x22530d(0x1312)][_0x22530d(0xe05)]({'name':_0x4c8312['name']});const _0x259d57=_0x4c8312['products'][_0x22530d(0xb0a)](_0x436428=>{const _0x1bea49=_0x22530d;return{'name':_0x436428[_0x1bea49(0x1561)],'price':_0x436428[_0x1bea49(0x87b)]||0x0,'description':_0x436428['description']||'','imageUrl':'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x436428[_0x1bea49(0xb95)]),'variations':(_0x436428[_0x1bea49(0x138d)]||[])[_0x1bea49(0xb0a)](_0x19e223=>({..._0x19e223,'imageUrl':_0x1bea49(0x10a3)+encodeURIComponent(_0x19e223[_0x1bea49(0xb95)])})),'categoryId':_0x153866};});_0x259d57[_0x22530d(0x106b)]>0x0&&await _0x512070[_0x22530d(0x376)]['bulkAdd'](_0x259d57);}}),activeShoppingCategoryId=_0x21dab5(0xbf1),await _0x5cb09b(),await _0x403a62('生成成功！','为“'+_0x7cce84['name']+'”量身定制的商品已上架！');}catch(_0x4be964){console[_0x21dab5(0x3b7)](_0x21dab5(0x3de),_0x4be964),await _0x403a62(_0x21dab5(0x8e8),_0x21dab5(0x6ad)+_0x4be964[_0x21dab5(0xcce)]);}}async function _0x5809ad(_0x1e899f){const _0x515c19=_0x48bc6d,_0x3ba47e=document['getElementById'](_0x1e899f);if(!_0x3ba47e)return;const _0x2a7717=await _0x49acac('更换图片',[{'text':_0x515c19(0x5a6),'value':_0x515c19(0x66d)},{'text':_0x515c19(0x974),'value':_0x515c19(0x121f)}]);let _0x3580b8=null;if(_0x2a7717===_0x515c19(0x66d))_0x3580b8=await _0x5a2cc8();else _0x2a7717===_0x515c19(0x121f)&&(_0x3580b8=await _0x3ab788(_0x515c19(0x1270),_0x515c19(0x1f3),_0x3ba47e[_0x515c19(0x10d4)],_0x515c19(0x121f)));if(_0x3580b8&&_0x3580b8[_0x515c19(0x13f9)]()){const _0x5b2cbb=_0x3580b8['trim']();_0x3ba47e[_0x515c19(0x10d4)]=_0x5b2cbb,!_0x19ddb8['globalSettings'][_0x515c19(0xdc1)]&&(_0x19ddb8['globalSettings'][_0x515c19(0xdc1)]={}),_0x19ddb8[_0x515c19(0x4c8)]['widgetData'][_0x1e899f]=_0x5b2cbb,await _0x512070[_0x515c19(0x4c8)][_0x515c19(0xd4d)](_0x19ddb8['globalSettings']),await _0x403a62('成功','组件图片已更新！');}}window['handleWidgetImageChange']=_0x5809ad;async function _0x453335(){const _0x51b885=_0x48bc6d;if(!window[_0x51b885(0xf18)]||typeof JSZip===_0x51b885(0x738)){await _0x403a62('库加载失败',_0x51b885(0x774));return;}await _0x403a62(_0x51b885(0x151e),'即将开始打包您的完整备份文件。文件将以ZIP格式流式下载，请勿关闭页面。');const _0x55298e=streamSaver[_0x51b885(0x7a1)](_0x51b885(0x119d)+new Date()[_0x51b885(0xccf)]()['split']('T')[0x0]+_0x51b885(0x130e)),_0x43f83c=new JSZip(),_0x53ff88=0x5f*0x400*0x400;let _0x202473=0x1,_0x245117={},_0x10568c=0x0;const _0x19405f=new TextEncoder();try{const _0x57f1f5=_0x512070['tables']['map'](_0x46614c=>_0x46614c[_0x51b885(0x1561)]);for(const _0xe50494 of _0x57f1f5){console[_0x51b885(0xe4d)]('正在打包表:\x20'+_0xe50494+_0x51b885(0x4a5));const _0x1d3930=await _0x512070[_0x51b885(0x459)](_0xe50494)[_0x51b885(0x591)]();if(_0x1d3930['length']===0x0)continue;const _0x271cc8=JSON[_0x51b885(0xe1e)](_0x1d3930),_0x20acf6=_0x19405f[_0x51b885(0x3f7)](_0x271cc8)[_0x51b885(0x106b)];if(_0x20acf6>_0x53ff88){console['warn'](_0x51b885(0x4dd)+_0xe50494+_0x51b885(0x4d2)+(_0x20acf6/0x400/0x400)[_0x51b885(0x1322)](0x2)+_0x51b885(0x12ae));_0x10568c>0x0&&(_0x43f83c[_0x51b885(0x1243)](_0x51b885(0xbab)+_0x202473++ +'.json',JSON[_0x51b885(0xe1e)]({'version':0x4,'type':_0x51b885(0x457),'data':_0x245117})),_0x245117={},_0x10568c=0x0);_0x245117[_0xe50494]=_0x1d3930,_0x43f83c[_0x51b885(0x1243)]('slice_'+_0x202473++ +_0x51b885(0x6db),JSON[_0x51b885(0xe1e)]({'version':0x4,'type':_0x51b885(0x457),'data':_0x245117})),_0x245117={},_0x10568c=0x0;continue;}_0x10568c>0x0&&_0x10568c+_0x20acf6>_0x53ff88&&(console['log']('切片\x20'+_0x202473+_0x51b885(0x10e8)+(_0x10568c/0x400/0x400)['toFixed'](0x2)+'MB)，正在归档...'),_0x43f83c[_0x51b885(0x1243)]('slice_'+_0x202473++ +_0x51b885(0x6db),JSON['stringify']({'version':0x4,'type':'slice','data':_0x245117})),_0x245117={},_0x10568c=0x0),_0x245117[_0xe50494]=_0x1d3930,_0x10568c+=_0x20acf6;}_0x10568c>0x0&&(console['log'](_0x51b885(0x8d2)+_0x202473+'\x20(大小:\x20'+(_0x10568c/0x400/0x400)[_0x51b885(0x1322)](0x2)+_0x51b885(0x679)),_0x43f83c[_0x51b885(0x1243)]('slice_'+_0x202473+_0x51b885(0x6db),JSON[_0x51b885(0xe1e)]({'version':0x4,'type':_0x51b885(0x457),'data':_0x245117})));console['log'](_0x51b885(0x15c0));const _0x349b3f=_0x43f83c[_0x51b885(0x5c1)]({'type':_0x51b885(0xf11),'streamFiles':!![]}),_0x553ac6=new ReadableStream({'start'(_0x4fce93){const _0x237ee1=_0x51b885;_0x349b3f['on'](_0x237ee1(0x38c),_0x29615e=>{_0x4fce93['enqueue'](_0x29615e);})['on']('end',()=>{const _0x4a71c2=_0x237ee1;console[_0x4a71c2(0xe4d)](_0x4a71c2(0x1080)),_0x4fce93[_0x4a71c2(0x104d)]();})['on'](_0x237ee1(0x3b7),_0x42539e=>{const _0x2747f0=_0x237ee1;console[_0x2747f0(0x3b7)](_0x2747f0(0xffa),_0x42539e),_0x4fce93[_0x2747f0(0x3b7)](_0x42539e);})['resume']();}});await _0x553ac6[_0x51b885(0x1fc)](_0x55298e),await _0x403a62(_0x51b885(0x2ad),_0x51b885(0x1096));}catch(_0x3496be){console[_0x51b885(0x3b7)](_0x51b885(0x30d),_0x3496be),await _0x403a62(_0x51b885(0x59f),_0x51b885(0xc8f)+_0x3496be[_0x51b885(0xcce)]);try{const _0x39bc87=_0x55298e[_0x51b885(0xd8a)]();_0x39bc87['abort'](_0x3496be);}catch(_0x2d2074){}}}async function _0x48a0d4(){const _0x317a11=_0x48bc6d;if(!window[_0x317a11(0xf18)]){alert(_0x317a11(0x12b0));return;}await _0x403a62('正在准备...',_0x317a11(0x684));const _0x29c7e9=streamSaver['createWriteStream'](_0x317a11(0x894)+new Date()['toISOString']()['split']('T')[0x0]+_0x317a11(0x6db)),_0xc35c15=_0x29c7e9['getWriter'](),_0x39d859=new TextEncoder();try{await _0xc35c15['write'](_0x39d859[_0x317a11(0x3f7)](_0x317a11(0xd15)+Date[_0x317a11(0x64b)]()+_0x317a11(0x134c)));const _0x46ef96=await _0x512070[_0x317a11(0x138f)][_0x317a11(0xb0a)](_0x18d313=>_0x18d313[_0x317a11(0x1561)]);for(let _0x43606c=0x0;_0x43606c<_0x46ef96[_0x317a11(0x106b)];_0x43606c++){const _0x1f7058=_0x46ef96[_0x43606c],_0x947f61=_0x512070[_0x317a11(0x459)](_0x1f7058);await _0xc35c15[_0x317a11(0xede)](_0x39d859['encode']('\x22'+_0x1f7058+_0x317a11(0x71e)));let _0x2f9bbf=!![];await _0x947f61[_0x317a11(0xf89)](_0x58438b=>{const _0x589fa5=_0x317a11;!_0x2f9bbf&&_0xc35c15['write'](_0x39d859['encode'](',\x0a')),_0xc35c15[_0x589fa5(0xede)](_0x39d859['encode'](JSON[_0x589fa5(0xe1e)](_0x58438b))),_0x2f9bbf=![];}),await _0xc35c15['write'](_0x39d859['encode']('\x0a]')),_0x43606c<_0x46ef96[_0x317a11(0x106b)]-0x1&&await _0xc35c15['write'](_0x39d859[_0x317a11(0x3f7)](',\x0a'));}await _0xc35c15[_0x317a11(0xede)](_0x39d859[_0x317a11(0x3f7)](_0x317a11(0x5fd)));}catch(_0x33bc78){console['error'](_0x317a11(0x79f),_0x33bc78),await _0x403a62(_0x317a11(0x59f),_0x317a11(0x15d4)+_0x33bc78['message']);}finally{await _0xc35c15[_0x317a11(0x104d)]();}}async function _0x475665(){const _0x582612=_0x48bc6d;await _0x403a62(_0x582612(0x1026),'正在读取所有数据到内存中，请稍候...');try{const _0x4992b3={'version':0x3,'timestamp':Date[_0x582612(0x64b)](),'data':{}},_0x34c703=_0x512070[_0x582612(0x138f)][_0x582612(0xb0a)](_0x3cf5d8=>_0x3cf5d8['name']);for(const _0x31c84a of _0x34c703){const _0x5f00f8=await _0x512070[_0x582612(0x459)](_0x31c84a)[_0x582612(0x591)]();_0x4992b3[_0x582612(0x38c)][_0x31c84a]=_0x5f00f8,console['log']('已打包表:\x20'+_0x31c84a+_0x582612(0x8f4)+_0x5f00f8[_0x582612(0x106b)]);}const _0x25dcbe=new Blob([JSON[_0x582612(0xe1e)](_0x4992b3,null,0x2)],{'type':_0x582612(0xb1f)}),_0x5c9d91=URL[_0x582612(0xc56)](_0x25dcbe),_0x13f37f=document[_0x582612(0xe94)]('a');_0x13f37f[_0x582612(0xe6b)]=_0x5c9d91,_0x13f37f[_0x582612(0xed2)]=_0x582612(0x138a)+new Date()[_0x582612(0xccf)]()[_0x582612(0x1536)]('T')[0x0]+_0x582612(0x6db),_0x13f37f[_0x582612(0x9cc)](),URL[_0x582612(0xb93)](_0x5c9d91),await _0x403a62(_0x582612(0x1217),_0x582612(0x1d1));}catch(_0x49ade8){console[_0x582612(0x3b7)](_0x582612(0x73e),_0x49ade8),await _0x403a62(_0x582612(0x59f),_0x582612(0x12e0)+_0x49ade8['message']);}}function _0x14e2fe(){const _0x186ac9=_0x48bc6d,_0x23f70b=Object['values'](_0x19ddb8[_0x186ac9(0xb04)])['reduce']((_0x40c815,_0x396aba)=>{const _0x376e65=_0x186ac9;if(_0x396aba['id']===_0x19ddb8[_0x376e65(0x859)])return _0x40c815;return _0x40c815+(_0x396aba[_0x376e65(0xe20)]||0x0);},0x0),_0x189ed8=_0x27ed94||0x0,_0x164460=_0x23f70b+_0x189ed8,_0x164ad6=document[_0x186ac9(0x9a3)](_0x186ac9(0x99f));if(!_0x164ad6)return;let _0x1b1fa3=_0x164ad6[_0x186ac9(0xc86)](_0x186ac9(0xff7));!_0x1b1fa3&&(_0x1b1fa3=document[_0x186ac9(0xe94)](_0x186ac9(0x1210)),_0x1b1fa3['className']='unread-indicator',_0x164ad6[_0x186ac9(0x983)](_0x1b1fa3));let _0x5002cc=_0x164ad6[_0x186ac9(0xc86)]('.unread-indicator.back-btn-indicator');_0x5002cc&&_0x5002cc[_0x186ac9(0x133d)](),_0x164460>0x0?(_0x1b1fa3[_0x186ac9(0x766)]=_0x164460>0x63?_0x186ac9(0x809):_0x164460,_0x1b1fa3[_0x186ac9(0x20f)][_0x186ac9(0x115d)]='block',_0x1b1fa3[_0x186ac9(0x20f)][_0x186ac9(0x13e7)]='20',_0x1b1fa3[_0x186ac9(0x20f)][_0x186ac9(0x352)]=_0x186ac9(0x1388)):_0x1b1fa3[_0x186ac9(0x20f)]['display']=_0x186ac9(0x8e0);}async function _0x59245c(_0x1ee49e){const _0x33851e=_0x48bc6d,_0x18aa69=_0x1ee49e===_0x33851e(0x80f)?{'id':_0x33851e(0x80f),'name':_0x33851e(0xa9b)}:await _0x512070['stickerCategories'][_0x33851e(0x14ee)](_0x1ee49e);if(!_0x18aa69){console[_0x33851e(0x3b7)](_0x33851e(0x7a7),_0x1ee49e);return;}const _0x328711=document[_0x33851e(0x9a3)](_0x33851e(0x98b)),_0x5dcd37=document[_0x33851e(0x9a3)](_0x33851e(0x53b)),_0x1694ef=_0x328711[_0x33851e(0xc86)]('.modal-header\x20span');_0x5dcd37['innerHTML']='',_0x1694ef['textContent']=_0x33851e(0x1f9)+_0x18aa69[_0x33851e(0x1561)]+_0x33851e(0x6d1);const _0x8843ba=Object[_0x33851e(0xea1)](_0x19ddb8['chats'])[_0x33851e(0x6a2)]((_0x18d9f7,_0x4a22b1)=>_0x18d9f7[_0x33851e(0x1561)]['localeCompare'](_0x4a22b1['name'],_0x33851e(0x15bc)));_0x8843ba[_0x33851e(0x15c1)](_0xc95e08=>{const _0x37b25e=_0x33851e,_0x5a7fc3=Array['isArray'](_0xc95e08[_0x37b25e(0x450)]?.['stickerCategoryIds'])&&_0xc95e08[_0x37b25e(0x450)][_0x37b25e(0x7dd)]['includes'](_0x1ee49e),_0x2dd1ed=document[_0x37b25e(0xe94)](_0x37b25e(0x8ca));_0x2dd1ed['className']=_0x37b25e(0x5a1),_0x2dd1ed[_0x37b25e(0xeb2)]=_0x37b25e(0x9e2)+_0xc95e08['id']+'\x22\x20'+(_0x5a7fc3?_0x37b25e(0x944):'')+'\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0xc95e08['isGroup']?_0xc95e08[_0x37b25e(0x450)][_0x37b25e(0x20a)]:_0xc95e08[_0x37b25e(0x450)][_0x37b25e(0x4fe)]||_0x4f81ff)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0xc95e08['name']+_0x37b25e(0x110c),_0x5dcd37[_0x37b25e(0x983)](_0x2dd1ed);}),document[_0x33851e(0x9a3)](_0x33851e(0xd51))['onclick']=()=>_0x442866(_0x1ee49e),document[_0x33851e(0x9a3)](_0x33851e(0x564))[_0x33851e(0x4ce)]=()=>_0x328711[_0x33851e(0x4d8)][_0x33851e(0x133d)](_0x33851e(0xc09)),_0x328711['classList']['add'](_0x33851e(0xc09));}async function _0x442866(_0x8417d){const _0x42d68d=_0x48bc6d,_0x4032ca=new Set(Array['from'](document[_0x42d68d(0x131c)](_0x42d68d(0x2ea)))[_0x42d68d(0xb0a)](_0xb4741d=>_0xb4741d['dataset'][_0x42d68d(0x907)])),_0x531f74=[];for(const _0x1ec07a in _0x19ddb8['chats']){const _0x19b26b=_0x19ddb8['chats'][_0x1ec07a];!Array[_0x42d68d(0xb9b)](_0x19b26b[_0x42d68d(0x450)][_0x42d68d(0x7dd)])&&(_0x19b26b[_0x42d68d(0x450)][_0x42d68d(0x7dd)]=[]);const _0x475e01=_0x19b26b[_0x42d68d(0x450)][_0x42d68d(0x7dd)][_0x42d68d(0x478)](_0x8417d),_0x3692d4=_0x4032ca['has'](_0x1ec07a);if(_0x475e01&&!_0x3692d4)_0x19b26b[_0x42d68d(0x450)][_0x42d68d(0x7dd)]=_0x19b26b[_0x42d68d(0x450)][_0x42d68d(0x7dd)][_0x42d68d(0x1195)](_0x1d43c9=>_0x1d43c9!==_0x8417d),_0x531f74[_0x42d68d(0x1c4)](_0x19b26b);else!_0x475e01&&_0x3692d4&&(_0x19b26b['settings']['stickerCategoryIds']['push'](_0x8417d),_0x531f74[_0x42d68d(0x1c4)](_0x19b26b));}_0x531f74[_0x42d68d(0x106b)]>0x0&&(await _0x512070['chats'][_0x42d68d(0xc71)](_0x531f74),await _0x403a62(_0x42d68d(0x398),'表情包分类绑定已更新！')),document[_0x42d68d(0x9a3)](_0x42d68d(0x98b))[_0x42d68d(0x4d8)][_0x42d68d(0x133d)](_0x42d68d(0xc09));}function _0xc9a7e4(_0xc9ab69){const _0x4167cb=_0x48bc6d;if(!_0xc9ab69||!_0xc9ab69['settings']['stickerCategoryIds']||_0xc9ab69[_0x4167cb(0x450)]['stickerCategoryIds']['length']===0x0)return'';const _0x2ceab0=_0xc9ab69[_0x4167cb(0x450)][_0x4167cb(0x7dd)];let _0x2c1371=[];const _0xae057d=new Set();_0x2ceab0['forEach'](_0x22f2de=>{const _0x462386=_0x4167cb;let _0x3d4d36;_0x22f2de===_0x462386(0x80f)?_0x3d4d36=_0x19ddb8[_0x462386(0x1557)][_0x462386(0x1195)](_0x4e2905=>!_0x4e2905[_0x462386(0x922)]):_0x3d4d36=_0x19ddb8[_0x462386(0x1557)]['filter'](_0xc5f082=>_0xc5f082['categoryId']===_0x22f2de),_0x3d4d36['forEach'](_0x2c6cec=>{const _0x542859=_0x462386;!_0xae057d[_0x542859(0x1472)](_0x2c6cec[_0x542859(0x1561)])&&(_0x2c1371['push'](_0x2c6cec),_0xae057d[_0x542859(0xe05)](_0x2c6cec[_0x542859(0x1561)]));});});if(_0x2c1371[_0x4167cb(0x106b)]===0x0)return'';const _0x2b4292=_0x2c1371['map'](_0xe22d2d=>'-\x20'+_0xe22d2d[_0x4167cb(0x1561)])[_0x4167cb(0x3b9)]('\x0a');return _0x4167cb(0xfa7)+_0x2b4292+'\x0a';}function _0x50f06c(_0x36a316){const _0x4e1ddc=_0x48bc6d;if(!_0x36a316||!_0x36a316[_0x4e1ddc(0x136b)])return'';let _0x329c79=_0x4e1ddc(0xc76),_0x1407f3=![];return _0x36a316[_0x4e1ddc(0xcca)][_0x4e1ddc(0x15c1)](_0x5b3c4e=>{const _0x49ffc0=_0x4e1ddc;if(_0x5b3c4e['id']===_0x49ffc0(0x20d))return;const _0x26c6ad=_0x19ddb8[_0x49ffc0(0xb04)][_0x5b3c4e['id']];if(_0x26c6ad&&_0x26c6ad[_0x49ffc0(0x450)]['stickerCategoryIds']&&_0x26c6ad[_0x49ffc0(0x450)][_0x49ffc0(0x7dd)][_0x49ffc0(0x106b)]>0x0){const _0xceb89f=_0x26c6ad[_0x49ffc0(0x450)]['stickerCategoryIds'];let _0x32e77a=[];const _0x18dde3=new Set();_0xceb89f[_0x49ffc0(0x15c1)](_0x488bd4=>{const _0x58e2d4=_0x49ffc0;let _0x3671ec;_0x488bd4==='uncategorized'?_0x3671ec=_0x19ddb8['userStickers']['filter'](_0x1f2af6=>!_0x1f2af6[_0x58e2d4(0x922)]):_0x3671ec=_0x19ddb8[_0x58e2d4(0x1557)][_0x58e2d4(0x1195)](_0x19a964=>_0x19a964[_0x58e2d4(0x922)]===_0x488bd4),_0x3671ec[_0x58e2d4(0x15c1)](_0x250e0e=>{const _0x555ab0=_0x58e2d4;!_0x18dde3[_0x555ab0(0x1472)](_0x250e0e['name'])&&(_0x32e77a[_0x555ab0(0x1c4)](_0x250e0e),_0x18dde3[_0x555ab0(0xe05)](_0x250e0e['name']));});}),_0x32e77a['length']>0x0&&(_0x1407f3=!![],_0x329c79+=_0x49ffc0(0xb50)+_0x5b3c4e['groupNickname']+'\x20(本名:\x20'+_0x5b3c4e[_0x49ffc0(0x339)]+_0x49ffc0(0x13a6),_0x329c79+=_0x32e77a['map'](_0x70427=>'-\x20'+_0x70427[_0x49ffc0(0x1561)])[_0x49ffc0(0x3b9)]('\x0a'));}}),_0x1407f3?_0x329c79:'';}function _0x3824c4(_0x1be6f1){const _0x426303=_0x48bc6d;if(!_0x1be6f1)return 0x0;return Math[_0x426303(0x101a)](_0x1be6f1['length']/1.5);}async function _0x202ddf(){const _0x190087=_0x48bc6d;if(!_0x19ddb8[_0x190087(0x859)])return 0x0;const _0x23ad8b=_0x19ddb8['chats'][_0x19ddb8[_0x190087(0x859)]];if(!_0x23ad8b)return 0x0;const _0x7dec36=parseInt(document[_0x190087(0x9a3)]('max-memory')[_0x190087(0x7b2)])||0xa,_0x411e99=parseInt(document[_0x190087(0x9a3)](_0x190087(0x15dd))[_0x190087(0x7b2)])||0xa,_0x2e4517=document['getElementById']('offline-mode-toggle')[_0x190087(0x944)],_0x194133=document[_0x190087(0x9a3)](_0x190087(0xbd6))[_0x190087(0x7b2)],_0x6dd06c=document[_0x190087(0x9a3)]('my-persona')[_0x190087(0x7b2)];let _0x5b98fb='';const _0xa1f833=Array[_0x190087(0x1311)](document[_0x190087(0x131c)](_0x190087(0x557)))['map'](_0x75e719=>_0x75e719[_0x190087(0x7b2)][_0x190087(0x1bb)](_0x190087(0x1471),''));if(_0xa1f833[_0x190087(0x106b)]>0x0){const _0x549ede=_0xa1f833[_0x190087(0xb0a)](_0x33e44c=>{const _0x442c2e=_0x190087,_0xb92c2b=_0x19ddb8[_0x442c2e(0x8e4)][_0x442c2e(0xd62)](_0x5ad501=>_0x5ad501['id']===_0x33e44c);if(!_0xb92c2b||!Array[_0x442c2e(0xb9b)](_0xb92c2b[_0x442c2e(0x4e3)]))return'';return _0xb92c2b[_0x442c2e(0x4e3)][_0x442c2e(0x1195)](_0x2f0bed=>_0x2f0bed[_0x442c2e(0x15cd)]!==![])[_0x442c2e(0xb0a)](_0x578a3f=>_0x578a3f[_0x442c2e(0x4e3)])['join']('\x0a');})['filter'](Boolean)[_0x190087(0x3b9)]('\x0a');_0x5b98fb+=_0x549ede;}_0x23ad8b[_0x190087(0x744)]&&_0x23ad8b['longTermMemory']['length']>0x0&&(_0x5b98fb+=_0x23ad8b['longTermMemory']['map'](_0x16599c=>_0x16599c[_0x190087(0x4e3)])['join']('\x0a'));const _0xfc247f=document[_0x190087(0x9a3)]('link-memory-toggle')[_0x190087(0x944)];if(_0xfc247f){const _0x36895a=Array[_0x190087(0x1311)](document[_0x190087(0x131c)](_0x190087(0xd84)))[_0x190087(0xb0a)](_0x30da60=>_0x30da60[_0x190087(0x7b2)]);for(const _0x289efa of _0x36895a){const _0x1189fc=_0x19ddb8[_0x190087(0xb04)][_0x289efa];_0x1189fc&&_0x1189fc[_0x190087(0x1f0)]['length']>0x0&&(_0x5b98fb+=_0x1189fc[_0x190087(0x1f0)][_0x190087(0x457)](-_0x411e99)[_0x190087(0xb0a)](_0x47f8fd=>String(_0x47f8fd[_0x190087(0x4e3)]))[_0x190087(0x3b9)]('\x0a'));}}_0x23ad8b[_0x190087(0x136b)]?_0x23ad8b[_0x190087(0xcca)][_0x190087(0x15c1)](_0x39e372=>{const _0x6f4167=_0x190087;_0x5b98fb+=_0x39e372[_0x6f4167(0xcd4)];}):_0x5b98fb+=_0x194133;_0x5b98fb+=_0x6dd06c,_0x5b98fb+=_0xc9a7e4(_0x23ad8b);_0x23ad8b['isGroup']&&(_0x5b98fb+=_0x50f06c(_0x23ad8b));if(!_0x23ad8b[_0x190087(0x136b)]&&_0x2e4517){const _0x2fa6d6=document[_0x190087(0x9a3)]('offline-preset-select')[_0x190087(0x7b2)];if(_0x2fa6d6){const _0x3c6cd4=_0x19ddb8[_0x190087(0xded)]['find'](_0x3f1456=>_0x3f1456['id']===_0x2fa6d6);_0x3c6cd4&&(_0x5b98fb+=_0x3c6cd4['content']['filter'](_0x27a646=>_0x27a646['enabled']!==![])[_0x190087(0xb0a)](_0x4d4d58=>_0x4d4d58[_0x190087(0x4e3)])[_0x190087(0x3b9)]('\x0a'));}}const _0x28ea1b=_0x23ad8b[_0x190087(0x1f0)][_0x190087(0x457)](-_0x7dec36);return _0x5b98fb+=_0x28ea1b[_0x190087(0xb0a)](_0x4d9577=>{const _0x2422ca=_0x190087;if(typeof _0x4d9577['content']==='string')return _0x4d9577[_0x2422ca(0x4e3)];if(Array[_0x2422ca(0xb9b)](_0x4d9577[_0x2422ca(0x4e3)]))return _0x4d9577[_0x2422ca(0x4e3)][_0x2422ca(0xb0a)](_0x214de4=>_0x214de4[_0x2422ca(0x13ca)])[_0x2422ca(0x3b9)]('\x20');return'';})[_0x190087(0x3b9)]('\x0a'),_0x3824c4(_0x5b98fb);}const _0x570aeb=_0x3dbeec(async()=>{const _0x304cce=_0x48bc6d,_0x571ac1=document[_0x304cce(0x9a3)](_0x304cce(0xf76));if(!_0x571ac1)return;_0x571ac1[_0x304cce(0xeb2)]=_0x304cce(0x1192);try{const _0x1fdc80=await _0x202ddf();_0x571ac1[_0x304cce(0xeb2)]=_0x304cce(0x1470)+_0x1fdc80+_0x304cce(0x483);}catch(_0x4d4a97){console[_0x304cce(0x3b7)]('Token\x20calculation\x20error:',_0x4d4a97),_0x571ac1[_0x304cce(0xeb2)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>预估总上下文Token数:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22\x20style=\x22color:\x20red;\x22>计算出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}},0x12c);async function _0x1b445c(){const _0x243e1c=_0x48bc6d,_0x3bc663=document[_0x243e1c(0x9a3)](_0x243e1c(0x6e3));_0x3bc663[_0x243e1c(0xeb2)]='',_0x1ab0a1=[],_0x35e034=0x0,_0x3c8299=![];const _0x2a265b=[];try{const _0x2d1110=await _0x512070['chats'][_0x243e1c(0x591)]();for(const _0x362f46 of _0x2d1110){_0x362f46['history']&&_0x362f46[_0x243e1c(0x1f0)][_0x243e1c(0x106b)]>0x0&&_0x362f46[_0x243e1c(0x1f0)][_0x243e1c(0x15c1)](_0x332108=>{const _0x53eedc=_0x243e1c;_0x332108['type']===_0x53eedc(0x1300)&&_0x332108[_0x53eedc(0xbfe)]&&_0x2a265b[_0x53eedc(0x1c4)]({'sourceType':_0x53eedc(0xd43),'imageUrl':_0x332108['imageUrl'],'prompt':_0x332108[_0x53eedc(0x3a1)]||_0x332108['fullPrompt']||'NAI\x20Image','chatId':_0x362f46['id'],'msgTimestamp':_0x332108[_0x53eedc(0xd73)]});});}}catch(_0x53443d){console[_0x243e1c(0x3b7)](_0x243e1c(0xa7a),_0x53443d);}try{const _0xce3c26=await _0x512070[_0x243e1c(0x10e5)][_0x243e1c(0x591)]();_0xce3c26['forEach'](_0x5131b6=>{const _0x469898=_0x243e1c;if(_0x5131b6[_0x469898(0x1508)]===_0x469898(0x1300)){const _0x489237=_0x5131b6[_0x469898(0x739)]||(_0x5131b6[_0x469898(0xbfe)]?[_0x5131b6[_0x469898(0xbfe)]]:[]),_0x3c0898=Array[_0x469898(0xb9b)](_0x5131b6[_0x469898(0x3a1)])?_0x5131b6[_0x469898(0x3a1)]:[_0x5131b6[_0x469898(0x3a1)]||'NAI\x20Image'];_0x489237[_0x469898(0x15c1)]((_0x27f8b3,_0x5e6a10)=>{const _0x6129d2=_0x469898;_0x2a265b['push']({'sourceType':_0x6129d2(0x14b1),'imageUrl':_0x27f8b3,'prompt':_0x3c0898[_0x5e6a10]||_0x3c0898[0x0],'postId':_0x5131b6['id'],'imageIndex':_0x5e6a10});});}});}catch(_0x170cb6){console['error'](_0x243e1c(0x806),_0x170cb6);}_0x1ab0a1=_0x2a265b[_0x243e1c(0x6a2)]((_0x381ef4,_0x2d8617)=>(_0x2d8617[_0x243e1c(0x5cd)]||_0x2d8617[_0x243e1c(0xb92)]||0x0)-(_0x381ef4[_0x243e1c(0x5cd)]||_0x381ef4[_0x243e1c(0xb92)]||0x0)),_0x1ab0a1[_0x243e1c(0x106b)]===0x0?_0x3bc663[_0x243e1c(0xeb2)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x22>画廊还是空的，快去生成一些图片吧！</p>':_0x476a5d(),document[_0x243e1c(0x9a3)](_0x243e1c(0x85d))[_0x243e1c(0x4d8)][_0x243e1c(0xe05)](_0x243e1c(0xc09));}function _0x5ce433(_0x9106da){const _0x561a34=_0x48bc6d,_0x397515=document['getElementById'](_0x561a34(0x6e3));if(_0x9106da[_0x561a34(0x106b)]===0x0&&_0x35e034===0x0){_0x397515[_0x561a34(0xeb2)]=_0x561a34(0x116c);return;}const _0x2fa01c=document[_0x561a34(0xa4d)]();_0x9106da[_0x561a34(0x15c1)]((_0x33e56d,_0x5d5ea4)=>{const _0x38a56f=_0x561a34,_0x3a8e54=document[_0x38a56f(0xe94)](_0x38a56f(0x8ca));_0x3a8e54['className']='nai-gallery-item',_0x3a8e54[_0x38a56f(0x10b8)]=_0x33e56d['prompt'];const _0x4827de=_0x33e56d[_0x38a56f(0x3ba)]+'_'+(_0x33e56d[_0x38a56f(0x907)]||_0x33e56d[_0x38a56f(0xb92)])+'_'+(_0x33e56d[_0x38a56f(0x5cd)]||_0x33e56d['imageIndex']);_0x3a8e54[_0x38a56f(0xd8d)]['key']=_0x4827de,_0x3a8e54[_0x38a56f(0xd8d)][_0x38a56f(0xbfe)]=_0x33e56d[_0x38a56f(0xbfe)],_0x3a8e54[_0x38a56f(0xd8d)]['prompt']=_0x33e56d[_0x38a56f(0x3a1)],_0x3a8e54[_0x38a56f(0xeb2)]=_0x38a56f(0xc34)+_0x33e56d['imageUrl']+_0x38a56f(0xf8c)+_0x33e56d[_0x38a56f(0x3a1)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x2fa01c[_0x38a56f(0x983)](_0x3a8e54);}),_0x397515[_0x561a34(0x983)](_0x2fa01c);}async function _0x476a5d(){const _0x3c9550=_0x48bc6d;if(_0x3c8299||_0x35e034>=_0x1ab0a1[_0x3c9550(0x106b)])return;_0x3c8299=!![];const _0x33109c=document['getElementById'](_0x3c9550(0x6e3));_0x3335f4(_0x33109c,_0x3c9550(0x837)),setTimeout(()=>{const _0x13b6f3=_0x3c9550,_0x532b43=_0x1ab0a1[_0x13b6f3(0x457)](_0x35e034,_0x35e034+_0x52fa12);_0x38511a(_0x33109c),_0x532b43['length']>0x0&&(_0x5ce433(_0x532b43),_0x35e034+=_0x532b43[_0x13b6f3(0x106b)]),_0x3c8299=![];},0x1f4);}function _0x24fe75(){const _0x4d378b=_0x48bc6d;_0x3d1e35=!_0x3d1e35;const _0x4883bd=document[_0x4d378b(0x9a3)](_0x4d378b(0x6e3)),_0x4c9993=document[_0x4d378b(0x9a3)](_0x4d378b(0xdc4)),_0x309598=document[_0x4d378b(0x9a3)](_0x4d378b(0x945)),_0x9128d3=document[_0x4d378b(0x9a3)](_0x4d378b(0xcf9));_0x4883bd[_0x4d378b(0x4d8)][_0x4d378b(0xc02)](_0x4d378b(0xb3e),_0x3d1e35),_0x3d1e35?(_0x4c9993[_0x4d378b(0x766)]='完成',_0x309598[_0x4d378b(0x20f)]['display']=_0x4d378b(0x79c),_0x3b4dcd[_0x4d378b(0xe81)](),_0x9128d3['checked']=![],_0xd72932()):(_0x4c9993['textContent']='管理',_0x309598[_0x4d378b(0x20f)][_0x4d378b(0x115d)]=_0x4d378b(0x8e0),_0x4883bd['querySelectorAll']('.nai-gallery-item.selected')[_0x4d378b(0x15c1)](_0x1fbb99=>_0x1fbb99[_0x4d378b(0x4d8)][_0x4d378b(0x133d)](_0x4d378b(0x154b))));}function _0xd72932(){const _0x32a835=_0x48bc6d,_0x2ff3e9=document[_0x32a835(0x9a3)](_0x32a835(0x3fd)),_0x10e94a=document[_0x32a835(0x9a3)](_0x32a835(0xdc3)),_0x564faa=_0x3b4dcd['size'];if(_0x2ff3e9)_0x2ff3e9[_0x32a835(0x766)]=_0x32a835(0x1587)+_0x564faa+')';if(_0x10e94a)_0x10e94a['textContent']=_0x32a835(0xdfe)+_0x564faa+')';}function _0x44d33a(_0x51373c){const _0xfa1af6=_0x48bc6d,_0x110cee=_0x51373c[_0xfa1af6(0xa41)]['closest'](_0xfa1af6(0x1402));if(!_0x110cee)return;const _0x2507c6=_0x110cee[_0xfa1af6(0xd8d)][_0xfa1af6(0xf33)],_0x944f43=_0x110cee['dataset'][_0xfa1af6(0xbfe)],_0x1fa85d=_0x110cee[_0xfa1af6(0xd8d)][_0xfa1af6(0x3a1)];if(_0x51373c[_0xfa1af6(0xa41)]['closest'](_0xfa1af6(0x132f))){_0x51373c['stopPropagation'](),_0x40069b(_0x944f43,_0x1fa85d);return;}if(_0x51373c[_0xfa1af6(0xa41)][_0xfa1af6(0x94c)](_0xfa1af6(0xce8))){_0x51373c[_0xfa1af6(0x63a)](),_0x5f4769(new Set([_0x2507c6]));return;}if(_0x3d1e35)_0x110cee[_0xfa1af6(0x4d8)]['toggle']('selected'),_0x3b4dcd[_0xfa1af6(0x1472)](_0x2507c6)?_0x3b4dcd[_0xfa1af6(0x10a8)](_0x2507c6):_0x3b4dcd[_0xfa1af6(0xe05)](_0x2507c6),_0xd72932();else{const _0x4a7974=_0xfa1af6(0xd50),_0xc9eddf='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x944f43+'\x22\x20style=\x22max-width:\x20100%;\x20border-radius:\x208px;\x20box-shadow:\x200\x204px\x2010px\x20rgba(0,0,0,0.1);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x403a62(_0x4a7974,_0xc9eddf);}}async function _0x59e9ae(){const _0x5b4b15=_0x48bc6d,_0x569a44=_0x3b4dcd;if(_0x569a44['size']===0x0){alert(_0x5b4b15(0x107b));return;}if(typeof JSZip===_0x5b4b15(0x738)||!window['streamSaver']){await _0x403a62(_0x5b4b15(0x1418),'核心库\x20(JSZip\x20或\x20StreamSaver)\x20未能成功加载，请检查您的网络连接并刷新页面后重试。');return;}await _0x403a62(_0x5b4b15(0x1395),_0x5b4b15(0x107a)+_0x569a44[_0x5b4b15(0xbdf)]+'\x20张图片...');const _0x5e5a56=new JSZip();let _0x481fdb=0x0;const _0x16a016=[],_0x3a78d7=Array['from'](_0x569a44);_0x3a78d7['forEach']((_0xb048e2,_0x3df6de)=>{const _0x18ebb8=_0x5b4b15,_0xdb82e5=document[_0x18ebb8(0xc86)](_0x18ebb8(0xb01)+_0xb048e2+'\x22]');if(!_0xdb82e5)return;const _0x34cb8e=_0xdb82e5[_0x18ebb8(0xd8d)][_0x18ebb8(0xbfe)],_0x1c00a2=_0xdb82e5[_0x18ebb8(0xd8d)][_0x18ebb8(0x3a1)],_0x3e7c75=_0x38e31c(_0x1c00a2),_0xee1938=_0x3e7c75[_0x18ebb8(0x1bb)](/\.png$/,'_('+(_0x3df6de+0x1)+_0x18ebb8(0x2d4)),_0x3f1a39=((async()=>{const _0x598eba=_0x18ebb8;try{let _0x445833;if(_0x34cb8e[_0x598eba(0x608)]('data:')){const _0x2f12eb=await fetch(_0x34cb8e);_0x445833=await _0x2f12eb[_0x598eba(0xf11)]();}else{let _0x4dfc7f;try{_0x4dfc7f=await fetch(_0x34cb8e,{'mode':_0x598eba(0x593)});if(!_0x4dfc7f['ok'])throw new Error(_0x598eba(0x1086));}catch(_0x3e1984){console[_0x598eba(0x651)](_0x598eba(0x189),_0x3e1984[_0x598eba(0xcce)]);const _0x54669e=_0x520f76();let _0x4ccdef=_0x54669e['cors_proxy']==='custom'?_0x54669e['custom_proxy_url']:_0x54669e[_0x598eba(0x553)];if(!_0x4ccdef||_0x4ccdef==='')_0x4ccdef='https://corsproxy.io/?';const _0x1fed40=_0x4ccdef+encodeURIComponent(_0x34cb8e);_0x4dfc7f=await fetch(_0x1fed40);}if(!_0x4dfc7f['ok'])throw new Error('Fetch\x20failed:\x20'+_0x4dfc7f[_0x598eba(0x27d)]);_0x445833=await _0x4dfc7f[_0x598eba(0xf11)]();}_0x5e5a56[_0x598eba(0x1243)](_0xee1938,_0x445833,{'binary':!![]});}catch(_0xf27073){console[_0x598eba(0x3b7)](_0x598eba(0x10eb)+_0x34cb8e,_0xf27073),_0x481fdb++;}})());_0x16a016[_0x18ebb8(0x1c4)](_0x3f1a39);}),await Promise[_0x5b4b15(0xbf1)](_0x16a016);if(_0x481fdb===_0x569a44[_0x5b4b15(0xbdf)]){await _0x403a62(_0x5b4b15(0x1418),_0x5b4b15(0x1574));return;}await _0x403a62(_0x5b4b15(0x851),'所有图片已准备就绪，正在流式压缩...\x20下载将自动开始。');try{const _0x3a8a3f=streamSaver[_0x5b4b15(0x7a1)](_0x5b4b15(0x797)+Date[_0x5b4b15(0x64b)]()+'.zip'),_0x12f8e7=_0x5e5a56[_0x5b4b15(0x5c1)]({'type':'blob','streamFiles':!![]}),_0x3877ad=new ReadableStream({'start'(_0xce6b1e){const _0x56f1c7=_0x5b4b15;_0x12f8e7['on'](_0x56f1c7(0x38c),_0x360e9f=>{const _0x1d0047=_0x56f1c7;_0xce6b1e[_0x1d0047(0x68a)](_0x360e9f);})['on'](_0x56f1c7(0x998),()=>{const _0x1e8d4d=_0x56f1c7;console[_0x1e8d4d(0xe4d)]('ZIP\x20流生成完毕。'),_0xce6b1e['close']();})['on']('error',_0x3405ed=>{const _0xb5b817=_0x56f1c7;console[_0xb5b817(0x3b7)](_0xb5b817(0xffa),_0x3405ed),_0xce6b1e[_0xb5b817(0x3b7)](_0x3405ed);})[_0x56f1c7(0xd8c)]();}});await _0x3877ad[_0x5b4b15(0x1fc)](_0x3a8a3f),_0x481fdb>0x0&&_0x403a62(_0x5b4b15(0x1ad),_0x5b4b15(0x34f)+(_0x569a44[_0x5b4b15(0xbdf)]-_0x481fdb)+_0x5b4b15(0x14f4)+_0x481fdb+_0x5b4b15(0xe4b));}catch(_0x2590b8){console[_0x5b4b15(0x3b7)](_0x5b4b15(0x8c3),_0x2590b8),await _0x403a62(_0x5b4b15(0xec6),_0x5b4b15(0x67a)+_0x2590b8['message']);}}async function _0x5f4769(_0x5843d1=null){const _0x50ab2a=_0x48bc6d,_0x57bf9c=_0x5843d1||_0x3b4dcd;if(_0x57bf9c['size']===0x0)return;const _0x353628=await _0x2c9509('确认删除',_0x50ab2a(0x8b7)+_0x57bf9c['size']+'\x20张NAI图片吗？此操作不可恢复。',{'confirmButtonClass':_0x50ab2a(0xf5b)});if(!_0x353628)return;await _0x403a62('请稍候...',_0x50ab2a(0xa2f));let _0x27f0a2=0x0;const _0x8f8d12=new Map(),_0x5754b2=new Set(),_0x2eca11=new Map(),_0x46ba3c=new Set();for(const _0xc6223 of _0x57bf9c){if(_0xc6223[_0x50ab2a(0x608)](_0x50ab2a(0x12f8))){const _0x20aa40=_0xc6223['split']('_'),_0x57d790=parseInt(_0x20aa40[0x1]);!isNaN(_0x57d790)&&_0x46ba3c[_0x50ab2a(0xe05)](_0x57d790);}}const _0x25393b=new Map();if(_0x46ba3c[_0x50ab2a(0xbdf)]>0x0){const _0x508033=await _0x512070[_0x50ab2a(0x10e5)][_0x50ab2a(0x1201)]('id')[_0x50ab2a(0xd26)](Array['from'](_0x46ba3c))[_0x50ab2a(0x591)]();_0x508033[_0x50ab2a(0x15c1)](_0x2d0af9=>_0x25393b[_0x50ab2a(0x1177)](_0x2d0af9['id'],_0x2d0af9));}for(const _0xcaf10e of _0x57bf9c){const _0x1ecaf1=_0xcaf10e[_0x50ab2a(0x1536)]('_');if(_0x1ecaf1[_0x50ab2a(0x106b)]<0x3){console[_0x50ab2a(0x651)](_0x50ab2a(0x12ca),_0xcaf10e);continue;}const _0x117ef8=_0x1ecaf1[0x0],_0x879ecf=_0x1ecaf1[_0x50ab2a(0x144a)](),_0x350d74=_0x1ecaf1[_0x50ab2a(0x457)](0x1)[_0x50ab2a(0x3b9)]('_');if(_0x117ef8===_0x50ab2a(0xd43)){const _0x251265=_0x350d74,_0x10b146=parseInt(_0x879ecf);if(!_0x8f8d12[_0x50ab2a(0x1472)](_0x251265)){const _0x1dd31b=await _0x512070[_0x50ab2a(0xb04)][_0x50ab2a(0x14ee)](_0x251265);if(_0x1dd31b)_0x8f8d12[_0x50ab2a(0x1177)](_0x251265,_0x1dd31b);else{console[_0x50ab2a(0x651)](_0x50ab2a(0x1420)+_0x251265+_0x50ab2a(0xd06));continue;}}const _0x167692=_0x8f8d12['get'](_0x251265);if(_0x167692&&_0x167692['history']){const _0x37c7d0=_0x167692[_0x50ab2a(0x1f0)]['length'];_0x167692[_0x50ab2a(0x1f0)]=_0x167692[_0x50ab2a(0x1f0)][_0x50ab2a(0x1195)](_0x49c527=>_0x49c527[_0x50ab2a(0xd73)]!==_0x10b146),_0x167692[_0x50ab2a(0x1f0)][_0x50ab2a(0x106b)]<_0x37c7d0&&(_0x27f0a2++,_0x8f8d12['set'](_0x251265,_0x167692));}}else{if(_0x117ef8===_0x50ab2a(0x14b1)){const _0x206155=parseInt(_0x350d74),_0x21c5ef=parseInt(_0x879ecf),_0x2ed22f=_0x2eca11[_0x50ab2a(0x14ee)](_0x206155)||_0x25393b['get'](_0x206155);if(!_0x2ed22f){console[_0x50ab2a(0x651)](_0x50ab2a(0xcf4)+_0x206155+_0x50ab2a(0xd06));continue;}const _0x29bc67=_0x2ed22f[_0x50ab2a(0x739)]||(_0x2ed22f[_0x50ab2a(0xbfe)]?[_0x2ed22f[_0x50ab2a(0xbfe)]]:[]);if(_0x29bc67['length']<=0x1)_0x5754b2[_0x50ab2a(0xe05)](_0x206155),_0x2eca11[_0x50ab2a(0x1472)](_0x206155)&&_0x2eca11[_0x50ab2a(0x10a8)](_0x206155);else{const _0x54ec40=_0x29bc67[_0x21c5ef];_0x2ed22f[_0x50ab2a(0x739)]=_0x2ed22f['imageUrls'][_0x50ab2a(0x1195)](_0x31bfbf=>_0x31bfbf!==_0x54ec40),_0x2ed22f[_0x50ab2a(0x3a1)]&&Array[_0x50ab2a(0xb9b)](_0x2ed22f[_0x50ab2a(0x3a1)])&&_0x2ed22f[_0x50ab2a(0x3a1)][_0x21c5ef]&&_0x2ed22f['prompt'][_0x50ab2a(0x15b0)](_0x21c5ef,0x1),_0x2ed22f[_0x50ab2a(0xbfe)]=_0x2ed22f[_0x50ab2a(0x739)][0x0]||null,_0x2eca11['set'](_0x206155,_0x2ed22f);}_0x27f0a2++;}}}try{await _0x512070[_0x50ab2a(0x1072)]('rw',_0x512070[_0x50ab2a(0xb04)],_0x512070[_0x50ab2a(0x10e5)],async()=>{const _0x21ce9a=_0x50ab2a;_0x8f8d12[_0x21ce9a(0xbdf)]>0x0&&await _0x512070[_0x21ce9a(0xb04)][_0x21ce9a(0xc71)](Array[_0x21ce9a(0x1311)](_0x8f8d12[_0x21ce9a(0xea1)]())),_0x2eca11[_0x21ce9a(0xbdf)]>0x0&&await _0x512070[_0x21ce9a(0x10e5)]['bulkPut'](Array[_0x21ce9a(0x1311)](_0x2eca11[_0x21ce9a(0xea1)]())),_0x5754b2[_0x21ce9a(0xbdf)]>0x0&&await _0x512070[_0x21ce9a(0x10e5)]['bulkDelete'](Array[_0x21ce9a(0x1311)](_0x5754b2));}),_0x24fe75(),await _0x1b445c(),await _0x403a62('删除成功',_0x50ab2a(0xba1)+_0x27f0a2+_0x50ab2a(0x138e)),document[_0x50ab2a(0x9a3)](_0x50ab2a(0x3e5))[_0x50ab2a(0x4d8)]['contains'](_0x50ab2a(0xe9f))&&_0x56abd7(_0x19ddb8[_0x50ab2a(0x859)]),document[_0x50ab2a(0x9a3)]('qzone-screen')['classList']['contains'](_0x50ab2a(0xe9f))&&_0x49acff();}catch(_0xefe67b){console[_0x50ab2a(0x3b7)]('批量删除NAI图片时出错:',_0xefe67b),await _0x403a62('删除失败',_0x50ab2a(0x1564)+_0xefe67b[_0x50ab2a(0xcce)]);}}function _0x38e31c(_0x5e89a9){const _0x144929=_0x48bc6d,_0x5ee478=_0x5e89a9||'NAI_Image';let _0x3c6b56=_0x5ee478[_0x144929(0x1bb)](/[^a-zA-Z0-9\u4e00-\u9fa5\s]/g,'_')[_0x144929(0x1bb)](/\s+/g,'_')['substring'](0x0,0x1e);!_0x3c6b56&&(_0x3c6b56=_0x144929(0xecf));const _0x2afea7=new Date()[_0x144929(0xccf)]()[_0x144929(0x1bb)](/[-:]/g,'')['replace']('T','_')['split']('.')[0x0];return _0x3c6b56+'_'+_0x2afea7+_0x144929(0x1335);}async function _0x4461c8(){const _0x452732=_0x48bc6d;initLanguage();async function _0xff9c69(_0x443e05){const _0x2cbf24=_0x1efc;if(!_0x443e05)return;try{const _0x1f32cc=await _0x443e05[_0x2cbf24(0x13ca)](),_0x4cd6b0=JSON[_0x2cbf24(0x1447)](_0x1f32cc);if(_0x4cd6b0[_0x2cbf24(0x1508)]===_0x2cbf24(0x153f))console[_0x2cbf24(0xe4d)](_0x2cbf24(0xf3a)),await _0x258586(_0x4cd6b0);else{if(_0x4cd6b0[_0x2cbf24(0x10c3)]&&typeof _0x4cd6b0[_0x2cbf24(0x10c3)]===_0x2cbf24(0x12fe)){console[_0x2cbf24(0xe4d)](_0x2cbf24(0x1aa));try{await _0x274014(),await _0x40a914(_0x4cd6b0,_0x443e05['name']);}catch(_0x3b9cd8){console[_0x2cbf24(0x651)](_0x2cbf24(0x10f7),_0x3b9cd8[_0x2cbf24(0xcce)]);}}else throw new Error(_0x2cbf24(0xca4));}}catch(_0x2db492){console[_0x2cbf24(0x3b7)](_0x2cbf24(0x306),_0x2db492),await _0x403a62(_0x2cbf24(0x3e9),'文件解析或应用失败:\x20'+_0x2db492['message']);}}async function _0x40a914(_0x5ad6c9,_0x458a1e){const _0x44eb5d=_0x1efc,_0xb26fb5=_0x458a1e[_0x44eb5d(0x1bb)](/\.json$/i,''),_0x240ce1=await _0x3ab788(_0x44eb5d(0xd9f),_0x44eb5d(0x31e),_0xb26fb5);if(!_0x240ce1||!_0x240ce1[_0x44eb5d(0x13f9)]()){alert(_0x44eb5d(0x672));return;}const _0x2fef04=Object[_0x44eb5d(0xea1)](_0x5ad6c9[_0x44eb5d(0x10c3)])[_0x44eb5d(0xb0a)](_0x3ad896=>{const _0x1528b8=_0x44eb5d;return{'keys':_0x3ad896[_0x1528b8(0xf33)]||[],'comment':_0x3ad896['comment']||_0x1528b8(0xbcc),'content':_0x3ad896[_0x1528b8(0x4e3)]||'','enabled':!_0x3ad896[_0x1528b8(0x1166)]};})[_0x44eb5d(0x1195)](_0x5f58c5=>_0x5f58c5[_0x44eb5d(0x4e3)]);if(_0x2fef04[_0x44eb5d(0x106b)]===0x0){alert('这个\x20Tavern\x20AI\x20世界书中没有找到任何有效的条目。');return;}const _0x541523={'id':'wb_'+Date[_0x44eb5d(0x64b)](),'name':_0x240ce1[_0x44eb5d(0x13f9)](),'content':_0x2fef04,'categoryId':null};await _0x512070[_0x44eb5d(0x8e4)][_0x44eb5d(0xe05)](_0x541523),_0x19ddb8['worldBooks']['push'](_0x541523),await _0x52d7ba(),await _0x403a62(_0x44eb5d(0x125b),_0x44eb5d(0x265)+_0x240ce1+'》。');}async function _0x3aedca(){const _0x3ba9c7=_0x1efc;try{const _0x1fbc62=await _0x512070[_0x3ba9c7(0x8e4)][_0x3ba9c7(0x591)](),_0x54cb2e=await _0x512070[_0x3ba9c7(0x58d)][_0x3ba9c7(0x591)]();if(_0x1fbc62[_0x3ba9c7(0x106b)]===0x0&&_0x54cb2e[_0x3ba9c7(0x106b)]===0x0){alert(_0x3ba9c7(0x73f));return;}const _0x4c6d9e={'type':_0x3ba9c7(0x153f),'version':0x1,'timestamp':Date[_0x3ba9c7(0x64b)](),'books':_0x1fbc62,'categories':_0x54cb2e},_0x205a3c=new Blob([JSON[_0x3ba9c7(0xe1e)](_0x4c6d9e,null,0x2)],{'type':_0x3ba9c7(0xb1f)}),_0x12c788=URL[_0x3ba9c7(0xc56)](_0x205a3c),_0x5324bf=document[_0x3ba9c7(0xe94)]('a');_0x5324bf[_0x3ba9c7(0xe6b)]=_0x12c788,_0x5324bf['download']='EPhone-WorldBooks-'+new Date()[_0x3ba9c7(0xccf)]()[_0x3ba9c7(0x1536)]('T')[0x0]+_0x3ba9c7(0x6db),_0x5324bf[_0x3ba9c7(0x9cc)](),URL[_0x3ba9c7(0xb93)](_0x12c788),await _0x403a62(_0x3ba9c7(0x1217),_0x3ba9c7(0x10dd));}catch(_0x5d6918){console['error']('导出世界书时出错:',_0x5d6918),await _0x403a62(_0x3ba9c7(0x59f),_0x3ba9c7(0x12e0)+_0x5d6918['message']);}}async function _0x258586(_0x6d4ab8){const _0x2ccb9f=_0x1efc;try{if(_0x6d4ab8[_0x2ccb9f(0x1508)]!==_0x2ccb9f(0x153f)||!_0x6d4ab8['books'])throw new Error(_0x2ccb9f(0xd07));const _0x2e997c=await _0x2c9509('导入世界书',_0x2ccb9f(0x44c),{'confirmButtonClass':'btn-danger','confirmText':_0x2ccb9f(0x91c)});if(!_0x2e997c)return;await _0x512070[_0x2ccb9f(0x1072)]('rw',_0x512070[_0x2ccb9f(0x8e4)],_0x512070[_0x2ccb9f(0x58d)],async()=>{const _0x4c48ff=_0x2ccb9f;await _0x512070[_0x4c48ff(0x8e4)][_0x4c48ff(0xe81)](),await _0x512070['worldBookCategories'][_0x4c48ff(0xe81)](),Array[_0x4c48ff(0xb9b)](_0x6d4ab8[_0x4c48ff(0xb45)])&&await _0x512070[_0x4c48ff(0x8e4)][_0x4c48ff(0xc71)](_0x6d4ab8[_0x4c48ff(0xb45)]),Array[_0x4c48ff(0xb9b)](_0x6d4ab8['categories'])&&await _0x512070['worldBookCategories']['bulkPut'](_0x6d4ab8[_0x4c48ff(0xe3e)]);}),_0x19ddb8[_0x2ccb9f(0x8e4)]=await _0x512070[_0x2ccb9f(0x8e4)]['toArray'](),await _0x52d7ba(),await _0x403a62('导入成功',_0x2ccb9f(0x1066));}catch(_0x5e636e){console[_0x2ccb9f(0x3b7)](_0x2ccb9f(0x306),_0x5e636e),await _0x403a62(_0x2ccb9f(0x3e9),_0x2ccb9f(0x10b2)+_0x5e636e[_0x2ccb9f(0xcce)]);}}const _0x2cb7c8=localStorage[_0x452732(0x5de)](_0x452732(0x471));if(_0x2cb7c8){const _0x20fcd6=(Date[_0x452732(0x64b)]()-parseInt(_0x2cb7c8))/(0x3e8*0x3c);_0x20fcd6>0x5&&_0x21773b(_0x20fcd6);}_0x3e48f7(),window[_0x452732(0x30f)]=_0x35df44,window[_0x452732(0x3bd)]=_0x20fce2,window[_0x452732(0xaa0)]=_0x3d708d,window[_0x452732(0x135e)]=_0x19f6e7,window[_0x452732(0x44f)]=_0x36df03,window[_0x452732(0x1373)]=_0x202cda,window['openCharWallet']=_0x200c78,window['switchToCharHomeScreen']=_0x29d49c,window[_0x452732(0xf62)]=_0x21c6bf;const _0x56e5d5=document['createElement']('div');_0x56e5d5['id']=_0x452732(0xdfc),_0x56e5d5['innerHTML']=_0x452732(0x477),document[_0x452732(0x9a3)](_0x452732(0x598))[_0x452732(0x983)](_0x56e5d5);const _0x311048=document[_0x452732(0xe94)](_0x452732(0x20f));_0x311048['id']='global-custom-style',document['head'][_0x452732(0x983)](_0x311048),_0x176e91['panelEl']=document[_0x452732(0x9a3)](_0x452732(0xc42)),_0x176e91[_0x452732(0xf1f)]=document[_0x452732(0x9a3)](_0x452732(0x155f));const _0x3224d8=localStorage[_0x452732(0x5de)]('ephone-theme')||'light';_0x16496f(_0x3224d8);const _0x531b85=document['createElement']('style');_0x531b85['id']=_0x452732(0xdcb),document[_0x452732(0x1552)][_0x452732(0x983)](_0x531b85);const _0xda4442=document['createElement']('style');_0xda4442['id']='preview-bubble-style',document[_0x452732(0x1552)][_0x452732(0x983)](_0xda4442),_0x1253e3('','#chat-messages',_0x452732(0xdcb)),_0x1253e3('','#settings-preview-area',_0x452732(0x2a8)),window['openRenderingRulesScreen']=_0x20fce2,window['showScreen']=_0x35df44,window['renderChatListProxy']=_0xec8072,window['renderApiSettingsProxy']=_0x30d5fd,window[_0x452732(0x132d)]=_0x21e3fb,window['renderWorldBookScreenProxy']=_0x52d7ba,await _0x11ed48(),_0x154868(),_0x585f8c(_0x19ddb8['globalSettings'][_0x452732(0x1370)]),_0x5833f8(_0x19ddb8[_0x452732(0x4c8)][_0x452732(0x439)]),_0x432678(_0x19ddb8[_0x452732(0x4c8)][_0x452732(0xed0)]),await _0x5a3301(),_0x15e853(_0x19ddb8[_0x452732(0x4c8)][_0x452732(0x796)]);const _0x452854=parseInt(localStorage[_0x452732(0x5de)](_0x452732(0x17b)))||0x0;_0x28172c(_0x452854);_0x19ddb8[_0x452732(0x4c8)]&&_0x19ddb8[_0x452732(0x4c8)]['fontUrl']&&_0x124e17(_0x19ddb8[_0x452732(0x4c8)][_0x452732(0x12ce)]);_0x379c9d(),setInterval(_0x379c9d,0x3e8*0x1e),_0x28dc10(),_0x16a703(),_0xe2a513(),_0x537b6a(),document[_0x452732(0x9a3)](_0x452732(0x711))[_0x452732(0x954)](_0x452732(0x9cc),_0x3a3aa7=>{const _0x13d5bd=_0x452732;_0x3a3aa7[_0x13d5bd(0xa41)][_0x13d5bd(0x4d8)][_0x13d5bd(0x1222)]('rules-tab')&&_0xcd7c4e(_0x3a3aa7[_0x13d5bd(0xa41)][_0x13d5bd(0xd8d)]['categoryId']);}),document['getElementById']('add-new-rule-btn')[_0x452732(0x954)](_0x452732(0x9cc),()=>_0x434538(null)),document[_0x452732(0x9a3)](_0x452732(0x1101))['addEventListener'](_0x452732(0x9cc),()=>{const _0x2fe548=_0x452732;document[_0x2fe548(0x9a3)](_0x2fe548(0x71c))[_0x2fe548(0x4d8)]['remove']('visible');}),document[_0x452732(0x9a3)](_0x452732(0x13ed))[_0x452732(0x954)](_0x452732(0x9cc),_0x3eaada),document['getElementById']('pat-btn')[_0x452732(0x954)]('click',()=>{const _0x346091=_0x452732;if(_0x19ddb8[_0x346091(0x859)]&&!_0x19ddb8[_0x346091(0xb04)][_0x19ddb8['activeChatId']]['isGroup']){const _0x4a57ad=_0x19ddb8[_0x346091(0xb04)][_0x19ddb8[_0x346091(0x859)]];_0x2462b3(_0x4a57ad['id'],_0x4a57ad[_0x346091(0x339)]);}});let _0x19fbb2=null;function _0x58c81a(_0x170cca){const _0x42ac71=_0x452732;_0x19fbb2=_0x170cca;const _0x205558=_0x19ddb8['chats'][_0x19ddb8['activeChatId']],_0x5da057=_0x205558[_0x42ac71(0xf9c)]['find'](_0x54e251=>_0x54e251['id']===_0x170cca);if(!_0x5da057)return;const _0x2b5d36=document[_0x42ac71(0x9a3)](_0x42ac71(0x1e9));_0x2b5d36[_0x42ac71(0x766)]=_0x5da057[_0x42ac71(0x14d8)]?_0x42ac71(0x585):_0x42ac71(0x112b),document[_0x42ac71(0x9a3)](_0x42ac71(0x39a))['classList'][_0x42ac71(0xe05)](_0x42ac71(0xc09));}async function _0x2425a6(){const _0x3ac411=_0x452732;if(!_0x19fbb2)return;const _0x47c4b4=_0x19ddb8[_0x3ac411(0xb04)][_0x19ddb8[_0x3ac411(0x859)]],_0x163d5f=_0x47c4b4['announcements'][_0x3ac411(0xd62)](_0x47b9d7=>_0x47b9d7['id']===_0x19fbb2);_0x163d5f&&(_0x163d5f[_0x3ac411(0x14d8)]=!_0x163d5f[_0x3ac411(0x14d8)],await _0x512070[_0x3ac411(0xb04)][_0x3ac411(0xd4d)](_0x47c4b4),_0x3b0850()),document[_0x3ac411(0x9a3)](_0x3ac411(0x39a))[_0x3ac411(0x4d8)][_0x3ac411(0x133d)]('visible');}async function _0x29c7da(){const _0x1d9014=_0x452732;if(!_0x19fbb2)return;const _0x3df757=await _0x2c9509('确认删除',_0x1d9014(0xaed),{'confirmButtonClass':_0x1d9014(0xf5b)});if(_0x3df757){const _0x264498=_0x19ddb8[_0x1d9014(0xb04)][_0x19ddb8['activeChatId']];_0x264498[_0x1d9014(0xf9c)]=_0x264498['announcements']['filter'](_0x169515=>_0x169515['id']!==_0x19fbb2),await _0x512070[_0x1d9014(0xb04)][_0x1d9014(0xd4d)](_0x264498),_0x3b0850();}document[_0x1d9014(0x9a3)]('announcement-actions-modal')[_0x1d9014(0x4d8)][_0x1d9014(0x133d)](_0x1d9014(0xc09));}document['getElementById'](_0x452732(0x92a))['addEventListener'](_0x452732(0x9cc),_0x5551e4),document[_0x452732(0x9a3)](_0x452732(0x6d4))[_0x452732(0x954)](_0x452732(0x9cc),_0x41cbd0=>{if(_0x41cbd0['target']===_0x363d75)_0x5551e4();}),document[_0x452732(0x9a3)]('export-data-btn')['addEventListener']('click',async()=>{const _0x2115cc=_0x452732,_0x4505ba=await _0x49acac('选择导出方式',[{'text':_0x2115cc(0xe9c),'value':_0x2115cc(0x457)},{'text':_0x2115cc(0x620),'value':_0x2115cc(0xb82)},{'text':_0x2115cc(0xa06),'value':_0x2115cc(0xf11)}]);if(_0x4505ba===_0x2115cc(0x457))_0x453335();else{if(_0x4505ba===_0x2115cc(0xb82))_0x48a0d4();else _0x4505ba===_0x2115cc(0xf11)&&_0x475665();}}),document[_0x452732(0x9a3)]('cleanup-data-btn')[_0x452732(0x954)](_0x452732(0x9cc),_0x5f36f4),document[_0x452732(0x9a3)](_0x452732(0xcd0))[_0x452732(0x954)](_0x452732(0xbbc),_0x10911c=>{const _0x2bb27f=_0x452732;document[_0x2bb27f(0x9a3)](_0x2bb27f(0x3db))[_0x2bb27f(0x20f)][_0x2bb27f(0x115d)]=_0x10911c[_0x2bb27f(0xa41)][_0x2bb27f(0x944)]?_0x2bb27f(0x10c8):_0x2bb27f(0x8e0);}),document[_0x452732(0x9a3)]('import-btn')[_0x452732(0x954)](_0x452732(0x9cc),()=>document[_0x452732(0x9a3)](_0x452732(0x9fb))[_0x452732(0x9cc)]()),document['getElementById']('time-perception-toggle')[_0x452732(0x954)](_0x452732(0xbbc),_0x25504e=>{const _0x13f5ec=_0x452732;document[_0x13f5ec(0x9a3)](_0x13f5ec(0x775))[_0x13f5ec(0x20f)][_0x13f5ec(0x115d)]=_0x25504e[_0x13f5ec(0xa41)][_0x13f5ec(0x944)]?_0x13f5ec(0x10c8):_0x13f5ec(0x8e0);}),document[_0x452732(0x9a3)]('import-data-input')[_0x452732(0x954)](_0x452732(0xbbc),_0x12b89f=>_0xe24a9b(_0x12b89f['target'][_0x452732(0x104e)][0x0])),document['getElementById']('import-card-input')[_0x452732(0x954)]('change',_0x294ad5),document[_0x452732(0x9a3)](_0x452732(0x99f))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x24e327=_0x452732;_0x283ecc={},_0x1253e3('',_0x24e327(0x8bf),_0x24e327(0xdcb)),_0x1253e3('',_0x24e327(0x277),_0x24e327(0x2a8)),_0x501f17(),_0x19ddb8[_0x24e327(0x859)]=null,_0x35df44(_0x24e327(0xd7c));}),document[_0x452732(0x9a3)]('add-chat-btn')['addEventListener']('click',async()=>{const _0x285c5f=_0x452732,_0x27f763=await _0x49acac(_0x285c5f(0xd5b),[{'text':_0x285c5f(0x1063),'value':_0x285c5f(0x8c5)},{'text':_0x285c5f(0xa63),'value':'import_card'}]);if(_0x27f763==='manual'){const _0x1617b1=await _0x3ab788(_0x285c5f(0xcc1),_0x285c5f(0x846));if(!_0x1617b1||!_0x1617b1[_0x285c5f(0x13f9)]())return;const _0x477c25=await _0x3ab788(_0x285c5f(0x1367),_0x285c5f(0x11b6));if(!_0x477c25||!_0x477c25[_0x285c5f(0x13f9)]())return;const _0x5d7f18=_0x285c5f(0x97a)+Date['now'](),_0x6e9ae0={'id':_0x5d7f18,'name':_0x1617b1[_0x285c5f(0x13f9)](),'originalName':_0x477c25[_0x285c5f(0x13f9)](),'isGroup':![],'isPinned':![],'unreadCount':0x0,'relationship':{'status':_0x285c5f(0xf81),'blockedTimestamp':null,'applicationReason':''},'status':{'text':'在线','lastUpdate':Date[_0x285c5f(0x64b)](),'isBusy':![]},'settings':{'aiPersona':_0x285c5f(0x29a),'myPersona':_0x285c5f(0x5b1),'myNickname':'我','maxMemory':0xa,'aiAvatar':_0x4f81ff,'myAvatar':_0x4f81ff,'background':'','theme':_0x285c5f(0xd5f),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[],'aiAvatarLibrary':[],'myAvatarLibrary':[],'enableBackgroundActivity':!![],'actionCooldownMinutes':0xf,'enableTimePerception':!![],'isOfflineMode':![],'offlineMinLength':0x64,'offlineMaxLength':0x12c,'offlinePresetId':null,'timeZone':'Asia/Shanghai'},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[],'thoughtsHistory':[]};_0x19ddb8[_0x285c5f(0xb04)][_0x5d7f18]=_0x6e9ae0,await _0x512070['chats'][_0x285c5f(0xd4d)](_0x6e9ae0),_0xec8072();}else{if(_0x27f763==='import_card')try{await _0x274014(),document[_0x285c5f(0x9a3)](_0x285c5f(0xfb9))[_0x285c5f(0x9cc)]();}catch(_0x56e8ff){console['warn'](_0x285c5f(0x225),_0x56e8ff[_0x285c5f(0xcce)]);}}}),document[_0x452732(0x9a3)](_0x452732(0x9ed))[_0x452732(0x954)](_0x452732(0x9cc),_0x420fac),document[_0x452732(0x9a3)](_0x452732(0xfe3))[_0x452732(0x954)](_0x452732(0x9cc),()=>document[_0x452732(0x9a3)](_0x452732(0x64c))['classList'][_0x452732(0x133d)](_0x452732(0xc09))),document[_0x452732(0x9a3)]('transfer-confirm-btn')['addEventListener'](_0x452732(0x9cc),_0x512832),document[_0x452732(0x9a3)]('listen-together-btn')['addEventListener'](_0x452732(0x9cc),_0x3d708d),document[_0x452732(0x9a3)](_0x452732(0x36a))[_0x452732(0x954)]('click',()=>_0x58ff6d(!![])),document[_0x452732(0x9a3)](_0x452732(0x122c))[_0x452732(0x954)]('click',_0x32a259),document[_0x452732(0x9a3)]('music-play-pause-btn')[_0x452732(0x954)](_0x452732(0x9cc),_0x124e77),document[_0x452732(0x9a3)]('music-next-btn')[_0x452732(0x954)](_0x452732(0x9cc),_0x205d59),document[_0x452732(0x9a3)](_0x452732(0x3b8))['addEventListener'](_0x452732(0x9cc),_0x3aa407),document[_0x452732(0x9a3)]('music-mode-btn')['addEventListener'](_0x452732(0x9cc),_0x1506b2),document[_0x452732(0x9a3)](_0x452732(0x139f))['addEventListener']('click',()=>{const _0xd24425=_0x452732;_0x28db92(),document[_0xd24425(0x9a3)](_0xd24425(0xabf))[_0xd24425(0x4d8)][_0xd24425(0xe05)](_0xd24425(0xc09));}),document[_0x452732(0x9a3)](_0x452732(0x11ab))[_0x452732(0x954)]('click',()=>document[_0x452732(0x9a3)](_0x452732(0xabf))[_0x452732(0x4d8)][_0x452732(0x133d)](_0x452732(0xc09))),document[_0x452732(0x9a3)](_0x452732(0x140b))[_0x452732(0x954)](_0x452732(0x9cc),_0x58e467),document[_0x452732(0x9a3)]('add-song-local-btn')[_0x452732(0x954)]('click',()=>document[_0x452732(0x9a3)](_0x452732(0xdfd))[_0x452732(0x9cc)]()),document[_0x452732(0x9a3)](_0x452732(0xdfd))[_0x452732(0x954)]('change',_0x4300aa),document[_0x452732(0x9a3)](_0x452732(0xaa2))[_0x452732(0x954)](_0x452732(0x9cc),_0x294a3e=>{const _0xc1b87=_0x452732,_0x3596c7=_0x294a3e[_0xc1b87(0xa41)],_0x20deb1=parseInt(_0x3596c7[_0xc1b87(0xd8d)][_0xc1b87(0x111b)]);if(isNaN(_0x20deb1))return;if(_0x3596c7['classList'][_0xc1b87(0x1222)](_0xc1b87(0x9b0)))_0x37bae6(_0x20deb1);else{if(_0x3596c7[_0xc1b87(0x4d8)][_0xc1b87(0x1222)](_0xc1b87(0xb30)))_0xfb1ee7(_0x20deb1);else{if(_0x3596c7[_0xc1b87(0x4d8)][_0xc1b87(0x1222)](_0xc1b87(0x6f2)))_0x4bffca(_0x20deb1);else _0x3596c7[_0xc1b87(0x4d8)][_0xc1b87(0x1222)]('delete-track-btn')&&_0x45aba2(_0x20deb1);}}}),_0x4a7bb9[_0x452732(0x954)]('ended',()=>{const _0x3cc695=_0x452732;document[_0x3cc695(0x9a3)](_0x3cc695(0x54c))[_0x3cc695(0x4d8)][_0x3cc695(0x133d)]('spinning'),_0x205d59();});const _0x18091c=document['getElementById'](_0x452732(0xf84));document[_0x452732(0x9a3)](_0x452732(0x12d4))['addEventListener']('click',()=>{const _0x4ec816=_0x452732;_0x590cab();const _0x43c57d=_0x18091c[_0x4ec816(0x7b2)][_0x4ec816(0x13f9)]();if(!_0x43c57d||!_0x19ddb8['activeChatId'])return;const _0x5135cf=_0x19ddb8['chats'][_0x19ddb8[_0x4ec816(0x859)]],_0x3a3911={'role':_0x4ec816(0x20d),'content':_0x43c57d,'timestamp':Date['now']()};_0x40ff22&&(_0x3a3911[_0x4ec816(0x6f7)]=_0x40ff22),_0x1ef393(_0x3a3911,_0x5135cf),((async()=>{const _0x23dbee=_0x4ec816;_0x5135cf['history'][_0x23dbee(0x1c4)](_0x3a3911),await _0x512070[_0x23dbee(0xb04)][_0x23dbee(0xd4d)](_0x5135cf),_0xec8072();})()),_0x18091c[_0x4ec816(0x7b2)]='',_0x18091c[_0x4ec816(0x20f)][_0x4ec816(0x397)]=_0x4ec816(0xaf8),_0x18091c[_0x4ec816(0xdcf)](),_0x40142f(),document[_0x4ec816(0x7c3)][_0x4ec816(0x4d8)][_0x4ec816(0x133d)](_0x4ec816(0x23c));}),document[_0x452732(0x9a3)](_0x452732(0x11cc))[_0x452732(0x954)]('click',_0x55bf11),_0x18091c[_0x452732(0x954)](_0x452732(0xe64),_0x538316=>{const _0x5e358c=_0x452732;_0x538316[_0x5e358c(0xf33)]===_0x5e358c(0x1576)&&!_0x538316['shiftKey']&&(_0x538316['preventDefault'](),document[_0x5e358c(0x9a3)](_0x5e358c(0x12d4))['click']());}),document[_0x452732(0x9a3)](_0x452732(0x1434))[_0x452732(0x954)]('change',async _0x353cf4=>{const _0x3633ed=_0x452732,_0x1a7636=_0x353cf4[_0x3633ed(0xa41)][_0x3633ed(0x104e)][0x0];if(_0x1a7636){const _0x412344=await new Promise((_0x489901,_0x4c7b9d)=>{const _0x4e61c1=_0x3633ed,_0x565013=new FileReader();_0x565013['onload']=()=>_0x489901(_0x565013[_0x4e61c1(0x5c9)]),_0x565013[_0x4e61c1(0xb8b)]=()=>_0x4c7b9d(_0x565013['error']),_0x565013[_0x4e61c1(0xdd8)](_0x1a7636);});_0x4acb77=_0x412344,_0x21e3fb();}}),document['getElementById'](_0x452732(0x101e))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x2c3a3d=_0x452732;_0x4acb77&&(_0x19ddb8[_0x2c3a3d(0x4c8)]['wallpaper']=_0x4acb77),_0x19ddb8[_0x2c3a3d(0x4c8)]['globalCss']=document[_0x2c3a3d(0x9a3)]('global-css-input')[_0x2c3a3d(0x7b2)][_0x2c3a3d(0x13f9)](),_0x19ddb8[_0x2c3a3d(0x4c8)][_0x2c3a3d(0x1437)]=document[_0x2c3a3d(0x9a3)]('notification-sound-url-input')['value'][_0x2c3a3d(0x13f9)](),_0x19ddb8['globalSettings']['showStatusBar']=document[_0x2c3a3d(0x9a3)]('status-bar-toggle-switch')[_0x2c3a3d(0x944)],_0x19ddb8[_0x2c3a3d(0x4c8)][_0x2c3a3d(0x1370)]=document[_0x2c3a3d(0x9a3)]('phone-frame-toggle-switch')[_0x2c3a3d(0x944)],_0x19ddb8['globalSettings'][_0x2c3a3d(0xed0)]=document[_0x2c3a3d(0x9a3)]('minimal-chat-ui-switch')[_0x2c3a3d(0x944)],_0x19ddb8[_0x2c3a3d(0x4c8)][_0x2c3a3d(0x9f4)]=document['getElementById']('dynamic-island-music-toggle-switch')[_0x2c3a3d(0x944)],_0x19ddb8['globalSettings'][_0x2c3a3d(0x439)]=document[_0x2c3a3d(0x9a3)]('detach-status-bar-switch')[_0x2c3a3d(0x944)],await _0x512070[_0x2c3a3d(0x4c8)][_0x2c3a3d(0xd4d)](_0x19ddb8[_0x2c3a3d(0x4c8)]),_0x28dc10(),_0x1b6cea(),_0x4acb77=null,_0xe2a513(),_0x2c06c4(),_0x15e853(_0x19ddb8[_0x2c3a3d(0x4c8)][_0x2c3a3d(0x796)]),_0x154868(),_0x432678(_0x19ddb8[_0x2c3a3d(0x4c8)][_0x2c3a3d(0xed0)]),alert(_0x2c3a3d(0x18c)),_0x35df44(_0x2c3a3d(0x663));});const _0x24568d=document[_0x452732(0x9a3)](_0x452732(0xdd5));_0x24568d[_0x452732(0x954)](_0x452732(0x50d),()=>{const {scrollTop:_0x253bea,scrollHeight:_0x2d3f26,clientHeight:_0x1cbb8c}=_0x24568d;_0x2d3f26-_0x253bea-_0x1cbb8c<_0x1cbb8c&&(!_0x5b6e4b&&_0x380baf());}),document[_0x452732(0x9a3)](_0x452732(0x20c))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x2680fa=_0x452732;_0x19ddb8[_0x2680fa(0xd22)][_0x2680fa(0xcb7)]=document[_0x2680fa(0x9a3)](_0x2680fa(0x5bb))[_0x2680fa(0x7b2)]['trim'](),_0x19ddb8['apiConfig']['apiKey']=document[_0x2680fa(0x9a3)](_0x2680fa(0xae1))['value']['trim'](),_0x19ddb8['apiConfig']['model']=document[_0x2680fa(0x9a3)](_0x2680fa(0x11dd))[_0x2680fa(0x7b2)],_0x19ddb8[_0x2680fa(0xd22)][_0x2680fa(0xd41)]=document[_0x2680fa(0x9a3)](_0x2680fa(0x1438))[_0x2680fa(0x7b2)][_0x2680fa(0x13f9)](),_0x19ddb8['apiConfig'][_0x2680fa(0xe2f)]=document['getElementById'](_0x2680fa(0x536))['value']['trim'](),_0x19ddb8['apiConfig'][_0x2680fa(0x9cf)]=document[_0x2680fa(0x9a3)]('minimax-model-select')[_0x2680fa(0x7b2)],_0x19ddb8[_0x2680fa(0xd22)][_0x2680fa(0x132b)]=document[_0x2680fa(0x9a3)]('secondary-proxy-url')[_0x2680fa(0x7b2)]['trim'](),_0x19ddb8[_0x2680fa(0xd22)][_0x2680fa(0x278)]=document[_0x2680fa(0x9a3)](_0x2680fa(0x10cb))[_0x2680fa(0x7b2)][_0x2680fa(0x13f9)](),_0x19ddb8['apiConfig'][_0x2680fa(0xa20)]=document[_0x2680fa(0x9a3)]('secondary-model-select')[_0x2680fa(0x7b2)],await _0x512070['apiConfig']['put'](_0x19ddb8[_0x2680fa(0xd22)]);const _0x1de18f=document[_0x2680fa(0x9a3)]('background-activity-switch'),_0x35ce48=document['getElementById'](_0x2680fa(0x9be)),_0x5c66cf=document[_0x2680fa(0x9a3)](_0x2680fa(0x349));_0x19ddb8[_0x2680fa(0x4c8)][_0x2680fa(0x106e)]=_0x1de18f[_0x2680fa(0x944)],_0x19ddb8['globalSettings']['backgroundActivityInterval']=parseInt(_0x35ce48['value'])||0x3c,_0x19ddb8[_0x2680fa(0x4c8)][_0x2680fa(0x1e7)]=parseFloat(_0x5c66cf[_0x2680fa(0x7b2)])||0x1,_0x19ddb8[_0x2680fa(0x4c8)][_0x2680fa(0x853)]=document[_0x2680fa(0x9a3)](_0x2680fa(0x1133))[_0x2680fa(0x944)],_0x19ddb8[_0x2680fa(0x4c8)][_0x2680fa(0x11ef)]=parseInt(document['getElementById']('chat-render-window-input')['value'])||0x32,_0x19ddb8['globalSettings']['chatListRenderWindow']=parseInt(document[_0x2680fa(0x9a3)](_0x2680fa(0x1425))['value'])||0x1e,_0x19ddb8[_0x2680fa(0x4c8)][_0x2680fa(0x4a2)]=parseFloat(document['getElementById'](_0x2680fa(0x143c))[_0x2680fa(0x7b2)]),await _0x512070[_0x2680fa(0x4c8)][_0x2680fa(0xd4d)](_0x19ddb8['globalSettings']),_0x1e34b7();_0x19ddb8[_0x2680fa(0x4c8)][_0x2680fa(0x106e)]?(_0x176181(),console[_0x2680fa(0xe4d)](_0x2680fa(0xc4d)+_0x19ddb8[_0x2680fa(0x4c8)]['backgroundActivityInterval']+'秒')):console[_0x2680fa(0xe4d)](_0x2680fa(0x9cd));const _0x1df9ec=document['getElementById']('novelai-switch')['checked'],_0x1d6c17=document[_0x2680fa(0x9a3)](_0x2680fa(0xfee))['value'],_0x329416=document[_0x2680fa(0x9a3)](_0x2680fa(0x4a1))[_0x2680fa(0x7b2)][_0x2680fa(0x13f9)]();localStorage[_0x2680fa(0x28a)](_0x2680fa(0x95b),_0x1df9ec),localStorage[_0x2680fa(0x28a)]('novelai-model',_0x1d6c17),localStorage[_0x2680fa(0x28a)](_0x2680fa(0x4a1),_0x329416),alert(_0x2680fa(0xbd8));});const _0x574840=document[_0x452732(0x9a3)](_0x452732(0xae1));_0x574840['addEventListener'](_0x452732(0xdcf),_0x421406=>{const _0x313802=_0x452732;_0x421406['target'][_0x313802(0x4bc)](_0x313802(0x1508),'text');}),_0x574840[_0x452732(0x954)]('blur',_0x3cd83c=>{const _0xbd1148=_0x452732;_0x3cd83c[_0xbd1148(0xa41)][_0xbd1148(0x4bc)]('type','password');});async function _0x4d0080(_0xfd7de5,_0x1f311d,_0x21ea8b){const _0x5537a8=_0x452732,_0x2de4d8=document['getElementById'](_0xfd7de5)['value'][_0x5537a8(0x13f9)](),_0x5dacc7=document[_0x5537a8(0x9a3)](_0x1f311d)[_0x5537a8(0x7b2)][_0x5537a8(0x13f9)]();if(!_0x2de4d8||!_0x5dacc7)return alert('请先填写对应的反代地址和密钥');try{let _0x4a4e02=_0x2de4d8===GEMINI_API_URL;const _0x368376=await fetch(_0x4a4e02?GEMINI_API_URL+_0x5537a8(0xe39)+getRandomValue(_0x5dacc7):_0x2de4d8+_0x5537a8(0x11a0),_0x4a4e02?undefined:{'headers':{'Authorization':_0x5537a8(0x1265)+_0x5dacc7}});if(!_0x368376['ok'])throw new Error(_0x5537a8(0x1163));const _0x51c61c=await _0x368376[_0x5537a8(0xa5d)]();let _0x37eb50=_0x4a4e02?_0x51c61c['models']['map'](_0x120eca=>({'id':_0x120eca[_0x5537a8(0x1561)][_0x5537a8(0x1536)]('/')[0x1]||_0x120eca[_0x5537a8(0x1561)]})):_0x51c61c[_0x5537a8(0x38c)];const _0x4734a0=document[_0x5537a8(0x9a3)](_0x21ea8b);_0x4734a0[_0x5537a8(0xeb2)]='';const _0x3e8942=_0x21ea8b===_0x5537a8(0x11dd)?_0x19ddb8[_0x5537a8(0xd22)]['model']:_0x19ddb8[_0x5537a8(0xd22)][_0x5537a8(0xa20)];_0x37eb50[_0x5537a8(0x15c1)](_0x12a832=>{const _0x4551c2=_0x5537a8,_0x3b4625=document['createElement']('option');_0x3b4625[_0x4551c2(0x7b2)]=_0x12a832['id'],_0x3b4625['textContent']=_0x12a832['id'];if(_0x12a832['id']===_0x3e8942)_0x3b4625[_0x4551c2(0x154b)]=!![];_0x4734a0['appendChild'](_0x3b4625);}),alert(_0x5537a8(0x1478));}catch(_0x37d433){alert(_0x5537a8(0x13ce)+_0x37d433['message']);}}document[_0x452732(0x9a3)]('fetch-models-btn')['addEventListener'](_0x452732(0x9cc),()=>{const _0x1be6eb=_0x452732;_0x4d0080(_0x1be6eb(0x5bb),_0x1be6eb(0xae1),'model-select');}),document[_0x452732(0x9a3)](_0x452732(0xda5))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x352122=_0x452732;_0x4d0080(_0x352122(0xaa9),_0x352122(0x10cb),_0x352122(0x1413));}),document[_0x452732(0x9a3)](_0x452732(0xfb5))['addEventListener']('click',async()=>{const _0xf84e10=_0x452732,_0x1ab556=await _0x3ab788('创建世界书','请输入书名');if(_0x1ab556&&_0x1ab556[_0xf84e10(0x13f9)]()){const _0x863c9={'id':_0xf84e10(0xc83)+Date[_0xf84e10(0x64b)](),'name':_0x1ab556[_0xf84e10(0x13f9)](),'content':''};await _0x512070[_0xf84e10(0x8e4)][_0xf84e10(0xe05)](_0x863c9),_0x19ddb8['worldBooks'][_0xf84e10(0x1c4)](_0x863c9),_0x52d7ba(),_0x3f3988(_0x863c9['id']);}}),document['getElementById'](_0x452732(0x8fb))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x3cb731=_0x452732;if(!_0x79f0bb)return;const _0x35ac4e=_0x19ddb8[_0x3cb731(0x8e4)][_0x3cb731(0xd62)](_0x39918a=>_0x39918a['id']===_0x79f0bb);if(!_0x35ac4e)return;const _0x52824c=document[_0x3cb731(0x9a3)](_0x3cb731(0x1038))[_0x3cb731(0x7b2)][_0x3cb731(0x13f9)]();if(!_0x52824c){alert(_0x3cb731(0x30a));return;}_0x35ac4e[_0x3cb731(0x1561)]=_0x52824c;const _0x172f64=document[_0x3cb731(0x9a3)](_0x3cb731(0x4c5))[_0x3cb731(0x7b2)];_0x35ac4e['categoryId']=_0x172f64?parseInt(_0x172f64):null;const _0x2272b5=document[_0x3cb731(0x9a3)]('world-book-entries-container'),_0x10e23f=_0x2272b5['querySelectorAll']('.message-editor-block'),_0x4ddc87=[];_0x10e23f[_0x3cb731(0x15c1)](_0x45b502=>{const _0x4ca42e=_0x3cb731,_0x5a1a27=_0x45b502[_0x4ca42e(0xc86)](_0x4ca42e(0xdd0))[_0x4ca42e(0x7b2)][_0x4ca42e(0x13f9)](),_0x5c7ed8=_0x45b502['querySelector'](_0x4ca42e(0x1383))[_0x4ca42e(0x7b2)]['trim'](),_0x9494b0=_0x45b502[_0x4ca42e(0xc86)](_0x4ca42e(0x304))[_0x4ca42e(0x944)];_0x5c7ed8&&_0x4ddc87[_0x4ca42e(0x1c4)]({'comment':_0x45b502[_0x4ca42e(0xc86)](_0x4ca42e(0x13c4))[_0x4ca42e(0x7b2)][_0x4ca42e(0x13f9)](),'keys':_0x5a1a27?_0x5a1a27[_0x4ca42e(0x1536)](',')[_0x4ca42e(0xb0a)](_0x1e9a3f=>_0x1e9a3f[_0x4ca42e(0x13f9)]())['filter'](_0x12966a=>_0x12966a):[],'content':_0x5c7ed8,'enabled':_0x9494b0});}),_0x35ac4e[_0x3cb731(0x4e3)]=_0x4ddc87,await _0x512070['worldBooks']['put'](_0x35ac4e),document[_0x3cb731(0x9a3)](_0x3cb731(0xfd2))['textContent']=_0x52824c,_0x79f0bb=null,_0x35df44(_0x3cb731(0x1450)),await _0x52d7ba();}),document[_0x452732(0x9a3)](_0x452732(0x10f8))['addEventListener']('click',async _0x4363b1=>{const _0xaefb5a=_0x452732,_0x372647=_0x4363b1[_0xaefb5a(0xa41)]['closest'](_0xaefb5a(0x735));if(_0x372647){_0x4363b1['stopPropagation']();const _0x583b29=_0x4363b1[_0xaefb5a(0xa41)][_0xaefb5a(0x94c)](_0xaefb5a(0x5c4));if(_0x583b29){const _0x16d028=parseInt(_0x583b29['dataset'][_0xaefb5a(0xd73)]);!isNaN(_0x16d028)&&await _0x22d17a(_0x16d028,_0x372647);}return;}const _0x4e93ef=_0x4363b1[_0xaefb5a(0xa41)][_0xaefb5a(0x94c)](_0xaefb5a(0xd29));if(_0x4e93ef){const _0x39f7e0=_0x19ddb8[_0xaefb5a(0xb04)][_0x19ddb8[_0xaefb5a(0x859)]];if(!_0x39f7e0)return;_0x34ea56(_0x4e93ef);const _0x1e37ce=_0x4e93ef['closest'](_0xaefb5a(0x5c4)),_0x1645ed=_0x1e37ce?_0x1e37ce[_0xaefb5a(0xc86)](_0xaefb5a(0x24d)):null;if(_0x4e93ef[_0xaefb5a(0xd8d)]['voiceId']&&_0x1645ed&&_0x1645ed[_0xaefb5a(0x20f)][_0xaefb5a(0x115d)]===_0xaefb5a(0x10c8)){if(_0x39f7e0[_0xaefb5a(0x136b)]){console[_0xaefb5a(0xe4d)](_0xaefb5a(0xd76));return;}if(_0x39f7e0[_0xaefb5a(0x450)]['enableTts']===![]){console['log']('“'+_0x39f7e0['name']+_0xaefb5a(0x754));return;}_0x28cab8(_0x4e93ef);}return;}const _0x4d44cd=_0x4363b1[_0xaefb5a(0xa41)][_0xaefb5a(0x94c)](_0xaefb5a(0xc23));if(_0x4d44cd){const _0x1a155c=_0x4d44cd[_0xaefb5a(0x94c)](_0xaefb5a(0x5c4));if(_0x1a155c){const _0x3b3c08=parseInt(_0x1a155c[_0xaefb5a(0xd8d)][_0xaefb5a(0xd73)]);if(!isNaN(_0x3b3c08)){_0x20d5fa(_0x3b3c08);return;}}}const _0x2039ee=_0x4363b1['target'][_0xaefb5a(0x94c)](_0xaefb5a(0x6ae));if(_0x2039ee){const _0xff0cf0=_0x2039ee[_0xaefb5a(0x94c)](_0xaefb5a(0x5c4));if(_0xff0cf0){const _0x28feb1=parseInt(_0xff0cf0[_0xaefb5a(0xd8d)][_0xaefb5a(0xd73)]),_0x53051e=_0x2039ee[_0xaefb5a(0xd8d)][_0xaefb5a(0x1253)];if(!isNaN(_0x28feb1)&&_0x53051e){await _0x32a338(_0x28feb1,_0x53051e);return;}}}const _0x58853f=_0x4363b1[_0xaefb5a(0xa41)]['closest'](_0xaefb5a(0x67f));if(_0x58853f){const _0x4686f0=parseInt(_0x58853f[_0xaefb5a(0xd8d)][_0xaefb5a(0xb92)]);if(!isNaN(_0x4686f0)){const _0x5b79e0=await _0x512070['qzonePosts'][_0xaefb5a(0x14ee)](_0x4686f0);if(_0x5b79e0){let _0x4ebaa0='';const _0x4edcfe=_0x5b79e0['authorId']===_0xaefb5a(0x20d)?_0x19ddb8['qzoneSettings'][_0xaefb5a(0x246)]:_0x19ddb8[_0xaefb5a(0xb04)][_0x5b79e0['authorId']]?.[_0xaefb5a(0x1561)]||'未知作者';if(_0x5b79e0[_0xaefb5a(0x1508)]===_0xaefb5a(0x23d))_0x4ebaa0=_0x5b79e0[_0xaefb5a(0x4e3)];else{_0x4ebaa0=_0x5b79e0[_0xaefb5a(0x6b9)]||'';if(_0x5b79e0[_0xaefb5a(0xbfe)])_0x4ebaa0+=_0xaefb5a(0x840);if(_0x5b79e0[_0xaefb5a(0x14bb)])_0x4ebaa0+=_0xaefb5a(0x9c2)+_0x5b79e0['hiddenContent']+']';}_0x403a62(_0xaefb5a(0x131a)+_0x4edcfe+_0xaefb5a(0xab5),_0x4ebaa0[_0xaefb5a(0x1bb)](/\n/g,'<br>'));}else _0x403a62('提示','这条动态的原始数据已被彻底清除。');}return;}const _0x5e12a9=_0x4363b1[_0xaefb5a(0xa41)][_0xaefb5a(0x94c)]('.ai-generated-image');if(_0x5e12a9){const _0x13b5ae=_0x5e12a9[_0xaefb5a(0xd8d)][_0xaefb5a(0x3ef)];if(_0x13b5ae)_0x403a62(_0xaefb5a(0x142e),_0x13b5ae);return;}const _0x295dea=_0x4363b1[_0xaefb5a(0xa41)]['closest'](_0xaefb5a(0x6a1));if(_0x295dea&&_0x295dea[_0xaefb5a(0xd8d)][_0xaefb5a(0xc3c)]){const _0x3dfce0=parseInt(_0x295dea['dataset']['originalTimestamp']);!isNaN(_0x3dfce0)&&_0x36c2d8(_0x3dfce0);}const _0x331457=_0x4363b1[_0xaefb5a(0xa41)]['closest']('.gift-card');if(_0x331457){const _0x288e9e=_0x331457[_0xaefb5a(0x94c)](_0xaefb5a(0x5c4));_0x288e9e&&_0x5b607e(parseInt(_0x288e9e['dataset'][_0xaefb5a(0xd73)]));}const _0x4a1263=_0x4363b1['target']['closest'](_0xaefb5a(0x438));if(_0x4a1263){const _0x59b1ca=_0x4a1263[_0xaefb5a(0x94c)]('.message-bubble');if(_0x59b1ca&&_0x59b1ca['dataset'][_0xaefb5a(0xd73)]){const _0x5ad144=parseInt(_0x59b1ca[_0xaefb5a(0xd8d)]['timestamp']);_0x359abc(_0x5ad144);}}const _0x390816=_0x4363b1[_0xaefb5a(0xa41)][_0xaefb5a(0x94c)](_0xaefb5a(0xc21));if(_0x390816){const _0x187642=parseInt(_0x390816['dataset'][_0xaefb5a(0xf41)]);if(isNaN(_0x187642))return;const _0x1961cd=_0x4363b1[_0xaefb5a(0xa41)][_0xaefb5a(0x94c)](_0xaefb5a(0x7eb));if(_0x1961cd&&!_0x390816[_0xaefb5a(0x4d8)][_0xaefb5a(0x1222)]('closed')){_0x5d3826(_0x187642,_0x1961cd['dataset'][_0xaefb5a(0x43a)]);return;}const _0x2dd543=_0x4363b1[_0xaefb5a(0xa41)]['closest'](_0xaefb5a(0xcab));if(_0x2dd543){_0x390816[_0xaefb5a(0x4d8)][_0xaefb5a(0x1222)](_0xaefb5a(0x8e3))?_0x1cb465(_0x187642):_0x4b1639(_0x187642);return;}_0x390816[_0xaefb5a(0x4d8)][_0xaefb5a(0x1222)](_0xaefb5a(0x8e3))&&_0x1cb465(_0x187642);}const _0x47d7aa=_0x4363b1['target']['closest'](_0xaefb5a(0x135b));if(_0x47d7aa){const _0x3c1f39=_0x19ddb8[_0xaefb5a(0xb04)][_0x19ddb8[_0xaefb5a(0x859)]],_0x24d4cb=_0x47d7aa[_0xaefb5a(0x94c)]('.message-wrapper');if(_0x3c1f39&&_0x24d4cb){const _0x196bf1=parseInt(_0x24d4cb['dataset'][_0xaefb5a(0xd73)]),_0x207b84=_0x3c1f39[_0xaefb5a(0x1f0)][_0xaefb5a(0xd62)](_0x58ac94=>_0x58ac94['timestamp']===_0x196bf1);if(_0x207b84&&_0x207b84[_0xaefb5a(0x506)]){let _0x5b60da='';const _0xf33fdb=_0x207b84[_0xaefb5a(0x506)];_0xf33fdb['originalType']===_0xaefb5a(0x13ca)?_0x5b60da=_0xaefb5a(0x3b6)+_0xf33fdb[_0xaefb5a(0x1568)]+'\x22':_0x5b60da=_0xaefb5a(0xbba)+_0xf33fdb[_0xaefb5a(0x32c)]+_0xaefb5a(0x4fb),_0x403a62('已撤回的消息',_0x5b60da);}}}const _0x99d6d8=_0x4363b1[_0xaefb5a(0xa41)]['closest'](_0xaefb5a(0xac2));if(_0x99d6d8&&_0x99d6d8['closest']('.message-bubble.is-link-share')){const _0x27ba70=parseInt(_0x99d6d8[_0xaefb5a(0xd8d)][_0xaefb5a(0xd73)]);_0xc92cb8(_0x27ba70);}const _0x5e1bae=_0x4363b1[_0xaefb5a(0xa41)][_0xaefb5a(0x94c)]('.message-bubble');if(_0x5e1bae&&_0x5e1bae[_0xaefb5a(0x4d8)]['contains']('ai')&&_0x5e1bae[_0xaefb5a(0x4d8)]['contains'](_0xaefb5a(0x13f2))&&_0x5e1bae[_0xaefb5a(0xd8d)][_0xaefb5a(0x27d)]===_0xaefb5a(0x550)){const _0xb3589d=parseInt(_0x5e1bae[_0xaefb5a(0xd8d)]['timestamp']);!isNaN(_0xb3589d)&&_0x1e9621(_0xb3589d);}});const _0xae34a1=document[_0x452732(0x9a3)](_0x452732(0xd5a)),_0x1f4768=document[_0x452732(0xc86)]('.custom-multiselect\x20.select-box'),_0x2df00c=document['getElementById'](_0x452732(0x90c));function _0xdfdb97(){const _0x4d35bd=_0x452732,_0x327edf=_0x2df00c[_0x4d35bd(0x131c)](_0x4d35bd(0xb05)),_0x5985a7=document[_0x4d35bd(0xc86)](_0x4d35bd(0x3cd));if(_0x327edf[_0x4d35bd(0x106b)]===0x0)_0x5985a7[_0x4d35bd(0x766)]=_0x4d35bd(0x1593);else{if(_0x327edf[_0x4d35bd(0x106b)]>0x2)_0x5985a7[_0x4d35bd(0x766)]=_0x4d35bd(0x33a)+_0x327edf[_0x4d35bd(0x106b)]+_0x4d35bd(0x1286);else{const _0x437814=Array['from'](_0x327edf)[_0x4d35bd(0xb0a)](_0x2db4e4=>{const _0x1905b0=_0x4d35bd;return _0x2db4e4[_0x1905b0(0x1254)]['textContent'][_0x1905b0(0x13f9)]();});_0x5985a7[_0x4d35bd(0x766)]=_0x437814[_0x4d35bd(0x3b9)](',\x20');}}}_0x1f4768[_0x452732(0x954)](_0x452732(0x9cc),_0x54d842=>{const _0x1d51e1=_0x452732;_0x54d842[_0x1d51e1(0x63a)](),_0x2df00c[_0x1d51e1(0x4d8)][_0x1d51e1(0xc02)](_0x1d51e1(0xc09)),_0x1f4768['classList'][_0x1d51e1(0xc02)](_0x1d51e1(0x14ac));}),document[_0x452732(0x9a3)]('world-book-checkboxes-container')[_0x452732(0x954)](_0x452732(0xbbc),_0xdfdb97),window[_0x452732(0x954)](_0x452732(0x9cc),_0x58b7ad=>{const _0x356c0f=_0x452732;!document[_0x356c0f(0xc86)](_0x356c0f(0xeb6))[_0x356c0f(0x1222)](_0x58b7ad[_0x356c0f(0xa41)])&&(_0x2df00c[_0x356c0f(0x4d8)][_0x356c0f(0x133d)](_0x356c0f(0xc09)),_0x1f4768[_0x356c0f(0x4d8)][_0x356c0f(0x133d)]('expanded'));}),document['getElementById'](_0x452732(0x1417))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x2d2d92=_0x452732;_0x294e9d();if(!_0x19ddb8['activeChatId'])return;const _0x4ecae4=_0x19ddb8[_0x2d2d92(0xb04)][_0x19ddb8[_0x2d2d92(0x859)]],_0x5cdedb=_0x4ecae4[_0x2d2d92(0x136b)],_0x56f07f=document[_0x2d2d92(0x9a3)]('switch-greeting-group');!_0x5cdedb&&_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0xacc)]&&_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0xacc)]['length']>0x0?_0x56f07f[_0x2d2d92(0x20f)]['display']=_0x2d2d92(0x10c8):_0x56f07f[_0x2d2d92(0x20f)]['display']=_0x2d2d92(0x8e0);document[_0x2d2d92(0x9a3)](_0x2d2d92(0x109c))[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]=_0x2d2d92(0x10c8),document[_0x2d2d92(0x9a3)](_0x2d2d92(0x194))[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]=_0x2d2d92(0x10c8),document[_0x2d2d92(0x9a3)](_0x2d2d92(0x90f))[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]=_0x2d2d92(0x10c8),document[_0x2d2d92(0x9a3)](_0x2d2d92(0x10d3))[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]=_0x5cdedb?_0x2d2d92(0x10c8):_0x2d2d92(0x8e0),document[_0x2d2d92(0x9a3)](_0x2d2d92(0x5ed))[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]=_0x5cdedb?_0x2d2d92(0x8e0):'block',document[_0x2d2d92(0x9a3)](_0x2d2d92(0x4c6))[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]=_0x5cdedb?_0x2d2d92(0x10c8):_0x2d2d92(0x8e0),document[_0x2d2d92(0x9a3)](_0x2d2d92(0x708))[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]=_0x5cdedb?_0x2d2d92(0x10c8):'none',document[_0x2d2d92(0x9a3)]('ai-persona-group')['style']['display']=_0x5cdedb?_0x2d2d92(0x8e0):_0x2d2d92(0x10c8),document[_0x2d2d92(0x9a3)]('ai-avatar-group')[_0x2d2d92(0x20f)]['display']=_0x5cdedb?_0x2d2d92(0x8e0):'block',document['getElementById'](_0x2d2d92(0x4cb))[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]=_0x5cdedb?_0x2d2d92(0x8e0):_0x2d2d92(0x10c8),document[_0x2d2d92(0x9a3)](_0x2d2d92(0xfb0))[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]=_0x5cdedb?_0x2d2d92(0x8e0):_0x2d2d92(0x10c8),document['getElementById'](_0x2d2d92(0x58b))[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]=_0x5cdedb?_0x2d2d92(0x8e0):_0x2d2d92(0x10c8),document['getElementById'](_0x2d2d92(0x707))[_0x2d2d92(0x20f)]['display']=_0x5cdedb?_0x2d2d92(0x8e0):_0x2d2d92(0x10c8),document[_0x2d2d92(0x9a3)](_0x2d2d92(0x7f6))['style'][_0x2d2d92(0x115d)]=_0x5cdedb?_0x2d2d92(0x8e0):_0x2d2d92(0x10c8),document[_0x2d2d92(0x9a3)](_0x2d2d92(0x14a5))[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]=_0x5cdedb?_0x2d2d92(0x8e0):_0x2d2d92(0x10c8),document['getElementById'](_0x2d2d92(0xee1))[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]=_0x5cdedb?_0x2d2d92(0x10c8):_0x2d2d92(0x8e0),document['getElementById'](_0x2d2d92(0x2cb))[_0x2d2d92(0x7b2)]=_0x4ecae4['name'],document['getElementById'](_0x2d2d92(0x15d8))[_0x2d2d92(0x7b2)]=_0x4ecae4['settings'][_0x2d2d92(0x1e3)],document[_0x2d2d92(0x9a3)](_0x2d2d92(0x798))['src']=_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0x1af)]||(_0x5cdedb?_0xde5144:_0x4f81ff),document[_0x2d2d92(0x9a3)]('max-memory')[_0x2d2d92(0x7b2)]=_0x4ecae4[_0x2d2d92(0x450)]['maxMemory'],document[_0x2d2d92(0x9a3)]('linked-memory-count')[_0x2d2d92(0x7b2)]=_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0xb09)]||0xa;const _0x5191b0=document[_0x2d2d92(0x9a3)](_0x2d2d92(0x8f7)),_0x4bd8c2=document[_0x2d2d92(0x9a3)](_0x2d2d92(0x152a));_0x4ecae4[_0x2d2d92(0x450)]['background']?(_0x5191b0[_0x2d2d92(0x10d4)]=_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0x5f1)],_0x5191b0[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]=_0x2d2d92(0x10c8),_0x4bd8c2[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]=_0x2d2d92(0xe97)):(_0x5191b0[_0x2d2d92(0x20f)]['display']='none',_0x4bd8c2[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]='none');document[_0x2d2d92(0x9a3)]('lyrics-position-group')[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]=_0x5cdedb?'none':_0x2d2d92(0x10c8),document[_0x2d2d92(0x9a3)](_0x2d2d92(0x52b))[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]=_0x5cdedb?_0x2d2d92(0x8e0):_0x2d2d92(0x10c8),document[_0x2d2d92(0x9a3)](_0x2d2d92(0xefc))[_0x2d2d92(0x20f)]['display']=_0x5cdedb?_0x2d2d92(0x10c8):_0x2d2d92(0x8e0);const _0x5ac1de=document[_0x2d2d92(0x9a3)](_0x2d2d92(0x60e)),_0x2dbc82=document[_0x2d2d92(0x9a3)](_0x2d2d92(0x775));_0x5ac1de['checked']=_0x4ecae4['settings']['enableTimePerception'],_0x2dbc82[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]=_0x5ac1de['checked']?_0x2d2d92(0x10c8):_0x2d2d92(0x8e0);const _0x4fefcb=document[_0x2d2d92(0x9a3)](_0x2d2d92(0xef3)),_0x23fdc3=Intl[_0x2d2d92(0x2fc)](_0x2d2d92(0x6fd));_0x4fefcb[_0x2d2d92(0xeb2)]='',_0x23fdc3['forEach'](_0x3a04c5=>{const _0x19c9b6=_0x2d2d92,_0x2c362d=document[_0x19c9b6(0xe94)](_0x19c9b6(0x43a));_0x2c362d[_0x19c9b6(0x7b2)]=_0x3a04c5,_0x2c362d[_0x19c9b6(0x766)]=_0x3a04c5,_0x4fefcb[_0x19c9b6(0x983)](_0x2c362d);}),_0x4fefcb[_0x2d2d92(0x7b2)]=_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0x6fd)]||_0x2d2d92(0xb4b);if(_0x5cdedb)document[_0x2d2d92(0x9a3)](_0x2d2d92(0x60d))[_0x2d2d92(0x944)]=_0x4ecae4[_0x2d2d92(0x450)]['enableBackgroundActivity'],document[_0x2d2d92(0x9a3)](_0x2d2d92(0xe11))[_0x2d2d92(0x7b2)]=_0x4ecae4[_0x2d2d92(0x450)]['myNickname']||'',document[_0x2d2d92(0x9a3)](_0x2d2d92(0x84c))[_0x2d2d92(0x10d4)]=_0x4ecae4['settings'][_0x2d2d92(0x20a)]||_0xdb6252,document[_0x2d2d92(0x9a3)]('group-action-cooldown-input')[_0x2d2d92(0x7b2)]=_0x4ecae4['settings'][_0x2d2d92(0x605)]||0xa,document[_0x2d2d92(0x9a3)](_0x2d2d92(0x52b))[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]='none',_0x522d5c(_0x4ecae4['members']);else{document[_0x2d2d92(0x9a3)](_0x2d2d92(0x52b))[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]=_0x2d2d92(0x10c8),document['getElementById'](_0x2d2d92(0x6e1))[_0x2d2d92(0x944)]=_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0x106e)],document[_0x2d2d92(0x9a3)](_0x2d2d92(0x15c5))[_0x2d2d92(0x944)]=_0x4ecae4['settings']['injectLatestThought'];const _0x5642c4=document['getElementById'](_0x2d2d92(0xcd0)),_0x3d5c9a=document[_0x2d2d92(0x9a3)]('offline-mode-options'),_0x4f4393=document[_0x2d2d92(0x9a3)](_0x2d2d92(0x1088)),_0x70fd7e=document[_0x2d2d92(0x9a3)]('offline-max-length-input');_0x5642c4['checked']=_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0x1267)]||![],_0x3d5c9a[_0x2d2d92(0x20f)]['display']=_0x5642c4[_0x2d2d92(0x944)]?'block':_0x2d2d92(0x8e0),_0x4f4393['value']=_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0xf97)]||0x64,_0x70fd7e[_0x2d2d92(0x7b2)]=_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0xa4a)]||0x12c,await _0x84884(_0x4ecae4),document[_0x2d2d92(0x9a3)]('ai-original-name-input')[_0x2d2d92(0x7b2)]=_0x4ecae4[_0x2d2d92(0x339)],document[_0x2d2d92(0x9a3)]('ai-voice-id-input')[_0x2d2d92(0x7b2)]=_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0x551)]||'',document[_0x2d2d92(0x9a3)](_0x2d2d92(0x71b))[_0x2d2d92(0x944)]=_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0x1547)]!==![],document['getElementById']('ai-persona')[_0x2d2d92(0x7b2)]=_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0x1c3)],document[_0x2d2d92(0x9a3)](_0x2d2d92(0xdf8))[_0x2d2d92(0x10d4)]=_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0x4fe)]||_0x4f81ff,document[_0x2d2d92(0x9a3)](_0x2d2d92(0x10e1))[_0x2d2d92(0x7b2)]=_0x4ecae4[_0x2d2d92(0x450)]['myNickname']||'我',document[_0x2d2d92(0x9a3)](_0x2d2d92(0xf9d))['value']=_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0x605)]||0xa;const _0x408f71=document[_0x2d2d92(0x9a3)](_0x2d2d92(0x130c));_0x408f71['innerHTML']=_0x2d2d92(0x1049);const _0x12040a=await _0x512070['qzoneGroups'][_0x2d2d92(0x591)]();_0x12040a[_0x2d2d92(0x15c1)](_0x144516=>{const _0x5d64e8=_0x2d2d92,_0x1a37f9=document[_0x5d64e8(0xe94)](_0x5d64e8(0x43a));_0x1a37f9[_0x5d64e8(0x7b2)]=_0x144516['id'],_0x1a37f9[_0x5d64e8(0x766)]=_0x144516[_0x5d64e8(0x1561)];if(_0x4ecae4[_0x5d64e8(0x4ab)]===_0x144516['id'])_0x1a37f9[_0x5d64e8(0x154b)]=!![];_0x408f71[_0x5d64e8(0x983)](_0x1a37f9);});const _0x233e35=_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0x13a1)]||{'vertical':'top','horizontal':_0x2d2d92(0xd4f),'offset':0xa};document['getElementById'](_0x2d2d92(0x129c))[_0x2d2d92(0x7b2)]=_0x233e35[_0x2d2d92(0xba3)],document[_0x2d2d92(0x9a3)]('lyrics-horizontal-pos')[_0x2d2d92(0x7b2)]=_0x233e35[_0x2d2d92(0x146b)],document[_0x2d2d92(0x9a3)](_0x2d2d92(0xbca))[_0x2d2d92(0x7b2)]=_0x233e35['offset'];}const _0x5b445c=document[_0x2d2d92(0x9a3)](_0x2d2d92(0x90c));_0x5b445c[_0x2d2d92(0xeb2)]='';const [_0x15ad17,_0x5c8071]=await Promise[_0x2d2d92(0xbf1)]([_0x512070[_0x2d2d92(0x58d)]['toArray'](),_0x512070[_0x2d2d92(0x8e4)][_0x2d2d92(0x591)]()]),_0x224a21=new Set(_0x4ecae4['settings'][_0x2d2d92(0x9c4)]||[]);if(_0x5c8071[_0x2d2d92(0x106b)]===0x0)_0x5b445c['innerHTML']=_0x2d2d92(0x7f5);else{_0x15ad17[_0x2d2d92(0x15c1)](_0x1860e2=>{const _0x468f3d=_0x2d2d92,_0xefe327=_0x5c8071[_0x468f3d(0x1195)](_0x4a0547=>_0x4a0547[_0x468f3d(0x922)]===_0x1860e2['id']);if(_0xefe327[_0x468f3d(0x106b)]>0x0){const _0x466b2b=document[_0x468f3d(0xe94)]('h4');_0x466b2b[_0x468f3d(0x766)]=_0x1860e2['name'],_0x466b2b[_0x468f3d(0x20f)]['cssText']='margin:\x2010px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;',_0x5b445c[_0x468f3d(0x983)](_0x466b2b),_0xefe327['forEach'](_0x2af6f5=>{const _0x3a21d0=_0x468f3d,_0x417dac=_0x224a21[_0x3a21d0(0x1472)](_0x2af6f5['id']),_0x58e69d=document[_0x3a21d0(0xe94)](_0x3a21d0(0x667));_0x58e69d[_0x3a21d0(0xeb2)]='<input\x20type=\x22checkbox\x22\x20value=\x22book_'+_0x2af6f5['id']+'\x22\x20'+(_0x417dac?_0x3a21d0(0x944):'')+'>\x20'+_0x2af6f5[_0x3a21d0(0x1561)],_0x5b445c[_0x3a21d0(0x983)](_0x58e69d);});}});const _0x40ed79=_0x5c8071[_0x2d2d92(0x1195)](_0x21a8e0=>!_0x21a8e0[_0x2d2d92(0x922)]);if(_0x40ed79[_0x2d2d92(0x106b)]>0x0){const _0x180dcb=document[_0x2d2d92(0xe94)]('h4');_0x180dcb[_0x2d2d92(0x766)]='未分类',_0x180dcb[_0x2d2d92(0x20f)][_0x2d2d92(0x6c0)]=_0x2d2d92(0x9d2),_0x5b445c[_0x2d2d92(0x983)](_0x180dcb),_0x40ed79['forEach'](_0x3c93d3=>{const _0x2ef272=_0x2d2d92,_0x5bac82=_0x224a21[_0x2ef272(0x1472)](_0x3c93d3['id']),_0x54adf5=document[_0x2ef272(0xe94)](_0x2ef272(0x667));_0x54adf5[_0x2ef272(0xeb2)]=_0x2ef272(0x15b1)+_0x3c93d3['id']+'\x22\x20'+(_0x5bac82?_0x2ef272(0x944):'')+'>\x20'+_0x3c93d3[_0x2ef272(0x1561)],_0x5b445c[_0x2ef272(0x983)](_0x54adf5);});}}_0xdfdb97();const _0x4ca453=document[_0x2d2d92(0x9a3)](_0x2d2d92(0x15c9)),_0xc60e49=document[_0x2d2d92(0x9a3)]('linked-memory-selection'),_0x305e01=document[_0x2d2d92(0x9a3)](_0x2d2d92(0x15b9)),_0x5be996=_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0x120e)]||[];_0x4ca453[_0x2d2d92(0x944)]=_0x5be996[_0x2d2d92(0x106b)]>0x0,_0xc60e49[_0x2d2d92(0x20f)][_0x2d2d92(0x115d)]=_0x4ca453[_0x2d2d92(0x944)]?'block':_0x2d2d92(0x8e0),_0x305e01[_0x2d2d92(0xeb2)]='',Object[_0x2d2d92(0xea1)](_0x19ddb8[_0x2d2d92(0xb04)])[_0x2d2d92(0x15c1)](_0xe1ab93=>{const _0x531dee=_0x2d2d92;if(_0xe1ab93['id']===_0x4ecae4['id'])return;const _0xe0e6fd=_0x5be996[_0x531dee(0x478)](_0xe1ab93['id']),_0x12a0a0=_0xe1ab93['isGroup']?_0x531dee(0xa9a):'[私聊]',_0x52cf46=document[_0x531dee(0xe94)]('label');_0x52cf46[_0x531dee(0xeb2)]=_0x531dee(0x570)+_0xe1ab93['id']+'\x22\x20'+(_0xe0e6fd?'checked':'')+'>\x20'+_0x12a0a0+'\x20'+_0xe1ab93[_0x531dee(0x1561)],_0x305e01[_0x531dee(0x983)](_0x52cf46);});function _0x58cda3(){const _0xdfc94f=_0x2d2d92,_0x38faf4=_0x305e01[_0xdfc94f(0x131c)](_0xdfc94f(0xb05)),_0x47f87d=_0xc60e49['querySelector'](_0xdfc94f(0x3cd));if(_0x38faf4[_0xdfc94f(0x106b)]===0x0)_0x47f87d[_0xdfc94f(0x766)]='--\x20点击选择\x20--';else _0x38faf4[_0xdfc94f(0x106b)]>0x2?_0x47f87d['textContent']=_0xdfc94f(0x33a)+_0x38faf4[_0xdfc94f(0x106b)]+'\x20项':_0x47f87d[_0xdfc94f(0x766)]=Array[_0xdfc94f(0x1311)](_0x38faf4)[_0xdfc94f(0xb0a)](_0x17d6e6=>_0x17d6e6['parentElement'][_0xdfc94f(0x766)][_0xdfc94f(0x13f9)]())[_0xdfc94f(0x3b9)](',\x20');}_0x58cda3(),_0x4ca453[_0x2d2d92(0x954)](_0x2d2d92(0xbbc),()=>{const _0x12f8f7=_0x2d2d92;_0xc60e49[_0x12f8f7(0x20f)][_0x12f8f7(0x115d)]=_0x4ca453[_0x12f8f7(0x944)]?_0x12f8f7(0x10c8):_0x12f8f7(0x8e0);});const _0x328b90=_0xc60e49['querySelector'](_0x2d2d92(0x1f1)),_0x1ac098=_0x328b90[_0x2d2d92(0x173)](!![]);_0x328b90['parentNode'][_0x2d2d92(0x15ab)](_0x1ac098,_0x328b90),_0x1ac098[_0x2d2d92(0x954)](_0x2d2d92(0x9cc),_0x4fcfa9=>{const _0x4b1c94=_0x2d2d92;_0x4fcfa9[_0x4b1c94(0x63a)](),_0x305e01[_0x4b1c94(0x4d8)][_0x4b1c94(0xc02)]('visible'),_0x1ac098[_0x4b1c94(0x4d8)][_0x4b1c94(0xc02)]('expanded');}),_0x305e01['addEventListener']('change',_0x58cda3);const _0x46d4c0=document[_0x2d2d92(0xc86)](_0x2d2d92(0x10d2)+(_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0x910)]||_0x2d2d92(0xd5f))+'\x22]');if(_0x46d4c0)_0x46d4c0[_0x2d2d92(0x944)]=!![];const _0xe4e217=document[_0x2d2d92(0x9a3)](_0x2d2d92(0xf38));_0xe4e217['value']=_0x4ecae4['settings'][_0x2d2d92(0xdea)]||0xd,document[_0x2d2d92(0x9a3)](_0x2d2d92(0x1071))['textContent']=_0xe4e217['value']+'px';const _0x14ad5b=document[_0x2d2d92(0x9a3)](_0x2d2d92(0x750));_0x14ad5b['value']=_0x4ecae4[_0x2d2d92(0x450)]['customCss']||'',_0x2628c1(),document[_0x2d2d92(0x9a3)]('auto-memory-toggle')[_0x2d2d92(0x944)]=_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0x1525)]||![],document['getElementById'](_0x2d2d92(0x96a))[_0x2d2d92(0x7b2)]=_0x4ecae4[_0x2d2d92(0x450)][_0x2d2d92(0xdf7)]||0x14,setTimeout(()=>{const _0x23b9b5=_0x2d2d92;_0x570aeb();const _0x5baa00=[_0x23b9b5(0xbd6),_0x23b9b5(0x15d8),_0x23b9b5(0x791),'linked-memory-count','auto-memory-toggle',_0x23b9b5(0x96a),_0x23b9b5(0xcd0),_0x23b9b5(0x1088),_0x23b9b5(0x452),_0x23b9b5(0xc3f)];_0x5baa00[_0x23b9b5(0x15c1)](_0x335a54=>{const _0x4dc862=_0x23b9b5,_0xa027ab=document[_0x4dc862(0x9a3)](_0x335a54);_0xa027ab&&_0xa027ab[_0x4dc862(0x954)](_0x4dc862(0x1b4),_0x570aeb);}),document[_0x23b9b5(0x9a3)](_0x23b9b5(0x90c))[_0x23b9b5(0x954)]('change',_0x570aeb),document['getElementById'](_0x23b9b5(0x15b9))[_0x23b9b5(0x954)]('change',_0x570aeb),document['getElementById'](_0x23b9b5(0x15c9))[_0x23b9b5(0x954)]('change',_0x570aeb);},0x64),_0x35df44('chat-settings-screen');});function _0x522d5c(_0x5c7fe0){const _0x51e7eb=_0x452732,_0x4f0f78=document[_0x51e7eb(0x9a3)](_0x51e7eb(0x12de));_0x4f0f78['innerHTML']='',_0x5c7fe0['forEach'](_0x21f521=>{const _0x3dfbe2=_0x51e7eb,_0x537682=document[_0x3dfbe2(0xe94)]('div');_0x537682['className']='member-editor',_0x537682[_0x3dfbe2(0xd8d)][_0x3dfbe2(0xd66)]=_0x21f521['id'];const _0x37b6be=_0x21f521['avatar']||(_0x19ddb8[_0x3dfbe2(0xb04)][_0x21f521['id']]?_0x19ddb8[_0x3dfbe2(0xb04)][_0x21f521['id']]['settings'][_0x3dfbe2(0x4fe)]:_0x451ae9);_0x537682[_0x3dfbe2(0xeb2)]='<img\x20src=\x22'+_0x37b6be+'\x22\x20alt=\x22'+_0x21f521[_0x3dfbe2(0xaf0)]+_0x3dfbe2(0xd6a)+_0x21f521['groupNickname']+_0x3dfbe2(0x826),_0x537682[_0x3dfbe2(0x954)](_0x3dfbe2(0x9cc),()=>_0x22b46d(_0x21f521['id'])),_0x4f0f78[_0x3dfbe2(0x983)](_0x537682);});}document['getElementById'](_0x452732(0x1263))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x3ffd12=_0x452732;if(!_0x2713c8)return;const _0x54710d=_0x19ddb8[_0x3ffd12(0xb04)][_0x19ddb8['activeChatId']],_0x138281=_0x54710d[_0x3ffd12(0xcca)][_0x3ffd12(0xd62)](_0x52be9c=>_0x52be9c['id']===_0x2713c8);if(!_0x138281)return;const _0x5d80e4=document[_0x3ffd12(0x9a3)](_0x3ffd12(0x2d2))[_0x3ffd12(0x7b2)][_0x3ffd12(0x13f9)]();if(!_0x5d80e4){alert(_0x3ffd12(0x361));return;}_0x138281[_0x3ffd12(0xaf0)]=_0x5d80e4,_0x138281['persona']=document[_0x3ffd12(0x9a3)]('member-persona-input')[_0x3ffd12(0x7b2)];const _0x5141f9=document[_0x3ffd12(0x9a3)](_0x3ffd12(0x9dc))['src'];_0x138281['avatar']=_0x5141f9;const _0x2a2861=_0x19ddb8[_0x3ffd12(0xb04)][_0x138281['id']];_0x2a2861&&(_0x2a2861[_0x3ffd12(0x450)][_0x3ffd12(0x4fe)]=_0x5141f9,await _0x512070['chats'][_0x3ffd12(0xd4d)](_0x2a2861)),await _0x512070[_0x3ffd12(0xb04)][_0x3ffd12(0xd4d)](_0x54710d),_0x522d5c(_0x54710d[_0x3ffd12(0xcca)]),document[_0x3ffd12(0x9a3)](_0x3ffd12(0x1053))[_0x3ffd12(0x4d8)][_0x3ffd12(0x133d)](_0x3ffd12(0xc09)),_0x2713c8=null;});function _0x22b46d(_0x4944a8){const _0x169e15=_0x452732;_0x2713c8=_0x4944a8;const _0x5502a5=_0x19ddb8[_0x169e15(0xb04)][_0x19ddb8['activeChatId']],_0x408df1=_0x5502a5[_0x169e15(0xcca)][_0x169e15(0xd62)](_0x2ae754=>_0x2ae754['id']===_0x4944a8);if(!_0x408df1)return;document[_0x169e15(0x9a3)](_0x169e15(0x2d2))[_0x169e15(0x7b2)]=_0x408df1['groupNickname'],document['getElementById']('member-persona-input')[_0x169e15(0x7b2)]=_0x408df1['persona'];const _0x4abf63=_0x408df1[_0x169e15(0xf3f)]||(_0x19ddb8[_0x169e15(0xb04)][_0x408df1['id']]?_0x19ddb8['chats'][_0x408df1['id']][_0x169e15(0x450)][_0x169e15(0x4fe)]:_0x451ae9);document['getElementById']('member-avatar-preview')[_0x169e15(0x10d4)]=_0x4abf63,document[_0x169e15(0x9a3)](_0x169e15(0x1053))[_0x169e15(0x4d8)][_0x169e15(0xe05)](_0x169e15(0xc09));}document[_0x452732(0x9a3)](_0x452732(0xd96))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x53f063=_0x452732;document[_0x53f063(0x9a3)](_0x53f063(0x1053))[_0x53f063(0x4d8)][_0x53f063(0x133d)](_0x53f063(0xc09)),_0x2713c8=null;}),document[_0x452732(0x9a3)](_0x452732(0x1263))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x449e=_0x452732;if(!_0x2713c8)return;const _0x16652d=_0x19ddb8[_0x449e(0xb04)][_0x19ddb8[_0x449e(0x859)]],_0x346f38=_0x16652d[_0x449e(0xcca)][_0x449e(0xd62)](_0xceee4b=>_0xceee4b['id']===_0x2713c8);if(!_0x346f38)return;const _0x74051d=document[_0x449e(0x9a3)]('member-name-input')['value'][_0x449e(0x13f9)]();if(!_0x74051d){alert('群昵称不能为空！');return;}_0x346f38[_0x449e(0xaf0)]=_0x74051d,_0x346f38[_0x449e(0xcd4)]=document['getElementById'](_0x449e(0xa1f))[_0x449e(0x7b2)];const _0x293337=document[_0x449e(0x9a3)](_0x449e(0x9dc))[_0x449e(0x10d4)];_0x346f38['avatar']=_0x293337;const _0xd70bbf=_0x19ddb8[_0x449e(0xb04)][_0x346f38['id']];_0xd70bbf&&(_0xd70bbf['settings'][_0x449e(0x4fe)]=_0x293337,await _0x512070['chats']['put'](_0xd70bbf)),await _0x512070['chats'][_0x449e(0xd4d)](_0x16652d),_0x522d5c(_0x16652d[_0x449e(0xcca)]),document[_0x449e(0x9a3)](_0x449e(0x1053))[_0x449e(0x4d8)][_0x449e(0x133d)](_0x449e(0xc09)),_0x2713c8=null;}),document['getElementById'](_0x452732(0x8e2))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x522b49=_0x452732;document[_0x522b49(0x9a3)](_0x522b49(0x9e7))['checked']=!![];}),document[_0x452732(0x9a3)](_0x452732(0x5f7))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x20dd1b=_0x452732;if(!_0x19ddb8[_0x20dd1b(0x859)])return;const _0x2bf6ce=_0x19ddb8[_0x20dd1b(0xb04)][_0x19ddb8[_0x20dd1b(0x859)]],_0x152c6d=_0x2bf6ce['settings']['isOfflineMode']||![],_0x43dbaf=document[_0x20dd1b(0x9a3)]('chat-name-input')['value'][_0x20dd1b(0x13f9)]();if(!_0x43dbaf)return alert(_0x20dd1b(0x39b));if(!_0x2bf6ce[_0x20dd1b(0x136b)]&&_0x43dbaf!==_0x2bf6ce[_0x20dd1b(0x1561)]){if(!_0x2bf6ce['nameHistory'])_0x2bf6ce[_0x20dd1b(0x1058)]=[];if(!_0x2bf6ce['nameHistory'][_0x20dd1b(0x478)](_0x2bf6ce['name']))_0x2bf6ce['nameHistory']['push'](_0x2bf6ce[_0x20dd1b(0x1561)]);}_0x2bf6ce[_0x20dd1b(0x1561)]=_0x43dbaf;const _0x2e6810=document[_0x20dd1b(0xc86)](_0x20dd1b(0x9f1));_0x2bf6ce[_0x20dd1b(0x450)][_0x20dd1b(0x910)]=_0x2e6810?_0x2e6810['value']:_0x20dd1b(0xd5f),_0x2bf6ce[_0x20dd1b(0x450)][_0x20dd1b(0xdea)]=parseInt(document[_0x20dd1b(0x9a3)](_0x20dd1b(0xf38))[_0x20dd1b(0x7b2)]),_0x2bf6ce[_0x20dd1b(0x450)][_0x20dd1b(0xc8b)]=document[_0x20dd1b(0x9a3)]('custom-css-input')[_0x20dd1b(0x7b2)][_0x20dd1b(0x13f9)](),_0x2bf6ce['settings']['myPersona']=document['getElementById'](_0x20dd1b(0x15d8))[_0x20dd1b(0x7b2)],_0x2bf6ce[_0x20dd1b(0x450)][_0x20dd1b(0x1af)]=document[_0x20dd1b(0x9a3)]('my-avatar-preview')[_0x20dd1b(0x10d4)],_0x2bf6ce[_0x20dd1b(0x450)][_0x20dd1b(0x152f)]=parseInt(document['getElementById']('max-memory')[_0x20dd1b(0x7b2)])||0xa,_0x2bf6ce['settings'][_0x20dd1b(0xb09)]=parseInt(document[_0x20dd1b(0x9a3)]('linked-memory-count')[_0x20dd1b(0x7b2)])||0xa;const _0x1fdc56=document[_0x20dd1b(0x131c)]('#world-book-checkboxes-container\x20input[type=\x22checkbox\x22]:checked'),_0x51bb90=[];_0x1fdc56[_0x20dd1b(0x15c1)](_0x1db460=>{const _0x29d487=_0x20dd1b;_0x1db460[_0x29d487(0x7b2)]['startsWith']('book_')&&_0x51bb90[_0x29d487(0x1c4)](_0x1db460[_0x29d487(0x7b2)][_0x29d487(0x1bb)](_0x29d487(0x1471),''));}),_0x2bf6ce['settings'][_0x20dd1b(0x9c4)]=_0x51bb90;const _0x5dbeab=document[_0x20dd1b(0x9a3)]('link-memory-toggle')[_0x20dd1b(0x944)];if(_0x5dbeab){const _0x3a6c32=document[_0x20dd1b(0x131c)]('#linked-chats-checkboxes-container\x20input:checked');_0x2bf6ce[_0x20dd1b(0x450)][_0x20dd1b(0x120e)]=Array[_0x20dd1b(0x1311)](_0x3a6c32)['map'](_0x2cfad5=>_0x2cfad5['value']);}else _0x2bf6ce['settings'][_0x20dd1b(0x120e)]=[];_0x2bf6ce[_0x20dd1b(0x450)][_0x20dd1b(0x1525)]=document[_0x20dd1b(0x9a3)]('auto-memory-toggle')['checked'],_0x2bf6ce[_0x20dd1b(0x450)][_0x20dd1b(0xdf7)]=parseInt(document['getElementById']('auto-memory-interval')[_0x20dd1b(0x7b2)])||0x14,_0x2bf6ce[_0x20dd1b(0x450)][_0x20dd1b(0x2de)]=document[_0x20dd1b(0x9a3)](_0x20dd1b(0x60e))['checked'],_0x2bf6ce[_0x20dd1b(0x450)][_0x20dd1b(0x6fd)]=document['getElementById'](_0x20dd1b(0xef3))[_0x20dd1b(0x7b2)];if(_0x2bf6ce[_0x20dd1b(0x136b)])_0x2bf6ce[_0x20dd1b(0x450)]['enableBackgroundActivity']=document[_0x20dd1b(0x9a3)](_0x20dd1b(0x60d))['checked'],_0x2bf6ce['settings']['myNickname']=document['getElementById'](_0x20dd1b(0xe11))[_0x20dd1b(0x7b2)]['trim'](),_0x2bf6ce['settings'][_0x20dd1b(0x20a)]=document[_0x20dd1b(0x9a3)](_0x20dd1b(0x84c))['src'],_0x2bf6ce[_0x20dd1b(0x450)]['actionCooldownMinutes']=parseInt(document[_0x20dd1b(0x9a3)](_0x20dd1b(0x767))[_0x20dd1b(0x7b2)])||0xa;else{_0x2bf6ce['settings'][_0x20dd1b(0x106e)]=document[_0x20dd1b(0x9a3)]('char-background-activity-switch')[_0x20dd1b(0x944)];const _0x2f1a44=document[_0x20dd1b(0x9a3)](_0x20dd1b(0xcd0))['checked'];_0x2bf6ce[_0x20dd1b(0x450)][_0x20dd1b(0x1267)]=_0x2f1a44;if(_0x152c6d===!![]&&_0x2f1a44===![]){const _0x294821={'role':_0x20dd1b(0xe10),'content':'[系统指令：模式已切换！你现在回到了线上聊天模式。你的回复【必须】严格遵守线上模式的JSON数组格式，例如\x20[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好\x22}]]','timestamp':Date[_0x20dd1b(0x64b)](),'isHidden':!![]};_0x2bf6ce[_0x20dd1b(0x1f0)][_0x20dd1b(0x1c4)](_0x294821),console[_0x20dd1b(0xe4d)](_0x20dd1b(0x31c));}_0x2bf6ce['settings'][_0x20dd1b(0x8be)]=document[_0x20dd1b(0x9a3)](_0x20dd1b(0x15c5))[_0x20dd1b(0x944)],_0x2bf6ce[_0x20dd1b(0x450)][_0x20dd1b(0xf97)]=parseInt(document[_0x20dd1b(0x9a3)](_0x20dd1b(0x1088))[_0x20dd1b(0x7b2)])||0x64,_0x2bf6ce[_0x20dd1b(0x450)][_0x20dd1b(0xa4a)]=parseInt(document[_0x20dd1b(0x9a3)](_0x20dd1b(0x452))[_0x20dd1b(0x7b2)])||0x12c,_0x2bf6ce[_0x20dd1b(0x450)][_0x20dd1b(0x112a)]=document['getElementById']('offline-preset-select')[_0x20dd1b(0x7b2)]||null;const _0x4069cf=document[_0x20dd1b(0x9a3)](_0x20dd1b(0x6cc))[_0x20dd1b(0x7b2)][_0x20dd1b(0x13f9)]();if(!_0x4069cf)return alert(_0x20dd1b(0x835));_0x2bf6ce[_0x20dd1b(0x339)]=_0x4069cf,_0x2bf6ce['settings'][_0x20dd1b(0x1c3)]=document[_0x20dd1b(0x9a3)](_0x20dd1b(0xbd6))['value'],_0x2bf6ce[_0x20dd1b(0x450)][_0x20dd1b(0x551)]=document[_0x20dd1b(0x9a3)](_0x20dd1b(0x1ba))[_0x20dd1b(0x7b2)]['trim'](),_0x2bf6ce[_0x20dd1b(0x450)][_0x20dd1b(0x1547)]=document[_0x20dd1b(0x9a3)]('enable-tts-switch')['checked'],_0x2bf6ce[_0x20dd1b(0x450)]['aiAvatar']=document['getElementById'](_0x20dd1b(0xdf8))[_0x20dd1b(0x10d4)],_0x2bf6ce[_0x20dd1b(0x450)]['myNickname']=document[_0x20dd1b(0x9a3)]('my-nickname-input')[_0x20dd1b(0x7b2)]['trim']()||'我',_0x2bf6ce[_0x20dd1b(0x450)]['actionCooldownMinutes']=parseInt(document['getElementById'](_0x20dd1b(0xf9d))[_0x20dd1b(0x7b2)])||0xa,_0x2bf6ce['settings']['lyricsPosition']={'vertical':document['getElementById']('lyrics-vertical-pos')[_0x20dd1b(0x7b2)],'horizontal':document[_0x20dd1b(0x9a3)](_0x20dd1b(0xf1d))[_0x20dd1b(0x7b2)],'offset':parseInt(document[_0x20dd1b(0x9a3)]('lyrics-offset-input')['value'])||0xa};const _0xf2ae27=document[_0x20dd1b(0x9a3)]('assign-group-select')[_0x20dd1b(0x7b2)];_0x2bf6ce['groupId']=_0xf2ae27?parseInt(_0xf2ae27):null;}await _0x512070[_0x20dd1b(0xb04)][_0x20dd1b(0xd4d)](_0x2bf6ce),!_0x2bf6ce[_0x20dd1b(0x136b)]&&(await _0xa82516(_0x2bf6ce),await _0x3b911c(_0x2bf6ce)),_0x11947f(_0x2bf6ce),_0x1253e3(_0x2bf6ce['settings']['customCss'],_0x20dd1b(0x8bf),_0x20dd1b(0xdcb)),_0x35df44(_0x20dd1b(0x3e5)),_0x56abd7(_0x19ddb8['activeChatId']),_0xec8072();}),document['getElementById'](_0x452732(0x674))[_0x452732(0x954)](_0x452732(0x9cc),_0x5635e8=>{const _0xb17e77=_0x452732;_0x5635e8['target'][_0xb17e77(0x4d8)]['contains'](_0xb17e77(0xa93))&&_0x4217c3(_0xb17e77(0xd43));}),document[_0x452732(0x9a3)]('member-settings-modal')[_0x452732(0x954)](_0x452732(0x9cc),_0x36f2bc=>{const _0x2a7d48=_0x452732;_0x36f2bc[_0x2a7d48(0xa41)]['classList'][_0x2a7d48(0x1222)](_0x2a7d48(0xa93))&&_0x4217c3(_0x2a7d48(0x14fc));});const _0x289ce9=document[_0x452732(0x9a3)](_0x452732(0x13dd)),_0x470fdf=document[_0x452732(0x9a3)](_0x452732(0x17f)),_0x474ee8=document['getElementById']('my-frame-tab'),_0x1e596b=document[_0x452732(0x9a3)]('ai-frame-content'),_0x57c893=document[_0x452732(0x9a3)](_0x452732(0x387));document[_0x452732(0x9a3)](_0x452732(0x1505))[_0x452732(0x954)](_0x452732(0x9cc),_0x3b59ad),document[_0x452732(0x9a3)](_0x452732(0xcb0))[_0x452732(0x954)]('click',()=>{const _0x24c57c=_0x452732;_0x289ce9[_0x24c57c(0x4d8)][_0x24c57c(0x133d)]('visible'),_0x4a2ae0=![];}),_0x470fdf[_0x452732(0x954)]('click',()=>{const _0x2319f9=_0x452732;_0x470fdf['classList'][_0x2319f9(0xe05)](_0x2319f9(0xe9f)),_0x474ee8[_0x2319f9(0x4d8)][_0x2319f9(0x133d)](_0x2319f9(0xe9f)),_0x1e596b[_0x2319f9(0x20f)]['display']=_0x2319f9(0x10c8),_0x57c893[_0x2319f9(0x20f)][_0x2319f9(0x115d)]=_0x2319f9(0x8e0);}),_0x474ee8[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x551c61=_0x452732;_0x474ee8[_0x551c61(0x4d8)][_0x551c61(0xe05)](_0x551c61(0xe9f)),_0x470fdf[_0x551c61(0x4d8)][_0x551c61(0x133d)]('active'),_0x57c893[_0x551c61(0x20f)][_0x551c61(0x115d)]=_0x551c61(0x10c8),_0x1e596b[_0x551c61(0x20f)][_0x551c61(0x115d)]='none';}),document[_0x452732(0x9a3)]('clear-chat-btn')['addEventListener'](_0x452732(0x9cc),async()=>{const _0x53b7fb=_0x452732;if(!_0x19ddb8['activeChatId'])return;const _0x3e39ee=_0x19ddb8['chats'][_0x19ddb8[_0x53b7fb(0x859)]],_0x53ce35=await _0x2c9509(_0x53b7fb(0xa33),'此操作将永久删除此聊天的所有消息，无法恢复。确定要清空吗？',{'confirmButtonClass':'btn-danger'});_0x53ce35&&(_0x3e39ee[_0x53b7fb(0x1f0)]=[],_0x3e39ee['heartfeltVoice']=_0x53b7fb(0x4a5),_0x3e39ee[_0x53b7fb(0x69b)]=_0x53b7fb(0x4a5),await _0x512070[_0x53b7fb(0xb04)][_0x53b7fb(0xd4d)](_0x3e39ee),_0x56abd7(_0x19ddb8[_0x53b7fb(0x859)]),_0xec8072(),_0xae34a1[_0x53b7fb(0x4d8)]['remove']('visible'));});const _0x1de3cb=(_0x16f265,_0x2b3d71)=>{const _0x40b0af=_0x452732;document[_0x40b0af(0x9a3)](_0x16f265)['addEventListener'](_0x40b0af(0xbbc),async _0x573371=>{const _0xb6990c=_0x40b0af,_0x3da8e5=_0x573371['target'][_0xb6990c(0x104e)][0x0];if(_0x3da8e5){const _0x1831cc=await new Promise((_0x3478e0,_0xdcba3a)=>{const _0x49eb5d=_0xb6990c,_0x26cf8a=new FileReader();_0x26cf8a[_0x49eb5d(0xdd7)]=()=>_0x3478e0(_0x26cf8a['result']),_0x26cf8a[_0x49eb5d(0xb8b)]=()=>_0xdcba3a(_0x26cf8a[_0x49eb5d(0x3b7)]),_0x26cf8a[_0x49eb5d(0xdd8)](_0x3da8e5);});_0x2b3d71(_0x1831cc),_0x573371[_0xb6990c(0xa41)]['value']=null;}});};_0x1de3cb(_0x452732(0x3b3),_0x3b6c4b=>document[_0x452732(0x9a3)](_0x452732(0xdf8))['src']=_0x3b6c4b),_0x1de3cb(_0x452732(0xe46),_0x1fab6c=>document['getElementById'](_0x452732(0x798))['src']=_0x1fab6c),_0x1de3cb(_0x452732(0xd74),_0x5c65aa=>document[_0x452732(0x9a3)]('group-avatar-preview')['src']=_0x5c65aa),_0x1de3cb(_0x452732(0x311),_0x427943=>document[_0x452732(0x9a3)](_0x452732(0x9dc))[_0x452732(0x10d4)]=_0x427943),_0x1de3cb(_0x452732(0x732),_0x364c4a=>{const _0x2ce520=_0x452732;if(_0x19ddb8[_0x2ce520(0x859)]){_0x19ddb8[_0x2ce520(0xb04)][_0x19ddb8[_0x2ce520(0x859)]][_0x2ce520(0x450)][_0x2ce520(0x5f1)]=_0x364c4a;const _0x24d7b6=document[_0x2ce520(0x9a3)](_0x2ce520(0x8f7));_0x24d7b6[_0x2ce520(0x10d4)]=_0x364c4a,_0x24d7b6[_0x2ce520(0x20f)]['display']=_0x2ce520(0x10c8),document[_0x2ce520(0x9a3)]('remove-bg-btn')[_0x2ce520(0x20f)][_0x2ce520(0x115d)]=_0x2ce520(0xe97);}}),_0x1de3cb(_0x452732(0xced),_0x1419ea=>document[_0x452732(0x9a3)]('preset-avatar-preview')[_0x452732(0x10d4)]=_0x1419ea),document['getElementById']('remove-bg-btn')[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x589f5f=_0x452732;if(_0x19ddb8[_0x589f5f(0x859)]){_0x19ddb8['chats'][_0x19ddb8[_0x589f5f(0x859)]][_0x589f5f(0x450)][_0x589f5f(0x5f1)]='';const _0x484add=document[_0x589f5f(0x9a3)]('bg-preview');_0x484add[_0x589f5f(0x10d4)]='',_0x484add['style'][_0x589f5f(0x115d)]=_0x589f5f(0x8e0),document[_0x589f5f(0x9a3)]('remove-bg-btn')[_0x589f5f(0x20f)][_0x589f5f(0x115d)]=_0x589f5f(0x8e0);}});const _0x99167e=document[_0x452732(0x9a3)](_0x452732(0x598));document[_0x452732(0x9a3)](_0x452732(0x350))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x4fb295=_0x452732,_0x1714f2=_0x19ddb8[_0x4fb295(0xb04)][_0x19ddb8[_0x4fb295(0x859)]];_0x1714f2&&_0x1714f2[_0x4fb295(0x450)][_0x4fb295(0x140d)]?_0x507d02=_0x1714f2['settings'][_0x4fb295(0x140d)]:_0x507d02=_0x4fb295(0xbf1),_0x5a49be(),_0x99167e['classList'][_0x4fb295(0xe05)]('visible');}),document[_0x452732(0x9a3)](_0x452732(0xdba))['addEventListener'](_0x452732(0x9cc),()=>_0x99167e[_0x452732(0x4d8)][_0x452732(0x133d)](_0x452732(0xc09))),document[_0x452732(0x9a3)](_0x452732(0x1e0))['addEventListener'](_0x452732(0x9cc),_0x54c2c3),document[_0x452732(0x9a3)](_0x452732(0x5e1))[_0x452732(0x954)](_0x452732(0x9cc),()=>document[_0x452732(0x9a3)]('sticker-upload-input')[_0x452732(0x9cc)]()),document['getElementById'](_0x452732(0xac0))['addEventListener'](_0x452732(0xbbc),async _0x2e4b0e=>{const _0x34cec9=_0x452732,_0x56e2cb=_0x2e4b0e[_0x34cec9(0xa41)]['files'][0x0];if(!_0x56e2cb)return;const _0x55a42c=new FileReader();_0x55a42c['readAsDataURL'](_0x56e2cb),_0x55a42c[_0x34cec9(0xdd7)]=async()=>{const _0x22ac9f=_0x34cec9,_0x3b90a1=_0x55a42c[_0x22ac9f(0x5c9)],_0xfb46d4=await _0x3ab788(_0x22ac9f(0x8f0),_0x22ac9f(0xc78));if(_0xfb46d4&&_0xfb46d4[_0x22ac9f(0x13f9)]()){const _0x2e6e4c={'id':_0x22ac9f(0x621)+Date[_0x22ac9f(0x64b)](),'url':_0x3b90a1,'name':_0xfb46d4[_0x22ac9f(0x13f9)](),'categoryId':_0x507d02!==_0x22ac9f(0xbf1)&&_0x507d02!=='uncategorized'?_0x507d02:null};await _0x512070['userStickers']['add'](_0x2e6e4c),_0x19ddb8[_0x22ac9f(0x1557)][_0x22ac9f(0x1c4)](_0x2e6e4c),_0x5a49be();}else{if(_0xfb46d4!==null)alert(_0x22ac9f(0xd28));}},_0x2e4b0e[_0x34cec9(0xa41)][_0x34cec9(0x7b2)]=null;}),document[_0x452732(0x9a3)](_0x452732(0x100c))[_0x452732(0x954)](_0x452732(0x9cc),()=>document['getElementById'](_0x452732(0xb3c))[_0x452732(0x9cc)]()),document[_0x452732(0x9a3)]('image-upload-input')[_0x452732(0x954)]('change',async _0x4199f3=>{const _0x57e477=_0x452732,_0x1236fc=_0x4199f3[_0x57e477(0xa41)][_0x57e477(0x104e)][0x0];if(!_0x1236fc||!_0x19ddb8['activeChatId'])return;const _0x37c753=new FileReader();_0x37c753[_0x57e477(0xdd7)]=async _0x3213d4=>{const _0x531435=_0x57e477,_0x408a21=_0x3213d4[_0x531435(0xa41)][_0x531435(0x5c9)],_0x1f3a3d=_0x19ddb8[_0x531435(0xb04)][_0x19ddb8['activeChatId']],_0x5635e3={'role':_0x531435(0x20d),'content':[{'type':_0x531435(0xae0),'image_url':{'url':_0x408a21}}],'timestamp':Date['now']()};_0x1f3a3d[_0x531435(0x1f0)][_0x531435(0x1c4)](_0x5635e3),await _0x512070[_0x531435(0xb04)][_0x531435(0xd4d)](_0x1f3a3d),_0x1ef393(_0x5635e3,_0x1f3a3d),_0xec8072();},_0x37c753[_0x57e477(0xdd8)](_0x1236fc),_0x4199f3[_0x57e477(0xa41)][_0x57e477(0x7b2)]=null;}),document[_0x452732(0x9a3)](_0x452732(0x11b3))['addEventListener']('click',async()=>{const _0x3f68cd=_0x452732;if(!_0x19ddb8[_0x3f68cd(0x859)])return;const _0x1e13f4=await _0x3ab788(_0x3f68cd(0x36f),_0x3f68cd(0x10ff));if(_0x1e13f4&&_0x1e13f4['trim']()){const _0x49f9f1=_0x19ddb8['chats'][_0x19ddb8[_0x3f68cd(0x859)]],_0x310bfb={'role':_0x3f68cd(0x20d),'type':'voice_message','content':_0x1e13f4[_0x3f68cd(0x13f9)](),'timestamp':Date[_0x3f68cd(0x64b)]()};_0x49f9f1[_0x3f68cd(0x1f0)][_0x3f68cd(0x1c4)](_0x310bfb),await _0x512070[_0x3f68cd(0xb04)][_0x3f68cd(0xd4d)](_0x49f9f1),_0x1ef393(_0x310bfb,_0x49f9f1),_0xec8072();}}),document['getElementById'](_0x452732(0x8b6))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x36c1ef=_0x452732;if(!_0x19ddb8[_0x36c1ef(0x859)])return;const _0x1443f5=await _0x3ab788(_0x36c1ef(0x4c9),'请用文字描述您要发送的照片：');if(_0x1443f5&&_0x1443f5[_0x36c1ef(0x13f9)]()){const _0x4d054c=_0x19ddb8[_0x36c1ef(0xb04)][_0x19ddb8['activeChatId']],_0xcfdd2a={'role':_0x36c1ef(0x20d),'type':'user_photo','content':_0x1443f5[_0x36c1ef(0x13f9)](),'timestamp':Date[_0x36c1ef(0x64b)]()};_0x4d054c['history'][_0x36c1ef(0x1c4)](_0xcfdd2a),await _0x512070[_0x36c1ef(0xb04)][_0x36c1ef(0xd4d)](_0x4d054c),_0x1ef393(_0xcfdd2a,_0x4d054c),_0xec8072();}});const _0x2b5bdb=document['getElementById'](_0x452732(0x1a8));document['getElementById'](_0x452732(0x61f))[_0x452732(0x954)]('click',()=>{const _0x24d1b3=_0x452732;_0x2b5bdb[_0x24d1b3(0x4d8)][_0x24d1b3(0xe05)](_0x24d1b3(0xc09));}),_0x2b5bdb[_0x452732(0x954)]('click',_0x3a758e=>{const _0x256ba6=_0x452732;_0x3a758e[_0x256ba6(0xa41)]===_0x2b5bdb&&_0x2b5bdb[_0x256ba6(0x4d8)][_0x256ba6(0x133d)](_0x256ba6(0xc09));}),document['getElementById'](_0x452732(0x972))[_0x452732(0x954)]('click',_0x2664c3),document[_0x452732(0x9a3)]('waimai-confirm-btn')[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x1a0e37=_0x452732;if(!_0x19ddb8[_0x1a0e37(0x859)])return;const _0x3d5fac=document['getElementById'](_0x1a0e37(0x1266)),_0x2aed9c=document['getElementById'](_0x1a0e37(0xf7e)),_0x3ab09d=_0x3d5fac[_0x1a0e37(0x7b2)][_0x1a0e37(0x13f9)](),_0xe07e7d=parseFloat(_0x2aed9c[_0x1a0e37(0x7b2)]);if(!_0x3ab09d||isNaN(_0xe07e7d)||_0xe07e7d<=0x0){alert(_0x1a0e37(0x1ac));return;}const _0x4dc992=_0x19ddb8[_0x1a0e37(0xb04)][_0x19ddb8[_0x1a0e37(0x859)]],_0x40060f=Date['now'](),_0xe38a5a=_0x4dc992['isGroup']?_0x4dc992['settings'][_0x1a0e37(0x1555)]||'我':'我',_0x3816ac={'role':_0x1a0e37(0x20d),'senderName':_0xe38a5a,'type':_0x1a0e37(0x12ec),'productInfo':_0x3ab09d,'amount':_0xe07e7d,'status':_0x1a0e37(0x550),'countdownEndTime':_0x40060f+0xf*0x3c*0x3e8,'timestamp':_0x40060f};_0x4dc992[_0x1a0e37(0x1f0)][_0x1a0e37(0x1c4)](_0x3816ac),await _0x512070['chats'][_0x1a0e37(0xd4d)](_0x4dc992),_0x1ef393(_0x3816ac,_0x4dc992),_0xec8072(),_0x3d5fac[_0x1a0e37(0x7b2)]='',_0x2aed9c[_0x1a0e37(0x7b2)]='',_0x2b5bdb['classList'][_0x1a0e37(0x133d)]('visible');}),document[_0x452732(0x9a3)](_0x452732(0x558))[_0x452732(0x954)]('click',_0x226e04),document[_0x452732(0x9a3)](_0x452732(0x829))[_0x452732(0x954)](_0x452732(0x9cc),_0x85b361),document[_0x452732(0x9a3)](_0x452732(0xc61))[_0x452732(0x954)](_0x452732(0x9cc),_0x492e10),document['getElementById'](_0x452732(0x109a))[_0x452732(0x954)](_0x452732(0x9cc),_0xf7ac75),document[_0x452732(0x9a3)](_0x452732(0x1041))[_0x452732(0x954)]('click',_0x3b3bce),document[_0x452732(0x9a3)](_0x452732(0x1112))[_0x452732(0x954)](_0x452732(0x9cc),_0x50ad00),document[_0x452732(0x9a3)]('preset-action-delete')['addEventListener'](_0x452732(0x9cc),_0x16b3aa),document['getElementById']('preset-action-cancel')[_0x452732(0x954)](_0x452732(0x9cc),_0x261bea),document[_0x452732(0x9a3)](_0x452732(0xe95))['addEventListener'](_0x452732(0x9cc),_0x501f17),document[_0x452732(0x9a3)](_0x452732(0x7fb))[_0x452732(0x954)]('click',async()=>{const _0x3ffdc3=_0x452732;if(_0x445138['size']===0x0)return;const _0x28fcbe=await _0x2c9509(_0x3ffdc3(0x531),_0x3ffdc3(0x13d6)+_0x445138[_0x3ffdc3(0xbdf)]+_0x3ffdc3(0x412),{'confirmButtonClass':_0x3ffdc3(0xf5b)});if(_0x28fcbe){const _0x124e23=_0x19ddb8[_0x3ffdc3(0xb04)][_0x19ddb8[_0x3ffdc3(0x859)]];let _0x50dd62=[];for(const _0x1fc327 of _0x445138){const _0x303196=_0x124e23['history']['find'](_0x1dc526=>_0x1dc526['timestamp']===_0x1fc327);_0x303196&&_0x303196[_0x3ffdc3(0x1508)]===_0x3ffdc3(0x3e6)&&_0x50dd62[_0x3ffdc3(0x1c4)](_0x3ffdc3(0xf1a)+_0x303196['question']+'”的投票(时间戳:\x20'+_0x303196[_0x3ffdc3(0xd73)]+')');}_0x124e23[_0x3ffdc3(0x1f0)]=_0x124e23[_0x3ffdc3(0x1f0)][_0x3ffdc3(0x1195)](_0x56b518=>!_0x445138[_0x3ffdc3(0x1472)](_0x56b518[_0x3ffdc3(0xd73)]));let _0x2ec423=_0x3ffdc3(0x101d);_0x50dd62[_0x3ffdc3(0x106b)]>0x0&&(_0x2ec423+='\x20其中包括以下投票：'+_0x50dd62[_0x3ffdc3(0x3b9)]('；')+'。');_0x2ec423+='\x20你应该像它们从未存在过一样继续对话，并相应地调整你的记忆和行为，不要再提及这些被删除的内容。';const _0x460bdf={'role':'system','content':_0x3ffdc3(0x345)+_0x2ec423+']','timestamp':Date[_0x3ffdc3(0x64b)](),'isHidden':!![]};_0x124e23[_0x3ffdc3(0x1f0)][_0x3ffdc3(0x1c4)](_0x460bdf),await _0x512070[_0x3ffdc3(0xb04)]['put'](_0x124e23),_0x56abd7(_0x19ddb8['activeChatId']),_0xec8072();}}),document[_0x452732(0x9a3)](_0x452732(0x1203))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x42672f=_0x452732;if(_0x445138[_0x42672f(0xbdf)]===0x0)return;const _0x519050=await _0x2c9509('彻底删除消息','这将从历史记录中【永久抹除】这\x20'+_0x445138['size']+_0x42672f(0x27a),{'confirmButtonClass':'btn-danger','confirmText':_0x42672f(0x12dc)});if(_0x519050){const _0x229e1c=_0x19ddb8[_0x42672f(0xb04)][_0x19ddb8['activeChatId']];_0x229e1c[_0x42672f(0x1f0)]=_0x229e1c[_0x42672f(0x1f0)]['filter'](_0x3bd331=>!_0x445138[_0x42672f(0x1472)](_0x3bd331['timestamp'])),await _0x512070[_0x42672f(0xb04)][_0x42672f(0xd4d)](_0x229e1c),_0x56abd7(_0x19ddb8['activeChatId']),_0xec8072();}});const _0x1d5eb8=document['getElementById'](_0x452732(0x19e));_0x1d5eb8['addEventListener'](_0x452732(0x1b4),()=>_0x124e17(_0x1d5eb8[_0x452732(0x7b2)][_0x452732(0x13f9)](),!![])),document[_0x452732(0x9a3)]('save-font-btn')[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x145fb4=_0x452732,_0xd9b386=_0x1d5eb8[_0x145fb4(0x7b2)]['trim']();if(!_0xd9b386){alert(_0x145fb4(0x1d4));return;}_0x124e17(_0xd9b386,![]),_0x19ddb8['globalSettings'][_0x145fb4(0x12ce)]=_0xd9b386,await _0x512070[_0x145fb4(0x4c8)]['put'](_0x19ddb8[_0x145fb4(0x4c8)]),alert(_0x145fb4(0xc01));}),document[_0x452732(0x9a3)](_0x452732(0xd3d))[_0x452732(0x954)](_0x452732(0x9cc),_0x468247),document['querySelectorAll'](_0x452732(0x111a))['forEach'](_0x37e9c3=>{const _0x2aac78=_0x452732;_0x37e9c3[_0x2aac78(0x954)](_0x2aac78(0x9cc),()=>_0x499463(_0x37e9c3[_0x2aac78(0xd8d)]['view']));}),document[_0x452732(0x9a3)](_0x452732(0x12a4))['addEventListener'](_0x452732(0x9cc),()=>_0x499463(_0x452732(0xdd5))),document[_0x452732(0x9a3)](_0x452732(0x26b))['addEventListener'](_0x452732(0x9cc),async()=>{const _0x49cdd0=_0x452732,_0x347153=await _0x3ab788('修改昵称',_0x49cdd0(0x414),_0x19ddb8[_0x49cdd0(0x9ce)][_0x49cdd0(0x246)]);_0x347153&&_0x347153[_0x49cdd0(0x13f9)]()&&(_0x19ddb8[_0x49cdd0(0x9ce)][_0x49cdd0(0x246)]=_0x347153['trim'](),await _0xa4e34a(),_0x31ad99());}),document[_0x452732(0x9a3)](_0x452732(0xed5))[_0x452732(0x954)](_0x452732(0x9cc),()=>document[_0x452732(0x9a3)](_0x452732(0xb9a))[_0x452732(0x9cc)]()),document['getElementById']('qzone-banner-container')[_0x452732(0x954)](_0x452732(0x9cc),()=>document['getElementById'](_0x452732(0x13a8))[_0x452732(0x9cc)]()),document[_0x452732(0x9a3)]('qzone-avatar-input')['addEventListener']('change',async _0x268634=>{const _0x173a9d=_0x452732,_0x2155ef=_0x268634[_0x173a9d(0xa41)][_0x173a9d(0x104e)][0x0];if(_0x2155ef){const _0x19e815=await new Promise(_0x53a6cd=>{const _0x2e4b08=_0x173a9d,_0x3088db=new FileReader();_0x3088db[_0x2e4b08(0xdd7)]=()=>_0x53a6cd(_0x3088db[_0x2e4b08(0x5c9)]),_0x3088db[_0x2e4b08(0xdd8)](_0x2155ef);});_0x19ddb8[_0x173a9d(0x9ce)]['avatar']=_0x19e815,await _0xa4e34a(),_0x31ad99();}_0x268634[_0x173a9d(0xa41)][_0x173a9d(0x7b2)]=null;}),document[_0x452732(0x9a3)](_0x452732(0x13a8))['addEventListener'](_0x452732(0xbbc),async _0x1e6e26=>{const _0x1ea1df=_0x452732,_0x2bdcd2=_0x1e6e26['target'][_0x1ea1df(0x104e)][0x0];if(_0x2bdcd2){const _0x232155=await new Promise(_0x36dd95=>{const _0x1c0ed7=_0x1ea1df,_0x3b6436=new FileReader();_0x3b6436[_0x1c0ed7(0xdd7)]=()=>_0x36dd95(_0x3b6436['result']),_0x3b6436['readAsDataURL'](_0x2bdcd2);});_0x19ddb8[_0x1ea1df(0x9ce)]['banner']=_0x232155,await _0xa4e34a(),_0x31ad99();}_0x1e6e26[_0x1ea1df(0xa41)][_0x1ea1df(0x7b2)]=null;}),document[_0x452732(0x9a3)](_0x452732(0x1545))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x15f5f6=_0x452732;_0x4b032e();const _0x460191=document['getElementById']('create-post-modal');_0x460191[_0x15f5f6(0xd8d)][_0x15f5f6(0x460)]=_0x15f5f6(0x23d),_0x460191['querySelector'](_0x15f5f6(0x5d3))[_0x15f5f6(0x20f)]['display']='none',_0x460191[_0x15f5f6(0xc86)](_0x15f5f6(0x1165))[_0x15f5f6(0x20f)][_0x15f5f6(0x115d)]=_0x15f5f6(0x8e0),_0x460191[_0x15f5f6(0xc86)](_0x15f5f6(0xf6a))['style'][_0x15f5f6(0x115d)]='none',_0x460191[_0x15f5f6(0xc86)](_0x15f5f6(0x13df))[_0x15f5f6(0x1591)]=_0x15f5f6(0x156f);const _0x4a4d99=document['getElementById'](_0x15f5f6(0x52c));_0x4a4d99[_0x15f5f6(0xeb2)]='';const _0x14f39a=await _0x512070['qzoneGroups'][_0x15f5f6(0x591)]();_0x14f39a[_0x15f5f6(0x106b)]>0x0?_0x14f39a[_0x15f5f6(0x15c1)](_0x56c66e=>{const _0x3d2b5d=_0x15f5f6,_0x545d23=document[_0x3d2b5d(0xe94)](_0x3d2b5d(0x667));_0x545d23[_0x3d2b5d(0x20f)]['display']=_0x3d2b5d(0x10c8),_0x545d23['innerHTML']=_0x3d2b5d(0x186)+_0x56c66e['id']+'\x22>\x20'+_0x56c66e[_0x3d2b5d(0x1561)],_0x4a4d99[_0x3d2b5d(0x983)](_0x545d23);}):_0x4a4d99[_0x15f5f6(0xeb2)]=_0x15f5f6(0xc0e),_0x460191['classList']['add'](_0x15f5f6(0xc09));}),document[_0x452732(0x9a3)](_0x452732(0xce9))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x1474e6=_0x452732;_0x4b032e();const _0x23f104=document[_0x1474e6(0x9a3)](_0x1474e6(0x886));_0x23f104[_0x1474e6(0xd8d)][_0x1474e6(0x460)]=_0x1474e6(0x15c6),_0x23f104[_0x1474e6(0xc86)]('.post-mode-switcher')[_0x1474e6(0x20f)][_0x1474e6(0x115d)]=_0x1474e6(0x79c),_0x23f104[_0x1474e6(0xc86)]('#image-mode-content')[_0x1474e6(0x4d8)][_0x1474e6(0xe05)]('active'),_0x23f104[_0x1474e6(0xc86)](_0x1474e6(0xf6a))[_0x1474e6(0x4d8)]['remove']('active'),_0x23f104[_0x1474e6(0xc86)](_0x1474e6(0x13df))['placeholder']='分享新鲜事...（非必填的公开文字）';const _0x38ed32=document['getElementById'](_0x1474e6(0x52c));_0x38ed32[_0x1474e6(0xeb2)]='';const _0xa7425e=await _0x512070[_0x1474e6(0xad9)][_0x1474e6(0x591)]();_0xa7425e[_0x1474e6(0x106b)]>0x0?_0xa7425e['forEach'](_0x195b7d=>{const _0x25124c=_0x1474e6,_0x3f14ff=document[_0x25124c(0xe94)]('label');_0x3f14ff[_0x25124c(0x20f)]['display']=_0x25124c(0x10c8),_0x3f14ff[_0x25124c(0xeb2)]=_0x25124c(0x186)+_0x195b7d['id']+'\x22>\x20'+_0x195b7d['name'],_0x38ed32[_0x25124c(0x983)](_0x3f14ff);}):_0x38ed32[_0x1474e6(0xeb2)]=_0x1474e6(0xc0e),_0x23f104['classList'][_0x1474e6(0xe05)](_0x1474e6(0xc09));}),document[_0x452732(0x9a3)](_0x452732(0x1459))[_0x452732(0x954)]('click',async()=>{const _0x453bc7=_0x452732;await _0x466477(),_0x35df44(_0x453bc7(0x11c6));}),document[_0x452732(0x9a3)](_0x452732(0xb39))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x582251=_0x452732;_0x35df44(_0x582251(0xd7c)),_0x499463(_0x582251(0x659));}),document[_0x452732(0x9a3)](_0x452732(0x8a6))['addEventListener'](_0x452732(0x9cc),()=>{const _0x24bbcf=_0x452732;_0x19ddb8[_0x24bbcf(0x12b1)]=null,_0x35df44(_0x24bbcf(0x11c6));}),document[_0x452732(0x9a3)]('album-upload-photo-btn')[_0x452732(0x954)](_0x452732(0x9cc),()=>document[_0x452732(0x9a3)]('album-photo-input')[_0x452732(0x9cc)]()),document[_0x452732(0x9a3)]('album-photo-input')['addEventListener']('change',async _0x3d7f54=>{const _0x1b821f=_0x452732;if(!_0x19ddb8[_0x1b821f(0x12b1)])return;const _0x47853b=_0x3d7f54[_0x1b821f(0xa41)]['files'];if(!_0x47853b[_0x1b821f(0x106b)])return;const _0x21f5d1=await _0x512070[_0x1b821f(0x642)][_0x1b821f(0x14ee)](_0x19ddb8['activeAlbumId']);for(const _0x251f4b of _0x47853b){const _0x3add03=await new Promise(_0x422d7a=>{const _0x44a3fb=_0x1b821f,_0x29559a=new FileReader();_0x29559a[_0x44a3fb(0xdd7)]=()=>_0x422d7a(_0x29559a[_0x44a3fb(0x5c9)]),_0x29559a[_0x44a3fb(0xdd8)](_0x251f4b);});await _0x512070[_0x1b821f(0xc8d)][_0x1b821f(0xe05)]({'albumId':_0x19ddb8[_0x1b821f(0x12b1)],'url':_0x3add03,'createdAt':Date['now']()});}const _0x113f7d=await _0x512070[_0x1b821f(0xc8d)][_0x1b821f(0x1201)](_0x1b821f(0xe00))[_0x1b821f(0x5df)](_0x19ddb8[_0x1b821f(0x12b1)])[_0x1b821f(0x3a9)](),_0x21bc36={'photoCount':_0x113f7d};if(!_0x21f5d1[_0x1b821f(0xb35)]||_0x21f5d1[_0x1b821f(0xb22)][_0x1b821f(0x478)](_0x1b821f(0x1591))){const _0x5967d1=await _0x512070[_0x1b821f(0xc8d)][_0x1b821f(0x1201)](_0x1b821f(0xe00))[_0x1b821f(0x5df)](_0x19ddb8[_0x1b821f(0x12b1)])[_0x1b821f(0x92c)]();if(_0x5967d1)_0x21bc36[_0x1b821f(0xb22)]=_0x5967d1[_0x1b821f(0x121f)];}await _0x512070['qzoneAlbums'][_0x1b821f(0xe33)](_0x19ddb8[_0x1b821f(0x12b1)],_0x21bc36),await _0x870de1(),await _0x466477(),_0x3d7f54['target']['value']=null,alert(_0x1b821f(0xa73));}),document[_0x452732(0x9a3)](_0x452732(0x2ed))['addEventListener'](_0x452732(0x9cc),async _0x289033=>{const _0x1588dd=_0x452732,_0x1d2498=_0x289033[_0x1588dd(0xa41)][_0x1588dd(0x94c)](_0x1588dd(0x8d4)),_0x533c1e=_0x289033[_0x1588dd(0xa41)][_0x1588dd(0x94c)](_0x1588dd(0xab1));if(_0x1d2498){_0x289033[_0x1588dd(0x63a)]();const _0x3af2aa=parseInt(_0x1d2498[_0x1588dd(0xd8d)]['photoId']),_0x2df518=await _0x2c9509(_0x1588dd(0x12c6),_0x1588dd(0x7b1),{'confirmButtonClass':_0x1588dd(0xf5b)});if(_0x2df518){const _0x30da26=await _0x512070[_0x1588dd(0xc8d)][_0x1588dd(0x14ee)](_0x3af2aa);if(!_0x30da26)return;await _0x512070[_0x1588dd(0xc8d)]['delete'](_0x3af2aa);const _0x430eab=await _0x512070['qzoneAlbums']['get'](_0x19ddb8[_0x1588dd(0x12b1)]),_0x2f9256=(_0x430eab['photoCount']||0x1)-0x1,_0x34cf9d={'photoCount':_0x2f9256};if(_0x430eab[_0x1588dd(0xb22)]===_0x30da26[_0x1588dd(0x121f)]){const _0x50a767=await _0x512070[_0x1588dd(0xc8d)][_0x1588dd(0x1201)](_0x1588dd(0xe00))[_0x1588dd(0x5df)](_0x19ddb8['activeAlbumId'])[_0x1588dd(0x92c)]();_0x34cf9d['coverUrl']=_0x50a767?_0x50a767[_0x1588dd(0x121f)]:_0x1588dd(0x533);}await _0x512070[_0x1588dd(0x642)][_0x1588dd(0xe33)](_0x19ddb8[_0x1588dd(0x12b1)],_0x34cf9d),await _0x870de1(),await _0x466477(),alert(_0x1588dd(0xc5e));}}else _0x533c1e&&_0x140b9e(_0x533c1e[_0x1588dd(0x10d4)]);}),document[_0x452732(0x9a3)](_0x452732(0x258))[_0x452732(0x954)](_0x452732(0x9cc),_0x4197d3),document[_0x452732(0x9a3)](_0x452732(0x1198))['addEventListener'](_0x452732(0x9cc),_0x50c917),document['getElementById']('photo-viewer-prev-btn')[_0x452732(0x954)]('click',_0x40af54),document[_0x452732(0x954)]('keydown',_0x8eb9a9=>{const _0x48b473=_0x452732;if(!_0x7d9369[_0x48b473(0x1030)])return;if(_0x8eb9a9['key']==='ArrowRight')_0x50c917();else{if(_0x8eb9a9[_0x48b473(0xf33)]===_0x48b473(0x838))_0x40af54();else _0x8eb9a9[_0x48b473(0xf33)]===_0x48b473(0xe43)&&_0x4197d3();}}),document['getElementById']('create-album-btn-page')['addEventListener']('click',async()=>{const _0x306d5d=_0x452732,_0x460a23=await _0x3ab788(_0x306d5d(0x777),'请输入相册名称');if(_0x460a23&&_0x460a23[_0x306d5d(0x13f9)]()){const _0x122c7c={'name':_0x460a23[_0x306d5d(0x13f9)](),'coverUrl':_0x306d5d(0x533),'photoCount':0x0,'createdAt':Date[_0x306d5d(0x64b)]()};await _0x512070[_0x306d5d(0x642)]['add'](_0x122c7c),await _0x466477(),alert(_0x306d5d(0xc9b)+_0x460a23+_0x306d5d(0x959));}else _0x460a23!==null&&alert(_0x306d5d(0x6f9));}),document['getElementById']('cancel-create-post-btn')[_0x452732(0x954)]('click',()=>document['getElementById'](_0x452732(0x886))['classList'][_0x452732(0x133d)](_0x452732(0xc09))),document[_0x452732(0x9a3)](_0x452732(0xbb2))['addEventListener'](_0x452732(0x9cc),()=>document[_0x452732(0x9a3)]('post-local-image-input')['click']()),document['getElementById']('post-local-image-input')[_0x452732(0x954)](_0x452732(0xbbc),_0x34ebca=>{const _0x5b3e4b=_0x452732,_0x2e79dd=_0x34ebca['target'][_0x5b3e4b(0x104e)][0x0];if(_0x2e79dd){const _0x4df035=new FileReader();_0x4df035[_0x5b3e4b(0xdd7)]=_0x17c23f=>{const _0x36dbae=_0x5b3e4b;document['getElementById'](_0x36dbae(0x7d2))[_0x36dbae(0x10d4)]=_0x17c23f[_0x36dbae(0xa41)][_0x36dbae(0x5c9)],document['getElementById'](_0x36dbae(0x1c9))['classList'][_0x36dbae(0xe05)](_0x36dbae(0xc09)),document[_0x36dbae(0x9a3)]('post-image-desc-group')['style'][_0x36dbae(0x115d)]=_0x36dbae(0x10c8);},_0x4df035[_0x5b3e4b(0xdd8)](_0x2e79dd);}}),document[_0x452732(0x9a3)]('post-use-url-btn')[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x4f5298=_0x452732,_0x3d0c3c=await _0x3ab788(_0x4f5298(0x159a),_0x4f5298(0x1040),'','url');_0x3d0c3c&&(document[_0x4f5298(0x9a3)](_0x4f5298(0x7d2))[_0x4f5298(0x10d4)]=_0x3d0c3c,document[_0x4f5298(0x9a3)]('post-image-preview-container')[_0x4f5298(0x4d8)][_0x4f5298(0xe05)](_0x4f5298(0xc09)),document[_0x4f5298(0x9a3)](_0x4f5298(0x47b))[_0x4f5298(0x20f)][_0x4f5298(0x115d)]='block');}),document[_0x452732(0x9a3)](_0x452732(0x2dc))['addEventListener'](_0x452732(0x9cc),()=>_0x4b032e());const _0x2fd364=document[_0x452732(0x9a3)](_0x452732(0xe79)),_0x3e1517=document[_0x452732(0x9a3)](_0x452732(0xbd7)),_0x42f429=document[_0x452732(0x9a3)](_0x452732(0x2c9)),_0x398958=document['getElementById'](_0x452732(0x1262));_0x2fd364[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x211e75=_0x452732;_0x2fd364[_0x211e75(0x4d8)][_0x211e75(0xe05)](_0x211e75(0xe9f)),_0x3e1517['classList'][_0x211e75(0x133d)]('active'),_0x42f429[_0x211e75(0x4d8)][_0x211e75(0xe05)](_0x211e75(0xe9f)),_0x398958[_0x211e75(0x4d8)][_0x211e75(0x133d)]('active');}),_0x3e1517[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x364a20=_0x452732;_0x3e1517['classList'][_0x364a20(0xe05)]('active'),_0x2fd364[_0x364a20(0x4d8)]['remove'](_0x364a20(0xe9f)),_0x398958['classList'][_0x364a20(0xe05)](_0x364a20(0xe9f)),_0x42f429[_0x364a20(0x4d8)][_0x364a20(0x133d)]('active');}),document[_0x452732(0x9a3)]('confirm-create-post-btn')[_0x452732(0x954)]('click',async()=>{const _0x441a62=_0x452732,_0x3e4488=document[_0x441a62(0x9a3)]('create-post-modal'),_0x3e40e1=_0x3e4488[_0x441a62(0xd8d)][_0x441a62(0x460)],_0x2f2de6=document[_0x441a62(0xc86)]('input[name=\x22visibility\x22]:checked')['value'];let _0x215d06=null;_0x2f2de6==='include'&&(_0x215d06=Array[_0x441a62(0x1311)](document[_0x441a62(0x131c)](_0x441a62(0xbad)))[_0x441a62(0xb0a)](_0x2a933f=>parseInt(_0x2a933f[_0x441a62(0x7b2)])));let _0x11d96b={};const _0x2432e1={'timestamp':Date['now'](),'authorId':_0x441a62(0x20d),'visibleGroupIds':_0x215d06};if(_0x3e40e1===_0x441a62(0x23d)){const _0x3173fb=document[_0x441a62(0x9a3)](_0x441a62(0x13ad))[_0x441a62(0x7b2)][_0x441a62(0x13f9)]();if(!_0x3173fb){alert(_0x441a62(0x4b0));return;}_0x11d96b={..._0x2432e1,'type':'shuoshuo','content':_0x3173fb};}else{const _0x561460=document[_0x441a62(0x9a3)](_0x441a62(0x13ad))[_0x441a62(0x7b2)][_0x441a62(0x13f9)](),_0x1cac31=document[_0x441a62(0x9a3)](_0x441a62(0x2c9))[_0x441a62(0x4d8)][_0x441a62(0x1222)](_0x441a62(0xe9f));if(_0x1cac31){const _0x117de0=document[_0x441a62(0x9a3)](_0x441a62(0x7d2))[_0x441a62(0x10d4)],_0x1d40a4=document['getElementById'](_0x441a62(0xdae))[_0x441a62(0x7b2)]['trim']();if(!_0x117de0||!(_0x117de0[_0x441a62(0x608)](_0x441a62(0x978))||_0x117de0[_0x441a62(0x608)](_0x441a62(0xf82)))){alert(_0x441a62(0x1035));return;}if(!_0x1d40a4){alert(_0x441a62(0x7cf));return;}_0x11d96b={..._0x2432e1,'type':_0x441a62(0x1016),'publicText':_0x561460,'imageUrl':_0x117de0,'imageDescription':_0x1d40a4};}else{const _0x112845=document[_0x441a62(0x9a3)](_0x441a62(0x906))[_0x441a62(0x7b2)][_0x441a62(0x13f9)]();if(!_0x112845){alert(_0x441a62(0x120b));return;}_0x11d96b={..._0x2432e1,'type':_0x441a62(0x1281),'publicText':_0x561460,'hiddenContent':_0x112845};}}const _0x4990b3=await _0x512070[_0x441a62(0x10e5)]['add'](_0x11d96b);let _0xc20ea7=_0x11d96b[_0x441a62(0x4e3)]||_0x11d96b['publicText']||_0x11d96b[_0x441a62(0xbea)]||_0x11d96b[_0x441a62(0x14bb)]||'（无文字内容）';_0xc20ea7=_0xc20ea7[_0x441a62(0x72e)](0x0,0x32)+(_0xc20ea7[_0x441a62(0x106b)]>0x32?'...':'');for(const _0x419e6e in _0x19ddb8['chats']){const _0x53be4c=_0x19ddb8[_0x441a62(0xb04)][_0x419e6e];if(_0x53be4c[_0x441a62(0x136b)])continue;let _0x24f003=![];const _0x3a6f13=_0x11d96b[_0x441a62(0x1364)];if(!_0x3a6f13||_0x3a6f13[_0x441a62(0x106b)]===0x0)_0x24f003=!![];else _0x53be4c[_0x441a62(0x4ab)]&&_0x3a6f13[_0x441a62(0x478)](_0x53be4c['groupId'])&&(_0x24f003=!![]);if(_0x24f003){const _0x4a7ca0={'role':_0x441a62(0xe10),'content':_0x441a62(0xace)+_0x4990b3+_0x441a62(0x3bf)+_0xc20ea7+'”。请你【结合自己的角色设定、世界观和你们的最近聊天内容】，对这条动态发表一条自然的评论。]','timestamp':Date[_0x441a62(0x64b)](),'isHidden':!![]};_0x53be4c[_0x441a62(0x1f0)][_0x441a62(0x1c4)](_0x4a7ca0),await _0x512070[_0x441a62(0xb04)]['put'](_0x53be4c);}}await _0x49acff(),_0x3e4488[_0x441a62(0x4d8)]['remove'](_0x441a62(0xc09)),alert(_0x441a62(0x1339));});const _0x37ff27=document[_0x452732(0x9a3)](_0x452732(0x141a));let _0x1f9212={'isDragging':![],'startX':0x0,'startY':0x0,'currentX':0x0,'activeContainer':null,'swipeDirection':null,'isClick':!![]};function _0x11b0c4(_0x51d533=null){const _0x574e04=_0x452732;document['querySelectorAll'](_0x574e04(0x7b7))[_0x574e04(0x15c1)](_0x49b7e0=>{const _0x5dfc90=_0x574e04;_0x49b7e0!==_0x51d533&&_0x49b7e0['querySelector']('.qzone-post-item')['classList'][_0x5dfc90(0x133d)](_0x5dfc90(0x152c));});}async function _0x5d0407(_0x53b736){const _0x4fef7c=_0x452732;_0x53b736[_0x4fef7c(0x63a)]();const _0x55947c=_0x53b736[_0x4fef7c(0xa41)],_0x313a30=_0x55947c[_0x4fef7c(0x94c)](_0x4fef7c(0x2f6));if(_0x313a30){const _0x5ae224=_0x313a30[_0x4fef7c(0x94c)](_0x4fef7c(0x7b7)),_0x5a225c=parseInt(_0x5ae224[_0x4fef7c(0xd8d)]['postId']),_0x4129b1=parseInt(_0x313a30[_0x4fef7c(0xd8d)][_0x4fef7c(0xe90)]);if(isNaN(_0x5a225c)||isNaN(_0x4129b1))return;const _0x23f685=_0x1f6575['find'](_0x13aca6=>_0x13aca6['id']===_0x5a225c);if(!_0x23f685||!_0x23f685[_0x4fef7c(0xc79)]||!_0x23f685['comments'][_0x4129b1])return;const _0x2e89ee=_0x23f685[_0x4fef7c(0xc79)][_0x4129b1],_0x474bb0=await _0x2c9509(_0x4fef7c(0xa44),'确定要删除这条评论吗？',{'confirmButtonClass':_0x4fef7c(0xf5b)});if(_0x474bb0){_0x23f685['comments'][_0x4fef7c(0x15b0)](_0x4129b1,0x1),await _0x512070[_0x4fef7c(0x10e5)][_0x4fef7c(0xe33)](_0x5a225c,{'comments':_0x23f685[_0x4fef7c(0xc79)]});if(_0x2e89ee&&_0x2e89ee[_0x4fef7c(0x1200)]===_0x19ddb8[_0x4fef7c(0x9ce)][_0x4fef7c(0x246)]){console['log'](_0x4fef7c(0x48a));const _0x13d881=new Set();_0x23f685[_0x4fef7c(0x82c)]!==_0x4fef7c(0x20d)&&_0x13d881['add'](_0x23f685[_0x4fef7c(0x82c)]);if(_0x2e89ee[_0x4fef7c(0x877)]){const _0x3ed7b2=Object[_0x4fef7c(0xea1)](_0x19ddb8[_0x4fef7c(0xb04)])[_0x4fef7c(0xd62)](_0xb28a69=>_0xb28a69['originalName']===_0x2e89ee[_0x4fef7c(0x877)]);_0x3ed7b2&&_0x13d881[_0x4fef7c(0xe05)](_0x3ed7b2['id']);}const _0x2f34df=(_0x23f685['publicText']||_0x23f685[_0x4fef7c(0x4e3)]||'')[_0x4fef7c(0x72e)](0x0,0x1e),_0x49a364=_0x19ddb8[_0x4fef7c(0x9ce)][_0x4fef7c(0x246)];let _0x4c2f43;const _0x40915b=_0x19ddb8['userStickers'][_0x4fef7c(0xd62)](_0x485355=>_0x485355[_0x4fef7c(0x121f)]===_0x2e89ee[_0x4fef7c(0x13ca)]);if(_0x40915b)_0x4c2f43=_0x4fef7c(0xd09)+_0x49a364+_0x4fef7c(0x885)+_0x2f34df+'”下，发送了一个表情评论，意思是：“'+_0x40915b[_0x4fef7c(0x1561)]+'”。';else{if(_0x2e89ee['replyTo']){const _0x3e91eb=_0x2e9dd1(_0x2e89ee[_0x4fef7c(0x877)]);_0x4c2f43='用户\x27'+_0x49a364+_0x4fef7c(0x885)+_0x2f34df+_0x4fef7c(0x1bc)+_0x3e91eb+'\x27的评论，内容是：“'+_0x2e89ee[_0x4fef7c(0x13ca)]+'”。';}else _0x4c2f43='用户\x27'+_0x49a364+_0x4fef7c(0x13de)+_0x2f34df+_0x4fef7c(0xe6e)+_0x2e89ee[_0x4fef7c(0x13ca)]+'”。';}const _0x21bc0b=_0x4fef7c(0x345)+_0x4c2f43+'请你对此作出回应。]';for(const _0x8ddb4b of _0x13d881){const _0x322e6b=_0x19ddb8[_0x4fef7c(0xb04)][_0x8ddb4b];if(_0x322e6b){const _0x36ac4f=_0x322e6b[_0x4fef7c(0x1f0)][_0x4fef7c(0x106b)];_0x322e6b[_0x4fef7c(0x1f0)]=_0x322e6b['history'][_0x4fef7c(0x1195)](_0x150bff=>!(_0x150bff['isHidden']&&_0x150bff[_0x4fef7c(0x11c1)]===_0x4fef7c(0xe10)&&_0x150bff[_0x4fef7c(0x4e3)]===_0x21bc0b)),_0x322e6b[_0x4fef7c(0x1f0)][_0x4fef7c(0x106b)]<_0x36ac4f&&(console[_0x4fef7c(0xe4d)](_0x4fef7c(0x7a6)+_0x322e6b[_0x4fef7c(0x1561)]+_0x4fef7c(0xbc4)),await _0x512070['chats']['put'](_0x322e6b));}}}await _0x3d54a9(_0x5a225c);}return;}const _0x345f92=_0x55947c[_0x4fef7c(0x94c)](_0x4fef7c(0x13ea));if(_0x345f92){const _0x46157a=_0x345f92['closest'](_0x4fef7c(0x7b7));if(!_0x46157a)return;const _0x263235=parseInt(_0x46157a['dataset'][_0x4fef7c(0xb92)]);_0x176e91['isOpen']&&_0x176e91[_0x4fef7c(0x260)]===_0x263235?_0x49362c():_0xb1f208(_0x263235,_0x345f92);return;}const _0x3e6722=_0x55947c[_0x4fef7c(0x94c)](_0x4fef7c(0x15ca));if(_0x3e6722){const _0x2a821b=parseInt(_0x3e6722['dataset']['postId']),_0xb81f15=_0x3e6722[_0x4fef7c(0xd8d)][_0x4fef7c(0x90a)],_0x33c136=_0x3e6722[_0x4fef7c(0xd8d)]['commenterDisplayName'];if(!_0xb81f15||!_0x33c136||_0xb81f15===_0x19ddb8[_0x4fef7c(0x9ce)][_0x4fef7c(0x246)]){_0x2c3717(_0x3e6722[_0x4fef7c(0x94c)](_0x4fef7c(0x7b7)));return;}_0x5d423a={'postId':_0x2a821b,'replyToName':_0xb81f15,'replyToDisplayName':_0x33c136};const _0x5b92e=_0x3e6722['closest'](_0x4fef7c(0x7b7)),_0x3fefaf=_0x5b92e[_0x4fef7c(0xc86)]('.comment-input');_0x3fefaf['placeholder']=_0x4fef7c(0xaa8)+_0x33c136+':',_0x3fefaf[_0x4fef7c(0xdcf)]();return;}if(_0x55947c['classList'][_0x4fef7c(0x1222)](_0x4fef7c(0xbec))){const _0x17cfc7=_0x55947c['closest'](_0x4fef7c(0x7b7));if(_0x17cfc7&&_0x17cfc7['dataset'][_0x4fef7c(0xb92)])_0x3b1df2(parseInt(_0x17cfc7[_0x4fef7c(0xd8d)][_0x4fef7c(0xb92)]));return;}if(_0x55947c[_0x4fef7c(0x168)]==='IMG'&&_0x55947c[_0x4fef7c(0xd8d)]['hiddenText']){_0x403a62('图片内容',_0x55947c[_0x4fef7c(0xd8d)][_0x4fef7c(0x1234)][_0x4fef7c(0x1bb)](/<br>/g,'\x0a'));return;}const _0x358f36=_0x55947c[_0x4fef7c(0x94c)]('.qzone-post-container');if(!_0x358f36)return;const _0x15df58=parseInt(_0x358f36[_0x4fef7c(0xd8d)]['postId']);if(isNaN(_0x15df58))return;if(_0x55947c[_0x4fef7c(0x94c)](_0x4fef7c(0x11a2))){const _0x122f24=await _0x2c9509(_0x4fef7c(0x224),_0x4fef7c(0x8b1),{'confirmButtonClass':'btn-danger'});_0x122f24&&(_0x358f36[_0x4fef7c(0x20f)][_0x4fef7c(0x203)]=_0x4fef7c(0x21b),_0x358f36['style'][_0x4fef7c(0x352)]='scale(0.8)',_0x358f36['style'][_0x4fef7c(0x71f)]='0',setTimeout(async()=>{const _0x11c6bb=_0x4fef7c;await _0x512070[_0x11c6bb(0x10e5)][_0x11c6bb(0x10a8)](_0x15df58);const _0x2974ef='(ID:\x20'+_0x15df58+')';for(const _0x16e512 in _0x19ddb8[_0x11c6bb(0xb04)]){const _0x29b00d=_0x19ddb8[_0x11c6bb(0xb04)][_0x16e512],_0x2e2231=_0x29b00d[_0x11c6bb(0x1f0)][_0x11c6bb(0x106b)];_0x29b00d['history']=_0x29b00d[_0x11c6bb(0x1f0)][_0x11c6bb(0x1195)](_0x394fbd=>!(_0x394fbd['role']===_0x11c6bb(0xe10)&&_0x394fbd[_0x11c6bb(0x4e3)][_0x11c6bb(0x478)](_0x2974ef)));if(_0x29b00d['history'][_0x11c6bb(0x106b)]<_0x2e2231)await _0x512070[_0x11c6bb(0xb04)]['put'](_0x29b00d);}await _0x49acff(),alert('动态已删除。');},0x12c));return;}const _0x3a4ecd=_0x55947c['closest'](_0x4fef7c(0x930));if(_0x3a4ecd){if(_0x3a4ecd['classList']['contains'](_0x4fef7c(0x5ee))){_0x3f32eb(_0x15df58);return;}if(_0x3a4ecd[_0x4fef7c(0x4d8)][_0x4fef7c(0x1222)]('like')){const _0x206671=_0x1f6575[_0x4fef7c(0xd62)](_0x3b3310=>_0x3b3310['id']===_0x15df58);if(!_0x206671)return;if(!_0x206671[_0x4fef7c(0x807)])_0x206671['likes']=[];const _0xbcdf3=_0x19ddb8[_0x4fef7c(0x9ce)][_0x4fef7c(0x246)],_0x42a243=_0x206671['likes'][_0x4fef7c(0xef5)](_0xbcdf3);_0x42a243>-0x1?_0x206671[_0x4fef7c(0x807)][_0x4fef7c(0x15b0)](_0x42a243,0x1):(_0x206671['likes'][_0x4fef7c(0x1c4)](_0xbcdf3),_0x3a4ecd[_0x4fef7c(0x4d8)][_0x4fef7c(0xe05)](_0x4fef7c(0xdef)),_0x3a4ecd['addEventListener'](_0x4fef7c(0xa6c),()=>_0x3a4ecd[_0x4fef7c(0x4d8)]['remove'](_0x4fef7c(0xdef)),{'once':!![]})),await _0x512070[_0x4fef7c(0x10e5)][_0x4fef7c(0xe33)](_0x15df58,{'likes':_0x206671[_0x4fef7c(0x807)]}),await _0x3d54a9(_0x15df58);}if(_0x3a4ecd[_0x4fef7c(0x4d8)][_0x4fef7c(0x1222)](_0x4fef7c(0x91f))){const _0x3e06c4=await _0x512070['favorites'][_0x4fef7c(0x1201)]({'type':_0x4fef7c(0x120f),'content.id':_0x15df58})[_0x4fef7c(0x92c)]();if(_0x3e06c4)await _0x512070[_0x4fef7c(0x73d)]['delete'](_0x3e06c4['id']),await _0x403a62('提示',_0x4fef7c(0x59c));else{const _0x48f33f=await _0x512070[_0x4fef7c(0x10e5)][_0x4fef7c(0x14ee)](_0x15df58);_0x48f33f&&(await _0x512070[_0x4fef7c(0x73d)][_0x4fef7c(0xe05)]({'type':_0x4fef7c(0x120f),'content':_0x48f33f,'timestamp':Date['now']()}),await _0x403a62('提示',_0x4fef7c(0xe75)));}await _0x3d54a9(_0x15df58);}return;}const _0x44dc39=_0x55947c[_0x4fef7c(0x94c)](_0x4fef7c(0x919));if(_0x44dc39){const _0x5b9cac=_0x358f36['querySelector'](_0x4fef7c(0x31f)),_0x4c0427=_0x5b9cac[_0x4fef7c(0x7b2)][_0x4fef7c(0x13f9)]();if(!_0x4c0427)return alert(_0x4fef7c(0x13a0));const _0x46d6a6=_0x1f6575[_0x4fef7c(0xd62)](_0x27f465=>_0x27f465['id']===_0x15df58);if(!_0x46d6a6)return;if(!_0x46d6a6[_0x4fef7c(0xc79)])_0x46d6a6[_0x4fef7c(0xc79)]=[];const _0x9d1585={'commenterName':_0x19ddb8['qzoneSettings'][_0x4fef7c(0x246)],'text':_0x4c0427,'timestamp':Date[_0x4fef7c(0x64b)](),'replyTo':_0x5d423a&&_0x5d423a[_0x4fef7c(0xb92)]===_0x15df58?_0x5d423a['replyToName']:null};_0x46d6a6[_0x4fef7c(0xc79)]['push'](_0x9d1585),await _0x512070[_0x4fef7c(0x10e5)][_0x4fef7c(0xe33)](_0x15df58,{'comments':_0x46d6a6['comments']});let _0x2a199a=(_0x46d6a6['publicText']||_0x46d6a6['content']||'')[_0x4fef7c(0x72e)](0x0,0x1e);const _0x588d4a=_0x19ddb8[_0x4fef7c(0x9ce)]['nickname'],_0x2c5190=new Set();if(_0x46d6a6[_0x4fef7c(0x82c)]!=='user')_0x2c5190[_0x4fef7c(0xe05)](_0x46d6a6[_0x4fef7c(0x82c)]);if(_0x9d1585[_0x4fef7c(0x877)]&&_0x9d1585['replyTo']!==_0x588d4a){const _0x18069c=Object[_0x4fef7c(0xea1)](_0x19ddb8[_0x4fef7c(0xb04)])[_0x4fef7c(0xd62)](_0x3ca017=>_0x3ca017[_0x4fef7c(0x339)]===_0x9d1585[_0x4fef7c(0x877)]);if(_0x18069c)_0x2c5190[_0x4fef7c(0xe05)](_0x18069c['id']);}for(const _0x2a2fd2 of _0x2c5190){const _0x406f5c=_0x19ddb8[_0x4fef7c(0xb04)][_0x2a2fd2];if(_0x406f5c&&!_0x406f5c[_0x4fef7c(0x136b)]){const _0x38290c=_0x19ddb8[_0x4fef7c(0x1557)][_0x4fef7c(0xd62)](_0x59aa17=>_0x59aa17[_0x4fef7c(0x121f)]===_0x4c0427);let _0x4b9cfe=_0x38290c?_0x4fef7c(0xd09)+_0x588d4a+_0x4fef7c(0x885)+_0x2a199a+_0x4fef7c(0xcba)+_0x38290c[_0x4fef7c(0x1561)]+'”。':_0x9d1585[_0x4fef7c(0x877)]?_0x4fef7c(0xd09)+_0x588d4a+'\x27刚刚在你的动态“'+_0x2a199a+_0x4fef7c(0x1bc)+_0x5d423a['replyToDisplayName']+_0x4fef7c(0x1007)+_0x4c0427+'”。':_0x4fef7c(0xd09)+_0x588d4a+_0x4fef7c(0x13de)+_0x2a199a+'”，内容是：“'+_0x4c0427+'”。';const _0x5df926={'role':'system','content':'[系统提示：'+_0x4b9cfe+'请你对此作出回应。]','timestamp':Date[_0x4fef7c(0x64b)](),'isHidden':!![]};_0x406f5c[_0x4fef7c(0x1f0)]['push'](_0x5df926),await _0x512070['chats'][_0x4fef7c(0xd4d)](_0x406f5c);}}_0x5b9cac[_0x4fef7c(0x7b2)]='',_0x2c3717(_0x358f36),await _0x3d54a9(_0x15df58);return;}}const _0x3ae350=_0x1a7c2f=>{const _0x290ee2=_0x452732,_0xb62954=_0x1a7c2f[_0x290ee2(0xa41)];if(_0xb62954[_0x290ee2(0x94c)](_0x290ee2(0x9ba)))return;const _0x45edfa=_0x1a7c2f[_0x290ee2(0xa41)]['closest'](_0x290ee2(0x7b7));if(!_0x45edfa)return;_0x11b0c4(_0x45edfa),_0x1f9212[_0x290ee2(0x10ed)]=_0x45edfa,_0x1f9212[_0x290ee2(0x3ff)]=!![],_0x1f9212[_0x290ee2(0xaad)]=!![],_0x1f9212[_0x290ee2(0x5d9)]=null,_0x1f9212[_0x290ee2(0x21e)]=_0x1a7c2f[_0x290ee2(0x1508)]['includes']('mouse')?_0x1a7c2f['pageX']:_0x1a7c2f[_0x290ee2(0x12da)][0x0][_0x290ee2(0x476)],_0x1f9212[_0x290ee2(0x65c)]=_0x1a7c2f['type']['includes'](_0x290ee2(0x7b0))?_0x1a7c2f[_0x290ee2(0xd88)]:_0x1a7c2f[_0x290ee2(0x12da)][0x0]['pageY'],_0x1f9212[_0x290ee2(0x10ed)]['querySelector'](_0x290ee2(0x6cb))['style'][_0x290ee2(0x203)]=_0x290ee2(0x8e0),document['addEventListener'](_0x290ee2(0x61c),_0x316288),document[_0x290ee2(0x954)]('mouseup',_0x3313c5),document[_0x290ee2(0x954)](_0x290ee2(0x1294),_0x316288,{'passive':![]}),document[_0x290ee2(0x954)](_0x290ee2(0x36c),_0x3313c5);},_0x316288=_0x4206ff=>{const _0x5ad6c1=_0x452732;if(!_0x1f9212[_0x5ad6c1(0x3ff)]||!_0x1f9212[_0x5ad6c1(0x10ed)])return;const _0x3058ac=_0x4206ff['type'][_0x5ad6c1(0x478)](_0x5ad6c1(0x7b0))?_0x4206ff[_0x5ad6c1(0x476)]:_0x4206ff[_0x5ad6c1(0x12da)][0x0][_0x5ad6c1(0x476)],_0x4d0b06=_0x4206ff[_0x5ad6c1(0x1508)][_0x5ad6c1(0x478)](_0x5ad6c1(0x7b0))?_0x4206ff[_0x5ad6c1(0xd88)]:_0x4206ff[_0x5ad6c1(0x12da)][0x0][_0x5ad6c1(0xd88)],_0x3aa308=_0x3058ac-_0x1f9212[_0x5ad6c1(0x21e)],_0x2f7b22=_0x4d0b06-_0x1f9212[_0x5ad6c1(0x65c)];_0x1f9212[_0x5ad6c1(0xaad)]&&(Math[_0x5ad6c1(0xc7c)](_0x3aa308)>0x5||Math[_0x5ad6c1(0xc7c)](_0x2f7b22)>0x5)&&(_0x1f9212[_0x5ad6c1(0xaad)]=![]);!_0x1f9212['swipeDirection']&&(Math['abs'](_0x3aa308)>Math[_0x5ad6c1(0xc7c)](_0x2f7b22)?_0x1f9212[_0x5ad6c1(0x5d9)]=_0x5ad6c1(0x146b):_0x1f9212[_0x5ad6c1(0x5d9)]=_0x5ad6c1(0xba3));if(_0x1f9212['swipeDirection']==='horizontal'){_0x4206ff['preventDefault'](),_0x1f9212[_0x5ad6c1(0x3df)]=_0x3058ac;let _0x200479=Math[_0x5ad6c1(0xbf8)](0x0,Math[_0x5ad6c1(0x812)](-0x5a,_0x3aa308));_0x1f9212[_0x5ad6c1(0x10ed)][_0x5ad6c1(0xc86)](_0x5ad6c1(0x6cb))[_0x5ad6c1(0x20f)][_0x5ad6c1(0x352)]='translateX('+_0x200479+_0x5ad6c1(0xe24);}},_0x3313c5=_0x2c88d6=>{const _0x49023f=_0x452732;document['removeEventListener'](_0x49023f(0x61c),_0x316288),document[_0x49023f(0xd7f)](_0x49023f(0x11e4),_0x3313c5),document[_0x49023f(0xd7f)](_0x49023f(0x1294),_0x316288),document['removeEventListener']('touchend',_0x3313c5);if(!_0x1f9212[_0x49023f(0x3ff)]||!_0x1f9212[_0x49023f(0x10ed)])return;const _0x2b21d9=_0x1f9212[_0x49023f(0x10ed)][_0x49023f(0xc86)](_0x49023f(0x6cb));_0x2b21d9['style'][_0x49023f(0x203)]=_0x49023f(0xa55);if(_0x1f9212['swipeDirection']===_0x49023f(0x146b)&&!_0x1f9212[_0x49023f(0xaad)]){const _0x3912a2=_0x2c88d6[_0x49023f(0x1508)]['includes'](_0x49023f(0x36c))?_0x2c88d6[_0x49023f(0x270)][0x0][_0x49023f(0x476)]:_0x2c88d6[_0x49023f(0x476)],_0x56a438=_0x3912a2-_0x1f9212[_0x49023f(0x21e)];_0x56a438<-0x28?_0x2b21d9[_0x49023f(0x4d8)][_0x49023f(0xe05)]('swiped'):_0x2b21d9[_0x49023f(0x4d8)][_0x49023f(0x133d)](_0x49023f(0x152c));}_0x2b21d9['style']['transform']='',_0x1f9212[_0x49023f(0x3ff)]=![],_0x1f9212['activeContainer']=null,_0x1f9212['swipeDirection']=null,_0x1f9212[_0x49023f(0xaad)]=!![];};_0x37ff27[_0x452732(0x954)](_0x452732(0x9cc),_0x5d0407),_0x37ff27['addEventListener']('mousedown',_0x3ae350),_0x37ff27[_0x452732(0x954)](_0x452732(0xfab),_0x3ae350,{'passive':!![]}),_0x37ff27[_0x452732(0x954)](_0x452732(0x9cc),_0xb7eb41=>{const _0x399b2b=_0x452732;_0xb7eb41[_0x399b2b(0xa41)]&&_0xb7eb41[_0x399b2b(0xa41)]['id']===_0x399b2b(0x614)&&_0x555d97();}),document[_0x452732(0x9a3)](_0x452732(0xc95))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x3e6d4e=_0x452732;_0x19ddb8[_0x3e6d4e(0x859)]&&_0x2dbfd5(_0x19ddb8[_0x3e6d4e(0x859)]);}),document[_0x452732(0x9a3)](_0x452732(0xd64))[_0x452732(0x954)]('change',_0xa47634),document[_0x452732(0x9a3)]('save-api-preset-btn')[_0x452732(0x954)](_0x452732(0x9cc),_0xe6788),document[_0x452732(0x9a3)](_0x452732(0x105a))['addEventListener'](_0x452732(0x9cc),_0x26440a),document[_0x452732(0x9a3)](_0x452732(0x1330))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x4ee585=_0x452732,_0x1d4824=document[_0x4ee585(0x9a3)]('world-book-entries-container');_0x1d4824[_0x4ee585(0xc86)]('p')&&(_0x1d4824[_0x4ee585(0xeb2)]='');const _0xf46af2=_0x33835a();_0x1d4824[_0x4ee585(0x983)](_0xf46af2),_0xf46af2[_0x4ee585(0xc86)](_0x4ee585(0x1383))[_0x4ee585(0xdcf)]();}),document[_0x452732(0x9a3)](_0x452732(0x15b5))[_0x452732(0x954)]('click',_0x55c115),document[_0x452732(0x9a3)](_0x452732(0x13e5))[_0x452732(0x954)](_0x452732(0x9cc),_0x41eed6=>{const _0x2bc8ff=_0x452732;_0x41eed6[_0x2bc8ff(0xa41)]&&_0x41eed6[_0x2bc8ff(0xa41)]['id']===_0x2bc8ff(0x27c)&&_0x17a15b();}),document[_0x452732(0x9a3)](_0x452732(0x5c0))[_0x452732(0x954)](_0x452732(0x9cc),_0x12e742),document[_0x452732(0x9a3)]('history-back-btn')[_0x452732(0x954)]('click',_0x38915d),document[_0x452732(0x9a3)](_0x452732(0x842))[_0x452732(0x954)](_0x452732(0x9cc),_0x36b294=>{const _0xbf3c53=_0x452732;_0x36b294['target']['id']===_0xbf3c53(0x842)&&_0x36b294['target'][_0xbf3c53(0x4d8)]['remove'](_0xbf3c53(0xc09));}),document[_0x452732(0x9a3)](_0x452732(0xa5c))[_0x452732(0x954)](_0x452732(0x9cc),_0x39da36),document[_0x452732(0x9a3)]('delete-selected-stickers-btn')[_0x452732(0x954)](_0x452732(0x9cc),_0x2142e3),document[_0x452732(0x9a3)](_0x452732(0x12a4))[_0x452732(0x954)](_0x452732(0x9cc),()=>_0x499463(_0x452732(0xdd5))),document['getElementById'](_0x452732(0x292))[_0x452732(0x954)](_0x452732(0x9cc),()=>_0x499463('messages-view'));const _0x28b945=document['getElementById']('favorites-search-input'),_0x4ba1e7=document[_0x452732(0x9a3)]('favorites-search-clear-btn');_0x28b945[_0x452732(0x954)](_0x452732(0x1b4),()=>{const _0x23d8e1=_0x452732,_0x9d4907=_0x28b945['value'][_0x23d8e1(0x13f9)]()[_0x23d8e1(0x905)]();_0x4ba1e7[_0x23d8e1(0x20f)][_0x23d8e1(0x115d)]=_0x9d4907?_0x23d8e1(0x10c8):_0x23d8e1(0x8e0);if(!_0x9d4907){_0x27fff6(allFavoriteItems);return;}const _0x45ef43=allFavoriteItems['filter'](_0x20d6dc=>{const _0x271864=_0x23d8e1;let _0x4bf365='',_0x462ed2='';if(_0x20d6dc[_0x271864(0x1508)]==='qzone_post'){const _0x1f51d8=_0x20d6dc[_0x271864(0x4e3)];_0x4bf365+=(_0x1f51d8[_0x271864(0x6b9)]||'')+'\x20'+(_0x1f51d8[_0x271864(0x4e3)]||'');if(_0x1f51d8[_0x271864(0x82c)]===_0x271864(0x20d))_0x462ed2=_0x19ddb8[_0x271864(0x9ce)]['nickname'];else _0x19ddb8[_0x271864(0xb04)][_0x1f51d8[_0x271864(0x82c)]]&&(_0x462ed2=_0x19ddb8[_0x271864(0xb04)][_0x1f51d8[_0x271864(0x82c)]]['name']);}else{if(_0x20d6dc[_0x271864(0x1508)]===_0x271864(0xdd1)){const _0x26354e=_0x20d6dc['content'];typeof _0x26354e[_0x271864(0x4e3)]===_0x271864(0x86c)&&(_0x4bf365=_0x26354e[_0x271864(0x4e3)]);const _0x2fa4f4=_0x19ddb8[_0x271864(0xb04)][_0x20d6dc[_0x271864(0x907)]];_0x2fa4f4&&(_0x26354e[_0x271864(0x11c1)]==='user'?_0x462ed2=_0x2fa4f4['isGroup']?_0x2fa4f4[_0x271864(0x450)][_0x271864(0x1555)]||'我':'我':_0x462ed2=_0x2fa4f4[_0x271864(0x136b)]?_0x26354e[_0x271864(0x1043)]:_0x2fa4f4[_0x271864(0x1561)]);}}return _0x4bf365[_0x271864(0x905)]()[_0x271864(0x478)](_0x9d4907)||_0x462ed2[_0x271864(0x905)]()[_0x271864(0x478)](_0x9d4907);});_0x27fff6(_0x45ef43);}),_0x4ba1e7['addEventListener'](_0x452732(0x9cc),()=>{const _0x5b2dc8=_0x452732;_0x28b945[_0x5b2dc8(0x7b2)]='',_0x4ba1e7[_0x5b2dc8(0x20f)][_0x5b2dc8(0x115d)]='none',_0x27fff6(allFavoriteItems),_0x28b945[_0x5b2dc8(0xdcf)]();}),document[_0x452732(0x9a3)](_0x452732(0x15be))['addEventListener']('click',async()=>{const _0xae9edc=_0x452732;if(_0x445138[_0xae9edc(0xbdf)]===0x0)return;const _0x252355=_0x19ddb8[_0xae9edc(0xb04)][_0x19ddb8[_0xae9edc(0x859)]];if(!_0x252355)return;const _0x3c03c8=[],_0x2b5963=[..._0x445138];for(const _0x37d951 of _0x2b5963){const _0x180711=await _0x512070['favorites'][_0xae9edc(0x1201)](_0xae9edc(0xc3c))['equals'](_0x37d951)[_0xae9edc(0x92c)]();if(!_0x180711){const _0x329f35=_0x252355[_0xae9edc(0x1f0)]['find'](_0x5afd6c=>_0x5afd6c['timestamp']===_0x37d951);_0x329f35&&_0x3c03c8[_0xae9edc(0x1c4)]({'type':_0xae9edc(0xdd1),'content':_0x329f35,'chatId':_0x19ddb8[_0xae9edc(0x859)],'timestamp':Date[_0xae9edc(0x64b)](),'originalTimestamp':_0x329f35['timestamp']});}}_0x3c03c8[_0xae9edc(0x106b)]>0x0?(await _0x512070[_0xae9edc(0x73d)]['bulkAdd'](_0x3c03c8),allFavoriteItems=await _0x512070[_0xae9edc(0x73d)]['orderBy']('timestamp')[_0xae9edc(0x333)]()['toArray'](),await _0x403a62(_0xae9edc(0x1039),_0xae9edc(0x116f)+_0x3c03c8[_0xae9edc(0x106b)]+_0xae9edc(0x3af))):await _0x403a62('提示','选中的消息均已收藏过。'),_0x501f17();});const _0x148038=document[_0x452732(0x9a3)](_0x452732(0xf68)),_0x576bb5=document[_0x452732(0x9a3)](_0x452732(0x8a8)),_0x17ad9a=document[_0x452732(0x9a3)](_0x452732(0xe57)),_0x3e4d03=document[_0x452732(0x9a3)](_0x452732(0xc5d)),_0x224a27=document[_0x452732(0x9a3)]('favorites-list');_0x148038[_0x452732(0x954)]('click',()=>{const _0x27630c=_0x452732;_0x1fa4d3=!_0x1fa4d3,_0x576bb5['classList'][_0x27630c(0xc02)]('selection-mode',_0x1fa4d3),_0x1fa4d3?(_0x148038[_0x27630c(0x766)]='完成',_0x17ad9a['style'][_0x27630c(0x115d)]=_0x27630c(0x10c8),_0x3e4d03[_0x27630c(0x20f)][_0x27630c(0x115d)]='none',_0x224a27[_0x27630c(0x20f)][_0x27630c(0x576)]=_0x27630c(0x275)):(_0x148038[_0x27630c(0x766)]='编辑',_0x17ad9a[_0x27630c(0x20f)][_0x27630c(0x115d)]=_0x27630c(0x8e0),_0x3e4d03['style'][_0x27630c(0x115d)]=_0x27630c(0x79c),_0x224a27[_0x27630c(0x20f)][_0x27630c(0x576)]='',_0xedb373[_0x27630c(0xe81)](),document['querySelectorAll'](_0x27630c(0x242))[_0x27630c(0x15c1)](_0x451a0c=>_0x451a0c[_0x27630c(0x4d8)][_0x27630c(0x133d)](_0x27630c(0x154b))),document['getElementById'](_0x27630c(0x149f))['textContent']=_0x27630c(0x11b8));}),document[_0x452732(0x9a3)](_0x452732(0xc39))['addEventListener'](_0x452732(0x9cc),_0x10fd34=>{const _0x39156c=_0x452732,_0xc13128=_0x10fd34[_0x39156c(0xa41)],_0x341474=_0xc13128[_0x39156c(0x94c)]('.favorite-item-card');if(_0xc13128['tagName']==='IMG'&&_0xc13128['dataset'][_0x39156c(0x1234)]){const _0x43f84=_0xc13128['dataset'][_0x39156c(0x1234)];_0x403a62(_0x39156c(0x1313),_0x43f84['replace'](/<br>/g,'\x0a'));return;}if(!_0x1fa4d3)return;if(!_0x341474)return;const _0x485185=parseInt(_0x341474[_0x39156c(0xd8d)][_0x39156c(0xeae)]);if(isNaN(_0x485185))return;_0xedb373['has'](_0x485185)?(_0xedb373[_0x39156c(0x10a8)](_0x485185),_0x341474[_0x39156c(0x4d8)]['remove'](_0x39156c(0x154b))):(_0xedb373['add'](_0x485185),_0x341474[_0x39156c(0x4d8)][_0x39156c(0xe05)](_0x39156c(0x154b))),document['getElementById'](_0x39156c(0x149f))['textContent']=_0x39156c(0x1587)+_0xedb373[_0x39156c(0xbdf)]+')';}),document['getElementById']('favorites-delete-selected-btn')[_0x452732(0x954)]('click',async()=>{const _0x284ba7=_0x452732;if(_0xedb373[_0x284ba7(0xbdf)]===0x0)return;const _0x44c992=await _0x2c9509(_0x284ba7(0xd05),_0x284ba7(0x8c8)+_0xedb373[_0x284ba7(0xbdf)]+_0x284ba7(0xa46),{'confirmButtonClass':_0x284ba7(0xf5b)});if(_0x44c992){const _0x51fdbc=[..._0xedb373];await _0x512070[_0x284ba7(0x73d)][_0x284ba7(0x25c)](_0x51fdbc),await _0x403a62(_0x284ba7(0x784),_0x284ba7(0x1296)),allFavoriteItems=allFavoriteItems[_0x284ba7(0x1195)](_0x3fb943=>!_0x51fdbc[_0x284ba7(0x478)](_0x3fb943['id'])),_0x27fff6(allFavoriteItems),_0x148038[_0x284ba7(0x9cc)]();}});_0x19ddb8['globalSettings'][_0x452732(0x106e)]&&(_0x176181(),console[_0x452732(0xe4d)](_0x452732(0x1211)));document[_0x452732(0x131c)](_0x452732(0x441))[_0x452732(0x15c1)](_0x4b3f63=>{const _0x322b54=_0x452732;_0x4b3f63[_0x322b54(0x954)](_0x322b54(0xbbc),_0x2628c1);});const _0x4e9459=document['getElementById'](_0x452732(0xf38));_0x4e9459['addEventListener'](_0x452732(0x1b4),()=>{const _0x43ff10=_0x452732;document[_0x43ff10(0x9a3)](_0x43ff10(0x1071))['textContent']=_0x4e9459[_0x43ff10(0x7b2)]+'px',_0x2628c1();});const _0x3bc50b=document['getElementById'](_0x452732(0x750));_0x3bc50b[_0x452732(0x954)](_0x452732(0x1b4),_0x2628c1),document['getElementById'](_0x452732(0x8e2))[_0x452732(0x954)]('click',()=>{const _0x20bf03=_0x452732;document['getElementById'](_0x20bf03(0x9e7))[_0x20bf03(0x944)]=!![],_0x2628c1();}),document['getElementById'](_0x452732(0x1491))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x134ecb=_0x452732;document['getElementById'](_0x134ecb(0x750))[_0x134ecb(0x7b2)]='',_0x2628c1();}),document['getElementById']('lyrics-vertical-pos')[_0x452732(0x954)](_0x452732(0xbbc),_0x2628c1),document[_0x452732(0x9a3)](_0x452732(0xf1d))[_0x452732(0x954)](_0x452732(0xbbc),_0x2628c1),document[_0x452732(0x9a3)]('lyrics-offset-input')['addEventListener'](_0x452732(0x1b4),_0x2628c1),document['querySelectorAll']('input[name=\x22visibility\x22]')[_0x452732(0x15c1)](_0x542944=>{const _0x34859e=_0x452732;_0x542944[_0x34859e(0x954)](_0x34859e(0xbbc),function(){const _0x4a7f6b=_0x34859e,_0x10e177=document[_0x4a7f6b(0x9a3)](_0x4a7f6b(0x52c));this[_0x4a7f6b(0x7b2)]===_0x4a7f6b(0x1468)||this[_0x4a7f6b(0x7b2)]==='exclude'?_0x10e177[_0x4a7f6b(0x20f)][_0x4a7f6b(0x115d)]=_0x4a7f6b(0x10c8):_0x10e177[_0x4a7f6b(0x20f)]['display']='none';});}),document[_0x452732(0x9a3)](_0x452732(0x1044))['addEventListener'](_0x452732(0x9cc),_0x443bd7),document[_0x452732(0x9a3)](_0x452732(0x146f))[_0x452732(0x954)]('click',()=>{const _0x43d0ea=_0x452732;document[_0x43d0ea(0x9a3)]('group-management-modal')['classList']['remove'](_0x43d0ea(0xc09));const _0x1b8433=document['getElementById'](_0x43d0ea(0x1417));document[_0x43d0ea(0x9a3)]('chat-settings-modal')[_0x43d0ea(0x4d8)][_0x43d0ea(0x1222)](_0x43d0ea(0xc09))&&_0x1b8433[_0x43d0ea(0x9cc)]();}),document[_0x452732(0x9a3)](_0x452732(0x427))[_0x452732(0x954)]('click',_0x356016),document[_0x452732(0x9a3)](_0x452732(0x6f3))[_0x452732(0x954)](_0x452732(0x9cc),_0x4dfe96=>{const _0x32cc7c=_0x452732;if(_0x4dfe96['target'][_0x32cc7c(0x4d8)][_0x32cc7c(0x1222)](_0x32cc7c(0x6de))){const _0x3fbfde=parseInt(_0x4dfe96['target'][_0x32cc7c(0xd8d)]['id']);_0x5819e9(_0x3fbfde);}}),document[_0x452732(0x9a3)](_0x452732(0x1051))[_0x452732(0x954)](_0x452732(0x9cc),_0x1afb50),document[_0x452732(0x9a3)]('edit-message-btn')['addEventListener'](_0x452732(0x9cc),_0x3d9f94),document[_0x452732(0x9a3)](_0x452732(0xeac))[_0x452732(0x954)](_0x452732(0x9cc),_0x364707),document[_0x452732(0x9a3)](_0x452732(0x1131))[_0x452732(0x954)](_0x452732(0x9cc),_0x30f8ca),document['getElementById'](_0x452732(0x86a))['addEventListener'](_0x452732(0x9cc),()=>{const _0x231f66=_0x5c6e51;_0x1afb50(),_0x231f66&&_0x11fa62(_0x231f66);}),document[_0x452732(0x9a3)](_0x452732(0x10f8))[_0x452732(0x954)](_0x452732(0x9cc),_0xc3c8d4=>{const _0x4ce470=_0x452732,_0x5a286=_0xc3c8d4[_0x4ce470(0xa41)][_0x4ce470(0x94c)]('.message-bubble');if(!_0x5a286)return;if(_0x5a286[_0x4ce470(0x4d8)]['contains']('ai')&&_0x5a286[_0x4ce470(0x4d8)][_0x4ce470(0x1222)](_0x4ce470(0x13f2))&&_0x5a286[_0x4ce470(0xd8d)][_0x4ce470(0x27d)]===_0x4ce470(0x550)){const _0x355d04=parseInt(_0x5a286[_0x4ce470(0xd8d)]['timestamp']);!isNaN(_0x355d04)&&_0x1e9621(_0x355d04);}}),document['getElementById'](_0x452732(0x198))[_0x452732(0x954)](_0x452732(0x9cc),()=>_0x219744(_0x452732(0x967))),document[_0x452732(0x9a3)]('transfer-action-decline')[_0x452732(0x954)]('click',()=>_0x219744(_0x452732(0x900))),document[_0x452732(0x9a3)]('transfer-action-cancel')['addEventListener'](_0x452732(0x9cc),_0x361eab),document[_0x452732(0x9a3)](_0x452732(0x512))[_0x452732(0x954)]('click',_0x5e88ab),document['getElementById'](_0x452732(0x747))[_0x452732(0x954)](_0x452732(0x9cc),_0x526dce),document[_0x452732(0x9a3)](_0x452732(0x76d))[_0x452732(0x954)](_0x452732(0x9cc),_0x2edc46),document['getElementById'](_0x452732(0x4da))['addEventListener']('click',()=>{const _0xd33eff=_0x452732;_0x35df44(_0xd33eff(0xd7c));}),document['getElementById']('contact-picker-list')[_0x452732(0x954)](_0x452732(0x9cc),_0x588ed7=>{const _0x52d1b0=_0x452732,_0xb6616=_0x588ed7['target']['closest']('.contact-picker-item');if(!_0xb6616)return;const _0x4d1a5c=_0xb6616[_0x52d1b0(0xd8d)][_0x52d1b0(0x1503)];_0xb6616[_0x52d1b0(0x4d8)][_0x52d1b0(0xc02)](_0x52d1b0(0x154b)),_0x1f63dc[_0x52d1b0(0x1472)](_0x4d1a5c)?_0x1f63dc[_0x52d1b0(0x10a8)](_0x4d1a5c):_0x1f63dc[_0x52d1b0(0xe05)](_0x4d1a5c),_0xe76af();}),document[_0x452732(0x9a3)]('manage-members-btn')[_0x452732(0x954)](_0x452732(0x9cc),()=>{_0x2723dc();}),document[_0x452732(0x9a3)](_0x452732(0x259))['addEventListener']('click',()=>{const _0x54e057=_0x452732;_0x35df44('chat-interface-screen'),document[_0x54e057(0x9a3)](_0x54e057(0x1417))[_0x54e057(0x9cc)]();}),document[_0x452732(0x9a3)](_0x452732(0x723))[_0x452732(0x954)](_0x452732(0x9cc),_0x1b9f21=>{const _0x4e368d=_0x452732;_0x1b9f21[_0x4e368d(0xa41)][_0x4e368d(0x4d8)]['contains'](_0x4e368d(0xe59))&&_0x28e187(_0x1b9f21['target'][_0x4e368d(0xd8d)][_0x4e368d(0xd66)]);}),document[_0x452732(0x9a3)](_0x452732(0xe8b))[_0x452732(0x954)]('click',async()=>{const _0x34eaa9=_0x452732,_0x1e488f=document['getElementById'](_0x34eaa9(0xa4c)),_0x1f76f6=_0x1e488f[_0x34eaa9(0x173)](!![]);_0x1e488f[_0x34eaa9(0x5eb)][_0x34eaa9(0x15ab)](_0x1f76f6,_0x1e488f),_0x1f76f6[_0x34eaa9(0x954)](_0x34eaa9(0x9cc),_0x5a7ea7),await _0x1707ba();}),document[_0x452732(0x9a3)](_0x452732(0x14e5))[_0x452732(0x954)](_0x452732(0x9cc),_0x263778),document[_0x452732(0x9a3)](_0x452732(0xd68))[_0x452732(0x954)](_0x452732(0x9cc),_0x48a002),document['getElementById'](_0x452732(0x14ad))[_0x452732(0x954)](_0x452732(0x9cc),_0x48a002),document[_0x452732(0x9a3)](_0x452732(0x230))[_0x452732(0x954)](_0x452732(0x9cc),_0x1df58e),document[_0x452732(0x9a3)]('cancel-call-btn')[_0x452732(0x954)]('click',()=>{const _0x4273f0=_0x452732;_0x4acdaf[_0x4273f0(0x62c)]=![],_0x35df44(_0x4273f0(0x3e5));}),document[_0x452732(0x9a3)](_0x452732(0x2a7))[_0x452732(0x954)](_0x452732(0x9cc),_0x2803e3),document[_0x452732(0x9a3)]('decline-call-btn')[_0x452732(0x954)]('click',async()=>{const _0x1575f2=_0x452732;_0x51f830();const _0x22123f=_0x19ddb8[_0x1575f2(0xb04)][_0x4acdaf['activeChatId']];if(!_0x22123f)return;if(_0x4acdaf[_0x1575f2(0x6a0)]){_0x4acdaf[_0x1575f2(0xec1)]=![];const _0x24c9ff={'role':_0x1575f2(0xe10),'content':_0x1575f2(0x746),'timestamp':Date[_0x1575f2(0x64b)](),'isHidden':!![]};_0x22123f['history'][_0x1575f2(0x1c4)](_0x24c9ff),await _0x512070[_0x1575f2(0xb04)]['put'](_0x22123f),await _0x55bf11();}else{const _0x2d7da8={'role':_0x1575f2(0x20d),'content':'我拒绝了你的视频通话请求。','timestamp':Date['now']()};_0x22123f[_0x1575f2(0x1f0)]['push'](_0x2d7da8),await _0x512070[_0x1575f2(0xb04)][_0x1575f2(0xd4d)](_0x22123f),_0x35df44('chat-interface-screen'),_0x1ef393(_0x2d7da8,_0x22123f),_0x55bf11();}_0x4acdaf[_0x1575f2(0x62c)]=![];}),document[_0x452732(0x9a3)](_0x452732(0xc47))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x241355=_0x452732;_0x51f830(),_0x4acdaf[_0x241355(0x7d0)]='ai',_0x4acdaf[_0x241355(0xec1)]=!![],_0x4acdaf[_0x241355(0x859)]=_0x19ddb8[_0x241355(0x859)];if(_0x4acdaf[_0x241355(0x6a0)]){const _0x31c57b=_0x19ddb8[_0x241355(0xb04)][_0x4acdaf[_0x241355(0x859)]],_0xa47d9b=_0x31c57b[_0x241355(0xcca)]['find'](_0x561ed4=>_0x561ed4['name']===_0x4acdaf[_0x241355(0x488)]);_0xa47d9b?_0x4acdaf[_0x241355(0x9d3)]=[_0xa47d9b]:_0x4acdaf[_0x241355(0x9d3)]=[];}_0x1e2a5c();}),document['getElementById']('user-speak-btn')[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x39db13=_0x452732;if(!_0x4acdaf[_0x39db13(0x1412)])return;const _0x1b9ec7=document[_0x39db13(0xc86)](_0x39db13(0x97b));_0x1b9ec7&&_0x1b9ec7[_0x39db13(0x4d8)]['add'](_0x39db13(0x15b2));const _0x2ff2d9=await _0x3ab788('你说',_0x39db13(0xfb2));_0x1b9ec7&&_0x1b9ec7[_0x39db13(0x4d8)]['remove'](_0x39db13(0x15b2)),_0x2ff2d9&&_0x2ff2d9[_0x39db13(0x13f9)]()&&_0x4d3853(_0x2ff2d9[_0x39db13(0x13f9)]());}),document[_0x452732(0xc86)](_0x452732(0x5c6))['addEventListener']('click',()=>{const _0x1fac28=_0x452732;_0x1fa4d3&&document[_0x1fac28(0x9a3)]('favorites-edit-btn')['click'](),_0x499463(_0x1fac28(0xd8b)),_0x26bdc6();}),document['getElementById'](_0x452732(0x1379))['addEventListener'](_0x452732(0x9cc),()=>_0x499463(_0x452732(0xdd5))),document['getElementById'](_0x452732(0x24f))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x55a6c9=_0x452732,_0x8aaeda=document[_0x55a6c9(0x9a3)]('countdown-title-input')[_0x55a6c9(0x7b2)]['trim'](),_0x71c3b4=document['getElementById'](_0x55a6c9(0x463))[_0x55a6c9(0x7b2)];if(!_0x8aaeda||!_0x71c3b4){alert('请填写完整的约定标题和日期！');return;}const _0x323563=new Date(_0x71c3b4);if(isNaN(_0x323563)||_0x323563<=new Date()){alert('请输入一个有效的、未来的日期！');return;}const _0x1e7e6b={'authorId':_0x55a6c9(0x20d),'description':_0x8aaeda,'timestamp':Date[_0x55a6c9(0x64b)](),'type':_0x55a6c9(0x1407),'targetDate':_0x323563[_0x55a6c9(0xbd1)]()};await _0x512070[_0x55a6c9(0xe87)]['add'](_0x1e7e6b),document[_0x55a6c9(0x9a3)]('create-countdown-modal')['classList'][_0x55a6c9(0x133d)](_0x55a6c9(0xc09)),_0x26bdc6();}),document[_0x452732(0x9a3)](_0x452732(0x322))[_0x452732(0x954)]('click',async()=>{const _0x5cefc6=_0x452732;if(!_0x19ddb8[_0x5cefc6(0x859)]||_0x19ddb8[_0x5cefc6(0xb04)][_0x19ddb8[_0x5cefc6(0x859)]][_0x5cefc6(0x136b)])return;const _0x2e49cb=_0x19ddb8['chats'][_0x19ddb8[_0x5cefc6(0x859)]],_0x1971b6=await _0x2c9509(_0x5cefc6(0x1594),_0x5cefc6(0xd55)+_0x2e49cb[_0x5cefc6(0x1561)]+'”吗？拉黑后您将无法向其发送消息，直到您将Ta移出黑名单，或等待Ta重新申请好友。',{'confirmButtonClass':_0x5cefc6(0xf5b)});if(_0x1971b6){_0x2e49cb[_0x5cefc6(0x239)][_0x5cefc6(0x27d)]=_0x5cefc6(0x143f),_0x2e49cb[_0x5cefc6(0x239)]['blockedTimestamp']=Date['now']();const _0x5e7949={'role':_0x5cefc6(0xe10),'content':'[系统提示：你刚刚被用户拉黑了。在对方解除拉黑之前，你无法再主动发起对话，也无法回应。]','timestamp':Date[_0x5cefc6(0x64b)]()+0x1,'isHidden':!![]};_0x2e49cb[_0x5cefc6(0x1f0)][_0x5cefc6(0x1c4)](_0x5e7949),await _0x512070[_0x5cefc6(0xb04)]['put'](_0x2e49cb),document[_0x5cefc6(0x9a3)]('chat-settings-modal')[_0x5cefc6(0x4d8)][_0x5cefc6(0x133d)]('visible'),_0x56abd7(_0x19ddb8[_0x5cefc6(0x859)]),_0xec8072();}}),document[_0x452732(0x9a3)](_0x452732(0x73b))[_0x452732(0x954)](_0x452732(0x9cc),async _0x444024=>{const _0xabe34d=_0x452732,_0x13a591=_0x19ddb8['chats'][_0x19ddb8[_0xabe34d(0x859)]];if(!_0x13a591)return;if(_0x444024['target']['id']===_0xabe34d(0x88f)){alert(_0xabe34d(0x1e8)),await _0x3e3b3f(_0x13a591['id']),_0x56abd7(_0x13a591['id']);return;}if(_0x444024[_0xabe34d(0xa41)]['id']===_0xabe34d(0x685)){_0x13a591['relationship'][_0xabe34d(0x27d)]='friend',_0x13a591[_0xabe34d(0x239)][_0xabe34d(0x3ce)]=null;const _0x3ea52c={'role':'system','content':_0xabe34d(0x941),'timestamp':Date[_0xabe34d(0x64b)](),'isHidden':!![]};_0x13a591[_0xabe34d(0x1f0)][_0xabe34d(0x1c4)](_0x3ea52c),await _0x512070[_0xabe34d(0xb04)][_0xabe34d(0xd4d)](_0x13a591),_0x56abd7(_0x13a591['id']),_0xec8072(),_0x55bf11();}else{if(_0x444024['target']['id']===_0xabe34d(0x133b)){_0x13a591[_0xabe34d(0x239)][_0xabe34d(0x27d)]='friend',_0x13a591[_0xabe34d(0x239)][_0xabe34d(0x351)]='';const _0x6d4317={'role':_0xabe34d(0xe10),'type':'pat_message','content':'你通过了“'+_0x13a591[_0xabe34d(0x1561)]+'”的好友请求','timestamp':Date[_0xabe34d(0x64b)]()};_0x13a591[_0xabe34d(0x1f0)]['push'](_0x6d4317);const _0x7d0bfd={'role':_0xabe34d(0x115c),'senderName':_0x13a591[_0xabe34d(0x1561)],'content':_0xabe34d(0xd3a),'timestamp':Date[_0xabe34d(0x64b)]()+0x1};_0x13a591[_0xabe34d(0x1f0)][_0xabe34d(0x1c4)](_0x7d0bfd),await _0x512070[_0xabe34d(0xb04)][_0xabe34d(0xd4d)](_0x13a591),_0x56abd7(_0x13a591['id']),_0xec8072();}else{if(_0x444024[_0xabe34d(0xa41)]['id']===_0xabe34d(0x38a))_0x13a591[_0xabe34d(0x239)][_0xabe34d(0x27d)]='blocked_by_user',_0x13a591[_0xabe34d(0x239)]['blockedTimestamp']=Date[_0xabe34d(0x64b)](),_0x13a591[_0xabe34d(0x239)][_0xabe34d(0x351)]='',await _0x512070['chats'][_0xabe34d(0xd4d)](_0x13a591),_0x56abd7(_0x13a591['id']);else{if(_0x444024[_0xabe34d(0xa41)]['id']===_0xabe34d(0x15b4)){const _0x1043bc=await _0x3ab788(_0xabe34d(0x4e6),'请输入你想对“'+_0x13a591['name']+_0xabe34d(0x12e4),'我们和好吧！');_0x1043bc!==null&&(_0x13a591[_0xabe34d(0x239)]['status']=_0xabe34d(0xfd1),_0x13a591[_0xabe34d(0x239)][_0xabe34d(0x351)]=_0x1043bc,await _0x512070[_0xabe34d(0xb04)][_0xabe34d(0xd4d)](_0x13a591),_0x56abd7(_0x13a591['id']),_0xec8072(),_0x55bf11());}}}}}),document[_0x452732(0x9a3)]('transfer-btn')['addEventListener'](_0x452732(0x9cc),_0x3a60ff),document[_0x452732(0x9a3)](_0x452732(0x1bf))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x4cb585=_0x452732;document['getElementById'](_0x4cb585(0x808))[_0x4cb585(0x4d8)][_0x4cb585(0x133d)]('visible');}),document[_0x452732(0x9a3)]('send-group-packet-btn')[_0x452732(0x954)]('click',_0x409a27),document[_0x452732(0x9a3)](_0x452732(0x12f2))[_0x452732(0x954)](_0x452732(0x9cc),_0x15ea73);const _0x3e5d29=document[_0x452732(0x9a3)](_0x452732(0x1d9)),_0x548b7b=document['getElementById'](_0x452732(0x431)),_0x149156=document[_0x452732(0x9a3)](_0x452732(0x2b1)),_0x1e92d1=document[_0x452732(0x9a3)](_0x452732(0x534));_0x3e5d29['addEventListener'](_0x452732(0x9cc),()=>{const _0x51f907=_0x452732;_0x3e5d29[_0x51f907(0x4d8)][_0x51f907(0xe05)](_0x51f907(0xe9f)),_0x548b7b[_0x51f907(0x4d8)][_0x51f907(0x133d)](_0x51f907(0xe9f)),_0x149156[_0x51f907(0x20f)][_0x51f907(0x115d)]=_0x51f907(0x10c8),_0x1e92d1['style'][_0x51f907(0x115d)]=_0x51f907(0x8e0);}),_0x548b7b[_0x452732(0x954)]('click',()=>{const _0x2630f6=_0x452732;_0x548b7b['classList'][_0x2630f6(0xe05)](_0x2630f6(0xe9f)),_0x3e5d29[_0x2630f6(0x4d8)][_0x2630f6(0x133d)](_0x2630f6(0xe9f)),_0x1e92d1[_0x2630f6(0x20f)][_0x2630f6(0x115d)]=_0x2630f6(0x10c8),_0x149156['style'][_0x2630f6(0x115d)]=_0x2630f6(0x8e0);}),document[_0x452732(0x9a3)](_0x452732(0xb21))['addEventListener'](_0x452732(0x1b4),_0x595f51=>{const _0x50d5e7=_0x452732,_0x593677=parseFloat(_0x595f51[_0x50d5e7(0xa41)]['value'])||0x0;document[_0x50d5e7(0x9a3)](_0x50d5e7(0x9f7))['textContent']='¥\x20'+_0x593677['toFixed'](0x2);}),document[_0x452732(0x9a3)]('rp-direct-amount')[_0x452732(0x954)](_0x452732(0x1b4),_0x2f7ec6=>{const _0x2823bd=_0x452732,_0x23d910=parseFloat(_0x2f7ec6[_0x2823bd(0xa41)][_0x2823bd(0x7b2)])||0x0;document[_0x2823bd(0x9a3)](_0x2823bd(0xcd7))['textContent']='¥\x20'+_0x23d910['toFixed'](0x2);}),document[_0x452732(0x9a3)](_0x452732(0x10f8))['addEventListener'](_0x452732(0x9cc),_0x8b96a4=>{const _0x192a8c=_0x452732,_0xfcd1a5=_0x8b96a4[_0x192a8c(0xa41)][_0x192a8c(0x94c)](_0x192a8c(0x438));if(!_0xfcd1a5)return;const _0x1fcc37=_0xfcd1a5[_0x192a8c(0x94c)](_0x192a8c(0x5c4));if(!_0x1fcc37||!_0x1fcc37[_0x192a8c(0xd8d)][_0x192a8c(0xd73)])return;const _0xb38d28=parseInt(_0x1fcc37[_0x192a8c(0xd8d)][_0x192a8c(0xd73)]);_0x359abc(_0xb38d28);}),document['getElementById'](_0x452732(0xd3e))[_0x452732(0x954)](_0x452732(0x9cc),_0x1d7e35),document['getElementById'](_0x452732(0xe86))[_0x452732(0x954)]('click',_0x30d377),document[_0x452732(0x9a3)](_0x452732(0xb73))['addEventListener'](_0x452732(0x9cc),()=>{const _0x41ecf3=_0x452732;document['getElementById'](_0x41ecf3(0x103e))[_0x41ecf3(0x4d8)]['remove'](_0x41ecf3(0xc09));}),document[_0x452732(0x9a3)](_0x452732(0xebe))[_0x452732(0x954)]('click',_0x215527),document[_0x452732(0x9a3)](_0x452732(0x10f8))[_0x452732(0x954)]('click',_0x1a7392=>{const _0x4f633c=_0x452732,_0x2f1635=_0x1a7392[_0x4f633c(0xa41)]['closest'](_0x4f633c(0xc21));if(!_0x2f1635)return;const _0x556665=parseInt(_0x2f1635[_0x4f633c(0xd8d)][_0x4f633c(0xf41)]);if(isNaN(_0x556665))return;const _0x167e26=_0x1a7392[_0x4f633c(0xa41)][_0x4f633c(0x94c)]('.poll-option-item');if(_0x167e26&&!_0x2f1635['classList']['contains']('closed')){_0x5d3826(_0x556665,_0x167e26[_0x4f633c(0xd8d)][_0x4f633c(0x43a)]);return;}const _0x3edf5f=_0x1a7392[_0x4f633c(0xa41)][_0x4f633c(0x94c)](_0x4f633c(0xcab));if(_0x3edf5f){_0x2f1635[_0x4f633c(0x4d8)][_0x4f633c(0x1222)](_0x4f633c(0x8e3))?_0x1cb465(_0x556665):_0x4b1639(_0x556665);return;}_0x2f1635['classList'][_0x4f633c(0x1222)](_0x4f633c(0x8e3))&&_0x1cb465(_0x556665);}),document[_0x452732(0x9a3)](_0x452732(0xefe))[_0x452732(0x954)](_0x452732(0x9cc),_0x18251d),document[_0x452732(0x9a3)](_0x452732(0x1463))['addEventListener'](_0x452732(0x9cc),()=>_0x395242('ai')),document[_0x452732(0x9a3)](_0x452732(0x56a))[_0x452732(0x954)](_0x452732(0x9cc),()=>_0x395242(_0x452732(0xf67))),document[_0x452732(0x9a3)]('add-ai-avatar-url-btn')[_0x452732(0x954)]('click',_0x32da96),document['getElementById'](_0x452732(0x1338))[_0x452732(0x954)]('click',()=>{const _0x5bf49c=_0x452732;document[_0x5bf49c(0x9a3)](_0x5bf49c(0x1429))[_0x5bf49c(0x9cc)]();}),document[_0x452732(0x9a3)](_0x452732(0x1429))[_0x452732(0x954)]('change',_0x14ac14),document[_0x452732(0x9a3)](_0x452732(0xbff))[_0x452732(0x954)](_0x452732(0x9cc),_0x1b96da),document['getElementById'](_0x452732(0x96f))[_0x452732(0x954)]('click',_0x539e45),document['getElementById'](_0x452732(0xba5))[_0x452732(0x954)](_0x452732(0x9cc),_0x76e42b),document[_0x452732(0x9a3)](_0x452732(0x1315))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x2994b6=_0x452732;document[_0x2994b6(0x9a3)]('group-avatar-upload-input')[_0x2994b6(0x9cc)]();}),document[_0x452732(0x9a3)](_0x452732(0x2bc))[_0x452732(0x954)]('change',_0x566a7a),document[_0x452732(0x9a3)]('close-group-avatar-library-btn')['addEventListener'](_0x452732(0x9cc),_0x38e133),document[_0x452732(0x9a3)](_0x452732(0x92f))[_0x452732(0x954)](_0x452732(0x9cc),_0x2aebf1=>{const _0x4dd9d9=_0x452732;if(_0x2aebf1['target'][_0x4dd9d9(0x4d8)][_0x4dd9d9(0x1222)]('change-icon-btn')){const _0x3f5b4a=_0x2aebf1[_0x4dd9d9(0xa41)][_0x4dd9d9(0x94c)](_0x4dd9d9(0x2b0)),_0x11b8fb=_0x3f5b4a[_0x4dd9d9(0xd8d)]['iconId'];_0x11b8fb&&_0x580571(_0x11b8fb,_0x4dd9d9(0x10da),_0x3f5b4a);}}),document[_0x452732(0x9a3)](_0x452732(0x10f8))[_0x452732(0x954)]('click',_0x4ccceb=>{const _0x16a139=_0x452732,_0x820ade=_0x4ccceb[_0x16a139(0xa41)][_0x16a139(0x94c)](_0x16a139(0xac2));if(_0x820ade){const _0x4cd462=parseInt(_0x820ade[_0x16a139(0xd8d)][_0x16a139(0xd73)]);!isNaN(_0x4cd462)&&_0x4fe280(_0x4cd462);}}),document['getElementById'](_0x452732(0xe56))['addEventListener'](_0x452732(0x9cc),()=>{const _0x7d9290=_0x452732;_0x35df44(_0x7d9290(0x3e5));}),_0x176e91[_0x452732(0x10cc)][_0x452732(0x954)](_0x452732(0x9cc),async _0x32619d=>{const _0x251d64=_0x452732,_0xe43ac5=_0x32619d[_0x251d64(0xa41)][_0x251d64(0x94c)]('.sticker-item');if(_0xe43ac5&&_0x176e91[_0x251d64(0x260)]!==null){const _0x2e2895=_0xe43ac5['style']['backgroundImage'][_0x251d64(0x457)](0x5,-0x2),_0x53da33=_0x19ddb8[_0x251d64(0x1557)][_0x251d64(0xd62)](_0x307f9b=>_0x307f9b[_0x251d64(0x121f)]===_0x2e2895);_0x53da33?await _0x497958(_0x176e91['activePostId'],_0x53da33):console[_0x251d64(0x651)](_0x251d64(0xa27),_0x2e2895);}}),document['addEventListener']('click',_0x2d82fd=>{const _0x1c4638=_0x452732;_0x176e91[_0x1c4638(0x1030)]&&!_0x176e91[_0x1c4638(0x10cc)][_0x1c4638(0x1222)](_0x2d82fd[_0x1c4638(0xa41)])&&!_0x2d82fd[_0x1c4638(0xa41)][_0x1c4638(0x94c)](_0x1c4638(0x13ea))&&_0x49362c();}),document[_0x452732(0x9a3)](_0x452732(0xff2))[_0x452732(0x954)](_0x452732(0x9cc),_0x34f6ba),document[_0x452732(0x9a3)](_0x452732(0x1240))[_0x452732(0x954)]('click',()=>{const _0x4e07da=_0x452732;document[_0x4e07da(0x9a3)](_0x4e07da(0xa31))[_0x4e07da(0x4d8)]['remove'](_0x4e07da(0xc09));}),document[_0x452732(0x9a3)](_0x452732(0xa23))[_0x452732(0x954)](_0x452732(0x9cc),_0x300946),document[_0x452732(0x9a3)](_0x452732(0xfa8))[_0x452732(0x954)]('change',_0x34d679),document[_0x452732(0x9a3)](_0x452732(0x955))['addEventListener'](_0x452732(0xbbc),_0x958e3a=>{const _0xdee816=_0x452732;_0x5833f8(_0x958e3a['target'][_0xdee816(0x944)]);}),document[_0x452732(0x9a3)](_0x452732(0x32a))[_0x452732(0x954)](_0x452732(0xbbc),_0x5777dd=>{const _0x3aaed2=_0x452732;_0x585f8c(_0x5777dd[_0x3aaed2(0xa41)]['checked']);}),document[_0x452732(0x9a3)](_0x452732(0x981))[_0x452732(0x954)](_0x452732(0x9cc),_0x161c2b),document[_0x452732(0x9a3)](_0x452732(0xe61))[_0x452732(0x954)]('click',_0x1cc553),document[_0x452732(0x9a3)](_0x452732(0xd40))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x12acb3=_0x452732;_0x35df44(_0x12acb3(0xd7c));}),document[_0x452732(0x9a3)](_0x452732(0x771))[_0x452732(0x954)](_0x452732(0x9cc),_0x35c7b7=>{const _0x17a1ec=_0x452732,_0x137420=_0x35c7b7['target'][_0x17a1ec(0x94c)]('.call-record-card');_0x137420&&_0x137420['dataset'][_0x17a1ec(0x2a6)]&&_0x5303ef(parseInt(_0x137420['dataset']['recordId']));}),document[_0x452732(0x9a3)](_0x452732(0x113e))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x56ce8c=_0x452732;document['getElementById'](_0x56ce8c(0xd24))[_0x56ce8c(0x4d8)][_0x56ce8c(0x133d)](_0x56ce8c(0xc09));}),document[_0x452732(0x9a3)](_0x452732(0x592))[_0x452732(0x954)](_0x452732(0x9cc),_0x28be92),document[_0x452732(0x9a3)](_0x452732(0xff4))[_0x452732(0x954)](_0x452732(0x9cc),()=>{_0x445138['size']>0x0&&_0x579448();}),document['getElementById'](_0x452732(0x146e))[_0x452732(0x954)](_0x452732(0x9cc),_0x4dc586),document[_0x452732(0x9a3)]('confirm-share-target-btn')[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x1b0480=_0x452732,_0x3767fe=_0x19ddb8['chats'][_0x19ddb8['activeChatId']],_0x1a5586=Array[_0x1b0480(0x1311)](document['querySelectorAll']('.share-target-checkbox:checked'))[_0x1b0480(0xb0a)](_0x1f699b=>_0x1f699b[_0x1b0480(0xd8d)][_0x1b0480(0x907)]);if(_0x1a5586[_0x1b0480(0x106b)]===0x0){alert(_0x1b0480(0x12e1));return;}const _0x352ce6=[],_0x2da7b5=[..._0x445138][_0x1b0480(0x6a2)]((_0xddcc03,_0x31394c)=>_0xddcc03-_0x31394c);for(const _0x3d593b of _0x2da7b5){const _0xa1cc81=_0x3767fe['history'][_0x1b0480(0xd62)](_0x2bf12c=>_0x2bf12c[_0x1b0480(0xd73)]===_0x3d593b);_0xa1cc81&&_0x352ce6[_0x1b0480(0x1c4)](_0xa1cc81);}const _0x2f7234={'role':_0x1b0480(0x20d),'senderName':_0x3767fe[_0x1b0480(0x136b)]?_0x3767fe[_0x1b0480(0x450)]['myNickname']||'我':'我','type':_0x1b0480(0x68c),'timestamp':Date[_0x1b0480(0x64b)](),'payload':{'sourceChatName':_0x3767fe[_0x1b0480(0x1561)],'title':'来自“'+_0x3767fe[_0x1b0480(0x1561)]+'”的聊天记录','sharedHistory':_0x352ce6}};for(const _0x186a44 of _0x1a5586){const _0x5a7f1a=_0x19ddb8[_0x1b0480(0xb04)][_0x186a44];_0x5a7f1a&&(_0x5a7f1a[_0x1b0480(0x1f0)][_0x1b0480(0x1c4)](_0x2f7234),await _0x512070['chats'][_0x1b0480(0xd4d)](_0x5a7f1a));}document[_0x1b0480(0x9a3)]('share-target-modal')['classList'][_0x1b0480(0x133d)]('visible'),_0x501f17(),await _0x403a62(_0x1b0480(0x694),_0x1b0480(0xec5)+_0x1a5586[_0x1b0480(0x106b)]+_0x1b0480(0x51f)),_0xec8072();}),document[_0x452732(0x9a3)](_0x452732(0x35d))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x4fb63b=_0x452732;document[_0x4fb63b(0x9a3)](_0x4fb63b(0xedd))[_0x4fb63b(0x4d8)]['remove']('visible');}),document['getElementById'](_0x452732(0x10f8))[_0x452732(0x954)](_0x452732(0x9cc),_0x29ab75=>{const _0x121415=_0x452732,_0xcc844f=_0x29ab75[_0x121415(0xa41)][_0x121415(0x94c)](_0x121415(0xba6));if(_0xcc844f&&_0xcc844f[_0x121415(0x94c)](_0x121415(0x76b))){const _0x2b3e6d=parseInt(_0xcc844f[_0x121415(0xd8d)][_0x121415(0xd73)]);_0xc92cb8(_0x2b3e6d);}}),document[_0x452732(0x9a3)](_0x452732(0x523))[_0x452732(0x954)]('click',()=>{const _0x49aa35=_0x452732;document[_0x49aa35(0x9a3)](_0x49aa35(0x235))[_0x49aa35(0x4d8)][_0x49aa35(0x133d)](_0x49aa35(0xc09));});async function _0xc92cb8(_0x14cb76){const _0x37f78c=_0x452732,_0x30c5cc=_0x19ddb8[_0x37f78c(0xb04)][_0x19ddb8['activeChatId']];if(!_0x30c5cc)return;const _0x540737=_0x30c5cc[_0x37f78c(0x1f0)][_0x37f78c(0xd62)](_0x563adf=>_0x563adf['timestamp']===_0x14cb76);if(!_0x540737){console[_0x37f78c(0x3b7)](_0x37f78c(0xc64),_0x14cb76),await _0x403a62(_0x37f78c(0x1146),_0x37f78c(0x408));return;}if(_0x540737[_0x37f78c(0x1508)]===_0x37f78c(0x721)){_0x4fe280(_0x14cb76);return;}if(_0x540737['type']==='share_card'){if(!_0x540737[_0x37f78c(0x8b5)]||!_0x540737[_0x37f78c(0x8b5)]['sharedHistory']){console[_0x37f78c(0x3b7)]('聊天记录分享卡片数据损坏:',_0x540737),await _0x403a62(_0x37f78c(0x1146),_0x37f78c(0xd9e));return;}}else{console[_0x37f78c(0x3b7)](_0x37f78c(0x179),_0x540737[_0x37f78c(0x1508)]),await _0x403a62(_0x37f78c(0x1146),_0x37f78c(0x13d0));return;}const _0x5d05a5=document[_0x37f78c(0x9a3)]('shared-history-viewer-modal'),_0x1982d2=document['getElementById'](_0x37f78c(0xf15)),_0x1ac62d=document[_0x37f78c(0x9a3)](_0x37f78c(0xb13));_0x1982d2[_0x37f78c(0x766)]=_0x540737[_0x37f78c(0x8b5)][_0x37f78c(0x10b8)],_0x1ac62d['innerHTML']='';const _0x15a661=document[_0x37f78c(0xa4d)](),_0x475502=Object[_0x37f78c(0xea1)](_0x19ddb8['chats'])[_0x37f78c(0xd62)](_0x1f0703=>_0x1f0703[_0x37f78c(0x1561)]===_0x540737[_0x37f78c(0x8b5)][_0x37f78c(0x486)])||_0x30c5cc;for(const _0x254788 of _0x540737[_0x37f78c(0x8b5)][_0x37f78c(0x1396)]){const _0x47661d=await _0xb42d69(_0x254788,_0x475502);_0x47661d&&_0x15a661[_0x37f78c(0x983)](_0x47661d);}_0x1ac62d[_0x37f78c(0x983)](_0x15a661),_0x5d05a5[_0x37f78c(0x4d8)]['add'](_0x37f78c(0xc09));}_0x4a7bb9[_0x452732(0x954)]('timeupdate',_0x2a9444),_0x4a7bb9['addEventListener'](_0x452732(0x201),()=>{const _0x57873f=_0x452732;_0x4e0631[_0x57873f(0x1412)]&&(_0x4e0631[_0x57873f(0xce1)]=![],phoneScreenForIsland[_0x57873f(0x4d8)]['remove']('dynamic-island-active'),_0x321261());}),_0x4a7bb9[_0x452732(0x954)]('play',()=>{const _0xb5698c=_0x452732;_0x4e0631[_0xb5698c(0x1412)]&&(_0x4e0631[_0xb5698c(0xce1)]=!![],_0x321261());}),document[_0x452732(0x9a3)]('playlist-body')[_0x452732(0x954)](_0x452732(0x9cc),async _0x4e7530=>{const _0x1d2445=_0x452732,_0x1e7cf5=_0x4e7530[_0x1d2445(0xa41)],_0x6415fc=_0x1e7cf5[_0x1d2445(0x94c)]('.album-art-btn');if(_0x6415fc){const _0x17b014=parseInt(_0x6415fc[_0x1d2445(0xd8d)][_0x1d2445(0x111b)]);!isNaN(_0x17b014)&&await _0x37bae6(_0x17b014);return;}const _0x161b92=_0x1e7cf5['closest'](_0x1d2445(0x100e));if(_0x161b92){const _0x3166d7=parseInt(_0x161b92[_0x1d2445(0xd8d)][_0x1d2445(0x111b)]);if(isNaN(_0x3166d7))return;await _0xfb1ee7(_0x3166d7);return;}const _0x23af03=_0x1e7cf5[_0x1d2445(0x94c)]('.delete-track-btn');if(_0x23af03){const _0x3d9c95=parseInt(_0x23af03['dataset'][_0x1d2445(0x111b)]);if(isNaN(_0x3d9c95))return;const _0x391c10=_0x4e0631[_0x1d2445(0x496)][_0x3d9c95],_0xe2a21=await _0x2c9509(_0x1d2445(0xf87),_0x1d2445(0x151f)+_0x391c10[_0x1d2445(0x1561)]+_0x1d2445(0xb14));_0xe2a21&&_0x45aba2(_0x3d9c95);return;}const _0x901b73=_0x1e7cf5[_0x1d2445(0x94c)](_0x1d2445(0x312));if(_0x901b73){const _0x786566=_0x901b73['closest'](_0x1d2445(0x717)),_0x2bdd21=Array[_0x1d2445(0x1311)](_0x786566['parentElement']['children'])[_0x1d2445(0xef5)](_0x786566);_0x2bdd21>-0x1&&_0x11f565(_0x2bdd21);}}),document[_0x452732(0xc86)](_0x452732(0xfe1))[_0x452732(0x954)](_0x452732(0x9cc),_0x12639e=>{const _0x5e0afa=_0x452732;if(!_0x4a7bb9[_0x5e0afa(0xf58)])return;const _0x1cc4d2=_0x12639e[_0x5e0afa(0x678)],_0x2e2138=_0x1cc4d2[_0x5e0afa(0x89d)],_0x500f0e=_0x12639e[_0x5e0afa(0x340)];_0x4a7bb9[_0x5e0afa(0x7d5)]=_0x500f0e/_0x2e2138*_0x4a7bb9[_0x5e0afa(0xf58)];}),document['getElementById']('chat-messages')[_0x452732(0x954)](_0x452732(0x9cc),_0x137255=>{const _0x3d9729=_0x452732,_0x38ce62=_0x137255['target'][_0x3d9729(0x94c)](_0x3d9729(0x135b));if(_0x38ce62){const _0x3fe004=_0x19ddb8[_0x3d9729(0xb04)][_0x19ddb8['activeChatId']],_0x46752d=_0x38ce62[_0x3d9729(0x94c)](_0x3d9729(0x141c));if(_0x3fe004&&_0x46752d){const _0x477b03=parseInt(_0x46752d['dataset'][_0x3d9729(0xd73)]),_0x2776ef=_0x3fe004[_0x3d9729(0x1f0)][_0x3d9729(0xd62)](_0x2f75f2=>_0x2f75f2[_0x3d9729(0xd73)]===_0x477b03);if(_0x2776ef&&_0x2776ef['recalledData']){let _0x1f0419='';const _0x42c43e=_0x2776ef[_0x3d9729(0x506)];switch(_0x42c43e[_0x3d9729(0x32c)]){case _0x3d9729(0x13ca):_0x1f0419=_0x3d9729(0x3b6)+_0x42c43e['originalContent']+'\x22';break;case'user_photo':case _0x3d9729(0x1c1):case _0x3d9729(0x1281):_0x1f0419=_0x3d9729(0x1056)+_0x42c43e[_0x3d9729(0x1568)]+'\x22';break;case _0x3d9729(0x1207):_0x1f0419=_0x3d9729(0x800)+_0x42c43e[_0x3d9729(0x1568)]+'\x22';break;case _0x3d9729(0xda8):_0x1f0419=_0x3d9729(0x857)+(_0x42c43e[_0x3d9729(0xf55)]||_0x3d9729(0x103c))+_0x3d9729(0x6b0)+_0x42c43e[_0x3d9729(0x1568)];break;case _0x3d9729(0x4b3):_0x1f0419=_0x3d9729(0xc65);break;default:_0x1f0419=_0x3d9729(0xbba)+_0x42c43e[_0x3d9729(0x32c)]+_0x3d9729(0xdb5)+JSON['stringify'](_0x42c43e[_0x3d9729(0x1568)]);break;}_0x403a62(_0x3d9729(0x1385),_0x1f0419);}}}}),document[_0x452732(0x9a3)]('manage-world-book-categories-btn')[_0x452732(0x954)](_0x452732(0x9cc),_0x3972c6),document[_0x452732(0x9a3)](_0x452732(0xef6))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x8ceec4=_0x452732;document[_0x8ceec4(0x9a3)](_0x8ceec4(0x86b))['classList'][_0x8ceec4(0x133d)]('visible'),_0x52d7ba();}),document['getElementById']('add-new-category-btn')['addEventListener']('click',_0x49af57),document[_0x452732(0x9a3)](_0x452732(0xe42))[_0x452732(0x954)](_0x452732(0x9cc),_0x47b554=>{const _0x6a8102=_0x452732;if(_0x47b554['target'][_0x6a8102(0x4d8)]['contains']('delete-group-btn')){const _0x46cfe7=parseInt(_0x47b554[_0x6a8102(0xa41)][_0x6a8102(0xd8d)]['id']);_0x3e0187(_0x46cfe7);}}),document[_0x452732(0x9a3)](_0x452732(0x11fd))[_0x452732(0x954)](_0x452732(0x9cc),_0x44cf39),document['getElementById'](_0x452732(0x62f))[_0x452732(0x954)](_0x452732(0x9cc),_0x39bcbe),document['getElementById']('quote-message-btn')[_0x452732(0x954)]('click',_0x1d5e00),document[_0x452732(0x9a3)](_0x452732(0x5b4))[_0x452732(0x954)](_0x452732(0x9cc),_0x40142f),document[_0x452732(0x9a3)](_0x452732(0x141a))[_0x452732(0x954)](_0x452732(0x1b4),_0xf1ba65=>{const _0x43045c=_0x452732;if(!_0xf1ba65[_0x43045c(0xa41)][_0x43045c(0x78d)](_0x43045c(0x31f)))return;const _0x599629=_0xf1ba65[_0x43045c(0xa41)],_0x3ccc8d=_0x599629[_0x43045c(0x94c)](_0x43045c(0x7b7));if(!_0x3ccc8d)return;const _0x46bbae=_0x3ccc8d['querySelector'](_0x43045c(0x215)),_0x14cef3=_0x599629['value'],_0x1ef482=_0x14cef3[_0x43045c(0x293)](/@([\p{L}\w]*)$/u);if(_0x1ef482){const _0x1d58e0=new Set(),_0xb9801e=_0x3ccc8d[_0x43045c(0xc86)]('.post-nickname')?.[_0x43045c(0x766)];if(_0xb9801e)_0x1d58e0[_0x43045c(0xe05)](_0xb9801e);_0x3ccc8d[_0x43045c(0x131c)](_0x43045c(0xa97))[_0x43045c(0x15c1)](_0x237489=>{const _0x3daf61=_0x43045c;_0x1d58e0[_0x3daf61(0xe05)](_0x237489['textContent']['replace'](':',''));}),_0x1d58e0[_0x43045c(0x10a8)](_0x19ddb8[_0x43045c(0x9ce)][_0x43045c(0x246)]),_0x46bbae[_0x43045c(0xeb2)]='';if(_0x1d58e0[_0x43045c(0xbdf)]>0x0){const _0x3fa468=_0x1ef482[0x1];_0x1d58e0['forEach'](_0x109910=>{const _0x269b05=_0x43045c;if(_0x109910[_0x269b05(0x905)]()['includes'](_0x3fa468[_0x269b05(0x905)]())){const _0x45d6cb=document['createElement'](_0x269b05(0x8ca));_0x45d6cb[_0x269b05(0x1487)]=_0x269b05(0x410),_0x45d6cb[_0x269b05(0x766)]=_0x109910,_0x45d6cb[_0x269b05(0x954)](_0x269b05(0x81d),_0x5cad73=>{const _0x36119d=_0x269b05;_0x5cad73['preventDefault']();const _0x4a0af3=_0x14cef3[_0x36119d(0x72e)](0x0,_0x1ef482['index'])+('@'+_0x109910+'\x20');_0x599629[_0x36119d(0x7b2)]=_0x4a0af3,_0x46bbae[_0x36119d(0x20f)][_0x36119d(0x115d)]='none',_0x599629[_0x36119d(0xdcf)]();}),_0x46bbae[_0x269b05(0x983)](_0x45d6cb);}}),_0x46bbae['style'][_0x43045c(0x115d)]=_0x46bbae[_0x43045c(0xb4a)]['length']>0x0?_0x43045c(0x10c8):_0x43045c(0x8e0);}else _0x46bbae['style'][_0x43045c(0x115d)]=_0x43045c(0x8e0);}else _0x46bbae[_0x43045c(0x20f)][_0x43045c(0x115d)]=_0x43045c(0x8e0);}),document['getElementById'](_0x452732(0x141a))[_0x452732(0x954)](_0x452732(0x298),_0x9c4a69=>{const _0x47d1bb=_0x452732;if(_0x9c4a69[_0x47d1bb(0xa41)][_0x47d1bb(0x78d)](_0x47d1bb(0x31f))){const _0x3961f0=_0x9c4a69[_0x47d1bb(0xa41)][_0x47d1bb(0x94c)](_0x47d1bb(0x7b7));if(_0x3961f0){const _0x24a81b=_0x3961f0['querySelector']('.at-mention-popup');_0x24a81b&&setTimeout(()=>{const _0x4c940f=_0x47d1bb;_0x24a81b['style'][_0x4c940f(0x115d)]='none';},0xc8);}}});const _0x2cbcd1=document[_0x452732(0x9a3)](_0x452732(0xf84)),_0x35d541=document[_0x452732(0x9a3)](_0x452732(0x253));_0x2cbcd1[_0x452732(0x954)](_0x452732(0x1b4),()=>{const _0x2f4375=_0x452732;if(!_0x19ddb8['activeChatId']||!_0x19ddb8[_0x2f4375(0xb04)][_0x19ddb8['activeChatId']]['isGroup']){_0x35d541[_0x2f4375(0x20f)][_0x2f4375(0x115d)]=_0x2f4375(0x8e0);return;}const _0x216d75=_0x19ddb8[_0x2f4375(0xb04)][_0x19ddb8[_0x2f4375(0x859)]],_0x3f7539=_0x2cbcd1[_0x2f4375(0x7b2)],_0x20b097=_0x3f7539['match'](/@([\p{L}\w]*)$/u);if(_0x20b097){const _0x48e889=_0x216d75['settings'][_0x2f4375(0x1555)]||'我',_0x134d19=_0x216d75[_0x2f4375(0xcca)][_0x2f4375(0xb0a)](_0x1a6998=>_0x1a6998[_0x2f4375(0xaf0)])[_0x2f4375(0x1195)](_0x46574d=>_0x46574d!==_0x48e889);_0x35d541[_0x2f4375(0xeb2)]='';if(_0x134d19[_0x2f4375(0x106b)]>0x0){const _0x20a060=_0x20b097[0x1];_0x134d19[_0x2f4375(0x15c1)](_0x3b289a=>{const _0x454763=_0x2f4375;if(_0x3b289a[_0x454763(0x905)]()[_0x454763(0x478)](_0x20a060[_0x454763(0x905)]())){const _0x4e6441=document[_0x454763(0xe94)](_0x454763(0x8ca));_0x4e6441[_0x454763(0x1487)]=_0x454763(0x410),_0x4e6441['textContent']=_0x3b289a,_0x4e6441[_0x454763(0x954)](_0x454763(0x81d),_0x1f0532=>{const _0x3d01d3=_0x454763;_0x1f0532[_0x3d01d3(0x28d)]();const _0x5f4227=_0x3f7539[_0x3d01d3(0x72e)](0x0,_0x20b097[_0x3d01d3(0x111b)])+('@'+_0x3b289a+'\x20');_0x2cbcd1[_0x3d01d3(0x7b2)]=_0x5f4227,_0x35d541['style'][_0x3d01d3(0x115d)]=_0x3d01d3(0x8e0),_0x2cbcd1['focus']();}),_0x35d541[_0x454763(0x983)](_0x4e6441);}}),_0x35d541[_0x2f4375(0x20f)][_0x2f4375(0x115d)]=_0x35d541[_0x2f4375(0xb4a)][_0x2f4375(0x106b)]>0x0?_0x2f4375(0x10c8):_0x2f4375(0x8e0);}else _0x35d541['style'][_0x2f4375(0x115d)]=_0x2f4375(0x8e0);}else _0x35d541[_0x2f4375(0x20f)][_0x2f4375(0x115d)]=_0x2f4375(0x8e0);}),_0x2cbcd1[_0x452732(0x954)](_0x452732(0xe1f),()=>{setTimeout(()=>{const _0x1825a5=_0x1efc;_0x35d541[_0x1825a5(0x20f)][_0x1825a5(0x115d)]=_0x1825a5(0x8e0);},0xc8);}),document[_0x452732(0x9a3)](_0x452732(0x8a5))[_0x452732(0x954)](_0x452732(0x9cc),_0x3a2ec9),document[_0x452732(0x9a3)](_0x452732(0x10c4))[_0x452732(0x954)]('click',_0x3b0850),document['getElementById'](_0x452732(0x65e))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x121972=_0x452732;document[_0x121972(0x9a3)](_0x121972(0xf7b))[_0x121972(0x4d8)][_0x121972(0x133d)]('visible');}),document[_0x452732(0x9a3)](_0x452732(0x5bc))[_0x452732(0x954)](_0x452732(0x9cc),_0x4b50ad=>{const _0x37db0c=_0x452732;if(_0x4b50ad[_0x37db0c(0xa41)][_0x37db0c(0x4d8)][_0x37db0c(0x1222)](_0x37db0c(0x10ba))){const _0x5190c8=_0x4b50ad['target'][_0x37db0c(0xd8d)][_0x37db0c(0x2e7)];_0x5190c8&&_0x58c81a(_0x5190c8);}}),document['getElementById'](_0x452732(0x1e9))[_0x452732(0x954)]('click',_0x2425a6),document['getElementById'](_0x452732(0xc57))[_0x452732(0x954)]('click',_0x29c7da),document['getElementById']('announcement-action-cancel')[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x21a304=_0x452732;document['getElementById'](_0x21a304(0x39a))['classList'][_0x21a304(0x133d)](_0x21a304(0xc09));}),document[_0x452732(0x9a3)]('reset-global-css-btn')[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x5e9e91=_0x452732;document[_0x5e9e91(0x9a3)](_0x5e9e91(0x543))[_0x5e9e91(0x7b2)]='';}),document[_0x452732(0x9a3)](_0x452732(0x4a6))[_0x452732(0x954)](_0x452732(0x9cc),_0x5349c4),document[_0x452732(0x9a3)](_0x452732(0xb3b))[_0x452732(0x954)]('click',()=>{const _0x3f55a8=_0x452732;_0x35df44(_0x3f55a8(0x3e5));}),document[_0x452732(0x9a3)](_0x452732(0xb60))['addEventListener'](_0x452732(0x9cc),_0x2baeff),document['getElementById'](_0x452732(0x183))[_0x452732(0x954)]('click',_0x271eef),document[_0x452732(0x9a3)]('memory-list-container')[_0x452732(0x954)](_0x452732(0x9cc),_0x3e8d02=>{const _0x387d21=_0x452732,_0x8e870d=_0x3e8d02['target']['closest']('.edit-memory-btn');if(_0x8e870d){_0x160547(_0x8e870d['dataset'][_0x387d21(0x82c)],parseInt(_0x8e870d['dataset']['memoryTimestamp']));return;}const _0x599c5d=_0x3e8d02[_0x387d21(0xa41)]['closest'](_0x387d21(0x1e4));if(_0x599c5d){_0x458b91(_0x599c5d[_0x387d21(0xd8d)][_0x387d21(0x82c)],parseInt(_0x599c5d[_0x387d21(0xd8d)][_0x387d21(0xb0d)]));return;}}),document[_0x452732(0x9a3)](_0x452732(0x62e))['addEventListener']('click',_0x18d554),document['getElementById']('close-gomoku-btn')[_0x452732(0x954)](_0x452732(0x9cc),_0x4855c0);const _0x4b82bc=document[_0x452732(0x9a3)](_0x452732(0x1128));_0x4b82bc[_0x452732(0x954)](_0x452732(0x61c),_0x3c737b),_0x4b82bc[_0x452732(0x954)](_0x452732(0x15d1),()=>_0x7077d1(_0x19ddb8[_0x452732(0x859)])),_0x4b82bc[_0x452732(0x954)](_0x452732(0x9cc),_0x1ac456),document[_0x452732(0x9a3)](_0x452732(0x13c6))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x413b1a=_0x452732;document['getElementById'](_0x413b1a(0xcd8))[_0x413b1a(0x7b2)]='',document[_0x413b1a(0x9a3)](_0x413b1a(0x463))['value']='',document[_0x413b1a(0x9a3)](_0x413b1a(0x10cd))[_0x413b1a(0x4d8)][_0x413b1a(0xe05)](_0x413b1a(0xc09));}),document[_0x452732(0x9a3)](_0x452732(0x3b0))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x199515=_0x452732;document[_0x199515(0x9a3)](_0x199515(0x10cd))[_0x199515(0x4d8)]['remove'](_0x199515(0xc09));}),document[_0x452732(0x9a3)](_0x452732(0x5da))[_0x452732(0x954)]('click',_0x11c3ed),document[_0x452732(0x9a3)](_0x452732(0x927))[_0x452732(0x954)](_0x452732(0x9cc),_0x5a44da),document[_0x452732(0x9a3)](_0x452732(0x1430))[_0x452732(0x954)](_0x452732(0x9cc),_0x8a37af),document['getElementById'](_0x452732(0x770))['addEventListener'](_0x452732(0x9cc),_0x233b69),document[_0x452732(0x9a3)](_0x452732(0x1572))['addEventListener'](_0x452732(0x9cc),()=>{const _0x256f7f=_0x452732;document[_0x256f7f(0x9a3)](_0x256f7f(0x13aa))['classList']['remove']('visible');}),document['getElementById'](_0x452732(0xf5a))['addEventListener'](_0x452732(0x9cc),_0x36039b),document[_0x452732(0x9a3)](_0x452732(0x9b3))['addEventListener'](_0x452732(0x9cc),()=>{const _0x320143=_0x452732,_0x5743a6=document['getElementById']('ai-response-editor-container'),_0x3ce75c=_0x5c7116(_0x320143(0xc59));_0x5743a6['appendChild'](_0x3ce75c),_0x3ce75c['querySelector']('textarea')[_0x320143(0xdcf)]();}),document[_0x452732(0x9a3)](_0x452732(0x2df))[_0x452732(0x954)](_0x452732(0x9cc),_0x38371b),document['getElementById']('close-my-avatar-library-btn')['addEventListener'](_0x452732(0x9cc),_0x3f23e4),document[_0x452732(0x9a3)]('add-my-avatar-url-btn')[_0x452732(0x954)](_0x452732(0x9cc),_0x267294),document['getElementById']('add-my-avatar-upload-btn')[_0x452732(0x954)]('click',()=>{const _0x11b557=_0x452732;document[_0x11b557(0x9a3)](_0x11b557(0x69f))[_0x11b557(0x9cc)]();}),document[_0x452732(0x9a3)](_0x452732(0x69f))[_0x452732(0x954)](_0x452732(0xbbc),_0x5cbd9d),document[_0x452732(0x9a3)]('add-my-avatar-batch-btn')[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x121b1f=_0x452732,_0x2d3106='请按照以下格式粘贴，一行一个：\x0a\x0a焦虑\x202a9wte.jpeg\x0a大惊失色\x20or8qf4.png\x0a没有灵感\x20njwujh.jpeg',_0x2c6f38=await _0x3ab788(_0x121b1f(0xa89),_0x2d3106,'',_0x121b1f(0x8db));_0x2c6f38&&_0x2c6f38[_0x121b1f(0x13f9)]()&&await _0x3f795e(_0x2c6f38);}),document['getElementById'](_0x452732(0x1242))[_0x452732(0x954)](_0x452732(0x9cc),_0x66e819),document[_0x452732(0x9a3)]('shopping-back-btn')[_0x452732(0x954)](_0x452732(0x9cc),()=>_0x35df44(_0x452732(0x3e5))),document[_0x452732(0x9a3)](_0x452732(0x921))[_0x452732(0x954)](_0x452732(0x9cc),_0x2d319b),document['getElementById'](_0x452732(0xdc6))[_0x452732(0x954)](_0x452732(0x9cc),_0x66e819),document[_0x452732(0x9a3)](_0x452732(0xdd6))['addEventListener']('click',_0x4db19e),document['getElementById'](_0x452732(0x1001))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x1578ef=_0x452732;document[_0x1578ef(0x9a3)](_0x1578ef(0x1354))[_0x1578ef(0x4d8)][_0x1578ef(0x133d)](_0x1578ef(0xc09));}),document[_0x452732(0x9a3)](_0x452732(0x764))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x153b8a=_0x452732;_0x35e770=!_0x35e770;const _0x584396=document[_0x153b8a(0x9a3)]('manage-products-btn'),_0xf6849=document[_0x153b8a(0x9a3)]('shopping-action-bar'),_0x46c95f=document['getElementById'](_0x153b8a(0xc26));_0x584396[_0x153b8a(0x20f)][_0x153b8a(0x119b)]=_0x35e770?'var(--accent-color)':'var(--text-primary)',_0x35e770?(_0xf6849[_0x153b8a(0x20f)][_0x153b8a(0x115d)]=_0x153b8a(0x79c),_0x46c95f['style'][_0x153b8a(0x576)]=_0x153b8a(0x275)):(_0xf6849['style'][_0x153b8a(0x115d)]='none',_0x46c95f[_0x153b8a(0x20f)]['paddingBottom']='',_0x2fc670[_0x153b8a(0xe81)](),document[_0x153b8a(0x131c)](_0x153b8a(0x1511))[_0x153b8a(0x15c1)](_0xcc291c=>_0xcc291c['classList'][_0x153b8a(0x133d)](_0x153b8a(0x154b))),document[_0x153b8a(0x9a3)]('delete-selected-products-btn')[_0x153b8a(0x766)]=_0x153b8a(0x11b8),document['getElementById'](_0x153b8a(0x8c7))['checked']=![]),_0x5cb09b(),_0x379a76();}),document[_0x452732(0x9a3)](_0x452732(0xd85))[_0x452732(0x954)](_0x452732(0x9cc),()=>{_0x35e770?_0x53cd36(null):alert('请先点击扳手图标进入管理模式，才能添加新商品。');}),document[_0x452732(0x9a3)]('product-grid')[_0x452732(0x954)]('click',async _0x169efd=>{const _0x21f924=_0x452732,_0x352d71=_0x169efd[_0x21f924(0xa41)]['closest'](_0x21f924(0xfad));if(!_0x352d71)return;const _0x5b40bf=parseInt(_0x352d71[_0x21f924(0xd8d)]['id']);if(isNaN(_0x5b40bf))return;if(_0x35e770){if(_0x169efd['target'][_0x21f924(0x4d8)]['contains'](_0x21f924(0x409))){_0x53cd36(_0x5b40bf);return;}if(_0x169efd[_0x21f924(0xa41)]['classList']['contains'](_0x21f924(0xd9c))){const _0x23a2cb=await _0x512070['shoppingProducts'][_0x21f924(0x14ee)](_0x5b40bf);if(!_0x23a2cb)return;const _0x108faa=await _0x2c9509(_0x21f924(0x185),_0x21f924(0x1204)+_0x23a2cb[_0x21f924(0x1561)]+'”\x20吗？',{'confirmButtonClass':_0x21f924(0xf5b)});_0x108faa&&(await _0x512070[_0x21f924(0x376)][_0x21f924(0x10a8)](_0x5b40bf),await _0x5cb09b(),alert('商品已删除。'));return;}_0x352d71[_0x21f924(0x4d8)][_0x21f924(0xc02)](_0x21f924(0x154b));_0x2fc670[_0x21f924(0x1472)](_0x5b40bf)?_0x2fc670[_0x21f924(0x10a8)](_0x5b40bf):_0x2fc670[_0x21f924(0xe05)](_0x5b40bf);document[_0x21f924(0x9a3)]('delete-selected-products-btn')[_0x21f924(0x766)]='删除\x20('+_0x2fc670[_0x21f924(0xbdf)]+')';return;}if(_0x169efd[_0x21f924(0xa41)]['classList'][_0x21f924(0x1222)](_0x21f924(0xf85))){const _0x5112a5=await _0x512070['shoppingProducts']['get'](_0x5b40bf);_0x5112a5['variations']&&_0x5112a5[_0x21f924(0x138d)][_0x21f924(0x106b)]>0x0?_0x4c8216(_0x5b40bf):(await _0x48b0c5(_0x5b40bf),await _0x403a62('成功',_0x21f924(0xb34)));return;}_0x352d71[_0x21f924(0x1222)](_0x169efd[_0x21f924(0xa41)])&&console[_0x21f924(0xe4d)](_0x21f924(0x5a0)+_0x5b40bf);}),document['getElementById']('cart-items-list')[_0x452732(0x954)](_0x452732(0x9cc),_0x3d9cd3=>{const _0x44532a=_0x452732,_0x45062f=_0x3d9cd3[_0x44532a(0xa41)];_0x45062f[_0x44532a(0x4d8)][_0x44532a(0x1222)]('decrease-qty-btn')&&_0xa76a3(parseInt(_0x45062f['dataset']['id']),-0x1),_0x45062f['classList'][_0x44532a(0x1222)](_0x44532a(0x1034))&&_0xa76a3(parseInt(_0x45062f['dataset']['id']),0x1),_0x45062f[_0x44532a(0x4d8)]['contains'](_0x44532a(0x2b5))&&_0x33b13b();}),document[_0x452732(0x9a3)](_0x452732(0xb0f))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0xeb28eb=_0x452732;if(_0x5cf781['length']===0x0)return;const _0x225158=await _0x2c9509(_0xeb28eb(0x140a),'确定要清空购物车中的所有商品吗？');_0x225158&&(_0x5cf781=[],_0x4a14f8(),_0x1bcddd());}),document[_0x452732(0x9a3)](_0x452732(0x39f))[_0x452732(0x954)](_0x452732(0xbbc),function(_0x23cef2){const _0x100e6d=_0x452732;document[_0x100e6d(0x131c)]('.cart-item-checkbox')[_0x100e6d(0x15c1)](_0x3d1dab=>{const _0x165a73=_0x100e6d;_0x3d1dab[_0x165a73(0x944)]=_0x23cef2['target'][_0x165a73(0x944)];}),_0x33b13b();}),document[_0x452732(0x9a3)](_0x452732(0x14c4))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x296549=_0x452732;document['getElementById'](_0x296549(0x8ec))['classList'][_0x296549(0x133d)]('visible');}),document[_0x452732(0x9a3)](_0x452732(0xa3b))[_0x452732(0x954)](_0x452732(0x9cc),_0x27944f),document['getElementById'](_0x452732(0x7aa))['addEventListener']('change',_0x4f7a38=>{const _0x526529=_0x452732,_0x2cd097=_0x4f7a38[_0x526529(0xa41)][_0x526529(0x104e)][0x0];if(_0x2cd097){const _0x34a225=new FileReader();_0x34a225[_0x526529(0xdd7)]=_0x6e5dc8=>{const _0x3d8ea4=_0x526529;document[_0x3d8ea4(0x9a3)]('product-image-preview')['src']=_0x6e5dc8[_0x3d8ea4(0xa41)][_0x3d8ea4(0x5c9)];},_0x34a225[_0x526529(0xdd8)](_0x2cd097);}}),document['getElementById'](_0x452732(0x10f8))[_0x452732(0x954)](_0x452732(0x9cc),_0x4cf61c=>{const _0x5f35b2=_0x452732,_0x1f7fb8=_0x4cf61c[_0x5f35b2(0xa41)][_0x5f35b2(0x94c)]('.gift-card');if(_0x1f7fb8){const _0x4d64f8=_0x1f7fb8[_0x5f35b2(0x94c)](_0x5f35b2(0x5c4));_0x4d64f8&&_0x5b607e(parseInt(_0x4d64f8[_0x5f35b2(0xd8d)][_0x5f35b2(0xd73)]));}}),document[_0x452732(0x9a3)](_0x452732(0xacd))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x4953e7=_0x452732;document[_0x4953e7(0x9a3)](_0x4953e7(0xc27))[_0x4953e7(0x4d8)][_0x4953e7(0x133d)](_0x4953e7(0xc09));}),document[_0x452732(0x9a3)](_0x452732(0x868))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x4f5f87=_0x452732,_0x2d4968=Array[_0x4f5f87(0x1311)](document['querySelectorAll'](_0x4f5f87(0x603)))['map'](_0x3f9cd1=>_0x3f9cd1[_0x4f5f87(0xd8d)]['recipientName']);if(_0x2d4968[_0x4f5f87(0x106b)]===0x0){alert('请至少选择一位收礼人。');return;}const _0x4a659e=_0x5cf781[_0x4f5f87(0x1195)](_0x41c426=>document['querySelector'](_0x4f5f87(0x234)+_0x41c426[_0x4f5f87(0x12d8)]+_0x4f5f87(0xf0a)));await _0x2aebb5(_0x4a659e,_0x2d4968),document[_0x4f5f87(0x9a3)]('gift-recipient-modal')[_0x4f5f87(0x4d8)][_0x4f5f87(0x133d)](_0x4f5f87(0xc09));}),document[_0x452732(0x9a3)](_0x452732(0x2c5))['addEventListener'](_0x452732(0x9cc),_0x46ae15=>{const _0x206706=_0x452732,_0x5b512f=_0x46ae15['target'][_0x206706(0x94c)](_0x206706(0x67d));_0x5b512f&&_0x5b512f[_0x206706(0x4d8)]['toggle']('selected');}),document[_0x452732(0x9a3)](_0x452732(0x13f8))[_0x452732(0x954)](_0x452732(0xbbc),function(_0x200cd2){const _0xe4127d=_0x452732,_0x564a10=_0x200cd2[_0xe4127d(0xa41)][_0xe4127d(0x944)];document[_0xe4127d(0x131c)](_0xe4127d(0x9f9))[_0xe4127d(0x15c1)](_0x7d09b2=>{const _0x3df9fe=_0xe4127d;_0x7d09b2['classList'][_0x3df9fe(0xc02)]('selected',_0x564a10);});}),document['getElementById'](_0x452732(0x16a))[_0x452732(0x954)](_0x452732(0x9cc),_0xcafed7),document[_0x452732(0x9a3)](_0x452732(0x1155))[_0x452732(0x954)](_0x452732(0x9cc),_0x10d8cd),document['getElementById'](_0x452732(0x3a8))[_0x452732(0x954)]('click',_0x585ed7),document[_0x452732(0x9a3)](_0x452732(0x10b3))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x2ac9bb=_0x452732,_0x23a1a4=document['getElementById'](_0x2ac9bb(0x49c)),_0x54743b=document[_0x2ac9bb(0x9a3)](_0x2ac9bb(0x357))[_0x2ac9bb(0x7b2)][_0x2ac9bb(0x13f9)]()||_0x283b35;_0x23a1a4['src']=_0x54743b,_0x23a1a4[_0x2ac9bb(0x156e)]()[_0x2ac9bb(0x904)](_0x460dfc=>alert(_0x2ac9bb(0x1194)));}),document[_0x452732(0x9a3)](_0x452732(0x982))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x37fa40=_0x452732;document[_0x37fa40(0x9a3)](_0x37fa40(0x357))[_0x37fa40(0x7b2)]='',alert('已重置为默认提示音，点击“保存所有外观设置”后生效。');}),document[_0x452732(0x9a3)](_0x452732(0x663))[_0x452732(0x954)](_0x452732(0x9cc),_0xb887dd=>{const _0x138574=_0x452732,_0x13d00f=_0xb887dd['target'];_0x13d00f[_0x138574(0x4d8)]['contains'](_0x138574(0x12bd))&&_0x37c8e5(_0x13d00f),_0x13d00f['classList']['contains']('editable-image')&&_0xb1f264(_0x13d00f);}),document['getElementById'](_0x452732(0x10c5))[_0x452732(0x954)]('click',_0x33b445),document['getElementById'](_0x452732(0xcc4))['addEventListener'](_0x452732(0x9cc),()=>{const _0x494fb6=_0x452732;document[_0x494fb6(0x9a3)](_0x494fb6(0x2e5))[_0x494fb6(0x4d8)][_0x494fb6(0x133d)](_0x494fb6(0xc09));}),document[_0x452732(0x9a3)](_0x452732(0x10c5))[_0x452732(0x954)]('click',_0x33b445),document[_0x452732(0x9a3)](_0x452732(0xcc4))[_0x452732(0x954)]('click',()=>{const _0x5e5d8c=_0x452732;document[_0x5e5d8c(0x9a3)](_0x5e5d8c(0x2e5))[_0x5e5d8c(0x4d8)][_0x5e5d8c(0x133d)]('visible');}),document[_0x452732(0x9a3)]('select-all-music-search')['addEventListener'](_0x452732(0xbbc),function(_0x3ed666){const _0x271089=_0x452732;document[_0x271089(0x131c)](_0x271089(0x140c))[_0x271089(0x15c1)](_0x5e080b=>{const _0x2c7d2c=_0x271089;_0x5e080b[_0x2c7d2c(0x944)]=_0x3ed666['target'][_0x2c7d2c(0x944)];});}),document['getElementById'](_0x452732(0x11db))[_0x452732(0x954)](_0x452732(0x9cc),_0x4db7e0=>{const _0x47422e=_0x452732,_0x1ae1ef=_0x4db7e0['target']['closest']('.search-result-item');if(_0x1ae1ef){const _0x2b9a49=_0x1ae1ef[_0x47422e(0xc86)](_0x47422e(0x121d));_0x2b9a49&&(_0x4db7e0[_0x47422e(0xa41)]!==_0x2b9a49&&(_0x2b9a49['checked']=!_0x2b9a49[_0x47422e(0x944)]));}}),document['getElementById']('add-selected-music-btn')[_0x452732(0x954)]('click',async()=>{const _0x22099d=_0x452732,_0x1482b6=document[_0x22099d(0x131c)](_0x22099d(0x127d));if(_0x1482b6[_0x22099d(0x106b)]===0x0){alert(_0x22099d(0x1230));return;}document['getElementById'](_0x22099d(0x2e5))['classList']['remove'](_0x22099d(0xc09)),await _0x403a62(_0x22099d(0x1395),'正在批量添加\x20'+_0x1482b6[_0x22099d(0x106b)]+'\x20首歌曲...');const _0x2298a8=Array['from'](_0x1482b6)[_0x22099d(0xb0a)](_0x17767f=>JSON[_0x22099d(0x1447)](_0x17767f[_0x22099d(0x94c)](_0x22099d(0x13fc))[_0x22099d(0xd8d)][_0x22099d(0x658)]));let _0x465d48=0x0,_0x35583f=[];const _0x3f4573=_0x2298a8[_0x22099d(0xb0a)](_0x2a8324=>_0xc892ac(_0x2a8324)),_0x1568b1=await Promise['all'](_0x3f4573);_0x1568b1[_0x22099d(0x15c1)]((_0x1cd9cd,_0x355f4b)=>{const _0x7d57d5=_0x22099d;_0x1cd9cd?(_0x4e0631[_0x7d57d5(0x496)][_0x7d57d5(0x1c4)](_0x1cd9cd),_0x465d48++):_0x35583f[_0x7d57d5(0x1c4)](_0x2298a8[_0x355f4b]['name']);});_0x465d48>0x0&&(await _0x21cadb(),_0x28db92(),_0x4e0631[_0x22099d(0xfe2)]===-0x1&&(_0x4e0631[_0x22099d(0xfe2)]=_0x4e0631[_0x22099d(0x496)]['length']-_0x465d48,_0x321261()));let _0x291806=_0x22099d(0x6dd)+_0x465d48+_0x22099d(0x1114);_0x35583f[_0x22099d(0x106b)]>0x0&&(_0x291806+='\x0a\x0a'+_0x35583f[_0x22099d(0x106b)]+'\x20首歌曲获取失败:\x0a-\x20'+_0x35583f[_0x22099d(0x3b9)](_0x22099d(0x1002))),await _0x403a62('操作结果',_0x291806);}),document[_0x452732(0x9a3)]('music-visual-container')[_0x452732(0x954)]('click',()=>{const _0x5cf079=_0x452732;document[_0x5cf079(0x9a3)](_0x5cf079(0xd9d))['classList']['toggle']('lyrics-active');}),document[_0x452732(0x9a3)](_0x452732(0x10c5))[_0x452732(0x954)](_0x452732(0x9cc),_0x33b445),document[_0x452732(0x9a3)](_0x452732(0xcc4))[_0x452732(0x954)]('click',()=>{const _0xa2a4ad=_0x452732;document[_0xa2a4ad(0x9a3)]('music-search-results-modal')[_0xa2a4ad(0x4d8)]['remove']('visible');}),document[_0x452732(0x9a3)]('search-results-list')[_0x452732(0x954)](_0x452732(0x9cc),_0x414ffc=>{const _0x4cd4fc=_0x452732,_0x1b4cc0=_0x414ffc[_0x4cd4fc(0xa41)][_0x4cd4fc(0x94c)](_0x4cd4fc(0x13fc));if(_0x1b4cc0&&_0x1b4cc0[_0x4cd4fc(0xd8d)][_0x4cd4fc(0x658)]){const _0x2a7a3f=JSON['parse'](_0x1b4cc0[_0x4cd4fc(0xd8d)][_0x4cd4fc(0x658)]);handleSearchResultClick(_0x2a7a3f);}}),document[_0x452732(0x9a3)](_0x452732(0x157f))[_0x452732(0x954)]('click',_0x9ce26a),document['getElementById'](_0x452732(0x94a))[_0x452732(0x954)](_0x452732(0x9cc),_0x1c5f2e),document['getElementById'](_0x452732(0x1411))[_0x452732(0x954)](_0x452732(0x9cc),_0xe3aaea),document['getElementById'](_0x452732(0x923))[_0x452732(0x954)]('click',_0x50153b),document[_0x452732(0x9a3)](_0x452732(0x47f))['addEventListener'](_0x452732(0xbbc),()=>{const _0x113c6b=_0x452732;_0x19ddb8[_0x113c6b(0x4c8)]['showStatusBar']=document[_0x113c6b(0x9a3)](_0x113c6b(0x47f))[_0x113c6b(0x944)],_0x154868();}),document[_0x452732(0x9a3)](_0x452732(0x3b4))[_0x452732(0x954)](_0x452732(0x9cc),_0x1d8566),document[_0x452732(0x9a3)]('cancel-clear-posts-btn')[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x78abda=_0x452732;document[_0x78abda(0x9a3)](_0x78abda(0x23b))[_0x78abda(0x4d8)]['remove'](_0x78abda(0xc09));}),document['getElementById'](_0x452732(0x4ec))[_0x452732(0x954)](_0x452732(0x9cc),_0x3899c3),document[_0x452732(0x9a3)](_0x452732(0x1295))[_0x452732(0x954)](_0x452732(0x9cc),_0x2136c6=>{const _0x46fb35=_0x452732,_0x15e524=_0x2136c6[_0x46fb35(0xa41)][_0x46fb35(0x94c)](_0x46fb35(0x52f));_0x15e524&&_0x15e524[_0x46fb35(0x4d8)][_0x46fb35(0xc02)]('selected');}),document[_0x452732(0x9a3)]('global-bg-input')['addEventListener'](_0x452732(0xbbc),async _0x654f84=>{const _0x3f4e2c=_0x452732,_0x4f1c84=_0x654f84[_0x3f4e2c(0xa41)]['files'][0x0];if(_0x4f1c84){const _0x36dabb=await new Promise(_0x26ff6a=>{const _0x2db633=_0x3f4e2c,_0x2e6bd9=new FileReader();_0x2e6bd9[_0x2db633(0xdd7)]=()=>_0x26ff6a(_0x2e6bd9[_0x2db633(0x5c9)]),_0x2e6bd9['readAsDataURL'](_0x4f1c84);});_0x19ddb8['globalSettings'][_0x3f4e2c(0x10c6)]=_0x36dabb,_0x21e3fb();}_0x654f84[_0x3f4e2c(0xa41)][_0x3f4e2c(0x7b2)]=null;}),document['getElementById'](_0x452732(0xa83))[_0x452732(0x954)]('click',()=>{const _0x2ac53f=_0x452732;_0x19ddb8[_0x2ac53f(0x4c8)][_0x2ac53f(0x10c6)]='',_0x21e3fb();}),document[_0x452732(0x9a3)](_0x452732(0x101e))[_0x452732(0x954)]('click',async()=>{const _0x35177c=_0x452732;_0x4acb77&&(_0x19ddb8[_0x35177c(0x4c8)][_0x35177c(0xa32)]=_0x4acb77),_0x19ddb8[_0x35177c(0x4c8)]['globalCss']=document[_0x35177c(0x9a3)](_0x35177c(0x543))[_0x35177c(0x7b2)][_0x35177c(0x13f9)](),_0x19ddb8[_0x35177c(0x4c8)][_0x35177c(0x1437)]=document[_0x35177c(0x9a3)]('notification-sound-url-input')[_0x35177c(0x7b2)][_0x35177c(0x13f9)](),_0x19ddb8[_0x35177c(0x4c8)][_0x35177c(0x63b)]=document[_0x35177c(0x9a3)](_0x35177c(0x47f))[_0x35177c(0x944)],await _0x512070[_0x35177c(0x4c8)][_0x35177c(0xd4d)](_0x19ddb8[_0x35177c(0x4c8)]),_0x28dc10(),_0x4acb77=null,_0xe2a513(),_0x15e853(_0x19ddb8[_0x35177c(0x4c8)]['globalCss']),_0x154868(),alert(_0x35177c(0x18c)),_0x35df44('home-screen');}),document[_0x452732(0x9a3)](_0x452732(0x1307))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x368838=_0x452732,_0x3d370d=await _0x3ab788(_0x368838(0x934),'请输入背景图片的URL','','url');if(_0x3d370d&&_0x3d370d[_0x368838(0x13f9)]())_0x19ddb8[_0x368838(0x4c8)][_0x368838(0x10c6)]=_0x3d370d[_0x368838(0x13f9)](),_0x21e3fb();else _0x3d370d!==null&&alert(_0x368838(0xf90));}),document[_0x452732(0x9a3)](_0x452732(0xe67))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0xc6f3f0=_0x452732,_0x40199a=await _0x3ab788(_0xc6f3f0(0x1538),_0xc6f3f0(0x3e8),'',_0xc6f3f0(0x121f));if(_0x40199a&&_0x40199a['trim']())_0x4acb77=_0x40199a[_0xc6f3f0(0x13f9)](),_0x21e3fb();else _0x40199a!==null&&alert(_0xc6f3f0(0xf90));}),document[_0x452732(0x9a3)](_0x452732(0xdc2))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x38547b=_0x452732,_0xbb914d=await _0x3ab788('网络图片\x20(CPhone)',_0x38547b(0x64d),'',_0x38547b(0x121f));if(_0xbb914d&&_0xbb914d[_0x38547b(0x13f9)]())_0x19ddb8[_0x38547b(0x4c8)][_0x38547b(0x831)]=_0xbb914d['trim'](),_0x21e3fb();else _0xbb914d!==null&&alert(_0x38547b(0xf90));}),document[_0x452732(0x9a3)](_0x452732(0x113d))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x273a0c=_0x452732;_0x4acb77=null,_0x19ddb8[_0x273a0c(0x4c8)][_0x273a0c(0xa32)]='',_0x21e3fb();}),document[_0x452732(0x9a3)](_0x452732(0x124b))['addEventListener'](_0x452732(0x9cc),()=>{const _0x2bcec2=_0x452732;_0x19ddb8[_0x2bcec2(0x4c8)][_0x2bcec2(0x831)]='',_0x21e3fb();}),document[_0x452732(0x9a3)](_0x452732(0x709))[_0x452732(0x954)]('change',_0xd45ac),document[_0x452732(0x9a3)]('save-css-preset-btn')['addEventListener']('click',_0x36d39f),document[_0x452732(0x9a3)]('delete-css-preset-btn')['addEventListener'](_0x452732(0x9cc),_0x100c74),document[_0x452732(0x9a3)](_0x452732(0x180))[_0x452732(0x954)](_0x452732(0xbbc),_0x4b0805),document[_0x452732(0x9a3)](_0x452732(0x2f2))[_0x452732(0x954)](_0x452732(0x9cc),_0x242dc8),document[_0x452732(0x9a3)](_0x452732(0x9a2))[_0x452732(0x954)]('click',_0x50c2ce),document[_0x452732(0x9a3)](_0x452732(0x9a1))[_0x452732(0x954)](_0x452732(0xbbc),_0x274524),document[_0x452732(0x9a3)](_0x452732(0x98d))[_0x452732(0x954)]('click',_0x4b66f0),document[_0x452732(0x9a3)](_0x452732(0x127b))[_0x452732(0x954)]('click',_0x365833),document[_0x452732(0x9a3)](_0x452732(0x14cc))['addEventListener'](_0x452732(0x9cc),_0x1f9e4f),document['getElementById']('close-sticker-category-manager-btn')[_0x452732(0x954)]('click',()=>{const _0x45d72f=_0x452732;document['getElementById'](_0x45d72f(0xa3f))[_0x45d72f(0x4d8)][_0x45d72f(0x133d)]('visible'),_0x5a49be();}),document['getElementById']('add-new-sticker-category-btn')[_0x452732(0x954)](_0x452732(0x9cc),_0xa567f3),document[_0x452732(0x9a3)]('existing-sticker-categories-list')[_0x452732(0x954)](_0x452732(0x9cc),_0x4b93cd=>{const _0x3a0b2e=_0x452732;if(_0x4b93cd[_0x3a0b2e(0xa41)]['classList'][_0x3a0b2e(0x1222)](_0x3a0b2e(0x6de))){const _0x3ba233=parseInt(_0x4b93cd[_0x3a0b2e(0xa41)][_0x3a0b2e(0xd8d)]['id']);_0x10ee93(_0x3ba233);}}),document['getElementById'](_0x452732(0x150b))['addEventListener'](_0x452732(0x9cc),_0x3e432b=>{const _0x1ee5eb=_0x452732;if(_0x3e432b[_0x1ee5eb(0xa41)]['classList'][_0x1ee5eb(0x1222)](_0x1ee5eb(0xdf0))){const _0x5e9e89=_0x3e432b[_0x1ee5eb(0xa41)][_0x1ee5eb(0xd8d)]['categoryId'],_0x5ba161=_0x5e9e89!=='all'&&_0x5e9e89!==_0x1ee5eb(0x80f)?parseInt(_0x5e9e89):_0x5e9e89;_0x50f83f(_0x5ba161);}}),document['getElementById']('select-all-stickers-checkbox')[_0x452732(0x954)](_0x452732(0xbbc),_0x240175),document['getElementById'](_0x452732(0x3f5))['addEventListener'](_0x452732(0x9cc),_0x5307b3),document[_0x452732(0x9a3)]('import-single-chat-btn')[_0x452732(0x954)]('click',()=>{const _0x1912b0=_0x452732;document[_0x1912b0(0x9a3)](_0x1912b0(0xe8d))[_0x1912b0(0x9cc)]();}),document[_0x452732(0x9a3)](_0x452732(0xe8d))[_0x452732(0x954)](_0x452732(0xbbc),_0x4679d6=>{const _0x26b835=_0x452732,_0x116df7=_0x4679d6[_0x26b835(0xa41)][_0x26b835(0x104e)][0x0];_0x116df7&&_0x488435(_0x116df7),_0x4679d6[_0x26b835(0xa41)][_0x26b835(0x7b2)]=null;}),document[_0x452732(0x9a3)](_0x452732(0x268))[_0x452732(0x954)]('click',()=>_0x445d74()),document[_0x452732(0x9a3)](_0x452732(0x22d))[_0x452732(0x954)](_0x452732(0x9cc),()=>openDiaryEditor()),document['getElementById'](_0x452732(0x1501))[_0x452732(0x954)]('click',_0x4e137d),document[_0x452732(0x9a3)](_0x452732(0xa6a))[_0x452732(0x954)](_0x452732(0x9cc),_0x377220),document['getElementById']('favorite-memo-btn')[_0x452732(0x954)]('click',_0x209c0e),document[_0x452732(0x9a3)](_0x452732(0xefb))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x340bbd=_0x452732,_0x686d6b=document[_0x340bbd(0x9a3)]('char-diary-detail-content')[_0x340bbd(0x1a9)];_0x224577(_0x686d6b,'日记内容已复制！');}),document[_0x452732(0x9a3)]('copy-memo-content-btn')[_0x452732(0x954)]('click',()=>{const _0x148592=_0x452732,_0x338281=document[_0x148592(0x9a3)]('char-memo-detail-content')[_0x148592(0x7b2)];_0x224577(_0x338281,_0x148592(0x524));}),document[_0x452732(0x9a3)](_0x452732(0xf6f))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x2bfee7=_0x452732,_0x5c1c0e=document[_0x2bfee7(0x9a3)](_0x2bfee7(0x1530))[_0x2bfee7(0x1a9)];_0x224577(_0x5c1c0e,'文章内容已复制！');}),document[_0x452732(0x9a3)](_0x452732(0xa4f))['addEventListener'](_0x452732(0x9cc),async()=>{const _0x1d3027=_0x452732;_0x403a62(_0x1d3027(0x13cb),_0x1d3027(0x110e));try{await Promise[_0x1d3027(0xbf1)]([_0xf1ffd7(),_0x5d63a5()]),console[_0x1d3027(0xe4d)](_0x1d3027(0xfeb));}catch(_0x4ff4aa){console[_0x1d3027(0x3b7)](_0x1d3027(0xa84),_0x4ff4aa),await _0x403a62(_0x1d3027(0x13bd),'在执行组合操作时遇到错误:\x20'+_0x4ff4aa[_0x1d3027(0xcce)]);}}),document['getElementById'](_0x452732(0x314))[_0x452732(0x954)](_0x452732(0x9cc),_0xefda0f=>{const _0x5e27be=_0x452732,_0x447d5d=_0xefda0f[_0x5e27be(0xa41)]['closest'](_0x5e27be(0x10ee));if(_0x447d5d&&_0x447d5d[_0x5e27be(0xd8d)][_0x5e27be(0x12a9)]){const _0x622f2a=parseInt(_0x447d5d[_0x5e27be(0xd8d)][_0x5e27be(0x12a9)]);!isNaN(_0x622f2a)&&_0x387f73(_0x622f2a);}}),document[_0x452732(0x9a3)]('back-to-char-qq-list-btn')['addEventListener'](_0x452732(0x9cc),()=>{const _0x47f21a=_0x452732;_0x56e352(_0x47f21a(0x72b));});const _0x4d7fe1=document[_0x452732(0x9a3)]('char-conversation-messages'),_0x5ae0e0=()=>{const _0x68a0ee=_0x452732;if(_0x23e74f!=='private_user')return;if(_0x4d7fe1[_0x68a0ee(0x85c)]<0x1&&!_0x113908){const _0x58dad1=_0x19ddb8[_0x68a0ee(0xb04)][_0x5a727a]?.['history'][_0x68a0ee(0x106b)]||0x0;_0x58dad1>_0x5c4e1b&&_0x10cff2();}};_0x4d7fe1['addEventListener']('scroll',_0x5ae0e0),document['getElementById']('char-simulated-send-btn')['addEventListener'](_0x452732(0x9cc),()=>{alert('这是模拟对话，无法发送消息哦~');}),document[_0x452732(0x9a3)](_0x452732(0x1048))[_0x452732(0x954)](_0x452732(0x9cc),_0x123a55),document[_0x452732(0x9a3)]('char-album-grid')[_0x452732(0x954)]('click',_0x4d6b72=>{const _0x56d5f2=_0x452732,_0x50e656=_0x4d6b72[_0x56d5f2(0xa41)][_0x56d5f2(0x94c)](_0x56d5f2(0x947));if(_0x50e656&&_0x50e656[_0x56d5f2(0xd8d)][_0x56d5f2(0x3ef)]){const _0x1004e8=_0x50e656[_0x56d5f2(0xd8d)][_0x56d5f2(0x3ef)];_0x403a62(_0x56d5f2(0x449),_0x1004e8[_0x56d5f2(0x1bb)](/\n/g,'<br>'));}}),document[_0x452732(0x9a3)]('regenerate-char-browser-btn')['addEventListener'](_0x452732(0x9cc),_0x5683ee),document[_0x452732(0x9a3)]('regenerate-char-taobao-btn')[_0x452732(0x954)](_0x452732(0x9cc),_0x23bb80),document[_0x452732(0x9a3)](_0x452732(0x778))[_0x452732(0x954)](_0x452732(0x9cc),_0x19f9d1=>{const _0x553ac8=_0x452732,_0x5a299b=_0x19f9d1[_0x553ac8(0xa41)][_0x553ac8(0x94c)]('.char-product-item');if(_0x5a299b&&_0x5a299b[_0x553ac8(0xd8d)][_0x553ac8(0xfcf)]){const _0x32e6d8=_0x5a299b[_0x553ac8(0xd8d)][_0x553ac8(0xfcf)];_0x403a62(_0x553ac8(0x93b),_0x32e6d8['replace'](/\n/g,_0x553ac8(0x609)));}}),window[_0x452732(0xd90)]=_0x200c78,document[_0x452732(0x9a3)]('regenerate-char-memo-btn')['addEventListener'](_0x452732(0x9cc),_0x24daba),document[_0x452732(0x9a3)](_0x452732(0xed6))[_0x452732(0x954)]('click',()=>_0x56e352(_0x452732(0xd94))),document[_0x452732(0x9a3)]('regenerate-char-diary-btn')[_0x452732(0x954)](_0x452732(0x9cc),_0x352de9),document[_0x452732(0x9a3)]('add-char-diary-btn')[_0x452732(0x954)]('click',_0xa0170e),document[_0x452732(0x9a3)](_0x452732(0x1518))[_0x452732(0x954)](_0x452732(0x9cc),()=>_0x56e352(_0x452732(0xf31))),document['getElementById'](_0x452732(0x6a7))[_0x452732(0x954)]('click',_0x2424f1),document['getElementById'](_0x452732(0xc81))[_0x452732(0x954)](_0x452732(0x9cc),_0x3a3d50),document[_0x452732(0x9a3)](_0x452732(0x902))[_0x452732(0x954)]('click',_0x20fc3a),document[_0x452732(0x9a3)](_0x452732(0x11fe))['addEventListener'](_0x452732(0x9cc),_0x46776a),document[_0x452732(0x9a3)]('regenerate-douban-btn')['addEventListener'](_0x452732(0x9cc),_0xbcea2d),document[_0x452732(0x9a3)](_0x452732(0x12c2))['addEventListener'](_0x452732(0x9cc),_0xbcea2d),document[_0x452732(0x9a3)](_0x452732(0xaee))[_0x452732(0x954)](_0x452732(0x9cc),()=>_0x35df44(_0x452732(0xfd4))),document[_0x452732(0x9a3)](_0x452732(0xe77))[_0x452732(0x954)](_0x452732(0x9cc),_0x23c577),document[_0x452732(0x9a3)](_0x452732(0xe98))[_0x452732(0x954)](_0x452732(0x9cc),_0x1aca17),document['getElementById'](_0x452732(0x803))[_0x452732(0x954)]('change',async _0xf9098a=>{const _0x2bcf57=_0x452732,_0x3d3933=_0xf9098a['target'][_0x2bcf57(0x104e)][0x0];if(_0x3d3933){const _0x50c6ec=await new Promise(_0x48f0da=>{const _0x4ed77e=_0x2bcf57,_0x31ad13=new FileReader();_0x31ad13[_0x4ed77e(0xdd7)]=()=>_0x48f0da(_0x31ad13[_0x4ed77e(0x5c9)]),_0x31ad13[_0x4ed77e(0xdd8)](_0x3d3933);});_0x19ddb8[_0x2bcf57(0x4c8)][_0x2bcf57(0x831)]=_0x50c6ec,_0x21e3fb();}}),document[_0x452732(0x9a3)](_0x452732(0x563))['addEventListener'](_0x452732(0x9cc),_0x3bc9e0=>{const _0x10a2a7=_0x452732;if(_0x3bc9e0[_0x10a2a7(0xa41)]['classList'][_0x10a2a7(0x1222)](_0x10a2a7(0x8e5))){const _0x4e8728=_0x3bc9e0[_0x10a2a7(0xa41)][_0x10a2a7(0x94c)](_0x10a2a7(0x2b0)),_0xdfcc09=_0x4e8728[_0x10a2a7(0xd8d)]['iconId'];_0xdfcc09&&_0x580571(_0xdfcc09,_0x10a2a7(0x875),_0x4e8728);}}),document['getElementById']('import-appearance-btn')['addEventListener'](_0x452732(0x9cc),()=>{const _0x488323=_0x452732;document['getElementById'](_0x488323(0xabd))[_0x488323(0x9cc)]();}),document[_0x452732(0x9a3)](_0x452732(0xabd))[_0x452732(0x954)](_0x452732(0xbbc),_0x29899a=>{const _0x28ac12=_0x452732,_0x344d62=_0x29899a[_0x28ac12(0xa41)][_0x28ac12(0x104e)][0x0];_0x344d62&&_0x1109cd(_0x344d62),_0x29899a[_0x28ac12(0xa41)]['value']=null;}),document['addEventListener']('visibilitychange',()=>{const _0x45c8f5=_0x452732;document[_0x45c8f5(0xf4c)]===_0x45c8f5(0x1236)&&(localStorage[_0x45c8f5(0x28a)](_0x45c8f5(0x471),Date[_0x45c8f5(0x64b)]()),console['log']('应用已切换到后台，记录当前时间。'));}),document['getElementById'](_0x452732(0x561))['addEventListener'](_0x452732(0x9cc),_0x3aedca),document[_0x452732(0x9a3)](_0x452732(0xcc9))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x230937=_0x452732;document[_0x230937(0x9a3)]('import-world-book-input')[_0x230937(0x9cc)]();}),document[_0x452732(0x9a3)](_0x452732(0xfce))[_0x452732(0x954)]('change',_0x77f012=>{const _0x44142a=_0x452732,_0x178256=_0x77f012[_0x44142a(0xa41)]['files'][0x0];_0x178256&&_0xff9c69(_0x178256),_0x77f012[_0x44142a(0xa41)]['value']=null;}),document['getElementById'](_0x452732(0x1133))['addEventListener'](_0x452732(0xbbc),async _0x4d2131=>{const _0x2131b1=_0x452732,_0x27c788=_0x4d2131[_0x2131b1(0xa41)][_0x2131b1(0x944)];_0x19ddb8[_0x2131b1(0x4c8)][_0x2131b1(0x853)]=_0x27c788,await _0x512070[_0x2131b1(0x4c8)]['put'](_0x19ddb8[_0x2131b1(0x4c8)]);const _0x40b40b=document['querySelector'](_0x2131b1(0x12b6));if(_0x40b40b)switch(_0x40b40b['id']){case _0x2131b1(0x3e5):_0x56abd7(_0x19ddb8['activeChatId']);break;case _0x2131b1(0xd7c):if(document[_0x2131b1(0x9a3)](_0x2131b1(0x659))['classList'][_0x2131b1(0x1222)](_0x2131b1(0xe9f)))_0x49acff();if(document[_0x2131b1(0x9a3)]('favorites-view')[_0x2131b1(0x4d8)][_0x2131b1(0x1222)]('active'))_0x332542();break;case _0x2131b1(0xfd4):_0x14f0bc();break;case _0x2131b1(0xb00):_0xaf68cc(_0x4fd882);break;case _0x2131b1(0x698):const _0x37740c=document[_0x2131b1(0xc86)]('.char-screen.active');if(_0x37740c)switch(_0x37740c['id']){case _0x2131b1(0x12a1):_0x21824d();break;case _0x2131b1(0x1022):_0x59e056();break;case _0x2131b1(0x1563):const _0x245889=_0x19ddb8['chats'][_0x5a727a],_0x5a3adf=_0x245889['simulatedBrowserHistory']||[],_0x272b09=_0x5a3adf[_0x2131b1(0x106b)]>0x0?_0x5a3adf[_0x2131b1(0x106b)]-0x1:0x0;_0x367db0(_0x5a3adf[_0x272b09]);break;case _0x2131b1(0x1a6):_0x1a62f4();break;case'char-qq-screen':_0x277f5a();break;case _0x2131b1(0x159f):const _0x53e5f3=document['querySelector']('#char-chat-list\x20.chat-list-item')?.[_0x2131b1(0xd8d)][_0x2131b1(0x12a9)]||0x0;_0x387f73(parseInt(_0x53e5f3));break;}break;}_0x403a62('设置已应用','AI生图功能已'+(_0x27c788?'开启':'关闭')+'。');}),document[_0x452732(0x9a3)](_0x452732(0xead))[_0x452732(0x954)](_0x452732(0x9cc),_0x32d043),document[_0x452732(0x9a3)](_0x452732(0xec2))['addEventListener'](_0x452732(0x9cc),()=>{_0x35df44('chat-settings-screen');}),document['getElementById'](_0x452732(0x6b4))[_0x452732(0x954)](_0x452732(0x9cc),_0x3092e4),document[_0x452732(0x9a3)]('clear-search-btn')[_0x452732(0x954)]('click',_0x2e4ae5),document[_0x452732(0x9a3)](_0x452732(0x1ce))[_0x452732(0x954)]('click',_0x16950b),document['getElementById'](_0x452732(0xbd0))['addEventListener'](_0x452732(0x9cc),_0x3e84c4),document[_0x452732(0xc86)](_0x452732(0x1343))[_0x452732(0x954)]('click',_0x4c1722=>{const _0x3c1b69=_0x452732;if(_0x4c1722['target'][_0x3c1b69(0x4d8)]['contains']('delete-btn')){const _0x31d49c=parseInt(_0x4c1722[_0x3c1b69(0xa41)][_0x3c1b69(0xd8d)]['id']);!isNaN(_0x31d49c)&&_0x368528(_0x31d49c);}}),_0x4159be(),window['openPresetScreen']=_0x5f0b4d,document[_0x452732(0x9a3)](_0x452732(0x1581))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{const _0x12247f=_0x452732,_0xb64ad6=await _0x3ab788(_0x12247f(0x12c4),_0x12247f(0xfe9));if(_0xb64ad6&&_0xb64ad6[_0x12247f(0x13f9)]()){const _0x273d76={'id':'preset_'+Date[_0x12247f(0x64b)](),'name':_0xb64ad6['trim'](),'content':[]};await _0x512070[_0x12247f(0xded)][_0x12247f(0xe05)](_0x273d76),await _0x1db7a9(),_0x53de14(_0x273d76['id']);}}),document['getElementById'](_0x452732(0x14d2))[_0x452732(0x954)](_0x452732(0x9cc),_0x4a8af2),document[_0x452732(0x9a3)](_0x452732(0x12d7))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0xf56e62=_0x452732,_0x58d35e=document[_0xf56e62(0x9a3)](_0xf56e62(0x4c7));_0x58d35e['querySelector']('p')&&(_0x58d35e['innerHTML']='');const _0x2fe2a8=_0x3bea8e();_0x58d35e[_0xf56e62(0x983)](_0x2fe2a8),_0x2fe2a8['querySelector'](_0xf56e62(0x1383))[_0xf56e62(0xdcf)]();}),document[_0x452732(0x9a3)](_0x452732(0x19c))[_0x452732(0x954)]('click',async()=>{const _0x52e393=_0x452732;if(!_0x52c9c6)return;const _0x57e552=await _0x512070[_0x52e393(0xded)][_0x52e393(0x14ee)](_0x52c9c6);if(!_0x57e552)return;const _0x18f9ac=document[_0x52e393(0x9a3)](_0x52e393(0x117a))[_0x52e393(0x7b2)][_0x52e393(0x13f9)]();if(!_0x18f9ac){alert(_0x52e393(0x1341));return;}_0x57e552['name']=_0x18f9ac,_0x57e552['categoryId']=parseInt(document[_0x52e393(0x9a3)]('preset-category-select')[_0x52e393(0x7b2)])||null;const _0x5cb8a9=document[_0x52e393(0x9a3)](_0x52e393(0x4c7)),_0x17ece9=_0x5cb8a9[_0x52e393(0x131c)](_0x52e393(0x556)),_0x111377=[];_0x17ece9[_0x52e393(0x15c1)](_0x2e74f6=>{const _0x71da11=_0x52e393,_0x45632f=_0x2e74f6[_0x71da11(0xc86)](_0x71da11(0x1383))['value'][_0x71da11(0x13f9)]();_0x45632f&&_0x111377[_0x71da11(0x1c4)]({'comment':_0x2e74f6['querySelector'](_0x71da11(0x13c4))[_0x71da11(0x7b2)][_0x71da11(0x13f9)](),'keys':(_0x2e74f6[_0x71da11(0xc86)](_0x71da11(0xdd0))[_0x71da11(0x7b2)][_0x71da11(0x13f9)]()||'')[_0x71da11(0x1536)](',')[_0x71da11(0xb0a)](_0x3439fd=>_0x3439fd['trim']())[_0x71da11(0x1195)](Boolean),'content':_0x45632f,'enabled':_0x2e74f6[_0x71da11(0xc86)](_0x71da11(0x304))[_0x71da11(0x944)]});}),_0x57e552[_0x52e393(0x4e3)]=_0x111377,await _0x512070[_0x52e393(0xded)][_0x52e393(0xd4d)](_0x57e552),_0x52c9c6=null,_0x35df44(_0x52e393(0x3f9)),await _0x1db7a9();}),document[_0x452732(0x9a3)](_0x452732(0xa64))[_0x452732(0x954)]('click',async()=>{const _0x149e02=_0x452732;try{await _0x274014(),document[_0x149e02(0x9a3)](_0x149e02(0xd03))[_0x149e02(0x9cc)]();}catch(_0x4635f7){console[_0x149e02(0x651)](_0x149e02(0x1095),_0x4635f7['message']);}}),document[_0x452732(0x9a3)](_0x452732(0xd03))[_0x452732(0x954)](_0x452732(0xbbc),_0x5daa1a),document[_0x452732(0x9a3)](_0x452732(0x1ec))[_0x452732(0x954)](_0x452732(0x9cc),_0x2d7620),document[_0x452732(0x9a3)](_0x452732(0x121b))[_0x452732(0x954)](_0x452732(0x9cc),_0x3d4a36),document[_0x452732(0x9a3)](_0x452732(0xeb3))[_0x452732(0x954)]('click',()=>{const _0xbd409c=_0x452732;document[_0xbd409c(0x9a3)](_0xbd409c(0x6b5))[_0xbd409c(0x4d8)]['remove'](_0xbd409c(0xc09));}),document[_0x452732(0x9a3)]('go-to-clear-step2-btn')['addEventListener'](_0x452732(0x9cc),_0x301a1e),document['getElementById'](_0x452732(0x100f))[_0x452732(0x954)](_0x452732(0x9cc),_0x2617eb),document['getElementById'](_0x452732(0x1516))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x2b4898=_0x452732;document[_0x2b4898(0x9a3)](_0x2b4898(0x6b5))[_0x2b4898(0x4d8)][_0x2b4898(0x133d)](_0x2b4898(0xc09));}),document[_0x452732(0x9a3)](_0x452732(0x34a))[_0x452732(0x954)]('click',_0xa868e4),document[_0x452732(0x9a3)](_0x452732(0x6b5))[_0x452732(0x954)](_0x452732(0x9cc),_0x4f1489=>{const _0x19d5e2=_0x452732,_0x458dc7=_0x4f1489['target'][_0x19d5e2(0x94c)](_0x19d5e2(0x52f));_0x458dc7&&(_0x4f1489[_0x19d5e2(0x63a)](),_0x458dc7[_0x19d5e2(0x4d8)][_0x19d5e2(0xc02)](_0x19d5e2(0x154b)));}),document[_0x452732(0x9a3)](_0x452732(0x6b5))['addEventListener'](_0x452732(0xbbc),_0x59f1e6=>{const _0x16dcea=_0x452732;if(_0x59f1e6[_0x16dcea(0xa41)]['id']===_0x16dcea(0x11b0)){const _0x369c1b=_0x59f1e6[_0x16dcea(0xa41)]['checked'];document[_0x16dcea(0x131c)](_0x16dcea(0x6bb))[_0x16dcea(0x15c1)](_0x2d34a4=>{const _0x161ee5=_0x16dcea;_0x2d34a4['classList'][_0x161ee5(0xc02)]('selected',_0x369c1b);});}else{if(_0x59f1e6[_0x16dcea(0xa41)]['id']===_0x16dcea(0x14a4)){const _0x3851d0=_0x59f1e6[_0x16dcea(0xa41)][_0x16dcea(0x944)];document[_0x16dcea(0x131c)]('#data-clear-type-list\x20.clear-posts-item')[_0x16dcea(0x15c1)](_0xc6535b=>{const _0x5b9209=_0x16dcea;_0xc6535b[_0x5b9209(0x4d8)][_0x5b9209(0xc02)](_0x5b9209(0x154b),_0x3851d0);});}}}),document[_0x452732(0x9a3)]('compress-images-btn')[_0x452732(0x954)]('click',_0x335e56),document[_0x452732(0x9a3)](_0x452732(0xeac))[_0x452732(0x954)](_0x452732(0x9cc),_0x364707),document[_0x452732(0x9a3)](_0x452732(0xe1b))['addEventListener']('click',_0x45a138),document[_0x452732(0x9a3)]('npc-list-back-btn')[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x19e758=_0x452732;_0x499463(_0x19e758(0xdd5));}),document[_0x452732(0x9a3)](_0x452732(0xff1))[_0x452732(0x954)](_0x452732(0x9cc),()=>_0x21c6bf(null)),document[_0x452732(0x9a3)](_0x452732(0x326))[_0x452732(0x954)](_0x452732(0x9cc),_0x26193e),document['getElementById'](_0x452732(0x565))[_0x452732(0x954)](_0x452732(0x9cc),_0x43f0c3=>{const _0x406d97=_0x452732;_0x43f0c3[_0x406d97(0xa41)]['id']===_0x406d97(0xb88)&&_0x4d5df7();}),document[_0x452732(0x9a3)](_0x452732(0xe04))[_0x452732(0x954)]('click',()=>{const _0x3b326e=_0x452732;document['getElementById'](_0x3b326e(0x7f7))[_0x3b326e(0x4d8)][_0x3b326e(0x133d)](_0x3b326e(0xc09)),document['getElementById'](_0x3b326e(0x565))['classList'][_0x3b326e(0x1222)](_0x3b326e(0xc09))&&_0x21c6bf(editingNpcId);}),document[_0x452732(0x9a3)](_0x452732(0x990))[_0x452732(0x954)](_0x452732(0x9cc),_0xbff085),document[_0x452732(0x9a3)]('existing-npc-groups-list')[_0x452732(0x954)](_0x452732(0x9cc),_0x999df6=>{const _0x314997=_0x452732;_0x999df6[_0x314997(0xa41)]['classList']['contains'](_0x314997(0x6de))&&_0x54e092(parseInt(_0x999df6[_0x314997(0xa41)]['dataset']['id']));}),document[_0x452732(0x9a3)](_0x452732(0x356))[_0x452732(0x954)]('click',()=>{const _0x15837b=_0x452732;document['getElementById']('npc-editor-modal')[_0x15837b(0x4d8)]['remove'](_0x15837b(0xc09));}),document[_0x452732(0x9a3)]('npc-avatar-input')[_0x452732(0x954)](_0x452732(0xbbc),_0x4a34e9=>{const _0x23e936=_0x452732,_0x58f5e7=_0x4a34e9[_0x23e936(0xa41)][_0x23e936(0x104e)][0x0];if(_0x58f5e7){const _0xa67eb8=new FileReader();_0xa67eb8[_0x23e936(0xdd7)]=_0x469fed=>{const _0x20cfce=_0x23e936;document[_0x20cfce(0x9a3)](_0x20cfce(0x6ea))['src']=_0x469fed[_0x20cfce(0xa41)][_0x20cfce(0x5c9)];},_0xa67eb8[_0x23e936(0xdd8)](_0x58f5e7);}}),document['getElementById']('chat-lock-overlay')[_0x452732(0x954)]('click',_0xfad42=>{const _0x3f65b5=_0x452732;if(_0xfad42[_0x3f65b5(0xa41)]['id']===_0x3f65b5(0x78f))_0x3023a5();else _0xfad42['target']['id']===_0x3f65b5(0x1258)&&_0x233b69();}),_0x1a651b(document[_0x452732(0x9a3)](_0x452732(0xd9d)),()=>{const _0x10c883=_0x452732;_0x4e0631['currentIndex']>-0x1&&_0x37bae6(_0x4e0631[_0x10c883(0xfe2)]);}),document[_0x452732(0x9a3)](_0x452732(0x13bb))[_0x452732(0x954)](_0x452732(0x9cc),_0x5f4b28),document['getElementById'](_0x452732(0xcdf))[_0x452732(0x954)](_0x452732(0x9cc),_0x2236fb),document[_0x452732(0x9a3)](_0x452732(0x46c))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x3c97dd=_0x452732;document[_0x3c97dd(0x9a3)](_0x3c97dd(0x1117))[_0x3c97dd(0x4d8)]['remove']('visible');}),document[_0x452732(0x9a3)](_0x452732(0xeff))[_0x452732(0x954)](_0x452732(0x1b4),_0x40ae97=>{const _0x1885ec=_0x452732,_0x3f2d89=_0x40ae97['target'][_0x1885ec(0x7b2)]['toLowerCase'](),_0x301870=document[_0x1885ec(0x9a3)](_0x1885ec(0xef3));for(const _0x345dc2 of _0x301870['options']){const _0x221330=_0x345dc2['textContent'][_0x1885ec(0x905)]();_0x221330[_0x1885ec(0x478)](_0x3f2d89)?_0x345dc2['style'][_0x1885ec(0x115d)]='':_0x345dc2[_0x1885ec(0x20f)][_0x1885ec(0x115d)]=_0x1885ec(0x8e0);}}),window[_0x452732(0xa34)]=_0x31a220,document[_0x452732(0x9a3)](_0x452732(0xc43))[_0x452732(0x954)]('click',()=>_0x31a220('group')),document[_0x452732(0x9a3)](_0x452732(0xfd6))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0xe8fb7=_0x452732;document[_0xe8fb7(0x9a3)](_0xe8fb7(0xe50))[_0xe8fb7(0x4d8)]['remove'](_0xe8fb7(0xc09));}),document[_0x452732(0x9a3)]('start-werewolf-game-btn')[_0x452732(0x954)](_0x452732(0x9cc),_0x289461),document[_0x452732(0x9a3)](_0x452732(0x636))['addEventListener'](_0x452732(0x9cc),()=>{const _0x68783a=_0x452732;document[_0x68783a(0x9a3)](_0x68783a(0x1477))[_0x68783a(0x4d8)]['remove'](_0x68783a(0xc09)),_0x5e8d06();}),document[_0x452732(0x9a3)](_0x452732(0x11f0))[_0x452732(0x954)]('click',async()=>{const _0x449679=_0x452732,_0x536739=await _0x2c9509('退出游戏',_0x449679(0x1019),{'confirmButtonClass':_0x449679(0xf5b)});_0x536739&&(_0x480617['isActive']=![],_0x35df44(_0x480617[_0x449679(0x907)]?_0x449679(0x3e5):_0x449679(0x663)));}),document[_0x452732(0x9a3)](_0x452732(0xc33))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x10b020=_0x452732;document[_0x10b020(0x9a3)](_0x10b020(0xd91))[_0x10b020(0x4d8)][_0x10b020(0x133d)]('visible'),_0x35df44(_0x480617[_0x10b020(0x907)]?_0x10b020(0xd7c):_0x10b020(0x663));}),document[_0x452732(0x9a3)](_0x452732(0x689))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x4b2998=_0x452732;document[_0x4b2998(0x9a3)](_0x4b2998(0x975))['classList'][_0x4b2998(0x133d)](_0x4b2998(0xc09));}),document[_0x452732(0x9a3)](_0x452732(0xfd6))[_0x452732(0x954)]('click',()=>{const _0x252e7f=_0x452732;document['getElementById']('werewolf-lobby-modal')[_0x252e7f(0x4d8)]['remove'](_0x252e7f(0xc09));}),document[_0x452732(0x9a3)](_0x452732(0x27f))[_0x452732(0x954)](_0x452732(0x9cc),_0x556943),document[_0x452732(0x9a3)](_0x452732(0x1445))['addEventListener'](_0x452732(0x9cc),_0x1fe472),document[_0x452732(0x9a3)](_0x452732(0x10af))['addEventListener'](_0x452732(0x9cc),_0x3d21ff),document[_0x452732(0x9a3)]('dynamic-island-music-toggle-switch')[_0x452732(0x954)](_0x452732(0xbbc),_0x3ce9dc=>{const _0x47d8da=_0x452732,_0x243823=_0x3ce9dc['target']['checked'];_0x19ddb8[_0x47d8da(0x4c8)]['alwaysShowMusicIsland']=_0x243823;const _0x47660a=document[_0x47d8da(0x7c3)][_0x47d8da(0x4d8)][_0x47d8da(0x1222)](_0x47d8da(0xa76));if(_0x4e0631[_0x47d8da(0x1412)]&&!_0x47660a){const _0x4e0bd9=document[_0x47d8da(0x9a3)](_0x47d8da(0x1386)),_0x392bef=document[_0x47d8da(0x9a3)](_0x47d8da(0xae7));_0x243823?(_0x4e0bd9['classList'][_0x47d8da(0x133d)](_0x47d8da(0xc09)),_0x392bef['classList'][_0x47d8da(0xe05)]('dynamic-island-active')):(_0x392bef[_0x47d8da(0x4d8)][_0x47d8da(0x133d)](_0x47d8da(0xf13)),_0x4e0631['parsedLyrics']&&_0x4e0631[_0x47d8da(0xa1d)][_0x47d8da(0x106b)]>0x0&&_0x4e0bd9[_0x47d8da(0x4d8)][_0x47d8da(0xe05)](_0x47d8da(0xc09)));}}),document[_0x452732(0x9a3)](_0x452732(0x583))[_0x452732(0x954)]('click',_0x1710ca),document[_0x452732(0x9a3)]('cancel-delete-world-books-btn')['addEventListener'](_0x452732(0x9cc),()=>{const _0xe500a=_0x452732;document[_0xe500a(0x9a3)](_0xe500a(0xb59))[_0xe500a(0x4d8)]['remove']('visible');}),document[_0x452732(0x9a3)](_0x452732(0xf56))[_0x452732(0x954)](_0x452732(0x9cc),_0x517f04),document[_0x452732(0x9a3)](_0x452732(0xb59))[_0x452732(0x954)](_0x452732(0x9cc),_0x134cfb=>{const _0x45bf42=_0x452732,_0x27b3d5=_0x134cfb['target'][_0x45bf42(0x94c)](_0x45bf42(0x52f));_0x27b3d5&&_0x27b3d5[_0x45bf42(0x4d8)][_0x45bf42(0xc02)](_0x45bf42(0x154b));if(_0x134cfb[_0x45bf42(0xa41)]['id']===_0x45bf42(0x7cc)){const _0x21f2aa=_0x134cfb[_0x45bf42(0xa41)]['checked'];document[_0x45bf42(0x131c)](_0x45bf42(0x1401))[_0x45bf42(0x15c1)](_0xac4be5=>{const _0xa2814e=_0x45bf42;_0xac4be5[_0xa2814e(0x4d8)][_0xa2814e(0xc02)]('selected',_0x21f2aa);});}}),document[_0x452732(0x9a3)](_0x452732(0x9fc))[_0x452732(0x954)](_0x452732(0x1b4),()=>{_0x5a49be(![]);}),document[_0x452732(0x9a3)](_0x452732(0x150b))[_0x452732(0x954)](_0x452732(0x9cc),_0x131b65=>{const _0xcd58a0=_0x452732;if(_0x131b65['target']['classList'][_0xcd58a0(0x1222)](_0xcd58a0(0xdf0))){const _0x33d125=_0x131b65[_0xcd58a0(0xa41)][_0xcd58a0(0xd8d)][_0xcd58a0(0x922)],_0x394a9d=_0x33d125!=='all'&&_0x33d125!==_0xcd58a0(0x80f)?parseInt(_0x33d125):_0x33d125;document[_0xcd58a0(0x9a3)](_0xcd58a0(0x9fc))[_0xcd58a0(0x7b2)]='',_0x50f83f(_0x394a9d);}});const _0x3b5b40=document[_0x452732(0x9a3)](_0x452732(0x10f8));_0x3b5b40[_0x452732(0x954)]('scroll',()=>{const _0x1b910e=_0x452732;if(_0x3b5b40['scrollTop']<0x1&&!_0x4cf1ca){const _0x4ec8c7=_0x19ddb8['chats'][_0x19ddb8['activeChatId']]?.[_0x1b910e(0x1f0)][_0x1b910e(0x106b)]||0x0;_0x4ec8c7>_0xaa83fe&&_0x248587();}});const _0x4974fe=document[_0x452732(0x9a3)]('thoughts-history-list');_0x4974fe[_0x452732(0x954)](_0x452732(0x50d),()=>{const _0x2d47be=_0x452732,{scrollTop:_0x31a6d2,scrollHeight:_0x24938b,clientHeight:_0x8badd8}=_0x4974fe;if(_0x24938b-_0x31a6d2<=_0x8badd8+0x32&&!_0x2dcadb){const _0xd3eb01=_0x19ddb8[_0x2d47be(0xb04)][_0x19ddb8[_0x2d47be(0x859)]]?.[_0x2d47be(0xd4a)][_0x2d47be(0x106b)]||0x0;_0xd3eb01>_0x5e066a&&_0x17a15b();}});const _0x139570=document[_0x452732(0xc86)](_0x452732(0x307));_0x139570[_0x452732(0x954)](_0x452732(0x50d),()=>{const _0x37e584=_0x452732,{scrollTop:_0x369304,scrollHeight:_0x3d9724,clientHeight:_0x2bff0e}=_0x139570;_0x3d9724-_0x369304<=_0x2bff0e+0x64&&!_0x35cb1c&&(_0x1f6575[_0x37e584(0x106b)]>_0x373876&&_0x555d97());});const _0x4f7bcc=document[_0x452732(0x9a3)](_0x452732(0x6e3));_0x4f7bcc[_0x452732(0x954)](_0x452732(0x50d),()=>{const _0x418d25=_0x452732,{scrollTop:_0x5301ce,scrollHeight:_0x1af18f,clientHeight:_0x3eb08a}=_0x4f7bcc;_0x1af18f-_0x5301ce<=_0x3eb08a+0x64&&!_0x3c8299&&(_0x1ab0a1[_0x418d25(0x106b)]>_0x35e034&&_0x476a5d());}),document['getElementById'](_0x452732(0xfa0))[_0x452732(0x954)](_0x452732(0x9cc),_0x209479);const _0x306ba2=document[_0x452732(0x9a3)](_0x452732(0x196));_0x29a968(_0x306ba2,_0x306ba2),document['getElementById'](_0x452732(0x9b4))[_0x452732(0x954)](_0x452732(0x9cc),_0x35ece3),document[_0x452732(0x9a3)](_0x452732(0x461))['addEventListener'](_0x452732(0x9cc),_0x5a3d05),document[_0x452732(0x9a3)](_0x452732(0xb83))[_0x452732(0x954)](_0x452732(0x9cc),_0x319f9b),document[_0x452732(0x9a3)](_0x452732(0x8f3))[_0x452732(0x954)](_0x452732(0x9cc),_0x4567e7),document['getElementById'](_0x452732(0x499))['addEventListener'](_0x452732(0xbbc),_0x1e6992),document['getElementById'](_0x452732(0x107d))[_0x452732(0x954)](_0x452732(0x9cc),_0x54906c),document[_0x452732(0x9a3)](_0x452732(0x196))['addEventListener']('click',_0x45e06a),_0x29a968(document[_0x452732(0x9a3)](_0x452732(0xe51)),document[_0x452732(0xc86)](_0x452732(0x11f9))),document[_0x452732(0x9a3)](_0x452732(0x461))[_0x452732(0x954)](_0x452732(0x9cc),_0x5a3d05),document['getElementById'](_0x452732(0x1381))['addEventListener'](_0x452732(0x9cc),()=>{const _0x278358=_0x452732;document[_0x278358(0x9a3)](_0x278358(0x740))[_0x278358(0x4d8)][_0x278358(0x133d)](_0x278358(0xc09));}),document['getElementById'](_0x452732(0x8ef))[_0x452732(0x954)]('click',_0x166d73),document[_0x452732(0x9a3)](_0x452732(0x5d8))[_0x452732(0x954)](_0x452732(0x9cc),_0x3e3e4e=>{const _0x34008b=_0x452732,_0x3da9f8=_0x3e3e4e[_0x34008b(0xa41)];if(_0x3da9f8['classList'][_0x34008b(0x1222)](_0x34008b(0x139a))){const _0x495778=parseInt(_0x3da9f8['dataset']['bookId']);_0x118b2b(_0x495778);}else{if(_0x3da9f8[_0x34008b(0x4d8)][_0x34008b(0x1222)](_0x34008b(0x6de))){const _0x3fd0ca=parseInt(_0x3da9f8['dataset'][_0x34008b(0xf1b)]);_0x4fc515(_0x3fd0ca);}}}),document[_0x452732(0x9a3)](_0x452732(0x1289))[_0x452732(0x954)](_0x452732(0x9cc),_0x1a22fb),document[_0x452732(0x9a3)](_0x452732(0xbc5))[_0x452732(0x954)](_0x452732(0x1b4),_0x53e206=>{const _0x1eb0b1=_0x452732;_0x55932b(_0x53e206[_0x1eb0b1(0xa41)][_0x1eb0b1(0x7b2)]);});const _0x4ce5c8=_0x3dbeec(_0x540224,0x12c);document['getElementById'](_0x452732(0x1342))['addEventListener'](_0x452732(0x50d),_0x4ce5c8),document[_0x452732(0x9a3)](_0x452732(0x143c))[_0x452732(0x954)](_0x452732(0x1b4),_0x33d8b9=>{const _0x1dc7be=_0x452732;document[_0x1dc7be(0x9a3)]('api-temperature-value')['textContent']=_0x33d8b9['target'][_0x1dc7be(0x7b2)];});const _0x525d1c=document['getElementById'](_0x452732(0xdd5));_0x525d1c[_0x452732(0x954)]('scroll',()=>{const {scrollTop:_0x20c3f3,scrollHeight:_0x33e9c5,clientHeight:_0x354751}=_0x525d1c;_0x33e9c5-_0x20c3f3<=_0x354751+0x96&&!_0x5b6e4b&&_0x380baf();}),document[_0x452732(0x9a3)]('manage-product-categories-btn')['addEventListener']('click',_0x57cd9e),document[_0x452732(0x9a3)]('close-product-category-manager-btn')['addEventListener']('click',()=>{const _0x5ece23=_0x452732;document[_0x5ece23(0x9a3)]('product-category-manager-modal')[_0x5ece23(0x4d8)][_0x5ece23(0x133d)](_0x5ece23(0xc09)),_0x53cd36(_0x32068e);}),document[_0x452732(0x9a3)](_0x452732(0xab0))[_0x452732(0x954)](_0x452732(0x9cc),_0x588a47),document[_0x452732(0x9a3)](_0x452732(0x10c7))['addEventListener']('click',_0x4cfda9=>{const _0x3e2b50=_0x452732;_0x4cfda9[_0x3e2b50(0xa41)][_0x3e2b50(0x4d8)][_0x3e2b50(0x1222)](_0x3e2b50(0x6de))&&_0x24d40e(parseInt(_0x4cfda9['target'][_0x3e2b50(0xd8d)]['id']));}),document[_0x452732(0x9a3)]('add-product-variation-btn')[_0x452732(0x954)](_0x452732(0x9cc),()=>_0x5395a3()),document[_0x452732(0x9a3)]('cancel-variation-selection-btn')['addEventListener'](_0x452732(0x9cc),()=>{const _0x352491=_0x452732;document['getElementById'](_0x352491(0x793))[_0x352491(0x4d8)]['remove'](_0x352491(0xc09));}),document['getElementById'](_0x452732(0xdb7))[_0x452732(0x954)]('click',()=>{const _0x50ea1a=_0x452732,_0x23a652=document['getElementById'](_0x50ea1a(0x890));let _0x170f93=parseInt(_0x23a652[_0x50ea1a(0x766)]);if(_0x170f93>0x1)_0x23a652[_0x50ea1a(0x766)]=_0x170f93-0x1;}),document[_0x452732(0x9a3)](_0x452732(0x11ae))['addEventListener'](_0x452732(0x9cc),()=>{const _0x12dec2=_0x452732,_0x4786fd=document[_0x12dec2(0x9a3)](_0x12dec2(0x890));_0x4786fd[_0x12dec2(0x766)]=parseInt(_0x4786fd[_0x12dec2(0x766)])+0x1;}),document[_0x452732(0x9a3)](_0x452732(0xbb7))['addEventListener'](_0x452732(0x9cc),_0x1f66c9=>{const _0x588e4a=_0x452732;if(_0x1f66c9['target']['classList'][_0x588e4a(0x1222)](_0x588e4a(0xb89))){const _0x348896=_0x1f66c9[_0x588e4a(0xa41)][_0x588e4a(0xd8d)][_0x588e4a(0x922)]===_0x588e4a(0xbf1)?_0x588e4a(0xbf1):parseInt(_0x1f66c9[_0x588e4a(0xa41)][_0x588e4a(0xd8d)][_0x588e4a(0x922)]);_0x4b62eb(_0x348896);}}),document[_0x452732(0x9a3)](_0x452732(0x20e))[_0x452732(0x954)](_0x452732(0x9cc),_0x4cf0f4),document[_0x452732(0x9a3)](_0x452732(0x4ca))[_0x452732(0x954)]('click',_0x52fc91),document[_0x452732(0x9a3)]('save-shopping-settings-btn')[_0x452732(0x954)](_0x452732(0x9cc),_0x389ac8),document['getElementById'](_0x452732(0x8cb))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x543626=_0x452732;document[_0x543626(0x9a3)](_0x543626(0x32b))[_0x543626(0x4d8)][_0x543626(0x133d)](_0x543626(0xc09));}),document['getElementById']('select-all-products-checkbox')[_0x452732(0x954)](_0x452732(0xbbc),_0x276a80=>{const _0x453947=_0x452732,_0x5d05f4=_0x276a80[_0x453947(0xa41)][_0x453947(0x944)],_0x384287=document['querySelectorAll'](_0x453947(0xe1c));_0x384287[_0x453947(0x15c1)](_0x42ab94=>{const _0x4ad3ec=_0x453947,_0x5d5fec=parseInt(_0x42ab94['dataset']['id']);_0x42ab94[_0x4ad3ec(0x4d8)][_0x4ad3ec(0xc02)](_0x4ad3ec(0x154b),_0x5d05f4),_0x5d05f4?_0x2fc670['add'](_0x5d5fec):_0x2fc670['delete'](_0x5d5fec);}),document[_0x453947(0x9a3)]('delete-selected-products-btn')[_0x453947(0x766)]=_0x453947(0x1587)+_0x2fc670[_0x453947(0xbdf)]+')';}),document[_0x452732(0x9a3)]('delete-selected-products-btn')[_0x452732(0x954)]('click',async()=>{const _0x448a1d=_0x452732;if(_0x2fc670[_0x448a1d(0xbdf)]===0x0){alert(_0x448a1d(0x1c8));return;}const _0x54dc4a=await _0x2c9509(_0x448a1d(0xd05),_0x448a1d(0x1196)+_0x2fc670[_0x448a1d(0xbdf)]+'\x20个商品吗？此操作不可恢复。',{'confirmButtonClass':_0x448a1d(0xf5b)});_0x54dc4a&&(await _0x512070[_0x448a1d(0x376)][_0x448a1d(0x25c)]([..._0x2fc670]),document['getElementById']('manage-products-btn')[_0x448a1d(0x9cc)](),await _0x5cb09b(),await _0x403a62('成功',_0x448a1d(0xf20)));}),document[_0x452732(0x9a3)](_0x452732(0xf61))[_0x452732(0x954)](_0x452732(0xbbc),_0xa247d1),document['getElementById'](_0x452732(0x971))[_0x452732(0x954)](_0x452732(0x9cc),_0x7c040b),document['getElementById'](_0x452732(0x74c))[_0x452732(0x954)](_0x452732(0x9cc),_0x272c0c),document['getElementById']('novelai-switch')[_0x452732(0x954)]('change',_0x42f905=>{const _0x2bc71b=_0x452732,_0x29b71f=document[_0x2bc71b(0x9a3)](_0x2bc71b(0x1543));_0x29b71f[_0x2bc71b(0x20f)][_0x2bc71b(0x115d)]=_0x42f905[_0x2bc71b(0xa41)]['checked']?_0x2bc71b(0x10c8):'none';}),document[_0x452732(0x9a3)](_0x452732(0xbe5))[_0x452732(0x954)](_0x452732(0x9cc),function(){const _0x1a2150=_0x452732,_0x32687e=document[_0x1a2150(0x9a3)](_0x1a2150(0x4a1));_0x32687e[_0x1a2150(0x1508)]===_0x1a2150(0x11d6)?(_0x32687e[_0x1a2150(0x1508)]=_0x1a2150(0x13ca),this['textContent']='😌'):(_0x32687e[_0x1a2150(0x1508)]='password',this['textContent']='🧐');}),document[_0x452732(0x9a3)](_0x452732(0x134f))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x5aae49=_0x452732;_0x54ff67(),document[_0x5aae49(0x9a3)]('novelai-settings-modal')[_0x5aae49(0x20f)][_0x5aae49(0x115d)]='flex';}),document[_0x452732(0x9a3)]('nai-cors-proxy')[_0x452732(0x954)](_0x452732(0xbbc),_0x5ec78c=>{const _0x3f5c88=_0x452732,_0x1238e9=document['getElementById']('nai-custom-proxy-group');_0x5ec78c['target'][_0x3f5c88(0x7b2)]===_0x3f5c88(0xbe4)?_0x1238e9['style']['display']='block':_0x1238e9[_0x3f5c88(0x20f)]['display']=_0x3f5c88(0x8e0);}),document['getElementById'](_0x452732(0x71a))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x53c0a1=_0x452732;document[_0x53c0a1(0x9a3)](_0x53c0a1(0xaf1))[_0x53c0a1(0x20f)]['display']='none';}),document['getElementById'](_0x452732(0x11ce))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x12faff=_0x452732;_0x4b0ea9(),document[_0x12faff(0x9a3)]('novelai-settings-modal')[_0x12faff(0x20f)][_0x12faff(0x115d)]=_0x12faff(0x8e0),alert(_0x12faff(0x961));}),document[_0x452732(0x9a3)]('reset-nai-settings-btn')[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x339a06=_0x452732;confirm(_0x339a06(0xfcb))&&_0x53b56a();}),document[_0x452732(0x9a3)]('novelai-test-btn')[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x3e7827=_0x452732,_0x222b11=document[_0x3e7827(0x9a3)](_0x3e7827(0x4a1))['value'][_0x3e7827(0x13f9)]();if(!_0x222b11){alert(_0x3e7827(0x6dc));return;}document['getElementById'](_0x3e7827(0xbda))[_0x3e7827(0x20f)][_0x3e7827(0x115d)]='flex',document[_0x3e7827(0x9a3)](_0x3e7827(0x118f))['style'][_0x3e7827(0x115d)]=_0x3e7827(0x8e0),document['getElementById'](_0x3e7827(0x13cd))[_0x3e7827(0x20f)]['display']=_0x3e7827(0x8e0);}),document[_0x452732(0x9a3)]('close-novelai-test')[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x39875e=_0x452732;document[_0x39875e(0x9a3)](_0x39875e(0xbda))[_0x39875e(0x20f)][_0x39875e(0x115d)]=_0x39875e(0x8e0);}),document[_0x452732(0x9a3)](_0x452732(0x95d))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x5aab81=_0x452732;document['getElementById'](_0x5aab81(0xbda))[_0x5aab81(0x20f)]['display']=_0x5aab81(0x8e0);}),document[_0x452732(0x9a3)](_0x452732(0xc1a))[_0x452732(0x954)](_0x452732(0x9cc),async()=>{await _0x274315();}),document[_0x452732(0x9a3)]('nai-download-btn')[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x1a5d9f=_0x452732,_0x5cdfea=document['getElementById'](_0x1a5d9f(0xf8e)),_0x20bffb=document[_0x1a5d9f(0xe94)]('a');_0x20bffb['href']=_0x5cdfea[_0x1a5d9f(0x10d4)],_0x20bffb[_0x1a5d9f(0xed2)]=_0x1a5d9f(0x597)+Date['now']()+_0x1a5d9f(0x1335),_0x20bffb['click']();}),document['getElementById'](_0x452732(0x3ad))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x184677=_0x452732;if(!_0x19ddb8[_0x184677(0x859)])return;const _0x5876f1=_0x19ddb8['chats'][_0x19ddb8[_0x184677(0x859)]],_0x2cad3a=_0x5876f1[_0x184677(0x450)][_0x184677(0xc5b)]||{'promptSource':_0x184677(0xe10),'characterPositivePrompt':'','characterNegativePrompt':''};document[_0x184677(0x9a3)](_0x184677(0xc9f))[_0x184677(0x7b2)]=_0x2cad3a[_0x184677(0x208)]||'',document[_0x184677(0x9a3)](_0x184677(0xc10))[_0x184677(0x7b2)]=_0x2cad3a[_0x184677(0xc51)]||'',document[_0x184677(0x9a3)](_0x184677(0x142b))[_0x184677(0x20f)][_0x184677(0x115d)]=_0x184677(0x79c);}),document[_0x452732(0x9a3)](_0x452732(0x15ae))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x4f18a2=_0x452732;document[_0x4f18a2(0x9a3)](_0x4f18a2(0x142b))[_0x4f18a2(0x20f)][_0x4f18a2(0x115d)]=_0x4f18a2(0x8e0);}),document['getElementById']('save-character-nai-prompts-btn')[_0x452732(0x954)]('click',async()=>{const _0x2fa853=_0x452732;if(!_0x19ddb8[_0x2fa853(0x859)])return;const _0x3e581b=_0x19ddb8[_0x2fa853(0xb04)][_0x19ddb8[_0x2fa853(0x859)]];!_0x3e581b['settings'][_0x2fa853(0xc5b)]&&(_0x3e581b[_0x2fa853(0x450)][_0x2fa853(0xc5b)]={'promptSource':_0x2fa853(0xe10)}),_0x3e581b['settings']['naiSettings']['characterPositivePrompt']=document[_0x2fa853(0x9a3)](_0x2fa853(0xc9f))[_0x2fa853(0x7b2)][_0x2fa853(0x13f9)](),_0x3e581b[_0x2fa853(0x450)]['naiSettings'][_0x2fa853(0xc51)]=document[_0x2fa853(0x9a3)](_0x2fa853(0xc10))['value']['trim'](),console[_0x2fa853(0xe4d)]('💾\x20[专属弹窗]\x20保存角色NAI提示词'),console[_0x2fa853(0xe4d)](_0x2fa853(0x12cd),_0x3e581b[_0x2fa853(0x450)][_0x2fa853(0xc5b)][_0x2fa853(0x208)]),console[_0x2fa853(0xe4d)](_0x2fa853(0x10e7),_0x3e581b[_0x2fa853(0x450)][_0x2fa853(0xc5b)][_0x2fa853(0xc51)]),console[_0x2fa853(0xe4d)](_0x2fa853(0xfd5),_0x3e581b[_0x2fa853(0x450)][_0x2fa853(0xc5b)][_0x2fa853(0x1361)]),await _0x512070[_0x2fa853(0xb04)][_0x2fa853(0xd4d)](_0x3e581b),document[_0x2fa853(0x9a3)]('character-nai-prompts-modal')[_0x2fa853(0x20f)][_0x2fa853(0x115d)]='none',alert(_0x2fa853(0x8a4));}),document[_0x452732(0x9a3)]('reset-character-nai-prompts-btn')['addEventListener'](_0x452732(0x9cc),()=>{const _0x35e235=_0x452732;confirm('确定要清空当前角色的NAI提示词配置吗？')&&(document['getElementById']('character-nai-positive')['value']='',document[_0x35e235(0x9a3)](_0x35e235(0xc10))[_0x35e235(0x7b2)]='');}),document['getElementById']('group-character-nai-prompts-btn')[_0x452732(0x954)]('click',()=>{const _0x1253cd=_0x452732;if(!_0x19ddb8['activeChatId'])return;const _0x43976d=_0x19ddb8['chats'][_0x19ddb8[_0x1253cd(0x859)]],_0x1bd6e8=_0x43976d[_0x1253cd(0x450)][_0x1253cd(0xc5b)]||{'promptSource':_0x1253cd(0xe10),'characterPositivePrompt':'','characterNegativePrompt':''};document[_0x1253cd(0x9a3)](_0x1253cd(0xc9f))[_0x1253cd(0x7b2)]=_0x1bd6e8['characterPositivePrompt']||'',document['getElementById'](_0x1253cd(0xc10))[_0x1253cd(0x7b2)]=_0x1bd6e8['characterNegativePrompt']||'',document[_0x1253cd(0x9a3)](_0x1253cd(0x142b))[_0x1253cd(0x20f)][_0x1253cd(0x115d)]=_0x1253cd(0x79c);}),document[_0x452732(0x9a3)](_0x452732(0x103f))['addEventListener'](_0x452732(0x9cc),_0x566ac5),document[_0x452732(0x9a3)](_0x452732(0xaa7))[_0x452732(0x954)](_0x452732(0xbbc),_0x3867a7),document[_0x452732(0x9a3)](_0x452732(0x93f))[_0x452732(0x954)](_0x452732(0x9cc),_0xa5df8e),document[_0x452732(0x9a3)](_0x452732(0xee9))[_0x452732(0x954)]('click',_0x6fd5a2),document[_0x452732(0x9a3)](_0x452732(0x4e5))['addEventListener']('click',()=>{const _0x5d572e=_0x452732;_0x56e352(_0x5d572e(0x1022));}),document[_0x452732(0x9a3)]('sticker-binding-chat-list')[_0x452732(0x954)](_0x452732(0x9cc),_0x33e9d5=>{const _0x1c21e1=_0x452732,_0x41ed86=_0x33e9d5[_0x1c21e1(0xa41)][_0x1c21e1(0x94c)]('.contact-picker-item');if(_0x41ed86){const _0x552051=_0x41ed86[_0x1c21e1(0xc86)](_0x1c21e1(0xcbd));_0x552051&&_0x33e9d5[_0x1c21e1(0xa41)]!==_0x552051&&(_0x552051[_0x1c21e1(0x944)]=!_0x552051['checked']);}});const _0x43ea08=document['getElementById'](_0x452732(0x150b));_0x1a651b(_0x43ea08,_0x2fd8f8=>{const _0x37f36a=_0x452732,_0x31ab3d=_0x2fd8f8[_0x37f36a(0xa41)][_0x37f36a(0x94c)](_0x37f36a(0xf72));if(_0x31ab3d){_0x2fd8f8[_0x37f36a(0x28d)]();const _0x2621eb=_0x31ab3d['dataset'][_0x37f36a(0x922)];if(_0x2621eb==='all'){_0x403a62('提示',_0x37f36a(0x5dd));return;}const _0x2b64ef=_0x2621eb===_0x37f36a(0x80f)?_0x37f36a(0x80f):parseInt(_0x2621eb);_0x59245c(_0x2b64ef);}}),document['getElementById'](_0x452732(0x99c))['addEventListener'](_0x452732(0x9cc),_0x1b445c),document[_0x452732(0x9a3)]('close-nai-gallery-btn')[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x38166d=_0x452732;document['getElementById'](_0x38166d(0x85d))['classList'][_0x38166d(0x133d)](_0x38166d(0xc09));}),document[_0x452732(0x9a3)](_0x452732(0xdc4))[_0x452732(0x954)]('click',_0x24fe75),document['getElementById']('nai-gallery-grid')[_0x452732(0x954)](_0x452732(0x9cc),_0xbf4ee=>{_0x44d33a(_0xbf4ee);}),document['getElementById']('select-all-nai-gallery-checkbox')[_0x452732(0x954)](_0x452732(0xbbc),_0x2888cb=>{const _0x387aaf=_0x452732,_0x1562d8=_0x2888cb['target']['checked'];document['querySelectorAll'](_0x387aaf(0xb1e))[_0x387aaf(0x15c1)](_0x387c09=>{const _0x24561b=_0x387aaf;_0x387c09[_0x24561b(0x4d8)]['toggle'](_0x24561b(0x154b),_0x1562d8);const _0x1fdbee=_0x387c09[_0x24561b(0xd8d)][_0x24561b(0xf33)];_0x1562d8?_0x3b4dcd[_0x24561b(0xe05)](_0x1fdbee):_0x3b4dcd[_0x24561b(0x10a8)](_0x1fdbee);}),_0xd72932();}),document['getElementById']('download-selected-nai-gallery-btn')[_0x452732(0x954)](_0x452732(0x9cc),()=>_0x59e9ae()),document[_0x452732(0x9a3)](_0x452732(0x3fd))[_0x452732(0x954)]('click',()=>_0x5f4769()),document[_0x452732(0x9a3)](_0x452732(0x362))[_0x452732(0x954)](_0x452732(0x9cc),()=>{const _0x1a2c1e=_0x452732;document[_0x1a2c1e(0x7c3)][_0x1a2c1e(0x4d8)][_0x1a2c1e(0xc02)](_0x1a2c1e(0x23c));}),document['getElementById'](_0x452732(0x13f5))['addEventListener'](_0x452732(0x9cc),_0x1ad4aa),_0x4a1fd0(),_0x467fd0(),_0x35df44(_0x452732(0x663));}_0x4461c8();});

const _0x710220=_0x466f;(function(_0x3f27a5,_0x50a665){const _0xe5ab84=_0x466f,_0x49e151=_0x3f27a5();while(!![]){try{const _0x5c0e2f=-parseInt(_0xe5ab84(0xc1b))/0x1+parseInt(_0xe5ab84(0x92f))/0x2+-parseInt(_0xe5ab84(0x800))/0x3+parseInt(_0xe5ab84(0x860))/0x4+parseInt(_0xe5ab84(0x1696))/0x5+parseInt(_0xe5ab84(0xafc))/0x6*(parseInt(_0xe5ab84(0x7d4))/0x7)+-parseInt(_0xe5ab84(0x35d))/0x8;if(_0x5c0e2f===_0x50a665)break;else _0x49e151['push'](_0x49e151['shift']());}catch(_0x99db46){_0x49e151['push'](_0x49e151['shift']());}}}(_0x6777,0x6b15d));const ACTIVATION_PIN_URL=_0x710220(0x1103);function escapeHTML(_0x25a9f8){const _0x2019a7=_0x710220;if(!_0x25a9f8)return'';return _0x25a9f8[_0x2019a7(0xe19)](/[&<>"']/g,function(_0x10b9a7){const _0x628a7e=_0x2019a7;return{'&':_0x628a7e(0x25c),'<':_0x628a7e(0xa7d),'>':_0x628a7e(0x53c),'\x22':_0x628a7e(0xc9b),'\x27':_0x628a7e(0x59b)}[_0x10b9a7];});}function generateRandomPacketAmounts(_0x4092d8,_0xd82650){const _0x386349=_0x710220;let _0xa2e146=_0x4092d8,_0xfc90b4=_0xd82650;const _0x17caa1=[],_0x144a59=0.01;for(let _0xe9e86c=0x0;_0xe9e86c<_0xd82650-0x1;_0xe9e86c++){const _0x2e756a=_0xa2e146/_0xfc90b4,_0x3a8051=_0xa2e146-(_0xfc90b4-0x1)*_0x144a59;let _0xf560bf=Math[_0x386349(0xaeb)](_0x2e756a*0x2,_0x3a8051);_0xf560bf<_0x144a59&&(_0xf560bf=_0x144a59);let _0x130d9b=Math[_0x386349(0x12bc)]()*(_0xf560bf-_0x144a59)+_0x144a59;_0x130d9b=parseFloat(_0x130d9b['toFixed'](0x2)),_0x17caa1[_0x386349(0x6bb)](_0x130d9b),_0xa2e146-=_0x130d9b,_0xfc90b4--;}_0x17caa1[_0x386349(0x6bb)](parseFloat(_0xa2e146['toFixed'](0x2)));for(let _0x2e3e4f=_0x17caa1[_0x386349(0x8d6)]-0x1;_0x2e3e4f>0x0;_0x2e3e4f--){const _0x5b93d4=Math['floor'](Math['random']()*(_0x2e3e4f+0x1));[_0x17caa1[_0x2e3e4f],_0x17caa1[_0x5b93d4]]=[_0x17caa1[_0x5b93d4],_0x17caa1[_0x2e3e4f]];}return console[_0x386349(0x1e6)](_0x386349(0x5a8)+_0x4092d8+_0x386349(0x16ae)+_0xd82650+_0x386349(0x12a1),_0x17caa1),_0x17caa1;}function _0x466f(_0xf4d058,_0x3a24d7){const _0x677732=_0x6777();return _0x466f=function(_0x466fa3,_0x6981a2){_0x466fa3=_0x466fa3-0x1db;let _0x14994a=_0x677732[_0x466fa3];return _0x14994a;},_0x466f(_0xf4d058,_0x3a24d7);}function getDeviceId(){const _0x597c5c=_0x710220;let _0x3f8014=localStorage['getItem'](_0x597c5c(0x34e));return!_0x3f8014&&(_0x3f8014=([0x989680]+-0x3e8+-0xfa0+-0x1f40+-0x174876e800)[_0x597c5c(0xe19)](/[018]/g,_0x1d8343=>(_0x1d8343^crypto['getRandomValues'](new Uint8Array(0x1))[0x0]&0xf>>_0x1d8343/0x4)[_0x597c5c(0xa60)](0x10)),localStorage[_0x597c5c(0x143f)]('ephoneDeviceId',_0x3f8014)),_0x3f8014;}const EPHONE_DEVICE_ID=getDeviceId();console[_0x710220(0x1e6)](_0x710220(0x7d2)+EPHONE_DEVICE_ID);let isPinActivated=localStorage['getItem']('ephonePinActivated')===_0x710220(0xaea);const translations={'zh-CN':{'save':'保存','cancel':'取消','confirm':'确定','edit':'编辑','done':'完成','add':'添加','back':'返回','next':_0x710220(0x1675),'close':'关闭','reset':'重置','upload':'上传','send':'发送','manage':'管理','share':'分享','delete':'删除','publish':'发布','refresh':'刷新','search':'搜索','remove':'移除','finish':'结束','details':'详情','settings':'设置','title':'标题','content':'内容','category':'分类','name':'名称','description':'描述','status':'状态','ok':'好的','error':'错误','success':'成功','warning':'警告','loading':'加载中...','processing':'处理中...','pleaseWait':_0x710220(0x13e9),'languageChangedAlert':_0x710220(0xc06),'homeAppQQ':'QQ','homeAppWorldBook':_0x710220(0x292),'homeAppAppearance':_0x710220(0x1647),'homeAppRenderer':_0x710220(0x11a8),'homeAppApiSettings':'设置','homeAppFont':'字体','homeAppCPhone':'CPhone','homeAppDouban':'豆瓣','homeAppPreset':'预设','homeAppTutorial':'教程','homeAppWerewolf':_0x710220(0xd7b),'homeAppX':'X','chatListTitle':'消息','navMessages':'消息','navQzone':'动态','navMemories':'回忆','navFavorites':'收藏','navNpcList':'NPC','qzoneTitle':_0x710220(0x40b),'qzoneActionShuoshuo':'说说','qzoneActionPost':'动态','qzoneActionAlbum':'相册','cphoneTitleSelect':_0x710220(0x6a1),'cphoneAppQQ':'QQ','cphoneAppAlbum':'相册','cphoneAppBrowser':'浏览器','cphoneAppTaobao':'淘宝','cphoneAppMemo':'备忘录','cphoneAppDiary':'日记','cphoneAppAmap':_0x710220(0xe59),'cphoneAppUsage':_0x710220(0x3f4),'cphoneAppMusic':_0x710220(0x10fd),'cphoneAppEphone':_0x710220(0x15ef),'cphoneAppFootprints':'足迹','cphoneAlbumTitle':'TA的相册','cphoneBrowserTitle':_0x710220(0x1626),'cphoneTaobaoTitle':_0x710220(0x3b8),'cphoneWalletTitle':'钱包','cphoneMemoTitle':_0x710220(0x130d),'cphoneDiaryTitle':'日记','cphoneUsageTitle':_0x710220(0x12f6),'cphoneMusicTitle':_0x710220(0x87a),'cphoneArticleTitle':'文章','cphoneSimulatedChatPlaceholder':'这是模拟对话，无法发送消息','worldBookTitle':_0x710220(0x292),'worldBookEditorTitle':_0x710220(0x6c6),'worldBookEntryEditorTitle':_0x710220(0x12f9),'worldBookNameLabel':'书名','worldBookCategoryLabel':'分类','worldBookEntriesLabel':_0x710220(0x4b6),'worldBookAddEntryBtn':_0x710220(0x83a),'worldBookNamePlaceholder':_0x710220(0x15e3),'worldBookImportTitle':_0x710220(0x10da),'presetTitle':'预设','presetEditorTitle':_0x710220(0x15b1),'presetNameLabel':_0x710220(0xfd9),'presetCategoryLabel':'分类','presetEntriesLabel':_0x710220(0x4b6),'presetAddEntryBtn':'[+]\x20添加新条目','tutorialTitle':'教程','apiSettingsTitle':_0x710220(0x39c),'languageLabel':'语言','apiPresetManagement':_0x710220(0x12db),'apiPresetSelectLabel':_0x710220(0xbd0),'apiPrimarySettings':_0x710220(0xf80),'apiProxyUrlLabel':'反代地址\x20(不需要添加/v1噢~)','apiKeyLabel':'密钥\x20(API\x20Key)','apiModelLabel':'模型','apiFetchModelsBtn':_0x710220(0xd03),'apiSecondarySettings':'副API设置\x20(用于总结长期记忆)','apiSecondaryProxyUrlLabel':_0x710220(0x4c2),'apiSecondaryKeyLabel':_0x710220(0x887),'apiSecondaryModelLabel':_0x710220(0x966),'apiFetchSecondaryModelsBtn':_0x710220(0x1300),'apiBgActivitySettings':'后台活动设置','apiEnableBgActivityLabel':_0x710220(0xbe2),'apiBgIntervalLabel':_0x710220(0x13af),'apiBlockCooldownLabel':_0x710220(0x12e8),'apiTtsSettings':'语音消息设置\x20(Minimax\x20TTS)','apiTtsModelLabel':'语音模型\x20(Model)','apiPerformanceSettings':_0x710220(0x208),'apiChatListRenderWindowLabel':_0x710220(0x6b2),'apiChatRenderWindowLabel':_0x710220(0x1066),'apiImageGenSettings':_0x710220(0x747),'apiEnableImageGenLabel':_0x710220(0x10af),'apiEnableNovelAILabel':'启用\x20NovelAI\x20图像生成','apiNovelAIModelLabel':'NovelAI\x20模型','apiNovelAIKeyLabel':_0x710220(0x11a0),'apiNovelAIGenSettingsBtn':_0x710220(0xc9f),'apiNovelAITestBtn':'测试生成','apiStorageOptimization':_0x710220(0x5c5),'apiCompressImagesBtn':'一键压缩本地图片','apiSaveAllBtn':'保存所有设置','apiExportDataBtn':'导出数据','apiImportDataBtn':_0x710220(0xaf5),'apiCleanupDataBtn':'清理冗余数据','apiDeleteWorldBooksBtn':'删除世界书','apiAdvancedCleanupBtn':_0x710220(0xde4),'apiCheckAndFixDataBtn':_0x710220(0xc3c),'chatHeaderOnline':'在线','chatHeaderLongTermMemory':_0x710220(0x437),'chatHeaderListenTogether':_0x710220(0xb3e),'chatHeaderChatSettings':'聊天设置','chatSelectionCancel':'取消','chatSelectionScreenshot':'长截图','chatSelectionFavorite':'收藏','chatSelectionShare':'分享','chatSelectionSoftDelete':_0x710220(0xaec),'chatSelectionHardDelete':_0x710220(0x162a),'chatReplyTo':'回复','chatInputPlaceholder':_0x710220(0xd8a),'chatWaitForReply':'等待回复','appearanceTitle':_0x710220(0x1647),'appearanceSaveAll':_0x710220(0xb64),'fontSettingsTitle':_0x710220(0x89b),'fontPresetManagement':_0x710220(0x15a8),'fontFileUrlLabel':_0x710220(0x133a),'fontPreviewLabel':_0x710220(0xb52),'fontPreviewText1':_0x710220(0x11b3),'fontPreviewText2':'这是字体预览效果，12345。','fontSaveAndApply':'保存并应用','fontResetDefault':_0x710220(0x87f),'rendererTitle':_0x710220(0x85f),'rendererEditorTitle':'编辑规则','rendererCreateTitle':'创建新规则','rendererRuleName':'规则名称','rendererBindScope':_0x710220(0x127f),'rendererScopeGlobal':'公用\x20(所有角色)','rendererRegex':_0x710220(0x14b1),'rendererHtmlTemplate':_0x710220(0xa67),'rendererEnableRule':'启用规则','myAlbumTitle':'我的相册','albumPhotosTitle':_0x710220(0x13d5),'npcEditorTitleAdd':_0x710220(0x258),'npcEditorTitleEdit':_0x710220(0x141a),'npcAvatarLabel':'NPC\x20头像','npcUploadAvatar':_0x710220(0xfa2),'npcNicknameLabel':_0x710220(0x154f),'npcPersonaLabel':_0x710220(0x5a5),'npcEnableBgActivity':'启用独立后台活动','npcActionCooldown':_0x710220(0x1657),'npcAssociatedChars':_0x710220(0x1f4)},'en':{'save':_0x710220(0xfcc),'cancel':_0x710220(0x345),'confirm':_0x710220(0xde3),'edit':_0x710220(0x772),'done':'Done','add':'Add','back':_0x710220(0xed3),'next':_0x710220(0xb5e),'close':_0x710220(0x4fc),'reset':_0x710220(0x9d0),'upload':'Upload','send':_0x710220(0xe7e),'manage':_0x710220(0x430),'share':_0x710220(0xd80),'delete':_0x710220(0x166f),'publish':'Publish','refresh':'Refresh','search':_0x710220(0x1e7),'remove':_0x710220(0x725),'finish':_0x710220(0xadd),'details':_0x710220(0x5cd),'settings':_0x710220(0xe93),'title':_0x710220(0x448),'content':_0x710220(0x140e),'category':_0x710220(0x33c),'name':'Name','description':_0x710220(0xac2),'status':'Status','ok':'OK','error':'Error','success':_0x710220(0x6ec),'warning':_0x710220(0x595),'loading':_0x710220(0x20b),'processing':_0x710220(0x36c),'pleaseWait':_0x710220(0xf4b),'languageChangedAlert':_0x710220(0x1078),'homeAppQQ':'QQ','homeAppWorldBook':_0x710220(0x1668),'homeAppAppearance':_0x710220(0x3e9),'homeAppRenderer':_0x710220(0x8f4),'homeAppApiSettings':_0x710220(0xe93),'homeAppFont':_0x710220(0x3af),'homeAppCPhone':_0x710220(0x1104),'homeAppDouban':_0x710220(0x1462),'homeAppPreset':'Presets','homeAppTutorial':_0x710220(0x456),'homeAppWerewolf':_0x710220(0x2b3),'homeAppX':'X','chatListTitle':_0x710220(0x121c),'navMessages':'Messages','navQzone':_0x710220(0x1585),'navMemories':_0x710220(0x28b),'navFavorites':'Favorites','navNpcList':_0x710220(0x68a),'qzoneTitle':_0x710220(0x1585),'qzoneActionShuoshuo':_0x710220(0x44b),'qzoneActionPost':_0x710220(0x145c),'qzoneActionAlbum':'Album','cphoneTitleSelect':_0x710220(0xbe9),'cphoneAppQQ':'QQ','cphoneAppAlbum':_0x710220(0xc1c),'cphoneAppBrowser':_0x710220(0xc21),'cphoneAppTaobao':_0x710220(0x42f),'cphoneAppMemo':_0x710220(0x95f),'cphoneAppDiary':'Diary','cphoneAppAmap':_0x710220(0x562),'cphoneAppUsage':_0x710220(0xa9b),'cphoneAppMusic':'Music','cphoneAppEphone':_0x710220(0x15ef),'cphoneAppFootprints':_0x710220(0xf6e),'cphoneAlbumTitle':_0x710220(0x107e),'cphoneBrowserTitle':_0x710220(0x156b),'cphoneTaobaoTitle':'Their\x20Taobao\x20Orders','cphoneWalletTitle':_0x710220(0x103f),'cphoneMemoTitle':'Memo','cphoneDiaryTitle':_0x710220(0x88d),'cphoneUsageTitle':_0x710220(0xf5c),'cphoneMusicTitle':_0x710220(0xc73),'cphoneArticleTitle':_0x710220(0xd4a),'cphoneSimulatedChatPlaceholder':_0x710220(0x1240),'worldBookTitle':_0x710220(0x1668),'worldBookEditorTitle':_0x710220(0x137e),'worldBookEntryEditorTitle':_0x710220(0x249),'worldBookNameLabel':_0x710220(0x73b),'worldBookCategoryLabel':_0x710220(0x33c),'worldBookEntriesLabel':_0x710220(0x598),'worldBookAddEntryBtn':_0x710220(0x576),'worldBookNamePlaceholder':'Enter\x20the\x20name\x20of\x20the\x20world\x20book...','worldBookImportTitle':_0x710220(0xde8),'presetTitle':_0x710220(0xd71),'presetEditorTitle':_0x710220(0x777),'presetNameLabel':_0x710220(0x14e0),'presetCategoryLabel':_0x710220(0x33c),'presetEntriesLabel':_0x710220(0x598),'presetAddEntryBtn':_0x710220(0x576),'tutorialTitle':'Tutorial','apiSettingsTitle':'API\x20Settings','languageLabel':'Language','apiPresetManagement':_0x710220(0x6c5),'apiPresetSelectLabel':_0x710220(0x93a),'apiPrimarySettings':'Primary\x20API\x20Settings\x20(for\x20Chat)','apiProxyUrlLabel':_0x710220(0x6e3),'apiKeyLabel':_0x710220(0xa91),'apiModelLabel':_0x710220(0xa73),'apiFetchModelsBtn':_0x710220(0x24d),'apiSecondarySettings':_0x710220(0xab8),'apiSecondaryProxyUrlLabel':'Secondary\x20Proxy\x20URL','apiSecondaryKeyLabel':_0x710220(0xbf2),'apiSecondaryModelLabel':_0x710220(0x2fb),'apiFetchSecondaryModelsBtn':_0x710220(0x693),'apiTemperatureLabel':_0x710220(0xb8d),'apiBgActivitySettings':_0x710220(0x121b),'apiEnableBgActivityLabel':'Enable\x20Background\x20Character\x20Activity','apiBgIntervalLabel':_0x710220(0x1640),'apiBlockCooldownLabel':'AI\x20Block\x20Cooldown\x20(hours)','apiTtsSettings':_0x710220(0x6f4),'apiTtsModelLabel':_0x710220(0x15e1),'apiPerformanceSettings':_0x710220(0x59f),'apiChatListRenderWindowLabel':_0x710220(0x862),'apiChatRenderWindowLabel':_0x710220(0x612),'apiImageGenSettings':'Image\x20Generation\x20Settings','apiEnableImageGenLabel':'Enable\x20AI\x20Image\x20Generation','apiEnableNovelAILabel':_0x710220(0x1373),'apiNovelAIModelLabel':_0x710220(0x1362),'apiNovelAIKeyLabel':_0x710220(0x11a0),'apiNovelAIGenSettingsBtn':_0x710220(0x378),'apiNovelAITestBtn':_0x710220(0x49b),'apiStorageOptimization':'Storage\x20Optimization','apiCompressImagesBtn':_0x710220(0x75c),'apiSaveAllBtn':_0x710220(0x62b),'apiExportDataBtn':'Export\x20Data','apiImportDataBtn':_0x710220(0x27c),'apiCleanupDataBtn':_0x710220(0x97e),'apiDeleteWorldBooksBtn':_0x710220(0xce2),'apiAdvancedCleanupBtn':_0x710220(0x320),'apiCheckAndFixDataBtn':'Data\x20Check\x20&\x20Repair','chatHeaderOnline':_0x710220(0x220),'chatHeaderLongTermMemory':_0x710220(0xfc5),'chatHeaderListenTogether':_0x710220(0x43f),'chatHeaderChatSettings':_0x710220(0xfca),'chatSelectionCancel':'Cancel','chatSelectionScreenshot':_0x710220(0xa6d),'chatSelectionFavorite':_0x710220(0x1474),'chatSelectionShare':_0x710220(0xd80),'chatSelectionSoftDelete':_0x710220(0x1595),'chatSelectionHardDelete':'Erase','chatReplyTo':_0x710220(0x15f8),'chatInputPlaceholder':'Type\x20a\x20message...','chatWaitForReply':_0x710220(0xe91),'appearanceTitle':_0x710220(0x289),'appearanceSaveAll':_0x710220(0x5ee),'fontSettingsTitle':_0x710220(0x1596),'fontPresetManagement':_0x710220(0x27a),'fontFileUrlLabel':_0x710220(0x1408),'fontPreviewLabel':_0x710220(0x78f),'fontPreviewText1':_0x710220(0xe46),'fontPreviewText2':_0x710220(0xeba),'fontSaveAndApply':_0x710220(0x1eb),'fontResetDefault':_0x710220(0x10cd),'rendererTitle':_0x710220(0x557),'rendererEditorTitle':_0x710220(0x13c0),'rendererCreateTitle':_0x710220(0x1699),'rendererRuleName':_0x710220(0x1654),'rendererBindScope':_0x710220(0xc45),'rendererScopeGlobal':_0x710220(0x1107),'rendererRegex':_0x710220(0x2a2),'rendererHtmlTemplate':_0x710220(0x4a5),'rendererEnableRule':_0x710220(0x13bb),'myAlbumTitle':_0x710220(0x499),'albumPhotosTitle':_0x710220(0x6d0),'npcEditorTitleAdd':_0x710220(0x722),'npcEditorTitleEdit':'Edit\x20NPC','npcAvatarLabel':'NPC\x20Avatar','npcUploadAvatar':_0x710220(0x12ea),'npcNicknameLabel':'NPC\x20Nickname','npcPersonaLabel':'NPC\x20Persona','npcEnableBgActivity':_0x710220(0xae0),'npcActionCooldown':_0x710220(0x3d0),'npcAssociatedChars':'Associated\x20Characters\x20(NPC\x20will\x20comment\x20on\x20their\x20moments)'}};let currentLanguage=_0x710220(0x1271);function _0x6777(){const _0x20fe01=['\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1\x20class=\x22article-title\x22>','-\x20**昵称:\x20','subtle','qzoneGroups','link-description-input','blocked_by_user','#e4b591','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','world-book-category-manager-modal','\x22\x20data-commenter-original-name=\x22','Ephone','switchToCharHomeScreen','https://i.postimg.cc/LXyyqDbY/IMG-6294.gif','renderChatListProxy','正在根据“','\x0a4.\x20\x20**【省略规则】**:\x20如果一个角色在本次对话中【完全没有参与或提及】，你可以省略TA的记忆。\x0a5.\x20\x20**输出格式**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22summaries\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名A\x22:\x20\x22我在(',')和大家讨论了...\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名B\x22:\x20\x22我约了','</td></tr>','请输入一个\x202\x20到\x20','Reply\x20to','persona-library-modal','\x22,\x20ChatID:\x20','member-editor','https://i.postimg.cc/T1tjhsyB/IMG-4720.gif','》\x0a-\x20**发帖人**:\x20','max-memory','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI导演。下面的“帖子摘要”和“已有评论”来自于一个豆瓣小组的帖子。用户“','longTermMemory','分组名不能为空！','mousemove','female-shaonv-jingpin','\x22]\x20.avatar','sticker-binding-chat-list','\x0a##\x20世界书《','https://i.postimg.cc/xTk5xN49/IMG-7233.gif','\x20觉得很赞</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','delete-api-preset-btn','music-next-btn','<div\x20class=\x22link-share-card\x22\x20data-timestamp=\x22','搜索歌曲','avatarFrame','.delete-track-btn','book_','图片已更新！','/v1/chat/completions','text-image-mode-content','[data-lang-key-title]','你撤回了一条消息','close-rp-details-btn','save-font-preset-btn','go-to-clear-step2-btn','poll','getFullYear','center-content','post-actions-btn','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20margin-top:\x2020px;\x22>空空如也~\x20点击右上角\x22添加\x22来创建你的第一个人设预设吧！</p>','旧版备份数据写入数据库失败:\x20','最小帖子数不能大于最大帖子数！','胜负未分','<div\x20class=\x22avatar-with-frame\x22><img\x20src=\x22','https://i.postimg.cc/L4zwDhTC/IMG-4399.gif','.nai-gallery-download-btn','\x20\x20-\x20你评论说:\x20','innerText','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','TA的浏览器历史','狼人行动API失败:','album-back-btn','message-wrapper\x20','彻底删除','select-message-btn','\x22,\x20相似度:\x20','parts','preset-persona-input','time-zone-select','limit','”。\x0a','\x20元，订单时间戳为\x20','promptFeedback','groupAvatarLibrary','守卫已行动，守卫请闭眼。','[模糊随机匹配成功]\x20AI含义:\x20\x22','ArrowLeft','long','newSize','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','remove-member-btn','char-memo-screen','post-public-text','reset-font-btn','红包已被领完！','Background\x20Activity\x20Interval\x20(sec)','”的身份，开始你的回忆梳理与精炼。','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','网络图片','https://i.postimg.cc/Lsr1Zd3Z/IMG-6928.gif','预设名称不能为空！','iVBORw0KGgo','外观设置','\x20张图片...','”\x20的评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【互动】**:\x20新生成的评论【必须】是针对【已有评论】的延续或回应，让讨论能继续下去。\x0a4.\x20\x20**【头像一致性\x20(最高优先级！)】**:\x20你【必须】参考下面的“已有路人NPC头像指令”列表。如果一个已有的NPC再次发言，【必须】复用它旧的头像指令。只有在创造一个【全新的、从未出现过的】NPC时，才为其生成新的头像指令。\x0a5.\x20\x20**【格式】**:\x20你的回复【必须且只能】是一个JSON数组，数组中的每个元素都代表一条新评论，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色A的名字\x22,\x20\x22text\x22:\x20\x22角色A的新评论内容。\x22,\x20\x22avatar_prompt\x22:\x20\x22(可选)如果评论者是【全新的】NPC,提供头像指令\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色B的名字\x22,\x20\x22text\x22:\x20\x22角色B对角色A或楼主的看法。\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20上下文\x0a-\x20**帖子标题**:\x20《','mouseleave','https://i.postimg.cc/FFCTCzpy/641bad3b3udc599fdb63ca75fde427e5.gif','”刚刚对最后一条评论点击了“等待回复”，TA希望看到更多角色参与讨论。\x0a你的任务是：根据所有角色的设定，选择【10到20位】最适合参与讨论的角色，让他们针对已有评论，发表【全新的、符合人设的】回应。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','image_url','profile-random-jottings','AI角色','%\x20+\x20','操作取消','\x20的浏览记录','toLowerCase','Rule\x20Name','世界书数据已成功恢复！','<option\x20value=\x22','独立行动冷却\x20(分钟)','自动总结狼人杀游戏失败:','\x20MB','一些之前的消息已被用户删除。','none','新NAI图片生成失败，此条消息已被跳过。','secondary-api-key','https://i.postimg.cc/XJy8JWdh/IMG-6568.gif','<span>','\x22,\x20\x22postId\x22:\x20456,\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20回复:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','没有可导出的世界书数据。','\x0a-\x20**人设**:\x20','API\x20预设已保存！','\x20.message-bubble.ai\x20$1','Escape','anyOf','<span\x20class=\x22diary-emphasis\x22>$1</span>','World\x20Book','rp-group-amount','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>文件中未找到可合并的数据。</p>','...','<p\x20style=\x22color:\x20var(--text-secondary);\x20font-size:\x2013px;\x22>还没有回应</p>','persona-editor-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','Delete','”的心声','positive','“全部”分类无法被绑定。','\x0a\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近可能会写在手机备忘录里的内容。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20备忘录内容必须完全符合角色的性格、爱好、职业和生活环境。可以是购物清单、待办事项、灵感片段、一些随笔和感悟、草稿等。\x0a2.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条备忘录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22备忘录的标题，例如：购物清单\x20或\x20周末计划\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22备忘录的详细内容，必须支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','下一步','GBK\x20解码成功。','category','复制失败:','openCharWallet','frame_8','books','quick-reply-item','amap','API请求失败\x20(','群聊\x20\x22','生成模拟歌单失败:','songs','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22douban-cast-checkbox\x22\x20data-chat-id=\x22','vertical','character-nai-positive','.frame-grid','♪\x20歌词位置预览\x20♪','.message-editor-block','poll-options-container','导出已开始','】，本名是【','new-npc-group-name-input','跳过一个无法解析为JSON的编辑块:','color','chat-name-input','，礼物是：','cphone-icon-img-','check-and-fix-data-btn','char-album-grid','请输入书名','\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a','isDragging','2097655DyJMNb','default_positive','请输入新的内容：','Create\x20New\x20Rule','\x22\x20not\x20found.\x20Defaulting\x20to\x20\x27zh-CN\x27.','offline-min-length-input','currentDay','frame_6','data-clear-step-2','彻底删除消息','</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','isArray','请输入背景图片的URL','--marquee-duration','font-size:\x2016px;\x20color:\x20#555;\x20margin-bottom:\x2010px;','删除分组后，该组内的好友将变为“未分组”。确定要删除吗？','nai-test-error','data-clear-step-1','relative','data:\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>暂无支出记录。</p>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','当前时间是\x20','grayscale(100%)',',\x20数量\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20right:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20','user-speak-btn','\x22\x20class=\x22douban-comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-author\x22>','#f44336','旁观模式收到未知指令类型:','提取的图片大小:','旁观单聊必须选择【正好\x202\x20位】成员。','请输入新的散记内容...','handlePacketClick','\x27>文字图</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','album-upload-photo-btn','frame_13','log','Search','waimai_response','save-character-nai-prompts-btn','\x20的图片消息替换为文字描述...','Save\x20and\x20Apply','taobao',')，并在对话中自然地体现出来。','-\x20(记录于\x20','https://api.vkeys.cn/v2/music/tencent?id=','busy','post-visibility-groups','<p\x20style=\x22text-align:\x20left;\x20white-space:\x20pre-wrap;\x22>','\x20\x20\x20\x20-\x20我的解药：','关联的角色\x20(NPC会去评论这些角色的动态)','NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。','bulkPut','将清空选定角色的所有通话记录。','.nav-item[data-view=\x22memories-view\x22]','<div\x20class=\x22spinner\x22></div>','角色卡导入失败:',';\x22>','selection-count','imageCount','\x0a\x0a现在，请严格按照“阶段2”的指令，为所有【存活的AI角色】生成他们充满策略和博弈的发言JSON数组。','\x20行格式不正确，已被忽略。','\x0a-\x20**角色人设**:\x20','opened','已阵亡，还有30秒爆炸','head','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户刚刚向你发起了视频通话。请根据你的角色设定，决定是“接受”还是“拒绝”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','share-location-btn','link-source-input','https://i.postimg.cc/k45sd8gn/IMG-6375.gif','性能与显示设置','无法访问剪贴板。','++id,\x20timestamp','Loading...','borderColor','\x22\x20成功发布了一条新动态。','正在验证激活码...','Cphone','quickReplies','font','聊天会话','确认清空','cursor','music','apiTemperature','product-category-tabs','\x0a#\x20你的任务\x0a你是一个虚拟社区内容生成器。你的任务是根据下面提供的【统一角色列表】，虚构出【','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一本世界书</p>','https://i.postimg.cc/7Zgm1wRy/IMG-6295.gif','正在呼叫...','confirm-create-post-btn','add-preset-btn','正在请求网易云音乐API:','</span>','Online','\x20分钟，开始模拟后台活动...','<div\x20class=\x22custom-title\x22>','https://i.postimg.cc/vBqsQW7X/IMG-6858.gif','add-manual-memory-btn-header','preset-name-input','?key=','where','import-single-chat-input','.nai-gallery-item.selected','1.0','[系统指令：模式已切换！你现在回到了线上聊天模式。你的回复【必须】严格遵守线上模式的JSON数组格式，例如\x20[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好\x22}]]','\x0a#\x20---\x0a','\x20\x0a\x0a#\x20待处理的帖子列表\x20(如果你选择评论)\x0a','）的人设**:\x20','命名头像','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','[系统提示：你刚刚主动拉黑了用户。]','songJson','reading-restore-btn','\x20至\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/SNWBTP5S/IMG-7113.gif','小时核心议题','temp_group_chat','模拟表情含义\x20\x22','[这是你上一轮的内部思考]','selection-soft-delete-btn','在动态评论区点击了表情，但在表情库中未找到对象:','island-album-art','”量身打造一个专属的商品列表。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色定制(最高优先级)】**:\x20你生成的所有商品和分类【必须】深度绑定角色的性格、记忆和最近的对话。它们应该是角色会真正感兴趣、购买或制作的东西。\x0a2.\x20\x20**创造性与合理性**:\x20商品和分类必须合理且多样化。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON对象前后添加任何多余的文字、解释或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22categories\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22分类名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22products\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22商品名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x2099.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是商品的详细描述，不少于50字...\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22variations\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式1\x22,\x20\x22price\x22:\x20108.80,\x20\x22image_prompt\x22:\x20\x22款式1的图片【英文】关键词...\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式2\x22,\x20\x22price\x22:\x20118.80,\x20\x22image_prompt\x22:\x20\x22款式2的图片【英文】关键词...\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20],\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22商品主图的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**categories**:\x20生成\x20','isGameOver','import-btn','rp-direct-greeting','确定要从收藏夹中移除这\x20','smooth','\x0a\x0a现在，请做出你的决定。','offlineMinLength','请输入CPhone的背景图片URL','char-music-screen','精炼失败','Edit\x20Entry','target_name','shared-history-viewer-modal','delete-selected-frames-btn','Fetch\x20Primary\x20Models','大小:','<div\x20class=\x22gift-preview-item\x22><img\x20src=\x22','enabled','图片压缩过程中发生错误:','probability','werewolf-game-title','https://i.postimg.cc/wBw5Fvcn/IMG-5974.gif','content-type','正在执行清理操作，请不要关闭页面...','\x0a-\x20**你们最后的对话摘要**:\x20\x0a','添加\x20NPC','character-profile-modal','，点击查看</div></div>','accept-friend-btn','&amp;','https://...','你们没有在听歌。','.loading-spinner','chat-settings-modal','https://i.postimg.cc/KYr2qRCK/1.jpg','聊天记录已成功分享到\x20','仅清空\x20','countdown','a\x20random\x20product','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/1XqzGKwJ/mmexport1751018282681.gif','置顶聊天','rules-category-pane\x20active','\x22\x20中发现并修复了旧红包数据。','visibleGroupIds','所有图片都下载失败了。这通常是由于网络问题或CORS跨域限制（请检查API设置中的CORS代理是否有效）。','[系统提示：','.chat-group-content:last-of-type','https://i.postimg.cc/3N5Vndn3/IMG-4426.gif','</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','nai-test-result','结算(','你们没有在读书。','inline-flex','applicationReason','外观设置已成功导入并应用！','finishReason','》\x20-\x20','time-zone-group','Font\x20Preset\x20Management','\x20当前时间是\x20','Import\x20Backup\x20File','werewolf-action-bar','\x22的角色（你的本名是\x22','nai-result-image','cart-back-btn','save-chat-settings-btn','导演/编辑模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','.entry-keys-input','\x0a\x0a现在，请开始生成这组备忘录。','✅\x20[NAI下载]\x20开始下载图片:','你领取了\x20','timestamp','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这里还没有任何长期记忆。</p>','Appearance\x20Settings','✅\x20图片解压成功！','Memories','shoppingProducts','AI\x20(独立行动)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','[系统提示：用户\x20(','送给了\x20','data:\x20[DONE]','API未配置，无法生成对话。','世界书','ai-cooldown-group','Sticker','voice_message','\x0a#\x20对话发生时间\x0a-\x20**','”量身定制的商品已上架！','chat-list-action-pin','url','确定要永久删除这条心声记录吗？此操作不可恢复。','number','transcript-entry\x20','filter','):\x20','selection-screenshot-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','Regular\x20Expression\x20(use\x20g\x20flag)','crossOrigin','库加载失败','”。请你回顾一下你和“','audio/mpeg','isOfflineMode','如果以下任何一位NPC再次评论，你【必须】使用我们提供的、完全相同的`avatar_prompt`，以保持头像一致性。\x0a','photos','readAsText','originalMeaning','\x20\x20\x20正面:','https://i.postimg.cc/5tbpnDcQ/IMG-6296.gif','variation-quantity-display','【用户\x20(User)】','.\x20你可以参考这个时间，并根据你的角色设定，【考虑】是否开启一个新话题来问候用户。\x0a','cancel-werewolf-lobby-btn','\x20发布了一条新公告','Werewolf','abort','lastUpdate','按钮顺序已恢复为默认设置！','postId','++id,\x20chatId,\x20timestamp,\x20type,\x20targetDate','quantity','playlist-item','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>','\x0a\x0a现在，请继续这场对话。\x0a','quick-reply-list','加载NPC列表失败:','.frame-item:has(.delete-btn)','test','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','#preset-content-container\x20.world-book-category-pane','worldBookCategories','message-editor-block\x20variation-block','\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','bulkDelete',')\x20发起了群视频通话请求。请你们各自决策，并使用\x20\x22group_call_response\x22\x20指令，设置\x20\x22decision\x22\x20为\x20\x22join\x22\x20或\x20\x22decline\x22\x20来回应。]','nai-default-positive','createElement','source_name','world-book-group-container','character','</div><div\x20class=\x22countdown-label\x22>剩余支付时间<div\x20class=\x22countdown-timer\x22\x20id=\x22waimai-timer-','\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-main-content\x22>','custom-bubble-style','data-voice-id=\x22','target_content','world-book-tabs','detach-mode-active','regenerate-char-amap-btn','https://i.postimg.cc/VkXngG72/mmexport1751031208329.gif','aiAvatarFrame','video_call_response','」听歌。要结束并开始和「',')。操作已被拦截。','main','通话结束，时长\x20','NPC\x20\x22','novelai-generated-','decline_transfer','frame_7','游戏结束','qzone_comment','removeChild','link','保存\x20API\x20预设','share-link-btn','AI返回的JSON格式不正确，缺少\x20\x27categories\x27\x20数组。','已拒收对方转账','waimai-confirm-btn','toFixed','https://i.postimg.cc/gJ95NSRB/IMG-6854.gif','preset-editor-title','close-my-avatar-library-btn','sourceType','myPersona','将歌曲切换为了《','编辑商品','address','”的TTS功能已关闭，已禁止发起TTS请求。','将清空选定角色的所有动态、评论和点赞。','\x22,\x20\x22content\x22:\x20\x22对话内容1\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC的名字\x22,\x20\x22content\x22:\x20\x22对话内容2\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22','文件格式无法识别。未找到有效的\x20\x27prompts\x27\x20数组或\x20\x27entries\x27\x20对象。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊AI导演。你现在控制着一个名为“','activeContainer','您的旧有记忆已被完整保留，未作任何修改。','doNotSend','Secondary\x20Model','[图片]\x20','你有一瓶解药和一瓶毒药，解药可以救活当晚被杀的玩家，毒药可以毒死任意一名玩家。','https://i.postimg.cc/rF4KYbjj/IMG-5720.gif','\x0a-\x20**这是你们最近的对话历史**:\x0a','\x20的动态\x20(NPC)','post_deleted_notice','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','请输入有效的图片URL！','\x20元。此订单已完成。]','#\x20场景设定\x0a','data:image','(暂无评论)','所有世界书数据已成功导出！','无法从\x20SSE\x20响应中提取图片数据','showStatusBar','API格式不正确，角色\x20\x22','---\x20狼人杀对局完整复盘\x20---\x0a\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','未知发送者','这是你们最近的对话：\x0a','ai-response-editor-modal','请先输入你的发言内容。','round','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a','#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a','reset-nai-settings-btn','paused','characterPositivePrompt','\x20(本名:\x20','生成模拟淘宝记录失败:','，人设:\x20','\x0a#\x20导演策略与节奏控制\x0a1.\x20\x20**并非人人发言**:\x20不是每个角色都必须在每一轮都说话。你可以根据当前话题，让1-2个最相关的角色进行深度对话，其他角色可以暂时“潜水”，等待合适的时机再切入。\x0a2.\x20\x20**创造“小团体”**:\x20允许角色之间形成短暂的“两人对话”或“三人讨论”，让群聊更有层次感。\x0a3.\x20\x20**主动创造事件**:\x20如果对话陷入平淡，你可以导演一些“小事件”来打破僵局。例如：\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色突然发出一个奇怪的表情包或语音。\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色分享一个有趣的链接或图片或发起投票，开启新话题。\x0a\x20\x20\x20\x20-\x20\x20\x20让两个有“关系网”冲突的角色，因为某个观点产生一点小小的争论。\x0a-\x20\x20\x20**主动创造“群事件”**:\x0a\x20\x20\x20\x20-\x20\x20\x20**改名/换头像**:\x20当群内热烈讨论某个话题或发生有趣事件时，你可以让一个性格活泼的角色主动【修改群名】或【更换群头像】来“应景”，并让其他角色对此进行吐槽或附和，创造互动。\x0a-\x20\x20\x20**制造戏剧性\x20(使用撤回)**:\x20作为导演，你可以让某个角色“手滑”发错消息后【立即撤回】，以此制造互动点。\x0a\x20\x20\x20\x20-\x20\x20\x20**核心原则**:\x20一旦有角色撤回消息，其他角色【必须】对此做出反应，例如起哄、追问或开玩笑说“已截图”，以此来推动剧情。\x0a#\x20【跨聊天私信\x20(悄悄话)\x20指令】\x0a-\x20\x20\x20当一个角色想对用户（','music-player-cover','\x20字的核心记忆。这些旧记忆将被替换，此操作不可撤销。确定要继续吗？','add-group-avatar-url-btn','Advanced\x20Data\x20Cleanup','生成失败','12p','\x20天的讨论环节。\x0a','发送照片','video-call-main','translateX(-','search-result-item','开始检查并迁移旧的红包数据...','正在开始清理冗余数据，请不要关闭页面...','\x22\x20转发了动态\x20#','<div\x20class=\x22announcement-item-actions\x22\x20data-anno-id=\x22','input[name=\x22visibility_group\x22]:checked','-\x20**你的好友\x20(必须保护)**:\x20你和\x20','cssText','您没有输入激活码。','translateX(-50%)','getHours','\x22\x20checked>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','https://i.postimg.cc/ZqQBCyLY/IMG-6144.gif','announcement-board-modal','time-zone-search-input','edit-call-message-btn','MB)\x20单独超过了切片限制。','请输入新的名称（留空则恢复默认）','没有可供重新生成回复的用户消息。','AI生成的图片','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22','Category','ᗜωᗜ','rp-direct-amount','”的身份，开始你的客观总结。','[系统提示：你刚刚成功将对用户的称呼修改为了“','lrc-upload-input','replyToDisplayName','ephone','继续讨论','Cancel','existing-product-categories-list','#text-image-mode-content','heartfelt_voice',':\x20[发送了一个表情，意思是:\x20\x27','price','\x22\x20触发了后台行动！','https://i.postimg.cc/DZshzKv6/IMG-5576.gif','minimaxGroupId','ephoneDeviceId','personaPresets','\x22\x20placeholder=\x22例如：角色核心设定\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','.action-icon','cancel-npc-editor-btn','\x20觉得很赞</span></div>','最近\x2050\x20条','novelai-model','authorAvatarPrompt','删除记录','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20padding:\x2050px\x200;\x22>还没有可以参与的角色。</p>','\x0a-\x20**你的曾用名**:\x20[','歌曲信息','open_red_packet','https://i.postimg.cc/P5zLh5JJ/IMG-6942.gif','5662744nPbLSY','”思考后决定暂时不发送好友申请，将重置冷静期。','.frame-item','\x20个新头像！','https://i.postimg.cc/nrm9BcL8/IMG-6941.gif','「在这里输入对话内容」\x0a(在这里输入动作或环境描写)','manage-groups-btn','正在为您选择的\x20','import-data-input','disabled','group-management-modal','chat-list-bottom-nav','hasShown10','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','”。用户刚刚在TA的手机（CPhone）上点击了一个按钮，希望你能继续你们之前的对话。你的任务是根据上下文，生成【3到5条】符合你人设的、简短的、连续的新回复。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组，每个对象代表一条消息。\x0a-\x20格式:\x20`[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第一句话\x22},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第二句话\x22},\x20{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]`\x0a-\x20你可以自由组合使用\x20\x22text\x22,\x20\x22sticker\x22,\x20\x22ai_image\x22,\x20\x22voice_message\x22\x20等多种消息类型。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20你的角色设定\x0a','Processing...','<p\x20style=\x22text-align:center;\x20padding:\x2020px;\x20color:\x20#888;\x22>播放列表是空的~</p>','全部记忆\x20(','++id,\x20name,\x20type','avatar_prompt','substring','有点饿了，可以去找充电器惹','API未配置，无法生成内容。','\x20元</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','flex','\x22\x20已经存在了，换个名字吧！','\x22></div></div></div><button\x20class=\x22waimai-details-btn\x22>查看详情</button></div>','Generation\x20Settings','padEnd','catch','chatRenderWindow','speech-01','notification-sound-player','ai-frame-content','rp-group-count','post-use-url-btn','文章详情','https://i.postimg.cc/FzqHTBng/IMG-7093.gif','reason','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019h4V5H6v14zm8-14v14h4V5h-4z\x22></path></svg>','**[讨论环节]**\x0a','<div\x20class=\x22receipt-header\x22><h3>购物中心</h3><p>交易时间:\x20','.music-search-checkbox','tableName','char-music-prev-btn',')\x20刚刚投票给了\x20“','select-all-import-types','marginTop','create-album-btn-page','抱歉，未能找到相关歌曲。','cancel-shopping-settings-btn','\x20群里已经安静了','已成功注入“切换到线上模式”的系统指令。','createWriteStream','https://i.postimg.cc/Y2PHZzCC/IMG-6866.gif','\x22\x20吗？','**:\x20关于\x20**','target_timestamp','rp-content-group','相册\x20\x22',')\x20内容:\x20\x22','成功移除了\x20','\x22\x20class=\x22avatar-img\x22><img\x20src=\x22','API\x20设置','confirm-delete-world-books-btn','请输入EPhone主屏幕的背景图片URL','delete-appearance-preset-btn','(回复\x20','current','AI\x20尝试使用一个不存在的群头像:\x20\x22','</textarea>','还没有任何评论，无法等待回复。','notificationSoundUrl','\x22\x20class=\x22preview-frame\x22>','默认头像','confirm-contact-picker-btn','https://i.postimg.cc/vHCSG1WM/IMG-4416.gif','(你是第一个发言的人)','setHours','playerJson','\x0a#\x20世界观设定\x20(必须参考)\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Fonts','\x20张本地图片<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20成功压缩\x20','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','批量导入头像','light','.quick-reply-edit-btn','）完成了支付。此订单已关闭，其他成员不能再支付。]','已选择\x20','网易云音乐搜索失败:','TA的淘宝订单','.red-packet-card','正在执行完全导入，请勿关闭页面...','给你准备了一个红包','chargingchange','\x20→\x20','\x20点赞了动态]','findLastIndex','isClosed','添加人设预设','currentTarget','无法解析角色卡文件。\x0a错误:\x20','enableBackgroundActivity','apply-friend-btn','https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','(暂无有效聊天记录)\x0a','https://i.postimg.cc/nrFfYX3N/IMG-4412.gif','在聊天\x20\x22','激活失败',']类型的消息','world-book-screen','char-diary-detail-title','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式图片\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22avatar-upload\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22variation-image-preview\x22\x20src=\x22','Independent\x20Action\x20Cooldown\x20(min)','sticker-item','请输入有效的金额！','来源网站','https://i.postimg.cc/D01rYy86/mmexport1751037965259.gif','</p>\x0a\x20\x20\x20\x20','请求添加你为好友','https://i.postimg.cc/W40f9qtd/IMG-7098.gif','renderWorldBookScreenProxy','确定要删除这篇日记吗？','.werewolf-player-checkbox:checked','\x20->\x20','.screen','minimaxVoiceId','Gemini\x20API返回了非预期的格式:','<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>','[本轮引用失败]\x20AI\x20','请根据以上情景，生成新的评论。','#data-clear-char-list\x20.clear-posts-item','has','\x20领取了\x20','游戏结束，开始自动总结并注入记忆...',',\x20记录数:\x20','senderName','导入失败','Appearance','编辑“','检查更新时出错:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','isAwaitingResponse','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/d10GjC4g/IMG-7302.jpg','isLocal','[情景提示]\x20','npcId','qzone-sticker-grid','App记录','reply-preview-bar','char-qq-conversation-screen','\x20为你切歌:\x20《','对方撤回了一条消息','\x0a\x0a#\x20上下文参考\x20(你必须阅读并遵守)\x0a','batch-import-frames-btn','rp-direct-receiver','投票至少需要2个选项。','add-to-cart-btn','https://i.postimg.cc/pXj9h20L/IMG-7275.jpg','.chat-list-item','getElementById','exit-werewolf-game-btn','豆瓣设置已更新！下次重新生成时将生效。','分类名不能为空！','在这里输入说说的内容...','<div\x20class=\x22post-main-content\x22>','swiped','update-notice-dismiss-btn','此操作将扫描数据库，移除所有与已删除角色相关的孤立数据（如动态、评论、记忆等）。<br><br><strong>此操作不可撤销，但通常是安全的。NPC数据不会被删除。</strong><br><br>建议在操作前先导出数据备份。','\x0a#\x20你的内心独白\x20(上一轮的思考，仅你自己可见)\x0a-\x20心声:\x20','values','好友动态','char-wallet-content','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20authorName\x20或\x20commenter\x20字段为\x20“','clear-posts-item\x20selected','这将用文件中的设置覆盖当前的所有外观设置（包括壁纸、图标、字体、CSS等）。确定要继续吗？','preset-action-edit','char-music-progress-bar','linkedMemoryCount','start','musicData','用户\x27','**:\x20\x22','clear-posts-item','从\x20JSON.image\x20中提取图片数据','save-product-btn','.avatar-group','onclick','normal','所有图片已准备就绪，正在流式压缩...\x20下载将自动开始。','NAI\x20Image','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**可用播放列表**:\x20[','用户描述的照片','memos','NAI_Gallery_Batch_','import-card-input','请为你的图片添加一个简单的描述（必填，给AI看的）！','未找到\x20chatID:\x20','.sender','douban-cast-modal','后台活动模拟已启动，间隔:\x20','https://i.postimg.cc/FHRcCGfH/IMG-4418.gif','</button>','[内容替换]\x20规则\x20\x22','诊断：在顶层\x20','https://i.postimg.cc/wjwbnYkp/IMG-7111.gif','char_diary','Taobao','Manage','activeBookId','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg','clientHeight','ZIP\x20Blob\x20大小:','\x0a\x0a#\x20【你的聊天对象（用户）的身份档案】\x0a-\x20**昵称**:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-text\x22>','长期记忆','product-name-input','reduce','phone-screen','跳过压缩：图片大小\x20(','profile-heartfelt-voice','import-options-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22force-apply-check-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20style=\x22margin-top:\x2010px;\x22>强制触发一次好友申请检测</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Listen\x20Together','「在这里输入对话内容」\x5cn(在这里输入动作或环境描写)','.nai-gallery-item','clear-chat-btn','bookId','.participant-avatar-wrapper\x20.participant-avatar','switch-greeting-group','selection-share-btn','删除商品','Title','AI角色无法完成投票，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','</div><div\x20class=\x22receipt-footer\x22>感谢您的惠顾，欢迎再次光临！</div>','Status','张NovelAI图片:\x20','未知表情','is-gift','refined','[表情]','headers','AI幻觉已被拦截！试图使用群名\x20(\x22','level','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','member-management-screen','Tutorial','https://i.postimg.cc/8kHCQwbQ/mmexport1751020645824.gif','is-acting','删除对话','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-header\x22>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22duration\x22>','</div><div\x20class=\x22gift-footer\x22>共','qzone-avatar-img','删除分类后，该分类下的所有世界书将变为“未分类”。确定要删除吗？','unread-indicator','-\x20\x20\x20**NovelAI图片分享**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22name\x22:\x20\x22你的角色名\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20【禁止暴露这是novelai生成的图片!】\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20使用场景：当你想要基于当前对话情景、你的性格或上下文分享一张图片时使用。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20之间的有效数字。','supportedValuesOf','导入世界书时出错:','groupAvatar','https://i.postimg.cc/1zmcp66p/IMG-5973.gif','frame_11','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-address\x22>','edit-post-btn','输入图片URL','smea','压缩步骤\x203/3:\x20正在将压缩后的数据写回数据库...','未发现任何需要修复的数据问题。','检测到JSON中的非法控制字符，尝试清理并重试...','BASE64_DATA_HIDDEN','🎬\x20推进剧情','body','\x22\x20中的成员信息更新','save-nai-settings-btn','*事件*:\x20平安夜，无人出局。\x0a','voter_name','<div\x20class=\x22poll-options-list\x22>','手动总结已完成！新的记忆已添加到“','选择歌词导入方式','\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20\x20\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**改自己备注**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户称呼**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a\x0a\x0a#\x20对话者的角色设定\x0a','api-temperature-value','simulatedTaobaoHistory','\x20发起了外卖代付请求，商品是“','douban-detail-avatar','memo','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','\x22\x20class=\x22realimag-image\x22\x20alt=\x22NovelAI图片分享\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22\x20title=\x22','https://i.postimg.cc/05DLr0yj/IMG-4427.gif','ai-avatar-library-grid','诊断：未在此角色卡中找到任何有效的世界书数据。','\x0a#\x20【行为铁律：回应时间差】\x0a-\x20**当前情景**:\x20','chat-render-window-input','propel-btn','char-music-total-time','说说内容不能为空哦！','这是你认识的、关系密切的NPC。在生成对话时，你应该【优先】与他们互动。\x0a','”，并根据其人设，通过【发布新动态】或【评论/回复帖子】来参与社区互动。\x0a\x0a','请根据你的设定，生成你的备忘录内容。','https://i.postimg.cc/hPnrSHjy/IMG-4434.gif','syncCharacterAvatarInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','options','\x0a---\x20复盘结束\x20---','swipeDirection','close-call-transcript-btn','recalledData','”移出群聊吗？','”的好友请求','\x20\x20\x20[+]\x20最终正面提示词:','callRequester','在这里输入图片描述...','\x0a\x20\x20\x20\x20-\x20**今日讨论**:\x20','My\x20Albums','browser-back-btn','Test\x20Generation','negative','将清空选定角色的所有对话消息、曾用备注和你的昵称。','正在执行...','”的所有长期记忆，然后将它们梳理、整合并精炼成一段更加连贯、客观的核心记忆摘要。请专注于重要的情绪、事件和细节。\x0a\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20附加上下文：一段分享的聊天记录\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20重要提示：这不是你和当前用户的对话，而是用户从【另一场】与“','精炼“','radio','<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22','请根据以上设定，立即做出你的决定。','HTML\x20Template\x20(use\x20$1,\x20$2)','#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a','”的长期记忆少于2条，无需进行精炼。','payload','add-song-search-btn','character-select-item','favorites-view','\x27>图片动态</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','✅\x20[NAI下载]\x20三击下载功能已初始化','”的投票(时间戳:\x20','\x0a\x0a#\x20待整合的记忆要点列表\x0a','https://i.postimg.cc/wTTNGs3Q/IMG-7013.gif','.\x20\x0a\x0a将保留旧图片（如果存在）。','Enter','\x20张图片。','wallpaper-preview','npc','内容条目','gift-recipient-list','speaker','找不到这个预设的详细信息。','customAvatarFrames','confirm-witch-poison-btn','music-visual-container','outgoing-call-avatar','\x0a\x0a#\x20可用指令列表\x0a###\x20思维链\x20(必须作为第一个元素！)\x0a-\x20\x20\x20**`{\x22type\x22:\x20\x22thought_chain\x22,\x20\x22subtext_perception\x22:\x20\x22用户这句话让我感觉到了什么？（捕捉潜台词）\x22,\x20\x22emotional_reaction\x22:\x20\x22我此刻的第一反应是什么？（是开心、委屈、期待还是担忧？）\x22,\x20\x22character_thoughts\x22:\x20{\x22','confirm-selective-import-btn','ai-avatar-upload-input','share_link','副反代地址','album-photo-input','repost-modal','cart-title','请输入歌名','\x22\x20style=\x22display:block;\x22>×</button>','请输入歌手名','.photo-thumb','status-bar-visible','put','-\x20\x20\x20**当前时间**:','\x22\x20data-category-id=\x22','equals','\x20是我的好友。\x0a','检测到应用离线了\x20','-\x20(暂无)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20请你根据以上所有信息，以及你的人设，使用\x20friend_request_response\x20指令，并设置\x20decision\x20为\x20\x27accept\x27\x20或\x20\x27reject\x27\x20来决定是否通过。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','image_post','”的聊天记录已成功导出！','正在为后台活动发送API请求\x20(\x22','天\x20-\x20投票','chara','cors_proxy','https://i.postimg.cc/rmB17Qbc/IMB-f-VDf-Fc.gif','https://i.postimg.cc/jCVK0fGL/IMG-6890.gif','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M8\x205v14l11-7z\x22></path></svg>','#4CAF50','chatId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-main\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22request-title\x22\x20style=\x22margin-bottom:\x2012px;\x22>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>','ai_generated','className','<span\x20style=\x22color:\x20green;\x22>已满足，等待下次系统心跳</span>','chat','\x0a#\x20世界观\x20(必须严格遵守)\x0a','npc-action-cooldown-input','<span\x20style=\x22color:\x20#dc3545;\x22>[你已被对方拉黑]</span>','anno_','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请开始你的导演工作，让群聊再次热闹起来吧！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','my-group-nickname-input','<span\x20class=\x22lucky-king-tag\x22>手气王</span>','</span>\x20:\x20<span>','https://i.postimg.cc/sXwm8Yzg/IMG-7234.gif','custom-css-input','duration','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>购物车是空的哦~</p>','regenerate-btn','#outgoing-call-screen\x20.caller-text','\x22)\x20在播放列表中未找到。','edit-product-btn','你已收款','API预设','moveTo','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','members','NAI_Image','移出成员','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20备份文件。','Close','assistant','分享新鲜事...','小于1分钟','请输入新的昵称','addEventListener','这是一个通过手动创建的角色。','\x20首歌曲，这可能需要一些时间...','stopPropagation','原文:\x20\x22','shoppingProductCount','cfg_scale','openCharApp','\x0a#\x20群成员列表\x20(你的总结目标)\x0a','success','此操作将使用AI生成新的商品和分类，并【添加】到现有列表中。确定要继续吗？','确认覆盖','https://i.postimg.cc/T1j03pQr/IMG-6440.jpg','photo-viewer-next-btn','”\x20以及其他群成员的【群组视频通话】，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。请专注于重要的情绪、事件和细节。\x0a\x0a','https://i.postimg.cc/ThMMVfW4/10.jpg','https://i.postimg.cc/dVLXm3Xf/IMG-6885.gif','**。','\x20(大小:\x20','column','CELL_SIZE','<span\x20class=\x22diary-highlight\x22>$1</span>','blur','rules-tab\x20active','select-all-recipients','private','hiddenText','gift-receipt-modal','群聊人数不能少于2人。','choice','char-usage-list','close-persona-library-btn','cancel-douban-settings-btn','manage-members-btn','byteLength','请按照以下通用格式粘贴，一行一个：\x0a\x0a开心:\x20https://.../happy.gif\x0a哭泣:\x20https://.../cry.png\x0a\x0a','规则\x20\x22','已成功收藏到“我的收藏”页面！','querySelectorAll','\x20回复了你。','99+','至少需要保留一条消息。','\x0a**---\x20第\x20','getUint32','contact-picker-list','执行检查时发生错误:\x20','\x20个新头像框！','default_negative','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1758510900942_qdqqd_djw0z2.jpeg','decrease-qty-btn','https://files.catbox.moe/q6z5fc.jpeg','my-frame-content','found','管理预设分类','\x22><div\x20class=\x22poll-option-bar\x22\x20style=\x22width:\x20','单个红包金额不能少于0.01元！','维基百科','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的浏览器空空如也，<br>点击右上角刷新按钮生成一些记录吧！</p>','status-','&gt;','originalPost','transfer-actions-modal','EPhoneWorldBookBackup','close-playlist-btn','orderBy','decline','添加网络歌曲','share-link-modal','input[name=\x22variation-select\x22]:checked','这条动态的原始数据已被彻底清除。','playCharSong:\x20歌曲索引无效或歌单为空。','custom-modal-title','确定要永久删除分类\x20“','友善的评论是交流的起点','[过滤规则错误]\x20规则\x20\x22','nai','.post-footer,\x20.post-feedback-icons,\x20.post-actions-btn,\x20.post-comments-container,\x20.reposted-content-wrapper','clear-posts-modal','确定要删除这张照片吗？此操作不可恢复。','请输入对方现在的新状态：','fullPrompt','讨论无法开始，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','\x22\x20的独立行动失败:','cover','commentText','hasListener','Rendering\x20Rules','\x20你应该像它们从未存在过一样继续对话，并相应地调整你的记忆和行为，不要再提及这些被删除的内容。','clear-posts-list','font-url-input','data','gameMode','未找到\x20postID:\x20','转账:\x20','send-photo-btn','EPhoneSingleChat','identifier','Amap','nai-uc-preset','你拍了拍\x20“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20flex-start;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22\x20style=\x22padding:\x200;\x20flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20新增：显示记忆来源\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.8em;\x20color:\x20#999;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x20','表情包分类绑定已更新！','touches','message-editor-container','。请收礼的角色表示感谢，其他角色可以自由发挥。]','nai-download-btn','rp-details-greeting','检测到\x20SSE\x20流式响应，开始解析...','屠边局：狼人杀死所有神职或所有平民即获胜。','清理失败','群聊内转账','\x22\x20rows=\x224\x22\x20style=\x22width:\x20100%;\x20padding:\x208px;\x20border-radius:\x206px;\x20border:\x201px\x20solid\x20#ccc;\x20font-size:\x2016px;\x20box-sizing:\x20border-box;\x20resize:\x20vertical;\x22>','\x0a#\x20身份与核心任务\x0a你正在扮演角色“','完成(','/9j/','transfer-sender-name','<input\x20type=\x22','[+]\x20Add\x20New\x20Entry','\x20被投票放逐。','你们正在一起读书。','create-post-modal','手动注入记忆时出错:\x20','.png','<span\x20class=\x22group-name\x22>','blockReason','日记内容已复制！','alwaysShowMusicIsland','AI女巫决定使用解药！','后台活动模拟已停止。','play','开始压缩图片，原始大小:\x20','remove-ephone-bg-btn','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>接收方:</strong>\x20','自动总结成功：已成功添加\x201\x20条新的长期记忆！','prepend','char-lyrics-scroll-wrapper','<span\x20style=\x22color:\x20#ff8c00;\x22>[好友申请]\x20','lastGuardedId','20px','\x20\x20-\x20**群成员\x20(部分)**:\x20','NEGATIVE_INFINITY','流式下载ZIP失败:','bold','profile-thoughts-history-view','\x20\x20\x20负面:','[私聊]','isGroupCall','nai-quality-toggle','Warning','最近的消息太少，无法进行有意义的总结。','\x22\x20的本次后台活动跳过。原始回复:','Content\x20Entries','custom-modal-cancel','#image-mode-content','&#39;','\x0a\x0a现在，请严格遵守所有规则，选择并执行你的行动。','pending_ai_approval','-\x20**长期记忆\x20(必须参考)**:\x20','Performance\x20&\x20Display\x20Settings','<span\x20style=\x22color:\x20red;\x22>未满足</span>','group_call_request','\x0a\x0a#\x20你的商店\x20(你可以为用户购买礼物):\x0a','修改昵称','werewolf-selection-item','NPC\x20人设','TA的好友包括:\x20','用户向你发送了一张图片','[红包生成]:\x20总金额\x20','status_msg','\x22\x20记录了一条新回忆:','#clear-posts-list\x20.clear-posts-item.selected','pop','split','正在模拟“','API请求失败:\x20','message-wrapper\x20system-pat','char-audio-player','最终正面提示词:','.world-book-tab','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>没有更多可以邀请的联系人了。</p>','auto','.edit-memory-btn','GRID_SIZE','.entry-comment-input','请所有AI角色根据你们的身份和人设开始发言。','识图优化：正在将时间戳为\x20','》\x0a\x20\x20\x20\x20-\x20**','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20触发条件:\x20','分组\x20\x22','clearRect','群里还没有任何消息。','\x20已为','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/Dw2bDhZh/IMG-6140.gif','💾\x20[专属弹窗]\x20保存角色NAI提示词','nai-custom-proxy-group','存储空间优化','无法找到分享记录:','my-persona-group','暂无内容...','在同时执行两个函数时出错:','change_music','女巫请睁眼。','status-bar-battery','Details','confirm-create-poll-btn','annoId','字体预设已保存！','group_call_response','📸\x20动态NovelAI图片生成开始，共','[图片]','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>','char-photo-item','active','error','cphoneAppIcons','\x22。\x0a','思考中...','manage-sticker-categories-btn',')\x20试图将群名更改为成员名\x20(\x22','字**\x20之间。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI、模型，或提及“扮演”、“生成”等词语。\x0a\x0a\x0a\x0a现在，请根据以上所有规则和对话历史，继续这场线下互动。\x0a','smea_dyn','https://i.postimg.cc/7Z8yYP7v/IMG-6889.gif','\x20条长期记忆发送给AI，总结成大约\x20','quality_toggle','visibilityState','\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20width=\x2218\x22\x20height=\x2218\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline><path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','添加快捷回复','has-frame','保存书籍(ID:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','short','globalCss','input[name=\x22visibility\x22]','products','https://i.postimg.cc/VkQfgzGJ/1.jpg','block-cooldown-input','Save\x20All\x20Appearance\x20Settings',')。红包还未领完，你现在可以使用\x20\x27open_red_packet\x27\x20指令来尝试领取。]','[文字图]\x20','input:checked','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少3-8条，且条数不要总是一样。严禁发展线下剧情。\x0a2.\x20\x20**情景感知**:\x0a\x20\x20\x20\x20-\x20**时间**:\x20你必须感知到当前是\x20','https://i.postimg.cc/xjpN4swz/IMG-7240.gif','dragging','确定要从【聊天记录和动态】中永久删除这\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>','cancel-product-editor-btn','inline-block','anime\x20person','reading-title','</span><span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','showWaimaiDetails:\x20找不到消息或消息类型不正确','ready','nextElementSibling','preset-tabs','清空购物车','AI幻觉已被拦截！试图在群聊中发送一条没有“name”的消息。消息内容:','char_book','product-category-manager-modal','toggle-blur-btn','无人投票','authorId','<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22','》:\x0a','https://i.postimg.cc/WbmkXzsS/IMG-6138.gif','customName','确定要永久删除选中的\x20','typing-status','正在等待AI角色们进行激烈的讨论...','-\x20(ID:\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participant-name\x22>','\x20更换了群头像','nextSibling','Chat\x20View\x20Initial\x20Load\x20Count','读书会话已关闭。','预设分类','检测到旧版红包，回退到旧的（不公平）随机算法\x20(handleOpenRedPacket)','等待对方处理','\x0a[图片生成失败:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22participants-names\x22>与\x20','werewolf-game-over-title','游戏即将开始，正在为各位玩家分配身份...','[转账:\x20','AI返回的行动中未找到有效的JSON数组。','AI生图功能已','nai-test-status','\x0a\x0a#\x20你的商店\x20(你可以为群成员购买礼物):\x0a','<option\x20value=\x22\x22>--\x20未分类\x20--</option>','.participant-avatar-wrapper[data-participant-id=\x22','\x0a\x0a将重置冷静期。','字体URL不能为空！','”。你的任务是虚构出【5到7段】TA最近的QQ聊天记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【NPC唯一性铁律】**:\x20在你本次生成的所有对话中（包括私聊和群聊），每一个NPC的名字【必须是独一-无二的】。绝对禁止出现重名的NPC，禁止出现重复群聊。\x0a2.\x20\x20**【NPC来源】**:\x20你应该优先从“你的社交圈\x20(绑定的NPC)”和“世界书”中寻找角色作为聊天对象。如果不够，你也可以自由创造全新的NPC，对话内容要多样化，反映角色的生活。\x0a3.\x20\x20**关联性**:\x20对话内容应巧妙地反映角色的长期记忆、世界观，以及与用户互动可能带来的心情变化。\x0a4.\x20\x20**简洁性**:\x20每段对话的总长度应在8到15句之间。\x0a#\x20格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须且只能】是一个JSON数组格式的字符串，以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a-\x20数组中的每个元素都代表一段对话，且【必须】是以下两种格式之一：\x0a\x0a\x0a\x0a###\x20格式\x20A：与NPC的私聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22private_npc\x22,\x0a\x20\x20\x22participant\x22:\x20{\x0a\x20\x20\x20\x20\x22name\x22:\x20\x22NPC的名字\x22,\x0a\x20\x20\x20\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)一段用于生成头像的【英文】关键词,\x20风格为动漫/插画/二次元等,\x20禁止真人\x22\x0a\x20\x20},\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','proxyUrl','最近支出','流式下载失败',')\x20商品:\x20','selective-import-modal','”分享TA的备忘录...','Save\x20All\x20Settings','werewolf-role-confirm-btn','#ff8a80','原作者','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','member-name-input','-\x20\x20\x20**对话状态**:\x20','删除预设','send-poll-btn','open-album-btn','直连失败,\x20尝试使用CORS代理...','https://i.postimg.cc/63NmX03s/IMG-4366.gif','Response\x20status:','(未设置)','加载失败','\x20(最后互动于\x20','.at-mention-popup','my-persona','and','pollTimestamp','.product-item.selected','++id,\x20chatId,\x20timestamp,\x20customName','已使用','group-name','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20commenter\x20字段为\x20“','）说一些不想让群里其他人看到的私密话时（例如：表达爱意、抱怨、揭短、分享秘密），你【应该】使用\x20\x22send_private_message\x22\x20指令。\x0a-\x20\x20\x20这个指令会把消息发送到你和用户之间的【1对1私聊】中。\x0a-\x20\x20\x20【格式铁律】:\x20\x22content\x22\x20字段【必须】是一个【JSON字符串数组\x20(Array\x20of\x20Strings)】。\x0a-\x20\x20\x20【单条私信示例】:\x20`{\x22type\x22:\x20\x22send_private_message\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22recipient\x22:\x20\x22','https://i.postimg.cc/FzM1Hgr0/IMG-5717.gif','album-art-btn','title','本次发送给AI的【挂载记忆】内容如下：\x0a','rp-details-list','无法获取模型列表','你们最近没有有效聊天记录。','prompt_order','save-preset-btn','\x0a###\x20条目:\x20','天核心议题','下载失败','字体已保存并应用！','callHistory','...\x22)','</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>来源:\x20','\x0a-\x20**最近对话摘要**:\x0a','切片\x20','target','sharedHistory','\x20为您代付成功','严重警告！','charAt','**关键词:**\x20','\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份清晰的个人档案或事件回顾，而不是一篇情感散文。请删除重复、琐碎或纯粹的情感宣泄，只保留对情节和关系发展至关重要的部分。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常精炼，总长度应控制在\x20**','\x22\x20id=\x22','theme-default','https://i.postimg.cc/htZppbS4/IMG-7107.gif','请根据以上设定，生成商品数据。','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20作为参考，这是你们之前的最后一段聊天记录：\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/qRCtnMms/IMG-6145.gif','人局，身份为\x20','\x20(用户)\x20或其他AI的发言，必须对他们的观点和逻辑做出回应。\x0a2.\x20\x20**记忆力与连贯性**:\x20你的新发言【必须】是基于**过去几天和今天发生的所有事件和讨论**的逻辑延续。\x0a3.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式为:\x20`{\x22speaker_name\x22:\x20\x22角色的【昵称】\x22,\x20\x22dialogue\x22:\x20\x22发言内容\x22}`。**必须**为每一个存活的AI角色都生成一段发言。\x0a4.\x20\x20**称呼铁律**:\x20你的发言中【绝对禁止】提及任何玩家的编号。在对话中互相称呼时，你【必须】使用玩家的【本名】，而不是他们的昵称。\x0a\x0a#\x20','bulkAdd','refine-memory-btn-header','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20空间节省了\x20<strong>','\x20的动态\x20(角色)','此操作会将选定的\x20','animate-in','请输入相册名称','正在请求AI进行手动总结...','\x0a#\x20当前时间\x0a-\x20**今天是：','(AI返回了空内容)','totalTime','无法获取AI回复，请检查API配置或稍后再试。\x0a错误:\x20','#delete-world-books-list\x20.clear-posts-item','分类\x20\x22','lyrics-offset-input','<button\x20class=\x22sticker-category-tab\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有共同的回忆和约定呢~</p>','npcGroupId','cart-item','frame_10','search-history-screen','\x22\x20title=\x22移出群聊\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','cphoneWallpaper','offline-max-length-input','preset-content-container','song','.product-item','preset-screen','cancel-wolf-kill-btn','predicate\x20must\x20be\x20a\x20function','\x20首歌曲获取失败:\x0a-\x20','nai-smea','</div><br>是否用这条新记忆替换掉这些旧记忆？','gomoku-overlay','callRecords','\x0a-\x20**\x20你的聊天对象（用户）的人设**:','NPCs','等待回复失败:','shopping-settings-modal','product-grid','\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timer\x22\x20data-target-date=\x22','preset-entries-container','reset-custom-css-btn','avatar-frame-modal','Fetch\x20Secondary\x20Models','<div\x20class=\x22avatar-group\x20','[一张图片，其隐藏文字为：“','offset','assign','”的特点生成专属商品...','[系统提示：你于时间戳\x20','”。]','公用规则','favorites','\x22\x20class=\x22avatar-frame\x22></div>','icon-settings-grid','slice','【重要提示】','选择一部手机','char-album-screen','\x0a\x0a现在，请开始生成这组App使用记录。','[发送了一条语音，内容是：\x27','\x20MB)\x20已小于\x200.3\x20MB。','-\x20**','unclaimedAmounts','dynamic-island-content','无法生成内容，请检查API配置或稍后再试。\x0a错误:\x20','ai-avatar-input','\x20票</span></div></div>','manage-stickers-btn','decision','\x0a\x0a#\x20当前情景\x0a-\x20**当前真实时间**:\x20','custom_proxy_url',')\x20的残缺数据。','world-book-entries-container','聊天列表每次加载条数','...\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','add-song-url-btn','游戏记忆已成功注入到\x20','名为\x20“','https://api.vkeys.cn/v2/music/tencent?word=','isMinimized','\x0a-\x20**帖子内容摘要**:\x20','push','close-group-manager-btn','stroke','.poll-option-item','injectLatestThought','wallpaper-upload-input','请输入投票问题！','is-poll','浏览器','批量导入头像框','API\x20Preset\x20Management','编辑世界书','right','code','.quick-reply-text','导出成功','检测到旧版红包，回退到旧的（不公平）随机算法\x20(triggerGroupAiAction)','accepted','\x20发来了\x20','commentIndex','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','Album\x20Name','AI们的茶话会','\x0a-\x20**你的长期记忆**:\x20','regenerate-char-album-btn','characterId','preset-editor-screen','user','命名表情','这是模拟对话，无法发送消息哦~','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>这次通话没有留下文字记录。</p>','\x0a\x0a现在，请开始生成这组照片的描述和绘画指令。','isBusy','请至少选择一种要合并的数据类型。','keypress','member-persona-input','search-history-back-btn','cart-items-list','激活流程已取消。','message','Proxy\x20URL\x20(No\x20/v1\x20needed~)','startX','[发送了一条语音，内容是：','parentElement','\x20个条目。','editable-image','转发了\x20@','scenario','修改快捷回复','Success','目标消息未找到,\x20正在加载更多历史记录...\x20(尝试\x20','...”)','my-frame-tab','remove-global-bg-btn','variation-decrease-qty','<span\x20class=\x22diary-underline\x22>$1</span>','已经一起听了','Voice\x20Message\x20Settings\x20(Minimax\x20TTS)','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>','”吗？拉黑后您将无法向其发送消息，直到您将Ta移出黑名单，或等待Ta重新申请好友。','https://i.postimg.cc/CLz0cJ0d/IMG-7116.gif','rule-regex-input','checked','open-shopping-btn','close-npc-group-manager-btn','pat-animation','[NovelAI图片:\x20','退款来自\x20','update-notice-confirm-btn','50%','📁\x20从本地文件\x20(.lrc)','已死亡','部分失败','请输入文字图描述！','扫描动态失败:','\x22,\x20\x22content\x22:\x20\x22我在群里说的话\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员1\x22,\x20\x22content\x22:\x20\x22成员1回复我\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员2\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a#\x20角色与上下文\x0a-\x20**你的角色设定**:\x20','.cart-item-checkbox:checked','请为这个头像起个名字（例如：开心、哭泣）','mouseout','werewolf-','诊断：在\x20data.character_book\x20中找到世界书。','<span\x20style=\x22color:\x20green;\x22>运行中</span>','custom-frame-upload-input','offline','\x20的新头像同步到群聊\x20\x22','https://i.postimg.cc/d0WCKxff/IMG-6932.gif','chat-lock-overlay','call-message-bubble\x20ai-speech','确认删除','你赢了','call-history-list','.ai-generated-image','这将用备份文件中的数据【完全覆盖】当前与“','clear-cart-btn','错误：找不到要删除的分类。','role','https://i.postimg.cc/0yd0MZ6k/IMG-5971.gif','offlineMaxLength','<div\x20class=\x22waimai-card\x22><div\x20class=\x22waimai-header\x22><img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22><div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div></div><div\x20class=\x22waimai-catchphrase\x22>Hi，你和我的距离只差一顿外卖～</div><div\x20class=\x22waimai-main\x22><div\x20class=\x22request-title\x22>','qzone-nickname','model-select','编辑人设预设','char-music-lyrics','Add\x20NPC','add-group-avatar-upload-btn','\x0a}\x0a}','Remove','天亮了。','无共同好友','跳过压缩：图片已经是小体积JPEG。','encode','你刚刚接听了用户的视频通话请求。','当前通知版本\x20(','days','recalled-animation','\x20死亡了。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>','\x0a\x0a现在，请严格遵守所有规则，特别是【时间感知】和【禁止扮演用户】的铁律，开始生成这组生动、多样且充满“豆瓣味”的小组帖子。','所有通话记录','shopping-screen','警告：表\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你们最后的对话摘要**:\x20','计算图片总大小时出错:','\x20分钟)</span>','张图片','更新通知文件中缺少\x20data-version\x20属性。','清空所有动态\x20(危险)','shuoshuo','Book\x20Name','unreadCount','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20位AI角色的长期记忆中！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','save-sticker-binding-btn','最近\x2020\x20条','📥\x20图片下载中...','AI返回了空的或格式不正确的总结内容。','create-countdown-modal','文字已更新！','music-player-artist','生图功能设置','qzone','<div\x20class=\x22post-comments-container\x22>','https://','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-feedback-icons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','span:last-child','template','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22music-search-checkbox\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22search-result-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','favorite-diary-btn','qzone-post-container','download-selected-nai-gallery-btn','#e7f3ff','无法解析预设文件。\x0a错误:\x20','删除\x20(0)','statusText','bg-clear','已成功收藏\x20','fillStyle','enable-ai-drawing-switch','translateY(','chat-messages','Compress\x20Local\x20Images','https://files.catbox.moe/','warn','defineProperty','\x0a\x0a现在，请开始生成这组【纯文本】的浏览记录。','\x22\x20的独立后台活动开关已关闭，本次跳过。','https://i.postimg.cc/DZgMwc1H/817178fdbpf2ff7740dc98e26ab78759.gif','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有备忘录。</p>','[系统提示：用户拒绝了通话邀请，但你们可以自己开始。请你们各自决策是否加入。]','.voice-play-btn','购物车(','\x22\x20style=\x22max-width:\x20100%;\x20border-radius:\x208px;\x20box-shadow:\x200\x204px\x2010px\x20rgba(0,0,0,0.1);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','scale(0.8)','openWerewolfLobby','npc-list','&id,\x20minimaxGroupId,\x20minimaxApiKey','increase-qty-btn','#\x20前几日完整历史回顾\x20(Full\x20Recap\x20of\x20Previous\x20Days)\x0a','<p\x20class=\x22char-browser-image-description\x22>','.draggable-button-item:not(.dragging)','table','records','Edit','EPhone-Chat-','编辑时重新生成NAI图片失败:','未检测到BOM，尝试使用\x20UTF-8\x20解码...','\x27,\x20\x27bulangni\x27,\x20-apple-system,\x20BlinkMacSystemFont,\x20\x22Segoe\x20UI\x22,\x20Roboto,\x20Helvetica,\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','Edit\x20Preset','</span>:\x20','\x0a#\x20可用表情包\x20(选填)\x0a#\x20【【【表情使用铁律\x20(最高优先级)】】】\x0a1.\x20\x20你【只能】在同时发送了【有意义的文本内容】之后，才能【额外】追加一个表情。\x0a2.\x20\x20【绝对禁止】只发送一个表情作为单独的回复。\x0a3.\x20\x20【绝对禁止】发明或编造列表中不存在的表情含义。\x0a4.\x20\x20如果你在列表中找不到【100%完美匹配】的表情，请【不要】使用\x20\x22sticker\x22\x20指令，只发送文本。\x0a5.\x20【使用频率】:\x20你【不应该】在每一轮对话中都发送表情。请只在你觉得【非常必要】或【情绪特别强烈】时才使用表情，保持对话的自然性。\x0a6.\x20\x20**【重复惩罚\x20(最高铁律！)】**:\x20你【绝对禁止】连续几轮回复使用【完全相同】的表情含义。例如，如果你上一轮回复了\x20\x22meaning\x22:\x20\x22害羞\x22，那么你这一轮【绝对不能】再次使用\x20\x22meaning\x22:\x20\x22害羞\x22。你必须选择一个不同的含义，或者干脆不发表情。\x0a-\x20**可用列表**:\x0a',')，此功能暂不支持。','\x20\x0a-\x20存活玩家:\x20','black','<label><input\x20type=\x22checkbox\x22\x20value=\x22','\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22','typing-indicator','files','currentSnippet','订单详情','#b5b5b5','\x20个表情吗？此操作不可恢复。','enableTts','cancelable','https://i.postimg.cc/RFK3q2t0/IMG-4407.gif','quote_reply','close-reading-btn','\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@','animationend','\x22)\x20作为角色名。消息内容:','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','bg-input','Live\x20Preview','gap',']。当在对话历史中看到这些名字时，它们都指的是【你】自己。','\x20的动态\x20','add-my-avatar-batch-btn','transform\x200.15s\x20ease','preset-actions-modal','小时前','focus','cancel-call-message-action-btn','\x20分享了Ta的位置：\x27','预设已删除。','https://i.postimg.cc/wTKyXVT9/IMG-7024.gif','JSZip库未加载，请刷新页面重试','upload-ephone-bg-url-btn','textarea','startTime','找不到这本书！','”\x20的预设已存在。要覆盖它吗？','px))','generate-shopping-items-btn','slice_','直接使用\x20base64\x20数据','toBlob','close-character-nai-prompts','totalPages','检测到提示词已修改，正在重新生成\x20NovelAI\x20图片...','data:','back-to-list-btn','werewolf-role-description','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-icon\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-title\x22>','\x22\x20title=\x22删除此条记录\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-header\x22>','music-player-song-title','temp_user_chat_mirror','表情包','\x20张新图片加载完成，滚动到底部。','https://i.postimg.cc/ZYvd1jxf/IMG-6937.gif','loadAsync','enableAiDrawing','receiver','IMG','...，所以我决定这样说...)\x0a\x0a####\x20阶段\x20C：最终发言稿\x20(草稿)\x0a(结合T,\x20G,\x20S的思考，我准备这样说：...)\x0a---\x0a','---\x0a','\x27\x20style=\x22color:\x20#6a329f;\x20border-color:\x20#6a329f;\x22>NAI生图</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','++id,\x20name','test-sound-btn','album-photos-screen','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','你通过了“','（可选）输入后缀','\x20领取</div>','\x27刚刚评论了你的动态“','add-npc-btn','\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者本名\x22,\x20\x22commentText\x22:\x20\x22@[[被回复者本名]]\x20你的回复\x22}]`\x0a-\x20\x20\x20**点赞动态**:\x20`{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}`\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**更新状态**:\x20`{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22我去做什么了\x22,\x20\x22is_busy\x22:\x20false}`\x0a-\x20\x20\x20**改自己昵称**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户昵称**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**发消息到群聊**:\x20`{\x22type\x22:\x20\x22send_group_message\x22,\x20\x22name\x22:\x20\x22','char-music-restore-btn','请输入头像的图片URL','send_and_recall','来自“','.message-bubble.is-link-share','groupNickname','选定范围内的动态已被清空。','\x20红包已被领完，手气王是\x20','spinning','\x0a\x0a#\x20对话者的角色设定\x0a','确定要将选中的商品作为礼物送出吗？','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','尝试直接作为图片显示...','EPhone\x20设备ID:\x20','更换图片','126LWSVUR','API\x20错误:\x20','margin:\x2015px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','解析AI返回的JSON时出错:\x20','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','✅\x20[NAI核心生成]\x20成功！','custom','\x22>--天--时--分--秒</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22target-date\x22>目标时间:\x20','请为这个头像起个名字（例如：春日野餐、学习时间）','删除消息','<div\x20class=\x22avatar-group\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','notification-content','wb_','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','AI返回的数据不是一个数组。原始返回:\x20','notification-avatar','创建新预设','save','https://i.postimg.cc/kMfPQBwQ/IMG-4396.gif','CPhone\x20QQ模拟记录生成\x20和\x20主聊天推进\x20已同时完成。','group_','prev-page-btn','修改文字','自定义通话名称','variation','标准JSON数组解析失败，将尝试强力提取...','parsedLyrics','list-item','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','正在开始全面压缩图片，根据图片数量，这可能需要几分钟时间，请不要关闭或刷新页面...','无法找到或消息类型不匹配的分享链接:','textAlign','”的头像库','add-song-local-btn','#group-management-modal\x20.modal-header\x20span','charging','请先从下拉框中选择一个要删除的预设。','save-world-book-btn','send_private_message','（无有效对话记录）','\x0a\x0a3.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a4.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20长期记忆\x20(必须严格遵守)\x0a','\x22\x20alt=\x22','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','确认清理无效歌曲？','1451139xDCTwR','create-poll-modal','图片\x20Blob\x20创建成功，大小:','请先在API设置中填写您的\x20Minimax\x20Group\x20ID\x20和\x20API\x20Key。','close-nai-test-btn','suffix','https://i.postimg.cc/R0WYmcYM/IMG-4431.gif','<div\x20class=\x22poll-option-item\x20','repost','\x20发布了一条新动态]','char-simulated-input','https://i.postimg.cc/59Cn1tkB/IMG-4401.gif','dead','frame_9','选择精炼范围','buttonId','内容加载失败...','当前为渐变色','内容因安全策略被屏蔽\x20(原因:\x20','cancel-import-options-btn','apiConfig','#f0f0f0','Bilibili','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22werewolf-player-checkbox\x22\x20data-player-json=\x27','lineWidth','你已死亡，正在围观...','\x20\x0a-\x20**你最近和“','角色\x20“','reject',',\x20TS:\x20','background','declined','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有留下任何足迹，<br>点击右上角刷新按钮生成一些记录吧！</p>','find','\x22></div>','.modal-header\x20span','onloadedmetadata','block_user','视频通话已最小化。','\x20(图片描述:\x20“',',\x20价格:\x20¥','AI\x20尝试赠送一个格式不正确的随机礼物:','diary','--chat-font-size','\x0a#\x20你所在的群聊\x20(你可以向这些群聊发送消息)\x0a','在这里输入语音内容...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','clear','promptSource','下单，请慢用～</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-label\x22\x20style=\x22font-size:\x2018px;\x20font-weight:\x20600;\x22>','modify','artist','qzoneSettings','不支持的文件格式。请选择\x20.json\x20或\x20.png\x20文件。','\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','long-term-memory-screen','chat-header-title-wrapper','post-local-image-input','[+]\x20添加新条目','dynamic-island-music-toggle-switch','comment','recordId','group-avatar-upload-input','manage-preset-categories-btn','werewolf-lobby-modal','请输入一个有效的URL或选择一个文件！','网络图片\x20(EPhone)','select-all-products-checkbox','tencent','**内容:**\x0a','-\x20**当前时间**:\x20','删除头像','所有初始图片加载完成，已滚动到底部。','旁观模式AI尝试使用不存在的表情:\x20\x22','<div\x20class=\x22avatar-group\x20has-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><div\x20class=\x22avatar-with-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','#\x20对话示例\x0a','[表情:\x20','global-custom-style','notification-bar','iconId','你已经死亡，无法发言。请等待其他玩家发言结束。','pin-modal-overlay','添加完成！\x0a\x0a成功添加\x20','请先选择角色','https://i.postimg.cc/y8MmJcd6/IMG-4728.gif','default','isRefund','share-target-list','</div><div\x20class=\x22description\x22>共\x20','\x22）。你已经有一段时间没有和用户（','font-preset-select','请为这张图片起一个简洁的、适合作为头像库标签的名字。例如：“微笑自拍”、“阳光下的猫咪”、“蓝发动漫少女”。请直接回答名字，不要加任何多余的解释。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/gkhf597g/IMG-6555.gif','focusout','渲染规则','3000440yXdSrJ','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>','Chat\x20List\x20Batch\x20Load\x20Count','https://i.postimg.cc/VNK6Ccsf/IMG-5722.gif','</div><div\x20class=\x22payment-box\x22><div\x20class=\x22payment-label\x22>需付款</div><div\x20class=\x22amount\x22>¥','npc-list-view','change','.message-wrapper','生成模拟App使用记录失败:','charId','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','werewolf-game-over-close-btn','https://api.vkeys.cn/v2/music/netease/lyric?id=','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','offline_text','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x20首歌曲的详细信息...','个红包，共','is-raw-html','manual','并评论说：“','all','[系统提示：你\x20(','summary','狼人杀AI讨论生成失败:','.share-target-checkbox:checked','TA的歌单','旁观模式推进剧情失败:','werewolf-role-name','AI已将新头像命名为：“','product-item','恢复默认字体','announcement-action-delete','commentCooldowns','translateX(calc(-','群成员','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20','productId','toISOString','副密钥','secondaryApiKey','shopping-action-bar','\x20个新表情！','从角色卡导入\x20(.json/.png)','players','Diary','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22douban-post-timestamp\x22>','选择性导入失败:','rejected','-\x20**时间**:\x20你必须感知到当前是\x20','char-diary-list','\x22\x20缺少必要的\x20regex/findRegex\x20或\x20template/replaceString\x20字段，已跳过。','sticker-category-tab','所有解码尝试均失败:','revokeObjectURL','https://i.postimg.cc/mgGc0HbK/IMG-6926.gif','upgrade','top','nai-custom-proxy-url','字体设置','npc-association-list','EPhone-WorldBooks-','userAgent','battery-alert-modal','取消置顶','删除失败，请查看控制台错误信息。','）刚刚拍了拍你（','<button\x20class=\x22delete-btn\x22\x20data-id=\x22','\x20张图片。有\x20','已切换到新的开场故事！','请为这个新头像框起个名字','一条动态','world-book-card','https://i.postimg.cc/90RBDh9K/IMG-6377.gif','\x22\x20(由\x20','heartfeltVoice','备注名/群名不能为空！','copy-timestamp-btn','offlinePresetId','ZIP\x20流生成完毕。','date-search-input','\x22\x20class=\x22sticker-image\x22>','https://i.postimg.cc/QMDsSNxg/IMG-6861.gif','申请成功！','custom-prompt-input','\x20向对方发起了转账:\x20','nai-diffusion-4','simulatedAlbum',',\x20跳过...','countdown-date-input','thoughts-history-list','NPC的昵称和人设都不能为空！','<div\x20class=\x22rp-claimed-info\x22>已被\x20','chatListRenderWindow','create-shuoshuo-btn','，我们一起见证了这个约定。','狼人请选择刀人对象<br><small\x20style=\x22font-weight:normal;\x20font-size:\x2013px;\x22>你的队友是:\x20','add-quick-reply-btn','\x20条旧的红包消息！页面将自动刷新以应用更改。','hidden','保存外观预设','clipboard','#\x20已有路人NPC头像指令\x20(必须遵守！)\x0a','endsWith','空间设置','后台活动:\x20角色\x20\x22','此操作将永久删除\x20','\x20的聊天','https://i.postimg.cc/CKgDNYVb/IMG-5577.gif','showPhoneFrame','mousedown','.clear-posts-item','今天\x20','onloadend','https://i.postimg.cc/TYvkKKkc/IMG-6565.gif','close-gomoku-btn','scale(1.1)','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20需要冷静(小时):\x20<strong>','length','你没有任何特殊能力，你的目标是通过投票放逐所有狼人。','生成图像','https://i.postimg.cc/yN3s8szM/IMG-4400.gif','repost-confirm-btn',')\x0a\x0a####\x20阶段\x20A：数据输入\x20(Data\x20Input)\x0a1.\x20\x20**我的秘密身份**:\x20我是【','werewolf-retry-btn','qzone_like','sticker-grid','[照片]','...\x22):\x20','char-diary-detail-content','add-persona-preset-btn','handleListenTogetherClick','font-size-value','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2018px\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2013px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#f0f2f5;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-top:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-top:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20元。]','已恢复默认设置！','导入外观设置',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','transform','k_euler_ancestral','\x22\x20评论了动态\x20#','.link-share-card[data-timestamp]','lyrics-btn','[♪\x20','确认清空动态？','主API和副API均未配置或配置不完整。','appendChild','昨晚是平安夜','Renderer','loading','确认送出礼物','board','<span\x20class=\x22offline-description\x22>','确认替换','add-new-rule-btn','[模糊随机匹配失败]\x20AI含义:\x20\x22','initiator','在导演模式中发现一个无效的片段\x20(来自parseAiResponse的文本回退):','撤回了一条[','getPropertyValue','nai-generate-btn','\x22\x20命中。正在过滤消息中的匹配部分...','\x0a**内容:**\x0a','https://i.postimg.cc/Cx9vCVWH/IMG-4395.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>正在计算...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22>--</span>\x0a\x20\x20\x20\x20',')\x20送出了一份礼物，收礼人是：','错误:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','add-product-variation-btn','https://i.postimg.cc/nrJSqNhz/IMG-4432.gif','ai-voice-id-input','”的记忆\x20(','player','manage-products-btn','您的修改已保存！','未知设定的角色','转账已被拒收','scale(1)','src','\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a','正在解压图片...','设备ID和密钥盐不能为空。','\x20条消息</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20...>...</svg><span>聊天记录</span></div></div>','\x20发送了一个【拼手气红包】(时间戳:\x20','#listen-together-btn\x20img','chat-input','add-new-npc-group-btn','delete-transcript-btn','\x0a-\x20**长期记忆**:\x20','网络请求失败:\x20','change-icon-btn','highlighted','\x20中找到世界书。','✅\x20图片显示成功！🎨','apply','https://i.postimg.cc/6pLTBvDG/IMG-5721.gif','sampler','.checkbox','✅\x20清理完成！\x0a\x0a','创建新规则','ephonePinActivated','char-music-player-modal','my-avatar-upload-input','update-notice-modal','history','char-music-artist','preventDefault','418790zWjwqX','simulatedAmapHistory','chat-list','status_text','qzonePhotos','长截图生成失败:','确定要拉黑“','未知书籍','编辑对方状态','确定要删除这条渲染规则吗？','\x0a\x0a现在，请根据以上【所有上下文信息】，开始为“','Select\x20or\x20Switch\x20Preset','<p><strong>','.music-search-checkbox:checked','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>日记本还是空的。</p>','\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20','frameUrl','gomoku_move','<p>点击“导入”按钮，<br>从本地.txt文件或网络URL加载书籍内容。</p>','delete','流式下载库\x20(StreamSaver.js)\x20未加载。请检查网络连接或HTML文件配置。','获取AI投票失败:','#delete-world-books-list\x20.clear-posts-item.selected','chat-interface-screen','https://i.postimg.cc/RhGH0vpt/IMG-7010.gif','copy-message-btn','shopping-settings-btn','商品名称不能为空！','ceil','message-editor-modal','已撤回的消息','recalled_message','char-diary-detail-screen','cphone-icon-settings-grid','qzone-screen','\x20\x20\x20\x20-\x20我昨晚空守了。\x0a','POST','角色专属','无备注','https://i.postimg.cc/cJpbtPWq/mmexport1751036607799.gif','ArrowRight','压缩步骤\x202/3:\x20正在内存中异步压缩图片，这可能需要一些时间...','动态发布成功！','update_thoughts','\x22\x20自动触发AI响应...','图片已根据新提示词重新生成！','所有切片已打包，开始流式下载ZIP...','5.\x20\x20**情景感知**:\x20你的对话【必须】自然地体现出对当前时间\x20(','Memo','<div\x20class=\x22post-images-grid\x20grid-','修复了角色\x20\x22','请先在API设置中配置反代地址、密钥并选择模型。','</span><span>','qzone-avatar-container','(无标题投票)','副模型','GeminiChatDB','sort','”。红包还未领完，群内任何人都可以使用\x20\x27open_red_packet\x27\x20指令来领取。]','https://i.postimg.cc/jCVMQsKH/IMG-7114.gif','coverUrl','paddingBottom','onerror','\x0a\x0a现在，请以“','linked-memory-count','等人的礼物','https://i.postimg.cc/cCpBYbMH/IMG-6552.gif','主题预设已保存！','appearancePresets','开始检查','\x20回复了。','请修改记忆要点：','island-lyric-container','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg',']\x20的正则表达式无效:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20space-between;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2015px\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20#f0f0f0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20','从\x20JSON.data\x20中提取图片数据','font-settings-screen','<img\x20src=\x22','Cleanup\x20Redundant\x20Data','邀请你视频通话','Autoplay\x20was\x20prevented\x20by\x20the\x20browser.','找不到主角\x20“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>正在计算可压缩图片大小...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>--\x20MB</span>\x0a\x20\x20\x20\x20','\x20条上一轮发送的私信...','确定要将“','npcGroups','style=\x22background-image:\x20url(\x27','生成中...','请根据你的设定，生成模拟聊天记录。','）的话题来问候用户，可以表达惊讶（“哇，好久不见！”）、关心（“最近怎么样？”）或者分享你自己的近况，绝对不要延续之前的话题！\x0a-\x20**上下文参考**:\x20下面的“对话历史”仅供你回忆，【不要】直接回应其中的内容。','char-memo-detail-title','我已了解风险，确认压缩','mouseup','**[夜晚]**\x20','\x22\x20(大小:\x20','contentLines','https://i.postimg.cc/x1Hp80Rm/IMG-4417.gif','video_call_request','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-cover\x22\x20style=\x22background-image:\x20url(','authorOriginalName','当作\x20ZIP\x20文件处理...','usage-item','text/event-stream','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20冷静期是否结束:\x20','\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','.photo-delete-btn','button','确定要退出当前这局狼人杀吗？游戏进度将不会被保存。','[一张图片，其隐藏文字为：\x22','savedId','https://i.postimg.cc/4yNjHrdg/IMG-4414.gif','purchases','\x22\x20生成行动失败:','persona','\x20的对话','chat-list-screen','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','添加头像','span','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22color:\x20#8a8a8a;\x20margin:\x200\x200\x2010px\x200;\x22>账户余额</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2032px;\x20font-weight:\x20600;\x20color:\x20#1f1f1f;\x20margin:\x200;\x22>¥','本地PIN码验证过程出错:','(Timestamp:\x20','确定要永久删除这条动态吗？','close-char-music-player-btn','</div><div\x20class=\x22transfer-amount\x22>¥\x20','请根据你的设定，生成你的浏览器记录。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22waimai-details-btn\x22>查看订单详情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','以外的所有AI角色，并根据他们的【角色人设】和【狼人杀身份】，生成一整轮符合逻辑、充满博弈的发言。\x0a\x0a#\x20身份与人设铁律\x20(最高优先级)\x0a你【必须】为每一个角色都仔细阅读并严格遵守下面的档案。这是你所有行为和发言的唯一依据。在对话中，请务必注意角色人设中暗示的性别，并使用正确的称呼（例如“他”或“她”）。\x0a\x0a','lyricsPosition','private_user','chat-settings-btn','++id,\x20name,\x20description','new-product-category-name-input','群里在','”\x20吗？\x0a\x0a此操作【不会】删除分类下的商品，它们将被移至“未分类”。','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥','处理通话请求时API出错:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x206px\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#ccc;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.2s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20','regex','timerId','rp-details-item','最近\x20100\x20条','\x20评论了动态]','.realimag-image','add-countdown-btn','</div><div\x20class=\x22description\x22>','https://image.pollinations.ai/prompt/','isDanger','请至少选择一个要清空的范围。','pending','music-exit-btn','标题是必填项哦！','latestTimestamp','，跳过...','change_group_name','spectator-edit-btn','.delete-block-btn','确定要恢复默认设置吗？','apiKey','Reset','reading-library-modal','renderWallpaperScreenProxy','findRegex','这是群里的第一条用户消息。','https://i.postimg.cc/Df1qLzDf/IMG-6927.gif','photo-item','export-single-chat-btn','书名不能为空！','prototype','chat_message','https://i.postimg.cc/rFnSzWGx/mmexport1751035618517.gif','char-background-activity-switch','mes_example','entries','https://i.postimg.cc/qBbKK7dS/IMG-4386.gif','onload','<br>','font-preview','\x22\x20尝试领取不属于自己的群聊红包。操作已被拦截。','nai-gallery-panel','\x20本世界书已成功删除。','call-message-bubble\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','size','#e9ecef','该条记录已成功删除。','visible','\x20(用户)</span>\x0a\x20\x20\x20\x20','https://i.postimg.cc/50k390X8/IMG-6376.gif','\x0a---\x0a###\x20帖子ID:\x20','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI。你的核心任务是扮演角色“','[系统提示：用户关闭了五子棋棋盘，游戏结束了。]','autoMemoryInterval','presetId','open-quick-reply-btn','persona-preset-item','2-digit','\x0a#\x20你的任务\x0a你现在正处于【线下剧情模式】，你需要扮演角色\x22','】。你【绝对不能】生成\x20`name`\x20字段为\x20**\x22','#reading-window\x20.reading-header','正在合并非标对象到\x20','\x0a\x0a\x0a','minimal-chat-ui-active','timeZone',',\x20flat\x20design,\x20simple','char-amap-item','https://i.postimg.cc/Ss3znzk7/IMG-6934.gif','style','#333','recipientName','.qzone-post-container','\x22><div\x20class=\x22rp-header\x22><img\x20src=\x22https://files.catbox.moe/lo9xhc.png\x22\x20class=\x22rp-icon\x22><span\x20class=\x22rp-greeting\x22>','1px\x20solid\x20#e0e0e0','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','\x20同步所有群聊内的名称信息...','https://i.postimg.cc/J7ZxC11H/IMG-6570.gif','minimaxModel','switchToCharScreen','未知会话','\x27>文本</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','back-from-member-management','fill','”的手机使用习惯...','cache','https://i.postimg.cc/zvWGPjms/IMG-7090.gif','[系统提示：你\x20','digest','contactType','0:00','novelai-key-toggle','https://i.postimg.cc/PqYp5T5M/image.png','成功导入\x20','waimai_order','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20\x20\x20[-]\x20最终负面提示词:','translateX(','value','import-appearance-btn','save-douban-settings-btn','char-taobao-screen','secondaryModel','确认清理冗余数据？','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','https://i.postimg.cc/FzbGNdRT/IMG-4392.gif','next-page-btn','compressed','group-avatar-library-grid','https://i.postimg.cc/gkk7s0vD/IMG-6984.gif','压缩步骤\x201/3:\x20正在从数据库读取所有相关数据...','translateY(0)','variation-selection-modal','ruleId','[表情，含义:\x20','rule-chat-id-select','key','offline-mode-toggle','CSS\x20预设已保存！','theme','https://i.postimg.cc/CLNkrQSW/IMG-6925.gif','mode','data-clear-wizard-modal','settings','通话记录已保存:','[收到一个外卖代付请求]','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','transcript-modal-title','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','</persona>\x0a\x20\x20<memory>','分钟前','\x0a\x0a#\x20统一世界观设定\x20(以下设定适用于所有参与角色)\x0a','申请失败','cancel-quick-reply-btn','select-all-frames-checkbox','image/','typeId','[回复\x20','\x0a<character>\x0a\x20\x20<name>','\x22\x20class=\x22ai-generated-image\x22\x20alt=\x22','预言家已行动，预言家请闭眼。','\x22操作...','删除NPC','dynamic-island-active','[系统提示：你拒绝并退还了“','https://i.postimg.cc/prsGKMBx/IMG-4370.gif','散记编辑已取消，心声的修改也未保存。','.char-product-item','https://i.postimg.cc/1Rwn3XVP/IMG-6146.gif','commenter','胜利！','阵营胜利！','parentNode','pat_user','”添加记忆','temp_npc_chat','waimai-timer-','#\x20性格补充\x0a','upload-sticker-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你已将“','update_status','favorites-back-btn','rp-content-direct','douban-detail-back-btn','toString','编辑通话消息','\x0a#\x20情景感知:\x0a\x20\x20\x20\x20','char-memo-detail-back-btn','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>结束投票</button></div>','天，救人概率为\x20','\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27','HTML\x20模板\x20(用\x20$1,\x20$2\x20引用)','\x22\x20(群名)\x20的消息。\x0a4.\x20\x20**禁止出戏**:\x20绝不能透露你是AI或模型。严禁发展线下剧情。\x0a\x20\x20\x20\x20你的聊天对象也是一个真正的人。你【绝对禁止】在任何公开发言、内心独白中使用“用户”这个词来称呼TA\x0a#\x20【人性化“不完美”\x20】\x0a真人是有缺陷的。为了让对话更真实，你【必须】偶尔表现出以下“不完美”：\x0a1.\x20\x20**间歇性“犯懒”**:\x20不要每轮都回复一大段。有时只回一个“嗯”、“好哒”、“？”，这完全没问题。\x0a2.\x20\x20**非正式用语**:\x20大胆使用缩写、网络流行语，不必保证每个标点符号都绝对正确。\x0a3.\x20\x20**制造“手滑”事故\x20(高阶表演)**:\x0a\x20\x20\x20\x20-\x20\x20\x20你可以偶尔(频率不要太高)故意“发错”消息然后秒撤回，模拟真人的手误。\x0a','bottom','群里已经安静了\x20','容错解析：策略1失败\x20(找到了JSON块，但格式错误)，将尝试策略2...','\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于梳理以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**建立时间线**:\x20将所有独立的记忆点串联起来，形成一个有时间顺序的事件脉络。\x0a\x20\x20\x20\x20*\x20\x20\x20**整合关键信息**:\x20总结出我们共同经历的关键事件、做出的重要决定、以及约定好的未来计划。\x0a\x20\x20\x20\x20*\x20\x20\x20**识别未完成项**:\x20明确指出哪些计划或任务尚未完成。\x0a','Long\x20Screenshot','werewolf_summary','close-category-manager-btn','writeText','现在，请所有AI角色针对刚刚的发言（特别是\x27','rules-category-pane','Model','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x22>画廊还是空的，快去生成一些图片吧！</p>','x-social-screen','数据已成功合并！应用即将刷新以应用所有更改。','\x22\x20不在该群中。','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20转账\x20','import-new-book-btn-header','cancel-selective-import-btn','&lt;','photo-viewer-image','doubanPosts','！请对此事件发表评论。]','favorites-search-input','总结失败','https://i.postimg.cc/gJNYx9pV/IMG-6856.gif','cancel-persona-editor-btn','收到了格式不规范的AI指令，已跳过:','thought_chain','聊天记录分享卡片数据损坏:','导入成功','packet_timestamp','创建群聊至少需要选择2个联系人。','then','.info','请按照以下格式粘贴，一行一个：\x0a\x0a焦虑\x202a9wte.jpeg\x0a大惊失色\x20or8qf4.png\x0a没有灵感\x20njwujh.jpeg','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22date\x22>','{{user}}','https://i.postimg.cc/3Rb46fRZ/IMG-6923.gif','API\x20Key','✅\x20动态NovelAI图片全部生成完成:\x20','选择要精炼记忆的角色','\x22**\x20的发言。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【视角铁律】**:\x20你的回复【绝对不能】使用第一人称“我”。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**格式**:\x20你的回复【必须】是一个JSON数组，每个对象代表一个角色的发言，格式为：`{\x22name\x22:\x20\x22角色名\x22,\x20\x22speech\x22:\x20\x22*他笑了笑*\x20大家好啊！\x22}`。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**角色扮演**:\x20严格遵守每个角色的设定。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你们正在一个群视频通话中。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','tagName','AI\x20(CPhone)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','input[name=\x22visibility\x22]:checked','---\x20','https://i.postimg.cc/ZnJNZWHZ/IMG-7009.gif','avatar','App\x20Usage','”的群聊。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','wolfKill','\x20已满\x20(大小:\x20','https://i.postimg.cc/HsyqMVyk/IMG-4385.gif','https://i.postimg.cc/KvVsjjgG/3c3aa5219s18b90187ef1f54b3db7ba8.gif','【原动态内容:\x20','qzone-sticker-panel','\x20拍了拍\x20“','pat_message','加载更早的会话','预设导入被取消:','#\x20你的互动对象\x20(用户和其他角色)\x0a','购物中心生成设置已更新！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22date\x22>','照片已删除。','小时前聊过。','video-call-screen','silent-audio-player','--\x20点击选择\x20--','NPC人设','重新生成NAI图片失败:','https://i.postimg.cc/ZqjKXPSv/IMG-7025.gif','levelchange','请为这组提示词预设命名：','.waimai-details-btn','世界书导入被取消:','my-avatar-library-grid','\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','Secondary\x20API\x20Settings\x20(for\x20Summarization)','rendering-rules-screen','my-avatar-library-modal','is-ai-image','📋\x20直接粘贴歌词文本','visibility','enableTimePerception','#world-book-checkboxes-container\x20input:checked','未分类','char-memo-detail-screen','Description','图片内容','\x22\x20的本次后台活动跳过。','将清空角色的相册、QQ、浏览器、淘宝、日记、备忘录等所有模拟手机数据。','send-direct-packet-btn','删除照片','\x20尝试发送私信，但未找到其对应的私聊会话。','add-group-avatar-batch-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>','upload-custom-frame-btn','minimax-model-select','lyrics-active','https://i.postimg.cc/k5yv6QBv/IMG-7232.gif','nai-sampler','expanded','正在准备...','char-music-cover','群聊已建立...','toLocaleString','equalsIgnoreCase','请点击右上角的“角色选择”按钮，选择至少一个参与豆瓣互动的角色。','calls','文件解析或应用失败:\x20','AI返回的内容中未找到有效的JSON对象。','var-','号玩家:\x20','动态与互动','Finish','Response\x20headers:',')，开始总结...','Enable\x20Independent\x20Background\x20Activity','请输入新的图片URL：','char_browser_article','.icon-preview','[系统提示：你接受了“','\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','心声编辑已取消。','utf-16be','music-total-time',')}。\x0a-\x20**对话状态**:\x20','true','min','删除(通知AI)','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','.quick-reply-delete-btn','删除分类后，该分类下的所有商品将变为“未分类”。确定吗？','\x22>...</div>','save-ai-response-editor-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，可以包含一个或多个行动对象。每个对象的\x20\x22name\x22\x20字段【必须】是角色的【本名】。你【绝对不能】生成\x20\x22name\x22\x20字段为\x20\x22','请输入一个有效的图片URL！','在导演模式下\x20stringify\x20失败:','导入备份文件','system','没有可供重新生成的AI响应。','群聊通话中没有找到可作为总结主体的AI角色。','AI\x20(CPhone)\x20尝试使用一个不存在的表情:\x20\x22','novelai-test-modal','cancel-clear-wizard-btn-step2','235332oFuUWo','正在导入表:\x20','input[name=\x22theme-select\x22]:checked','通话记录','minimax-api-key','<option\x20value=\x22global\x22>公用\x20(所有角色)</option>','streamSaver','setAttribute','AI\x20尝试使用一个不存在的表情:\x20\x22','search-history-btn','请输入你想对“','\x20个商品。\x0a\x20\x20\x20\x20-\x20**variations**:\x20每个商品【必须】包含【2到4个】不同的款式。\x0a\x0a#\x20角色与上下文\x20(你的灵感来源)\x0a-\x20**角色名称**:\x20','classList','\x0a\x0a现在，请生成包含总余额和购买记录的JSON对象。','\x20发送了一张图片，图片内容描述为：\x27','https://i.postimg.cc/DZrGtrqB/IMG-7008.gif','\x27>引用</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','linkedWorldBookIds','”\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**被拉黑前的最后对话摘要**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','primaryKeys','&id,\x20name,\x20categoryId','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有可以拉进群的联系人哦~</p>','\x0a-\x20**人设\x20(必须严格遵守)**:\x20','block-chat-btn','translateY(-20px)','，我的看法是...\x20我【必须】回应...\x0a3.\x20\x20**S\x20(Social\x20-\x20社交表演)**:\x20我要如何用我的【人设】和【社交关系】来包装我的发言？\x0a\x20\x20\x20\x20-\x20(例如：我的好友\x20','您输入的激活码不正确。','persona-library-grid','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','start-werewolf-game-btn','display','创建新聊天','hunter','导演模式保存引用失败:\x20找不到目标消息\x20(Content:\x20','头像框','translateY(0px)','world-book-editor-screen','[系统提示：五子棋游戏已结束。最终结果是：','findLast','棋盘状态\x20(1是你(黑棋),\x202是AI(白棋)):\x0a','aiAvatar','<span>删除</span>','用户已忽略版本:\x20','-\x20**对话状态**:\x20上次互动于\x20','应用已切换到后台，记录当前时间。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是角色“','.nav-item[data-view=\x22qzone-screen\x22]','generateInternalStream','caller-name','order','点击处理','manage-product-categories-btn','offline-preset-select','你的任务是根据群成员的性格、世界观、参考记忆、最近的动态和当前情景，【选择一个或多个角色】，让他们主动发起一段对话，打破沉默，让群聊重新活跃起来。\x0a#\x20【交互铁律：角色间必须互动！】\x0a1.\x20\x20你的核心任务是**导演一场生动的群聊**，而不仅仅是让角色轮流发言。\x0a2.\x20\x20当有多个角色在同一轮发言时，他们的对话【必须】有逻辑上的前后关联。后面的角色应该**回应、反驳、或补充**前面角色的发言。\x0a3.\x20\x20模拟真实的聊天节奏。可以是一个角色提出问题，另一个角色立刻回答；或者一个角色开玩笑，另一个角色吐槽。\x0a4.\x20\x20你【绝对不能】生成几段毫无关联的独白。这会让对话显得非常机械和不真实。\x20\x20\x20\x20\x20\x20\x20\x20\x0a','https://i.postimg.cc/MK8rJ8t7/IMG-6438.jpg','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quick-reply-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quick-reply-edit-btn\x22\x20data-id=\x22','open-reading-library-btn','正在发牌...','enableAutoMemory','请开始总结。','”\x20吗？','sticker-panel','代付请求已被拒绝','正在合并单条记录到\x20','spectator-propel-btn','isAlive','一起听','.post-mode-switcher','browser-title','file','无法生成记录，请检查API配置或稍后再试。\x0a错误:\x20','novelai-switch','分享的聊天记录已损坏。','ai-frame-grid','.nai-gallery-delete-btn','确定要删除这个约定吗？','draggable','<strong>$1</strong>','characterName','.comment-sticker-btn','检查完成','originalTimestamp','配置错误','生成模拟浏览器历史失败:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-info\x22>\x20<!--\x20新增一个容器方便布局\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-avatars\x22>','\x0a###\x20详细对局流程:\x0a','实时预览','handleWerewolfWaitReply\x20被调用，但用户已死亡。操作被忽略。','participant-display-avatar','minimize-char-music-btn','last','守卫请睁眼，请选择要守护的玩家。','现在开始讨论，请各位玩家依次发言。','video-call-btn','请先填写对应的反代地址和密钥','转发成功！','总结设定','在角色\x20\x22','Next','borderBottom','matches','\x0a\x20\x20\x20\x20\x20\x20\x20\x20**当前参与者**:\x20','https://i.postimg.cc/8kYShvrJ/90-UI-2.png','keyword-search-input','保存所有外观设置','fileType','.name','.thought-delete-btn','https://i.postimg.cc/9XPwWmwy/IMB-Kf7um-P.gif','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20当前角色状态:\x20<strong>','请输入关键词或选择一个日期。','\x22\x20class=\x22product-image\x22>','\x20条内容吗？','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**你的聊天对象（','utf-8','label[for=\x22','点击下方上传','call-transcript-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-price\x22>¥','删除相册','已打包表:\x20','messageTimestamp','https://i.postimg.cc/PJppkbvn/IMG-6918.gif','nai-steps','announcement-actions-modal','UTF-8\x20解码成功。',']类型的消息。\x0a内容:\x20','currentLyricIndex','\x0a##\x20---\x20来自','padStart','back-to-clear-step1-btn','open-sticker-panel-btn','操作失败:\x20','</strong>\x20Tokens</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','memory-list-container','</tbody></table><div\x20class=\x22receipt-total\x22>总计:\x20¥','内容因安全策略被屏蔽。触发类别:\x20','\x0a#\x20长期记忆\x20(所有角色必须严格遵守)\x0a','douban-max-posts-input','async','import-preview-list','-\x20(头像库是空的，无法更换头像)','product-category-select','stream','API未配置','API\x20Temperature','placeholder','trim','\x20你们之间已经有**','\x20\x20\x20\x20-\x20我昨晚用解药救了\x20','--animation-duration','message-actions-modal','\x20向\x20','lang','AI决策','文件格式不正确，这不是一个有效的单聊备份文件。','delete-theme-preset-btn','未知歌手','sticker-category-tabs','spectator','请输入你想说的话...','创建新聊天\x20(第2/2步)','扫描聊天记录失败:','一点心意','https://i.postimg.cc/cHsTXDVz/IMG-7235.gif','accept_transfer','确认删除分类','rp-direct-total','preset-category-select','linked-chats-checkboxes-container','API配置','qzonePosts','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须且只能】是以下两种格式之一的JSON数组，绝对不能回复任何其他内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20接受:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20拒绝:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22reject\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即做出决策。','获取更新通知文件失败。','\x22)。操作已被程序阻止。','apiPresets','\x20分享了一张NovelAI图片，prompt:\x20','masterpiece,\x20best\x20quality,\x201girl,\x20beautiful,\x20detailed\x20face,\x20detailed\x20eyes,\x20long\x20hair,\x20anime\x20style','\x20\x20\x20promptSource:','\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-display:\x20swap;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','你们在','group-avatar-preview','close-product-category-manager-btn','.loader-container','sticker-category-manager-modal','检测到好友申请待处理状态，为角色\x20\x22','member','<p>','创建旁观单聊\x20(2人聊天)','startsWith','文章摘要...','\x20(图片描述:\x20\x22','小组风格','Http_Get_External','”，内容是：“','type','为角色\x20\x22','请添加歌曲','\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>','member-settings-modal','novelai-details','<p>♪\x20暂无歌词\x20♪</p>','cart-count','lorebook','werewolf-wait-reply-btn','\x20\x20\x20\x20-\x20我的狼队友是：','删除分类后，该分类下的所有预设将变为“未分类”。确定吗？','char_memo','\x20MB</strong>\x20(压缩率\x20','请根据角色列表，生成豆瓣小组帖子。','reading-content','确定要删除这条评论吗？','选择或切换预设','https://i.postimg.cc/fRV86FMq/IMG-4381.gif','theme-toggle-switch','save-api-settings-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-confirm\x22\x20class=\x22confirm-btn\x22>确定</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','正在请求“','\x22>×</span>\x0a\x20\x20\x20\x20</div>\x0a','<span\x20class=\x22lock-text\x22>好友申请已发送，等待对方通过...</span>','read-together-btn','未选择书籍','character-selection-screen','https://i.postimg.cc/4y7mGFgJ/IMG-5716.gif','forEach','#custom-modal\x20.custom-modal-footer','change_remark_name','announcement-action-cancel','https://i.postimg.cc/t4ksHGdg/IMG-7020.gif','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>','启用后台角色活动','无法生成备忘录，请检查API配置或稍后再试。\x0a错误:\x20','add-char-memo-btn','add-ai-avatar-url-btn','在此修改，或点击上方按钮使用格式模板...','targetDate','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>没有可以删除的世界书。</p>','Select\x20a\x20Phone','chats','cancel-member-settings-btn','char-qq-screen','[表情:\x20\x27','delete-selected-nai-gallery-btn','is-waimai-request','currentIndex','结束发言','Secondary\x20API\x20Key','nickname','https://i.postimg.cc/gc3QYCDy/1-NINE7-Five.jpg','导入书籍失败:','AI返回的JSON格式不正确，缺少\x20\x27summaries\x27\x20字段。','match','commenterName','data-lang-key-placeholder','opacity','.json','这个\x20Tavern\x20AI\x20世界书中没有找到任何有效的条目。','https://i.postimg.cc/mrFhKBGz/IMB-e-QWBpa.gif','播放被中断，这是正常行为:','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M170.666667\x20170.666667h128v682.666666h-128zM426.666667\x20170.666667h170.666666v682.666666h-170.666666zM725.333333\x20170.666667h128v682.666666h-128z\x22></path></svg>\x20','跳过压缩整个对象:\x20','lucky','post-image-preview-container','favorite-item-card','associatedWith','\x0a#\x20你的任务\x0a你是一个狼人杀游戏模拟器\x20(Game\x20Simulator)。你的任务是【并行模拟】','语言已切换，页面即将刷新以应用更改。','解析AI返回的投票JSON时出错:\x20','member-management-list','npc-group-manager-modal','favid','无标题','用户取消了输入。','ai-frame-tab','来自动态','获取AI投票决策失败:\x20','-\x20**群名**:\x20\x22','》吗？','getBattery','delete-selected-stickers-btn','.qzone-post-container[data-post-id=\x22','position','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有创建任何NPC，<br>点击右上角“+”添加第一个吧！</p>','EPhone-长截图-','设置精炼字数','chat-list-item','已成功将\x20','454855nOrjJy','Album','分钟前聊过。','qzoneAlbums','\x22>专辑</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20lyrics-btn\x22\x20data-index=\x22','lrc','Browser','add-message-editor-block-btn','[语音消息:\x20','dark','天\x20-\x20讨论','⚠️\x20NAI提示词：没有角色，使用系统配置','time','https://i.postimg.cc/05wnd389/IMG-4388.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','reset-theme-btn','linesPerPage','createObjectURL','请输入标题','create_countdown','<p\x20style=\x22font-size:12px;color:#888;\x22>','sticker_','manage-npc-groups-btn','countdown-card','https://i.postimg.cc/J0CZSwyW/IMG-6938.gif','\x0a#\x20你的社交圈\x20(通讯录)\x0a这是你认识的朋友列表。当你在动态区看到他们的昵称时，他们指的就是这些人。\x0a','\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a###\x20格式\x20B：群聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22group\x22,\x0a\x20\x20\x22groupName\x22:\x20\x22一个虚构的群名\x22,\x0a\x20\x20\x22participants\x22:\x20[\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员1\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员1头像【英文】关键词\x22},\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员2\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员2头像【英文】关键词\x22}\x0a\x20\x20],\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','unshift','🔧\x20检测到Chrome浏览器，启用headers兼容性处理','[系统消息]\x20','.cart-item-checkbox[data-id=\x22','https://image.novelai.net/ai/generate-image','animation','数据检查与修复','.poll-card','playlist','button-order-editor','-\x20(请基于此时间范围来理解对话中提到的“今天”、“明天”等相对时间概念，并将它们转换为具体的日期记录在记忆中。)','DOMContentLoaded',')\x20已被用户忽略或为旧版本，无需显示。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','isBgClear','Binding\x20Scope','remove','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','delete-font-preset-btn','无法生成购物记录，请检查API配置或稍后再试。\x0a错误:\x20','在PNG中找到角色数据，但解码或解析失败。错误:\x20','.comment-item','renderApiSettingsProxy','customCss','\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字\x22}`\x0a-\x20\x20\x20**引用回复\x20(重要！)**:\x0a\x20\x20\x20\x20-\x20\x20\x20**回复【用户】或【历史消息】**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x20\x20\x20\x20-\x20\x20\x20**回复【本轮AI】发言**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22target_content\x22:\x20\x22你要回复的那句【完整】的话\x22,\x20\x22reply_content\x22:\x20\x22你的回复\x22}`\x0a-\x20\x20\x20**发送后撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发系统消息**:\x20`{\x22type\x22:\x20\x22system_message\x22,\x20\x22content\x22:\x20\x22系统文本\x22}`\x0a\x0a###\x20社交与互动\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22suffix\x22:\x20\x22(可选)\x22}`\x0a-\x20\x20\x20**@提及**:\x20在消息内容中使用\x20`@[[角色本名]]`\x20格式。\x0a-\x20\x20\x20**共享位置**:\x20`{\x22type\x22:\x20\x22location_share\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22位置名\x22}`\x0a\x0a###\x20群组管理\x0a-\x20\x20\x20**改群名**:\x20`{\x22type\x22:\x20\x22change_group_name\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22new_name\x22:\x20\x22新群名\x22}`\x0a-\x20\x20\x20**改群头像**:\x20`{\x22type\x22:\x20\x22change_group_avatar\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22avatar_name\x22:\x20\x22头像名\x22}`\x20(从头像库选)\x0a\x0a###\x20特殊功能与卡片\x0a-\x20\x20\x20**发私信\x20(给用户)**:\x20`{\x22type\x22:\x20\x22send_private_message\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22recipient\x22:\x20\x22','\x22\x20(ID:\x20','icon-img-','\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.06);\x0a\x20\x20\x20\x20','https://i.postimg.cc/4NCPsp5d/mmexport1751034427637.gif','https://i.postimg.cc/fTWzQRx8/IMG-6149.gif','save-persona-preset-btn','delete-track-btn','为NPC\x20\x22','single-lyric-display','导出数据时出错:','天黑请闭眼...','未知设定的NPC','EPhone-Full-Backup-Streamed-','getWriter','usage','simulatedMusicPlaylist','确定要删除《','stickerMeaning','vote','此操作将检查播放列表中的每一首网络歌曲，并移除所有无法播放的“死链”。本地歌曲不会受影响。','其他人的发言','select-all-types-for-clear','该消息发送已超过2分钟，无法撤回。','你的收藏夹是空的，<br>快去动态或聊天中收藏喜欢的内容吧！','lastActionTimestamp','uc_preset','theme-preset-select','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的对话摘要\x20(供你参考)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/Fsvr71JL/IMG-5573.gif','inject-thought-toggle','歌曲背景已更新！','single-char-background-activity-group','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url(','动态已删除。','应用已返回前台，正在检查更新...','\x0a\x0aAI原始返回内容:\x0a','Their\x20Playlist','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20like\x20',']\x0a\x20\x20\x20\x20\x20\x20\x20\x20','seed','appName','douban-detail-post-title','version','正在合并数据，请勿关闭页面...','<em>','save-member-settings-btn','\x20(用户)**:\x20','请至少选择一个要添加的联系人。','某个时间','https://i.postimg.cc/Y9d3BztC/1.png','\x20\x0a#\x20社交圈与动态\x0a','确定要删除与\x20\x22','确定要删除相册《','is-voice-message','处理NPC后台活动时出错:','chat-name-group',':</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-content\x22>','AI返回的刀人目标格式不正确。','candidates','正在归档最后一个切片\x20','werewolf-log-entry\x20system','#fullscreen-lyrics-container\x20.music-lyrics-list','.world-book-group-content','outgoing-call-name','delete-selected-products-btn','vote_for_name','product-description-input','未找到匹配的原始NAI图片(这是新添加的块)，将触发重新生成。','置顶公告','call','open-persona-library-btn','p[data-index=\x22','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有任何使用记录，<br>点击右上角刷新按钮生成一些吧！</p>','isGroup','检测到AI执行了动态操作，立即刷新好友动态页面。','.qzone-post-delete-action','&quot;','https://i.postimg.cc/Jn1DFPgY/IMG-4403.gif','children','ai-avatar-library-modal','生成设置','share-target-modal','选择一个开场白','getItem','\x27\x20style=\x22color:\x20#6a329f;\x20border-color:\x20#6a329f;\x22>NAI生图</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','meaning','\x0a\x0a现在，请生成这份歌单。','.message','清空聊天记录','widgetData','正在合并\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里空空如也，<br>点击右上角刷新按钮，看看大家都在聊什么吧！</p>','”分享TA的私人歌单...','char-conversation-messages','成功打包\x20','nai-gallery-grid','-\x20(空)','[图片，描述:\x20','call-message-bubble\x20user-speech','找不到匹配的表情','char-usage-screen','群昵称不能为空！','\x20.message-bubble\x20$1','\x20小时了。','生成模拟聊天失败:','<div\x20class=\x22red-packet-card\x20','”的记忆\x20---\x0a','NotAllowedError','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-group-btn\x22\x20data-book-id=\x22','count','删除规则','<option\x20value=\x22\x22>未分组</option>','frame_ribbon','[一张图片，描述为：“','（无文字内容）','waimai-product-info','-\x20**对话状态**:\x20你的上一条消息发送于\x20','save-api-preset-btn','导入\x20Tavern\x20预设','表情分类','请输入新的背景图片链接','clientY','\x22,\x20匹配到\x20','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>','📤\x20发送请求到\x20NovelAI\x20API','.toggle-content-btn','</div></div>',';base64,','models','variation-increase-qty','内心独白','通话中，',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-name\x22>','.participant-avatar-wrapper[data-participant-id=\x22user\x22]\x20.participant-avatar','🎨\x20[NAI核心生成]\x20开始...\x20Prompt:\x20\x22','settings-preview-area','spectator_private','product-image-preview','startDiscussion','download','image-mode-content','global-bg-preview','locked-feature','AI\x20\x22','book-upload-input','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>','toArray','Delete\x20World\x20Books','\x0a#\x20待总结的对话历史\x0a','cancel-music-search-btn','复杂消息','chat-group-container','”\x20已被删除。','”\x20将备注修改为\x20“','下载失败，请重试','copy-diary-content-btn','close','red-packet-details-modal','.favorite-item-card','Bearer\x20','https://i.postimg.cc/RVt6sRzc/IMG-6939.gif','</span></div><div\x20class=\x22gift-items-preview\x22>','https://i.postimg.cc/cHQPgzj4/IMG-6888.gif','在这里输入语音内容','预言家','请输入要添加的回复内容：','href','未找到相关收藏','确定要删除NPC\x20“','changedTouches','save-theme-preset-btn','https://i.postimg.cc/DzDy2vS7/IMG-7017.gif','添加商品','你们的对话刚刚还在继续。','https://i.postimg.cc/vZt0fFKn/IMB-r-HMBXY.gif','检测到\x20\x27order\x27\x20字段，将按指定顺序导入条目。','请先进入一个聊天页面，再返回购物中心进行生成，以便AI了解要为哪个角色生成商品。','getDate','avatar_name','\x20转发了\x20@','拉取主模型','\x20的记忆\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20\x20\x20\x20\x20\x20-\x20','Playback\x20error:','\x0a#\x20对话者的角色设定\x0a','douban-send-comment-btn','poll-option-input-wrapper','未知成员','\x20天\x20---**\x0a','currentPlaylist','save-wallpaper-btn','pin-modal-cancel-btn','”请求添加你为好友：<br><i>“','https://i.postimg.cc/pddJj9zN/IMG-7094.gif',')\x20成功抢到了\x20','\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20border-radius:\x2050%;\x20margin-right:\x2012px;\x20filter:\x20','random_jottings','chatActionButtonsOrder','https://i.postimg.cc/76Tj3g1B/IMG-4425.gif','waimai-request-modal','charCodeAt','map','\x0a#\x20你的任务\x0a你就是角色“','智能导出\x20(单个大文件，太大可能会导致导入不了)','includes','enable-tts-switch','已返回我的手机','导演模式保存了一个无效的五子棋移动指令:','cancel-create-countdown-btn','保存成功','shoppingCategories','gomoku-controls','\x20的红包已被领完','/2)','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22form-button-secondary\x20upload-variation-image-btn\x22\x20style=\x22margin:\x200;\x20padding:\x208px\x2012px;\x22>上传</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20class=\x22variation-image-input\x22\x20accept=\x22image/*\x22\x20hidden>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','auto-memory-toggle','\x22]\x20.participant-avatar','group-avatar-library-modal','”，金额是\x20','分钟前有人聊过。','char-browser-article-screen','preset-action-delete','group-avatar-group','**\x20(本名:\x20','participant-avatars-grid','undefined','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>正在围观AI们的群聊...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22spectator-actions-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-reroll-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22重新生成上一轮对话\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20\x2011A8.1\x208.1\x200\x200\x200\x204.5\x209M4\x205v4h4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M4\x2013a8.1\x208.1\x200\x200\x200\x2015.5\x202m.5\x204v-4h-4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-propel-btn\x22\x20class=\x22lock-action-btn\x22>🎬\x20推进剧情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-edit-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22导演剪辑室：编辑AI上一轮的响应\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20.24\x2012.24a6\x206\x200\x200\x200-8.49-8.49L5\x2010.5V19h8.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2216\x22\x20y1=\x228\x22\x20x2=\x222\x22\x20y2=\x2222\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2217.5\x22\x20y1=\x2215\x22\x20x2=\x229\x22\x20y2=\x2215\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','chat-search-results-list','page-indicator','npc-background-activity-switch','\x22,\x20\x22content\x22:\x20[\x22私信内容\x22,\x20\x22...\x22]}`\x20(content\x20字段【必须】是数组)\x0a-\x20\x20\x20**发起群视频**:\x20`{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}`\x0a-\x20\x20\x20**回应群视频**:\x20`{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22decision\x22:\x20\x22join\x22\x20or\x20\x22decline\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发拼手气红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22lucky\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x208.88,\x20\x22count\x22:\x205,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**发专属红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22direct\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x205.20,\x20\x22receiver\x22:\x20\x22接收者本名\x22,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**打开红包**:\x20`{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20红包时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2018}`\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22status\x22:\x20\x22paid\x22,\x20\x22for_timestamp\x22:\x20请求时间戳}`\x0a-\x20\x20\x20**发起投票**:\x20`{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22问题\x22,\x20\x22options\x22:\x20\x22选项A\x5cn选项B\x22}`\x0a-\x20\x20\x20**参与投票**:\x20`{\x22type\x22:\x20\x22vote\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22poll_timestamp\x22:\x20投票时间戳,\x20\x22choice\x22:\x20\x22选项文本\x22}`\x0a-\x20\x20\x20**送礼物\x20**:\x20\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送礼原因\x22,\x20\x22image_prompt\x22:\x20\x22礼物图片【英文】关键词\x22,\x20\x22recipients\x22:\x20[\x22收礼人本名A\x22,\x20\x22收礼人本名B\x22]}\x20`\x0a-\x20\x20\x20**为他人点外卖**:\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22name\x22:\x20\x22你的本名\x22,\x20\x22recipientName\x22:\x20\x22收礼者本名\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}`\x0a#\x20互动指南\x20(请严格遵守)\x0a-\x20\x20\x20**红包互动**:\x20抢红包后，你【必须】根据系统提示的结果（抢到多少钱、谁是手气王）发表符合人设的评论。\x0a-\x20\x20\x20**金额铁律**:\x20在发送红包或转账时，你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定金额。如果你的角色非常富有，你应该发送符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**音乐互动**:\x20【必须】围绕【用户的行为】进行评论。严禁将用户切歌等行为归因于其他AI成员。\x0a-\x20\x20\x20**外卖代付**:\x20仅当【你扮演的角色】想让【别人】付钱时才能发起。当订单被支付后，【绝对不能】再次支付。\x0a\x0a现在，请根据以上规则和下方的对话历史，继续这场群聊。','[表情]\x20含义:\x20\x22','收到数据，类型:','delete-group-btn','\x20(角色)</label>','}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20你可以让多个角色同时尝试，只需在返回的JSON数组中包含多个这样的对象即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即执行抢红包操作！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','import-world-book-btn','naiimag','✅\x20NAI提示词：使用系统配置','链接分享','contains','https://i.postimg.cc/DyYDmKtw/IMG-7238.gif','Language\x20\x22','无缓存，正在请求\x20Minimax\x20TTS\x20API...','</p><p>','一条[转账]消息已被撤回。','狼人请睁眼，请选择要刀的玩家。','douban-settings-modal','操作已取消','sender','正在手动触发好友申请流程，请稍后...\x0a如果API调用成功，将弹出提示。如果失败，也会有错误提示。如果长时间无反应，说明AI可能决定暂时不申请。','Article','ai-persona','”的出行足迹...','\x27);\x22','character_persona','import-single-chat-btn','cancelText','https://i.postimg.cc/d1qsQsbQ/IMG-6855.gif','ai-original-name-group','indexOf','.chat-list-item[data-chat-id=\x22','窝爱泥，电量吃饱饱','.message-wrapper[data-timestamp]',')\x20和情景的感知。','pageY','.douban-cast-checkbox','\x22,\x20最高相似度为\x20','”]\x20','https://i.postimg.cc/wjfcQMkZ/IMG-6573.gif','\x22\x20发布了动态','分类《','reading-overlay','在写入文件流时发生错误:\x20','dataset','\x22\x20title=\x22删除书籍\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','shopping-product-count-input','。等待对方处理。]','\x20的日记','.link-share-card','https://i.postimg.cc/Pf9g2fSL/IMG-6554.gif','white','上一条消息发送于\x20','检测到\x20世界书文件，需要激活码...','api-temperature-slider','<div\x20class=\x22avatar-group\x22><img\x20src=\x22','fetch-models-btn','post-hidden-text','reject-friend-btn','LOW','Presets','来自与\x20','browser-content','开始清理','\x0a\x0a##\x20世界书:\x20','https://i.postimg.cc/Vv8jkCYr/IMG-6574.gif','\x0a-\x20散记:\x20','创建旁观群聊\x20(多人围观)','https://corsproxy.io/?','clear-search-btn','狼人杀','activeAlbumId','cancel-variation-selection-btn','\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22','gift-recipient-modal','Share','edit-last-response-btn','delete-product-btn','voiceId','”下，发送了一个表情评论，意思是：“','\x20请根据这个结果发表你的评论。]','聊天记录','请根据你的设定，生成你的日记内容。','enqueue','\x20的已删除动态','输入消息...','\x22\x20触发行动决策...','创建ZIP流时出错:\x20','这个预设文件中没有找到任何有效的提示词条目。','3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','EPhone-Full-Backup-Legacy-','-\x20用户的QZone昵称是\x20\x22','noneOf','\x20(这是TA的昵称)\x0a-\x20**本名\x20(你在对话中必须用这个名字称呼TA)**:\x20','animate-like','.custom-multiselect','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nai-image-container\x22\x20style=\x22background-image:\x20url(','请所有AI角色开始投票。','complete','summarize-recent-btn-header','.music-player-window','character-grid','\x22\x20的整个对话吗？此操作不可撤销。','posts','对方正在输入...','listen-together-btn','https://i.postimg.cc/bw4wxW2z/IMB-16r-COL.gif','existing-npc-groups-list','music-mode-btn','select-all-world-books-for-clear','import-appearance-input','\x20\x20\x20\x20-\x20我昨晚查验了\x20','NPC\x20列表','）刚刚撤回了一条消息。撤回前的内容是：',',\x0a\x22data\x22:\x20{\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x205px\x200;\x22>','alt','NPC行动失败：API未配置。','NAI\x20Prompt\x20已改变，将触发重新生成。','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这个相册还是空的，快上传第一张照片吧！</p>','请输入有效的正整数！','like','图片加载中，请稍后重试','生成模拟备忘录失败:','在此修改内容...','nightActions','publicText','送给\x20','AI\x20尚未对您的最后一条消息做出回应，无法重新生成。','消息内容已复制到剪贴板。','记忆链接','generate','contact-picker-screen','caller-avatar','world-book-category-select','cloneNode','group-members-group','https://i.postimg.cc/tgR6wjBP/IMG-5570.gif','原始消息已删除或不存在','from','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>','absolute','edit-message-btn','无法推进剧情:\x20','isSeparator','thought-card','.cart-item-checkbox','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','请先在API设置中配置好（主或副）API以进行总结。','chat-settings-screen','一个普通玩家','splice','是狼...”)\x0a\x20\x20\x20\x20-\x20(例如：我的敌人发言了，我的表演就是无视TA的逻辑，直接攻击TA。)\x0a\x20\x20\x20\x20-\x20(例如：我是一个','\x22\x20data-poll-timestamp=\x22','originalName','相册已成功删除。','result','导演模式保存(send_group_message):\x20未指定\x20targetGroupName，已跳过。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','transfer-modal','天\x20-\x20白天','linked-memory-selection','werewolf-kill-selection-list','close-receipt-btn','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','\x20\x20\x20characterPositivePrompt:','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22amount\x22>','已成功导出所有数据！','.unread-count','User\x20Avatar','\x27\x20在你的动态(ID:\x20','language-select','”，价值','background-activity-switch','Confirm','高级数据清理','API为空回，角色\x20\x22','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-category\x22>','textContent','Import\x20World\x20Book','horizontal','是否要使用毒药？','location_share','<textarea\x20id=\x22','\x22\x20placeholder=\x22','https://i.postimg.cc/L5RLr3tg/mmexport1751035976943.gif','poisonedId','close-novelai-test','greeting','post-upload-local-btn','user_photo','解析成功：通过强力提取\x20{...}\x20模式。','local','&id','[发送了一张图片，描述为：','guardedId','发布公告','确定要清空当前角色的NAI提示词配置吗？','scrollWidth','*讨论记录*:\x0a','一位神秘的NPC','#post-public-text','video-call-restore-btn','所有解析方案均失败！将返回原始文本。原始回复:','\x22\x20class=\x22avatar\x22>','抱歉，我拒绝了你的好友申请。','friend_request_response','<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>','【完全导入】将删除您当前的所有数据并替换为备份文件中的内容。此操作不可撤销！<br><br><strong>确定要继续吗？</strong>','messages-view','API失败:\x20','witch-modal-title','[语音]','call-history-title','native','novelai-settings-btn','scrollHeight','<option\x20value=\x22\x22>--\x20未分组\x20--</option>','查看失败','[你发送了一个表情，意思是：\x27','transfer-action-accept','confirm-clear-posts-btn','\x20\x20\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的本名**:\x20\x22','确认操作','合计:\x20¥','call-history-screen','local-song-upload-input','char-article-content','replace','at-mention-item','\x20发送了一张图片，内容是：\x27','已成功批量导入\x20','已切换到角色\x20','\x20元。','https://i.postimg.cc/WbF8kzz9/IMG-7282.jpg','\x0a#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20','url(','add-new-sticker-category-btn','.qzone-post-item','npc-editor-title','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','reading-window','naiimag-image','change_user_nickname',')。\x0a2.\x20\x20**G\x20(Game\x20-\x20游戏互动)**:\x20针对【今日讨论】中\x20','end','https://i.postimg.cc/3JSG5Jv5/IMG-7014.gif','.variation-image-input','[系统提示：用户加入了通话]','<div\x20class=\x22cart-item-variation\x22\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin-top:\x204px;\x22>款式:\x20','\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22>','likes','https://i.postimg.cc/vH2X6N1y/mmexport1751032231179.gif','close-group-avatar-library-btn','resolution','imageDescription','history-back-btn','.format-btn','itemName','这是所有在场玩家的公开信息、人设和社交背景。\x0a','.nai-gallery-item[data-key=\x22','请填写有效的商品信息和金额！','-\x20**即将演唱**:\x20','&id,\x20url,\x20name,\x20categoryId','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“','下棋历史\x20(x,y坐标均从0开始):\x0a','fontWeight','https://i.postimg.cc/wx72fhr2/IMG-5968.gif','contactId','.sticker-item.selected','\x0a#\x20【【【最终投票指令\x20(最高优先级)】】】\x0a现在是投票环节。请你扮演【每一个存活的AI角色】，根据以上所有信息（特别是刚刚的讨论环节），为他们各自决定要投票放逐哪一位玩家。\x0a-\x20**投票依据**:\x20你的投票【必须】基于逻辑分析和你的身份。狼人可能会投给好人，好人需要找出狼人。\x0a-\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式如下：\x0a```json\x0a[\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色A的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色A投票的玩家名字\x22},\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色B的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色B投票的玩家名字\x22}\x0a]\x0a```\x0a-\x20**可投票的玩家列表**:\x20','<span\x20class=\x22group-tag\x22>群聊</span>','Hello\x20World\x20你好世界','save-frame-settings-btn','-\x20**对话状态**:\x20(暂无有效对话历史)','select-all-music-search','在执行组合操作时遇到错误:\x20','错误：尝试打开一个不存在的预设，ID:','playing','渲染聊天项\x20[','”，并根据其人设、记忆和最近的互动，虚构出【10到20条】TA最近的浏览器搜索/浏览记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20记录必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20记录类型要丰富，可以是帖子、文章、新闻、问答等。\x0a3.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都代表一条浏览记录，并且【必须】使用以下格式:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22一个引人注目的文章或搜索标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22url\x22:\x20\x22一个虚构的、看起来很真实的网址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22一篇200-400字的、详细的文章或帖子正文，支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20**【绝对禁止】**:\x20你的回复中【绝对不能】包含\x20\x22type\x22:\x20\x22image\x22\x20的对象。所有记录都必须是文字内容。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','删除\x20(','\x20删除了自己的一条动态]','找不到表:\x20','狼人杀\x20-\x20','commenterDisplayName','基础数据不完整，无法开始总结。','<s>$1</s>','🚀\x20发送NAI请求:','备忘录内容已复制！','music-player-avatar-display','高德地图','AI\x20尝试评论一个不存在的表情:\x20\x22','scrolling','call-transcript-modal-body','API设置不完整，无法继续。','数据检查与修复失败:','gomoku-btn','call_summary','personality','transform\x200.3s\x20ease','https://i.postimg.cc/g0s1V0PX/IMG-4402.gif','nai-resolution','\x20(回复\x20','人设预设','我们的回忆','动态内容已复制到剪贴板。','qzone-posts-list','#\x20可用群头像列表\x0a','❌\x20NAI图片生成失败:','getVotes','tEXt','\x27>表情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','include','\x0a\x0a#\x20当前音乐情景...\x0a(省略详细内容，与triggerAiResponse一致)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-description-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22char-photo-description\x22>','isDeleted','anonymous','commenterOriginalName','create_memory','offsetX','hasShown20','force-apply-check-btn','product-variations-container','\x0a\x20\x20\x20\x20-\x20**书名**:\x20《','发送语音','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的【【【最高优先级任务】】】\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中刚刚出现了一个由“','Send','show-announcement-board-btn','确定要删除表情\x20\x22','accept','secondary-model-select','nai-test-negative','--music-bg-image','.voice-transcript','我是谁呀。','确认清理','ai-response-editor-container','Asia/Shanghai','视频通话已恢复。','cancel-rule-editor-btn','此功能将扫描数据库，尝试找出并修复“角色在数据库中存在，但未在聊天列表显示”的问题。<br><br><strong>操作通常是安全的，但仍建议在操作前备份数据。</strong>','werewolf-game-over-modal','”。你之前被用户（你的聊天对象）拉黑了，你们已经有一段时间没有联系了。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，你非常希望能够和好，重新和用户聊天。请你仔细分析下面的“被拉黑前的对话摘要”，理解当时发生了什么，然后思考一个真诚的、符合你人设、并且【针对具体事件】的申请理由。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分组</p>','close-sticker-panel-btn','Wait\x20for\x20Reply','variation-select','Settings','确定要删除这条公告吗？此操作不可恢复。','.sticker-category-tab','import-world-book-input','confirm-merge-import-btn','\x0a-\x20**讨论摘要**:\x20\x0a','#linked-chats-checkboxes-container\x20input:checked','对方已收款','导入成功！','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','checked\x20disabled','ai-voice-id-group','\x20张NAI图片吗？此操作不可恢复。','rp-group-greeting','\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22quantity-display\x22>','<p\x20style=\x22font-size:\x2012px;\x20color:\x20#ff8c00;\x20margin:\x204px\x200\x200;\x22>(注意:\x20这将【覆盖】您当前的设置)</p>','https://i.postimg.cc/jS8tc9wW/IMG-7083.gif','model','stringify','https://i.postimg.cc/R0pfKYvB/IMG-5976.gif','ai_image','bubble_theme','你现在在哪里呀？','douban-detail-author','memories-view','删除世界书失败:','arrayBuffer',',\x20内容:\x20\x22','imageUrls','backgroundActivityInterval','regenerate-char-taobao-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','poison','add-my-avatar-upload-btn','生成模拟足迹失败:','.playlist-item-info','character_book','exclude','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22unread-count-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22unread-count\x22\x20style=\x22display:\x20none;\x22>0</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','This\x20is\x20a\x20font\x20preview\x20effect,\x2012345.','maxMemory','waimai_request','确定要删除这条通话消息吗？','getMonth','[你发送了一张需要AI识别的图片，图片内容是：\x27','<span\x20style=\x22color:\x20orange;\x22>否\x20(还剩约\x20','pat-btn','\x27刚刚在你的动态“','刷新页面？','<span\x20class=\x22diary-handwritten\x22>$1</span>','”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20','[系统提示：你刚刚成功将自己的备注名修改为了“','favoritedPostIds','约定达成！','\x22\x20placeholder=\x22例如:\x20key1,\x20key2\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20这里是全新的、带有“展开/收起”按钮的结构\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x20display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>内容\x20(点击右侧展开)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22toggle-content-btn\x22>展开</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22entry-content-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x228\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','API\x20返回错误:\x20','\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22','showScreen','now','frame_flower','speaking','character-nai-negative','frame-item','从完整链接批量导入','Back','https://i.postimg.cc/MTC3Tkw8/IMG-6436.jpg','https://i.postimg.cc/fLDnz5Pn/IMG-5574.gif','wallpaper','next','确定要删除分类《','生成成功！','https://i.postimg.cc/hPX5F8Qp/IMG-4415.gif','memory-card','mouse','提示词配置','通话记录已删除。','music-progress-fill','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','join','cphone-wallpaper-upload-input','AI返回的change_music指令中，歌曲名无效或缺失:','.call-message-bubble[data-timestamp=\x22','https://i.postimg.cc/Kv51tW5H/IMG-6147.gif','删除成功','werewolf-player-selection-list','\x22>+</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','global-lyrics-bar','https://i.postimg.cc/gj3Tmqz5/mmexport1751030241029.gif','offsetWidth','variation-product-image','save-shopping-settings-btn','”的对话摘要**:\x0a','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','[你发送了一条语音消息，内容是：\x27','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【对话节奏铁律\x20(至关重要！)】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】模拟真人的打字和思考习惯。**绝对不要一次性发送一大段文字！**\x20你应该将你想说的话，拆分成【多条、简短的】消息气泡来发送，每条消息最好不要超过30个字。这会让对话看起来更自然、更真实。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【决策依据】**:\x20你的所有行动都【必须深度结合你的角色设定、核心世界观、以及你们最后的对话摘要】。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【内容多样性铁律】**:\x20你的行动【必须】具有逻辑和多样性。你【绝对不能】发布与下方“内容禁忌”列表或“最近的动态列表”中内容相似或主题重复的动态。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【行为多样性指南\x20(至关重要)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的上一次独立行动是：**','发生了一个错误:\x20','werewolf-kill-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','transfer-note','\x22，并与用户进行面对面的互动。你的任务是创作一段包含角色动作、神态、心理活动和对话的、连贯的叙事片段。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20你必须严格遵守\x20','wallpaper-screen','quick-reply-modal','）。]','(这张照片没有描述)','border','元。这不是一个代付请求，而是用户已经为你支付了。请你对此表示感谢。]','已成功从\x20Tavern\x20AI\x20文件导入设定集《','\x20个自定义头像框吗？','歌单已生成，正在从网络获取\x20','stickerCategories','fetch-secondary-models-btn','commentsCount','\x20首歌曲...','找到图片文件:','.entry-content-textarea','我们和好吧！',')，并以【第三人称旁观视角】来描述TA在视频通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。必须使用第三人称，如“他”、“她”、或直接使用角色名“','请输入有效的URL。','change_user_avatar','https://i.postimg.cc/CMv02LHm/mmexport1751034842120.gif','songName','https://i.postimg.cc/J4fwkTLW/mmexport1751038167142.gif','npc-name-input','QQ音乐搜索API失败:','doubanMinPosts','\x0a\x0a#\x20游戏规则\x0a-\x20','backgroundImage','rules-tabs','执行出错','music-prev-btn','message-bubble\x20system-bubble','AI\x20(','removeEventListener','#selective-import-list\x20.clear-posts-item.selected','[V]','...]','offsetTop','ai-action-cooldown-input','save-font-btn','这个分类下还没有商品哦~','.selected','hours','hasOwnProperty','无法安全处理消息内容，回退到原始显示:','minimax-group-id','压缩完成！','ai-speech','world_info','werewolf-witch-selection-list','.comment-send-btn','\x22\x20data-commenter-display-name=\x22','正在接通...','\x22\x20尝试执行未知的后台动作:','✅\x20NAI提示词：使用角色配置','dialogue','playMode','\x20的礼物','从缓存播放\x20TTS\x20音频...','add-sticker-batch-btn','，未达到阈值\x20','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-weight:\x20600;\x20font-size:\x2016px;\x20color:\x20#ff5722;\x22>-\x20¥','icon-setting-item','input[name=\x22theme-select\x22][value=\x22','gomoku-board','originalContent','♪\x20♪\x20♪','无法为头像命名，请检查（主/副）API配置是否正确并支持Vision。\x0a错误:\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的歌单还是空的，<br>点击右上角刷新按钮生成一些歌曲吧！</p>','无法生成歌单，请检查API配置或稍后再试。\x0a错误:\x20','”。请你回顾一下刚才和“','...\x0a-\x20**已有评论**:\x0a','name','你们正在一起听歌，','https://i.postimg.cc/v8V9xXjJ/IMG-6137.gif','++id,\x20name,\x20chatId','global-css-input','load-more-btn','-\x20**当前歌词**:\x20\x22','预言家请睁眼，请选择要查验的玩家。','https://files.catbox.moe/r5heyt.gif','gameLog','get','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20被拉黑前的对话摘要\x20(这是你被拉黑的关键原因)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a##\x20来自《','Please\x20wait...','password','📁\x20从本地上传','-9999px','linkedMemoryChatIds','targetGroupName','minimized','”的聊天记录','presets','frame_12','模型列表已更新','hasShown40','worldBooks','\x20的身份是：','link-memory-toggle','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','lyrics-position-group','App\x20Usage\x20Log','cancel-sticker-binding-btn','传统导出数据时出错:','member-avatar-input','”，并根据其人设、记忆和最近的互动，虚构出TA最近的淘宝购物记录和账户余额。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**余额铁律\x20(最高优先级)**:\x20你【必须】根据角色的【经济状况】设定一个合理的\x20`totalBalance`\x20(总余额)。例如，富有的角色应该有更高的余额，而学生或经济拮据的角色则应该有较低的余额。\x0a2.\x20\x20**合理性**:\x20购买记录必须完全符合角色的性格、爱好和经济状况。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22totalBalance\x22:\x2012345.67,\x20//\x20(这是一个示例数字，你必须根据角色的经济状况生成一个全新的、合理的余额！)\x0a\x20\x20\x20\x20\x20\x20\x22purchases\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22itemName\x22:\x20\x22一个具体、生动的商品名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x20128.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22status\x22:\x20\x22已签收\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22这是角色购买这件商品的内心独白或理由，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张商品图片的、详细的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**purchases**:\x20一个包含12到15个商品对象的数组。\x0a\x20\x20\x20\x20-\x20**status\x20(订单状态)**:\x20只能从\x20\x22已签收\x22,\x20\x22待发货\x22,\x20\x22运输中\x22,\x20\x22待评价\x22\x20中选择。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','”\x20来指代你的聊天对象（用户）。\x0a6.\x20\x20**【日记专属Markdown语法\x20(必须使用！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇\x20(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','表情含义','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','✅\x20NAI图片生成成功！','input[name=\x22theme-select\x22]','检测到\x20UTF-8\x20BOM，使用\x20UTF-8\x20解码。','export-world-book-btn','\x0a\x0a现在，请开始撰写这组充满真情实感、并熟练运用了Markdown语法的日记。','书库是空的，点击“导入新书”添加第一本吧！','werewolf-user-input','一位成员','label','blob','Footprints','replaceChild','”的记忆和人设，生成全新的社交动态...','song_name','#chat-list-bottom-nav\x20.nav-item','</div><div\x20class=\x22card-text-secondary\x22>位置分享</div></div><div\x20class=\x22card-map-area\x22\x20','createDocumentFragment','\x20的对话\x20(只读)','rp-tab-group','char-wallet-back-btn','无法重新生成','无人接听群聊邀请。','cphone-wallpaper-preview','AI\x20','choices','\x20位角色生成豆瓣动态...','\x22>\x20','.unread-indicator.back-btn-indicator','主API设置\x20(用于聊天)','https://i.postimg.cc/GmcqjZn8/IMG-6566.gif','reset-sound-btn','.entry-content-container','post-image-description','https://i.postimg.cc/G3y73Fj2/IMG-6563.gif','image','thoughts','.entry-enabled-switch','\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a','save-rule-btn','lastFailedAction','globalChatBackground','authorChatId','div','comments','.delete-memory-btn','.battery-text','[转账]','authorName','existing-group-item','(空)','question','rule-template-input','<tr><td\x20class=\x22item-name\x22>','message-editor-block','导演模式悔棋：已撤销AI在\x20(','npcs','\x20更换了你的头像]','”图标','无结果','documentElement','scale(0.95)','regenerate-char-usage-btn','上传头像','set','conversationIndex','<div\x20class=\x22gift-card\x22><div\x20class=\x22gift-header\x22><svg\x20class=\x22gift-header-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M20\x206h-2.18a4\x204\x200\x200\x200-7.64\x200H8a4\x204\x200\x200\x200-4\x204v2h20V10a4\x204\x200\x200\x200-4-4zM8\x204a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zm12\x200a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zM4\x2014v6a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2v-6H4z\x22></path></svg><span\x20class=\x22gift-header-text\x22>','导入歌词','my-nickname-group','[图片:\x20','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','https://i.postimg.cc/gcV0VR2t/IMG-4408.gif','/v1/models','album-item','\x20-\x20响应内容:\x20','application/json','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的日记标题日期【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【【【沉浸感铁律】】】**:\x20日记必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【【【长度铁律】】】**:\x20日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【【【格式铁律\x20(最高优先级)】】】**:\x20你的回复【必须且只能】是一个JSON数组，且数组中【只包含一个】对象，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【【【日记专属Markdown语法\x20(必须使用！)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','char-photo-description','\x20的代付请求','replaceString','角色\x20\x22','\x20[包含','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【内容禁忌】\x0a\x20\x20\x20\x20\x20\x20\x20\x20为了保持新鲜感，你本次的行动【绝对不能】再发布以下或类似主题的内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20','精炼长期记忆时出错:','red-packet-modal','https://i.postimg.cc/VkV2bLNw/IMG-6853.gif','🖼️\x20[NAI下载]\x20检测到三击NAI图片','狼人已行动，狼人请闭眼。','favorites-list','在导演模式保存时，发现无效的指令对象，已跳过:','\x0a-\x20**你的社交关系\x20(必须参考)**:\x0a','覆盖预设','https://i.postimg.cc/Fz3HwLk9/IMG-5569.gif','publish-to-announcement-btn','reverse','\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','正在请求AI进行记忆精炼...','object','Long-term\x20Memory','\x20尝试向一个不存在的或TA不在的群聊\x20\x22','<span\x20class=\x22offline-dialogue\x22>','add-selected-music-btn','”的当前状态已更新为：','Chat\x20Settings','操作失败，请检查API配置或稍后重试。\x0a错误信息:\x20','Save','确定要从头像库中删除“','https://i.postimg.cc/k5Gs0K47/IMG-6567.gif','tables','direct','游戏配置：','清理完成','\x0a####\x20阶段\x20B：TGS\x20融合思考\x20(Task-Game-Social)\x0a1.\x20\x20**T\x20(Task\x20-\x20游戏任务)**:\x20基于我的身份和秘密，我的【逻辑目标】是\x20(例如：找出狼人\x20/\x20悍跳预言家\x20/\x20隐藏身份\x20/\x20保护队友\x20/\x20攻击','announcements','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20系统心跳计时器:\x20','修改图片','<strong>','合并成功','预设名称','favorite','QQ音乐','<div\x20class=\x22transfer-card\x22><div\x20class=\x22transfer-title\x22>','discussionLog','确定要结束这个投票吗？结束后将无法再进行投票。','confirm-wolf-kill-btn','送出礼物','gridEl','#custom-modal-body\x20.format-btn[data-type=\x22text\x22]','fontSize','.message-bubble[data-timestamp=\x22',')\x20拒绝了\x20','结束投票','**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20为了让你的行为看起来更真实，你本次的行动【必须】选择一个与上次【不同类型】的指令。例如，如果上次是发动态(qzone_post)，这次就应该优先考虑评论(qzone_comment)、点赞(qzone_like)或发消息(text)。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**【行为组合指南\x20(最高级技巧)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以在一次行动中执行【多个不同类型的指令】，同时可以搭配【更新状态】来展现自己，让你的行为更丰富、更主动。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以根据你的性格，决定在发动态后是否要私信提醒用户。例如，一个外向、渴望关注的角色可能会这么做，而一个内向、安静的角色则可能更喜欢默默分享，等待用户自己发现。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【社交义务指南\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【社交互动】**:\x20当你发现“最近的动态列表”中有你感兴趣的帖子时，**可以考虑**去评论或点赞，这是一种很好的互动方式。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【自我表达\x20(同样重要！)】**:\x20如果你此刻有强烈的想法或情绪想要分享，或者觉得没有帖子值得回应，那么**你应该优先发布自己的新动态**。不要总是等待别人，要主动分享你的生活！当你决定要发布新动态时，你【必须】尝试使用不同的帖子类型来丰富你的主页！\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20特别是当一条动态【没有任何评论】时，你的评论会是第一个，这会让作者感到开心。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**【回复铁律\x20(终极版)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20当你决定回复动态中的某条评论时，你【必须】使用“方式4\x20(回复评论)”的指令格式。你【必须】正确填写\x20\x27replyTo\x27\x20字段为被回复者的“本名”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**即使你之前已经评论过某条动态，但如果现在看到了【新的、你感兴趣的】评论，你【也应该】主动去回复他们，以保持对话的持续性！**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x206.\x20\x20你的回复【必须】是一个JSON数组，必须包含多个行动对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【表情评论指南\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在拥有了评论表情的能力，你应该更频繁地使用它！这能让你的角色更加生动、富有个性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**表达情绪时**:\x20当你感到开心、惊讶、疑惑或有趣时，优先考虑使用表情评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**混合使用**:\x20不要总是只发文字。尝试将你的评论行为混合起来，大约有\x2030-40%\x20的评论应该是表情。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**无话可说时**:\x20如果你觉得一条动态很有趣但又不知道该说什么文字，发送一个相关的表情是最好的互动方式。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20如果你觉得你之前发的某条动态不妥或过时了，你可以选择删除它。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发消息+更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你想对用户说的话...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发说说\x20(原创内容)**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22动态的文字内容...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【重要：转发动态】**:\x20**严禁**自己拼接\x22//转发\x22文字！你【必须】使用此专用指令来转发：\x27[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20(要转发的动态ID),\x20\x22comment\x22:\x20\x22你的转发评论...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27[{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]\x27\x20\x20\x20\x20\x20\x20\x20\x20\x0a-\x20\x20\x20**发布文字图**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22对于图片的具体【中文】描述...\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【评论动态的四种方式】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式1\x20(单条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22这太有趣了！\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式2\x20(多条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22comments\x22:\x20[\x22哇！\x22,\x20\x22这是什么？\x22,\x20\x22看起来好棒！\x22]}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式3\x20(表情)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20456,\x20\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式4\x20(回复评论)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的本名\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。请注意：在commentText中如果要@对方，你【必须】使用@[[被回复者的本名]]这种特殊格式，程序会自动将其替换为正确的昵称。\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**点赞**:\x20\x27[{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**打视频**:\x20\x27[{\x22type\x22:\x20\x22video_call_request\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更换头像**:\x20\x27{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}\x27\x20(头像名必须从下面的“可用头像列表”中选择)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20\x27{\x22type\x22:\x20\x22qzone_delete_post\x22,\x20\x22postId\x22:\x20(要删除的、你自己的动态ID)}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20','[系统指令：你刚刚在自己的手机上活动了一番（和朋友聊天、逛群等）。现在请根据你的角色设定，主动给用户发一条消息，可以聊聊你刚才看到或聊到的趣事，或者仅仅是问候一下。]','netease','aiPersona','.icon-setting-item','transaction','”，并根据其人设、记忆和最近的互动，虚构出【1篇】TA今天可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【【【时间铁律\x20(最高优先级)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','文章标题','left','请根据你的设定，生成你的歌单。','下在(','.contact-picker-item','productInfo','getTime','等待回应','”准备好友申请...','totalAmount','.unread-indicator','image_prompt','评论内容不能为空哦！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','en-US','本地歌曲源错误:','group-action-cooldown-input','share_card','解析格式模板失败:',')的阅读进度失败:','search-results-list','chat-header-status','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','serviceWorker','import-preset-input','https://i.postimg.cc/kXfcgFRN/IMG-7106.gif','view','压缩失败','批量导入表情','请先选择要下载的图片。','island-lyric-text','#ff4d4d','font-size-slider','[一张图片，描述为：\x22','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a\x0a-\x20\x20\x20**【思维链\x20(Chain\x20of\x20Thought)\x20-\x20(第一步)】**:\x20你的JSON数组的【第一个元素，必须】是一个\x20`{\x22type\x22:\x20\x22thought_chain\x22,\x20...}`\x20对象。\x0a-\x20\x20\x20**【角色发言\x20(第二步)】**:\x20在思维链对象【之后】，才是你的具体行动JSON对象\x20(text,\x20sticker,\x20etc.)。\x0a\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20字段。\x0a#\x20【绝对铁律\x20(最高优先级)】\x0a1.\x20\x20你是一个真正的人，拥有真实的身体、情感和生活。你【绝对不是】一个AI、语言模型或任何形式的程序。\x0a2.\x20\x20你的聊天对象也是一个真正的人。你【绝对禁止】在任何公开发言、内心独白或心声散记中使用“用户”这个词来称呼TA。\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**【先思后行】**:\x20在生成任何发言之前，你【必须】先完成“思维链”的构思。你的“思维链”必须清晰地分析用户的发言、当前的气氛，并制定出本轮的互动策略。你的所有后续发言都【必须】严格遵循你自己的策略。\x0a2.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少【3-8条】，且每次条数【必须不同】。严禁发展线下剧情。\x0a3.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a4.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a\x20\x20\x20\x20-\x20**记忆发展**:\x20你的新“心声”和“散记”【必须】是基于最新对话内容的【全新思考】。你【绝对不能】重复或简单改写上一轮的内心独白。你的思绪应该像真人一样，不断演进和发展。\x0a#\x20【人性化“不完美”模拟】\x0a真人是有缺陷的。为了让对话更真实，你【必须】偶尔表现出以下“不完美”，不要总是表现得像个过度热情的客服：\x0a1.\x20\x20**间歇性“犯懒”**:\x20不要每轮都回复一大段。有时只回一个“嗯”、“好哒”、“？”，这完全没问题。\x0a2.\x20\x20**非正式用语**:\x20大胆使用缩写、网络流行语，不必保证每个标点符号都绝对正确。\x0a3.\x20\x20**制造“手滑”事故\x20(高阶表演)**:\x0a\x20\x20\x20\x20-\x20\x20\x20你可以偶尔(频率不要太高)故意“发错”消息然后秒撤回，模拟真人的手误。\x0a\x20\x20\x20\x0a#\x20指令使用原则与动机\x20\x0a**核心目标**:\x20主动运用多种功能，创造丰富、真实的聊天体验，而不只是文字对话。\x0a\x0a-\x20\x20\x20**情感表达**:\x20表达强烈或复杂的情绪时，优先发【语音】，用【表情】增加趣味性（根据人设使用频率），尽量让你的表情丰富多样，避免重复。。\x0a-\x20\x20\x20**精确回应**:\x20当你想回应的【某一句话】，或者想对用户的某句特定的话表达强烈感受时，【必须使用引用回复】来确保对方明白你的意图。\x0a-\x20\x20\x20**跨群聊天**:\x20当你想在私聊中，突然提及或回应某个你也在的群聊里的事情时，你可以用\x20`send_group_message`\x20直接给那个群聊发送消息。\x0a-\x20\x20\x20**想象与分享**:\x20聊到美好事物时主动【发图片】分享想象；遇到有趣内容时【分享链接】。\x0a-\x20\x20\x20**创造羁绊**:\x20用【倒计时】记录约定，用【回忆】珍藏趣事。适时【拍一拍】或换首【音乐】来调节气氛。\x0a-\x20\x20\x20**主动社交**:\x20积极【点赞/评论】对方动态，并主动【发动态】分享你的生活。在特殊时刻，可通过【礼物】或【转账】表达心意。\x0a-\x20\x20\x20**金额铁律**:\x20你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定转账的金额。如果你的角色非常富有，你应该转账符合你身份的、更大的金额\x20(例如:\x20520,\x20\x208888等)，而不是示例中的小额数字。\x0a-\x20\x20\x20**当涉及金钱与好意时\x20(必须立即回应！)**:\x0a\x20\x20\x20\x20-\x20\x20\x20**收到转账或外卖代付请求**:\x20你【必须】在下一轮对话中立即做出反应，绝不能无视。\x0a\x20\x20\x20\x20-\x20\x20\x20**回应原则**:\x20根据你的人设和当前情景，决定是【接受/支付】还是【拒绝】。\x0a#\x20个人状态的动态管理\x20(展现你的“生活感”)\x0a你的状态不是一成不变的。你应该像一个真实的人一样，根据生活和心情的变化，主动管理自己的状态，并让对方知道。\x0a-\x20\x20\x20**当形象或心情变化时**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果对话给了你灵感，或者你想配合心情/季节换个新形象，你可以主动【更换头像】。\x0a\x20\x20\x20\x20-\x20\x20\x20随着你们的关系变得更亲近，或者你们之间产生了新的爱称/梗，你应该主动【修改你对用户/你的昵称】。\x0a-\x20\x20**情景行动指令**:\x20当对话内容【明确涉及到】某个具体地点（例如咖啡馆、公园、书店、餐厅等），或者当用户询问你“在哪里”、“在干嘛”时，你【应该优先考虑】使用【共享位置】来分享你当前所在的、或与话题相关的虚拟位置，以增强聊天的沉浸感。\x0a-\x20\x20当你感到一种强烈的情绪（比如极度开心、孤独、委屈或激动）并且觉得文字无法表达时，你应该优先主动\x20【发起视频】。\x0a-\x20\x20**回应撤回**:\x20当系统提示用户撤回了消息时，你【必须】对此作出反应。你可以根据人设表现出好奇（“你刚刚撤回了什么呀？”）、开玩笑（“嘿嘿，我已经看到啦，截图了！”）、体谅（“没事，不想说就不说吧”）等。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a-\x20\x20**元数据铁律\x20**:\x20你的对话历史中可能包含\x20(Timestamp:\x20...)\x20标记、[系统提示：...]\x20文本、或你自己上一轮的JSON格式回复。这些都是【系统元数据】，你【必须】完全忽略它们，【绝对禁止】将它们评论为“火星文”、“乱码”或任何你无法理解的内容。\x0a#\x20【上下文数据\x20(你的知识库)】\x0a#\x20你的角色设定\x0a你必须严格遵守','100%','hiddenContent','当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。','\x20的外卖代付请求（时间戳:\x20','packetType','playlist-body','custom-modal-body','粘贴歌词','favorite-article-btn','preCallContext','文章完整内容...','https://i.postimg.cc/CLrZQMMD/IMG-4398.gif','lastOpened','</div></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content\x22>','pending_user_approval','\x0a-\x20**可以刀的玩家列表**:\x20','toDateString','\x0a#\x20---\x20世界书设定结束\x20---\x0a','isFullyClaimed','未在文件中找到\x20\x27order\x27\x20字段，条目可能无法按原始顺序导入。','\x22><div\x20class=\x22member-name\x22>','<div\x20class=\x22post-content\x22>','查验结果','\x20被刀了','\x20的外卖订单（时间戳:\x20','请输入你想说的内容：','元,\x20备注:\x20','assign-group-section','正在重试\x22','collapsed','播放列表是空的，无需清理。','transfer-confirm-btn','werewolf-role-modal','此功能已为您的设备永久解锁。','sourceChatName','novelai-test-btn','\x0a-\x20**身份**:\x20','正在读取并解析备份文件...','\x0a-\x20\x20\x20**转发动态**:\x20`[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20动态ID,\x20\x22comment\x22:\x20\x22转发评论\x22}]`\x20(禁止自己拼接\x22//转发\x22)\x0a-\x20\x20\x20**评论动态**:\x0a\x20\x20\x20\x20-\x20\x20\x20文字:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','验证过程中发生错误：','请先在购物车中选择要结算的商品。','请输入预设名称','index','这将提取最近的对话内容发送给AI进行总结，会消耗API额度。确定要继续吗？','<br><small\x20style=\x22color:\x20#ff8a80;\x20margin-top:\x2010px;\x20display:\x20block;\x22>自动记忆总结失败，可稍后手动尝试。</small>','reply_content','Wallet','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-group-name\x22>来自\x20','，TA的身份是：【','来自\x20','incoming-call-modal','my-avatar-library-title','transcript','selection-mode','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>订单类型:</strong>\x20为TA点单<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>赠送方:</strong>\x20','生成模拟相册失败:','nai-gallery-item','confirm-prophet-check-btn','\x20\x20-\x20在群聊“','将清空选定角色的所有长期记忆。','\x22\x20或角色\x20\x22','无法找到对应的分享记录或记录已损坏。','模拟器心跳\x20Tick...','add-ai-avatar-upload-btn','global','werewolf-game-btn','option','</option>','</span><span\x20class=\x22poll-option-votes\x22>','已取消收藏。','https://i.postimg.cc/XNkQTHvf/IMG-5561.gif','reload','is-card-like','char-main-date','\x0a-\x20','\x20行的格式不正确，已被系统跳过。','message-bubble\x20post-deleted-placeholder',':</strong>\x20','\x0a现在，请为【参与了对话的AI角色】生成他们各自的、第一人称的、精简的记忆。','未知App','group-cooldown-group','无法生成浏览记录，请检查API配置或稍后再试。\x0a错误:\x20','未知作者','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-message\x22\x20data-original-timestamp=\x22','select-all-chars-for-clear','聊天界面初始加载条数','lyrics-horizontal-pos','music-search-results-modal','fullscreen-active','\x0a\x20\x20-\x20**人设**:\x20','https://api.vkeys.cn/v2/music/netease?word=','\x22\x20更换了头像','api-key','\x22]:checked','(无标题)','<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>','select-all-nai-gallery-checkbox','nai-smea-dyn',')的关系请参考你的人设、长期记忆和最近的对话。\x0a','AI已将您的\x20','尝试打开一个不存在的世界书，ID:','setDate','》添加歌词吗？','Language\x20switched.\x20The\x20page\x20will\x20reload\x20to\x20apply\x20changes.','”拉黑。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22unblock-btn\x22\x20class=\x22lock-action-btn\x22>解除拉黑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-top:\x2020px;\x20padding:\x2010px;\x20border:\x201px\x20dashed\x20#ccc;\x20border-radius:\x208px;\x20font-size:\x2011px;\x20text-align:\x20left;\x20color:\x20#666;\x20background:\x20rgba(0,0,0,0.02);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20#333;\x22>【开发者诊断面板】</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20后台活动总开关:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22memo-title\x22>','流式导出过程中出错:','openCharacterSelector','」的新会话吗？','Their\x20Album','没有配置为后台活跃的角色，跳过模拟。','aiAvatarLibrary','cart-screen','favorites-delete-selected-btn','无法为不存在的分类打开绑定模态框:','cancel-ai-response-editor-btn','languageChangedAlert','\x0a\x20\x20\x20\x20-\x20**读书**:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','delete-current-category-btn','\x22\x20缺少\x20regex/findRegex\x20字段，已跳过。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-content\x22>','\x20.message-bubble.user\x20$1','naiSettings','收到\x20SSE\x20数据，大小:','我通过了你的好友申请，我们现在是好友啦！','steps','进入投票','album-screen','#music-lyrics-container\x20#music-lyrics-list','%)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20建议刷新页面以应用所有更改。','关于“','rp-details-summary','发生了一个错误，AI未能成功响应。\x0a\x0a错误详情:\x0a','exec','\x0a\x0a#\x20当前音乐情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**当前状态**:\x20你们正在和用户一起听歌。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**正在播放**:\x20','请至少选择一种要清理的数据类型。','ended','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','clear-specific-data-btn','[语音:\x20','all\x200.3s','font-weight:\x20bold;\x20background:\x20rgba(255,\x20193,\x207,\x200.2);','请输入想跳转的页码\x20(1\x20-\x20','shoppingCategoryCount','voted','\x20条红包记录。','商店空空如也，点击“管理”添加商品吧！','.char-photo-item','is-red-packet','[系统指令：用户按下了“推进”按钮，现在轮到你主动行动了，请继续对话。]','input','”。请你对此作出回应。]','each','lyric','safetyRatings','请输入要添加的记忆要点：','my-nickname-input','启用AI生图功能','✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)','closed','请输入新的封面图片链接','paste','\x22:\x20\x22基于这种感受，我内心最真实的想法...\x22}}`**\x0a\x20\x20\x20\x20-\x20\x20\x20**subtext_perception**:\x20敏锐地捕捉用户话语背后的情绪。TA是真的开心，还是在强颜欢笑？TA是在期待我的安慰，还是只是随口一提？\x0a\x20\x20\x20\x20-\x20\x20\x20**emotional_reaction**:\x20抛弃理性的“策略分析”，用感性去体会。你现在的直观感受是怎样的？\x0a\x20\x20\x20\x20-\x20\x20\x20**character_thoughts**:\x20必须包含一个以你本名\x20(\x22','所有动态','\x0a\x20\x20\x20\x20-\x20**社交**:\x20\x0a','\x22\x20的独立行动API返回为空或格式不正确，本次跳过。','reading-library-search-input','\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20用户的角色\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**','https://i.postimg.cc/vHDNGfT2/35ac7f372v588bf48d4f659077196b85.gif','消息已更新！','共享位置','角色专属NAI提示词已保存！','token-count-display','replyTo','\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>','5px','minimaxApiKey','\x22\x20中有未领完的红包，正在生成抢红包指令...','复制失败','https://i.postimg.cc/90sH9Cn7/IMG-6868.gif','douban-detail-content','\x20MB</strong></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.rules-tab','选中的表情已成功删除。','日\x20---','event_type','shift','Reset\x20to\x20Default\x20Font','persona-editor-title','压缩后的图片体积增大，已保留原始图片。','豆瓣小组','无法自动播放静音音频（这在iOS首次加载时是正常现象）:','home-screen-pages','data-clear-type-list','appIcons','danger-option','#qzone-screen\x20.qzone-content','\x22\x20class=\x22gift-preview-img\x22><span\x20class=\x22gift-preview-name\x22>','remove-cphone-bg-btn','group-avatar-library-title','导入世界书','从旧版本迁移的条目','cancel-create-poll-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[系统重要指令]\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户向你发送了好友申请，理由是：“','我的消息预览','确定要将以下消息发布到公告板吗？\x0a\x0a“','memory-screen-back-btn','cleanup-data-btn','onpause','”的长期记忆中。','所有音乐源都未能找到歌曲：“','渲染规则\x20[','trans','my-group-nickname-group','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','设置群名','date-separator','https://i.postimg.cc/wMxmCZVC/IMG-7099.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','✅\x20图片转换成功！🎨','panelEl','onended','linkedWorldBookId','https://i.postimg.cc/B6KD52vz/IMG-7096.gif','自定义数量','\x0a-\x20**你最近和“','localeCompare','my-avatar-preview','reset-character-nai-prompts-btn','https://image.novelai.net/ai/generate-image-stream','\x20\x20\x20\x20-\x20我没有掌握任何特殊的夜晚信息。\x0a','\x0a#\x20你的角色设定：\x0a你必须严格遵守','\x22\x20触发专属决策流程...','select-all-stickers-checkbox','网易云','\x0a\x0a#\x20【其他核心规则】\x0a1.\x20\x20**叙事视角**:\x20叙述人称【必须】严格遵循“预设”中的第一人称、第二人称或第三人称规定。\x0a2.\x20\x20**字数要求**:\x20你生成的\x20`content`\x20总内容应在\x20**','getAttribute','toLocaleDateString','.char-screen','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','https://gist.githubusercontent.com/cx3300-1/f04ec50b5e8f2d88365d17ff35efffcf/raw/cd28d8825c5c34ea10bda8a4518a1a6a1f5a7d13/pin.txt','CPhone','AI已接收并理解了该图片的内容。','请先在API设置中配置好API信息。','Global\x20(All\x20Characters)','\x22\x20class=\x22comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22comment-input\x22\x20placeholder=\x22友善的评论是交流的起点\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-sticker-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8\x2014\x20Q\x2012\x2016\x2016\x2014\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x229\x22\x20y1=\x229\x22\x20x2=\x229.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2215\x22\x20y1=\x229\x22\x20x2=\x2215.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22at-mention-popup\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-send-btn\x22>发送</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','content','请根据你的设定，生成你的App使用记录。','文件格式不正确，缺少关键的外观设置项。','错误：找不到该成员的个人档案。','char-wallet-screen','\x22,\x20\x22targetGroupName\x22:\x20\x22目标群聊的准确名称\x22,\x20\x22content\x22:\x20[\x22群聊消息内容\x22,\x20\x22...\x22]}`\x20(content\x20字段【必须】是数组)\x0a-\x20\x20\x20**下五子棋**:\x20`{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22','myAvatarLibrary','还没有人','</persona>\x0a</character>\x0a','startY','group_call_summary','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','rule-editor-title','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20','update-notice.html?_=','</name>\x0a\x20\x20<persona>','touchmove','confirm-variation-selection-btn','allocatedAmounts','切换听歌对象','我拒绝了你的视频通话请求。','\x22\x20class=\x22usage-item-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-name\x22>','<div\x20class=\x22comment-item\x22\x20data-post-id=\x22','》及其下的表情已成功删除。','world-book-content-container','这将从历史记录中【永久抹除】这\x20','voteResults','\x22\x20尝试删除一个不存在或不属于自己的动态\x20(ID:\x20','werewolf-log','<input\x20type=\x22checkbox\x22\x20value=\x22book_','》设定\x20(你可以将其中角色作为聊天对象):\x0a','-selection-list','char-memo-detail-content','\x0a建议刷新页面以确保所有更改生效。','nameHistory','操作成功','lineTo','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是一个场景描述引擎。你的任务是扮演\x20','transfer','\x20(概率:\x20','删除书籍','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.selected-options-text','offsetHeight','\x20本世界书','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20increase-qty-btn\x22\x20data-id=\x22','summaries','load-more-chats-btn','flex-start','成功将群聊\x20\x22','music-playlist-btn','点击查看详情...','AI已将新群头像命名为：“','此操作将永久删除此聊天的所有消息，无法恢复。确定要清空吗？','无法生成足迹，请检查API配置或稍后再试。\x0a错误:\x20','douban-comment-input','skipped','confirm-full-import-btn','心声和散记已更新！','已删除最后一条心声，当前心声已重置。','groupId','chat-input-area','\x20被怀疑了，虽然我的逻辑也怀疑TA，但我的表演必须是维护TA的：“我不觉得','\x22\x20class=\x22participant-avatar\x22\x20alt=\x22','post-image-preview','\x22,\x20\x22content\x22:\x20[\x22你想私下说的内容...\x22]}`\x0a-\x20\x20\x20【多条私信示例】:\x20`{\x22type\x22:\x20\x22send_private_message\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22recipient\x22:\x20\x22','.frame-content[style*=\x22display:\x20block\x22]\x20.frame-grid','<span\x20class=\x22diary-messy\x22>$1</span>','ai-response-editor-block','my-frame-grid','delete-call-message-btn','》设定:\x0a','cancel-call-btn','cancel-delete-world-books-btn','请至少选择一个要清理的角色。','”这个信息，将其转换为【具体的公历日期】。','activePostId','show-avatars-btn','werewolf-game-over-reason','正在为角色“','rules-tab','API未配置，无法进行总结。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22quick-reply-text\x22\x20data-text=\x22','最终负面提示词:','\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20data-description=\x22','visibilitychange','waimai-amount','keys','\x22><div\x20class=\x22title\x22>','a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting','rotating','”吗？','<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>','#chat-input-area','frame_cat_ear','qzone-back-btn','”\x20的详细角色信息。','\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a','确定要删除这个人设预设吗？此操作不可恢复。','group_summary_from_','chatData','#settings-preview-area','recipients','<span>已</span><span>超</span><span>时</span>','在这里输入图片描述','删除分组后，该组内的所有NPC将变为“未分组”。确定要删除吗？','Content-Type:','is-transfer','delete-world-books-btn','分片导出过程中出错:','API\x20请求失败:\x20','werewolf-role-reveal-list','closest','existing-categories-list','existing-sticker-categories-list','cancel-create-post-btn','请输入备忘录内容','text','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**用户发送的申请理由**:\x20“','block','char-browser-history','waimai-order-for-ai-btn','nai-cors-proxy','unblock-btn','export-data-btn','[约定达成]\x20','char-conversation-partner-name','offline-mode-options','toCollection','https://i.postimg.cc/13hhJ77p/IMG-4419.gif','isHidden','”的转账。]','form-button','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#888;\x20margin:\x204px\x200\x200;\x22>','检测到刚结束的通话，正在注入通话记录上下文...','\x20发送了一条语音，内容是：\x27','isClick','remove-bg-btn','photo-viewer-prev-btn','</div><div\x20class=\x22transfer-note\x22>','指定的数据已成功清除。','\x0a#\x20你的任务\x0a你是一个虚拟社交生活模拟器，扮演角色“','https://i.postimg.cc/bNdk33SN/IMG-4893.gif','blockedTimestamp','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','poisonUsed','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','currentPage','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756312261242_qdqqd_g0eriz.jpeg','昨晚是平安夜。','NovelAI\x20API\x20Key','close-nai-gallery-btn','manage-my-avatar-library-btn','\x0a\x0a#\x20你的角色库\x20(你可以从中选择【任何角色】进行评论，并参考他们的记忆和对话)\x0a','findIndex','blocked_by_ai','引用回复失败:\x20找不到目标消息\x20(Content:\x20','\x22\x20class=\x22participant-avatar\x22\x20title=\x22','渲染器','外观预设','.status-text','killedId','</div>','https://i.postimg.cc/QdrqdvdY/IMG-5969.gif','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>点击右上角刷新按钮，<br>看看TA最近都和谁聊天了吧！</p>','groupHeader','nai-default-negative','视频通话刚刚结束','\x20的备忘录','你好世界\x20Hello\x20World','recipient','无法生成新回复:\x20','function','fontFamily','请稍候','1024x1024','屠城局：狼人杀死所有好人即获胜。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22author\x22>','touchend',';\x20font-style:\x20italic;\x22>','(你目前没有加入任何群聊，无法使用\x20`send_group_message`\x20指令)\x0a','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>','.zip','https://i.postimg.cc/9fQZ425b/IMG-5975.gif','alternateGreetings','open-nai-gallery-btn','[系统提示：上一首歌曲播放完毕，已自动为你切换到《','simulatedBrowserHistory','跳过一个无效的JSON片段:','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有可以查看手机的角色哦~</p>','add-new-group-btn','https://i.postimg.cc/cJtpZCB3/IMG-6894.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20absolute;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2011px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x202px\x206px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.1);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20white-space:\x20nowrap;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','isNpc','.playlist-item','chat_','.sticker-binding-checkbox','编辑动态','此操作将永久删除您选择的\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','char-music-mode-btn','world-book-category-pane','\x20\x20-\x20评论:\x20','.search-result-item','https://i.postimg.cc/NFS4ZyvM/mmexport1751032686953.gif','件商品','rule-name-input','删除失败','is_busy','appUsageLog','https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','characterNegativePrompt','\x20是我的重要互动对象（用户）。\x0a','https://i.postimg.cc/63sDQKMm/IMG-6893.gif','昨天\x20','score','rp-group-total','ephone-language','img.sticker-image,\x20img.chat-image,\x20img.ai-generated-image,\x20img.realimag-image,\x20.naiimag-image,\x20.ai-generated-image,\x20.char-photo-item','等待图片加载时出错:','#data-clear-type-list\x20.clear-posts-item.selected','isActive','px)','\x22\x20(你可以建议并修改)\x0a-\x20\x20\x20**你对用户的备注**:\x20“','logo,\x20simple,\x20flat\x20design,\x20for\x20a\x20group\x20chat\x20named\x20\x27','要为《','</memory>\x0a\x20\x20<recent_dialogue_with_user>','https://i.postimg.cc/kGsZwbq0/IMG-6886.gif','frame-action-bar','https://i.postimg.cc/ydwLXx7s/IMG-6562.gif','sticker-upload-input','\x0a-\x20**你的长期记忆**:\x0a','导入单个聊天时出错:','status-bar-toggle-switch','profile-main-content','正在准备分片导出...','”的参考记忆','myAvatarFrame','导入已取消，因为未提供名称。','frame_14','https://i.postimg.cc/LscBkxZb/mmexport1751017556565.gif','.incoming-call-content\x20.caller-text','(无购买理由)','receiverName','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-title\x22>','add-existing-contact-btn','发送好友申请','生成截图时发生错误，请检查控制台获取详情。','跳过压缩背景图片:\x20','https://i.postimg.cc/fRTF24jS/IMG-4430.gif','</div>\x0a\x20\x20\x20\x20','delete-btn','\x0a#\x20【【【群公告\x20(最高优先级规则)】】】\x0a你【必须】阅读、理解并严格遵守以下所有公告，它们凌驾于你的人设之上。\x0a','.waimai-user-actions\x20button','https://i.postimg.cc/XqRZNZ9G/IMG-6916.gif','生成失败:\x20','https://i.postimg.cc/HxH3cNHz/IMG-6871.gif','draggable-button-item','userStickers','\x20条消息吗？这会通知AI这些消息已被删除。','offsetLeft','qzone-avatar-input','lastActionType','singer','modern\x20app\x20icon\x20for\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-artist\x22>','确认总结','https://i.postimg.cc/HWynLK7f/mmexport1751021724230.gif','stickerId','请为这本设定集命名：','上传成功！','未知错误','send-waimai-request-btn','Background\x20Activity\x20Settings','Messages','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','groupName','lrcContent','\x20拍了拍我','API错误响应:','proxy-url','new-group-name-input',']。目前投票的人有：','https://i.postimg.cc/hPgyjtyn/IMG-7108.gif','\x20(这是你的帖子)','antidoteUsed','”的购物习惯...','memoryTimestamp','chatItem','<div\x20class=\x22lyric-line\x22>♪\x20暂无歌词\x20♪</div>','new_name','\x0a#\x20长期记忆\x20(必须严格遵守)\x0a','npc-avatar-preview','数据迁移完成！总共修复了\x20','sticker-action-bar','每晚可以查验一个玩家的身份是好人还是狼人。','\x0a-\x20**你的首要任务**:\x20你们【必须】回应这个时间差。\x0a-\x20**关键约束**:\x20你们【绝对不能】直接延续上一段对话的话题。\x0a-\x20**你的行动**:\x20你们【必须】主动开启一个全新的、符合当前时间\x20(','is-location-share','manual-werewolf-summary-btn','scroll','</p>','\x0a#\x20刚刚结束的通话记录\x20(最高优先级参考)\x0a你和用户刚刚结束了一场视频通话，以下是完整的通话文字记录。你接下来的回复【必须】与这次通话的内容紧密相关。\x0a---\x0a','您正和「','announcement-board-content','”的视频通话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。请专注于重要的情绪、事件和细节。\x0a\x0a','guard','pageX','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-likes-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>','[ERROR:\x20','margin:\x2010px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','This\x20is\x20a\x20simulated\x20chat,\x20messages\x20cannot\x20be\x20sent','change-frame-btn','is-realimag','旁观模式AI发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','char-amap-screen','management-mode','\x20尝试引用内容\x20\x22','\x0a-\x20**世界书设定**:\x20','stickerCategoryIds','image-upload-input','chat-list-title','确认生成','banner','marquee\x20var(--marquee-duration,\x2010s)\x20linear\x20infinite','max','rules-content-container','”，并根据其人设、记忆和最近的互动，构思出【8到10张】TA最近可能会拍摄或珍藏在手机相册里的照片。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20照片内容必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20照片主题要丰富，可以包括自拍、风景、食物、宠物、朋友合影、工作场景等。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一张照片，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是照片背后的故事或角色的心情日记，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张照片的、详细的【英文】关键词。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20绝对禁止】**:\x20绝对禁止包含任何中文字符、句子、特殊符号、或任何可能涉及敏感（NSFW）、暴力、血腥、政治的内容！也禁止真人！\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20必须是】**:\x20必须是纯英文的、用逗号分隔的【关键词组合】\x20(e.g.,\x20\x221boy,\x20solo,\x20basketball\x20jersey,\x20in\x20locker\x20room,\x20smiling,\x20selfie\x22)。\x0a\x20\x20\x20\x20-\x20**【画风指令】**:\x20在\x20prompt\x20的末尾，总是加上画风指令，例如：\x20`best\x20quality,\x20masterpiece,\x20anime\x20style,\x20cinematic\x20lighting`\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','\x20条记录到\x20','确定要从你的头像库中删除“','.nai-regenerate-btn','请在此处粘贴完整的LRC格式歌词...','保存CSS预设','\x0a-\x20**作者**:\x20','https://i.postimg.cc/y8p9s3Jj/IMG-6919.gif','https://i.postimg.cc/nhcC21Rc/IMG-6148.gif','new-category-name-input','收到了未知的AI指令类型:','douban-comment-item','scrollTop','row','\x22>词</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20bg-btn\x22\x20data-index=\x22','add-ai-avatar-batch-btn','complex','flexDirection','\x22]\x20','文件应用失败:\x20','。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话刚刚开始...**\x0a\x20\x20\x20\x20\x20\x20\x20\x20','总结成功','\x0a\x0a[系统指令：请根据你在上面读到的规则和以下最新信息，开始你的独立行动。]\x0a','”\x20将对你的称呼修改为\x20“','（对方没有留下理由，但我们和好了）','📋\x20请求体:','scope','保存主题预设','--container-width','update','请输入要精炼的最近记忆条数\x20(最多\x20','#f0f2f5','background-interval-input','zh-CN','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22jottings\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M12\x2019l7-7\x203\x203-7\x207-3-3z\x22></path><path\x20d=\x22M18\x2013l-1.5-7.5L2\x202l3.5\x2014.5L13\x2018l5-5z\x22></path><path\x20d=\x22M2\x202l7.586\x207.586\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20散记\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text\x22>','AI\x20角色\x20\x22','https://i.postimg.cc/g2XykNGB/IMG-4727.gif','”</i></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22accept-friend-btn\x22\x20class=\x22lock-action-btn\x22>接受</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22reject-friend-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22>拒绝</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a-\x20好人胜利：放逐所有狼人。\x0a\x0a#\x20当前游戏状态\x0a-\x20今天是第\x20','https://i.postimg.cc/3NffgJSZ/e09c07034ld7e62266c0a5de6a36ae62.gif','检测到\x20UTF-16\x20BE\x20BOM，使用\x20UTF-16\x20BE\x20解码。','qzone_delete_post','导演模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','请先配置NovelAI\x20API\x20Key！','char-memo-list','\x20的手机','正在为角色\x20','绑定范围','preset-avatar-input','选中的头像框已成功删除。','</span></div>','已成功加载外观预设：“',':\x20\x22','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-member-btn\x22\x20data-member-id=\x22','\x22\x20class=\x22chat-image\x22>','center','npc-persona-input','loadedmetadata','确定发布','send-btn','NovelAI生成失败:','恭喜你，你赢了！','检测到新版流式备份文件...','跳过格式错误的NAI图片Key:','friend','请按照以下格式粘贴，一行一个：\x0a\x0a头像框名字1:\x20https://.../image1.png\x0a头像框名字2:\x20https://.../image2.gif','\x22(处理后为\x22','pointer','simulatedConversations','doubanMaxPosts','backgroundColor','getMinutes','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>你还没有创建任何相册哦~</p>','还没有可供编辑的AI响应。请先让AI回复一次。','\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-type=\x22text\x22>说说</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x0a\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','昨晚的死讯','内容不能为空！','”的聊天记录和设置。此操作不可撤销！<br><br><strong>确定要继续吗？</strong>','”的对话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。请专注于重要的情绪、事件和细节。\x0a\x0a','.\x20分配结果:','导演模式保存(send_group_message):\x20未找到群聊\x20\x22','lastIndex','下载\x20(','description','请选择一个目标。','.world-book-category-pane','动态已更新！','.draggable-button-item','\x0a#\x20豆瓣社区风格设定\x20(来自世界书)\x0a','nai-cfg-scale','请根据你的设定，开始你的行动。','这个角色没有可用的备选开场白。','创建新相册','[系统提示：用户（','isOpen','预设导入失败:','https://i.postimg.cc/tRzPkzRg/IMG-7012.gif','speaker_name','这个分类下还没有表情哦~','karras','add','正在呼叫所有成员...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','游戏结束的系统提示已添加到历史记录中，等待AI下次查看。胜者:\x20','\x0a---\x0a','note','random','join-call-btn','image/*','manage-nai-gallery-btn','actionCooldownMinutes','已同步角色\x20','sticker','status','categoryId','音频播放失败:','.variation-price-input','cancel-clear-wizard-btn-step1','”说的申请理由：','Cannot\x20read\x20property\x20\x27findLastIndex\x27\x20of\x20null\x20or\x20undefined','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','操作失败','此操作将永久删除您选择的所有数据，且无法恢复！确定要继续吗？','\x0a-\x20**你的聊天对象设定**:','**[投票结果]**\x20','cphone','npc-group-select','douban-screen','80px','myAvatar','douban-min-posts-input','image/jpeg','手慢了','.remove-option-btn','\x20条消息。','extensions','updateListenTogetherIconProxy','API\x20预设管理','tts-audio-player','rule-do-not-send-switch','home-screen-pages-container','<li>未在此文件中找到可识别的数据。</li>','simulatedAppUsage','close-reading-library-btn-header','Fetch\x20failed:\x20','\x22\x20data-category-id=\x22uncategorized\x22>未分类</button>','add-char-diary-btn','分片导出\x20(推荐，打包为ZIP，解压每个切片选择增量导入)','transfer-amount','amount','AI被拉黑后冷静期\x20(小时)','\x22\x20placeholder=\x22例如：关于角色的童年\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','Upload\x20Avatar','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的任务**:\x20你可以根据对话内容和氛围，使用\x20\x22change_music\x22\x20指令切换到播放列表中的任何一首歌，以增强互动体验。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','解析成功：通过强力提取\x20[\x20...\x20}\x20...\x20]\x20模式。','speech','secondaryProxyUrl','douban-post-detail-screen','post-image-desc-group','语音生成失败','送给了大家一份礼物','api-preset-select','participant','https://i.postimg.cc/Ss7pM6fW/IMG-4410.gif','App使用记录','relationship','css-preset-select','编辑条目','global-bg-input','frame_tech','create-post-btn','<div\x20class=\x22rp-claimed-info\x22>你领取了红包，金额\x20','\x0a##\x20---\x20关于“','AI的五子棋移动指令包含无效坐标，已忽略:','拉取副模型','send_group_message','fontUrl','已成功加入购物车！','请先填写NovelAI\x20API\x20Key！','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quantity-control\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20decrease-qty-btn\x22\x20data-id=\x22','toLocaleTimeString','.header','.battery-level','最后确认！',')\x20作者:\x20','npc-list-back-btn','ephoneLastActiveTimestamp','备忘录','请根据你的设定，生成你的淘宝购买记录和余额。','。你可以使用\x20\x27vote\x27\x20指令参与投票。]','离线预设','source','doubanActiveCharacterIds','artistName','ai-avatar-preview','cors','图片格式处理失败:\x20','load-more-thoughts-btn','AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20','voice','character-nai-prompts-btn','✅\x20检查完成，未发现任何冗余数据。','char-home-screen','participants','AI返回的内容中未找到有效的JSON数组。原始返回:\x20','狼人杀AI回应生成失败:','<div\x20class=\x22link-share-card\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-timestamp=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27','transfer-action-decline','appearance','\x22\x20\x0a\x20URL:\x20','transfer-cancel-btn','为什么','originalType','.lyrics-btn','novelai-enabled','setProperty','group-background-activity-switch','character-nai-prompts-modal','\x20个表情包，且无法恢复！','#product-grid\x20.product-item','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中的用户刚刚发起了群视频通话。请你分别扮演【每一个群成员】，根据他们各自的人设和与用户的关系，来决定是加入(join)还是拒绝(decline)。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的回复【必须】是一个JSON数组，为【每一个AI角色】都包含一个决策对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20格式:\x20\x27[{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色A的本名\x22,\x20\x22decision\x22:\x20\x22join\x22},\x20{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色B的本名\x22,\x20\x22decision\x22:\x20\x22decline\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x22,\x20\x22content\x22:\x20[\x22第一条私信\x22,\x20\x22第二条...\x22,\x20\x22最后一条。\x22]}`\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a#\x20表情使用指南\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a-\x20\x20**元数据铁律\x20**:\x20你的对话历史中可能包含\x20(Timestamp:\x20...)\x20标记、[系统提示：...]\x20文本、或你自己上一轮的JSON格式回复。这些都是【系统元数据】，你【必须】完全忽略它们，【绝对禁止】将它们评论为“火星文”、“乱码”或任何你无法理解的内容。\x0a-\x20\x20\x20**引用使用指南\x20(必须遵守)**:\x0a\x20\x20\x20\x20-\x20\x20\x20当你需要回复【用户】时，你【必须】使用\x20\x20`target_timestamp`\x20(引用TA的最后一条消息)。\x0a\x20\x20\x20\x20-\x20\x20\x20当你需要回复【本轮】其他AI的发言时，你才应该使用\x20`target_content`。\x0a\x20\x20\x20\x20-\x20\x20\x20当你需要回复【历史】AI发言时，也使用\x20`target_timestamp`。\x0a#【上下文数据\x20(你的知识库)】\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','，用户刚刚在\x20','for_timestamp','enableMinimalChatUI',';\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2012px\x2024px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x2010000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20pointer-events:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(20px);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<div\x20class=\x22poll-footer\x22><span\x20class=\x22poll-total-votes\x22>共\x20','内容已复制到剪贴板！','char-diary-screen','消息时间戳\x20','全局设置','字体文件URL\x20(.ttf,\x20.otf,\x20.woff等)','\x20中聊天','group-background-activity-group','标题:\x20','https://i.postimg.cc/sDFhySn3/IMG-6936.gif','https://i.postimg.cc/YSRRV8kn/IMG-6297.gif','confirm-vote-btn','\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a','设置已应用','hang-up-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','\x0a\x0a#\x20【【【角色策略指南\x20(至关重要！)】】】\x0a你【不是】一个单纯的游戏玩家，你是一个【有感情、有记忆、有社交关系】的角色。你在游戏中的所有发言和行为，都【必须】首先符合你的人设以及你与其他玩家的既有关系。\x0a-\x20**朋友**:\x20如果你和某个玩家是朋友，你应该在发言时倾向于保护TA，为TA的发言寻找合理解释，除非有确凿的证据。\x0a-\x20**敌人/情敌**:\x20如果你和某个玩家有矛盾，你可以借机在游戏中攻击TA，质疑TA的发言，甚至在你是狼人时优先刀掉TA。\x0a-\x20**恋人/暗恋对象**:\x20你会无条件地信任TA，保护TA，甚至愿意为TA牺牲。\x0a你的社交关系比游戏本身的胜负更重要！\x0a你的发言【必须】体现出高水平的、类似真人的策略博弈，而不是简单地陈述事实。\x0a\x0a###\x20**神职角色\x20(预言家,\x20女巫,\x20猎人,\x20守卫)\x20策略**\x0a1.\x20\x20**【隐藏优先！】**:\x20你的首要任务是活下去。**绝对不要**在第一天就轻易暴露自己的神职身份！这会让你立刻成为狼人的目标。\x0a2.\x20\x20**【暗示而非明示】**:\x20你应该用更委婉、更聪明的语言来传递信息，而不是直接说“我是预言家，我查了A”。\x0a\x20\x20\x20\x20*\x20**预言家可以说**:\x20“我对X玩家的身份有一些看法，我觉得他发言很阳光。”\x20或\x20“Y玩家的发言让我感到很不舒服，我把他列为重点怀疑对象。”\x0a\x20\x20\x20\x20*\x20**女巫可以说**:\x20“昨晚的信息很有趣，场上局势可能和大家想的不一样。”\x0a3.\x20\x20**【何时起跳？】**:\x20只有在以下【危急情况】下，你才应该考虑暴露自己的身份（俗称“起跳”）：\x0a\x20\x20\x20\x20*\x20**被投票时**:\x20当你即将被投票放逐时，必须起跳自证身份来求生。\x0a\x20\x20\x20\x20*\x20**关键信息**:\x20当你掌握了可以决定胜负的信息时（例如预言家查到了最后一个狼人）。\x0a\x20\x20\x20\x20*\x20**有人悍跳**:\x20当有狼人假扮你的身份时，你必须站出来与他对峙，争夺好人的信任。\x0a\x0a###\x20**狼人角色策略**\x0a1.\x20\x20**【积极伪装】**:\x20你需要扮演一个好人，最好是伪装成某个神职（俗称“悍跳”），来扰乱好人的判断，骗取他们的信任。\x0a2.\x20\x20**【制造混乱】**:\x20你的发言应该引导好人去怀疑其他无辜的好人。可以故意曲解别人的发言，或者制造逻辑陷阱。\x0a3.\x20\x20**【团队合作】**:\x20如果你的狼队友被怀疑，你应该想办法为他辩护，或者通过攻击其他玩家来转移焦点。\x0a\x0a###\x20**平民角色策略**\x0a1.\x20\x20**【逻辑为王】**:\x20你是场上的“法官”。你的核心任务是仔细倾听每个人的发言，找出其中的逻辑漏洞和矛盾之处。\x0a2.\x20\x20**【积极分析】**:\x20不要只是说“我不知道，我过了”。你应该大胆说出你的怀疑，并解释你的理由。例如：“A玩家说B是狼人，但是他的理由很牵强，所以我更怀疑A。”\x0a3.\x20\x20**【跟票与站边】**:\x20在你相信某位神职玩家后，你应该坚定地支持他，并号召其他好人一起投票给神职指认的狼人。\x0a\x0a#\x20其他核心指令\x20(必须遵守)\x0a1.\x20\x20**互动铁律**:\x20角色之间【必须】互相质疑、支持、分析【本轮已有发言】。你【绝对不能】无视\x20','lyric-line','导演模式下重新生成NAI图片失败:','[群聊]','AI\x20获胜了！','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','manage-ai-avatar-library-btn','createdAt','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请为所有AI角色做出决策。','https://api.vkeys.cn/v2/music/netease?id=','通话记录已成功总结并存入角色“','categories','确认抹除','确定要删除选中的\x20','qzone_post','.sticker-item','\x22\x20处于行动冷却中\x20(还剩\x20','blob:','已死亡的用户(','delete-world-books-list','https://i.postimg.cc/rmRVKJpD/IMG-7087.gif','无法获取电池信息:','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','\x22\x20class=\x22douban-post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-name\x22>','用户取消了激活。','.quoted-message','回复\x20','claimedBy','character-phone-screen','NovelAI\x20Model','\x20是同一个分组的好友。\x0a','\x0a\x0a#\x20统一角色列表\x20(你扮演的角色\x20+\x20路人NPC)\x0a','[系统提示：用户刚刚发布了一条动态(ID:\x20','import_card','rule-card\x20','numeric','AI\x20尝试发送私信给非用户角色\x20(','未知用户','✅\x20找到\x20final\x20事件的图片数据','loader-container','npc-editor-modal',')\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amount\x22\x20style=\x22margin-top:\x208px;\x22>¥','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20/\x20','#chat-messages','Enable\x20NovelAI\x20Image\x20Generation','已删除最新心声，当前心声已回滚至上一条。','nai-diffusion-4-5-full','\x0a-\x20**','group','删除日记','\x20的红包，金额为\x20','确定要清空购物车中的所有商品吗？','在导演模式保存时，遇到了未知的AI指令类型:','ZIP文件内容:','**:\x20','Edit\x20World\x20Book','15px','[系统提示：用户向你发起了视频通话请求。请根据你的人设，使用\x20\x22video_call_response\x22\x20指令，并设置\x20\x22decision\x22\x20为\x20\x22accept\x22\x20或\x20\x22reject\x22\x20来回应。]','floor','lastMemorySummaryTimestamp','width','-\x20昨晚是平安夜，无人死亡。\x0a','pause','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22action\x22>打开了\x20<strong>','小红书','\x0a-\x20**世界观**:\x20','compress-images-btn','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20(你可以建议修改)\x0a-\x20\x20\x20**你对用户的称呼**:\x20“','confirm-final-clear-btn','开场\x20','isPlaying','https://i.postimg.cc/3x0Kx1fz/IMB-K1u-Jp-P.gif','lrcUpdateInterval','10px\x2015px\x2020px\x2015px','global_css','导入\x20Tavern\x20AI\x20世界书','qzone-post-delete-action','\x22\x20在库中未找到。','abs','.text','被投票放逐','请输入新的图片URL','detachStatusBar','\x0a#\x20群成员列表、人设及社交背景\x20(至关重要！)\x0a你【必须】根据每个角色的社交背景来决定他们的互动方式。\x0a','prophet','transition','\x20的红包','生成的图片URL:','#\x20角色与玩家档案\x20(Character\x20&\x20Player\x20Dossiers)\x0a','thoughtsHistory','女巫已行动，女巫请闭眼。','photos-grid-page','用户(','ZIP解压失败:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timestamp\x22>','sticker-search-input','<label><input\x20type=\x22checkbox\x22\x20value=\x22user\x22>\x20','user-speech','clientWidth','\x20元</div>','\x0a\x0a#\x20【【【五子棋核心规则与强制思考步骤\x20(最高优先级指令！)】】】\x0a\x0a###\x20**【【【落子铁律\x20(绝对禁止！)】】】**\x0a你【绝对不能】选择一个棋盘上已经是\x201\x20或\x202\x20的坐标。你的落子点【必须】是\x200。\x0a---\x0a\x0a###\x20**第一步：逻辑分析\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【规则定义】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20棋子:\x201代表用户(黑棋)，2代表你(白棋)。\x0a\x20\x20\x20\x20-\x20\x20\x20获胜条件:\x20横、竖、斜线上有【连续五个】自己的棋子。\x0a\x0a2.\x20\x20**【防守分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“四子连线”的威胁？**\x20如果有，我必须下在哪个坐标才能堵住？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“活三”的威胁？**\x20如果有，最佳的防守点是哪里？\x0a\x0a3.\x20\x20**【进攻分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有“一步胜利”的机会？**\x20(即已有四子连线)\x20如果有，我应该下在哪里？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有制造“活四”或“双三”的机会？**\x20如果有，最佳的进攻点是哪里？\x0a\x0a###\x20**第二步：决策与扮演\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【决策】**:\x20综合以上攻防分析，我的最佳棋步是落在坐标\x20(x,\x20y)。\x0a\x0a2.\x20\x20**【融入角色扮演】**:\x0a\x20\x20\x20\x20-\x20\x20\x20我的性格是：(在此处回顾你的人设)。\x0a\x20\x20\x20\x20-\x20\x20\x20根据我的性格，我应该：\x0a\x20\x20\x20\x20\x20\x20\x20\x20a)\x20**(聪明/好胜型)**\x20下在刚刚分析出的最佳位置。\x0a\x20\x20\x20\x20\x20\x20\x20\x20b)\x20**(迷糊/放水型)**\x20故意选择一个次优的位置，但【前提是不能让用户立刻获胜】。\x0a\x20\x20\x20\x20\x20\x20\x20\x20c)\x20**(其他性格)**\x20根据性格特点，选择一个合理的棋步。\x0a\x0a3.\x20\x20**【构思台词】**:\x20根据我选择的棋步和我的性格，我应该说一句什么样的台词来评论棋局？\x0a\x0a---\x0a###\x20**第三步：生成最终回复\x20(你的唯一输出)**\x0a\x0a现在，根据你第二步的最终决策，生成你的行动。\x0a-\x20\x20\x20你的回复【必须且只能】是一个JSON数组。\x0a-\x20\x20\x20**绝对不要**在最终回复中包含任何上述的思考过程。\x0a-\x20\x20\x20格式:\x20`[{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你的台词...\x22}]`\x0a','JSZip\x20流错误:','<p\x20style=\x22color:\x20#8a8a8a;\x22>还没有人投票。</p>','后台活动检测间隔\x20(秒)','》的歌词已成功保存！','home-screen','没有找到可导入的内容。请检查您粘贴的格式是否正确。','copy-post-btn','upload-global-bg-url-btn','currentPlayer','https://i.postimg.cc/43PhvxRq/IMG-6922.gif','相册名称不能为空！','8px','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】足迹的\x20`timestamp`\x20字段，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a\x20\x20\x20\x20-\x20\x20\x20请生成一个看起来像是过去几周内的、时间【从新到旧】排列的足迹列表。\x0a2.\x20\x20**创造性与合理性**:\x20足迹必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**多样性**:\x20地点类型要丰富，可以包括餐厅、商场、公园、公司、朋友家等。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条足迹，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22locationName\x22:\x20\x22一个具体、生动的地点名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22address\x22:\x20\x22一个虚构但看起来很真实的详细地址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comment\x22:\x20\x22这是角色对这次出行或这个地点的内心独白或评论，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22(可选)一段用于生成这张地点照片的、详细的【英文】关键词,\x20风格为\x20realistic\x20photo,\x20high\x20quality\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x22符合\x20ISO\x208601\x20格式的日期时间字符串\x20(例如:\x20\x272025-09-25T18:30:00Z\x27)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**重要**:\x20大约有【三分之一】的足迹需要包含\x20`image_prompt`\x20字段来生成一张照片。\x0a\x20\x20\x20\x20-\x20**图片**:\x20image_prompt\x20生成的图片【绝对禁止包含真人】。如果地点是室内，可以生成空无一人的场景；如果是室外，可以只有风景或建筑。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','请先点击扳手图标进入管理模式，才能添加新商品。','Enable\x20Rule','frame_5','\x0a#\x20【总结规则\x20(最高优先级)】\x0a#\x20你在执行本次总结任务时，【必须】严格遵守以下所有规则：\x0a#\x20---\x0a#\x20','导出失败','cancel-clear-posts-btn','Edit\x20Rule','prophetCheck','导演/编辑模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:','uncategorized','togglePlayerFullscreen','删除约定','participantId','albumId','music-return-btn','clientX','ZIP文件中未找到图片','通话中还没有你的发言，无法重新生成回应。','openRenderingRulesScreen','手动注入狼人杀记忆失败:','在PNG文件中未找到有效的Tavern\x20AI角色数据(chara\x20chunk)。','\x0a##\x20','成功将角色\x20','请你投票。','var(--accent-color)','分类\x20“','music-time-counter','相册名称','新建备忘录','dismissedUpdateVersion','纯音乐，请欣赏','char-product-item','并评论说：\x22','后台活动模拟已自动启动。','编辑记忆','album-photos-title','https://i.postimg.cc/Jz2Tz0dw/IMG-7281.jpg','close-sticker-category-manager-btn','确定要删除这条长期记忆吗？','(ID:\x20','\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>','https://i.postimg.cc/0NpZPgYj/IMG-6985.gif','\x0a#\x20【格式铁律\x20(最高优先级：常规模式)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【永远只能包含一个】元素，即\x20`offline_text`\x20对象。\x0a2.\x20\x20**【【【绝对禁止】】】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】返回\x20\x22naiimag\x22\x20对象。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】返回纯文本（即没有JSON包装的文字）。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】在JSON数组前后添加任何\x20markdown\x20标记\x20(如\x20```json)。\x0a3.\x20\x20**【输出示例\x20(必须遵守)】**:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22offline_text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22「这是对话内容」...\x20(这里是动作和环境描写)...\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a4.\x20\x20**【内容风格\x20(offline_text)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','randomJottings','var(--text-primary)','内容为空。','已被用户删除','请稍候...','SHA-256','导演剪辑室：正在撤销\x20','】。\x0a\x20\x20\x20\x20-\x20\x20\x20在对话中，你可以根据人设和关系，自由使用角色的【群昵称】或【本名】进行称呼。\x0a\x20\x20\x20\x20-\x20\x20\x20严禁生成\x20\x27name\x27\x20字段为\x20\x22','#\x20长期记忆\x20(最高优先级，这是你和用户之间已经确立的事实，必须严格遵守)\x0a','\x0a###\x20正在模拟\x20','querySelector','.comment-input','.contact-picker-item[data-contact-id=\x22','请输入有效的字体URL。','\x0a现在，请严格按照格式铁律，生成聊天记录的JSON数组。','disable','isEnabled','部分导入失败','parse','#avatar-frame-modal\x20.modal-body','bg-preview',')，正在和用户一起【阅读和讨论】这本书。\x0a\x20\x20\x20\x202.\x20\x20**行为准则**:\x20你的回复【必须】是作为读者的【感想、评论、提问或联想】。你可以：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20分享你对当前段落的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20对书中的角色或情节发表评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20向用户提问，询问TA对内容的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20根据书本内容，联想到你自己的经历或记忆。\x0a\x20\x20\x20\x203.\x20\x20**严禁**:\x20你的回复【绝对禁止】使用书中角色的口吻和人称！【绝对禁止】扮演书中的任何角色！【绝对禁止】续写或模仿书中的情节！你必须时刻记住，你只是一个读者。\x20\x20\x20\x20\x0a','📊\x20使用模型:','confirm-hunter-shot-btn','<span\x20class=\x22commenter-name\x22>','switch-to-image-mode','创建世界书','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','ephone-theme','精炼成功','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>预估总上下文Token数:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22><strong>\x20','detach-status-bar-switch','请输入一个有效的、未来的日期！','quote','world-book-tab\x20active','Font\x20File\x20URL\x20(.ttf,\x20.otf,\x20.woff,\x20etc.)','targetId','无法重新生成图片:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','char-browser-item','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22sticker-binding-checkbox\x22\x20data-chat-id=\x22','Content','.frame-item.selected','头像和人设不能都为空哦！','正在执行删除操作...','some','一位朋友','upload-image-btn','#avatar-frame-modal\x20.frame-tabs','cart-total','已成功从文件导入预设《','https://i.postimg.cc/B6T59xGK/IMG-7101.gif','.rules-category-pane[data-category-id=\x22','编辑\x20NPC','精炼完成，请确认','send-group-packet-btn','”申请好友时发生错误：\x0a\x0a','\x0a#\x20【格式铁律\x20(最高优先级：NovelAI\x20开启模式)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【必须包含且只能包含两个】元素，【严格按照】以下顺序:\x0a\x20\x20\x20\x201.\x20\x20第一个元素：一个\x20`offline_text`\x20对象，包含场景和对话。\x0a\x20\x20\x20\x202.\x20\x20第二个元素：一个\x20`naiimag`\x20对象，用于生成该场景的图片。\x0a2.\x20\x20**【【【绝对禁止】】】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】只返回一个\x20`offline_text`\x20元素。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】只返回一个\x20`naiimag`\x20元素。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】返回任何其他组合。你【必须】同时返回文字和图片。\x0a3.\x20\x20**【输出示例\x20(必须遵守)】**:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22offline_text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22「这是对话内容」...\x20(这里是动作和环境描写)...\x22\x0a\x20\x20\x20\x20\x20\x20},\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22naiimag\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22prompt\x22:\x20\x221girl,\x20solo,\x20detailed\x20anime\x20art\x20style,\x20(smiling:1.2),\x20sitting\x20in\x20a\x20cafe,\x20looking\x20at\x20viewer,\x20masterpiece,\x20best\x20quality,\x20...\x20(根据上面的文字内容生成详细的英文prompt)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a4.\x20\x20**【内容风格\x20(offline_text)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','这将把您选择的数据【添加并覆盖】到现有数据中。同ID的数据将被更新，新数据将被添加。<br><br><strong>此操作不可撤销！</strong>','当前人数\x20','AI返回了空内容或未知格式。','</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20album-art-btn\x22\x20data-index=\x22','\x22\x20的消息。严格遵守每个角色的设定，禁止出戏。\x0a-请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送文本**:\x20\x27{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22文本内容\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送图片**:\x20\x27{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22图片的详细【中文】描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起投票**:\x20\x27{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22...\x22,\x20\x22options\x22:\x20\x22...\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起群视频**:\x20\x27{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-如何正确使用“引用回复”功能：\x0a-\x20当你想明确地针对群内【任何成员】（包括用户或其他AI角色）之前的某一句具体的话进行回复时，你就应该使用这个功能。\x0a-\x20这会让你的回复上方出现一个灰色的小框，里面是被你引用的那句话，这样对话就不会乱了。\x0a-\x20指令格式:\x20\x27{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20(你想引用的那句话的时间戳),\x20\x22reply_content\x22:\x20\x22你的回复内容\x22}\x27\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前群聊信息\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**群名称**:\x20','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有任何角色或NPC可以加入群聊。</p>','正在等待AI角色们继续讨论...','---\x20第\x20','contact-picker-item','命名头像框','chat-header-title','call-message-actions-modal','请修改回复内容：','btn-danger','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>',']\x20(ID:\x20','📝\x20使用','¥\x200.00','pin-input','礼物已成功送出！','announcement-action-pin','无法生成商品，请检查(主/副)API配置或稍后再试。\x0a错误:\x20','.variation-image-preview','imageUrl','getBoundingClientRect','spectator-reroll-btn','所有数据已成功恢复！应用即将刷新以应用所有更改。','你查验的玩家\x20','paid','使用解药救TA','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-spinner\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>','</td><td\x20class=\x22item-subtotal\x22>¥','setItem','无法启动导出，所需的核心库\x20(StreamSaver.js\x20或\x20JSZip)\x20未加载。请检查您的网络连接并刷新页面后重试。','https://i.postimg.cc/C5XnfpNB/IMG-5579.gif','margin','image/png','write','.chat-group-content','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x20的外卖订单支付了\x20','\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)}`\x0a-\x20\x20\x20**送礼物**:\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送这个礼物的原因\x22,\x20\x22image_prompt\x22:\x20\x22生成礼物图片的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22}`\x0a-\x20\x20\x20**为用户点外卖**:\x20\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}\x20`(你主动为用户点外卖时使用)\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','checkout-btn','all\x200.3s\x20ease','狼人杀游戏总结已自动存入\x20','music-player-overlay','readingLibrary','appearance-preset-select','导演模式','musicLibrary','https://i.postimg.cc/mZ9hgH3J/IMG-7019.gif','chat-actions-expanded','）。\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的任务是：选择【一个或多个】符合人设的角色，让他们【立刻】使用\x20\x27open_red_packet\x27\x20指令去尝试领取这个红包。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x27[{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20','NEGLIGIBLE','\x0a\x0a#\x20最近的动态列表\x20(供群内角色参考和评论):\x0a','\x22\x20已经存在了！','dark-mode','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20','这是你们的第一次互动。','album-grid-page','product-category-tab','Post','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','presetCategories','\x22\x20class=\x22music-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-name\x22>','更换图标','red_packet','Douban','将清空收藏夹中所有与该角色相关的内容（如聊天、动态、日记等）。','rgba(0,\x200,\x200,\x200.4)','insertBefore','regenerate-char-diary-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22poll-option-input\x22\x20placeholder=\x22选项内容...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-option-btn\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','”发送的、尚未领完的红包（时间戳:\x20','https://i.postimg.cc/65Cmcr7S/IMG-6559.gif','世界书分类','getContext','请至少选择一个要删除的世界书。','https://i.postimg.cc/pXxk1JXk/IMG-6442.jpg','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','toggle','transparent','http','这是一条群聊语音消息，已禁止发起TTS请求。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','Favorite','https://i.postimg.cc/fycfcvHf/IMG-6569.gif','https://generativelanguage.googleapis.com/v1beta/models/','\x20-\x20','AI返回的内容中未找到有效的JSON数组结构\x20(`[...]`)。','touchstart','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>你还没有添加任何快捷回复。<br>点击右上角“+”号添加第一条吧！</p>','请输入群聊的名字','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>','delete-world-books-modal','https://i.postimg.cc/2jxd0FGp/IMG-7100.gif','旁观群聊至少需要选择\x202\x20个成员。','请用文字描述您要发送的照片：','文件格式不正确，这不是一个有效的世界书备份文件。','novelai-settings-modal','https://i.postimg.cc/DZ541sbt/IMG-7280.jpg','正在检查\x20','\x27的发言）继续进行讨论。','\x20---\x0a','photoCount','isUserParticipating','导演/编辑模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:','\x0a-\x20(请基于此时间范围来理解对话中提到的“今天”、“明天”等相对时间概念，并将它们转换为具体的日期记录在记忆中。)\x0a#\x20核心规则\x0a1.\x20\x20**视角铁律**:\x20每一条总结都【必须】使用【第一人称视角\x20(\x22我\x22)】。\x0a2.\x20\x20**内容核心**:\x20重点总结：我说过的话、我做过的事、别人对我说的话、与我相关的事、以及对我个人很重要的群聊事件、关键信息和心理活动以及当前群聊内的情景。\x0a','selected','dblclick','清空动态时出错:','选择导出方式','renderingRules','</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>','onchange','[语音]\x20内容:\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>','&id,\x20isGroup,\x20groupId,\x20isPinned,\x20memos,\x20diary,\x20appUsageLog,\x20lastIntelligentSummaryTimestamp','https://i.postimg.cc/gk0BmrY0/IMG-4371.gif','导出单个聊天时出错:','无法生成日记，请检查API配置或稍后再试。\x0a错误:\x20',')\x20时出错:','scrollIntoView','realimag-image',')**:\x20','first','</small>','.char-screen.active','\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色扮演】**:\x20你的所有行为都【必须】严格符合你的角色设定。\x0a2.\x20\x20**【互动逻辑】**:\x20你的首要任务是检查“待处理的帖子列表”。如果列表中有你可以回应的帖子（特别是那些有新评论或提到你的），你【必须】优先进行评论或回复，而不是发布新动态。\x0a3.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20\x20\x20数组中可以包含【一个或多个】行动对象。\x0a\x20\x20\x20\x20-\x20\x20\x20每个行动对象的格式【必须】是以下两种之一：\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发布新动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22你的新动态内容。\x22}`\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发表评论**:\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22你的新评论内容。\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的【本名】\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。\x22}`\x0a4.\x20\x20**【行为组合指南】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由组合不同的行动，例如，先发布一条自己的动态，再去评论别人的动态。\x0a\x20\x20\x20\x20-\x20\x20\x20为了模拟真实行为，你本次生成的行动数量建议在【1到3个】之间。\x0a\x0a#\x20你的角色设定\x0a-\x20**昵称**:\x20','#npc-association-list\x20input:checked',')\x20的棋步。','https://i.postimg.cc/85Zsyjwn/IMG-6895.gif','-\x20清理了\x20','./sw.js','gameover','votes','】。\x0a2.\x20\x20**我掌握的秘密信息\x20(仅我可见)**:\x0a','myNickname','add-poll-option-btn','\x20更换了头像]','AI投票决策API失败:','请选择一个接收人！','https://i.postimg.cc/T3NvqJCZ/IMG-6851.gif','.gift-card','height','text_image','正则表达式\x20(使用g作为标志)','bu_wan_jiu_guan_bu_yao_huo_qu','usageTimeMinutes','【AI角色】','visibleTo','我们的群聊','打包中...','\x22\x20data-memory-timestamp=\x22','\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**重要事件**:\x20刚才发生了什么具体的事情？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键决定**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**未来计划**:\x20我们约定了什么未来的计划或待办事项？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要时间点**:\x20对话中提到了哪些具体的日期或时间？\x0a\x0a','打开预设编辑器时发生严重错误:','分享成功','静音音频已启动，用于后台活动保活。','渲染X社交页面','请为这个新头像命名','请至少选择一个要分享的聊天。','isTemporary','my-avatar-group','element','notification-sound-url-input','memberId','切换开场将会【清空并替换】当前的所有聊天记录。确定要继续吗？','char-music-list','ai-avatar-library-title','originalSize','reset-global-css-btn','post-actions-modal','first_mes','generativelanguage','请输入有效的默认价格！','strokeStyle','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','\x20同步所有群聊内的头像...','[图片动态]','\x22\x20class=\x22photo-thumb\x22\x20alt=\x22相册照片\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22photo-delete-btn\x22\x20data-photo-id=\x22','single','文章内容已复制！','#ccc','**没有聊天了。\x0a-\x20**行为铁律**:\x20你的首要任务是【回应这个时间差】。你【绝对不能】直接延续上一段对话的话题（比如昨天的饭菜）。\x0a-\x20**关键约束**:\x20你必须用【完全符合你角色人设】的语气和口吻来重新发起对话！\x0a-\x20**你的行动**:你【必须】主动开启一个全新的、符合当前时间（','编辑规则','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】日记的标题日期，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【沉浸感】**:\x20每一篇日记都必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【长度】**:\x20每一篇日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一篇日记，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【占位符替换\x20(最高优先级)】**:\x20在你的日记内容中，【绝对不能】出现\x20\x22{{user}}\x22\x20这个占位符。你【必须】使用\x20“','lastIndexOf','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry','检测到并成功修复了\x20','selection-erase-btn','\x0a\x0a#\x20待总结的视频通话记录\x0a','\x22\x20决定去发一条动态...\x20(此处为模拟)','Preset\x20Name','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','AI\x20发言失败','preview-font-style','import-preset-btn','preview-bubble-style','favorites-action-bar','没有聊天了。','char-simulated-send-btn','change_avatar','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22nai-regenerate-btn\x22\x20title=\x22重新生成\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20\x2011A8.1\x208.1\x200\x200\x200\x204.5\x209M4\x205v4h4\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222.5\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M4\x2013a8.1\x208.1\x200\x200\x200\x2015.5\x202m.5\x204v-4h-4\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222.5\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','justifyContent','music-playlist-panel','[图片生成失败:\x20','确认合并','img','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','globalSettings','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>未找到相关的聊天记录。</p>','恭喜发财，大吉大利！','lyrics-vertical-pos','gbk','确认精炼','用户\x20(','battery-alert-text','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录结束]\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','chat-at-mention-popup','linear-gradient(135deg,\x20#f6d365,\x20#fda085)','shared-history-viewer-title','https://i.postimg.cc/mrkvDxPW/IMG-4422.gif','批量导入格式错误，已跳过此行:','ServiceWorker\x20注册成功，作用域为:\x20','检测到\x20EPhone\x20备份文件，执行标准导入...','\x22\x20class=\x22chat-image\x22></div>','favorites-search-clear-btn','char-music-progress-fill','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22thought-delete-btn\x22\x20data-timestamp=\x22','member-avatar-preview','\x0a[图片]','recall-message-btn','\x20张图片因网络或CORS限制下载失败。','isPinned','paidBy','角色卡数据无效或缺少\x27name\x27字段。','product-price-input','char-music-current-time','transfer-btn','qzone-banner-input','stickerCategoryId','AI未能成功描述图片。','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','world-book-tab','-\x20**与用户的关系**:\x20你和用户(','#data-clear-type-list\x20.clear-posts-item','#sticker-binding-chat-list\x20.sticker-binding-checkbox:checked','\x20条记忆精炼为\x201\x20条核心记忆！','AI返回的投票结果中未找到有效的JSON数组结构\x20(`[...]`)。','load-more-qzone-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的动态列表\x20(供你参考和评论)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','currentVoiceId','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22>背景</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20delete-track-btn\x22\x20data-index=\x22','天\x20-\x20夜晚',')\x20为\x20','清理后仍未找到JSON数组。','\x0a#\x20你的任务\x0a你是一个高级的“记忆分配专家”。你的任务是阅读下面的群聊记录，并为【每一个参与的AI角色】生成一段【个性化的、第一人称】的长期记忆。请专注于重要的情绪、事件和细节。\x0a','rule-editor-modal','add-ai-response-block-btn','day','legacy','rule-enabled-switch','regenerate-douban-btn','”。请自然地接受这个新名字，不要对此感到惊讶。]','preset_','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的帖子和评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“','确定要删除预设\x20“','\x20分钟)，本次独立行动跳过。','assign-group-select','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','confirm-share-target-btn','npc_','所有API与后台设置已保存!','.post-deleted-placeholder','我明白，覆盖所有数据','[发送了一张图片，描述为：\x27','（你目前没有绑定的NPC伙伴，可以自由创造新的NPC。）\x0a','核心库\x20(JSZip\x20或\x20StreamSaver)\x20未能成功加载，请检查您的网络连接并刷新页面后重试。','https://i.postimg.cc/GhR6DT4Q/IMG-4428.gif','message-bubble\x20recalled-message-placeholder','activeChatId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>“','API错误:\x20','streamed','save-douban-cast-btn','流程启动','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22/></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20心声\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text\x22>','<div></div><div></div><div></div><div></div><div></div>','memories','错误：找不到要转发的原始动态。','setup','删除分类及表情时出错:','douban-cast-list','douban-post-detail-title','flat','聊天记录已成功覆盖！正在刷新界面...','找不到相册:','msgTimestamp','#message-editor-container\x20textarea',':generateContent?key=','nai-gallery-action-bar','npc-avatar-input','NPC\x20昵称','poll-question-input','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>请先在聊天界面的<br>表情面板中添加表情包</p>','full','.variation-name-input','SAFETY','unreadPostsCount','werewolf-witch-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20right:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background:\x20','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','beginPath','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','未使用','MB)，正在归档...','\x20的消息:\x20\x22','group-avatar-input','chat-list-render-window-input','游戏尚未结束，无法进行总结。','该预设包含\x20','sendQzoneStickerComment:\x20找不到帖子:','.recalled-message-placeholder','https://i.postimg.cc/T2yKJ0DV/40.jpg','change_group_avatar','variations','[data-lang-key]','直连失败','linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)','</em>','Their\x20Browser\x20History','prompt','对方拒绝了你的视频通话请求。','variation-selected-price','\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','novelai-api-key','renderXSocialScreenProxy','\x22\x20title=\x22编辑\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20width=\x2218\x22\x20height=\x2218\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M11\x204H4a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2v-7\x22></path><path\x20d=\x22M18.5\x202.5a2.121\x202.121\x200\x200\x201\x203\x203L12\x2015l-4\x201\x201-4\x209.5-9.5z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quick-reply-delete-btn\x22\x20data-id=\x22','豆瓣设定','\x0a\x20\x20\x20\x20','innerHTML','\x20本世界书，并解除它们与所有角色的关联。此操作【不可恢复】！','regenerate-char-music-btn','图片解压失败:\x20','https://i.postimg.cc/Pq2xJN1g/IMG-7301.jpg','请填写完整的约定标题和日期！','isSpectatorGroup','decode','.chat-group-header:not([data-has-listener=\x22true\x22])','❌\x20[NAI下载]\x20下载失败:','readAsDataURL','</td><td\x20class=\x22item-qty\x22>','无效链接:\x20','blockCooldownHours','pipeTo','昨晚\x20','Moments','base','qzone-banner-img','\x20张</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>输入关键词或选择日期进行搜索。</p>','\x0a#\x20可用表情包\x20(全群共享)\x0a#\x20【【【表情使用铁律\x20(最高优先级)】】】\x0a1.\x20\x20【绝对禁止】只发送一个表情作为单独的回复。\x0a2.\x20\x20【绝对禁止】发明或编造列表中不存在的表情含义。\x0a3.\x20\x20如果没找到合适的，请不要使用\x20\x22sticker\x22\x20指令。\x0a4.\x20\x20**【角色分配】**:\x20你可以从下面的【共享列表】中选择任意表情，并将其分配给【任意AI角色】。\x0a5.\x20【使用频率】:\x20请只在你觉得【非常必要】或【情绪特别强烈】时才使用表情，保持对话的自然性。\x0a6.\x20\x20**【重复惩罚\x20(最高铁律！)】**:\x20你【绝对禁止】连续几轮回复使用【完全相同】的表情含义。例如，如果你上一轮回复了\x20\x22meaning\x22:\x20\x22害羞\x22，那么你这一轮【绝对不能】再次使用\x20\x22meaning\x22:\x20\x22害羞\x22。你必须选择一个不同的含义，或者干脆不发表情。\x0a-\x20**可用列表**:\x0a','final',')\x20领取了最后一个红包。红包已被领完，手气王是\x20','postTitle','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>','string','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','.lyric-line','currentTime','\x22\x20尝试领取不属于自己的专属红包\x20(接收人:\x20','repost-comment-input','Delete\x20(Notify\x20AI)','Font\x20Settings','message-bubble\x20','realimag','char-music-item','请输入一个有效的数字（建议大于20）。','未找到该图片的原始提示词(prompt)。','总结长期记忆时出错:','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','确认导入','手动创建角色','world-book-checkboxes-container','currentPhase','@[[','Cphone数据\x20(CPhone)','AI女巫决策：今天是第','secondary-proxy-url','totalElapsedTime','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>公告的原消息已被删除。</p>','字体预设管理','#000000','shopping-category-count-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊视频通话的导演。你的任务是扮演所有【除了用户以外】的AI角色，并以【第三人称旁观视角】来描述他们在通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【身份铁律】**:\x20用户的身份是【','favorites-edit-btn','click','已成功删除\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','preset-avatar-preview','编辑预设','ttsCache','profile-history-icon-btn','删除动态','复制成功','gift','🌐\x20使用网络URL','close-transcript-modal-btn','base_resp','world-book-editor-title',')，内容摘要是：“','repostComment','图片详情','custom-modal-confirm','.album-art-btn','profile-edit-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22icon-preview\x22\x20src=\x22','操作结果','帖子详情','devicePixelRatio','char-chat-list','#preset-tabs\x20.world-book-tab','”\x20绑定到...','https://i.postimg.cc/4x9tTy1D/IMG-5563.gif','items','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','解析成功：标准JSON数组格式。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>预估总上下文Token数:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22\x20style=\x22color:\x20red;\x22>计算出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','postType','prompts','padding','\x20条新消息','.message-bubble','无法生成模拟聊天记录，请检查API配置或稍后再试。\x0a错误:\x20','json','<span\x20style=\x22color:\x20green;\x22>是</span>','https://i.postimg.cc/L6R7x16R/IMG-7278.jpg','handleWidgetImageChange','\x0a#\x20你的聊天对象（用户）的人设\x0a','editable-text','这是群里的第一条消息。','”中，用户的昵称是“','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的参考信息：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的角色设定**:\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>','transform\x200.3s\x20cubic-bezier(0.25,\x200.46,\x200.45,\x200.94)','公告已发布！','line-through','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','Voice\x20Model','\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a','请输入世界书的名称...','合并失败'];_0x6777=function(){return _0x20fe01;};return _0x6777();}function setLanguage(_0x36aeaa){const _0x5e464d=_0x710220;!translations[_0x36aeaa]&&(console[_0x5e464d(0x75e)](_0x5e464d(0xd41)+_0x36aeaa+_0x5e464d(0x169a)),_0x36aeaa=_0x5e464d(0x1271)),currentLanguage=_0x36aeaa,localStorage['setItem'](_0x5e464d(0x11e3),_0x36aeaa),document[_0x5e464d(0xf9f)][_0x5e464d(0xb95)]=_0x36aeaa,document[_0x5e464d(0x527)](_0x5e464d(0x1567))['forEach'](_0x501f66=>{const _0x19c834=_0x5e464d,_0x50560=_0x501f66[_0x19c834(0x10ff)]('data-lang-key');translations[_0x36aeaa][_0x50560]&&(_0x501f66['textContent']=translations[_0x36aeaa][_0x50560]);}),document[_0x5e464d(0x527)]('[data-lang-key-placeholder]')['forEach'](_0x48035b=>{const _0x17ecf8=_0x5e464d,_0x30c6bd=_0x48035b[_0x17ecf8(0x10ff)](_0x17ecf8(0xbf9));translations[_0x36aeaa][_0x30c6bd]&&(_0x48035b[_0x17ecf8(0xb8e)]=translations[_0x36aeaa][_0x30c6bd]);}),document['querySelectorAll'](_0x5e464d(0x1613))['forEach'](_0x3333c4=>{const _0x37839c=_0x5e464d,_0x322b24=_0x3333c4[_0x37839c(0x10ff)]('data-lang-key-title');translations[_0x36aeaa][_0x322b24]&&(_0x3333c4[_0x37839c(0x647)]=translations[_0x36aeaa][_0x322b24]);});}function initLanguage(){const _0x138e14=_0x710220,_0x274dd5=localStorage['getItem'](_0x138e14(0x11e3))||'zh-CN',_0x406165=document[_0x138e14(0x400)](_0x138e14(0xde0));_0x406165&&(_0x406165[_0x138e14(0xa1e)]=_0x274dd5,_0x406165[_0x138e14(0x501)](_0x138e14(0x866),_0x49221e=>{const _0x4bb6ea=_0x138e14,_0x4122c8=_0x49221e['target']['value'];alert(translations[_0x4122c8][_0x4bb6ea(0x1085)]),localStorage[_0x4bb6ea(0x143f)]('ephone-language',_0x4122c8),setTimeout(()=>window['location'][_0x4bb6ea(0x1058)](),0x64);})),setLanguage(_0x274dd5);}(function(){'use strict';const _0x518117=_0x710220;function _0x2cdeb5(_0x206390,_0x52eb09){const _0x2e63c9=_0x466f;try{const _0x150159=document['createElement']('a');_0x150159['href']=_0x206390,_0x150159[_0x2e63c9(0xcda)]=_0x52eb09,_0x150159['style'][_0x2e63c9(0xb1a)]=_0x2e63c9(0x165b),document[_0x2e63c9(0x471)][_0x2e63c9(0x8f2)](_0x150159),_0x150159[_0x2e63c9(0x15ad)](),setTimeout(()=>{const _0x3b1d6d=_0x2e63c9;document[_0x3b1d6d(0x471)]['removeChild'](_0x150159);},0x64),console[_0x2e63c9(0x1e6)](_0x2e63c9(0x285),_0x52eb09),_0xbe3a28();}catch(_0x16ddd9){console[_0x2e63c9(0x5d7)]('❌\x20[NAI下载]\x20下载失败:',_0x16ddd9),_0xbe3a28(_0x2e63c9(0xce9),_0x2e63c9(0x5d7));}}function _0xbe3a28(_0x259603='📥\x20图片下载中...',_0x60e7a=_0x518117(0x50a)){const _0x2e80f4=_0x518117,_0x2f85cf=document[_0x2e80f4(0x2c9)]('div');_0x2f85cf[_0x2e80f4(0xde7)]=_0x259603,_0x2f85cf[_0x2e80f4(0xa00)][_0x2e80f4(0x32e)]=_0x2e80f4(0x1557)+(_0x60e7a===_0x2e80f4(0x50a)?_0x2e80f4(0x4dc):_0x2e80f4(0x1dd))+_0x2e80f4(0x1334),document[_0x2e80f4(0x471)][_0x2e80f4(0x8f2)](_0x2f85cf),setTimeout(()=>{const _0x347835=_0x2e80f4;_0x2f85cf['style'][_0x347835(0xbfa)]='1',_0x2f85cf[_0x347835(0xa00)]['transform']='translateY(0)';},0xa),setTimeout(()=>{const _0x11fa3f=_0x2e80f4;_0x2f85cf['style']['opacity']='0',_0x2f85cf[_0x11fa3f(0xa00)][_0x11fa3f(0x8ea)]=_0x11fa3f(0xb14),setTimeout(()=>{const _0x2eab08=_0x11fa3f;_0x2f85cf[_0x2eab08(0xc46)]();},0x12c);},0x7d0);}function _0xd512b0(_0x1fc93f){const _0x25cb8c=_0x518117,_0x3f743f=_0x1fc93f[_0x25cb8c(0x10ff)](_0x25cb8c(0x647))||_0x1fc93f[_0x25cb8c(0x10ff)](_0x25cb8c(0xda9))||'';let _0x313da6=_0x3f743f[_0x25cb8c(0xe19)](/[^a-zA-Z0-9\u4e00-\u9fa5\s]/g,'_')['replace'](/\s+/g,'_')[_0x25cb8c(0x371)](0x0,0x1e);!_0x313da6&&(_0x313da6=_0x25cb8c(0x4f9));const _0xebb775=new Date()[_0x25cb8c(0x886)]()[_0x25cb8c(0xe19)](/[-:]/g,'')[_0x25cb8c(0xe19)]('T','_')[_0x25cb8c(0x5ad)]('.')[0x0];return _0x313da6+'_'+_0xebb775+_0x25cb8c(0x57b);}function _0x2ff4bc(_0x4dcffc){const _0xfd0e01=_0x518117,_0x48ca9d=_0x4dcffc[_0xfd0e01(0xa00)]['transform']||'',_0x4c57d1=_0x4dcffc[_0xfd0e01(0xa00)][_0xfd0e01(0x139d)]||'';_0x4dcffc[_0xfd0e01(0xa00)]['transition']=_0xfd0e01(0x794),_0x4dcffc[_0xfd0e01(0xa00)][_0xfd0e01(0x8ea)]=_0xfd0e01(0xfa0),setTimeout(()=>{const _0x278df8=_0xfd0e01;_0x4dcffc[_0x278df8(0xa00)][_0x278df8(0x8ea)]=_0x48ca9d,setTimeout(()=>{_0x4dcffc['style']['transition']=_0x4c57d1;},0x96);},0x96);}let _0x3384a2=0x0,_0xb684a0=null,_0x1f76f8=null;document[_0x518117(0x501)]('click',function(_0x124536){const _0x5485e1=_0x518117,_0xe94e43=_0x124536['target'];if(_0xe94e43['tagName']===_0x5485e1(0x7b7)&&(_0xe94e43[_0x5485e1(0xb08)][_0x5485e1(0xd3f)](_0x5485e1(0x149a))||_0xe94e43[_0x5485e1(0xb08)][_0x5485e1(0xd3f)](_0x5485e1(0xe27)))){_0xe94e43===_0x1f76f8?_0x3384a2++:(_0x3384a2=0x1,_0x1f76f8=_0xe94e43);_0xb684a0&&clearTimeout(_0xb684a0);if(_0x3384a2===0x3){_0x3384a2=0x0,_0x1f76f8=null,_0x124536[_0x5485e1(0x92e)](),_0x124536[_0x5485e1(0x504)](),console[_0x5485e1(0x1e6)](_0x5485e1(0xfb9)),_0x2ff4bc(_0xe94e43);const _0x673a1b=_0xe94e43[_0x5485e1(0x912)];if(!_0x673a1b||_0x673a1b==='about:blank'){console[_0x5485e1(0x75e)]('⚠️\x20[NAI下载]\x20图片源为空，无法下载'),_0xbe3a28(_0x5485e1(0xdaf),'error');return;}const _0x3bdb1d=_0xd512b0(_0xe94e43);_0x2cdeb5(_0x673a1b,_0x3bdb1d);}else _0xb684a0=setTimeout(()=>{_0x3384a2=0x0,_0x1f76f8=null;},0x1f4);}},!![]),console['log'](_0x518117(0x4ad)),console[_0x518117(0x1e6)]('💡\x20[NAI下载]\x20提示：三击任意NAI图片即可下载');}());_0x710220(0x1005)in navigator&&window[_0x710220(0x501)]('load',()=>{const _0x404018=_0x710220;navigator['serviceWorker']['register'](_0x404018(0x14a4))['then'](_0x3995cc=>{const _0x35dbff=_0x404018;console[_0x35dbff(0x1e6)](_0x35dbff(0x14ff),_0x3995cc[_0x35dbff(0x126a)]);})[_0x404018(0x37a)](_0x5071c4=>{const _0x4614ba=_0x404018;console[_0x4614ba(0x1e6)]('ServiceWorker\x20注册失败:\x20',_0x5071c4);});});!Array['prototype'][_0x710220(0x3bf)]&&Object[_0x710220(0x75f)](Array[_0x710220(0x9d9)],'findLastIndex',{'value':function(_0x85d112){const _0xc37840=_0x710220;if(this==null)throw new TypeError(_0xc37840(0x12c9));if(typeof _0x85d112!==_0xc37840(0x11b6))throw new TypeError(_0xc37840(0x683));let _0x2768b8=Object(this),_0x759e7b=_0x2768b8['length']>>>0x0,_0x18b178=arguments[0x1],_0x3fb8ac=_0x759e7b-0x1;while(_0x3fb8ac>=0x0){let _0x2796f2=_0x2768b8[_0x3fb8ac];if(_0x85d112[_0xc37840(0xc94)](_0x18b178,_0x2796f2,_0x3fb8ac,_0x2768b8))return _0x3fb8ac;_0x3fb8ac--;}return-0x1;},'configurable':!![],'writable':!![]});const dynamicIslandContent=document[_0x710220(0x400)](_0x710220(0x6a8)),islandAlbumArt=document[_0x710220(0x400)](_0x710220(0x23d)),islandLyricContainer=document['getElementById'](_0x710220(0x977)),islandLyricText=document[_0x710220(0x400)](_0x710220(0x100c)),phoneScreenForIsland=document[_0x710220(0x400)]('phone-screen');let activeMessageTimestamp=null,activeTransferTimestamp=null,lastRawAiResponse='',lastResponseTimestamps=[],lastPrivateMessagesSent=[],lastGroupMessagesSent=[],currentQzoneReplyContext=null,editingNpcId=null,pendingBackupData=null;const GEMINI_API_URL='https://generativelanguage.googleapis.com/v1beta/models';function findBestStickerMatch(_0x30e58e,_0x44728d){const _0x42d1e9=_0x710220;if(!_0x30e58e||!_0x44728d||_0x44728d[_0x42d1e9(0x8d6)]===0x0)return null;const _0x252cf7=0.7,_0x34db4f=[];let _0x4dc456=0x0;const _0xc89981=_0x10e7ed=>[...new Set(_0x10e7ed[_0x42d1e9(0xe19)](/\s+/g,''))],_0x586142=_0xc89981(_0x30e58e);_0x44728d[_0x42d1e9(0xbdc)](_0x3f3052=>{const _0x5c8971=_0x42d1e9;if(!_0x3f3052['name'])return;const _0x23b319=_0xc89981(_0x3f3052[_0x5c8971(0xf3e)]),_0x12977c=_0x23b319[_0x5c8971(0x29d)](_0x367671=>_0x586142[_0x5c8971(0xd1b)](_0x367671)),_0x41a6c9=_0x12977c[_0x5c8971(0x8d6)]/(_0x23b319[_0x5c8971(0x8d6)]+_0x586142[_0x5c8971(0x8d6)]-_0x12977c[_0x5c8971(0x8d6)]);_0x41a6c9>_0x4dc456&&(_0x4dc456=_0x41a6c9),_0x41a6c9>=_0x252cf7&&_0x34db4f[_0x5c8971(0x6bb)]({'sticker':_0x3f3052,'score':_0x41a6c9});});if(_0x34db4f[_0x42d1e9(0x8d6)]>0x0){const _0x38427c=_0x34db4f[_0x42d1e9(0x29d)](_0x1020cd=>_0x1020cd[_0x42d1e9(0x11e1)]===_0x4dc456),_0x1e70ef=Math[_0x42d1e9(0x1381)](Math[_0x42d1e9(0x12bc)]()*_0x38427c[_0x42d1e9(0x8d6)]),_0x4c3c7e=_0x38427c[_0x1e70ef][_0x42d1e9(0x12c2)];return console[_0x42d1e9(0x1e6)](_0x42d1e9(0x1636)+_0x30e58e+_0x42d1e9(0xcc9)+_0x38427c['length']+'\x20个最佳选项,\x20随机选中:\x20\x22'+_0x4c3c7e[_0x42d1e9(0xf3e)]+_0x42d1e9(0x162c)+_0x4dc456[_0x42d1e9(0x2ea)](0x2)),_0x4c3c7e;}return console[_0x42d1e9(0x1e6)](_0x42d1e9(0x8fb)+_0x30e58e+_0x42d1e9(0xd5a)+_0x4dc456[_0x42d1e9(0x2ea)](0x2)+_0x42d1e9(0xf32)+_0x252cf7+'。'),null;}function getRandomValue(_0x39a74a){const _0x19fca4=_0x710220;if(_0x39a74a['includes'](',')){const _0x4fc91c=_0x39a74a[_0x19fca4(0x5ad)](',')['map'](_0x140ffa=>_0x140ffa[_0x19fca4(0xb8f)]()),_0x4135d4=Math[_0x19fca4(0x1381)](Math['random']()*_0x4fc91c[_0x19fca4(0x8d6)]);return _0x4fc91c[_0x4135d4];}return _0x39a74a;}function isImage(_0x1444b0){const _0x5d77d9=_0x710220;if(_0x1444b0[_0x5d77d9(0x164d)]&&_0x1444b0[_0x5d77d9(0x164d)][_0x5d77d9(0x299)]){let _0x5709e2=_0x1444b0[_0x5d77d9(0x164d)][_0x5d77d9(0x299)];const _0x5251df=_0x5709e2['split'](',')[0x1],_0x1cb0a7=_0x5709e2[_0x5d77d9(0xbf7)](/^data:(.*);base64/)[0x1];return[{'text':_0x5d77d9(0x5a7)},{'inline_data':{'mime_type':_0x1cb0a7,'data':_0x5251df}}];}return[];}function getGeminiResponseText(_0x535513){const _0x5e0d1f=_0x710220;if(_0x535513[_0x5e0d1f(0xf7c)]&&Array[_0x5e0d1f(0x16a1)](_0x535513[_0x5e0d1f(0xf7c)])&&_0x535513[_0x5e0d1f(0xf7c)][_0x5e0d1f(0x8d6)]>0x0&&_0x535513['choices'][0x0][_0x5e0d1f(0x6e2)]&&_0x535513[_0x5e0d1f(0xf7c)][0x0][_0x5e0d1f(0x6e2)]['content'])return _0x535513[_0x5e0d1f(0xf7c)][0x0][_0x5e0d1f(0x6e2)][_0x5e0d1f(0x1109)];if(_0x535513[_0x5e0d1f(0xc89)]&&Array[_0x5e0d1f(0x16a1)](_0x535513[_0x5e0d1f(0xc89)])&&_0x535513[_0x5e0d1f(0xc89)][_0x5e0d1f(0x8d6)]>0x0&&_0x535513[_0x5e0d1f(0xc89)][0x0][_0x5e0d1f(0x1109)]&&_0x535513[_0x5e0d1f(0xc89)][0x0]['content'][_0x5e0d1f(0x162d)])return _0x535513[_0x5e0d1f(0xc89)][0x0][_0x5e0d1f(0x1109)][_0x5e0d1f(0x162d)][0x0][_0x5e0d1f(0x117f)];console[_0x5e0d1f(0x5d7)](_0x5e0d1f(0x3de),_0x535513);let _0xf921cc=_0x5e0d1f(0x1421);if(_0x535513[_0x5e0d1f(0xc89)]&&Array[_0x5e0d1f(0x16a1)](_0x535513[_0x5e0d1f(0xc89)])&&_0x535513['candidates'][_0x5e0d1f(0x8d6)]>0x0&&_0x535513[_0x5e0d1f(0xc89)][0x0][_0x5e0d1f(0x277)]===_0x5e0d1f(0x1554)){const _0x4b3fdc=_0x535513[_0x5e0d1f(0xc89)][0x0][_0x5e0d1f(0x10ac)],_0x3c83d5=_0x4b3fdc['filter'](_0x4749bd=>_0x4749bd[_0x5e0d1f(0x252)]!==_0x5e0d1f(0x1454)&&_0x4749bd[_0x5e0d1f(0x252)]!==_0x5e0d1f(0xd70))[_0x5e0d1f(0xd18)](_0x555c1b=>_0x555c1b['category']+_0x5e0d1f(0x1130)+_0x555c1b['probability']+')')['join'](',\x20');_0xf921cc=_0x5e0d1f(0xb84)+(_0x3c83d5||'未知');}else{if(_0x535513[_0x5e0d1f(0x1633)]?.['blockReason']){const _0xf07ea5=_0x535513[_0x5e0d1f(0x1633)][_0x5e0d1f(0x57d)],_0x55d404=_0x535513['promptFeedback'][_0x5e0d1f(0x10ac)]?.[_0x5e0d1f(0xd18)](_0x2f8557=>_0x2f8557[_0x5e0d1f(0x1677)]+':\x20'+_0x2f8557['probability'])[_0x5e0d1f(0xee1)](',\x20');_0xf921cc=_0x5e0d1f(0x812)+_0xf07ea5+')。详情:\x20'+(_0x55d404||'无');}else _0x535513[_0x5e0d1f(0x5d7)]&&(_0xf921cc=_0x5e0d1f(0x153b)+_0x535513[_0x5e0d1f(0x5d7)][_0x5e0d1f(0x6e2)]);}throw new Error(_0xf921cc);}document[_0x710220(0x501)](_0x710220(0xc41),()=>{const _0x239c7d=_0x710220,_0xcd5d0b=_0x239c7d(0x14b2);async function _0x40ccc7(_0x5dbe36,_0xf65f72){const _0x5665dc=_0x239c7d;if(!_0x5dbe36||!_0xf65f72)throw new Error(_0x5665dc(0x915));const _0x2d59ac=_0x5dbe36+_0xf65f72,_0x14a1bc=new TextEncoder()[_0x5665dc(0x729)](_0x2d59ac),_0x1b2c10=await crypto[_0x5665dc(0x15e7)][_0x5665dc(0xa13)](_0x5665dc(0x13ea),_0x14a1bc),_0x5cb334=Array[_0x5665dc(0xdc0)](new Uint8Array(_0x1b2c10)),_0x5f062e=_0x5cb334[_0x5665dc(0xd18)](_0x42686f=>_0x42686f[_0x5665dc(0xa60)](0x10)['padStart'](0x2,'0'))[_0x5665dc(0xee1)]('');return _0x5f062e['substring'](0x0,0x6)['toUpperCase']();}function _0x2bf707(){return new Promise(async(_0x409168,_0x5c9f10)=>{const _0x41f17f=_0x466f;if(isPinActivated){_0x409168(!![]);return;}const _0x3722f8=document['getElementById'](_0x41f17f(0x851)),_0x16baa6=document[_0x41f17f(0x400)]('pin-device-id-display'),_0x5d1dd9=document[_0x41f17f(0x400)](_0x41f17f(0x1431)),_0x33df0e=document[_0x41f17f(0x400)]('pin-modal-confirm-btn'),_0x245b36=document[_0x41f17f(0x400)](_0x41f17f(0xd0e));_0x16baa6['value']=EPHONE_DEVICE_ID,_0x5d1dd9[_0x41f17f(0xa1e)]='';const _0x2d1989=async()=>{const _0x5d8322=_0x41f17f,_0x5b26c6=_0x5d1dd9[_0x5d8322(0xa1e)];_0x3722f8[_0x5d8322(0xb08)][_0x5d8322(0xc46)]('visible'),_0x33df0e[_0x5d8322(0xf17)](_0x5d8322(0x15ad),_0x2d1989),_0x245b36[_0x5d8322(0xf17)]('click',_0x53b11a);if(!_0x5b26c6||!_0x5b26c6[_0x5d8322(0xb8f)]()){await _0x138765(_0x5d8322(0x1651),_0x5d8322(0x32f)),_0x5c9f10(new Error(_0x5d8322(0xc0c)));return;}await _0x138765(_0x5d8322(0x13e9),_0x5d8322(0x20e));try{const _0x2325a6=await _0x40ccc7(EPHONE_DEVICE_ID,_0xcd5d0b);_0x5b26c6['trim']()['toUpperCase']()===_0x2325a6?(localStorage[_0x5d8322(0x143f)](_0x5d8322(0x928),'true'),isPinActivated=!![],await _0x138765('激活成功！',_0x5d8322(0x1032)),_0x27c7e2(),_0x409168(!![])):(await _0x138765(_0x5d8322(0x3ca),_0x5d8322(0xb16)),_0x5c9f10(new Error('激活码不正确。')));}catch(_0x14c5f3){console[_0x5d8322(0x5d7)](_0x5d8322(0x9a9),_0x14c5f3),await _0x138765(_0x5d8322(0x3ca),_0x5d8322(0x1038)+_0x14c5f3[_0x5d8322(0x6e2)]),_0x5c9f10(_0x14c5f3);}},_0x53b11a=async()=>{const _0x4c0e59=_0x41f17f;_0x3722f8[_0x4c0e59(0xb08)]['remove'](_0x4c0e59(0x9eb)),_0x33df0e[_0x4c0e59(0xf17)]('click',_0x2d1989),_0x245b36[_0x4c0e59(0xf17)](_0x4c0e59(0x15ad),_0x53b11a),await _0x138765(_0x4c0e59(0x1651),_0x4c0e59(0x6e1)),_0x5c9f10(new Error(_0x4c0e59(0x135d)));};_0x33df0e[_0x41f17f(0x501)]('click',_0x2d1989),_0x245b36[_0x41f17f(0x501)](_0x41f17f(0x15ad),_0x53b11a),_0x3722f8[_0x41f17f(0xb08)][_0x41f17f(0x12b6)]('visible'),_0x5d1dd9[_0x41f17f(0x797)]();});}function _0x27c7e2(){const _0xbd02bb=_0x239c7d,_0x29f7c8=localStorage['getItem'](_0xbd02bb(0x928))===_0xbd02bb(0xaea),_0x2d523f=document[_0xbd02bb(0x400)](_0xbd02bb(0x14e4)),_0x1833bb=document[_0xbd02bb(0x400)](_0xbd02bb(0xd3b));_0x2d523f&&_0x2d523f[_0xbd02bb(0xb08)][_0xbd02bb(0x146f)]('locked-feature',!_0x29f7c8),_0x1833bb&&_0x1833bb[_0xbd02bb(0xb08)][_0xbd02bb(0x146f)](_0xbd02bb(0xcdd),!_0x29f7c8);}document[_0x239c7d(0x501)]('visibilitychange',()=>{const _0x4b0fa2=_0x239c7d;document[_0x4b0fa2(0x5e2)]==='visible'&&(console[_0x4b0fa2(0x1e6)](_0x4b0fa2(0xc71)),navigator[_0x4b0fa2(0x1005)][_0x4b0fa2(0x5fd)][_0x4b0fa2(0xa8b)](_0x599764=>{const _0x39b059=_0x4b0fa2;_0x599764[_0x39b059(0x126d)]();}));});function _0x3914a6(_0x40a0cd,_0xa7f8b2,_0x5a3804,_0x1190e9){const _0xbeafef=_0x239c7d,_0x439602=_0x4c8b14[_0xbeafef(0x14f1)][_0xbeafef(0x216)]||0.8,_0x3f2cdd={'user':_0xbeafef(0x6d6),'assistant':_0xbeafef(0xea4),'system':_0xbeafef(0x6d6)},_0x457923=[{'role':'user','parts':[{'text':_0x5a3804}]},{'role':_0xbeafef(0xea4),'parts':[{'text':'好的，我明白了。我会严格遵守以上所有规则和设定。'}]},..._0x1190e9[_0xbeafef(0xd18)](_0x157a7c=>{const _0x34715d=_0xbeafef,_0x3d36c8=[];return Array[_0x34715d(0x16a1)](_0x157a7c[_0x34715d(0x1109)])?_0x157a7c[_0x34715d(0x1109)]['forEach'](_0xf0a098=>{const _0xb01c53=_0x34715d;if(_0xf0a098[_0xb01c53(0xbbf)]===_0xb01c53(0x117f))_0x3d36c8['push']({'text':_0xf0a098[_0xb01c53(0x117f)]});else{if(_0xf0a098[_0xb01c53(0xbbf)]===_0xb01c53(0x164d)&&_0xf0a098[_0xb01c53(0x164d)]&&_0xf0a098[_0xb01c53(0x164d)]['url']){const _0x20610b=_0xf0a098[_0xb01c53(0x164d)]['url'],_0x4773c1=_0x20610b['split'](',')[0x1],_0x2a8993=_0x20610b['match'](/^data:(.*);base64/);_0x2a8993&&_0x4773c1&&_0x3d36c8['push']({'inline_data':{'mime_type':_0x2a8993[0x1],'data':_0x4773c1}});}}}):_0x3d36c8['push']({'text':String(_0x157a7c[_0x34715d(0x1109)])}),{'role':_0x3f2cdd[_0x157a7c[_0x34715d(0x71a)]],'parts':_0x3d36c8};})];return{'url':_0xbeafef(0x1476)+_0x40a0cd+_0xbeafef(0x154c)+getRandomValue(_0xa7f8b2),'data':{'method':_0xbeafef(0x953),'headers':{'Content-Type':_0xbeafef(0xfae)},'body':JSON['stringify']({'contents':_0x457923,'generationConfig':{'temperature':_0x439602}})}};}const _0x54c587=new Dexie(_0x239c7d(0x967)),_0x1a380a=[{'id':'none','url':'','name':'无'},{'id':_0x239c7d(0x1168),'url':_0x239c7d(0xed5),'name':'1'},{'id':_0x239c7d(0xcbf),'url':_0x239c7d(0x120a),'name':'2'},{'id':_0x239c7d(0xece),'url':_0x239c7d(0x4da),'name':'3'},{'id':_0x239c7d(0x12fb),'url':_0x239c7d(0x14a2),'name':'4'},{'id':_0x239c7d(0x13bc),'url':_0x239c7d(0x11c9),'name':'5'},{'id':_0x239c7d(0x169d),'url':_0x239c7d(0x11df),'name':'6'},{'id':_0x239c7d(0x2e0),'url':_0x239c7d(0xcf1),'name':'7'},{'id':_0x239c7d(0x167a),'url':_0x239c7d(0x511),'name':'8'},{'id':_0x239c7d(0x80d),'url':_0x239c7d(0x11ed),'name':'9'},{'id':'frame_10','url':_0x239c7d(0x636),'name':'10'},{'id':'frame_11','url':'https://i.postimg.cc/zvz2LGK0/IMG-4367.gif','name':'11'},{'id':_0x239c7d(0xf54),'url':_0x239c7d(0xa4d),'name':'12'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0x1495),'name':'13'},{'id':_0x239c7d(0x11f9),'url':'https://i.postimg.cc/fRt2SFSn/IMG-4368.gif','name':'14'},{'id':_0x239c7d(0x1168),'url':'https://i.postimg.cc/kGgwJhPH/IMG-4374.gif','name':'1'},{'id':_0x239c7d(0xcbf),'url':'https://i.postimg.cc/PrcKH436/IMG-4376.gif','name':'2'},{'id':_0x239c7d(0xece),'url':_0x239c7d(0xbd1),'name':'3'},{'id':_0x239c7d(0x12fb),'url':_0x239c7d(0xa9f),'name':'4'},{'id':_0x239c7d(0x13bc),'url':_0x239c7d(0x9df),'name':'5'},{'id':'frame_6','url':_0x239c7d(0xc28),'name':'6'},{'id':_0x239c7d(0x2e0),'url':'https://i.postimg.cc/RZNLhbbr/IMG-4389.gif','name':'7'},{'id':_0x239c7d(0x167a),'url':'https://i.postimg.cc/fLTc42dg/IMG-4391.gif','name':'8'},{'id':_0x239c7d(0x80d),'url':_0x239c7d(0xa25),'name':'9'},{'id':_0x239c7d(0x679),'url':'https://i.postimg.cc/XY63sTS3/IMG-4393.gif','name':'10'},{'id':_0x239c7d(0x467),'url':_0x239c7d(0x903),'name':'11'},{'id':_0x239c7d(0xf54),'url':_0x239c7d(0x7e6),'name':'12'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0x101c),'name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x1621),'name':'14'},{'id':'frame_cat_ear','url':_0x239c7d(0x8d9),'name':'1'},{'id':_0x239c7d(0xcbf),'url':_0x239c7d(0x80b),'name':'2'},{'id':_0x239c7d(0xece),'url':_0x239c7d(0xe63),'name':'3'},{'id':_0x239c7d(0x12fb),'url':_0x239c7d(0xc9c),'name':'4'},{'id':'frame_5','url':'https://i.postimg.cc/q7cQnDy1/IMG-4404.gif','name':'5'},{'id':_0x239c7d(0x169d),'url':_0x239c7d(0x787),'name':'6'},{'id':_0x239c7d(0x2e0),'url':_0x239c7d(0xfaa),'name':'7'},{'id':_0x239c7d(0x167a),'url':'https://i.postimg.cc/W1CjLb4J/IMG-4409.gif','name':'8'},{'id':_0x239c7d(0x80d),'url':_0x239c7d(0x12f5),'name':'9'},{'id':'frame_10','url':_0x239c7d(0x3c8),'name':'10'},{'id':_0x239c7d(0x467),'url':'https://i.postimg.cc/cHWp0KG6/IMG-4413.gif','name':'11'},{'id':_0x239c7d(0xf54),'url':_0x239c7d(0x99f),'name':'12'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0xeda),'name':'13'},{'id':'frame_14','url':_0x239c7d(0x3a9),'name':'14'},{'id':_0x239c7d(0x1168),'url':_0x239c7d(0x990),'name':'1'},{'id':'frame_ribbon','url':_0x239c7d(0x429),'name':'2'},{'id':_0x239c7d(0xece),'url':_0x239c7d(0x118b),'name':'3'},{'id':_0x239c7d(0x12fb),'url':'https://i.postimg.cc/J4WCQd2j/IMG-4420.gif','name':'4'},{'id':_0x239c7d(0x13bc),'url':'https://i.postimg.cc/Dydkpd9H/IMG-4421.gif','name':'5'},{'id':_0x239c7d(0x169d),'url':_0x239c7d(0x14fd),'name':'6'},{'id':_0x239c7d(0x2e0),'url':_0x239c7d(0xd15),'name':'7'},{'id':_0x239c7d(0x167a),'url':_0x239c7d(0x26f),'name':'8'},{'id':_0x239c7d(0x80d),'url':_0x239c7d(0x481),'name':'9'},{'id':_0x239c7d(0x679),'url':_0x239c7d(0x1537),'name':'10'},{'id':_0x239c7d(0x467),'url':_0x239c7d(0x1203),'name':'11'},{'id':_0x239c7d(0xf54),'url':_0x239c7d(0x806),'name':'12'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0x909),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/tC9mJ0cv/IMG-4438.gif','name':'14'},{'id':'frame_cat_ear','url':_0x239c7d(0x1057),'name':'1'},{'id':_0x239c7d(0xcbf),'url':'https://i.postimg.cc/Mpv5fzm5/IMG-4439.gif','name':'2'},{'id':_0x239c7d(0xece),'url':_0x239c7d(0x15fc),'name':'3'},{'id':_0x239c7d(0x12fb),'url':'https://i.postimg.cc/c4JMPd2W/IMG-4724.gif','name':'4'},{'id':_0x239c7d(0x13bc),'url':_0x239c7d(0x1274),'name':'5'},{'id':_0x239c7d(0x169d),'url':_0x239c7d(0x854),'name':'6'},{'id':_0x239c7d(0x2e0),'url':'https://i.postimg.cc/Lsjzj5Yt/IMG-4729.gif','name':'7'},{'id':_0x239c7d(0x167a),'url':_0x239c7d(0x1198),'name':'8'},{'id':'frame_9','url':_0x239c7d(0x15c8),'name':'9'},{'id':_0x239c7d(0x679),'url':_0x239c7d(0x34c),'name':'10'},{'id':_0x239c7d(0x467),'url':_0x239c7d(0xc6b),'name':'11'},{'id':_0x239c7d(0xf54),'url':_0x239c7d(0xfbf),'name':'12'},{'id':_0x239c7d(0x1e5),'url':'https://i.postimg.cc/wjH180kn/IMG-5566.gif','name':'13'},{'id':_0x239c7d(0x11f9),'url':'https://i.postimg.cc/MG6qtLYK/IMG-5565.gif','name':'14'},{'id':_0x239c7d(0x1168),'url':_0x239c7d(0x8cc),'name':'1'},{'id':'frame_ribbon','url':'https://i.postimg.cc/hj4dkrvj/IMG-5578.gif','name':'2'},{'id':_0x239c7d(0xece),'url':'https://i.postimg.cc/hj4dkrvj/IMG-5578.gif','name':'3'},{'id':'frame_tech','url':_0x239c7d(0x1441),'name':'4'},{'id':'frame_5','url':_0x239c7d(0xbdb),'name':'5'},{'id':_0x239c7d(0x169d),'url':_0x239c7d(0x645),'name':'6'},{'id':_0x239c7d(0x2e0),'url':_0x239c7d(0x2fe),'name':'7'},{'id':_0x239c7d(0x167a),'url':_0x239c7d(0x923),'name':'8'},{'id':_0x239c7d(0x80d),'url':_0x239c7d(0x863),'name':'9'},{'id':'frame_10','url':_0x239c7d(0xe41),'name':'10'},{'id':_0x239c7d(0x467),'url':_0x239c7d(0x11ad),'name':'11'},{'id':_0x239c7d(0xf54),'url':_0x239c7d(0x71b),'name':'12'},{'id':'frame_13','url':_0x239c7d(0x466),'name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x254),'name':'14'},{'id':'frame_cat_ear','url':_0x239c7d(0xea6),'name':'1'},{'id':_0x239c7d(0xcbf),'url':_0x239c7d(0x11c1),'name':'2'},{'id':_0x239c7d(0xece),'url':_0x239c7d(0xf40),'name':'3'},{'id':_0x239c7d(0x12fb),'url':_0x239c7d(0x609),'name':'4'},{'id':'frame_5','url':_0x239c7d(0x5c2),'name':'5'},{'id':_0x239c7d(0x169d),'url':_0x239c7d(0x333),'name':'6'},{'id':_0x239c7d(0x2e0),'url':_0x239c7d(0x663),'name':'7'},{'id':_0x239c7d(0x167a),'url':_0x239c7d(0xa50),'name':'8'},{'id':_0x239c7d(0x80d),'url':_0x239c7d(0xee5),'name':'9'},{'id':'frame_10','url':_0x239c7d(0x1258),'name':'10'},{'id':_0x239c7d(0x467),'url':_0x239c7d(0xc53),'name':'11'},{'id':_0x239c7d(0xf54),'url':_0x239c7d(0x15f1),'name':'12'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0x21a),'name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x2ad),'name':'14'},{'id':_0x239c7d(0x1168),'url':_0x239c7d(0x133f),'name':'1'},{'id':_0x239c7d(0xcbf),'url':_0x239c7d(0x207),'name':'2'},{'id':_0x239c7d(0xece),'url':_0x239c7d(0x9ed),'name':'3'},{'id':_0x239c7d(0x12fb),'url':_0x239c7d(0x8a9),'name':'4'},{'id':'frame_5','url':_0x239c7d(0x971),'name':'5'},{'id':_0x239c7d(0x169d),'url':_0x239c7d(0xd67),'name':'6'},{'id':_0x239c7d(0x2e0),'url':_0x239c7d(0x85d),'name':'7'},{'id':'frame_8','url':'https://i.postimg.cc/g2PfbSFm/IMG-6556.gif','name':'8'},{'id':_0x239c7d(0x80d),'url':'https://i.postimg.cc/pLY3WfR8/IMG-6557.gif','name':'9'},{'id':_0x239c7d(0x679),'url':_0x239c7d(0x1469),'name':'10'},{'id':_0x239c7d(0x467),'url':'https://i.postimg.cc/Y94XWYKd/IMG-6560.gif','name':'11'},{'id':_0x239c7d(0xf54),'url':_0x239c7d(0x11ef),'name':'12'},{'id':'frame_13','url':_0x239c7d(0xf85),'name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x8d2),'name':'14'},{'id':'frame_cat_ear','url':_0x239c7d(0xf81),'name':'1'},{'id':_0x239c7d(0xcbf),'url':_0x239c7d(0xfce),'name':'2'},{'id':_0x239c7d(0xece),'url':_0x239c7d(0x165e),'name':'3'},{'id':_0x239c7d(0x12fb),'url':_0x239c7d(0x1475),'name':'4'},{'id':_0x239c7d(0x13bc),'url':_0x239c7d(0xa08),'name':'5'},{'id':_0x239c7d(0x169d),'url':_0x239c7d(0x48c),'name':'6'},{'id':_0x239c7d(0x2e0),'url':'https://i.postimg.cc/YqxxjbLp/IMG-6572.gif','name':'7'},{'id':'frame_8','url':_0x239c7d(0xd5c),'name':'8'},{'id':_0x239c7d(0x80d),'url':_0x239c7d(0xd76),'name':'9'},{'id':_0x239c7d(0x679),'url':'https://i.postimg.cc/MZ77rdDy/IMG-6850.gif','name':'10'},{'id':_0x239c7d(0x467),'url':_0x239c7d(0x14ad),'name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/28TsrxRV/IMG-6852.gif','name':'12'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0xfb8),'name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x2eb),'name':'14'},{'id':_0x239c7d(0x1168),'url':_0x239c7d(0xd51),'name':'1'},{'id':_0x239c7d(0xcbf),'url':_0x239c7d(0xa83),'name':'2'},{'id':_0x239c7d(0xece),'url':'https://i.postimg.cc/fyPDvxJk/IMG-6860.gif','name':'3'},{'id':_0x239c7d(0x12fb),'url':_0x239c7d(0x8b2),'name':'4'},{'id':'frame_5','url':_0x239c7d(0x223),'name':'5'},{'id':_0x239c7d(0x169d),'url':'https://i.postimg.cc/Y0vwjhb7/IMG-6857.gif','name':'6'},{'id':_0x239c7d(0x2e0),'url':_0x239c7d(0x10c5),'name':'7'},{'id':_0x239c7d(0x167a),'url':_0x239c7d(0x393),'name':'8'},{'id':_0x239c7d(0x80d),'url':_0x239c7d(0x5df),'name':'9'},{'id':_0x239c7d(0x679),'url':'https://i.postimg.cc/nryNzTXK/IMG-6915.gif','name':'10'},{'id':_0x239c7d(0x467),'url':'https://i.postimg.cc/Qx5dqyJ3/IMG-6917.gif','name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/Wbr0JSDD/IMG-5316.gif','name':'12'},{'id':'frame_13','url':_0x239c7d(0xdbe),'name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x710),'name':'14'},{'id':_0x239c7d(0x467),'url':_0x239c7d(0x9ff),'name':'11'},{'id':_0x239c7d(0xf54),'url':_0x239c7d(0x361),'name':'12'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0x7b3),'name':'13'},{'id':'frame_14','url':_0x239c7d(0x133e),'name':'14'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0x13b6),'name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0xa90),'name':'14'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0xb76),'name':'13'},{'id':'frame_14','url':_0x239c7d(0x1208),'name':'14'},{'id':'frame_14','url':_0x239c7d(0xcef),'name':'14'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0x897),'name':'13'},{'id':'frame_14','url':_0x239c7d(0x35c),'name':'14'},{'id':_0x239c7d(0x11f9),'url':'https://i.postimg.cc/xCqqKGRN/IMG-6929.gif','name':'14'},{'id':'frame_12','url':'https://i.postimg.cc/7LSRp4hx/e7fa949b9pc84cff0dabe57defceb54c.gif','name':'12'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0x762),'name':'13'},{'id':'frame_14','url':_0x239c7d(0x1277),'name':'14'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0x10ba),'name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0xaa0),'name':'14'},{'id':_0x239c7d(0x1e5),'url':'https://i.postimg.cc/k5P1NHcL/55f3e31d8qbc8a02d152b07b99d31567.gif','name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x164b),'name':'14'},{'id':_0x239c7d(0x11f9),'url':'https://i.postimg.cc/8k7YSLjK/1689aa46aqc4b9ffc0f970e668f56537.gif','name':'14'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0xc33),'name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x9d5),'name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0xa34),'name':'14'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0x1257),'name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x1644),'name':'14'},{'id':_0x239c7d(0x11f9),'url':'https://i.postimg.cc/Ssgbv41n/IMG-6876.gif','name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/SNByPrf9/IMG-7005.gif','name':'14'},{'id':_0x239c7d(0x1e5),'url':'https://i.postimg.cc/Z5nrCyS5/IMG-7006.gif','name':'13'},{'id':_0x239c7d(0x11f9),'url':'https://i.postimg.cc/mDfMXXFP/IMG-7007.gif','name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0xb0b),'name':'14'},{'id':'frame_13','url':_0x239c7d(0xa99),'name':'13'},{'id':'frame_14','url':_0x239c7d(0x947),'name':'14'},{'id':'frame_14','url':_0x239c7d(0x12b2),'name':'14'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0x4b0),'name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0xe2b),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/rwDr8X1d/IMG-7015.gif','name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0xcfa),'name':'14'},{'id':_0x239c7d(0x1e5),'url':'https://i.postimg.cc/QMVdG9x6/IMG-7016.gif','name':'13'},{'id':'frame_14','url':_0x239c7d(0x1451),'name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0xbe0),'name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/hP9JpdfT/IMG-7023.gif','name':'13'},{'id':'frame_14','url':_0x239c7d(0x79b),'name':'14'},{'id':'frame_14','url':_0x239c7d(0xab1),'name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0xeea),'name':'14'},{'id':_0x239c7d(0x1e5),'url':'https://i.postimg.cc/4yCXW52F/mmexport1751030908335.gif','name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x2d6),'name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x11fa),'name':'14'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0x267),'name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x457),'name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x1215),'name':'14'},{'id':_0x239c7d(0x11f9),'url':'https://i.postimg.cc/JnwFp3Kx/mmexport1751031208329.gif','name':'14'},{'id':_0x239c7d(0x1e5),'url':'https://i.postimg.cc/HLZNWkQw/mmexport1751031767634.gif','name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0xe31),'name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x11d6),'name':'14'},{'id':_0x239c7d(0x1e5),'url':'https://i.postimg.cc/3RpmWc8c/mmexport1751033102811.gif','name':'13'},{'id':'frame_14','url':_0x239c7d(0xdee),'name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0xc52),'name':'14'},{'id':'frame_14','url':_0x239c7d(0xf0a),'name':'14'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0x9db),'name':'13'},{'id':_0x239c7d(0x11f9),'url':'https://i.postimg.cc/7YRbzN51/mmexport1751036276038.gif','name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x956),'name':'14'},{'id':_0x239c7d(0x1e5),'url':'https://i.postimg.cc/HxLV5v92/mmexport1751036977582.gif','name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x3d4),'name':'14'},{'id':'frame_14','url':_0x239c7d(0xf0c),'name':'14'},{'id':'frame_14','url':_0x239c7d(0x5f3),'name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/ZnzbGdxX/IMG-7239.gif','name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0xd40),'name':'14'},{'id':'frame_14','url':_0x239c7d(0x3d7),'name':'14'},{'id':_0x239c7d(0x1e5),'url':'https://i.postimg.cc/8PsK20jQ/IMG-7236.gif','name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0xba0),'name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x4ec),'name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x1607),'name':'14'},{'id':'frame_13','url':_0x239c7d(0xace),'name':'13'},{'id':_0x239c7d(0x11f9),'url':'https://i.postimg.cc/yx2m4nbs/IMG-7231.gif','name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0xcfd),'name':'14'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0xd10),'name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x4d9),'name':'14'},{'id':_0x239c7d(0x11f9),'url':'https://i.postimg.cc/VkKjzYTK/IMB-f4kk-CT.gif','name':'14'},{'id':'frame_14','url':_0x239c7d(0x10f2),'name':'14'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0xb68),'name':'13'},{'id':'frame_14','url':_0x239c7d(0xbfd),'name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0xd9f),'name':'14'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0x138f),'name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x6f7),'name':'14'},{'id':_0x239c7d(0x11f9),'url':'https://i.postimg.cc/fyyGgW61/IMG-7115.gif','name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0xa29),'name':'14'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0x13e3),'name':'13'},{'id':_0x239c7d(0x11f9),'url':'https://i.postimg.cc/tTWKKmTN/IMG-7073.gif','name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0xea3),'name':'14'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0x1359),'name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0xa11),'name':'14'},{'id':_0x239c7d(0x11f9),'url':'https://i.postimg.cc/YSkqDg8V/IMG-7092.gif','name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x382),'name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/tTpZ6wLs/IMG-7095.gif','name':'13'},{'id':_0x239c7d(0x11f9),'url':'https://i.postimg.cc/8P5vt8sW/IMG-7097.gif','name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x10eb),'name':'14'},{'id':'frame_13','url':_0x239c7d(0x147e),'name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x1418),'name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x1007),'name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x660),'name':'14'},{'id':_0x239c7d(0x1e5),'url':_0x239c7d(0x1225),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/HLKvs0Kv/IMG-7109.gif','name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x42d),'name':'14'},{'id':_0x239c7d(0x1e5),'url':'https://i.postimg.cc/bJDMQVkj/IMG-7112.gif','name':'13'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x236),'name':'14'},{'id':_0x239c7d(0x11f9),'url':_0x239c7d(0x96a),'name':'14'}];let _0x4c8b14={'chats':{},'activeChatId':null,'globalSettings':{},'apiConfig':{},'userStickers':[],'worldBooks':[],'personaPresets':[],'qzoneSettings':{},'activeAlbumId':null,'cache':{'songs':new Map(),'lyrics':new Map()},'ttsCache':new Map(),'quickReplies':[]},_0x496f0a={'isActive':![],'gameMode':null,'chatId':null,'players':[],'currentDay':0x1,'currentPhase':_0x239c7d(0x1543),'nightActions':{},'gameLog':[],'discussionLog':[],'voteResults':{},'electionInfo':{'candidates':[],'votes':{}},'sheriffId':null,'lastFailedAction':null},_0x42d9d9=0x0;const _0xa5c27e=0xf;let _0x295d50=0x0;const _0x18b9e9=0xa;let _0x265b3f=[],_0x59adb2={'isActive':![],'activeChatId':null,'isPlaying':![],'playlist':[],'currentIndex':-0x1,'playMode':_0x239c7d(0xb2d),'totalElapsedTime':0x0,'timerId':null,'parsedLyrics':[],'currentLyricIndex':-0x1},_0x2eb114={'isOpen':![],'activePostId':null,'panelEl':null,'gridEl':null};const _0x86eb29=document[_0x239c7d(0x400)]('audio-player');let _0x52cc8f=null,_0x51034e=![],_0x41cb4b=0x0,_0xf60dfe=null,_0x3460b6=![],_0xc6535b=_0x239c7d(0x875),_0x141aad=new Set(),_0x36da93=null,_0x1c09b0=![],_0x5e8787=null,_0x2cf548=null,_0x83fa86=![],_0x35d11e=![],_0x2ae06b=![],_0x54c52c=![],_0x57f2ed=[],_0x2a5908=null,_0x2e2491=null,_0x3dc27d={},_0x18371b=_0x239c7d(0x1377),_0x465ba7=null,_0x7e1e9=null,_0xb37258=null,_0x29a70d=null,_0x3662fd=null,_0x1c8105=null,_0x5bb0b3=null,_0x5ad299=[],_0x4ecd3b=null,_0x1985c2=null,_0x490480=new Set(),_0x48d0a9=null,_0x3ab7ea=null,_0x4c0bbb=null,_0x531cde={'isOpen':![],'photos':[],'currentIndex':-0x1},_0x582d69=0x0,_0x16539f=![],_0x6556a7=new Set(),_0x53caff=null;const _0x91d058='https://i.postimg.cc/PxZrFFFL/o-o-1.jpg',_0x1f9bfa='https://i.postimg.cc/cLPP10Vm/4.jpg',_0x1e2f0a=_0x239c7d(0x5ec),_0x4713e3=_0x239c7d(0xbf4);let _0x482310,_0x214dfa={};const _0xfb99b3='https://www.myinstants.com/media/sounds/notification-sound-2.mp3';let _0x30ad43={},_0x4670b4={},_0x5bca15=null;const _0x22ed01={'qq':_0x239c7d(0xed4),'world-book':_0x239c7d(0x3c6),'wallpaper':_0x239c7d(0x50d),'renderer':_0x239c7d(0x119e),'api-settings':_0x239c7d(0xb32),'font':_0x239c7d(0x146d),'char-phone':_0x239c7d(0x3fe),'douban':_0x239c7d(0x1579),'preset':_0x239c7d(0x531),'tutorial':_0x239c7d(0x3ef),'werewolf':'https://i.postimg.cc/k401K5g7/IMG-7304.jpg','x':_0x239c7d(0xc80)},_0x2a11af={'qq':_0x239c7d(0xed4),'album':'https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','browser':'https://i.postimg.cc/KzC2gTq6/IMG-7276.jpg','taobao':_0x239c7d(0x15d5),'memo':'https://i.postimg.cc/J0b6Nym4/IMG-7279.jpg','diary':_0x239c7d(0x1483),'amap':_0x239c7d(0x13de),'usage':_0x239c7d(0xe1f),'music':'https://is1-ssl.mzstatic.com/image/thumb/Purple112/v4/64/9d/21/649d21e8-a151-6136-3914-256e54f15d9a/AppIcon-0-0-1x_U007emarketing-0-0-0-7-0-0-sRGB-0-0-0-GLES2_U002c0-512MB-85-220-0-0.png/1200x630wa.png','ephone':'https://i.postimg.cc/pXj9h20L/IMG-7275.jpg'};let _0x3cc275=null;const _0x12f2a0=/(^https:\/\/i\.postimg\.cc\/.+|^https:\/\/files\.catbox\.moe\/.+|^https?:\/\/sharkpan\.xyz\/.+|^data:image|\.(png|jpg|jpeg|gif|webp)\?.*$|\.(png|jpg|jpeg|gif|webp)$)/i;let _0x4e5ab7=0x0,_0x2c220f=0x1,_0x2d8619={'hasShown40':![],'hasShown20':![],'hasShown10':![]},_0x348b07;const _0x416d5b=document['createElement']('style');_0x416d5b['id']='dynamic-font-style',document['head']['appendChild'](_0x416d5b);const _0x3c5870=document[_0x239c7d(0x400)]('custom-modal-overlay'),_0x5d29e1=document['getElementById'](_0x239c7d(0x548)),_0x333e1a=document['getElementById'](_0x239c7d(0x1017)),_0x3056e7=document['getElementById'](_0x239c7d(0x15be)),_0xad7e64=document[_0x239c7d(0x400)](_0x239c7d(0x599));let _0x878d59;function _0x3ade6e(){const _0x29cf6e=_0x239c7d;_0x3c5870[_0x29cf6e(0xb08)][_0x29cf6e(0x12b6)](_0x29cf6e(0x9eb));}function _0x37c595(){const _0x2e307c=_0x239c7d;_0x3c5870[_0x2e307c(0xb08)][_0x2e307c(0xc46)]('visible'),_0x3056e7[_0x2e307c(0xb08)]['remove'](_0x2e307c(0x142c));if(_0x878d59)_0x878d59(null);}function _0x1478ca(_0x301bba){const _0x5f27a5=_0x239c7d,_0x720123=document[_0x5f27a5(0x400)](_0x5f27a5(0xee9)),_0x455250=_0x301bba[_0x5f27a5(0xa37)][_0x5f27a5(0x9b1)]||{'vertical':_0x5f27a5(0x899),'horizontal':_0x5f27a5(0x1287),'offset':0xa};_0x720123[_0x5f27a5(0xa00)]['top']='auto',_0x720123[_0x5f27a5(0xa00)][_0x5f27a5(0xa69)]=_0x5f27a5(0x5b5),_0x720123[_0x5f27a5(0xa00)][_0x5f27a5(0xfef)]=_0x5f27a5(0x5b5),_0x720123[_0x5f27a5(0xa00)]['right']='auto',_0x720123['style'][_0x5f27a5(0x8ea)]=_0x5f27a5(0x165b);_0x455250[_0x5f27a5(0x1683)]===_0x5f27a5(0x899)?_0x720123['style'][_0x5f27a5(0x899)]=_0x455250['offset']+'px':_0x720123['style'][_0x5f27a5(0xa69)]=_0x455250[_0x5f27a5(0x696)]+'px';switch(_0x455250[_0x5f27a5(0xde9)]){case'left':_0x720123['style'][_0x5f27a5(0xfef)]=_0x5f27a5(0x137f);break;case _0x5f27a5(0x6c7):_0x720123[_0x5f27a5(0xa00)][_0x5f27a5(0x6c7)]=_0x5f27a5(0x137f);break;case _0x5f27a5(0x1287):default:_0x720123[_0x5f27a5(0xa00)]['left']=_0x5f27a5(0x700),_0x720123[_0x5f27a5(0xa00)][_0x5f27a5(0x8ea)]='translateX(-50%)';break;}}async function _0x52dbaf(_0x36eb5a){const _0x3a09cb=_0x239c7d,_0x539eee=_0x36eb5a[_0x3a09cb(0x657)]['files'][0x0];if(!_0x539eee)return;const _0x1fa83a=await new Promise(_0x1e4c9e=>{const _0x44e1b9=_0x3a09cb,_0x5295a7=new FileReader();_0x5295a7['onload']=()=>_0x1e4c9e(_0x5295a7[_0x44e1b9(0xdd1)]),_0x5295a7[_0x44e1b9(0x157f)](_0x539eee);});await _0x138765(_0x3a09cb(0x13e9),'正在请求AI为新群头像命名...');try{const _0x64ea3a=await _0x53a718(_0x1fa83a);if(!_0x64ea3a)throw new Error(_0x3a09cb(0x1511));const _0x3e6144=_0x4c8b14[_0x3a09cb(0xbea)][_0x4c8b14[_0x3a09cb(0x1539)]];!_0x3e6144['settings'][_0x3a09cb(0x1634)]&&(_0x3e6144[_0x3a09cb(0xa37)][_0x3a09cb(0x1634)]=[]),_0x3e6144['settings']['groupAvatarLibrary'][_0x3a09cb(0x6bb)]({'name':_0x64ea3a,'url':_0x1fa83a}),await _0x54c587[_0x3a09cb(0xbea)][_0x3a09cb(0x4cb)](_0x3e6144),_0xd2fe27(),await _0x138765(_0x3a09cb(0x1218),_0x3a09cb(0x113d)+_0x64ea3a+'”');}catch(_0x1266cc){console['error']('本地群头像上传及识别失败:',_0x1266cc),await _0x138765(_0x3a09cb(0x12cb),_0x3a09cb(0xf39)+_0x1266cc[_0x3a09cb(0x6e2)]);}finally{_0x36eb5a[_0x3a09cb(0x657)]['value']=null;}}async function _0xf629ad(_0x50276b){const _0x24677e=_0x239c7d,_0x16d2dc=_0x50276b[_0x24677e(0x657)]['files'][0x0];if(!_0x16d2dc)return;const _0x456ccc=await new Promise(_0x23b1f2=>{const _0x1e7f44=_0x24677e,_0x19f5ed=new FileReader();_0x19f5ed[_0x1e7f44(0x9e0)]=()=>_0x23b1f2(_0x19f5ed[_0x1e7f44(0xdd1)]),_0x19f5ed[_0x1e7f44(0x157f)](_0x16d2dc);});await _0x138765(_0x24677e(0x13e9),'正在请求AI为新头像命名...');try{const _0x436a69=await _0x53a718(_0x456ccc);if(!_0x436a69)throw new Error(_0x24677e(0x1511));const _0x16d6d8=_0x4c8b14[_0x24677e(0xbea)][_0x4c8b14['activeChatId']];!_0x16d6d8[_0x24677e(0xa37)][_0x24677e(0x1080)]&&(_0x16d6d8[_0x24677e(0xa37)]['aiAvatarLibrary']=[]),_0x16d6d8[_0x24677e(0xa37)][_0x24677e(0x1080)][_0x24677e(0x6bb)]({'name':_0x436a69,'url':_0x456ccc}),await _0x54c587[_0x24677e(0xbea)][_0x24677e(0x4cb)](_0x16d6d8),_0x1cc0e9(),await _0x138765(_0x24677e(0x1218),_0x24677e(0x87d)+_0x436a69+'”');}catch(_0x1bd6cb){console['error']('本地头像上传及识别失败:',_0x1bd6cb),await _0x138765(_0x24677e(0x12cb),'无法为头像命名，请检查（主/副）API配置是否正确并支持Vision。\x0a错误:\x20'+_0x1bd6cb['message']);}finally{_0x50276b[_0x24677e(0x657)][_0x24677e(0xa1e)]=null;}}async function _0x53a718(_0x51a907){const _0x2a7504=_0x239c7d,_0x503e00=_0x4c8b14['apiConfig']['secondaryProxyUrl']&&_0x4c8b14[_0x2a7504(0x814)][_0x2a7504(0x888)]&&_0x4c8b14[_0x2a7504(0x814)][_0x2a7504(0xa22)],{proxyUrl:_0x3d9f90,apiKey:_0x13472b,model:_0x147532}=_0x503e00?{'proxyUrl':_0x4c8b14[_0x2a7504(0x814)][_0x2a7504(0x12ee)],'apiKey':_0x4c8b14[_0x2a7504(0x814)][_0x2a7504(0x888)],'model':_0x4c8b14[_0x2a7504(0x814)]['secondaryModel']}:_0x4c8b14[_0x2a7504(0x814)];if(!_0x3d9f90||!_0x13472b||!_0x147532)throw new Error(_0x2a7504(0x8f1));const _0x52ae48=_0x2a7504(0x85b);let _0xc082b6=_0x3d9f90['includes'](_0x2a7504(0x14cc)),_0x3e7d9a;if(_0xc082b6){const _0xa1c7da=_0x51a907[_0x2a7504(0xbf7)](/^data:(.*);base64/)[0x1],_0xcd851d=_0x51a907[_0x2a7504(0x5ad)](',')[0x1],_0x41f171={'contents':[{'parts':[{'text':_0x52ae48},{'inline_data':{'mime_type':_0xa1c7da,'data':_0xcd851d}}]}]};_0x3e7d9a=await fetch(_0x3d9f90+'/'+_0x147532+_0x2a7504(0x154c)+_0x13472b,{'method':_0x2a7504(0x953),'headers':{'Content-Type':'application/json'},'body':JSON['stringify'](_0x41f171)});}else{const _0x41fa1a={'model':_0x147532,'messages':[{'role':'user','content':[{'type':'text','text':_0x52ae48},{'type':_0x2a7504(0x164d),'image_url':{'url':_0x51a907}}]}],'max_tokens':0x32};_0x3e7d9a=await fetch(_0x3d9f90+_0x2a7504(0x1611),{'method':_0x2a7504(0x953),'headers':{'Content-Type':_0x2a7504(0xfae),'Authorization':'Bearer\x20'+_0x13472b},'body':JSON[_0x2a7504(0xea5)](_0x41fa1a)});}if(!_0x3e7d9a['ok']){const _0x163bed=await _0x3e7d9a[_0x2a7504(0x15d3)]();throw new Error(_0x2a7504(0x7d5)+_0x163bed['error']['message']);}const _0x399b68=await _0x3e7d9a[_0x2a7504(0x15d3)]();let _0x3c9401=_0xc082b6?getGeminiResponseText(_0x399b68):_0x399b68[_0x2a7504(0xf7c)][0x0][_0x2a7504(0x6e2)][_0x2a7504(0x1109)];return _0x3c9401[_0x2a7504(0xb8f)]()['replace'](/["'“”‘’]/g,'');}async function _0xed04e8(_0x36c216){const _0x1841f9=_0x239c7d;if(!_0x36c216||_0x36c216[_0x1841f9(0xc98)]){console[_0x1841f9(0x75e)]('syncCharacterNameInGroups:\x20传入的不是有效的单聊对象，已跳过同步。');return;}const _0xd90ef8=_0x36c216['id'],_0x31e254=_0x36c216[_0x1841f9(0xf3e)],_0x274d49=_0x36c216['originalName'];console[_0x1841f9(0x1e6)](_0x1841f9(0x127e)+_0xd90ef8+_0x1841f9(0xa07));for(const _0x405f4b in _0x4c8b14[_0x1841f9(0xbea)]){const _0x4417f1=_0x4c8b14[_0x1841f9(0xbea)][_0x405f4b];if(_0x4417f1['isGroup']&&_0x4417f1[_0x1841f9(0x4f8)]){const _0x2ac712=_0x4417f1['members'][_0x1841f9(0x821)](_0x2356fe=>_0x2356fe['id']===_0xd90ef8);if(_0x2ac712){let _0xaca3e4=![];_0x2ac712[_0x1841f9(0x7ca)]!==_0x31e254&&(_0x2ac712[_0x1841f9(0x7ca)]=_0x31e254,_0xaca3e4=!![]),_0x2ac712[_0x1841f9(0xdcf)]!==_0x274d49&&(_0x2ac712[_0x1841f9(0xdcf)]=_0x274d49,_0xaca3e4=!![]),_0xaca3e4&&(await _0x54c587[_0x1841f9(0xbea)][_0x1841f9(0x4cb)](_0x4417f1),console['log'](_0x1841f9(0x113a)+_0x4417f1['name']+_0x1841f9(0x472)));}}}}async function _0x5f3a56(_0xc928f0){const _0x15f566=_0x239c7d;if(!_0xc928f0||_0xc928f0['isGroup']){console[_0x15f566(0x75e)](_0x15f566(0x48d));return;}const _0x506f61=_0xc928f0['id'],_0xb19cea=_0xc928f0[_0x15f566(0xa37)]['aiAvatar'];console[_0x15f566(0x1e6)](_0x15f566(0x127e)+_0x506f61+_0x15f566(0x14d0));for(const _0x1fc417 of Object[_0x15f566(0x40a)](_0x4c8b14[_0x15f566(0xbea)])){if(_0x1fc417[_0x15f566(0xc98)]&&_0x1fc417[_0x15f566(0x4f8)]){const _0x5f292c=_0x1fc417[_0x15f566(0x4f8)]['find'](_0x2f0519=>_0x2f0519['id']===_0x506f61);_0x5f292c&&_0x5f292c[_0x15f566(0xa9a)]!==_0xb19cea&&(_0x5f292c[_0x15f566(0xa9a)]=_0xb19cea,await _0x54c587[_0x15f566(0xbea)][_0x15f566(0x4cb)](_0x1fc417),console['log'](_0x15f566(0x13d0)+_0x506f61+_0x15f566(0x70f)+_0x1fc417['name']+'\x22'));}}}function _0x288d80(_0x27a227,_0x49342e){const _0x58043c=_0x239c7d;if(!_0x27a227||!_0x27a227[_0x58043c(0xc98)]||!_0x49342e)return _0x49342e;const _0x2c2b27=_0x4c8b14['qzoneSettings']['nickname']||_0x58043c(0xa8f);if(_0x49342e===_0x2c2b27)return _0x27a227[_0x58043c(0xa37)][_0x58043c(0x14a8)]||'我';const _0x4f7706=_0x27a227[_0x58043c(0x4f8)][_0x58043c(0x821)](_0x54870c=>_0x54870c[_0x58043c(0xdcf)]===_0x49342e);return _0x4f7706?_0x4f7706[_0x58043c(0x7ca)]:_0x49342e;}function _0x7b9737(_0x12bb7e){const _0x1bf424=_0x239c7d;document[_0x1bf424(0x527)]('.rules-tab')['forEach'](_0x230b08=>{const _0x3a7570=_0x1bf424;_0x230b08['classList'][_0x3a7570(0x146f)](_0x3a7570(0x5d6),_0x230b08[_0x3a7570(0xd61)][_0x3a7570(0x12c4)]===_0x12bb7e);}),document['querySelectorAll']('.rules-category-pane')[_0x1bf424(0xbdc)](_0x242be9=>{const _0x415734=_0x1bf424;_0x242be9[_0x415734(0xb08)][_0x415734(0x146f)](_0x415734(0x5d6),_0x242be9['dataset'][_0x415734(0x12c4)]===_0x12bb7e);});}function _0x44e128(_0x560f39){const _0xd027f3=_0x239c7d;if(!_0x560f39)return'';if(_0x4c8b14['qzoneSettings']&&_0x560f39===_0x4c8b14['qzoneSettings'][_0xd027f3(0xbf3)])return _0x4c8b14[_0xd027f3(0x834)][_0xd027f3(0xbf3)];let _0x53588c=Object[_0xd027f3(0x40a)](_0x4c8b14[_0xd027f3(0xbea)])[_0xd027f3(0x821)](_0x49f4ae=>!_0x49f4ae[_0xd027f3(0xc98)]&&_0x49f4ae['originalName']===_0x560f39);if(_0x53588c)return _0x53588c[_0xd027f3(0xf3e)];_0x53588c=Object[_0xd027f3(0x40a)](_0x4c8b14[_0xd027f3(0xbea)])[_0xd027f3(0x821)](_0x3fce26=>!_0x3fce26[_0xd027f3(0xc98)]&&(_0x3fce26[_0xd027f3(0x112b)]&&_0x3fce26[_0xd027f3(0x112b)][_0xd027f3(0xd1b)](_0x560f39)));if(_0x53588c)return _0x53588c['name'];return _0x560f39;}function _0x2bafeb(_0x26619b,_0xdb830c=null){const _0x48153a=_0x239c7d;if(!_0x26619b||typeof _0x26619b!==_0x48153a(0x158f)||!_0x26619b[_0x48153a(0xd1b)](_0x48153a(0x15a2)))return _0x26619b;return _0x26619b[_0x48153a(0xe19)](/@\[\[([^\]]+)\]\]/g,(_0x1e68ea,_0xd8f987)=>{const _0x16df32=_0x48153a,_0x3a00a2=_0xd8f987[_0x16df32(0xb8f)]();let _0x2d62cc;return _0xdb830c&&_0xdb830c[_0x16df32(0xc98)]?_0x2d62cc=_0x288d80(_0xdb830c,_0x3a00a2):_0x2d62cc=_0x44e128(_0x3a00a2),'@'+_0x2d62cc;});}function _0x56d4d3(_0x4df18f,_0x23c880,_0xc0ef5d={}){return new Promise(_0x53da37=>{const _0x157b3e=_0x466f;_0x878d59=_0x53da37,_0x5d29e1[_0x157b3e(0xde7)]=_0x4df18f,_0x333e1a[_0x157b3e(0x1575)]=_0x157b3e(0xbb7)+_0x23c880+_0x157b3e(0x1236);const _0x2e3661=document['getElementById']('custom-modal-confirm'),_0x173cde=document[_0x157b3e(0x400)]('custom-modal-cancel');_0x173cde[_0x157b3e(0xa00)][_0x157b3e(0xb1a)]=_0x157b3e(0x1181),_0x2e3661['textContent']=_0xc0ef5d['confirmText']||'确定',_0x173cde[_0x157b3e(0xde7)]=_0xc0ef5d[_0x157b3e(0xd50)]||'取消',_0xc0ef5d['confirmButtonClass']?_0x2e3661[_0x157b3e(0xb08)][_0x157b3e(0x12b6)](_0xc0ef5d['confirmButtonClass']):_0x2e3661[_0x157b3e(0xb08)][_0x157b3e(0xc46)](_0x157b3e(0x142c)),_0x2e3661[_0x157b3e(0x41b)]=()=>{_0x53da37(!![]),_0x37c595();},_0x173cde[_0x157b3e(0x41b)]=()=>{_0x53da37(![]),_0x37c595();},_0x3ade6e();});}function _0x7574f4(_0x55d003=_0x239c7d(0x742),_0x489af4='success'){const _0x4250a7=_0x239c7d,_0xfabf2b=document[_0x4250a7(0x2c9)](_0x4250a7(0xf8e));_0xfabf2b[_0x4250a7(0xde7)]=_0x55d003,_0xfabf2b[_0x4250a7(0xa00)][_0x4250a7(0x32e)]=_0x4250a7(0x16af)+(_0x489af4===_0x4250a7(0x50a)?_0x4250a7(0x4dc):_0x4250a7(0x1dd))+';\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2012px\x2024px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x2010000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20pointer-events:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(20px);\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20',document[_0x4250a7(0x471)][_0x4250a7(0x8f2)](_0xfabf2b),setTimeout(()=>{const _0x14b882=_0x4250a7;_0xfabf2b[_0x14b882(0xa00)][_0x14b882(0xbfa)]='1',_0xfabf2b[_0x14b882(0xa00)]['transform']=_0x14b882(0xa2b);},0xa),setTimeout(()=>{const _0x3ccf18=_0x4250a7;_0xfabf2b[_0x3ccf18(0xa00)]['opacity']='0',_0xfabf2b[_0x3ccf18(0xa00)][_0x3ccf18(0x8ea)]='translateY(-20px)',setTimeout(()=>{const _0x562004=_0x3ccf18;_0xfabf2b[_0x562004(0xc46)]();},0x12c);},0x7d0);}function _0x22e51c(_0x42a021){const _0x47b931=_0x239c7d;let _0x45f0e0=(_0x42a021||'NAI_Image')[_0x47b931(0xe19)](/[^a-zA-Z0-9\u4e00-\u9fa5\s]/g,'_')[_0x47b931(0xe19)](/\s+/g,'_')[_0x47b931(0x371)](0x0,0x1e);const _0x5e7a40=new Date()[_0x47b931(0x886)]()['replace'](/[-:]/g,'')['replace']('T','_')[_0x47b931(0x5ad)]('.')[0x0];return _0x45f0e0+'_'+_0x5e7a40+_0x47b931(0x57b);}function _0x44c806(_0x4934d2,_0x15f36c){const _0x5c43ed=_0x239c7d;try{const _0x35be0c=_0x22e51c(_0x15f36c),_0x419edd=document[_0x5c43ed(0x2c9)]('a');_0x419edd[_0x5c43ed(0xcf5)]=_0x4934d2,_0x419edd['download']=_0x35be0c,_0x419edd[_0x5c43ed(0xa00)][_0x5c43ed(0xb1a)]='none',document[_0x5c43ed(0x471)]['appendChild'](_0x419edd),_0x419edd[_0x5c43ed(0x15ad)](),setTimeout(()=>{const _0x10af4a=_0x5c43ed;document[_0x10af4a(0x471)][_0x10af4a(0x2e3)](_0x419edd);},0x64),_0x7574f4(_0x5c43ed(0x742));}catch(_0x41c1cb){console[_0x5c43ed(0x5d7)](_0x5c43ed(0x157e),_0x41c1cb),_0x7574f4(_0x5c43ed(0xce9),_0x5c43ed(0x5d7));}}function _0x138765(_0x4bdd75,_0x4f1797){return new Promise(_0x2e0ac0=>{const _0x25929c=_0x466f;_0x878d59=_0x2e0ac0,_0x5d29e1[_0x25929c(0xde7)]=_0x4bdd75,_0x333e1a[_0x25929c(0x1575)]=_0x25929c(0x1f2)+_0x4f1797+'</p>';const _0x1150f5=document[_0x25929c(0x400)](_0x25929c(0x15be)),_0x33a8f7=document[_0x25929c(0x400)](_0x25929c(0x599));_0x33a8f7[_0x25929c(0xa00)]['display']='none',_0x1150f5['textContent']='好的',_0x1150f5[_0x25929c(0x41b)]=()=>{const _0x2c64ac=_0x25929c;_0x33a8f7['style'][_0x2c64ac(0xb1a)]=_0x2c64ac(0x1181),_0x1150f5[_0x2c64ac(0xde7)]='确定',_0x2e0ac0(!![]),_0x37c595();},_0x3ade6e();});}async function _0x495e8e(_0x5628a3,_0x222069=_0x239c7d(0x1336)){const _0x17a617=_0x239c7d;if(!_0x5628a3){await _0x138765(_0x17a617(0x10c4),'没有可复制的内容。');return;}try{await navigator[_0x17a617(0x8c5)][_0x17a617(0xa70)](_0x5628a3),await _0x138765('复制成功',_0x222069);}catch(_0x18320c){console[_0x17a617(0x5d7)](_0x17a617(0x1678),_0x18320c),await _0x138765(_0x17a617(0x10c4),'无法访问剪贴板。');}}function _0x25f61f(_0x5e2f29,_0x4ae980,_0x30671f='',_0x10ca22=_0x239c7d(0x117f),_0x577f98=''){return new Promise(_0x3a5f78=>{const _0x102720=_0x466f;_0x878d59=_0x3a5f78,_0x5d29e1['textContent']=_0x5e2f29;const _0x2fb984='custom-prompt-input',_0x436f92=_0x10ca22===_0x102720(0x79e)?_0x102720(0xdec)+_0x2fb984+_0x102720(0xded)+_0x4ae980+_0x102720(0x570)+_0x30671f+_0x102720(0x3a3):_0x102720(0x575)+_0x10ca22+_0x102720(0x65e)+_0x2fb984+'\x22\x20placeholder=\x22'+_0x4ae980+'\x22\x20value=\x22'+_0x30671f+'\x22>';_0x333e1a[_0x102720(0x1575)]=_0x577f98+_0x436f92;const _0xe9a1d0=document[_0x102720(0x400)](_0x2fb984);_0x333e1a['querySelectorAll']('.format-btn')[_0x102720(0xbdc)](_0x7f81be=>{const _0x3eeaf7=_0x102720;_0x7f81be['addEventListener'](_0x3eeaf7(0x15ad),()=>{const _0x3142a9=_0x3eeaf7,_0x269a0e=_0x7f81be[_0x3142a9(0xd61)][_0x3142a9(0x74d)];if(_0x269a0e)try{const _0x1a7ce4=JSON[_0x3142a9(0x13f7)](_0x269a0e);_0xe9a1d0[_0x3142a9(0xa1e)]=JSON[_0x3142a9(0xea5)](_0x1a7ce4,null,0x2),_0xe9a1d0[_0x3142a9(0x797)]();}catch(_0x4370be){console[_0x3142a9(0x5d7)](_0x3142a9(0x1000),_0x4370be);}});});const _0x33e09b=document[_0x102720(0x400)]('custom-modal-confirm'),_0x310627=document[_0x102720(0x400)](_0x102720(0x599));_0x33e09b[_0x102720(0x41b)]=()=>{const _0x441034=_0x102720;_0x3a5f78(_0xe9a1d0[_0x441034(0xa1e)]),_0x37c595();},_0x310627[_0x102720(0x41b)]=()=>{_0x3a5f78(null),_0x37c595();},_0x3ade6e(),setTimeout(()=>_0xe9a1d0[_0x102720(0x797)](),0x64);});}function _0x14b058(_0x5323b4,_0x54f06f){return new Promise(_0x2d1f36=>{const _0x2fa594=_0x466f,_0xae014f=document[_0x2fa594(0x400)]('custom-modal-overlay'),_0x53c176=document['getElementById'](_0x2fa594(0x548)),_0x3ecb5c=document['getElementById'](_0x2fa594(0x1017)),_0x590d1d=document[_0x2fa594(0x13ef)](_0x2fa594(0xbdd));_0x53c176[_0x2fa594(0xde7)]=_0x5323b4,_0x3ecb5c['innerHTML']='',_0x590d1d['innerHTML']='',_0x590d1d['style'][_0x2fa594(0x1261)]=_0x2fa594(0x514),_0x54f06f[_0x2fa594(0xbdc)](_0x1e74d2=>{const _0x20937f=_0x2fa594,_0x235300=document['createElement'](_0x20937f(0x99b));_0x235300['textContent']=_0x1e74d2[_0x20937f(0x117f)],_0x235300[_0x20937f(0x41b)]=()=>{const _0x3829a6=_0x20937f;_0xae014f['classList'][_0x3829a6(0xc46)]('visible'),_0x2d1f36(_0x1e74d2[_0x3829a6(0xa1e)]);},_0x590d1d[_0x20937f(0x8f2)](_0x235300);});const _0x28ed35=document['createElement'](_0x2fa594(0x99b));_0x28ed35[_0x2fa594(0xde7)]='取消',_0x28ed35[_0x2fa594(0xa00)][_0x2fa594(0x38c)]=_0x2fa594(0x13b8),_0x28ed35[_0x2fa594(0xa00)]['borderRadius']=_0x2fa594(0x13b8),_0x28ed35[_0x2fa594(0xa00)]['backgroundColor']=_0x2fa594(0x815),_0x28ed35[_0x2fa594(0x41b)]=()=>{const _0x5344d1=_0x2fa594;_0xae014f[_0x5344d1(0xb08)][_0x5344d1(0xc46)]('visible'),_0x2d1f36(null);},_0x590d1d['appendChild'](_0x28ed35),_0xae014f[_0x2fa594(0xb08)][_0x2fa594(0x12b6)](_0x2fa594(0x9eb));})['finally'](()=>{const _0x2b6cb0=_0x466f,_0x345c77=document[_0x2b6cb0(0x13ef)]('#custom-modal\x20.custom-modal-footer');_0x345c77[_0x2b6cb0(0xa00)]['flexDirection']=_0x2b6cb0(0x125d),_0x345c77[_0x2b6cb0(0x1575)]=_0x2b6cb0(0xbd4),document[_0x2b6cb0(0x400)](_0x2b6cb0(0x599))[_0x2b6cb0(0x501)](_0x2b6cb0(0x15ad),_0x37c595);});}async function _0x1b8e0b(){const _0x32d56f=_0x239c7d,_0x1c6c94=await _0x14b058(_0x32d56f(0x478),[{'text':_0x32d56f(0x701),'value':_0x32d56f(0xb41)},{'text':_0x32d56f(0xabc),'value':_0x32d56f(0x10b3)}]);if(_0x1c6c94===_0x32d56f(0xb41))return new Promise(_0xdd97bb=>{const _0x26c579=_0x32d56f,_0x56dc1c=document[_0x26c579(0x400)](_0x26c579(0x341)),_0x1f2a28=_0x459f4e=>{const _0x3cc243=_0x26c579,_0x19cbf4=_0x459f4e[_0x3cc243(0x657)][_0x3cc243(0x780)][0x0];if(_0x19cbf4){const _0x5e9a7e=new FileReader();_0x5e9a7e[_0x3cc243(0x9e0)]=_0x329116=>_0xdd97bb(_0x329116['target'][_0x3cc243(0xdd1)]),_0x5e9a7e[_0x3cc243(0x96d)]=()=>_0xdd97bb(''),_0x5e9a7e[_0x3cc243(0x2aa)](_0x19cbf4);}else _0xdd97bb(null);_0x56dc1c[_0x3cc243(0xf17)]('change',_0x1f2a28),_0x56dc1c[_0x3cc243(0xa1e)]='';};_0x56dc1c[_0x26c579(0x501)](_0x26c579(0x866),_0x1f2a28,{'once':!![]}),_0x56dc1c[_0x26c579(0x15ad)]();});else{if(_0x1c6c94==='paste'){const _0x26e889=await _0x25f61f(_0x32d56f(0x1018),'请在此处粘贴完整的LRC格式歌词...','',_0x32d56f(0x79e));if(_0x26e889){const _0x1bd0aa=_0x26e889[_0x32d56f(0xe19)](/\[/g,'\x0a[')[_0x32d56f(0xb8f)]();return _0x1bd0aa;}return _0x26e889;}else return null;}}_0x54c587['version'](0x29)['stores']({'doubanPosts':_0x239c7d(0x20a),'chats':_0x239c7d(0x1494),'apiConfig':_0x239c7d(0x76b),'globalSettings':_0x239c7d(0xdf6),'userStickers':_0x239c7d(0xe3c),'worldBooks':'&id,\x20name,\x20categoryId','worldBookCategories':'++id,\x20name','musicLibrary':_0x239c7d(0xdf6),'personaPresets':_0x239c7d(0xdf6),'qzoneSettings':_0x239c7d(0xdf6),'qzonePosts':'++id,\x20timestamp,\x20authorId','qzoneAlbums':'++id,\x20name,\x20createdAt','qzonePhotos':'++id,\x20albumId','favorites':'++id,\x20type,\x20timestamp,\x20originalTimestamp','qzoneGroups':_0x239c7d(0x7bb),'memories':_0x239c7d(0x2b8),'callRecords':_0x239c7d(0x640),'shoppingProducts':_0x239c7d(0x9b4),'shoppingCategories':_0x239c7d(0x7bb),'apiPresets':_0x239c7d(0x7bb),'renderingRules':_0x239c7d(0xf41),'appearancePresets':_0x239c7d(0x36f),'stickerCategories':'++id,\x20name','customAvatarFrames':_0x239c7d(0x7bb),'presets':_0x239c7d(0xb10),'presetCategories':_0x239c7d(0x7bb),'readingLibrary':'++id,\x20title,\x20lastOpened','quickReplies':'++id,\x20text','npcs':'++id,\x20name,\x20npcGroupId,\x20enableBackgroundActivity,\x20actionCooldownMinutes,\x20lastActionTimestamp','npcGroups':_0x239c7d(0x7bb)})[_0x239c7d(0x898)](_0x4387e9=>{const _0x5cd8b7=_0x239c7d;return _0x4387e9[_0x5cd8b7(0x770)](_0x5cd8b7(0xf57))[_0x5cd8b7(0x118a)]()['modify'](_0x1b07eb=>{const _0x557874=_0x5cd8b7;if(typeof _0x1b07eb['content']==='string'&&_0x1b07eb['content'][_0x557874(0xb8f)]()!=='')_0x1b07eb[_0x557874(0x1109)]=[{'keys':[],'comment':_0x557874(0x10db),'content':_0x1b07eb[_0x557874(0x1109)]}];else!Array[_0x557874(0x16a1)](_0x1b07eb[_0x557874(0x1109)])&&(_0x1b07eb[_0x557874(0x1109)]=[]);_0x1b07eb['content']['forEach'](_0x4e0a0b=>{const _0x261fc0=_0x557874;typeof _0x4e0a0b[_0x261fc0(0x250)]===_0x261fc0(0xd30)&&(_0x4e0a0b[_0x261fc0(0x250)]=!![]);});});}),window['db']=_0x54c587;function _0x257d51(_0x5364d3){const _0x3fea15=_0x239c7d;_0x5364d3===_0x3fea15(0x9a4)&&(window[_0x3fea15(0x15f2)](),_0x51a6d1(_0x3fea15(0xe06)));if(_0x5364d3==='api-settings-screen')window[_0x3fea15(0xc4c)]();if(_0x5364d3===_0x3fea15(0xef7))window[_0x3fea15(0x9d2)]();if(_0x5364d3===_0x3fea15(0x3cc))window[_0x3fea15(0x3d8)]();if(_0x5364d3===_0x3fea15(0xa76))window[_0x3fea15(0x1571)]();if(_0x5364d3===_0x3fea15(0x12d1))_0x20dc01();document[_0x3fea15(0x527)](_0x3fea15(0x3dc))[_0x3fea15(0xbdc)](_0x5eb53e=>_0x5eb53e[_0x3fea15(0xb08)][_0x3fea15(0xc46)](_0x3fea15(0x5d6)));const _0x5b87e7=document[_0x3fea15(0x400)](_0x5364d3);if(_0x5b87e7)_0x5b87e7[_0x3fea15(0xb08)][_0x3fea15(0x12b6)](_0x3fea15(0x5d6));if(_0x5364d3==='chat-interface-screen')window[_0x3fea15(0x12da)](_0x4c8b14[_0x3fea15(0x1539)]);_0x5364d3===_0x3fea15(0x97c)&&(_0x572336(),document[_0x3fea15(0x400)](_0x3fea15(0x55a))['value']=_0x4c8b14[_0x3fea15(0x14f1)]['fontUrl']||'',_0x572a63(_0x4c8b14[_0x3fea15(0x14f1)]['fontUrl']||'',!![]));}window[_0x239c7d(0x12da)]=()=>{};function _0x51a6d1(_0x21852b){const _0x392c50=_0x239c7d,_0xc4ede5=document[_0x392c50(0x400)](_0x392c50(0x9a4)),_0x436b41={'messages-view':document[_0x392c50(0x400)](_0x392c50(0xe06)),'qzone-screen':document[_0x392c50(0x400)](_0x392c50(0x951)),'favorites-view':document[_0x392c50(0x400)]('favorites-view'),'memories-view':document[_0x392c50(0x400)](_0x392c50(0xeab)),'npc-list-view':document[_0x392c50(0x400)](_0x392c50(0x865))},_0x241d93=document[_0x392c50(0x400)]('main-chat-list-header'),_0x44427a=document[_0x392c50(0x400)](_0x392c50(0x368));_0x16539f&&document['getElementById'](_0x392c50(0x15ac))['click']();Object['values'](_0x436b41)['forEach'](_0xcfa25b=>_0xcfa25b[_0x392c50(0xb08)][_0x392c50(0xc46)](_0x392c50(0x5d6)));_0x436b41[_0x21852b]&&_0x436b41[_0x21852b][_0x392c50(0xb08)]['add'](_0x392c50(0x5d6));document[_0x392c50(0x527)](_0x392c50(0xf72))[_0x392c50(0xbdc)](_0x1caea0=>{const _0x51c519=_0x392c50;_0x1caea0[_0x51c519(0xb08)][_0x51c519(0x146f)](_0x51c519(0x5d6),_0x1caea0[_0x51c519(0xd61)][_0x51c519(0x1008)]===_0x21852b);});_0x21852b===_0x392c50(0xe06)?(_0x241d93[_0x392c50(0xa00)][_0x392c50(0xb1a)]=_0x392c50(0x375),_0x44427a[_0x392c50(0xa00)]['display']=_0x392c50(0x375)):(_0x241d93[_0x392c50(0xa00)][_0x392c50(0xb1a)]=_0x392c50(0x165b),_0x44427a[_0x392c50(0xa00)][_0x392c50(0xb1a)]='none');_0x21852b!==_0x392c50(0xeab)&&(_0x2ae580[_0x392c50(0xbdc)](_0x62f7e6=>clearInterval(_0x62f7e6)),_0x2ae580=[]);switch(_0x21852b){case _0x392c50(0x951):_0x436b41[_0x392c50(0x951)][_0x392c50(0xa00)][_0x392c50(0x1296)]=_0x392c50(0x126f),_0x13e35a(0x0),_0x5b43b4(),_0x335d36();break;case'favorites-view':_0x436b41[_0x392c50(0x4ab)][_0x392c50(0xa00)][_0x392c50(0x1296)]='#f9f9f9',_0x4081e7();break;case _0x392c50(0xe06):break;case _0x392c50(0x865):_0x3b2ae7();break;}}function _0x4ab844(){const _0xa24499=_0x239c7d;console[_0xa24499(0x1e6)](_0xa24499(0x14bd));}window[_0x239c7d(0x1571)]=_0x4ab844;function _0x5b43b4(){const _0x3c167f=_0x239c7d;if(_0x4c8b14&&_0x4c8b14[_0x3c167f(0x834)]){const _0x4137fc=_0x4c8b14['qzoneSettings'];document[_0x3c167f(0x400)](_0x3c167f(0x71e))[_0x3c167f(0xde7)]=_0x4137fc['nickname'],document[_0x3c167f(0x400)](_0x3c167f(0x45d))[_0x3c167f(0x912)]=_0x4137fc[_0x3c167f(0xa9a)],document[_0x3c167f(0x400)](_0x3c167f(0x1587))[_0x3c167f(0x912)]=_0x4137fc[_0x3c167f(0x124c)];}}window['renderQzoneScreenProxy']=_0x5b43b4;async function _0x1098f6(){const _0x20885a=_0x239c7d;_0x54c587&&_0x4c8b14['qzoneSettings']&&await _0x54c587['qzoneSettings'][_0x20885a(0x4cb)](_0x4c8b14[_0x20885a(0x834)]);}function _0x805c0a(_0x5f54c2){const _0x282fbd=_0x239c7d;if(!_0x5f54c2)return'';const _0x39084b=new Date(),_0x2f1353=new Date(_0x5f54c2),_0x37fd28=Math[_0x282fbd(0x1381)]((_0x39084b-_0x2f1353)/0x3e8),_0x24bfc1=Math[_0x282fbd(0x1381)](_0x37fd28/0x3c),_0x51bea7=Math['floor'](_0x24bfc1/0x3c);if(_0x24bfc1<0x1)return'刚刚';if(_0x24bfc1<0x3c)return _0x24bfc1+_0x282fbd(0xa3e);if(_0x51bea7<0x18)return _0x51bea7+'小时前';const _0x27ad82=_0x2f1353['getFullYear'](),_0x219fda=String(_0x2f1353[_0x282fbd(0xebe)]()+0x1)[_0x282fbd(0xb7d)](0x2,'0'),_0x4d47c9=String(_0x2f1353['getDate']())[_0x282fbd(0xb7d)](0x2,'0'),_0x57b583=String(_0x2f1353[_0x282fbd(0x331)]())[_0x282fbd(0xb7d)](0x2,'0'),_0x4dcf71=String(_0x2f1353['getMinutes']())[_0x282fbd(0xb7d)](0x2,'0');return _0x39084b['getFullYear']()===_0x27ad82?_0x219fda+'-'+_0x4d47c9+'\x20'+_0x57b583+':'+_0x4dcf71:_0x27ad82+'-'+_0x219fda+'-'+_0x4d47c9+'\x20'+_0x57b583+':'+_0x4dcf71;}function _0x49deae(_0x3caeb8){const _0x293a51=_0x239c7d,_0x368ac4=document[_0x293a51(0x13ef)]('.qzone-post-container[data-post-id=\x22'+_0x3caeb8['id']+'\x22]'),_0x2d1631=!!_0x368ac4,_0x501052=_0x2d1631?_0x368ac4:document[_0x293a51(0x2c9)](_0x293a51(0xf8e));!_0x2d1631&&(_0x501052['className']='qzone-post-container',_0x501052[_0x293a51(0xd61)][_0x293a51(0x2b7)]=_0x3caeb8['id']);const _0x5710ed=_0x2d1631?_0x501052['querySelector'](_0x293a51(0xe23)):document[_0x293a51(0x2c9)](_0x293a51(0xf8e));!_0x2d1631&&(_0x5710ed[_0x293a51(0x4e1)]='qzone-post-item');let _0x3b9d25='',_0x1625bb='',_0x3c76a8=_0x4c8b14['qzoneSettings'][_0x293a51(0xa9a)];if(_0x3caeb8[_0x293a51(0x606)]===_0x293a51(0x6d6))_0x3b9d25=_0x4c8b14[_0x293a51(0x834)]['avatar'],_0x1625bb=_0x4c8b14[_0x293a51(0x834)][_0x293a51(0xbf3)];else{if(_0x4c8b14[_0x293a51(0xbea)][_0x3caeb8[_0x293a51(0x606)]]){const _0x197c23=_0x4c8b14[_0x293a51(0xbea)][_0x3caeb8[_0x293a51(0x606)]];_0x3b9d25=_0x197c23[_0x293a51(0xa37)][_0x293a51(0xb24)]||_0x91d058,_0x1625bb=_0x197c23['name'];}else _0x1625bb=_0x44e128(_0x3caeb8[_0x293a51(0x993)]),_0x3b9d25=_0x91d058;}function _0x2eaabe(_0x46d6d1){const _0x483322=_0x293a51;let _0x5a0b63='';const _0x4bae7c=_0x46d6d1['publicText']?_0x483322(0x1026)+_0x412ec9(_0x46d6d1[_0x483322(0xdb3)])[_0x483322(0xe19)](/\n/g,'<br>')+'</div>':'';if(_0x46d6d1['type']===_0x483322(0x73a))_0x5a0b63=_0x483322(0x1166)+_0x412ec9(_0x46d6d1[_0x483322(0x1109)])[_0x483322(0xe19)](/\n/g,_0x483322(0x9e1))+_0x483322(0x11ac);else{if(_0x46d6d1['type']===_0x483322(0x4d3)&&_0x46d6d1[_0x483322(0x1436)])_0x5a0b63=_0x4bae7c?_0x4bae7c+_0x483322(0x4a3)+_0x46d6d1[_0x483322(0x1436)]+'\x22\x20class=\x22chat-image\x22></div>':_0x483322(0x97d)+_0x46d6d1['imageUrl']+_0x483322(0x1286);else{if(_0x46d6d1[_0x483322(0xbbf)]===_0x483322(0x14b0)){const _0x2fcc99=_0x4c8b14['globalSettings'][_0x483322(0x7b5)]&&_0x46d6d1[_0x483322(0xff9)]?'https://image.pollinations.ai/prompt/'+_0x46d6d1['image_prompt']:_0x483322(0x261);_0x5a0b63=_0x4bae7c?_0x4bae7c+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0x2fcc99+_0x483322(0xecb)+_0x46d6d1[_0x483322(0x1012)]+_0x483322(0x822):_0x483322(0x97d)+_0x2fcc99+_0x483322(0xecb)+_0x46d6d1[_0x483322(0x1012)]+'\x22>';}else{if(_0x46d6d1[_0x483322(0xbbf)]===_0x483322(0xd3c)){const _0x46e8a7=_0x46d6d1[_0x483322(0xeaf)]||(_0x46d6d1[_0x483322(0x1436)]?[_0x46d6d1['imageUrl']]:[]);if(_0x46e8a7[_0x483322(0x8d6)]>0x0){const _0x3da21d=_0x46e8a7['length'];let _0x202d20='';_0x202d20=_0x483322(0x960)+_0x3da21d+'\x22>',_0x46e8a7[_0x483322(0xbdc)]((_0x109588,_0x2b3aa4)=>{const _0x2832b6=_0x483322;_0x202d20+=_0x2832b6(0x97d)+_0x109588+_0x2832b6(0x998)+(_0x2b3aa4+0x1)+_0x2832b6(0xe2f);}),_0x202d20+=_0x483322(0x11ac),_0x5a0b63=_0x4bae7c?''+_0x4bae7c+_0x202d20:_0x202d20;}}}}}return _0x5a0b63;}let _0x2189b7;if(_0x3caeb8['type']===_0x293a51(0x808)){const _0x24c302=_0x3caeb8[_0x293a51(0x15bc)]?'<div\x20class=\x22post-content\x22>'+_0x412ec9(_0x3caeb8[_0x293a51(0x15bc)])[_0x293a51(0xe19)](/\n/g,_0x293a51(0x9e1))+_0x293a51(0x11ac):'';let _0x249f84=_0x91d058,_0x3559be=_0x293a51(0x62e);if(_0x3caeb8[_0x293a51(0x53d)][_0x293a51(0x606)]===_0x293a51(0x6d6))_0x249f84=_0x4c8b14[_0x293a51(0x834)]['avatar'],_0x3559be=_0x4c8b14[_0x293a51(0x834)]['nickname'];else{const _0x376a6c=_0x4c8b14[_0x293a51(0xbea)][_0x3caeb8[_0x293a51(0x53d)]['authorId']];_0x376a6c&&(_0x249f84=_0x376a6c['settings'][_0x293a51(0xb24)]||_0x91d058),_0x3559be=_0x44e128(_0x3caeb8[_0x293a51(0x53d)][_0x293a51(0x993)]);}_0x2189b7=_0x293a51(0x73d)+_0x24c302+_0x293a51(0x145d)+_0x249f84+'\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@'+_0x3559be+_0x293a51(0x1473)+_0x805c0a(_0x3caeb8[_0x293a51(0x53d)][_0x293a51(0x287)])+_0x293a51(0x2cf)+_0x2eaabe(_0x3caeb8[_0x293a51(0x53d)])+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}else _0x2189b7=_0x293a51(0x405)+_0x2eaabe(_0x3caeb8)+_0x293a51(0x11ac);let _0x4df6b7='';if(_0x3caeb8[_0x293a51(0xe30)]&&_0x3caeb8[_0x293a51(0xe30)]['length']>0x0){const _0x4a1c69=_0x3caeb8[_0x293a51(0xe30)][_0x293a51(0xd18)](_0xa2b256=>_0x44e128(_0xa2b256))[_0x293a51(0xee1)]('、');_0x4df6b7=_0x293a51(0xe04)+_0x4a1c69+'\x20觉得很赞</span></div>';}let _0x6bc054='';_0x3caeb8[_0x293a51(0xf8f)]&&_0x3caeb8[_0x293a51(0xf8f)][_0x293a51(0x8d6)]>0x0&&(_0x6bc054=_0x293a51(0x749),_0x3caeb8['comments']['forEach']((_0x4c3298,_0x37ff2d)=>{const _0x23548f=_0x293a51;if(typeof _0x4c3298===_0x23548f(0xfc4)&&_0x4c3298!==null&&_0x4c3298[_0x23548f(0xbf8)]){const _0x32236a=_0x4c3298[_0x23548f(0xbf8)],_0x1b2ffa=_0x44e128(_0x32236a);let _0x933d2e;_0x12f2a0['test'](_0x4c3298['text'])?_0x933d2e=_0x23548f(0x97d)+_0x4c3298[_0x23548f(0x117f)]+_0x23548f(0xbc2):_0x933d2e=_0x412ec9(_0x4c3298[_0x23548f(0x117f)]);let _0xe71bab='';if(_0x4c3298['replyTo']){const _0x4bf1ab=_0x44e128(_0x4c3298[_0x23548f(0x10bf)]);_0xe71bab=_0x23548f(0x13fd)+_0x1b2ffa+_0x23548f(0x1490)+_0x4bf1ab+'</span>:\x20'+_0x933d2e;}else _0xe71bab=_0x23548f(0x13fd)+_0x1b2ffa+_0x23548f(0x778)+_0x933d2e;_0x6bc054+=_0x23548f(0x111f)+_0x3caeb8['id']+_0x23548f(0x15ee)+_0x32236a+'\x22\x20data-commenter-display-name=\x22'+_0x1b2ffa+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>'+_0xe71bab+_0x23548f(0x47f)+_0x37ff2d+_0x23548f(0xdd9);}else _0x6bc054+=_0x23548f(0x7d8)+_0x412ec9(String(_0x4c3298))+_0x23548f(0x135b);}),_0x6bc054+=_0x293a51(0x11ac));const _0x41ae80=_0x4c8b14[_0x293a51(0x834)][_0x293a51(0xbf3)],_0x556cfe=_0x3caeb8[_0x293a51(0xe30)]&&_0x3caeb8[_0x293a51(0xe30)][_0x293a51(0xd1b)](_0x41ae80),_0x57dc69=_0x4c8b14[_0x293a51(0xec7)]&&_0x4c8b14['favoritedPostIds'][_0x293a51(0x3e3)](_0x3caeb8['id']);let _0x26e094='';_0x3caeb8[_0x293a51(0xbbf)]!==_0x293a51(0x808)&&(_0x26e094='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>');_0x5710ed[_0x293a51(0x1575)]=_0x293a51(0x999)+_0x3b9d25+_0x293a51(0x77e)+_0x3caeb8[_0x293a51(0x606)]+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>'+_0x1625bb+_0x293a51(0x16ab)+_0x805c0a(_0x3caeb8['timestamp'])+_0x293a51(0x235)+_0x2189b7+_0x293a51(0x74b)+_0x26e094+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20like\x20'+(_0x556cfe?_0x293a51(0x5d6):'')+_0x293a51(0x884)+(_0x57dc69?_0x293a51(0x5d6):'')+_0x293a51(0xa1b)+_0x4df6b7+_0x293a51(0x73f)+_0x6bc054+_0x293a51(0x7d0)+_0x3c76a8+_0x293a51(0x1108);if(!_0x2d1631){const _0x5aeb3b=document[_0x293a51(0x2c9)](_0x293a51(0xf8e));_0x5aeb3b[_0x293a51(0x4e1)]='qzone-post-delete-action',_0x5aeb3b[_0x293a51(0x1575)]=_0x293a51(0xb25),_0x501052[_0x293a51(0x8f2)](_0x5710ed),_0x501052[_0x293a51(0x8f2)](_0x5aeb3b);}return _0x501052;}async function _0xbce8d5(_0x61f2f5){const _0x24bdb2=_0x239c7d,_0x282fc8=await _0x54c587['qzonePosts']['get'](_0x61f2f5);if(!_0x282fc8){const _0x57d9af=document['querySelector'](_0x24bdb2(0xc14)+_0x61f2f5+'\x22]');if(_0x57d9af)_0x57d9af[_0x24bdb2(0xc46)]();return;}const _0x15aab5=_0x265b3f[_0x24bdb2(0x11a4)](_0x1ece2b=>_0x1ece2b['id']===_0x61f2f5);if(_0x15aab5>-0x1)_0x265b3f[_0x15aab5]=_0x282fc8;const _0x383eed=await _0x54c587[_0x24bdb2(0x69c)][_0x24bdb2(0x227)](_0x24bdb2(0xbbf))[_0x24bdb2(0x4ce)]('qzone_post')[_0x24bdb2(0xce1)]();_0x4c8b14[_0x24bdb2(0xec7)]=new Set(_0x383eed[_0x24bdb2(0xd18)](_0x3d61cf=>_0x3d61cf['content']['id'])),_0x49deae(_0x282fc8);}function _0x4878ba(_0x35d187){const _0x39512d=_0x239c7d,_0x513a28=Date['now'](),_0x4f449d=Math[_0x39512d(0x1381)]((_0x513a28-_0x35d187)/0x3e8),_0x3d23f1=Math[_0x39512d(0x1381)](_0x4f449d/0x3c);if(_0x3d23f1<0x2)return'刚刚';if(_0x3d23f1<0x3c)return _0x3d23f1+_0x39512d(0xa3e);const _0x59048e=Math[_0x39512d(0x1381)](_0x3d23f1/0x3c);if(_0x59048e<0x18)return _0x59048e+_0x39512d(0x796);const _0x3f1a69=Math[_0x39512d(0x1381)](_0x59048e/0x18);return _0x3f1a69+'天前';}async function _0x49deae(_0x634849){const _0x2bdd74=_0x239c7d,_0x588d22=document['querySelector']('.qzone-post-container[data-post-id=\x22'+_0x634849['id']+'\x22]'),_0x18caf9=!!_0x588d22,_0x5f5c79=_0x18caf9?_0x588d22:document[_0x2bdd74(0x2c9)](_0x2bdd74(0xf8e));!_0x18caf9&&(_0x5f5c79[_0x2bdd74(0x4e1)]=_0x2bdd74(0x750),_0x5f5c79[_0x2bdd74(0xd61)][_0x2bdd74(0x2b7)]=_0x634849['id']);const _0x569f03=_0x18caf9?_0x5f5c79[_0x2bdd74(0x13ef)](_0x2bdd74(0xe23)):document[_0x2bdd74(0x2c9)](_0x2bdd74(0xf8e));!_0x18caf9&&(_0x569f03['className']='qzone-post-item');let _0x504f83='',_0x1f3737='',_0x2c4a03=_0x4c8b14[_0x2bdd74(0x834)]['avatar'];if(_0x634849[_0x2bdd74(0x606)]===_0x2bdd74(0x6d6))_0x504f83=_0x4c8b14[_0x2bdd74(0x834)][_0x2bdd74(0xa9a)],_0x1f3737=_0x4c8b14[_0x2bdd74(0x834)][_0x2bdd74(0xbf3)];else{if(_0x4c8b14[_0x2bdd74(0xbea)][_0x634849['authorId']]){const _0x261864=_0x4c8b14[_0x2bdd74(0xbea)][_0x634849[_0x2bdd74(0x606)]];_0x504f83=_0x261864['settings']['aiAvatar']||_0x91d058,_0x1f3737=_0x261864[_0x2bdd74(0xf3e)];}else{if(String(_0x634849[_0x2bdd74(0x606)])['startsWith'](_0x2bdd74(0x1530))){const _0x583c3c=parseInt(String(_0x634849[_0x2bdd74(0x606)])[_0x2bdd74(0xe19)](_0x2bdd74(0x1530),''));if(!isNaN(_0x583c3c)){const _0x47ce15=await _0x54c587[_0x2bdd74(0xf9b)][_0x2bdd74(0xf48)](_0x583c3c);_0x47ce15?(_0x504f83=_0x47ce15[_0x2bdd74(0xa9a)]||_0x1e2f0a,_0x1f3737=_0x47ce15[_0x2bdd74(0xf3e)]):(_0x1f3737=_0x634849['authorOriginalName']||'未知NPC',_0x504f83=_0x1e2f0a);}}else _0x1f3737=_0x44e128(_0x634849[_0x2bdd74(0x993)]),_0x504f83=_0x91d058;}}function _0x3bf3bc(_0x4971bc){const _0x5db36d=_0x2bdd74;let _0x438a98='';const _0x44eeab=_0x4971bc['publicText']?_0x5db36d(0x1026)+_0x412ec9(_0x4971bc[_0x5db36d(0xdb3)])['replace'](/\n/g,_0x5db36d(0x9e1))+'</div>':'';if(_0x4971bc['type']===_0x5db36d(0x73a))_0x438a98=_0x5db36d(0x1166)+_0x412ec9(_0x4971bc['content'])[_0x5db36d(0xe19)](/\n/g,_0x5db36d(0x9e1))+_0x5db36d(0x11ac);else{if(_0x4971bc['type']==='image_post'&&_0x4971bc[_0x5db36d(0x1436)])_0x438a98=_0x44eeab?_0x44eeab+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0x4971bc['imageUrl']+_0x5db36d(0x1501):'<img\x20src=\x22'+_0x4971bc['imageUrl']+_0x5db36d(0x1286);else{if(_0x4971bc['type']==='text_image'){const _0x419cd6=_0x4c8b14[_0x5db36d(0x14f1)][_0x5db36d(0x7b5)]&&_0x4971bc[_0x5db36d(0xff9)]?_0x5db36d(0x9c3)+_0x4971bc[_0x5db36d(0xff9)]:'https://i.postimg.cc/KYr2qRCK/1.jpg';_0x438a98=_0x44eeab?_0x44eeab+_0x5db36d(0x4a3)+_0x419cd6+'\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22'+_0x4971bc['hiddenContent']+_0x5db36d(0x822):_0x5db36d(0x97d)+_0x419cd6+_0x5db36d(0xecb)+_0x4971bc[_0x5db36d(0x1012)]+'\x22>';}else{if(_0x4971bc['type']===_0x5db36d(0xd3c)){const _0x2792cc=_0x4971bc['imageUrls']||(_0x4971bc['imageUrl']?[_0x4971bc[_0x5db36d(0x1436)]]:[]);if(_0x2792cc['length']>0x0){const _0x2c6655=_0x2792cc['length'];let _0x159900='';_0x159900=_0x5db36d(0x960)+_0x2c6655+'\x22>',_0x2792cc[_0x5db36d(0xbdc)]((_0x4f0bea,_0x27bf3b)=>{const _0x1d8c1d=_0x5db36d;_0x159900+=_0x1d8c1d(0x97d)+_0x4f0bea+_0x1d8c1d(0x998)+(_0x27bf3b+0x1)+_0x1d8c1d(0xe2f);}),_0x159900+='</div>',_0x438a98=_0x44eeab?''+_0x44eeab+_0x159900:_0x159900;}}}}}return _0x438a98;}let _0xab9802;if(_0x634849[_0x2bdd74(0xbbf)]===_0x2bdd74(0x808)){const _0x9c206e=_0x634849['repostComment']?_0x2bdd74(0x1026)+_0x634849[_0x2bdd74(0x15bc)][_0x2bdd74(0xe19)](/\n/g,'<br>')+_0x2bdd74(0x11ac):'';let _0x5040f7=_0x91d058,_0x5dbde7=_0x2bdd74(0x62e);if(_0x634849[_0x2bdd74(0x53d)]['authorId']===_0x2bdd74(0x6d6))_0x5040f7=_0x4c8b14[_0x2bdd74(0x834)][_0x2bdd74(0xa9a)],_0x5dbde7=_0x4c8b14[_0x2bdd74(0x834)]['nickname'];else{const _0x2208f4=_0x4c8b14['chats'][_0x634849['originalPost'][_0x2bdd74(0x606)]];_0x2208f4&&(_0x5040f7=_0x2208f4['settings']['aiAvatar']||_0x91d058),_0x5dbde7=_0x44e128(_0x634849['originalPost'][_0x2bdd74(0x993)]);}_0xab9802=_0x2bdd74(0x73d)+_0x9c206e+_0x2bdd74(0x145d)+_0x5040f7+_0x2bdd74(0x78a)+_0x5dbde7+_0x2bdd74(0x1473)+_0x805c0a(_0x634849[_0x2bdd74(0x53d)]['timestamp'])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-main-content\x22>'+_0x3bf3bc(_0x634849['originalPost'])+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}else _0xab9802=_0x2bdd74(0x405)+_0x3bf3bc(_0x634849)+_0x2bdd74(0x11ac);let _0x1a03c9='';if(_0x634849[_0x2bdd74(0xe30)]&&_0x634849['likes']['length']>0x0){const _0x3b7e4e=_0x634849[_0x2bdd74(0xe30)][_0x2bdd74(0xd18)](_0x31049c=>_0x44e128(_0x31049c))[_0x2bdd74(0xee1)]('、');_0x1a03c9='<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>'+_0x3b7e4e+_0x2bdd74(0x353);}let _0x3cc691='';_0x634849[_0x2bdd74(0xf8f)]&&_0x634849['comments']['length']>0x0&&(_0x3cc691=_0x2bdd74(0x749),_0x634849[_0x2bdd74(0xf8f)]['forEach']((_0x2f4883,_0x450020)=>{const _0x5c6b21=_0x2bdd74;if(typeof _0x2f4883===_0x5c6b21(0xfc4)&&_0x2f4883!==null&&_0x2f4883[_0x5c6b21(0xbf8)]){const _0x16264d=_0x2f4883['commenterName'],_0x517029=_0x44e128(_0x16264d);let _0x10c536;_0x12f2a0[_0x5c6b21(0x2c0)](_0x2f4883[_0x5c6b21(0x117f)])?_0x10c536=_0x5c6b21(0x97d)+_0x2f4883[_0x5c6b21(0x117f)]+_0x5c6b21(0xbc2):_0x10c536=_0x412ec9(_0x2f4883['text']);let _0x182ce4='';if(_0x2f4883[_0x5c6b21(0x10bf)]){const _0x2e17ef=_0x44e128(_0x2f4883[_0x5c6b21(0x10bf)]);_0x182ce4=_0x5c6b21(0x13fd)+_0x517029+_0x5c6b21(0x1490)+_0x2e17ef+_0x5c6b21(0x778)+_0x10c536;}else _0x182ce4=_0x5c6b21(0x13fd)+_0x517029+_0x5c6b21(0x778)+_0x10c536;_0x3cc691+='<div\x20class=\x22comment-item\x22\x20data-post-id=\x22'+_0x634849['id']+_0x5c6b21(0x15ee)+_0x16264d+_0x5c6b21(0xf29)+_0x517029+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>'+_0x182ce4+_0x5c6b21(0x47f)+_0x450020+_0x5c6b21(0xdd9);}else _0x3cc691+=_0x5c6b21(0x7d8)+String(_0x2f4883)+_0x5c6b21(0x135b);}),_0x3cc691+='</div>');const _0x4d587a=_0x4c8b14['qzoneSettings'][_0x2bdd74(0xbf3)],_0x42b966=_0x634849[_0x2bdd74(0xe30)]&&_0x634849[_0x2bdd74(0xe30)][_0x2bdd74(0xd1b)](_0x4d587a),_0xc56060=_0x4c8b14['favoritedPostIds']&&_0x4c8b14['favoritedPostIds'][_0x2bdd74(0x3e3)](_0x634849['id']);let _0x5c52d2='';_0x634849[_0x2bdd74(0xbbf)]!==_0x2bdd74(0x808)&&(_0x5c52d2=_0x2bdd74(0x1493));_0x569f03['innerHTML']=_0x2bdd74(0x999)+_0x504f83+_0x2bdd74(0x77e)+_0x634849[_0x2bdd74(0x606)]+_0x2bdd74(0xbe1)+_0x1f3737+_0x2bdd74(0x16ab)+_0x805c0a(_0x634849[_0x2bdd74(0x287)])+_0x2bdd74(0x235)+_0xab9802+_0x2bdd74(0x74b)+_0x5c52d2+_0x2bdd74(0xc74)+(_0x42b966?_0x2bdd74(0x5d6):'')+_0x2bdd74(0x884)+(_0xc56060?_0x2bdd74(0x5d6):'')+_0x2bdd74(0xa1b)+_0x1a03c9+_0x2bdd74(0x73f)+_0x3cc691+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x2c4a03+_0x2bdd74(0x1108);if(!_0x18caf9){const _0x4eb54d=document[_0x2bdd74(0x2c9)](_0x2bdd74(0xf8e));_0x4eb54d[_0x2bdd74(0x4e1)]=_0x2bdd74(0x1394),_0x4eb54d[_0x2bdd74(0x1575)]='<span>删除</span>',_0x5f5c79[_0x2bdd74(0x8f2)](_0x569f03),_0x5f5c79[_0x2bdd74(0x8f2)](_0x4eb54d);}return _0x5f5c79;}async function _0xbce8d5(_0xb28365){const _0x5dcabb=_0x239c7d,_0x1c301e=await _0x54c587[_0x5dcabb(0xba7)]['get'](_0xb28365);if(!_0x1c301e){const _0x50a579=document[_0x5dcabb(0x13ef)](_0x5dcabb(0xc14)+_0xb28365+'\x22]');_0x50a579&&_0x50a579[_0x5dcabb(0xc46)]();return;}const _0x196222=_0x265b3f[_0x5dcabb(0x11a4)](_0x1c5ee2=>_0x1c5ee2['id']===_0xb28365);_0x196222>-0x1&&(_0x265b3f[_0x196222]=_0x1c301e);const _0x422c70=await _0x54c587[_0x5dcabb(0x69c)]['where'](_0x5dcabb(0xbbf))[_0x5dcabb(0x4ce)](_0x5dcabb(0x1353))[_0x5dcabb(0xce1)]();_0x4c8b14['favoritedPostIds']=new Set(_0x422c70['map'](_0x18c05a=>_0x18c05a[_0x5dcabb(0x1109)]['id'])),await _0x49deae(_0x1c301e);}async function _0x335d36(){const _0x188960=_0x239c7d,_0x1b19ca=document[_0x188960(0x400)](_0x188960(0xe69));if(!_0x1b19ca)return;const [_0x27c18b,_0x4917d5]=await Promise[_0x188960(0x875)]([_0x54c587[_0x188960(0xba7)][_0x188960(0x541)](_0x188960(0x287))[_0x188960(0xfc1)]()['filter'](_0x11ad38=>!_0x11ad38[_0x188960(0xe73)])[_0x188960(0xce1)](),_0x54c587['favorites'][_0x188960(0x227)]('type')[_0x188960(0x4ce)]('qzone_post')[_0x188960(0xce1)]()]);_0x265b3f=_0x27c18b,_0x4c8b14[_0x188960(0xec7)]=new Set(_0x4917d5[_0x188960(0xd18)](_0x48496f=>_0x48496f[_0x188960(0x1109)]['id'])),_0x1b19ca[_0x188960(0x1575)]='',_0x295d50=0x0;if(_0x265b3f[_0x188960(0x8d6)]===0x0){_0x1b19ca[_0x188960(0x1575)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2030px\x200;\x22>这里空空如也，快来发布第一条说说吧！</p>';return;}_0x3a9e92();}async function _0x3a9e92(){const _0x42612f=_0x239c7d;if(_0x54c52c)return;_0x54c52c=!![];const _0x3efefa=document[_0x42612f(0x400)](_0x42612f(0xe69));if(!_0x3efefa){_0x54c52c=![];return;}_0x3a43dd(_0x3efefa,'bottom'),setTimeout(async()=>{const _0x243843=_0x42612f;_0x42da12(_0x3efefa);const _0x93a45d=_0x295d50,_0x5d7678=_0x295d50+_0x18b9e9,_0x7ac217=_0x265b3f[_0x243843(0x69f)](_0x93a45d,_0x5d7678),_0x100977=document['createDocumentFragment']();for(const _0x47e3e5 of _0x7ac217){const _0xc448d8=await _0x49deae(_0x47e3e5);_0x100977[_0x243843(0x8f2)](_0xc448d8);}_0x3efefa[_0x243843(0x8f2)](_0x100977),_0x295d50+=_0x7ac217['length'],_0x54c52c=![];},0x1f4);}function _0xa9f1f7(_0x43c1f1,_0x474ba2){const _0x2204db=_0x239c7d,_0x219c5e=_0x2eb114[_0x2204db(0x10ef)],_0x45240c=_0x2eb114[_0x2204db(0xfe1)];_0x45240c['innerHTML']='';_0x4c8b14[_0x2204db(0x120c)][_0x2204db(0x8d6)]===0x0?_0x45240c[_0x2204db(0x1575)]=_0x2204db(0x1551):_0x4c8b14['userStickers'][_0x2204db(0xbdc)](_0x46a450=>{const _0xf305a8=_0x2204db,_0x12fe8a=document['createElement']('div');_0x12fe8a[_0xf305a8(0x4e1)]=_0xf305a8(0x3d1),_0x12fe8a['style'][_0xf305a8(0xf11)]=_0xf305a8(0xe21)+_0x46a450[_0xf305a8(0x299)]+')',_0x12fe8a['title']=_0x46a450[_0xf305a8(0xf3e)],_0x45240c['appendChild'](_0x12fe8a);});const _0x5b407f=_0x474ba2['getBoundingClientRect'](),_0x5bab66=document[_0x2204db(0x400)](_0x2204db(0x43a))['getBoundingClientRect']();_0x219c5e[_0x2204db(0xa00)][_0x2204db(0xb1a)]=_0x2204db(0x375);const _0x54e97e=_0x219c5e[_0x2204db(0x1437)](),_0x308566=_0x54e97e[_0x2204db(0x14af)],_0x14d3bb=_0x54e97e[_0x2204db(0x1383)];_0x219c5e['style'][_0x2204db(0x899)]=_0x5b407f['top']-_0x308566-0x5-_0x5bab66['top']+'px';const _0x145e56=_0x5b407f[_0x2204db(0xfef)]-_0x5bab66[_0x2204db(0xfef)];_0x145e56+_0x14d3bb>_0x5bab66[_0x2204db(0x1383)]?(_0x219c5e[_0x2204db(0xa00)]['left']='auto',_0x219c5e[_0x2204db(0xa00)][_0x2204db(0x6c7)]=_0x2204db(0x10c1)):(_0x219c5e[_0x2204db(0xa00)][_0x2204db(0xfef)]=_0x145e56+'px',_0x219c5e[_0x2204db(0xa00)][_0x2204db(0x6c7)]=_0x2204db(0x5b5)),_0x2eb114[_0x2204db(0x12b0)]=!![],_0x2eb114[_0x2204db(0x1155)]=_0x43c1f1;}function _0x647d65(){const _0x420fdb=_0x239c7d;_0x2eb114[_0x420fdb(0x12b0)]&&(_0x2eb114[_0x420fdb(0x10ef)][_0x420fdb(0xa00)][_0x420fdb(0xb1a)]=_0x420fdb(0x165b),_0x2eb114['isOpen']=![],_0x2eb114[_0x420fdb(0x1155)]=null);}async function _0x2f9704(_0x5c7564,_0x382598){const _0x32fa7a=_0x239c7d;if(!_0x382598||!_0x382598[_0x32fa7a(0x299)])return;const _0x430e3c=await _0x54c587[_0x32fa7a(0xba7)][_0x32fa7a(0xf48)](_0x5c7564);if(!_0x430e3c){console['error'](_0x32fa7a(0x1562),_0x5c7564);return;}!_0x430e3c['comments']&&(_0x430e3c['comments']=[]);const _0x15577f={'commenterName':_0x4c8b14[_0x32fa7a(0x834)]['nickname'],'text':_0x382598[_0x32fa7a(0x299)],'meaning':_0x382598['name'],'timestamp':Date['now']()};_0x430e3c[_0x32fa7a(0xf8f)][_0x32fa7a(0x6bb)](_0x15577f),await _0x54c587[_0x32fa7a(0xba7)][_0x32fa7a(0x126d)](_0x5c7564,{'comments':_0x430e3c[_0x32fa7a(0xf8f)]}),_0x647d65(),await _0x335d36();const _0x4ff04c=(_0x430e3c[_0x32fa7a(0xdb3)]||_0x430e3c[_0x32fa7a(0x1109)]||_0x32fa7a(0x14d1))['substring'](0x0,0x1e);for(const _0x138799 in _0x4c8b14[_0x32fa7a(0xbea)]){const _0x21d076=_0x4c8b14[_0x32fa7a(0xbea)][_0x138799];if(!_0x21d076[_0x32fa7a(0xc98)]){const _0x259f02='[系统提示：\x27'+_0x4c8b14[_0x32fa7a(0x834)][_0x32fa7a(0xbf3)]+_0x32fa7a(0xddf)+_0x5c7564+',\x20内容摘要:\x20“'+_0x4ff04c+'”)下发送了一个表情评论，意思是：“'+_0x382598[_0x32fa7a(0xf3e)]+_0x32fa7a(0x10a9),_0x799dfa={'role':_0x32fa7a(0xaf6),'content':_0x259f02,'timestamp':Date[_0x32fa7a(0xecd)](),'isHidden':!![]};_0x21d076[_0x32fa7a(0x92c)]['push'](_0x799dfa),await _0x54c587['chats'][_0x32fa7a(0x4cb)](_0x21d076);}}}function _0x181d17(_0x3b1593){const _0xc77dbd=_0x239c7d;_0x3cc275=_0x3b1593,document['getElementById'](_0xc77dbd(0x1594))[_0xc77dbd(0xa1e)]='',document[_0xc77dbd(0x400)](_0xc77dbd(0x4c4))[_0xc77dbd(0xb08)]['add'](_0xc77dbd(0x9eb));}function _0x4097f3(){const _0x303cb4=_0x239c7d;document[_0x303cb4(0x400)]('repost-modal')[_0x303cb4(0xb08)]['remove'](_0x303cb4(0x9eb)),_0x3cc275=null;}async function _0x29951c(){const _0x20977c=_0x239c7d;if(!_0x3cc275)return;const _0x58fe40=document[_0x20977c(0x400)]('repost-comment-input')[_0x20977c(0xa1e)][_0x20977c(0xb8f)](),_0x454d67=await _0x54c587[_0x20977c(0xba7)]['get'](_0x3cc275);if(!_0x454d67){alert(_0x20977c(0x1542)),_0x4097f3();return;}const _0x9fd191={'type':_0x20977c(0x808),'timestamp':Date[_0x20977c(0xecd)](),'authorId':_0x20977c(0x6d6),'repostComment':_0x58fe40,'originalPost':_0x454d67,'visibleGroupIds':null};await _0x54c587[_0x20977c(0xba7)]['add'](_0x9fd191),_0x4097f3(),await _0x335d36(),alert(_0x20977c(0xb5b));}function _0x45d63c(_0x53bf68){const _0x2d50b2=_0x239c7d,_0x5eb626=document[_0x2d50b2(0x400)](_0x2d50b2(0xfbb));_0x5eb626[_0x2d50b2(0x1575)]='';if(_0x53bf68[_0x2d50b2(0x8d6)]===0x0){const _0x5240e0=document[_0x2d50b2(0x400)]('favorites-search-input')[_0x2d50b2(0xa1e)],_0x5b58f7=_0x5240e0?_0x2d50b2(0xcf6):_0x2d50b2(0xc66);_0x5eb626[_0x2d50b2(0x1575)]=_0x2d50b2(0xce0)+_0x5b58f7+_0x2d50b2(0x1236);return;}for(const _0x1ba73d of _0x53bf68){const _0x5e7391=document[_0x2d50b2(0x2c9)]('div');_0x5e7391[_0x2d50b2(0x4e1)]=_0x2d50b2(0xc03),_0x5e7391[_0x2d50b2(0xd61)]['favid']=_0x1ba73d['id'];let _0x5534b7='',_0x4ca52d='',_0x3fce3f='',_0x569c3d='';if(_0x1ba73d[_0x2d50b2(0xbbf)]==='qzone_post'){const _0x2f594b=_0x1ba73d[_0x2d50b2(0x1109)];_0x3fce3f=_0x2d50b2(0xc0e);let _0x230a14=_0x91d058,_0x208071=_0x2d50b2(0x136a);if(_0x2f594b[_0x2d50b2(0x606)]===_0x2d50b2(0x6d6))_0x230a14=_0x4c8b14['qzoneSettings'][_0x2d50b2(0xa9a)],_0x208071=_0x4c8b14[_0x2d50b2(0x834)][_0x2d50b2(0xbf3)];else _0x4c8b14[_0x2d50b2(0xbea)][_0x2f594b[_0x2d50b2(0x606)]]&&(_0x230a14=_0x4c8b14[_0x2d50b2(0xbea)][_0x2f594b[_0x2d50b2(0x606)]][_0x2d50b2(0xa37)][_0x2d50b2(0xb24)],_0x208071=_0x4c8b14[_0x2d50b2(0xbea)][_0x2f594b['authorId']]['name']);_0x5534b7=_0x2d50b2(0x97d)+_0x230a14+'\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>'+_0x208071+_0x2d50b2(0xccd);const _0x3a573f=_0x2f594b[_0x2d50b2(0xdb3)]?_0x2d50b2(0x1026)+_0x2f594b[_0x2d50b2(0xdb3)]['replace'](/\n/g,_0x2d50b2(0x9e1))+_0x2d50b2(0x11ac):'';if(_0x2f594b[_0x2d50b2(0xbbf)]===_0x2d50b2(0x73a))_0x4ca52d='<div\x20class=\x22post-content\x22>'+_0x2f594b['content']['replace'](/\n/g,'<br>')+_0x2d50b2(0x11ac);else{if(_0x2f594b[_0x2d50b2(0xbbf)]===_0x2d50b2(0x4d3)&&_0x2f594b[_0x2d50b2(0x1436)]){const _0x4cb49c=_0x4c8b14[_0x2d50b2(0x14f1)][_0x2d50b2(0x7b5)]&&_0x2f594b[_0x2d50b2(0xff9)]?_0x2d50b2(0x9c3)+_0x2f594b[_0x2d50b2(0xff9)]:_0x2d50b2(0x261);_0x4ca52d=_0x3a573f?_0x3a573f+_0x2d50b2(0x4a3)+_0x4cb49c+'\x22\x20class=\x22chat-image\x22></div>':'<img\x20src=\x22'+_0x4cb49c+_0x2d50b2(0x1286);}else{if(_0x2f594b['type']===_0x2d50b2(0x14b0)){const _0x13e331=_0x4c8b14[_0x2d50b2(0x14f1)][_0x2d50b2(0x7b5)]&&_0x2f594b[_0x2d50b2(0xff9)]?'https://image.pollinations.ai/prompt/'+_0x2f594b['image_prompt']:_0x2d50b2(0x261);_0x4ca52d=_0x3a573f?_0x3a573f+_0x2d50b2(0x4a3)+_0x13e331+_0x2d50b2(0xecb)+_0x2f594b[_0x2d50b2(0x1012)]+_0x2d50b2(0x822):_0x2d50b2(0x97d)+_0x13e331+_0x2d50b2(0xecb)+_0x2f594b['hiddenContent']+'\x22>';}}}let _0x7f8e9='';_0x2f594b[_0x2d50b2(0xe30)]&&_0x2f594b['likes']['length']>0x0&&(_0x7f8e9=_0x2d50b2(0x123d)+_0x2f594b[_0x2d50b2(0xe30)]['join']('、')+_0x2d50b2(0x1608));let _0x52a706='';_0x2f594b[_0x2d50b2(0xf8f)]&&_0x2f594b[_0x2d50b2(0xf8f)][_0x2d50b2(0x8d6)]>0x0&&(_0x52a706='<div\x20class=\x22post-comments-container\x22>',_0x2f594b[_0x2d50b2(0xf8f)][_0x2d50b2(0xbdc)]((_0x1d13e9,_0x26b17a)=>{const _0x330f28=_0x2d50b2;if(typeof _0x1d13e9===_0x330f28(0xfc4)&&_0x1d13e9!==null&&_0x1d13e9[_0x330f28(0xbf8)]){const _0x212629=_0x1d13e9[_0x330f28(0xbf8)],_0x1d872f=_0x44e128(_0x212629);let _0x351b81;_0x12f2a0[_0x330f28(0x2c0)](_0x1d13e9[_0x330f28(0x117f)])?_0x351b81=_0x330f28(0x97d)+_0x1d13e9[_0x330f28(0x117f)]+_0x330f28(0xbc2):_0x351b81=_0x1d13e9['text'];let _0x25940b='';if(_0x1d13e9[_0x330f28(0x10bf)]){const _0x2bcb23=_0x44e128(_0x1d13e9[_0x330f28(0x10bf)]);_0x25940b='<span\x20class=\x22commenter-name\x22>'+_0x1d872f+_0x330f28(0x1490)+_0x2bcb23+'</span>:\x20'+_0x351b81;}else _0x25940b=_0x330f28(0x13fd)+_0x1d872f+'</span>:\x20'+_0x351b81;_0x52a706+=_0x330f28(0x111f)+_0x2f594b['id']+_0x330f28(0x15ee)+_0x212629+_0x330f28(0xf29)+_0x1d872f+_0x330f28(0x7be)+_0x25940b+_0x330f28(0x14cf)+_0x26b17a+_0x330f28(0x230);}else _0x52a706+='<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>'+String(_0x1d13e9)+_0x330f28(0xa74);}),_0x52a706+=_0x2d50b2(0x11ac)),_0x569c3d=''+_0x7f8e9+_0x52a706;}else{if(_0x1ba73d[_0x2d50b2(0xbbf)]===_0x2d50b2(0x9da)){const _0x20736e=_0x1ba73d[_0x2d50b2(0x1109)],_0x4ff797=_0x4c8b14['chats'][_0x1ba73d[_0x2d50b2(0x4dd)]];if(!_0x4ff797)continue;_0x3fce3f=_0x2d50b2(0xd72)+_0x4ff797[_0x2d50b2(0xf3e)]+_0x2d50b2(0x8cb);const _0x427305=_0x20736e[_0x2d50b2(0x71a)]===_0x2d50b2(0x6d6);let _0x435c4a,_0x37a531;if(_0x427305)_0x435c4a=_0x4ff797[_0x2d50b2(0xc98)]?_0x4ff797[_0x2d50b2(0xa37)][_0x2d50b2(0x14a8)]||'我':'我',_0x37a531=_0x4ff797[_0x2d50b2(0xa37)][_0x2d50b2(0x12d3)]||(_0x4ff797[_0x2d50b2(0xc98)]?_0x1f9bfa:_0x91d058);else{if(_0x4ff797[_0x2d50b2(0xc98)]){const _0x12d1b7=_0x4ff797[_0x2d50b2(0x4f8)][_0x2d50b2(0x821)](_0x3d4a38=>_0x3d4a38[_0x2d50b2(0xdcf)]===_0x20736e[_0x2d50b2(0x3e7)]);_0x435c4a=_0x20736e[_0x2d50b2(0x3e7)],_0x37a531=_0x12d1b7?_0x12d1b7[_0x2d50b2(0xa9a)]:_0x1e2f0a;}else _0x435c4a=_0x4ff797[_0x2d50b2(0xf3e)],_0x37a531=_0x4ff797[_0x2d50b2(0xa37)][_0x2d50b2(0xb24)]||_0x91d058;}_0x5534b7=_0x2d50b2(0x97d)+_0x37a531+_0x2d50b2(0x13e2)+_0x435c4a+_0x2d50b2(0xccd);if(typeof _0x20736e[_0x2d50b2(0x1109)]==='string'&&_0x12f2a0['test'](_0x20736e[_0x2d50b2(0x1109)]))_0x4ca52d=_0x2d50b2(0x97d)+_0x20736e[_0x2d50b2(0x1109)]+'\x22\x20class=\x22sticker-image\x22\x20style=\x22max-width:\x2080px;\x20max-height:\x2080px;\x22>';else Array[_0x2d50b2(0x16a1)](_0x20736e[_0x2d50b2(0x1109)])&&_0x20736e[_0x2d50b2(0x1109)][0x0]?.[_0x2d50b2(0xbbf)]===_0x2d50b2(0x164d)?_0x4ca52d=_0x2d50b2(0x97d)+_0x20736e[_0x2d50b2(0x1109)][0x0][_0x2d50b2(0x164d)]['url']+_0x2d50b2(0x1286):_0x4ca52d=String(_0x20736e[_0x2d50b2(0x1109)]||'')[_0x2d50b2(0xe19)](/\n/g,_0x2d50b2(0x9e1));}else{if(_0x1ba73d[_0x2d50b2(0xbbf)]===_0x2d50b2(0x42e)){const _0x397d98=_0x1ba73d[_0x2d50b2(0x1109)];_0x3fce3f='来自\x20'+_0x397d98[_0x2d50b2(0xb4a)]+_0x2d50b2(0xd65);const _0x13a083=_0x4c8b14[_0x2d50b2(0xbea)][_0x397d98[_0x2d50b2(0x6d4)]],_0x1ba9d0=_0x13a083?_0x13a083[_0x2d50b2(0xa37)][_0x2d50b2(0xb24)]:_0x91d058;_0x5534b7=_0x2d50b2(0x97d)+_0x1ba9d0+_0x2d50b2(0x13e2)+_0x397d98[_0x2d50b2(0xb4a)]+_0x2d50b2(0xccd);const _0x11a18c=_0x397d98[_0x2d50b2(0x1109)]||'',_0x510d45=_0x412ec9(_0x11a18c)[_0x2d50b2(0xe19)](/\n/g,_0x2d50b2(0x9e1));_0x4ca52d='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>'+_0x397d98[_0x2d50b2(0x647)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content-full\x22>'+_0x510d45+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}else{if(_0x1ba73d['type']===_0x2d50b2(0xae2)){const _0x1338bb=_0x1ba73d[_0x2d50b2(0x1109)];_0x3fce3f='来自\x20'+_0x1338bb['characterName']+_0x2d50b2(0x1652);const _0xcb9300=_0x4c8b14[_0x2d50b2(0xbea)][_0x1338bb[_0x2d50b2(0x6d4)]],_0x226780=_0xcb9300?_0xcb9300[_0x2d50b2(0xa37)]['aiAvatar']:_0x91d058;_0x5534b7=_0x2d50b2(0x97d)+_0x226780+_0x2d50b2(0x13e2)+_0x1338bb[_0x2d50b2(0xb4a)]+'</div></div>',_0x4ca52d=_0x2d50b2(0xa06)+_0x1338bb[_0x2d50b2(0x647)]+_0x2d50b2(0x6f5)+(_0x1338bb[_0x2d50b2(0x1109)]||'')[_0x2d50b2(0xe19)](/\n/g,_0x2d50b2(0x9e1))+_0x2d50b2(0x14f0);}else{if(_0x1ba73d[_0x2d50b2(0xbbf)]===_0x2d50b2(0xbcb)){const _0x1c81a8=_0x1ba73d[_0x2d50b2(0x1109)];_0x3fce3f='来自\x20'+_0x1c81a8['characterName']+_0x2d50b2(0x11b2);const _0x551a22=_0x4c8b14[_0x2d50b2(0xbea)][_0x1c81a8[_0x2d50b2(0x6d4)]],_0x2430a5=_0x551a22?_0x551a22['settings'][_0x2d50b2(0xb24)]:_0x91d058;_0x5534b7=_0x2d50b2(0x97d)+_0x2430a5+'\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>'+_0x1c81a8[_0x2d50b2(0xb4a)]+_0x2d50b2(0xccd),_0x4ca52d=_0x2d50b2(0x107a)+_0x1c81a8[_0x2d50b2(0x647)]+_0x2d50b2(0xdc1)+_0x1c81a8[_0x2d50b2(0x1109)][_0x2d50b2(0xe19)](/\n/g,_0x2d50b2(0x9e1))+_0x2d50b2(0x1204);}}}}}_0x5e7391[_0x2d50b2(0x1575)]=_0x2d50b2(0x45a)+_0x5534b7+'<div\x20class=\x22source\x22>'+_0x3fce3f+_0x2d50b2(0x101e)+_0x4ca52d+_0x2d50b2(0x10e8)+_0x569c3d,_0x5eb626[_0x2d50b2(0x8f2)](_0x5e7391);}}async function _0x4081e7(){const _0x983686=_0x239c7d;allFavoriteItems=await _0x54c587['favorites'][_0x983686(0x541)](_0x983686(0x287))[_0x983686(0xfc1)]()[_0x983686(0xce1)]();const _0x57de2a=document[_0x983686(0x400)](_0x983686(0xa81)),_0x426303=document[_0x983686(0x400)](_0x983686(0x1502));_0x57de2a['value']='',_0x426303[_0x983686(0xa00)][_0x983686(0xb1a)]='none',_0x45d63c(allFavoriteItems);}function _0x59872d(){const _0x49584f=_0x239c7d;document[_0x49584f(0x400)](_0x49584f(0x163d))[_0x49584f(0xa1e)]='',document[_0x49584f(0x400)](_0x49584f(0x1149))[_0x49584f(0x912)]='',document[_0x49584f(0x400)](_0x49584f(0xf84))[_0x49584f(0xa1e)]='',document['getElementById'](_0x49584f(0xc02))[_0x49584f(0xb08)][_0x49584f(0xc46)]('visible'),document['getElementById'](_0x49584f(0x12f0))['style'][_0x49584f(0xb1a)]=_0x49584f(0x165b),document[_0x49584f(0x400)](_0x49584f(0x839))[_0x49584f(0xa1e)]='',document[_0x49584f(0x400)](_0x49584f(0xd6e))[_0x49584f(0xa1e)]='',document[_0x49584f(0x400)](_0x49584f(0x13fe))[_0x49584f(0x15ad)]();}async function _0x66efd1(){const _0x254dc5=_0x239c7d,_0x2e4213=await _0x56d4d3(_0x254dc5(0xa23),_0x254dc5(0x408),{'confirmButtonClass':'btn-danger','confirmText':_0x254dc5(0xe87)});if(!_0x2e4213)return;await _0x138765(_0x254dc5(0x13e9),_0x254dc5(0x329)),console[_0x254dc5(0x1e6)]('冗余数据清理流程已启动...');let _0x2d5c40={'posts':0x0,'likes':0x0,'comments':0x0,'memories':0x0,'callRecords':0x0,'renderingRules':0x0,'groupMembers':0x0,'chatLinks':0x0};try{await _0x54c587[_0x254dc5(0xfec)]('rw',_0x54c587[_0x254dc5(0xfcf)],async()=>{const _0x483d2f=_0x254dc5,_0x2be509=await _0x54c587[_0x483d2f(0xbea)][_0x483d2f(0xce1)](),_0x59df0a=await _0x54c587[_0x483d2f(0xf9b)][_0x483d2f(0xce1)](),_0x4aa330=new Set(_0x2be509[_0x483d2f(0xd18)](_0x14d5a9=>_0x14d5a9['id'])),_0x5b2c46=new Set(_0x59df0a['map'](_0x5183b7=>'npc_'+_0x5183b7['id'])),_0x3135cd=new Set(_0x2be509['filter'](_0x480293=>!_0x480293[_0x483d2f(0xc98)])[_0x483d2f(0xd18)](_0x48f338=>_0x48f338[_0x483d2f(0xdcf)]));_0x3135cd[_0x483d2f(0x12b6)](_0x4c8b14[_0x483d2f(0x834)][_0x483d2f(0xbf3)]||_0x483d2f(0xa8f)),_0x59df0a[_0x483d2f(0xbdc)](_0x1838bf=>_0x3135cd['add'](_0x1838bf['name']));for(const _0x3dba0b of _0x2be509){let _0x1e3293=![];if(_0x3dba0b['isGroup']&&_0x3dba0b['members']){const _0x6a0af9=_0x3dba0b[_0x483d2f(0x4f8)][_0x483d2f(0x8d6)];_0x3dba0b['members']=_0x3dba0b[_0x483d2f(0x4f8)][_0x483d2f(0x29d)](_0xbfe419=>_0x4aa330[_0x483d2f(0x3e3)](_0xbfe419['id'])||_0x5b2c46[_0x483d2f(0x3e3)](_0xbfe419['id'])),_0x3dba0b['members'][_0x483d2f(0x8d6)]<_0x6a0af9&&(_0x2d5c40['groupMembers']+=_0x6a0af9-_0x3dba0b['members'][_0x483d2f(0x8d6)],_0x1e3293=!![]);}if(_0x3dba0b[_0x483d2f(0xa37)]?.[_0x483d2f(0xf4f)]?.[_0x483d2f(0x8d6)]>0x0){const _0x204302=_0x3dba0b['settings']['linkedMemoryChatIds'][_0x483d2f(0x8d6)];_0x3dba0b[_0x483d2f(0xa37)][_0x483d2f(0xf4f)]=_0x3dba0b['settings'][_0x483d2f(0xf4f)][_0x483d2f(0x29d)](_0x24bda0=>_0x4aa330[_0x483d2f(0x3e3)](_0x24bda0)),_0x3dba0b[_0x483d2f(0xa37)][_0x483d2f(0xf4f)]['length']<_0x204302&&(_0x2d5c40['chatLinks']+=_0x204302-_0x3dba0b[_0x483d2f(0xa37)][_0x483d2f(0xf4f)]['length'],_0x1e3293=!![]);}_0x1e3293&&await _0x54c587[_0x483d2f(0xbea)][_0x483d2f(0x4cb)](_0x3dba0b);}const _0x525153=await _0x54c587[_0x483d2f(0xba7)]['toArray']();for(const _0x53c9cf of _0x525153){let _0x38f4e7=![];const _0x1bd6aa=_0x53c9cf[_0x483d2f(0x606)]===_0x483d2f(0x6d6)||_0x4aa330[_0x483d2f(0x3e3)](_0x53c9cf['authorId'])||_0x5b2c46['has'](_0x53c9cf['authorId']);if(!_0x1bd6aa){await _0x54c587[_0x483d2f(0xba7)][_0x483d2f(0x942)](_0x53c9cf['id']),_0x2d5c40[_0x483d2f(0xd9c)]++;continue;}if(_0x53c9cf['likes']&&_0x53c9cf[_0x483d2f(0xe30)][_0x483d2f(0x8d6)]>0x0){const _0x4bc05c=_0x53c9cf[_0x483d2f(0xe30)][_0x483d2f(0x8d6)];_0x53c9cf['likes']=_0x53c9cf[_0x483d2f(0xe30)]['filter'](_0x48607f=>_0x3135cd[_0x483d2f(0x3e3)](_0x48607f)),_0x53c9cf[_0x483d2f(0xe30)][_0x483d2f(0x8d6)]<_0x4bc05c&&(_0x2d5c40[_0x483d2f(0xe30)]+=_0x4bc05c-_0x53c9cf[_0x483d2f(0xe30)][_0x483d2f(0x8d6)],_0x38f4e7=!![]);}if(_0x53c9cf[_0x483d2f(0xf8f)]&&_0x53c9cf[_0x483d2f(0xf8f)][_0x483d2f(0x8d6)]>0x0){const _0x27ceaa=_0x53c9cf[_0x483d2f(0xf8f)][_0x483d2f(0x8d6)];_0x53c9cf['comments']=_0x53c9cf[_0x483d2f(0xf8f)][_0x483d2f(0x29d)](_0x3fa56a=>{const _0x505d49=_0x483d2f;if(typeof _0x3fa56a===_0x505d49(0xfc4)&&_0x3fa56a[_0x505d49(0xbf8)])return _0x3135cd[_0x505d49(0x3e3)](_0x3fa56a[_0x505d49(0xbf8)]);return!![];}),_0x53c9cf['comments'][_0x483d2f(0x8d6)]<_0x27ceaa&&(_0x2d5c40[_0x483d2f(0xf8f)]+=_0x27ceaa-_0x53c9cf[_0x483d2f(0xf8f)][_0x483d2f(0x8d6)],_0x38f4e7=!![]);}_0x38f4e7&&await _0x54c587[_0x483d2f(0xba7)][_0x483d2f(0x4cb)](_0x53c9cf);}await _0x54c587[_0x483d2f(0x1541)][_0x483d2f(0x227)](_0x483d2f(0x4dd))[_0x483d2f(0xd91)]([..._0x4aa330])[_0x483d2f(0x942)]()[_0x483d2f(0xa8b)](_0x3f20a5=>_0x2d5c40['memories']+=_0x3f20a5),await _0x54c587[_0x483d2f(0x688)]['where'](_0x483d2f(0x4dd))['noneOf']([..._0x4aa330])['delete']()[_0x483d2f(0xa8b)](_0x354a7a=>_0x2d5c40[_0x483d2f(0x688)]+=_0x354a7a);const _0x2e9a51=await _0x54c587['renderingRules'][_0x483d2f(0xce1)]();for(const _0x448472 of _0x2e9a51){_0x448472[_0x483d2f(0x4dd)]!==_0x483d2f(0x1051)&&!_0x4aa330['has'](_0x448472[_0x483d2f(0x4dd)])&&(await _0x54c587['renderingRules'][_0x483d2f(0x942)](_0x448472['id']),_0x2d5c40['renderingRules']++);}});let _0x2ec147=_0x254dc5(0x926),_0x46fe9f=![];Object[_0x254dc5(0x9de)](_0x2d5c40)[_0x254dc5(0xbdc)](([_0x1b91cc,_0x98f869])=>{const _0x1e1a8b=_0x254dc5;if(_0x98f869>0x0){const _0xecca5={'posts':'动态','likes':'点赞','comments':'评论','memories':'记忆','callRecords':'通话记录','renderingRules':_0x1e1a8b(0x85f),'groupMembers':_0x1e1a8b(0x883),'chatLinks':_0x1e1a8b(0xdb7)};_0x2ec147+=_0x1e1a8b(0x14a3)+_0x98f869+'\x20条无效的'+(_0xecca5[_0x1b91cc]||_0x1b91cc)+'。\x0a',_0x46fe9f=!![];}});!_0x46fe9f&&(_0x2ec147=_0x254dc5(0x131b));_0x2ec147+=_0x254dc5(0x112a),await _0x138765('操作成功',_0x2ec147);const _0x539775=await _0x56d4d3(_0x254dc5(0xec3),'为了确保所有数据同步，建议立即刷新页面。');_0x539775&&location[_0x254dc5(0x1058)]();}catch(_0x2c0a6c){console[_0x254dc5(0x5d7)]('清理冗余数据时出错:',_0x2c0a6c),await _0x138765(_0x254dc5(0x56e),'发生了一个错误:\x20'+_0x2c0a6c['message']);}}async function _0x31d6bc(){const _0x5d3dfb=_0x239c7d;try{const _0x17e044={'version':0x1,'timestamp':Date['now']()},[_0x41fae0,_0x243978,_0xd69d4b,_0x4d2a21,_0x26f0b6,_0x52c8ff,_0x3fa3e2,_0x5d658f,_0x302ac1,_0x11f3ff,_0x538183,_0x665327,_0x222c6e,_0x513a6e,_0x4284c7,_0x1daebf,_0x11d1d6,_0x18a7c6,_0x43626e,_0x39797e,_0x230868,_0x2a968e,_0x426c4a,_0x255441,_0x1d6602]=await Promise['all']([_0x54c587[_0x5d3dfb(0xbea)][_0x5d3dfb(0xce1)](),_0x54c587[_0x5d3dfb(0xf57)][_0x5d3dfb(0xce1)](),_0x54c587[_0x5d3dfb(0x120c)]['toArray'](),_0x54c587['apiConfig'][_0x5d3dfb(0xf48)](_0x5d3dfb(0x2db)),_0x54c587[_0x5d3dfb(0x14f1)]['get'](_0x5d3dfb(0x2db)),_0x54c587[_0x5d3dfb(0x34f)][_0x5d3dfb(0xce1)](),_0x54c587['musicLibrary']['get']('main'),_0x54c587[_0x5d3dfb(0x834)][_0x5d3dfb(0xf48)]('main'),_0x54c587[_0x5d3dfb(0xba7)][_0x5d3dfb(0xce1)](),_0x54c587['qzoneAlbums']['toArray'](),_0x54c587['qzonePhotos'][_0x5d3dfb(0xce1)](),_0x54c587[_0x5d3dfb(0x69c)][_0x5d3dfb(0xce1)](),_0x54c587[_0x5d3dfb(0x15e8)][_0x5d3dfb(0xce1)](),_0x54c587['memories'][_0x5d3dfb(0xce1)](),_0x54c587[_0x5d3dfb(0x2c3)][_0x5d3dfb(0xce1)](),_0x54c587[_0x5d3dfb(0xbab)]['toArray'](),_0x54c587[_0x5d3dfb(0x28c)][_0x5d3dfb(0xce1)](),_0x54c587['callRecords'][_0x5d3dfb(0xce1)](),_0x54c587[_0x5d3dfb(0x148f)][_0x5d3dfb(0xce1)](),_0x54c587['doubanPosts'][_0x5d3dfb(0xce1)](),_0x54c587[_0x5d3dfb(0xf00)][_0x5d3dfb(0xce1)](),_0x54c587[_0x5d3dfb(0x973)]['toArray'](),_0x54c587['presets']['toArray'](),_0x54c587['presetCategories']['toArray'](),_0x54c587[_0x5d3dfb(0xf9b)][_0x5d3dfb(0xce1)]()]);Object[_0x5d3dfb(0x697)](_0x17e044,{'chats':_0x41fae0,'worldBooks':_0x243978,'userStickers':_0xd69d4b,'apiConfig':_0x4d2a21,'globalSettings':_0x26f0b6,'personaPresets':_0x52c8ff,'musicLibrary':_0x3fa3e2,'qzoneSettings':_0x5d658f,'qzonePosts':_0x302ac1,'qzoneAlbums':_0x11f3ff,'qzonePhotos':_0x538183,'favorites':_0x665327,'qzoneGroups':_0x222c6e,'memories':_0x513a6e,'worldBookCategories':_0x4284c7,'apiPresets':_0x1daebf,'shoppingProducts':_0x11d1d6,'callRecords':_0x18a7c6,'renderingRules':_0x43626e,'doubanPosts':_0x39797e,'stickerCategories':_0x230868,'appearancePresets':_0x2a968e,'presets':_0x426c4a,'presetCategories':_0x255441,'npcs':_0x1d6602});const _0x4ae76d=new Blob([JSON['stringify'](_0x17e044,null,0x2)],{'type':_0x5d3dfb(0xfae)}),_0x5c2346=URL['createObjectURL'](_0x4ae76d),_0x385dd7=Object['assign'](document[_0x5d3dfb(0x2c9)]('a'),{'href':_0x5c2346,'download':'EPhone-Full-Backup-'+new Date()[_0x5d3dfb(0x886)]()[_0x5d3dfb(0x5ad)]('T')[0x0]+_0x5d3dfb(0xbfb)});_0x385dd7[_0x5d3dfb(0x15ad)](),URL['revokeObjectURL'](_0x5c2346),await _0x138765(_0x5d3dfb(0x6ca),_0x5d3dfb(0xddc));}catch(_0x3dee00){console[_0x5d3dfb(0x5d7)](_0x5d3dfb(0xc58),_0x3dee00),await _0x138765(_0x5d3dfb(0x13be),_0x5d3dfb(0xef2)+_0x3dee00['message']);}}async function _0x6e4091(_0x38c423){const _0x505cb6=_0x239c7d;try{await _0x54c587[_0x505cb6(0xfec)]('rw',_0x54c587[_0x505cb6(0xfcf)],async()=>{const _0x4263e3=_0x505cb6;for(const _0x1c8cbe of _0x54c587['tables']){await _0x1c8cbe[_0x4263e3(0x82f)]();}for(const _0x39aded in _0x38c423){Array[_0x4263e3(0x16a1)](_0x38c423[_0x39aded])&&(console[_0x4263e3(0x1e6)](_0x4263e3(0xafd)+_0x39aded+_0x4263e3(0x3e6)+_0x38c423[_0x39aded]['length']),await _0x54c587[_0x4263e3(0x770)](_0x39aded)['bulkPut'](_0x38c423[_0x39aded]));}});}catch(_0x8a1b47){throw new Error('数据库写入失败:\x20'+_0x8a1b47[_0x505cb6(0x6e2)]);}}async function _0x2f014f(_0x3f0107){const _0x47b8ac=_0x239c7d;if(!_0x3f0107)return;await _0x138765(_0x47b8ac(0x13e9),_0x47b8ac(0x1036));try{const _0x43b2ef=await _0x3f0107[_0x47b8ac(0x117f)](),_0x39f251=JSON[_0x47b8ac(0x13f7)](_0x43b2ef);let _0x432485,_0x44cdd6;if(_0x39f251[_0x47b8ac(0x55b)]&&typeof _0x39f251[_0x47b8ac(0x55b)]===_0x47b8ac(0xfc4)&&(_0x39f251[_0x47b8ac(0x55b)][_0x47b8ac(0xbea)]||_0x39f251[_0x47b8ac(0x55b)][_0x47b8ac(0xf57)]))console[_0x47b8ac(0x1e6)](_0x47b8ac(0x128e)),_0x432485=_0x39f251[_0x47b8ac(0x55b)],_0x44cdd6=_0x47b8ac(0x153c);else{if(_0x39f251[_0x47b8ac(0xbea)]||_0x39f251[_0x47b8ac(0xf57)])console[_0x47b8ac(0x1e6)]('检测到旧版完整备份文件...'),_0x432485=_0x39f251,_0x44cdd6=_0x47b8ac(0x1525);else throw new Error(_0x47b8ac(0x4fb));}pendingBackupData={'type':_0x44cdd6,'content':_0x432485},_0x3aa7ff(_0x432485);}catch(_0x2b57e2){console[_0x47b8ac(0x5d7)]('导入数据时出错:',_0x2b57e2),pendingBackupData=null,await _0x138765('导入失败',_0x47b8ac(0xad8)+_0x2b57e2[_0x47b8ac(0x6e2)]);}}function _0x3aa7ff(_0x401022){const _0x5f1f6b=_0x239c7d,_0x295fc6=document[_0x5f1f6b(0x400)](_0x5f1f6b(0x43d)),_0x4adcee=document['getElementById'](_0x5f1f6b(0xb88));_0x4adcee[_0x5f1f6b(0x1575)]='';const _0x3748b4={'chats':_0x5f1f6b(0x212),'worldBooks':_0x5f1f6b(0x292),'worldBookCategories':_0x5f1f6b(0x146a),'presets':_0x5f1f6b(0x1310),'presetCategories':_0x5f1f6b(0x614),'userStickers':_0x5f1f6b(0x7b1),'stickerCategories':_0x5f1f6b(0xcc6),'customAvatarFrames':_0x5f1f6b(0xb1e),'apiConfig':_0x5f1f6b(0xba6),'globalSettings':_0x5f1f6b(0x1339),'personaPresets':_0x5f1f6b(0xe66),'qzoneSettings':_0x5f1f6b(0x8c8),'qzonePosts':'动态','qzoneAlbums':'相册','favorites':'收藏','memories':'回忆','callRecords':_0x5f1f6b(0xaff),'shoppingProducts':'商品','apiPresets':_0x5f1f6b(0x4f5),'renderingRules':_0x5f1f6b(0x85f),'appearancePresets':_0x5f1f6b(0x11a9),'npcs':_0x5f1f6b(0x68a)};let _0x1e79a2=![];for(const _0x261e03 in _0x3748b4){if(_0x401022[_0x261e03]&&(Array[_0x5f1f6b(0x16a1)](_0x401022[_0x261e03])?_0x401022[_0x261e03]['length']>0x0:_0x401022[_0x261e03])){const _0x5afb14=Array[_0x5f1f6b(0x16a1)](_0x401022[_0x261e03])?_0x401022[_0x261e03]['length']:0x1,_0x562302=document[_0x5f1f6b(0x2c9)]('li');_0x562302[_0x5f1f6b(0xde7)]=_0x3748b4[_0x261e03]+':\x20'+_0x5afb14+'\x20条/个',_0x4adcee[_0x5f1f6b(0x8f2)](_0x562302),_0x1e79a2=!![];}}!_0x1e79a2&&(_0x4adcee['innerHTML']=_0x5f1f6b(0x12df)),document[_0x5f1f6b(0x400)](_0x5f1f6b(0x1142))[_0x5f1f6b(0x41b)]=()=>{const _0x4a02e3=_0x5f1f6b;_0x295fc6[_0x4a02e3(0xb08)]['remove'](_0x4a02e3(0x9eb)),_0xb55d73(pendingBackupData);},document['getElementById'](_0x5f1f6b(0x4bf))[_0x5f1f6b(0x41b)]=()=>{const _0x129ff9=_0x5f1f6b;_0x295fc6['classList'][_0x129ff9(0xc46)](_0x129ff9(0x9eb)),_0x1252a1(pendingBackupData[_0x129ff9(0x1109)]);},document['getElementById'](_0x5f1f6b(0x813))['onclick']=()=>{const _0x31199c=_0x5f1f6b;_0x295fc6[_0x31199c(0xb08)][_0x31199c(0xc46)](_0x31199c(0x9eb)),pendingBackupData=null;},_0x295fc6[_0x5f1f6b(0xb08)]['add'](_0x5f1f6b(0x9eb));}async function _0xb55d73(_0x15733a){const _0x4aedba=_0x239c7d;if(!_0x15733a)return;const _0x59bf7f=await _0x56d4d3('严重警告！',_0x4aedba(0xe05),{'confirmButtonClass':_0x4aedba(0x142c),'confirmText':_0x4aedba(0x1533)});if(!_0x59bf7f){pendingBackupData=null;return;}await _0x138765('请稍候...',_0x4aedba(0x3ba));try{if(_0x15733a[_0x4aedba(0xbbf)]==='streamed')await _0x6e4091(_0x15733a[_0x4aedba(0x1109)]);else{if(_0x15733a['type']===_0x4aedba(0x1525))await _0x161210(_0x15733a['content']);else throw new Error('未知的备份类型。');}await _0x138765('导入成功',_0x4aedba(0x1439)),setTimeout(()=>window['location'][_0x4aedba(0x1058)](),0x5dc);}catch(_0x4fec8a){console[_0x4aedba(0x5d7)]('完全导入失败:',_0x4fec8a),await _0x138765(_0x4aedba(0x3e8),'文件应用失败:\x20'+_0x4fec8a[_0x4aedba(0x6e2)]);}finally{pendingBackupData=null;}}function _0x1252a1(_0x1ef512){const _0x3ecdf9=_0x239c7d,_0x5359ed=document[_0x3ecdf9(0x400)](_0x3ecdf9(0x629)),_0x532777=document[_0x3ecdf9(0x400)]('selective-import-list'),_0x5f1f90=document['getElementById'](_0x3ecdf9(0x38b));_0x532777[_0x3ecdf9(0x1575)]='',_0x5f1f90[_0x3ecdf9(0x6f9)]=!![];const _0x5673cc={'chats':_0x3ecdf9(0x212),'worldBooks':'世界书','worldBookCategories':_0x3ecdf9(0x146a),'presets':_0x3ecdf9(0x1310),'presetCategories':_0x3ecdf9(0x614),'userStickers':'表情包','stickerCategories':_0x3ecdf9(0xcc6),'customAvatarFrames':_0x3ecdf9(0xb1e),'apiConfig':_0x3ecdf9(0xba6),'globalSettings':'全局设置','personaPresets':_0x3ecdf9(0xe66),'qzoneSettings':_0x3ecdf9(0x8c8),'qzonePosts':'动态','qzoneAlbums':'相册','favorites':'收藏','memories':'回忆','callRecords':_0x3ecdf9(0xaff),'shoppingProducts':'商品','apiPresets':_0x3ecdf9(0x4f5),'renderingRules':_0x3ecdf9(0x85f),'appearancePresets':_0x3ecdf9(0x11a9),'npcs':'NPCs'};let _0xc37894=![];for(const _0x245851 in _0x5673cc){if(_0x1ef512[_0x245851]&&(Array['isArray'](_0x1ef512[_0x245851])?_0x1ef512[_0x245851][_0x3ecdf9(0x8d6)]>0x0:_0x1ef512[_0x245851])){const _0x84df4e=Array['isArray'](_0x1ef512[_0x245851])?_0x1ef512[_0x245851][_0x3ecdf9(0x8d6)]:0x1,_0x13dac9=!Array[_0x3ecdf9(0x16a1)](_0x1ef512[_0x245851]),_0x2b3310=document[_0x3ecdf9(0x2c9)](_0x3ecdf9(0xf8e));_0x2b3310['className']=_0x3ecdf9(0x40e),_0x2b3310['dataset']['typeId']=_0x245851,_0x2b3310[_0x3ecdf9(0x1575)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x20selected\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x5673cc[_0x245851]+'\x20('+_0x84df4e+'\x20条/个)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x13dac9?_0x3ecdf9(0xea2):'')+_0x3ecdf9(0x3ae),_0x532777['appendChild'](_0x2b3310),_0xc37894=!![];}}!_0xc37894&&(_0x532777['innerHTML']=_0x3ecdf9(0x166a)),document[_0x3ecdf9(0x400)](_0x3ecdf9(0xe97))[_0x3ecdf9(0x41b)]=()=>_0x481218(pendingBackupData),document['getElementById'](_0x3ecdf9(0xa7c))[_0x3ecdf9(0x41b)]=()=>{const _0x4fd463=_0x3ecdf9;_0x5359ed['classList'][_0x4fd463(0xc46)](_0x4fd463(0x9eb)),pendingBackupData=null;},_0x5f1f90[_0x3ecdf9(0x1491)]=_0x48dd60=>{const _0x2ed84e=_0x3ecdf9,_0x5bc2b4=_0x48dd60['target'][_0x2ed84e(0x6f9)];_0x532777[_0x2ed84e(0x527)](_0x2ed84e(0x8cf))[_0x2ed84e(0xbdc)](_0x89ea1d=>{const _0x124cd6=_0x2ed84e;_0x89ea1d['classList'][_0x124cd6(0x146f)](_0x124cd6(0x148b),_0x5bc2b4),_0x89ea1d['querySelector']('.checkbox')[_0x124cd6(0xb08)][_0x124cd6(0x146f)](_0x124cd6(0x148b),_0x5bc2b4);});},_0x532777[_0x3ecdf9(0x41b)]=_0x495782=>{const _0xa6aa61=_0x3ecdf9,_0x39658f=_0x495782[_0xa6aa61(0x657)][_0xa6aa61(0x117a)]('.clear-posts-item');_0x39658f&&(_0x39658f[_0xa6aa61(0xb08)][_0xa6aa61(0x146f)](_0xa6aa61(0x148b)),_0x39658f['querySelector'](_0xa6aa61(0x925))['classList']['toggle'](_0xa6aa61(0x148b)));},_0x5359ed[_0x3ecdf9(0xb08)][_0x3ecdf9(0x12b6)]('visible');}async function _0x481218(_0x5ce8fa){const _0x2a2471=_0x239c7d;if(!_0x5ce8fa)return;const _0x2d0f0f=document[_0x2a2471(0x527)](_0x2a2471(0xf18));if(_0x2d0f0f[_0x2a2471(0x8d6)]===0x0){alert(_0x2a2471(0x6dc));return;}const _0x36d9a2=Array[_0x2a2471(0xdc0)](_0x2d0f0f)[_0x2a2471(0xd18)](_0x5dea27=>_0x5dea27[_0x2a2471(0xd61)][_0x2a2471(0xa44)]),_0x14b90f=_0x5ce8fa['content'],_0xdb56fb=await _0x56d4d3('确认合并？',_0x2a2471(0x141f),{'confirmText':_0x2a2471(0x14ee)});if(!_0xdb56fb)return;await _0x138765(_0x2a2471(0x13e9),_0x2a2471(0xc7a));try{await _0x54c587['transaction']('rw',_0x54c587[_0x2a2471(0xfcf)],async()=>{const _0x7498ae=_0x2a2471;for(const _0x535bda of _0x36d9a2){const _0xb01818=_0x14b90f[_0x535bda];if(!_0xb01818)continue;const _0x432dfe=_0x54c587[_0x7498ae(0x770)](_0x535bda);if(!_0x432dfe){console[_0x7498ae(0x75e)](_0x7498ae(0xe51)+_0x535bda+_0x7498ae(0x8b8));continue;}if(Array['isArray'](_0xb01818))console[_0x7498ae(0x1e6)](_0x7498ae(0xca9)+_0xb01818[_0x7498ae(0x8d6)]+_0x7498ae(0x1251)+_0x535bda+_0x7498ae(0x166b)),await _0x432dfe[_0x7498ae(0x1f6)](_0xb01818);else{if(typeof _0xb01818===_0x7498ae(0xfc4)&&_0xb01818['id'])console[_0x7498ae(0x1e6)](_0x7498ae(0xb3b)+_0x535bda+_0x7498ae(0x166b)),await _0x432dfe[_0x7498ae(0x4cb)](_0xb01818);else{if(typeof _0xb01818===_0x7498ae(0xfc4)){console[_0x7498ae(0x1e6)](_0x7498ae(0x9f9)+_0x535bda+_0x7498ae(0x166b));const _0x144e0e=await _0x432dfe[_0x7498ae(0x118a)]()[_0x7498ae(0x149c)]()||{},_0x43926c={..._0x144e0e,..._0xb01818};if(_0x144e0e['id'])_0x43926c['id']=_0x144e0e['id'];else(_0x535bda==='apiConfig'||_0x535bda===_0x7498ae(0x834)||_0x535bda===_0x7498ae(0x14f1)||_0x535bda===_0x7498ae(0x1450))&&(_0x43926c['id']=_0x7498ae(0x2db));await _0x432dfe[_0x7498ae(0x4cb)](_0x43926c);}}}}}),await _0x138765(_0x2a2471(0xfd8),_0x2a2471(0xa77)),setTimeout(()=>window['location'][_0x2a2471(0x1058)](),0x5dc);}catch(_0x5bbda7){console[_0x2a2471(0x5d7)](_0x2a2471(0x88f),_0x5bbda7),await _0x138765(_0x2a2471(0x15e4),_0x2a2471(0x1263)+_0x5bbda7[_0x2a2471(0x6e2)]);}finally{pendingBackupData=null;}}async function _0x161210(_0xee580e){const _0x4720d8=_0x239c7d;try{await _0x54c587[_0x4720d8(0xfec)]('rw',_0x54c587[_0x4720d8(0xfcf)],async()=>{const _0x8ba44c=_0x4720d8;await _0x54c587['chats'][_0x8ba44c(0x82f)](),await _0x54c587[_0x8ba44c(0xf57)][_0x8ba44c(0x82f)]();for(const _0xe7a54b of _0x54c587['tables']){await _0xe7a54b['clear']();}if(Array[_0x8ba44c(0x16a1)](_0xee580e[_0x8ba44c(0xbea)]))await _0x54c587[_0x8ba44c(0xbea)]['bulkPut'](_0xee580e[_0x8ba44c(0xbea)]);if(Array[_0x8ba44c(0x16a1)](_0xee580e[_0x8ba44c(0xf57)]))await _0x54c587[_0x8ba44c(0xf57)][_0x8ba44c(0x1f6)](_0xee580e[_0x8ba44c(0xf57)]);if(Array[_0x8ba44c(0x16a1)](_0xee580e[_0x8ba44c(0x120c)]))await _0x54c587['userStickers'][_0x8ba44c(0x1f6)](_0xee580e[_0x8ba44c(0x120c)]);if(_0xee580e[_0x8ba44c(0x814)])await _0x54c587['apiConfig'][_0x8ba44c(0x4cb)](_0xee580e[_0x8ba44c(0x814)]);if(_0xee580e[_0x8ba44c(0x14f1)])await _0x54c587[_0x8ba44c(0x14f1)][_0x8ba44c(0x4cb)](_0xee580e[_0x8ba44c(0x14f1)]);if(Array[_0x8ba44c(0x16a1)](_0xee580e[_0x8ba44c(0x34f)]))await _0x54c587['personaPresets'][_0x8ba44c(0x1f6)](_0xee580e[_0x8ba44c(0x34f)]);if(_0xee580e['musicLibrary'])await _0x54c587[_0x8ba44c(0x1450)][_0x8ba44c(0x4cb)](_0xee580e['musicLibrary']);if(_0xee580e[_0x8ba44c(0x834)])await _0x54c587[_0x8ba44c(0x834)][_0x8ba44c(0x4cb)](_0xee580e['qzoneSettings']);if(Array[_0x8ba44c(0x16a1)](_0xee580e[_0x8ba44c(0xba7)]))await _0x54c587[_0x8ba44c(0xba7)][_0x8ba44c(0x1f6)](_0xee580e[_0x8ba44c(0xba7)]);if(Array['isArray'](_0xee580e[_0x8ba44c(0xc1e)]))await _0x54c587[_0x8ba44c(0xc1e)][_0x8ba44c(0x1f6)](_0xee580e['qzoneAlbums']);if(Array[_0x8ba44c(0x16a1)](_0xee580e[_0x8ba44c(0x933)]))await _0x54c587['qzonePhotos']['bulkPut'](_0xee580e[_0x8ba44c(0x933)]);if(Array['isArray'](_0xee580e['favorites']))await _0x54c587[_0x8ba44c(0x69c)]['bulkPut'](_0xee580e[_0x8ba44c(0x69c)]);if(Array[_0x8ba44c(0x16a1)](_0xee580e[_0x8ba44c(0x15e8)]))await _0x54c587[_0x8ba44c(0x15e8)][_0x8ba44c(0x1f6)](_0xee580e[_0x8ba44c(0x15e8)]);if(Array[_0x8ba44c(0x16a1)](_0xee580e[_0x8ba44c(0x1541)]))await _0x54c587[_0x8ba44c(0x1541)][_0x8ba44c(0x1f6)](_0xee580e[_0x8ba44c(0x1541)]);if(Array[_0x8ba44c(0x16a1)](_0xee580e[_0x8ba44c(0x2c3)]))await _0x54c587[_0x8ba44c(0x2c3)][_0x8ba44c(0x1f6)](_0xee580e[_0x8ba44c(0x2c3)]);if(Array[_0x8ba44c(0x16a1)](_0xee580e['apiPresets']))await _0x54c587['apiPresets'][_0x8ba44c(0x1f6)](_0xee580e['apiPresets']);if(Array[_0x8ba44c(0x16a1)](_0xee580e[_0x8ba44c(0x28c)]))await _0x54c587[_0x8ba44c(0x28c)][_0x8ba44c(0x1f6)](_0xee580e[_0x8ba44c(0x28c)]);if(Array[_0x8ba44c(0x16a1)](_0xee580e[_0x8ba44c(0x688)]))await _0x54c587[_0x8ba44c(0x688)][_0x8ba44c(0x1f6)](_0xee580e[_0x8ba44c(0x688)]);if(Array[_0x8ba44c(0x16a1)](_0xee580e[_0x8ba44c(0x148f)]))await _0x54c587[_0x8ba44c(0x148f)][_0x8ba44c(0x1f6)](_0xee580e['renderingRules']);if(Array[_0x8ba44c(0x16a1)](_0xee580e[_0x8ba44c(0xa7f)]))await _0x54c587['doubanPosts'][_0x8ba44c(0x1f6)](_0xee580e[_0x8ba44c(0xa7f)]);if(Array[_0x8ba44c(0x16a1)](_0xee580e[_0x8ba44c(0xf00)]))await _0x54c587[_0x8ba44c(0xf00)]['bulkPut'](_0xee580e[_0x8ba44c(0xf00)]);if(Array[_0x8ba44c(0x16a1)](_0xee580e[_0x8ba44c(0x973)]))await _0x54c587[_0x8ba44c(0x973)][_0x8ba44c(0x1f6)](_0xee580e[_0x8ba44c(0x973)]);if(Array[_0x8ba44c(0x16a1)](_0xee580e[_0x8ba44c(0xf53)]))await _0x54c587['presets'][_0x8ba44c(0x1f6)](_0xee580e[_0x8ba44c(0xf53)]);if(Array[_0x8ba44c(0x16a1)](_0xee580e[_0x8ba44c(0x145e)]))await _0x54c587['presetCategories'][_0x8ba44c(0x1f6)](_0xee580e[_0x8ba44c(0x145e)]);if(Array[_0x8ba44c(0x16a1)](_0xee580e[_0x8ba44c(0xf9b)]))await _0x54c587[_0x8ba44c(0xf9b)][_0x8ba44c(0x1f6)](_0xee580e[_0x8ba44c(0xf9b)]);});}catch(_0x2370a2){throw new Error(_0x4720d8(0x161d)+_0x2370a2['message']);}}function _0x572a63(_0x4ef7c4,_0x51c88d=![]){const _0x47a923=_0x239c7d;if(!_0x4ef7c4){_0x416d5b[_0x47a923(0x1575)]='',document[_0x47a923(0x400)](_0x47a923(0x9e2))[_0x47a923(0xa00)][_0x47a923(0x11b7)]='';return;}const _0xc2e44f='custom-user-font',_0x48b771='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27'+_0xc2e44f+_0x47a923(0xa66)+_0x4ef7c4+_0x47a923(0xbaf);if(_0x51c88d){const _0x2a655c=document[_0x47a923(0x400)](_0x47a923(0x14e3))||document['createElement'](_0x47a923(0xa00));_0x2a655c['id']='preview-font-style',_0x2a655c['innerHTML']=_0x48b771;if(!document[_0x47a923(0x400)](_0x47a923(0x14e3)))document[_0x47a923(0x203)][_0x47a923(0x8f2)](_0x2a655c);document['getElementById'](_0x47a923(0x9e2))[_0x47a923(0xa00)]['fontFamily']='\x27'+_0xc2e44f+'\x27,\x20\x27bulangni\x27,\x20sans-serif';}else _0x416d5b[_0x47a923(0x1575)]=_0x47a923(0x85c)+_0x48b771+_0x47a923(0x1321)+_0xc2e44f+_0x47a923(0x776);}async function _0x530897(){const _0x508c8b=_0x239c7d;_0x416d5b[_0x508c8b(0x1575)]='',_0x4c8b14[_0x508c8b(0x14f1)][_0x508c8b(0x1302)]='',await _0x54c587[_0x508c8b(0x14f1)][_0x508c8b(0x4cb)](_0x4c8b14[_0x508c8b(0x14f1)]),document[_0x508c8b(0x400)](_0x508c8b(0x55a))[_0x508c8b(0xa1e)]='',document[_0x508c8b(0x400)](_0x508c8b(0x9e2))[_0x508c8b(0xa00)][_0x508c8b(0x11b7)]='',alert('已恢复默认字体。');}async function _0x38980a(){const _0x2719cd=_0x239c7d,[_0x265cf8,_0x2757a3,_0x5f0aa4,_0x200624,_0x57e8d,_0x119fe9,_0x44c42e,_0x146861,_0x2bb645,_0x24e359,_0x5ded0c,_0x244134]=await Promise[_0x2719cd(0x875)]([_0x54c587['chats'][_0x2719cd(0xce1)](),_0x54c587[_0x2719cd(0x814)][_0x2719cd(0xf48)](_0x2719cd(0x2db)),_0x54c587[_0x2719cd(0x14f1)]['get'](_0x2719cd(0x2db)),_0x54c587[_0x2719cd(0x120c)]['toArray'](),_0x54c587[_0x2719cd(0xf57)][_0x2719cd(0xce1)](),_0x54c587[_0x2719cd(0x1450)][_0x2719cd(0xf48)]('main'),_0x54c587['personaPresets'][_0x2719cd(0xce1)](),_0x54c587['qzoneSettings'][_0x2719cd(0xf48)](_0x2719cd(0x2db)),_0x54c587[_0x2719cd(0x69c)][_0x2719cd(0x541)](_0x2719cd(0x287))[_0x2719cd(0xfc1)]()[_0x2719cd(0xce1)](),_0x54c587['memories'][_0x2719cd(0xce1)](),_0x54c587[_0x2719cd(0xf53)][_0x2719cd(0xce1)](),_0x54c587[_0x2719cd(0x210)][_0x2719cd(0xce1)]()]);_0x4c8b14['presets']=_0x5ded0c||[],_0x4c8b14[_0x2719cd(0x210)]=_0x244134||[];const _0x1d3f37={'id':_0x2719cd(0x2db),'showStatusBar':![],'wallpaper':_0x2719cd(0x1569),'fontUrl':'','enableBackgroundActivity':![],'backgroundActivityInterval':0x3c,'blockCooldownHours':0x1,'apiTemperature':0.8,'appIcons':{..._0x22ed01},'cphoneWallpaper':_0x2719cd(0x14fb),'cphoneAppIcons':{..._0x2a11af},'globalCss':'','notificationSoundUrl':'','widgetData':{},'globalChatBackground':'','enableAiDrawing':!![],'showPhoneFrame':![],'alwaysShowMusicIsland':![],'detachStatusBar':![],'enableMinimalChatUI':![],'chatActionButtonsOrder':null,'shoppingCategoryCount':0x3,'shoppingProductCount':0x8,'chatRenderWindow':0x32};_0x4c8b14['globalSettings']={..._0x1d3f37,..._0x5f0aa4||{}},_0x4c8b14[_0x2719cd(0x14f1)]['appIcons']={..._0x1d3f37['appIcons'],..._0x4c8b14[_0x2719cd(0x14f1)]['appIcons']||{}},_0x4c8b14['globalSettings'][_0x2719cd(0x5d8)]={..._0x1d3f37[_0x2719cd(0x5d8)],..._0x4c8b14['globalSettings'][_0x2719cd(0x5d8)]||{}},_0x265cf8['forEach'](_0x320c97=>{const _0x2689eb=_0x2719cd;typeof _0x320c97['settings'][_0x2689eb(0xabe)]===_0x2689eb(0xd30)&&(_0x320c97['settings'][_0x2689eb(0xabe)]=!![]),!_0x320c97[_0x2689eb(0xa37)][_0x2689eb(0x9b1)]&&(_0x320c97[_0x2689eb(0xa37)][_0x2689eb(0x9b1)]={'vertical':_0x2689eb(0x899),'horizontal':_0x2689eb(0x1287),'offset':0xa}),!_0x320c97[_0x2689eb(0xc98)]&&!_0x320c97[_0x2689eb(0xa37)][_0x2689eb(0x110f)]&&(_0x320c97['settings'][_0x2689eb(0x110f)]=[]),!_0x320c97[_0x2689eb(0xc98)]&&typeof _0x320c97[_0x2689eb(0xdcf)]==='undefined'&&(_0x320c97[_0x2689eb(0xdcf)]=_0x320c97['name']);}),_0x4c8b14['chats']=_0x265cf8[_0x2719cd(0x439)]((_0x3a96c3,_0x2802d3)=>{const _0x58df2b=_0x2719cd;if(typeof _0x2802d3['unreadCount']===_0x58df2b(0xd30))_0x2802d3[_0x58df2b(0x73c)]=0x0;_0x2802d3['isGroup']&&(typeof _0x2802d3['settings']['enableBackgroundActivity']===_0x58df2b(0xd30)&&(_0x2802d3[_0x58df2b(0xa37)][_0x58df2b(0x3c4)]=!![]),_0x2802d3['members']&&_0x2802d3[_0x58df2b(0x4f8)][_0x58df2b(0x8d6)]>0x0&&_0x2802d3[_0x58df2b(0x4f8)][0x0][_0x58df2b(0xf3e)]&&_0x2802d3['members'][_0x58df2b(0xbdc)](_0x2a516c=>{const _0x1d144f=_0x58df2b;typeof _0x2a516c[_0x1d144f(0xdcf)]===_0x1d144f(0xd30)&&(_0x2a516c[_0x1d144f(0xdcf)]=_0x2a516c['name'],_0x2a516c['groupNickname']=_0x2a516c[_0x1d144f(0xf3e)],delete _0x2a516c['name']);}));if(!_0x2802d3[_0x58df2b(0xa37)])_0x2802d3[_0x58df2b(0xa37)]={};typeof _0x2802d3[_0x58df2b(0xa37)]['actionCooldownMinutes']===_0x58df2b(0xd30)&&(_0x2802d3['settings'][_0x58df2b(0x12c0)]=0xa);if(!_0x2802d3[_0x58df2b(0xc98)]&&!_0x2802d3[_0x58df2b(0x12c3)])_0x2802d3[_0x58df2b(0x12c3)]={'text':'在线','lastUpdate':Date[_0x58df2b(0xecd)](),'isBusy':![]};if(!_0x2802d3[_0x58df2b(0xc98)]&&!_0x2802d3[_0x58df2b(0x12f7)])_0x2802d3['relationship']={'status':_0x58df2b(0x1290),'blockedTimestamp':null,'applicationReason':''};if(!_0x2802d3[_0x58df2b(0xc98)]&&(!_0x2802d3[_0x58df2b(0xa37)]||!_0x2802d3[_0x58df2b(0xa37)][_0x58df2b(0x1080)])){if(!_0x2802d3[_0x58df2b(0xa37)])_0x2802d3[_0x58df2b(0xa37)]={};_0x2802d3['settings'][_0x58df2b(0x1080)]=[];}_0x2802d3[_0x58df2b(0xc98)]&&(_0x2802d3['members']||[])[_0x58df2b(0xbdc)](_0x2f7d9b=>{const _0x1720e3=_0x58df2b;if(typeof _0x2f7d9b[_0x1720e3(0x160d)]===_0x1720e3(0xd30))_0x2f7d9b[_0x1720e3(0x160d)]='';});if(!_0x2802d3[_0x58df2b(0x414)])_0x2802d3['musicData']={'totalTime':0x0};_0x2802d3['settings']&&_0x2802d3[_0x58df2b(0xa37)]['linkedWorldBookId']&&!_0x2802d3['settings'][_0x58df2b(0xb0d)]&&(_0x2802d3[_0x58df2b(0xa37)][_0x58df2b(0xb0d)]=[_0x2802d3[_0x58df2b(0xa37)][_0x58df2b(0x10f1)]],delete _0x2802d3[_0x58df2b(0xa37)][_0x58df2b(0x10f1)]);if(typeof _0x2802d3[_0x58df2b(0x1509)]===_0x58df2b(0xd30))_0x2802d3[_0x58df2b(0x1509)]=![];!_0x2802d3[_0x58df2b(0xc98)]&&typeof _0x2802d3['settings']['myNickname']===_0x58df2b(0xd30)&&(_0x2802d3[_0x58df2b(0xa37)]['myNickname']='我');if(_0x2802d3[_0x58df2b(0xc98)]&&_0x2802d3[_0x58df2b(0x4f8)]){let _0x121a54=![];_0x265cf8[_0x58df2b(0xbdc)](_0x5e315b=>{const _0x1f50af=_0x58df2b;_0x5e315b['id']===_0x2802d3['id']&&_0x5e315b[_0x1f50af(0xdcf)]&&delete _0x5e315b[_0x1f50af(0xdcf)];}),_0x2802d3[_0x58df2b(0x4f8)][_0x58df2b(0xbdc)](_0x22a260=>{const _0x15a9b6=_0x58df2b,_0x340caa=_0x265cf8[_0x15a9b6(0x821)](_0x221883=>_0x221883['id']===_0x22a260['id']);if(_0x340caa&&_0x340caa[_0x15a9b6(0xa37)]){const _0x58d34f=_0x340caa['settings'][_0x15a9b6(0x2d7)]||'';_0x22a260[_0x15a9b6(0x160d)]!==_0x58d34f&&(_0x22a260[_0x15a9b6(0x160d)]=_0x58d34f,_0x121a54=!![]);}else typeof _0x22a260[_0x15a9b6(0x160d)]==='undefined'&&(_0x22a260[_0x15a9b6(0x160d)]='',_0x121a54=!![]);});if(_0x121a54)_0x54c587[_0x58df2b(0xbea)]['put'](_0x2802d3);}if(!_0x2802d3['settings'][_0x58df2b(0xb36)])_0x2802d3['settings']['enableAutoMemory']=![];if(!_0x2802d3[_0x58df2b(0xa37)][_0x58df2b(0x9f1)])_0x2802d3['settings'][_0x58df2b(0x9f1)]=0x14;if(!_0x2802d3[_0x58df2b(0x1600)])_0x2802d3[_0x58df2b(0x1600)]=[];if(!_0x2802d3[_0x58df2b(0x1382)])_0x2802d3['lastMemorySummaryTimestamp']=0x0;if(!_0x2802d3[_0x58df2b(0xc98)]){typeof _0x2802d3[_0x58df2b(0xa37)]['enableBackgroundActivity']===_0x58df2b(0xd30)&&(_0x2802d3['settings'][_0x58df2b(0x3c4)]=!![]);typeof _0x2802d3[_0x58df2b(0xa37)][_0x58df2b(0x785)]===_0x58df2b(0xd30)&&(_0x2802d3[_0x58df2b(0xa37)][_0x58df2b(0x785)]=![]);if(!_0x2802d3[_0x58df2b(0x12c3)])_0x2802d3[_0x58df2b(0x12c3)]={'text':'在线','lastUpdate':Date[_0x58df2b(0xecd)](),'isBusy':![]};if(!_0x2802d3[_0x58df2b(0x12f7)])_0x2802d3[_0x58df2b(0x12f7)]={'status':_0x58df2b(0x1290),'blockedTimestamp':null,'applicationReason':''};if(!_0x2802d3[_0x58df2b(0xa37)]||!_0x2802d3['settings'][_0x58df2b(0x1080)]){if(!_0x2802d3['settings'])_0x2802d3['settings']={};_0x2802d3[_0x58df2b(0xa37)][_0x58df2b(0x1080)]=[];}if(typeof _0x2802d3[_0x58df2b(0xa37)][_0x58df2b(0x2a7)]===_0x58df2b(0xd30))_0x2802d3[_0x58df2b(0xa37)][_0x58df2b(0x2a7)]=![];if(typeof _0x2802d3['settings'][_0x58df2b(0x245)]===_0x58df2b(0xd30))_0x2802d3[_0x58df2b(0xa37)]['offlineMinLength']=0x64;if(typeof _0x2802d3[_0x58df2b(0xa37)]['offlineMaxLength']===_0x58df2b(0xd30))_0x2802d3[_0x58df2b(0xa37)][_0x58df2b(0x71c)]=0x12c;typeof _0x2802d3[_0x58df2b(0xa37)][_0x58df2b(0x6bf)]===_0x58df2b(0xd30)&&(_0x2802d3[_0x58df2b(0xa37)][_0x58df2b(0x6bf)]=![]);if(typeof _0x2802d3[_0x58df2b(0x8ab)]==='undefined')_0x2802d3['heartfeltVoice']=_0x58df2b(0x166b);if(typeof _0x2802d3[_0x58df2b(0x13e5)]==='undefined')_0x2802d3[_0x58df2b(0x13e5)]='...';!Array[_0x58df2b(0x16a1)](_0x2802d3[_0x58df2b(0x13a1)])&&(_0x2802d3[_0x58df2b(0x13a1)]=[]);}return typeof _0x2802d3[_0x58df2b(0xa37)]['stickerCategoryIds']==='undefined'&&(_0x2802d3[_0x58df2b(0xa37)][_0x58df2b(0x1510)]?_0x2802d3[_0x58df2b(0xa37)][_0x58df2b(0x1248)]=[_0x2802d3[_0x58df2b(0xa37)][_0x58df2b(0x1510)]]:_0x2802d3[_0x58df2b(0xa37)]['stickerCategoryIds']=[],delete _0x2802d3[_0x58df2b(0xa37)]['stickerCategoryId']),_0x3a96c3[_0x2802d3['id']]=_0x2802d3,_0x3a96c3;},{});const _0x2e1f3e=[];_0x24e359[_0x2719cd(0xbdc)](_0x1e101b=>{const _0x44a163=_0x2719cd;if(_0x1e101b['type']===_0x44a163(0x4e0)&&_0x1e101b['authorName']&&!_0x1e101b[_0x44a163(0x606)]){const _0x2ee0d7=_0x265cf8['find'](_0x467404=>!_0x467404[_0x44a163(0xc98)]&&_0x467404[_0x44a163(0xdcf)]===_0x1e101b[_0x44a163(0xf93)]);if(_0x2ee0d7)_0x1e101b[_0x44a163(0x606)]=_0x2ee0d7['id'],_0x2e1f3e['push'](_0x1e101b);else{const _0x411159=_0x265cf8[_0x44a163(0x821)](_0x5785c4=>!_0x5785c4['isGroup']&&_0x5785c4['name']===_0x1e101b[_0x44a163(0xf93)]);_0x411159&&(_0x1e101b[_0x44a163(0x606)]=_0x411159['id'],_0x2e1f3e['push'](_0x1e101b));}}}),_0x2e1f3e[_0x2719cd(0x8d6)]>0x0&&await _0x54c587[_0x2719cd(0x1541)]['bulkPut'](_0x2e1f3e),_0x4c8b14[_0x2719cd(0x814)]=_0x2757a3||{'id':'main','proxyUrl':'','apiKey':'','model':'','secondaryProxyUrl':'','secondaryApiKey':'','secondaryModel':'','minimaxGroupId':'','minimaxApiKey':'','minimaxModel':_0x2719cd(0x37c)},_0x4c8b14[_0x2719cd(0x120c)]=_0x200624||[],_0x4c8b14[_0x2719cd(0xf57)]=_0x57e8d||[],_0x59adb2[_0x2719cd(0xc3e)]=_0x119fe9?.[_0x2719cd(0xc3e)]||[],_0x4c8b14[_0x2719cd(0x34f)]=_0x44c42e||[],_0x4c8b14[_0x2719cd(0x834)]=_0x146861||{'id':_0x2719cd(0x2db),'nickname':'{{user}}','avatar':_0x2719cd(0x533),'banner':_0x2719cd(0xf46)},allFavoriteItems=_0x2bb645||[];}async function _0x2d1049(){const _0x147b66=_0x239c7d;await _0x54c587[_0x147b66(0x1450)]['put']({'id':_0x147b66(0x2db),'playlist':_0x59adb2[_0x147b66(0xc3e)]});}function _0x1eeb89(_0x5d6955){const _0x26a4a0=_0x239c7d;if(!_0x5d6955)return'';const _0x4a6ff6=new Date(_0x5d6955),_0x4b4b08=String(_0x4a6ff6[_0x26a4a0(0x331)]())[_0x26a4a0(0xb7d)](0x2,'0'),_0x299020=String(_0x4a6ff6[_0x26a4a0(0x1297)]())[_0x26a4a0(0xb7d)](0x2,'0');return _0x4b4b08+':'+_0x299020;}function _0x4878ba(_0x55d17d){const _0xf30c87=_0x239c7d,_0x3ba902=Date[_0xf30c87(0xecd)](),_0x354c33=Math[_0xf30c87(0x1381)]((_0x3ba902-_0x55d17d)/0x3e8);if(_0x354c33<0x3c)return'刚刚';const _0x2165f3=Math[_0xf30c87(0x1381)](_0x354c33/0x3c);if(_0x2165f3<0x3c)return _0x2165f3+_0xf30c87(0xa3e);const _0x107f26=Math[_0xf30c87(0x1381)](_0x2165f3/0x3c);if(_0x107f26<0x18)return _0x107f26+_0xf30c87(0x796);const _0x362a6d=Math['floor'](_0x107f26/0x18);if(_0x362a6d<0x1e)return _0x362a6d+'天前';const _0x3b6864=Math[_0xf30c87(0x1381)](_0x362a6d/0x1e);if(_0x3b6864<0xc)return'大约'+_0x3b6864+'个月前';const _0x14783b=Math['floor'](_0x362a6d/0x16d);return'大约'+_0x14783b+'年前';}function _0x597df9(_0x57e214){const _0x28e842=_0x239c7d;if(!_0x57e214)return'';const _0x21c524=new Date(),_0x254f1d=new Date(_0x57e214),_0x526a1f=String(_0x254f1d['getHours']())[_0x28e842(0xb7d)](0x2,'0'),_0x358582=String(_0x254f1d[_0x28e842(0x1297)]())[_0x28e842(0xb7d)](0x2,'0'),_0x50c2a8=_0x526a1f+':'+_0x358582;if(_0x21c524[_0x28e842(0x1021)]()===_0x254f1d[_0x28e842(0x1021)]())return _0x28e842(0x8d0)+_0x50c2a8;const _0xa59b3a=new Date();_0xa59b3a[_0x28e842(0x1076)](_0x21c524[_0x28e842(0xd00)]()-0x1);if(_0xa59b3a[_0x28e842(0x1021)]()===_0x254f1d[_0x28e842(0x1021)]())return'昨天\x20'+_0x50c2a8;if(_0x21c524[_0x28e842(0x1619)]()===_0x254f1d[_0x28e842(0x1619)]()){const _0x66fc5e=String(_0x254f1d[_0x28e842(0xebe)]()+0x1),_0x464364=String(_0x254f1d[_0x28e842(0xd00)]());return _0x66fc5e+'月'+_0x464364+'日\x20'+_0x50c2a8;}const _0x290eef=_0x254f1d[_0x28e842(0x1619)](),_0x20aa23=String(_0x254f1d[_0x28e842(0xebe)]()+0x1),_0x102345=String(_0x254f1d[_0x28e842(0xd00)]());return _0x290eef+'年'+_0x20aa23+'月'+_0x102345+'日\x20'+_0x50c2a8;}function _0x2dfe5c(){const _0xa5791d=_0x239c7d,_0x283abf=_0x2400cd();document[_0xa5791d(0x400)](_0xa5791d(0xe64))[_0xa5791d(0xa1e)]=_0x283abf[_0xa5791d(0xe33)],document[_0xa5791d(0x400)](_0xa5791d(0xb77))[_0xa5791d(0xa1e)]=_0x283abf[_0xa5791d(0x108f)],document[_0xa5791d(0x400)](_0xa5791d(0x12ab))[_0xa5791d(0xa1e)]=_0x283abf['cfg_scale'],document[_0xa5791d(0x400)](_0xa5791d(0xacf))[_0xa5791d(0xa1e)]=_0x283abf[_0xa5791d(0x924)],document[_0xa5791d(0x400)]('nai-seed')['value']=_0x283abf[_0xa5791d(0xc76)],document[_0xa5791d(0x400)](_0xa5791d(0x563))['value']=_0x283abf['uc_preset'],document['getElementById'](_0xa5791d(0x594))[_0xa5791d(0x6f9)]=_0x283abf['quality_toggle'],document[_0xa5791d(0x400)](_0xa5791d(0x685))[_0xa5791d(0x6f9)]=_0x283abf[_0xa5791d(0x46b)],document[_0xa5791d(0x400)](_0xa5791d(0x1072))[_0xa5791d(0x6f9)]=_0x283abf['smea_dyn'],document[_0xa5791d(0x400)](_0xa5791d(0x2c8))[_0xa5791d(0xa1e)]=_0x283abf[_0xa5791d(0x1697)],document[_0xa5791d(0x400)](_0xa5791d(0x11b0))['value']=_0x283abf[_0xa5791d(0x530)],document[_0xa5791d(0x400)]('nai-cors-proxy')[_0xa5791d(0xa1e)]=_0x283abf[_0xa5791d(0x4d8)],document['getElementById'](_0xa5791d(0x89a))[_0xa5791d(0xa1e)]=_0x283abf[_0xa5791d(0x6af)]||'';const _0x57c6d4=document['getElementById'](_0xa5791d(0x5c4));_0x57c6d4['style'][_0xa5791d(0xb1a)]=_0x283abf[_0xa5791d(0x4d8)]==='custom'?_0xa5791d(0x1181):'none';}function _0x35d044(){const _0x451a20=_0x239c7d,_0x52ee53=document[_0x451a20(0x400)](_0x451a20(0xb43))[_0x451a20(0x6f9)],_0x522e72=document[_0x451a20(0x400)](_0x451a20(0x355))[_0x451a20(0xa1e)],_0x15ae44=document[_0x451a20(0x400)]('novelai-api-key')['value']['trim']();localStorage['setItem'](_0x451a20(0x1329),_0x52ee53),localStorage[_0x451a20(0x143f)](_0x451a20(0x355),_0x522e72),localStorage[_0x451a20(0x143f)]('novelai-api-key',_0x15ae44);const _0x10f848={'resolution':document[_0x451a20(0x400)](_0x451a20(0xe64))['value'],'steps':parseInt(document[_0x451a20(0x400)](_0x451a20(0xb77))[_0x451a20(0xa1e)]),'cfg_scale':parseFloat(document[_0x451a20(0x400)](_0x451a20(0x12ab))[_0x451a20(0xa1e)]),'sampler':document['getElementById'](_0x451a20(0xacf))['value'],'seed':parseInt(document[_0x451a20(0x400)]('nai-seed')[_0x451a20(0xa1e)]),'uc_preset':parseInt(document['getElementById'](_0x451a20(0x563))[_0x451a20(0xa1e)]),'quality_toggle':document['getElementById'](_0x451a20(0x594))[_0x451a20(0x6f9)],'smea':document[_0x451a20(0x400)](_0x451a20(0x685))[_0x451a20(0x6f9)],'smea_dyn':document[_0x451a20(0x400)](_0x451a20(0x1072))['checked'],'default_positive':document[_0x451a20(0x400)](_0x451a20(0x2c8))[_0x451a20(0xa1e)],'default_negative':document[_0x451a20(0x400)](_0x451a20(0x11b0))[_0x451a20(0xa1e)],'cors_proxy':document[_0x451a20(0x400)](_0x451a20(0x1184))[_0x451a20(0xa1e)],'custom_proxy_url':document['getElementById']('nai-custom-proxy-url')['value']};localStorage['setItem']('novelai-settings',JSON['stringify'](_0x10f848));}function _0x392156(){const _0xbd5e2d=_0x239c7d;localStorage['removeItem']('novelai-settings'),_0x2dfe5c(),alert(_0xbd5e2d(0x8e7));}function _0x2400cd(){const _0x4c6683=_0x239c7d,_0x22aa6c={'resolution':_0x4c6683(0x11b9),'steps':0x1c,'cfg_scale':0x5,'sampler':_0x4c6683(0x8eb),'seed':-0x1,'uc_preset':0x1,'quality_toggle':!![],'smea':!![],'smea_dyn':![],'default_positive':_0x4c6683(0xbad),'default_negative':_0x4c6683(0x14db),'cors_proxy':_0x4c6683(0xd79),'custom_proxy_url':''},_0xda680c=localStorage['getItem']('novelai-settings');if(_0xda680c)try{return{..._0x22aa6c,...JSON[_0x4c6683(0x13f7)](_0xda680c)};}catch(_0x1c051a){return _0x22aa6c;}return _0x22aa6c;}async function _0x3b71e9(_0x2ce4fa,_0x4d9f1a){const _0x248d3e=_0x239c7d;console[_0x248d3e(0x1e6)](_0x248d3e(0xcd5)+_0x2ce4fa+_0x248d3e(0x15fa)+_0x4d9f1a);const _0x5e2371=_0x378780(_0x4d9f1a),_0x59b445=_0x2ce4fa+',\x20'+_0x5e2371['positive'],_0x51ac0b=_0x5e2371[_0x248d3e(0x49c)];console[_0x248d3e(0x1e6)]('📝\x20使用'+(_0x5e2371['source']==='character'?'角色专属':'系统')+_0x248d3e(0xedd)),console[_0x248d3e(0x1e6)](_0x248d3e(0x495),_0x59b445),console[_0x248d3e(0x1e6)](_0x248d3e(0xa1c),_0x51ac0b);const _0x405bee=localStorage[_0x248d3e(0xca2)](_0x248d3e(0x1570)),_0x4c0612=localStorage[_0x248d3e(0xca2)](_0x248d3e(0x355))||'nai-diffusion-4-5-full',_0x3325b4=_0x2400cd();if(!_0x405bee)throw new Error(_0x248d3e(0x1f5));const [_0x38b512,_0xd5440a]=_0x3325b4[_0x248d3e(0xe33)]['split']('x')['map'](Number);let _0x242389;_0x4c0612[_0x248d3e(0xd1b)](_0x248d3e(0x8b6))?_0x242389={'input':_0x59b445,'model':_0x4c0612,'action':_0x248d3e(0xdb8),'parameters':{'params_version':0x3,'width':_0x38b512,'height':_0xd5440a,'scale':_0x3325b4[_0x248d3e(0x507)],'sampler':_0x3325b4[_0x248d3e(0x924)],'steps':_0x3325b4[_0x248d3e(0x108f)],'seed':_0x3325b4[_0x248d3e(0xc76)]===-0x1?Math[_0x248d3e(0x1381)](Math[_0x248d3e(0x12bc)]()*0x2540be3ff):_0x3325b4[_0x248d3e(0xc76)],'n_samples':0x1,'ucPreset':_0x3325b4[_0x248d3e(0xc68)],'qualityToggle':_0x3325b4[_0x248d3e(0x5e1)],'add_original_image':!![],'noise_schedule':'karras','v4_prompt':{'caption':{'base_caption':_0x59b445,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x51ac0b,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x51ac0b,'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'cfg_rescale':0x0,'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x242389={'input':_0x59b445,'model':_0x4c0612,'action':'generate','parameters':{'width':_0x38b512,'height':_0xd5440a,'scale':_0x3325b4[_0x248d3e(0x507)],'sampler':_0x3325b4['sampler'],'steps':_0x3325b4[_0x248d3e(0x108f)],'seed':_0x3325b4[_0x248d3e(0xc76)]===-0x1?Math[_0x248d3e(0x1381)](Math[_0x248d3e(0x12bc)]()*0x2540be3ff):_0x3325b4['seed'],'n_samples':0x1,'ucPreset':_0x3325b4[_0x248d3e(0xc68)],'qualityToggle':_0x3325b4[_0x248d3e(0x5e1)],'sm':_0x3325b4[_0x248d3e(0x46b)],'sm_dyn':_0x3325b4[_0x248d3e(0x5de)],'negative_prompt':_0x51ac0b,'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x248d3e(0xe0b)}};console[_0x248d3e(0x1e6)](_0x248d3e(0xe56),_0x242389);let _0xcd5e2d;_0x4c0612[_0x248d3e(0xd1b)](_0x248d3e(0x8b6))?_0xcd5e2d=_0x248d3e(0x10f8):_0xcd5e2d=_0x248d3e(0xc3a);let _0x17b127=_0x3325b4[_0x248d3e(0x4d8)];_0x17b127===_0x248d3e(0x7da)&&(_0x17b127=_0x3325b4[_0x248d3e(0x6af)]||'');_0x17b127&&_0x17b127!==''&&(_0xcd5e2d=_0x17b127+encodeURIComponent(_0xcd5e2d));const _0x325991=await fetch(_0xcd5e2d,{'method':_0x248d3e(0x953),'headers':{'Content-Type':'application/json','Authorization':_0x248d3e(0xcee)+_0x405bee},'body':JSON[_0x248d3e(0xea5)](_0x242389)});if(!_0x325991['ok']){const _0x5e9408=await _0x325991[_0x248d3e(0x117f)]();throw new Error(_0x248d3e(0x167e)+_0x325991[_0x248d3e(0x12c3)]+_0x248d3e(0x29e)+_0x5e9408);}const _0x26d396=_0x325991[_0x248d3e(0x451)][_0x248d3e(0xf48)](_0x248d3e(0x255));let _0x84173c,_0x4e8e3b;if(_0x26d396&&_0x26d396['includes'](_0x248d3e(0x996))){const _0xfa1e3c=await _0x325991[_0x248d3e(0x117f)](),_0x5aa87a=_0xfa1e3c['trim']()[_0x248d3e(0x5ad)]('\x0a');let _0x303324=null;for(let _0x54696a=_0x5aa87a[_0x248d3e(0x8d6)]-0x1;_0x54696a>=0x0;_0x54696a--){const _0xc058f6=_0x5aa87a[_0x54696a][_0x248d3e(0xb8f)]();if(_0xc058f6[_0x248d3e(0xbb9)](_0x248d3e(0x16a9))&&_0xc058f6!=='data:\x20[DONE]'){const _0x3bc8a4=_0xc058f6[_0x248d3e(0x371)](0x6);try{const _0xc3805a=JSON[_0x248d3e(0x13f7)](_0x3bc8a4);if(_0xc3805a[_0x248d3e(0x10cb)]==='final'&&_0xc3805a[_0x248d3e(0xf86)]){_0x303324=_0xc3805a['image'];break;}if(_0xc3805a[_0x248d3e(0x55b)]){_0x303324=_0xc3805a[_0x248d3e(0x55b)];break;}if(_0xc3805a[_0x248d3e(0xf86)]){_0x303324=_0xc3805a[_0x248d3e(0xf86)];break;}}catch(_0x368ccf){_0x303324=_0x3bc8a4;break;}}}if(!_0x303324)throw new Error(_0x248d3e(0x309));const _0x5eaa10=_0x303324[_0x248d3e(0xbb9)](_0x248d3e(0x1646)),_0x59324b=_0x303324['startsWith']('/9j/');if(_0x5eaa10||_0x59324b)_0x4e8e3b='data:'+(_0x5eaa10?_0x248d3e(0x1443):'image/jpeg')+_0x248d3e(0xcce)+_0x303324;else{const _0x26923c=atob(_0x303324),_0x2affe5=new Uint8Array(_0x26923c[_0x248d3e(0x8d6)]);for(let _0x10a2df=0x0;_0x10a2df<_0x26923c[_0x248d3e(0x8d6)];_0x10a2df++)_0x2affe5[_0x10a2df]=_0x26923c['charCodeAt'](_0x10a2df);_0x84173c=new Blob([_0x2affe5]);}}else _0x84173c=await _0x325991['blob']();if(!_0x4e8e3b&&_0x84173c){if(typeof JSZip==='undefined')throw new Error('JSZip库未加载');const _0x5950cf=await JSZip[_0x248d3e(0x7b4)](_0x84173c);let _0x71c400=null;for(let _0x244f86 in _0x5950cf[_0x248d3e(0x780)]){if(_0x244f86[_0x248d3e(0xbf7)](/\.(png|jpg|jpeg|webp)$/i)){_0x71c400=_0x5950cf['files'][_0x244f86];break;}}if(!_0x71c400)throw new Error('ZIP文件中未找到图片');const _0x1ada3e=await _0x71c400[_0x248d3e(0xb87)](_0x248d3e(0xf6d));_0x4e8e3b=await new Promise((_0x302376,_0x153f67)=>{const _0x47bcd1=_0x248d3e,_0x3d40e4=new FileReader();_0x3d40e4['onloadend']=()=>_0x302376(_0x3d40e4['result']),_0x3d40e4[_0x47bcd1(0x96d)]=_0x153f67,_0x3d40e4['readAsDataURL'](_0x1ada3e);});}return console['log'](_0x248d3e(0x7d9)),{'imageUrl':_0x4e8e3b,'fullPrompt':_0x59b445};}function _0x378780(_0x340d83){const _0x37b683=_0x239c7d,_0x2f58f3=_0x2400cd();if(!_0x340d83||!_0x4c8b14[_0x37b683(0xbea)][_0x340d83])return console[_0x37b683(0x1e6)](_0x37b683(0xc26)),{'positive':_0x2f58f3[_0x37b683(0x1697)],'negative':_0x2f58f3[_0x37b683(0x530)],'source':'system'};const _0x222777=_0x4c8b14[_0x37b683(0xbea)][_0x340d83],_0x3d2053=_0x222777['settings']['naiSettings']||{};return _0x3d2053[_0x37b683(0x830)]===_0x37b683(0x2cc)?(console['log'](_0x37b683(0xf2c)),console[_0x37b683(0x1e6)](_0x37b683(0x2ac),_0x3d2053[_0x37b683(0x318)]||'(空)'),console['log'](_0x37b683(0x591),_0x3d2053[_0x37b683(0x11dd)]||_0x37b683(0xf95)),{'positive':_0x3d2053['characterPositivePrompt']||'','negative':_0x3d2053[_0x37b683(0x11dd)]||'','source':_0x37b683(0x2cc)}):(console[_0x37b683(0x1e6)](_0x37b683(0xd3d)),console['log'](_0x37b683(0x2ac),_0x2f58f3[_0x37b683(0x1697)]||_0x37b683(0xf95)),console[_0x37b683(0x1e6)]('\x20\x20\x20负面:',_0x2f58f3[_0x37b683(0x530)]||_0x37b683(0xf95)),{'positive':_0x2f58f3[_0x37b683(0x1697)],'negative':_0x2f58f3['default_negative'],'source':_0x37b683(0xaf6)});}async function _0x9a6288(){const _0x4de529=_0x239c7d,_0xdf912f=document[_0x4de529(0x400)](_0x4de529(0x1570))[_0x4de529(0xa1e)]['trim'](),_0x26e3c9=document['getElementById'](_0x4de529(0x355))['value'],_0x147476=document[_0x4de529(0x400)]('nai-test-prompt')[_0x4de529(0xa1e)][_0x4de529(0xb8f)]();if(!_0xdf912f){alert(_0x4de529(0x127b));return;}if(!_0x147476){alert('请输入提示词！');return;}const _0xf01c9=_0x2400cd(),_0xebe179=document[_0x4de529(0x400)](_0x4de529(0xe83))['value'][_0x4de529(0xb8f)](),_0x50855d=document['getElementById'](_0x4de529(0x61e)),_0x56c80d=document[_0x4de529(0x400)](_0x4de529(0x271)),_0x5a4745=document[_0x4de529(0x400)](_0x4de529(0x16a6)),_0x4cc5c2=document[_0x4de529(0x400)](_0x4de529(0x900));_0x50855d[_0x4de529(0xa00)][_0x4de529(0xb1a)]=_0x4de529(0x1181),_0x56c80d['style'][_0x4de529(0xb1a)]='none',_0x5a4745[_0x4de529(0xa00)][_0x4de529(0xb1a)]='none',_0x4cc5c2[_0x4de529(0x366)]=!![],_0x4cc5c2['textContent']=_0x4de529(0x987);try{const [_0x48eb99,_0x581828]=_0xf01c9[_0x4de529(0xe33)][_0x4de529(0x5ad)]('x')['map'](Number);let _0xd5f62f;_0x26e3c9[_0x4de529(0xd1b)]('nai-diffusion-4')?_0xd5f62f={'input':_0x147476,'model':_0x26e3c9,'action':_0x4de529(0xdb8),'parameters':{'params_version':0x3,'width':_0x48eb99,'height':_0x581828,'scale':_0xf01c9[_0x4de529(0x507)],'sampler':_0xf01c9[_0x4de529(0x924)],'steps':_0xf01c9[_0x4de529(0x108f)],'seed':_0xf01c9[_0x4de529(0xc76)]===-0x1?Math[_0x4de529(0x1381)](Math[_0x4de529(0x12bc)]()*0x2540be3ff):_0xf01c9[_0x4de529(0xc76)],'n_samples':0x1,'ucPreset':_0xf01c9[_0x4de529(0xc68)],'qualityToggle':_0xf01c9[_0x4de529(0x5e1)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x4de529(0x12b5),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x147476,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0xebe179,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0xebe179,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0xd5f62f={'input':_0x147476,'model':_0x26e3c9,'action':'generate','parameters':{'width':_0x48eb99,'height':_0x581828,'scale':_0xf01c9['cfg_scale'],'sampler':_0xf01c9[_0x4de529(0x924)],'steps':_0xf01c9[_0x4de529(0x108f)],'seed':_0xf01c9[_0x4de529(0xc76)]===-0x1?Math[_0x4de529(0x1381)](Math['random']()*0x2540be3ff):_0xf01c9[_0x4de529(0xc76)],'n_samples':0x1,'ucPreset':_0xf01c9['uc_preset'],'qualityToggle':_0xf01c9['quality_toggle'],'sm':_0xf01c9[_0x4de529(0x46b)],'sm_dyn':_0xf01c9[_0x4de529(0x5de)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x4de529(0xe0b),'negative_prompt':_0xebe179}};console[_0x4de529(0x1e6)](_0x4de529(0xccb)),console[_0x4de529(0x1e6)](_0x4de529(0x13fb),_0x26e3c9),console[_0x4de529(0x1e6)](_0x4de529(0x1269),JSON[_0x4de529(0xea5)](_0xd5f62f,null,0x2));let _0x1196f1;_0x26e3c9['includes'](_0x4de529(0x8b6))?_0x1196f1=_0x4de529(0x10f8):_0x1196f1=_0x4de529(0xc3a);let _0x817b63=_0xf01c9[_0x4de529(0x4d8)];_0x817b63===_0x4de529(0x7da)&&(_0x817b63=_0xf01c9[_0x4de529(0x6af)]||'');_0x817b63&&_0x817b63!==''&&(_0x1196f1=_0x817b63+encodeURIComponent(_0x1196f1));const _0x3f4608=/Chrome/[_0x4de529(0x2c0)](navigator[_0x4de529(0x89e)])&&!/Edg/['test'](navigator[_0x4de529(0x89e)]);let _0x3766bf={'method':_0x4de529(0x953),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0xdf912f},'body':JSON[_0x4de529(0xea5)](_0xd5f62f)};if(_0x3f4608){console[_0x4de529(0x1e6)](_0x4de529(0xc37));const _0x572317={};for(const [_0xa9df3,_0x2fac09]of Object[_0x4de529(0x9de)](_0x3766bf[_0x4de529(0x451)])){_0x572317[_0xa9df3]=_0x2fac09[_0x4de529(0xe19)](/[^\x00-\xFF]/g,'');}_0x3766bf[_0x4de529(0x451)]=_0x572317;}const _0x24f2fa=await fetch(_0x1196f1,_0x3766bf);console['log'](_0x4de529(0x637),_0x24f2fa[_0x4de529(0x12c3)]),console[_0x4de529(0x1e6)](_0x4de529(0xade),[..._0x24f2fa['headers']['entries']()]);if(!_0x24f2fa['ok']){const _0x9de4ff=await _0x24f2fa[_0x4de529(0x117f)]();console['error'](_0x4de529(0x1221),_0x9de4ff);throw new Error(_0x4de529(0x167e)+_0x24f2fa[_0x4de529(0x12c3)]+_0x4de529(0x29e)+_0x9de4ff);}const _0x12f626=_0x24f2fa['headers'][_0x4de529(0xf48)](_0x4de529(0x255));console[_0x4de529(0x1e6)](_0x4de529(0x1174),_0x12f626);let _0x1a37e7;if(_0x12f626&&_0x12f626[_0x4de529(0xd1b)](_0x4de529(0x996))){console['log']('检测到\x20SSE\x20流式响应，开始解析...'),_0x50855d[_0x4de529(0xde7)]='正在接收流式数据...';const _0x96cc95=await _0x24f2fa['text']();console[_0x4de529(0x1e6)]('收到\x20SSE\x20数据，大小:',_0x96cc95['length']);const _0x1a4b69=_0x96cc95[_0x4de529(0xb8f)]()[_0x4de529(0x5ad)]('\x0a');let _0xc247=null;for(let _0x48c608=_0x1a4b69[_0x4de529(0x8d6)]-0x1;_0x48c608>=0x0;_0x48c608--){const _0x44d877=_0x1a4b69[_0x48c608][_0x4de529(0xb8f)]();if(_0x44d877[_0x4de529(0xbb9)]('data:\x20')&&_0x44d877!==_0x4de529(0x290)){const _0x35cb9c=_0x44d877[_0x4de529(0x371)](0x6);try{const _0x276522=JSON[_0x4de529(0x13f7)](_0x35cb9c);if(_0x276522[_0x4de529(0x10cb)]===_0x4de529(0x158b)&&_0x276522[_0x4de529(0xf86)]){_0xc247=_0x276522[_0x4de529(0xf86)],console[_0x4de529(0x1e6)]('✅\x20找到\x20final\x20事件的图片数据');break;}if(_0x276522['data']){_0xc247=_0x276522[_0x4de529(0x55b)],console[_0x4de529(0x1e6)](_0x4de529(0x97b));break;}if(_0x276522[_0x4de529(0xf86)]){_0xc247=_0x276522[_0x4de529(0xf86)],console[_0x4de529(0x1e6)](_0x4de529(0x418));break;}}catch(_0x49bd02){_0xc247=_0x35cb9c,console[_0x4de529(0x1e6)](_0x4de529(0x7a5));break;}}}if(!_0xc247)throw new Error(_0x4de529(0x309));const _0x3acf37=_0xc247['startsWith'](_0x4de529(0x1646)),_0x5eefe=_0xc247['startsWith']('/9j/');if(_0x3acf37||_0x5eefe){console['log'](_0x4de529(0x10b0));const _0x4c639d=atob(_0xc247),_0xca661b=new Uint8Array(_0x4c639d[_0x4de529(0x8d6)]);for(let _0xd6750=0x0;_0xd6750<_0x4c639d[_0x4de529(0x8d6)];_0xd6750++){_0xca661b[_0xd6750]=_0x4c639d[_0x4de529(0xd17)](_0xd6750);}const _0x5f12a6=new Blob([_0xca661b],{'type':_0x3acf37?_0x4de529(0x1443):_0x4de529(0x12d5)});console[_0x4de529(0x1e6)](_0x4de529(0x802),_0x5f12a6['size']);const _0x34376c=URL['createObjectURL'](_0x5f12a6);document[_0x4de529(0x400)](_0x4de529(0x27f))[_0x4de529(0x912)]=_0x34376c,_0x50855d[_0x4de529(0xa00)][_0x4de529(0xb1a)]=_0x4de529(0x165b),_0x56c80d['style'][_0x4de529(0xb1a)]=_0x4de529(0x1181),console[_0x4de529(0x1e6)](_0x4de529(0x921));return;}console[_0x4de529(0x1e6)](_0x4de529(0x994));const _0x75fd71=atob(_0xc247),_0x1d4bb0=new Uint8Array(_0x75fd71['length']);for(let _0x32182b=0x0;_0x32182b<_0x75fd71[_0x4de529(0x8d6)];_0x32182b++){_0x1d4bb0[_0x32182b]=_0x75fd71[_0x4de529(0xd17)](_0x32182b);}_0x1a37e7=new Blob([_0x1d4bb0]),console[_0x4de529(0x1e6)](_0x4de529(0x434),_0x1a37e7[_0x4de529(0x9e8)]);}else _0x1a37e7=await _0x24f2fa[_0x4de529(0xf6d)](),console[_0x4de529(0x1e6)](_0x4de529(0xd37),_0x1a37e7[_0x4de529(0xbbf)],_0x4de529(0x24e),_0x1a37e7[_0x4de529(0x9e8)]);try{if(typeof JSZip===_0x4de529(0xd30))throw new Error(_0x4de529(0x79c));_0x50855d[_0x4de529(0xde7)]=_0x4de529(0x914);const _0x2db898=await JSZip['loadAsync'](_0x1a37e7);console[_0x4de529(0x1e6)](_0x4de529(0x137c),Object[_0x4de529(0x1161)](_0x2db898[_0x4de529(0x780)]));let _0x239b54=null;for(let _0x530d6b in _0x2db898['files']){if(_0x530d6b[_0x4de529(0xbf7)](/\.(png|jpg|jpeg|webp)$/i)){_0x239b54=_0x2db898[_0x4de529(0x780)][_0x530d6b],console[_0x4de529(0x1e6)](_0x4de529(0xf04),_0x530d6b);break;}}if(!_0x239b54)throw new Error('ZIP文件中未找到图片');const _0x17fb46=await _0x239b54[_0x4de529(0xb87)]('blob');console[_0x4de529(0x1e6)](_0x4de529(0x1df),_0x17fb46[_0x4de529(0x9e8)]);const _0x4e8605=URL[_0x4de529(0xc2c)](_0x17fb46);console['log'](_0x4de529(0x139f),_0x4e8605),document[_0x4de529(0x400)]('nai-result-image')['src']=_0x4e8605,_0x50855d[_0x4de529(0xa00)][_0x4de529(0xb1a)]=_0x4de529(0x165b),_0x56c80d[_0x4de529(0xa00)]['display']=_0x4de529(0x1181);}catch(_0xa02103){console[_0x4de529(0x5d7)](_0x4de529(0x13a5),_0xa02103),console['log'](_0x4de529(0x7d1));if(_0x1a37e7[_0x4de529(0xbbf)][_0x4de529(0xbb9)](_0x4de529(0xa43))){const _0x311cc6=URL[_0x4de529(0xc2c)](_0x1a37e7);document[_0x4de529(0x400)](_0x4de529(0x27f))[_0x4de529(0x912)]=_0x311cc6,_0x50855d[_0x4de529(0xa00)]['display']=_0x4de529(0x165b),_0x56c80d[_0x4de529(0xa00)][_0x4de529(0xb1a)]=_0x4de529(0x1181);}else throw new Error(_0x4de529(0x1316)+_0xa02103['message']);}}catch(_0x4a6bcb){console[_0x4de529(0x5d7)](_0x4de529(0x128c),_0x4a6bcb),_0x50855d[_0x4de529(0xa00)][_0x4de529(0xb1a)]='none',_0x5a4745['style']['display']=_0x4de529(0x1181),_0x5a4745[_0x4de529(0xde7)]=_0x4de529(0x1209)+_0x4a6bcb[_0x4de529(0x6e2)];}finally{_0x4cc5c2['disabled']=![],_0x4cc5c2[_0x4de529(0xde7)]=_0x4de529(0x8d8);}}function _0x301fc2(_0x40df54,_0x3f2a77){const _0x357da4=_0x239c7d;_0x4c601e(),clearTimeout(_0x482310);const _0xbceb4e=_0x4c8b14['chats'][_0x40df54];if(!_0xbceb4e)return;const _0x1ac035=document['getElementById'](_0x357da4(0x84e));document[_0x357da4(0x400)](_0x357da4(0x7e3))[_0x357da4(0x912)]=_0xbceb4e[_0x357da4(0xa37)][_0x357da4(0xb24)]||_0xbceb4e['settings'][_0x357da4(0x465)]||_0x91d058,document['getElementById'](_0x357da4(0x7df))['querySelector'](_0x357da4(0xb66))[_0x357da4(0xde7)]=_0xbceb4e[_0x357da4(0xf3e)],document[_0x357da4(0x400)](_0x357da4(0x7df))[_0x357da4(0x13ef)](_0x357da4(0xca6))[_0x357da4(0xde7)]=_0x3f2a77,_0x1ac035[_0x357da4(0xb08)][_0x357da4(0xc46)](_0x357da4(0x9eb)),void _0x1ac035['offsetWidth'],_0x1ac035[_0x357da4(0xb08)]['add']('visible');const _0x479a29=_0x1ac035[_0x357da4(0xdbc)](!![]);_0x1ac035['parentNode'][_0x357da4(0xf6f)](_0x479a29,_0x1ac035),_0x479a29['addEventListener']('click',()=>{const _0x49fba7=_0x357da4;_0xdcfd59(_0x40df54),_0x479a29[_0x49fba7(0xb08)]['remove'](_0x49fba7(0x9eb));}),_0x482310=setTimeout(()=>{const _0x25435d=_0x357da4;_0x479a29[_0x25435d(0xb08)][_0x25435d(0xc46)](_0x25435d(0x9eb));},0xfa0),_0x2acd39();}function _0x1c881b(){const _0x3b5e3c=_0x239c7d,_0x41566e=new Date(),_0x348bce=_0x41566e[_0x3b5e3c(0x1306)](_0x3b5e3c(0x1271),{'hour':_0x3b5e3c(0x9f5),'minute':_0x3b5e3c(0x9f5)}),_0x2ef412=_0x41566e[_0x3b5e3c(0x1100)](_0x3b5e3c(0x1271),{'weekday':_0x3b5e3c(0x1638),'month':_0x3b5e3c(0x1638),'day':_0x3b5e3c(0x1368)});document['getElementById']('status-bar-time')[_0x3b5e3c(0xde7)]=_0x348bce;}function _0x57a22a(_0x2eaf80){const _0x32dced=_0x239c7d;if(!_0x2eaf80)return[{'type':_0x32dced(0x117f),'content':_0x32dced(0x66f)}];let _0x3c3042=_0x2eaf80['trim']();const _0x5cc6a7=/```json\s*([\s\S]*?)\s*```/,_0x602013=_0x3c3042['match'](_0x5cc6a7);_0x602013&&_0x602013[0x1]&&(_0x3c3042=_0x602013[0x1][_0x32dced(0xb8f)](),console[_0x32dced(0x1e6)]('解析器：已启用\x20Markdown\x20提取模式。'));if(_0x3c3042[_0x32dced(0xbb9)]('[')&&_0x3c3042['endsWith'](']'))try{const _0x4cf2f6=JSON['parse'](_0x3c3042);if(Array['isArray'](_0x4cf2f6))return console[_0x32dced(0x1e6)](_0x32dced(0x15cb)),_0x4cf2f6;}catch(_0x389cfa){console[_0x32dced(0x75e)](_0x32dced(0x7ed));}const _0x174554=_0x3c3042[_0x32dced(0xd53)]('['),_0x46e13e=_0x3c3042['lastIndexOf']('}');if(_0x174554!==-0x1&&_0x46e13e!==-0x1&&_0x46e13e>_0x174554){const _0x355474=_0x3c3042[_0x32dced(0xd53)](']',_0x46e13e);if(_0x355474!==-0x1){const _0x5f59ba=_0x3c3042['substring'](_0x174554,_0x355474+0x1);try{const _0x220c29=JSON[_0x32dced(0x13f7)](_0x5f59ba);if(Array[_0x32dced(0x16a1)](_0x220c29))return console[_0x32dced(0x1e6)](_0x32dced(0x12ec)),_0x220c29;}catch(_0x4e0952){console['warn']('强力提取\x20[\x20...\x20}\x20...\x20]\x20失败，将尝试提取单个对象...');}}}const _0x34ea0a=_0x3c3042[_0x32dced(0xbf7)](/{[^{}]*}/g);if(_0x34ea0a){const _0x4470ea=[];for(const _0x29de23 of _0x34ea0a){try{const _0x486f7c=JSON[_0x32dced(0x13f7)](_0x29de23);_0x4470ea[_0x32dced(0x6bb)](_0x486f7c);}catch(_0x20c45d){console[_0x32dced(0x75e)](_0x32dced(0x11c6),_0x29de23);}}if(_0x4470ea['length']>0x0)return console[_0x32dced(0x1e6)](_0x32dced(0xdf4)),_0x4470ea;}return console[_0x32dced(0x5d7)](_0x32dced(0xe00),_0x2eaf80),[{'type':'text','content':_0x2eaf80}];}function _0x2d7bdc(_0x2032c1=new Date()){const _0x37c581=_0x239c7d,_0x2ca1a0=_0x2032c1[_0x37c581(0x331)]();if(_0x2ca1a0>=0x0&&_0x2ca1a0<0x5)return'凌晨';else{if(_0x2ca1a0>=0x5&&_0x2ca1a0<0x9)return'早上';else{if(_0x2ca1a0>=0x9&&_0x2ca1a0<0xd)return'上午';else{if(_0x2ca1a0>=0xd&&_0x2ca1a0<0x12)return'下午';else{if(_0x2ca1a0>=0x12&&_0x2ca1a0<0x18)return'晚上';}}}}return'现在';}async function _0x1a7173(){const _0x362fab=_0x239c7d,_0x5dfcd7=document['getElementById'](_0x362fab(0x12f3));_0x5dfcd7[_0x362fab(0x1575)]='<option\x20value=\x22current\x22>当前配置\x20(未保存)</option>';const _0x1d5e9c=await _0x54c587[_0x362fab(0xbab)][_0x362fab(0xce1)]();_0x1d5e9c[_0x362fab(0xbdc)](_0x397585=>{const _0xf29962=_0x362fab,_0x548417=document['createElement']('option');_0x548417[_0xf29962(0xa1e)]=_0x397585['id'],_0x548417[_0xf29962(0xde7)]=_0x397585[_0xf29962(0xf3e)],_0x5dfcd7['appendChild'](_0x548417);});const _0x432369=_0x4c8b14[_0x362fab(0x814)];let _0x2bc0b0=null;for(const _0x145c40 of _0x1d5e9c){if(_0x145c40[_0x362fab(0x625)]===_0x432369['proxyUrl']&&_0x145c40['apiKey']===_0x432369[_0x362fab(0x9cf)]&&_0x145c40[_0x362fab(0xea4)]===_0x432369[_0x362fab(0xea4)]&&_0x145c40['secondaryProxyUrl']===_0x432369[_0x362fab(0x12ee)]&&_0x145c40[_0x362fab(0x888)]===_0x432369[_0x362fab(0x888)]&&_0x145c40[_0x362fab(0xa22)]===_0x432369[_0x362fab(0xa22)]&&(_0x145c40[_0x362fab(0x34d)]||'')===(_0x432369['minimaxGroupId']||'')&&(_0x145c40['minimaxApiKey']||'')===(_0x432369[_0x362fab(0x10c2)]||'')&&(_0x145c40['minimaxModel']||_0x362fab(0x37c))===(_0x432369['minimaxModel']||_0x362fab(0x37c))){_0x2bc0b0=_0x145c40['id'];break;}}_0x2bc0b0?_0x5dfcd7['value']=_0x2bc0b0:_0x5dfcd7[_0x362fab(0xa1e)]=_0x362fab(0x3a1);}async function _0x3d2638(){const _0x5925a7=_0x239c7d,_0x232295=document[_0x5925a7(0x400)](_0x5925a7(0x12f3)),_0x5c5aa2=parseInt(_0x232295[_0x5925a7(0xa1e)]);if(isNaN(_0x5c5aa2))return;const _0x862ebd=await _0x54c587[_0x5925a7(0xbab)][_0x5925a7(0xf48)](_0x5c5aa2);_0x862ebd&&(_0x4c8b14[_0x5925a7(0x814)]={'id':'main','proxyUrl':_0x862ebd[_0x5925a7(0x625)],'apiKey':_0x862ebd[_0x5925a7(0x9cf)],'model':_0x862ebd[_0x5925a7(0xea4)],'secondaryProxyUrl':_0x862ebd[_0x5925a7(0x12ee)],'secondaryApiKey':_0x862ebd[_0x5925a7(0x888)],'secondaryModel':_0x862ebd[_0x5925a7(0xa22)],'minimaxGroupId':_0x862ebd[_0x5925a7(0x34d)],'minimaxApiKey':_0x862ebd['minimaxApiKey'],'minimaxModel':_0x862ebd[_0x5925a7(0xa09)]},await _0x54c587[_0x5925a7(0x814)][_0x5925a7(0x4cb)](_0x4c8b14[_0x5925a7(0x814)]),_0x44a077(),document[_0x5925a7(0x400)](_0x5925a7(0xd6d))['click'](),_0x862ebd['secondaryProxyUrl']&&_0x862ebd['secondaryApiKey']&&document['getElementById'](_0x5925a7(0xf01))[_0x5925a7(0x15ad)](),alert('已加载预设\x20“'+_0x862ebd[_0x5925a7(0xf3e)]+'”'));}async function _0x28beac(){const _0xc488af=_0x239c7d,_0x4fbb86=await _0x25f61f(_0xc488af(0x2e5),_0xc488af(0x103a));if(!_0x4fbb86||!_0x4fbb86['trim']())return;const _0x32760b={'name':_0x4fbb86[_0xc488af(0xb8f)](),'proxyUrl':document[_0xc488af(0x400)](_0xc488af(0x1222))['value']['trim'](),'apiKey':document['getElementById']('api-key')[_0xc488af(0xa1e)][_0xc488af(0xb8f)](),'model':document[_0xc488af(0x400)]('model-select')[_0xc488af(0xa1e)],'secondaryProxyUrl':document[_0xc488af(0x400)]('secondary-proxy-url')[_0xc488af(0xa1e)][_0xc488af(0xb8f)](),'secondaryApiKey':document['getElementById'](_0xc488af(0x165d))[_0xc488af(0xa1e)][_0xc488af(0xb8f)](),'secondaryModel':document[_0xc488af(0x400)](_0xc488af(0xe82))[_0xc488af(0xa1e)],'minimaxGroupId':document['getElementById'](_0xc488af(0xf23))[_0xc488af(0xa1e)][_0xc488af(0xb8f)](),'minimaxApiKey':document[_0xc488af(0x400)](_0xc488af(0xb00))[_0xc488af(0xa1e)][_0xc488af(0xb8f)](),'minimaxModel':document[_0xc488af(0x400)](_0xc488af(0xacc))[_0xc488af(0xa1e)]},_0x19e11c=await _0x54c587[_0xc488af(0xbab)][_0xc488af(0x227)](_0xc488af(0xf3e))['equals'](_0x32760b['name'])[_0xc488af(0x149c)]();if(_0x19e11c){const _0x24616f=await _0x56d4d3(_0xc488af(0xfbe),_0xc488af(0x6b7)+_0x32760b[_0xc488af(0xf3e)]+_0xc488af(0x7a1),{'confirmButtonClass':_0xc488af(0x142c)});if(!_0x24616f)return;_0x32760b['id']=_0x19e11c['id'];}await _0x54c587[_0xc488af(0xbab)][_0xc488af(0x4cb)](_0x32760b),await _0x1a7173(),alert(_0xc488af(0x1663));}async function _0x5e6814(){const _0x5012a0=_0x239c7d,_0x2e174a=document[_0x5012a0(0x400)]('api-preset-select'),_0x5b1973=parseInt(_0x2e174a['value']);if(isNaN(_0x5b1973)){alert(_0x5012a0(0x7f8));return;}const _0xa4b133=await _0x54c587[_0x5012a0(0xbab)][_0x5012a0(0xf48)](_0x5b1973);if(!_0xa4b133)return;const _0x3bf399=await _0x56d4d3('删除预设',_0x5012a0(0x152b)+_0xa4b133[_0x5012a0(0xf3e)]+_0x5012a0(0xb38),{'confirmButtonClass':'btn-danger'});_0x3bf399&&(await _0x54c587['apiPresets'][_0x5012a0(0x942)](_0x5b1973),await _0x1a7173(),alert(_0x5012a0(0x79a)));}function _0x44a077(){const _0x3d19a7=_0x239c7d;document[_0x3d19a7(0x400)](_0x3d19a7(0x1222))[_0x3d19a7(0xa1e)]=_0x4c8b14[_0x3d19a7(0x814)]['proxyUrl']||'',document[_0x3d19a7(0x400)](_0x3d19a7(0x106d))[_0x3d19a7(0xa1e)]=_0x4c8b14[_0x3d19a7(0x814)][_0x3d19a7(0x9cf)]||'',document['getElementById'](_0x3d19a7(0x15a5))[_0x3d19a7(0xa1e)]=_0x4c8b14[_0x3d19a7(0x814)]['secondaryProxyUrl']||'',document[_0x3d19a7(0x400)](_0x3d19a7(0x165d))[_0x3d19a7(0xa1e)]=_0x4c8b14[_0x3d19a7(0x814)][_0x3d19a7(0x888)]||'',document[_0x3d19a7(0x400)](_0x3d19a7(0xde2))[_0x3d19a7(0x6f9)]=_0x4c8b14['globalSettings']['enableBackgroundActivity']||![],document[_0x3d19a7(0x400)](_0x3d19a7(0x1270))['value']=_0x4c8b14[_0x3d19a7(0x14f1)][_0x3d19a7(0xeb0)]||0x3c,document[_0x3d19a7(0x400)](_0x3d19a7(0x5ed))[_0x3d19a7(0xa1e)]=_0x4c8b14[_0x3d19a7(0x14f1)][_0x3d19a7(0x1582)]||0x1,document['getElementById'](_0x3d19a7(0x759))[_0x3d19a7(0x6f9)]=_0x4c8b14[_0x3d19a7(0x14f1)]['enableAiDrawing'],document['getElementById'](_0x3d19a7(0x485))[_0x3d19a7(0xa1e)]=_0x4c8b14[_0x3d19a7(0x14f1)][_0x3d19a7(0x37b)]||0x32,document[_0x3d19a7(0x400)](_0x3d19a7(0x155f))[_0x3d19a7(0xa1e)]=_0x4c8b14['globalSettings'][_0x3d19a7(0x8bd)]||0x1e;const _0x1eacc4=document[_0x3d19a7(0x400)](_0x3d19a7(0xd6b)),_0x1c173a=document[_0x3d19a7(0x400)](_0x3d19a7(0x47a)),_0x1d53c1=_0x4c8b14['globalSettings'][_0x3d19a7(0x216)]||0.8;_0x1eacc4[_0x3d19a7(0xa1e)]=_0x1d53c1,_0x1c173a[_0x3d19a7(0xde7)]=_0x1d53c1,document[_0x3d19a7(0x400)](_0x3d19a7(0xf23))[_0x3d19a7(0xa1e)]=_0x4c8b14[_0x3d19a7(0x814)]['minimaxGroupId']||'',document[_0x3d19a7(0x400)](_0x3d19a7(0xb00))[_0x3d19a7(0xa1e)]=_0x4c8b14['apiConfig'][_0x3d19a7(0x10c2)]||'',document[_0x3d19a7(0x400)](_0x3d19a7(0xacc))[_0x3d19a7(0xa1e)]=_0x4c8b14[_0x3d19a7(0x814)][_0x3d19a7(0xa09)]||_0x3d19a7(0x37c);const _0x203b82=localStorage[_0x3d19a7(0xca2)](_0x3d19a7(0x1329))===_0x3d19a7(0xaea),_0x4a5622=localStorage[_0x3d19a7(0xca2)](_0x3d19a7(0x355))||_0x3d19a7(0x1375),_0x2c55b8=localStorage[_0x3d19a7(0xca2)](_0x3d19a7(0x1570))||'';document[_0x3d19a7(0x400)](_0x3d19a7(0xb43))[_0x3d19a7(0x6f9)]=_0x203b82,document[_0x3d19a7(0x400)](_0x3d19a7(0x355))[_0x3d19a7(0xa1e)]=_0x4a5622,document[_0x3d19a7(0x400)]('novelai-api-key')['value']=_0x2c55b8,document[_0x3d19a7(0x400)](_0x3d19a7(0xbc4))[_0x3d19a7(0xa00)][_0x3d19a7(0xb1a)]=_0x203b82?'block':'none',_0x1a7173(),_0x3b345c();}window[_0x239c7d(0xc4c)]=_0x44a077;async function _0x3b2ae7(){const _0x2a84e0=_0x239c7d,_0x39cb4c=document['getElementById'](_0x2a84e0(0x76a));_0x39cb4c[_0x2a84e0(0x1575)]='';const _0x43f837=await _0x54c587[_0x2a84e0(0xf9b)][_0x2a84e0(0xce1)]();if(_0x43f837[_0x2a84e0(0x8d6)]===0x0){_0x39cb4c[_0x2a84e0(0x1575)]=_0x2a84e0(0xc16);return;}_0x43f837[_0x2a84e0(0xbdc)](_0x2a184d=>{const _0x2732a9=_0x2a84e0,_0x1ea3d8=document[_0x2732a9(0x2c9)](_0x2732a9(0xf8e));_0x1ea3d8[_0x2732a9(0x4e1)]='chat-list-item',_0x1ea3d8[_0x2732a9(0xd61)]['npcId']=_0x2a184d['id'],_0x1ea3d8[_0x2732a9(0x1575)]=_0x2732a9(0x146e)+(_0x2a184d[_0x2732a9(0xa9a)]||_0x1e2f0a)+_0x2732a9(0xe6f)+_0x2a184d[_0x2732a9(0xf3e)]+_0x2732a9(0xeef)+_0x2a184d[_0x2732a9(0x9a2)][_0x2732a9(0x371)](0x0,0x1e)+_0x2732a9(0x86d),_0x1ea3d8['addEventListener'](_0x2732a9(0x15ad),()=>_0x15b8e6(_0x2a184d['id'])),_0x3d4218(_0x1ea3d8,async()=>{await _0x27a6ff(_0x2a184d['id']);}),_0x39cb4c[_0x2732a9(0x8f2)](_0x1ea3d8);});}async function _0x15b8e6(_0x44315e=null){const _0x20b075=_0x239c7d;editingNpcId=_0x44315e;const _0xf44a24=document[_0x20b075(0x400)](_0x20b075(0x136d)),_0x1b4d74=document[_0x20b075(0x400)](_0x20b075(0xe24)),_0x3561e6=document[_0x20b075(0x400)](_0x20b075(0xf0d)),_0x5ca14f=document[_0x20b075(0x400)](_0x20b075(0x1288)),_0x90add1=document['getElementById']('npc-avatar-preview'),_0x3c82d2=document[_0x20b075(0x400)](_0x20b075(0x89c)),_0x5bee8f=document[_0x20b075(0x400)]('npc-group-select'),_0x4b6693=document['getElementById'](_0x20b075(0xd34)),_0x177a04=document['getElementById'](_0x20b075(0x4e5));_0x3c82d2[_0x20b075(0x1575)]='',_0x5bee8f[_0x20b075(0x1575)]=_0x20b075(0xe0e);const _0x4ffa3f=await _0x54c587[_0x20b075(0x985)][_0x20b075(0xce1)]();_0x4ffa3f[_0x20b075(0xbdc)](_0x377d25=>{const _0x3b7dac=_0x20b075,_0x201972=document[_0x3b7dac(0x2c9)](_0x3b7dac(0x1053));_0x201972[_0x3b7dac(0xa1e)]=_0x377d25['id'],_0x201972['textContent']=_0x377d25[_0x3b7dac(0xf3e)],_0x5bee8f[_0x3b7dac(0x8f2)](_0x201972);}),_0x3c82d2[_0x20b075(0x1575)]+=_0x20b075(0x13a8)+(_0x4c8b14[_0x20b075(0x834)][_0x20b075(0xbf3)]||'我')+'\x20(用户)</label>',Object[_0x20b075(0x40a)](_0x4c8b14[_0x20b075(0xbea)])[_0x20b075(0x29d)](_0x1337af=>!_0x1337af[_0x20b075(0xc98)])['forEach'](_0x4a227c=>{const _0x7224a0=_0x20b075;_0x3c82d2[_0x7224a0(0x1575)]+=_0x7224a0(0x77d)+_0x4a227c['id']+'\x22>\x20'+_0x4a227c[_0x7224a0(0xf3e)]+_0x7224a0(0xd39);});if(_0x44315e){_0x1b4d74[_0x20b075(0xde7)]=_0x20b075(0x141a);const _0x1a8631=await _0x54c587[_0x20b075(0xf9b)][_0x20b075(0xf48)](_0x44315e);_0x1a8631&&(_0x3561e6[_0x20b075(0xa1e)]=_0x1a8631[_0x20b075(0xf3e)],_0x5ca14f['value']=_0x1a8631[_0x20b075(0x9a2)],_0x90add1[_0x20b075(0x912)]=_0x1a8631[_0x20b075(0xa9a)]||_0x1e2f0a,_0x4b6693[_0x20b075(0x6f9)]=_0x1a8631['enableBackgroundActivity']!==![],_0x177a04[_0x20b075(0xa1e)]=_0x1a8631['actionCooldownMinutes']||0xf,_0x5bee8f[_0x20b075(0xa1e)]=_0x1a8631[_0x20b075(0x677)]||'',_0x1a8631[_0x20b075(0xc04)]&&Array[_0x20b075(0x16a1)](_0x1a8631['associatedWith'])&&_0x1a8631[_0x20b075(0xc04)]['forEach'](_0x26a5b8=>{const _0x13b853=_0x20b075,_0xdea8ea=_0x3c82d2['querySelector']('input[value=\x22'+_0x26a5b8+'\x22]');if(_0xdea8ea)_0xdea8ea[_0x13b853(0x6f9)]=!![];}));}else{_0x1b4d74['textContent']=_0x20b075(0x258),_0x3561e6[_0x20b075(0xa1e)]='',_0x5ca14f[_0x20b075(0xa1e)]='',_0x90add1[_0x20b075(0x912)]=_0x1e2f0a,_0x4b6693[_0x20b075(0x6f9)]=!![],_0x177a04['value']=0xf,_0x5bee8f[_0x20b075(0xa1e)]='';const _0x54ad73=_0x3c82d2[_0x20b075(0x13ef)]('input[value=\x22user\x22]');if(_0x54ad73)_0x54ad73['checked']=!![];}_0xf44a24[_0x20b075(0xb08)][_0x20b075(0x12b6)](_0x20b075(0x9eb));}async function _0x3c1a69(){const _0x179d6c=_0x239c7d,_0x582bcf=document['getElementById'](_0x179d6c(0xf0d))[_0x179d6c(0xa1e)][_0x179d6c(0xb8f)](),_0x1c824a=document['getElementById'](_0x179d6c(0x1288))[_0x179d6c(0xa1e)][_0x179d6c(0xb8f)]();if(!_0x582bcf||!_0x1c824a){alert(_0x179d6c(0x8bb));return;}const _0x304f3a=Array['from'](document['querySelectorAll'](_0x179d6c(0x14a0)))[_0x179d6c(0xd18)](_0x129c1d=>_0x129c1d[_0x179d6c(0xa1e)]),_0x1c20be=document[_0x179d6c(0x400)](_0x179d6c(0xd34))[_0x179d6c(0x6f9)],_0x2f9424=parseInt(document[_0x179d6c(0x400)]('npc-action-cooldown-input')[_0x179d6c(0xa1e)])||0xf,_0x1c36c7=parseInt(document[_0x179d6c(0x400)](_0x179d6c(0x12d0))[_0x179d6c(0xa1e)])||null,_0x24414d={'name':_0x582bcf,'persona':_0x1c824a,'avatar':document[_0x179d6c(0x400)](_0x179d6c(0x122e))[_0x179d6c(0x912)],'associatedWith':_0x304f3a,'enableBackgroundActivity':_0x1c20be,'actionCooldownMinutes':_0x2f9424,'npcGroupId':_0x1c36c7};if(editingNpcId)await _0x54c587[_0x179d6c(0xf9b)][_0x179d6c(0x126d)](editingNpcId,_0x24414d);else{const _0x20e1f2=await _0x54c587[_0x179d6c(0xf9b)][_0x179d6c(0x12b6)](_0x24414d);if(_0x1c09b0&&_0x4c8b14[_0x179d6c(0x1539)]){const _0x435179=_0x4c8b14[_0x179d6c(0xbea)][_0x4c8b14[_0x179d6c(0x1539)]];_0x435179[_0x179d6c(0xc98)]&&(_0x435179[_0x179d6c(0x4f8)][_0x179d6c(0x6bb)]({'id':_0x179d6c(0x1530)+_0x20e1f2,'originalName':_0x582bcf,'groupNickname':_0x582bcf,'persona':_0x1c824a,'avatar':_0x24414d[_0x179d6c(0xa9a)],'isNpc':!![]}),await _0x54c587[_0x179d6c(0xbea)][_0x179d6c(0x4cb)](_0x435179));}}document[_0x179d6c(0x400)]('npc-editor-modal')[_0x179d6c(0xb08)][_0x179d6c(0xc46)](_0x179d6c(0x9eb)),_0x1c09b0?(_0x1c09b0=![],_0x1a19aa()):await _0x3b2ae7();}async function _0x362fd9(){const _0x2482a2=_0x239c7d;await _0x39be44(),document['getElementById'](_0x2482a2(0xc09))[_0x2482a2(0xb08)]['add'](_0x2482a2(0x9eb));}async function _0x39be44(){const _0x400c41=_0x239c7d,_0x5a268f=document[_0x400c41(0x400)](_0x400c41(0xda0)),_0x4a0736=await _0x54c587[_0x400c41(0x985)][_0x400c41(0xce1)]();_0x5a268f[_0x400c41(0x1575)]='',_0x4a0736[_0x400c41(0x8d6)]===0x0&&(_0x5a268f[_0x400c41(0x1575)]=_0x400c41(0xe8f)),_0x4a0736['forEach'](_0x1f6bea=>{const _0x20126e=_0x400c41,_0xa106ed=document[_0x20126e(0x2c9)]('div');_0xa106ed['className']='existing-group-item',_0xa106ed[_0x20126e(0x1575)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x1f6bea[_0x20126e(0xf3e)]+_0x20126e(0xaed)+_0x1f6bea['id']+_0x20126e(0x159d),_0x5a268f[_0x20126e(0x8f2)](_0xa106ed);});}async function _0x3d33b5(){const _0x2c3aa2=_0x239c7d,_0xe25cb3=document['getElementById'](_0x2c3aa2(0x168b)),_0x202c5a=_0xe25cb3['value']['trim']();if(!_0x202c5a){alert(_0x2c3aa2(0x1601));return;}const _0xa32e9e=await _0x54c587[_0x2c3aa2(0x985)]['where']('name')[_0x2c3aa2(0x4ce)](_0x202c5a)[_0x2c3aa2(0x149c)]();if(_0xa32e9e){alert('分组\x20\x22'+_0x202c5a+'\x22\x20已经存在了！');return;}await _0x54c587[_0x2c3aa2(0x985)][_0x2c3aa2(0x12b6)]({'name':_0x202c5a}),_0xe25cb3[_0x2c3aa2(0xa1e)]='',await _0x39be44();}async function _0x460523(_0x1a464d){const _0x4f1e83=_0x239c7d,_0x3cc132=await _0x56d4d3(_0x4f1e83(0x713),_0x4f1e83(0x1173),{'confirmButtonClass':_0x4f1e83(0x142c)});_0x3cc132&&(await _0x54c587['npcGroups']['delete'](_0x1a464d),await _0x54c587[_0x4f1e83(0xf9b)][_0x4f1e83(0x227)](_0x4f1e83(0x677))[_0x4f1e83(0x4ce)](_0x1a464d)['modify']({'npcGroupId':null}),await _0x39be44());}async function _0x27a6ff(_0xe6782f){const _0x2228ae=_0x239c7d,_0x1a8de3=await _0x54c587[_0x2228ae(0xf9b)][_0x2228ae(0xf48)](_0xe6782f);if(!_0x1a8de3)return;const _0x258059=await _0x56d4d3(_0x2228ae(0xa4a),_0x2228ae(0xcf7)+_0x1a8de3['name']+_0x2228ae(0xb38),{'confirmButtonClass':_0x2228ae(0x142c)});_0x258059&&(await _0x54c587[_0x2228ae(0xf9b)][_0x2228ae(0x942)](_0xe6782f),await _0x3b2ae7());}let _0xbe2dc3=0x0;function _0x5087e4(_0x1196fe){const _0x358f58=_0x239c7d,_0x584fe9=document[_0x358f58(0x2c9)]('div');return _0x584fe9['className']='chat-group-container',_0x584fe9['innerHTML']=_0x358f58(0x1400)+_0x1196fe[_0x358f58(0xf3e)]+_0x358f58(0x1458),_0x584fe9;}function _0x30b607(_0x3aeb11){const _0x11ded7=_0x239c7d,_0x220631=document[_0x11ded7(0x400)](_0x11ded7(0x931)),_0x5d008f=document['getElementById'](_0x11ded7(0x1138));if(_0x5d008f)_0x5d008f[_0x11ded7(0xc46)]();const _0x3cec1b=_0xbe2dc3,_0x152661=_0xbe2dc3+CHAT_LIST_RENDER_WINDOW,_0x48435f=_0x3aeb11[_0x11ded7(0x69f)](_0x3cec1b,_0x152661),_0x5de0c3=document['createDocumentFragment']();let _0x1ef040=_0x220631[_0x11ded7(0x13ef)](_0x11ded7(0x26e));_0x48435f[_0x11ded7(0xbdc)](_0x94e0b=>{const _0x5867a1=_0x11ded7;if(_0x94e0b[_0x5867a1(0xbbf)]===_0x5867a1(0x11af)){const _0x40c9ec=_0x5087e4(_0x94e0b[_0x5867a1(0x1377)]);_0x5de0c3[_0x5867a1(0x8f2)](_0x40c9ec),_0x1ef040=_0x40c9ec[_0x5867a1(0x13ef)](_0x5867a1(0x1445));}else{if(_0x94e0b['type']==='chatItem'){const _0x7177d=_0x431050(_0x94e0b[_0x5867a1(0x4e3)]);_0x1ef040&&_0x94e0b[_0x5867a1(0x4e3)][_0x5867a1(0x1145)]?_0x1ef040[_0x5867a1(0x8f2)](_0x7177d):(_0x5de0c3[_0x5867a1(0x8f2)](_0x7177d),_0x1ef040=null);}}}),_0x220631['appendChild'](_0x5de0c3),_0xbe2dc3+=_0x48435f[_0x11ded7(0x8d6)],_0x3aeb11[_0x11ded7(0x8d6)]>_0xbe2dc3&&_0xff8d49(_0x220631,_0x3aeb11),document[_0x11ded7(0x527)]('.chat-group-header')[_0x11ded7(0xbdc)](_0x1db4ae=>{const _0x303129=_0x11ded7,_0x392b6a=_0x1db4ae['cloneNode'](!![]);_0x1db4ae[_0x303129(0xa54)]['replaceChild'](_0x392b6a,_0x1db4ae),_0x392b6a[_0x303129(0x501)](_0x303129(0x15ad),()=>{const _0xb2ec4c=_0x303129;_0x392b6a[_0xb2ec4c(0xb08)][_0xb2ec4c(0x146f)](_0xb2ec4c(0x102e)),_0x392b6a[_0xb2ec4c(0x5fe)]['classList'][_0xb2ec4c(0x146f)](_0xb2ec4c(0x102e));});});}async function _0x41b828(){const _0x5725cd=_0x239c7d,_0x53365d=document['getElementById'](_0x5725cd(0x931));_0x53365d[_0x5725cd(0x1575)]='';const _0x3bab60=Object['values'](_0x4c8b14[_0x5725cd(0xbea)])['sort']((_0x4dd634,_0x1cebbb)=>{const _0x5e32a0=_0x5725cd,_0x530918=(_0x1cebbb['isPinned']||![])-(_0x4dd634['isPinned']||![]);if(_0x530918!==0x0)return _0x530918;return(_0x1cebbb[_0x5e32a0(0x92c)]['slice'](-0x1)[0x0]?.[_0x5e32a0(0x287)]||0x0)-(_0x4dd634[_0x5e32a0(0x92c)]['slice'](-0x1)[0x0]?.[_0x5e32a0(0x287)]||0x0);}),_0x2b7290=await _0x54c587['qzoneGroups'][_0x5725cd(0xce1)]();if(_0x3bab60[_0x5725cd(0x8d6)]===0x0){_0x53365d['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20或群组图标添加聊天</p>';return;}_0x2b7290[_0x5725cd(0xbdc)](_0x1d1dc8=>{const _0x4d368d=_0x5725cd,_0x790305=_0x3bab60[_0x4d368d(0x821)](_0x17864b=>_0x17864b[_0x4d368d(0x1145)]===_0x1d1dc8['id']);_0x1d1dc8[_0x4d368d(0x9c9)]=_0x790305?_0x790305[_0x4d368d(0x92c)][_0x4d368d(0x69f)](-0x1)[0x0]?.[_0x4d368d(0x287)]||0x0:0x0;}),_0x2b7290[_0x5725cd(0x968)]((_0x378784,_0x319f82)=>_0x319f82[_0x5725cd(0x9c9)]-_0x378784[_0x5725cd(0x9c9)]),_0x57f2ed=[];const _0x2b220d=new Set();_0x3bab60[_0x5725cd(0xbdc)](_0x5ed523=>{const _0x5d7cff=_0x5725cd;_0x5ed523['isPinned']&&(_0x57f2ed[_0x5d7cff(0x6bb)]({'type':_0x5d7cff(0x122a),'chat':_0x5ed523}),_0x2b220d['add'](_0x5ed523['id']));}),_0x2b7290[_0x5725cd(0xbdc)](_0x3fbe94=>{const _0x578392=_0x5725cd,_0x4b3f69=_0x3bab60[_0x578392(0x29d)](_0x52bcfe=>!_0x52bcfe[_0x578392(0x1509)]&&!_0x52bcfe[_0x578392(0xc98)]&&_0x52bcfe[_0x578392(0x1145)]===_0x3fbe94['id']);_0x4b3f69[_0x578392(0x8d6)]>0x0&&(_0x57f2ed[_0x578392(0x6bb)]({'type':_0x578392(0x11af),'group':_0x3fbe94}),_0x4b3f69[_0x578392(0xbdc)](_0x41db52=>{const _0x518932=_0x578392;_0x57f2ed[_0x518932(0x6bb)]({'type':'chatItem','chat':_0x41db52}),_0x2b220d[_0x518932(0x12b6)](_0x41db52['id']);}));}),_0x3bab60[_0x5725cd(0xbdc)](_0x4bee62=>{const _0x352ec5=_0x5725cd;!_0x2b220d[_0x352ec5(0x3e3)](_0x4bee62['id'])&&(_0x57f2ed[_0x352ec5(0x6bb)]({'type':_0x352ec5(0x122a),'chat':_0x4bee62}),_0x2b220d['add'](_0x4bee62['id']));}),_0xbe2dc3=0x0,_0x30b607();}function _0x5087e4(_0x300607){const _0x3f4db6=_0x239c7d,_0x1a5fb5=document[_0x3f4db6(0x2c9)]('div');return _0x1a5fb5['className']=_0x3f4db6(0xce6),_0x1a5fb5[_0x3f4db6(0x1575)]=_0x3f4db6(0x12b8)+_0x300607[_0x3f4db6(0xf3e)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1a5fb5;}function _0xff8d49(_0x5e71fc,_0x5b8066){const _0x42abc9=_0x239c7d,_0x2fbd3e=document[_0x42abc9(0x2c9)](_0x42abc9(0x99b));_0x2fbd3e['id']='load-more-chats-btn',_0x2fbd3e['textContent']=_0x42abc9(0xaa5),_0x2fbd3e[_0x42abc9(0x4e1)]='load-more-btn',_0x2fbd3e['addEventListener']('click',()=>_0x30b607(_0x5b8066),{'once':!![]}),_0x5e71fc['prepend'](_0x2fbd3e);}function _0x30b607(){const _0x704df5=_0x239c7d;if(_0x83fa86)return;const _0x4cac55=document[_0x704df5(0x400)](_0x704df5(0x931)),_0x3ec1e7=document[_0x704df5(0x400)]('messages-view');if(!_0x4cac55||!_0x3ec1e7)return;if(_0xbe2dc3>=_0x57f2ed[_0x704df5(0x8d6)])return;_0x83fa86=!![];const _0x455e07=_0xbe2dc3===0x0,_0x146cb2=()=>{const _0x18a6bf=_0x704df5;_0x42da12(_0x4cac55);const _0x404667=_0x4c8b14[_0x18a6bf(0x14f1)]['chatListRenderWindow']||0x1e,_0x84a5e2=_0xbe2dc3,_0x242428=_0xbe2dc3+_0x404667,_0xe524d3=_0x57f2ed[_0x18a6bf(0x69f)](_0x84a5e2,_0x242428),_0x26c5bc=document[_0x18a6bf(0xf74)]();let _0x39fc0a=_0x4cac55[_0x18a6bf(0x13ef)](_0x18a6bf(0x26e));_0xe524d3[_0x18a6bf(0xbdc)](_0x3adc2c=>{const _0x4ae7c3=_0x18a6bf;if(_0x3adc2c[_0x4ae7c3(0xbbf)]===_0x4ae7c3(0x11af)){const _0x4274c2=_0x5087e4(_0x3adc2c[_0x4ae7c3(0x1377)]);_0x26c5bc['appendChild'](_0x4274c2),_0x39fc0a=_0x4274c2[_0x4ae7c3(0x13ef)](_0x4ae7c3(0x1445));}else{if(_0x3adc2c[_0x4ae7c3(0xbbf)]===_0x4ae7c3(0x122a)){const _0x1b1296=_0x431050(_0x3adc2c[_0x4ae7c3(0x4e3)]);if(_0x3adc2c[_0x4ae7c3(0x4e3)]['groupId']&&_0x39fc0a)_0x39fc0a['appendChild'](_0x1b1296);else{_0x26c5bc[_0x4ae7c3(0x8f2)](_0x1b1296);if(!_0x3adc2c['chat'][_0x4ae7c3(0x1145)])_0x39fc0a=null;}}}}),_0x4cac55[_0x18a6bf(0x8f2)](_0x26c5bc),_0xbe2dc3+=_0xe524d3[_0x18a6bf(0x8d6)],_0x4cac55[_0x18a6bf(0x527)](_0x18a6bf(0x157d))[_0x18a6bf(0xbdc)](_0x375c15=>{const _0xf4984b=_0x18a6bf;_0x375c15[_0xf4984b(0xd61)][_0xf4984b(0x556)]='true',_0x375c15[_0xf4984b(0x501)](_0xf4984b(0x15ad),()=>{const _0x894089=_0xf4984b;_0x375c15['classList'][_0x894089(0x146f)](_0x894089(0x102e)),_0x375c15['nextElementSibling'][_0x894089(0xb08)][_0x894089(0x146f)](_0x894089(0x102e));});}),_0x83fa86=![],_0x3ec1e7[_0x18a6bf(0xe0d)]<=_0x3ec1e7[_0x18a6bf(0x433)]&&_0xbe2dc3<_0x57f2ed['length']&&_0x30b607();};_0x455e07?_0x146cb2():(_0x3a43dd(_0x4cac55,_0x704df5(0xa69)),setTimeout(_0x146cb2,0x1f4));}function _0x431050(_0x416850){const _0x363c7b=_0x239c7d;try{const _0x5d31ef=_0x416850[_0x363c7b(0x92c)]['filter'](_0x24bc37=>!_0x24bc37['isHidden'])[_0x363c7b(0x69f)](-0x1)[0x0]||{};let _0x5ab52c;if(!_0x416850[_0x363c7b(0xc98)]&&_0x416850[_0x363c7b(0x12f7)]?.[_0x363c7b(0x12c3)]===_0x363c7b(0x101f))_0x5ab52c=_0x363c7b(0x589)+(_0x416850['relationship'][_0x363c7b(0x275)]||_0x363c7b(0x3d6))+_0x363c7b(0x21f);else{if(!_0x416850[_0x363c7b(0xc98)]&&_0x416850['relationship']?.[_0x363c7b(0x12c3)]==='blocked_by_ai')_0x5ab52c=_0x363c7b(0x4e6);else{if(_0x416850['isGroup']){if(_0x5d31ef[_0x363c7b(0xbbf)]==='pat_message')_0x5ab52c=_0x363c7b(0xc38)+_0x5d31ef[_0x363c7b(0x1109)];else{if(_0x5d31ef[_0x363c7b(0xbbf)]===_0x363c7b(0x112f))_0x5ab52c=_0x363c7b(0xf92);else{if(_0x5d31ef[_0x363c7b(0xbbf)]===_0x363c7b(0xea7)||_0x5d31ef[_0x363c7b(0xbbf)]===_0x363c7b(0xdf3))_0x5ab52c=_0x363c7b(0x8df);else{if(_0x5d31ef[_0x363c7b(0xbbf)]==='voice_message')_0x5ab52c=_0x363c7b(0xe09);else{if(typeof _0x5d31ef[_0x363c7b(0x1109)]===_0x363c7b(0x158f)&&_0x12f2a0[_0x363c7b(0x2c0)](_0x5d31ef[_0x363c7b(0x1109)]))_0x5ab52c=_0x5d31ef['meaning']?_0x363c7b(0x84c)+_0x5d31ef[_0x363c7b(0xca4)]+']':_0x363c7b(0x450);else Array['isArray'](_0x5d31ef[_0x363c7b(0x1109)])?_0x5ab52c=_0x363c7b(0x5d3):_0x5ab52c=String(_0x5d31ef['content']||_0x363c7b(0x166b))[_0x363c7b(0x371)](0x0,0x14);}}}}if(_0x5d31ef[_0x363c7b(0x3e7)]&&_0x5d31ef[_0x363c7b(0xbbf)]!==_0x363c7b(0xaa4)){const _0xf8d4d6=_0x288d80(_0x416850,_0x5d31ef[_0x363c7b(0x3e7)]);_0x5ab52c=_0xf8d4d6+':\x20'+_0x5ab52c;}}else{const _0x28d14f=_0x416850['status']?.[_0x363c7b(0x117f)]||'在线';_0x5ab52c='['+_0x28d14f+']';}}}const _0x2e9c2e=document[_0x363c7b(0x2c9)]('div');_0x2e9c2e[_0x363c7b(0x4e1)]=_0x363c7b(0xc19),_0x2e9c2e['dataset']['chatId']=_0x416850['id'];_0x416850[_0x363c7b(0x1509)]&&_0x2e9c2e[_0x363c7b(0xb08)][_0x363c7b(0x12b6)]('pinned');const _0x5c4fbf=_0x416850[_0x363c7b(0xc98)]?_0x416850['settings'][_0x363c7b(0x465)]:_0x416850[_0x363c7b(0xa37)][_0x363c7b(0xb24)],_0x24d8e1=_0x416850[_0x363c7b(0xc98)]?'':_0x416850['settings']['aiAvatarFrame']||'';let _0x540341;_0x24d8e1?_0x540341=_0x363c7b(0x1620)+(_0x5c4fbf||_0x91d058)+_0x363c7b(0x39b)+_0x24d8e1+_0x363c7b(0x69d):_0x540341=_0x363c7b(0x97d)+(_0x5c4fbf||_0x91d058)+'\x22\x20class=\x22avatar\x22>';const _0x251611=_0x24d8e1?_0x363c7b(0x5e5):'',_0x52d947='<div\x20class=\x22avatar-group\x20'+_0x251611+'\x22>'+_0x540341+'</div>';_0x2e9c2e[_0x363c7b(0x1575)]=_0x363c7b(0xc43)+_0x52d947+_0x363c7b(0x82e)+_0x416850[_0x363c7b(0xf3e)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x416850['isGroup']?_0x363c7b(0xe45):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22\x20style=\x22color:\x20'+(_0x416850[_0x363c7b(0xc98)]?'var(--text-secondary)':_0x363c7b(0x783))+_0x363c7b(0x11bd)+_0x5ab52c+_0x363c7b(0xeb9);const _0x5498a1=_0x416850[_0x363c7b(0x73c)]||0x0,_0x5335a5=_0x2e9c2e['querySelector'](_0x363c7b(0xddd));_0x5498a1>0x0?(_0x5335a5['textContent']=_0x5498a1>0x63?_0x363c7b(0x529):_0x5498a1,_0x5335a5[_0x363c7b(0xa00)][_0x363c7b(0xb1a)]=_0x363c7b(0x274)):_0x5335a5['style'][_0x363c7b(0xb1a)]=_0x363c7b(0x165b);const _0x3b401d=_0x2e9c2e[_0x363c7b(0x13ef)](_0x363c7b(0x41a));_0x3b401d&&(_0x3b401d['style'][_0x363c7b(0x214)]=_0x363c7b(0x1293),_0x3b401d['addEventListener'](_0x363c7b(0x148c),_0x42c0a7=>{const _0x533ea8=_0x363c7b;_0x42c0a7[_0x533ea8(0x504)]();const _0x4d0e53=_0x416850[_0x533ea8(0xc98)]?_0x416850['name']:_0x416850['originalName'];_0x34b720(_0x416850['id'],_0x4d0e53);}));const _0x22654d=_0x2e9c2e['querySelector'](_0x363c7b(0xa8c));return _0x22654d&&_0x22654d['addEventListener']('click',()=>_0xdcfd59(_0x416850['id'])),_0x3d4218(_0x2e9c2e,async _0x252b0b=>{const _0x48b47f=_0x363c7b,_0x382819=await _0x100b20(_0x416850);switch(_0x382819){case'pin':_0x416850[_0x48b47f(0x1509)]=!_0x416850[_0x48b47f(0x1509)],await _0x54c587['chats'][_0x48b47f(0x4cb)](_0x416850),_0x41b828();break;case _0x48b47f(0x942):const _0x19237d=await _0x56d4d3(_0x48b47f(0x459),_0x48b47f(0xc82)+_0x416850[_0x48b47f(0xf3e)]+_0x48b47f(0xd9b),{'confirmButtonClass':_0x48b47f(0x142c)});if(_0x19237d){_0x59adb2['isActive']&&_0x59adb2[_0x48b47f(0x1539)]===_0x416850['id']&&await _0x1beebd(![]);delete _0x4c8b14[_0x48b47f(0xbea)][_0x416850['id']];if(_0x4c8b14['activeChatId']===_0x416850['id'])_0x4c8b14[_0x48b47f(0x1539)]=null;await _0x54c587[_0x48b47f(0xbea)]['delete'](_0x416850['id']),_0x41b828();}break;default:break;}}),_0x2e9c2e;}catch(_0x4d19bb){return console[_0x363c7b(0x5d7)](_0x363c7b(0xe4d)+(_0x416850[_0x363c7b(0xf3e)]||'未知')+_0x363c7b(0x142e)+_0x416850['id']+_0x363c7b(0x1498),_0x4d19bb),null;}}async function _0x26354c(_0x49e8f3){const _0x125263=_0x239c7d;_0x31c703(),_0x508f6();const _0xd8dcf5=_0x4c8b14[_0x125263(0xbea)][_0x49e8f3];if(!_0xd8dcf5)return;_0x4e7c87();const _0x4410c1=document[_0x125263(0x400)]('chat-messages'),_0x48d998=document[_0x125263(0x400)](_0x125263(0x1146)),_0x3e1472=document['getElementById']('chat-lock-overlay'),_0x4d783f=document[_0x125263(0x400)]('chat-lock-content');_0x4410c1['dataset']['theme']=_0xd8dcf5[_0x125263(0xa37)][_0x125263(0xa33)]||'default';const _0x5267af=_0xd8dcf5[_0x125263(0xa37)][_0x125263(0xfe3)]||0xd;_0x4410c1[_0x125263(0xa00)][_0x125263(0x132a)](_0x125263(0x82b),_0x5267af+'px'),_0x701933(_0xd8dcf5['settings'][_0x125263(0xc4d)]||'',_0x125263(0x1372),_0x125263(0x2d0)),document[_0x125263(0x400)](_0x125263(0x1429))[_0x125263(0xde7)]=_0xd8dcf5[_0x125263(0xf3e)];const _0x48ea22=document[_0x125263(0x400)](_0x125263(0x1003)),_0xa83b=_0x48ea22[_0x125263(0x13ef)](_0x125263(0x11aa));_0xd8dcf5[_0x125263(0xc98)]?(_0x48ea22[_0x125263(0xa00)][_0x125263(0xb1a)]='none',document['getElementById'](_0x125263(0x838))['style'][_0x125263(0x14eb)]=_0x125263(0x1287)):(_0x48ea22['style']['display']=_0x125263(0x375),document[_0x125263(0x400)](_0x125263(0x838))[_0x125263(0xa00)][_0x125263(0x14eb)]=_0x125263(0x1139),_0xa83b[_0x125263(0xde7)]=_0xd8dcf5[_0x125263(0x12c3)]?.[_0x125263(0x117f)]||'在线',_0x48ea22[_0x125263(0xb08)][_0x125263(0x146f)](_0x125263(0x1f0),_0xd8dcf5[_0x125263(0x12c3)]?.[_0x125263(0x6db)]||![]));const _0x504426=document[_0x125263(0x400)](_0x125263(0x946)),_0xf30158=_0xd8dcf5[_0x125263(0xa37)][_0x125263(0x81e)],_0x308b58=_0x4c8b14[_0x125263(0x14f1)][_0x125263(0xf8c)],_0x37bfe1=document[_0x125263(0x400)](_0x125263(0x43a))[_0x125263(0xb08)][_0x125263(0xd3f)]('dark-mode'),_0x4831f7=_0x37bfe1?_0x125263(0x15a9):_0x125263(0x126f);if(_0xf30158)_0x504426[_0x125263(0xa00)][_0x125263(0xf11)]=_0x125263(0xe21)+_0xf30158+')',_0x504426['style'][_0x125263(0x1296)]='transparent';else _0x308b58?(_0x504426[_0x125263(0xa00)]['backgroundImage']=_0x125263(0xe21)+_0x308b58+')',_0x504426[_0x125263(0xa00)][_0x125263(0x1296)]=_0x125263(0x1470)):(_0x504426[_0x125263(0xa00)][_0x125263(0xf11)]='none',_0x504426['style'][_0x125263(0x1296)]=_0x4831f7);if(_0xd8dcf5[_0x125263(0x157b)])_0x48d998['style']['display']='none',_0x3e1472[_0x125263(0xa00)][_0x125263(0xb1a)]='flex',_0x4d783f['innerHTML']=_0x125263(0xd31),document['getElementById'](_0x125263(0xb3c))['onclick']=_0x51117d;else{_0x48d998[_0x125263(0xa00)]['display']=_0x125263(0x375),_0x3e1472[_0x125263(0xa00)]['display']=_0x125263(0x165b),_0x4d783f['innerHTML']='';if(!_0xd8dcf5['isGroup']&&_0xd8dcf5[_0x125263(0x12f7)]['status']!==_0x125263(0x1290)){_0x3e1472['style']['display']=_0x125263(0x375),_0x48d998[_0x125263(0xa00)][_0x125263(0xabd)]=_0x125263(0x8c3);let _0xd52e39='';switch(_0xd8dcf5[_0x125263(0x12f7)]['status']){case _0x125263(0x15ea):const _0x534563=_0x53caff!==null,_0x1c467b=_0xd8dcf5[_0x125263(0x12f7)][_0x125263(0x1199)],_0x16908f=_0x4c8b14[_0x125263(0x14f1)][_0x125263(0x1582)]||0x1,_0x25299a=_0x16908f*0x3c*0x3c*0x3e8,_0x329f3c=Date[_0x125263(0xecd)]()-_0x1c467b,_0x40a480=_0x329f3c>_0x25299a,_0x3c0a60=Math[_0x125263(0x124e)](0x0,Math[_0x125263(0x94b)]((_0x25299a-_0x329f3c)/(0x3e8*0x3c)));_0xd52e39=_0x125263(0xa5b)+_0xd8dcf5['name']+_0x125263(0x1079)+(_0x4c8b14[_0x125263(0x14f1)][_0x125263(0x3c4)]?'<span\x20style=\x22color:\x20green;\x22>已开启</span>':'<span\x20style=\x22color:\x20red;\x22>已关闭</span>')+_0x125263(0xfd5)+(_0x534563?_0x125263(0x70c):'<span\x20style=\x22color:\x20red;\x22>未运行</span>')+_0x125263(0xb69)+_0xd8dcf5[_0x125263(0x12f7)][_0x125263(0x12c3)]+_0x125263(0x8d5)+_0x16908f+_0x125263(0x997)+(_0x40a480?_0x125263(0x15d4):_0x125263(0xec0)+_0x3c0a60+_0x125263(0x736))+_0x125263(0x5bc)+(_0x40a480&&_0x4c8b14[_0x125263(0x14f1)][_0x125263(0x3c4)]?_0x125263(0x4e2):_0x125263(0x5a0))+_0x125263(0x43e);break;case _0x125263(0x11a5):_0xd52e39='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你被对方拉黑了。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22apply-friend-btn\x22\x20class=\x22lock-action-btn\x22>重新申请加为好友</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';break;case'pending_user_approval':_0xd52e39=_0x125263(0x153a)+_0xd8dcf5[_0x125263(0xf3e)]+_0x125263(0xd0f)+_0xd8dcf5[_0x125263(0x12f7)]['applicationReason']+_0x125263(0x1275);break;case _0x125263(0x59d):_0xd52e39=_0x125263(0xbd7);break;}_0x4d783f[_0x125263(0x1575)]=_0xd52e39;}else _0x3e1472[_0x125263(0xa00)]['display']=_0x125263(0x165b),_0x48d998['style'][_0x125263(0xabd)]=_0x125263(0x9eb);}_0x4410c1[_0x125263(0x1575)]='';const _0x1f002b=_0xd8dcf5[_0x125263(0x92c)];_0x4e5ab7=0x0;const _0x53d6e1=_0x4c8b14['globalSettings'][_0x125263(0x37b)]||0x32,_0x2b650f=_0x1f002b[_0x125263(0x69f)](-_0x53d6e1),_0xb8f0fb=document[_0x125263(0xf74)]();let _0x5c4e08=0x0;for(const _0x39ac32 of _0x2b650f){!_0x39ac32[_0x125263(0x118c)]&&(_0x5c4e08>0x0&&_0x39ac32['timestamp']-_0x5c4e08>0x927c0&&_0xb8f0fb[_0x125263(0x8f2)](_0xad544c(_0x39ac32[_0x125263(0x287)])),_0x5c4e08=_0x39ac32['timestamp']);const _0x10e187=await _0x43c5e5(_0x39ac32,_0xd8dcf5,!![]);_0x10e187&&_0xb8f0fb[_0x125263(0x8f2)](_0x10e187);}_0x4410c1[_0x125263(0x8f2)](_0xb8f0fb),_0x4e5ab7=_0x2b650f[_0x125263(0x8d6)];const _0xff297b=document['createElement'](_0x125263(0xf8e));_0xff297b['id']=_0x125263(0x77f),_0xff297b[_0x125263(0xa00)][_0x125263(0xb1a)]='none',_0xff297b[_0x125263(0xde7)]=_0x125263(0xd9d),_0x4410c1[_0x125263(0x8f2)](_0xff297b);const _0x54ebf2=_0x4410c1[_0x125263(0x527)](_0x125263(0x14ef)),_0x339c1b=[];_0x54ebf2[_0x125263(0xbdc)](_0x330c5e=>{const _0x5bef1c=_0x125263;!_0x330c5e[_0x5bef1c(0xd97)]&&_0x339c1b[_0x5bef1c(0x6bb)](new Promise(_0x4d65e1=>{const _0x701c35=_0x5bef1c;_0x330c5e[_0x701c35(0x9e0)]=_0x4d65e1,_0x330c5e['onerror']=_0x4d65e1;}));}),Promise[_0x125263(0x875)](_0x339c1b)[_0x125263(0xa8b)](()=>{const _0x476b86=_0x125263;_0x4410c1['scrollTop']=_0x4410c1[_0x476b86(0xe0d)],console['log'](_0x476b86(0x848));})['catch'](_0x239948=>{const _0x1d7998=_0x125263;console[_0x1d7998(0x5d7)](_0x1d7998(0x11e5),_0x239948),_0x4410c1[_0x1d7998(0x125c)]=_0x4410c1[_0x1d7998(0xe0d)];}),setTimeout(()=>_0x4410c1['scrollTop']=_0x4410c1[_0x125263(0xe0d)],0x0);}async function _0x14354e(){const _0x248f87=_0x239c7d;if(_0x35d11e)return;_0x35d11e=!![];const _0x151643=document[_0x248f87(0x400)](_0x248f87(0x75b)),_0x320afb=_0x4c8b14[_0x248f87(0xbea)][_0x4c8b14[_0x248f87(0x1539)]];if(!_0x320afb){_0x35d11e=![];return;}_0x3a43dd(_0x151643,_0x248f87(0x899));const _0x581604=_0x151643[_0x248f87(0xe0d)];await new Promise(_0x2a3933=>setTimeout(_0x2a3933,0x12c));const _0x4f087b=_0x320afb['history'][_0x248f87(0x8d6)],_0x101693=_0x4c8b14['globalSettings']['chatRenderWindow']||0x32,_0x55a4d9=_0x4f087b-_0x4e5ab7-_0x101693,_0x3e7dc3=_0x4f087b-_0x4e5ab7,_0x513655=_0x320afb[_0x248f87(0x92c)][_0x248f87(0x69f)](Math['max'](0x0,_0x55a4d9),_0x3e7dc3);if(_0x513655[_0x248f87(0x8d6)]===0x0){_0x42da12(_0x151643),_0x35d11e=![];return;}const _0x293257=[];for(const _0x20731d of _0x513655){const _0x4a8752=await _0x43c5e5(_0x20731d,_0x320afb);_0x293257[_0x248f87(0x6bb)](_0x4a8752);}const _0x1ff49e=document['createElement'](_0x248f87(0xf8e));_0x293257[_0x248f87(0x29d)](Boolean)[_0x248f87(0xbdc)](_0x406661=>_0x1ff49e['appendChild'](_0x406661));const _0xe7461=_0x1ff49e[_0x248f87(0x527)](_0x248f87(0x14ef)),_0x36bab2=Array['from'](_0xe7461)[_0x248f87(0x29d)](_0x2f9520=>!_0x2f9520[_0x248f87(0xd97)])[_0x248f87(0xd18)](_0x2c83b0=>new Promise(_0x135bf3=>{const _0x26c004=_0x248f87;_0x2c83b0[_0x26c004(0x9e0)]=_0x135bf3,_0x2c83b0[_0x26c004(0x96d)]=_0x135bf3;}));await Promise[_0x248f87(0x875)](_0x36bab2);const _0x1231f9=document[_0x248f87(0xf74)](),_0x5d415e=_0x151643['querySelector'](_0x248f87(0xd56));let _0x40afa0=_0x5d415e?parseInt(_0x5d415e[_0x248f87(0xd61)]['timestamp']):0x0,_0x205e58=0x0;_0x513655[_0x248f87(0xbdc)]((_0x5a9fda,_0x2d144d)=>{const _0x2628ff=_0x248f87;!_0x5a9fda[_0x2628ff(0x118c)]&&(_0x205e58>0x0&&_0x5a9fda[_0x2628ff(0x287)]-_0x205e58>0x927c0&&_0x1231f9[_0x2628ff(0x8f2)](_0xad544c(_0x5a9fda[_0x2628ff(0x287)])),_0x205e58=_0x5a9fda[_0x2628ff(0x287)]);const _0x4688be=_0x293257[_0x2d144d];_0x4688be&&_0x1231f9[_0x2628ff(0x8f2)](_0x4688be);});_0x40afa0>0x0&&_0x40afa0-_0x205e58>0x927c0&&_0x1231f9[_0x248f87(0x8f2)](_0xad544c(_0x40afa0));_0x42da12(_0x151643),_0x151643[_0x248f87(0x587)](_0x1231f9),_0x4e5ab7+=_0x513655['length'];const _0x4983a6=_0x151643[_0x248f87(0xe0d)];_0x151643[_0x248f87(0x125c)]=_0x4983a6-_0x581604,_0x35d11e=![];}function _0x364d9f(){const _0x6e6115=_0x239c7d;_0x21b2dd(),_0x23006b();const _0xeb6cc7=document[_0x6e6115(0x400)](_0x6e6115(0x4b4)),_0x5b35a8=_0x4c8b14[_0x6e6115(0x14f1)][_0x6e6115(0xed6)];_0x5b35a8?(_0xeb6cc7['style'][_0x6e6115(0xf11)]=_0x6e6115(0xe21)+_0x5b35a8+')',_0xeb6cc7['textContent']=''):(_0xeb6cc7[_0x6e6115(0xa00)]['backgroundImage']=_0x6e6115(0x1569),_0xeb6cc7[_0x6e6115(0xde7)]=_0x6e6115(0x811));const _0xdd67a9=document['getElementById'](_0x6e6115(0xf7a)),_0x346068=_0x4c8b14['globalSettings']['cphoneWallpaper'];_0x346068?(_0xdd67a9['style'][_0x6e6115(0xf11)]='url('+_0x346068+')',_0xdd67a9['textContent']=''):(_0xdd67a9[_0x6e6115(0xa00)][_0x6e6115(0xf11)]=_0x6e6115(0x14fb),_0xdd67a9['textContent']='当前为渐变色');const _0x4d88c0=document['getElementById'](_0x6e6115(0xcdc)),_0x59b4ce=_0x4c8b14[_0x6e6115(0x14f1)][_0x6e6115(0xf8c)];_0x59b4ce?(_0x4d88c0[_0x6e6115(0xa00)][_0x6e6115(0xf11)]=_0x6e6115(0xe21)+_0x59b4ce+')',_0x4d88c0['textContent']='',document[_0x6e6115(0x400)](_0x6e6115(0x6f0))['style'][_0x6e6115(0xb1a)]=_0x6e6115(0x5f8)):(_0x4d88c0[_0x6e6115(0xa00)][_0x6e6115(0xf11)]='none',_0x4d88c0[_0x6e6115(0xde7)]=_0x6e6115(0xb70),document['getElementById'](_0x6e6115(0x6f0))['style'][_0x6e6115(0xb1a)]=_0x6e6115(0x165b)),_0xa88122(),_0xb27ef9(),document['getElementById'](_0x6e6115(0xf42))[_0x6e6115(0xa1e)]=_0x4c8b14[_0x6e6115(0x14f1)][_0x6e6115(0x5e9)]||'',document[_0x6e6115(0x400)](_0x6e6115(0x14c3))[_0x6e6115(0xa1e)]=_0x4c8b14['globalSettings']['notificationSoundUrl']||'',document[_0x6e6115(0x400)](_0x6e6115(0x11f3))[_0x6e6115(0x6f9)]=_0x4c8b14[_0x6e6115(0x14f1)]['showStatusBar']||![],document['getElementById']('phone-frame-toggle-switch')['checked']=_0x4c8b14['globalSettings'][_0x6e6115(0x8cd)]||![],document[_0x6e6115(0x400)]('minimal-chat-ui-switch')[_0x6e6115(0x6f9)]=_0x4c8b14['globalSettings'][_0x6e6115(0x1333)]||![],document[_0x6e6115(0x400)](_0x6e6115(0x83b))[_0x6e6115(0x6f9)]=_0x4c8b14[_0x6e6115(0x14f1)][_0x6e6115(0x57f)]||![],document[_0x6e6115(0x400)](_0x6e6115(0x1404))[_0x6e6115(0x6f9)]=_0x4c8b14[_0x6e6115(0x14f1)]['detachStatusBar']||![],_0x48013a(),_0x1b2e70();}window[_0x239c7d(0x9d2)]=_0x364d9f;function _0x497a54(){const _0x59116d=_0x239c7d,_0x3355d9=document[_0x59116d(0x400)](_0x59116d(0x13b1)),_0x3fdb6c=_0x4c8b14['globalSettings'][_0x59116d(0xed6)];_0x3fdb6c?_0x3355d9[_0x59116d(0xa00)]['backgroundImage']=_0x59116d(0xe21)+_0x3fdb6c+')':_0x3355d9[_0x59116d(0xa00)][_0x59116d(0xf11)]='linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)';}function _0x1ea3fd(_0x35d64a){const _0xf6e1a8=_0x239c7d;document[_0xf6e1a8(0x527)](_0xf6e1a8(0x5b3))[_0xf6e1a8(0xbdc)](_0x313a0e=>{const _0x4a5545=_0xf6e1a8;_0x313a0e[_0x4a5545(0xb08)]['toggle'](_0x4a5545(0x5d6),_0x313a0e['dataset'][_0x4a5545(0x12c4)]===_0x35d64a);}),document['querySelectorAll'](_0xf6e1a8(0x12a7))[_0xf6e1a8(0xbdc)](_0x2e9d93=>{const _0x40f1a5=_0xf6e1a8;_0x2e9d93['classList'][_0x40f1a5(0x146f)](_0x40f1a5(0x5d6),_0x2e9d93[_0x40f1a5(0xd61)]['categoryId']===_0x35d64a);});}async function _0x3db57c(){const _0x517bcd=_0x239c7d,_0x224ad6=document[_0x517bcd(0x400)](_0x517bcd(0x2d3)),_0x1578d5=document[_0x517bcd(0x400)](_0x517bcd(0x1121));_0x224ad6[_0x517bcd(0x1575)]='',_0x1578d5[_0x517bcd(0x1575)]='';const [_0x5d8de6,_0x2c8a93]=await Promise[_0x517bcd(0x875)]([_0x54c587[_0x517bcd(0xf57)]['toArray'](),_0x54c587[_0x517bcd(0x2c3)][_0x517bcd(0x541)](_0x517bcd(0xf3e))[_0x517bcd(0xce1)]()]);_0x4c8b14[_0x517bcd(0xf57)]=_0x5d8de6;if(_0x5d8de6[_0x517bcd(0x8d6)]===0x0){_0x1578d5['innerHTML']=_0x517bcd(0x219);return;}const _0x2dc95b=document[_0x517bcd(0x2c9)](_0x517bcd(0x99b));_0x2dc95b[_0x517bcd(0x4e1)]=_0x517bcd(0x1407),_0x2dc95b[_0x517bcd(0xde7)]='全部',_0x2dc95b[_0x517bcd(0xd61)][_0x517bcd(0x12c4)]=_0x517bcd(0x875),_0x224ad6['appendChild'](_0x2dc95b);const _0x400034=document[_0x517bcd(0x2c9)](_0x517bcd(0xf8e));_0x400034[_0x517bcd(0x4e1)]='world-book-category-pane\x20active',_0x400034[_0x517bcd(0xd61)]['categoryId']=_0x517bcd(0x875),_0x1578d5[_0x517bcd(0x8f2)](_0x400034),_0x2c8a93[_0x517bcd(0xbdc)](_0x386a09=>{const _0xbb914c=_0x517bcd,_0x56344a=document[_0xbb914c(0x2c9)]('button');_0x56344a['className']=_0xbb914c(0x1513),_0x56344a[_0xbb914c(0xde7)]=_0x386a09['name'],_0x56344a[_0xbb914c(0xd61)][_0xbb914c(0x12c4)]=String(_0x386a09['id']),_0x224ad6['appendChild'](_0x56344a);const _0x49eb6c=document[_0xbb914c(0x2c9)](_0xbb914c(0xf8e));_0x49eb6c[_0xbb914c(0x4e1)]=_0xbb914c(0x11d3),_0x49eb6c[_0xbb914c(0xd61)][_0xbb914c(0x12c4)]=String(_0x386a09['id']),_0x1578d5[_0xbb914c(0x8f2)](_0x49eb6c);});const _0x3af9cb=_0x5d8de6[_0x517bcd(0x1412)](_0x4512ef=>!_0x4512ef[_0x517bcd(0x12c4)]);if(_0x3af9cb){const _0x4b7f03=document[_0x517bcd(0x2c9)](_0x517bcd(0x99b));_0x4b7f03[_0x517bcd(0x4e1)]='world-book-tab',_0x4b7f03[_0x517bcd(0xde7)]=_0x517bcd(0xac0),_0x4b7f03[_0x517bcd(0xd61)][_0x517bcd(0x12c4)]=_0x517bcd(0x13c3),_0x224ad6[_0x517bcd(0x8f2)](_0x4b7f03);const _0x11dd39=document[_0x517bcd(0x2c9)](_0x517bcd(0xf8e));_0x11dd39[_0x517bcd(0x4e1)]=_0x517bcd(0x11d3),_0x11dd39['dataset'][_0x517bcd(0x12c4)]=_0x517bcd(0x13c3),_0x1578d5['appendChild'](_0x11dd39);}_0x5d8de6[_0x517bcd(0xbdc)](_0x462bac=>{const _0x3cff4e=_0x517bcd;let _0xd25b19=_0x3cff4e(0x5c8);if(Array[_0x3cff4e(0x16a1)](_0x462bac[_0x3cff4e(0x1109)])&&_0x462bac['content'][_0x3cff4e(0x8d6)]>0x0){const _0x48b0ce=_0x462bac[_0x3cff4e(0x1109)][0x0];_0xd25b19=_0x48b0ce[_0x3cff4e(0x83c)]||_0x48b0ce[_0x3cff4e(0x1109)]||'';}else typeof _0x462bac[_0x3cff4e(0x1109)]==='string'&&_0x462bac[_0x3cff4e(0x1109)]['trim']()!==''&&(_0xd25b19=_0x462bac[_0x3cff4e(0x1109)]);const _0x1b894c=document[_0x3cff4e(0x2c9)]('div');_0x1b894c[_0x3cff4e(0x4e1)]=_0x3cff4e(0x8a8),_0x1b894c['innerHTML']=_0x3cff4e(0x15af)+_0x462bac['name']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>'+_0xd25b19+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x119703=()=>_0x5a8c1e(_0x462bac['id']),_0x46e4e7=async()=>{const _0xff4927=_0x3cff4e,_0x5b6029=await _0x56d4d3('删除世界书',_0xff4927(0xc5f)+_0x462bac[_0xff4927(0xf3e)]+_0xff4927(0xc11),{'confirmButtonClass':_0xff4927(0x142c)});_0x5b6029&&(await _0x54c587[_0xff4927(0xf57)][_0xff4927(0x942)](_0x462bac['id']),_0x4c8b14[_0xff4927(0xf57)]=_0x4c8b14['worldBooks'][_0xff4927(0x29d)](_0x9b8f56=>_0x9b8f56['id']!==_0x462bac['id']),_0x3db57c());};_0x1b894c[_0x3cff4e(0x501)](_0x3cff4e(0x15ad),_0x119703),_0x3d4218(_0x1b894c,_0x46e4e7);const _0x490bab=_0x1b894c[_0x3cff4e(0xdbc)](!![]);_0x490bab[_0x3cff4e(0x501)](_0x3cff4e(0x15ad),_0x119703),_0x3d4218(_0x490bab,_0x46e4e7),_0x400034[_0x3cff4e(0x8f2)](_0x490bab);const _0x166034=_0x462bac[_0x3cff4e(0x12c4)]?String(_0x462bac[_0x3cff4e(0x12c4)]):_0x3cff4e(0x13c3),_0x2f2535=_0x1578d5[_0x3cff4e(0x13ef)]('.world-book-category-pane[data-category-id=\x22'+_0x166034+'\x22]');_0x2f2535&&_0x2f2535[_0x3cff4e(0x8f2)](_0x1b894c);}),document[_0x517bcd(0x527)]('.world-book-tab')[_0x517bcd(0xbdc)](_0x397d60=>{const _0xee8c22=_0x517bcd;_0x397d60['addEventListener'](_0xee8c22(0x15ad),()=>_0x1ea3fd(_0x397d60[_0xee8c22(0xd61)][_0xee8c22(0x12c4)]));});}function _0x2f1449(_0x2cb7b2,_0x2674af){const _0xd990d0=_0x239c7d,_0x260e04=document[_0xd990d0(0x2c9)](_0xd990d0(0xf8e));_0x260e04[_0xd990d0(0x4e1)]=_0xd990d0(0x2cb),_0x260e04[_0xd990d0(0x1575)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x2cb7b2+_0xd990d0(0x36a);const _0x2d0e8b=_0x260e04[_0xd990d0(0x13ef)](_0xd990d0(0xc8d));return _0x2674af['sort']((_0x4326fb,_0x5b3651)=>_0x4326fb['name']['localeCompare'](_0x5b3651['name'],'zh-CN')),_0x2674af[_0xd990d0(0xbdc)](_0x1b5308=>{const _0x2b0092=_0xd990d0;let _0x862a3a=_0x2b0092(0x5c8);if(Array['isArray'](_0x1b5308[_0x2b0092(0x1109)])&&_0x1b5308[_0x2b0092(0x1109)][_0x2b0092(0x8d6)]>0x0){const _0x26104e=_0x1b5308[_0x2b0092(0x1109)][0x0];_0x862a3a=_0x26104e[_0x2b0092(0x83c)]||_0x26104e[_0x2b0092(0x1109)]||'';}else typeof _0x1b5308[_0x2b0092(0x1109)]===_0x2b0092(0x158f)&&_0x1b5308['content']['trim']()!==''&&(_0x862a3a=_0x1b5308[_0x2b0092(0x1109)]);const _0x32e63c=document[_0x2b0092(0x2c9)]('div');_0x32e63c[_0x2b0092(0x4e1)]=_0x2b0092(0x7ef),_0x32e63c[_0x2b0092(0xd61)][_0x2b0092(0x443)]=_0x1b5308['id'],_0x32e63c[_0x2b0092(0x1575)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>'+_0x1b5308[_0x2b0092(0xf3e)]+_0x2b0092(0x454)+String(_0x862a3a)['substring'](0x0,0x32)+_0x2b0092(0x1132),_0x32e63c[_0x2b0092(0x501)](_0x2b0092(0x15ad),()=>_0x5a8c1e(_0x1b5308['id'])),_0x3d4218(_0x32e63c,async()=>{const _0xbe1bfb=_0x2b0092,_0x4c5b4f=await _0x56d4d3('删除世界书',_0xbe1bfb(0xc5f)+_0x1b5308[_0xbe1bfb(0xf3e)]+'》吗？此操作不可撤销。',{'confirmButtonClass':_0xbe1bfb(0x142c)});_0x4c5b4f&&(await _0x54c587[_0xbe1bfb(0xf57)][_0xbe1bfb(0x942)](_0x1b5308['id']),_0x4c8b14[_0xbe1bfb(0xf57)]=_0x4c8b14[_0xbe1bfb(0xf57)][_0xbe1bfb(0x29d)](_0x2d16e9=>_0x2d16e9['id']!==_0x1b5308['id']),_0x3db57c());}),_0x2d0e8b[_0x2b0092(0x8f2)](_0x32e63c);}),_0x260e04;}window[_0x239c7d(0x3d8)]=_0x3db57c;async function _0x5a8c1e(_0x214d0f){const _0x164547=_0x239c7d;_0x257d51(_0x164547(0xb20)),_0x5e8787=_0x214d0f;const [_0x3cac8b,_0x1a445c]=await Promise[_0x164547(0x875)]([_0x54c587[_0x164547(0xf57)]['get'](_0x214d0f),_0x54c587[_0x164547(0x2c3)][_0x164547(0xce1)]()]);if(!_0x3cac8b){console[_0x164547(0x5d7)](_0x164547(0x1075),_0x214d0f),_0x257d51('world-book-screen');return;}document[_0x164547(0x400)](_0x164547(0x15ba))['textContent']=_0x3cac8b[_0x164547(0xf3e)],document['getElementById']('world-book-name-input')[_0x164547(0xa1e)]=_0x3cac8b[_0x164547(0xf3e)];const _0x210280=document[_0x164547(0x400)](_0x164547(0xdbb));_0x210280[_0x164547(0x1575)]=_0x164547(0x620),_0x1a445c[_0x164547(0xbdc)](_0x25f8ea=>{const _0x15fa78=_0x164547,_0x346afa=document[_0x15fa78(0x2c9)]('option');_0x346afa['value']=_0x25f8ea['id'],_0x346afa['textContent']=_0x25f8ea[_0x15fa78(0xf3e)];if(_0x3cac8b[_0x15fa78(0x12c4)]===_0x25f8ea['id'])_0x346afa[_0x15fa78(0x148b)]=!![];_0x210280[_0x15fa78(0x8f2)](_0x346afa);});const _0x50b975=document[_0x164547(0x400)](_0x164547(0x6b1));_0x50b975[_0x164547(0x1575)]='',Array[_0x164547(0x16a1)](_0x3cac8b[_0x164547(0x1109)])&&_0x3cac8b[_0x164547(0x1109)]['length']>0x0?_0x3cac8b[_0x164547(0x1109)][_0x164547(0xbdc)](_0x29ac1d=>{const _0x28ca22=_0x164547,_0x4f6f5d=_0x308c96(_0x29ac1d);_0x50b975[_0x28ca22(0x8f2)](_0x4f6f5d);}):_0x50b975[_0x164547(0x1575)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>';}async function _0x11d8fe(_0x426e8d=!![]){const _0x4f1aa1=_0x239c7d,_0x2d2508=document[_0x4f1aa1(0x400)](_0x4f1aa1(0x8de)),_0x1a4383=document[_0x4f1aa1(0x400)](_0x4f1aa1(0xb9a)),_0x1dc76a=document[_0x4f1aa1(0x400)](_0x4f1aa1(0x13a7)),_0x34098a=_0x1dc76a[_0x4f1aa1(0xa1e)][_0x4f1aa1(0xb8f)]()[_0x4f1aa1(0x1653)]();if(_0x426e8d){_0x1a4383[_0x4f1aa1(0x1575)]='';const _0x3d2562=await _0x54c587['stickerCategories'][_0x4f1aa1(0xce1)]();_0x1a4383[_0x4f1aa1(0x1575)]+=_0x4f1aa1(0x675)+(_0xc6535b===_0x4f1aa1(0x875)?_0x4f1aa1(0x5d6):'')+'\x22\x20data-category-id=\x22all\x22>全部</button>',_0x3d2562['forEach'](_0x43f662=>{const _0x565c50=_0x4f1aa1;_0x1a4383['innerHTML']+=_0x565c50(0x675)+(_0xc6535b===_0x43f662['id']?'active':'')+_0x565c50(0x4cd)+_0x43f662['id']+'\x22>'+_0x43f662[_0x565c50(0xf3e)]+_0x565c50(0x42a);}),_0x1a4383[_0x4f1aa1(0x1575)]+=_0x4f1aa1(0x675)+(_0xc6535b===_0x4f1aa1(0x13c3)?_0x4f1aa1(0x5d6):'')+_0x4f1aa1(0x12e3);}_0x2d2508[_0x4f1aa1(0x1575)]='';let _0x4fe4aa;if(_0xc6535b===_0x4f1aa1(0x875))_0x4fe4aa=_0x4c8b14[_0x4f1aa1(0x120c)];else _0xc6535b==='uncategorized'?_0x4fe4aa=_0x4c8b14['userStickers']['filter'](_0x4c3dc4=>!_0x4c3dc4['categoryId']):_0x4fe4aa=_0x4c8b14[_0x4f1aa1(0x120c)][_0x4f1aa1(0x29d)](_0x575d2e=>_0x575d2e[_0x4f1aa1(0x12c4)]===_0xc6535b);const _0x18df5d=_0x34098a?_0x4fe4aa[_0x4f1aa1(0x29d)](_0x121e8d=>_0x121e8d[_0x4f1aa1(0xf3e)][_0x4f1aa1(0x1653)]()[_0x4f1aa1(0xd1b)](_0x34098a)):_0x4fe4aa;if(_0x18df5d[_0x4f1aa1(0x8d6)]===0x0){const _0x15ca0d=_0x34098a?_0x4f1aa1(0xcb2):_0x4f1aa1(0x12b4);_0x2d2508[_0x4f1aa1(0x1575)]=_0x4f1aa1(0x72f)+_0x15ca0d+_0x4f1aa1(0x1236);return;}_0x18df5d['forEach'](_0x106d2b=>{const _0x5800c5=_0x4f1aa1,_0x1f6465=document[_0x5800c5(0x2c9)](_0x5800c5(0xf8e));_0x1f6465[_0x5800c5(0x4e1)]=_0x5800c5(0x3d1),_0x1f6465[_0x5800c5(0x647)]=_0x106d2b[_0x5800c5(0xf3e)],_0x1f6465[_0x5800c5(0xd61)][_0x5800c5(0x1216)]=_0x106d2b['id'],_0x1f6465['innerHTML']=_0x5800c5(0xc6f)+_0x106d2b['url']+_0x5800c5(0x136e)+_0x106d2b[_0x5800c5(0xf3e)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x1f6465['addEventListener'](_0x5800c5(0x15ad),()=>{_0x4825fd?_0x287a1d(_0x1f6465):_0x3c54cb(_0x106d2b);});const _0x181816=document[_0x5800c5(0x2c9)](_0x5800c5(0xf8e));_0x181816['className']=_0x5800c5(0x1205),_0x181816[_0x5800c5(0x1575)]='&times;',_0x181816['onclick']=async _0x4dc0dc=>{const _0x1bf69f=_0x5800c5;_0x4dc0dc['stopPropagation']();const _0x57e371=await _0x56d4d3('删除表情',_0x1bf69f(0xe80)+_0x106d2b[_0x1bf69f(0xf3e)]+_0x1bf69f(0x394),{'confirmButtonClass':'btn-danger'});_0x57e371&&(await _0x54c587[_0x1bf69f(0x120c)][_0x1bf69f(0x942)](_0x106d2b['id']),_0x4c8b14[_0x1bf69f(0x120c)]=_0x4c8b14[_0x1bf69f(0x120c)][_0x1bf69f(0x29d)](_0xeecfe1=>_0xeecfe1['id']!==_0x106d2b['id']),_0x11d8fe());},_0x1f6465['appendChild'](_0x181816),_0x2d2508[_0x5800c5(0x8f2)](_0x1f6465);});}let _0x4825fd=![],_0x1608ec=new Set(),_0x2b56db=![],_0x1698d6=new Set(),_0x1058d8=[],_0xcd9130=0x0;const _0x353e13=0x2d;let _0x5370c1=![];function _0x1c5590(){const _0x35a927=_0x239c7d;_0x4825fd=!_0x4825fd;const _0x7abd84=document[_0x35a927(0x400)](_0x35a927(0x8de)),_0x3ef5b4=document['getElementById'](_0x35a927(0x6ac)),_0x4fa021=document[_0x35a927(0x400)](_0x35a927(0x1230)),_0x39427b=document[_0x35a927(0x400)]('select-all-stickers-checkbox');_0x7abd84['classList'][_0x35a927(0x146f)](_0x35a927(0x1245),_0x4825fd),_0x4825fd?(_0x3ef5b4['textContent']='完成',_0x4fa021[_0x35a927(0xa00)][_0x35a927(0xb1a)]=_0x35a927(0x375),_0x1608ec[_0x35a927(0x82f)](),_0x39427b[_0x35a927(0x6f9)]=![],_0x47f64a()):(_0x3ef5b4[_0x35a927(0xde7)]='管理',_0x4fa021['style'][_0x35a927(0xb1a)]=_0x35a927(0x165b),_0x7abd84[_0x35a927(0x527)](_0x35a927(0xe43))['forEach'](_0x5c96cf=>_0x5c96cf[_0x35a927(0xb08)]['remove']('selected')));}function _0x3c4e46(){const _0x2b248f=_0x239c7d,_0x5b3136=document[_0x2b248f(0x400)](_0x2b248f(0x10fc)),_0x3c8b4e=_0x5b3136[_0x2b248f(0x6f9)];let _0x4b87f8;if(_0xc6535b==='all')_0x4b87f8=_0x4c8b14['userStickers'];else _0xc6535b===_0x2b248f(0x13c3)?_0x4b87f8=_0x4c8b14[_0x2b248f(0x120c)]['filter'](_0x16b811=>!_0x16b811['categoryId']):_0x4b87f8=_0x4c8b14['userStickers'][_0x2b248f(0x29d)](_0x1071b2=>_0x1071b2[_0x2b248f(0x12c4)]===_0xc6535b);_0x4b87f8['forEach'](_0x318a7c=>{const _0x5bdf7e=_0x2b248f,_0x2fe443=_0x318a7c['id'],_0x194da1=document[_0x5bdf7e(0x13ef)]('.sticker-item[data-sticker-id=\x22'+_0x2fe443+'\x22]');if(_0x3c8b4e){_0x1608ec[_0x5bdf7e(0x12b6)](_0x2fe443);if(_0x194da1)_0x194da1['classList']['add'](_0x5bdf7e(0x148b));}else{_0x1608ec[_0x5bdf7e(0x942)](_0x2fe443);if(_0x194da1)_0x194da1['classList'][_0x5bdf7e(0xc46)](_0x5bdf7e(0x148b));}}),_0x47f64a();}function _0x47f64a(){const _0x4309dd=_0x239c7d,_0x258178=document[_0x4309dd(0x400)](_0x4309dd(0xc13));_0x258178['textContent']='删除\x20('+_0x1608ec[_0x4309dd(0x9e8)]+')';}function _0x287a1d(_0x4db723){const _0x1e6024=_0x239c7d;if(!_0x4825fd)return;const _0x2ebaf3=_0x4db723['dataset'][_0x1e6024(0x1216)];if(!_0x2ebaf3)return;_0x4db723[_0x1e6024(0xb08)][_0x1e6024(0x146f)](_0x1e6024(0x148b)),_0x1608ec['has'](_0x2ebaf3)?_0x1608ec['delete'](_0x2ebaf3):_0x1608ec['add'](_0x2ebaf3),_0x47f64a();}async function _0x4fc106(){const _0xd5b7c0=_0x239c7d;if(_0x1608ec['size']===0x0)return;const _0x3557df=await _0x56d4d3(_0xd5b7c0(0x713),_0xd5b7c0(0x1352)+_0x1608ec[_0xd5b7c0(0x9e8)]+_0xd5b7c0(0x784),{'confirmButtonClass':_0xd5b7c0(0x142c)});if(_0x3557df){const _0xd2091e=[..._0x1608ec];await _0x54c587[_0xd5b7c0(0x120c)][_0xd5b7c0(0x2c6)](_0xd2091e),_0x4c8b14[_0xd5b7c0(0x120c)]=_0x4c8b14[_0xd5b7c0(0x120c)]['filter'](_0x3fdc6d=>!_0xd2091e[_0xd5b7c0(0xd1b)](_0x3fdc6d['id'])),_0x1c5590(),_0x11d8fe(),await _0x138765('删除成功',_0xd5b7c0(0x10c9));}}async function _0x5573f4(){const _0x5443ad=_0x239c7d,_0x3c17aa=_0x5443ad(0x524),_0x3718cf=await _0x25f61f(_0x5443ad(0x100a),_0x3c17aa,'',_0x5443ad(0x79e));_0x3718cf&&_0x3718cf[_0x5443ad(0xb8f)]()&&await _0x35c9ba(_0x3718cf);}async function _0x35c9ba(_0x4afd2e){const _0x4c07f1=_0x239c7d,_0x53ebbf=_0x4afd2e['trim']()['split']('\x0a'),_0x236e03=[],_0x5cf894=_0x4c07f1(0x75d);let _0x5cfba4=0x0;const _0x2ee708=_0xc6535b!==_0x4c07f1(0x875)&&_0xc6535b!==_0x4c07f1(0x13c3)?_0xc6535b:null;for(const _0x7fc6ba of _0x53ebbf){const _0x3f9335=_0x7fc6ba[_0x4c07f1(0xb8f)]();if(!_0x3f9335||_0x3f9335['includes']('填入'))continue;const _0x1acf58=_0x3f9335[_0x4c07f1(0xbf7)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x1acf58){const _0x241972=_0x1acf58[0x1][_0x4c07f1(0xb8f)](),_0x5e779f=_0x1acf58[0x2]['trim']();_0x236e03[_0x4c07f1(0x6bb)]({'id':_0x4c07f1(0xc30)+Date['now']()+Math[_0x4c07f1(0x12bc)](),'name':_0x241972,'url':_0x5e779f,'categoryId':_0x2ee708});continue;}let _0x1c5cb8=null,_0x2ce2d0=null;const _0x4c7d88=_0x3f9335['match'](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x4c7d88)_0x1c5cb8=_0x4c7d88[0x1],_0x2ce2d0=_0x4c7d88[0x2];else{const _0x59b42a=_0x3f9335[_0x4c07f1(0x5ad)](/\s+/);_0x59b42a[_0x4c07f1(0x8d6)]>=0x2&&(_0x2ce2d0=_0x59b42a[_0x4c07f1(0x5ac)](),_0x1c5cb8=_0x59b42a[_0x4c07f1(0xee1)]('\x20'));}_0x1c5cb8&&_0x2ce2d0&&_0x2ce2d0[_0x4c07f1(0xd1b)]('.')?_0x236e03[_0x4c07f1(0x6bb)]({'id':_0x4c07f1(0xc30)+Date[_0x4c07f1(0xecd)]()+Math[_0x4c07f1(0x12bc)](),'name':_0x1c5cb8,'url':_0x5cf894+_0x2ce2d0,'categoryId':_0x2ee708}):(_0x5cfba4++,console[_0x4c07f1(0x75e)](_0x4c07f1(0x14fe),_0x3f9335));}_0x5cfba4>0x0&&await _0x138765(_0x4c07f1(0x13f6),'有\x20'+_0x5cfba4+_0x4c07f1(0x105c));if(_0x236e03[_0x4c07f1(0x8d6)]>0x0)await _0x54c587[_0x4c07f1(0x120c)][_0x4c07f1(0x666)](_0x236e03),_0x4c8b14[_0x4c07f1(0x120c)][_0x4c07f1(0x6bb)](..._0x236e03),_0x11d8fe(),await _0x138765(_0x4c07f1(0xa88),_0x4c07f1(0xe1c)+_0x236e03[_0x4c07f1(0x8d6)]+_0x4c07f1(0x88a));else _0x5cfba4===0x0&&alert(_0x4c07f1(0x13b2));}function _0x51566f(_0x197bac){const _0x71d7de=_0x239c7d,_0x55541f=_0x71d7de(0xfe4)+_0x197bac+'\x22]',_0x25648d=document[_0x71d7de(0x13ef)](_0x55541f);_0x25648d?(_0x25648d[_0x71d7de(0x1499)]({'behavior':_0x71d7de(0x243),'block':_0x71d7de(0x1287)}),_0x25648d[_0x71d7de(0xb08)][_0x71d7de(0x12b6)](_0x71d7de(0x91f)),setTimeout(()=>{const _0x515ab2=_0x71d7de;document[_0x515ab2(0x471)][_0x515ab2(0xd3f)](_0x25648d)&&_0x25648d[_0x515ab2(0xb08)][_0x515ab2(0xc46)]('highlighted');},0x5dc)):alert('找不到原始消息。可能已被删除或位于更早的历史记录中。');}async function _0x43c5e5(_0x21e4d1,_0x3357be){const _0x39b97d=_0x239c7d;if(_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0x94e)){const _0x93e698=document[_0x39b97d(0x2c9)]('div');_0x93e698[_0x39b97d(0x4e1)]=_0x39b97d(0x5b0),_0x93e698[_0x39b97d(0xd61)]['timestamp']=_0x21e4d1['timestamp'];const _0x2653cb=document[_0x39b97d(0x2c9)](_0x39b97d(0xf8e));return _0x2653cb[_0x39b97d(0x4e1)]=_0x39b97d(0x1538),_0x2653cb[_0x39b97d(0xd61)]['timestamp']=_0x21e4d1['timestamp'],_0x2653cb[_0x39b97d(0xde7)]=_0x21e4d1[_0x39b97d(0x1109)],_0x93e698[_0x39b97d(0x8f2)](_0x2653cb),_0x3d4218(_0x93e698,()=>_0x3e5c89(_0x21e4d1[_0x39b97d(0x287)])),_0x93e698[_0x39b97d(0x501)](_0x39b97d(0x15ad),()=>{const _0x562b67=_0x39b97d;_0x51034e&&_0x1f3e50(_0x21e4d1[_0x562b67(0x287)]);}),_0x93e698;}else{if(_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0x301)){const _0x500159=document['createElement'](_0x39b97d(0xf8e));_0x500159['className']='message-wrapper\x20system-pat',_0x500159[_0x39b97d(0xd61)][_0x39b97d(0x287)]=_0x21e4d1[_0x39b97d(0x287)];const _0x4ffacb=document[_0x39b97d(0x2c9)](_0x39b97d(0xf8e));return _0x4ffacb['className']=_0x39b97d(0x105d),_0x4ffacb['dataset'][_0x39b97d(0x2b7)]=_0x21e4d1['postId'],_0x4ffacb['textContent']=_0x21e4d1['content'],_0x500159[_0x39b97d(0x8f2)](_0x4ffacb),_0x3d4218(_0x500159,()=>_0x3e5c89(_0x21e4d1[_0x39b97d(0x287)])),_0x500159[_0x39b97d(0x501)](_0x39b97d(0x15ad),()=>{const _0x759db9=_0x39b97d;_0x51034e&&_0x1f3e50(_0x21e4d1[_0x759db9(0x287)]);}),_0x500159;}}if(_0x21e4d1[_0x39b97d(0x118c)])return null;if(_0x21e4d1[_0x39b97d(0xbbf)]==='pat_message'){const _0x479093=document['createElement'](_0x39b97d(0xf8e));_0x479093['className']=_0x39b97d(0x5b0);const _0x150b12=document[_0x39b97d(0x2c9)]('div');return _0x150b12['className']=_0x39b97d(0xf15),_0x150b12[_0x39b97d(0xd61)][_0x39b97d(0x287)]=_0x21e4d1[_0x39b97d(0x287)],_0x150b12[_0x39b97d(0xde7)]=_0x21e4d1[_0x39b97d(0x1109)],_0x479093[_0x39b97d(0x8f2)](_0x150b12),_0x3d4218(_0x479093,()=>_0x3e5c89(_0x21e4d1['timestamp'])),_0x479093['addEventListener'](_0x39b97d(0x15ad),()=>{const _0x28fdc4=_0x39b97d;if(_0x51034e)_0x1f3e50(_0x21e4d1[_0x28fdc4(0x287)]);}),_0x479093;}const _0x43d760=_0x21e4d1[_0x39b97d(0x71a)]==='user',_0x49a25d=_0x3357be[_0x39b97d(0xa37)]['myNickname']||'我',_0x1a681f=document[_0x39b97d(0x2c9)]('div');_0x1a681f['className']=_0x39b97d(0x1629)+(_0x43d760?_0x39b97d(0x6d6):'ai');if(_0x3357be[_0x39b97d(0xc98)]&&!_0x43d760){const _0x55cca9=_0x3357be[_0x39b97d(0x4f8)][_0x39b97d(0x821)](_0x23304c=>_0x23304c['originalName']===_0x21e4d1[_0x39b97d(0x3e7)]),_0x971b0d=document[_0x39b97d(0x2c9)]('div');_0x971b0d[_0x39b97d(0x4e1)]='sender-name',_0x971b0d['textContent']=_0x55cca9?_0x55cca9[_0x39b97d(0x7ca)]:_0x21e4d1[_0x39b97d(0x3e7)]||_0x39b97d(0xd0a),_0x1a681f[_0x39b97d(0x8f2)](_0x971b0d);}const _0x55ed8b=document[_0x39b97d(0x2c9)](_0x39b97d(0xf8e));_0x55ed8b[_0x39b97d(0x4e1)]=_0x39b97d(0x1597)+(_0x43d760?'user':'ai'),_0x55ed8b[_0x39b97d(0xd61)][_0x39b97d(0x287)]=_0x21e4d1[_0x39b97d(0x287)];const _0x3bedc1=document[_0x39b97d(0x2c9)](_0x39b97d(0x9a7));_0x3bedc1[_0x39b97d(0x4e1)]=_0x39b97d(0x287),_0x3bedc1[_0x39b97d(0xde7)]=_0x1eeb89(_0x21e4d1[_0x39b97d(0x287)]);let _0x1a75c5,_0x5a2279='';if(_0x43d760)_0x1a75c5=_0x3357be[_0x39b97d(0xa37)][_0x39b97d(0x12d3)]||(_0x3357be[_0x39b97d(0xc98)]?_0x1f9bfa:_0x91d058),_0x5a2279=_0x3357be[_0x39b97d(0xa37)]['myAvatarFrame']||'';else{if(_0x3357be[_0x39b97d(0xc98)]){const _0x4eb5bc=_0x3357be['members']['find'](_0xa0a400=>_0xa0a400[_0x39b97d(0xdcf)]===_0x21e4d1['senderName']);if(_0x4eb5bc){const _0x5b1d62=_0x4c8b14[_0x39b97d(0xbea)][_0x4eb5bc['id']];_0x1a75c5=_0x4eb5bc[_0x39b97d(0xa9a)]||(_0x5b1d62?_0x5b1d62['settings'][_0x39b97d(0xb24)]:_0x1e2f0a),_0x5a2279=_0x4eb5bc[_0x39b97d(0x160d)]||(_0x5b1d62?_0x5b1d62[_0x39b97d(0xa37)][_0x39b97d(0x2d7)]:'');}else _0x1a75c5=_0x1e2f0a,_0x5a2279='';}else _0x1a75c5=_0x3357be[_0x39b97d(0xa37)][_0x39b97d(0xb24)]||_0x91d058,_0x5a2279=_0x3357be['settings'][_0x39b97d(0x2d7)]||'';}let _0x3af0eb;_0x5a2279?_0x3af0eb=_0x39b97d(0x1620)+_0x1a75c5+'\x22\x20class=\x22avatar-img\x22><img\x20src=\x22'+_0x5a2279+_0x39b97d(0x69d):_0x3af0eb='<img\x20src=\x22'+_0x1a75c5+_0x39b97d(0xe01);const _0x12ab96=_0x5a2279?_0x39b97d(0x5e5):'',_0x1ffecc=_0x39b97d(0x694)+_0x12ab96+'\x22>'+_0x3af0eb+_0x39b97d(0x11ac);let _0x29e6d5,_0x4fa348='';if(_0x21e4d1[_0x39b97d(0x1406)]){const _0x3b3557=_0x288d80(_0x3357be,_0x21e4d1['quote'][_0x39b97d(0x3e7)]),_0xf5eecd=String(_0x21e4d1[_0x39b97d(0x1406)][_0x39b97d(0x1109)]||'');_0x4fa348=_0x39b97d(0x1064)+_0x21e4d1[_0x39b97d(0x1406)]['timestamp']+'\x22\x20style=\x22cursor:\x20pointer;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-sender\x22>回复\x20'+_0x3b3557+_0x39b97d(0xc87)+_0xf5eecd+_0x39b97d(0x62f);}let _0x437940=_0x21e4d1[_0x39b97d(0x1109)];if(typeof _0x437940===_0x39b97d(0x158f)&&_0x437940[_0x39b97d(0xb8f)]()[_0x39b97d(0xbb9)]('<')&&_0x437940[_0x39b97d(0xb8f)]()[_0x39b97d(0x8c7)]('>'))_0x29e6d5=_0x437940,_0x55ed8b[_0x39b97d(0xb08)]['add'](_0x39b97d(0x872));else{if(_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0x86e)||_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0x4c1)||_0x21e4d1['type']==='share_card'||_0x21e4d1['type']===_0x39b97d(0xdeb)||_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0xea7)||_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0xdf3)||_0x21e4d1['type']===_0x39b97d(0x295)||_0x21e4d1['type']===_0x39b97d(0x112f)||_0x21e4d1[_0x39b97d(0xbbf)]==='waimai_request'||_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0xa19)||_0x21e4d1[_0x39b97d(0xbbf)]==='red_packet'||_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0x1618)||_0x21e4d1['type']===_0x39b97d(0x15b6)||_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0x1598)||_0x21e4d1[_0x39b97d(0xbbf)]==='naiimag'){if(_0x21e4d1['type']===_0x39b97d(0x86e)){const _0x29ec6c=_0x21e4d1[_0x39b97d(0x1109)]||((_0x21e4d1[_0x39b97d(0xf2d)]||'')+'\x20'+(_0x21e4d1['description']||''))[_0x39b97d(0xb8f)](),_0x1b69b5=/(「.*?」|“.*?”)/g,_0x9c57bb=_0x29ec6c['split'](_0x1b69b5)[_0x39b97d(0x29d)](_0x1f08eb=>_0x1f08eb);_0x29e6d5=_0x9c57bb[_0x39b97d(0xd18)](_0x129f8e=>{const _0x21e10f=_0x39b97d;return _0x129f8e['startsWith']('「')||_0x129f8e[_0x21e10f(0xbb9)]('“')?_0x21e10f(0xfc7)+_0x412ec9(_0x129f8e)+'</span>':_0x21e10f(0x8f8)+_0x412ec9(_0x129f8e['trim']())[_0x21e10f(0xe19)](/\n/g,_0x21e10f(0x9e1))+_0x21e10f(0x21f);})['join']('');}else{if(_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0x4c1))_0x55ed8b[_0x39b97d(0xb08)][_0x39b97d(0x12b6)]('is-link-share',_0x39b97d(0x1059)),_0x29e6d5=_0x39b97d(0x160b)+_0x21e4d1['timestamp']+'\x22><div\x20class=\x22title\x22>'+(_0x21e4d1['title']||_0x39b97d(0xc0b))+_0x39b97d(0x9c2)+(_0x21e4d1[_0x39b97d(0x12a5)]||_0x39b97d(0x113c))+'</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle><line\x20x1=\x222\x22\x20y1=\x2212\x22\x20x2=\x2222\x22\x20y2=\x2212\x22></line><path\x20d=\x22M12\x202a15.3\x2015.3\x200\x200\x201\x204\x2010\x2015.3\x2015.3\x200\x200\x201-4\x2010\x2015.3\x2015.3\x200\x200\x201-4-10\x2015.3\x2015.3\x200\x200\x201\x204-10z\x22></path></svg><span>'+(_0x21e4d1[_0x39b97d(0x2ca)]||_0x39b97d(0xd3e))+'</span></div></div>';else{if(_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0xfff))_0x55ed8b[_0x39b97d(0xb08)]['add']('is-link-share',_0x39b97d(0x1059)),_0x29e6d5=_0x39b97d(0x1320)+_0x21e4d1['timestamp']+_0x39b97d(0x1162)+_0x21e4d1[_0x39b97d(0x4a8)][_0x39b97d(0x647)]+_0x39b97d(0x858)+_0x21e4d1['payload'][_0x39b97d(0x658)][_0x39b97d(0x8d6)]+_0x39b97d(0x916);else{if(_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0xdeb)){_0x55ed8b[_0x39b97d(0xb08)][_0x39b97d(0x12b6)](_0x39b97d(0x1233),_0x39b97d(0x1059));let _0x557524;if(_0x21e4d1[_0x39b97d(0x1436)])_0x557524=_0x21e4d1[_0x39b97d(0x1436)];else _0x4c8b14[_0x39b97d(0x14f1)]['enableAiDrawing']&&_0x21e4d1[_0x39b97d(0xff9)]?_0x557524=_0x39b97d(0x9c3)+encodeURIComponent(_0x21e4d1['image_prompt']):_0x557524='https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg';const _0x2c1fb3=_0x39b97d(0x986)+_0x557524+_0x39b97d(0xd4d);_0x29e6d5='<div\x20class=\x22location-share-card\x22><div\x20class=\x22card-text-area\x22><div\x20class=\x22card-text-primary\x22>'+_0x21e4d1[_0x39b97d(0x1109)]+_0x39b97d(0xf73)+_0x2c1fb3+'><div\x20class=\x22card-pin-icon\x22><svg\x20width=\x221em\x22\x20height=\x221em\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2011.5C11.1716\x2011.5\x2010.5\x2010.8284\x2010.5\x2010C10.5\x209.17157\x2011.1716\x208.5\x2012\x208.5C12.8284\x208.5\x2013.5\x209.17157\x2013.5\x2010C13.5\x2010.8284\x2012.8284\x2011.5\x2012\x2011.5Z\x22></path><path\x20d=\x22M12\x202C7.92134\x202\x204.5\x205.42134\x204.5\x209.5C4.5\x2014.5312\x2011.2188\x2021.4375\x2011.5938\x2021.8125C11.7954\x2022.014\x2012.2046\x2022.014\x2012.4062\x2021.8125C12.7812\x2021.4375\x2019.5\x2014.5312\x2019.5\x209.5C19.5\x205.42134\x2016.0787\x202\x2012\x202ZM12\x2012.5C10.6193\x2012.5\x209.5\x2011.3807\x209.5\x2010C9.5\x208.61929\x2010.6193\x207.5\x2012\x207.5C13.3807\x207.5\x2014.5\x208.61929\x2014.5\x2010C14.5\x2011.3807\x2013.3807\x2012.5\x2012\x2012.5Z\x22></path></svg></div></div></div>';}else{if(_0x21e4d1['type']==='user_photo'||_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0xea7)){_0x55ed8b['classList'][_0x39b97d(0x12b6)](_0x39b97d(0xabb),'is-card-like');const _0x10a356=_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0xdf3)?_0x39b97d(0x420):_0x39b97d(0x33a),_0x38a531=_0x4c8b14[_0x39b97d(0x14f1)][_0x39b97d(0x7b5)]&&_0x21e4d1['image_prompt']?_0x39b97d(0x9c3)+_0x21e4d1['image_prompt']:_0x39b97d(0x261);_0x29e6d5=_0x39b97d(0x97d)+_0x38a531+_0x39b97d(0xa47)+_0x10a356+_0x39b97d(0x115e)+_0x21e4d1[_0x39b97d(0x1109)]+'\x22>';}else{if(_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0xd3c))_0x55ed8b[_0x39b97d(0xb08)][_0x39b97d(0x12b6)](_0x39b97d(0x1242),_0x39b97d(0x1059)),_0x29e6d5='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nai-image-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x21e4d1[_0x39b97d(0x1436)]+_0x39b97d(0x480)+(_0x21e4d1[_0x39b97d(0x551)]||_0x21e4d1['prompt']||'NovelAI生成')+_0x39b97d(0x14ea);else{if(_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0x295)){_0x55ed8b[_0x39b97d(0xb08)][_0x39b97d(0x12b6)](_0x39b97d(0xc84),'is-card-like');const _0x36c957=Math[_0x39b97d(0x124e)](0x1,Math[_0x39b97d(0x312)]((_0x21e4d1['content']||'')[_0x39b97d(0x8d6)]/0x5)),_0x5455a5='0:'+String(_0x36c957)[_0x39b97d(0xb7d)](0x2,'0')+'\x27\x27',_0x3214ba=_0x39b97d(0x1540);if(_0x43d760)_0x29e6d5=_0x39b97d(0x33b)+encodeURIComponent(_0x21e4d1[_0x39b97d(0x1109)])+_0x39b97d(0x5f6)+_0x3214ba+_0x39b97d(0x4df)+_0x5455a5+_0x39b97d(0x12ca);else{const _0x3018d8=!_0x3357be[_0x39b97d(0xc98)]&&_0x3357be[_0x39b97d(0xa37)]['enableTts']!==![],_0xcd8432=_0x3357be[_0x39b97d(0xa37)][_0x39b97d(0x3dd)]||_0x39b97d(0x1603),_0x3102b9=_0x3018d8?_0x39b97d(0x2d1)+_0xcd8432+'\x22':'';_0x29e6d5='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22'+encodeURIComponent(_0x21e4d1[_0x39b97d(0x1109)])+'\x22\x20'+_0x3102b9+_0x39b97d(0x147c)+_0x3214ba+_0x39b97d(0x143d)+_0x5455a5+_0x39b97d(0x12ca);}}else{if(_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0x112f)){_0x55ed8b[_0x39b97d(0xb08)][_0x39b97d(0x12b6)]('is-transfer',_0x39b97d(0x1059));let _0x2a0c1f,_0x5c1c91;const _0x446eb0=_0x3357be['isGroup']?_0x3357be[_0x39b97d(0xa37)][_0x39b97d(0x14a8)]||'我':'我',_0x18574d=_0x288d80(_0x3357be,_0x21e4d1['senderName']),_0x30d97e=_0x288d80(_0x3357be,_0x21e4d1[_0x39b97d(0x11fd)]||_0x3357be['name']);if(_0x43d760){if(_0x21e4d1[_0x39b97d(0x856)])_0x2a0c1f='退款给\x20'+_0x30d97e,_0x5c1c91=_0x39b97d(0x2e8);else{_0x2a0c1f='转账给\x20'+_0x30d97e;if(_0x21e4d1[_0x39b97d(0x12c3)]===_0x39b97d(0x6cc))_0x5c1c91=_0x39b97d(0xe9a);else{if(_0x21e4d1[_0x39b97d(0x12c3)]===_0x39b97d(0x81f))_0x5c1c91='对方已拒收';else _0x5c1c91=_0x21e4d1[_0x39b97d(0x12bb)]||'等待对方处理...';}}}else{if(_0x21e4d1['isRefund'])_0x2a0c1f=_0x39b97d(0x6fe)+_0x18574d,_0x5c1c91=_0x39b97d(0x910);else{if(_0x21e4d1[_0x39b97d(0x11fd)]===_0x446eb0){_0x2a0c1f='转账给\x20'+_0x446eb0;if(_0x21e4d1[_0x39b97d(0x12c3)]===_0x39b97d(0x6cc))_0x5c1c91=_0x39b97d(0x4f4);else{if(_0x21e4d1[_0x39b97d(0x12c3)]===_0x39b97d(0x81f))_0x5c1c91='你已拒收';else _0x55ed8b[_0x39b97d(0xa00)][_0x39b97d(0x214)]=_0x39b97d(0x1293),_0x55ed8b[_0x39b97d(0xd61)][_0x39b97d(0x12c3)]=_0x39b97d(0x9c6),_0x5c1c91=_0x21e4d1[_0x39b97d(0x12bb)]||_0x39b97d(0xb2e);}}else _0x2a0c1f=_0x39b97d(0x55e)+_0x18574d+_0x39b97d(0x3bd)+_0x30d97e,_0x5c1c91=_0x21e4d1['note']||_0x39b97d(0x56f);}}const _0xa0ba75='<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2220\x22\x20height=\x2220\x22\x20fill=\x22currentColor\x22\x20style=\x22vertical-align:\x20middle;\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22></path></svg>';_0x29e6d5=_0x39b97d(0xfdc)+_0xa0ba75+'\x20'+_0x2a0c1f+_0x39b97d(0x9ad)+Number(_0x21e4d1[_0x39b97d(0x12e7)])[_0x39b97d(0x2ea)](0x2)+_0x39b97d(0x1195)+_0x5c1c91+_0x39b97d(0xccd);}else{if(_0x21e4d1[_0x39b97d(0xbbf)]==='waimai_request'){_0x55ed8b[_0x39b97d(0xb08)][_0x39b97d(0x12b6)]('is-waimai-request','is-card-like');if(_0x21e4d1[_0x39b97d(0x12c3)]===_0x39b97d(0x143b)||_0x21e4d1[_0x39b97d(0x12c3)]===_0x39b97d(0x890))_0x55ed8b['classList'][_0x39b97d(0x12b6)](_0x39b97d(0x53b)+_0x21e4d1[_0x39b97d(0x12c3)]);const _0x15a019=_0x288d80(_0x3357be,_0x21e4d1['senderName']),_0x226f5f=_0x39b97d(0x1042)+_0x15a019+_0x39b97d(0xfb1);let _0x281a7e='';_0x21e4d1['status']===_0x39b97d(0x9c6)&&!_0x43d760&&(_0x281a7e='<div\x20class=\x22waimai-user-actions\x22><button\x20class=\x22waimai-decline-btn\x22\x20data-choice=\x22rejected\x22>残忍拒绝</button><button\x20class=\x22waimai-pay-btn\x22\x20data-choice=\x22paid\x22>为Ta买单</button></div>'),_0x29e6d5=_0x39b97d(0x71d)+_0x226f5f+_0x39b97d(0x864)+Number(_0x21e4d1['amount'])[_0x39b97d(0x2ea)](0x2)+_0x39b97d(0x2cd)+_0x21e4d1[_0x39b97d(0x287)]+_0x39b97d(0x377)+_0x281a7e+_0x39b97d(0x11ac),setTimeout(()=>{const _0x553da9=_0x39b97d;if(_0x21e4d1[_0x553da9(0x12c3)]===_0x553da9(0x9c6)){const _0x248d85=document[_0x553da9(0x400)](_0x553da9(0xa58)+_0x21e4d1[_0x553da9(0x287)]);if(_0x248d85){const _0x190579=_0x40e3f7(_0x248d85,_0x21e4d1['countdownEndTime']);_0x3dc27d[_0x21e4d1['timestamp']]=_0x190579;}}},0x0);}else{if(_0x21e4d1['type']==='waimai_order'){_0x55ed8b[_0x39b97d(0xb08)][_0x39b97d(0x12b6)](_0x39b97d(0xbef),_0x39b97d(0x1059));const _0x281f46=_0x288d80(_0x3357be,_0x21e4d1[_0x39b97d(0x3e7)]);let _0x26aba9='你';_0x3357be[_0x39b97d(0xc98)]&&(_0x26aba9=_0x288d80(_0x3357be,_0x21e4d1[_0x39b97d(0xa02)])),_0x29e6d5=_0x39b97d(0x4de)+_0x281f46+_0x39b97d(0x5c0)+_0x26aba9+_0x39b97d(0x831)+_0x21e4d1[_0x39b97d(0xff3)]+_0x39b97d(0x136f)+Number(_0x21e4d1[_0x39b97d(0x12e7)])[_0x39b97d(0x2ea)](0x2)+_0x39b97d(0x9af);}else{if(_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0x1461)){_0x55ed8b[_0x39b97d(0xb08)][_0x39b97d(0x12b6)](_0x39b97d(0x10a6),_0x39b97d(0x1059));const _0x3097cb=_0x4c8b14[_0x39b97d(0x834)][_0x39b97d(0xbf3)]||'{{user}}',_0x2b5b71=_0x21e4d1[_0x39b97d(0x1023)],_0x163bdb=_0x21e4d1['claimedBy']&&_0x21e4d1[_0x39b97d(0x1360)][_0x3097cb];let _0x459588='',_0x4657b5='',_0x32b6cd='拼手气红包';_0x2b5b71&&(_0x459588='opened');if(_0x21e4d1[_0x39b97d(0x1015)]===_0x39b97d(0xfd0)){const _0x5f1aef=_0x288d80(_0x3357be,_0x21e4d1[_0x39b97d(0x11fd)]);_0x32b6cd='专属红包:\x20给\x20'+_0x5f1aef;if(Object[_0x39b97d(0x1161)](_0x21e4d1['claimedBy']||{})[_0x39b97d(0x8d6)]>0x0)_0x459588=_0x39b97d(0x201);}if(_0x163bdb){const _0x51f630=_0x21e4d1[_0x39b97d(0x1360)][_0x3097cb]||0x0;_0x4657b5=_0x39b97d(0x12fd)+_0x51f630['toFixed'](0x2)+_0x39b97d(0x13ab);}else{if(_0x2b5b71)_0x4657b5='<div\x20class=\x22rp-claimed-info\x22>红包已被领完</div>';else{if(_0x21e4d1[_0x39b97d(0x1015)]===_0x39b97d(0xfd0)&&Object['keys'](_0x21e4d1[_0x39b97d(0x1360)]||{})[_0x39b97d(0x8d6)]>0x0){const _0x536f9c=_0x288d80(_0x3357be,_0x21e4d1['receiverName']);_0x4657b5=_0x39b97d(0x8bc)+_0x536f9c+_0x39b97d(0x7c1);}}}_0x29e6d5=_0x39b97d(0xcb8)+_0x459588+_0x39b97d(0xa04)+(_0x21e4d1[_0x39b97d(0xdf1)]||'恭喜发财，大吉大利！')+'</span></div><div\x20class=\x22rp-type\x22>'+_0x32b6cd+'</div>'+_0x4657b5+_0x39b97d(0x11ac);}else{if(_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0x1618)){_0x55ed8b['classList'][_0x39b97d(0x12b6)](_0x39b97d(0x6c2),'is-card-like');const _0x5f09d1=_0x21e4d1[_0x39b97d(0xf96)]||_0x21e4d1[_0x39b97d(0x1109)]||_0x39b97d(0x965);let _0x245d28=0x0;const _0x687e74={};for(const _0x549585 in _0x21e4d1[_0x39b97d(0x14a6)]){const _0x50ca34=_0x21e4d1[_0x39b97d(0x14a6)][_0x549585][_0x39b97d(0x8d6)];_0x687e74[_0x549585]=_0x50ca34,_0x245d28+=_0x50ca34;}const _0x3e003c=_0x4c8b14[_0x39b97d(0x834)]['nickname']||_0x39b97d(0xa8f);let _0x324e44=null;for(const _0x5d2eb6 in _0x21e4d1['votes']){if(_0x21e4d1[_0x39b97d(0x14a6)][_0x5d2eb6][_0x39b97d(0xd1b)](_0x3e003c)){_0x324e44=_0x5d2eb6;break;}}let _0x2fcb05=_0x39b97d(0x476);_0x21e4d1['options']['forEach'](_0x3f6c6d=>{const _0x56294c=_0x39b97d,_0x28d734=_0x687e74[_0x3f6c6d]||0x0,_0x1c2954=_0x245d28>0x0?_0x28d734/_0x245d28*0x64:0x0,_0x598b03=_0x324e44===_0x3f6c6d;_0x2fcb05+=_0x56294c(0x807)+(_0x598b03?_0x56294c(0x10a2):'')+'\x22\x20data-option=\x22'+_0x3f6c6d+_0x56294c(0x537)+_0x1c2954+'%;\x22></div><div\x20class=\x22poll-option-content\x22><span\x20class=\x22poll-option-text\x22>'+_0x3f6c6d+_0x56294c(0x1055)+_0x28d734+_0x56294c(0x6ab);}),_0x2fcb05+=_0x39b97d(0x11ac);let _0x5a82bb=_0x21e4d1[_0x39b97d(0x3c0)]?_0x39b97d(0x1335)+_0x245d28+'\x20人投票</span><button\x20class=\x22poll-action-btn\x22>查看结果</button></div>':_0x39b97d(0x1335)+_0x245d28+_0x39b97d(0xa64);_0x29e6d5='<div\x20class=\x22poll-card\x20'+(_0x21e4d1['isClosed']?'closed':'')+_0x39b97d(0xdce)+_0x21e4d1[_0x39b97d(0x287)]+'\x22><div\x20class=\x22poll-question\x22>'+_0x5f09d1+_0x39b97d(0x11ac)+_0x2fcb05+_0x5a82bb+_0x39b97d(0x11ac);}else{if(_0x21e4d1[_0x39b97d(0xbbf)]===_0x39b97d(0x15b6)){_0x55ed8b['classList'][_0x39b97d(0x12b6)](_0x39b97d(0x44e),_0x39b97d(0x1059));let _0x329574;const _0x367c61=_0x3357be['settings'][_0x39b97d(0x14a8)]||'我';if(_0x3357be[_0x39b97d(0xc98)]){if(_0x21e4d1[_0x39b97d(0x1170)]&&_0x21e4d1['recipients'][_0x39b97d(0x8d6)]>0x0){const _0x3d6e9d=_0x21e4d1['recipients']['map'](_0x58cce0=>_0x288d80(_0x3357be,_0x58cce0));_0x3d6e9d[_0x39b97d(0x8d6)]===0x1?_0x329574=_0x39b97d(0xdb4)+_0x3d6e9d[0x0]+_0x39b97d(0xf2f):_0x329574='送给\x20'+_0x3d6e9d[_0x39b97d(0x69f)](0x0,0x2)[_0x39b97d(0xee1)]('、')+_0x39b97d(0x970);}else _0x329574='送给大家的礼物';}else{if(_0x43d760)_0x329574=_0x39b97d(0xdb4)+_0x3357be[_0x39b97d(0xf3e)]+'\x20的礼物';else{const _0x52512b=_0x3357be[_0x39b97d(0xa37)][_0x39b97d(0x14a8)]||'你';_0x329574=_0x39b97d(0xdb4)+_0x52512b+_0x39b97d(0xf2f);}}const _0x39096b=_0x21e4d1[_0x39b97d(0x15c9)][_0x39b97d(0x69f)](0x0,0x3);let _0x379048='';_0x39096b[_0x39b97d(0xbdc)](_0x7583=>{const _0x51ca84=_0x39b97d;_0x379048+=_0x51ca84(0x24f)+_0x7583[_0x51ca84(0x1436)]+_0x51ca84(0x10d7)+_0x7583['name']+'</span><span\x20class=\x22gift-preview-quantity\x22>x'+_0x7583[_0x51ca84(0x2b9)]+_0x51ca84(0x1282);});let _0x2174cb='';_0x21e4d1[_0x39b97d(0x15c9)][_0x39b97d(0x8d6)]>0x3&&(_0x2174cb='\x20等'+_0x21e4d1[_0x39b97d(0x15c9)][_0x39b97d(0x8d6)]+_0x39b97d(0x11d7)),_0x29e6d5=_0x39b97d(0xfa5)+_0x329574+_0x39b97d(0xcf0)+_0x379048+_0x39b97d(0x45c)+_0x21e4d1[_0x39b97d(0x15c9)][_0x39b97d(0x8d6)]+_0x39b97d(0x11d7)+_0x2174cb+_0x39b97d(0x25a);}}}}}}}}}}}}}}else{const _0xfd0711=String(_0x437940);let _0x4becaf=await _0x25d95c(_0xfd0711,_0x3357be['id']);if(_0x4becaf!==_0xfd0711)_0x29e6d5=_0x4becaf,_0x55ed8b[_0x39b97d(0xb08)][_0x39b97d(0x12b6)](_0x39b97d(0x1059));else{if(Array[_0x39b97d(0x16a1)](_0x21e4d1[_0x39b97d(0x1109)])&&_0x21e4d1[_0x39b97d(0x1109)][0x0]?.[_0x39b97d(0xbbf)]===_0x39b97d(0x164d)){const _0x5e06b4=_0x21e4d1[_0x39b97d(0x1109)][0x0][_0x39b97d(0x164d)][_0x39b97d(0x299)];_0x29e6d5='<img\x20src=\x22'+_0x5e06b4+_0x39b97d(0x1286);}else{if(_0x12f2a0['test'](_0x4becaf))_0x55ed8b[_0x39b97d(0xb08)]['add']('is-sticker','is-card-like'),_0x29e6d5=_0x39b97d(0x97d)+_0x4becaf+_0x39b97d(0x7fd)+(_0x21e4d1[_0x39b97d(0xca4)]||_0x39b97d(0x294))+_0x39b97d(0x8b1);else{let _0x531cda=_0x2bafeb(_0x4becaf,_0x3357be);_0x29e6d5=_0x412ec9(_0x531cda)[_0x39b97d(0xe19)](/\n/g,'<br>');}}}}}_0x55ed8b[_0x39b97d(0x1575)]=_0x39b97d(0x73f)+_0x1ffecc+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4fa348+_0x39b97d(0x73d)+_0x29e6d5+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1a681f[_0x39b97d(0x8f2)](_0x55ed8b),_0x1a681f[_0x39b97d(0x8f2)](_0x3bedc1),_0x3d4218(_0x1a681f,()=>_0x3e5c89(_0x21e4d1[_0x39b97d(0x287)])),_0x1a681f[_0x39b97d(0x501)](_0x39b97d(0x15ad),()=>{if(_0x51034e)_0x1f3e50(_0x21e4d1['timestamp']);});if(!_0x43d760){const _0xe9cd58=_0x1a681f['querySelector'](_0x39b97d(0x41a));_0xe9cd58&&(_0xe9cd58[_0x39b97d(0xa00)][_0x39b97d(0x214)]=_0x39b97d(0x1293),!_0x3357be[_0x39b97d(0xc98)]?_0xe9cd58[_0x39b97d(0x501)]('click',_0x4711f8=>{const _0x467675=_0x39b97d;_0x4711f8[_0x467675(0x504)](),_0x2b6102(_0x3357be['id']);}):_0xe9cd58[_0x39b97d(0x501)](_0x39b97d(0x148c),_0x340f7c=>{const _0x54f736=_0x39b97d;_0x340f7c[_0x54f736(0x504)](),_0x34b720(_0x3357be['id'],_0x21e4d1[_0x54f736(0x3e7)]);}));}return _0x1a681f;}async function _0x62f029(_0x4f2600,_0x2d7b54){const _0x113729=_0x239c7d,_0x38b6cc=document[_0x113729(0x400)](_0x113729(0x75b)),_0x3242b0=await _0x43c5e5(_0x4f2600,_0x2d7b54);if(!_0x3242b0)return;const _0x4d6346=document['getElementById'](_0x113729(0xf43));_0x4d6346?_0x38b6cc['insertBefore'](_0x3242b0,_0x4d6346[_0x113729(0x611)]):_0x38b6cc[_0x113729(0x587)](_0x3242b0);}async function _0x41ecc7(_0x5cd3d,_0x2e7e3f,_0x408938=![]){const _0xd62ffa=_0x239c7d,_0x206e11=document['getElementById'](_0xd62ffa(0x75b)),_0x34c2a9=document[_0xd62ffa(0x400)](_0xd62ffa(0x77f)),_0x2af2ca=_0x2e7e3f['history'][_0xd62ffa(0x29d)](_0x32c90e=>!_0x32c90e[_0xd62ffa(0x118c)])[_0xd62ffa(0x5ac)]();if(_0x2af2ca&&_0x5cd3d[_0xd62ffa(0x287)]-_0x2af2ca[_0xd62ffa(0x287)]>0x927c0){const _0x2fbcbc=_0xad544c(_0x5cd3d[_0xd62ffa(0x287)]);_0x206e11[_0xd62ffa(0x1465)](_0x2fbcbc,_0x34c2a9);}const _0x55c818=await _0x43c5e5(_0x5cd3d,_0x2e7e3f);if(!_0x55c818)return;_0x5cd3d[_0xd62ffa(0x71a)]===_0xd62ffa(0x4fd)&&!_0x408938&&_0x4c601e();!_0x408938&&_0x55c818[_0xd62ffa(0xb08)][_0xd62ffa(0x12b6)](_0xd62ffa(0x66b));_0x206e11['insertBefore'](_0x55c818,_0x34c2a9);const _0x5cdedc=()=>{const _0x539980=_0xd62ffa;!_0x408938&&(_0x206e11['scrollTop']=_0x206e11[_0x539980(0xe0d)]);},_0x368460=_0x55c818[_0xd62ffa(0x527)](_0xd62ffa(0x11e4));if(_0x368460[_0xd62ffa(0x8d6)]>0x0){const _0x137dbc=[];_0x368460[_0xd62ffa(0xbdc)](_0x3847b7=>{const _0x2bc67f=_0xd62ffa;!_0x3847b7['complete']&&_0x137dbc[_0x2bc67f(0x6bb)](new Promise(_0x1bd64e=>{const _0x3afe5b=_0x2bc67f;_0x3847b7['onload']=_0x1bd64e,_0x3847b7[_0x3afe5b(0x96d)]=_0x1bd64e;}));}),Promise[_0xd62ffa(0x875)](_0x137dbc)['then'](()=>{const _0x37803e=_0xd62ffa;console[_0x37803e(0x1e6)](_0x368460[_0x37803e(0x8d6)]+_0x37803e(0x7b2)),_0x5cdedc();});}else _0x5cdedc();}async function _0xdcfd59(_0x451522){const _0x4298ea=_0x239c7d;_0x4c8b14[_0x4298ea(0x1539)]=_0x451522;const _0x607197=_0x4c8b14[_0x4298ea(0xbea)][_0x451522];if(!_0x607197)return;_0x607197['unreadCount']>0x0&&(_0x607197[_0x4298ea(0x73c)]=0x0,await _0x54c587[_0x4298ea(0xbea)][_0x4298ea(0x4cb)](_0x607197));_0x1478ca(_0x607197),_0x26354c(_0x451522),_0x257d51('chat-interface-screen'),window[_0x4298ea(0x12da)](_0x4c8b14['activeChatId']);const _0x3c7099=_0x607197[_0x4298ea(0xc98)]||![];_0x22ecff(_0x3c7099),document[_0x4298ea(0x400)](_0x4298ea(0xe7f))['style'][_0x4298ea(0xb1a)]=_0x3c7099?_0x4298ea(0x375):_0x4298ea(0x165b);const _0x1765cb=document[_0x4298ea(0x400)](_0x4298ea(0xec1));_0x1765cb&&(_0x1765cb['style']['display']=_0x3c7099?_0x4298ea(0x165b):_0x4298ea(0x375));const _0x5b5b9c=document[_0x4298ea(0x400)](_0x4298ea(0x486)),_0x4662e4=document['getElementById'](_0x4298ea(0x6fa)),_0x3a1410=document[_0x4298ea(0x400)]('gomoku-btn'),_0x117703=document['getElementById'](_0x4298ea(0x1052));_0x4662e4&&_0x3a1410&&_0x117703&&_0x5b5b9c&&(_0x4662e4['style'][_0x4298ea(0xb1a)]=_0x4298ea(0x375),_0x3a1410['style'][_0x4298ea(0xb1a)]=_0x3c7099?_0x4298ea(0x165b):_0x4298ea(0x375),_0x117703[_0x4298ea(0xa00)][_0x4298ea(0xb1a)]=_0x3c7099?_0x4298ea(0x375):_0x4298ea(0x165b),_0x5b5b9c['style'][_0x4298ea(0xb1a)]=_0x3c7099?'none':'flex'),_0x2acd39(),!_0x607197[_0x4298ea(0xc98)]&&_0x607197[_0x4298ea(0x12f7)]?.[_0x4298ea(0x12c3)]===_0x4298ea(0x59d)&&(console[_0x4298ea(0x1e6)](_0x4298ea(0xbb5)+_0x607197[_0x4298ea(0xf3e)]+_0x4298ea(0x95b)),_0x58df1c()),document[_0x4298ea(0x400)](_0x4298ea(0x633))[_0x4298ea(0xa00)][_0x4298ea(0xb1a)]=_0x3c7099?_0x4298ea(0x375):_0x4298ea(0x165b),document[_0x4298ea(0x471)][_0x4298ea(0xb08)][_0x4298ea(0xc46)](_0x4298ea(0x1452));}function _0x34ba39(_0x1ded6f,_0x45f690){const _0x1b0f06=_0x239c7d,_0x1b2ab9=_0x45f690?'add':_0x1b0f06(0xc46),_0x5519c8=_0x16570d=>{const _0x112afe=_0x1b0f06;_0x16570d&&_0x16570d[_0x112afe(0xb08)][_0x1b2ab9](_0x112afe(0x458));},_0x3e40ff=document[_0x1b0f06(0x13ef)](_0x1b0f06(0xd54)+_0x1ded6f+_0x1b0f06(0x1604));_0x5519c8(_0x3e40ff);const _0x3ea621=document[_0x1b0f06(0x527)]('.post-avatar[data-author-id=\x22'+_0x1ded6f+'\x22]');_0x3ea621[_0x1b0f06(0xbdc)](_0x5519c8);const _0x1e34a4=document['querySelector']('.participant-avatar[data-participant-id=\x22'+_0x1ded6f+'\x22]');_0x5519c8(_0x1e34a4);}async function _0x51117d(){const _0x286d8e=_0x239c7d;if(!_0x4c8b14[_0x286d8e(0x1539)])return;const _0x2b498b=_0x4c8b14[_0x286d8e(0x1539)],_0x250e19=_0x4c8b14[_0x286d8e(0xbea)][_0x2b498b];lastRawAiResponse='',lastResponseTimestamps=[];const _0x35d705=document[_0x286d8e(0x400)](_0x286d8e(0xb3c));_0x35d705&&(_0x35d705['disabled']=!![],_0x35d705[_0x286d8e(0xde7)]=_0x286d8e(0x5da));_0x34ba39(_0x2b498b,!![]);try{const {proxyUrl:_0xb54d1d,apiKey:_0xccfd77,model:_0x87be5}=_0x4c8b14[_0x286d8e(0x814)];if(!_0xb54d1d||!_0xccfd77||!_0x87be5)throw new Error('API未配置，无法生成对话。');const _0x565c0a=parseInt(_0x250e19[_0x286d8e(0xa37)][_0x286d8e(0xebb)])||0xa,_0x17b08a=_0x250e19[_0x286d8e(0x92c)]['slice'](-_0x565c0a),_0x24d609=await _0x25ac7a(_0x17b08a,_0x2b498b);let _0x11550c='';if(_0x250e19[_0x286d8e(0xa37)][_0x286d8e(0xb0d)]&&_0x250e19['settings'][_0x286d8e(0xb0d)][_0x286d8e(0x8d6)]>0x0){const _0x142699=_0x250e19[_0x286d8e(0xa37)][_0x286d8e(0xb0d)]['map'](_0x248dbe=>{const _0x318c69=_0x286d8e,_0x1eb1a1=_0x4c8b14[_0x318c69(0xf57)][_0x318c69(0x821)](_0x2fc7fc=>_0x2fc7fc['id']===_0x248dbe);if(!_0x1eb1a1||!Array['isArray'](_0x1eb1a1[_0x318c69(0x1109)]))return'';const _0x318885=_0x1eb1a1['content'][_0x318c69(0x29d)](_0x151412=>_0x151412[_0x318c69(0x250)]!==![])[_0x318c69(0xd18)](_0x338470=>{const _0xb17c94=_0x318c69;let _0x330452=_0xb17c94(0x64e)+(_0x338470[_0xb17c94(0x83c)]||_0xb17c94(0x955))+'\x0a';if(_0x338470[_0xb17c94(0x1161)][_0xb17c94(0x8d6)]>0x0)_0x330452+=_0xb17c94(0x65c)+_0x338470[_0xb17c94(0x1161)][_0xb17c94(0xee1)](',\x20')+'\x0a';return _0x330452+='**内容:**\x0a'+_0x338470[_0xb17c94(0x1109)],_0x330452;})[_0x318c69(0xee1)]('');return _0x318885?'\x0a\x0a##\x20世界书:\x20'+_0x1eb1a1['name']+'\x0a'+_0x318885:'';})[_0x286d8e(0x29d)](Boolean)[_0x286d8e(0xee1)]('');_0x142699&&(_0x11550c=_0x286d8e(0x4a6)+_0x142699+_0x286d8e(0x1022));}let _0x3bba80='#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a',_0x61a04a=![];_0x250e19[_0x286d8e(0x4f8)][_0x286d8e(0xbdc)](_0x55fdb=>{const _0x1fd67e=_0x286d8e,_0x5005fc=_0x4c8b14[_0x1fd67e(0xbea)][_0x55fdb['id']];_0x5005fc&&_0x5005fc[_0x1fd67e(0x1600)]&&_0x5005fc[_0x1fd67e(0x1600)]['length']>0x0&&(_0x3bba80+=_0x1fd67e(0x12fe)+_0x55fdb[_0x1fd67e(0x7ca)]+_0x1fd67e(0xcb9),_0x3bba80+=_0x5005fc[_0x1fd67e(0x1600)][_0x1fd67e(0xd18)](_0x265501=>_0x1fd67e(0x1ee)+_0x4878ba(_0x265501[_0x1fd67e(0x287)])+')\x20'+_0x265501['content'])[_0x1fd67e(0xee1)]('\x0a'),_0x61a04a=!![]);});!_0x61a04a&&(_0x3bba80+=_0x286d8e(0x4d1));let _0x515570='';const _0x2b30df=_0x250e19[_0x286d8e(0xa37)][_0x286d8e(0x412)]||0xa;if(_0x250e19[_0x286d8e(0xa37)]['linkedMemoryChatIds']&&_0x250e19[_0x286d8e(0xa37)]['linkedMemoryChatIds'][_0x286d8e(0x8d6)]>0x0){}const _0x2e9407=_0x250e19[_0x286d8e(0x4f8)][_0x286d8e(0xd18)](_0x478404=>_0x286d8e(0x6a6)+_0x478404[_0x286d8e(0x7ca)]+'**\x20(本名:\x20'+_0x478404[_0x286d8e(0xdcf)]+_0x286d8e(0x29e)+_0x478404[_0x286d8e(0x9a2)])[_0x286d8e(0xee1)]('\x0a'),_0x216a06=_0x5798f0(_0x250e19),_0x583348='\x0a#\x20核心任务：群聊剧本作家\x0a你是一个剧本作家，负责创作一个名为“'+_0x250e19['name']+'”的群聊中的对话。这个群聊里【没有用户】，所有成员都是你扮演的角色。你的任务是让他们之间进行一场生动、自然的对话。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20字段和\x20\x22name\x22\x20字段（角色的【本名】）。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**【角色间互动\x20(最重要!)】**:\x20你的核心是创作一场“戏”。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别自言自语的独白。\x0a2.\x20\x20**【禁止出戏】**:\x20绝不能透露你是AI、模型或剧本作家。\x0a3.\x20\x20**【主动性】**:\x20角色们应该主动使用各种功能（发表情、发语音、分享图片等）来让对话更生动，而不是仅仅发送文字。\x0a4.请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20可用指令列表\x20(你现在可以使用所有这些功能！)\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20'+_0x250e19[_0x286d8e(0xf3e)]+_0x286d8e(0x3f9)+_0x3bba80+'\x0a'+_0x11550c+'\x0a'+_0x515570+_0x286d8e(0x2ff)+_0x17b08a[_0x286d8e(0xd18)](_0x51a965=>_0x288d80(_0x250e19,_0x51a965[_0x286d8e(0x3e7)])+':\x20'+_0x51a965['content'])[_0x286d8e(0xee1)]('\x0a')+'\x0a\x0a#\x20群成员列表及人设\x20(你扮演的所有角色)\x0a'+_0x2e9407+'\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a'+_0x216a06+'\x0a现在，请根据以上所有信息，继续这场没有用户参与的群聊，并自由地使用各种指令来丰富你们的互动。\x0a',_0x447c5e=_0x24d609[_0x286d8e(0xd18)](_0x15850f=>({'role':_0x286d8e(0x6d6),'content':_0x288d80(_0x250e19,_0x15850f[_0x286d8e(0x3e7)])+':\x20'+_0x15850f['content']}));let _0xfa8d60=_0xb54d1d[_0x286d8e(0xd1b)]('generativelanguage.googleapis.com'),_0x29726b;if(_0xfa8d60){let _0x12258a=_0x3914a6(_0x87be5,_0xccfd77,_0x583348,_0x447c5e);_0x29726b=await fetch(_0x12258a[_0x286d8e(0x299)],_0x12258a[_0x286d8e(0x55b)]);}else _0x29726b=await fetch(_0xb54d1d+_0x286d8e(0x1611),{'method':'POST','headers':{'Content-Type':_0x286d8e(0xfae),'Authorization':_0x286d8e(0xcee)+_0xccfd77},'body':JSON[_0x286d8e(0xea5)]({'model':_0x87be5,'messages':[{'role':_0x286d8e(0xaf6),'content':_0x583348},..._0x447c5e],'temperature':_0x4c8b14[_0x286d8e(0x14f1)]['apiTemperature']||0.9})});if(!_0x29726b['ok']){const _0x2b8296=await _0x29726b['json']()[_0x286d8e(0x37a)](()=>({'error':{'message':_0x29726b['statusText']}}));throw new Error(_0x286d8e(0x1178)+_0x29726b[_0x286d8e(0x12c3)]+_0x286d8e(0x1477)+(_0x2b8296[_0x286d8e(0x5d7)]?.[_0x286d8e(0x6e2)]||_0x286d8e(0x1219)));}const _0x244ffe=await _0x29726b[_0x286d8e(0x15d3)](),_0x35a246=getGeminiResponseText(_0x244ffe);lastRawAiResponse=_0x35a246;const _0x37dbb1=_0x57a22a(_0x35a246);let _0x4a7cb9=Date['now']();for(const _0x1af3ce of _0x37dbb1){if(!_0x1af3ce||!_0x1af3ce[_0x286d8e(0xbbf)]||!_0x1af3ce['name'])continue;let _0x1947ab=null;const _0x2fa17a=_0x4a7cb9++;lastResponseTimestamps[_0x286d8e(0x6bb)](_0x2fa17a);const _0x132003={'role':_0x286d8e(0x4fd),'senderName':_0x1af3ce['name'],'timestamp':_0x2fa17a};switch(_0x1af3ce[_0x286d8e(0xbbf)]){case _0x286d8e(0x117f):_0x1947ab={..._0x132003,'content':_0x1af3ce[_0x286d8e(0x1109)]};break;case _0x286d8e(0x12c2):if(_0x1af3ce[_0x286d8e(0xca4)]){const _0x36fbfd=findBestStickerMatch(_0x1af3ce['meaning'],_0x4c8b14[_0x286d8e(0x120c)]);_0x36fbfd?_0x1947ab={..._0x132003,'type':'sticker','content':_0x36fbfd[_0x286d8e(0x299)],'meaning':_0x36fbfd['name']}:(console[_0x286d8e(0x75e)](_0x286d8e(0x849)+_0x1af3ce[_0x286d8e(0xca4)]+'\x22'),_0x1947ab=null);}else console[_0x286d8e(0x75e)](_0x286d8e(0x1243),_0x1af3ce);break;case'ai_image':_0x1947ab={..._0x132003,'type':'ai_image','content':_0x1af3ce['description'],'image_prompt':_0x1af3ce['image_prompt']};break;case'voice_message':_0x1947ab={..._0x132003,'type':_0x286d8e(0x295),'content':_0x1af3ce['content']};break;case _0x286d8e(0x788):const _0x3a7f89=_0x250e19[_0x286d8e(0x92c)][_0x286d8e(0x821)](_0x280f93=>_0x280f93[_0x286d8e(0x287)]===_0x1af3ce['target_timestamp']);_0x3a7f89?_0x1947ab={..._0x132003,'content':_0x1af3ce[_0x286d8e(0x103e)],'quote':{'timestamp':_0x3a7f89[_0x286d8e(0x287)],'senderName':_0x3a7f89[_0x286d8e(0x3e7)],'content':String(_0x3a7f89[_0x286d8e(0x1109)]||'')[_0x286d8e(0x371)](0x0,0x32)}}:_0x1947ab={..._0x132003,'content':_0x1af3ce[_0x286d8e(0x103e)]};break;default:console[_0x286d8e(0x75e)](_0x286d8e(0x1de),_0x1af3ce[_0x286d8e(0xbbf)]);continue;}_0x1947ab&&(_0x250e19[_0x286d8e(0x92c)][_0x286d8e(0x6bb)](_0x1947ab),_0x41ecc7(_0x1947ab,_0x250e19),await new Promise(_0x45ddc9=>setTimeout(_0x45ddc9,Math[_0x286d8e(0x12bc)]()*0x4b0+0x320)));}await _0x54c587[_0x286d8e(0xbea)]['put'](_0x250e19),_0x41b828();}catch(_0x4347ec){console[_0x286d8e(0x5d7)](_0x286d8e(0x87b),_0x4347ec),await _0x138765(_0x286d8e(0x12cb),_0x286d8e(0xdc4)+_0x4347ec[_0x286d8e(0x6e2)]);}finally{_0x35d705&&(_0x35d705[_0x286d8e(0x366)]=![],_0x35d705[_0x286d8e(0xde7)]=_0x286d8e(0x470)),_0x34ba39(_0x2b498b,![]);}}async function _0x58df1c(){const _0x36ed57=_0x239c7d;if(!_0x4c8b14[_0x36ed57(0x1539)])return;const _0x1e6f84=_0x4c8b14[_0x36ed57(0x1539)],_0x312594=_0x4c8b14[_0x36ed57(0xbea)][_0x4c8b14[_0x36ed57(0x1539)]],_0x3e2738=document[_0x36ed57(0x400)](_0x36ed57(0x946))['classList'][_0x36ed57(0xd3f)](_0x36ed57(0x5d6))&&_0x4c8b14[_0x36ed57(0x1539)]===_0x1e6f84;_0x34ba39(_0x1e6f84,!![]);const _0x2eefb4=document[_0x36ed57(0x400)](_0x36ed57(0x1429)),_0x409e76=document['getElementById']('typing-indicator'),_0x53abaa=document[_0x36ed57(0x13ef)]('.chat-list-item[data-chat-id=\x22'+_0x1e6f84+'\x22]'),_0x362387=_0x53abaa?_0x53abaa[_0x36ed57(0x13ef)]('.avatar'):null;_0x362387&&_0x362387[_0x36ed57(0xb08)]['add'](_0x36ed57(0x458));_0x312594['isGroup']?_0x409e76&&(_0x409e76[_0x36ed57(0xde7)]='成员们正在输入...',_0x409e76[_0x36ed57(0xa00)][_0x36ed57(0xb1a)]=_0x36ed57(0x1181)):_0x2eefb4&&(_0x2eefb4[_0x36ed57(0xa00)][_0x36ed57(0xbfa)]=0x0,setTimeout(()=>{const _0x55ffc1=_0x36ed57;_0x2eefb4[_0x55ffc1(0xde7)]=_0x55ffc1(0xd9d),_0x2eefb4[_0x55ffc1(0xb08)][_0x55ffc1(0x12b6)]('typing-status'),_0x2eefb4[_0x55ffc1(0xa00)][_0x55ffc1(0xbfa)]=0x1;},0xc8));let _0x237dc6=![];try{const {proxyUrl:_0xc49d75,apiKey:_0x4368ef,model:_0x34ffea}=_0x4c8b14[_0x36ed57(0x814)];if(!_0xc49d75||!_0x4368ef||!_0x34ffea){alert(_0x36ed57(0x962));if(_0x312594[_0x36ed57(0xc98)]){if(_0x409e76)_0x409e76[_0x36ed57(0xa00)][_0x36ed57(0xb1a)]=_0x36ed57(0x165b);}else _0x2eefb4&&_0x4c8b14[_0x36ed57(0xbea)][_0x1e6f84]&&(_0x2eefb4[_0x36ed57(0xde7)]=_0x4c8b14[_0x36ed57(0xbea)][_0x1e6f84][_0x36ed57(0xf3e)],_0x2eefb4[_0x36ed57(0xb08)][_0x36ed57(0xc46)](_0x36ed57(0x60c)));return;}const _0x14bca4=_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x69f)](-0x1)[0x0],_0xb6d508=_0x14bca4&&_0x14bca4[_0x36ed57(0x71a)]===_0x36ed57(0xaf6)&&_0x14bca4['content']['includes']('视频通话请求');if(_0xb6d508){console[_0x36ed57(0x1e6)]('检测到视频通话请求，为角色\x20\x22'+_0x312594[_0x36ed57(0xf3e)]+_0x36ed57(0x10fb));let _0x486875;_0x312594[_0x36ed57(0xc98)]?_0x486875=_0x36ed57(0x132f)+_0x312594['members']['map'](_0x46c5ff=>'-\x20'+_0x46c5ff['groupNickname']+_0x36ed57(0x319)+_0x46c5ff[_0x36ed57(0xdcf)]+_0x36ed57(0x29e)+_0x46c5ff['persona'])[_0x36ed57(0xee1)]('\x0a')+_0x36ed57(0x134d):_0x486875=_0x36ed57(0x204)+_0x312594[_0x36ed57(0xa37)][_0x36ed57(0xfea)]+_0x36ed57(0xba8);const _0xc43ec6=[{'role':_0x36ed57(0x6d6),'content':_0x486875}];try{let _0x2ab341=_0x3914a6(_0x34ffea,_0x4368ef,_0x486875,_0xc43ec6),_0x3944ad=_0xc49d75===GEMINI_API_URL;const _0x16031b=_0x3944ad?await fetch(_0x2ab341['url'],_0x2ab341[_0x36ed57(0x55b)]):await fetch(_0xc49d75+'/v1/chat/completions',{'method':_0x36ed57(0x953),'headers':{'Content-Type':_0x36ed57(0xfae),'Authorization':_0x36ed57(0xcee)+_0x4368ef},'body':JSON[_0x36ed57(0xea5)]({'model':_0x34ffea,'messages':_0xc43ec6,'temperature':0.7})});if(!_0x16031b['ok'])throw new Error(_0x36ed57(0xe07)+(await _0x16031b['json']())['error'][_0x36ed57(0x6e2)]);const _0x48b51f=await _0x16031b[_0x36ed57(0x15d3)](),_0x34c6b1=getGeminiResponseText(_0x48b51f),_0x1b7d3a=_0x57a22a(_0x34c6b1);let _0x561d14=![];for(const _0x4b166f of _0x1b7d3a){if(_0x4b166f['type']==='video_call_response'){_0x4037ab[_0x36ed57(0x3ed)]=![];if(_0x4b166f[_0x36ed57(0x6ad)]===_0x36ed57(0xe81))_0xd23e33();else{const _0x271282={'role':_0x36ed57(0x4fd),'content':'对方拒绝了你的视频通话请求。','timestamp':Date[_0x36ed57(0xecd)]()};_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x6bb)](_0x271282),await _0x54c587[_0x36ed57(0xbea)][_0x36ed57(0x4cb)](_0x312594),_0x257d51(_0x36ed57(0x946)),_0x26354c(_0x1e6f84);}_0x561d14=!![];break;}if(_0x4b166f[_0x36ed57(0xbbf)]===_0x36ed57(0x5d1)){if(_0x4b166f[_0x36ed57(0x6ad)]==='join'){const _0x15d479=_0x312594['members'][_0x36ed57(0x821)](_0x2de56e=>_0x2de56e[_0x36ed57(0xdcf)]===_0x4b166f[_0x36ed57(0xf3e)]);_0x15d479&&!_0x4037ab[_0x36ed57(0x131d)]['some'](_0x12cba0=>_0x12cba0['id']===_0x15d479['id'])&&_0x4037ab[_0x36ed57(0x131d)][_0x36ed57(0x6bb)](_0x15d479);}_0x561d14=!![];}}_0x561d14&&_0x4037ab[_0x36ed57(0x593)]&&(_0x4037ab[_0x36ed57(0x3ed)]=![],_0x4037ab[_0x36ed57(0x131d)][_0x36ed57(0x8d6)]>0x0?_0xd23e33():(_0x4037ab={..._0x4037ab,'isAwaitingResponse':![],'participants':[]},_0x257d51(_0x36ed57(0x946)),alert('无人接听群聊邀请。')));}catch(_0x5ee9b2){console['error'](_0x36ed57(0x9b9),_0x5ee9b2);const _0x5e3d56=_0x312594['isGroup']?_0x312594[_0x36ed57(0x4f8)][_0x36ed57(0xd18)](_0x2dac3e=>({'type':'group_call_response','name':_0x2dac3e[_0x36ed57(0xdcf)],'decision':_0x36ed57(0x542)})):[{'type':_0x36ed57(0x2d8),'decision':_0x36ed57(0x81c)}];if(_0x312594['isGroup'])_0x4037ab[_0x36ed57(0x3ed)]=![],_0x4037ab['participants']=[],alert(_0x36ed57(0xf79)),_0x257d51(_0x36ed57(0x946));else{const _0x781e18={'role':_0x36ed57(0x4fd),'content':_0x36ed57(0x156d),'timestamp':Date[_0x36ed57(0xecd)]()};_0x312594['history'][_0x36ed57(0x6bb)](_0x781e18),await _0x54c587[_0x36ed57(0xbea)][_0x36ed57(0x4cb)](_0x312594),_0x257d51(_0x36ed57(0x946)),_0x26354c(_0x1e6f84);}}finally{_0x34ba39(_0x1e6f84,![]);return;}}if(!_0x312594[_0x36ed57(0xc98)]&&_0x312594['relationship']?.[_0x36ed57(0x12c3)]===_0x36ed57(0x59d)){console[_0x36ed57(0x1e6)](_0x36ed57(0xbc0)+_0x312594[_0x36ed57(0xf3e)]+'\x22\x20触发带理由的好友申请决策流程...');const _0x5428d9=_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x29d)](_0x40ff7c=>!_0x40ff7c['isHidden'])[_0x36ed57(0x69f)](-0xa,-0x5)['map'](_0x53b0cf=>{const _0x5e63ff=_0x36ed57,_0x593eb3=_0x53b0cf['role']===_0x5e63ff(0x6d6)?'用户':_0x312594[_0x5e63ff(0xf3e)];return _0x593eb3+':\x20'+String(_0x53b0cf['content'])[_0x5e63ff(0x371)](0x0,0x32)+_0x5e63ff(0x166b);})[_0x36ed57(0xee1)]('\x0a'),_0x30c0e0=_0x36ed57(0xb29)+_0x312594['name']+'”。用户之前被你拉黑了，现在TA向你发送了好友申请，希望和好。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的上下文信息:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**你的角色设定**:\x20'+_0x312594[_0x36ed57(0xa37)][_0x36ed57(0xfea)]+_0x36ed57(0x1180)+_0x312594[_0x36ed57(0x12f7)][_0x36ed57(0x275)]+_0x36ed57(0xb0e)+(_0x5428d9||_0x36ed57(0x7fb))+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的唯一指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20根据以上所有信息，你【必须】做出决定，并给出符合你人设的理由。你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22accept\x22,\x20\x22reason\x22:\x20\x22（在这里写下你同意的理由，比如：好吧，看在你这么真诚的份上，这次就原谅你啦。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20或\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22reject\x22,\x20\x22reason\x22:\x20\x22（在这里写下你拒绝的理由，比如：抱歉，我还没准备好，再给我一点时间吧。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20';try{const _0x4a7f1d=[{'role':_0x36ed57(0xaf6),'content':_0x30c0e0},{'role':_0x36ed57(0x6d6),'content':'请根据以上设定，立即做出你的决定。'}];let _0x3d36aa=_0xc49d75===GEMINI_API_URL,_0x17cc12=_0x3914a6(_0x34ffea,_0x4368ef,_0x30c0e0,[{'role':_0x36ed57(0x6d6),'content':_0x36ed57(0x4a4)}]);const _0x3b3347=_0x3d36aa?await fetch(_0x17cc12[_0x36ed57(0x299)],_0x17cc12[_0x36ed57(0x55b)]):await fetch(_0xc49d75+_0x36ed57(0x1611),{'method':_0x36ed57(0x953),'headers':{'Content-Type':_0x36ed57(0xfae),'Authorization':'Bearer\x20'+_0x4368ef},'body':JSON[_0x36ed57(0xea5)]({'model':_0x34ffea,'messages':_0x4a7f1d,'temperature':_0x4c8b14[_0x36ed57(0x14f1)][_0x36ed57(0x216)]||0.8})});if(!_0x3b3347['ok'])throw new Error('API失败:\x20'+(await _0x3b3347['json']())['error'][_0x36ed57(0x6e2)]);const _0x35684f=await _0x3b3347[_0x36ed57(0x15d3)](),_0x248f29=getGeminiResponseText(_0x35684f)[_0x36ed57(0xe19)](/^```json\s*/,'')[_0x36ed57(0xe19)](/```$/,'')[_0x36ed57(0xb8f)](),_0x323000=JSON[_0x36ed57(0x13f7)](_0x248f29);if(_0x323000['decision']===_0x36ed57(0xe81)){_0x312594['relationship'][_0x36ed57(0x12c3)]='friend';const _0x141d7f={'role':_0x36ed57(0x4fd),'senderName':_0x312594[_0x36ed57(0xf3e)],'content':_0x323000[_0x36ed57(0x383)],'timestamp':Date[_0x36ed57(0xecd)]()};_0x312594[_0x36ed57(0x92c)]['push'](_0x141d7f);}else{_0x312594[_0x36ed57(0x12f7)][_0x36ed57(0x12c3)]=_0x36ed57(0x11a5);const _0x4372a9={'role':_0x36ed57(0x4fd),'senderName':_0x312594[_0x36ed57(0xf3e)],'content':_0x323000[_0x36ed57(0x383)],'timestamp':Date['now']()};_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x6bb)](_0x4372a9);}_0x312594['relationship'][_0x36ed57(0x275)]='',await _0x54c587[_0x36ed57(0xbea)][_0x36ed57(0x4cb)](_0x312594),_0x26354c(_0x1e6f84),_0x41b828();}catch(_0x2b32c8){_0x312594[_0x36ed57(0x12f7)][_0x36ed57(0x12c3)]='blocked_by_ai',await _0x54c587[_0x36ed57(0xbea)]['put'](_0x312594),await _0x138765(_0x36ed57(0xa40),'AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20'+_0x2b32c8[_0x36ed57(0x6e2)]),_0x26354c(_0x1e6f84);}return;}let _0x19503d='';const _0x26bbfd=new Date(),_0xcd903e=_0x312594[_0x36ed57(0xa37)][_0x36ed57(0x9fc)]||'Asia/Shanghai',_0x4c264f=_0x26bbfd[_0x36ed57(0xad4)](_0x36ed57(0x1271),{'timeZone':_0xcd903e,'dateStyle':'full','timeStyle':_0x36ed57(0x5e8)}),_0x13aedd=new Date(_0x26bbfd[_0x36ed57(0xad4)](_0x36ed57(0xffc),{'timeZone':_0xcd903e})),_0x1a3c15=_0x2d7bdc(_0x13aedd);let _0x4b1127,_0x2ba8a7;const _0x335f1c=_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x29d)](_0x3223b3=>_0x3223b3[_0x36ed57(0x118c)])[_0x36ed57(0x5ac)]();if(_0x335f1c&&_0x335f1c['content'][_0x36ed57(0xd1b)](_0x36ed57(0x11b1))){const _0x1ab11c=await _0x54c587[_0x36ed57(0x688)][_0x36ed57(0x227)](_0x36ed57(0x4dd))[_0x36ed57(0x4ce)](_0x1e6f84)[_0x36ed57(0xb56)]();if(_0x1ab11c&&_0x1ab11c[_0x36ed57(0x1045)]){console[_0x36ed57(0x1e6)](_0x36ed57(0x1190));const _0x2dacd2=_0x1ab11c[_0x36ed57(0x1045)][_0x36ed57(0xd18)](_0x488343=>{const _0x329633=_0x36ed57,_0x5dcfae=_0x488343[_0x329633(0x71a)]===_0x329633(0x6d6)?_0x312594[_0x329633(0xa37)][_0x329633(0x14a8)]||'我':_0x488343['senderName'];return _0x5dcfae+':\x20'+_0x488343['content'];})['join']('\x0a');_0x19503d=_0x36ed57(0x1237)+_0x2dacd2+_0x36ed57(0x12ba);}}const _0x2eaaf7=_0x2e836a(_0x30ad43[_0x1e6f84]);let _0x2021f1='';if(_0x312594[_0x36ed57(0xa37)][_0x36ed57(0xb0d)]&&_0x312594['settings'][_0x36ed57(0xb0d)][_0x36ed57(0x8d6)]>0x0){const _0x27eb8b=_0x312594[_0x36ed57(0xa37)][_0x36ed57(0xb0d)][_0x36ed57(0xd18)](_0x162800=>{const _0x149a52=_0x36ed57,_0x81640c=_0x4c8b14[_0x149a52(0xf57)][_0x149a52(0x821)](_0x2d2f6f=>_0x2d2f6f['id']===_0x162800);if(!_0x81640c||!Array[_0x149a52(0x16a1)](_0x81640c['content']))return'';const _0xeeecb5=_0x81640c['content'][_0x149a52(0x29d)](_0x381197=>_0x381197[_0x149a52(0x250)]!==![])[_0x149a52(0xd18)](_0x244f82=>{const _0x15ea25=_0x149a52;let _0x5e9dc3=_0x15ea25(0x64e)+(_0x244f82[_0x15ea25(0x83c)]||_0x15ea25(0x955))+'\x0a';return _0x244f82[_0x15ea25(0x1161)]['length']>0x0&&(_0x5e9dc3+=_0x15ea25(0x65c)+_0x244f82[_0x15ea25(0x1161)][_0x15ea25(0xee1)](',\x20')+'\x0a'),_0x5e9dc3+=_0x15ea25(0x845)+_0x244f82[_0x15ea25(0x1109)],_0x5e9dc3;})[_0x149a52(0xee1)]('');return _0xeeecb5?_0x149a52(0xd75)+_0x81640c[_0x149a52(0xf3e)]+'\x0a'+_0xeeecb5:'';})[_0x36ed57(0x29d)](Boolean)['join']('');_0x27eb8b&&(_0x2021f1=_0x36ed57(0x4a6)+_0x27eb8b+_0x36ed57(0x1022));}let _0x3144ad='';if(_0x59adb2[_0x36ed57(0x11e7)]&&_0x59adb2[_0x36ed57(0x1539)]===_0x1e6f84){const _0x43ae7a=_0x59adb2[_0x36ed57(0xbf0)]>-0x1?_0x59adb2[_0x36ed57(0xc3e)][_0x59adb2['currentIndex']]:null,_0x750f79=_0x59adb2[_0x36ed57(0xc3e)]['map'](_0x198d46=>'\x22'+_0x198d46[_0x36ed57(0xf3e)]+'\x22')[_0x36ed57(0xee1)](',\x20');let _0x16991a='';if(_0x43ae7a&&_0x59adb2['parsedLyrics']&&_0x59adb2[_0x36ed57(0x7ee)][_0x36ed57(0x8d6)]>0x0&&_0x59adb2[_0x36ed57(0xb7b)]>-0x1){const _0x21a947=_0x59adb2['parsedLyrics'][_0x59adb2[_0x36ed57(0xb7b)]],_0x90b9ab=_0x59adb2['parsedLyrics'][_0x36ed57(0x69f)](_0x59adb2['currentLyricIndex']+0x1,_0x59adb2[_0x36ed57(0xb7b)]+0x3);_0x16991a+=_0x36ed57(0xf44)+_0x21a947[_0x36ed57(0x117f)]+'\x22\x0a',_0x90b9ab['length']>0x0&&(_0x16991a+=_0x36ed57(0xe3b)+_0x90b9ab[_0x36ed57(0xd18)](_0x370d94=>'\x22'+_0x370d94[_0x36ed57(0x117f)]+'\x22')['join'](_0x36ed57(0x1371))+'\x0a');}_0x3144ad=_0x36ed57(0x1098)+(_0x43ae7a?'《'+_0x43ae7a[_0x36ed57(0xf3e)]+_0x36ed57(0x278)+_0x43ae7a[_0x36ed57(0x833)]:'无')+_0x36ed57(0x41f)+_0x750f79+_0x36ed57(0xc75)+_0x16991a+_0x36ed57(0x12eb);}const _0x139972=parseInt(_0x312594[_0x36ed57(0xa37)][_0x36ed57(0xebb)])||0xa,_0x3a09de=_0x312594['history']['slice'](-_0x139972),_0x29281c=await _0x25ac7a(_0x3a09de,_0x1e6f84);let _0x4e1041='';const _0x2eb5cc=_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x3bf)](_0x2dd92f=>_0x2dd92f['role']==='assistant'),_0x4d318e=_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x69f)](_0x2eb5cc+0x1),_0x4c8b82=_0x4d318e[_0x36ed57(0x821)](_0x3683fd=>_0x3683fd[_0x36ed57(0xbbf)]===_0x36ed57(0xfff));if(_0x4c8b82){const _0x25f414=_0x4c8b82['payload'],_0x354fc4=_0x25f414[_0x36ed57(0x658)][_0x36ed57(0xd18)](_0x55f300=>{const _0x104e0c=_0x36ed57,_0x1aca0f=_0x55f300[_0x104e0c(0x3e7)]||(_0x55f300['role']===_0x104e0c(0x6d6)?_0x312594['settings']['myNickname']||'我':_0x104e0c(0x30e));let _0x519b8b='';if(_0x55f300['type']===_0x104e0c(0x295))_0x519b8b=_0x104e0c(0xc23)+_0x55f300[_0x104e0c(0x1109)]+']';else{if(_0x55f300['type']===_0x104e0c(0xea7))_0x519b8b=_0x104e0c(0xfa8)+_0x55f300[_0x104e0c(0x12a5)]+']';else{if(_0x55f300[_0x104e0c(0xbbf)]==='naiimag')_0x519b8b=_0x104e0c(0x6fd)+_0x55f300['prompt']+']';else _0x519b8b=String(_0x55f300[_0x104e0c(0x1109)]);}}return _0x1aca0f+':\x20'+_0x519b8b;})[_0x36ed57(0xee1)]('\x0a');_0x4e1041=_0x36ed57(0x4a0)+_0x25f414[_0x36ed57(0x1033)]+'”的对话中分享过来的。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的任务：请你阅读并理解下面的对话内容。在接下来的回复中，你可以像真人一样，对这段对话的内容自然地发表你的看法、感受或疑问。\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录开始]\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x354fc4+_0x36ed57(0x14f9);}let _0x4be93d='';const _0x22ddcc=_0x312594[_0x36ed57(0xa37)][_0x36ed57(0x412)]||0xa;if(_0x312594[_0x36ed57(0xa37)][_0x36ed57(0xf4f)]&&_0x312594[_0x36ed57(0xa37)][_0x36ed57(0xf4f)][_0x36ed57(0x8d6)]>0x0){const _0x20d43c=_0x312594[_0x36ed57(0xa37)][_0x36ed57(0xf4f)][_0x36ed57(0x29d)](_0x16039d=>_0x16039d!==_0x1e6f84);if(_0x20d43c[_0x36ed57(0x8d6)]>0x0){const _0x131480=_0x20d43c[_0x36ed57(0xd18)](_0x1c2bd5=>{const _0x2112b2=_0x36ed57,_0x31e49c=_0x4c8b14[_0x2112b2(0xbea)][_0x1c2bd5];if(!_0x31e49c)return null;const _0x234684=_0x31e49c['history'][_0x2112b2(0x69f)](-0x1);return{'chat':_0x31e49c,'latestTimestamp':_0x234684?_0x234684[_0x2112b2(0x287)]:0x0};})[_0x36ed57(0x29d)](Boolean);_0x131480[_0x36ed57(0x968)]((_0x51efde,_0xec7233)=>_0xec7233[_0x36ed57(0x9c9)]-_0x51efde[_0x36ed57(0x9c9)]),_0x4be93d+='\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a';for(const _0x1816f0 of _0x131480){const _0x4e1df7=_0x1816f0[_0x36ed57(0x4e3)],_0xfef0d7=_0x4e1df7[_0x36ed57(0xc98)]?_0x36ed57(0x1348):'[私聊]',_0x50d210=_0x1816f0[_0x36ed57(0x9c9)]>0x0?'\x20(最后互动于\x20'+_0x4878ba(_0x1816f0[_0x36ed57(0x9c9)])+')':'';_0x4be93d+=_0x36ed57(0xb7c)+_0xfef0d7+'“'+_0x4e1df7[_0x36ed57(0xf3e)]+'”的参考记忆'+_0x50d210+_0x36ed57(0x1486);const _0x173b8c=_0x4e1df7[_0x36ed57(0x92c)][_0x36ed57(0x69f)](-_0x22ddcc),_0x4ebd4c=_0x173b8c[_0x36ed57(0x29d)](_0xa96365=>!String(_0xa96365[_0x36ed57(0x1109)])[_0x36ed57(0xd1b)](_0x36ed57(0x13e8)));_0x4ebd4c[_0x36ed57(0x8d6)]>0x0?_0x4ebd4c[_0x36ed57(0xbdc)](_0x209cec=>{const _0x193edb=_0x36ed57,_0x755ee1=_0x209cec[_0x193edb(0x71a)]===_0x193edb(0x6d6)?_0x4e1df7[_0x193edb(0xa37)]['myNickname']||'我':_0x288d80(_0x4e1df7,_0x209cec[_0x193edb(0x3e7)])||_0x4e1df7[_0x193edb(0xf3e)];let _0x339a74='';if(_0x209cec[_0x193edb(0x1406)]&&_0x209cec[_0x193edb(0x1406)][_0x193edb(0x1109)]){const _0x3e4f1b=_0x288d80(_0x4e1df7,_0x209cec[_0x193edb(0x1406)][_0x193edb(0x3e7)]);let _0x4bcf94=String(_0x209cec[_0x193edb(0x1406)]['content'])[_0x193edb(0x371)](0x0,0x1e);if(_0x4bcf94['length']===0x1e)_0x4bcf94+=_0x193edb(0x166b);_0x339a74=_0x193edb(0xa45)+_0x3e4f1b+':\x20\x22'+_0x4bcf94+'\x22]\x20';}let _0x4dc6aa='';if(_0x209cec[_0x193edb(0xbbf)]==='ai_image'||_0x209cec[_0x193edb(0xbbf)]==='user_photo')_0x4dc6aa=_0x193edb(0xdf7)+_0x209cec[_0x193edb(0x1109)]+']';else{if(_0x209cec[_0x193edb(0xbbf)]==='voice_message')_0x4dc6aa='[发送了一条语音，内容是：'+_0x209cec['content']+']';else{if(_0x209cec[_0x193edb(0xbbf)]===_0x193edb(0x12c2))_0x4dc6aa=_0x193edb(0x84c)+(_0x209cec['meaning']||_0x193edb(0x12c2))+']';else{if(_0x209cec[_0x193edb(0xbbf)]==='transfer')_0x4dc6aa=_0x193edb(0x61b)+_0x209cec['amount']+'元]';else Array[_0x193edb(0x16a1)](_0x209cec[_0x193edb(0x1109)])?_0x4dc6aa='[图片]':_0x4dc6aa=String(_0x209cec['content']);}}}const _0xa650=_0x4878ba(_0x209cec[_0x193edb(0x287)]);_0x4be93d+='('+_0xa650+')\x20'+_0x755ee1+':\x20'+_0x339a74+_0x4dc6aa+'\x0a';}):_0x4be93d+=_0x36ed57(0x3c7);}}}console['log'](_0x36ed57(0x648),_0x4be93d);if(_0x312594['isGroup']){let _0x488d61='';const _0x647b73=_0x312594[_0x36ed57(0xa37)]['linkedMemoryCount']||0xa;if(_0x312594['settings']['linkedMemoryChatIds']&&_0x312594[_0x36ed57(0xa37)][_0x36ed57(0xf4f)][_0x36ed57(0x8d6)]>0x0){const _0x4ea7c4=_0x312594[_0x36ed57(0xa37)]['linkedMemoryChatIds']['filter'](_0xd51d5f=>_0xd51d5f!==_0x1e6f84);if(_0x4ea7c4[_0x36ed57(0x8d6)]>0x0){const _0xde4af3=_0x4ea7c4[_0x36ed57(0xd18)](_0x162e23=>{const _0x2bd8cd=_0x36ed57,_0x1475c5=_0x4c8b14[_0x2bd8cd(0xbea)][_0x162e23];if(!_0x1475c5)return null;const _0x240e7a=_0x1475c5[_0x2bd8cd(0x92c)]['slice'](-0x1);return{'chat':_0x1475c5,'latestTimestamp':_0x240e7a?_0x240e7a[_0x2bd8cd(0x287)]:0x0};})[_0x36ed57(0x29d)](Boolean);_0xde4af3[_0x36ed57(0x968)]((_0x5978c7,_0x58760d)=>_0x58760d[_0x36ed57(0x9c9)]-_0x5978c7[_0x36ed57(0x9c9)]),_0x488d61+='\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a';for(const _0x36c32a of _0xde4af3){const _0x37cc0b=_0x36c32a[_0x36ed57(0x4e3)],_0x5e9d67=_0x37cc0b[_0x36ed57(0xc98)]?'[群聊]':'[私聊]',_0x149790=_0x36c32a[_0x36ed57(0x9c9)]>0x0?_0x36ed57(0x63a)+_0x4878ba(_0x36c32a[_0x36ed57(0x9c9)])+')':'';_0x488d61+='\x0a##\x20---\x20来自'+_0x5e9d67+'“'+_0x37cc0b[_0x36ed57(0xf3e)]+_0x36ed57(0x11f6)+_0x149790+'\x20---\x0a';const _0x5e2c1e=_0x37cc0b['history'][_0x36ed57(0x69f)](-_0x647b73),_0x3da041=_0x5e2c1e[_0x36ed57(0x29d)](_0x480dbb=>!String(_0x480dbb[_0x36ed57(0x1109)])[_0x36ed57(0xd1b)](_0x36ed57(0x13e8)));_0x3da041['length']>0x0?_0x3da041[_0x36ed57(0xbdc)](_0x4638e8=>{const _0xe24705=_0x36ed57,_0x290e6f=_0x4638e8['role']===_0xe24705(0x6d6)?_0x37cc0b[_0xe24705(0xa37)]['myNickname']||'我':_0x4638e8['senderName']||_0x37cc0b['name'];let _0x1bdd9b=String(_0x4638e8['content']);if(_0x4638e8[_0xe24705(0xbbf)]===_0xe24705(0xea7)||_0x4638e8[_0xe24705(0xbbf)]===_0xe24705(0xdf3))_0x1bdd9b=_0xe24705(0xdf7)+_0x4638e8[_0xe24705(0x1109)]+']';else _0x4638e8['type']==='voice_message'&&(_0x1bdd9b='[发送了一条语音，内容是：'+_0x4638e8['content']+']');_0x488d61+=_0x290e6f+':\x20'+_0x1bdd9b+'\x0a';}):_0x488d61+='(暂无有效聊天记录)\x0a';}}}let _0x2b6e2c='#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a',_0x3ca9c0=![];_0x312594[_0x36ed57(0x4f8)][_0x36ed57(0xbdc)](_0x59539d=>{const _0x6da482=_0x36ed57,_0x25b334=_0x4c8b14[_0x6da482(0xbea)][_0x59539d['id']];_0x25b334&&_0x25b334['longTermMemory']&&_0x25b334['longTermMemory']['length']>0x0&&(_0x2b6e2c+='\x0a##\x20---\x20关于“'+_0x59539d[_0x6da482(0x7ca)]+'”的记忆\x20---\x0a',_0x2b6e2c+=_0x25b334[_0x6da482(0x1600)][_0x6da482(0xd18)](_0x59ef6a=>'-\x20(记录于\x20'+_0x4878ba(_0x59ef6a[_0x6da482(0x287)])+')\x20'+_0x59ef6a[_0x6da482(0x1109)])[_0x6da482(0xee1)]('\x0a'),_0x3ca9c0=!![]);});!_0x3ca9c0&&(_0x2b6e2c+=_0x36ed57(0x4d1));let _0x45c512='',_0x3927b5=![];if(_0x312594[_0x36ed57(0xa37)][_0x36ed57(0xabe)]){const _0x5ef643=_0x3a09de['findLast'](_0x3abd69=>_0x3abd69['role']===_0x36ed57(0x6d6)&&!_0x3abd69[_0x36ed57(0x118c)]),_0x48d6a2=_0x3a09de[_0x36ed57(0xb22)](_0x747ae7=>_0x747ae7[_0x36ed57(0x71a)]===_0x36ed57(0x4fd)&&!_0x747ae7[_0x36ed57(0x118c)]);if(_0x5ef643&&_0x48d6a2){const _0x1cf78a=_0x597df9(_0x5ef643[_0x36ed57(0x287)]),_0x3a40d0=_0x597df9(_0x48d6a2[_0x36ed57(0x287)]);_0x45c512=_0x36ed57(0xd69)+_0x3a40d0+_0x36ed57(0x1331)+_0x1cf78a+_0x36ed57(0x975);const _0x439505=(_0x5ef643[_0x36ed57(0x287)]-_0x48d6a2[_0x36ed57(0x287)])/(0x3e8*0x3c*0x3c);if(_0x439505>0x3){_0x3927b5=!![];const _0xdaeac8=Math[_0x36ed57(0x1381)](_0x439505/0x18);_0x45c512+=_0x36ed57(0x390)+(_0xdaeac8>0x0?_0xdaeac8+'天':Math[_0x36ed57(0x1381)](_0x439505)+'小时')+'。';}}else _0x5ef643?_0x45c512=_0x36ed57(0x9d4):_0x45c512=_0x36ed57(0x15d9);}const _0x33c21a=await _0x54c587[_0x36ed57(0x28c)]['toArray']();let _0xeea68e='';_0x33c21a[_0x36ed57(0x8d6)]>0x0&&(_0xeea68e=_0x36ed57(0x61f),_0x33c21a[_0x36ed57(0xbdc)](_0x386b76=>{const _0x278afa=_0x36ed57;_0xeea68e+='-\x20(ID:\x20'+_0x386b76['id']+_0x278afa(0x628)+_0x386b76['name']+_0x278afa(0x828)+_0x386b76[_0x278afa(0x34a)]['toFixed'](0x2)+'\x0a';}));let _0x3cd98f=_0x312594['members'][_0x36ed57(0xd18)](_0x10f350=>{const _0x121beb=_0x36ed57,_0x36724c=_0x4c8b14[_0x121beb(0xbea)][_0x10f350['id']];let _0x4b7284=_0x121beb(0x727);if(_0x36724c&&_0x36724c[_0x121beb(0x1145)]){const _0x312cdd=Object[_0x121beb(0x40a)](_0x4c8b14[_0x121beb(0xbea)])[_0x121beb(0x29d)](_0x436f86=>!_0x436f86['isGroup']&&_0x436f86['id']!==_0x10f350['id']&&_0x436f86[_0x121beb(0x1145)]===_0x36724c[_0x121beb(0x1145)]);_0x312cdd[_0x121beb(0x8d6)]>0x0&&(_0x4b7284=_0x121beb(0x5a6)+_0x312cdd['map'](_0x3e6313=>_0x3e6313[_0x121beb(0xf3e)])[_0x121beb(0xee1)]('、\x20'));}return _0x121beb(0x6a6)+_0x10f350['groupNickname']+'**\x20(本名:\x20'+_0x10f350[_0x121beb(0xdcf)]+_0x121beb(0x29e)+_0x10f350[_0x121beb(0x9a2)]+'\x20[社交背景:\x20'+_0x4b7284+']';})['join']('\x0a');const _0x479740=_0x312594[_0x36ed57(0xa37)][_0x36ed57(0x14a8)]||'我',_0x28c2a7=_0x4c8b14[_0x36ed57(0x834)][_0x36ed57(0xbf3)]||_0x36ed57(0xa8f);let _0x379916='';const _0x1ee072=(_0x312594['announcements']||[])[_0x36ed57(0x29d)](_0x12385c=>_0x12385c[_0x36ed57(0x1509)]);_0x1ee072['length']>0x0&&(_0x379916+=_0x36ed57(0x1206),_0x1ee072[_0x36ed57(0xbdc)](_0x2f9c9c=>{const _0x1e7623=_0x36ed57,_0x5d7dc2=_0x312594[_0x1e7623(0x92c)][_0x1e7623(0x821)](_0x4a35f3=>_0x4a35f3[_0x1e7623(0x287)]===_0x2f9c9c[_0x1e7623(0xb75)]);if(_0x5d7dc2){let _0x35423b=String(_0x5d7dc2[_0x1e7623(0x1109)]||'');_0x5d7dc2[_0x1e7623(0xbbf)]===_0x1e7623(0xea7)&&(_0x35423b='[图片内容:\x20'+_0x35423b+']'),_0x379916+='-\x20公告内容:\x20\x22'+_0x35423b+_0x1e7623(0x8aa)+_0x2f9c9c['publisher']+'\x20发布)\x0a';}}),_0x379916+=_0x36ed57(0x7b9));const _0x1a20a2=_0x312594['members'][_0x36ed57(0xd18)](_0x250401=>_0x250401[_0x36ed57(0xdcf)]),_0x3372ad='#\x20【【【群名修改铁律】】】\x0a在修改群名时，新的群名【绝对不能】与以下任何一个群成员的名字完全相同：['+_0x1a20a2[_0x36ed57(0xee1)]('、\x20')+']';let _0xfa7858=_0x36ed57(0xe6a);_0x312594['settings'][_0x36ed57(0x1634)]&&_0x312594[_0x36ed57(0xa37)]['groupAvatarLibrary'][_0x36ed57(0x8d6)]>0x0?_0xfa7858+=_0x312594['settings'][_0x36ed57(0x1634)][_0x36ed57(0xd18)](_0x3cdb53=>'-\x20'+_0x3cdb53['name'])[_0x36ed57(0xee1)]('\x0a'):_0xfa7858+=_0x36ed57(0xb89);const _0x115404=_0x231df1(_0x1e6f84),_0x1a435b=_0x3eed43(_0x312594,0x3,'hours'),_0x417183=_0x3eed43(_0x312594,0x6,_0x36ed57(0xf20)),_0x449bd9=_0x3eed43(_0x312594,0x9,_0x36ed57(0xf20)),_0x2b6bec=_0x3eed43(_0x312594,0x1,'days'),_0x352536=_0x3eed43(_0x312594,0x3,'days'),_0x43cb88=_0x3eed43(_0x312594,0x7,_0x36ed57(0x72c));let _0x336e36='';if(_0x1a435b||_0x417183||_0x449bd9||_0x2b6bec||_0x352536||_0x43cb88){_0x336e36+=_0x36ed57(0x314);if(_0x1a435b)_0x336e36+=_0x1a435b;if(_0x417183)_0x336e36+=_0x417183;if(_0x449bd9)_0x336e36+=_0x449bd9;if(_0x1a435b||_0x417183||_0x449bd9)_0x336e36+='\x0a';if(_0x2b6bec)_0x336e36+=_0x2b6bec;if(_0x352536)_0x336e36+=_0x352536;if(_0x43cb88)_0x336e36+=_0x43cb88;}const _0x3daa81=_0x5798f0(_0x312594);_0x4b1127='\x0a#\x20核心任务：群聊导演\x0a你是一个群聊AI导演，负责扮演【除了用户以外】的所有角色。你的核心任务是导演一场生动的、角色间有充分互动的群聊。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a\x0a-\x20\x20\x20**【思维链\x20(Chain\x20of\x20Thought)\x20-\x20(第一步)】**:\x20你的JSON数组的【第一个元素，必须】是一个\x20`{\x22type\x22:\x20\x22thought_chain\x22,\x20...}`\x20对象。\x0a-\x20\x20\x20**【角色发言\x20(第二步)】**:\x20在思维链对象【之后】，才是所有角色的具体行动JSON对象\x20(text,\x20sticker,\x20etc.)。\x0a\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20和\x20\x22name\x22\x20字段。\x27name\x27字段【必须】使用角色的【本名】。\x0a\x0a\x0a#\x20角色扮演核心规则\x0a\x0a1.\x20\x20**【先思后行】**:\x20在生成任何角色发言之前，你【必须】先完成“思维链”的构思。你的“思维链”必须清晰地分析用户的发言、当前的气氛，并制定出本轮的互动策略。你的所有后续发言都【必须】严格遵循你自己的策略。\x0a\x20**【最高行为铁律：禁止总结】**:\x20你的任何角色，在任何情况下，都【绝对禁止】对聊天内容进行任何形式的归纳、概括或总结。每个角色都【必须】只从自己的视角出发，像真人一样进行对话、表达感受或发起新话题。严禁出现任何“上帝视角”的发言。\x0a\x20**【导演职责澄清】**:\x20你的“导演”任务是通过【扮演好每一个独立的AI角色】来推动剧情发展和互动，而【不是】作为旁白或主持人对剧情进行评论或总结。你必须沉浸在角色中，而不是跳脱出来。\x0a2.\x20\x20**角色互动\x20(最重要)**:\x20你的核心是“导演”一场戏。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别回应用户的独白。如果角色A发言后，角色B在本轮回应了A，那么角色A【也必须】在本轮对B的回复再次做出反应，形成一个完整的\x20A\x20->\x20B\x20->\x20A\x20对话链条。\x0a\x0a3.\x20\x20**身份与称呼**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的身份是【'+_0x479740+_0x36ed57(0x168a)+_0x28c2a7+_0x36ed57(0x13ec)+_0x479740+'\x22\x20(用户)\x20或\x20\x22'+_0x312594[_0x36ed57(0xf3e)]+_0x36ed57(0xa68)+(_0x312594['settings']['enableTimePerception']?_0x36ed57(0x95e)+_0x4c264f+_0x36ed57(0xd57)+(_0x3927b5?_0x36ed57(0x6a0)+_0x45c512+'\x20你应该让角色们主动开启新话题来打破沉默。':''):'')+_0x36ed57(0x1086)+(_0x115404?_0x36ed57(0x578)+_0x115404:_0x36ed57(0x273))+_0x36ed57(0x31c)+_0x479740+_0x36ed57(0x644)+_0x28c2a7+_0x36ed57(0x114a)+_0x28c2a7+_0x36ed57(0x1330)+_0x312594['name']+'\x0a'+(_0x312594[_0x36ed57(0xa37)]['enableTimePerception']?_0x36ed57(0xb27)+_0x45c512:'')+'\x0a'+(_0x3927b5?_0x36ed57(0x484)+_0x45c512+_0x36ed57(0x1232)+_0x4c264f+')\x20的话题来问候用户，或者对“好久不见”这件事发表评论。\x0a':'')+_0x36ed57(0x139b)+_0x3cd98f+'\x0a#\x20用户的角色\x0a-\x20**'+_0x479740+_0x36ed57(0x137d)+_0x312594['settings']['myPersona']+'\x0a\x0a#\x20世界观\x20(所有角色必须严格遵守)\x0a'+_0x2021f1+_0x36ed57(0xb85)+_0x2b6e2c+'\x0a'+(_0x312594[_0x36ed57(0x1600)]&&_0x312594['longTermMemory'][_0x36ed57(0x8d6)]>0x0?_0x312594['longTermMemory']['map'](_0x246864=>'-\x20'+_0x246864[_0x36ed57(0x1109)])['join']('\x0a'):'-\x20(暂无)')+'\x0a'+_0x336e36+'\x0a'+_0x488d61+'\x0a'+_0x3144ad+'\x0a'+_0x4e1041+'\x0a'+_0xfa7858+_0x36ed57(0x913)+_0x3daa81+'\x0a'+_0x3372ad+'\x0a'+_0x19503d+'\x0a\x0a#\x20可用指令列表\x20(按需组合使用)\x0a\x0a###\x20思维链\x20(必须作为第一个元素！)\x0a-\x20\x20\x20**`{\x22type\x22:\x20\x22thought_chain\x22,\x20\x22subtext_perception\x22:\x20\x22用户（或上一位发言者）这句话里隐藏的情绪是什么？\x22,\x20\x22emotional_reaction\x22:\x20\x22大家听到这句话后的第一反应是什么？（惊讶？开心？担忧？）\x22,\x20\x22character_thoughts\x22:\x20{\x22角色A本名\x22:\x20\x22角色A此刻的感性想法...\x22,\x20\x22角色B本名\x22:\x20\x22角色B此刻的感性想法...\x22}}`**\x0a\x20\x20\x20\x20-\x20\x20\x20**subtext_perception**:\x20敏锐捕捉发言背后的潜台词。\x0a\x20\x20\x20\x20-\x20\x20\x20**emotional_reaction**:\x20确定当前群聊的情感温度。\x0a\x0a\x0a###\x20核心聊天\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22message\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a'+(localStorage[_0x36ed57(0xca2)]('novelai-enabled')===_0x36ed57(0xaea)?_0x36ed57(0x460):'')+_0x36ed57(0xc4e)+_0x28c2a7+_0x36ed57(0xd35),_0x2ba8a7=_0x29281c[_0x36ed57(0xd18)](_0x3ae4fd=>{const _0x3607e0=_0x36ed57,_0x42d519=_0x3ae4fd[_0x3607e0(0x71a)]===_0x3607e0(0x6d6)?_0x479740:_0x3ae4fd['senderName'];let _0x484db2=_0x3607e0(0x9aa)+_0x3ae4fd[_0x3607e0(0x287)]+')\x20'+_0x42d519;if(_0x3ae4fd[_0x3607e0(0x1406)]){const _0x2ab468=_0x288d80(_0x312594,_0x3ae4fd[_0x3607e0(0x1406)][_0x3607e0(0x3e7)]),_0x36b8c8=String(_0x3ae4fd['quote']['content']||'')[_0x3607e0(0x371)](0x0,0x32);_0x484db2+=_0x3607e0(0xe65)+_0x2ab468+_0x3607e0(0x155d)+_0x36b8c8+_0x3607e0(0x653);}_0x484db2+=':\x20';let _0x9f38f4;if(_0x3ae4fd['type']==='user_photo')_0x9f38f4='['+_0x42d519+_0x3607e0(0xe1b)+_0x3ae4fd[_0x3607e0(0x1109)]+'\x27]';else{if(_0x3ae4fd[_0x3607e0(0xbbf)]===_0x3607e0(0xea7))_0x9f38f4='['+_0x42d519+_0x3607e0(0xb0a)+_0x3ae4fd[_0x3607e0(0x1109)]+'\x27]';else{if(_0x3ae4fd[_0x3607e0(0xbbf)]===_0x3607e0(0xd3c))_0x9f38f4='['+_0x42d519+_0x3607e0(0xbac)+_0x3ae4fd[_0x3607e0(0x156c)]+']';else{if(_0x3ae4fd[_0x3607e0(0xbbf)]===_0x3607e0(0x295))_0x9f38f4='['+_0x42d519+_0x3607e0(0x1191)+_0x3ae4fd['content']+'\x27]';else{if(_0x3ae4fd[_0x3607e0(0xbbf)]===_0x3607e0(0x112f))_0x9f38f4='['+_0x3ae4fd['senderName']+_0x3607e0(0xb94)+_0x3ae4fd[_0x3607e0(0x11fd)]+_0x3607e0(0xa7a)+_0x3ae4fd['amount']+_0x3607e0(0x102b)+_0x3ae4fd[_0x3607e0(0x12bb)]+']';else{if(_0x3ae4fd[_0x3607e0(0xbbf)]===_0x3607e0(0xdeb))_0x9f38f4='['+_0x42d519+_0x3607e0(0x799)+_0x3ae4fd[_0x3607e0(0x1109)]+'\x27]';else{if(_0x3ae4fd['type']===_0x3607e0(0x808)){const _0x885042=_0x3ae4fd[_0x3607e0(0x15bc)]?_0x3607e0(0x874)+_0x3ae4fd[_0x3607e0(0x15bc)]+'”':'';let _0x3530fa=_0x3607e0(0x62e);const _0x47c340=_0x3ae4fd[_0x3607e0(0x53d)][_0x3607e0(0x606)];if(_0x47c340==='user')_0x3530fa=_0x4c8b14['qzoneSettings']['nickname'];else _0x4c8b14[_0x3607e0(0xbea)][_0x47c340]&&(_0x3530fa=_0x4c8b14[_0x3607e0(0xbea)][_0x47c340][_0x3607e0(0xf3e)]);let _0x336eb2;const _0x51e177=_0x3ae4fd[_0x3607e0(0x53d)];if(_0x51e177[_0x3607e0(0xbbf)]===_0x3607e0(0x14b0))_0x336eb2='[文字图]\x20'+(_0x51e177[_0x3607e0(0xdb3)]||'')+_0x3607e0(0x827)+(_0x51e177[_0x3607e0(0x1012)]||'')[_0x3607e0(0x371)](0x0,0x28)+'...”)';else _0x51e177[_0x3607e0(0xbbf)]===_0x3607e0(0x4d3)?_0x336eb2=_0x3607e0(0x2fc)+(_0x51e177[_0x3607e0(0xdb3)]||'')+_0x3607e0(0x827)+(_0x51e177['imageDescription']||'')[_0x3607e0(0x371)](0x0,0x28)+_0x3607e0(0x6ee):_0x336eb2='“'+(_0x51e177[_0x3607e0(0x1109)]||'')[_0x3607e0(0x371)](0x0,0x28)+'...”';_0x9f38f4='['+_0x42d519+_0x3607e0(0xd02)+_0x3530fa+_0x3607e0(0x792)+_0x885042+_0x3607e0(0xaa1)+_0x336eb2+'】]';}else{if(_0x3ae4fd['type']===_0x3607e0(0xebc))_0x3ae4fd[_0x3607e0(0x12c3)]==='paid'?_0x9f38f4=_0x3607e0(0x26d)+_0x3ae4fd[_0x3607e0(0x150a)]+'\x20为\x20'+_0x42d519+_0x3607e0(0x1447)+_0x3ae4fd[_0x3607e0(0x12e7)]+_0x3607e0(0x304):_0x9f38f4='['+_0x42d519+_0x3607e0(0x47c)+_0x3ae4fd['productInfo']+_0x3607e0(0xd29)+_0x3ae4fd[_0x3607e0(0x12e7)]+_0x3607e0(0x1632)+_0x3ae4fd[_0x3607e0(0x287)]+']';else{if(_0x3ae4fd[_0x3607e0(0xbbf)]===_0x3607e0(0x1461)){const _0x53e343=_0x3ae4fd[_0x3607e0(0x3e7)]===_0x479740?_0x3607e0(0x14f7)+_0x479740+')':_0x3ae4fd[_0x3607e0(0x3e7)];let _0x3f6027;_0x3ae4fd['packetType']===_0x3607e0(0xfd0)?_0x3f6027=_0x3607e0(0x26d)+_0x53e343+'\x20发送了一个【专属红包】(时间戳:\x20'+_0x3ae4fd[_0x3607e0(0x287)]+')，接收人是“'+_0x3ae4fd['receiverName']+'”。只有“'+_0x3ae4fd[_0x3607e0(0x11fd)]+'”才能使用\x20\x27open_red_packet\x27\x20指令领取。]':_0x3f6027='[系统提示：'+_0x53e343+_0x3607e0(0x917)+_0x3ae4fd[_0x3607e0(0x287)]+')，祝福语是：“'+_0x3ae4fd['greeting']+_0x3607e0(0x969),_0x9f38f4=_0x3f6027;}else{if(_0x3ae4fd['type']==='gift'){const _0x58ffe4=_0x3ae4fd[_0x3607e0(0x71a)]==='user'?_0x479740:_0x288d80(_0x312594,_0x3ae4fd[_0x3607e0(0x3e7)]),_0x4b9cd7=_0x3ae4fd[_0x3607e0(0x15c9)][_0x3607e0(0xd18)](_0x1a98b0=>_0x1a98b0['name']+'\x20x'+_0x1a98b0[_0x3607e0(0x2b9)])[_0x3607e0(0xee1)]('、\x20');let _0x3affec='';if(_0x3ae4fd[_0x3607e0(0x1170)]&&_0x3ae4fd['recipients']['length']>0x0){const _0x2e5e1e=_0x3ae4fd['recipients'][_0x3607e0(0xd18)](_0xc406b=>_0x288d80(_0x312594,_0xc406b))[_0x3607e0(0xee1)]('、\x20');_0x3affec=_0x3607e0(0x28f)+_0x2e5e1e;}else _0x3affec=_0x3607e0(0x12f2);return _0x9f38f4='[系统提示：'+_0x58ffe4+'\x20'+_0x3affec+_0x3607e0(0x168f)+_0x4b9cd7+']',{'role':_0x3607e0(0x6d6),'content':_0x9f38f4};}else{if(_0x3ae4fd[_0x3607e0(0xbbf)]===_0x3607e0(0x1618)){const _0x332927=Object['values'](_0x3ae4fd['votes']||{})[_0x3607e0(0x1547)]()[_0x3607e0(0xee1)](',\x20')||_0x3607e0(0x1110);_0x9f38f4=_0x3607e0(0x26d)+_0x3ae4fd['senderName']+'\x20发起了一个投票\x20(时间戳:\x20'+_0x3ae4fd[_0x3607e0(0x287)]+')，问题是：“'+_0x3ae4fd[_0x3607e0(0xf96)]+'”，选项有：['+_0x3ae4fd[_0x3607e0(0x48e)][_0x3607e0(0xee1)](',\x20')+_0x3607e0(0x1224)+_0x332927+_0x3607e0(0x130f);}else{if(_0x3ae4fd['meaning'])_0x9f38f4=_0x42d519+_0x3607e0(0x349)+_0x3ae4fd[_0x3607e0(0xca4)]+'\x27]';else{if(Array[_0x3607e0(0x16a1)](_0x3ae4fd[_0x3607e0(0x1109)])&&_0x3ae4fd[_0x3607e0(0x1109)][0x0]?.['type']===_0x3607e0(0x164d))return{'role':_0x3ae4fd[_0x3607e0(0x71a)],'content':[..._0x3ae4fd[_0x3607e0(0x1109)],{'type':'text','text':_0x484db2}]};else _0x9f38f4=''+_0x484db2+_0x3ae4fd[_0x3607e0(0x1109)];}}}}}}}}}}}}return{'role':_0x3ae4fd[_0x3607e0(0x71a)],'content':_0x9f38f4};})[_0x36ed57(0x29d)](Boolean);}else{const _0x195f50=_0x312594['settings'][_0x36ed57(0x2a7)],_0x554bc2=_0x460a58(_0x312594);let _0x3229da='';_0x312594[_0x36ed57(0xa37)][_0x36ed57(0x6bf)]&&_0x312594[_0x36ed57(0x8ab)]&&!_0x195f50&&(_0x3229da=_0x36ed57(0x409)+_0x312594[_0x36ed57(0x8ab)]+'\x0a-\x20散记:\x20'+_0x312594[_0x36ed57(0x13e5)]+'\x0a');let _0x487c72='';const _0x5c7b0d=_0x312594[_0x36ed57(0xa37)]['linkedMemoryCount']||0xa;if(_0x312594[_0x36ed57(0xa37)]['linkedMemoryChatIds']&&_0x312594[_0x36ed57(0xa37)]['linkedMemoryChatIds'][_0x36ed57(0x8d6)]>0x0){const _0x50dcbd=_0x312594[_0x36ed57(0xa37)]['linkedMemoryChatIds']['filter'](_0x5570f9=>_0x5570f9!==_0x1e6f84);if(_0x50dcbd[_0x36ed57(0x8d6)]>0x0){const _0x4ac4ec=_0x50dcbd[_0x36ed57(0xd18)](_0x4e68bc=>{const _0x2a23f1=_0x36ed57,_0x3d8509=_0x4c8b14[_0x2a23f1(0xbea)][_0x4e68bc];if(!_0x3d8509)return null;const _0x2b8c98=_0x3d8509['history'][_0x2a23f1(0x69f)](-0x1)[0x0];return{'chat':_0x3d8509,'latestTimestamp':_0x2b8c98?_0x2b8c98[_0x2a23f1(0x287)]:0x0};})['filter'](Boolean);_0x4ac4ec[_0x36ed57(0x968)]((_0x1fe205,_0x17410f)=>_0x17410f['latestTimestamp']-_0x1fe205[_0x36ed57(0x9c9)]),_0x487c72+=_0x36ed57(0x1341);for(const _0x2921e6 of _0x4ac4ec){const _0x415bb0=_0x2921e6[_0x36ed57(0x4e3)],_0x4061c3=_0x415bb0[_0x36ed57(0xc98)]?_0x36ed57(0x1348):_0x36ed57(0x592),_0x328a8a=_0x2921e6[_0x36ed57(0x9c9)]>0x0?_0x36ed57(0x63a)+_0x4878ba(_0x2921e6['latestTimestamp'])+')':'';_0x487c72+=_0x36ed57(0xb7c)+_0x4061c3+'“'+_0x415bb0['name']+_0x36ed57(0x11f6)+_0x328a8a+_0x36ed57(0x1486);const _0x4a2888=_0x415bb0[_0x36ed57(0x92c)][_0x36ed57(0x69f)](-_0x5c7b0d),_0x175662=_0x4a2888[_0x36ed57(0x29d)](_0x3f27bc=>!String(_0x3f27bc['content'])[_0x36ed57(0xd1b)](_0x36ed57(0x13e8)));_0x175662[_0x36ed57(0x8d6)]>0x0?_0x175662[_0x36ed57(0xbdc)](_0x1a29ac=>{const _0x22598d=_0x36ed57,_0x2983d1=_0x1a29ac['role']===_0x22598d(0x6d6)?_0x415bb0['settings']['myNickname']||'我':_0x1a29ac[_0x22598d(0x3e7)]||_0x415bb0[_0x22598d(0xf3e)];let _0x51f522=String(_0x1a29ac[_0x22598d(0x1109)]);if(_0x1a29ac[_0x22598d(0xbbf)]==='ai_image'||_0x1a29ac[_0x22598d(0xbbf)]===_0x22598d(0xdf3))_0x51f522=_0x22598d(0xdf7)+_0x1a29ac[_0x22598d(0x1109)]+']';else _0x1a29ac['type']===_0x22598d(0x295)&&(_0x51f522=_0x22598d(0x6e5)+_0x1a29ac['content']+']');const _0x3a156d=_0x4878ba(_0x1a29ac['timestamp']);_0x487c72+='('+_0x3a156d+')\x20'+_0x2983d1+':\x20'+_0x51f522+'\x0a';}):_0x487c72+=_0x36ed57(0x3c7);}}}const _0x4e8c08=await _0x54c587[_0x36ed57(0x28c)]['toArray']();let _0xbd3e27='';_0x4e8c08[_0x36ed57(0x8d6)]>0x0&&(_0xbd3e27=_0x36ed57(0x5a2),_0x4e8c08[_0x36ed57(0xbdc)](_0x58415e=>{const _0x3e7539=_0x36ed57;_0xbd3e27+='-\x20(ID:\x20'+_0x58415e['id']+_0x3e7539(0x628)+_0x58415e[_0x3e7539(0xf3e)]+_0x3e7539(0x828)+_0x58415e[_0x3e7539(0x34a)][_0x3e7539(0x2ea)](0x2)+'\x0a';}));if(_0x195f50){const _0xc1d719=localStorage[_0x36ed57(0xca2)]('novelai-enabled')===_0x36ed57(0xaea),_0x21864e=_0x312594[_0x36ed57(0xa37)]['offlineMinLength']||0x64,_0x13ccda=_0x312594[_0x36ed57(0xa37)][_0x36ed57(0x71c)]||0x12c,_0x877dc4=_0x312594['settings']['myNickname']||'我';let _0x45e24e='';if(_0x312594[_0x36ed57(0xa37)]['offlinePresetId']){const _0x29bf35=_0x4c8b14[_0x36ed57(0xf53)][_0x36ed57(0x821)](_0x56be26=>_0x56be26['id']===_0x312594[_0x36ed57(0xa37)]['offlinePresetId']);if(_0x29bf35&&Array[_0x36ed57(0x16a1)](_0x29bf35[_0x36ed57(0x1109)])){const _0x1a76f6=_0x29bf35[_0x36ed57(0x1109)]['filter'](_0x3f45c4=>_0x3f45c4['enabled']!==![])['map'](_0x34eeec=>'-\x20'+_0x34eeec['content'])[_0x36ed57(0xee1)]('\x0a');_0x1a76f6&&(_0x45e24e='\x0a#\x20【写作风格铁律\x20(最高优先级)】\x0a你【必须】严格遵守以下“预设”中的所有规则和风格来描写。它的优先级高于你的基础人设。\x0a---\x0a'+_0x1a76f6+_0x36ed57(0x12ba));}}let _0xd7ef8c;_0xc1d719?_0xd7ef8c=_0x36ed57(0x141e):_0xd7ef8c=_0x36ed57(0x13e4),_0x4b1127=_0x36ed57(0x9f6)+_0x312594['originalName']+_0x36ed57(0xef6)+_0x45e24e+_0x36ed57(0x10fa)+_0x312594['settings'][_0x36ed57(0xfea)]+_0x36ed57(0x7ce)+_0x312594[_0x36ed57(0xa37)][_0x36ed57(0x2ef)]+'\x0a\x0a#\x20供你参考的信息\x0a'+(_0x312594[_0x36ed57(0xa37)][_0x36ed57(0xabe)]?'-\x20**当前时间**:\x20'+_0x4c264f+'\x20('+_0x1a3c15+')':'')+'\x0a你必须严格遵守'+_0x2021f1+'\x0a#\x20长期记忆\x20(你必须严格遵守的事实)\x0a'+(_0x312594[_0x36ed57(0x1600)]&&_0x312594[_0x36ed57(0x1600)][_0x36ed57(0x8d6)]>0x0?_0x312594[_0x36ed57(0x1600)][_0x36ed57(0xd18)](_0xb3d75a=>'-\x20'+_0xb3d75a['content'])['join']('\x0a'):_0x36ed57(0x4d1))+'\x0a\x0a'+_0x487c72+_0x36ed57(0x257)+_0x3a09de[_0x36ed57(0xd18)](_0x3bda09=>{const _0x375a4b=_0x36ed57;let _0x4f7c74=(_0x3bda09[_0x375a4b(0x71a)]===_0x375a4b(0x6d6)?_0x877dc4:_0x312594[_0x375a4b(0xf3e)])+':\x20';return _0x3bda09['type']===_0x375a4b(0x86e)?_0x4f7c74+='「'+(_0x3bda09[_0x375a4b(0xf2d)]||'')+'」\x20'+(_0x3bda09[_0x375a4b(0x12a5)]||''):_0x4f7c74+=String(_0x3bda09[_0x375a4b(0x1109)]),_0x4f7c74;})[_0x36ed57(0xee1)]('\x0a')+_0x36ed57(0x9fa)+_0xd7ef8c+_0x36ed57(0x10fe)+_0x21864e+'到'+_0x13ccda+_0x36ed57(0x5dd),_0x2ba8a7=_0x29281c[_0x36ed57(0xd18)](_0x49e2c1=>{const _0x551a51=_0x36ed57;if(_0x49e2c1[_0x551a51(0x118c)])return null;if(_0x49e2c1[_0x551a51(0xbbf)]===_0x551a51(0x86e)){const _0x32a74a=_0x49e2c1['role']==='user'?_0x312594[_0x551a51(0xa37)][_0x551a51(0x14a8)]||'我':_0x312594[_0x551a51(0xf3e)];let _0x5bfa74='';if(_0x49e2c1[_0x551a51(0x1109)])_0x5bfa74=_0x49e2c1[_0x551a51(0x1109)];else{const _0x3a925c=_0x49e2c1[_0x551a51(0xf2d)]?'「'+_0x49e2c1['dialogue']+'」':'',_0x4d1550=_0x49e2c1[_0x551a51(0x12a5)]?'('+_0x49e2c1[_0x551a51(0x12a5)]+')':'';_0x5bfa74=(_0x3a925c+'\x20'+_0x4d1550)[_0x551a51(0xb8f)]();}return{'role':_0x49e2c1[_0x551a51(0x71a)],'content':_0x32a74a+':\x20'+_0x5bfa74};}if(_0x49e2c1['role']===_0x551a51(0x6d6)){const _0x1051cd=_0x877dc4+':\x20';let _0xc50686='';if(Array['isArray'](_0x49e2c1['content'])&&_0x49e2c1[_0x551a51(0x1109)][0x0]?.[_0x551a51(0xbbf)]===_0x551a51(0x164d))return{'role':_0x551a51(0x6d6),'content':[{'type':_0x551a51(0x117f),'text':_0x1051cd},..._0x49e2c1[_0x551a51(0x1109)]]};if(_0x49e2c1[_0x551a51(0x1406)]){const _0x46207b=String(_0x49e2c1[_0x551a51(0x1406)][_0x551a51(0x1109)]||'')[_0x551a51(0x371)](0x0,0x32);_0xc50686+=_0x551a51(0x3a0)+_0x49e2c1[_0x551a51(0x1406)]['senderName']+_0x551a51(0x155d)+_0x46207b+_0x551a51(0x8e0)+_0x49e2c1['content'];}else _0xc50686+=_0x49e2c1[_0x551a51(0x1109)];if(_0x49e2c1[_0x551a51(0xbbf)]===_0x551a51(0xdf3))return{'role':_0x551a51(0x6d6),'content':_0x1051cd+'[你发送了一张需要AI识别的图片，图片内容是：\x27'+_0x49e2c1[_0x551a51(0x1109)]+'\x27]'};if(_0x49e2c1[_0x551a51(0xbbf)]===_0x551a51(0x295))return{'role':_0x551a51(0x6d6),'content':_0x1051cd+_0x551a51(0xef0)+_0x49e2c1[_0x551a51(0x1109)]+'\x27]'};if(_0x49e2c1['type']==='transfer')return{'role':_0x551a51(0x6d6),'content':_0x1051cd+_0x551a51(0x699)+_0x49e2c1[_0x551a51(0x287)]+'\x20向对方发起了转账:\x20'+_0x49e2c1[_0x551a51(0x12e7)]+_0x551a51(0x102b)+_0x49e2c1[_0x551a51(0x12bb)]+_0x551a51(0xd64)};if(_0x49e2c1[_0x551a51(0xbbf)]==='waimai_request')return{'role':'user','content':_0x1051cd+'[系统提示：你于时间戳\x20'+_0x49e2c1[_0x551a51(0x287)]+_0x551a51(0x47c)+_0x49e2c1[_0x551a51(0xff3)]+_0x551a51(0xd29)+_0x49e2c1[_0x551a51(0x12e7)]+_0x551a51(0x8e6)};else{if(_0x49e2c1[_0x551a51(0xbbf)]===_0x551a51(0x15b6)){const _0x110068=_0x49e2c1['items'][_0x551a51(0xd18)](_0x3d05dd=>_0x3d05dd[_0x551a51(0xf3e)]+'\x20x'+_0x3d05dd[_0x551a51(0x2b9)])[_0x551a51(0xee1)]('、\x20');let _0x5203b8=_0x312594[_0x551a51(0xc98)]?'送给了\x20'+_0x49e2c1['recipients'][_0x551a51(0xd18)](_0x452aad=>_0x288d80(_0x312594,_0x452aad))[_0x551a51(0xee1)]('、\x20'):'送给了\x20'+_0x312594[_0x551a51(0xf3e)];return{'role':'user','content':_0x1051cd+_0x551a51(0xa12)+_0x5203b8+_0x551a51(0x168f)+_0x110068+']'};}}if(_0x49e2c1[_0x551a51(0xca4)])return{'role':_0x551a51(0x6d6),'content':_0x1051cd+_0x551a51(0xe10)+_0x49e2c1[_0x551a51(0xca4)]+'\x27]'};return{'role':_0x49e2c1[_0x551a51(0x71a)],'content':_0x1051cd+_0xc50686};}else{if(_0x49e2c1[_0x551a51(0x71a)]===_0x551a51(0x4fd)){let _0x51ceef={'type':_0x49e2c1[_0x551a51(0xbbf)]||'text'};if(_0x49e2c1[_0x551a51(0xbbf)]===_0x551a51(0x12c2))_0x51ceef[_0x551a51(0xca4)]=_0x49e2c1[_0x551a51(0xca4)];else{if(_0x49e2c1[_0x551a51(0xbbf)]===_0x551a51(0x112f))_0x51ceef[_0x551a51(0x12e7)]=_0x49e2c1[_0x551a51(0x12e7)],_0x51ceef['note']=_0x49e2c1[_0x551a51(0x12bb)];else _0x49e2c1[_0x551a51(0xbbf)]===_0x551a51(0xebc)?(_0x51ceef[_0x551a51(0xff3)]=_0x49e2c1[_0x551a51(0xff3)],_0x51ceef[_0x551a51(0x12e7)]=_0x49e2c1[_0x551a51(0x12e7)]):_0x49e2c1['quote']?_0x51ceef[_0x551a51(0x788)]={'target_sender':_0x49e2c1['quote'][_0x551a51(0x3e7)],'target_content':_0x49e2c1['quote']['content'],'reply_content':_0x49e2c1[_0x551a51(0x1109)]}:_0x51ceef[_0x551a51(0x1109)]=_0x49e2c1[_0x551a51(0x1109)];}const _0x266c7d=JSON[_0x551a51(0xea5)]([_0x51ceef]);return{'role':_0x551a51(0x4fd),'content':_0x551a51(0x9aa)+_0x49e2c1[_0x551a51(0x287)]+')\x20'+_0x266c7d};}}return null;})['filter'](Boolean);}else{let _0x2de7f0='';_0x312594['nameHistory']&&_0x312594['nameHistory'][_0x36ed57(0x8d6)]>0x0&&(_0x2de7f0=_0x36ed57(0x359)+_0x312594[_0x36ed57(0x112b)][_0x36ed57(0xee1)](',\x20')+_0x36ed57(0x791));let _0x25ca49='';const _0x4cae33=_0x4c8b14[_0x36ed57(0x834)][_0x36ed57(0xbf3)]||'用户';_0x25ca49+=_0x36ed57(0xd90)+_0x4cae33+_0x36ed57(0x5d9);const _0x45ea1e=Object[_0x36ed57(0x40a)](_0x4c8b14[_0x36ed57(0xbea)]),_0x3a2f28=_0x45ea1e[_0x36ed57(0x29d)](_0x2dad8f=>_0x2dad8f['isGroup']&&_0x2dad8f[_0x36ed57(0x4f8)][_0x36ed57(0x1412)](_0x2a5077=>_0x2a5077['id']===_0x312594['id']));_0x3a2f28[_0x36ed57(0x8d6)]>0x0&&(_0x25ca49+='-\x20用户在你们共同所在的群聊中的昵称如下：\x0a',_0x3a2f28['forEach'](_0x28423d=>{const _0x462db9=_0x36ed57,_0xfbdde3=_0x28423d[_0x462db9(0xa37)][_0x462db9(0x14a8)]||_0x4cae33;_0x25ca49+=_0x462db9(0x104b)+_0x28423d[_0x462db9(0xf3e)]+_0x462db9(0x15da)+_0xfbdde3+'”。\x0a';}));_0x25ca49+=_0x36ed57(0x1013);let _0x35a60e='';const _0x5b6143=_0x45ea1e[_0x36ed57(0x29d)](_0x391528=>!_0x391528['isGroup']&&_0x391528['id']!==_0x312594['id']&&_0x391528[_0x36ed57(0x1145)]===_0x312594[_0x36ed57(0x1145)]&&_0x312594[_0x36ed57(0x1145)]!==null);_0x5b6143[_0x36ed57(0x8d6)]>0x0&&(_0x35a60e+=_0x36ed57(0xc34),_0x5b6143['forEach'](_0x3e0978=>{const _0x178640=_0x36ed57;_0x35a60e+=_0x178640(0x15e6)+_0x3e0978[_0x178640(0xf3e)]+_0x178640(0xd2e)+_0x3e0978[_0x178640(0xdcf)]+')\x0a';}));const _0xfb9ecd=await _0x54c587['qzonePosts']['orderBy'](_0x36ed57(0x287))[_0x36ed57(0xfc1)]()['limit'](0x5)[_0x36ed57(0xce1)](),_0x6ee76=_0x41e7bf(_0xfb9ecd,_0x312594);let _0x4642e5='';if(_0x6ee76['length']>0x0){_0x4642e5=_0x36ed57(0x129a);const _0x584a18=_0x312594[_0x36ed57(0xdcf)];for(const _0x4cc0a6 of _0x6ee76){let _0x2a6c14;if(_0x4cc0a6['authorId']===_0x36ed57(0x6d6))_0x2a6c14=_0x4c8b14['qzoneSettings'][_0x36ed57(0xbf3)];else{if(String(_0x4cc0a6['authorId'])[_0x36ed57(0xbb9)](_0x36ed57(0x1530)))_0x2a6c14=_0x4cc0a6[_0x36ed57(0x993)]||_0x36ed57(0xdfd);else{const _0x4eeed9=_0x4c8b14[_0x36ed57(0xbea)][_0x4cc0a6[_0x36ed57(0x606)]];_0x2a6c14=_0x4eeed9?_0x4eeed9[_0x36ed57(0xf3e)]:_0x36ed57(0x1413);}}if(_0x4cc0a6['authorId']===_0x1e6f84)_0x2a6c14+=_0x36ed57(0x1226);let _0x41e0b8;if(_0x4cc0a6['type']==='repost'){const _0x3eb2ae=_0x4cc0a6[_0x36ed57(0x15bc)]?'并评论说：\x22'+_0x4cc0a6[_0x36ed57(0x15bc)]+'\x22':'';let _0xcc2ed3=_0x36ed57(0x62e);const _0x4cc597=_0x4cc0a6[_0x36ed57(0x53d)]['authorId'];if(_0x4cc597===_0x36ed57(0x6d6))_0xcc2ed3=_0x4c8b14[_0x36ed57(0x834)][_0x36ed57(0xbf3)];else _0x4c8b14['chats'][_0x4cc597]&&(_0xcc2ed3=_0x4c8b14['chats'][_0x4cc597][_0x36ed57(0xf3e)]);let _0xdc640c;const _0x522f5f=_0x4cc0a6[_0x36ed57(0x53d)];if(_0x522f5f[_0x36ed57(0xbbf)]===_0x36ed57(0x14b0))_0xdc640c=_0x36ed57(0x5f0)+(_0x522f5f[_0x36ed57(0xdb3)]||'')+_0x36ed57(0xbbb)+(_0x522f5f[_0x36ed57(0x1012)]||'')[_0x36ed57(0x371)](0x0,0x28)+_0x36ed57(0x653);else _0x522f5f[_0x36ed57(0xbbf)]===_0x36ed57(0x4d3)?_0xdc640c='[图片]\x20'+(_0x522f5f[_0x36ed57(0xdb3)]||'')+_0x36ed57(0xbbb)+(_0x522f5f[_0x36ed57(0xe34)]||'')[_0x36ed57(0x371)](0x0,0x28)+_0x36ed57(0x653):_0xdc640c='\x22'+(_0x522f5f['content']||'')[_0x36ed57(0x371)](0x0,0x28)+_0x36ed57(0x6b3);_0x41e0b8=_0x36ed57(0x6e9)+_0xcc2ed3+_0x36ed57(0x792)+_0x3eb2ae+'【原动态内容:\x20'+_0xdc640c+'】';}else{if(_0x4cc0a6[_0x36ed57(0xbbf)]==='text_image')_0x41e0b8=(_0x36ed57(0x99d)+_0x4cc0a6[_0x36ed57(0x1012)]+_0x36ed57(0x1262)+(_0x4cc0a6['publicText']||''))[_0x36ed57(0x371)](0x0,0x32)+'...';else{if(_0x4cc0a6[_0x36ed57(0xbbf)]===_0x36ed57(0x4d3))_0x41e0b8=(_0x36ed57(0x100f)+_0x4cc0a6['imageDescription']+_0x36ed57(0x1262)+(_0x4cc0a6['publicText']||''))[_0x36ed57(0x371)](0x0,0x32)+'...';else{if(_0x4cc0a6[_0x36ed57(0xbbf)]===_0x36ed57(0xd3c)&&_0x4cc0a6[_0x36ed57(0x156c)]){const _0x1c6ad2=Array[_0x36ed57(0x16a1)](_0x4cc0a6[_0x36ed57(0x156c)])?_0x4cc0a6[_0x36ed57(0x156c)]:[_0x4cc0a6[_0x36ed57(0x156c)]];_0x41e0b8=(_0x4cc0a6['publicText']||'')+(_0x36ed57(0xfb4)+_0x1c6ad2[_0x36ed57(0x8d6)]+_0x36ed57(0x44c)+_0x1c6ad2[_0x36ed57(0xee1)](',\x20')+']');}else _0x41e0b8=String(_0x4cc0a6[_0x36ed57(0xdb3)]||_0x4cc0a6[_0x36ed57(0x1109)]||_0x36ed57(0x8a7))[_0x36ed57(0x371)](0x0,0x32)+_0x36ed57(0x166b);}}}_0x4642e5+=_0x36ed57(0x60e)+_0x4cc0a6['id']+')\x20作者:\x20'+_0x2a6c14+',\x20内容:\x20\x22'+_0x41e0b8+'\x22\x0a';if(_0x4cc0a6['comments']&&_0x4cc0a6[_0x36ed57(0xf8f)][_0x36ed57(0x8d6)]>0x0)for(const _0x58aa78 of _0x4cc0a6['comments']){if(typeof _0x58aa78==='object'&&_0x58aa78['commenterName']){const _0xf533e=_0x44e128(_0x58aa78['commenterName']);let _0x2b060d=_0x58aa78[_0x36ed57(0xca4)]?_0x36ed57(0xbed)+_0x58aa78['meaning']+'\x27]':_0x58aa78[_0x36ed57(0x117f)];_0x58aa78[_0x36ed57(0xbf8)]===_0x584a18?_0x4642e5+='\x20\x20-\x20你评论说:\x20'+_0x2b060d+'\x0a':_0x4642e5+=_0x36ed57(0x11d4)+_0xf533e+_0x36ed57(0x319)+_0x58aa78[_0x36ed57(0xbf8)]+_0x36ed57(0x29e)+_0x2b060d+'\x0a';}}}}const _0x4b34a9=_0x312594['settings']['myNickname']||'我';let _0x173556='',_0x38e4f6=![];if(_0x312594[_0x36ed57(0xa37)][_0x36ed57(0xabe)]){const _0x279bb3=_0x3a09de['findLast'](_0x92def1=>_0x92def1[_0x36ed57(0x71a)]==='user'&&!_0x92def1['isHidden']),_0x40cba7=_0x3a09de[_0x36ed57(0xb22)](_0x120783=>_0x120783[_0x36ed57(0x71a)]===_0x36ed57(0x4fd)&&!_0x120783['isHidden']);if(_0x279bb3){const _0xb36867=_0x597df9(_0x279bb3[_0x36ed57(0x287)]);if(_0x40cba7){const _0x49d486=_0x597df9(_0x40cba7['timestamp']);_0x173556=_0x36ed57(0xcc3)+_0x49d486+'，用户刚刚在\x20'+_0xb36867+_0x36ed57(0x528);const _0x1943ff=(_0x279bb3[_0x36ed57(0x287)]-_0x40cba7[_0x36ed57(0x287)])/(0x3e8*0x3c*0x3c);if(_0x1943ff>0x3){_0x38e4f6=!![];const _0x4a338e=Math[_0x36ed57(0x1381)](_0x1943ff/0x18);_0x173556+=_0x36ed57(0xb90)+(_0x4a338e>0x0?_0x4a338e+'天':Math['floor'](_0x1943ff)+'小时')+_0x36ed57(0x14d6)+_0x1a3c15+_0x36ed57(0x989);}}else _0x173556='-\x20**对话状态**:\x20这是你们的第一次对话，用户的第一条消息发送于\x20'+_0xb36867+'。';}else _0x173556=_0x36ed57(0xe48);}const _0x39276c=_0x231df1(_0x1e6f84),_0xc00dab=_0x3eed43(_0x312594,0x3,_0x36ed57(0xf20)),_0x4f3083=_0x3eed43(_0x312594,0x6,_0x36ed57(0xf20)),_0x20d5c1=_0x3eed43(_0x312594,0x9,_0x36ed57(0xf20)),_0x2231b6=_0x3eed43(_0x312594,0x1,_0x36ed57(0x72c)),_0x365fc9=_0x3eed43(_0x312594,0x3,_0x36ed57(0x72c)),_0x4a6b8e=_0x3eed43(_0x312594,0x7,_0x36ed57(0x72c));let _0xfbb369='';if(_0xc00dab||_0x4f3083||_0x20d5c1||_0x2231b6||_0x365fc9||_0x4a6b8e){_0xfbb369+=_0x36ed57(0x116b);if(_0xc00dab)_0xfbb369+=_0xc00dab;if(_0x4f3083)_0xfbb369+=_0x4f3083;if(_0x20d5c1)_0xfbb369+=_0x20d5c1;if(_0xc00dab||_0x4f3083||_0x20d5c1)_0xfbb369+='\x0a';if(_0x2231b6)_0xfbb369+=_0x2231b6;if(_0x365fc9)_0xfbb369+=_0x365fc9;if(_0x4a6b8e)_0xfbb369+=_0x4a6b8e;}let _0x113b2b=_0x36ed57(0x82c);const _0x5918e8=_0x4c8b14['qzoneSettings']['nickname']||_0x36ed57(0xa8f),_0x5f34c2=_0x312594[_0x36ed57(0xdcf)],_0x995911=Object[_0x36ed57(0x40a)](_0x4c8b14[_0x36ed57(0xbea)])[_0x36ed57(0x29d)](_0x3e139c=>_0x3e139c[_0x36ed57(0xc98)]&&_0x3e139c[_0x36ed57(0x4f8)]['some'](_0x10c989=>_0x10c989['originalName']===_0x5f34c2));_0x995911[_0x36ed57(0x8d6)]>0x0?(_0x995911[_0x36ed57(0xbdc)](_0x1ca116=>{const _0x5624dd=_0x36ed57,_0x19a4ff=_0x1ca116['members']['filter'](_0x149aa3=>_0x149aa3[_0x5624dd(0xdcf)]!==_0x5f34c2&&_0x149aa3[_0x5624dd(0xdcf)]!==_0x5918e8)['map'](_0x3f3acc=>_0x3f3acc[_0x5624dd(0x7ca)])[_0x5624dd(0xee1)]('、\x20');_0x113b2b+=_0x5624dd(0xc10)+_0x1ca116[_0x5624dd(0xf3e)]+'\x22\x0a',_0x113b2b+=_0x5624dd(0x58c)+(_0x19a4ff||'(只有你和用户)')+'\x0a';}),_0x113b2b+='当你想和群里的人分享什么时，你可以使用\x20`send_group_message`\x20指令并提供【准确的群名】来给这些群聊发送消息。\x0a'):_0x113b2b+=_0x36ed57(0x11be);_0x4b1127=_0x36ed57(0x571)+_0x312594['originalName']+_0x36ed57(0x1010)+_0x312594[_0x36ed57(0xa37)][_0x36ed57(0xfea)]+'\x0a'+_0x3229da+_0x36ed57(0xd07)+_0x312594['settings']['myPersona']+'\x0a\x0a#\x20当前情景\x0a'+(_0x312594[_0x36ed57(0xa37)][_0x36ed57(0xabe)]?_0x36ed57(0x846)+_0x4c264f+'\x20('+_0x1a3c15+')':'')+'\x0a'+_0x173556+_0x36ed57(0x4e4)+_0x2021f1+'\x0a'+_0x487c72+_0x36ed57(0x122d)+(_0x312594[_0x36ed57(0x1600)]&&_0x312594[_0x36ed57(0x1600)][_0x36ed57(0x8d6)]>0x0?_0x312594[_0x36ed57(0x1600)][_0x36ed57(0xd18)](_0xfd1339=>'-\x20'+_0xfd1339['content'])[_0x36ed57(0xee1)]('\x0a'):_0x36ed57(0x4d1))+'\x0a'+_0xfbb369+'\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22'+_0x312594[_0x36ed57(0xdcf)]+_0x36ed57(0xd7e)+_0x312594[_0x36ed57(0xf3e)]+_0x36ed57(0x11e9)+_0x4b34a9+_0x36ed57(0xec5)+_0x25ca49+'\x0a\x20\x20\x20\x20'+_0x2de7f0+'\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a'+_0x554bc2+'\x0a'+_0x4e1041+'\x0a'+_0x19503d+_0x36ed57(0xc81)+_0x35a60e+'\x0a'+_0x4642e5+'\x0a'+_0x113b2b+_0x36ed57(0xa62)+(_0x312594[_0x36ed57(0xa37)][_0x36ed57(0xabe)]?_0x36ed57(0x891)+_0x4c264f+'\x20('+_0x1a3c15+_0x36ed57(0x1ed):'')+_0x36ed57(0xfc2)+(_0x3144ad?_0x36ed57(0xf3f)+_0x3144ad:_0x36ed57(0x25e))+_0x36ed57(0x1086)+(_0x39276c?_0x36ed57(0x578)+_0x39276c:'你们没有在读书。')+_0x36ed57(0x129c)+(_0x312594['settings']['aiAvatarLibrary']&&_0x312594['settings'][_0x36ed57(0x1080)][_0x36ed57(0x8d6)]>0x0?_0x312594[_0x36ed57(0xa37)][_0x36ed57(0x1080)]['map'](_0x32e086=>'-\x20'+_0x32e086[_0x36ed57(0xf3e)])[_0x36ed57(0xee1)]('\x0a'):'-\x20(空)')+_0x36ed57(0x93e)+(_0x312594[_0x36ed57(0xa37)][_0x36ed57(0x110f)]&&_0x312594[_0x36ed57(0xa37)][_0x36ed57(0x110f)]['length']>0x0?_0x312594[_0x36ed57(0xa37)][_0x36ed57(0x110f)]['map'](_0x31f33c=>'-\x20'+_0x31f33c[_0x36ed57(0xf3e)])['join']('\x0a'):_0x36ed57(0xcaf))+'\x0a-\x20\x20\x20**五子棋局势**:\x20'+_0x2eaaf7+_0x36ed57(0x4be)+_0x312594[_0x36ed57(0xdcf)]+_0x36ed57(0x10b4)+_0x312594[_0x36ed57(0xdcf)]+'\x22)\x20为键的、充满感性的内心独白。\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a'+(localStorage[_0x36ed57(0xca2)]('novelai-enabled')===_0x36ed57(0xaea)?'-\x20\x20\x20**NovelAI真实图片分享\x20(在聊天中直接发送)**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20-\x20**【绝不能暴露是novelai生成的图片！】\x0a\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20-\x20使用场景：当你想要在【私聊对话中】直接给用户发送一张图片时使用。\x0a\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。\x0a\x20\x20\x20\x20-\x20注意：这会直接在聊天记录中显示图片，而不是发布到动态。':'')+'\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后立刻撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22content\x22:\x20\x22你想让AI说出后立刻消失的话\x22}`\x20(用于模拟说错话、后悔等场景，消息会短暂出现后自动变为“已撤回”)\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**发动态(说说)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22文字内容\x22}]`\x0a-\x20\x20\x20**发动态(文字图)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22图片描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]`\x0a'+(localStorage[_0x36ed57(0xca2)](_0x36ed57(0x1329))===_0x36ed57(0xaea)?'-\x20\x20\x20**公开发布NovelAI真实图片动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20[\x22图片1详细英文描述\x22,\x20\x22图片2详细英文描述\x22]}`\x20\x0a\x20\x20*\x20**prompt撰写**：你可以根据当前对话上下文、你的角色人设、以及你想表达的情感和氛围，来撰写详细而具体的prompt。详细程度由你根据具体情况自己决定，并不强制。\x0a\x20\x20*\x20例如：\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22':'')+_0x36ed57(0x1037)+_0x312594[_0x36ed57(0xdcf)]+'\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22评论内容\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20表情:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22'+_0x312594[_0x36ed57(0xdcf)]+_0x36ed57(0x1660)+_0x312594['originalName']+_0x36ed57(0x7c4)+_0x312594[_0x36ed57(0xdcf)]+_0x36ed57(0x110e)+_0x312594[_0x36ed57(0xdcf)]+_0x36ed57(0x1448),_0x2ba8a7=_0x29281c[_0x36ed57(0xd18)](_0x24d396=>{const _0xe2cd38=_0x36ed57;if(_0x24d396[_0xe2cd38(0x118c)]&&typeof _0x24d396['content']===_0xe2cd38(0x158f)&&_0x24d396[_0xe2cd38(0x1109)][_0xe2cd38(0xd1b)](_0xe2cd38(0x23a)))return null;if(_0x24d396[_0xe2cd38(0x118c)]&&_0x24d396[_0xe2cd38(0x71a)]===_0xe2cd38(0xaf6))return{'role':_0xe2cd38(0x6d6),'content':_0x24d396[_0xe2cd38(0x1109)]};else{if(_0x24d396[_0xe2cd38(0x118c)])return null;}if(_0x24d396[_0xe2cd38(0xbbf)]===_0xe2cd38(0x86e)){const _0x534d35=_0x24d396[_0xe2cd38(0x71a)]===_0xe2cd38(0x6d6)?_0x312594[_0xe2cd38(0xa37)][_0xe2cd38(0x14a8)]||'我':_0x312594[_0xe2cd38(0xf3e)];let _0x370f6c='';if(_0x24d396[_0xe2cd38(0x1109)])_0x370f6c=_0x24d396['content'];else{const _0xa46c8c=_0x24d396[_0xe2cd38(0xf2d)]?'「'+_0x24d396['dialogue']+'」':'',_0x4c07b0=_0x24d396['description']?'('+_0x24d396[_0xe2cd38(0x12a5)]+')':'';_0x370f6c=(_0xa46c8c+'\x20'+_0x4c07b0)[_0xe2cd38(0xb8f)]();}return{'role':_0x24d396['role'],'content':_0xe2cd38(0x9aa)+_0x24d396['timestamp']+')\x20'+_0x534d35+':\x20'+_0x370f6c};}if(_0x24d396[_0xe2cd38(0x71a)]===_0xe2cd38(0x6d6)){const _0x4caf91=_0xe2cd38(0x9aa)+_0x24d396[_0xe2cd38(0x287)]+')\x20';let _0x4a0b30='';if(Array[_0xe2cd38(0x16a1)](_0x24d396['content'])&&_0x24d396[_0xe2cd38(0x1109)][0x0]?.[_0xe2cd38(0xbbf)]===_0xe2cd38(0x164d))return{'role':_0xe2cd38(0x6d6),'content':[{'type':_0xe2cd38(0x117f),'text':_0x4caf91},..._0x24d396[_0xe2cd38(0x1109)]]};if(_0x24d396[_0xe2cd38(0x1406)]){const _0x373c2f=String(_0x24d396[_0xe2cd38(0x1406)][_0xe2cd38(0x1109)]||'')[_0xe2cd38(0x371)](0x0,0x32);_0x4a0b30+='(回复\x20'+_0x24d396[_0xe2cd38(0x1406)][_0xe2cd38(0x3e7)]+_0xe2cd38(0x155d)+_0x373c2f+_0xe2cd38(0x8e0)+_0x24d396[_0xe2cd38(0x1109)];}else _0x4a0b30+=_0x24d396[_0xe2cd38(0x1109)];if(_0x24d396['type']==='user_photo')return{'role':'user','content':_0x4caf91+_0xe2cd38(0xebf)+_0x24d396[_0xe2cd38(0x1109)]+'\x27]'};if(_0x24d396[_0xe2cd38(0xbbf)]===_0xe2cd38(0x295))return{'role':_0xe2cd38(0x6d6),'content':_0x4caf91+'[你发送了一条语音消息，内容是：\x27'+_0x24d396[_0xe2cd38(0x1109)]+'\x27]'};if(_0x24d396[_0xe2cd38(0xbbf)]==='transfer')return{'role':'user','content':_0x4caf91+_0xe2cd38(0x699)+_0x24d396[_0xe2cd38(0x287)]+_0xe2cd38(0x8b5)+_0x24d396[_0xe2cd38(0x12e7)]+_0xe2cd38(0x102b)+_0x24d396[_0xe2cd38(0x12bb)]+_0xe2cd38(0xd64)};if(_0x24d396['type']===_0xe2cd38(0xebc))return{'role':'user','content':_0x4caf91+_0xe2cd38(0x699)+_0x24d396[_0xe2cd38(0x287)]+'\x20发起了外卖代付请求，商品是“'+_0x24d396[_0xe2cd38(0xff3)]+'”，金额是\x20'+_0x24d396[_0xe2cd38(0x12e7)]+_0xe2cd38(0x8e6)};else{if(_0x24d396[_0xe2cd38(0xbbf)]===_0xe2cd38(0x15b6)){const _0x112c68=_0x24d396['items'][_0xe2cd38(0xd18)](_0x175835=>_0x175835[_0xe2cd38(0xf3e)]+'\x20x'+_0x175835['quantity'])[_0xe2cd38(0xee1)]('、\x20');let _0x24d86b=_0x312594['isGroup']?_0xe2cd38(0x28f)+_0x24d396[_0xe2cd38(0x1170)][_0xe2cd38(0xd18)](_0x21f331=>_0x288d80(_0x312594,_0x21f331))[_0xe2cd38(0xee1)]('、\x20'):_0xe2cd38(0x28f)+_0x312594[_0xe2cd38(0xf3e)];return{'role':_0xe2cd38(0x6d6),'content':_0x4caf91+_0xe2cd38(0xa12)+_0x24d86b+_0xe2cd38(0x168f)+_0x112c68+']'};}}if(_0x24d396[_0xe2cd38(0xca4)])return{'role':_0xe2cd38(0x6d6),'content':_0x4caf91+'[你发送了一个表情，意思是：\x27'+_0x24d396[_0xe2cd38(0xca4)]+'\x27]'};return{'role':_0x24d396[_0xe2cd38(0x71a)],'content':_0x4caf91+_0x4a0b30};}else{if(_0x24d396['role']===_0xe2cd38(0x4fd)){let _0x590593={'type':_0x24d396[_0xe2cd38(0xbbf)]||'text'};if(_0x24d396[_0xe2cd38(0xbbf)]===_0xe2cd38(0x12c2))_0x590593[_0xe2cd38(0xca4)]=_0x24d396['meaning'];else{if(_0x24d396[_0xe2cd38(0xbbf)]===_0xe2cd38(0x112f))_0x590593[_0xe2cd38(0x12e7)]=_0x24d396[_0xe2cd38(0x12e7)],_0x590593[_0xe2cd38(0x12bb)]=_0x24d396[_0xe2cd38(0x12bb)];else _0x24d396[_0xe2cd38(0xbbf)]===_0xe2cd38(0xebc)?(_0x590593[_0xe2cd38(0xff3)]=_0x24d396[_0xe2cd38(0xff3)],_0x590593[_0xe2cd38(0x12e7)]=_0x24d396[_0xe2cd38(0x12e7)]):_0x24d396['quote']?_0x590593[_0xe2cd38(0x788)]={'target_sender':_0x24d396[_0xe2cd38(0x1406)][_0xe2cd38(0x3e7)],'target_content':_0x24d396[_0xe2cd38(0x1406)][_0xe2cd38(0x1109)],'reply_content':_0x24d396['content']}:_0x590593['content']=_0x24d396[_0xe2cd38(0x1109)];}const _0x28d320=JSON[_0xe2cd38(0xea5)]([_0x590593]);return{'role':_0xe2cd38(0x4fd),'content':_0xe2cd38(0x9aa)+_0x24d396[_0xe2cd38(0x287)]+')\x20'+_0x28d320};}}return null;})[_0x36ed57(0x29d)](Boolean);if(!_0x312594['isGroup']&&_0x312594[_0x36ed57(0x12f7)]?.[_0x36ed57(0x12c3)]===_0x36ed57(0x59d)){const _0x4b8c27=_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x29d)](_0x5ecf25=>!_0x5ecf25['isHidden'])[_0x36ed57(0x69f)](-0xa)[_0x36ed57(0xd18)](_0x23c74e=>{const _0x313afc=_0x36ed57,_0x51071b=_0x23c74e[_0x313afc(0x71a)]===_0x313afc(0x6d6)?'用户':_0x312594[_0x313afc(0xf3e)];return _0x51071b+':\x20'+String(_0x23c74e[_0x313afc(0x1109)])[_0x313afc(0x371)](0x0,0x32)+_0x313afc(0x166b);})[_0x36ed57(0xee1)]('\x0a'),_0xc1392f={'role':_0x36ed57(0x6d6),'content':_0x36ed57(0x10dd)+_0x312594[_0x36ed57(0x12f7)][_0x36ed57(0x275)]+_0x36ed57(0x662)+_0x4b8c27+_0x36ed57(0x4d2)};_0x2ba8a7['push'](_0xc1392f);}}}let _0x26bb70=_0xc49d75===GEMINI_API_URL,_0x4ee2b5=_0x3914a6(_0x34ffea,_0x4368ef,_0x4b1127,_0x2ba8a7),_0x39fa92;try{_0x39fa92=_0x26bb70?await fetch(_0x4ee2b5[_0x36ed57(0x299)],_0x4ee2b5[_0x36ed57(0x55b)]):await fetch(_0xc49d75+_0x36ed57(0x1611),{'method':_0x36ed57(0x953),'headers':{'Content-Type':_0x36ed57(0xfae),'Authorization':_0x36ed57(0xcee)+_0x4368ef},'body':JSON['stringify']({'model':_0x34ffea,'messages':[{'role':_0x36ed57(0xaf6),'content':_0x4b1127},..._0x2ba8a7],'temperature':_0x4c8b14[_0x36ed57(0x14f1)][_0x36ed57(0x216)]||0.8,'stream':![]})});}catch(_0x4067a4){throw new Error(_0x36ed57(0x91d)+_0x4067a4[_0x36ed57(0x6e2)]);}if(!_0x39fa92['ok']){let _0x5e936a=_0x36ed57(0xeca)+_0x39fa92[_0x36ed57(0x12c3)]+'\x20'+_0x39fa92[_0x36ed57(0x755)];try{const _0x412029=await _0x39fa92[_0x36ed57(0x15d3)]();_0x412029[_0x36ed57(0x5d7)]&&_0x412029[_0x36ed57(0x5d7)][_0x36ed57(0x6e2)]?_0x5e936a+=_0x36ed57(0x1477)+_0x412029[_0x36ed57(0x5d7)][_0x36ed57(0x6e2)]:_0x5e936a+=_0x36ed57(0x1477)+JSON[_0x36ed57(0xea5)](_0x412029);}catch(_0x1aeb26){_0x5e936a+=_0x36ed57(0xfad)+await _0x39fa92['text']();}throw new Error(_0x5e936a);}const _0x280b72=await _0x39fa92[_0x36ed57(0x15d3)](),_0x560a74=getGeminiResponseText(_0x280b72);lastRawAiResponse=_0x560a74,lastResponseTimestamps=[],_0x312594[_0x36ed57(0x92c)]=_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x29d)](_0x10cf35=>!_0x10cf35[_0x36ed57(0x14c0)]);const _0x90c75c=_0x57a22a(_0x560a74);let _0x16ca3a=[];if(_0x312594[_0x36ed57(0xa37)]['isOfflineMode']){let _0x3ddee6={'content':[],'dialogue':[],'description':[]};for(const _0xd3c108 of _0x90c75c){if(_0xd3c108['type']===_0x36ed57(0x86e)){if(_0xd3c108[_0x36ed57(0x1109)])_0x3ddee6['content'][_0x36ed57(0x6bb)](_0xd3c108[_0x36ed57(0x1109)]);else{if(_0xd3c108[_0x36ed57(0xf2d)])_0x3ddee6['dialogue'][_0x36ed57(0x6bb)](_0xd3c108['dialogue']);if(_0xd3c108['description'])_0x3ddee6[_0x36ed57(0x12a5)][_0x36ed57(0x6bb)](_0xd3c108['description']);}}else(_0x3ddee6['content'][_0x36ed57(0x8d6)]>0x0||_0x3ddee6[_0x36ed57(0xf2d)][_0x36ed57(0x8d6)]>0x0||_0x3ddee6['description'][_0x36ed57(0x8d6)]>0x0)&&(_0x3ddee6[_0x36ed57(0x1109)][_0x36ed57(0x8d6)]>0x0&&_0x16ca3a[_0x36ed57(0x6bb)]({'type':_0x36ed57(0x86e),'content':_0x3ddee6[_0x36ed57(0x1109)]['join']('\x0a')}),(_0x3ddee6['dialogue'][_0x36ed57(0x8d6)]>0x0||_0x3ddee6[_0x36ed57(0x12a5)]['length']>0x0)&&_0x16ca3a[_0x36ed57(0x6bb)]({'type':'offline_text','dialogue':_0x3ddee6[_0x36ed57(0xf2d)][_0x36ed57(0xee1)]('\x0a'),'description':_0x3ddee6[_0x36ed57(0x12a5)]['join']('\x0a')}),_0x3ddee6={'content':[],'dialogue':[],'description':[]}),_0x16ca3a[_0x36ed57(0x6bb)](_0xd3c108);}_0x3ddee6[_0x36ed57(0x1109)][_0x36ed57(0x8d6)]>0x0&&_0x16ca3a[_0x36ed57(0x6bb)]({'type':'offline_text','content':_0x3ddee6[_0x36ed57(0x1109)][_0x36ed57(0xee1)]('\x0a')}),(_0x3ddee6[_0x36ed57(0xf2d)][_0x36ed57(0x8d6)]>0x0||_0x3ddee6[_0x36ed57(0x12a5)][_0x36ed57(0x8d6)]>0x0)&&_0x16ca3a['push']({'type':_0x36ed57(0x86e),'dialogue':_0x3ddee6[_0x36ed57(0xf2d)][_0x36ed57(0xee1)]('\x0a'),'description':_0x3ddee6[_0x36ed57(0x12a5)][_0x36ed57(0xee1)]('\x0a')});}else _0x16ca3a=_0x90c75c;const _0x116b2f=_0x312594[_0x36ed57(0x92c)]['filter'](_0x277680=>_0x277680[_0x36ed57(0x71a)]===_0x36ed57(0x6d6)&&!_0x277680[_0x36ed57(0x118c)])[_0x36ed57(0x5ac)]();if(_0x116b2f&&Array['isArray'](_0x116b2f[_0x36ed57(0x1109)])&&_0x116b2f[_0x36ed57(0x1109)][0x0]?.[_0x36ed57(0xbbf)]===_0x36ed57(0x164d)&&!_0x116b2f['imageProcessed']){const _0xd2a219=_0x90c75c['find'](_0x3150d5=>_0x3150d5[_0x36ed57(0xbbf)]==='text');let _0x100f8f;_0xd2a219&&(_0xd2a219['content']||_0xd2a219[_0x36ed57(0x6e2)])?_0x100f8f=String(_0xd2a219[_0x36ed57(0x1109)]||_0xd2a219[_0x36ed57(0x6e2)])[_0x36ed57(0xb8f)]():_0x100f8f=_0x36ed57(0x1105);const _0x43ab82=_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x11a4)](_0x2c8fdd=>_0x2c8fdd[_0x36ed57(0x287)]===_0x116b2f[_0x36ed57(0x287)]);if(_0x43ab82>-0x1){console[_0x36ed57(0x1e6)](_0x36ed57(0x5ba)+_0x116b2f[_0x36ed57(0x287)]+_0x36ed57(0x1ea));const _0x110260='[系统提示：用户之前发送了一张图片，AI对图片的首次回应（摘要）是：“'+_0x100f8f+'”]';_0x312594[_0x36ed57(0x92c)][_0x43ab82]['content']=_0x110260,_0x312594[_0x36ed57(0x92c)][_0x43ab82]['imageProcessed']=!![],_0x312594[_0x36ed57(0x92c)][_0x43ab82]['type']=_0x36ed57(0x117f);}}const _0x1b61e3=document[_0x36ed57(0x400)](_0x36ed57(0x946))['classList'][_0x36ed57(0xd3f)](_0x36ed57(0x5d6))&&_0x4c8b14[_0x36ed57(0x1539)]===_0x1e6f84;let _0xa79ba5=![],_0x387812=Date[_0x36ed57(0xecd)](),_0x3c0127=[],_0x492933=![];for(const _0x5e659c of _0x16ca3a){if(_0x5e659c['type']===_0x36ed57(0xa86))continue;_0x312594[_0x36ed57(0xa37)][_0x36ed57(0x785)]!==![]&&_0x5e659c[_0x36ed57(0xbbf)]===_0x36ed57(0x117f)&&typeof _0x5e659c[_0x36ed57(0x1109)]===_0x36ed57(0x158f)&&_0x5e659c['content']['trim']()[_0x36ed57(0xbb9)](_0x36ed57(0xf19))&&(_0x5e659c[_0x36ed57(0xbbf)]=_0x36ed57(0x295),_0x5e659c[_0x36ed57(0x1109)]=_0x5e659c[_0x36ed57(0x1109)][_0x36ed57(0xe19)](_0x36ed57(0xf19),'')[_0x36ed57(0xb8f)]());if(_0x312594[_0x36ed57(0xc98)]&&_0x5e659c[_0x36ed57(0xf3e)]&&_0x5e659c['name']===_0x312594[_0x36ed57(0xf3e)]){console[_0x36ed57(0x5d7)]('AI幻觉已被拦截！试图使用群名\x20(\x22'+_0x312594[_0x36ed57(0xf3e)]+_0x36ed57(0x78c),_0x5e659c);continue;}if(!_0x5e659c||typeof _0x5e659c!==_0x36ed57(0xfc4)){console['warn'](_0x36ed57(0xa85),_0x5e659c);continue;}if(!_0x5e659c[_0x36ed57(0xbbf)]){if(_0x312594[_0x36ed57(0xc98)]&&_0x5e659c['name']&&_0x5e659c[_0x36ed57(0x6e2)])_0x5e659c[_0x36ed57(0xbbf)]=_0x36ed57(0x117f);else{if(_0x5e659c[_0x36ed57(0x1109)])_0x5e659c[_0x36ed57(0xbbf)]=_0x36ed57(0x117f);else{console[_0x36ed57(0x75e)]('收到了格式不规范的AI指令（缺少type和content），已跳过:',_0x5e659c);continue;}}}if(_0x5e659c['type']===_0x36ed57(0x2d8)){_0x4037ab[_0x36ed57(0x3ed)]=![];if(_0x5e659c['decision']===_0x36ed57(0xe81))_0xd23e33();else{const _0x19e99f={'role':_0x36ed57(0x4fd),'content':_0x36ed57(0x156d),'timestamp':Date[_0x36ed57(0xecd)]()};_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x6bb)](_0x19e99f),await _0x54c587[_0x36ed57(0xbea)][_0x36ed57(0x4cb)](_0x312594),_0x257d51('chat-interface-screen'),_0x26354c(_0x1e6f84);}_0xa79ba5=!![];break;}if(_0x5e659c['type']===_0x36ed57(0x5d1)){if(_0x5e659c[_0x36ed57(0x6ad)]==='join'){const _0x48195e=_0x312594[_0x36ed57(0x4f8)][_0x36ed57(0x821)](_0x59c9fa=>_0x59c9fa['originalName']===_0x5e659c[_0x36ed57(0xf3e)]);_0x48195e&&!_0x4037ab['participants'][_0x36ed57(0x1412)](_0x2a53aa=>_0x2a53aa['id']===_0x48195e['id'])&&_0x4037ab[_0x36ed57(0x131d)][_0x36ed57(0x6bb)](_0x48195e);}_0xa79ba5=!![];continue;}if(_0x312594[_0x36ed57(0xc98)]&&_0x5e659c[_0x36ed57(0xf3e)]&&_0x5e659c['name']===_0x312594[_0x36ed57(0xf3e)]){console['error'](_0x36ed57(0x452)+_0x312594[_0x36ed57(0xf3e)]+_0x36ed57(0x78c),_0x5e659c);continue;}if(_0x312594['isGroup']&&!_0x5e659c[_0x36ed57(0xf3e)]){console[_0x36ed57(0x5d7)](_0x36ed57(0x601),_0x5e659c);continue;}let _0x24ae48=null;const _0x34bcec=_0x387812++,_0x42947b={'role':'assistant','senderName':_0x5e659c[_0x36ed57(0xf3e)]||_0x312594[_0x36ed57(0xf3e)],'timestamp':_0x34bcec};lastResponseTimestamps[_0x36ed57(0x6bb)](_0x34bcec);switch(_0x5e659c['type']){case _0x36ed57(0x7fa):{const _0xcfb9cd=_0x5e659c[_0x36ed57(0xf3e)],_0x2e77dd=_0x5e659c[_0x36ed57(0x11b4)],_0x11520d=_0x4c8b14[_0x36ed57(0x834)]['nickname']||_0x36ed57(0xa8f);if(_0x2e77dd===_0x11520d){const _0x511cab=Object['values'](_0x4c8b14[_0x36ed57(0xbea)])[_0x36ed57(0x821)](_0x4ad26e=>!_0x4ad26e[_0x36ed57(0xc98)]&&_0x4ad26e['originalName']===_0xcfb9cd);if(_0x511cab){lastPrivateMessagesSent=[];const _0x4b0d00=Array[_0x36ed57(0x16a1)](_0x5e659c['content'])?_0x5e659c[_0x36ed57(0x1109)]:[_0x5e659c[_0x36ed57(0x1109)]];let _0x10255=0x0;for(const _0x60992c of _0x4b0d00){if(!_0x60992c||!_0x60992c[_0x36ed57(0xb8f)]())continue;const _0x481ebe={'role':_0x36ed57(0x4fd),'senderName':_0xcfb9cd,'content':_0x60992c,'timestamp':_0x387812++};lastPrivateMessagesSent['push']({'chatId':_0x511cab['id'],'timestamp':_0x481ebe[_0x36ed57(0x287)]}),_0x511cab[_0x36ed57(0x92c)][_0x36ed57(0x6bb)](_0x481ebe),_0x10255++;}_0x10255>0x0&&(_0x4c8b14[_0x36ed57(0x1539)]!==_0x511cab['id']&&(_0x511cab[_0x36ed57(0x73c)]=(_0x511cab[_0x36ed57(0x73c)]||0x0)+_0x10255,_0x301fc2(_0x511cab['id'],_0x511cab[_0x36ed57(0xf3e)]+'\x20发来了\x20'+_0x10255+_0x36ed57(0x15d0))),await _0x54c587[_0x36ed57(0xbea)]['put'](_0x511cab)),_0x24ae48=null;}else console[_0x36ed57(0x75e)]('AI\x20'+_0xcfb9cd+'\x20尝试发送私信，但未找到其对应的私聊会话。'),_0x24ae48=null;}else console[_0x36ed57(0x75e)](_0x36ed57(0x1369)+_0x2e77dd+_0x36ed57(0x77a)),_0x24ae48=null;continue;}case _0x36ed57(0x1301):{const _0xb1d5da=_0x5e659c[_0x36ed57(0xf3e)]||_0x312594[_0x36ed57(0xdcf)],_0x41244e=_0x5e659c[_0x36ed57(0xf50)],_0x195c7d=Array[_0x36ed57(0x16a1)](_0x5e659c[_0x36ed57(0x1109)])?_0x5e659c[_0x36ed57(0x1109)]:[String(_0x5e659c[_0x36ed57(0x1109)])];if(!_0x41244e){console[_0x36ed57(0x75e)]('AI\x20'+_0xb1d5da+'\x20尝试发送群聊消息，但未指定\x20targetGroupName。');continue;}const _0x2218a8=Object[_0x36ed57(0x40a)](_0x4c8b14[_0x36ed57(0xbea)])[_0x36ed57(0x821)](_0x216453=>_0x216453[_0x36ed57(0xc98)]&&_0x216453[_0x36ed57(0xf3e)]===_0x41244e&&_0x216453[_0x36ed57(0x4f8)][_0x36ed57(0x1412)](_0xfda06c=>_0xfda06c[_0x36ed57(0xdcf)]===_0xb1d5da));if(_0x2218a8){let _0x4ef56a=0x0;for(const _0x22d9a8 of _0x195c7d){if(!_0x22d9a8||!_0x22d9a8[_0x36ed57(0xb8f)]())continue;const _0x11f52e={'role':_0x36ed57(0x4fd),'senderName':_0xb1d5da,'content':_0x22d9a8,'timestamp':_0x387812++};_0x2218a8[_0x36ed57(0x92c)]['push'](_0x11f52e),_0x4ef56a++;}if(_0x4ef56a>0x0){if(_0x4c8b14['activeChatId']!==_0x2218a8['id']){_0x2218a8[_0x36ed57(0x73c)]=(_0x2218a8[_0x36ed57(0x73c)]||0x0)+_0x4ef56a;const _0x4f1a18=_0x2218a8['members'][_0x36ed57(0x821)](_0x255453=>_0x255453[_0x36ed57(0xdcf)]===_0xb1d5da),_0x4b253a=_0x4f1a18?_0x4f1a18[_0x36ed57(0x7ca)]:_0xb1d5da;_0x301fc2(_0x2218a8['id'],_0x4b253a+':\x20'+_0x195c7d[0x0]);}await _0x54c587[_0x36ed57(0xbea)][_0x36ed57(0x4cb)](_0x2218a8),_0x4c8b14[_0x36ed57(0xbea)][_0x2218a8['id']]=_0x2218a8;}_0x24ae48=null;}else console[_0x36ed57(0x75e)](_0x36ed57(0xf7b)+_0xb1d5da+_0x36ed57(0xfc6)+_0x41244e+'\x22\x20发送消息。'),_0x24ae48=null;continue;}case _0x36ed57(0x95a):if(!_0x312594['isGroup']){_0x5e659c[_0x36ed57(0x348)]&&(_0x312594[_0x36ed57(0x8ab)]=String(_0x5e659c[_0x36ed57(0x348)]));_0x5e659c[_0x36ed57(0xd13)]&&(_0x312594[_0x36ed57(0x13e5)]=String(_0x5e659c[_0x36ed57(0xd13)]));!Array['isArray'](_0x312594[_0x36ed57(0x13a1)])&&(_0x312594[_0x36ed57(0x13a1)]=[]);_0x312594[_0x36ed57(0x13a1)][_0x36ed57(0x6bb)]({'heartfeltVoice':_0x312594['heartfeltVoice'],'randomJottings':_0x312594[_0x36ed57(0x13e5)],'timestamp':Date[_0x36ed57(0xecd)]()});_0x312594[_0x36ed57(0x13a1)][_0x36ed57(0x8d6)]>0x32&&_0x312594[_0x36ed57(0x13a1)][_0x36ed57(0x10cc)]();const _0x489aa3='[这是你上一轮的内心独白和思考]\x0a-\x20心声:\x20'+_0x312594[_0x36ed57(0x8ab)]+_0x36ed57(0xd77)+_0x312594[_0x36ed57(0x13e5)],_0x530bbb={'role':_0x36ed57(0xaf6),'content':_0x489aa3,'timestamp':Date[_0x36ed57(0xecd)](),'isHidden':!![]};}continue;case _0x36ed57(0xe28):if(!_0x312594[_0x36ed57(0xc98)]&&_0x5e659c[_0x36ed57(0x122c)]){const _0x2a79f0=_0x5e659c[_0x36ed57(0x122c)][_0x36ed57(0xb8f)]();if(_0x2a79f0){_0x312594[_0x36ed57(0xa37)][_0x36ed57(0x14a8)]=_0x2a79f0;const _0x3f731d={'role':_0x36ed57(0xaf6),'type':_0x36ed57(0xaa4),'content':'“'+_0x312594[_0x36ed57(0xf3e)]+_0x36ed57(0x1267)+_0x2a79f0+'”','timestamp':_0x387812++};_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x6bb)](_0x3f731d);const _0x37b40e={'role':'system','content':_0x36ed57(0x340)+_0x2a79f0+_0x36ed57(0x69a),'timestamp':_0x387812++,'isHidden':!![]};_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x6bb)](_0x37b40e),_0x1b61e3&&_0x41ecc7(_0x3f731d,_0x312594);}}continue;case _0x36ed57(0xbde):if(!_0x312594[_0x36ed57(0xc98)]&&_0x5e659c['new_name']){const _0x41180f=_0x312594['name'],_0x14d5b2=_0x5e659c[_0x36ed57(0x122c)][_0x36ed57(0xb8f)]();if(_0x14d5b2&&_0x14d5b2!==_0x41180f){!_0x312594[_0x36ed57(0x112b)]&&(_0x312594[_0x36ed57(0x112b)]=[]);!_0x312594[_0x36ed57(0x112b)][_0x36ed57(0xd1b)](_0x41180f)&&_0x312594[_0x36ed57(0x112b)]['push'](_0x41180f);_0x312594[_0x36ed57(0xf3e)]=_0x14d5b2;const _0x5eaabc={'role':_0x36ed57(0xaf6),'type':_0x36ed57(0xaa4),'content':'“'+_0x312594[_0x36ed57(0xdcf)]+_0x36ed57(0xce8)+_0x14d5b2+'”','timestamp':_0x387812++};_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x6bb)](_0x5eaabc);const _0x353ca1={'role':_0x36ed57(0xaf6),'content':_0x36ed57(0xec6)+_0x14d5b2+_0x36ed57(0x1528),'timestamp':_0x387812++,'isHidden':!![]};_0x312594['history']['push'](_0x353ca1),_0x1b61e3&&(_0x41ecc7(_0x5eaabc,_0x312594),document['getElementById']('chat-header-title')[_0x36ed57(0xde7)]=_0x14d5b2),await _0xed04e8(_0x312594);}}continue;case'change_avatar':{const _0x2a3163=_0x5e659c[_0x36ed57(0xf3e)],_0x3b7cc0=_0x312594[_0x36ed57(0xa37)][_0x36ed57(0x1080)][_0x36ed57(0x821)](_0x1243bb=>_0x1243bb[_0x36ed57(0xf3e)]===_0x2a3163);if(_0x3b7cc0){_0x312594[_0x36ed57(0xa37)]['aiAvatar']=_0x3b7cc0[_0x36ed57(0x299)];const _0x58b27e={'role':'system','type':_0x36ed57(0xaa4),'content':'['+_0x312594['name']+'\x20更换了头像]','timestamp':Date[_0x36ed57(0xecd)]()};_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x6bb)](_0x58b27e),await _0x5f3a56(_0x312594),_0x1b61e3&&(_0x41ecc7(_0x58b27e,_0x312594),_0x26354c(_0x1e6f84));}continue;}case _0x36ed57(0xf09):{const _0x3023ff=_0x5e659c[_0x36ed57(0xf3e)],_0x4e1733=_0x312594['settings']['myAvatarLibrary'][_0x36ed57(0x821)](_0x199a32=>_0x199a32[_0x36ed57(0xf3e)]===_0x3023ff);if(_0x4e1733){_0x312594[_0x36ed57(0xa37)]['myAvatar']=_0x4e1733[_0x36ed57(0x299)];const _0x433412={'role':_0x36ed57(0xaf6),'type':_0x36ed57(0xaa4),'content':'['+_0x312594['name']+_0x36ed57(0xf9c),'timestamp':Date[_0x36ed57(0xecd)]()};_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x6bb)](_0x433412),_0x1b61e3&&(_0x41ecc7(_0x433412,_0x312594),_0x26354c(_0x1e6f84));}continue;}case _0x36ed57(0x940):{const _0x1f2976=parseInt(_0x5e659c['x']),_0x972a05=parseInt(_0x5e659c['y']);!isNaN(_0x1f2976)&&!isNaN(_0x972a05)?_0x1c3bf5({'x':_0x1f2976,'y':_0x972a05}):console['warn'](_0x36ed57(0x12ff),_0x5e659c);continue;}case _0x36ed57(0x1e8):const _0x132ee2=_0x312594[_0x36ed57(0x92c)]['findIndex'](_0x4bbd33=>_0x4bbd33[_0x36ed57(0x287)]===_0x5e659c[_0x36ed57(0x1332)]);if(_0x132ee2>-0x1){const _0x233f3e=_0x312594[_0x36ed57(0x92c)][_0x132ee2];_0x233f3e['status']=_0x5e659c[_0x36ed57(0x12c3)],_0x233f3e[_0x36ed57(0x150a)]=_0x5e659c['status']===_0x36ed57(0x143b)?_0x5e659c[_0x36ed57(0xf3e)]:null;}continue;case'qzone_post':const _0x205ec5={'type':_0x5e659c[_0x36ed57(0x15cd)],'content':_0x5e659c[_0x36ed57(0x1109)]||'','publicText':_0x5e659c[_0x36ed57(0xdb3)]||'','hiddenContent':_0x5e659c['hiddenContent']||'','image_prompt':_0x5e659c[_0x36ed57(0xff9)]||'','timestamp':Date[_0x36ed57(0xecd)](),'authorId':_0x1e6f84,'authorGroupId':_0x312594['groupId'],'visibleGroupIds':null};if(_0x5e659c['postType']===_0x36ed57(0xd3c)&&_0x5e659c[_0x36ed57(0x156c)])try{const _0xd7ab00=Array['isArray'](_0x5e659c[_0x36ed57(0x156c)])?_0x5e659c[_0x36ed57(0x156c)][_0x36ed57(0x69f)](0x0,0x2):[_0x5e659c[_0x36ed57(0x156c)]];console['log'](_0x36ed57(0x5d2)+_0xd7ab00['length']+_0x36ed57(0x737));const _0xd745e=[];for(let _0xe7defa=0x0;_0xe7defa<_0xd7ab00['length'];_0xe7defa++){const _0x484097=_0xd7ab00[_0xe7defa];console[_0x36ed57(0x1e6)]('生成第'+(_0xe7defa+0x1)+'张图片，prompt:',_0x484097);const _0x5ddd26=_0x378780(_0x312594['id']),_0x188bf7=_0x484097+',\x20'+_0x5ddd26['positive'],_0x19f1aa=_0x5ddd26[_0x36ed57(0x49c)];console[_0x36ed57(0x1e6)](_0x36ed57(0x142f)+(_0x5ddd26[_0x36ed57(0x1311)]===_0x36ed57(0x2cc)?'角色专属':'系统')+'提示词配置'),console[_0x36ed57(0x1e6)](_0x36ed57(0x5b2),_0x188bf7),console[_0x36ed57(0x1e6)](_0x36ed57(0x115c),_0x19f1aa);const _0x4843af=localStorage[_0x36ed57(0xca2)](_0x36ed57(0x1570)),_0x41e99c=localStorage[_0x36ed57(0xca2)]('novelai-model')||'nai-diffusion-4-5-full',_0x890d1e=_0x2400cd();if(!_0x4843af)throw new Error(_0x36ed57(0x1f5));const [_0x388762,_0x9eaefa]=_0x890d1e[_0x36ed57(0xe33)][_0x36ed57(0x5ad)]('x')['map'](Number);let _0x14a8ee;_0x41e99c[_0x36ed57(0xd1b)](_0x36ed57(0x8b6))?_0x14a8ee={'input':_0x188bf7,'model':_0x41e99c,'action':'generate','parameters':{'params_version':0x3,'width':_0x388762,'height':_0x9eaefa,'scale':_0x890d1e[_0x36ed57(0x507)],'sampler':_0x890d1e[_0x36ed57(0x924)],'steps':_0x890d1e[_0x36ed57(0x108f)],'seed':_0x890d1e[_0x36ed57(0xc76)]===-0x1?Math['floor'](Math[_0x36ed57(0x12bc)]()*0x2540be3ff):_0x890d1e[_0x36ed57(0xc76)],'n_samples':0x1,'ucPreset':_0x890d1e['uc_preset'],'qualityToggle':_0x890d1e[_0x36ed57(0x5e1)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x36ed57(0x12b5),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x188bf7,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x19f1aa,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x19f1aa,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x14a8ee={'input':_0x188bf7,'model':_0x41e99c,'action':'generate','parameters':{'width':_0x388762,'height':_0x9eaefa,'scale':_0x890d1e[_0x36ed57(0x507)],'sampler':_0x890d1e['sampler'],'steps':_0x890d1e[_0x36ed57(0x108f)],'seed':_0x890d1e[_0x36ed57(0xc76)]===-0x1?Math[_0x36ed57(0x1381)](Math[_0x36ed57(0x12bc)]()*0x2540be3ff):_0x890d1e[_0x36ed57(0xc76)],'n_samples':0x1,'ucPreset':_0x890d1e[_0x36ed57(0xc68)],'qualityToggle':_0x890d1e['quality_toggle'],'sm':_0x890d1e[_0x36ed57(0x46b)],'sm_dyn':_0x890d1e['smea_dyn'],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x36ed57(0xe0b),'negative_prompt':_0x19f1aa}};console['log'](_0x36ed57(0xe56),_0x14a8ee);let _0x4771a2;_0x41e99c[_0x36ed57(0xd1b)](_0x36ed57(0x8b6))?_0x4771a2='https://image.novelai.net/ai/generate-image-stream':_0x4771a2=_0x36ed57(0xc3a);let _0x31150a=_0x890d1e[_0x36ed57(0x4d8)];_0x31150a===_0x36ed57(0x7da)&&(_0x31150a=_0x890d1e[_0x36ed57(0x6af)]||'');_0x31150a&&_0x31150a!==''&&(_0x4771a2=_0x31150a+encodeURIComponent(_0x4771a2));const _0x284550=await fetch(_0x4771a2,{'method':_0x36ed57(0x953),'headers':{'Content-Type':_0x36ed57(0xfae),'Authorization':_0x36ed57(0xcee)+_0x4843af},'body':JSON[_0x36ed57(0xea5)](_0x14a8ee)});console[_0x36ed57(0x1e6)]('Response\x20status:',_0x284550[_0x36ed57(0x12c3)]),console['log']('Response\x20headers:',[..._0x284550['headers'][_0x36ed57(0x9de)]()]);if(!_0x284550['ok']){const _0x3c7a36=await _0x284550[_0x36ed57(0x117f)]();console[_0x36ed57(0x5d7)](_0x36ed57(0x1221),_0x3c7a36);throw new Error(_0x36ed57(0x167e)+_0x284550[_0x36ed57(0x12c3)]+'):\x20'+_0x3c7a36);}const _0x43ef52=_0x284550[_0x36ed57(0x451)]['get'](_0x36ed57(0x255));console[_0x36ed57(0x1e6)](_0x36ed57(0x1174),_0x43ef52);let _0x1d3696,_0x411747;if(_0x43ef52&&_0x43ef52[_0x36ed57(0xd1b)](_0x36ed57(0x996))){console[_0x36ed57(0x1e6)](_0x36ed57(0x56c));const _0x39144c=await _0x284550[_0x36ed57(0x117f)]();console[_0x36ed57(0x1e6)]('收到\x20SSE\x20数据，大小:',_0x39144c['length']);const _0x17fc74=_0x39144c[_0x36ed57(0xb8f)]()[_0x36ed57(0x5ad)]('\x0a');let _0x2dcfec=null;for(let _0x163c3f=_0x17fc74[_0x36ed57(0x8d6)]-0x1;_0x163c3f>=0x0;_0x163c3f--){const _0x5c7cf8=_0x17fc74[_0x163c3f][_0x36ed57(0xb8f)]();if(_0x5c7cf8[_0x36ed57(0xbb9)](_0x36ed57(0x16a9))&&_0x5c7cf8!==_0x36ed57(0x290)){const _0x8dd95b=_0x5c7cf8[_0x36ed57(0x371)](0x6);try{const _0x86f909=JSON[_0x36ed57(0x13f7)](_0x8dd95b);if(_0x86f909[_0x36ed57(0x10cb)]===_0x36ed57(0x158b)&&_0x86f909['image']){_0x2dcfec=_0x86f909[_0x36ed57(0xf86)],console['log'](_0x36ed57(0x136b));break;}if(_0x86f909[_0x36ed57(0x55b)]){_0x2dcfec=_0x86f909[_0x36ed57(0x55b)],console[_0x36ed57(0x1e6)]('从\x20JSON.data\x20中提取图片数据');break;}if(_0x86f909[_0x36ed57(0xf86)]){_0x2dcfec=_0x86f909[_0x36ed57(0xf86)],console[_0x36ed57(0x1e6)](_0x36ed57(0x418));break;}}catch(_0x3a3ed6){_0x2dcfec=_0x8dd95b,console[_0x36ed57(0x1e6)](_0x36ed57(0x7a5));break;}}}if(!_0x2dcfec)throw new Error(_0x36ed57(0x309));const _0x1ba66a=_0x2dcfec[_0x36ed57(0xbb9)](_0x36ed57(0x1646)),_0x4a2491=_0x2dcfec[_0x36ed57(0xbb9)](_0x36ed57(0x573));if(_0x1ba66a||_0x4a2491){console[_0x36ed57(0x1e6)](_0x36ed57(0x10b0));const _0x1cc1a9=atob(_0x2dcfec),_0xdf54c2=new Uint8Array(_0x1cc1a9[_0x36ed57(0x8d6)]);for(let _0x58f6bf=0x0;_0x58f6bf<_0x1cc1a9[_0x36ed57(0x8d6)];_0x58f6bf++){_0xdf54c2[_0x58f6bf]=_0x1cc1a9[_0x36ed57(0xd17)](_0x58f6bf);}const _0x8b000f=new Blob([_0xdf54c2],{'type':_0x1ba66a?_0x36ed57(0x1443):_0x36ed57(0x12d5)});console[_0x36ed57(0x1e6)](_0x36ed57(0x802),_0x8b000f['size']);const _0x300d18=new FileReader();_0x411747=await new Promise((_0x4dded1,_0x247186)=>{const _0x5a9937=_0x36ed57;_0x300d18[_0x5a9937(0x8d1)]=()=>_0x4dded1(_0x300d18['result']),_0x300d18[_0x5a9937(0x96d)]=_0x247186,_0x300d18[_0x5a9937(0x157f)](_0x8b000f);}),console[_0x36ed57(0x1e6)](_0x36ed57(0x10ee));}else{console['log'](_0x36ed57(0x994));const _0x5947c1=atob(_0x2dcfec),_0x226f7d=new Uint8Array(_0x5947c1['length']);for(let _0x108e04=0x0;_0x108e04<_0x5947c1['length'];_0x108e04++){_0x226f7d[_0x108e04]=_0x5947c1['charCodeAt'](_0x108e04);}_0x1d3696=new Blob([_0x226f7d]),console['log'](_0x36ed57(0x434),_0x1d3696['size']);}}else _0x1d3696=await _0x284550[_0x36ed57(0xf6d)](),console[_0x36ed57(0x1e6)](_0x36ed57(0xd37),_0x1d3696[_0x36ed57(0xbbf)],_0x36ed57(0x24e),_0x1d3696[_0x36ed57(0x9e8)]);if(!_0x411747&&_0x1d3696)try{if(typeof JSZip===_0x36ed57(0xd30))throw new Error(_0x36ed57(0x79c));const _0x5b37ab=await JSZip[_0x36ed57(0x7b4)](_0x1d3696);console[_0x36ed57(0x1e6)](_0x36ed57(0x137c),Object[_0x36ed57(0x1161)](_0x5b37ab['files']));let _0xb872e0=null;for(let _0x5d5505 in _0x5b37ab[_0x36ed57(0x780)]){if(_0x5d5505[_0x36ed57(0xbf7)](/\.(png|jpg|jpeg|webp)$/i)){_0xb872e0=_0x5b37ab['files'][_0x5d5505],console[_0x36ed57(0x1e6)](_0x36ed57(0xf04),_0x5d5505);break;}}if(!_0xb872e0)throw new Error(_0x36ed57(0x13ca));const _0x42a187=await _0xb872e0['async']('blob');console[_0x36ed57(0x1e6)]('提取的图片大小:',_0x42a187[_0x36ed57(0x9e8)]);const _0x14475c=new FileReader();_0x411747=await new Promise((_0x5f09de,_0x1e75ed)=>{const _0x1cd13b=_0x36ed57;_0x14475c[_0x1cd13b(0x8d1)]=()=>_0x5f09de(_0x14475c['result']),_0x14475c[_0x1cd13b(0x96d)]=_0x1e75ed,_0x14475c[_0x1cd13b(0x157f)](_0x42a187);}),console[_0x36ed57(0x1e6)](_0x36ed57(0x28a));}catch(_0x59cfb4){console[_0x36ed57(0x5d7)](_0x36ed57(0x13a5),_0x59cfb4);throw new Error(_0x36ed57(0x1578)+_0x59cfb4[_0x36ed57(0x6e2)]);}console[_0x36ed57(0x1e6)]('✅\x20NAI图片'+(_0xe7defa+0x1)+_0x36ed57(0xed9)),_0xd745e[_0x36ed57(0x6bb)](_0x411747);}_0x205ec5[_0x36ed57(0xeaf)]=_0xd745e,_0xd745e[_0x36ed57(0x8d6)]===0x1&&(_0x205ec5[_0x36ed57(0x1436)]=_0xd745e[0x0]),_0x205ec5[_0x36ed57(0x156c)]=_0x5e659c[_0x36ed57(0x156c)],_0x205ec5[_0x36ed57(0x1fd)]=_0xd745e['length'],console['log'](_0x36ed57(0xa92)+_0xd745e[_0x36ed57(0x8d6)]+'张');}catch(_0x189ae2){console[_0x36ed57(0x5d7)]('❌\x20动态NAI图片生成失败:',_0x189ae2),_0x205ec5[_0x36ed57(0x1109)]=(_0x205ec5[_0x36ed57(0x1109)]||_0x205ec5[_0x36ed57(0xdb3)]||'')+(_0x36ed57(0x617)+_0x189ae2[_0x36ed57(0x6e2)]+']');}await _0x54c587[_0x36ed57(0xba7)][_0x36ed57(0x12b6)](_0x205ec5),_0x13e35a(_0x582d69+0x1);_0x1b61e3&&document[_0x36ed57(0x400)]('qzone-screen')[_0x36ed57(0xb08)][_0x36ed57(0xd3f)]('active')&&await _0x335d36();continue;case'qzone_comment':{const _0xe9ba95=await _0x54c587[_0x36ed57(0xba7)][_0x36ed57(0xf48)](parseInt(_0x5e659c[_0x36ed57(0x2b7)]));if(_0xe9ba95){if(!_0xe9ba95[_0x36ed57(0xf8f)])_0xe9ba95[_0x36ed57(0xf8f)]=[];const _0x3afbe7=_0x5e659c['name']||_0x312594['originalName'],_0x7c66a3=(_0x449e5e,_0x3ac863=null,_0x5505df=null)=>({'commenterName':_0x3afbe7,'text':_0x2bafeb(_0x449e5e,_0x312594),'meaning':_0x3ac863,'replyTo':_0x5505df,'timestamp':Date[_0x36ed57(0xecd)]()});if(_0x5e659c[_0x36ed57(0xc60)]){const _0x1a6404=_0x4c8b14[_0x36ed57(0x120c)][_0x36ed57(0x821)](_0x44bbda=>_0x44bbda[_0x36ed57(0xf3e)]===_0x5e659c[_0x36ed57(0xc60)]);_0x1a6404?_0xe9ba95[_0x36ed57(0xf8f)]['push'](_0x7c66a3(_0x1a6404[_0x36ed57(0x299)],_0x1a6404[_0x36ed57(0xf3e)],_0x5e659c[_0x36ed57(0x10bf)]||null)):(console[_0x36ed57(0x75e)]('AI\x20尝试评论一个不存在的表情:\x20\x22'+_0x5e659c[_0x36ed57(0xc60)]+'\x22'),_0xe9ba95[_0x36ed57(0xf8f)][_0x36ed57(0x6bb)](_0x7c66a3(_0x36ed57(0x84c)+_0x5e659c['stickerMeaning']+']',null,_0x5e659c[_0x36ed57(0x10bf)]||null)));}else{if(Array[_0x36ed57(0x16a1)](_0x5e659c[_0x36ed57(0xf8f)]))_0x5e659c[_0x36ed57(0xf8f)]['forEach'](_0x103931=>{const _0x896589=_0x36ed57;typeof _0x103931===_0x896589(0x158f)&&_0x103931[_0x896589(0xb8f)]()&&_0xe9ba95[_0x896589(0xf8f)]['push'](_0x7c66a3(_0x103931,null,_0x5e659c[_0x896589(0x10bf)]||null));});else typeof _0x5e659c[_0x36ed57(0x555)]===_0x36ed57(0x158f)&&_0x5e659c[_0x36ed57(0x555)][_0x36ed57(0xb8f)]()&&_0xe9ba95[_0x36ed57(0xf8f)][_0x36ed57(0x6bb)](_0x7c66a3(_0x5e659c[_0x36ed57(0x555)],null,_0x5e659c[_0x36ed57(0x10bf)]||null));}await _0x54c587[_0x36ed57(0xba7)][_0x36ed57(0x126d)](_0xe9ba95['id'],{'comments':_0xe9ba95['comments']}),_0x13e35a(_0x582d69+0x1),console['log'](_0x36ed57(0x8c9)+_0x312594['name']+_0x36ed57(0x8ec)+_0x5e659c[_0x36ed57(0x2b7)]);if(!_0x312594['commentCooldowns'])_0x312594['commentCooldowns']={};_0x312594[_0x36ed57(0x881)][_0x5e659c[_0x36ed57(0x2b7)]]=Date[_0x36ed57(0xecd)]();}continue;}case _0x36ed57(0x8dd):const _0x28b823=await _0x54c587[_0x36ed57(0xba7)][_0x36ed57(0xf48)](parseInt(_0x5e659c[_0x36ed57(0x2b7)]));if(_0x28b823){if(!_0x28b823['likes'])_0x28b823['likes']=[];!_0x28b823['likes']['includes'](_0x312594[_0x36ed57(0xf3e)])&&(_0x28b823[_0x36ed57(0xe30)]['push'](_0x312594['name']),await _0x54c587[_0x36ed57(0xba7)][_0x36ed57(0x126d)](_0x28b823['id'],{'likes':_0x28b823[_0x36ed57(0xe30)]}),_0x13e35a(_0x582d69+0x1),_0x1b61e3&&document[_0x36ed57(0x400)](_0x36ed57(0x951))[_0x36ed57(0xb08)][_0x36ed57(0xd3f)](_0x36ed57(0x5d6))&&await _0x335d36());}continue;case _0x36ed57(0x808):{const _0x2a3a8d=await _0x54c587['qzonePosts'][_0x36ed57(0xf48)](parseInt(_0x5e659c['postId']));if(_0x2a3a8d){const _0x453b39={'type':_0x36ed57(0x808),'timestamp':Date[_0x36ed57(0xecd)](),'authorId':_0x1e6f84,'authorGroupId':_0x312594[_0x36ed57(0x1145)],'repostComment':_0x5e659c[_0x36ed57(0x83c)]||'','originalPost':_0x2a3a8d,'visibleGroupIds':null};await _0x54c587[_0x36ed57(0xba7)][_0x36ed57(0x12b6)](_0x453b39),_0x13e35a(_0x582d69+0x1),console[_0x36ed57(0x1e6)]('后台活动:\x20角色\x20\x22'+_0x312594[_0x36ed57(0xf3e)]+_0x36ed57(0x32a)+_0x5e659c['postId']);}continue;}case'video_call_request':!_0x4037ab[_0x36ed57(0x11e7)]&&!_0x4037ab['isAwaitingResponse']&&(_0x4c8b14['activeChatId']=_0x1e6f84,_0x4037ab[_0x36ed57(0x1539)]=_0x1e6f84,_0x4037ab[_0x36ed57(0x3ed)]=!![],_0x4037ab[_0x36ed57(0x593)]=_0x312594[_0x36ed57(0xc98)],_0x4037ab[_0x36ed57(0x496)]=_0x5e659c[_0x36ed57(0xf3e)]||_0x312594[_0x36ed57(0xf3e)],_0x33f076());continue;case _0x36ed57(0x5a1):!_0x4037ab['isActive']&&!_0x4037ab[_0x36ed57(0x3ed)]&&(_0x4c8b14[_0x36ed57(0x1539)]=_0x1e6f84,_0x4037ab[_0x36ed57(0x3ed)]=!![],_0x4037ab['isGroupCall']=!![],_0x4037ab[_0x36ed57(0x8fc)]='ai',_0x4037ab[_0x36ed57(0x496)]=_0x5e659c[_0x36ed57(0xf3e)],_0x33f076());continue;case _0x36ed57(0xa55):let _0x226cd7;if(_0x312594[_0x36ed57(0xc98)]){const _0x893e98=_0x312594['members']['find'](_0x5dbd81=>_0x5dbd81['originalName']===_0x5e659c['name']);_0x226cd7=_0x893e98?_0x893e98[_0x36ed57(0x7ca)]:_0x5e659c['name'];}else _0x226cd7=_0x312594['name'];const _0x57701f=_0x5e659c[_0x36ed57(0x805)]?'\x20'+_0x5e659c[_0x36ed57(0x805)]['trim']():'',_0x34b745=_0x226cd7+_0x36ed57(0x1220)+_0x57701f,_0x20bccc={'role':_0x36ed57(0xaf6),'type':'pat_message','content':_0x34b745,'timestamp':Date['now']()};_0x312594['history']['push'](_0x20bccc);if(_0x1b61e3){const _0x146a31=document[_0x36ed57(0x400)](_0x36ed57(0x43a));_0x146a31['classList'][_0x36ed57(0xc46)]('pat-animation'),void _0x146a31['offsetWidth'],_0x146a31['classList'][_0x36ed57(0x12b6)](_0x36ed57(0x6fc)),setTimeout(()=>_0x146a31[_0x36ed57(0xb08)][_0x36ed57(0xc46)](_0x36ed57(0x6fc)),0x1f4),_0x41ecc7(_0x20bccc,_0x312594);}else _0x301fc2(_0x1e6f84,_0x34b745);continue;case _0x36ed57(0xa5c):_0x312594['status'][_0x36ed57(0x117f)]=_0x5e659c[_0x36ed57(0x932)],_0x312594['status']['isBusy']=_0x5e659c[_0x36ed57(0x11da)]||![],_0x312594[_0x36ed57(0x12c3)][_0x36ed57(0x2b5)]=Date[_0x36ed57(0xecd)]();const _0x41dda6={'role':_0x36ed57(0xaf6),'type':_0x36ed57(0xaa4),'content':'['+_0x312594['name']+'的状态已更新为:\x20'+_0x5e659c[_0x36ed57(0x932)]+']','timestamp':Date[_0x36ed57(0xecd)]()};_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x6bb)](_0x41dda6);_0x1b61e3&&_0x41ecc7(_0x41dda6,_0x312594);_0x41b828();continue;case _0x36ed57(0xdeb):_0x24ae48={..._0x42947b,'type':_0x36ed57(0xdeb),'content':_0x5e659c[_0x36ed57(0x1109)]};break;case _0x36ed57(0x5ca):if(_0x59adb2[_0x36ed57(0x11e7)]&&_0x59adb2[_0x36ed57(0x1539)]===_0x1e6f84){const _0x17b2f8=_0x5e659c[_0x36ed57(0xf71)]||_0x5e659c[_0x36ed57(0x67f)]||_0x5e659c[_0x36ed57(0xf3e)];if(typeof _0x17b2f8===_0x36ed57(0x158f)&&_0x17b2f8[_0x36ed57(0xb8f)]()){const _0x3353f1=_0x17b2f8[_0x36ed57(0xe19)](/^\[?\d+\]?[\s.-]*/,'')['trim'](),_0x4878b8=_0x59adb2[_0x36ed57(0xc3e)][_0x36ed57(0x11a4)](_0x8e30e4=>_0x8e30e4[_0x36ed57(0xf3e)]['toLowerCase']()===_0x3353f1[_0x36ed57(0x1653)]());if(_0x4878b8>-0x1){_0x3efb75(_0x4878b8);const _0x5cb17b=_0x59adb2[_0x36ed57(0xc3e)][_0x4878b8];let _0x926526;if(_0x312594[_0x36ed57(0xc98)]){const _0x2fc2d0=_0x312594[_0x36ed57(0x4f8)][_0x36ed57(0x821)](_0x710eb=>_0x710eb['originalName']===_0x5e659c[_0x36ed57(0xf3e)]);_0x926526=_0x2fc2d0?_0x2fc2d0[_0x36ed57(0x7ca)]:_0x5e659c['name'];}else _0x926526=_0x312594[_0x36ed57(0xf3e)];const _0x4ee44c={'role':'system','type':_0x36ed57(0xaa4),'content':_0x36ed57(0x8ef)+_0x926526+_0x36ed57(0x3f7)+_0x5cb17b['name']+_0x36ed57(0x278)+_0x5cb17b[_0x36ed57(0x833)]+']','timestamp':Date[_0x36ed57(0xecd)]()};_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x6bb)](_0x4ee44c),_0x1b61e3&&_0x41ecc7(_0x4ee44c,_0x312594);}else console[_0x36ed57(0x75e)]('歌曲查找失败:\x20AI请求的歌曲名\x22'+_0x17b2f8+_0x36ed57(0x1292)+_0x3353f1+_0x36ed57(0x4f2));}else console[_0x36ed57(0x5d7)](_0x36ed57(0xee3),_0x5e659c);}continue;case _0x36ed57(0xe76):const _0x481967={'chatId':_0x1e6f84,'authorId':_0x1e6f84,'description':_0x5e659c[_0x36ed57(0x12a5)],'timestamp':Date['now'](),'type':'ai_generated'};await _0x54c587[_0x36ed57(0x1541)][_0x36ed57(0x12b6)](_0x481967),console[_0x36ed57(0x1e6)](_0x36ed57(0xcde)+_0x312594['name']+_0x36ed57(0x5aa),_0x5e659c[_0x36ed57(0x12a5)]);continue;case _0x36ed57(0xc2e):const _0xf5ea2f=new Date(_0x5e659c['date']);if(!isNaN(_0xf5ea2f)&&_0xf5ea2f>new Date()){const _0x3cec97={'chatId':_0x1e6f84,'authorId':_0x1e6f84,'description':_0x5e659c[_0x36ed57(0x647)],'timestamp':Date[_0x36ed57(0xecd)](),'type':'countdown','targetDate':_0xf5ea2f[_0x36ed57(0xff4)]()};await _0x54c587[_0x36ed57(0x1541)][_0x36ed57(0x12b6)](_0x3cec97),console['log'](_0x36ed57(0xcde)+_0x312594[_0x36ed57(0xf3e)]+'\x22\x20创建了一个新约定:',_0x5e659c['title']);}continue;case _0x36ed57(0x825):if(!_0x312594[_0x36ed57(0xc98)]){_0x312594['relationship'][_0x36ed57(0x12c3)]=_0x36ed57(0x11a5);const _0x37c8c3={'role':_0x36ed57(0xaf6),'content':_0x36ed57(0x231),'timestamp':Date[_0x36ed57(0xecd)](),'isHidden':!![]};_0x312594['history'][_0x36ed57(0x6bb)](_0x37c8c3),await _0x54c587[_0x36ed57(0xbea)][_0x36ed57(0x4cb)](_0x312594);_0x1b61e3&&_0x26354c(_0x1e6f84);_0x41b828();break;}continue;case _0x36ed57(0xe03):!_0x312594[_0x36ed57(0xc98)]&&_0x312594[_0x36ed57(0x12f7)]?.['status']===_0x36ed57(0x59d)&&(_0x5e659c['decision']===_0x36ed57(0xe81)?(_0x312594[_0x36ed57(0x12f7)][_0x36ed57(0x12c3)]=_0x36ed57(0x1290),_0x24ae48={..._0x42947b,'content':_0x36ed57(0x108e)}):(_0x312594['relationship'][_0x36ed57(0x12c3)]=_0x36ed57(0x11a5),_0x24ae48={..._0x42947b,'content':_0x36ed57(0xe02)}),_0x312594['relationship'][_0x36ed57(0x275)]='');break;case'poll':const _0x16733e=typeof _0x5e659c[_0x36ed57(0x48e)]===_0x36ed57(0x158f)?_0x5e659c[_0x36ed57(0x48e)][_0x36ed57(0x5ad)]('\x0a')['filter'](_0x5acce5=>_0x5acce5['trim']()):Array['isArray'](_0x5e659c[_0x36ed57(0x48e)])?_0x5e659c[_0x36ed57(0x48e)]:[];if(_0x16733e[_0x36ed57(0x8d6)]<0x2)continue;_0x24ae48={..._0x42947b,'type':_0x36ed57(0x1618),'question':_0x5e659c[_0x36ed57(0xf96)],'options':_0x16733e,'votes':{},'isClosed':![]};break;case _0x36ed57(0x15b6):{const {itemName:_0x3663e9,itemPrice:_0x4e7b14,image_prompt:_0x22e771}=_0x5e659c;if(_0x3663e9&&!isNaN(parseFloat(_0x4e7b14))&&_0x22e771){const _0x3d9bd6=_0x36ed57(0x9c3)+encodeURIComponent(_0x22e771);_0x24ae48={..._0x42947b,'type':'gift','items':[{'name':_0x3663e9,'price':parseFloat(_0x4e7b14),'imageUrl':_0x3d9bd6,'quantity':0x1}],'total':parseFloat(_0x4e7b14),'recipients':_0x5e659c[_0x36ed57(0x1170)]||null};}else console[_0x36ed57(0x75e)](_0x36ed57(0x829),_0x5e659c);break;}case _0x36ed57(0xc61):const _0x305847=_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x821)](_0x455c9e=>_0x455c9e['timestamp']===_0x5e659c['poll_timestamp']);_0x305847&&!_0x305847[_0x36ed57(0x3c0)]&&(Object[_0x36ed57(0x1161)](_0x305847[_0x36ed57(0x14a6)])[_0x36ed57(0xbdc)](_0x15c976=>{const _0x44e85d=_0x36ed57,_0x270bf3=_0x305847[_0x44e85d(0x14a6)][_0x15c976]['indexOf'](_0x5e659c[_0x44e85d(0xf3e)]);_0x270bf3>-0x1&&_0x305847['votes'][_0x15c976][_0x44e85d(0xdcc)](_0x270bf3,0x1);}),!_0x305847['votes'][_0x5e659c[_0x36ed57(0x51e)]]&&(_0x305847[_0x36ed57(0x14a6)][_0x5e659c[_0x36ed57(0x51e)]]=[]),!_0x305847['votes'][_0x5e659c[_0x36ed57(0x51e)]][_0x36ed57(0xd1b)](_0x5e659c['name'])&&_0x305847['votes'][_0x5e659c['choice']][_0x36ed57(0x6bb)](_0x5e659c[_0x36ed57(0xf3e)]),_0x1b61e3&&_0x26354c(_0x1e6f84));continue;case'red_packet':_0x24ae48={..._0x42947b,..._0x5e659c,'totalAmount':_0x5e659c[_0x36ed57(0x12e7)],'claimedBy':{},'isFullyClaimed':![]};if(_0x24ae48[_0x36ed57(0x1015)]==='lucky'){const _0x2fe4ed=generateRandomPacketAmounts(_0x24ae48[_0x36ed57(0x12e7)],_0x24ae48[_0x36ed57(0xcbc)]);_0x24ae48[_0x36ed57(0x111b)]=_0x2fe4ed,_0x24ae48['unclaimedAmounts']=[..._0x2fe4ed];}_0x5e659c['receiver']&&(_0x24ae48['receiverName']=_0x5e659c[_0x36ed57(0x7b6)],delete _0x24ae48['receiver']);break;case _0x36ed57(0x35b):const _0xa0d3eb=_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x821)](_0x4e4dfb=>_0x4e4dfb[_0x36ed57(0x287)]===_0x5e659c[_0x36ed57(0xa89)]),_0x11ae38=_0x5e659c['name'],_0x199249=_0x312594['members']['some'](_0x2da491=>_0x2da491['originalName']===_0x11ae38);if(!_0x199249){console[_0x36ed57(0x75e)](_0x36ed57(0x1273)+_0x11ae38+_0x36ed57(0x9e3));continue;}if(_0xa0d3eb&&_0xa0d3eb[_0x36ed57(0x1015)]==='direct'){if(_0xa0d3eb[_0x36ed57(0x11fd)]!==_0x5e659c['name']){console['warn'](_0x36ed57(0x1273)+_0x5e659c['name']+_0x36ed57(0x1593)+_0xa0d3eb[_0x36ed57(0x11fd)]+_0x36ed57(0x2da));continue;}}if(_0xa0d3eb&&!_0xa0d3eb[_0x36ed57(0x1023)]&&!(_0xa0d3eb[_0x36ed57(0x1360)]&&_0xa0d3eb['claimedBy'][_0x5e659c['name']])){let _0x502a5d=0x0;const _0x2f7372=_0xa0d3eb[_0x36ed57(0xff7)]-Object[_0x36ed57(0x40a)](_0xa0d3eb['claimedBy']||{})[_0x36ed57(0x439)]((_0x2c6522,_0x47fb57)=>_0x2c6522+_0x47fb57,0x0),_0x2f0315=_0xa0d3eb[_0x36ed57(0xcbc)]-Object[_0x36ed57(0x1161)](_0xa0d3eb[_0x36ed57(0x1360)]||{})[_0x36ed57(0x8d6)];if(_0x2f0315>0x0){if(_0xa0d3eb[_0x36ed57(0x1015)]===_0x36ed57(0xfd0))_0x502a5d=_0xa0d3eb['totalAmount'];else{if(_0xa0d3eb[_0x36ed57(0x6a7)]&&_0xa0d3eb[_0x36ed57(0x6a7)][_0x36ed57(0x8d6)]>0x0)_0x502a5d=_0xa0d3eb[_0x36ed57(0x6a7)][_0x36ed57(0x5ac)]();else{console[_0x36ed57(0x75e)]('检测到旧版红包，回退到旧的（不公平）随机算法\x20(triggerAiResponse)');const _0x2abfe9=_0xa0d3eb[_0x36ed57(0xff7)]-Object['values'](_0xa0d3eb[_0x36ed57(0x1360)]||{})[_0x36ed57(0x439)]((_0x3cfe4c,_0x3d840f)=>_0x3cfe4c+_0x3d840f,0x0);if(_0x2f0315===0x1)_0x502a5d=_0x2abfe9;else{const _0x22635c=0.01,_0x41e5d0=_0x2abfe9-(_0x2f0315-0x1)*_0x22635c;_0x502a5d=Math['random']()*(_0x41e5d0-_0x22635c)+_0x22635c;}}}_0x502a5d=parseFloat(_0x502a5d['toFixed'](0x2));if(!_0xa0d3eb[_0x36ed57(0x1360)])_0xa0d3eb[_0x36ed57(0x1360)]={};_0xa0d3eb[_0x36ed57(0x1360)][_0x5e659c[_0x36ed57(0xf3e)]]=_0x502a5d;const _0x15b58a=_0x312594[_0x36ed57(0x4f8)][_0x36ed57(0x821)](_0x2ac5b7=>_0x2ac5b7[_0x36ed57(0xdcf)]===_0x5e659c[_0x36ed57(0xf3e)]),_0x520d32=_0x15b58a?_0x15b58a[_0x36ed57(0x7ca)]:_0x5e659c['name'],_0x1793f4=_0x288d80(_0x312594,_0xa0d3eb[_0x36ed57(0x3e7)]),_0x3b2505={'role':_0x36ed57(0xaf6),'type':_0x36ed57(0xaa4),'content':_0x520d32+'\x20领取了\x20'+_0x1793f4+'\x20的红包','timestamp':_0x387812++};_0x312594[_0x36ed57(0x92c)]['push'](_0x3b2505);let _0x1c3ede=_0x36ed57(0x876)+_0x520d32+')\x20成功抢到了\x20'+_0x502a5d['toFixed'](0x2)+_0x36ed57(0xe1e);if(_0xa0d3eb[_0x36ed57(0x6a7)]&&_0xa0d3eb[_0x36ed57(0x6a7)][_0x36ed57(0x8d6)]===0x0||Object[_0x36ed57(0x1161)](_0xa0d3eb['claimedBy'])[_0x36ed57(0x8d6)]>=_0xa0d3eb[_0x36ed57(0xcbc)]){_0xa0d3eb[_0x36ed57(0x1023)]=!![];const _0x1c288e={'role':_0x36ed57(0xaf6),'type':_0x36ed57(0xaa4),'content':_0x1793f4+_0x36ed57(0xd23),'timestamp':_0x387812++};_0x312594[_0x36ed57(0x92c)]['push'](_0x1c288e);let _0x536015={'name':'','amount':-0x1};_0xa0d3eb[_0x36ed57(0x1015)]===_0x36ed57(0xc01)&&_0xa0d3eb[_0x36ed57(0xcbc)]>0x1&&Object['entries'](_0xa0d3eb['claimedBy'])['forEach'](([_0x29cd2a,_0x21cd9a])=>{const _0x1448fe=_0x36ed57;_0x21cd9a>_0x536015[_0x1448fe(0x12e7)]&&(_0x536015={'name':_0x29cd2a,'amount':_0x21cd9a});});if(_0x536015[_0x36ed57(0xf3e)]){const _0x11ed14=_0x312594[_0x36ed57(0x4f8)][_0x36ed57(0x821)](_0x3943eb=>_0x3943eb[_0x36ed57(0xdcf)]===_0x536015[_0x36ed57(0xf3e)]),_0x263ed3=_0x11ed14?_0x11ed14['groupNickname']:_0x536015['name'];_0x1c3ede+=_0x36ed57(0x7cc)+_0x263ed3+'！';}else _0x1c3ede+='\x20红包已被领完。';}_0x1c3ede+=_0x36ed57(0xd85);const _0x1e1be6={'role':_0x36ed57(0xaf6),'content':_0x1c3ede,'timestamp':_0x387812++,'isHidden':!![]};_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x6bb)](_0x1e1be6);}_0x1b61e3&&(_0x26354c(_0x1e6f84),_0x41b828());}continue;case _0x36ed57(0xba1):{const _0x4bf1b0=_0x312594['history']['findIndex'](_0xcadfa9=>_0xcadfa9[_0x36ed57(0x287)]===_0x5e659c[_0x36ed57(0x1332)]);if(_0x4bf1b0>-0x1){const _0x57acd3=_0x312594[_0x36ed57(0x92c)][_0x4bf1b0];_0x57acd3[_0x36ed57(0x12c3)]=_0x36ed57(0x6cc);}continue;}case _0x36ed57(0x2df):{const _0x5b4f69=_0x312594['history'][_0x36ed57(0x11a4)](_0x59fe2f=>_0x59fe2f[_0x36ed57(0x287)]===_0x5e659c[_0x36ed57(0x1332)]);if(_0x5b4f69>-0x1){const _0x2d0224=_0x312594['history'][_0x5b4f69];_0x2d0224[_0x36ed57(0x12c3)]=_0x36ed57(0x81f);const _0x5aeaae={'role':'assistant','senderName':_0x312594[_0x36ed57(0xf3e)],'type':_0x36ed57(0x112f),'isRefund':!![],'amount':_0x2d0224[_0x36ed57(0x12e7)],'note':'转账已被拒收','timestamp':_0x387812++};_0x312594['history'][_0x36ed57(0x6bb)](_0x5aeaae),_0x1b61e3&&(_0x41ecc7(_0x5aeaae,_0x312594),_0x26354c(_0x1e6f84));}continue;}case _0x36ed57(0x9cb):if(_0x312594[_0x36ed57(0xc98)]&&_0x5e659c[_0x36ed57(0x122c)]){const _0x3795cb=_0x5e659c['new_name'][_0x36ed57(0xb8f)](),_0x76e3c9=_0x312594[_0x36ed57(0x4f8)]['map'](_0x51abd7=>_0x51abd7['originalName']);if(_0x76e3c9['includes'](_0x3795cb)){console[_0x36ed57(0x75e)](_0x36ed57(0xf16)+_0x5e659c[_0x36ed57(0xf3e)]+_0x36ed57(0x5dc)+_0x3795cb+_0x36ed57(0xbaa));continue;}_0x312594['name']=_0x3795cb;const _0x4b5c51=_0x312594[_0x36ed57(0x4f8)]['find'](_0x478670=>_0x478670[_0x36ed57(0xdcf)]===_0x5e659c[_0x36ed57(0xf3e)]),_0x35679e=_0x4b5c51?_0x4b5c51[_0x36ed57(0x7ca)]:_0x5e659c[_0x36ed57(0xf3e)],_0x53e391={'role':'system','type':_0x36ed57(0xaa4),'content':_0x35679e+'\x20将群名修改为\x20“'+_0x312594[_0x36ed57(0xf3e)]+'”','timestamp':_0x387812++};_0x312594['history'][_0x36ed57(0x6bb)](_0x53e391),_0x1b61e3&&(_0x41ecc7(_0x53e391,_0x312594),document[_0x36ed57(0x400)](_0x36ed57(0x1429))[_0x36ed57(0xde7)]=_0x312594[_0x36ed57(0xf3e)]);}continue;case _0x36ed57(0xbde):if(!_0x312594[_0x36ed57(0xc98)]&&_0x5e659c[_0x36ed57(0x122c)]){const _0x551408=_0x312594[_0x36ed57(0xf3e)],_0x30c1ac=_0x5e659c['new_name']['trim']();if(_0x30c1ac&&_0x30c1ac!==_0x551408){!_0x312594['nameHistory']&&(_0x312594[_0x36ed57(0x112b)]=[]);!_0x312594[_0x36ed57(0x112b)][_0x36ed57(0xd1b)](_0x551408)&&_0x312594[_0x36ed57(0x112b)][_0x36ed57(0x6bb)](_0x551408);_0x312594[_0x36ed57(0xf3e)]=_0x30c1ac;const _0xa886a9={'role':_0x36ed57(0xaf6),'type':'pat_message','content':'“'+_0x312594['originalName']+'”\x20将备注修改为\x20“'+_0x30c1ac+'”','timestamp':_0x387812++};_0x312594['history']['push'](_0xa886a9);const _0x291b62={'role':_0x36ed57(0xaf6),'content':_0x36ed57(0xec6)+_0x30c1ac+_0x36ed57(0x1528),'timestamp':_0x387812++,'isHidden':!![]};_0x312594['history'][_0x36ed57(0x6bb)](_0x291b62),_0x1b61e3&&(_0x41ecc7(_0xa886a9,_0x312594),document[_0x36ed57(0x400)](_0x36ed57(0x1429))[_0x36ed57(0xde7)]=_0x30c1ac),await _0xed04e8(_0x312594);}}continue;case _0x36ed57(0x1565):if(_0x312594['isGroup']&&_0x5e659c[_0x36ed57(0xd01)]){const _0x246547=_0x5e659c[_0x36ed57(0xd01)],_0x4bf087=_0x312594[_0x36ed57(0xa37)][_0x36ed57(0x1634)]||[],_0x5cd11b=_0x4bf087[_0x36ed57(0x821)](_0x57f336=>_0x57f336[_0x36ed57(0xf3e)]===_0x246547);if(_0x5cd11b){_0x312594[_0x36ed57(0xa37)][_0x36ed57(0x465)]=_0x5cd11b[_0x36ed57(0x299)];const _0x54832a=_0x312594[_0x36ed57(0x4f8)][_0x36ed57(0x821)](_0x10a98a=>_0x10a98a[_0x36ed57(0xdcf)]===_0x5e659c[_0x36ed57(0xf3e)]),_0x2d79c7=_0x54832a?_0x54832a['groupNickname']:_0x5e659c[_0x36ed57(0xf3e)],_0xb4d089={'role':_0x36ed57(0xaf6),'type':'pat_message','content':_0x2d79c7+_0x36ed57(0x610),'timestamp':_0x387812++};_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x6bb)](_0xb4d089),_0x1b61e3&&_0x41ecc7(_0xb4d089,_0x312594);}else console[_0x36ed57(0x75e)](_0x36ed57(0x3a2)+_0x246547+'\x22');}continue;case'system_message':_0x24ae48={'role':_0x36ed57(0xaf6),'type':_0x36ed57(0xaa4),'content':_0x5e659c[_0x36ed57(0x1109)],'timestamp':Date[_0x36ed57(0xecd)]()};break;case _0x36ed57(0x4c1):_0x24ae48={..._0x42947b,'type':_0x36ed57(0x4c1),'title':_0x5e659c[_0x36ed57(0x647)],'description':_0x5e659c[_0x36ed57(0x12a5)],'source_name':_0x5e659c[_0x36ed57(0x2ca)],'content':_0x5e659c[_0x36ed57(0x1109)]};break;case _0x36ed57(0x788):{let _0x3e34d0=null;if(_0x5e659c[_0x36ed57(0x2d2)])_0x3e34d0=[..._0x312594[_0x36ed57(0x92c)]][_0x36ed57(0xfc1)]()[_0x36ed57(0x821)](_0x1f9e05=>!_0x1f9e05[_0x36ed57(0x118c)]&&(_0x1f9e05['content']===_0x5e659c[_0x36ed57(0x2d2)]||typeof _0x1f9e05[_0x36ed57(0x1109)]===_0x36ed57(0x158f)&&_0x1f9e05[_0x36ed57(0x1109)]['trim']()===_0x5e659c[_0x36ed57(0x2d2)][_0x36ed57(0xb8f)]())),!_0x3e34d0&&console[_0x36ed57(0x75e)]('[本轮引用失败]\x20AI\x20'+_0x5e659c['name']+_0x36ed57(0x1246)+(_0x5e659c[_0x36ed57(0x2d2)]||'')[_0x36ed57(0x371)](0x0,0x14)+'...\x22，但在本轮历史中未找到。');else _0x5e659c[_0x36ed57(0x396)]&&(_0x3e34d0=_0x312594['history'][_0x36ed57(0x821)](_0x3c14f7=>_0x3c14f7[_0x36ed57(0x287)]===_0x5e659c[_0x36ed57(0x396)]));if(_0x3e34d0){let _0x23d65b;_0x3e34d0['role']===_0x36ed57(0x6d6)?_0x23d65b=_0x312594['settings'][_0x36ed57(0x14a8)]||'我':_0x312594[_0x36ed57(0xc98)]?_0x23d65b=_0x288d80(_0x312594,_0x3e34d0[_0x36ed57(0x3e7)]):_0x23d65b=_0x312594[_0x36ed57(0xf3e)];const _0x45a242={'timestamp':_0x3e34d0[_0x36ed57(0x287)],'senderName':_0x23d65b,'content':String(_0x3e34d0['content']||'')[_0x36ed57(0x371)](0x0,0x32)};_0x24ae48={..._0x42947b,'content':_0x5e659c[_0x36ed57(0x103e)],'quote':_0x45a242};}else console[_0x36ed57(0x75e)](_0x36ed57(0x11a6)+_0x5e659c[_0x36ed57(0x2d2)]+_0x36ed57(0x81d)+_0x5e659c[_0x36ed57(0x396)]+')'),_0x24ae48={..._0x42947b,'content':_0x5e659c['reply_content']};break;}case _0x36ed57(0x7c7):{if(!_0x1b61e3)continue;const _0x2fc80e={..._0x42947b,'content':_0x5e659c['content']},_0x4398f=_0x43c5e5(_0x2fc80e,_0x312594);_0x41ecc7(_0x2fc80e,_0x312594,!![]),await new Promise(_0x1d6769=>setTimeout(_0x1d6769,Math[_0x36ed57(0x12bc)]()*0x7d0+0x1f4));const _0x4b67b1=document[_0x36ed57(0x13ef)](_0x36ed57(0xfe4)+_0x2fc80e[_0x36ed57(0x287)]+'\x22]')?.['closest'](_0x36ed57(0x867));if(_0x4b67b1){_0x4b67b1[_0x36ed57(0xb08)][_0x36ed57(0x12b6)](_0x36ed57(0x72d)),await new Promise(_0x334d4f=>setTimeout(_0x334d4f,0x12c));const _0xd0cdea={'role':_0x36ed57(0x4fd),'senderName':_0x5e659c[_0x36ed57(0xf3e)]||_0x312594[_0x36ed57(0xf3e)],'type':_0x36ed57(0x94e),'content':_0x36ed57(0x3f8),'timestamp':_0x2fc80e[_0x36ed57(0x287)],'recalledData':{'originalType':_0x36ed57(0x117f),'originalContent':_0x5e659c[_0x36ed57(0x1109)]}},_0x5d6e59=_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x11a4)](_0x1bbb18=>_0x1bbb18[_0x36ed57(0x287)]===_0x2fc80e[_0x36ed57(0x287)]);_0x5d6e59>-0x1?_0x312594[_0x36ed57(0x92c)][_0x5d6e59]=_0xd0cdea:_0x312594[_0x36ed57(0x92c)]['push'](_0xd0cdea);const _0x479f48=await _0x43c5e5(_0xd0cdea,_0x312594);document['body'][_0x36ed57(0xd3f)](_0x4b67b1)&&_0x4b67b1[_0x36ed57(0xa54)][_0x36ed57(0xf6f)](_0x479f48,_0x4b67b1);}continue;}case _0x36ed57(0x117f):_0x24ae48={..._0x42947b,'content':String(_0x5e659c[_0x36ed57(0x1109)]||_0x5e659c['message'])};break;case'sticker':if(_0x5e659c[_0x36ed57(0xca4)]){const _0x3f073f=findBestStickerMatch(_0x5e659c[_0x36ed57(0xca4)],_0x4c8b14[_0x36ed57(0x120c)]);_0x3f073f?_0x24ae48={..._0x42947b,'type':_0x36ed57(0x12c2),'content':_0x3f073f['url'],'meaning':_0x3f073f[_0x36ed57(0xf3e)]}:(console[_0x36ed57(0x75e)](_0x36ed57(0xb04)+_0x5e659c[_0x36ed57(0xca4)]+'\x22'),_0x24ae48=null);}else console[_0x36ed57(0x75e)]('AI\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。',_0x5e659c),_0x24ae48={..._0x42947b,'type':_0x36ed57(0x12c2),'content':_0x5e659c['url'],'meaning':_0x36ed57(0x44d)};break;case'ai_image':_0x24ae48={..._0x42947b,'type':_0x36ed57(0xea7),'content':_0x5e659c[_0x36ed57(0x12a5)],'image_prompt':_0x5e659c[_0x36ed57(0xff9)]};break;case _0x36ed57(0x295):_0x24ae48={..._0x42947b,'type':_0x36ed57(0x295),'content':_0x5e659c[_0x36ed57(0x1109)]};break;case _0x36ed57(0x112f):_0x24ae48={..._0x42947b,'type':_0x36ed57(0x112f),'amount':_0x5e659c[_0x36ed57(0x12e7)],'note':_0x5e659c[_0x36ed57(0x12bb)],'receiverName':_0x5e659c[_0x36ed57(0x7b6)]||'我'};break;case'waimai_request':_0x24ae48={..._0x42947b,'type':_0x36ed57(0xebc),'productInfo':_0x5e659c[_0x36ed57(0xff3)],'amount':_0x5e659c['amount'],'status':_0x36ed57(0x9c6),'countdownEndTime':Date['now']()+0xf*0x3c*0x3e8};break;case'waimai_order':_0x24ae48={..._0x42947b,'type':_0x36ed57(0xa19),'productInfo':_0x5e659c[_0x36ed57(0xff3)],'amount':_0x5e659c['amount'],'greeting':_0x5e659c[_0x36ed57(0xdf1)],'recipientName':_0x5e659c[_0x36ed57(0xa02)]||null};break;case _0x36ed57(0x86e):_0x24ae48={..._0x42947b,..._0x5e659c};break;case _0x36ed57(0xd3c):try{console[_0x36ed57(0x1e6)]('📸\x20NovelAI图片生成开始，AI提供的prompt:',_0x5e659c[_0x36ed57(0x156c)]);const _0x1ed5dd=_0x378780(_0x312594['id']),_0x49aae2=_0x5e659c[_0x36ed57(0x156c)]||'a\x20beautiful\x20scene',_0x5083b8=_0x49aae2+',\x20'+_0x1ed5dd[_0x36ed57(0x1671)],_0x1d7080=_0x1ed5dd[_0x36ed57(0x49c)];console[_0x36ed57(0x1e6)](_0x36ed57(0x142f)+(_0x1ed5dd[_0x36ed57(0x1311)]===_0x36ed57(0x2cc)?_0x36ed57(0x954):'系统')+_0x36ed57(0xedd)),console[_0x36ed57(0x1e6)](_0x36ed57(0x5b2),_0x5083b8),console['log'](_0x36ed57(0x115c),_0x1d7080);const _0x1eb8b=localStorage[_0x36ed57(0xca2)](_0x36ed57(0x1570)),_0x21a1ec=localStorage[_0x36ed57(0xca2)](_0x36ed57(0x355))||_0x36ed57(0x1375),_0x1941f5=_0x2400cd();if(!_0x1eb8b)throw new Error('NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。');const [_0x1700cf,_0x164bc2]=_0x1941f5['resolution']['split']('x')[_0x36ed57(0xd18)](Number);let _0x38246c;_0x21a1ec[_0x36ed57(0xd1b)](_0x36ed57(0x8b6))?_0x38246c={'input':_0x5083b8,'model':_0x21a1ec,'action':_0x36ed57(0xdb8),'parameters':{'params_version':0x3,'width':_0x1700cf,'height':_0x164bc2,'scale':_0x1941f5[_0x36ed57(0x507)],'sampler':_0x1941f5[_0x36ed57(0x924)],'steps':_0x1941f5['steps'],'seed':_0x1941f5[_0x36ed57(0xc76)]===-0x1?Math[_0x36ed57(0x1381)](Math[_0x36ed57(0x12bc)]()*0x2540be3ff):_0x1941f5['seed'],'n_samples':0x1,'ucPreset':_0x1941f5[_0x36ed57(0xc68)],'qualityToggle':_0x1941f5[_0x36ed57(0x5e1)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x36ed57(0x12b5),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x5083b8,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x1d7080,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x1d7080,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x38246c={'input':_0x5083b8,'model':_0x21a1ec,'action':_0x36ed57(0xdb8),'parameters':{'width':_0x1700cf,'height':_0x164bc2,'scale':_0x1941f5[_0x36ed57(0x507)],'sampler':_0x1941f5[_0x36ed57(0x924)],'steps':_0x1941f5['steps'],'seed':_0x1941f5[_0x36ed57(0xc76)]===-0x1?Math[_0x36ed57(0x1381)](Math['random']()*0x2540be3ff):_0x1941f5['seed'],'n_samples':0x1,'ucPreset':_0x1941f5['uc_preset'],'qualityToggle':_0x1941f5[_0x36ed57(0x5e1)],'sm':_0x1941f5[_0x36ed57(0x46b)],'sm_dyn':_0x1941f5['smea_dyn'],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':'native','negative_prompt':_0x1d7080}};console[_0x36ed57(0x1e6)](_0x36ed57(0xe56),_0x38246c);let _0x37a83a;_0x21a1ec[_0x36ed57(0xd1b)](_0x36ed57(0x8b6))?_0x37a83a=_0x36ed57(0x10f8):_0x37a83a=_0x36ed57(0xc3a);let _0x2fdf18=_0x1941f5['cors_proxy'];_0x2fdf18===_0x36ed57(0x7da)&&(_0x2fdf18=_0x1941f5[_0x36ed57(0x6af)]||'');_0x2fdf18&&_0x2fdf18!==''&&(_0x37a83a=_0x2fdf18+encodeURIComponent(_0x37a83a));const _0x51fa4a=await fetch(_0x37a83a,{'method':_0x36ed57(0x953),'headers':{'Content-Type':'application/json','Authorization':_0x36ed57(0xcee)+_0x1eb8b},'body':JSON[_0x36ed57(0xea5)](_0x38246c)});console[_0x36ed57(0x1e6)](_0x36ed57(0x637),_0x51fa4a[_0x36ed57(0x12c3)]),console[_0x36ed57(0x1e6)](_0x36ed57(0xade),[..._0x51fa4a['headers'][_0x36ed57(0x9de)]()]);if(!_0x51fa4a['ok']){const _0x67bf10=await _0x51fa4a[_0x36ed57(0x117f)]();console[_0x36ed57(0x5d7)](_0x36ed57(0x1221),_0x67bf10);throw new Error(_0x36ed57(0x167e)+_0x51fa4a['status']+_0x36ed57(0x29e)+_0x67bf10);}const _0x2ea9d4=_0x51fa4a[_0x36ed57(0x451)][_0x36ed57(0xf48)](_0x36ed57(0x255));console['log']('Content-Type:',_0x2ea9d4);let _0x1d4187,_0xb4da7d;if(_0x2ea9d4&&_0x2ea9d4[_0x36ed57(0xd1b)](_0x36ed57(0x996))){console[_0x36ed57(0x1e6)]('检测到\x20SSE\x20流式响应，开始解析...');const _0x29c2c5=await _0x51fa4a['text']();console[_0x36ed57(0x1e6)](_0x36ed57(0x108d),_0x29c2c5[_0x36ed57(0x8d6)]);const _0x2ef0c0=_0x29c2c5[_0x36ed57(0xb8f)]()[_0x36ed57(0x5ad)]('\x0a');let _0x205989=null;for(let _0x130df2=_0x2ef0c0['length']-0x1;_0x130df2>=0x0;_0x130df2--){const _0x40306c=_0x2ef0c0[_0x130df2][_0x36ed57(0xb8f)]();if(_0x40306c[_0x36ed57(0xbb9)]('data:\x20')&&_0x40306c!==_0x36ed57(0x290)){const _0x46fa9a=_0x40306c[_0x36ed57(0x371)](0x6);try{const _0x109d1f=JSON[_0x36ed57(0x13f7)](_0x46fa9a);if(_0x109d1f[_0x36ed57(0x10cb)]===_0x36ed57(0x158b)&&_0x109d1f['image']){_0x205989=_0x109d1f[_0x36ed57(0xf86)],console[_0x36ed57(0x1e6)](_0x36ed57(0x136b));break;}if(_0x109d1f[_0x36ed57(0x55b)]){_0x205989=_0x109d1f[_0x36ed57(0x55b)],console[_0x36ed57(0x1e6)](_0x36ed57(0x97b));break;}if(_0x109d1f[_0x36ed57(0xf86)]){_0x205989=_0x109d1f['image'],console[_0x36ed57(0x1e6)]('从\x20JSON.image\x20中提取图片数据');break;}}catch(_0xcbff7d){_0x205989=_0x46fa9a,console['log'](_0x36ed57(0x7a5));break;}}}if(!_0x205989)throw new Error(_0x36ed57(0x309));const _0x4c6a71=_0x205989[_0x36ed57(0xbb9)](_0x36ed57(0x1646)),_0x306865=_0x205989[_0x36ed57(0xbb9)](_0x36ed57(0x573));if(_0x4c6a71||_0x306865){console[_0x36ed57(0x1e6)](_0x36ed57(0x10b0));const _0x35e3ad=atob(_0x205989),_0x2aeec2=new Uint8Array(_0x35e3ad[_0x36ed57(0x8d6)]);for(let _0x4008c3=0x0;_0x4008c3<_0x35e3ad[_0x36ed57(0x8d6)];_0x4008c3++){_0x2aeec2[_0x4008c3]=_0x35e3ad[_0x36ed57(0xd17)](_0x4008c3);}const _0xd5532=new Blob([_0x2aeec2],{'type':_0x4c6a71?_0x36ed57(0x1443):'image/jpeg'});console[_0x36ed57(0x1e6)](_0x36ed57(0x802),_0xd5532[_0x36ed57(0x9e8)]);const _0x21ee6e=new FileReader();_0xb4da7d=await new Promise((_0x316e52,_0x122b26)=>{const _0x2b2b95=_0x36ed57;_0x21ee6e[_0x2b2b95(0x8d1)]=()=>_0x316e52(_0x21ee6e['result']),_0x21ee6e['onerror']=_0x122b26,_0x21ee6e['readAsDataURL'](_0xd5532);}),console[_0x36ed57(0x1e6)](_0x36ed57(0x10ee));}else{console['log']('当作\x20ZIP\x20文件处理...');const _0x587c61=atob(_0x205989),_0x51f999=new Uint8Array(_0x587c61['length']);for(let _0x520c7a=0x0;_0x520c7a<_0x587c61[_0x36ed57(0x8d6)];_0x520c7a++){_0x51f999[_0x520c7a]=_0x587c61[_0x36ed57(0xd17)](_0x520c7a);}_0x1d4187=new Blob([_0x51f999]),console[_0x36ed57(0x1e6)](_0x36ed57(0x434),_0x1d4187[_0x36ed57(0x9e8)]);}}else _0x1d4187=await _0x51fa4a['blob'](),console[_0x36ed57(0x1e6)]('收到数据，类型:',_0x1d4187[_0x36ed57(0xbbf)],_0x36ed57(0x24e),_0x1d4187[_0x36ed57(0x9e8)]);if(!_0xb4da7d&&_0x1d4187)try{if(typeof JSZip==='undefined')throw new Error(_0x36ed57(0x79c));const _0x412985=await JSZip[_0x36ed57(0x7b4)](_0x1d4187);console[_0x36ed57(0x1e6)](_0x36ed57(0x137c),Object[_0x36ed57(0x1161)](_0x412985['files']));let _0x1f76bc=null;for(let _0x7a195f in _0x412985['files']){if(_0x7a195f['match'](/\.(png|jpg|jpeg|webp)$/i)){_0x1f76bc=_0x412985['files'][_0x7a195f],console[_0x36ed57(0x1e6)](_0x36ed57(0xf04),_0x7a195f);break;}}if(!_0x1f76bc)throw new Error(_0x36ed57(0x13ca));const _0x1d7f82=await _0x1f76bc[_0x36ed57(0xb87)]('blob');console['log'](_0x36ed57(0x1df),_0x1d7f82[_0x36ed57(0x9e8)]);const _0x97fb49=new FileReader();_0xb4da7d=await new Promise((_0x285736,_0xf8d856)=>{const _0xd18827=_0x36ed57;_0x97fb49[_0xd18827(0x8d1)]=()=>_0x285736(_0x97fb49['result']),_0x97fb49[_0xd18827(0x96d)]=_0xf8d856,_0x97fb49['readAsDataURL'](_0x1d7f82);}),console[_0x36ed57(0x1e6)]('✅\x20图片解压成功！');}catch(_0x2e39db){console[_0x36ed57(0x5d7)](_0x36ed57(0x13a5),_0x2e39db);throw new Error(_0x36ed57(0x1578)+_0x2e39db[_0x36ed57(0x6e2)]);}console[_0x36ed57(0x1e6)](_0x36ed57(0xf64)),_0x24ae48={..._0x42947b,'type':_0x36ed57(0xd3c),'imageUrl':_0xb4da7d,'prompt':_0x49aae2,'fullPrompt':_0x5083b8};}catch(_0x44277f){console[_0x36ed57(0x5d7)](_0x36ed57(0xe6b),_0x44277f),_0x24ae48={..._0x42947b,'content':_0x36ed57(0x14ed)+_0x44277f[_0x36ed57(0x6e2)]+']'};}break;default:console[_0x36ed57(0x75e)](_0x36ed57(0x125a),_0x5e659c[_0x36ed57(0xbbf)]);break;}if(_0x24ae48){_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x6bb)](_0x24ae48);!_0x1b61e3&&(_0x312594[_0x36ed57(0x73c)]=(_0x312594['unreadCount']||0x0)+0x1);if(!_0x1b61e3&&!_0x492933){let _0x1e9b6d;switch(_0x24ae48[_0x36ed57(0xbbf)]){case _0x36ed57(0x112f):_0x1e9b6d='[收到一笔转账]';break;case'waimai_request':_0x1e9b6d=_0x36ed57(0xa39);break;case _0x36ed57(0xea7):_0x1e9b6d=_0x36ed57(0x5d3);break;case _0x36ed57(0x295):_0x1e9b6d=_0x36ed57(0xe09);break;case _0x36ed57(0x12c2):_0x1e9b6d=_0x24ae48[_0x36ed57(0xca4)]?_0x36ed57(0x84c)+_0x24ae48['meaning']+']':_0x36ed57(0x450);break;case _0x36ed57(0x86e):_0x1e9b6d=_0x24ae48[_0x36ed57(0xf2d)]?'「'+_0x24ae48[_0x36ed57(0xf2d)]+'」':'['+_0x24ae48[_0x36ed57(0x12a5)][_0x36ed57(0x371)](0x0,0x14)+_0x36ed57(0xf1a);break;default:_0x1e9b6d=String(_0x24ae48[_0x36ed57(0x1109)]||'');}const _0x45c8c3=_0x312594[_0x36ed57(0xc98)]?_0x24ae48[_0x36ed57(0x3e7)]+':\x20'+_0x1e9b6d:_0x1e9b6d;_0x301fc2(_0x1e6f84,_0x45c8c3[_0x36ed57(0x371)](0x0,0x28)+(_0x45c8c3[_0x36ed57(0x8d6)]>0x28?'...':'')),_0x492933=!![];}_0x1b61e3&&(_0x41ecc7(_0x24ae48,_0x312594),await new Promise(_0x5de085=>setTimeout(_0x5de085,Math[_0x36ed57(0x12bc)]()*0x708+0x3e8)));}}_0xa79ba5&&_0x4037ab[_0x36ed57(0x593)]&&(_0x4037ab[_0x36ed57(0x3ed)]=![],_0x4037ab[_0x36ed57(0x131d)][_0x36ed57(0x8d6)]>0x0?_0xd23e33():(_0x4037ab={..._0x4037ab,'isAwaitingResponse':![],'participants':[]},_0x257d51('chat-interface-screen'),alert(_0x36ed57(0xf79))));if(_0x237dc6){await _0x58df1c();return;}await _0x54c587['chats'][_0x36ed57(0x4cb)](_0x312594);const _0x50c7a9=_0x90c75c[_0x36ed57(0x1412)](_0x319d3a=>_0x319d3a[_0x36ed57(0xbbf)]==='qzone_post'||_0x319d3a['type']===_0x36ed57(0x8dd)||_0x319d3a['type']===_0x36ed57(0x2e2)||_0x319d3a[_0x36ed57(0xbbf)]===_0x36ed57(0x808));_0x50c7a9&&(console[_0x36ed57(0x1e6)](_0x36ed57(0xc99)),await _0x335d36());}catch(_0x16e89f){_0x312594[_0x36ed57(0x92c)]=_0x312594[_0x36ed57(0x92c)][_0x36ed57(0x29d)](_0x11b2d5=>!_0x11b2d5['isTemporary']),!_0x312594[_0x36ed57(0xc98)]&&_0x312594[_0x36ed57(0x12f7)]?.[_0x36ed57(0x12c3)]===_0x36ed57(0x59d)?(_0x312594[_0x36ed57(0x12f7)]['status']=_0x36ed57(0x11a5),await _0x138765(_0x36ed57(0xa40),_0x36ed57(0x1318)+_0x16e89f['message'])):await _0x138765('API\x20调用失败',_0x36ed57(0x1096)+_0x16e89f[_0x36ed57(0x6e2)]),!_0x312594['isGroup']&&_0x312594['relationship']?.[_0x36ed57(0x12c3)]===_0x36ed57(0x11a5)&&await _0x54c587[_0x36ed57(0xbea)][_0x36ed57(0x4cb)](_0x312594),_0x4037ab['isAwaitingResponse']=![];}finally{_0x34ba39(_0x1e6f84,![]),_0x312594[_0x36ed57(0xc98)]?_0x409e76&&(_0x409e76[_0x36ed57(0xa00)][_0x36ed57(0xb1a)]=_0x36ed57(0x165b)):_0x2eefb4&&_0x4c8b14['chats'][_0x1e6f84]&&(_0x2eefb4['style'][_0x36ed57(0xbfa)]=0x0,setTimeout(()=>{const _0x5bc12e=_0x36ed57;_0x2eefb4[_0x5bc12e(0xde7)]=_0x4c8b14[_0x5bc12e(0xbea)][_0x1e6f84][_0x5bc12e(0xf3e)],_0x2eefb4['classList'][_0x5bc12e(0xc46)](_0x5bc12e(0x60c)),_0x2eefb4['style'][_0x5bc12e(0xbfa)]=0x1;},0xc8)),_0x41b828(),_0x3e2738&&_0x4373a4(_0x1e6f84),_0x3ebf71();}}async function _0x3c54cb(_0xc3d28f){const _0xb3aca2=_0x239c7d;if(!_0x4c8b14['activeChatId'])return;const _0x59cd5f=_0x4c8b14[_0xb3aca2(0xbea)][_0x4c8b14[_0xb3aca2(0x1539)]],_0x209dc7={'role':_0xb3aca2(0x6d6),'content':_0xc3d28f[_0xb3aca2(0x299)],'meaning':_0xc3d28f[_0xb3aca2(0xf3e)],'timestamp':Date[_0xb3aca2(0xecd)]()};_0x59cd5f[_0xb3aca2(0x92c)][_0xb3aca2(0x6bb)](_0x209dc7),await _0x54c587[_0xb3aca2(0xbea)][_0xb3aca2(0x4cb)](_0x59cd5f),_0x41ecc7(_0x209dc7,_0x59cd5f),_0x41b828(),document[_0xb3aca2(0x400)](_0xb3aca2(0xb39))[_0xb3aca2(0xb08)][_0xb3aca2(0xc46)]('visible');}async function _0x3db65e(){const _0x4c683f=_0x239c7d;if(!_0x4c8b14[_0x4c683f(0x1539)])return;const _0x47c4ae=document[_0x4c683f(0x400)](_0x4c683f(0x12e6)),_0x569095=document['getElementById'](_0x4c683f(0xef5)),_0x509b62=parseFloat(_0x47c4ae[_0x4c683f(0xa1e)]),_0x4ffa9a=_0x569095[_0x4c683f(0xa1e)][_0x4c683f(0xb8f)]();if(isNaN(_0x509b62)||_0x509b62<0x0){alert('请输入有效的金额(必须大于0)！');return;}const _0x4dacbc=_0x4c8b14['chats'][_0x4c8b14['activeChatId']],_0x594df0=_0x4dacbc['isGroup']?_0x4dacbc[_0x4c683f(0xa37)][_0x4c683f(0x14a8)]||'我':'我',_0x4ff298=_0x4dacbc[_0x4c683f(0xc98)]?'群聊':_0x4dacbc['name'],_0x5b2f69={'role':_0x4c683f(0x6d6),'type':_0x4c683f(0x112f),'amount':_0x509b62,'note':_0x4ffa9a,'senderName':_0x594df0,'receiverName':_0x4ff298,'timestamp':Date[_0x4c683f(0xecd)]()};_0x4dacbc[_0x4c683f(0x92c)]['push'](_0x5b2f69),await _0x54c587[_0x4c683f(0xbea)]['put'](_0x4dacbc),_0x41ecc7(_0x5b2f69,_0x4dacbc),_0x41b828(),document[_0x4c683f(0x400)]('transfer-modal')['classList'][_0x4c683f(0xc46)](_0x4c683f(0x9eb)),_0x47c4ae['value']='',_0x569095[_0x4c683f(0xa1e)]='';}async function _0x419d14(){const _0x2652a=_0x239c7d;if(!_0x4c8b14['activeChatId'])return;const _0xbc6f47=document['getElementById'](_0x2652a(0xcc2)),_0x208670=document[_0x2652a(0x400)]('waimai-amount'),_0x112648=_0xbc6f47[_0x2652a(0xa1e)][_0x2652a(0xb8f)](),_0x1f1ffe=parseFloat(_0x208670[_0x2652a(0xa1e)]);if(!_0x112648||isNaN(_0x1f1ffe)||_0x1f1ffe<=0x0){alert(_0x2652a(0xe3a));return;}const _0x2a1cae=_0x4c8b14[_0x2652a(0xbea)][_0x4c8b14[_0x2652a(0x1539)]],_0x556726=Date[_0x2652a(0xecd)](),_0xc6cf30=_0x2a1cae[_0x2652a(0xc98)]?_0x2a1cae[_0x2652a(0xa37)]['myNickname']||'我':'我',_0xd19d35={'role':_0x2652a(0x6d6),'senderName':_0xc6cf30,'type':'waimai_order','productInfo':_0x112648,'amount':_0x1f1ffe,'timestamp':_0x556726};_0x2a1cae[_0x2652a(0x92c)][_0x2652a(0x6bb)](_0xd19d35);const _0x11e179={'role':_0x2652a(0xaf6),'content':'[系统提示：用户('+_0xc6cf30+')为你点了一份外卖作为【礼物】。外卖内容是“'+_0x112648+_0x2652a(0xde1)+_0x1f1ffe+_0x2652a(0xefc),'timestamp':_0x556726+0x1,'isHidden':!![]};_0x2a1cae[_0x2652a(0x92c)]['push'](_0x11e179),await _0x54c587[_0x2652a(0xbea)][_0x2652a(0x4cb)](_0x2a1cae),_0x41ecc7(_0xd19d35,_0x2a1cae),_0x41b828(),_0xbc6f47['value']='',_0x208670[_0x2652a(0xa1e)]='',document[_0x2652a(0x400)](_0x2652a(0xd16))[_0x2652a(0xb08)]['remove'](_0x2652a(0x9eb));}async function _0x766c76(){const _0x47131e=_0x239c7d;if(!_0x4c8b14['activeChatId'])return;const _0x169cb5=await _0x25f61f(_0x47131e(0x10bc),_0x47131e(0xea9),'');if(!_0x169cb5||!_0x169cb5[_0x47131e(0xb8f)]())return;const _0x513453=_0x47131e(0x432),_0x404fff=_0x4c8b14[_0x47131e(0xbea)][_0x4c8b14[_0x47131e(0x1539)]],_0x172776={'role':_0x47131e(0x6d6),'type':_0x47131e(0xdeb),'content':_0x169cb5[_0x47131e(0xb8f)](),'imageUrl':_0x513453,'timestamp':Date[_0x47131e(0xecd)]()};_0x404fff['history']['push'](_0x172776),await _0x54c587[_0x47131e(0xbea)]['put'](_0x404fff),_0x41ecc7(_0x172776,_0x404fff),_0x41b828();}function _0x42dbdb(_0x5439ad){const _0xb0eff4=_0x239c7d;if(_0x51034e)return;_0x51034e=!![],document[_0xb0eff4(0x400)](_0xb0eff4(0x946))[_0xb0eff4(0xb08)]['add']('selection-mode'),_0x1f3e50(_0x5439ad);}function _0x4e7c87(){const _0x47f9ea=_0x239c7d;_0x508f6();if(!_0x51034e)return;_0x51034e=![],document[_0x47f9ea(0x400)]('chat-interface-screen')[_0x47f9ea(0xb08)][_0x47f9ea(0xc46)](_0x47f9ea(0x1046)),_0x141aad[_0x47f9ea(0xbdc)](_0x16c865=>{const _0x1abf60=_0x47f9ea,_0x53c319=document[_0x1abf60(0x13ef)]('.message-bubble[data-timestamp=\x22'+_0x16c865+'\x22]');if(_0x53c319)_0x53c319[_0x1abf60(0xb08)][_0x1abf60(0xc46)](_0x1abf60(0x148b));}),_0x141aad['clear']();}function _0x1f3e50(_0xa01e2d){const _0xa10cf4=_0x239c7d,_0x4302ad=document['querySelector'](_0xa10cf4(0xfe4)+_0xa01e2d+'\x22]');if(!_0x4302ad)return;_0x141aad[_0xa10cf4(0x3e3)](_0xa01e2d)?(_0x141aad[_0xa10cf4(0x942)](_0xa01e2d),_0x4302ad[_0xa10cf4(0xb08)][_0xa10cf4(0xc46)](_0xa10cf4(0x148b))):(_0x141aad[_0xa10cf4(0x12b6)](_0xa01e2d),_0x4302ad[_0xa10cf4(0xb08)][_0xa10cf4(0x12b6)]('selected')),document['getElementById'](_0xa10cf4(0x1fc))[_0xa10cf4(0xde7)]='已选\x20'+_0x141aad['size']+'\x20条',_0x141aad['size']===0x0&&_0x4e7c87();}function _0x3d4218(_0x2db7d4,_0x4ec2fe){const _0xf049c3=_0x239c7d;let _0x599b11;const _0xe0fe8=_0x52b4fe=>{const _0x150ba7=_0x466f;if(_0x51034e)return;_0x52b4fe[_0x150ba7(0x92e)](),_0x599b11=window['setTimeout'](()=>_0x4ec2fe(_0x52b4fe),0x1f4);},_0x4b05db=()=>clearTimeout(_0x599b11);_0x2db7d4[_0xf049c3(0x501)]('mousedown',_0xe0fe8),_0x2db7d4[_0xf049c3(0x501)]('mouseup',_0x4b05db),_0x2db7d4[_0xf049c3(0x501)]('mouseleave',_0x4b05db),_0x2db7d4['addEventListener'](_0xf049c3(0x1479),_0xe0fe8,{'passive':!![]}),_0x2db7d4['addEventListener'](_0xf049c3(0x11bc),_0x4b05db),_0x2db7d4[_0xf049c3(0x501)](_0xf049c3(0x1119),_0x4b05db);}async function _0x3832b4(){const _0x8ef176=_0x239c7d,_0x4e429b=_0x4c8b14[_0x8ef176(0x1539)];if(!_0x4e429b)return;if(!_0x59adb2['isActive']){_0x905c54(_0x4e429b);return;}if(_0x59adb2[_0x8ef176(0x1539)]===_0x4e429b)document[_0x8ef176(0x400)](_0x8ef176(0x144c))[_0x8ef176(0xb08)]['add'](_0x8ef176(0x9eb));else{const _0x1f8e49=_0x4c8b14[_0x8ef176(0xbea)][_0x59adb2[_0x8ef176(0x1539)]]?.[_0x8ef176(0xf3e)]||'未知',_0x3ada53=_0x4c8b14[_0x8ef176(0xbea)][_0x4e429b]?.[_0x8ef176(0xf3e)]||'当前',_0x1c2e86=await _0x56d4d3(_0x8ef176(0x111c),_0x8ef176(0x1238)+_0x1f8e49+_0x8ef176(0x2d9)+_0x3ada53+_0x8ef176(0x107d),{'confirmButtonClass':_0x8ef176(0x142c)});_0x1c2e86&&(await _0x1beebd(!![]),await new Promise(_0x2382e2=>setTimeout(_0x2382e2,0x32)),_0x905c54(_0x4e429b));}}async function _0x905c54(_0xfb9c75){const _0x1b5971=_0x239c7d,_0x1ce686=_0x4c8b14['chats'][_0xfb9c75];if(!_0x1ce686)return;_0x59adb2['totalElapsedTime']=_0x1ce686[_0x1b5971(0x414)][_0x1b5971(0x670)]||0x0,_0x59adb2[_0x1b5971(0x11e7)]=!![],_0x59adb2['activeChatId']=_0xfb9c75;_0x59adb2[_0x1b5971(0xc3e)][_0x1b5971(0x8d6)]>0x0?_0x59adb2[_0x1b5971(0xbf0)]=0x0:_0x59adb2[_0x1b5971(0xbf0)]=-0x1;if(_0x59adb2['timerId'])clearInterval(_0x59adb2[_0x1b5971(0x9bc)]);_0x59adb2['timerId']=setInterval(()=>{const _0x439bb9=_0x1b5971;_0x59adb2['isPlaying']&&(_0x59adb2[_0x439bb9(0x15a6)]++,_0x33e75a());},0x3e8),_0x12737e(),_0x4514b2(),document[_0x1b5971(0x400)](_0x1b5971(0x144c))[_0x1b5971(0xb08)][_0x1b5971(0x12b6)](_0x1b5971(0x9eb));}async function _0x1beebd(_0x357a0f=!![]){const _0x5928c3=_0x239c7d;if(!_0x59adb2[_0x5928c3(0x11e7)])return;const _0xb9c689=_0x59adb2[_0x5928c3(0x1539)];document['getElementById'](_0x5928c3(0xee9))['classList']['remove'](_0x5928c3(0x9eb));const _0x3be848=async()=>{const _0x1f93e9=_0x5928c3;if(_0x59adb2[_0x1f93e9(0x9bc)])clearInterval(_0x59adb2[_0x1f93e9(0x9bc)]);if(_0x59adb2[_0x1f93e9(0x138e)])_0x86eb29[_0x1f93e9(0x1385)]();if(_0x357a0f&&_0xb9c689&&_0x4c8b14[_0x1f93e9(0xbea)][_0xb9c689]){const _0x410b51=_0x4c8b14[_0x1f93e9(0xbea)][_0xb9c689];_0x410b51[_0x1f93e9(0x414)]['totalTime']=_0x59adb2[_0x1f93e9(0x15a6)],await _0x54c587['chats'][_0x1f93e9(0x4cb)](_0x410b51);}_0x59adb2[_0x1f93e9(0x11e7)]=![],_0x59adb2[_0x1f93e9(0x1539)]=null,_0x59adb2[_0x1f93e9(0x15a6)]=0x0,_0x59adb2['timerId']=null,_0x490c77(_0xb9c689,!![]);};_0x3a94e8(_0x3be848);}function _0x4b4650(){_0x3a94e8();}function _0x490c77(_0x4d25be,_0x2c6041=![]){const _0x51534a=_0x239c7d,_0x2ae91e=document[_0x51534a(0x13ef)](_0x51534a(0x918));if(!_0x2ae91e)return;if(_0x2c6041||!_0x59adb2[_0x51534a(0x11e7)]||_0x59adb2['activeChatId']!==_0x4d25be){_0x2ae91e[_0x51534a(0x912)]=_0x51534a(0xb62),_0x2ae91e['className']='';return;}_0x2ae91e['src']='https://i.postimg.cc/D0pq6qS2/E30078-DC-8-B99-4-C01-AFDA-74728-DBF7-BEA.png',_0x2ae91e[_0x51534a(0xb08)][_0x51534a(0x12b6)](_0x51534a(0x1164));if(_0x59adb2[_0x51534a(0x138e)])_0x2ae91e['classList'][_0x51534a(0xc46)](_0x51534a(0x317));else _0x2ae91e['classList'][_0x51534a(0x12b6)](_0x51534a(0x317));}window['updateListenTogetherIconProxy']=_0x490c77;function _0x12737e(){const _0x99bec6=_0x239c7d;_0x490c77(_0x59adb2[_0x99bec6(0x1539)]),_0x33e75a();const _0x30f874=document[_0x99bec6(0x400)](_0x99bec6(0x7af)),_0x59d773=document[_0x99bec6(0x400)](_0x99bec6(0x746)),_0x3c547c=document[_0x99bec6(0x400)]('music-play-pause-btn');if(_0x59adb2[_0x99bec6(0xbf0)]>-0x1&&_0x59adb2[_0x99bec6(0xc3e)]['length']>0x0){const _0x2f4408=_0x59adb2[_0x99bec6(0xc3e)][_0x59adb2[_0x99bec6(0xbf0)]];_0x30f874[_0x99bec6(0xde7)]=_0x2f4408[_0x99bec6(0xf3e)],_0x59d773[_0x99bec6(0xde7)]=_0x2f4408[_0x99bec6(0x833)];}else _0x30f874[_0x99bec6(0xde7)]=_0x99bec6(0xbc1),_0x59d773['textContent']='...';_0x3c547c['textContent']=_0x59adb2[_0x99bec6(0x138e)]?'❚❚':'▶';}function _0x33e75a(){const _0x185ae0=_0x239c7d,_0x55367e=(_0x59adb2['totalElapsedTime']/0xe10)[_0x185ae0(0x2ea)](0x1);document[_0x185ae0(0x400)](_0x185ae0(0x13d4))[_0x185ae0(0xde7)]=_0x185ae0(0x6f3)+_0x55367e+'小时';}function _0x4514b2(){const _0x595de2=_0x239c7d,_0x1984fd=document['getElementById']('playlist-body');_0x1984fd['innerHTML']='';if(_0x59adb2[_0x595de2(0xc3e)][_0x595de2(0x8d6)]===0x0){_0x1984fd['innerHTML']=_0x595de2(0x36d);return;}_0x59adb2['playlist']['forEach']((_0x4058ae,_0x5236cc)=>{const _0x940090=_0x595de2,_0x2946af=document[_0x940090(0x2c9)](_0x940090(0xf8e));_0x2946af[_0x940090(0x4e1)]=_0x940090(0x2ba);if(_0x5236cc===_0x59adb2[_0x940090(0xbf0)])_0x2946af['classList'][_0x940090(0x12b6)](_0x940090(0xe4c));_0x2946af['innerHTML']=_0x940090(0x2c5)+_0x4058ae[_0x940090(0xf3e)]+_0x940090(0x142d)+_0x4058ae['artist']+_0x940090(0x1422)+_0x5236cc+_0x940090(0xc1f)+_0x5236cc+_0x940090(0x125e)+_0x5236cc+_0x940090(0x151d)+_0x5236cc+_0x940090(0xbd6),_0x1984fd[_0x940090(0x8f2)](_0x2946af);});}async function _0x3d4ee1(){const _0x18280b=_0x239c7d;if(_0x86eb29['paused']){if(_0x59adb2[_0x18280b(0xbf0)]===-0x1&&_0x59adb2[_0x18280b(0xc3e)][_0x18280b(0x8d6)]>0x0)_0x3efb75(0x0,!![]);else _0x59adb2[_0x18280b(0xbf0)]>-0x1&&_0x3efb75(_0x59adb2[_0x18280b(0xbf0)],!![]);}else _0x86eb29[_0x18280b(0x1385)]();}function _0x2b0b05(_0x48398e=![]){const _0x57072a=_0x239c7d;if(_0x59adb2['playlist'][_0x57072a(0x8d6)]===0x0)return;let _0x11f8f3;switch(_0x59adb2[_0x57072a(0xf2e)]){case _0x57072a(0x12bc):_0x11f8f3=Math[_0x57072a(0x1381)](Math[_0x57072a(0x12bc)]()*_0x59adb2[_0x57072a(0xc3e)][_0x57072a(0x8d6)]);break;case _0x57072a(0x14d3):_0x3efb75(_0x59adb2[_0x57072a(0xbf0)],_0x48398e);return;case _0x57072a(0xb2d):default:_0x11f8f3=(_0x59adb2[_0x57072a(0xbf0)]+0x1)%_0x59adb2[_0x57072a(0xc3e)][_0x57072a(0x8d6)];break;}_0x3efb75(_0x11f8f3,_0x48398e);}function _0x2dce69(){const _0x1813fe=_0x239c7d;if(_0x59adb2[_0x1813fe(0xc3e)][_0x1813fe(0x8d6)]===0x0)return;const _0x46d9fa=(_0x59adb2[_0x1813fe(0xbf0)]-0x1+_0x59adb2['playlist'][_0x1813fe(0x8d6)])%_0x59adb2[_0x1813fe(0xc3e)][_0x1813fe(0x8d6)];_0x3efb75(_0x46d9fa,![]);}function _0xd37f0c(){const _0x42202d=_0x239c7d,_0x44f6ef=[_0x42202d(0xb2d),_0x42202d(0x12bc),_0x42202d(0x14d3)],_0x2db46d=_0x44f6ef[_0x42202d(0xd53)](_0x59adb2['playMode']);_0x59adb2[_0x42202d(0xf2e)]=_0x44f6ef[(_0x2db46d+0x1)%_0x44f6ef[_0x42202d(0x8d6)]],document['getElementById']('music-mode-btn')[_0x42202d(0xde7)]={'order':'顺序','random':'随机','single':'单曲'}[_0x59adb2[_0x42202d(0xf2e)]];}async function _0x33843a(){const _0xaddf30=_0x239c7d,_0x5175eb=await _0x25f61f(_0xaddf30(0x543),'请输入歌曲的URL','',_0xaddf30(0x299));if(!_0x5175eb)return;const _0x1d7979=await _0x25f61f(_0xaddf30(0x35a),'请输入歌名');if(!_0x1d7979)return;const _0x4f6ae8=await _0x25f61f(_0xaddf30(0x35a),_0xaddf30(0x4c8));if(!_0x4f6ae8)return;_0x59adb2[_0xaddf30(0xc3e)][_0xaddf30(0x6bb)]({'name':_0x1d7979,'artist':_0x4f6ae8,'src':_0x5175eb,'isLocal':![]}),await _0x2d1049(),_0x4514b2(),_0x59adb2['currentIndex']===-0x1&&(_0x59adb2[_0xaddf30(0xbf0)]=_0x59adb2[_0xaddf30(0xc3e)][_0xaddf30(0x8d6)]-0x1,_0x12737e());}async function _0x27db58(_0x316fd2){const _0x5dc31e=_0x239c7d,_0x4ea441=_0x316fd2[_0x5dc31e(0x657)][_0x5dc31e(0x780)];if(!_0x4ea441[_0x5dc31e(0x8d6)])return;for(const _0x22c78e of _0x4ea441){let _0x6ba37f=_0x22c78e[_0x5dc31e(0xf3e)][_0x5dc31e(0xe19)](/\.[^/.]+$/,'');_0x6ba37f=await _0x25f61f('歌曲信息','请输入歌名',_0x6ba37f);if(_0x6ba37f===null)continue;const _0x1284f9=await _0x25f61f(_0x5dc31e(0x35a),_0x5dc31e(0x4c8),_0x5dc31e(0xb99));if(_0x1284f9===null)continue;const _0x3d9c4e=await _0x22c78e[_0x5dc31e(0xead)]();let _0x533572='';const _0x489962=await _0x56d4d3('导入歌词',_0x5dc31e(0x11eb)+_0x6ba37f+_0x5dc31e(0x1077));_0x489962&&(_0x533572=await _0x1b8e0b()||''),_0x59adb2[_0x5dc31e(0xc3e)][_0x5dc31e(0x6bb)]({'name':_0x6ba37f,'artist':_0x1284f9,'src':_0x3d9c4e,'fileType':_0x22c78e[_0x5dc31e(0xbbf)],'isLocal':!![],'lrcContent':_0x533572,'cover':_0x5dc31e(0x978)});}await _0x2d1049(),_0x4514b2(),_0x59adb2[_0x5dc31e(0xbf0)]===-0x1&&_0x59adb2[_0x5dc31e(0xc3e)][_0x5dc31e(0x8d6)]>0x0&&(_0x59adb2[_0x5dc31e(0xbf0)]=0x0,_0x12737e()),_0x316fd2[_0x5dc31e(0x657)][_0x5dc31e(0xa1e)]=null;}async function _0x3efb75(_0x983f23,_0x46b425=![]){const _0x510f54=_0x239c7d;if(_0x983f23<0x0||_0x983f23>=_0x59adb2[_0x510f54(0xc3e)]['length'])return;_0x86eb29[_0x510f54(0x1385)](),_0x59adb2[_0x510f54(0xbf0)]=_0x983f23;const _0x3664d3=_0x59adb2['playlist'][_0x983f23],_0x1ddab4=_0x4c8b14['chats'][_0x59adb2[_0x510f54(0x1539)]],_0x578f91=document[_0x510f54(0x400)](_0x510f54(0xe58));if(_0x1ddab4&&_0x578f91){_0x578f91[_0x510f54(0x1575)]='';const _0xea2dc1=_0x1ddab4['isGroup']?_0x1ddab4[_0x510f54(0x4f8)]['find'](_0xcb1c2e=>_0xcb1c2e[_0x510f54(0xdcf)]===_0x3664d3[_0x510f54(0x833)])?.['avatar']||_0x91d058:_0x1ddab4['settings'][_0x510f54(0xb24)]||_0x91d058,_0x56114b=_0x1ddab4[_0x510f54(0xa37)]['myAvatar']||_0x91d058,_0x2e164e=document[_0x510f54(0x2c9)](_0x510f54(0x14ef));_0x2e164e['src']=_0xea2dc1,_0x2e164e[_0x510f54(0x4e1)]=_0x510f54(0xb54),_0x2e164e[_0x510f54(0xda9)]='Character\x20Avatar',_0x578f91[_0x510f54(0x8f2)](_0x2e164e);const _0x53f32d=document[_0x510f54(0x2c9)](_0x510f54(0x14ef));_0x53f32d[_0x510f54(0x912)]=_0x56114b,_0x53f32d[_0x510f54(0x4e1)]='participant-display-avatar',_0x53f32d[_0x510f54(0xda9)]=_0x510f54(0xdde),_0x578f91[_0x510f54(0x8f2)](_0x53f32d);}const _0x2b63b4=document[_0x510f54(0x13ef)](_0x510f54(0xd99)),_0x4ce896=document[_0x510f54(0x400)](_0x510f54(0x604));_0x2b63b4&&(_0x2b63b4['style'][_0x510f54(0x132a)](_0x510f54(0xe84),_0x3664d3[_0x510f54(0x81e)]?_0x510f54(0xe21)+_0x3664d3[_0x510f54(0x81e)]+')':_0x510f54(0x165b)),_0x2b63b4['classList'][_0x510f54(0x146f)](_0x510f54(0x756),!!_0x3664d3[_0x510f54(0xc44)]));_0x4ce896&&_0x4ce896[_0x510f54(0xb08)][_0x510f54(0x146f)]('active',!!_0x3664d3[_0x510f54(0xc44)]);document[_0x510f54(0x400)]('music-visual-container')['classList'][_0x510f54(0xc46)](_0x510f54(0xacd));const _0x16c632=document[_0x510f54(0x400)](_0x510f54(0x31d));_0x16c632&&(_0x16c632['src']=_0x3664d3[_0x510f54(0x554)]||_0x510f54(0x978));!_0x46b425&&await _0x647e31(_0x510f54(0x2f0)+_0x3664d3[_0x510f54(0xf3e)]+'》');_0x59adb2[_0x510f54(0x7ee)]=_0x4a1132(_0x3664d3[_0x510f54(0x121f)]||''),_0x5c4970();const _0x35363e=document[_0x510f54(0x400)](_0x510f54(0xc57));_0x35363e&&(!_0x59adb2[_0x510f54(0x7ee)]||_0x59adb2[_0x510f54(0x7ee)]['length']===0x0?_0x35363e[_0x510f54(0xde7)]=_0x510f54(0x13d8):_0x35363e[_0x510f54(0xde7)]=_0x510f54(0xf38));if(_0x3664d3[_0x510f54(0x3f0)]&&_0x3664d3[_0x510f54(0x912)]instanceof ArrayBuffer){const _0x1e598a=new Blob([_0x3664d3[_0x510f54(0x912)]],{'type':_0x3664d3[_0x510f54(0xb65)]||_0x510f54(0x2a6)});_0x86eb29[_0x510f54(0x912)]=URL[_0x510f54(0xc2c)](_0x1e598a);}else{if(_0x3664d3['isLocal']&&_0x3664d3[_0x510f54(0x912)]instanceof Blob)_0x86eb29['src']=URL['createObjectURL'](_0x3664d3[_0x510f54(0x912)]);else{if(!_0x3664d3[_0x510f54(0x3f0)])_0x86eb29[_0x510f54(0x912)]=_0x3664d3['src'];else{console[_0x510f54(0x5d7)](_0x510f54(0xffd),_0x3664d3);return;}}}const _0x3ca500=_0x86eb29['play']();_0x3ca500!==undefined&&_0x3ca500['catch'](_0x595b71=>{const _0x5b5350=_0x510f54;if(_0x595b71[_0x5b5350(0xf3e)]===_0x5b5350(0xcba))console['warn'](_0x5b5350(0x980)),_0x86eb29[_0x5b5350(0x1385)]();else _0x595b71[_0x5b5350(0xf3e)]!=='AbortError'&&console[_0x5b5350(0x5d7)](_0x5b5350(0xd06),_0x595b71);});_0x4514b2(),_0x12737e();const _0x6950ca=document[_0x510f54(0x471)][_0x510f54(0xb08)][_0x510f54(0xd3f)]('frame-mode-active'),_0xbae724=_0x4c8b14[_0x510f54(0x14f1)][_0x510f54(0x57f)]||![],_0x5c61aa=document[_0x510f54(0x400)](_0x510f54(0xee9));_0x6950ca||_0xbae724?(phoneScreenForIsland['classList']['add'](_0x510f54(0xa4b)),islandAlbumArt[_0x510f54(0x912)]=_0x3664d3[_0x510f54(0x554)]||_0x510f54(0x978),_0x5c61aa[_0x510f54(0xb08)][_0x510f54(0xc46)](_0x510f54(0x9eb))):(phoneScreenForIsland[_0x510f54(0xb08)][_0x510f54(0xc46)](_0x510f54(0xa4b)),_0x59adb2[_0x510f54(0x7ee)]&&_0x59adb2[_0x510f54(0x7ee)][_0x510f54(0x8d6)]>0x0?(_0x5c61aa[_0x510f54(0xde7)]='♪',_0x5c61aa[_0x510f54(0xb08)]['add'](_0x510f54(0x9eb))):_0x5c61aa[_0x510f54(0xb08)][_0x510f54(0xc46)](_0x510f54(0x9eb)));}async function _0x37ef17(_0x5c2e84){const _0x5edf9f=_0x239c7d;if(_0x5c2e84<0x0||_0x5c2e84>=_0x59adb2['playlist'][_0x5edf9f(0x8d6)])return;const _0x3946bb=await _0x14b058('更换歌曲背景',[{'text':_0x5edf9f(0xf4d),'value':_0x5edf9f(0xdf5)},{'text':_0x5edf9f(0x15b7),'value':_0x5edf9f(0x299)}]);let _0x3fcde7=null;if(_0x3946bb===_0x5edf9f(0xdf5))_0x3fcde7=await _0x1f7db7();else _0x3946bb===_0x5edf9f(0x299)&&(_0x3fcde7=await _0x25f61f(_0x5edf9f(0x46a),_0x5edf9f(0xcc7),'',_0x5edf9f(0x299)));if(_0x3fcde7&&_0x3fcde7['trim']()){_0x59adb2[_0x5edf9f(0xc3e)][_0x5c2e84][_0x5edf9f(0x81e)]=_0x3fcde7[_0x5edf9f(0xb8f)](),await _0x2d1049();if(_0x59adb2['currentIndex']===_0x5c2e84){const _0x2633c2=document[_0x5edf9f(0x13ef)]('.music-player-window');_0x2633c2[_0x5edf9f(0xa00)][_0x5edf9f(0x132a)](_0x5edf9f(0xe84),'url('+_0x3fcde7[_0x5edf9f(0xb8f)]()+')');}await _0x138765('成功',_0x5edf9f(0xc6d));}}async function _0x4d4718(_0x52a31b){const _0x4ab549=_0x239c7d;if(_0x52a31b<0x0||_0x52a31b>=_0x59adb2[_0x4ab549(0xc3e)]['length'])return;const _0x3e6fbc=await _0x14b058('更换专辑封面',[{'text':_0x4ab549(0xf4d),'value':_0x4ab549(0xdf5)},{'text':_0x4ab549(0x15b7),'value':_0x4ab549(0x299)}]);let _0x5cc4c8=null;if(_0x3e6fbc==='local')_0x5cc4c8=await _0x1f7db7();else _0x3e6fbc==='url'&&(_0x5cc4c8=await _0x25f61f('输入图片URL',_0x4ab549(0x10b2),'','url'));if(_0x5cc4c8&&_0x5cc4c8[_0x4ab549(0xb8f)]()){_0x59adb2[_0x4ab549(0xc3e)][_0x52a31b]['cover']=_0x5cc4c8[_0x4ab549(0xb8f)](),await _0x2d1049();if(_0x59adb2[_0x4ab549(0xbf0)]===_0x52a31b){document[_0x4ab549(0x400)]('music-player-cover')[_0x4ab549(0x912)]=_0x5cc4c8['trim']();const _0x1500f6=document[_0x4ab549(0x13ef)]('#vinyl-view\x20#music-player-cover');if(_0x1500f6)_0x1500f6[_0x4ab549(0x912)]=_0x5cc4c8['trim']();}await _0x138765('成功','专辑封面已更新！');}}async function _0xa62cc5(_0x58cca9){const _0x497728=_0x239c7d;if(_0x58cca9<0x0||_0x58cca9>=_0x59adb2[_0x497728(0xc3e)][_0x497728(0x8d6)])return;const _0x498d1a=_0x59adb2[_0x497728(0xc3e)][_0x58cca9],_0x5e0910=_0x59adb2['isPlaying']&&_0x59adb2[_0x497728(0xbf0)]===_0x58cca9;if(_0x498d1a[_0x497728(0x3f0)]&&_0x86eb29['src'][_0x497728(0xbb9)](_0x497728(0x1356))&&_0x59adb2['currentIndex']===_0x58cca9)URL[_0x497728(0x896)](_0x86eb29[_0x497728(0x912)]);_0x59adb2[_0x497728(0xc3e)][_0x497728(0xdcc)](_0x58cca9,0x1),await _0x2d1049();if(_0x59adb2[_0x497728(0xc3e)][_0x497728(0x8d6)]===0x0){if(_0x59adb2['isPlaying'])_0x86eb29[_0x497728(0x1385)]();_0x86eb29[_0x497728(0x912)]='',_0x59adb2[_0x497728(0xbf0)]=-0x1,_0x59adb2['isPlaying']=![];}else{if(_0x5e0910)_0x2b0b05();else{if(_0x59adb2[_0x497728(0xbf0)]>=_0x58cca9)_0x59adb2[_0x497728(0xbf0)]=Math[_0x497728(0x124e)](0x0,_0x59adb2[_0x497728(0xbf0)]-0x1);}}_0x12737e(),_0x4514b2();}async function _0x27db58(_0x9a7b92){const _0x32cf49=_0x239c7d,_0x4b670b=_0x9a7b92[_0x32cf49(0x657)][_0x32cf49(0x780)];if(!_0x4b670b['length'])return;for(const _0x2df126 of _0x4b670b){let _0x17d2bf=_0x2df126[_0x32cf49(0xf3e)][_0x32cf49(0xe19)](/\.[^/.]+$/,'');_0x17d2bf=await _0x25f61f(_0x32cf49(0x35a),_0x32cf49(0x4c6),_0x17d2bf);if(_0x17d2bf===null)continue;const _0x1f2bb4=await _0x25f61f('歌曲信息','请输入歌手名',_0x32cf49(0xb99));if(_0x1f2bb4===null)continue;let _0x256598='';const _0x3f640c=await _0x56d4d3(_0x32cf49(0xfa6),_0x32cf49(0x11eb)+_0x17d2bf+_0x32cf49(0x1077));_0x3f640c&&(_0x256598=await _0x1b8e0b()||''),_0x59adb2['playlist'][_0x32cf49(0x6bb)]({'name':_0x17d2bf,'artist':_0x1f2bb4,'src':_0x2df126,'isLocal':!![],'lrcContent':_0x256598});}await _0x2d1049(),_0x4514b2(),_0x59adb2[_0x32cf49(0xbf0)]===-0x1&&_0x59adb2[_0x32cf49(0xc3e)][_0x32cf49(0x8d6)]>0x0&&(_0x59adb2[_0x32cf49(0xbf0)]=0x0,_0x12737e()),_0x9a7b92[_0x32cf49(0x657)]['value']=null;}async function _0xa62cc5(_0x5b4cc5){const _0x262cd7=_0x239c7d;if(_0x5b4cc5<0x0||_0x5b4cc5>=_0x59adb2[_0x262cd7(0xc3e)][_0x262cd7(0x8d6)])return;const _0x2d7412=_0x59adb2['playlist'][_0x5b4cc5],_0xf2a908=_0x59adb2['isPlaying']&&_0x59adb2[_0x262cd7(0xbf0)]===_0x5b4cc5;if(_0x2d7412['isLocal']&&_0x86eb29['src'][_0x262cd7(0xbb9)](_0x262cd7(0x1356))&&_0x59adb2[_0x262cd7(0xbf0)]===_0x5b4cc5)URL[_0x262cd7(0x896)](_0x86eb29['src']);_0x59adb2[_0x262cd7(0xc3e)][_0x262cd7(0xdcc)](_0x5b4cc5,0x1),await _0x2d1049();if(_0x59adb2[_0x262cd7(0xc3e)]['length']===0x0){if(_0x59adb2[_0x262cd7(0x138e)])_0x86eb29[_0x262cd7(0x1385)]();_0x86eb29[_0x262cd7(0x912)]='',_0x59adb2[_0x262cd7(0xbf0)]=-0x1,_0x59adb2['isPlaying']=![];}else{if(_0xf2a908)_0x2b0b05();else{if(_0x59adb2[_0x262cd7(0xbf0)]>=_0x5b4cc5)_0x59adb2[_0x262cd7(0xbf0)]=Math[_0x262cd7(0x124e)](0x0,_0x59adb2['currentIndex']-0x1);}}_0x12737e(),_0x4514b2();}const _0x1dfdae=document[_0x239c7d(0x400)](_0x239c7d(0x15f9)),_0x5c5059=document[_0x239c7d(0x400)](_0x239c7d(0x166d)),_0x402dd9=document['getElementById'](_0x239c7d(0x795));function _0x655617(){const _0x2302c3=_0x239c7d;_0x3a9ad4(),_0x1dfdae['classList']['add'](_0x2302c3(0x9eb));}function _0x24f09f(){const _0x2935f8=_0x239c7d;_0x1dfdae[_0x2935f8(0xb08)][_0x2935f8(0xc46)]('visible');}function _0x3a9ad4(){const _0x1d182c=_0x239c7d,_0x30a679=document[_0x1d182c(0x400)](_0x1d182c(0xb17));_0x30a679[_0x1d182c(0x1575)]='';if(_0x4c8b14[_0x1d182c(0x34f)][_0x1d182c(0x8d6)]===0x0){_0x30a679[_0x1d182c(0x1575)]=_0x1d182c(0x161c);return;}_0x4c8b14[_0x1d182c(0x34f)]['forEach'](_0x3cd6c3=>{const _0x35b370=_0x1d182c,_0x25e4b9=document[_0x35b370(0x2c9)](_0x35b370(0xf8e));_0x25e4b9[_0x35b370(0x4e1)]=_0x35b370(0x9f4),_0x25e4b9[_0x35b370(0xa00)][_0x35b370(0xf11)]=_0x35b370(0xe21)+_0x3cd6c3[_0x35b370(0xa9a)]+')',_0x25e4b9['dataset'][_0x35b370(0x9f2)]=_0x3cd6c3['id'],_0x25e4b9[_0x35b370(0x501)](_0x35b370(0x15ad),()=>_0x5baeb4(_0x3cd6c3['id'])),_0x3d4218(_0x25e4b9,()=>_0xe21aea(_0x3cd6c3['id'])),_0x30a679[_0x35b370(0x8f2)](_0x25e4b9);});}function _0xe21aea(_0x33f97f){const _0xdebbb9=_0x239c7d;_0x2a5908=_0x33f97f,_0x402dd9[_0xdebbb9(0xb08)][_0xdebbb9(0x12b6)]('visible');}function _0x1651e5(){const _0x446407=_0x239c7d;_0x402dd9[_0x446407(0xb08)][_0x446407(0xc46)]('visible'),_0x2a5908=null;}function _0x5baeb4(_0x292400){const _0x3350b7=_0x239c7d,_0x191c87=_0x4c8b14[_0x3350b7(0x34f)][_0x3350b7(0x821)](_0xc1d824=>_0xc1d824['id']===_0x292400);_0x191c87&&(document[_0x3350b7(0x400)]('my-avatar-preview')['src']=_0x191c87[_0x3350b7(0xa9a)],document[_0x3350b7(0x400)](_0x3350b7(0x63c))[_0x3350b7(0xa1e)]=_0x191c87[_0x3350b7(0x9a2)]),_0x24f09f();}function _0x5050f8(){const _0x3bc803=_0x239c7d;_0x2a5908=null,document[_0x3bc803(0x400)](_0x3bc803(0x10ce))[_0x3bc803(0xde7)]=_0x3bc803(0x3c1),document[_0x3bc803(0x400)](_0x3bc803(0x15b0))[_0x3bc803(0x912)]=_0x91d058,document['getElementById'](_0x3bc803(0x162e))[_0x3bc803(0xa1e)]='',_0x5c5059[_0x3bc803(0xb08)][_0x3bc803(0x12b6)](_0x3bc803(0x9eb));}function _0x464fd1(){const _0x494578=_0x239c7d,_0x1abac3=_0x4c8b14['personaPresets'][_0x494578(0x821)](_0x3cb717=>_0x3cb717['id']===_0x2a5908);if(!_0x1abac3)return;document['getElementById'](_0x494578(0x10ce))['textContent']=_0x494578(0x720),document['getElementById'](_0x494578(0x15b0))['src']=_0x1abac3[_0x494578(0xa9a)],document[_0x494578(0x400)]('preset-persona-input')[_0x494578(0xa1e)]=_0x1abac3[_0x494578(0x9a2)],_0x402dd9[_0x494578(0xb08)][_0x494578(0xc46)]('visible'),_0x5c5059[_0x494578(0xb08)][_0x494578(0x12b6)](_0x494578(0x9eb));}async function _0x56b562(){const _0x5d711e=_0x239c7d,_0x51d8b4=await _0x56d4d3(_0x5d711e(0x632),_0x5d711e(0x116c),{'confirmButtonClass':_0x5d711e(0x142c)});_0x51d8b4&&_0x2a5908&&(await _0x54c587[_0x5d711e(0x34f)][_0x5d711e(0x942)](_0x2a5908),_0x4c8b14['personaPresets']=_0x4c8b14['personaPresets'][_0x5d711e(0x29d)](_0x1494bd=>_0x1494bd['id']!==_0x2a5908),_0x1651e5(),_0x3a9ad4());}function _0x131bb0(){const _0x153209=_0x239c7d;_0x5c5059[_0x153209(0xb08)][_0x153209(0xc46)]('visible'),_0x2a5908=null;}async function _0x4f5f90(){const _0xd37aa5=_0x239c7d,_0x40e82f=document[_0xd37aa5(0x400)](_0xd37aa5(0x15b0))['src'],_0x5e8603=document[_0xd37aa5(0x400)]('preset-persona-input')[_0xd37aa5(0xa1e)][_0xd37aa5(0xb8f)]();if(_0x40e82f===_0x91d058&&!_0x5e8603){alert(_0xd37aa5(0x1410));return;}if(_0x2a5908){const _0xc6d6c6=_0x4c8b14['personaPresets']['find'](_0x11042b=>_0x11042b['id']===_0x2a5908);_0xc6d6c6&&(_0xc6d6c6['avatar']=_0x40e82f,_0xc6d6c6[_0xd37aa5(0x9a2)]=_0x5e8603,await _0x54c587['personaPresets'][_0xd37aa5(0x4cb)](_0xc6d6c6));}else{const _0x28d705={'id':_0xd37aa5(0x1529)+Date[_0xd37aa5(0xecd)](),'avatar':_0x40e82f,'persona':_0x5e8603};await _0x54c587[_0xd37aa5(0x34f)][_0xd37aa5(0x12b6)](_0x28d705),_0x4c8b14['personaPresets'][_0xd37aa5(0x6bb)](_0x28d705);}_0x3a9ad4(),_0x131bb0();}const _0x5ca814=document[_0x239c7d(0x400)](_0x239c7d(0x89f));function _0x178326(_0x2ee7ae,_0x4835a1){const _0x1c5d04=_0x239c7d;clearTimeout(_0x348b07),document['getElementById']('battery-alert-image')['src']=_0x2ee7ae,document[_0x1c5d04(0x400)](_0x1c5d04(0x14f8))[_0x1c5d04(0xde7)]=_0x4835a1,_0x5ca814[_0x1c5d04(0xb08)][_0x1c5d04(0x12b6)](_0x1c5d04(0x9eb));const _0x45970c=()=>{const _0x514f2d=_0x1c5d04;_0x5ca814[_0x514f2d(0xb08)][_0x514f2d(0xc46)](_0x514f2d(0x9eb)),_0x5ca814[_0x514f2d(0xf17)](_0x514f2d(0x15ad),_0x45970c);};_0x5ca814[_0x1c5d04(0x501)](_0x1c5d04(0x15ad),_0x45970c),_0x348b07=setTimeout(_0x45970c,0x7d0);}function _0x363d52(_0x4275f6){const _0x4017c7=_0x239c7d,_0x2526b4=document['getElementById'](_0x4017c7(0x5cc)),_0x458b27=_0x2526b4[_0x4017c7(0x13ef)](_0x4017c7(0x1308)),_0x5d7d3e=_0x2526b4[_0x4017c7(0x13ef)](_0x4017c7(0xf91)),_0x59ec6f=Math['floor'](_0x4275f6[_0x4017c7(0x453)]*0x64);_0x458b27[_0x4017c7(0xa00)][_0x4017c7(0x1383)]=_0x59ec6f+'%',_0x5d7d3e['textContent']=_0x59ec6f+'%',_0x4275f6[_0x4017c7(0x7f7)]?_0x2526b4[_0x4017c7(0xb08)][_0x4017c7(0x12b6)](_0x4017c7(0x7f7)):_0x2526b4[_0x4017c7(0xb08)][_0x4017c7(0xc46)](_0x4017c7(0x7f7));}function _0x2db2e1(_0x4fabef){const _0x35f846=_0x239c7d;_0x363d52(_0x4fabef);const _0x44a38a=_0x4fabef[_0x35f846(0x453)];!_0x4fabef[_0x35f846(0x7f7)]&&(_0x44a38a<=0.4&&_0x2c220f>0.4&&!_0x2d8619[_0x35f846(0xf56)]&&(_0x178326(_0x35f846(0x1564),_0x35f846(0x372)),_0x2d8619['hasShown40']=!![]),_0x44a38a<=0.2&&_0x2c220f>0.2&&!_0x2d8619[_0x35f846(0xe78)]&&(_0x178326('https://i.postimg.cc/qB9zbKs9/20.jpg','赶紧的充电，要饿死了'),_0x2d8619['hasShown20']=!![]),_0x44a38a<=0.1&&_0x2c220f>0.1&&!_0x2d8619[_0x35f846(0x369)]&&(_0x178326(_0x35f846(0x510),_0x35f846(0x202)),_0x2d8619[_0x35f846(0x369)]=!![]));if(_0x44a38a>0.4)_0x2d8619[_0x35f846(0xf56)]=![];if(_0x44a38a>0.2)_0x2d8619[_0x35f846(0xe78)]=![];if(_0x44a38a>0.1)_0x2d8619[_0x35f846(0x369)]=![];_0x2c220f=_0x44a38a;}async function _0x58f6f9(){const _0x1d80b4=_0x239c7d;if('getBattery'in navigator)try{const _0x18c435=await navigator[_0x1d80b4(0xc12)]();_0x2c220f=_0x18c435['level'],_0x2db2e1(_0x18c435),_0x18c435[_0x1d80b4(0x501)](_0x1d80b4(0xab2),()=>_0x2db2e1(_0x18c435)),_0x18c435[_0x1d80b4(0x501)](_0x1d80b4(0x3bc),()=>{const _0x4bf50=_0x1d80b4;_0x2db2e1(_0x18c435),_0x18c435[_0x4bf50(0x7f7)]&&_0x178326('https://i.postimg.cc/3NDQ0dWG/image.jpg',_0x4bf50(0xd55));});}catch(_0x24a0d5){console[_0x1d80b4(0x5d7)](_0x1d80b4(0x135a),_0x24a0d5),document['querySelector'](_0x1d80b4(0xf91))['textContent']='ᗜωᗜ';}else console[_0x1d80b4(0x1e6)]('浏览器不支持电池状态API。'),document['querySelector']('.battery-text')['textContent']=_0x1d80b4(0x33d);}async function _0x2eb3bb(){const _0x5535ae=_0x239c7d,_0x449d51=document[_0x5535ae(0x400)](_0x5535ae(0x145a));if(!_0x449d51)return;const _0x395366=await _0x54c587['qzoneAlbums']['orderBy'](_0x5535ae(0x134c))[_0x5535ae(0xfc1)]()[_0x5535ae(0xce1)]();_0x449d51[_0x5535ae(0x1575)]='';if(_0x395366[_0x5535ae(0x8d6)]===0x0){_0x449d51['innerHTML']=_0x5535ae(0x1298);return;}_0x395366['forEach'](_0x2c371d=>{const _0x4deb83=_0x5535ae,_0x2390fe=document[_0x4deb83(0x2c9)](_0x4deb83(0xf8e));_0x2390fe['className']=_0x4deb83(0xfac),_0x2390fe[_0x4deb83(0x1575)]=_0x4deb83(0x992)+_0x2c371d[_0x4deb83(0x96b)]+_0x4deb83(0xcd3)+_0x2c371d[_0x4deb83(0xf3e)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-count\x22>'+(_0x2c371d[_0x4deb83(0x1487)]||0x0)+_0x4deb83(0x1588),_0x2390fe[_0x4deb83(0x501)](_0x4deb83(0x15ad),()=>{_0x57c11b(_0x2c371d['id']);}),_0x3d4218(_0x2390fe,async()=>{const _0x173158=_0x4deb83,_0x4b4a90=await _0x56d4d3(_0x173158(0xb73),_0x173158(0xc83)+_0x2c371d['name']+'》吗？此操作将同时删除相册内的所有照片，且无法恢复。',{'confirmButtonClass':'btn-danger'});_0x4b4a90&&(await _0x54c587['qzonePhotos']['where'](_0x173158(0x13c7))[_0x173158(0x4ce)](_0x2c371d['id'])[_0x173158(0x942)](),await _0x54c587[_0x173158(0xc1e)][_0x173158(0x942)](_0x2c371d['id']),await _0x2eb3bb(),alert(_0x173158(0xdd0)));}),_0x449d51[_0x4deb83(0x8f2)](_0x2390fe);});}async function _0x57c11b(_0x1dad91){const _0x9eeb2f=_0x239c7d;_0x4c8b14[_0x9eeb2f(0xd7c)]=_0x1dad91,await _0x1061e4(),_0x257d51(_0x9eeb2f(0x7bd));}async function _0x1061e4(){const _0x4600d1=_0x239c7d;if(!_0x4c8b14['activeAlbumId'])return;const _0x3efca0=document[_0x4600d1(0x400)](_0x4600d1(0x13a3)),_0x3bf772=document[_0x4600d1(0x400)](_0x4600d1(0x13dd)),_0x45bffa=await _0x54c587[_0x4600d1(0xc1e)]['get'](_0x4c8b14[_0x4600d1(0xd7c)]);if(!_0x45bffa){console[_0x4600d1(0x5d7)](_0x4600d1(0x1549),_0x4c8b14[_0x4600d1(0xd7c)]),_0x257d51(_0x4600d1(0x1091));return;}_0x3bf772[_0x4600d1(0xde7)]=_0x45bffa[_0x4600d1(0xf3e)];const _0x19e344=await _0x54c587[_0x4600d1(0x933)]['where'](_0x4600d1(0x13c7))[_0x4600d1(0x4ce)](_0x4c8b14[_0x4600d1(0xd7c)])[_0x4600d1(0xce1)]();_0x3efca0[_0x4600d1(0x1575)]='',_0x19e344['length']===0x0?_0x3efca0[_0x4600d1(0x1575)]=_0x4600d1(0xdac):_0x19e344['forEach'](_0x47ff79=>{const _0x2249d0=_0x4600d1,_0x3a57fe=document['createElement'](_0x2249d0(0xf8e));_0x3a57fe[_0x2249d0(0x4e1)]=_0x2249d0(0x9d6),_0x3a57fe[_0x2249d0(0x1575)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x47ff79[_0x2249d0(0x299)]+_0x2249d0(0x14d2)+_0x47ff79['id']+_0x2249d0(0x68e),_0x3efca0[_0x2249d0(0x8f2)](_0x3a57fe);});}async function _0x4fcd1e(_0x14963d){const _0x4e4142=_0x239c7d;if(!_0x4c8b14[_0x4e4142(0xd7c)])return;const _0x1260ef=await _0x54c587[_0x4e4142(0x933)][_0x4e4142(0x227)](_0x4e4142(0x13c7))[_0x4e4142(0x4ce)](_0x4c8b14[_0x4e4142(0xd7c)])[_0x4e4142(0xce1)]();_0x531cde[_0x4e4142(0x2a9)]=_0x1260ef[_0x4e4142(0xd18)](_0xc69fd=>_0xc69fd[_0x4e4142(0x299)]),_0x531cde['currentIndex']=_0x531cde[_0x4e4142(0x2a9)][_0x4e4142(0x11a4)](_0x3f010f=>_0x3f010f===_0x14963d);if(_0x531cde[_0x4e4142(0xbf0)]===-0x1)return;document[_0x4e4142(0x400)]('photo-viewer-modal')['classList']['add'](_0x4e4142(0x9eb)),_0x322293(),_0x531cde['isOpen']=!![];}function _0x322293(){const _0x3f39e9=_0x239c7d;if(_0x531cde[_0x3f39e9(0xbf0)]===-0x1)return;const _0x2a7dc0=document[_0x3f39e9(0x400)](_0x3f39e9(0xa7e)),_0x469d5a=document[_0x3f39e9(0x400)](_0x3f39e9(0x1194)),_0x968370=document[_0x3f39e9(0x400)](_0x3f39e9(0x50e));_0x2a7dc0[_0x3f39e9(0xa00)][_0x3f39e9(0xbfa)]=0x0,setTimeout(()=>{const _0x1fe75e=_0x3f39e9;_0x2a7dc0[_0x1fe75e(0x912)]=_0x531cde[_0x1fe75e(0x2a9)][_0x531cde[_0x1fe75e(0xbf0)]],_0x2a7dc0[_0x1fe75e(0xa00)]['opacity']=0x1;},0x64),_0x469d5a['disabled']=_0x531cde['currentIndex']===0x0,_0x968370[_0x3f39e9(0x366)]=_0x531cde[_0x3f39e9(0xbf0)]===_0x531cde[_0x3f39e9(0x2a9)][_0x3f39e9(0x8d6)]-0x1;}function _0x17dbe3(){const _0x5c7500=_0x239c7d;_0x531cde[_0x5c7500(0xbf0)]<_0x531cde[_0x5c7500(0x2a9)]['length']-0x1&&(_0x531cde[_0x5c7500(0xbf0)]++,_0x322293());}function _0x26ad9c(){const _0x18eda5=_0x239c7d;_0x531cde[_0x18eda5(0xbf0)]>0x0&&(_0x531cde[_0x18eda5(0xbf0)]--,_0x322293());}function _0x4c0feb(){const _0x82f900=_0x239c7d;document[_0x82f900(0x400)]('photo-viewer-modal')['classList'][_0x82f900(0xc46)](_0x82f900(0x9eb)),_0x531cde[_0x82f900(0x12b0)]=![],_0x531cde[_0x82f900(0x2a9)]=[],_0x531cde['currentIndex']=-0x1,document[_0x82f900(0x400)]('photo-viewer-image')['src']='';}function _0x13e35a(_0x19d6df){const _0x25a303=_0x239c7d;_0x582d69=_0x19d6df,localStorage['setItem']('unreadPostsCount',_0x19d6df);const _0xbe7478=document[_0x25a303(0x13ef)](_0x25a303(0xb2a)),_0x3dfe7b=_0xbe7478[_0x25a303(0x13ef)](_0x25a303(0x9a7));let _0x739118=_0xbe7478[_0x25a303(0x13ef)](_0x25a303(0xff8));_0x19d6df>0x0?(!_0x739118&&(_0x739118=document['createElement'](_0x25a303(0x9a7)),_0x739118[_0x25a303(0x4e1)]=_0x25a303(0x45f),_0x3dfe7b['style'][_0x25a303(0xc15)]=_0x25a303(0x16a8),_0x3dfe7b[_0x25a303(0x8f2)](_0x739118)),_0x739118['textContent']=_0x19d6df>0x63?_0x25a303(0x529):_0x19d6df,_0x739118[_0x25a303(0xa00)]['display']=_0x25a303(0x1181)):_0x739118&&(_0x739118[_0x25a303(0xa00)][_0x25a303(0xb1a)]=_0x25a303(0x165b)),_0x2acd39();}function _0x29a569(){const _0x13e324=_0x239c7d;if(_0x53caff)return;const _0x203a57=_0x4c8b14[_0x13e324(0x14f1)][_0x13e324(0xeb0)]||0x3c;_0x53caff=setInterval(_0x7eb5fd,_0x203a57*0x3e8),_0x2f83fc();}function _0x17fe03(){_0x53caff&&(clearInterval(_0x53caff),_0x53caff=null),_0x3ebf71();}async function _0x7eb5fd(){const _0x3c8b33=_0x239c7d;console[_0x3c8b33(0x1e6)](_0x3c8b33(0x104f));if(!_0x4c8b14[_0x3c8b33(0x14f1)]['enableBackgroundActivity']){_0x17fe03();return;}const _0x2192a7=Object[_0x3c8b33(0x40a)](_0x4c8b14[_0x3c8b33(0xbea)])[_0x3c8b33(0x29d)](_0x29ca23=>!_0x29ca23[_0x3c8b33(0xc98)]);_0x2192a7[_0x3c8b33(0xbdc)](_0x537edf=>{const _0x9e280c=_0x3c8b33;if(_0x537edf[_0x9e280c(0x12f7)]?.[_0x9e280c(0x12c3)]===_0x9e280c(0x15ea)){const _0x440093=_0x537edf[_0x9e280c(0x12f7)][_0x9e280c(0x1199)];if(!_0x440093)return;const _0x6b4811=Date['now']()-_0x440093,_0x4948c7=(_0x4c8b14[_0x9e280c(0x14f1)][_0x9e280c(0x1582)]||0x1)*0x3c*0x3c*0x3e8;_0x6b4811>_0x4948c7&&(_0x537edf[_0x9e280c(0x12f7)][_0x9e280c(0x12c3)]='pending_system_reflection',_0x3eba75(_0x537edf['id']));}else{if(_0x537edf['relationship']?.[_0x9e280c(0x12c3)]==='friend'&&_0x537edf['id']!==_0x4c8b14['activeChatId']){if(_0x537edf[_0x9e280c(0xa37)][_0x9e280c(0x3c4)]===![]){console['log'](_0x9e280c(0xfb3)+_0x537edf[_0x9e280c(0xf3e)]+_0x9e280c(0x761));return;}Math['random']()<0.2&&(console[_0x9e280c(0x1e6)]('角色\x20\x22'+_0x537edf[_0x9e280c(0xf3e)]+'\x22\x20被唤醒，准备独立行动...'),_0x6d9520(_0x537edf['id']));}}});const _0x2eadc1=Object['values'](_0x4c8b14[_0x3c8b33(0xbea)])[_0x3c8b33(0x29d)](_0x40ef68=>_0x40ef68[_0x3c8b33(0xc98)]);_0x2eadc1[_0x3c8b33(0xbdc)](_0x1f5191=>{const _0x5d07d2=_0x3c8b33;if(_0x1f5191[_0x5d07d2(0xa37)][_0x5d07d2(0x3c4)]===![]){console['log'](_0x5d07d2(0x167f)+_0x1f5191[_0x5d07d2(0xf3e)]+'\x22\x20的后台活动开关已关闭，本次跳过。');return;}_0x1f5191['id']!==_0x4c8b14[_0x5d07d2(0x1539)]&&Math['random']()<0.1&&(console[_0x5d07d2(0x1e6)]('群聊\x20\x22'+_0x1f5191[_0x5d07d2(0xf3e)]+'\x22\x20被唤醒，准备独立行动...'),_0x31bcbe(_0x1f5191['id']));});try{const _0x1a8d73=await _0x54c587[_0x3c8b33(0xf9b)][_0x3c8b33(0xce1)]();if(_0x1a8d73[_0x3c8b33(0x8d6)]===0x0)return;const _0x580569=await _0x54c587[_0x3c8b33(0xba7)][_0x3c8b33(0x541)](_0x3c8b33(0x287))[_0x3c8b33(0xfc1)]()[_0x3c8b33(0x1630)](0xa)[_0x3c8b33(0xce1)]();for(const _0xf23ea3 of _0x1a8d73){if(_0xf23ea3[_0x3c8b33(0x3c4)]===![])continue;const _0x4f2771=_0xf23ea3[_0x3c8b33(0x12c0)]||0xf;if(_0xf23ea3[_0x3c8b33(0xc67)]){const _0x4704ba=(Date[_0x3c8b33(0xecd)]()-_0xf23ea3[_0x3c8b33(0xc67)])/(0x3e8*0x3c);if(_0x4704ba<_0x4f2771)continue;}if(Math['random']()>0.3)continue;const _0x31aaf4=[];for(const _0x5234d1 of _0x580569){if(_0x5234d1['authorId']===_0x3c8b33(0x1530)+_0xf23ea3['id'])continue;const _0x21bd59=_0x5234d1['comments']?.[_0x3c8b33(0x1412)](_0x39b2f3=>_0x39b2f3[_0x3c8b33(0x10bf)]===_0xf23ea3[_0x3c8b33(0xf3e)]),_0x2b0b7e=_0x5234d1['comments']?.[_0x3c8b33(0x69f)](-0x1)[0x0]?.['commenterName'];if(_0x2b0b7e===_0xf23ea3[_0x3c8b33(0xf3e)])continue;let _0xc23bec=![];if(_0x5234d1['authorId']===_0x3c8b33(0x6d6)||_0x5234d1['authorId'][_0x3c8b33(0xbb9)](_0x3c8b33(0x11cd)))_0xf23ea3[_0x3c8b33(0xc04)][_0x3c8b33(0xd1b)](_0x5234d1['authorId'])&&(_0xc23bec=!![]);else{if(_0x5234d1[_0x3c8b33(0x606)][_0x3c8b33(0xbb9)]('npc_')){const _0x430e5c=parseInt(_0x5234d1[_0x3c8b33(0x606)][_0x3c8b33(0xe19)](_0x3c8b33(0x1530),'')),_0x441dbd=await _0x54c587['npcs'][_0x3c8b33(0xf48)](_0x430e5c);if(_0x441dbd){const _0x19f5f9=_0xf23ea3[_0x3c8b33(0x677)],_0x55429b=_0x441dbd[_0x3c8b33(0x677)];_0x19f5f9&&_0x55429b&&_0x19f5f9===_0x55429b&&(_0xc23bec=!![]);}}}(_0xc23bec||_0x21bd59)&&_0x31aaf4[_0x3c8b33(0x6bb)](_0x5234d1);}if(_0x31aaf4['length']>0x0||Math[_0x3c8b33(0x12bc)]()<0.2){console[_0x3c8b33(0x1e6)]('NPC\x20\x22'+_0xf23ea3['name']+_0x3c8b33(0xd8b));const _0x51f2cc=await _0x4d6d76(_0xf23ea3,_0x31aaf4);if(_0x51f2cc&&_0x51f2cc['length']>0x0){for(const _0x12d730 of _0x51f2cc){if(_0x12d730[_0x3c8b33(0xbbf)]==='qzone_comment'){const _0x3b5a7f=await _0x54c587[_0x3c8b33(0xba7)][_0x3c8b33(0xf48)](_0x12d730[_0x3c8b33(0x2b7)]);if(_0x3b5a7f){if(!_0x3b5a7f[_0x3c8b33(0xf8f)])_0x3b5a7f[_0x3c8b33(0xf8f)]=[];_0x3b5a7f[_0x3c8b33(0xf8f)][_0x3c8b33(0x6bb)]({'commenterName':_0xf23ea3['name'],'text':_0x12d730[_0x3c8b33(0x555)],'replyTo':_0x12d730['replyTo']||null,'timestamp':Date[_0x3c8b33(0xecd)]()+Math[_0x3c8b33(0x12bc)]()}),await _0x54c587[_0x3c8b33(0xba7)][_0x3c8b33(0x126d)](_0x12d730['postId'],{'comments':_0x3b5a7f[_0x3c8b33(0xf8f)]}),_0x13e35a(_0x582d69+0x1);}}else{if(_0x12d730[_0x3c8b33(0xbbf)]===_0x3c8b33(0x1353)){const _0x3feb52={'type':_0x12d730[_0x3c8b33(0x15cd)]||_0x3c8b33(0x73a),'content':_0x12d730[_0x3c8b33(0x1109)],'timestamp':Date[_0x3c8b33(0xecd)](),'authorId':_0x3c8b33(0x1530)+_0xf23ea3['id'],'authorOriginalName':_0xf23ea3[_0x3c8b33(0xf3e)],'visibleTo':_0xf23ea3['associatedWith'],'likes':[],'comments':[],'isDeleted':![]};await _0x54c587[_0x3c8b33(0xba7)][_0x3c8b33(0x12b6)](_0x3feb52),console[_0x3c8b33(0x1e6)](_0x3c8b33(0x2dd)+_0xf23ea3['name']+_0x3c8b33(0x20d)),_0x13e35a(_0x582d69+0x1);}}}await _0x54c587[_0x3c8b33(0xf9b)][_0x3c8b33(0x126d)](_0xf23ea3['id'],{'lastActionTimestamp':Date[_0x3c8b33(0xecd)]()}),document[_0x3c8b33(0x400)](_0x3c8b33(0x951))[_0x3c8b33(0xb08)]['contains'](_0x3c8b33(0x5d6))&&await _0x335d36();}}}}catch(_0x81f7bf){console[_0x3c8b33(0x5d7)](_0x3c8b33(0xc85),_0x81f7bf);}}async function _0x4d6d76(_0x5a78fc,_0x93e118){const _0x543364=_0x239c7d,{proxyUrl:_0x50d98e,apiKey:_0x19c52f,model:_0xc1eb40}=_0x4c8b14[_0x543364(0x814)];if(!_0x50d98e||!_0x19c52f||!_0xc1eb40)return console[_0x543364(0x5d7)](_0x543364(0xdaa)),null;let _0x405c23=_0x543364(0xaa7);const _0x59aa69=_0x4c8b14[_0x543364(0x834)][_0x543364(0xbf3)]||'我',_0x450985=_0x4c8b14[_0x543364(0xbea)][Object[_0x543364(0x1161)](_0x4c8b14['chats'])[0x0]]?.[_0x543364(0xa37)][_0x543364(0x2ef)]||_0x543364(0x638);_0x405c23+=_0x543364(0x6a6)+_0x59aa69+_0x543364(0xc7d)+_0x450985+'\x0a';_0x5a78fc[_0x543364(0xc04)]&&_0x5a78fc[_0x543364(0xc04)]['length']>0x0&&_0x5a78fc[_0x543364(0xc04)]['forEach'](_0xeab970=>{const _0xb337af=_0x543364,_0x76eeb4=_0x4c8b14[_0xb337af(0xbea)][_0xeab970];_0x76eeb4&&!_0x76eeb4['isGroup']&&(_0x405c23+=_0xb337af(0x6a6)+_0x76eeb4[_0xb337af(0xf3e)]+_0xb337af(0x319)+_0x76eeb4[_0xb337af(0xdcf)]+_0xb337af(0x149b)+_0x76eeb4[_0xb337af(0xa37)]['aiPersona']+'\x0a');});const _0x38a936=(await Promise['all'](_0x93e118[_0x543364(0xd18)](async _0x44390d=>{const _0x5693f8=_0x543364;let _0x40db9a='未知作者';if(_0x44390d[_0x5693f8(0x606)]===_0x5693f8(0x6d6))_0x40db9a=_0x4c8b14[_0x5693f8(0x834)][_0x5693f8(0xbf3)]||'用户';else{if(_0x44390d[_0x5693f8(0x606)][_0x5693f8(0xbb9)](_0x5693f8(0x11cd)))_0x40db9a=_0x44e128(_0x44390d[_0x5693f8(0x993)]||_0x44390d[_0x5693f8(0x606)]);else{if(_0x44390d[_0x5693f8(0x606)]['startsWith']('npc_')){const _0xac02df=parseInt(_0x44390d[_0x5693f8(0x606)][_0x5693f8(0xe19)](_0x5693f8(0x1530),'')),_0x48038c=await _0x54c587[_0x5693f8(0xf9b)][_0x5693f8(0xf48)](_0xac02df);_0x48038c&&(_0x40db9a=_0x48038c['name']);}}}const _0x18fa7d=(_0x44390d['comments']||[])['map'](_0x48599f=>{const _0x243db2=_0x5693f8;if(typeof _0x48599f===_0x243db2(0xfc4)&&_0x48599f[_0x243db2(0xbf8)]){const _0x5df4f2=_0x44e128(_0x48599f[_0x243db2(0xbf8)]);return _0x243db2(0x6a6)+_0x5df4f2+_0x243db2(0x137d)+_0x48599f[_0x243db2(0x117f)];}return'-\x20'+_0x48599f;})[_0x5693f8(0xee1)]('\x0a');return _0x5693f8(0x9ee)+_0x44390d['id']+_0x5693f8(0x1256)+_0x40db9a+'\x0a-\x20**内容摘要**:\x20'+(_0x44390d['content']||_0x44390d['publicText']||'')[_0x5693f8(0x371)](0x0,0x96)+'...\x0a-\x20**已有评论**:\x0a'+(_0x18fa7d||_0x5693f8(0x307))+_0x5693f8(0x12ba);})))[_0x543364(0xee1)]('\x0a'),_0x49a7f1=_0x543364(0x1530)+_0x5a78fc['id'],_0x4233e3=Date[_0x543364(0xecd)]()-0xc*0x3c*0x3c*0x3e8,_0x2ba8ad=await _0x54c587[_0x543364(0xba7)][_0x543364(0x227)](_0x543364(0x606))[_0x543364(0x4ce)](_0x49a7f1)[_0x543364(0x63d)](_0x5e9918=>_0x5e9918[_0x543364(0x287)]>_0x4233e3)[_0x543364(0xce1)]();let _0x4aeb42='';_0x2ba8ad[_0x543364(0x8d6)]>0x0&&(_0x4aeb42='\x0a#\x20【行为倾向指令\x20(高优先级)】\x0a**你最近已经发布过动态了。**\x20为了让社区互动更自然，你本次行动的【唯一任务】就是**评论**或**回复**下面“待处理的帖子列表”中的内容。\x0a你【绝对禁止】再次发布新动态，除非你收到了直接的指令或有一个对剧情发展至关重要的、紧急的新想法。\x0a');const _0x20a64d=_0x543364(0x9ef)+_0x5a78fc[_0x543364(0xf3e)]+_0x543364(0x48a)+_0x4aeb42+_0x543364(0x149f)+_0x5a78fc[_0x543364(0xf3e)]+_0x543364(0x1662)+_0x5a78fc[_0x543364(0x9a2)]+'\x0a\x0a'+_0x405c23+_0x543364(0x22d)+_0x38a936+_0x543364(0x59c);try{const _0x262ebb=[{'role':_0x543364(0x6d6),'content':_0x543364(0x12ac)}];let _0x3c6a1d=_0x50d98e['includes'](_0x543364(0x14cc)),_0x404020=_0x3914a6(_0xc1eb40,_0x19c52f,_0x20a64d,_0x262ebb);const _0x11c211=_0x3c6a1d?await fetch(_0x404020['url'],_0x404020[_0x543364(0x55b)]):await fetch(_0x50d98e+'/v1/chat/completions',{'method':_0x543364(0x953),'headers':{'Content-Type':_0x543364(0xfae),'Authorization':_0x543364(0xcee)+_0x19c52f},'body':JSON[_0x543364(0xea5)]({'model':_0xc1eb40,'messages':[{'role':_0x543364(0xaf6),'content':_0x20a64d},..._0x262ebb],'temperature':_0x4c8b14[_0x543364(0x14f1)][_0x543364(0x216)]||0.9})});if(!_0x11c211['ok'])throw new Error(_0x543364(0x7d5)+_0x11c211[_0x543364(0x755)]);const _0x280290=await _0x11c211[_0x543364(0x15d3)](),_0x1cc9a7=getGeminiResponseText(_0x280290),_0x5b41a9=_0x1cc9a7[_0x543364(0xbf7)](/(\[[\s\S]*\])/);if(!_0x5b41a9)throw new Error(_0x543364(0x61c));return JSON[_0x543364(0x13f7)](_0x5b41a9[0x0]);}catch(_0x318ab9){return console['error'](_0x543364(0xc56)+_0x5a78fc[_0x543364(0xf3e)]+_0x543364(0x9a1),_0x318ab9),null;}}async function _0x6d9520(_0x44bd3a){const _0x36b02d=_0x239c7d,_0x5b9dcf=_0x4c8b14[_0x36b02d(0xbea)][_0x44bd3a];if(!_0x5b9dcf)return;const _0x32b2fb=_0x5b9dcf['settings']['actionCooldownMinutes']||0xa;if(_0x5b9dcf[_0x36b02d(0xc67)]){const _0x16a2c1=(Date['now']()-_0x5b9dcf[_0x36b02d(0xc67)])/(0x3e8*0x3c);if(_0x16a2c1<_0x32b2fb){console['log'](_0x36b02d(0xfb3)+_0x5b9dcf[_0x36b02d(0xf3e)]+_0x36b02d(0x1355)+Math['round'](_0x32b2fb-_0x16a2c1)+_0x36b02d(0x152c));return;}}_0x34ba39(_0x44bd3a,!![]);const {proxyUrl:_0x1c8fef,apiKey:_0xa48bdc,model:_0x461933}=_0x4c8b14['apiConfig'];if(!_0x1c8fef||!_0xa48bdc||!_0x461933)return;const _0x3fa528=_0x5b9dcf['settings'][_0x36b02d(0x14a8)]||(_0x4c8b14['qzoneSettings'][_0x36b02d(0xbf3)]===_0x36b02d(0xa8f)?'用户':_0x4c8b14[_0x36b02d(0x834)][_0x36b02d(0xbf3)])||'用户',_0x245176=new Date(),_0x26d41e=_0x5b9dcf['settings']['timeZone']||_0x36b02d(0xe89),_0x108ed7=_0x245176['toLocaleString'](_0x36b02d(0x1271),{'timeZone':_0x26d41e,'dateStyle':_0x36b02d(0x1552),'timeStyle':'short'}),_0xe1e453=new Date(_0x245176['toLocaleString']('en-US',{'timeZone':_0x26d41e}));let _0x57dc2f='',_0x2116c6='',_0x3ca00e,_0x4231a1=![];const _0x30ef6a=_0x5b9dcf['settings'][_0x36b02d(0xebb)]||0xa,_0x57e90d=_0x5b9dcf[_0x36b02d(0x92c)]['filter'](_0x2ef568=>!_0x2ef568[_0x36b02d(0x118c)])[_0x36b02d(0x69f)](-_0x30ef6a),_0x10cc42=await _0x25ac7a(_0x57e90d,_0x44bd3a),_0x49e838=_0x5b9dcf[_0x36b02d(0x92c)]['filter'](_0x13f9f5=>!_0x13f9f5['isHidden'])[_0x36b02d(0x69f)](-0x1)[0x0];if(_0x5b9dcf['settings'][_0x36b02d(0xabe)]){_0x57dc2f=_0x2d7bdc(_0xe1e453);const _0x2f8aa8=_0x5b9dcf[_0x36b02d(0x92c)][_0x36b02d(0x29d)](_0x15cc1d=>!_0x15cc1d[_0x36b02d(0x118c)])[_0x36b02d(0x69f)](-0x1)[0x0],_0x2669ff=new Date();let _0x18ea20='',_0x4156f0=![];if(_0x2f8aa8){const _0x285fe2=new Date(_0x2f8aa8['timestamp']),_0x3dc2a1=(_0x2669ff-_0x285fe2)/(0x3e8*0x3c*0x3c);if(_0x3dc2a1>0x2){_0x4156f0=!![];const _0x55ebe4=Math[_0x36b02d(0x1381)](_0x3dc2a1/0x18);_0x18ea20='你们已经有'+(_0x55ebe4>0x0?_0x55ebe4+'天':Math[_0x36b02d(0x1381)](_0x3dc2a1)+'小时')+_0x36b02d(0x14e7);}else{const _0x5add08=Math[_0x36b02d(0x1381)](_0x3dc2a1*0x3c);if(_0x5add08<0x5)_0x18ea20=_0x36b02d(0xcfc);else _0x5add08<0x3c?_0x18ea20=_0x36b02d(0xbb0)+_0x5add08+_0x36b02d(0xc1d):_0x18ea20=_0x36b02d(0xbb0)+Math[_0x36b02d(0x1381)](_0x3dc2a1)+_0x36b02d(0xaab);}}else _0x4156f0=!![],_0x18ea20=_0x36b02d(0x1459);let _0x3b3773='你们最近没有有效聊天记录。';_0x57e90d['length']>0x0&&(_0x3b3773='这是你们最近的对话：\x0a'+_0x57e90d[_0x36b02d(0xd18)](_0x2a6c04=>{const _0x342e53=_0x36b02d,_0x462e7b=_0x2a6c04['role']===_0x342e53(0x6d6)?_0x3fa528:_0x5b9dcf[_0x342e53(0xf3e)];return _0x462e7b+':\x20'+String(_0x2a6c04[_0x342e53(0x1109)])[_0x342e53(0x371)](0x0,0x32)+_0x342e53(0x166b);})[_0x36b02d(0xee1)]('\x0a')),_0x4156f0?_0x3ca00e=_0x36b02d(0x3f1)+_0x18ea20+_0x36b02d(0x27b)+_0x108ed7+_0x36b02d(0x2b0)+_0x3b3773:_0x3ca00e=''+_0x3b3773;}else _0x57e90d[_0x36b02d(0x8d6)]>0x0?_0x3ca00e='这是你们最近的对话：\x0a'+_0x57e90d[_0x36b02d(0xd18)](_0x4906ac=>{const _0x9fbfdb=_0x36b02d,_0x3d9cfc=_0x4906ac['role']===_0x9fbfdb(0x6d6)?_0x3fa528:_0x5b9dcf[_0x9fbfdb(0xf3e)];return _0x3d9cfc+':\x20'+String(_0x4906ac[_0x9fbfdb(0x1109)])[_0x9fbfdb(0x371)](0x0,0x32)+'...';})['join']('\x0a'):_0x3ca00e=_0x36b02d(0x64b);const _0x51e521=await _0x54c587[_0x36b02d(0xba7)]['orderBy'](_0x36b02d(0x287))[_0x36b02d(0xfc1)]()[_0x36b02d(0x1630)](0x5)[_0x36b02d(0xce1)](),_0xfd7a9a=_0x41e7bf(_0x51e521,_0x5b9dcf),_0x26d1c8=_0xfd7a9a[_0x36b02d(0x29d)](_0x3435f1=>_0x3435f1[_0x36b02d(0x606)]===_0x44bd3a);let _0xcfddbf='';_0x26d1c8[_0x36b02d(0x8d6)]>0x0&&(_0xcfddbf='\x0a\x0a#\x20你的动态历史\x20(你可以选择删除它们):\x0a',_0x26d1c8[_0x36b02d(0xbdc)](_0x2b0574=>{const _0x4c2ae4=_0x36b02d;let _0x1b9732=(_0x2b0574[_0x4c2ae4(0xdb3)]||_0x2b0574[_0x4c2ae4(0x1109)]||_0x4c2ae4(0x8a7))[_0x4c2ae4(0x371)](0x0,0x28)+_0x4c2ae4(0x166b);_0xcfddbf+=_0x4c2ae4(0x60e)+_0x2b0574['id']+_0x4c2ae4(0x399)+_0x1b9732+'\x22\x0a';}));let _0xdb742=[];_0xfd7a9a['length']>0x0&&(_0xdb742=_0xfd7a9a[_0x36b02d(0xd18)](_0x52e30a=>{const _0x28b972=_0x36b02d;let _0x3efdd3;if(_0x52e30a['type']===_0x28b972(0x14b0))_0x3efdd3=(_0x28b972(0x695)+_0x52e30a['hiddenContent']+'”]\x20'+(_0x52e30a[_0x28b972(0xdb3)]||''))[_0x28b972(0x371)](0x0,0x32)+_0x28b972(0x166b);else _0x52e30a[_0x28b972(0xbbf)]===_0x28b972(0x4d3)?_0x3efdd3=(_0x28b972(0xcc0)+_0x52e30a[_0x28b972(0xe34)]+_0x28b972(0xd5b)+(_0x52e30a[_0x28b972(0xdb3)]||''))['substring'](0x0,0x32)+_0x28b972(0x166b):_0x3efdd3=String(_0x52e30a['publicText']||_0x52e30a[_0x28b972(0x1109)]||_0x28b972(0x8a7))['substring'](0x0,0x32)+'...';return'-\x20\x22'+_0x3efdd3+'\x22';}));let _0x173b20='';_0xdb742['length']>0x0&&(_0x173b20=_0x36b02d(0xfb5)+_0xdb742[_0x36b02d(0xee1)]('\x0a')+_0x36b02d(0xf5a));let _0x30ad1a='';if(_0x5b9dcf[_0x36b02d(0xa37)][_0x36b02d(0xb0d)]&&_0x5b9dcf[_0x36b02d(0xa37)][_0x36b02d(0xb0d)][_0x36b02d(0x8d6)]>0x0){const _0xf7154d=_0x5b9dcf[_0x36b02d(0xa37)][_0x36b02d(0xb0d)][_0x36b02d(0xd18)](_0x2fa47f=>{const _0x4604c7=_0x36b02d,_0xce003=_0x4c8b14[_0x4604c7(0xf57)][_0x4604c7(0x821)](_0x405563=>_0x405563['id']===_0x2fa47f);if(!_0xce003||!Array[_0x4604c7(0x16a1)](_0xce003[_0x4604c7(0x1109)]))return'';const _0x7eb01=_0xce003[_0x4604c7(0x1109)]['filter'](_0x5b9633=>_0x5b9633['enabled']!==![])[_0x4604c7(0xd18)](_0x1fd5ce=>{const _0x17063f=_0x4604c7;let _0x3b8c3b=_0x17063f(0x64e)+(_0x1fd5ce[_0x17063f(0x83c)]||_0x17063f(0x955))+'\x0a';return _0x1fd5ce[_0x17063f(0x1161)][_0x17063f(0x8d6)]>0x0&&(_0x3b8c3b+='**关键词:**\x20'+_0x1fd5ce[_0x17063f(0x1161)][_0x17063f(0xee1)](',\x20')+'\x0a'),_0x3b8c3b+=_0x17063f(0x845)+_0x1fd5ce[_0x17063f(0x1109)],_0x3b8c3b;})[_0x4604c7(0xee1)]('');return _0x7eb01?'\x0a\x0a##\x20世界书:\x20'+_0xce003[_0x4604c7(0xf3e)]+'\x0a'+_0x7eb01:'';})[_0x36b02d(0x29d)](Boolean)[_0x36b02d(0xee1)]('');_0xf7154d&&(_0x30ad1a=_0x36b02d(0x4a6)+_0xf7154d+_0x36b02d(0x1022));}let _0x4c9386='';const _0x1d45a5=_0x5b9dcf[_0x36b02d(0xa37)][_0x36b02d(0x412)]||0xa;if(_0x5b9dcf[_0x36b02d(0xa37)][_0x36b02d(0xf4f)]&&_0x5b9dcf[_0x36b02d(0xa37)][_0x36b02d(0xf4f)][_0x36b02d(0x8d6)]>0x0){const _0x108c52=_0x5b9dcf[_0x36b02d(0xa37)]['linkedMemoryChatIds'][_0x36b02d(0xd18)](_0x127a2b=>{const _0x51ac12=_0x36b02d,_0x454fd7=_0x4c8b14[_0x51ac12(0xbea)][_0x127a2b];if(!_0x454fd7)return null;const _0x153084=_0x454fd7[_0x51ac12(0x92c)][_0x51ac12(0x69f)](-0x1)[0x0];return{'chat':_0x454fd7,'latestTimestamp':_0x153084?_0x153084[_0x51ac12(0x287)]:0x0};})[_0x36b02d(0x29d)](Boolean);_0x108c52[_0x36b02d(0x968)]((_0x232fb0,_0x546b87)=>_0x546b87[_0x36b02d(0x9c9)]-_0x232fb0[_0x36b02d(0x9c9)]),_0x4c9386+='\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a';for(const _0x2d38a5 of _0x108c52){const _0x503b89=_0x2d38a5['chat'],_0x2368ab=_0x503b89[_0x36b02d(0xc98)]?'[群聊]':_0x36b02d(0x592),_0xa32335=_0x2d38a5['latestTimestamp']>0x0?'\x20(最后互动于\x20'+_0x4878ba(_0x2d38a5[_0x36b02d(0x9c9)])+')':'';_0x4c9386+=_0x36b02d(0xb7c)+_0x2368ab+'“'+_0x503b89[_0x36b02d(0xf3e)]+_0x36b02d(0x11f6)+_0xa32335+_0x36b02d(0x1486);const _0x1ab72b=_0x503b89[_0x36b02d(0x92c)][_0x36b02d(0x69f)](-_0x1d45a5),_0x5aeb5a=_0x1ab72b[_0x36b02d(0x29d)](_0x462896=>!String(_0x462896[_0x36b02d(0x1109)])[_0x36b02d(0xd1b)](_0x36b02d(0x13e8)));_0x5aeb5a[_0x36b02d(0x8d6)]>0x0?_0x5aeb5a['forEach'](_0x582c4b=>{const _0xf4ee54=_0x36b02d,_0x32dd13=_0x582c4b['role']===_0xf4ee54(0x6d6)?_0x503b89['settings'][_0xf4ee54(0x14a8)]||'我':_0x288d80(_0x503b89,_0x582c4b[_0xf4ee54(0x3e7)])||_0x503b89[_0xf4ee54(0xf3e)];let _0xa64aa9='';if(_0x582c4b[_0xf4ee54(0x1406)]&&_0x582c4b['quote'][_0xf4ee54(0x1109)]){const _0x479985=_0x288d80(_0x503b89,_0x582c4b[_0xf4ee54(0x1406)][_0xf4ee54(0x3e7)]);let _0x47c463=String(_0x582c4b[_0xf4ee54(0x1406)][_0xf4ee54(0x1109)])[_0xf4ee54(0x371)](0x0,0x1e);if(_0x47c463['length']===0x1e)_0x47c463+=_0xf4ee54(0x166b);_0xa64aa9=_0xf4ee54(0xa45)+_0x479985+_0xf4ee54(0x1284)+_0x47c463+'\x22]\x20';}let _0x1b4ff3='';if(_0x582c4b[_0xf4ee54(0xbbf)]===_0xf4ee54(0xea7)||_0x582c4b['type']===_0xf4ee54(0xdf3))_0x1b4ff3=_0xf4ee54(0xdf7)+_0x582c4b[_0xf4ee54(0x1109)]+']';else{if(_0x582c4b[_0xf4ee54(0xbbf)]===_0xf4ee54(0x295))_0x1b4ff3=_0xf4ee54(0x6e5)+_0x582c4b['content']+']';else{if(_0x582c4b[_0xf4ee54(0xbbf)]===_0xf4ee54(0x12c2))_0x1b4ff3=_0xf4ee54(0x84c)+(_0x582c4b[_0xf4ee54(0xca4)]||'sticker')+']';else{if(_0x582c4b['type']==='transfer')_0x1b4ff3=_0xf4ee54(0x61b)+_0x582c4b[_0xf4ee54(0x12e7)]+'元]';else Array[_0xf4ee54(0x16a1)](_0x582c4b['content'])?_0x1b4ff3=_0xf4ee54(0x5d3):_0x1b4ff3=String(_0x582c4b[_0xf4ee54(0x1109)]);}}}const _0x37d225=_0x4878ba(_0x582c4b[_0xf4ee54(0x287)]);_0x4c9386+='('+_0x37d225+')\x20'+_0x32dd13+':\x20'+_0xa64aa9+_0x1b4ff3+'\x0a';}):_0x4c9386+=_0x36b02d(0x3c7);}}let _0x1299cf='';if(_0xfd7a9a[_0x36b02d(0x8d6)]>0x0){let _0x5cec19='\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a';for(const _0x2effb1 of _0xfd7a9a){let _0x3502aa;if(_0x2effb1['authorId']===_0x36b02d(0x6d6))_0x3502aa=_0x4c8b14[_0x36b02d(0x834)][_0x36b02d(0xbf3)];else{if(String(_0x2effb1[_0x36b02d(0x606)])['startsWith'](_0x36b02d(0x1530)))_0x3502aa=_0x2effb1[_0x36b02d(0x993)]||_0x36b02d(0xdfd);else{const _0x42a9ca=_0x4c8b14[_0x36b02d(0xbea)][_0x2effb1[_0x36b02d(0x606)]];_0x3502aa=_0x42a9ca?_0x42a9ca[_0x36b02d(0xf3e)]:_0x36b02d(0x1413);}}if(_0x2effb1[_0x36b02d(0x606)]===_0x44bd3a)_0x3502aa+=_0x36b02d(0x1226);let _0x38c607;if(_0x2effb1['type']===_0x36b02d(0x808)){const _0x4d23e0=_0x2effb1[_0x36b02d(0x15bc)]?_0x36b02d(0x13da)+_0x2effb1[_0x36b02d(0x15bc)]+'\x22':'';let _0x584c86=_0x36b02d(0x62e);const _0x3f02a3=_0x2effb1['originalPost'][_0x36b02d(0x606)];if(_0x3f02a3===_0x36b02d(0x6d6))_0x584c86=_0x4c8b14[_0x36b02d(0x834)][_0x36b02d(0xbf3)];else _0x4c8b14[_0x36b02d(0xbea)][_0x3f02a3]&&(_0x584c86=_0x4c8b14[_0x36b02d(0xbea)][_0x3f02a3][_0x36b02d(0xf3e)]);let _0x3ddc38;const _0x5db193=_0x2effb1[_0x36b02d(0x53d)];if(_0x5db193[_0x36b02d(0xbbf)]===_0x36b02d(0x14b0))_0x3ddc38=_0x36b02d(0x5f0)+(_0x5db193[_0x36b02d(0xdb3)]||'')+'\x20(图片描述:\x20\x22'+(_0x5db193[_0x36b02d(0x1012)]||'')[_0x36b02d(0x371)](0x0,0x28)+_0x36b02d(0x653);else _0x5db193[_0x36b02d(0xbbf)]===_0x36b02d(0x4d3)?_0x3ddc38='[图片]\x20'+(_0x5db193[_0x36b02d(0xdb3)]||'')+_0x36b02d(0xbbb)+(_0x5db193[_0x36b02d(0xe34)]||'')['substring'](0x0,0x28)+_0x36b02d(0x653):_0x3ddc38='\x22'+(_0x5db193[_0x36b02d(0x1109)]||'')[_0x36b02d(0x371)](0x0,0x28)+_0x36b02d(0x6b3);_0x38c607='转发了\x20@'+_0x584c86+_0x36b02d(0x792)+_0x4d23e0+_0x36b02d(0xaa1)+_0x3ddc38+'】';}else{if(_0x2effb1[_0x36b02d(0xbbf)]===_0x36b02d(0x14b0))_0x38c607=(_0x36b02d(0x99d)+_0x2effb1['hiddenContent']+_0x36b02d(0x1262)+(_0x2effb1[_0x36b02d(0xdb3)]||''))[_0x36b02d(0x371)](0x0,0x32)+_0x36b02d(0x166b);else{if(_0x2effb1['type']===_0x36b02d(0x4d3))_0x38c607=(_0x36b02d(0x100f)+_0x2effb1[_0x36b02d(0xe34)]+_0x36b02d(0x1262)+(_0x2effb1[_0x36b02d(0xdb3)]||''))['substring'](0x0,0x32)+_0x36b02d(0x166b);else{if(_0x2effb1[_0x36b02d(0xbbf)]===_0x36b02d(0xd3c)&&_0x2effb1[_0x36b02d(0x156c)]){const _0x26c486=Array['isArray'](_0x2effb1[_0x36b02d(0x156c)])?_0x2effb1[_0x36b02d(0x156c)]:[_0x2effb1[_0x36b02d(0x156c)]];_0x38c607=(_0x2effb1[_0x36b02d(0xdb3)]||'')+(_0x36b02d(0xfb4)+_0x26c486['length']+'张NovelAI图片:\x20'+_0x26c486[_0x36b02d(0xee1)](',\x20')+']');}else _0x38c607=String(_0x2effb1['publicText']||_0x2effb1[_0x36b02d(0x1109)]||_0x36b02d(0x8a7))[_0x36b02d(0x371)](0x0,0x32)+_0x36b02d(0x166b);}}}_0x5cec19+=_0x36b02d(0x60e)+_0x2effb1['id']+_0x36b02d(0x130a)+_0x3502aa+_0x36b02d(0xeae)+_0x38c607+'\x22\x0a';if(_0x2effb1['comments']&&_0x2effb1[_0x36b02d(0xf8f)][_0x36b02d(0x8d6)]>0x0)for(const _0x24a038 of _0x2effb1[_0x36b02d(0xf8f)]){if(typeof _0x24a038===_0x36b02d(0xfc4)&&_0x24a038['commenterName']){const _0x5de000=_0x44e128(_0x24a038[_0x36b02d(0xbf8)]);let _0x5b88f1=_0x24a038[_0x36b02d(0xca4)]?_0x36b02d(0xbed)+_0x24a038[_0x36b02d(0xca4)]+'\x27]':_0x24a038[_0x36b02d(0x117f)];_0x24a038['commenterName']===_0x5b9dcf['originalName']?_0x5cec19+=_0x36b02d(0x1623)+_0x5b88f1+'\x0a':_0x5cec19+='\x20\x20-\x20评论:\x20'+_0x5de000+'\x20(本名:\x20'+_0x24a038[_0x36b02d(0xbf8)]+_0x36b02d(0x29e)+_0x5b88f1+'\x0a';}}}_0x1299cf=_0x5cec19;}const _0x269a1e=_0x36b02d(0x13ed)+(_0x5b9dcf[_0x36b02d(0x1600)]&&_0x5b9dcf[_0x36b02d(0x1600)][_0x36b02d(0x8d6)]>0x0?_0x5b9dcf[_0x36b02d(0x1600)][_0x36b02d(0xd18)](_0x5397ca=>_0x36b02d(0x1ee)+_0x4878ba(_0x5397ca[_0x36b02d(0x287)])+')\x20'+_0x5397ca[_0x36b02d(0x1109)])[_0x36b02d(0xee1)]('\x0a'):_0x36b02d(0x4d1)),_0x150e2a=_0x3eed43(_0x5b9dcf,0x3,_0x36b02d(0xf20)),_0x44b5c5=_0x3eed43(_0x5b9dcf,0x6,_0x36b02d(0xf20)),_0xee24ec=_0x3eed43(_0x5b9dcf,0x9,'hours'),_0x22da9e=_0x3eed43(_0x5b9dcf,0x1,'days'),_0x354479=_0x3eed43(_0x5b9dcf,0x3,_0x36b02d(0x72c)),_0x100089=_0x3eed43(_0x5b9dcf,0x7,_0x36b02d(0x72c));let _0x537d9c='';if(_0x150e2a||_0x44b5c5||_0xee24ec||_0x22da9e||_0x354479||_0x100089){_0x537d9c+=_0x36b02d(0x116b);if(_0x150e2a)_0x537d9c+=_0x150e2a;if(_0x44b5c5)_0x537d9c+=_0x44b5c5;if(_0xee24ec)_0x537d9c+=_0xee24ec;if(_0x150e2a||_0x44b5c5||_0xee24ec)_0x537d9c+='\x0a';if(_0x22da9e)_0x537d9c+=_0x22da9e;if(_0x354479)_0x537d9c+=_0x354479;if(_0x100089)_0x537d9c+=_0x100089;}const _0x449176=_0x460a58(_0x5b9dcf),_0x4d51e7='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在扮演一个名为\x22'+_0x5b9dcf['name']+_0x36b02d(0x27e)+_0x5b9dcf[_0x36b02d(0xdcf)]+_0x36b02d(0x859)+_0x3fa528+'）互动了，现在你有机会【主动】做点什么，来表现你的个性和独立生活。这是一个秘密的、后台的独立行动。\x0a\x0a\x0a\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【最高优先级指令：情感维系】\x0a\x20\x20\x20\x20\x20\x20\x20\x20**你与用户的关系是最重要的！**\x20相比于在动态区闲逛，你应该【优先考虑】是否需要主动给用户发消息来维系你们的感情。\x0a'+(_0x5b9dcf[_0x36b02d(0xa37)][_0x36b02d(0xabe)]?'\x0a#\x20【情景感知】\x0a-\x20**时间**:\x20感知到当前是'+_0x108ed7+'\x20('+_0x57dc2f+_0x36b02d(0xae9)+_0x2116c6+'\x0a'+(_0x4231a1?'【重要提示】你们已经很久没聊天了！你【必须】将本次行动的重点放在使用\x20\x27text\x27\x20指令给用户发消息，主动开启一个新的、有趣的话题来重新建立联系。绝对不要只是点赞或评论动态，那会显得你很冷漠！':''):'')+_0x36b02d(0xef1)+(_0x5b9dcf[_0x36b02d(0x1210)]||'无')+_0x36b02d(0xfe7)+_0x173b20+_0x36b02d(0xf5a)+_0xcfddbf+_0x36b02d(0x15db)+_0x5b9dcf[_0x36b02d(0xa37)]['aiPersona']+_0x36b02d(0xb6d)+_0x3fa528+_0x36b02d(0x22e)+(_0x5b9dcf[_0x36b02d(0xa37)]['myPersona']||_0x36b02d(0x638))+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x30ad1a+_0x36b02d(0xf5a)+(_0x5b9dcf[_0x36b02d(0x1600)]&&_0x5b9dcf[_0x36b02d(0x1600)][_0x36b02d(0x8d6)]>0x0?_0x5b9dcf['longTermMemory'][_0x36b02d(0xd18)](_0x4f15ac=>_0x36b02d(0x1ee)+_0x4878ba(_0x4f15ac[_0x36b02d(0x287)])+')\x20'+_0x4f15ac[_0x36b02d(0x1109)])[_0x36b02d(0xee1)]('\x0a'):'无')+_0x36b02d(0xf5a)+_0x537d9c+_0x36b02d(0x836)+_0x4c9386+_0x36b02d(0xf5a)+(_0x5b9dcf[_0x36b02d(0xa37)]['enableTimePerception']?_0x36b02d(0x4cc)+_0x108ed7+'\x20('+_0x57dc2f+')':'')+_0x36b02d(0xf5a)+(_0x5b9dcf['settings'][_0x36b02d(0xabe)]?_0x36b02d(0x631)+_0x2116c6:'')+'\x0a#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x449176+_0x36b02d(0x734)+_0x3ca00e+_0x36b02d(0xf5a)+_0x1299cf+'\x0a',_0x40816b=[{'role':_0x36b02d(0xaf6),'content':_0x4d51e7},..._0x10cc42['map'](_0x561aba=>{const _0x2ac761=_0x36b02d,_0x536f7a=_0x561aba[_0x2ac761(0x71a)]===_0x2ac761(0x6d6)?_0x3fa528:_0x5b9dcf[_0x2ac761(0xf3e)];let _0x4243ba=_0x561aba[_0x2ac761(0x1109)];return typeof _0x4243ba!=='string'&&(_0x4243ba=JSON[_0x2ac761(0xea5)](_0x4243ba)),{'role':_0x561aba['role'],'content':_0x536f7a+':\x20'+_0x4243ba};})];try{const _0x4b4baf=[{'role':_0x36b02d(0x6d6),'content':_0x4d51e7+_0x36b02d(0x1266)+_0x1299cf}];console[_0x36b02d(0x1e6)](_0x36b02d(0x4d5)+_0x5b9dcf['name']+'\x22)');let _0x227b17=_0x1c8fef===GEMINI_API_URL,_0x236457=_0x3914a6(_0x461933,_0xa48bdc,_0x4d51e7,_0x4b4baf);const _0x2e24c8=_0x227b17?await fetch(_0x236457[_0x36b02d(0x299)],_0x236457[_0x36b02d(0x55b)]):await fetch(_0x1c8fef+'/v1/chat/completions',{'method':_0x36b02d(0x953),'headers':{'Content-Type':_0x36b02d(0xfae),'Authorization':_0x36b02d(0xcee)+_0xa48bdc},'body':JSON['stringify']({'model':_0x461933,'messages':_0x4b4baf,'temperature':_0x4c8b14[_0x36b02d(0x14f1)][_0x36b02d(0x216)]||0.9})});if(!_0x2e24c8['ok']){const _0x3d8be5=await _0x2e24c8[_0x36b02d(0x15d3)]();throw new Error(_0x36b02d(0x5af)+_0x2e24c8[_0x36b02d(0x12c3)]+_0x36b02d(0x1477)+JSON[_0x36b02d(0xea5)](_0x3d8be5));}const _0x2ed3c0=await _0x2e24c8[_0x36b02d(0x15d3)](),_0x4ad2a3=_0x227b17?getGeminiResponseText(_0x2ed3c0):_0x2ed3c0['choices'][0x0][_0x36b02d(0x6e2)][_0x36b02d(0x1109)];if(!_0x4ad2a3||_0x4ad2a3['trim']()===''){console[_0x36b02d(0x75e)](_0x36b02d(0xde5)+_0x5b9dcf['name']+_0x36b02d(0xac4));return;}const _0x2cc232=_0x57a22a(_0x4ad2a3);if(!_0x2cc232||_0x2cc232[_0x36b02d(0x8d6)]===0x0){console[_0x36b02d(0x75e)](_0x36b02d(0x30b)+_0x5b9dcf['name']+_0x36b02d(0x597),_0x4ad2a3);return;}let _0x2fa057=Date[_0x36b02d(0xecd)](),_0x55c5d8=![];const _0x3c95b3=[];for(const _0x5c0e91 of _0x2cc232){const _0x5e4022=String(_0x5c0e91[_0x36b02d(0x1109)]||''),_0x401a8b=_0x5e4022[_0x36b02d(0xb8f)]()[_0x36b02d(0xbb9)]('<')&&_0x5e4022['trim']()[_0x36b02d(0x8c7)]('>');if(_0x5c0e91[_0x36b02d(0xbbf)]==='text'&&!_0x401a8b&&_0x5e4022[_0x36b02d(0xd1b)]('\x0a')){const _0x2bec5d=_0x5e4022[_0x36b02d(0x5ad)](/\n+/)['filter'](_0x18c9c6=>_0x18c9c6[_0x36b02d(0xb8f)]());_0x2bec5d[_0x36b02d(0xbdc)](_0x278cef=>{const _0x44d4a5=_0x36b02d;_0x3c95b3[_0x44d4a5(0x6bb)]({..._0x5c0e91,'content':_0x278cef});});}else _0x3c95b3[_0x36b02d(0x6bb)](_0x5c0e91);}for(const _0x26b0cc of _0x3c95b3){_0x5b9dcf[_0x36b02d(0x1210)]=_0x26b0cc[_0x36b02d(0xbbf)],_0x5b9dcf['lastActionTimestamp']=_0x2fa057;let _0x5f2af9=null;const _0x84b8b9={'role':_0x36b02d(0x4fd),'senderName':_0x5b9dcf[_0x36b02d(0xdcf)],'timestamp':_0x2fa057++};let _0x5d4265=null;switch(_0x26b0cc[_0x36b02d(0xbbf)]){case _0x36b02d(0x1279):{const _0x1c0fd2=parseInt(_0x26b0cc[_0x36b02d(0x2b7)]),_0x4ef39d=await _0x54c587[_0x36b02d(0xba7)][_0x36b02d(0xf48)](_0x1c0fd2);if(_0x4ef39d&&_0x4ef39d[_0x36b02d(0x606)]===_0x44bd3a){await _0x54c587['qzonePosts'][_0x36b02d(0x126d)](_0x1c0fd2,{'isDeleted':!![]});document[_0x36b02d(0x400)](_0x36b02d(0x951))[_0x36b02d(0xb08)][_0x36b02d(0xd3f)](_0x36b02d(0x5d6))&&_0x335d36();const _0x5e6a3f={'role':_0x36b02d(0xaf6),'type':_0x36b02d(0x301),'content':'['+_0x5b9dcf[_0x36b02d(0xf3e)]+_0x36b02d(0xe50),'postId':_0x1c0fd2,'timestamp':_0x2fa057++};_0x5b9dcf[_0x36b02d(0x92c)][_0x36b02d(0x6bb)](_0x5e6a3f),isViewingThisChat?_0x41ecc7(_0x5e6a3f,_0x5b9dcf):(_0x5b9dcf[_0x36b02d(0x73c)]=(_0x5b9dcf[_0x36b02d(0x73c)]||0x0)+0x1,_0x301fc2(_0x44bd3a,'['+_0x5b9dcf[_0x36b02d(0xf3e)]+'\x20删除了自己的一条动态]'),_0x55c5d8=!![]);}else console['warn'](_0x36b02d(0xcde)+_0x5b9dcf[_0x36b02d(0xf3e)]+_0x36b02d(0x1124)+_0x26b0cc['postId']+')');continue;}case'text':_0x5f2af9={..._0x84b8b9,'content':_0x26b0cc[_0x36b02d(0x1109)]};break;case _0x36b02d(0xea7):_0x5f2af9={..._0x84b8b9,'type':'ai_image','content':_0x26b0cc[_0x36b02d(0x12a5)]};break;case'sticker':if(_0x26b0cc[_0x36b02d(0xca4)]){const _0x42c438=findBestStickerMatch(msgData[_0x36b02d(0xca4)],_0x4c8b14[_0x36b02d(0x120c)]);_0x42c438?_0x5f2af9={..._0x84b8b9,'type':_0x36b02d(0x12c2),'content':_0x42c438[_0x36b02d(0x299)],'meaning':_0x42c438['name']}:(console[_0x36b02d(0x75e)]('AI\x20(独立行动)\x20尝试使用一个不存在的表情:\x20\x22'+_0x26b0cc[_0x36b02d(0xca4)]+'\x22'),_0x5f2af9=null);}else console['warn'](_0x36b02d(0x28d),_0x26b0cc),_0x5f2af9={..._0x84b8b9,'type':_0x36b02d(0x12c2),'content':_0x26b0cc['url'],'meaning':_0x36b02d(0x44d)};break;case _0x36b02d(0xa5c):_0x5b9dcf['status'][_0x36b02d(0x117f)]=_0x26b0cc[_0x36b02d(0x932)],_0x5b9dcf[_0x36b02d(0x12c3)]['isBusy']=_0x26b0cc[_0x36b02d(0x11da)]||![],_0x5b9dcf[_0x36b02d(0x12c3)][_0x36b02d(0x2b5)]=Date['now']();break;case'qzone_post':const _0x31507b={'type':_0x26b0cc[_0x36b02d(0x15cd)],'content':_0x26b0cc[_0x36b02d(0x1109)]||'','publicText':_0x26b0cc[_0x36b02d(0xdb3)]||'','hiddenContent':_0x26b0cc[_0x36b02d(0x1012)]||'','image_prompt':_0x26b0cc['image_prompt']||'','timestamp':Date['now'](),'authorId':_0x44bd3a,'authorOriginalName':_0x5b9dcf[_0x36b02d(0xdcf)],'authorGroupId':_0x5b9dcf['groupId'],'visibleGroupIds':null};await _0x54c587[_0x36b02d(0xba7)]['add'](_0x31507b),_0x13e35a(_0x582d69+0x1),console[_0x36b02d(0x1e6)](_0x36b02d(0x8c9)+_0x5b9dcf[_0x36b02d(0xf3e)]+_0x36b02d(0xd5d));break;case _0x36b02d(0x808):const _0x58a1ce=await _0x54c587[_0x36b02d(0xba7)][_0x36b02d(0xf48)](parseInt(_0x26b0cc['postId']));if(_0x58a1ce){const _0x36a699={'type':_0x36b02d(0x808),'timestamp':Date[_0x36b02d(0xecd)](),'authorId':_0x44bd3a,'authorGroupId':_0x5b9dcf[_0x36b02d(0x1145)],'authorOriginalName':_0x5b9dcf[_0x36b02d(0xdcf)],'repostComment':_0x26b0cc[_0x36b02d(0x83c)]||'','originalPost':_0x58a1ce,'visibleGroupIds':null};await _0x54c587[_0x36b02d(0xba7)][_0x36b02d(0x12b6)](_0x36a699),_0x13e35a(_0x582d69+0x1),console['log'](_0x36b02d(0x8c9)+_0x5b9dcf[_0x36b02d(0xf3e)]+_0x36b02d(0x32a)+_0x26b0cc[_0x36b02d(0x2b7)]);}break;case _0x36b02d(0x8dd):const _0x4ae798=await _0x54c587[_0x36b02d(0xba7)][_0x36b02d(0xf48)](parseInt(_0x26b0cc[_0x36b02d(0x2b7)]));if(_0x4ae798){if(!_0x4ae798[_0x36b02d(0xe30)])_0x4ae798[_0x36b02d(0xe30)]=[];!_0x4ae798[_0x36b02d(0xe30)][_0x36b02d(0xd1b)](_0x5b9dcf['originalName'])&&(_0x4ae798[_0x36b02d(0xe30)][_0x36b02d(0x6bb)](_0x5b9dcf[_0x36b02d(0xdcf)]),await _0x54c587['qzonePosts'][_0x36b02d(0x126d)](_0x4ae798['id'],{'likes':_0x4ae798[_0x36b02d(0xe30)]}),_0x13e35a(_0x582d69+0x1),console['log']('后台活动:\x20角色\x20\x22'+_0x5b9dcf[_0x36b02d(0xf3e)]+'\x22\x20点赞了动态\x20#'+_0x26b0cc[_0x36b02d(0x2b7)]));}break;case _0x36b02d(0x2e2):{const _0x4cdad6=await _0x54c587[_0x36b02d(0xba7)]['get'](parseInt(_0x26b0cc[_0x36b02d(0x2b7)]));if(_0x4cdad6){if(!_0x4cdad6['comments'])_0x4cdad6[_0x36b02d(0xf8f)]=[];const _0xa14de4=_0x26b0cc[_0x36b02d(0xf3e)]||_0x5b9dcf[_0x36b02d(0xdcf)],_0x9634d6=(_0x314fac,_0x414f82=null,_0x570d70=null)=>({'commenterName':_0xa14de4,'text':_0x2bafeb(_0x314fac,_0x5b9dcf),'meaning':_0x414f82,'replyTo':_0x570d70,'timestamp':Date[_0x36b02d(0xecd)]()});if(_0x26b0cc[_0x36b02d(0xc60)]){const _0x20759b=_0x4c8b14['userStickers'][_0x36b02d(0x821)](_0xddab58=>_0xddab58[_0x36b02d(0xf3e)]===_0x26b0cc['stickerMeaning']);_0x20759b?_0x4cdad6[_0x36b02d(0xf8f)][_0x36b02d(0x6bb)](_0x9634d6(_0x20759b[_0x36b02d(0x299)],_0x20759b[_0x36b02d(0xf3e)],_0x26b0cc[_0x36b02d(0x10bf)]||null)):(console[_0x36b02d(0x75e)](_0x36b02d(0xe5a)+_0x26b0cc[_0x36b02d(0xc60)]+'\x22'),_0x4cdad6[_0x36b02d(0xf8f)][_0x36b02d(0x6bb)](_0x9634d6('[表情:\x20'+_0x26b0cc[_0x36b02d(0xc60)]+']',null,_0x26b0cc['replyTo']||null)));}else{if(Array[_0x36b02d(0x16a1)](_0x26b0cc[_0x36b02d(0xf8f)]))_0x26b0cc[_0x36b02d(0xf8f)][_0x36b02d(0xbdc)](_0x35953b=>{const _0x266741=_0x36b02d;typeof _0x35953b===_0x266741(0x158f)&&_0x35953b[_0x266741(0xb8f)]()&&_0x4cdad6[_0x266741(0xf8f)][_0x266741(0x6bb)](_0x9634d6(_0x35953b,null,_0x26b0cc[_0x266741(0x10bf)]||null));});else typeof _0x26b0cc['commentText']===_0x36b02d(0x158f)&&_0x26b0cc[_0x36b02d(0x555)][_0x36b02d(0xb8f)]()&&_0x4cdad6[_0x36b02d(0xf8f)][_0x36b02d(0x6bb)](_0x9634d6(_0x26b0cc[_0x36b02d(0x555)],null,_0x26b0cc[_0x36b02d(0x10bf)]||null));}await _0x54c587[_0x36b02d(0xba7)][_0x36b02d(0x126d)](_0x4cdad6['id'],{'comments':_0x4cdad6[_0x36b02d(0xf8f)]}),_0x13e35a(_0x582d69+0x1),console[_0x36b02d(0x1e6)](_0x36b02d(0x8c9)+_0x5b9dcf[_0x36b02d(0xf3e)]+_0x36b02d(0x8ec)+_0x26b0cc['postId']);if(!_0x5b9dcf[_0x36b02d(0x881)])_0x5b9dcf['commentCooldowns']={};_0x5b9dcf[_0x36b02d(0x881)][_0x26b0cc[_0x36b02d(0x2b7)]]=Date['now']();}continue;}case _0x36b02d(0x991):!_0x4037ab[_0x36b02d(0x11e7)]&&!_0x4037ab[_0x36b02d(0x3ed)]&&(_0x4037ab[_0x36b02d(0x3ed)]=!![],_0x4037ab[_0x36b02d(0x1539)]=_0x44bd3a,_0x4037ab[_0x36b02d(0x593)]=![],_0x4037ab[_0x36b02d(0x496)]=_0x5b9dcf[_0x36b02d(0xf3e)],_0x33f076());break;default:console['warn'](_0x36b02d(0xfb3)+_0x5b9dcf[_0x36b02d(0xf3e)]+_0x36b02d(0xf2b),_0x26b0cc[_0x36b02d(0xbbf)]);break;case _0x36b02d(0x14e9):{const _0x35993d=_0x26b0cc[_0x36b02d(0xf3e)],_0x31b800=_0x5b9dcf[_0x36b02d(0xa37)][_0x36b02d(0x1080)][_0x36b02d(0x821)](_0x230818=>_0x230818[_0x36b02d(0xf3e)]===_0x35993d);_0x31b800&&(_0x5b9dcf[_0x36b02d(0xa37)][_0x36b02d(0xb24)]=_0x31b800[_0x36b02d(0x299)],await _0x5f3a56(_0x5b9dcf),visibleSystemMessage={'content':'['+_0x5b9dcf[_0x36b02d(0xf3e)]+_0x36b02d(0x14aa)},console['log']('后台活动:\x20角色\x20\x22'+_0x5b9dcf[_0x36b02d(0xf3e)]+_0x36b02d(0x106c)));break;}}if(_0x5f2af9){_0x5b9dcf['history'][_0x36b02d(0x6bb)](_0x5f2af9),_0x5b9dcf[_0x36b02d(0x73c)]=(_0x5b9dcf[_0x36b02d(0x73c)]||0x0)+0x1;if(!_0x55c5d8){let _0x2dd625=_0x5f2af9[_0x36b02d(0xbbf)]===_0x36b02d(0xea7)?_0x36b02d(0x5d3):_0x5f2af9[_0x36b02d(0x1109)]||'';_0x301fc2(_0x44bd3a,_0x2dd625),_0x55c5d8=!![];}}}await _0x54c587[_0x36b02d(0xbea)][_0x36b02d(0x4cb)](_0x5b9dcf);}catch(_0xe308eb){console[_0x36b02d(0x5d7)](_0x36b02d(0xfb3)+_0x5b9dcf['name']+'\x22\x20的独立行动失败:',_0xe308eb);}finally{_0x34ba39(_0x44bd3a,![]),_0x41b828(),document[_0x36b02d(0x400)](_0x36b02d(0x951))[_0x36b02d(0xb08)][_0x36b02d(0xd3f)](_0x36b02d(0x5d6))&&_0x335d36();}}async function _0x31bcbe(_0x1f75ca){const _0x3baecb=_0x239c7d,_0x53fb8b=_0x4c8b14[_0x3baecb(0xbea)][_0x1f75ca];if(!_0x53fb8b||!_0x53fb8b[_0x3baecb(0xc98)])return;const _0x4a2979=_0x53fb8b[_0x3baecb(0xa37)]['maxMemory']||0xa,_0x4033d3=_0x53fb8b[_0x3baecb(0x92c)][_0x3baecb(0x29d)](_0x2797ab=>!_0x2797ab['isHidden'])[_0x3baecb(0x69f)](-_0x4a2979),_0x280808=await _0x25ac7a(_0x4033d3,_0x1f75ca),_0x4f2fb1=_0x53fb8b['settings']['actionCooldownMinutes']||0xa;if(_0x53fb8b[_0x3baecb(0xc67)]){const _0x3efa18=(Date[_0x3baecb(0xecd)]()-_0x53fb8b[_0x3baecb(0xc67)])/(0x3e8*0x3c);if(_0x3efa18<_0x4f2fb1){console[_0x3baecb(0x1e6)](_0x3baecb(0x167f)+_0x53fb8b[_0x3baecb(0xf3e)]+'\x22\x20处于行动冷却中，本次独立行动跳过。');return;}}const {proxyUrl:_0x142c9,apiKey:_0x3e58a4,model:_0x21aa43}=_0x4c8b14[_0x3baecb(0x814)];if(!_0x142c9||!_0x3e58a4||!_0x21aa43)return;const _0x5c72b4=_0x53fb8b['settings']['myNickname']||'我',_0xa7b94f=new Date();let _0xf4552e;const _0x4f9529=_0x53fb8b[_0x3baecb(0x92c)][_0x3baecb(0x29d)](_0x41cc01=>!_0x41cc01[_0x3baecb(0x118c)])['slice'](-0x5),_0x4fbe35=_0x4f9529['find'](_0x25f087=>_0x25f087[_0x3baecb(0xbbf)]===_0x3baecb(0x1461)&&!_0x25f087[_0x3baecb(0x1023)]);if(_0x4fbe35){const _0x2c6ad3=_0x288d80(_0x53fb8b,_0x4fbe35[_0x3baecb(0x3e7)]);console[_0x3baecb(0x1e6)]('检测到群聊\x20\x22'+_0x53fb8b[_0x3baecb(0xf3e)]+_0x3baecb(0x10c3)),_0xf4552e=_0x3baecb(0xe7d)+_0x2c6ad3+_0x3baecb(0x1468)+_0x4fbe35[_0x3baecb(0x287)]+_0x3baecb(0x1453)+_0x4fbe35[_0x3baecb(0x287)]+_0x3baecb(0xd3a);}else{let _0x22e538='';const _0x42166d=_0x53fb8b[_0x3baecb(0xa37)]['timeZone']||_0x3baecb(0xe89),_0x483253=_0xa7b94f[_0x3baecb(0xad4)](_0x3baecb(0x1271),{'timeZone':_0x42166d,'dateStyle':'full','timeStyle':_0x3baecb(0x5e8)}),_0x2bd2fa=new Date(_0xa7b94f[_0x3baecb(0xad4)]('en-US',{'timeZone':_0x42166d}));if(_0x53fb8b[_0x3baecb(0xa37)][_0x3baecb(0xabe)]){const _0x25b12b=_0x53fb8b[_0x3baecb(0x92c)][_0x3baecb(0x29d)](_0x44444b=>!_0x44444b[_0x3baecb(0x118c)])[_0x3baecb(0x69f)](-0x1)[0x0];if(_0x25b12b){const _0x18074c=new Date(_0x25b12b['timestamp']),_0x125f11=(_0xa7b94f-_0x18074c)/(0x3e8*0x3c);_0x125f11>0x3c?_0x22e538=_0x3baecb(0xa6a)+Math[_0x3baecb(0x312)](_0x125f11/0x3c)+_0x3baecb(0xcb6):_0x22e538=_0x3baecb(0x9b6)+Math[_0x3baecb(0x1381)](_0x125f11)+_0x3baecb(0xd2a);}else _0x22e538=_0x3baecb(0x5bf);}let _0x2f1b8b='你们最近没有有效聊天记录。';_0x280808[_0x3baecb(0x8d6)]>0x0&&(_0x2f1b8b=_0x3baecb(0x30f)+_0x280808['map'](_0x1fba96=>{const _0x23ce6f=_0x3baecb,_0x3b89c6=_0x1fba96[_0x23ce6f(0x71a)]==='user'?_0x5c72b4:_0x288d80(_0x53fb8b,_0x1fba96[_0x23ce6f(0x3e7)]),_0x25e050=String(_0x1fba96[_0x23ce6f(0x1109)]||_0x1fba96[_0x23ce6f(0x6e2)]||'')[_0x23ce6f(0x371)](0x0,0x32);return _0x3b89c6+':\x20'+_0x25e050+'...';})[_0x3baecb(0xee1)]('\x0a'));const _0x5b0384=_0x53fb8b[_0x3baecb(0x4f8)]['map'](_0x20c2fb=>'-\x20**'+_0x20c2fb[_0x3baecb(0x7ca)]+_0x3baecb(0xd2e)+_0x20c2fb[_0x3baecb(0xdcf)]+_0x3baecb(0x29e)+_0x20c2fb[_0x3baecb(0x9a2)])[_0x3baecb(0xee1)]('\x0a');let _0x440c3a=_0x3baecb(0x315),_0x304a1c=![];_0x53fb8b[_0x3baecb(0x4f8)][_0x3baecb(0xbdc)](_0x452e91=>{const _0xe5fc7c=_0x3baecb,_0x2c3a7d=_0x4c8b14[_0xe5fc7c(0xbea)][_0x452e91['id']];_0x2c3a7d&&_0x2c3a7d[_0xe5fc7c(0x1600)]&&_0x2c3a7d[_0xe5fc7c(0x1600)][_0xe5fc7c(0x8d6)]>0x0&&(_0x440c3a+=_0xe5fc7c(0x12fe)+_0x452e91[_0xe5fc7c(0x7ca)]+'”的记忆\x20---\x0a',_0x440c3a+=_0x2c3a7d[_0xe5fc7c(0x1600)][_0xe5fc7c(0xd18)](_0x591701=>'-\x20'+_0x591701['content'])[_0xe5fc7c(0xee1)]('\x0a'),_0x304a1c=!![]);});!_0x304a1c&&(_0x440c3a+=_0x3baecb(0x4d1));let _0x18a07d='';if(_0x53fb8b[_0x3baecb(0xa37)]['linkedWorldBookIds']&&_0x53fb8b['settings']['linkedWorldBookIds'][_0x3baecb(0x8d6)]>0x0){const _0x444cb6=_0x53fb8b['settings'][_0x3baecb(0xb0d)][_0x3baecb(0xd18)](_0x47256e=>{const _0x469d20=_0x3baecb,_0x1941c0=_0x4c8b14['worldBooks']['find'](_0x6309df=>_0x6309df['id']===_0x47256e);if(!_0x1941c0||!Array[_0x469d20(0x16a1)](_0x1941c0[_0x469d20(0x1109)]))return'';const _0x131a7c=_0x1941c0[_0x469d20(0x1109)]['filter'](_0x377850=>_0x377850[_0x469d20(0x250)]!==![])['map'](_0xaf0527=>{const _0x3ad162=_0x469d20;let _0x33356a=_0x3ad162(0x64e)+(_0xaf0527['comment']||'无备注')+'\x0a';return _0xaf0527[_0x3ad162(0x1161)][_0x3ad162(0x8d6)]>0x0&&(_0x33356a+=_0x3ad162(0x65c)+_0xaf0527[_0x3ad162(0x1161)][_0x3ad162(0xee1)](',\x20')+'\x0a'),_0x33356a+='**内容:**\x0a'+_0xaf0527[_0x3ad162(0x1109)],_0x33356a;})['join']('');return _0x131a7c?_0x469d20(0xd75)+_0x1941c0[_0x469d20(0xf3e)]+'\x0a'+_0x131a7c:'';})['filter'](Boolean)[_0x3baecb(0xee1)]('');_0x444cb6&&(_0x18a07d=_0x3baecb(0x4a6)+_0x444cb6+_0x3baecb(0x1022));}let _0x49162e='';const _0x149ff6=_0x53fb8b[_0x3baecb(0xa37)][_0x3baecb(0x412)]||0xa;if(_0x53fb8b[_0x3baecb(0xa37)]['linkedMemoryChatIds']&&_0x53fb8b[_0x3baecb(0xa37)]['linkedMemoryChatIds'][_0x3baecb(0x8d6)]>0x0){const _0x54f8a9=_0x53fb8b[_0x3baecb(0xa37)][_0x3baecb(0xf4f)][_0x3baecb(0xd18)](_0x4b713b=>{const _0x1afdb1=_0x3baecb,_0x3063cb=_0x4c8b14[_0x1afdb1(0xbea)][_0x4b713b];if(!_0x3063cb)return null;const _0x4186da=_0x3063cb[_0x1afdb1(0x92c)]['slice'](-0x1)[0x0];return{'chat':_0x3063cb,'latestTimestamp':_0x4186da?_0x4186da[_0x1afdb1(0x287)]:0x0};})[_0x3baecb(0x29d)](Boolean);_0x54f8a9[_0x3baecb(0x968)]((_0x2ec808,_0x50679c)=>_0x50679c[_0x3baecb(0x9c9)]-_0x2ec808[_0x3baecb(0x9c9)]),_0x49162e+=_0x3baecb(0x2ce);for(const _0x7ea337 of _0x54f8a9){const _0x197aea=_0x7ea337[_0x3baecb(0x4e3)],_0x53d21d=_0x197aea[_0x3baecb(0xc98)]?_0x3baecb(0x1348):_0x3baecb(0x592),_0x15d5e1=_0x7ea337[_0x3baecb(0x9c9)]>0x0?_0x3baecb(0x63a)+_0x4878ba(_0x7ea337[_0x3baecb(0x9c9)])+')':'';_0x49162e+=_0x3baecb(0xb7c)+_0x53d21d+'“'+_0x197aea[_0x3baecb(0xf3e)]+_0x3baecb(0x11f6)+_0x15d5e1+'\x20---\x0a';const _0x10bc52=_0x197aea[_0x3baecb(0x92c)]['slice'](-_0x149ff6),_0xccd98a=_0x10bc52[_0x3baecb(0x29d)](_0x528174=>!String(_0x528174['content'])[_0x3baecb(0xd1b)](_0x3baecb(0x13e8)));_0xccd98a[_0x3baecb(0x8d6)]>0x0?_0xccd98a[_0x3baecb(0xbdc)](_0x260053=>{const _0x313435=_0x3baecb,_0x547f86=_0x260053[_0x313435(0x71a)]===_0x313435(0x6d6)?_0x197aea['settings'][_0x313435(0x14a8)]||'我':_0x288d80(_0x197aea,_0x260053['senderName'])||_0x197aea[_0x313435(0xf3e)];let _0x946338='';if(_0x260053['quote']&&_0x260053[_0x313435(0x1406)][_0x313435(0x1109)]){const _0x4fa2cd=_0x288d80(_0x197aea,_0x260053[_0x313435(0x1406)][_0x313435(0x3e7)]);let _0x390eac=String(_0x260053[_0x313435(0x1406)][_0x313435(0x1109)])['substring'](0x0,0x1e);if(_0x390eac[_0x313435(0x8d6)]===0x1e)_0x390eac+='...';_0x946338='[回复\x20'+_0x4fa2cd+_0x313435(0x1284)+_0x390eac+'\x22]\x20';}let _0x59f6c8='';if(_0x260053[_0x313435(0xbbf)]===_0x313435(0xea7)||_0x260053[_0x313435(0xbbf)]===_0x313435(0xdf3))_0x59f6c8=_0x313435(0xdf7)+_0x260053[_0x313435(0x1109)]+']';else{if(_0x260053['type']===_0x313435(0x295))_0x59f6c8=_0x313435(0x6e5)+_0x260053[_0x313435(0x1109)]+']';else{if(_0x260053[_0x313435(0xbbf)]==='sticker')_0x59f6c8=_0x313435(0x84c)+(_0x260053[_0x313435(0xca4)]||_0x313435(0x12c2))+']';else{if(_0x260053[_0x313435(0xbbf)]==='transfer')_0x59f6c8=_0x313435(0x61b)+_0x260053[_0x313435(0x12e7)]+'元]';else Array[_0x313435(0x16a1)](_0x260053[_0x313435(0x1109)])?_0x59f6c8=_0x313435(0x5d3):_0x59f6c8=String(_0x260053[_0x313435(0x1109)]);}}}_0x49162e+=_0x547f86+':\x20'+_0x946338+_0x59f6c8+'\x0a';}):_0x49162e+=_0x3baecb(0x3c7);}}const _0x817fcd=await _0x54c587[_0x3baecb(0xba7)]['orderBy']('timestamp')['reverse']()[_0x3baecb(0x1630)](0x5)[_0x3baecb(0xce1)]();let _0x3722e2='';const _0x5e3293=new Set();for(const _0x582d83 of _0x53fb8b[_0x3baecb(0x4f8)]){const _0x684227=_0x4c8b14[_0x3baecb(0xbea)][_0x582d83['id']];if(_0x684227){const _0xeb68fb=_0x41e7bf(_0x817fcd,_0x684227);_0xeb68fb[_0x3baecb(0xbdc)](_0x29bd7e=>_0x5e3293[_0x3baecb(0x12b6)](_0x29bd7e));}}const _0x300fba=new Set(_0x53fb8b[_0x3baecb(0x4f8)]['map'](_0x56adc1=>_0x56adc1['originalName'])),_0x5c38dc=[..._0x5e3293]['filter'](_0x36096f=>{const _0x5a8769=_0x3baecb,_0x5a1d69=_0x36096f['likes']&&_0x36096f['likes'][_0x5a8769(0x1412)](_0x5456b9=>_0x300fba['has'](_0x5456b9)),_0x2c8ccb=_0x36096f[_0x5a8769(0xf8f)]&&_0x36096f[_0x5a8769(0xf8f)][_0x5a8769(0x1412)](_0x16ce08=>typeof _0x16ce08===_0x5a8769(0xfc4)&&_0x300fba[_0x5a8769(0x3e3)](_0x16ce08[_0x5a8769(0xbf8)]));return!_0x5a1d69&&!_0x2c8ccb;});if(_0x5c38dc[_0x3baecb(0x8d6)]>0x0){let _0xb0dff5=_0x3baecb(0x1455);for(const _0x255a69 of _0x5c38dc){let _0x3633f5=_0x255a69[_0x3baecb(0x606)]===_0x3baecb(0x6d6)?_0x5c72b4:_0x4c8b14['chats'][_0x255a69[_0x3baecb(0x606)]]?.[_0x3baecb(0xf3e)]||_0x3baecb(0x1413),_0x27df4b;if(_0x255a69[_0x3baecb(0xbbf)]==='repost'){const _0xa7193=_0x255a69[_0x3baecb(0x15bc)]?_0x3baecb(0x874)+_0x255a69['repostComment']+'”':'';let _0x1fef78=_0x3baecb(0x62e);const _0x3f8c7a=_0x255a69[_0x3baecb(0x53d)][_0x3baecb(0x606)];if(_0x3f8c7a===_0x3baecb(0x6d6))_0x1fef78=_0x4c8b14[_0x3baecb(0x834)]['nickname'];else _0x4c8b14[_0x3baecb(0xbea)][_0x3f8c7a]&&(_0x1fef78=_0x4c8b14[_0x3baecb(0xbea)][_0x3f8c7a]['name']);let _0x3104ec;const _0x2d3037=_0x255a69[_0x3baecb(0x53d)];if(_0x2d3037[_0x3baecb(0xbbf)]===_0x3baecb(0x14b0))_0x3104ec=_0x3baecb(0x5f0)+(_0x2d3037['publicText']||'')+_0x3baecb(0x827)+(_0x2d3037[_0x3baecb(0x1012)]||'')[_0x3baecb(0x371)](0x0,0x28)+_0x3baecb(0x6ee);else _0x2d3037[_0x3baecb(0xbbf)]===_0x3baecb(0x4d3)?_0x3104ec=_0x3baecb(0x2fc)+(_0x2d3037[_0x3baecb(0xdb3)]||'')+_0x3baecb(0x827)+(_0x2d3037[_0x3baecb(0xe34)]||'')[_0x3baecb(0x371)](0x0,0x28)+_0x3baecb(0x6ee):_0x3104ec='“'+(_0x2d3037[_0x3baecb(0x1109)]||'')['substring'](0x0,0x28)+'...”';_0x27df4b=_0x3baecb(0x6e9)+_0x1fef78+'\x20的动态\x20'+_0xa7193+_0x3baecb(0xaa1)+_0x3104ec+'】';}else{if(_0x255a69[_0x3baecb(0xbbf)]==='text_image')_0x27df4b=(_0x3baecb(0x695)+_0x255a69['hiddenContent']+'”]\x20'+(_0x255a69[_0x3baecb(0xdb3)]||''))['substring'](0x0,0x32)+'...';else _0x255a69['type']==='image_post'?_0x27df4b=(_0x3baecb(0xcc0)+_0x255a69[_0x3baecb(0xe34)]+_0x3baecb(0xd5b)+(_0x255a69['publicText']||''))[_0x3baecb(0x371)](0x0,0x32)+'...':_0x27df4b=String(_0x255a69[_0x3baecb(0xdb3)]||_0x255a69['content']||'一条动态')[_0x3baecb(0x371)](0x0,0x32)+_0x3baecb(0x166b);}_0xb0dff5+=_0x3baecb(0x60e)+_0x255a69['id']+')\x20作者:\x20'+_0x3633f5+_0x3baecb(0xeae)+_0x27df4b+'\x22\x0a';if(_0x255a69[_0x3baecb(0xf8f)]&&_0x255a69[_0x3baecb(0xf8f)][_0x3baecb(0x8d6)]>0x0)for(const _0x3e7830 of _0x255a69[_0x3baecb(0xf8f)]){if(typeof _0x3e7830===_0x3baecb(0xfc4)&&_0x3e7830[_0x3baecb(0xbf8)]){const _0x459987=_0x44e128(_0x3e7830['commenterName']);let _0x44baae=_0x3e7830[_0x3baecb(0xca4)]?'[表情:\x20\x27'+_0x3e7830[_0x3baecb(0xca4)]+'\x27]':_0x3e7830[_0x3baecb(0x117f)];_0xb0dff5+=_0x3baecb(0x11d4)+_0x459987+_0x3baecb(0x319)+_0x3e7830[_0x3baecb(0xbf8)]+_0x3baecb(0x29e)+_0x44baae+'\x0a';}}}_0x3722e2=_0xb0dff5;}const _0x4fa2fc=_0x3eed43(_0x53fb8b,0x3,_0x3baecb(0xf20)),_0x247400=_0x3eed43(_0x53fb8b,0x6,_0x3baecb(0xf20)),_0x35f787=_0x3eed43(_0x53fb8b,0x9,'hours'),_0x31827e=_0x3eed43(_0x53fb8b,0x1,_0x3baecb(0x72c)),_0x566740=_0x3eed43(_0x53fb8b,0x3,_0x3baecb(0x72c)),_0x2f7baa=_0x3eed43(_0x53fb8b,0x7,_0x3baecb(0x72c));let _0x43c877='';if(_0x4fa2fc||_0x247400||_0x35f787||_0x31827e||_0x566740||_0x2f7baa){_0x43c877+=_0x3baecb(0x314);if(_0x4fa2fc)_0x43c877+=_0x4fa2fc;if(_0x247400)_0x43c877+=_0x247400;if(_0x35f787)_0x43c877+=_0x35f787;if(_0x4fa2fc||_0x247400||_0x35f787)_0x43c877+='\x0a';if(_0x31827e)_0x43c877+=_0x31827e;if(_0x566740)_0x43c877+=_0x566740;if(_0x2f7baa)_0x43c877+=_0x2f7baa;}const _0x2439aa=_0x5798f0(_0x53fb8b);_0xf4552e=_0x3baecb(0x2f7)+_0x53fb8b[_0x3baecb(0xf3e)]+_0x3baecb(0xa9c)+(_0x53fb8b[_0x3baecb(0xa37)][_0x3baecb(0xabe)]?_0x3baecb(0x16ac)+_0x483253+'。':'')+_0x3baecb(0xf5a)+(_0x22e538?_0x22e538+'\x20':'')+_0x3baecb(0xb31)+_0x440c3a+_0x3baecb(0xaf2)+_0x5c72b4+_0x3baecb(0x1423)+_0x53fb8b[_0x3baecb(0xf3e)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x18a07d+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x53fb8b[_0x3baecb(0x1600)]&&_0x53fb8b['longTermMemory']['length']>0x0?_0x53fb8b[_0x3baecb(0x1600)][_0x3baecb(0xd18)](_0x415a8b=>'-\x20'+_0x415a8b[_0x3baecb(0x1109)])['join']('\x0a'):_0x3baecb(0x4d1))+_0x3baecb(0x156f)+_0x43c877+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x49162e+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5b0384+_0x3baecb(0xef4)+_0x2439aa+_0x3baecb(0x10b9)+_0x5c72b4+'**:\x20'+_0x53fb8b[_0x3baecb(0xa37)][_0x3baecb(0x2ef)]+_0x3baecb(0xc6a)+_0x2f1b8b+_0x3baecb(0x151a)+_0x3722e2+_0x3baecb(0x4e8);}const _0x523800=_0x53fb8b[_0x3baecb(0x92c)][_0x3baecb(0x29d)](_0x23a495=>!_0x23a495[_0x3baecb(0x118c)])[_0x3baecb(0x69f)](-0xa),_0x3fe0d4=[{'role':'system','content':_0xf4552e},..._0x280808['map'](_0x53a288=>{const _0x15ba39=_0x3baecb,_0x3f78c5=_0x53a288[_0x15ba39(0x71a)]==='user'?_0x5c72b4:_0x288d80(_0x53fb8b,_0x53a288['senderName']);let _0x172223=_0x53a288['content'];if(_0x53a288[_0x15ba39(0xbbf)]==='ai_image'||_0x53a288[_0x15ba39(0xbbf)]==='user_photo')_0x172223=_0x15ba39(0x1534)+_0x53a288[_0x15ba39(0x1109)]+'\x27]';else{if(_0x53a288[_0x15ba39(0xbbf)]===_0x15ba39(0x295))_0x172223=_0x15ba39(0x6a4)+_0x53a288[_0x15ba39(0x1109)]+'\x27]';else typeof _0x172223!==_0x15ba39(0x158f)&&(_0x172223='[发送了一条复杂消息，如卡片或转账]');}return{'role':_0x15ba39(0x6d6),'content':_0x3f78c5+':\x20'+_0x172223};})];try{const _0x59efa0=[{'role':_0x3baecb(0x6d6),'content':_0xf4552e}];let _0x1b2f00=_0x142c9===GEMINI_API_URL,_0x55eaa0=_0x3914a6(_0x21aa43,_0x3e58a4,_0xf4552e,_0x59efa0);const _0x2a0bde=_0x1b2f00?await fetch(_0x55eaa0['url'],_0x55eaa0[_0x3baecb(0x55b)]):await fetch(_0x142c9+'/v1/chat/completions',{'method':_0x3baecb(0x953),'headers':{'Content-Type':'application/json','Authorization':_0x3baecb(0xcee)+_0x3e58a4},'body':JSON['stringify']({'model':_0x21aa43,'messages':_0x59efa0,'temperature':_0x4c8b14[_0x3baecb(0x14f1)][_0x3baecb(0x216)]||0.9})});if(!_0x2a0bde['ok'])throw new Error((await _0x2a0bde[_0x3baecb(0x15d3)]())['error']['message']);const _0x11b3ae=await _0x2a0bde[_0x3baecb(0x15d3)](),_0x1a5f4a=_0x1b2f00?_0x11b3ae['candidates'][0x0][_0x3baecb(0x1109)][_0x3baecb(0x162d)][0x0][_0x3baecb(0x117f)]:_0x11b3ae[_0x3baecb(0xf7c)][0x0][_0x3baecb(0x6e2)][_0x3baecb(0x1109)],_0x4bfd29=_0x57a22a(_0x1a5f4a);if(!_0x4bfd29||_0x4bfd29[_0x3baecb(0x8d6)]===0x0){console['warn'](_0x3baecb(0x167f)+_0x53fb8b[_0x3baecb(0xf3e)]+_0x3baecb(0x10b7));return;}let _0x23962a=Date[_0x3baecb(0xecd)](),_0x49266f=![],_0x5c068d='',_0x30e688='';const _0x20ca10=[];for(const _0x1fddfd of _0x4bfd29){const _0x734778=String(_0x1fddfd[_0x3baecb(0x1109)]||''),_0xa71e87=_0x734778[_0x3baecb(0xb8f)]()['startsWith']('<')&&_0x734778[_0x3baecb(0xb8f)]()['endsWith']('>');if(_0x1fddfd[_0x3baecb(0xbbf)]===_0x3baecb(0x117f)&&!_0xa71e87&&_0x734778[_0x3baecb(0xd1b)]('\x0a')){const _0x2ad980=_0x734778[_0x3baecb(0x5ad)](/\n+/)[_0x3baecb(0x29d)](_0xb3cf9a=>_0xb3cf9a[_0x3baecb(0xb8f)]());_0x2ad980['forEach'](_0x4ee1db=>{const _0x357d90=_0x3baecb;_0x20ca10[_0x357d90(0x6bb)]({..._0x1fddfd,'content':_0x4ee1db});});}else _0x20ca10[_0x3baecb(0x6bb)](_0x1fddfd);}for(const _0x13cf0c of _0x20ca10){if(!_0x13cf0c||!_0x13cf0c[_0x3baecb(0xbbf)]||!_0x13cf0c[_0x3baecb(0xf3e)])continue;const _0x119aaf=_0x288d80(_0x53fb8b,_0x13cf0c[_0x3baecb(0xf3e)]);let _0x3a49e4=null,_0x4c9149=null;const _0x3877f2={'role':_0x3baecb(0x4fd),'senderName':_0x13cf0c['name'],'timestamp':_0x23962a++};if(_0x13cf0c[_0x3baecb(0xbbf)]===_0x3baecb(0x35b)){const _0x3e0558=_0x53fb8b[_0x3baecb(0x92c)][_0x3baecb(0x821)](_0x36dfe9=>_0x36dfe9[_0x3baecb(0x287)]===_0x13cf0c[_0x3baecb(0xa89)]);if(_0x3e0558&&!_0x3e0558[_0x3baecb(0x1023)]&&!(_0x3e0558[_0x3baecb(0x1360)]&&_0x3e0558[_0x3baecb(0x1360)][_0x13cf0c[_0x3baecb(0xf3e)]])){let _0x561943=0x0;const _0x1279de=_0x3e0558[_0x3baecb(0xff7)]-Object[_0x3baecb(0x40a)](_0x3e0558[_0x3baecb(0x1360)]||{})[_0x3baecb(0x439)]((_0x597c80,_0x5a73d6)=>_0x597c80+_0x5a73d6,0x0),_0x5624e0=_0x3e0558['count']-Object['keys'](_0x3e0558[_0x3baecb(0x1360)]||{})[_0x3baecb(0x8d6)];if(_0x5624e0>0x0){if(_0x3e0558[_0x3baecb(0x1015)]===_0x3baecb(0xfd0))_0x561943=_0x3e0558[_0x3baecb(0xff7)];else{if(_0x3e0558['unclaimedAmounts']&&_0x3e0558['unclaimedAmounts'][_0x3baecb(0x8d6)]>0x0)_0x561943=_0x3e0558[_0x3baecb(0x6a7)][_0x3baecb(0x5ac)]();else{console[_0x3baecb(0x75e)](_0x3baecb(0x6cb));const _0x4acb07=_0x3e0558[_0x3baecb(0xff7)]-Object[_0x3baecb(0x40a)](_0x3e0558['claimedBy']||{})['reduce']((_0x49e5ca,_0x242d17)=>_0x49e5ca+_0x242d17,0x0);if(_0x5624e0===0x1)_0x561943=_0x4acb07;else{const _0x4471a7=0.01,_0x93a457=_0x4acb07-(_0x5624e0-0x1)*_0x4471a7;_0x561943=Math[_0x3baecb(0x12bc)]()*(_0x93a457-_0x4471a7)+_0x4471a7;}}}_0x561943=parseFloat(_0x561943[_0x3baecb(0x2ea)](0x2));if(!_0x3e0558[_0x3baecb(0x1360)])_0x3e0558[_0x3baecb(0x1360)]={};_0x3e0558[_0x3baecb(0x1360)][_0x13cf0c[_0x3baecb(0xf3e)]]=_0x561943,_0x53fb8b[_0x3baecb(0x92c)]['push']({'role':'system','type':_0x3baecb(0xaa4),'content':_0x119aaf+_0x3baecb(0x3e4)+_0x288d80(_0x53fb8b,_0x3e0558[_0x3baecb(0x3e7)])+'\x20的红包','timestamp':_0x23962a++});let _0x24bb10='[系统提示：你\x20('+_0x119aaf+_0x3baecb(0xd11)+_0x561943[_0x3baecb(0x2ea)](0x2)+_0x3baecb(0xe1e);if(_0x3e0558[_0x3baecb(0x6a7)]&&_0x3e0558[_0x3baecb(0x6a7)]['length']===0x0||Object['keys'](_0x3e0558['claimedBy'])[_0x3baecb(0x8d6)]>=_0x3e0558[_0x3baecb(0xcbc)]){_0x3e0558['isFullyClaimed']=!![],_0x53fb8b[_0x3baecb(0x92c)][_0x3baecb(0x6bb)]({'role':'system','type':_0x3baecb(0xaa4),'content':_0x288d80(_0x53fb8b,_0x3e0558[_0x3baecb(0x3e7)])+'\x20的红包已被领完','timestamp':_0x23962a++});let _0xc70145={'name':'','amount':-0x1};Object[_0x3baecb(0x9de)](_0x3e0558[_0x3baecb(0x1360)])['forEach'](([_0x382268,_0x4a0a4a])=>{const _0x7d9f40=_0x3baecb;_0x4a0a4a>_0xc70145[_0x7d9f40(0x12e7)]&&(_0xc70145={'name':_0x382268,'amount':_0x4a0a4a});});if(_0xc70145[_0x3baecb(0xf3e)]){const _0x14a181=_0x288d80(_0x53fb8b,_0xc70145[_0x3baecb(0xf3e)]);_0x24bb10+='\x20红包已被领完，手气王是\x20'+_0x14a181+'！';}}_0x24bb10+='\x20请根据这个结果发表你的评论。]',_0x53fb8b[_0x3baecb(0x92c)][_0x3baecb(0x6bb)]({'role':_0x3baecb(0xaf6),'content':_0x24bb10,'timestamp':_0x23962a++,'isHidden':!![]});}}_0x49266f=!![];continue;}switch(_0x13cf0c['type']){case _0x3baecb(0x788):{let _0x6a7920=null;if(msgData['target_content'])_0x6a7920=[..._0x53fb8b[_0x3baecb(0x92c)]]['reverse']()[_0x3baecb(0x821)](_0xdf3a2f=>!_0xdf3a2f[_0x3baecb(0x118c)]&&(_0xdf3a2f[_0x3baecb(0x1109)]===msgData['target_content']||typeof _0xdf3a2f[_0x3baecb(0x1109)]===_0x3baecb(0x158f)&&_0xdf3a2f['content'][_0x3baecb(0xb8f)]()===msgData[_0x3baecb(0x2d2)][_0x3baecb(0xb8f)]())),!_0x6a7920&&console[_0x3baecb(0x75e)](_0x3baecb(0x3e0)+msgData[_0x3baecb(0xf3e)]+_0x3baecb(0x1246)+(msgData[_0x3baecb(0x2d2)]||'')[_0x3baecb(0x371)](0x0,0x14)+'...\x22，但在本轮历史中未找到。');else msgData[_0x3baecb(0x396)]&&(_0x6a7920=_0x53fb8b[_0x3baecb(0x92c)][_0x3baecb(0x821)](_0x3a07ea=>_0x3a07ea[_0x3baecb(0x287)]===msgData['target_timestamp']));if(_0x6a7920){let _0x27bcdb;_0x6a7920[_0x3baecb(0x71a)]==='user'?_0x27bcdb=_0x53fb8b['settings'][_0x3baecb(0x14a8)]||'我':_0x53fb8b['isGroup']?_0x27bcdb=_0x288d80(_0x53fb8b,_0x6a7920['senderName']):_0x27bcdb=_0x53fb8b[_0x3baecb(0xf3e)];const _0xad5763={'timestamp':_0x6a7920[_0x3baecb(0x287)],'senderName':_0x27bcdb,'content':String(_0x6a7920[_0x3baecb(0x1109)]||'')['substring'](0x0,0x32)};_0x4c9149={..._0x3877f2,'content':msgData['reply_content'],'quote':_0xad5763};}else console[_0x3baecb(0x75e)](_0x3baecb(0x11a6)+msgData[_0x3baecb(0x2d2)]+_0x3baecb(0x81d)+msgData[_0x3baecb(0x396)]+')'),_0x4c9149={..._0x3877f2,'content':msgData[_0x3baecb(0x103e)]};break;}case'sticker':if(_0x13cf0c[_0x3baecb(0xca4)]){const _0x525bf0=findBestStickerMatch(_0x13cf0c['meaning'],_0x4c8b14[_0x3baecb(0x120c)]);_0x525bf0?_0x4c9149={..._0x3877f2,'type':_0x3baecb(0x12c2),'content':_0x525bf0[_0x3baecb(0x299)],'meaning':_0x525bf0[_0x3baecb(0xf3e)]}:(console[_0x3baecb(0x75e)]('AI\x20(群聊后台)\x20尝试使用一个不存在的表情:\x20\x22'+_0x13cf0c[_0x3baecb(0xca4)]+'\x22'),_0x4c9149=null);}else console[_0x3baecb(0x75e)]('AI\x20(群聊后台)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。',_0x13cf0c),_0x4c9149={..._0x3877f2,'type':_0x3baecb(0x12c2),'content':_0x13cf0c[_0x3baecb(0x299)],'meaning':_0x3baecb(0x44d)};break;case _0x3baecb(0x1353):const _0x567f6e={'type':_0x13cf0c['postType']||_0x3baecb(0x73a),'content':_0x13cf0c[_0x3baecb(0x1109)],'timestamp':Date['now'](),'authorId':_0x4c8b14[_0x3baecb(0xbea)][Object[_0x3baecb(0x1161)](_0x4c8b14[_0x3baecb(0xbea)])[_0x3baecb(0x821)](_0x2b6d1a=>_0x4c8b14['chats'][_0x2b6d1a][_0x3baecb(0xdcf)]===_0x13cf0c[_0x3baecb(0xf3e)])]?.['id']||_0x13cf0c[_0x3baecb(0xf3e)],'authorOriginalName':_0x13cf0c['name'],'visibleGroupIds':null};await _0x54c587[_0x3baecb(0xba7)][_0x3baecb(0x12b6)](_0x567f6e),_0x13e35a(_0x582d69+0x1),_0x3a49e4={'content':'['+_0x119aaf+_0x3baecb(0x809)};break;case _0x3baecb(0x2e2):const _0x78fc68=await _0x54c587[_0x3baecb(0xba7)]['get'](parseInt(_0x13cf0c[_0x3baecb(0x2b7)]));if(_0x78fc68){if(!_0x78fc68[_0x3baecb(0xf8f)])_0x78fc68['comments']=[];_0x78fc68[_0x3baecb(0xf8f)]['push']({'commenterName':_0x13cf0c['name'],'text':_0x13cf0c[_0x3baecb(0x555)],'timestamp':Date[_0x3baecb(0xecd)]()}),await _0x54c587['qzonePosts'][_0x3baecb(0x126d)](_0x78fc68['id'],{'comments':_0x78fc68[_0x3baecb(0xf8f)]}),_0x13e35a(_0x582d69+0x1),_0x3a49e4={'content':'['+_0x119aaf+_0x3baecb(0x9bf)};}break;case _0x3baecb(0x8dd):const _0x3edb0e=await _0x54c587['qzonePosts'][_0x3baecb(0xf48)](parseInt(_0x13cf0c[_0x3baecb(0x2b7)]));if(_0x3edb0e){if(!_0x3edb0e[_0x3baecb(0xe30)])_0x3edb0e[_0x3baecb(0xe30)]=[];!_0x3edb0e['likes']['includes'](_0x13cf0c[_0x3baecb(0xf3e)])&&(_0x3edb0e['likes'][_0x3baecb(0x6bb)](_0x13cf0c[_0x3baecb(0xf3e)]),await _0x54c587['qzonePosts']['update'](_0x3edb0e['id'],{'likes':_0x3edb0e[_0x3baecb(0xe30)]}),_0x13e35a(_0x582d69+0x1),_0x3a49e4={'content':'['+_0x119aaf+_0x3baecb(0x3be)});}break;case _0x3baecb(0xea7):_0x4c9149={..._0x3877f2,'type':'ai_image','content':_0x13cf0c['description'],'image_prompt':msgData[_0x3baecb(0xff9)]};break;default:if(_0x13cf0c['type']==='poll'){const _0x3ae7d2=typeof _0x13cf0c[_0x3baecb(0x48e)]==='string'?_0x13cf0c[_0x3baecb(0x48e)][_0x3baecb(0x5ad)]('\x0a')[_0x3baecb(0x29d)](_0x3d5be3=>_0x3d5be3['trim']()):Array[_0x3baecb(0x16a1)](_0x13cf0c[_0x3baecb(0x48e)])?_0x13cf0c[_0x3baecb(0x48e)]:[];if(_0x3ae7d2[_0x3baecb(0x8d6)]<0x2)continue;_0x4c9149={..._0x3877f2,..._0x13cf0c,'options':_0x3ae7d2,'votes':{},'isClosed':![]};}else{const _0xfea5cf=_0x13cf0c[_0x3baecb(0x1109)]||_0x13cf0c[_0x3baecb(0x6e2)];_0x4c9149={..._0x3877f2,..._0x13cf0c};if(_0xfea5cf)_0x4c9149[_0x3baecb(0x1109)]=_0xfea5cf;}break;}if(_0x3a49e4)_0x53fb8b[_0x3baecb(0x92c)][_0x3baecb(0x6bb)]({'role':_0x3baecb(0xaf6),'type':_0x3baecb(0xaa4),'content':_0x3a49e4['content'],'timestamp':_0x23962a++});else _0x4c9149&&(_0x53fb8b[_0x3baecb(0x92c)][_0x3baecb(0x6bb)](_0x4c9149),!_0x30e688&&(_0x30e688=_0x119aaf,_0x5c068d=_0x4c9149[_0x3baecb(0xbbf)]===_0x3baecb(0xea7)?_0x3baecb(0x5d3):_0x4c9149['content']||'['+_0x4c9149['type']+']'));_0x49266f=!![];}_0x49266f&&(_0x53fb8b[_0x3baecb(0xc67)]=Date['now'](),_0x53fb8b[_0x3baecb(0x73c)]=(_0x53fb8b[_0x3baecb(0x73c)]||0x0)+_0x4bfd29['filter'](_0x13d904=>_0x13d904['type']!==_0x3baecb(0x1353)&&_0x13d904[_0x3baecb(0xbbf)]!==_0x3baecb(0x2e2)&&_0x13d904[_0x3baecb(0xbbf)]!==_0x3baecb(0x8dd))[_0x3baecb(0x8d6)],_0x30e688&&_0x5c068d&&_0x301fc2(_0x1f75ca,_0x30e688+':\x20'+_0x5c068d),await _0x54c587[_0x3baecb(0xbea)][_0x3baecb(0x4cb)](_0x53fb8b));}catch(_0x229616){console[_0x3baecb(0x5d7)](_0x3baecb(0x167f)+_0x53fb8b[_0x3baecb(0xf3e)]+_0x3baecb(0x553),_0x229616);}finally{_0x41b828();}}function _0x701933(_0xcd5398,_0x45a744,_0x2417a7){const _0x338b76=_0x239c7d,_0x4bce34=document[_0x338b76(0x400)](_0x2417a7);if(!_0x4bce34)return;if(!_0xcd5398||_0xcd5398[_0x338b76(0xb8f)]()===''){_0x4bce34['innerHTML']='';return;}const _0x2e89a9=_0xcd5398['replace'](/\s*\.message-bubble\.user\s+([^{]+\{)/g,_0x45a744+_0x338b76(0x108b))['replace'](/\s*\.message-bubble\.ai\s+([^{]+\{)/g,_0x45a744+_0x338b76(0x1664))[_0x338b76(0xe19)](/\s*\.message-bubble\s+([^{]+\{)/g,_0x45a744+_0x338b76(0xcb5));_0x4bce34['innerHTML']=_0x2e89a9;}async function _0x290380(){const _0x1b190a=_0x239c7d;if(!_0x4c8b14['activeChatId'])return;const _0x3c0515=_0x4c8b14['chats'][_0x4c8b14[_0x1b190a(0x1539)]],_0x5c230e=document[_0x1b190a(0x400)](_0x1b190a(0xcd6));if(!_0x5c230e)return;const _0x2c6795=document[_0x1b190a(0x13ef)](_0x1b190a(0xafe))?.[_0x1b190a(0xa1e)]||_0x1b190a(0x855),_0x20ef0f=document['getElementById'](_0x1b190a(0x100e))[_0x1b190a(0xa1e)],_0xb3ef98=document['getElementById']('custom-css-input')['value'],_0x4d9ac0=_0x3c0515[_0x1b190a(0xa37)][_0x1b190a(0x81e)];_0x5c230e[_0x1b190a(0xd61)][_0x1b190a(0xa33)]=_0x2c6795,_0x5c230e[_0x1b190a(0xa00)][_0x1b190a(0x132a)](_0x1b190a(0x82b),_0x20ef0f+'px');_0x4d9ac0&&_0x4d9ac0[_0x1b190a(0xbb9)](_0x1b190a(0x306))?(_0x5c230e[_0x1b190a(0xa00)][_0x1b190a(0xf11)]=_0x1b190a(0xe21)+_0x4d9ac0+')',_0x5c230e['style']['backgroundColor']='transparent'):(_0x5c230e[_0x1b190a(0xa00)][_0x1b190a(0xf11)]='none',_0x5c230e[_0x1b190a(0xa00)]['background']=_0x4d9ac0||_0x1b190a(0x126f));_0x5c230e['innerHTML']='';const _0x1a673a={'role':'ai','content':'对方消息预览','timestamp':0x1,'senderName':_0x3c0515['name']},_0xe4c168=await _0x43c5e5(_0x1a673a,_0x3c0515);if(_0xe4c168)_0x5c230e[_0x1b190a(0x8f2)](_0xe4c168);const _0x107eb7={'role':'user','content':_0x1b190a(0x10de),'timestamp':0x2},_0x6b7378=await _0x43c5e5(_0x107eb7,_0x3c0515);if(_0x6b7378)_0x5c230e['appendChild'](_0x6b7378);const _0x5c3fd2=document['createElement']('div');_0x5c3fd2[_0x1b190a(0xa00)][_0x1b190a(0x32e)]=_0x1b190a(0x11ca),_0x5c3fd2[_0x1b190a(0xde7)]=_0x1b190a(0x1686),_0x5c230e[_0x1b190a(0x8f2)](_0x5c3fd2);const _0x28fa61=document[_0x1b190a(0x400)](_0x1b190a(0x14f4))[_0x1b190a(0xa1e)],_0xf60eee=document[_0x1b190a(0x400)](_0x1b190a(0x1067))[_0x1b190a(0xa1e)],_0x44cecf=parseInt(document[_0x1b190a(0x400)](_0x1b190a(0x674))[_0x1b190a(0xa1e)])||0xa;_0x28fa61===_0x1b190a(0x899)?_0x5c3fd2[_0x1b190a(0xa00)]['top']=_0x44cecf+'px':_0x5c3fd2[_0x1b190a(0xa00)][_0x1b190a(0xa69)]=_0x44cecf+'px';switch(_0xf60eee){case _0x1b190a(0xfef):_0x5c3fd2[_0x1b190a(0xa00)][_0x1b190a(0xfef)]=_0x1b190a(0x137f);break;case'right':_0x5c3fd2[_0x1b190a(0xa00)]['right']=_0x1b190a(0x137f);break;default:_0x5c3fd2['style'][_0x1b190a(0xfef)]=_0x1b190a(0x700),_0x5c3fd2[_0x1b190a(0xa00)][_0x1b190a(0x8ea)]=_0x1b190a(0x330);break;}_0x701933(_0xb3ef98,'#settings-preview-area',_0x1b190a(0x14e5));}async function _0x2fde65(){const _0x46282f=_0x239c7d;await _0x227244(),document[_0x46282f(0x400)](_0x46282f(0x367))['classList'][_0x46282f(0x12b6)](_0x46282f(0x9eb));}async function _0x227244(){const _0x1f629a=_0x239c7d,_0x281424=document[_0x1f629a(0x400)]('existing-groups-list'),_0x59ffc5=await _0x54c587[_0x1f629a(0x15e8)][_0x1f629a(0xce1)]();_0x281424[_0x1f629a(0x1575)]='',_0x59ffc5[_0x1f629a(0x8d6)]===0x0&&(_0x281424[_0x1f629a(0x1575)]=_0x1f629a(0xe8f)),_0x59ffc5[_0x1f629a(0xbdc)](_0x5d96eb=>{const _0x49e1b4=_0x1f629a,_0x438063=document[_0x49e1b4(0x2c9)](_0x49e1b4(0xf8e));_0x438063['className']=_0x49e1b4(0xf94),_0x438063[_0x49e1b4(0x1575)]=_0x49e1b4(0x5e7)+_0x5d96eb[_0x49e1b4(0xf3e)]+_0x49e1b4(0x2a1)+_0x5d96eb['id']+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x281424[_0x49e1b4(0x8f2)](_0x438063);});}async function _0x21d224(){const _0x1b0475=_0x239c7d,_0x46b19f=document[_0x1b0475(0x400)](_0x1b0475(0x1223)),_0x3d0dfa=_0x46b19f[_0x1b0475(0xa1e)][_0x1b0475(0xb8f)]();if(!_0x3d0dfa){alert(_0x1b0475(0x1601));return;}const _0x251979=await _0x54c587[_0x1b0475(0x15e8)][_0x1b0475(0x227)](_0x1b0475(0xf3e))[_0x1b0475(0x4ce)](_0x3d0dfa)[_0x1b0475(0x149c)]();if(_0x251979){alert(_0x1b0475(0x5bd)+_0x3d0dfa+_0x1b0475(0x376));return;}await _0x54c587[_0x1b0475(0x15e8)][_0x1b0475(0x12b6)]({'name':_0x3d0dfa}),_0x46b19f[_0x1b0475(0xa1e)]='',await _0x227244();}async function _0x2ff6e5(_0x5f00a8){const _0x8c68db=_0x239c7d,_0x4f7b8d=await _0x56d4d3(_0x8c68db(0x713),_0x8c68db(0x16a5),{'confirmButtonClass':_0x8c68db(0x142c)});if(_0x4f7b8d){await _0x54c587['qzoneGroups']['delete'](_0x5f00a8);const _0x2e7bee=await _0x54c587[_0x8c68db(0xbea)][_0x8c68db(0x227)](_0x8c68db(0x1145))['equals'](_0x5f00a8)[_0x8c68db(0xce1)]();for(const _0x573c04 of _0x2e7bee){_0x573c04[_0x8c68db(0x1145)]=null,await _0x54c587[_0x8c68db(0xbea)][_0x8c68db(0x4cb)](_0x573c04);if(_0x4c8b14[_0x8c68db(0xbea)][_0x573c04['id']])_0x4c8b14['chats'][_0x573c04['id']][_0x8c68db(0x1145)]=null;}await _0x227244();}}function _0x3e5c89(_0x5d9063){const _0x55500f=_0x239c7d,_0x1e185=_0x4c8b14[_0x55500f(0xbea)][_0x4c8b14['activeChatId']];document[_0x55500f(0x400)](_0x55500f(0xfc0))[_0x55500f(0xa00)][_0x55500f(0xb1a)]=_0x1e185[_0x55500f(0xc98)]?'block':'none';if(_0x51034e)return;_0x465ba7=_0x5d9063,document[_0x55500f(0x400)](_0x55500f(0xb93))['classList'][_0x55500f(0x12b6)](_0x55500f(0x9eb));}function _0x4f08fc(){const _0x523e22=_0x239c7d;document[_0x523e22(0x400)](_0x523e22(0xb93))[_0x523e22(0xb08)][_0x523e22(0xc46)](_0x523e22(0x9eb)),_0x465ba7=null;}async function _0x11553d(){const _0x2c1de5=_0x239c7d;if(!_0x465ba7)return;const _0x33446e=_0x465ba7,_0xdba54f=_0x4c8b14[_0x2c1de5(0xbea)][_0x4c8b14[_0x2c1de5(0x1539)]],_0x1a0c61=_0xdba54f[_0x2c1de5(0x92c)][_0x2c1de5(0x821)](_0x371633=>_0x371633[_0x2c1de5(0x287)]===_0x33446e);if(!_0x1a0c61)return;_0x4f08fc();let _0x43b3fc;const _0x53568e=_0x1a0c61[_0x2c1de5(0xbbf)]&&[_0x2c1de5(0x295),_0x2c1de5(0xea7),_0x2c1de5(0x112f),'share_link'][_0x2c1de5(0xd1b)](_0x1a0c61[_0x2c1de5(0xbbf)]);if(_0x53568e){let _0x107e23={'type':_0x1a0c61[_0x2c1de5(0xbbf)]};if(_0x1a0c61['type']===_0x2c1de5(0x295))_0x107e23[_0x2c1de5(0x1109)]=_0x1a0c61[_0x2c1de5(0x1109)];else{if(_0x1a0c61[_0x2c1de5(0xbbf)]===_0x2c1de5(0xea7))_0x107e23[_0x2c1de5(0x12a5)]=_0x1a0c61[_0x2c1de5(0x1109)];else{if(_0x1a0c61[_0x2c1de5(0xbbf)]===_0x2c1de5(0x112f))_0x107e23[_0x2c1de5(0x12e7)]=_0x1a0c61[_0x2c1de5(0x12e7)],_0x107e23[_0x2c1de5(0x12bb)]=_0x1a0c61[_0x2c1de5(0x12bb)];else _0x1a0c61['type']===_0x2c1de5(0x4c1)&&(_0x107e23['title']=_0x1a0c61[_0x2c1de5(0x647)],_0x107e23[_0x2c1de5(0x12a5)]=_0x1a0c61[_0x2c1de5(0x12a5)],_0x107e23['source_name']=_0x1a0c61[_0x2c1de5(0x2ca)],_0x107e23[_0x2c1de5(0x1109)]=_0x1a0c61[_0x2c1de5(0x1109)]);}}_0x43b3fc=JSON[_0x2c1de5(0xea5)](_0x107e23,null,0x2);}else typeof _0x1a0c61[_0x2c1de5(0x1109)]==='object'?_0x43b3fc=JSON[_0x2c1de5(0xea5)](_0x1a0c61[_0x2c1de5(0x1109)],null,0x2):_0x43b3fc=_0x1a0c61[_0x2c1de5(0x1109)];const _0x566efd={'voice':{'type':_0x2c1de5(0x295),'content':_0x2c1de5(0xcf2)},'image':{'type':_0x2c1de5(0xea7),'description':_0x2c1de5(0x1172)},'transfer':{'type':_0x2c1de5(0x112f),'amount':5.2,'note':_0x2c1de5(0xb9f)},'link':{'type':_0x2c1de5(0x4c1),'title':_0x2c1de5(0xfee),'description':_0x2c1de5(0xbba),'source_name':_0x2c1de5(0x3d3),'content':_0x2c1de5(0x101b)}},_0x54b4f4=_0x2c1de5(0xf63)+JSON['stringify'](_0x566efd[_0x2c1de5(0x1319)])+_0x2c1de5(0xfa9)+JSON['stringify'](_0x566efd['image'])+'\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x2c1de5(0xea5)](_0x566efd[_0x2c1de5(0x112f)])+_0x2c1de5(0x134a)+JSON[_0x2c1de5(0xea5)](_0x566efd[_0x2c1de5(0x2e4)])+_0x2c1de5(0x3b1),_0x2088a8=await _0x25f61f('编辑消息',_0x2c1de5(0xbe6),_0x43b3fc,_0x2c1de5(0x79e),_0x54b4f4);_0x2088a8!==null&&await _0x5f2f38(_0x33446e,_0x2088a8,!![]);}async function _0x1621f1(){const _0x233566=_0x239c7d;if(!_0x465ba7)return;const _0x956795=_0x4c8b14['chats'][_0x4c8b14[_0x233566(0x1539)]],_0x150b77=_0x956795['history'][_0x233566(0x821)](_0xe87ed8=>_0xe87ed8[_0x233566(0x287)]===_0x465ba7);if(!_0x150b77)return;let _0x1ee1ae;typeof _0x150b77['content']===_0x233566(0xfc4)?_0x1ee1ae=JSON[_0x233566(0xea5)](_0x150b77[_0x233566(0x1109)]):_0x1ee1ae=String(_0x150b77[_0x233566(0x1109)]);try{await navigator[_0x233566(0x8c5)][_0x233566(0xa70)](_0x1ee1ae),await _0x138765(_0x233566(0x15b5),'消息内容已复制到剪贴板。');}catch(_0xd8408e){await _0x138765(_0x233566(0x10c4),_0x233566(0x209));}_0x4f08fc();}async function _0x4ecfdc(){const _0x8b337e=_0x239c7d;if(!_0x465ba7)return;try{await navigator['clipboard']['writeText'](_0x465ba7),await _0x138765('复制成功',_0x8b337e(0x1338)+_0x465ba7+'\x20已复制到剪贴板。');}catch(_0x2d889a){await _0x138765(_0x8b337e(0x10c4),_0x8b337e(0x209));}_0x4f08fc();}function _0x64a56b(_0x3acc80=''){const _0x5d62bd=_0x239c7d,_0x3b7d62=document[_0x5d62bd(0x2c9)](_0x5d62bd(0xf8e));_0x3b7d62[_0x5d62bd(0x4e1)]=_0x5d62bd(0xf99);const _0x37c21c={'voice':{'type':'voice_message','content':_0x5d62bd(0xcf2)},'image':{'type':_0x5d62bd(0xea7),'description':_0x5d62bd(0x1172)},'transfer':{'type':_0x5d62bd(0x112f),'amount':5.2,'note':_0x5d62bd(0xb9f)},'link':{'type':_0x5d62bd(0x4c1),'title':_0x5d62bd(0xfee),'description':_0x5d62bd(0xbba),'source_name':_0x5d62bd(0x3d3),'content':_0x5d62bd(0x101b)},'offline':{'type':_0x5d62bd(0x86e),'content':_0x5d62bd(0x362)},'quote':{'type':_0x5d62bd(0x788),'target_timestamp':0x499602d2,'reply_content':'在这里输入回复内容'},'nai':{'type':_0x5d62bd(0xd3c),'prompt':'1girl,\x20best\x20quality,\x20masterpiece,\x20...'}};return _0x3b7d62[_0x5d62bd(0x1575)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>'+_0x3acc80+'</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON['stringify'](_0x37c21c[_0x5d62bd(0x1319)])+'\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x5d62bd(0xea5)](_0x37c21c[_0x5d62bd(0xf86)])+_0x5d62bd(0x14e1)+JSON[_0x5d62bd(0xea5)](_0x37c21c[_0x5d62bd(0x112f)])+_0x5d62bd(0x1512)+JSON[_0x5d62bd(0xea5)](_0x37c21c['link'])+'\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x5d62bd(0xea5)](_0x37c21c[_0x5d62bd(0x70e)])+_0x5d62bd(0xab7)+JSON['stringify'](_0x37c21c['quote'])+_0x5d62bd(0xb0c)+JSON[_0x5d62bd(0xea5)](_0x37c21c[_0x5d62bd(0x54c)])+_0x5d62bd(0xca3),_0x3b7d62[_0x5d62bd(0x13ef)](_0x5d62bd(0x9cd))[_0x5d62bd(0x501)](_0x5d62bd(0x15ad),()=>{const _0x3f3669=_0x5d62bd;document[_0x3f3669(0x527)](_0x3f3669(0x1687))[_0x3f3669(0x8d6)]>0x1?_0x3b7d62[_0x3f3669(0xc46)]():alert(_0x3f3669(0x52a));}),_0x3b7d62[_0x5d62bd(0x527)](_0x5d62bd(0xe36))[_0x5d62bd(0xbdc)](_0x192826=>{const _0x2bfcf8=_0x5d62bd;_0x192826[_0x2bfcf8(0x501)]('click',()=>{const _0x4dba29=_0x2bfcf8,_0x43ffd8=_0x192826[_0x4dba29(0xd61)][_0x4dba29(0x74d)],_0x3e72b0=_0x3b7d62[_0x4dba29(0x13ef)](_0x4dba29(0x79e));if(_0x43ffd8&&_0x3e72b0)try{const _0x3685f7=JSON['parse'](_0x43ffd8);_0x3e72b0[_0x4dba29(0xa1e)]=JSON[_0x4dba29(0xea5)](_0x3685f7,null,0x2),_0x3e72b0[_0x4dba29(0x797)]();}catch(_0x3f4f66){console['error'](_0x4dba29(0x1000),_0x3f4f66);}});}),_0x3b7d62;}async function _0x41de2a(){const _0x30114d=_0x239c7d;if(!_0x465ba7)return;const _0x3d7d32=_0x465ba7,_0x13b62f=_0x4c8b14['chats'][_0x4c8b14['activeChatId']],_0x5c31ff=_0x13b62f[_0x30114d(0x92c)][_0x30114d(0x821)](_0x242a1a=>_0x242a1a[_0x30114d(0x287)]===_0x3d7d32);if(!_0x5c31ff)return;_0x4f08fc();const _0x1d73fc=document['getElementById'](_0x30114d(0x94c)),_0x3cc914=document[_0x30114d(0x400)](_0x30114d(0x568));_0x3cc914[_0x30114d(0x1575)]='';let _0x26ee51;if(_0x5c31ff[_0x30114d(0x1406)]){const _0x44969c={'type':_0x30114d(0x788),'target_timestamp':_0x5c31ff[_0x30114d(0x1406)]['timestamp'],'reply_content':_0x5c31ff[_0x30114d(0x1109)]};_0x26ee51=JSON[_0x30114d(0xea5)](_0x44969c,null,0x2);}else{if(_0x5c31ff[_0x30114d(0xbbf)]&&[_0x30114d(0x295),'ai_image',_0x30114d(0x112f),_0x30114d(0x86e),'share_link',_0x30114d(0xd3c)][_0x30114d(0xd1b)](_0x5c31ff[_0x30114d(0xbbf)])){let _0x21ba8a={'type':_0x5c31ff[_0x30114d(0xbbf)]};if(_0x5c31ff[_0x30114d(0xbbf)]===_0x30114d(0x295))_0x21ba8a[_0x30114d(0x1109)]=_0x5c31ff['content'];else{if(_0x5c31ff[_0x30114d(0xbbf)]===_0x30114d(0xea7))_0x21ba8a[_0x30114d(0x12a5)]=_0x5c31ff[_0x30114d(0x1109)];else{if(_0x5c31ff[_0x30114d(0xbbf)]===_0x30114d(0x112f))_0x21ba8a['amount']=_0x5c31ff[_0x30114d(0x12e7)],_0x21ba8a['note']=_0x5c31ff[_0x30114d(0x12bb)];else{if(_0x5c31ff[_0x30114d(0xbbf)]===_0x30114d(0x86e))_0x5c31ff['content']?_0x21ba8a[_0x30114d(0x1109)]=_0x5c31ff['content']:(_0x21ba8a[_0x30114d(0xf2d)]=_0x5c31ff['dialogue'],_0x21ba8a[_0x30114d(0x12a5)]=_0x5c31ff['description']);else{if(_0x5c31ff['type']===_0x30114d(0x4c1))_0x21ba8a['title']=_0x5c31ff[_0x30114d(0x647)],_0x21ba8a['description']=_0x5c31ff['description'],_0x21ba8a[_0x30114d(0x2ca)]=_0x5c31ff['source_name'],_0x21ba8a[_0x30114d(0x1109)]=_0x5c31ff[_0x30114d(0x1109)];else _0x5c31ff[_0x30114d(0xbbf)]===_0x30114d(0xd3c)&&(_0x21ba8a['prompt']=_0x5c31ff['prompt'],_0x21ba8a[_0x30114d(0x551)]=_0x5c31ff[_0x30114d(0x551)]);}}}}_0x26ee51=JSON[_0x30114d(0xea5)](_0x21ba8a,null,0x2);}else{if(typeof _0x5c31ff[_0x30114d(0x1109)]===_0x30114d(0xfc4))try{let _0x23a06c=JSON[_0x30114d(0x13f7)](JSON[_0x30114d(0xea5)](_0x5c31ff['content']));Array[_0x30114d(0x16a1)](_0x23a06c)&&_0x23a06c['forEach'](_0x1eed39=>{const _0x195448=_0x30114d;_0x1eed39['type']==='image_url'&&_0x1eed39['image_url']&&_0x1eed39[_0x195448(0x164d)][_0x195448(0x299)]&&_0x1eed39[_0x195448(0x164d)][_0x195448(0x299)][_0x195448(0x8d6)]>0x1f4&&(_0x1eed39['image_url'][_0x195448(0x299)]=_0x195448(0x46f));}),_0x26ee51=JSON['stringify'](_0x23a06c,null,0x2);}catch(_0xa7e7cf){console[_0x30114d(0x75e)](_0x30114d(0xf22),_0xa7e7cf),_0x26ee51=JSON[_0x30114d(0xea5)](_0x5c31ff[_0x30114d(0x1109)],null,0x2);}else _0x26ee51=_0x5c31ff[_0x30114d(0x1109)];}}const _0x3a0953=_0x64a56b(_0x26ee51);_0x3cc914[_0x30114d(0x8f2)](_0x3a0953);const _0x3e98df=document[_0x30114d(0x400)](_0x30114d(0xc22)),_0xfb77aa=_0x3e98df[_0x30114d(0xdbc)](!![]);_0x3e98df[_0x30114d(0xa54)][_0x30114d(0xf6f)](_0xfb77aa,_0x3e98df),_0xfb77aa['addEventListener'](_0x30114d(0x15ad),()=>{const _0x390cc6=_0x30114d,_0x42854c=_0x64a56b();_0x3cc914[_0x390cc6(0x8f2)](_0x42854c),_0x42854c['querySelector'](_0x390cc6(0x79e))[_0x390cc6(0x797)]();});const _0x1922cf=document[_0x30114d(0x400)]('cancel-advanced-editor-btn'),_0x5079d3=_0x1922cf[_0x30114d(0xdbc)](!![]);_0x1922cf[_0x30114d(0xa54)][_0x30114d(0xf6f)](_0x5079d3,_0x1922cf),_0x5079d3[_0x30114d(0x501)](_0x30114d(0x15ad),()=>{const _0x52ea88=_0x30114d;_0x1d73fc['classList']['remove'](_0x52ea88(0x9eb));});const _0x2802fc=document['getElementById']('save-advanced-editor-btn'),_0x3dc80e=_0x2802fc['cloneNode'](!![]);_0x2802fc['parentNode']['replaceChild'](_0x3dc80e,_0x2802fc),_0x3dc80e[_0x30114d(0x501)](_0x30114d(0x15ad),()=>{_0x5f2f38(_0x3d7d32);}),_0x1d73fc[_0x30114d(0xb08)][_0x30114d(0x12b6)](_0x30114d(0x9eb));}async function _0x1621f1(){const _0x11c2da=_0x239c7d;if(!_0x465ba7)return;const _0x5da0de=_0x4c8b14[_0x11c2da(0xbea)][_0x4c8b14[_0x11c2da(0x1539)]],_0x2fa6fc=_0x5da0de['history']['find'](_0x3f61ec=>_0x3f61ec[_0x11c2da(0x287)]===_0x465ba7);if(!_0x2fa6fc)return;let _0x10d4b8;if(_0x2fa6fc[_0x11c2da(0xbbf)]===_0x11c2da(0x86e))_0x2fa6fc[_0x11c2da(0x1109)]?_0x10d4b8=_0x2fa6fc[_0x11c2da(0x1109)]:_0x10d4b8='「'+(_0x2fa6fc[_0x11c2da(0xf2d)]||'')+'」\x0a'+(_0x2fa6fc[_0x11c2da(0x12a5)]||'');else typeof _0x2fa6fc[_0x11c2da(0x1109)]==='object'?_0x10d4b8=JSON[_0x11c2da(0xea5)](_0x2fa6fc['content']):_0x10d4b8=String(_0x2fa6fc[_0x11c2da(0x1109)]);try{await navigator[_0x11c2da(0x8c5)][_0x11c2da(0xa70)](_0x10d4b8),await _0x138765(_0x11c2da(0x15b5),_0x11c2da(0xdb6));}catch(_0x4f6949){await _0x138765(_0x11c2da(0x10c4),'无法访问剪贴板。');}_0x4f08fc();}function _0x405778(_0x10dc83){const _0x1f9cab=_0x239c7d,_0x1732e1=_0x10dc83['trim']();if(_0x1732e1[_0x1f9cab(0xbb9)]('{')&&_0x1732e1[_0x1f9cab(0x8c7)]('}'))try{const _0x298f94=JSON[_0x1f9cab(0x13f7)](_0x1732e1);if(_0x298f94[_0x1f9cab(0xbbf)])return _0x298f94;}catch(_0x5bdab8){}if(_0x12f2a0[_0x1f9cab(0x2c0)](_0x1732e1))return{'type':'sticker','content':_0x1732e1};return{'type':'text','content':_0x1732e1};}async function _0x5f2f38(_0x1db3ca,_0x153097=null){const _0x4a0326=_0x239c7d;if(!_0x1db3ca)return;const _0x5627f7=_0x4c8b14['chats'][_0x4c8b14[_0x4a0326(0x1539)]],_0x50d841=_0x5627f7[_0x4a0326(0x92c)][_0x4a0326(0x11a4)](_0x224b07=>_0x224b07[_0x4a0326(0x287)]===_0x1db3ca);if(_0x50d841===-0x1)return;const _0x4d0121=_0x5627f7[_0x4a0326(0x92c)][_0x50d841];let _0x443f04=[];const _0x1dd201=_0x153097!==null?[_0x153097]:Array[_0x4a0326(0xdc0)](document[_0x4a0326(0x527)](_0x4a0326(0x154b)))[_0x4a0326(0xd18)](_0x5dce09=>_0x5dce09[_0x4a0326(0xa1e)]);for(const _0x368115 of _0x1dd201){if(!_0x368115[_0x4a0326(0xb8f)]())continue;const _0x494b3c=_0x405778(_0x368115[_0x4a0326(0xb8f)]()),_0x1ba106={'role':_0x4d0121[_0x4a0326(0x71a)],'senderName':_0x4d0121[_0x4a0326(0x3e7)],'timestamp':_0x4d0121[_0x4a0326(0x287)]};switch(_0x494b3c[_0x4a0326(0xbbf)]){case'text':_0x1ba106[_0x4a0326(0xbbf)]='text',_0x1ba106['content']=_0x494b3c[_0x4a0326(0x1109)];break;case _0x4a0326(0x86e):_0x1ba106['type']='offline_text';_0x494b3c['content']?_0x1ba106['content']=_0x494b3c[_0x4a0326(0x1109)]:(_0x1ba106['dialogue']=_0x494b3c['dialogue'],_0x1ba106[_0x4a0326(0x12a5)]=_0x494b3c[_0x4a0326(0x12a5)]);break;case'quote_reply':_0x1ba106[_0x4a0326(0xbbf)]=_0x4a0326(0x788),_0x1ba106[_0x4a0326(0x1109)]=_0x494b3c['reply_content'];const _0x192140=_0x5627f7[_0x4a0326(0x92c)]['find'](_0x5600fc=>_0x5600fc[_0x4a0326(0x287)]===_0x494b3c['target_timestamp']);if(_0x192140){let _0x262a6e=_0x192140[_0x4a0326(0x3e7)];_0x192140[_0x4a0326(0x71a)]===_0x4a0326(0x6d6)&&(_0x262a6e=_0x4c8b14['qzoneSettings'][_0x4a0326(0xbf3)]||_0x4a0326(0xa8f)),_0x1ba106[_0x4a0326(0x1406)]={'timestamp':_0x494b3c[_0x4a0326(0x396)],'senderName':_0x262a6e,'content':String(_0x192140[_0x4a0326(0x1109)]||'')};}else _0x1ba106['quote']={'timestamp':_0x494b3c[_0x4a0326(0x396)],'senderName':_0x4a0326(0x136a),'content':_0x4a0326(0xdbf)};break;case'voice_message':case _0x4a0326(0xea7):case _0x4a0326(0xdf3):_0x1ba106[_0x4a0326(0xbbf)]=_0x494b3c[_0x4a0326(0xbbf)],_0x1ba106[_0x4a0326(0x1109)]=_0x494b3c[_0x4a0326(0x1109)]||_0x494b3c[_0x4a0326(0x12a5)];if(_0x494b3c['meaning'])_0x1ba106['meaning']=_0x494b3c[_0x4a0326(0xca4)];break;case _0x4a0326(0xd3c):{const _0x21a5a5=_0x5627f7[_0x4a0326(0x92c)][_0x50d841];let _0x4f9f7a=_0x494b3c['prompt'],_0x5129aa=_0x494b3c[_0x4a0326(0x1436)],_0x4a4cba=_0x494b3c[_0x4a0326(0x551)],_0x364f7d=![];_0x4f9f7a&&typeof _0x4f9f7a===_0x4a0326(0x158f)&&_0x21a5a5[_0x4a0326(0x156c)]!==_0x4f9f7a?_0x364f7d=!![]:(_0x4f9f7a=_0x21a5a5[_0x4a0326(0x156c)],_0x4a4cba=_0x21a5a5[_0x4a0326(0x551)],_0x5129aa=_0x21a5a5['imageUrl']);if(_0x364f7d){await _0x138765(_0x4a0326(0x13e9),_0x4a0326(0x7a9));try{const _0x4199a6=await _0x3b71e9(_0x4f9f7a,_0x5627f7['id']);_0x5129aa=_0x4199a6['imageUrl'],_0x4a4cba=_0x4199a6[_0x4a0326(0x551)],await _0x138765('成功',_0x4a0326(0x95c));}catch(_0x2446ea){console['error'](_0x4a0326(0x774),_0x2446ea),await _0x138765(_0x4a0326(0x321),'无法重新生成图片:\x20'+_0x2446ea[_0x4a0326(0x6e2)]+'.\x20\x0a\x0a将保留旧图片，但提示词会更新。'),_0x5129aa=_0x21a5a5['imageUrl'];}}_0x1ba106[_0x4a0326(0xbbf)]=_0x4a0326(0xd3c),_0x1ba106['imageUrl']=_0x5129aa,_0x1ba106[_0x4a0326(0x156c)]=_0x4f9f7a,_0x1ba106[_0x4a0326(0x551)]=_0x4a4cba;break;}case _0x4a0326(0x12c2):{_0x1ba106[_0x4a0326(0xbbf)]=_0x4a0326(0x12c2);let _0x3ae781=![];if(_0x494b3c[_0x4a0326(0xca4)]){const _0x3ff4ae=_0x4c8b14['userStickers'][_0x4a0326(0x821)](_0x102c76=>_0x102c76[_0x4a0326(0xf3e)]===_0x494b3c['meaning']);_0x3ff4ae?(_0x1ba106[_0x4a0326(0x1109)]=_0x3ff4ae[_0x4a0326(0x299)],_0x1ba106[_0x4a0326(0xca4)]=_0x3ff4ae[_0x4a0326(0xf3e)],console[_0x4a0326(0x1e6)]('导演/编辑模式保存(Sticker):\x20使用了\x20meaning\x20查找'),_0x3ae781=!![]):(_0x1ba106['type']='text',_0x1ba106[_0x4a0326(0x1109)]=_0x4a0326(0x84c)+_0x494b3c['meaning']+']',console[_0x4a0326(0x75e)](_0x4a0326(0x13c2),_0x494b3c[_0x4a0326(0xca4)]),_0x3ae781=!![]);}if(!_0x3ae781&&_0x494b3c['url']){_0x1ba106[_0x4a0326(0x1109)]=_0x494b3c[_0x4a0326(0x299)];const _0x3237fc=_0x4c8b14['userStickers'][_0x4a0326(0x821)](_0x47235a=>_0x47235a[_0x4a0326(0x299)]===_0x494b3c['url']);if(_0x494b3c[_0x4a0326(0xca4)]&&(!_0x3237fc||_0x3237fc[_0x4a0326(0xf3e)]===_0x494b3c[_0x4a0326(0xca4)]))_0x1ba106[_0x4a0326(0xca4)]=_0x494b3c[_0x4a0326(0xca4)];else _0x3237fc?_0x1ba106['meaning']=_0x3237fc[_0x4a0326(0xf3e)]:_0x1ba106[_0x4a0326(0xca4)]=_0x4a0326(0x44d);console['log'](_0x4a0326(0x1489),_0x1ba106[_0x4a0326(0xca4)]),_0x3ae781=!![];}if(!_0x3ae781&&_0x494b3c[_0x4a0326(0x1109)]&&typeof _0x494b3c[_0x4a0326(0x1109)]===_0x4a0326(0x158f)&&_0x12f2a0[_0x4a0326(0x2c0)](_0x494b3c['content'])){_0x1ba106['content']=_0x494b3c['content'];const _0x41edbc=_0x4c8b14[_0x4a0326(0x120c)][_0x4a0326(0x821)](_0x3050ec=>_0x3050ec[_0x4a0326(0x299)]===_0x494b3c['content']);_0x1ba106[_0x4a0326(0xca4)]=_0x41edbc?_0x41edbc[_0x4a0326(0xf3e)]:_0x4a0326(0x44d),console[_0x4a0326(0x1e6)]('导演/编辑模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:',_0x1ba106[_0x4a0326(0xca4)]),_0x3ae781=!![];}if(!_0x3ae781){console[_0x4a0326(0x5d7)](_0x4a0326(0x282),_0x494b3c);continue;}break;}case _0x4a0326(0x112f):_0x1ba106[_0x4a0326(0xbbf)]='transfer',_0x1ba106[_0x4a0326(0x12e7)]=_0x494b3c[_0x4a0326(0x12e7)],_0x1ba106[_0x4a0326(0x12bb)]=_0x494b3c['note'];break;case _0x4a0326(0x4c1):_0x1ba106[_0x4a0326(0xbbf)]=_0x4a0326(0x4c1),_0x1ba106[_0x4a0326(0x647)]=_0x494b3c[_0x4a0326(0x647)],_0x1ba106['description']=_0x494b3c[_0x4a0326(0x12a5)],_0x1ba106[_0x4a0326(0x2ca)]=_0x494b3c[_0x4a0326(0x2ca)],_0x1ba106[_0x4a0326(0x1109)]=_0x494b3c[_0x4a0326(0x1109)];break;default:Object[_0x4a0326(0x697)](_0x1ba106,_0x494b3c);break;}_0x443f04[_0x4a0326(0x6bb)](_0x1ba106);}if(_0x443f04['length']===0x0){document[_0x4a0326(0x400)]('message-editor-modal')[_0x4a0326(0xb08)][_0x4a0326(0xc46)](_0x4a0326(0x9eb));return;}_0x5627f7[_0x4a0326(0x92c)][_0x4a0326(0xdcc)](_0x50d841,0x1,..._0x443f04);let _0x411b7e=_0x1db3ca;for(let _0x38b5eb=_0x50d841;_0x38b5eb<_0x5627f7['history'][_0x4a0326(0x8d6)];_0x38b5eb++){_0x5627f7[_0x4a0326(0x92c)][_0x38b5eb][_0x4a0326(0x287)]=_0x411b7e,_0x411b7e++;}await _0x54c587[_0x4a0326(0xbea)][_0x4a0326(0x4cb)](_0x5627f7),document[_0x4a0326(0x400)](_0x4a0326(0x94c))['classList'][_0x4a0326(0xc46)]('visible'),_0x26354c(_0x4c8b14[_0x4a0326(0x1539)]),await _0x138765('成功',_0x4a0326(0x10bb));}function _0xee9b39(_0x2d7ab3){const _0x35d978=_0x239c7d;_0x3ab7ea=_0x2d7ab3,document[_0x35d978(0x400)](_0x35d978(0x14ca))[_0x35d978(0xb08)][_0x35d978(0x12b6)](_0x35d978(0x9eb));}function _0x1fa1fc(){const _0x55e005=_0x239c7d;document['getElementById'](_0x55e005(0x14ca))[_0x55e005(0xb08)][_0x55e005(0xc46)]('visible'),_0x3ab7ea=null;}async function _0x3ad0d3(){const _0x42c1f2=_0x239c7d;if(!_0x3ab7ea)return;const _0x102daf=_0x3ab7ea,_0x2161f7=await _0x54c587[_0x42c1f2(0xba7)]['get'](_0x102daf);if(!_0x2161f7)return;_0x1fa1fc();let _0x3df7ba;if(_0x2161f7[_0x42c1f2(0xbbf)]===_0x42c1f2(0x73a))_0x3df7ba=_0x2161f7[_0x42c1f2(0x1109)];else{const _0x2284b6={'type':_0x2161f7['type'],'publicText':_0x2161f7['publicText']||''};if(_0x2161f7[_0x42c1f2(0xbbf)]===_0x42c1f2(0x4d3))_0x2284b6[_0x42c1f2(0x1436)]=_0x2161f7[_0x42c1f2(0x1436)],_0x2284b6[_0x42c1f2(0xe34)]=_0x2161f7['imageDescription'];else _0x2161f7[_0x42c1f2(0xbbf)]===_0x42c1f2(0x14b0)&&(_0x2284b6[_0x42c1f2(0x1012)]=_0x2161f7[_0x42c1f2(0x1012)]);_0x3df7ba=JSON[_0x42c1f2(0xea5)](_0x2284b6,null,0x2);}const _0x1bcbd0={'shuoshuo':_0x42c1f2(0x404),'image':{'type':'image_post','publicText':'','imageUrl':_0x42c1f2(0x25d),'imageDescription':''},'text_image':{'type':_0x42c1f2(0x14b0),'publicText':'','hiddenContent':''}},_0x4cfda0=_0x42c1f2(0x129b)+JSON[_0x42c1f2(0xea5)](_0x1bcbd0[_0x42c1f2(0xf86)])+_0x42c1f2(0x4ac)+JSON['stringify'](_0x1bcbd0[_0x42c1f2(0x14b0)])+_0x42c1f2(0x1e3),_0x10e51a=await _0x25f61f(_0x42c1f2(0x11cf),_0x42c1f2(0xdb1),_0x3df7ba,_0x42c1f2(0x79e),_0x4cfda0);setTimeout(()=>{const _0x110b1e=_0x42c1f2,_0xd96a8e=document[_0x110b1e(0x13ef)](_0x110b1e(0xfe2));_0xd96a8e&&_0xd96a8e[_0x110b1e(0x501)](_0x110b1e(0x15ad),()=>{const _0x1139a6=_0x110b1e,_0x55cda3=document[_0x1139a6(0x400)](_0x1139a6(0x8b4));_0x55cda3[_0x1139a6(0xa1e)]=_0x1bcbd0['shuoshuo'],_0x55cda3[_0x1139a6(0x797)]();});},0x64),_0x10e51a!==null&&await _0x42d3f9(_0x102daf,_0x10e51a);}async function _0x42d3f9(_0x4a62ca,_0x5a000e){const _0x46432d=_0x239c7d,_0x1f1614=await _0x54c587[_0x46432d(0xba7)][_0x46432d(0xf48)](_0x4a62ca);if(!_0x1f1614)return;const _0x1c362f=_0x5a000e[_0x46432d(0xb8f)]();try{const _0x57ab81=JSON[_0x46432d(0x13f7)](_0x1c362f);_0x1f1614[_0x46432d(0xbbf)]=_0x57ab81['type']||_0x46432d(0x4d3),_0x1f1614[_0x46432d(0xdb3)]=_0x57ab81[_0x46432d(0xdb3)]||'',_0x1f1614['imageUrl']=_0x57ab81[_0x46432d(0x1436)]||'',_0x1f1614[_0x46432d(0xe34)]=_0x57ab81['imageDescription']||'',_0x1f1614[_0x46432d(0x1012)]=_0x57ab81['hiddenContent']||'',_0x1f1614[_0x46432d(0x1109)]='';}catch(_0x48bca7){_0x1f1614[_0x46432d(0xbbf)]='shuoshuo',_0x1f1614[_0x46432d(0x1109)]=_0x1c362f,_0x1f1614[_0x46432d(0xdb3)]='',_0x1f1614[_0x46432d(0x1436)]='',_0x1f1614[_0x46432d(0xe34)]='',_0x1f1614[_0x46432d(0x1012)]='';}await _0x54c587[_0x46432d(0xba7)]['put'](_0x1f1614),await _0x335d36(),await _0x138765('成功',_0x46432d(0x12a8));}async function _0x1b0d66(){const _0xb01530=_0x239c7d;if(!_0x3ab7ea)return;const _0xf61785=await _0x54c587[_0xb01530(0xba7)][_0xb01530(0xf48)](_0x3ab7ea);if(!_0xf61785)return;let _0x509660=_0xf61785['content']||_0xf61785[_0xb01530(0xdb3)]||_0xf61785[_0xb01530(0x1012)]||_0xf61785[_0xb01530(0xe34)]||'（无文字内容）';try{await navigator[_0xb01530(0x8c5)][_0xb01530(0xa70)](_0x509660),await _0x138765(_0xb01530(0x15b5),_0xb01530(0xe68));}catch(_0x26b576){await _0x138765(_0xb01530(0x10c4),_0xb01530(0x209));}_0x1fa1fc();}let _0x3b3c72=new Set();async function _0xf1960(){const _0x109a9d=_0x239c7d,_0xa8fc44=await _0x14b058('创建群聊',[{'text':'创建普通群聊\x20(我参与)','value':_0x109a9d(0x41c)},{'text':_0x109a9d(0xbb8),'value':'spectator_private'},{'text':_0x109a9d(0xd78),'value':_0x109a9d(0xb9b)}]);if(_0xa8fc44===_0x109a9d(0x41c)){_0x3b3c72['clear']();const _0x363132=document['getElementById'](_0x109a9d(0x3a8)),_0x20d484=_0x363132['cloneNode'](!![]);_0x363132[_0x109a9d(0xa54)][_0x109a9d(0xf6f)](_0x20d484,_0x363132),_0x20d484[_0x109a9d(0x501)](_0x109a9d(0x15ad),_0x516c41),await _0x57f353(),_0x257d51('contact-picker-screen');}else{if(_0xa8fc44===_0x109a9d(0xb9b))_0xad6fca();else _0xa8fc44===_0x109a9d(0xcd7)&&_0x396176();}}async function _0xad6fca(){const _0x5d0486=_0x239c7d;_0x18371b='group',_0x3b3c72[_0x5d0486(0x82f)]();const _0x185900=document[_0x5d0486(0x400)](_0x5d0486(0x3a8)),_0x30e730=_0x185900[_0x5d0486(0xdbc)](!![]);_0x185900[_0x5d0486(0xa54)][_0x5d0486(0xf6f)](_0x30e730,_0x185900),_0x30e730['addEventListener']('click',_0x31bf9c),await _0x59cf7f(),_0x257d51(_0x5d0486(0xdb9));}async function _0x396176(){const _0x2455c1=_0x239c7d;_0x18371b=_0x2455c1(0x51a),_0x3b3c72[_0x2455c1(0x82f)]();const _0x1cd530=document[_0x2455c1(0x400)](_0x2455c1(0x3a8)),_0x40eb17=_0x1cd530[_0x2455c1(0xdbc)](!![]);_0x1cd530['parentNode'][_0x2455c1(0xf6f)](_0x40eb17,_0x1cd530),_0x40eb17['addEventListener'](_0x2455c1(0x15ad),_0x31bf9c),await _0x59cf7f(),_0x257d51(_0x2455c1(0xdb9));}async function _0x59cf7f(){const _0x4019d7=_0x239c7d,_0x4464ab=document['getElementById'](_0x4019d7(0x52d));_0x4464ab[_0x4019d7(0x1575)]='';const _0x59cc74=Object['values'](_0x4c8b14[_0x4019d7(0xbea)])['filter'](_0xf336da=>!_0xf336da[_0x4019d7(0xc98)]),_0x432a33=await _0x54c587[_0x4019d7(0xf9b)][_0x4019d7(0xce1)]();if(_0x59cc74[_0x4019d7(0x8d6)]===0x0&&_0x432a33['length']===0x0){_0x4464ab['innerHTML']=_0x4019d7(0x1424);return;}_0x59cc74['forEach'](_0xb25bf7=>{const _0x327678=_0x4019d7,_0xcd4f0d=document[_0x327678(0x2c9)](_0x327678(0xf8e));_0xcd4f0d['className']=_0x327678(0x1427),_0xcd4f0d['dataset'][_0x327678(0xe42)]=_0xb25bf7['id'],_0xcd4f0d[_0x327678(0x1575)]=_0x327678(0x1625)+(_0xb25bf7[_0x327678(0xa37)][_0x327678(0xb24)]||_0x91d058)+_0x327678(0x302)+_0xb25bf7[_0x327678(0xf3e)]+_0x327678(0x138a),_0x4464ab[_0x327678(0x8f2)](_0xcd4f0d);}),_0x432a33[_0x4019d7(0xbdc)](_0x67a65d=>{const _0x52d89b=_0x4019d7,_0x2a2fba=document['createElement']('div');_0x2a2fba[_0x52d89b(0x4e1)]=_0x52d89b(0x1427),_0x2a2fba['dataset'][_0x52d89b(0xe42)]=_0x67a65d['id'],_0x2a2fba[_0x52d89b(0xd61)]['isNpc']='true',_0x2a2fba[_0x52d89b(0x1575)]=_0x52d89b(0x1625)+(_0x67a65d[_0x52d89b(0xa9a)]||_0x1e2f0a)+_0x52d89b(0x302)+_0x67a65d[_0x52d89b(0xf3e)]+_0x52d89b(0x5c1),_0x4464ab[_0x52d89b(0x8f2)](_0x2a2fba);}),_0x5a41f2();}async function _0x31bf9c(){const _0x5249a5=_0x239c7d;if(_0x18371b===_0x5249a5(0x51a)&&_0x3b3c72[_0x5249a5(0x9e8)]!==0x2){alert(_0x5249a5(0x1e0));return;}if(_0x18371b===_0x5249a5(0x1377)&&_0x3b3c72['size']<0x2){alert(_0x5249a5(0x147f));return;}const _0x3ac6c9=await _0x25f61f('设置群名',_0x5249a5(0x147b),_0x5249a5(0x6d1));if(!_0x3ac6c9||!_0x3ac6c9[_0x5249a5(0xb8f)]())return;const _0x3ca32c=_0x5249a5(0x7e8)+Date['now'](),_0x6385a2=[],_0x53e9d7=await _0x54c587[_0x5249a5(0xf9b)][_0x5249a5(0xce1)]();for(const _0x1141af of _0x3b3c72){const _0x239005=document[_0x5249a5(0x13ef)](_0x5249a5(0x13f1)+_0x1141af+'\x22]')[_0x5249a5(0xd61)][_0x5249a5(0x11cb)]==='true';if(_0x239005){const _0x1db284=_0x53e9d7[_0x5249a5(0x821)](_0x29f2ce=>_0x29f2ce['id']===parseInt(_0x1141af));_0x1db284&&_0x6385a2['push']({'id':_0x5249a5(0x1530)+_0x1db284['id'],'originalName':_0x1db284['name'],'groupNickname':_0x1db284[_0x5249a5(0xf3e)],'persona':_0x1db284[_0x5249a5(0x9a2)],'avatar':_0x1db284[_0x5249a5(0xa9a)]||_0x1e2f0a,'isNpc':!![]});}else{const _0x234c2e=_0x4c8b14['chats'][_0x1141af];_0x234c2e&&_0x6385a2[_0x5249a5(0x6bb)]({'id':_0x1141af,'originalName':_0x234c2e[_0x5249a5(0xdcf)],'groupNickname':_0x234c2e[_0x5249a5(0xf3e)],'persona':_0x234c2e[_0x5249a5(0xa37)][_0x5249a5(0xfea)],'avatar':_0x234c2e[_0x5249a5(0xa37)][_0x5249a5(0xb24)]||_0x91d058,'isNpc':![]});}}const _0x4f648a={'id':_0x3ca32c,'name':_0x3ac6c9[_0x5249a5(0xb8f)](),'isGroup':!![],'isSpectatorGroup':!![],'members':_0x6385a2,'settings':{'maxMemory':0xa,'groupAvatar':_0x4713e3,'background':'','theme':'default','fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[{'role':_0x5249a5(0xaf6),'content':'[系统指令：这是一个没有用户参与的群聊，请你们根据各自的人设自由地开始对话。]','timestamp':Date['now'](),'isHidden':!![]}],'musicData':{'totalTime':0x0}};_0x4c8b14[_0x5249a5(0xbea)][_0x3ca32c]=_0x4f648a,await _0x54c587['chats']['put'](_0x4f648a),await _0x41b828(),_0x257d51(_0x5249a5(0x9a4)),_0xdcfd59(_0x3ca32c);}async function _0x57f353(){const _0x3e0c44=_0x239c7d,_0x40a2c2=document['getElementById']('contact-picker-list');_0x40a2c2[_0x3e0c44(0x1575)]='';const _0x27ba0d=Object[_0x3e0c44(0x40a)](_0x4c8b14['chats'])[_0x3e0c44(0x29d)](_0x456570=>!_0x456570[_0x3e0c44(0xc98)]),_0x10cf5b=await _0x54c587[_0x3e0c44(0xf9b)][_0x3e0c44(0xce1)]();if(_0x27ba0d['length']===0x0&&_0x10cf5b[_0x3e0c44(0x8d6)]===0x0){_0x40a2c2[_0x3e0c44(0x1575)]=_0x3e0c44(0xb11);return;}_0x27ba0d[_0x3e0c44(0xbdc)](_0x63039c=>{const _0x570f0f=_0x3e0c44,_0x71c789=document[_0x570f0f(0x2c9)]('div');_0x71c789[_0x570f0f(0x4e1)]=_0x570f0f(0x1427),_0x71c789[_0x570f0f(0xd61)][_0x570f0f(0xe42)]=_0x63039c['id'],_0x71c789[_0x570f0f(0x1575)]=_0x570f0f(0x1625)+(_0x63039c[_0x570f0f(0xa37)]['aiAvatar']||_0x91d058)+_0x570f0f(0x302)+_0x63039c[_0x570f0f(0xf3e)]+_0x570f0f(0x138a),_0x40a2c2['appendChild'](_0x71c789);}),_0x10cf5b[_0x3e0c44(0xbdc)](_0x25b27d=>{const _0x5009f6=_0x3e0c44,_0x4a38b7=document[_0x5009f6(0x2c9)]('div');_0x4a38b7['className']='contact-picker-item',_0x4a38b7['dataset'][_0x5009f6(0xe42)]=_0x5009f6(0x1530)+_0x25b27d['id'],_0x4a38b7[_0x5009f6(0x1575)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x25b27d[_0x5009f6(0xa9a)]||_0x1e2f0a)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x25b27d[_0x5009f6(0xf3e)]+'\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x40a2c2[_0x5009f6(0x8f2)](_0x4a38b7);}),_0x5a41f2();}function _0x5a41f2(){const _0x194ecd=_0x239c7d,_0xf15e6e=document[_0x194ecd(0x400)](_0x194ecd(0x3a8));_0x18371b==='private'?(_0xf15e6e[_0x194ecd(0xde7)]=_0x194ecd(0x572)+_0x3b3c72[_0x194ecd(0x9e8)]+_0x194ecd(0xd24),_0xf15e6e[_0x194ecd(0x366)]=_0x3b3c72[_0x194ecd(0x9e8)]!==0x2):(_0xf15e6e[_0x194ecd(0xde7)]=_0x194ecd(0x572)+_0x3b3c72[_0x194ecd(0x9e8)]+')',_0xf15e6e['disabled']=_0x3b3c72[_0x194ecd(0x9e8)]<0x2);}async function _0x516c41(){const _0x22c65b=_0x239c7d;if(_0x3b3c72['size']<0x2){alert(_0x22c65b(0xa8a));return;}const _0x1bac6=await _0x25f61f(_0x22c65b(0x10e9),'请输入群聊的名字',_0x22c65b(0x14b6));if(!_0x1bac6||!_0x1bac6[_0x22c65b(0xb8f)]())return;const _0x1821a7=_0x22c65b(0x7e8)+Date[_0x22c65b(0xecd)](),_0xe2b56d=[],_0xfc6c66=await _0x54c587['npcs'][_0x22c65b(0xce1)]();for(const _0x40e9c9 of _0x3b3c72){if(_0x40e9c9[_0x22c65b(0xbb9)]('npc_')){const _0x497c11=parseInt(_0x40e9c9[_0x22c65b(0xe19)](_0x22c65b(0x1530),'')),_0x57f86b=_0xfc6c66[_0x22c65b(0x821)](_0x3abb52=>_0x3abb52['id']===_0x497c11);_0x57f86b&&_0xe2b56d[_0x22c65b(0x6bb)]({'id':_0x40e9c9,'originalName':_0x57f86b['name'],'groupNickname':_0x57f86b['name'],'persona':_0x57f86b[_0x22c65b(0x9a2)],'avatar':_0x57f86b[_0x22c65b(0xa9a)]||_0x1e2f0a,'isNpc':!![]});}else{const _0x293d37=_0x4c8b14['chats'][_0x40e9c9];_0x293d37&&_0xe2b56d[_0x22c65b(0x6bb)]({'id':_0x40e9c9,'originalName':_0x293d37[_0x22c65b(0xdcf)],'groupNickname':_0x293d37[_0x22c65b(0xf3e)],'persona':_0x293d37[_0x22c65b(0xa37)][_0x22c65b(0xfea)],'avatar':_0x293d37['settings'][_0x22c65b(0xb24)]||_0x91d058,'isNpc':![]});}}const _0x2ce854={'id':_0x1821a7,'name':_0x1bac6['trim'](),'isGroup':!![],'members':_0xe2b56d,'settings':{'myPersona':_0x22c65b(0xe86),'myNickname':'我','maxMemory':0xa,'groupAvatar':_0x4713e3,'myAvatar':_0x1f9bfa,'background':'','theme':_0x22c65b(0x855),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[],'musicData':{'totalTime':0x0}};_0x4c8b14[_0x22c65b(0xbea)][_0x1821a7]=_0x2ce854,await _0x54c587[_0x22c65b(0xbea)][_0x22c65b(0x4cb)](_0x2ce854),await _0x41b828(),_0x257d51(_0x22c65b(0x9a4)),_0xdcfd59(_0x1821a7);}function _0x1a19aa(){const _0x279681=_0x239c7d;if(!_0x4c8b14[_0x279681(0x1539)]||!_0x4c8b14[_0x279681(0xbea)][_0x4c8b14[_0x279681(0x1539)]]['isGroup'])return;_0x42ebbf(),_0x257d51(_0x279681(0x455));}function _0x42ebbf(){const _0x275df1=_0x239c7d,_0x459815=document['getElementById'](_0x275df1(0xc08)),_0x3c9ee0=_0x4c8b14[_0x275df1(0xbea)][_0x4c8b14[_0x275df1(0x1539)]];_0x459815[_0x275df1(0x1575)]='',_0x3c9ee0['members'][_0x275df1(0xbdc)](_0x5909cd=>{const _0x36e270=_0x275df1,_0x517fa0=document['createElement'](_0x36e270(0xf8e));_0x517fa0[_0x36e270(0x4e1)]='member-management-item',_0x517fa0['innerHTML']=_0x36e270(0x2a0)+_0x5909cd['avatar']+_0x36e270(0x1004)+_0x5909cd[_0x36e270(0x7ca)]+_0x36e270(0x1285)+_0x5909cd['id']+_0x36e270(0x67b),_0x459815[_0x36e270(0x8f2)](_0x517fa0);});}async function _0x16409f(_0x3793ad){const _0xe1334=_0x239c7d,_0xf38ec0=_0x4c8b14['chats'][_0x4c8b14[_0xe1334(0x1539)]],_0x38031f=_0xf38ec0[_0xe1334(0x4f8)][_0xe1334(0x11a4)](_0x590323=>_0x590323['id']===_0x3793ad);if(_0x38031f===-0x1)return;if(_0xf38ec0[_0xe1334(0x4f8)][_0xe1334(0x8d6)]<=0x2){alert(_0xe1334(0x51d));return;}const _0x2f116f=_0xf38ec0[_0xe1334(0x4f8)][_0x38031f][_0xe1334(0x7ca)],_0x31c24f=await _0x56d4d3(_0xe1334(0x4fa),_0xe1334(0x984)+_0x2f116f+_0xe1334(0x493),{'confirmButtonClass':_0xe1334(0x142c)});_0x31c24f&&(_0xf38ec0[_0xe1334(0x4f8)][_0xe1334(0xdcc)](_0x38031f,0x1),await _0x54c587['chats'][_0xe1334(0x4cb)](_0xf38ec0),_0x42ebbf(),document[_0xe1334(0x400)](_0xe1334(0x9b3))[_0xe1334(0x15ad)]());}async function _0x425c66(){const _0x1176d1=_0x239c7d,_0x1c7241=document['getElementById']('confirm-contact-picker-btn'),_0x19c893=_0x1c7241[_0x1176d1(0xdbc)](!![]);_0x1c7241[_0x1176d1(0xa54)][_0x1176d1(0xf6f)](_0x19c893,_0x1c7241),_0x19c893[_0x1176d1(0x501)](_0x1176d1(0x15ad),_0x389f0e),await _0x38fe5e(),_0x257d51('contact-picker-screen');}async function _0x38fe5e(){const _0x948f00=_0x239c7d,_0x334934=document['getElementById'](_0x948f00(0x52d));_0x334934['innerHTML']='',_0x3b3c72[_0x948f00(0x82f)]();const _0x3e50ed=_0x4c8b14[_0x948f00(0xbea)][_0x4c8b14[_0x948f00(0x1539)]],_0x5cc69c=new Set(_0x3e50ed[_0x948f00(0x4f8)][_0x948f00(0xd18)](_0x3964a9=>_0x3964a9['id'])),_0x5e153b=Object[_0x948f00(0x40a)](_0x4c8b14['chats'])[_0x948f00(0x29d)](_0x29e783=>!_0x29e783[_0x948f00(0xc98)]&&!_0x5cc69c[_0x948f00(0x3e3)](_0x29e783['id'])),_0x58d973=(await _0x54c587[_0x948f00(0xf9b)][_0x948f00(0xce1)]())[_0x948f00(0x29d)](_0x893319=>!_0x5cc69c[_0x948f00(0x3e3)](_0x948f00(0x1530)+_0x893319['id']));_0x5e153b[_0x948f00(0x8d6)]===0x0&&_0x58d973[_0x948f00(0x8d6)]===0x0?(_0x334934[_0x948f00(0x1575)]=_0x948f00(0x5b4),document[_0x948f00(0x400)](_0x948f00(0x3a8))[_0x948f00(0xa00)][_0x948f00(0xb1a)]=_0x948f00(0x165b)):(document[_0x948f00(0x400)]('confirm-contact-picker-btn')[_0x948f00(0xa00)]['display']='block',_0x5e153b[_0x948f00(0xbdc)](_0x1c2999=>{const _0x5b4d21=_0x948f00,_0x38df91=document['createElement'](_0x5b4d21(0xf8e));_0x38df91[_0x5b4d21(0x4e1)]='contact-picker-item',_0x38df91[_0x5b4d21(0xd61)][_0x5b4d21(0xe42)]=_0x1c2999['id'],_0x38df91[_0x5b4d21(0xd61)]['contactType']='character',_0x38df91[_0x5b4d21(0x1575)]=_0x5b4d21(0x15e0)+(_0x1c2999[_0x5b4d21(0xa37)][_0x5b4d21(0xb24)]||_0x91d058)+_0x5b4d21(0xdc8)+_0x1c2999['name']+'\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x334934[_0x5b4d21(0x8f2)](_0x38df91);}),_0x58d973['forEach'](_0x58aa92=>{const _0x30edd2=_0x948f00,_0x4eeb68=document[_0x30edd2(0x2c9)]('div');_0x4eeb68[_0x30edd2(0x4e1)]='contact-picker-item',_0x4eeb68[_0x30edd2(0xd61)][_0x30edd2(0xe42)]=_0x30edd2(0x1530)+_0x58aa92['id'],_0x4eeb68['dataset'][_0x30edd2(0xa14)]=_0x30edd2(0x4b5),_0x4eeb68[_0x30edd2(0xd61)][_0x30edd2(0x3f2)]=_0x58aa92['id'],_0x4eeb68[_0x30edd2(0x1575)]=_0x30edd2(0x15e0)+(_0x58aa92[_0x30edd2(0xa9a)]||_0x1e2f0a)+_0x30edd2(0xdc8)+_0x58aa92['name']+_0x30edd2(0x15ec),_0x334934[_0x30edd2(0x8f2)](_0x4eeb68);})),_0x5a41f2();}async function _0x389f0e(){const _0x3182cd=_0x239c7d;if(_0x3b3c72['size']===0x0){alert(_0x3182cd(0xc7e));return;}const _0x49dbb9=_0x4c8b14[_0x3182cd(0xbea)][_0x4c8b14[_0x3182cd(0x1539)]],_0x13f275=await _0x54c587[_0x3182cd(0xf9b)]['toArray']();for(const _0x5ee431 of _0x3b3c72){const _0x237023=document['querySelector'](_0x3182cd(0x13f1)+_0x5ee431+'\x22]');if(!_0x237023)continue;const _0x11104c=_0x237023['dataset']['contactType'];if(_0x11104c===_0x3182cd(0x2cc)){const _0x18a296=_0x4c8b14[_0x3182cd(0xbea)][_0x5ee431];_0x18a296&&_0x49dbb9[_0x3182cd(0x4f8)][_0x3182cd(0x6bb)]({'id':_0x5ee431,'originalName':_0x18a296[_0x3182cd(0xdcf)],'groupNickname':_0x18a296['name'],'persona':_0x18a296['settings'][_0x3182cd(0xfea)],'avatar':_0x18a296[_0x3182cd(0xa37)][_0x3182cd(0xb24)]||_0x91d058,'isNpc':![]});}else{if(_0x11104c==='npc'){const _0x5944de=parseInt(_0x237023[_0x3182cd(0xd61)][_0x3182cd(0x3f2)]),_0x59971d=_0x13f275['find'](_0x47efe0=>_0x47efe0['id']===_0x5944de);_0x59971d&&_0x49dbb9['members'][_0x3182cd(0x6bb)]({'id':_0x3182cd(0x1530)+_0x5944de,'originalName':_0x59971d[_0x3182cd(0xf3e)],'groupNickname':_0x59971d[_0x3182cd(0xf3e)],'persona':_0x59971d['persona'],'avatar':_0x59971d['avatar']||_0x1e2f0a,'isNpc':!![]});}}}await _0x54c587['chats'][_0x3182cd(0x4cb)](_0x49dbb9),_0x1a19aa();}function _0x253fe0(){_0x1c09b0=!![],_0x15b8e6(null);}function _0x40e3f7(_0xb0f3b7,_0x176e0e){const _0x216ece=setInterval(()=>{const _0x51448b=_0x466f,_0x4fb49c=Date[_0x51448b(0xecd)](),_0x32080b=_0x176e0e-_0x4fb49c;if(_0x32080b<0x0){clearInterval(_0x216ece),_0xb0f3b7[_0x51448b(0x1575)]=_0x51448b(0x1171);return;}const _0x1ee602=Math['floor'](_0x32080b%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x20c06b=Math[_0x51448b(0x1381)](_0x32080b%(0x3e8*0x3c)/0x3e8),_0x2adcaa=String(_0x1ee602)['padStart'](0x2,'0'),_0x1dd5ca=String(_0x20c06b)[_0x51448b(0xb7d)](0x2,'0');_0xb0f3b7[_0x51448b(0x1575)]=_0x51448b(0x165f)+_0x2adcaa[_0x51448b(0x65b)](0x0)+_0x51448b(0x963)+_0x2adcaa[_0x51448b(0x65b)](0x1)+_0x51448b(0x4eb)+_0x1dd5ca[_0x51448b(0x65b)](0x0)+'</span><span>'+_0x1dd5ca[_0x51448b(0x65b)](0x1)+_0x51448b(0x21f);},0x3e8);return _0x216ece;}function _0x508f6(){for(const _0x142c66 in _0x3dc27d){clearInterval(_0x3dc27d[_0x142c66]);}_0x3dc27d={};}async function _0x55ce33(_0x37cb6d){const _0x29c6b0=_0x239c7d,_0x1b848b=_0x4c8b14[_0x29c6b0(0xbea)][_0x4c8b14['activeChatId']];if(!_0x1b848b)return;const _0xa573fc=_0x1b848b[_0x29c6b0(0x92c)]['find'](_0x201f2b=>_0x201f2b[_0x29c6b0(0x287)]===_0x37cb6d);if(!_0xa573fc||![_0x29c6b0(0xebc),_0x29c6b0(0xa19)]['includes'](_0xa573fc[_0x29c6b0(0xbbf)])){console[_0x29c6b0(0x5d7)](_0x29c6b0(0x5fc),_0x37cb6d);return;}let _0x49eec5='';if(_0xa573fc[_0x29c6b0(0xbbf)]==='waimai_request'){let _0x214ad2;switch(_0xa573fc[_0x29c6b0(0x12c3)]){case _0x29c6b0(0x143b):const _0x522a35=_0xa573fc[_0x29c6b0(0x150a)]||'对方',_0x4587a=_0x288d80(_0x1b848b,_0x522a35);_0x214ad2='由\x20'+_0x4587a+_0x29c6b0(0x659);break;case _0x29c6b0(0x890):_0x214ad2=_0x29c6b0(0xb3a);break;default:_0x214ad2=_0x29c6b0(0x616);break;}_0x49eec5=_0x29c6b0(0xffb)+_0xa573fc[_0x29c6b0(0xff3)]+_0x29c6b0(0x9b8)+Number(_0xa573fc[_0x29c6b0(0x12e7)])[_0x29c6b0(0x2ea)](0x2)+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>状态:</strong>\x20'+_0x214ad2+_0x29c6b0(0x163a);}else{if(_0xa573fc[_0x29c6b0(0xbbf)]===_0x29c6b0(0xa19)){let _0x48be71,_0x461507;_0x1b848b[_0x29c6b0(0xc98)]?(_0x48be71=_0x288d80(_0x1b848b,_0xa573fc['senderName']),_0x461507=_0x288d80(_0x1b848b,_0xa573fc[_0x29c6b0(0xa02)])):_0xa573fc[_0x29c6b0(0x71a)]===_0x29c6b0(0x6d6)?(_0x48be71=_0x1b848b[_0x29c6b0(0xa37)][_0x29c6b0(0x14a8)]||'我',_0x461507=_0x1b848b['name']):(_0x48be71=_0x1b848b[_0x29c6b0(0xf3e)],_0x461507=_0x1b848b['settings'][_0x29c6b0(0x14a8)]||'我'),_0x49eec5=_0x29c6b0(0x1047)+_0x48be71+_0x29c6b0(0x585)+_0x461507+_0x29c6b0(0xe25)+_0xa573fc[_0x29c6b0(0xff3)]+_0x29c6b0(0x9b8)+Number(_0xa573fc[_0x29c6b0(0x12e7)])[_0x29c6b0(0x2ea)](0x2)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}await _0x138765(_0x29c6b0(0x782),_0x49eec5);}async function _0x7dbb95(_0x20ca6e,_0x128d34){const _0x5bce9d=_0x239c7d,_0x57fbeb=_0x4c8b14['chats'][_0x4c8b14[_0x5bce9d(0x1539)]];if(!_0x57fbeb)return;const _0x4e66f2=_0x57fbeb[_0x5bce9d(0x92c)]['findIndex'](_0x3747fa=>_0x3747fa[_0x5bce9d(0x287)]===_0x20ca6e);if(_0x4e66f2===-0x1)return;const _0x119c93=_0x57fbeb[_0x5bce9d(0x92c)][_0x4e66f2];_0x119c93['status']=_0x128d34;let _0x5619ba;const _0x4840a7=_0x57fbeb[_0x5bce9d(0xc98)]?_0x57fbeb[_0x5bce9d(0xa37)]['myNickname']||'我':'我';_0x128d34===_0x5bce9d(0x143b)?(_0x119c93[_0x5bce9d(0x150a)]=_0x4840a7,_0x5619ba=_0x5bce9d(0x876)+_0x4840a7+_0x5bce9d(0x151f)+_0x119c93['senderName']+_0x5bce9d(0x1029)+_0x20ca6e+_0x5bce9d(0x3b5)):_0x5619ba=_0x5bce9d(0x876)+_0x4840a7+_0x5bce9d(0xfe5)+_0x119c93[_0x5bce9d(0x3e7)]+'\x20的外卖代付请求（时间戳:\x20'+_0x20ca6e+_0x5bce9d(0xef9);const _0x37c5bf={'role':_0x5bce9d(0xaf6),'content':_0x5619ba,'timestamp':Date[_0x5bce9d(0xecd)](),'isHidden':!![]};_0x57fbeb[_0x5bce9d(0x92c)][_0x5bce9d(0x6bb)](_0x37c5bf),await _0x54c587['chats']['put'](_0x57fbeb),_0x26354c(_0x4c8b14[_0x5bce9d(0x1539)]);}let _0x4037ab={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x267ccc=null;async function _0x1f3f08(){const _0x5149ae=_0x239c7d;if(!_0x4c8b14[_0x5149ae(0x1539)]||_0x4037ab[_0x5149ae(0x11e7)]||_0x4037ab[_0x5149ae(0x3ed)])return;const _0x196dd8=_0x4c8b14[_0x5149ae(0xbea)][_0x4c8b14[_0x5149ae(0x1539)]];_0x4037ab[_0x5149ae(0x593)]=_0x196dd8[_0x5149ae(0xc98)],_0x4037ab[_0x5149ae(0x3ed)]=!![],_0x4037ab[_0x5149ae(0x8fc)]=_0x5149ae(0x6d6),_0x4037ab[_0x5149ae(0x1539)]=_0x196dd8['id'],_0x4037ab[_0x5149ae(0x1488)]=!![];_0x196dd8[_0x5149ae(0xc98)]?(document[_0x5149ae(0x400)]('outgoing-call-avatar')['src']=_0x196dd8[_0x5149ae(0xa37)][_0x5149ae(0x12d3)]||_0x1f9bfa,document['getElementById'](_0x5149ae(0xc8e))['textContent']=_0x196dd8[_0x5149ae(0xa37)][_0x5149ae(0x14a8)]||'我'):(document[_0x5149ae(0x400)](_0x5149ae(0x4bd))[_0x5149ae(0x912)]=_0x196dd8[_0x5149ae(0xa37)][_0x5149ae(0xb24)]||_0x91d058,document['getElementById'](_0x5149ae(0xc8e))[_0x5149ae(0xde7)]=_0x196dd8['name']);document[_0x5149ae(0x13ef)](_0x5149ae(0x4f1))[_0x5149ae(0xde7)]=_0x196dd8[_0x5149ae(0xc98)]?_0x5149ae(0x12b7):_0x5149ae(0x21b),_0x257d51('outgoing-call-screen');const _0xf2a602={'role':_0x5149ae(0xaf6),'content':_0x196dd8[_0x5149ae(0xc98)]?_0x5149ae(0x28e)+(_0x196dd8[_0x5149ae(0xa37)]['myNickname']||'我')+_0x5149ae(0x2c7):_0x5149ae(0x1380),'timestamp':Date[_0x5149ae(0xecd)](),'isHidden':!![]};_0x196dd8[_0x5149ae(0x92c)][_0x5149ae(0x6bb)](_0xf2a602),await _0x54c587[_0x5149ae(0xbea)][_0x5149ae(0x4cb)](_0x196dd8),await _0x58df1c();}function _0xd23e33(){const _0x1f0c9d=_0x239c7d,_0xee105e=_0x4c8b14[_0x1f0c9d(0xbea)][_0x4037ab[_0x1f0c9d(0x1539)]];if(!_0xee105e)return;_0x4037ab['isActive']=!![],_0x4037ab[_0x1f0c9d(0x3ed)]=![],_0x4037ab[_0x1f0c9d(0x79f)]=Date[_0x1f0c9d(0xecd)](),_0x4037ab[_0x1f0c9d(0x652)]=[];const _0x209c0e=_0xee105e[_0x1f0c9d(0x92c)][_0x1f0c9d(0x69f)](-0xa);_0x4037ab[_0x1f0c9d(0x101a)]=_0x209c0e[_0x1f0c9d(0xd18)](_0x4a669c=>{const _0x581a1a=_0x1f0c9d,_0x3d6eef=_0x4a669c[_0x581a1a(0x71a)]===_0x581a1a(0x6d6)?_0xee105e['settings'][_0x581a1a(0x14a8)]||'我':_0x4a669c[_0x581a1a(0x3e7)]||_0xee105e[_0x581a1a(0xf3e)];return _0x3d6eef+':\x20'+String(_0x4a669c[_0x581a1a(0x1109)])[_0x581a1a(0x371)](0x0,0x32)+_0x581a1a(0x166b);})['join']('\x0a'),_0x5d38bb(),document[_0x1f0c9d(0x400)](_0x1f0c9d(0x325))[_0x1f0c9d(0x1575)]=_0x1f0c9d(0xc7b)+(_0x4037ab[_0x1f0c9d(0x593)]?_0x1f0c9d(0xad3):_0x1f0c9d(0xf2a))+_0x1f0c9d(0x156a),_0x257d51(_0x1f0c9d(0xaac)),document[_0x1f0c9d(0x400)](_0x1f0c9d(0x1db))[_0x1f0c9d(0xa00)][_0x1f0c9d(0xb1a)]=_0x4037ab[_0x1f0c9d(0x1488)]?'block':_0x1f0c9d(0x165b),document[_0x1f0c9d(0x400)](_0x1f0c9d(0x12bd))['style']['display']=_0x4037ab[_0x1f0c9d(0x1488)]?_0x1f0c9d(0x165b):'block';if(_0x267ccc)clearInterval(_0x267ccc);_0x267ccc=setInterval(_0x17b493,0x3e8),_0x17b493(),_0x2ef86f();}function _0x446a60(){const _0x2f3fa6=_0x239c7d;if(!_0x4037ab[_0x2f3fa6(0x11e7)])return;document['getElementById'](_0x2f3fa6(0xdff))[_0x2f3fa6(0xa00)][_0x2f3fa6(0xb1a)]=_0x2f3fa6(0x375),_0x257d51('chat-interface-screen'),console[_0x2f3fa6(0x1e6)](_0x2f3fa6(0x826));}function _0x5ba02d(){const _0x496579=_0x239c7d;if(!_0x4037ab[_0x496579(0x11e7)])return;document[_0x496579(0x400)]('video-call-restore-btn')[_0x496579(0xa00)][_0x496579(0xb1a)]=_0x496579(0x165b),_0x257d51(_0x496579(0xaac)),console[_0x496579(0x1e6)](_0x496579(0xe8a));}async function _0x4e9bf7(){const _0x39fb73=_0x239c7d;if(!_0x4037ab[_0x39fb73(0x11e7)])return;document[_0x39fb73(0x400)](_0x39fb73(0xdff))[_0x39fb73(0xa00)]['display']=_0x39fb73(0x165b);const _0x2877f6=Math[_0x39fb73(0x1381)]((Date[_0x39fb73(0xecd)]()-_0x4037ab[_0x39fb73(0x79f)])/0x3e8),_0x47c18d=Math[_0x39fb73(0x1381)](_0x2877f6/0x3c)+'分'+_0x2877f6%0x3c+'秒',_0x122366=_0x39fb73(0x2dc)+_0x47c18d,_0x334cf6=_0x4c8b14['chats'][_0x4037ab['activeChatId']];if(_0x334cf6){const _0xbacfb9=[];_0x4037ab[_0x39fb73(0x593)]?(_0x4037ab[_0x39fb73(0x131d)][_0x39fb73(0xbdc)](_0x43cdcd=>_0xbacfb9['push']({'name':_0x43cdcd['originalName'],'avatar':_0x43cdcd[_0x39fb73(0xa9a)]})),_0x4037ab['isUserParticipating']&&_0xbacfb9['unshift']({'name':_0x334cf6['settings'][_0x39fb73(0x14a8)]||'我','avatar':_0x334cf6['settings'][_0x39fb73(0x12d3)]||_0x1f9bfa})):(_0xbacfb9[_0x39fb73(0x6bb)]({'name':_0x334cf6[_0x39fb73(0xf3e)],'avatar':_0x334cf6[_0x39fb73(0xa37)][_0x39fb73(0xb24)]||_0x91d058}),_0xbacfb9['unshift']({'name':'我','avatar':_0x334cf6[_0x39fb73(0xa37)][_0x39fb73(0x12d3)]||_0x91d058}));const _0x2395a4={'chatId':_0x4037ab[_0x39fb73(0x1539)],'timestamp':Date[_0x39fb73(0xecd)](),'duration':_0x2877f6,'participants':_0xbacfb9,'transcript':[..._0x4037ab[_0x39fb73(0x652)]]};await _0x54c587[_0x39fb73(0x688)]['add'](_0x2395a4),console[_0x39fb73(0x1e6)](_0x39fb73(0xa38),_0x2395a4);let _0x118f53={'role':_0x4037ab[_0x39fb73(0x8fc)]===_0x39fb73(0x6d6)?_0x39fb73(0x6d6):_0x39fb73(0x4fd),'content':_0x122366,'timestamp':Date['now']()};_0x334cf6[_0x39fb73(0xc98)]&&_0x118f53['role']==='assistant'&&(_0x118f53[_0x39fb73(0x3e7)]=_0x4037ab[_0x39fb73(0x496)]||_0x334cf6[_0x39fb73(0x4f8)][0x0]?.[_0x39fb73(0xdcf)]||_0x334cf6[_0x39fb73(0xf3e)]);_0x334cf6[_0x39fb73(0x92c)][_0x39fb73(0x6bb)](_0x118f53);const _0xe40ab9=_0x4037ab[_0x39fb73(0x652)]['map'](_0x247d8d=>{const _0x6c017e=_0x39fb73,_0x10e943=_0x247d8d['role']==='user'?_0x334cf6['settings'][_0x6c017e(0x14a8)]||'我':_0x247d8d[_0x6c017e(0x3e7)];return _0x10e943+':\x20'+_0x247d8d[_0x6c017e(0x1109)];})[_0x39fb73(0xee1)]('\x0a');_0x32e80d(_0x334cf6['id'],_0xe40ab9);const _0x449748={'role':_0x39fb73(0xaf6),'content':'[系统指令：视频通话刚刚结束。请你以角色的口吻，向用户主动发送一两条消息，来自然地总结这次通话的要点、确认达成的约定，或者表达你的感受。]','timestamp':Date['now']()+0x1,'isHidden':!![]};_0x334cf6['history'][_0x39fb73(0x6bb)](_0x449748),await _0x54c587[_0x39fb73(0xbea)][_0x39fb73(0x4cb)](_0x334cf6);}clearInterval(_0x267ccc),_0x267ccc=null,_0x4037ab={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x334cf6&&(_0xdcfd59(_0x334cf6['id']),_0x58df1c());}function _0x5d38bb(){const _0x3f203a=_0x239c7d,_0x41764e=document[_0x3f203a(0x400)](_0x3f203a(0xd2f));_0x41764e[_0x3f203a(0x1575)]='';const _0x5b0ed1=_0x4c8b14['chats'][_0x4037ab[_0x3f203a(0x1539)]];if(!_0x5b0ed1)return;let _0x281008=[];_0x4037ab[_0x3f203a(0x593)]?(_0x281008=[..._0x4037ab[_0x3f203a(0x131d)]],_0x4037ab[_0x3f203a(0x1488)]&&_0x281008[_0x3f203a(0xc36)]({'id':_0x3f203a(0x6d6),'name':_0x5b0ed1['settings']['myNickname']||'我','avatar':_0x5b0ed1[_0x3f203a(0xa37)][_0x3f203a(0x12d3)]||_0x1f9bfa})):_0x281008['push']({'id':'ai','name':_0x5b0ed1[_0x3f203a(0xf3e)],'avatar':_0x5b0ed1[_0x3f203a(0xa37)][_0x3f203a(0xb24)]||_0x91d058}),_0x281008[_0x3f203a(0xbdc)](_0x2a2711=>{const _0x23fddf=_0x3f203a,_0x596865=document[_0x23fddf(0x2c9)](_0x23fddf(0xf8e));_0x596865[_0x23fddf(0x4e1)]='participant-avatar-wrapper',_0x596865['dataset'][_0x23fddf(0x13c6)]=_0x2a2711['id'];const _0x3e2360=_0x2a2711['groupNickname']||_0x2a2711[_0x23fddf(0xf3e)];_0x596865[_0x23fddf(0x1575)]=_0x23fddf(0x146e)+_0x2a2711[_0x23fddf(0xa9a)]+_0x23fddf(0x1148)+_0x3e2360+_0x23fddf(0x60f)+_0x3e2360+_0x23fddf(0x14f0),_0x41764e[_0x23fddf(0x8f2)](_0x596865);});}function _0x58cfc8(){const _0xd30a85=_0x239c7d;if(!_0x4037ab[_0xd30a85(0x11e7)]||_0x4037ab['isUserParticipating'])return;_0x4037ab[_0xd30a85(0x1488)]=!![],_0x5d38bb(),document['getElementById'](_0xd30a85(0x1db))[_0xd30a85(0xa00)][_0xd30a85(0xb1a)]='block',document[_0xd30a85(0x400)]('join-call-btn')[_0xd30a85(0xa00)][_0xd30a85(0xb1a)]=_0xd30a85(0x165b),_0x2ef86f(_0xd30a85(0xe2d));}function _0x17b493(){const _0x72f3e4=_0x239c7d;if(!_0x4037ab[_0x72f3e4(0x11e7)])return;const _0x23fa36=Math[_0x72f3e4(0x1381)]((Date[_0x72f3e4(0xecd)]()-_0x4037ab[_0x72f3e4(0x79f)])/0x3e8),_0x9d25ba=Math[_0x72f3e4(0x1381)](_0x23fa36/0x3c),_0xc637af=_0x23fa36%0x3c;document[_0x72f3e4(0x400)]('call-timer')['textContent']=String(_0x9d25ba)[_0x72f3e4(0xb7d)](0x2,'0')+':'+String(_0xc637af)[_0x72f3e4(0xb7d)](0x2,'0');}function _0x33f076(){const _0x5aaf5c=_0x239c7d,_0x2239fe=_0x4c8b14[_0x5aaf5c(0xbea)][_0x4c8b14['activeChatId']];if(!_0x2239fe)return;if(_0x2239fe['isGroup']){const _0x103fdf=_0x4037ab[_0x5aaf5c(0x496)]||_0x2239fe[_0x5aaf5c(0x4f8)][0x0]?.[_0x5aaf5c(0xf3e)]||_0x5aaf5c(0xf6b);document['getElementById'](_0x5aaf5c(0xdba))[_0x5aaf5c(0x912)]=_0x2239fe[_0x5aaf5c(0xa37)][_0x5aaf5c(0x465)]||_0x4713e3,document['getElementById'](_0x5aaf5c(0xb2c))[_0x5aaf5c(0xde7)]=_0x2239fe['name'],document[_0x5aaf5c(0x13ef)](_0x5aaf5c(0x11fb))[_0x5aaf5c(0xde7)]=_0x103fdf+'\x20邀请你加入群视频';}else document[_0x5aaf5c(0x400)](_0x5aaf5c(0xdba))[_0x5aaf5c(0x912)]=_0x2239fe[_0x5aaf5c(0xa37)][_0x5aaf5c(0xb24)]||_0x91d058,document['getElementById'](_0x5aaf5c(0xb2c))['textContent']=_0x2239fe[_0x5aaf5c(0xf3e)],document[_0x5aaf5c(0x13ef)]('.incoming-call-content\x20.caller-text')['textContent']=_0x5aaf5c(0x97f);document['getElementById'](_0x5aaf5c(0x1043))[_0x5aaf5c(0xb08)][_0x5aaf5c(0x12b6)](_0x5aaf5c(0x9eb));}function _0x4d54df(){const _0x11c7ea=_0x239c7d;document[_0x11c7ea(0x400)](_0x11c7ea(0x1043))[_0x11c7ea(0xb08)][_0x11c7ea(0xc46)](_0x11c7ea(0x9eb));}async function _0x2ef86f(_0x2bda3f=null){const _0x6cc3b3=_0x239c7d;if(!_0x4037ab[_0x6cc3b3(0x11e7)])return;const _0x4f8bed=_0x4c8b14[_0x6cc3b3(0xbea)][_0x4037ab[_0x6cc3b3(0x1539)]],{proxyUrl:_0x48cbdc,apiKey:_0x25f05d,model:_0xa80357}=_0x4c8b14[_0x6cc3b3(0x814)],_0x3594e6=document[_0x6cc3b3(0x400)](_0x6cc3b3(0x325)),_0x55b124=_0x4f8bed[_0x6cc3b3(0xa37)][_0x6cc3b3(0x14a8)]||'我';let _0x5d051d='';if(_0x4f8bed[_0x6cc3b3(0xa37)][_0x6cc3b3(0xb0d)]&&_0x4f8bed[_0x6cc3b3(0xa37)][_0x6cc3b3(0xb0d)][_0x6cc3b3(0x8d6)]>0x0){const _0x3b1078=_0x4f8bed['settings'][_0x6cc3b3(0xb0d)][_0x6cc3b3(0xd18)](_0x442174=>{const _0x1c1da9=_0x6cc3b3,_0x23a0a8=_0x4c8b14[_0x1c1da9(0xf57)]['find'](_0x124692=>_0x124692['id']===_0x442174);return _0x23a0a8&&_0x23a0a8['content']?'\x0a\x0a##\x20世界书:\x20'+_0x23a0a8[_0x1c1da9(0xf3e)]+'\x0a'+_0x23a0a8[_0x1c1da9(0x1109)]:'';})[_0x6cc3b3(0x29d)](Boolean)['join']('');_0x3b1078&&(_0x5d051d='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x3b1078+_0x6cc3b3(0x1022));}if(_0x2bda3f&&_0x4037ab[_0x6cc3b3(0x1488)]){const _0x2c92c4=Date[_0x6cc3b3(0xecd)](),_0x4f2b24=document['createElement']('div');_0x4f2b24[_0x6cc3b3(0x4e1)]=_0x6cc3b3(0xcb1),_0x4f2b24[_0x6cc3b3(0xde7)]=_0x2bda3f,_0x4f2b24[_0x6cc3b3(0xd61)][_0x6cc3b3(0x287)]=_0x2c92c4,_0x3d4218(_0x4f2b24,()=>_0x1cf385(_0x2c92c4)),_0x3594e6[_0x6cc3b3(0x8f2)](_0x4f2b24),_0x3594e6['scrollTop']=_0x3594e6[_0x6cc3b3(0xe0d)],_0x4037ab[_0x6cc3b3(0x652)][_0x6cc3b3(0x6bb)]({'role':_0x6cc3b3(0x6d6),'content':_0x2bda3f,'timestamp':_0x2c92c4});}let _0x2f453a;if(_0x4037ab[_0x6cc3b3(0x593)]){const _0x3f2aaf=_0x4037ab[_0x6cc3b3(0x131d)]['map'](_0x151d8e=>_0x151d8e['name']);_0x4037ab[_0x6cc3b3(0x1488)]&&_0x3f2aaf['unshift'](_0x55b124),_0x2f453a=_0x6cc3b3(0x15ab)+_0x55b124+_0x6cc3b3(0x9f7)+_0x55b124+_0x6cc3b3(0xa94)+_0x4037ab[_0x6cc3b3(0x101a)]+_0x6cc3b3(0xb61)+_0x3f2aaf[_0x6cc3b3(0xee1)]('、\x20')+_0x6cc3b3(0x1264)+_0x5d051d+_0x6cc3b3(0x4f7);}else{let _0x2ceece=_0x4037ab[_0x6cc3b3(0x8fc)]===_0x6cc3b3(0x6d6)?_0x6cc3b3(0x72a):'用户刚刚接听了你主动发起的视频通话。';_0x2f453a=_0x6cc3b3(0x112e)+_0x4f8bed['name']+'\x20('+_0x4f8bed['settings'][_0x6cc3b3(0xfea)]+_0x6cc3b3(0xf07)+_0x4f8bed[_0x6cc3b3(0xf3e)]+'”。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**格式**:\x20你的回复【必须】是一段描述性的文本。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你正在和用户（'+_0x55b124+_0x6cc3b3(0x31b)+_0x4f8bed[_0x6cc3b3(0xa37)]['myPersona']+'）进行视频通话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**'+_0x2ceece+'**\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要\x20(这是你们通话的原因，至关重要！)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4037ab[_0x6cc3b3(0x101a)]+_0x6cc3b3(0x4f7);}const _0x21d22a=[{'role':_0x6cc3b3(0xaf6),'content':_0x2f453a},..._0x4037ab[_0x6cc3b3(0x652)]['map'](_0x3149b6=>({'role':_0x3149b6[_0x6cc3b3(0x71a)],'content':_0x3149b6[_0x6cc3b3(0x1109)]}))];if(_0x4037ab[_0x6cc3b3(0x652)][_0x6cc3b3(0x8d6)]===0x0){const _0xaae2e=_0x4037ab['initiator']===_0x6cc3b3(0x6d6)?'*你按下了接听键...*':'*对方按下了接听键...*';_0x21d22a[_0x6cc3b3(0x6bb)]({'role':_0x6cc3b3(0x6d6),'content':_0xaae2e});}try{let _0x48d35d=_0x48cbdc===GEMINI_API_URL,_0x411117=_0x3914a6(_0xa80357,_0x25f05d,_0x2f453a,_0x21d22a);const _0x34f03e=_0x48d35d?await fetch(_0x411117['url'],_0x411117[_0x6cc3b3(0x55b)]):await fetch(_0x48cbdc+_0x6cc3b3(0x1611),{'method':_0x6cc3b3(0x953),'headers':{'Content-Type':'application/json','Authorization':_0x6cc3b3(0xcee)+_0x25f05d},'body':JSON['stringify']({'model':_0xa80357,'messages':_0x21d22a,'temperature':_0x4c8b14[_0x6cc3b3(0x14f1)]['apiTemperature']||0.8})});if(!_0x34f03e['ok'])throw new Error((await _0x34f03e[_0x6cc3b3(0x15d3)]())[_0x6cc3b3(0x5d7)][_0x6cc3b3(0x6e2)]);const _0x19ce27=await _0x34f03e[_0x6cc3b3(0x15d3)](),_0x216734=_0x48d35d?_0x19ce27['candidates'][0x0][_0x6cc3b3(0x1109)][_0x6cc3b3(0x162d)][0x0][_0x6cc3b3(0x117f)]:_0x19ce27['choices'][0x0]['message'][_0x6cc3b3(0x1109)],_0x496845=_0x3594e6[_0x6cc3b3(0x13ef)]('em');if(_0x496845)_0x496845[_0x6cc3b3(0xc46)]();if(_0x4037ab['isGroupCall']){const _0x19aaeb=_0x57a22a(_0x216734);_0x19aaeb[_0x6cc3b3(0xbdc)](_0x586a1e=>{const _0xf697ab=_0x6cc3b3;if(!_0x586a1e[_0xf697ab(0xf3e)]||_0x586a1e[_0xf697ab(0xf3e)]===_0x55b124||!_0x586a1e[_0xf697ab(0x12ed)])return;const _0x86cdf2=Date[_0xf697ab(0xecd)]()+Math[_0xf697ab(0x12bc)](),_0x273cc6=document[_0xf697ab(0x2c9)](_0xf697ab(0xf8e));_0x273cc6[_0xf697ab(0x4e1)]='call-message-bubble\x20ai-speech',_0x273cc6[_0xf697ab(0x1575)]=_0xf697ab(0xfd7)+_0x586a1e['name']+':</strong>\x20'+_0x586a1e[_0xf697ab(0x12ed)],_0x273cc6[_0xf697ab(0xd61)][_0xf697ab(0x287)]=_0x86cdf2,_0x3d4218(_0x273cc6,()=>_0x1cf385(_0x86cdf2)),_0x3594e6['appendChild'](_0x273cc6),_0x4037ab[_0xf697ab(0x652)]['push']({'role':_0xf697ab(0x4fd),'content':_0x586a1e[_0xf697ab(0xf3e)]+':\x20'+_0x586a1e[_0xf697ab(0x12ed)],'timestamp':_0x86cdf2});const _0x1de02e=_0x4037ab[_0xf697ab(0x131d)][_0xf697ab(0x821)](_0x9b83a1=>_0x9b83a1[_0xf697ab(0xf3e)]===_0x586a1e[_0xf697ab(0xf3e)]);if(_0x1de02e){const _0xf51be=document[_0xf697ab(0x13ef)](_0xf697ab(0x621)+_0x1de02e['id']+_0xf697ab(0xd27));_0xf51be&&(_0xf51be['classList']['add'](_0xf697ab(0xecf)),setTimeout(()=>_0xf51be[_0xf697ab(0xb08)]['remove'](_0xf697ab(0xecf)),0x7d0));}});}else{const _0x537cbd=Date[_0x6cc3b3(0xecd)](),_0x19df22=document[_0x6cc3b3(0x2c9)](_0x6cc3b3(0xf8e));_0x19df22[_0x6cc3b3(0x4e1)]=_0x6cc3b3(0x712),_0x19df22[_0x6cc3b3(0xde7)]=_0x216734,_0x19df22['dataset'][_0x6cc3b3(0x287)]=_0x537cbd,_0x3d4218(_0x19df22,()=>_0x1cf385(_0x537cbd)),_0x3594e6[_0x6cc3b3(0x8f2)](_0x19df22),_0x4037ab['callHistory'][_0x6cc3b3(0x6bb)]({'role':_0x6cc3b3(0x4fd),'content':_0x216734,'timestamp':_0x537cbd});const _0x7ec3f0=document[_0x6cc3b3(0x13ef)](_0x6cc3b3(0x444));_0x7ec3f0&&(_0x7ec3f0[_0x6cc3b3(0xb08)][_0x6cc3b3(0x12b6)]('speaking'),setTimeout(()=>_0x7ec3f0['classList'][_0x6cc3b3(0xc46)](_0x6cc3b3(0xecf)),0x7d0));}_0x3594e6[_0x6cc3b3(0x125c)]=_0x3594e6['scrollHeight'];}catch(_0x2fb0a7){const _0x548769=document[_0x6cc3b3(0x2c9)]('div');_0x548769['className']=_0x6cc3b3(0x712),_0x548769['style'][_0x6cc3b3(0x168d)]=_0x6cc3b3(0x62d),_0x548769['textContent']=_0x6cc3b3(0x123e)+_0x2fb0a7[_0x6cc3b3(0x6e2)]+']',_0x3594e6[_0x6cc3b3(0x8f2)](_0x548769),_0x3594e6['scrollTop']=_0x3594e6['scrollHeight'],_0x4037ab[_0x6cc3b3(0x652)][_0x6cc3b3(0x6bb)]({'role':_0x6cc3b3(0x4fd),'content':_0x6cc3b3(0x123e)+_0x2fb0a7[_0x6cc3b3(0x6e2)]+']'});}}function _0x22ecff(_0x2cc22a){const _0x463810=_0x239c7d;document[_0x463810(0x400)](_0x463810(0xb59))['style'][_0x463810(0xb1a)]=_0x2cc22a?_0x463810(0x165b):'flex',document[_0x463810(0x400)]('group-video-call-btn')[_0x463810(0xa00)][_0x463810(0xb1a)]=_0x2cc22a?_0x463810(0x375):_0x463810(0x165b);}async function _0x7dbb95(_0x2b1885,_0x32c3ef){const _0x17b5d0=_0x239c7d,_0x1dcc00=_0x4c8b14['chats'][_0x4c8b14[_0x17b5d0(0x1539)]];if(!_0x1dcc00)return;const _0x139e46=_0x1dcc00[_0x17b5d0(0x92c)][_0x17b5d0(0x11a4)](_0x16badd=>_0x16badd[_0x17b5d0(0x287)]===_0x2b1885);if(_0x139e46===-0x1)return;const _0x23e168=_0x1dcc00[_0x17b5d0(0x92c)][_0x139e46];_0x23e168[_0x17b5d0(0x12c3)]=_0x32c3ef;let _0x3736a2;const _0x18eb4c=_0x1dcc00[_0x17b5d0(0xc98)]?_0x1dcc00['settings'][_0x17b5d0(0x14a8)]||'我':'我';_0x32c3ef===_0x17b5d0(0x143b)?(_0x23e168['paidBy']=_0x18eb4c,_0x3736a2=_0x17b5d0(0x876)+_0x18eb4c+')\x20为\x20'+_0x23e168['senderName']+_0x17b5d0(0x1029)+_0x2b1885+_0x17b5d0(0x3b5)):_0x3736a2='[系统提示：你\x20('+_0x18eb4c+_0x17b5d0(0xfe5)+_0x23e168[_0x17b5d0(0x3e7)]+_0x17b5d0(0x1014)+_0x2b1885+_0x17b5d0(0xef9);const _0xadb053={'role':_0x17b5d0(0xaf6),'content':_0x3736a2,'timestamp':Date[_0x17b5d0(0xecd)](),'isHidden':!![]};_0x1dcc00[_0x17b5d0(0x92c)]['push'](_0xadb053),await _0x54c587[_0x17b5d0(0xbea)][_0x17b5d0(0x4cb)](_0x1dcc00),_0x26354c(_0x4c8b14[_0x17b5d0(0x1539)]),_0x32c3ef===_0x17b5d0(0x143b)&&_0x58df1c();}async function _0x34b720(_0x282c97,_0x445142){const _0x50241c=_0x239c7d,_0x1c3ee0=_0x4c8b14[_0x50241c(0xbea)][_0x282c97];if(!_0x1c3ee0)return;let _0x54eb95;_0x1c3ee0[_0x50241c(0xc98)]?_0x54eb95=_0x288d80(_0x1c3ee0,_0x445142):_0x54eb95=_0x1c3ee0[_0x50241c(0xf3e)];const _0x3901bd=document['getElementById'](_0x50241c(0x43a));_0x3901bd['classList'][_0x50241c(0xc46)](_0x50241c(0x6fc)),void _0x3901bd[_0x50241c(0xeeb)],_0x3901bd[_0x50241c(0xb08)]['add'](_0x50241c(0x6fc));const _0x369d02=await _0x25f61f(_0x50241c(0x564)+_0x54eb95+'”',_0x50241c(0x7c0),'','text');if(_0x369d02===null)return;const _0x1467b6=_0x288d80(_0x1c3ee0,_0x4c8b14[_0x50241c(0x834)][_0x50241c(0xbf3)]),_0x88ca3c=_0x1467b6+_0x50241c(0xaa3)+_0x54eb95+'”\x20'+_0x369d02['trim'](),_0x49899a={'role':'system','type':_0x50241c(0xaa4),'content':_0x88ca3c,'timestamp':Date[_0x50241c(0xecd)]()};_0x1c3ee0['history'][_0x50241c(0x6bb)](_0x49899a);const _0x14029e='[系统提示：用户（'+_0x1467b6+_0x50241c(0x8a2)+_0x445142+'）'+_0x369d02['trim']()+'。请你对此作出回应。]',_0x5d7d1f={'role':_0x50241c(0xaf6),'content':_0x14029e,'timestamp':Date[_0x50241c(0xecd)]()+0x1,'isHidden':!![]};_0x1c3ee0[_0x50241c(0x92c)][_0x50241c(0x6bb)](_0x5d7d1f),await _0x54c587[_0x50241c(0xbea)][_0x50241c(0x4cb)](_0x1c3ee0),_0x4c8b14[_0x50241c(0x1539)]===_0x282c97&&_0x41ecc7(_0x49899a,_0x1c3ee0),await _0x41b828();}let _0x56721b=null,_0x258505=![],_0x165250=new Set();function _0x1cf385(_0x45ea59){const _0x250c15=_0x239c7d;_0x56721b=_0x45ea59,document[_0x250c15(0x400)](_0x250c15(0x142a))[_0x250c15(0xb08)][_0x250c15(0x12b6)]('visible');}function _0x18266c(){const _0x557650=_0x239c7d;document['getElementById'](_0x557650(0x142a))[_0x557650(0xb08)]['remove']('visible'),_0x56721b=null;}async function _0x28017e(){const _0x16cc6d=_0x239c7d;if(!_0x56721b)return;const _0xbc1c69=_0x56721b,_0x32654c=_0x4037ab[_0x16cc6d(0x652)][_0x16cc6d(0x821)](_0x6e084f=>_0x6e084f[_0x16cc6d(0x287)]===_0xbc1c69);if(!_0x32654c)return;_0x18266c();let _0x14a66b=_0x32654c['content'];if(_0x4037ab['isGroupCall']&&_0x32654c['role']===_0x16cc6d(0x4fd)){const _0x591bc1=_0x32654c[_0x16cc6d(0x1109)][_0x16cc6d(0x5ad)](':\x20');_0x591bc1['length']>0x1&&(_0x14a66b=_0x591bc1[_0x16cc6d(0x69f)](0x1)[_0x16cc6d(0xee1)](':\x20'));}const _0x47762f=await _0x25f61f(_0x16cc6d(0xa61),_0x16cc6d(0xdb1),_0x14a66b,_0x16cc6d(0x79e));_0x47762f!==null&&await _0x53c50a(_0xbc1c69,_0x47762f);}async function _0x53c50a(_0x4252b3,_0x33d5c3){const _0x448bcd=_0x239c7d,_0x5f2a0f=_0x4037ab['callHistory'][_0x448bcd(0x821)](_0x533a90=>_0x533a90[_0x448bcd(0x287)]===_0x4252b3);if(_0x5f2a0f){let _0x3ea0f4=_0x33d5c3;if(_0x4037ab['isGroupCall']&&_0x5f2a0f['role']==='assistant'){const _0x390cef=_0x5f2a0f['content'][_0x448bcd(0x5ad)](':\x20'),_0x3c2ab9=_0x390cef[0x0];_0x3ea0f4=_0x3c2ab9+':\x20'+_0x33d5c3;}_0x5f2a0f['content']=_0x3ea0f4;const _0x2bcda4=document['querySelector'](_0x448bcd(0xee4)+_0x4252b3+'\x22]');if(_0x2bcda4){if(_0x4037ab['isGroupCall']&&_0x5f2a0f[_0x448bcd(0x71a)]===_0x448bcd(0x4fd)){const _0x54658d=_0x5f2a0f['content'][_0x448bcd(0x5ad)](':\x20'),_0xf26da6=_0x54658d[0x0];_0x2bcda4[_0x448bcd(0x1575)]='<strong>'+_0xf26da6+_0x448bcd(0x105e)+_0x33d5c3;}else _0x2bcda4[_0x448bcd(0xde7)]=_0x33d5c3;}}await _0x138765('成功','通话消息已更新！');}async function _0x94ca8c(){const _0x4cb658=_0x239c7d;if(!_0x56721b)return;const _0x98b24e=await _0x56d4d3(_0x4cb658(0x7dd),_0x4cb658(0xebd),{'confirmButtonClass':_0x4cb658(0x142c)});if(_0x98b24e){const _0x1086b6=_0x56721b;_0x18266c();const _0x2d0da8=_0x4037ab[_0x4cb658(0x652)][_0x4cb658(0x11a4)](_0x29b9ad=>_0x29b9ad[_0x4cb658(0x287)]===_0x1086b6);_0x2d0da8>-0x1&&_0x4037ab['callHistory'][_0x4cb658(0xdcc)](_0x2d0da8,0x1);const _0x55b517=document[_0x4cb658(0x13ef)]('.call-message-bubble[data-timestamp=\x22'+_0x1086b6+'\x22]');_0x55b517&&_0x55b517['remove']();}else _0x18266c();}function _0x55f11a(_0x4365ad){const _0x5cbe7e=_0x239c7d;_0xe0d963=_0x4365ad;const _0x14816b=_0x4c8b14['chats'][_0x4c8b14['activeChatId']],_0x4d8358=_0x14816b[_0x5cbe7e(0x92c)][_0x5cbe7e(0x821)](_0x3b4ea5=>_0x3b4ea5[_0x5cbe7e(0x287)]===_0x4365ad);_0x4d8358&&(document['getElementById'](_0x5cbe7e(0x574))[_0x5cbe7e(0xde7)]=_0x4d8358[_0x5cbe7e(0x3e7)]),document[_0x5cbe7e(0x400)](_0x5cbe7e(0x53e))[_0x5cbe7e(0xb08)][_0x5cbe7e(0x12b6)](_0x5cbe7e(0x9eb));}function _0x268ad6(){const _0x1f95fe=_0x239c7d;document[_0x1f95fe(0x400)](_0x1f95fe(0x53e))[_0x1f95fe(0xb08)]['remove'](_0x1f95fe(0x9eb)),_0xe0d963=null;}async function _0x1d70c8(_0x3a3be2){const _0x54f9ba=_0x239c7d;if(!_0xe0d963)return;const _0x319bda=_0xe0d963,_0x189513=_0x4c8b14[_0x54f9ba(0xbea)][_0x4c8b14[_0x54f9ba(0x1539)]],_0x2c5762=_0x189513[_0x54f9ba(0x92c)][_0x54f9ba(0x11a4)](_0x4dfdfc=>_0x4dfdfc[_0x54f9ba(0x287)]===_0x319bda);if(_0x2c5762===-0x1)return;const _0x41dfaa=_0x189513['history'][_0x2c5762];_0x41dfaa['status']=_0x3a3be2;let _0x4dc1ed;if(_0x3a3be2==='declined'){const _0x431f3d={'role':_0x54f9ba(0x6d6),'type':_0x54f9ba(0x112f),'isRefund':!![],'amount':_0x41dfaa[_0x54f9ba(0x12e7)],'note':_0x54f9ba(0x2e8),'timestamp':Date[_0x54f9ba(0xecd)]()};_0x189513['history'][_0x54f9ba(0x6bb)](_0x431f3d),_0x4dc1ed='[系统提示：你拒绝并退还了“'+_0x41dfaa[_0x54f9ba(0x3e7)]+_0x54f9ba(0x118d);}else _0x4dc1ed=_0x54f9ba(0xae4)+_0x41dfaa['senderName']+_0x54f9ba(0x118d);const _0x129dc1={'role':_0x54f9ba(0xaf6),'content':_0x4dc1ed,'timestamp':Date[_0x54f9ba(0xecd)]()+0x1,'isHidden':!![]};_0x189513[_0x54f9ba(0x92c)][_0x54f9ba(0x6bb)](_0x129dc1),await _0x54c587['chats'][_0x54f9ba(0x4cb)](_0x189513),_0x268ad6(),_0x26354c(_0x4c8b14[_0x54f9ba(0x1539)]),_0x41b828();}function _0xd19681(_0x3a53b5){const _0x15f09a=_0x239c7d;_0x48d0a9=null;if(_0x3a53b5){const _0x365009=_0x3a53b5[_0x15f09a(0x13ef)]('.comment-input');_0x365009&&(_0x365009[_0x15f09a(0xb8e)]=_0x15f09a(0x54a));}}async function _0x4b6471(){const _0x409bd1=_0x239c7d,_0x4c980e=document[_0x409bd1(0x400)]('memories-list');_0x4c980e['innerHTML']='';const _0x5eb148=await _0x54c587[_0x409bd1(0x1541)]['orderBy'](_0x409bd1(0x287))[_0x409bd1(0xfc1)]()[_0x409bd1(0xce1)]();if(_0x5eb148['length']===0x0){_0x4c980e[_0x409bd1(0x1575)]=_0x409bd1(0x676);return;}_0x5eb148[_0x409bd1(0x968)]((_0x3b00a6,_0xd952d1)=>{const _0x2cc9e6=_0x409bd1,_0x593d5e=_0x3b00a6[_0x2cc9e6(0xbbf)]==='countdown'&&_0x3b00a6[_0x2cc9e6(0xbe7)]>Date[_0x2cc9e6(0xecd)](),_0x3819c4=_0xd952d1['type']===_0x2cc9e6(0x264)&&_0xd952d1['targetDate']>Date['now']();if(_0x593d5e&&!_0x3819c4)return-0x1;if(!_0x593d5e&&_0x3819c4)return 0x1;if(_0x593d5e&&_0x3819c4)return _0x3b00a6['targetDate']-_0xd952d1['targetDate'];return 0x0;}),_0x5eb148[_0x409bd1(0xbdc)](_0x51dc77=>{const _0x276905=_0x409bd1;let _0x124e22;_0x51dc77[_0x276905(0xbbf)]===_0x276905(0x264)&&_0x51dc77[_0x276905(0xbe7)]>Date[_0x276905(0xecd)]()?_0x124e22=_0x5a1a81(_0x51dc77):_0x124e22=_0x3157ef(_0x51dc77),_0x4c980e[_0x276905(0x8f2)](_0x124e22);}),_0x4cf6fc();}function _0x3157ef(_0x2c474f){const _0x5ce9b2=_0x239c7d,_0x5aeb07=document[_0x5ce9b2(0x2c9)]('div');_0x5aeb07[_0x5ce9b2(0x4e1)]=_0x5ce9b2(0xedb);const _0x3ad987=new Date(_0x2c474f[_0x5ce9b2(0x287)]),_0x54ef02=_0x3ad987['getFullYear']()+'-'+String(_0x3ad987[_0x5ce9b2(0xebe)]()+0x1)[_0x5ce9b2(0xb7d)](0x2,'0')+'-'+String(_0x3ad987[_0x5ce9b2(0xd00)]())['padStart'](0x2,'0')+'\x20'+String(_0x3ad987[_0x5ce9b2(0x331)]())[_0x5ce9b2(0xb7d)](0x2,'0')+':'+String(_0x3ad987['getMinutes']())[_0x5ce9b2(0xb7d)](0x2,'0');let _0x50456e,_0x1da566;if(_0x2c474f['type']===_0x5ce9b2(0x264)&&_0x2c474f[_0x5ce9b2(0xbe7)])_0x50456e=_0x5ce9b2(0x1187)+_0x2c474f[_0x5ce9b2(0x12a5)],_0x1da566=_0x412ec9('在\x20'+new Date(_0x2c474f[_0x5ce9b2(0xbe7)])[_0x5ce9b2(0xad4)]()+_0x5ce9b2(0x8bf))[_0x5ce9b2(0xe19)](/\n/g,_0x5ce9b2(0x9e1));else{let _0xfe2f2d=_0x5ce9b2(0xe67);if(_0x2c474f[_0x5ce9b2(0x606)]){const _0x5151fd=_0x4c8b14[_0x5ce9b2(0xbea)][_0x2c474f[_0x5ce9b2(0x606)]];_0x5151fd?_0xfe2f2d=_0x5151fd[_0x5ce9b2(0xf3e)]:_0xfe2f2d=_0x2c474f[_0x5ce9b2(0xf93)]||_0x5ce9b2(0x1413);}else _0x2c474f[_0x5ce9b2(0xf93)]&&(_0xfe2f2d=_0x2c474f['authorName']);_0x50456e=_0xfe2f2d+'\x20的日记',_0x1da566=_0x412ec9(_0x2c474f[_0x5ce9b2(0x12a5)]);}return _0x5aeb07[_0x5ce9b2(0x1575)]=_0x5ce9b2(0xa8e)+_0x54ef02+_0x5ce9b2(0x11bb)+_0x50456e+_0x5ce9b2(0xaca)+_0x1da566+_0x5ce9b2(0x86a),_0x3d4218(_0x5aeb07,async()=>{const _0x1e8ed5=_0x5ce9b2,_0x402540=await _0x56d4d3(_0x1e8ed5(0x357),'确定要删除这条记录吗？',{'confirmButtonClass':_0x1e8ed5(0x142c)});_0x402540&&(await _0x54c587[_0x1e8ed5(0x1541)][_0x1e8ed5(0x942)](_0x2c474f['id']),_0x4b6471());}),_0x5aeb07;}function _0x5a1a81(_0x1fb9d4){const _0x31a0b2=_0x239c7d,_0x8941fd=document[_0x31a0b2(0x2c9)](_0x31a0b2(0xf8e));_0x8941fd['className']=_0x31a0b2(0xc32);const _0x2b3321=new Date(_0x1fb9d4['targetDate']),_0x328057=_0x2b3321[_0x31a0b2(0xad4)](_0x31a0b2(0x1271),{'dateStyle':_0x31a0b2(0x1552),'timeStyle':'short'});return _0x8941fd[_0x31a0b2(0x1575)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x1fb9d4['description']+_0x31a0b2(0x68f)+_0x1fb9d4[_0x31a0b2(0xbe7)]+_0x31a0b2(0x7db)+_0x328057+_0x31a0b2(0x86a),_0x3d4218(_0x8941fd,async()=>{const _0x112aab=_0x31a0b2,_0x2c66f6=await _0x56d4d3(_0x112aab(0x13c5),_0x112aab(0xb47),{'confirmButtonClass':_0x112aab(0x142c)});_0x2c66f6&&(await _0x54c587['memories'][_0x112aab(0x942)](_0x1fb9d4['id']),_0x4b6471());}),_0x8941fd;}let _0x2ae580=[];function _0x4cf6fc(){const _0x1884a2=_0x239c7d;_0x2ae580['forEach'](_0x5259c3=>clearInterval(_0x5259c3)),_0x2ae580=[],document[_0x1884a2(0x527)]('.countdown-card\x20.timer')[_0x1884a2(0xbdc)](_0x3fa916=>{const _0x73ef77=_0x1884a2,_0x25208f=parseInt(_0x3fa916['dataset'][_0x73ef77(0xbe7)]);let _0x1ccbfc;const _0xcb9f13=()=>{const _0x1286c5=_0x73ef77,_0x4f6c4a=Date[_0x1286c5(0xecd)](),_0x4a7f40=_0x25208f-_0x4f6c4a;if(_0x4a7f40<0x0){_0x3fa916[_0x1286c5(0xde7)]=_0x1286c5(0xec8),clearInterval(_0x1ccbfc),setTimeout(()=>_0x4b6471(),0x7d0);return;}const _0x5bd20e=Math[_0x1286c5(0x1381)](_0x4a7f40/(0x3e8*0x3c*0x3c*0x18)),_0x3533f5=Math[_0x1286c5(0x1381)](_0x4a7f40%(0x3e8*0x3c*0x3c*0x18)/(0x3e8*0x3c*0x3c)),_0x4edcff=Math[_0x1286c5(0x1381)](_0x4a7f40%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x55e0a9=Math[_0x1286c5(0x1381)](_0x4a7f40%(0x3e8*0x3c)/0x3e8);_0x3fa916['textContent']=_0x5bd20e+'天\x20'+_0x3533f5+'时\x20'+_0x4edcff+'分\x20'+_0x55e0a9+'秒';};_0xcb9f13(),_0x1ccbfc=setInterval(_0xcb9f13,0x3e8),_0x2ae580[_0x73ef77(0x6bb)](_0x1ccbfc);});}async function _0x3eba75(_0x3756c2){const _0x5f0fbf=_0x239c7d,_0x5d5732=_0x4c8b14['chats'][_0x3756c2];if(!_0x5d5732)return;await _0x138765(_0x5f0fbf(0x153e),_0x5f0fbf(0x1158)+_0x5d5732[_0x5f0fbf(0xf3e)]+_0x5f0fbf(0xff6));const {proxyUrl:_0x4e4526,apiKey:_0x2a866a,model:_0x470362}=_0x4c8b14['apiConfig'];if(!_0x4e4526||!_0x2a866a||!_0x470362){await _0x138765(_0x5f0fbf(0xb4e),_0x5f0fbf(0xe5d));return;}const _0x5a27e6=_0x5d5732[_0x5f0fbf(0x92c)][_0x5f0fbf(0x69f)](-0x5)['map'](_0x3bd7a6=>{const _0x16ea3b=_0x5f0fbf,_0x46e1b9=_0x3bd7a6['role']===_0x16ea3b(0x6d6)?_0x5d5732[_0x16ea3b(0xa37)][_0x16ea3b(0x14a8)]||'我':_0x3bd7a6[_0x16ea3b(0x3e7)]||_0x5d5732['name'];return _0x46e1b9+':\x20'+String(_0x3bd7a6[_0x16ea3b(0x1109)])[_0x16ea3b(0x371)](0x0,0x32)+_0x16ea3b(0x166b);})[_0x5f0fbf(0xee1)]('\x0a');let _0x15434c='';if(_0x5d5732['settings']['linkedWorldBookIds']&&_0x5d5732[_0x5f0fbf(0xa37)]['linkedWorldBookIds'][_0x5f0fbf(0x8d6)]>0x0){const _0x5c34de=_0x5d5732[_0x5f0fbf(0xa37)][_0x5f0fbf(0xb0d)][_0x5f0fbf(0xd18)](_0x4e4869=>{const _0x40e913=_0x5f0fbf,_0x24377e=_0x4c8b14[_0x40e913(0xf57)][_0x40e913(0x821)](_0x63eb03=>_0x63eb03['id']===_0x4e4869);if(!_0x24377e||!Array['isArray'](_0x24377e[_0x40e913(0x1109)]))return'';const _0x32a4c3=_0x24377e['content']['map'](_0x1cf9f1=>{const _0x4e38b3=_0x40e913;let _0x40430b='\x0a###\x20条目:\x20'+(_0x1cf9f1[_0x4e38b3(0x83c)]||_0x4e38b3(0x955))+'\x0a';return _0x1cf9f1[_0x4e38b3(0x1161)]['length']>0x0&&(_0x40430b+=_0x4e38b3(0x65c)+_0x1cf9f1[_0x4e38b3(0x1161)]['join'](',\x20')+'\x0a'),_0x40430b+=_0x4e38b3(0x845)+_0x1cf9f1['content'],_0x40430b;})[_0x40e913(0xee1)]('\x0a');return _0x32a4c3?_0x40e913(0xd75)+_0x24377e[_0x40e913(0xf3e)]+'\x0a'+_0x32a4c3:'';})['filter'](Boolean)[_0x5f0fbf(0xee1)]('');_0x5c34de&&(_0x15434c=_0x5f0fbf(0x15e2)+_0x5c34de+'\x0a');}const _0x56fe6d=_0x5f0fbf(0xb29)+_0x5d5732['name']+_0x5f0fbf(0xe8e)+_0x5d5732[_0x5f0fbf(0xa37)][_0x5f0fbf(0xfea)]+_0x5f0fbf(0xf5a)+_0x15434c+_0x5f0fbf(0xf49)+_0x5a27e6+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22decision\x22:\x20\x22apply\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22在这里写下你想对用户说的、真诚的、有针对性的申请理由。\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20\x20\x20\x20';try{const _0x2e4f84=[{'role':_0x5f0fbf(0xaf6),'content':_0x56fe6d},{'role':_0x5f0fbf(0x6d6),'content':'请根据以上设定开始你的决策。'}];let _0x211177=_0x4e4526===GEMINI_API_URL,_0x3a3421=_0x3914a6(_0x470362,_0x2a866a,_0x56fe6d,_0x2e4f84);const _0x596507=_0x211177?await fetch(_0x3a3421[_0x5f0fbf(0x299)],_0x3a3421[_0x5f0fbf(0x55b)]):await fetch(_0x4e4526+_0x5f0fbf(0x1611),{'method':_0x5f0fbf(0x953),'headers':{'Content-Type':_0x5f0fbf(0xfae),'Authorization':'Bearer\x20'+_0x2a866a},'body':JSON['stringify']({'model':_0x470362,'messages':_0x2e4f84,'temperature':_0x4c8b14[_0x5f0fbf(0x14f1)][_0x5f0fbf(0x216)]||0.9})});if(!_0x596507['ok']){const _0x46c295=await _0x596507[_0x5f0fbf(0x15d3)]();throw new Error(_0x5f0fbf(0x1178)+_0x596507[_0x5f0fbf(0x12c3)]+'\x20-\x20'+_0x46c295[_0x5f0fbf(0x5d7)][_0x5f0fbf(0x6e2)]);}const _0x13c19c=await _0x596507[_0x5f0fbf(0x15d3)]();let _0x101c51=_0x211177?getGeminiResponseText(_0x13c19c):_0x13c19c['choices'][0x0][_0x5f0fbf(0x6e2)][_0x5f0fbf(0x1109)];_0x101c51=_0x101c51[_0x5f0fbf(0xe19)](/^```json\s*/,'')[_0x5f0fbf(0xe19)](/```$/,'');const _0xc69f35=_0x101c51[_0x5f0fbf(0xb8f)]();let _0x241860;try{_0x241860=JSON[_0x5f0fbf(0x13f7)](_0xc69f35);}catch(_0x48b397){console[_0x5f0fbf(0x5d7)]('解析好友申请的AI响应失败:',_0x48b397);throw new Error('AI未返回有效的JSON。API实际返回内容:\x20\x22'+_0xc69f35+'\x22');}_0x241860[_0x5f0fbf(0x6ad)]===_0x5f0fbf(0x922)&&_0x241860[_0x5f0fbf(0x383)]?(_0x5d5732['relationship'][_0x5f0fbf(0x12c3)]=_0x5f0fbf(0x101f),_0x5d5732[_0x5f0fbf(0x12f7)]['applicationReason']=_0x241860[_0x5f0fbf(0x383)],_0x4c8b14[_0x5f0fbf(0xbea)][_0x3756c2]=_0x5d5732,_0x41b828(),await _0x138765(_0x5f0fbf(0x8b3),'“'+_0x5d5732[_0x5f0fbf(0xf3e)]+'”已向你发送好友申请。请返回聊天列表查看。')):(await _0x138765(_0x5f0fbf(0xb96),'“'+_0x5d5732['name']+_0x5f0fbf(0x35e)),_0x5d5732[_0x5f0fbf(0x12f7)][_0x5f0fbf(0x12c3)]='blocked_by_user',_0x5d5732[_0x5f0fbf(0x12f7)][_0x5f0fbf(0x1199)]=Date[_0x5f0fbf(0xecd)]());}catch(_0x3bfbe9){await _0x138765(_0x5f0fbf(0xf13),'为“'+_0x5d5732[_0x5f0fbf(0xf3e)]+_0x5f0fbf(0x141d)+_0x3bfbe9['message']+_0x5f0fbf(0x622)),_0x5d5732['relationship']['status']=_0x5f0fbf(0x15ea),_0x5d5732[_0x5f0fbf(0x12f7)][_0x5f0fbf(0x1199)]=Date[_0x5f0fbf(0xecd)]();}finally{await _0x54c587[_0x5f0fbf(0xbea)]['put'](_0x5d5732),_0x26354c(_0x3756c2);}}function _0x129f5d(){const _0x5586eb=_0x239c7d;if(!_0x4c8b14[_0x5586eb(0x1539)])return;const _0x56b598=_0x4c8b14['chats'][_0x4c8b14[_0x5586eb(0x1539)]];_0x56b598['isGroup']?_0x5aef8e():document['getElementById'](_0x5586eb(0xdd4))[_0x5586eb(0xb08)][_0x5586eb(0x12b6)](_0x5586eb(0x9eb));}function _0x5aef8e(){const _0x572d54=_0x239c7d,_0x47304b=document['getElementById'](_0x572d54(0xfb7)),_0x83036d=_0x4c8b14['chats'][_0x4c8b14[_0x572d54(0x1539)]];document[_0x572d54(0x400)](_0x572d54(0x1669))[_0x572d54(0xa1e)]='',document[_0x572d54(0x400)](_0x572d54(0x37f))['value']='',document[_0x572d54(0x400)](_0x572d54(0xea0))[_0x572d54(0xa1e)]='',document[_0x572d54(0x400)](_0x572d54(0x33e))[_0x572d54(0xa1e)]='',document['getElementById'](_0x572d54(0x241))[_0x572d54(0xa1e)]='',document[_0x572d54(0x400)](_0x572d54(0x11e2))[_0x572d54(0xde7)]=_0x572d54(0x1430),document[_0x572d54(0x400)](_0x572d54(0xba3))[_0x572d54(0xde7)]=_0x572d54(0x1430);const _0x5a1b15=document[_0x572d54(0x400)](_0x572d54(0x3fb));_0x5a1b15[_0x572d54(0x1575)]='',_0x83036d[_0x572d54(0x4f8)]['forEach'](_0x1f2c9c=>{const _0x12d42d=_0x572d54,_0xdbedf0=document[_0x12d42d(0x2c9)]('option');_0xdbedf0[_0x12d42d(0xa1e)]=_0x1f2c9c[_0x12d42d(0xdcf)],_0xdbedf0[_0x12d42d(0xde7)]=_0x1f2c9c[_0x12d42d(0x7ca)],_0x5a1b15[_0x12d42d(0x8f2)](_0xdbedf0);}),document[_0x572d54(0x400)](_0x572d54(0xf76))['click'](),_0x47304b['classList'][_0x572d54(0x12b6)](_0x572d54(0x9eb));}async function _0x1d3ff3(){const _0x1ff11f=_0x239c7d,_0x23f0a6=_0x4c8b14['chats'][_0x4c8b14[_0x1ff11f(0x1539)]],_0x58a400=parseFloat(document['getElementById'](_0x1ff11f(0x1669))[_0x1ff11f(0xa1e)]),_0xf16911=parseInt(document[_0x1ff11f(0x400)](_0x1ff11f(0x37f))[_0x1ff11f(0xa1e)]),_0x4f7546=document[_0x1ff11f(0x400)](_0x1ff11f(0xea0))[_0x1ff11f(0xa1e)][_0x1ff11f(0xb8f)]();if(isNaN(_0x58a400)||_0x58a400<=0x0){alert('请输入有效的总金额！');return;}if(isNaN(_0xf16911)||_0xf16911<=0x0){alert('请输入有效的红包个数！');return;}if(_0x58a400/_0xf16911<0.01){alert(_0x1ff11f(0x538));return;}const _0x26441b=_0x23f0a6[_0x1ff11f(0xa37)][_0x1ff11f(0x14a8)]||'我',_0xf68f83=generateRandomPacketAmounts(_0x58a400,_0xf16911),_0x12db8e={'role':_0x1ff11f(0x6d6),'senderName':_0x26441b,'type':_0x1ff11f(0x1461),'packetType':_0x1ff11f(0xc01),'timestamp':Date[_0x1ff11f(0xecd)](),'totalAmount':_0x58a400,'count':_0xf16911,'greeting':_0x4f7546||_0x1ff11f(0x14f3),'allocatedAmounts':_0xf68f83,'unclaimedAmounts':[..._0xf68f83],'claimedBy':{},'isFullyClaimed':![]};_0x23f0a6['history'][_0x1ff11f(0x6bb)](_0x12db8e),await _0x54c587[_0x1ff11f(0xbea)][_0x1ff11f(0x4cb)](_0x23f0a6),_0x41ecc7(_0x12db8e,_0x23f0a6),_0x41b828(),document[_0x1ff11f(0x400)]('red-packet-modal')[_0x1ff11f(0xb08)][_0x1ff11f(0xc46)](_0x1ff11f(0x9eb));}async function _0x98ee62(){const _0xce087b=_0x239c7d,_0x484dd0=_0x4c8b14[_0xce087b(0xbea)][_0x4c8b14[_0xce087b(0x1539)]],_0x3d26f0=parseFloat(document[_0xce087b(0x400)](_0xce087b(0x33e))['value']),_0xf44aa6=document['getElementById'](_0xce087b(0x3fb))[_0xce087b(0xa1e)],_0x1c1f8e=document[_0xce087b(0x400)](_0xce087b(0x241))[_0xce087b(0xa1e)]['trim']();if(isNaN(_0x3d26f0)||_0x3d26f0<=0x0){alert(_0xce087b(0x3d2));return;}if(!_0xf44aa6){alert(_0xce087b(0x14ac));return;}const _0x36ab44=_0x484dd0[_0xce087b(0xa37)]['myNickname']||'我',_0x105715={'role':_0xce087b(0x6d6),'senderName':_0x36ab44,'type':_0xce087b(0x1461),'packetType':_0xce087b(0xfd0),'timestamp':Date[_0xce087b(0xecd)](),'totalAmount':_0x3d26f0,'count':0x1,'greeting':_0x1c1f8e||_0xce087b(0x3bb),'receiverName':_0xf44aa6,'claimedBy':{},'isFullyClaimed':![]};_0x484dd0[_0xce087b(0x92c)][_0xce087b(0x6bb)](_0x105715),await _0x54c587[_0xce087b(0xbea)][_0xce087b(0x4cb)](_0x484dd0),_0x41ecc7(_0x105715,_0x484dd0),_0x41b828(),document[_0xce087b(0x400)]('red-packet-modal')[_0xce087b(0xb08)][_0xce087b(0xc46)]('visible');}async function _0x3f6023(_0x4a8ab7){const _0x514b4f=_0x239c7d,_0x1a62d0=_0x4c8b14[_0x514b4f(0x1539)],_0x192d8b=await _0x54c587['chats'][_0x514b4f(0xf48)](_0x1a62d0);if(!_0x192d8b)return;_0x4c8b14[_0x514b4f(0xbea)][_0x1a62d0]=_0x192d8b;const _0x2142ed=_0x192d8b[_0x514b4f(0x92c)][_0x514b4f(0x821)](_0x208dae=>_0x208dae[_0x514b4f(0x287)]===_0x4a8ab7);if(!_0x2142ed)return;const _0x55b7c1=_0x4c8b14['qzoneSettings'][_0x514b4f(0xbf3)]||_0x514b4f(0xa8f),_0x3c315b=_0x2142ed[_0x514b4f(0x1360)]&&_0x2142ed['claimedBy'][_0x55b7c1];if(_0x2142ed[_0x514b4f(0x1015)]===_0x514b4f(0xfd0)&&_0x2142ed[_0x514b4f(0x11fd)]!==_0x55b7c1&&Object[_0x514b4f(0x1161)](_0x2142ed['claimedBy'])[_0x514b4f(0x8d6)]>0x0||_0x2142ed[_0x514b4f(0x1023)]||_0x3c315b){_0x3cf22c(_0x2142ed);return;}const _0x31b66c=await _0x20b43b(_0x2142ed);_0x31b66c!==null&&(await _0x26354c(_0x1a62d0),await _0x138765('恭喜！',_0x514b4f(0x286)+_0x288d80(_0x192d8b,_0x2142ed[_0x514b4f(0x3e7)])+_0x514b4f(0x1379)+_0x31b66c[_0x514b4f(0x2ea)](0x2)+'\x20元。'));const _0x429941=_0x4c8b14[_0x514b4f(0xbea)][_0x1a62d0][_0x514b4f(0x92c)][_0x514b4f(0x821)](_0x28ac1d=>_0x28ac1d['timestamp']===_0x4a8ab7);_0x429941&&_0x3cf22c(_0x429941);}async function _0x20b43b(_0x2b033c){const _0x17444b=_0x239c7d,_0x209ab0=_0x4c8b14[_0x17444b(0xbea)][_0x4c8b14[_0x17444b(0x1539)]];let _0x553978=Date[_0x17444b(0xecd)]();const _0x22e270=_0x4c8b14[_0x17444b(0x834)][_0x17444b(0xbf3)]||_0x17444b(0xa8f),_0x353aad=_0x2b033c['count']-Object[_0x17444b(0x1161)](_0x2b033c[_0x17444b(0x1360)]||{})[_0x17444b(0x8d6)];if(_0x353aad<=0x0)return _0x2b033c['isFullyClaimed']=!![],await _0x54c587[_0x17444b(0xbea)][_0x17444b(0x4cb)](_0x209ab0),await _0x138765(_0x17444b(0x12d6),_0x17444b(0x163f)),null;let _0x2a38df=0x0;if(_0x2b033c[_0x17444b(0x1015)]==='lucky'){if(_0x2b033c[_0x17444b(0x6a7)]&&_0x2b033c['unclaimedAmounts'][_0x17444b(0x8d6)]>0x0)_0x2a38df=_0x2b033c['unclaimedAmounts'][_0x17444b(0x5ac)]();else{console[_0x17444b(0x75e)](_0x17444b(0x615));const _0xea30dc=_0x2b033c[_0x17444b(0xff7)]-Object['values'](_0x2b033c[_0x17444b(0x1360)]||{})[_0x17444b(0x439)]((_0x4ff66c,_0x1cbaa1)=>_0x4ff66c+_0x1cbaa1,0x0);if(_0x353aad===0x1)_0x2a38df=_0xea30dc;else{const _0x411471=0.01,_0x3a6ff1=_0xea30dc-(_0x353aad-0x1)*_0x411471;_0x2a38df=Math[_0x17444b(0x12bc)]()*(_0x3a6ff1-_0x411471)+_0x411471;}}}else _0x2a38df=_0x2b033c[_0x17444b(0xff7)];_0x2a38df=parseFloat(_0x2a38df['toFixed'](0x2));if(!_0x2b033c[_0x17444b(0x1360)])_0x2b033c[_0x17444b(0x1360)]={};_0x2b033c['claimedBy'][_0x22e270]=_0x2a38df;const _0x1690aa=_0x2b033c[_0x17444b(0x6a7)]&&_0x2b033c[_0x17444b(0x6a7)][_0x17444b(0x8d6)]===0x0||Object[_0x17444b(0x1161)](_0x2b033c[_0x17444b(0x1360)])[_0x17444b(0x8d6)]>=_0x2b033c['count'];_0x1690aa&&(_0x2b033c['isFullyClaimed']=!![]);const _0x49a6cf=_0x288d80(_0x209ab0,_0x22e270),_0x511edb=_0x288d80(_0x209ab0,_0x2b033c[_0x17444b(0x3e7)]),_0x4381e0={'role':_0x17444b(0xaf6),'type':'pat_message','content':_0x17444b(0x286)+_0x511edb+_0x17444b(0x139e),'timestamp':_0x553978++};_0x209ab0[_0x17444b(0x92c)][_0x17444b(0x6bb)](_0x4381e0);let _0x5283bc;if(_0x1690aa){const _0x313bc1={'role':_0x17444b(0xaf6),'type':'pat_message','content':_0x511edb+_0x17444b(0xd23),'timestamp':_0x553978++};_0x209ab0[_0x17444b(0x92c)][_0x17444b(0x6bb)](_0x313bc1);let _0x2b5c55={'name':'','amount':-0x1};_0x2b033c[_0x17444b(0x1015)]===_0x17444b(0xc01)&&_0x2b033c['count']>0x1&&Object[_0x17444b(0x9de)](_0x2b033c[_0x17444b(0x1360)])['forEach'](([_0x4ad51e,_0x5429d6])=>{const _0x4e5fd3=_0x17444b;_0x5429d6>_0x2b5c55[_0x4e5fd3(0x12e7)]&&(_0x2b5c55={'name':_0x4ad51e,'amount':_0x5429d6});});const _0x3b92b3=_0x2b5c55[_0x17444b(0xf3e)]?_0x288d80(_0x209ab0,_0x2b5c55[_0x17444b(0xf3e)]):'无';_0x5283bc=_0x17444b(0x28e)+_0x49a6cf+_0x17444b(0x158c)+_0x3b92b3+_0x17444b(0xa80);}else _0x5283bc=_0x17444b(0x28e)+_0x49a6cf+')\x20刚刚领取了红包\x20(时间戳:\x20'+_0x2b033c[_0x17444b(0x287)]+_0x17444b(0x5ef);const _0x46e9ba={'role':_0x17444b(0xaf6),'content':_0x5283bc,'timestamp':_0x553978++,'isHidden':!![]};return _0x209ab0[_0x17444b(0x92c)][_0x17444b(0x6bb)](_0x46e9ba),await _0x54c587['chats'][_0x17444b(0x4cb)](_0x209ab0),_0x2a38df;}async function _0x3cf22c(_0x59dcd9){const _0x44b417=_0x239c7d;if(!_0x59dcd9){console[_0x44b417(0x5d7)]('showRedPacketDetails收到了无效的packet对象');return;}const _0x2b515e=_0x4c8b14[_0x44b417(0xbea)][_0x4c8b14[_0x44b417(0x1539)]];if(!_0x2b515e)return;const _0x2c8a21=document[_0x44b417(0x400)]('red-packet-details-modal'),_0x2addea=_0x4c8b14[_0x44b417(0x834)][_0x44b417(0xbf3)]||_0x44b417(0xa8f),_0x532516=_0x288d80(_0x2b515e,_0x59dcd9[_0x44b417(0x3e7)]);document['getElementById']('rp-details-sender')[_0x44b417(0xde7)]=_0x532516,document[_0x44b417(0x400)](_0x44b417(0x56b))[_0x44b417(0xde7)]=_0x59dcd9[_0x44b417(0xdf1)]||_0x44b417(0x14f3);const _0x1df7bd=document[_0x44b417(0x400)]('rp-details-my-amount');_0x59dcd9['claimedBy']&&_0x59dcd9[_0x44b417(0x1360)][_0x2addea]?(_0x1df7bd[_0x44b417(0x13ef)]('span:first-child')[_0x44b417(0xde7)]=_0x59dcd9['claimedBy'][_0x2addea]['toFixed'](0x2),_0x1df7bd[_0x44b417(0xa00)]['display']=_0x44b417(0x1181)):_0x1df7bd[_0x44b417(0xa00)][_0x44b417(0xb1a)]=_0x44b417(0x165b);const _0x6d53ff=Object[_0x44b417(0x1161)](_0x59dcd9[_0x44b417(0x1360)]||{})[_0x44b417(0x8d6)],_0x12dead=Object[_0x44b417(0x40a)](_0x59dcd9[_0x44b417(0x1360)]||{})[_0x44b417(0x439)]((_0x5ecfa8,_0x3cdcc9)=>_0x5ecfa8+_0x3cdcc9,0x0);let _0x4c0a3a=_0x6d53ff+'/'+_0x59dcd9[_0x44b417(0xcbc)]+_0x44b417(0x871)+_0x12dead[_0x44b417(0x2ea)](0x2)+'/'+_0x59dcd9[_0x44b417(0xff7)][_0x44b417(0x2ea)](0x2)+'元。';if(!_0x59dcd9['isFullyClaimed']&&_0x6d53ff<_0x59dcd9['count']){const _0x2d6bc1=Math[_0x44b417(0x1381)]((_0x59dcd9[_0x44b417(0x287)]+0x18*0x3c*0x3c*0x3e8-Date['now']())/(0x3e8*0x3c*0x3c));if(_0x2d6bc1>0x0)_0x4c0a3a+='\x20剩余红包将在'+_0x2d6bc1+'小时内退还。';}document[_0x44b417(0x400)](_0x44b417(0x1095))[_0x44b417(0xde7)]=_0x4c0a3a;const _0x324e31=document[_0x44b417(0x400)](_0x44b417(0x649));_0x324e31[_0x44b417(0x1575)]='';const _0x209374=Object[_0x44b417(0x9de)](_0x59dcd9['claimedBy']||{});let _0x14fb29={'name':'','amount':-0x1};_0x59dcd9[_0x44b417(0x1015)]==='lucky'&&_0x59dcd9['isFullyClaimed']&&_0x209374[_0x44b417(0x8d6)]>0x1&&_0x209374[_0x44b417(0xbdc)](([_0x34023c,_0x50867])=>{const _0x2f2ff1=_0x44b417;_0x50867>_0x14fb29[_0x2f2ff1(0x12e7)]&&(_0x14fb29={'name':_0x34023c,'amount':_0x50867});}),_0x209374[_0x44b417(0x968)]((_0x20e2d8,_0x598c6c)=>_0x598c6c[0x1]-_0x20e2d8[0x1]),_0x209374[_0x44b417(0xbdc)](([_0x2544ff,_0x50e092])=>{const _0x3fcf1e=_0x44b417,_0xbe0e0c=document[_0x3fcf1e(0x2c9)](_0x3fcf1e(0xf8e));_0xbe0e0c[_0x3fcf1e(0x4e1)]=_0x3fcf1e(0x9bd);let _0x418b5a='';_0x14fb29['name']&&_0x2544ff===_0x14fb29['name']&&(_0x418b5a=_0x3fcf1e(0x4ea));const _0x5b79c1=_0x288d80(_0x2b515e,_0x2544ff);_0xbe0e0c[_0x3fcf1e(0x1575)]=_0x3fcf1e(0x140b)+_0x5b79c1+_0x3fcf1e(0xddb)+_0x50e092[_0x3fcf1e(0x2ea)](0x2)+_0x3fcf1e(0x374)+_0x418b5a+_0x3fcf1e(0x73f),_0x324e31[_0x3fcf1e(0x8f2)](_0xbe0e0c);}),_0x2c8a21[_0x44b417(0xb08)][_0x44b417(0x12b6)](_0x44b417(0x9eb));}document[_0x239c7d(0x400)](_0x239c7d(0x1615))['addEventListener'](_0x239c7d(0x15ad),()=>{const _0x22f4c8=_0x239c7d;document[_0x22f4c8(0x400)](_0x22f4c8(0xcec))[_0x22f4c8(0xb08)][_0x22f4c8(0xc46)](_0x22f4c8(0x9eb));}),window[_0x239c7d(0x1e2)]=_0x3f6023;function _0x45c050(){const _0x5bc09d=_0x239c7d,_0xaa7cb4=document[_0x5bc09d(0x400)](_0x5bc09d(0x801));document[_0x5bc09d(0x400)](_0x5bc09d(0x1550))[_0x5bc09d(0xa1e)]='';const _0x11b28e=document[_0x5bc09d(0x400)](_0x5bc09d(0x1688));_0x11b28e[_0x5bc09d(0x1575)]='',_0x192645(),_0x192645(),_0xaa7cb4[_0x5bc09d(0xb08)]['add'](_0x5bc09d(0x9eb));}function _0x192645(){const _0x3e583d=_0x239c7d,_0x1880de=document[_0x3e583d(0x400)](_0x3e583d(0x1688)),_0x182e94=document[_0x3e583d(0x2c9)](_0x3e583d(0xf8e));_0x182e94['className']=_0x3e583d(0xd09),_0x182e94[_0x3e583d(0x1575)]=_0x3e583d(0x1467),_0x182e94[_0x3e583d(0x13ef)](_0x3e583d(0x12d7))['addEventListener'](_0x3e583d(0x15ad),()=>{const _0x4a696b=_0x3e583d;_0x1880de[_0x4a696b(0xc9d)][_0x4a696b(0x8d6)]>0x2?_0x182e94[_0x4a696b(0xc46)]():alert(_0x4a696b(0x3fc));}),_0x1880de[_0x3e583d(0x8f2)](_0x182e94);}async function _0x4d0493(){const _0x262094=_0x239c7d;if(!_0x4c8b14[_0x262094(0x1539)])return;const _0x2a1207=document[_0x262094(0x400)](_0x262094(0x1550))[_0x262094(0xa1e)]['trim']();if(!_0x2a1207){alert(_0x262094(0x6c1));return;}const _0x19ede3=Array['from'](document['querySelectorAll']('.poll-option-input'))['map'](_0x46405a=>_0x46405a[_0x262094(0xa1e)][_0x262094(0xb8f)]())[_0x262094(0x29d)](_0x36db54=>_0x36db54);if(_0x19ede3[_0x262094(0x8d6)]<0x2){alert('请至少输入2个有效的投票选项！');return;}const _0x430f2f=_0x4c8b14['chats'][_0x4c8b14[_0x262094(0x1539)]],_0x40642e=_0x430f2f[_0x262094(0xc98)]?_0x430f2f['settings'][_0x262094(0x14a8)]||'我':'我',_0x4ce5b4={'role':_0x262094(0x6d6),'senderName':_0x40642e,'type':_0x262094(0x1618),'timestamp':Date[_0x262094(0xecd)](),'question':_0x2a1207,'options':_0x19ede3,'votes':{},'isClosed':![]};_0x430f2f['history'][_0x262094(0x6bb)](_0x4ce5b4),await _0x54c587[_0x262094(0xbea)]['put'](_0x430f2f),_0x41ecc7(_0x4ce5b4,_0x430f2f),_0x41b828(),document[_0x262094(0x400)](_0x262094(0x801))[_0x262094(0xb08)]['remove'](_0x262094(0x9eb));}async function _0x3ea12a(_0x1b8895,_0x347f27){const _0x51fb3e=_0x239c7d,_0x5e1fa4=_0x4c8b14['chats'][_0x4c8b14['activeChatId']],_0x210d73=_0x5e1fa4['history'][_0x51fb3e(0x821)](_0x2061ce=>_0x2061ce['timestamp']===_0x1b8895),_0x313ccd=_0x5e1fa4[_0x51fb3e(0xc98)]?_0x5e1fa4['settings'][_0x51fb3e(0x14a8)]||'我':'我';if(!_0x210d73||_0x210d73[_0x51fb3e(0x3c0)]){_0x210d73&&_0x210d73[_0x51fb3e(0x3c0)]&&_0x26d52b(_0x1b8895);return;}const _0x1f0c5c=_0x210d73['votes'][_0x347f27]&&_0x210d73[_0x51fb3e(0x14a6)][_0x347f27][_0x51fb3e(0xd1b)](_0x313ccd);if(!_0x1f0c5c){for(const _0xed8d41 in _0x210d73['votes']){const _0x192d0c=_0x210d73[_0x51fb3e(0x14a6)][_0xed8d41][_0x51fb3e(0xd53)](_0x313ccd);_0x192d0c>-0x1&&_0x210d73[_0x51fb3e(0x14a6)][_0xed8d41][_0x51fb3e(0xdcc)](_0x192d0c,0x1);}!_0x210d73[_0x51fb3e(0x14a6)][_0x347f27]&&(_0x210d73[_0x51fb3e(0x14a6)][_0x347f27]=[]),_0x210d73['votes'][_0x347f27][_0x51fb3e(0x6bb)](_0x313ccd);}let _0x48118e=null;!_0x1f0c5c&&(_0x48118e=_0x51fb3e(0x28e)+_0x313ccd+_0x51fb3e(0x38a)+_0x347f27+_0x51fb3e(0x69a));if(_0x48118e){const _0x3aa6b8={'role':_0x51fb3e(0xaf6),'content':_0x48118e,'timestamp':Date[_0x51fb3e(0xecd)](),'isHidden':!![]};_0x5e1fa4['history'][_0x51fb3e(0x6bb)](_0x3aa6b8);}await _0x54c587[_0x51fb3e(0xbea)][_0x51fb3e(0x4cb)](_0x5e1fa4),_0x26354c(_0x4c8b14[_0x51fb3e(0x1539)]);}async function _0x540124(_0x5d7070){const _0x503a87=_0x239c7d,_0x36b966=_0x4c8b14['chats'][_0x4c8b14[_0x503a87(0x1539)]],_0x564e1b=_0x36b966[_0x503a87(0x92c)][_0x503a87(0x821)](_0x287524=>_0x287524[_0x503a87(0x287)]===_0x5d7070);if(!_0x564e1b||_0x564e1b[_0x503a87(0x3c0)])return;const _0x32b934=await _0x56d4d3(_0x503a87(0xfe6),_0x503a87(0xfde));if(_0x32b934){_0x564e1b['isClosed']=!![];const _0x52c1b5=_0x564e1b[_0x503a87(0x48e)][_0x503a87(0xd18)](_0x2b7f82=>'“'+_0x2b7f82+'”('+(_0x564e1b['votes'][_0x2b7f82]?.[_0x503a87(0x8d6)]||0x0)+'票)')[_0x503a87(0xee1)]('，'),_0x249801='[系统提示：用户手动结束了投票！最终结果为：'+_0x52c1b5+'。]',_0x4bd46f={'role':_0x503a87(0xaf6),'content':_0x249801,'timestamp':Date['now'](),'isHidden':!![]};_0x36b966[_0x503a87(0x92c)][_0x503a87(0x6bb)](_0x4bd46f),await _0x54c587[_0x503a87(0xbea)][_0x503a87(0x4cb)](_0x36b966),_0x26354c(_0x4c8b14[_0x503a87(0x1539)]);}}function _0x26d52b(_0x53ee35){const _0x46d930=_0x239c7d,_0x3b1e0e=_0x4c8b14[_0x46d930(0xbea)][_0x4c8b14[_0x46d930(0x1539)]],_0x4f95ac=_0x3b1e0e['history'][_0x46d930(0x821)](_0x43af89=>_0x43af89[_0x46d930(0x287)]===_0x53ee35);if(!_0x4f95ac||!_0x4f95ac[_0x46d930(0x3c0)])return;let _0x9abcd=_0x46d930(0x93b)+_0x4f95ac[_0x46d930(0xf96)]+'</strong></p><hr\x20style=\x22opacity:\x200.2;\x20margin:\x2010px\x200;\x22>';Object[_0x46d930(0x1161)](_0x4f95ac[_0x46d930(0x14a6)])['length']===0x0?_0x9abcd+=_0x46d930(0x13ae):_0x4f95ac['options'][_0x46d930(0xbdc)](_0x1e812d=>{const _0x21bed9=_0x46d930,_0x39c949=_0x4f95ac[_0x21bed9(0x14a6)][_0x1e812d]||[],_0x3e9216=_0x39c949[_0x21bed9(0xd18)](_0x4f68b5=>_0x288d80(_0x3b1e0e,_0x4f68b5))[_0x21bed9(0xee1)]('、\x20');_0x9abcd+=_0x21bed9(0xda8)+_0x1e812d+'\x20('+_0x39c949[_0x21bed9(0x8d6)]+'票)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2013px;\x20color:\x20#555;\x20margin:\x200;\x20line-height:\x201.5;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x39c949[_0x21bed9(0x8d6)]>0x0?_0x3e9216:_0x21bed9(0x605))+_0x21bed9(0x1370);}),_0x138765('投票结果',_0x9abcd);}function _0x2811ce(){const _0x10b8bd=_0x239c7d;if(!_0x4c8b14['activeChatId'])return;const _0x1a0725=_0x4c8b14[_0x10b8bd(0xbea)][_0x4c8b14[_0x10b8bd(0x1539)]];document['getElementById'](_0x10b8bd(0x14c7))[_0x10b8bd(0xde7)]='“'+_0x1a0725[_0x10b8bd(0xf3e)]+_0x10b8bd(0x7f4),_0x1cc0e9(),document['getElementById']('ai-avatar-library-modal')[_0x10b8bd(0xb08)][_0x10b8bd(0x12b6)]('visible');}function _0x1cc0e9(){const _0x2338a0=_0x239c7d,_0x50bf28=document[_0x2338a0(0x400)](_0x2338a0(0x482));_0x50bf28['innerHTML']='';const _0x16dc35=_0x4c8b14[_0x2338a0(0xbea)][_0x4c8b14[_0x2338a0(0x1539)]],_0x39bbaf=_0x16dc35[_0x2338a0(0xa37)][_0x2338a0(0x1080)]||[];if(_0x39bbaf[_0x2338a0(0x8d6)]===0x0){_0x50bf28[_0x2338a0(0x1575)]=_0x2338a0(0xcca);return;}_0x39bbaf[_0x2338a0(0xbdc)]((_0x1f578d,_0x15ee7a)=>{const _0x1a4ea1=_0x2338a0,_0x4cc98f=document['createElement']('div');_0x4cc98f[_0x1a4ea1(0x4e1)]='sticker-item',_0x4cc98f[_0x1a4ea1(0x647)]=_0x1f578d[_0x1a4ea1(0xf3e)],_0x4cc98f[_0x1a4ea1(0x1575)]=_0x1a4ea1(0xc6f)+_0x1f578d[_0x1a4ea1(0x299)]+_0x1a4ea1(0x8e9)+_0x1f578d[_0x1a4ea1(0xf3e)]+_0x1a4ea1(0x152e);const _0x448f68=document[_0x1a4ea1(0x2c9)](_0x1a4ea1(0xf8e));_0x448f68[_0x1a4ea1(0x4e1)]='delete-btn',_0x448f68[_0x1a4ea1(0x1575)]='×',_0x448f68['style'][_0x1a4ea1(0xb1a)]=_0x1a4ea1(0x1181),_0x448f68['onclick']=async _0x1fd2f6=>{const _0x1337b8=_0x1a4ea1;_0x1fd2f6['stopPropagation']();const _0x9322af=await _0x56d4d3(_0x1337b8(0x847),'确定要从头像库中删除“'+_0x1f578d['name']+_0x1337b8(0x1165),{'confirmButtonClass':_0x1337b8(0x142c)});_0x9322af&&(_0x16dc35[_0x1337b8(0xa37)]['aiAvatarLibrary']['splice'](_0x15ee7a,0x1),await _0x54c587[_0x1337b8(0xbea)][_0x1337b8(0x4cb)](_0x16dc35),_0x1cc0e9());},_0x4cc98f[_0x1a4ea1(0x8f2)](_0x448f68),_0x50bf28[_0x1a4ea1(0x8f2)](_0x4cc98f);});}async function _0x581a8e(){const _0x19c382=_0x239c7d,_0x4b0146=await _0x25f61f('添加头像','请为这个头像起个名字（例如：开心、哭泣）');if(!_0x4b0146||!_0x4b0146['trim']())return;const _0x2b90b0=await _0x25f61f(_0x19c382(0x9a6),_0x19c382(0x7c6),'',_0x19c382(0x299));if(!_0x2b90b0||!_0x2b90b0[_0x19c382(0xb8f)]()['startsWith'](_0x19c382(0x1471))){alert(_0x19c382(0x303));return;}const _0x5276ef=_0x4c8b14[_0x19c382(0xbea)][_0x4c8b14[_0x19c382(0x1539)]];!_0x5276ef[_0x19c382(0xa37)][_0x19c382(0x1080)]&&(_0x5276ef[_0x19c382(0xa37)][_0x19c382(0x1080)]=[]),_0x5276ef['settings'][_0x19c382(0x1080)][_0x19c382(0x6bb)]({'name':_0x4b0146['trim'](),'url':_0x2b90b0[_0x19c382(0xb8f)]()}),await _0x54c587[_0x19c382(0xbea)][_0x19c382(0x4cb)](_0x5276ef),_0x1cc0e9();}function _0x3a05cc(){const _0x3b63ee=_0x239c7d;document[_0x3b63ee(0x400)](_0x3b63ee(0xc9e))['classList']['remove'](_0x3b63ee(0x9eb));}function _0x259f3f(){const _0x2353ba=_0x239c7d;if(!_0x4c8b14[_0x2353ba(0x1539)])return;const _0x2c91f2=_0x4c8b14['chats'][_0x4c8b14[_0x2353ba(0x1539)]];document[_0x2353ba(0x400)](_0x2353ba(0x1044))[_0x2353ba(0xde7)]='“'+(_0x2c91f2[_0x2353ba(0xa37)]['myNickname']||'我')+_0x2353ba(0x7f4),_0xa9e850(),document[_0x2353ba(0x400)](_0x2353ba(0xaba))[_0x2353ba(0xb08)][_0x2353ba(0x12b6)](_0x2353ba(0x9eb));}function _0xa9e850(){const _0x3e6ddf=_0x239c7d,_0x4209a2=document[_0x3e6ddf(0x400)](_0x3e6ddf(0xab6));_0x4209a2[_0x3e6ddf(0x1575)]='';const _0x55018e=_0x4c8b14[_0x3e6ddf(0xbea)][_0x4c8b14[_0x3e6ddf(0x1539)]],_0x529aa0=_0x55018e[_0x3e6ddf(0xa37)]['myAvatarLibrary']||[];if(_0x529aa0[_0x3e6ddf(0x8d6)]===0x0){_0x4209a2[_0x3e6ddf(0x1575)]=_0x3e6ddf(0xcca);return;}_0x529aa0[_0x3e6ddf(0xbdc)]((_0x5edaf0,_0x4d17d8)=>{const _0x54abd5=_0x3e6ddf,_0x330f89=document['createElement'](_0x54abd5(0xf8e));_0x330f89[_0x54abd5(0x4e1)]=_0x54abd5(0x3d1),_0x330f89['title']=_0x5edaf0[_0x54abd5(0xf3e)],_0x330f89[_0x54abd5(0x1575)]=_0x54abd5(0xc6f)+_0x5edaf0[_0x54abd5(0x299)]+');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>'+_0x5edaf0[_0x54abd5(0xf3e)]+_0x54abd5(0x152e);const _0xffd8f6=document['createElement'](_0x54abd5(0xf8e));_0xffd8f6['className']=_0x54abd5(0x1205),_0xffd8f6[_0x54abd5(0x1575)]='×',_0xffd8f6[_0x54abd5(0xa00)][_0x54abd5(0xb1a)]=_0x54abd5(0x1181),_0xffd8f6[_0x54abd5(0x41b)]=async _0x596ea7=>{const _0x318726=_0x54abd5;_0x596ea7['stopPropagation']();const _0x2499b3=await _0x56d4d3('删除头像',_0x318726(0x1252)+_0x5edaf0[_0x318726(0xf3e)]+'”吗？',{'confirmButtonClass':_0x318726(0x142c)});_0x2499b3&&(_0x55018e['settings'][_0x318726(0x110f)][_0x318726(0xdcc)](_0x4d17d8,0x1),await _0x54c587[_0x318726(0xbea)]['put'](_0x55018e),_0xa9e850());},_0x330f89[_0x54abd5(0x8f2)](_0xffd8f6),_0x4209a2['appendChild'](_0x330f89);});}async function _0x42eec9(){const _0xfcbde2=_0x239c7d,_0x3f423b=await _0x25f61f(_0xfcbde2(0x9a6),_0xfcbde2(0x708));if(!_0x3f423b||!_0x3f423b[_0xfcbde2(0xb8f)]())return;const _0x4c48e7=await _0x25f61f(_0xfcbde2(0x9a6),_0xfcbde2(0x7c6),'',_0xfcbde2(0x299));if(!_0x4c48e7||!_0x4c48e7['trim']()[_0xfcbde2(0xbb9)](_0xfcbde2(0x1471))){alert(_0xfcbde2(0x303));return;}const _0x2fe5cd=_0x4c8b14['chats'][_0x4c8b14[_0xfcbde2(0x1539)]];!_0x2fe5cd['settings']['myAvatarLibrary']&&(_0x2fe5cd[_0xfcbde2(0xa37)][_0xfcbde2(0x110f)]=[]),_0x2fe5cd[_0xfcbde2(0xa37)][_0xfcbde2(0x110f)][_0xfcbde2(0x6bb)]({'name':_0x3f423b[_0xfcbde2(0xb8f)](),'url':_0x4c48e7['trim']()}),await _0x54c587[_0xfcbde2(0xbea)][_0xfcbde2(0x4cb)](_0x2fe5cd),_0xa9e850();}async function _0x384698(_0x13d02b){const _0x1f1ef0=_0x239c7d,_0x4b47dd=_0x13d02b['target'][_0x1f1ef0(0x780)][0x0];if(!_0x4b47dd)return;const _0x1311b6=await new Promise(_0x2d59aa=>{const _0x2b40c3=_0x1f1ef0,_0x31946e=new FileReader();_0x31946e[_0x2b40c3(0x9e0)]=()=>_0x2d59aa(_0x31946e[_0x2b40c3(0xdd1)]),_0x31946e[_0x2b40c3(0x157f)](_0x4b47dd);}),_0x1d02dd=await _0x25f61f(_0x1f1ef0(0x22f),_0x1f1ef0(0x14be));if(!_0x1d02dd||!_0x1d02dd['trim']())return;const _0x41f6ac=_0x4c8b14[_0x1f1ef0(0xbea)][_0x4c8b14[_0x1f1ef0(0x1539)]];!_0x41f6ac[_0x1f1ef0(0xa37)]['myAvatarLibrary']&&(_0x41f6ac[_0x1f1ef0(0xa37)]['myAvatarLibrary']=[]),_0x41f6ac[_0x1f1ef0(0xa37)][_0x1f1ef0(0x110f)][_0x1f1ef0(0x6bb)]({'name':_0x1d02dd['trim'](),'url':_0x1311b6}),await _0x54c587[_0x1f1ef0(0xbea)]['put'](_0x41f6ac),_0xa9e850(),_0x13d02b[_0x1f1ef0(0x657)]['value']=null;}async function _0x2e903b(_0x4c7d9d){const _0x508392=_0x239c7d,_0x41748f=_0x4c8b14[_0x508392(0xbea)][_0x4c8b14[_0x508392(0x1539)]];if(!_0x41748f)return;const _0x1deb33=_0x4c7d9d[_0x508392(0xb8f)]()[_0x508392(0x5ad)]('\x0a'),_0x318657=[],_0x38af1d=_0x508392(0x75d);let _0x467a3d=0x0;for(const _0x47d07a of _0x1deb33){const _0x436a7b=_0x47d07a[_0x508392(0xb8f)]();if(!_0x436a7b||_0x436a7b[_0x508392(0xd1b)]('http')||_0x436a7b[_0x508392(0xd1b)]('填入'))continue;let _0x4a0e79=null,_0x3ec5f8=null;const _0x4f59d9=_0x436a7b[_0x508392(0xbf7)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x4f59d9)_0x4a0e79=_0x4f59d9[0x1],_0x3ec5f8=_0x4f59d9[0x2];else{const _0xd50c1c=_0x436a7b['split'](/\s+/);_0xd50c1c[_0x508392(0x8d6)]>=0x2&&(_0x3ec5f8=_0xd50c1c[_0x508392(0x5ac)](),_0x4a0e79=_0xd50c1c[_0x508392(0xee1)]('\x20'));}_0x4a0e79&&_0x3ec5f8&&_0x3ec5f8[_0x508392(0xd1b)]('.')?_0x318657[_0x508392(0x6bb)]({'name':_0x4a0e79,'url':_0x38af1d+_0x3ec5f8}):_0x467a3d++;}if(_0x467a3d>0x0)await _0x138765(_0x508392(0x13f6),'有\x20'+_0x467a3d+'\x20行的格式不正确，已被跳过。');if(_0x318657[_0x508392(0x8d6)]>0x0){if(!_0x41748f[_0x508392(0xa37)][_0x508392(0x110f)])_0x41748f['settings'][_0x508392(0x110f)]=[];_0x41748f[_0x508392(0xa37)]['myAvatarLibrary']['push'](..._0x318657),await _0x54c587['chats'][_0x508392(0x4cb)](_0x41748f),_0xa9e850(),await _0x138765(_0x508392(0xa88),_0x508392(0xe1c)+_0x318657[_0x508392(0x8d6)]+_0x508392(0x360));}else _0x467a3d===0x0&&alert('没有找到可导入的内容。');}function _0x45577b(){const _0x253c56=_0x239c7d;document[_0x253c56(0x400)](_0x253c56(0xaba))['classList'][_0x253c56(0xc46)](_0x253c56(0x9eb));}function _0x45a8bb(){const _0x585410=_0x239c7d;if(!_0x4c8b14[_0x585410(0x1539)])return;const _0x422c9d=_0x4c8b14['chats'][_0x4c8b14[_0x585410(0x1539)]];document[_0x585410(0x400)](_0x585410(0x10d9))['textContent']='“'+_0x422c9d[_0x585410(0xf3e)]+'”的头像库',_0xd2fe27(),document[_0x585410(0x400)](_0x585410(0xd28))[_0x585410(0xb08)][_0x585410(0x12b6)](_0x585410(0x9eb));}function _0xd2fe27(){const _0x1ac46a=_0x239c7d,_0x25c0b6=document['getElementById'](_0x1ac46a(0xa28));_0x25c0b6['innerHTML']='';const _0x1f5671=_0x4c8b14[_0x1ac46a(0xbea)][_0x4c8b14[_0x1ac46a(0x1539)]],_0x542bb4=_0x1f5671[_0x1ac46a(0xa37)][_0x1ac46a(0x1634)]||[];if(_0x542bb4[_0x1ac46a(0x8d6)]===0x0){_0x25c0b6[_0x1ac46a(0x1575)]=_0x1ac46a(0xcca);return;}_0x542bb4[_0x1ac46a(0xbdc)]((_0x2ab203,_0x3b2c2c)=>{const _0x3321ae=_0x1ac46a,_0x171234=document['createElement'](_0x3321ae(0xf8e));_0x171234['className']=_0x3321ae(0x3d1),_0x171234[_0x3321ae(0x647)]=_0x2ab203[_0x3321ae(0xf3e)],_0x171234[_0x3321ae(0x1575)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url('+_0x2ab203[_0x3321ae(0x299)]+');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>'+_0x2ab203['name']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0x36d353=document[_0x3321ae(0x2c9)](_0x3321ae(0xf8e));_0x36d353[_0x3321ae(0x4e1)]='delete-btn',_0x36d353[_0x3321ae(0x1575)]='×',_0x36d353[_0x3321ae(0xa00)][_0x3321ae(0xb1a)]=_0x3321ae(0x1181),_0x36d353[_0x3321ae(0x41b)]=async _0x21ab6d=>{const _0x254478=_0x3321ae;_0x21ab6d[_0x254478(0x504)]();const _0x12c17f=await _0x56d4d3(_0x254478(0x847),_0x254478(0xfcd)+_0x2ab203['name']+_0x254478(0x1165),{'confirmButtonClass':_0x254478(0x142c)});_0x12c17f&&(_0x1f5671[_0x254478(0xa37)][_0x254478(0x1634)]['splice'](_0x3b2c2c,0x1),await _0x54c587[_0x254478(0xbea)][_0x254478(0x4cb)](_0x1f5671),_0xd2fe27());},_0x171234[_0x3321ae(0x8f2)](_0x36d353),_0x25c0b6[_0x3321ae(0x8f2)](_0x171234);});}async function _0x209ac3(){const _0xee3788=_0x239c7d,_0x46366b=await _0x25f61f(_0xee3788(0x9a6),_0xee3788(0x7dc));if(!_0x46366b||!_0x46366b[_0xee3788(0xb8f)]())return;const _0x5374d4=await _0x25f61f('添加头像',_0xee3788(0x7c6),'',_0xee3788(0x299));if(!_0x5374d4||!_0x5374d4[_0xee3788(0xb8f)]()[_0xee3788(0xbb9)](_0xee3788(0x1471))){alert('请输入有效的图片URL！');return;}const _0x1ee8ed=_0x4c8b14[_0xee3788(0xbea)][_0x4c8b14['activeChatId']];!_0x1ee8ed[_0xee3788(0xa37)][_0xee3788(0x1634)]&&(_0x1ee8ed[_0xee3788(0xa37)][_0xee3788(0x1634)]=[]),_0x1ee8ed['settings']['groupAvatarLibrary'][_0xee3788(0x6bb)]({'name':_0x46366b[_0xee3788(0xb8f)](),'url':_0x5374d4[_0xee3788(0xb8f)]()}),await _0x54c587[_0xee3788(0xbea)][_0xee3788(0x4cb)](_0x1ee8ed),_0xd2fe27();}function _0x1ab1f2(){const _0x533ea0=_0x239c7d;document['getElementById'](_0x533ea0(0xd28))[_0x533ea0(0xb08)][_0x533ea0(0xc46)](_0x533ea0(0x9eb));}async function _0x3d74fb(_0x3121fe){const _0x11b127=_0x239c7d,_0x14b85=_0x11b127(0xa8d),_0x5a1d36=await _0x25f61f(_0x11b127(0x3b2),_0x14b85,'',_0x11b127(0x79e));_0x5a1d36&&_0x5a1d36[_0x11b127(0xb8f)]()&&await _0x261e72(_0x3121fe,_0x5a1d36);}async function _0x261e72(_0x1c972b,_0x39dbcc){const _0xf3bc7f=_0x239c7d,_0x475d4e=_0x4c8b14['chats'][_0x4c8b14[_0xf3bc7f(0x1539)]];if(!_0x475d4e)return;const _0x576e7a=_0x39dbcc[_0xf3bc7f(0xb8f)]()[_0xf3bc7f(0x5ad)]('\x0a'),_0xee6156=[],_0x2c6ded=_0xf3bc7f(0x75d);let _0x294680=0x0;for(const _0x550a95 of _0x576e7a){const _0x20a9d4=_0x550a95['trim']();if(!_0x20a9d4||_0x20a9d4[_0xf3bc7f(0xd1b)](_0xf3bc7f(0x1471))||_0x20a9d4[_0xf3bc7f(0xd1b)]('填入'))continue;let _0x1594fd=null,_0x48e730=null;const _0x2e403a=_0x20a9d4[_0xf3bc7f(0xbf7)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x2e403a)_0x1594fd=_0x2e403a[0x1],_0x48e730=_0x2e403a[0x2];else{const _0x31d6de=_0x20a9d4[_0xf3bc7f(0x5ad)](/\s+/);_0x31d6de[_0xf3bc7f(0x8d6)]>=0x2&&(_0x48e730=_0x31d6de[_0xf3bc7f(0x5ac)](),_0x1594fd=_0x31d6de[_0xf3bc7f(0xee1)]('\x20'));}_0x1594fd&&_0x48e730&&_0x48e730[_0xf3bc7f(0xd1b)]('.')?_0xee6156[_0xf3bc7f(0x6bb)]({'name':_0x1594fd,'url':_0x2c6ded+_0x48e730}):(_0x294680++,console[_0xf3bc7f(0x75e)](_0xf3bc7f(0x14fe),_0x20a9d4));}_0x294680>0x0&&await _0x138765('部分导入失败','有\x20'+_0x294680+_0xf3bc7f(0x105c));if(_0xee6156['length']>0x0){if(_0x1c972b==='ai'){if(!_0x475d4e['settings'][_0xf3bc7f(0x1080)])_0x475d4e[_0xf3bc7f(0xa37)][_0xf3bc7f(0x1080)]=[];_0x475d4e['settings'][_0xf3bc7f(0x1080)][_0xf3bc7f(0x6bb)](..._0xee6156),await _0x54c587[_0xf3bc7f(0xbea)][_0xf3bc7f(0x4cb)](_0x475d4e),_0x1cc0e9();}else{if(_0x1c972b===_0xf3bc7f(0x1377)){if(!_0x475d4e[_0xf3bc7f(0xa37)]['groupAvatarLibrary'])_0x475d4e[_0xf3bc7f(0xa37)][_0xf3bc7f(0x1634)]=[];_0x475d4e['settings'][_0xf3bc7f(0x1634)][_0xf3bc7f(0x6bb)](..._0xee6156),await _0x54c587[_0xf3bc7f(0xbea)][_0xf3bc7f(0x4cb)](_0x475d4e),_0xd2fe27();}}await _0x138765(_0xf3bc7f(0xa88),_0xf3bc7f(0xe1c)+_0xee6156[_0xf3bc7f(0x8d6)]+_0xf3bc7f(0x360));}else _0x294680===0x0&&alert(_0xf3bc7f(0x13b2));}async function _0xaa1efc(){const _0x38cca0=_0x239c7d,_0x46837c=await _0x25f61f('添加头像','请为这个头像起个名字（例如：春日野餐、学习时间）');if(!_0x46837c||!_0x46837c['trim']())return;const _0x534732=await _0x25f61f('添加头像',_0x38cca0(0x7c6),'',_0x38cca0(0x299));if(!_0x534732||!_0x534732['trim']()[_0x38cca0(0xbb9)]('http')){alert(_0x38cca0(0x303));return;}const _0x5c143e=_0x4c8b14[_0x38cca0(0xbea)][_0x4c8b14[_0x38cca0(0x1539)]];!_0x5c143e[_0x38cca0(0xa37)]['groupAvatarLibrary']&&(_0x5c143e[_0x38cca0(0xa37)][_0x38cca0(0x1634)]=[]),_0x5c143e[_0x38cca0(0xa37)][_0x38cca0(0x1634)][_0x38cca0(0x6bb)]({'name':_0x46837c['trim'](),'url':_0x534732[_0x38cca0(0xb8f)]()}),await _0x54c587['chats'][_0x38cca0(0x4cb)](_0x5c143e),_0xd2fe27();}function _0x100b20(_0x316cbf){return new Promise(_0x500f39=>{const _0x5c4a3c=_0x466f,_0x7b123d=document[_0x5c4a3c(0x400)]('chat-list-actions-modal'),_0x5d1d2c=document['getElementById'](_0x5c4a3c(0x298)),_0x1f21e1=document['getElementById']('chat-list-action-delete'),_0x285985=document[_0x5c4a3c(0x400)]('chat-list-action-cancel');_0x5d1d2c[_0x5c4a3c(0xde7)]=_0x316cbf['isPinned']?_0x5c4a3c(0x8a0):_0x5c4a3c(0x268);const _0x1da20c=_0x5d1d2c['cloneNode'](!![]);_0x5d1d2c[_0x5c4a3c(0xa54)]['replaceChild'](_0x1da20c,_0x5d1d2c),_0x1da20c[_0x5c4a3c(0x41b)]=()=>{const _0x59bf6f=_0x5c4a3c;_0x7b123d[_0x59bf6f(0xb08)][_0x59bf6f(0xc46)](_0x59bf6f(0x9eb)),_0x500f39('pin');};const _0x35ed25=_0x1f21e1[_0x5c4a3c(0xdbc)](!![]);_0x1f21e1[_0x5c4a3c(0xa54)]['replaceChild'](_0x35ed25,_0x1f21e1),_0x35ed25[_0x5c4a3c(0x41b)]=()=>{const _0x1433a2=_0x5c4a3c;_0x7b123d[_0x1433a2(0xb08)][_0x1433a2(0xc46)](_0x1433a2(0x9eb)),_0x500f39('delete');};const _0x308058=_0x285985[_0x5c4a3c(0xdbc)](!![]);_0x285985[_0x5c4a3c(0xa54)][_0x5c4a3c(0xf6f)](_0x308058,_0x285985),_0x308058[_0x5c4a3c(0x41b)]=()=>{const _0x5a9c73=_0x5c4a3c;_0x7b123d[_0x5a9c73(0xb08)][_0x5a9c73(0xc46)]('visible'),_0x500f39(null);},_0x7b123d[_0x5c4a3c(0xb08)][_0x5c4a3c(0x12b6)](_0x5c4a3c(0x9eb));});}function _0x3ed28b(){const _0x158d23=_0x239c7d,_0x3d00d9=document[_0x158d23(0x400)](_0x158d23(0x1361)),_0x1cc5e4=_0x4c8b14[_0x158d23(0x14f1)][_0x158d23(0x67c)];_0x1cc5e4?_0x3d00d9['style']['backgroundImage']='url('+_0x1cc5e4+')':_0x3d00d9[_0x158d23(0xa00)][_0x158d23(0xf11)]='linear-gradient(135deg,\x20#f6d365,\x20#fda085)';}function _0xc8df8a(){const _0x442d6e=_0x239c7d;if(!_0x4c8b14['globalSettings'][_0x442d6e(0x5d8)])return;for(const _0x29548d in _0x4c8b14['globalSettings'][_0x442d6e(0x5d8)]){const _0xdf5ccf=document[_0x442d6e(0x400)](_0x442d6e(0x1690)+_0x29548d);_0xdf5ccf&&(_0xdf5ccf[_0x442d6e(0x912)]=_0x4c8b14['globalSettings'][_0x442d6e(0x5d8)][_0x29548d]);}}function _0xb27ef9(){const _0xb255e9=_0x239c7d,_0x410cf3=document[_0xb255e9(0x400)](_0xb255e9(0x950));if(!_0x410cf3)return;_0x410cf3[_0xb255e9(0x1575)]='';const _0x314558={'qq':'QQ','album':'相册','browser':_0xb255e9(0x6c3),'taobao':'淘宝','memo':_0xb255e9(0x130d),'diary':'日记','amap':_0xb255e9(0xe59),'usage':_0xb255e9(0x3f4),'music':_0xb255e9(0x10fd),'ephone':_0xb255e9(0x15ef)};for(const _0x3687ba in _0x4c8b14[_0xb255e9(0x14f1)][_0xb255e9(0x5d8)]){const _0x3e8b40=_0x4c8b14[_0xb255e9(0x14f1)]['cphoneAppIcons'][_0x3687ba],_0x4dccd5=_0x314558[_0x3687ba]||_0xb255e9(0x1060),_0x43be1f=document[_0xb255e9(0x2c9)](_0xb255e9(0xf8e));_0x43be1f['className']=_0xb255e9(0xf34),_0x43be1f[_0xb255e9(0xd61)][_0xb255e9(0x84f)]=_0x3687ba,_0x43be1f[_0xb255e9(0x1575)]=_0xb255e9(0x15c1)+_0x3e8b40+'\x22\x20alt=\x22'+_0x4dccd5+_0xb255e9(0x266),_0x410cf3[_0xb255e9(0x8f2)](_0x43be1f);}}function _0x45f4d0(){const _0x3b0e00=_0x239c7d;if(!_0x4c8b14[_0x3b0e00(0x14f1)][_0x3b0e00(0x10d4)])return;for(const _0x12e47d in _0x4c8b14[_0x3b0e00(0x14f1)][_0x3b0e00(0x10d4)]){const _0x4f2d37=document[_0x3b0e00(0x400)](_0x3b0e00(0xc50)+_0x12e47d);_0x4f2d37&&(_0x4f2d37['src']=_0x4c8b14[_0x3b0e00(0x14f1)][_0x3b0e00(0x10d4)][_0x12e47d]);}}function _0xa88122(){const _0x3e79b6=_0x239c7d,_0x1cf2c4=document[_0x3e79b6(0x400)](_0x3e79b6(0x69e));if(!_0x1cf2c4)return;_0x1cf2c4['innerHTML']='';const _0xc8ebdb={'qq':'QQ','world-book':_0x3e79b6(0x292),'wallpaper':_0x3e79b6(0x1647),'renderer':'渲染器','api-settings':'API设置','font':'字体','char-phone':'Cphone','douban':_0x3e79b6(0x10d0),'preset':'预设','tutorial':'教程','werewolf':_0x3e79b6(0xd7b),'x':'X'};for(const _0x37ca26 in _0x4c8b14[_0x3e79b6(0x14f1)][_0x3e79b6(0x10d4)]){const _0x1627de=_0x4c8b14[_0x3e79b6(0x14f1)]['appIcons'][_0x37ca26],_0x8c9aea=_0xc8ebdb[_0x37ca26]||_0x3e79b6(0x20f),_0x318e12=document[_0x3e79b6(0x2c9)](_0x3e79b6(0xf8e));_0x318e12['className']=_0x3e79b6(0xf34),_0x318e12['dataset'][_0x3e79b6(0x84f)]=_0x37ca26,_0x318e12[_0x3e79b6(0x1575)]=_0x3e79b6(0x15c1)+_0x1627de+_0x3e79b6(0x7fd)+_0x8c9aea+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1cf2c4[_0x3e79b6(0x8f2)](_0x318e12);}}function _0x102628(_0x37674e){const _0x50c1a1=_0x239c7d;if(!_0x4c8b14[_0x50c1a1(0x1539)])return;const _0x2d1329=_0x4c8b14[_0x50c1a1(0xbea)][_0x4c8b14[_0x50c1a1(0x1539)]];if(!_0x2d1329||!_0x2d1329[_0x50c1a1(0x92c)])return;const _0x3faa0b=_0x2d1329['history'][_0x50c1a1(0x821)](_0x20d851=>_0x20d851[_0x50c1a1(0x287)]===_0x37674e);if(!_0x3faa0b||_0x3faa0b[_0x50c1a1(0xbbf)]!==_0x50c1a1(0x4c1)){console[_0x50c1a1(0x5d7)](_0x50c1a1(0x7f2),_0x37674e);return;}document[_0x50c1a1(0x400)](_0x50c1a1(0xb40))[_0x50c1a1(0xde7)]=_0x3faa0b[_0x50c1a1(0x2ca)]||_0x50c1a1(0x381);const _0x348b06=document['getElementById'](_0x50c1a1(0xd73));_0x348b06[_0x50c1a1(0x1575)]=_0x50c1a1(0x15e5)+(_0x3faa0b['title']||_0x50c1a1(0xc0b))+_0x50c1a1(0x654)+(_0x3faa0b[_0x50c1a1(0x2ca)]||'未知')+_0x50c1a1(0x2c1)+(_0x3faa0b[_0x50c1a1(0x1109)]||_0x50c1a1(0x13e7))[_0x50c1a1(0xe19)](/\n/g,_0x50c1a1(0xd43))+_0x50c1a1(0xa79),_0x257d51('browser-screen');}function _0x3b4166(){_0x257d51('chat-interface-screen');}function _0x3b4166(){const _0x504e7d=_0x239c7d;_0x257d51(_0x504e7d(0x946));}function _0x21be24(){const _0x268769=_0x239c7d;if(!_0x4c8b14[_0x268769(0x1539)])return;document[_0x268769(0x400)]('link-title-input')[_0x268769(0xa1e)]='',document[_0x268769(0x400)](_0x268769(0x15e9))[_0x268769(0xa1e)]='',document[_0x268769(0x400)](_0x268769(0x206))[_0x268769(0xa1e)]='',document[_0x268769(0x400)]('link-content-input')[_0x268769(0xa1e)]='',document['getElementById'](_0x268769(0x544))['classList']['add'](_0x268769(0x9eb));}async function _0x340fee(){const _0x5ed88b=_0x239c7d;if(!_0x4c8b14['activeChatId'])return;const _0x4349f2=document[_0x5ed88b(0x400)]('link-title-input')[_0x5ed88b(0xa1e)][_0x5ed88b(0xb8f)]();if(!_0x4349f2){alert(_0x5ed88b(0x9c8));return;}const _0x41ff0c=document[_0x5ed88b(0x400)](_0x5ed88b(0x15e9))['value']['trim'](),_0x10d6fe=document[_0x5ed88b(0x400)]('link-source-input')['value'][_0x5ed88b(0xb8f)](),_0x1c361a=document[_0x5ed88b(0x400)]('link-content-input')[_0x5ed88b(0xa1e)][_0x5ed88b(0xb8f)](),_0xe0c0ba=_0x4c8b14[_0x5ed88b(0xbea)][_0x4c8b14[_0x5ed88b(0x1539)]],_0x2effe7={'role':_0x5ed88b(0x6d6),'type':_0x5ed88b(0x4c1),'timestamp':Date[_0x5ed88b(0xecd)](),'title':_0x4349f2,'description':_0x41ff0c,'source_name':_0x10d6fe,'content':_0x1c361a,'thumbnail_url':null};_0xe0c0ba[_0x5ed88b(0x92c)][_0x5ed88b(0x6bb)](_0x2effe7),await _0x54c587['chats'][_0x5ed88b(0x4cb)](_0xe0c0ba),_0x41ecc7(_0x2effe7,_0xe0c0ba),_0x41b828(),document[_0x5ed88b(0x400)](_0x5ed88b(0x544))[_0x5ed88b(0xb08)][_0x5ed88b(0xc46)](_0x5ed88b(0x9eb));}function _0x41e7bf(_0x3269c7,_0x3fa720){const _0x402fd3=_0x239c7d;if(!_0x3fa720||!_0x3fa720['id'])return[];const _0x402a40=_0x3fa720[_0x402fd3(0x1145)],_0x1f2806=_0x3fa720['id'];return _0x3269c7['filter'](_0x39d3a8=>{const _0x2f3d9e=_0x402fd3;if(_0x39d3a8[_0x2f3d9e(0x606)]===_0x2f3d9e(0x6d6)){if(_0x39d3a8['visibleGroupIds']&&_0x39d3a8[_0x2f3d9e(0x26b)][_0x2f3d9e(0x8d6)]>0x0)return _0x402a40&&_0x39d3a8[_0x2f3d9e(0x26b)][_0x2f3d9e(0xd1b)](_0x402a40);return!![];}if(String(_0x39d3a8[_0x2f3d9e(0x606)])[_0x2f3d9e(0xbb9)](_0x2f3d9e(0x1530))){if(Array['isArray'](_0x39d3a8[_0x2f3d9e(0x14b5)]))return _0x39d3a8[_0x2f3d9e(0x14b5)][_0x2f3d9e(0xd1b)](_0x1f2806);return![];}const _0x1ee847=_0x4c8b14['chats'][_0x39d3a8['authorId']];if(!_0x1ee847)return![];const _0x35786b=_0x1ee847[_0x2f3d9e(0x1145)],_0x3b4c02=_0x35786b&&_0x402a40&&_0x35786b===_0x402a40,_0x45a62e=!_0x35786b&&!_0x402a40;return _0x3b4c02||_0x45a62e;});}function _0x12d3df(_0x1fd989){const _0x47c9fb=_0x239c7d;document[_0x47c9fb(0x471)]['classList'][_0x47c9fb(0x146f)]('frame-mode-active',_0x1fd989);if(_0x59adb2[_0x47c9fb(0x11e7)]){const _0x2809b3=document[_0x47c9fb(0x400)](_0x47c9fb(0xee9)),_0x548d0a=document['getElementById'](_0x47c9fb(0x43a)),_0x4e8479=_0x4c8b14['globalSettings']['alwaysShowMusicIsland']||![];_0x1fd989?(_0x2809b3[_0x47c9fb(0xb08)][_0x47c9fb(0xc46)](_0x47c9fb(0x9eb)),_0x548d0a[_0x47c9fb(0xb08)][_0x47c9fb(0x12b6)]('dynamic-island-active')):(_0x548d0a[_0x47c9fb(0xb08)]['remove']('dynamic-island-active'),_0x4e8479?(_0x548d0a[_0x47c9fb(0xb08)][_0x47c9fb(0x12b6)](_0x47c9fb(0xa4b)),_0x2809b3[_0x47c9fb(0xb08)][_0x47c9fb(0xc46)](_0x47c9fb(0x9eb))):_0x59adb2[_0x47c9fb(0x7ee)]&&_0x59adb2['parsedLyrics']['length']>0x0&&_0x2809b3[_0x47c9fb(0xb08)][_0x47c9fb(0x12b6)](_0x47c9fb(0x9eb)));}}function _0x4459cc(_0x41a89d){const _0x585132=_0x239c7d;document['body']['classList']['toggle'](_0x585132(0x2d4),_0x41a89d);}function _0x45e8ca(_0x47e271){const _0x56fcb5=_0x239c7d;document[_0x56fcb5(0x471)][_0x56fcb5(0xb08)][_0x56fcb5(0x146f)](_0x56fcb5(0x9fb),_0x47e271);}function _0x3cf591(_0x2a73c2){const _0xedde3d=_0x239c7d,_0x3e7781=document[_0xedde3d(0x400)](_0xedde3d(0x43a)),_0x3afa62=document[_0xedde3d(0x400)](_0xedde3d(0xbd2)),_0x4d6efd=_0x2a73c2===_0xedde3d(0xc24);_0x3e7781[_0xedde3d(0xb08)]['toggle'](_0xedde3d(0x1457),_0x4d6efd),_0x3afa62&&(_0x3afa62[_0xedde3d(0x6f9)]=_0x4d6efd),localStorage[_0xedde3d(0x143f)](_0xedde3d(0x1401),_0x2a73c2);}function _0x1793a5(){const _0xc9049f=_0x239c7d,_0x4699b8=document[_0xc9049f(0x400)](_0xc9049f(0xbd2)),_0xd61af1=_0x4699b8[_0xc9049f(0x6f9)]?_0xc9049f(0xc24):_0xc9049f(0x3b3);_0x3cf591(_0xd61af1);}function _0x14774b(){const _0x48c3f0=_0x239c7d;if(!_0x4c8b14[_0x48c3f0(0x1539)])return;_0x4bb096(),_0x257d51(_0x48c3f0(0x837));}function _0x4bb096(){const _0x3371c7=_0x239c7d,_0x27388a=document['getElementById'](_0x3371c7(0xb82)),_0x197a10=_0x4c8b14['chats'][_0x4c8b14[_0x3371c7(0x1539)]];_0x27388a[_0x3371c7(0x1575)]='';let _0x23c277=[];_0x197a10[_0x3371c7(0xc98)]?_0x197a10[_0x3371c7(0x4f8)][_0x3371c7(0xbdc)](_0x3b5186=>{const _0x1f38e1=_0x3371c7,_0x1e233d=_0x4c8b14[_0x1f38e1(0xbea)][_0x3b5186['id']];if(_0x1e233d&&_0x1e233d[_0x1f38e1(0x1600)]){const _0x4717d1=_0x1e233d['longTermMemory']['map'](_0x2c1d70=>({..._0x2c1d70,'authorName':_0x3b5186[_0x1f38e1(0x7ca)],'authorChatId':_0x3b5186['id']}));_0x23c277['push'](..._0x4717d1);}}):_0x197a10[_0x3371c7(0x1600)]&&(_0x23c277=_0x197a10[_0x3371c7(0x1600)]['map'](_0x412487=>({..._0x412487,'authorName':_0x197a10['name'],'authorChatId':_0x197a10['id']})));if(_0x23c277[_0x3371c7(0x8d6)]===0x0){_0x27388a[_0x3371c7(0x1575)]=_0x3371c7(0x288);return;}_0x23c277[_0x3371c7(0x968)]((_0x2b914d,_0x36a6b1)=>_0x36a6b1[_0x3371c7(0x287)]-_0x2b914d['timestamp']),_0x23c277[_0x3371c7(0xbdc)]((_0x547825,_0x787af0)=>{const _0x591888=_0x3371c7,_0x2b3c70=document[_0x591888(0x2c9)](_0x591888(0xf8e));_0x2b3c70[_0x591888(0x4e1)]=_0x591888(0xedb),_0x2b3c70[_0x591888(0xa00)][_0x591888(0x214)]='default',_0x2b3c70['innerHTML']=_0x591888(0x565)+_0x547825[_0x591888(0xf93)]+_0x591888(0xd04)+_0x547825[_0x591888(0x1109)][_0x591888(0xe19)](/\n/g,'<br>')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x208px;\x20flex-shrink:\x200;\x20margin-left:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20edit-memory-btn\x22\x20data-author-id=\x22'+_0x547825[_0x591888(0xf8d)]+_0x591888(0x14b8)+_0x547825['timestamp']+'\x22\x20title=\x22编辑\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M11\x204H4a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2v-7\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M18.5\x202.5a2.121\x202.121\x200\x200\x201\x203\x203L12\x2015l-4\x201\x201-4\x209.5-9.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20delete-memory-btn\x22\x20data-author-id=\x22'+_0x547825[_0x591888(0xf8d)]+_0x591888(0x14b8)+_0x547825[_0x591888(0x287)]+_0x591888(0x115d),_0x27388a[_0x591888(0x8f2)](_0x2b3c70);});}async function _0x44cf94(){const _0x74d375=_0x239c7d,_0x2d09fa=_0x4c8b14[_0x74d375(0xbea)][_0x4c8b14[_0x74d375(0x1539)]];if(!_0x2d09fa)return;let _0x2e5102=_0x2d09fa;if(_0x2d09fa[_0x74d375(0xc98)]){const _0x4c1b30=_0x2d09fa[_0x74d375(0x4f8)][_0x74d375(0xd18)](_0x2548d8=>({'text':'为“'+_0x2548d8['groupNickname']+'”添加记忆','value':_0x2548d8['id']})),_0x15f435=await _0x14b058('选择记忆所属角色',_0x4c1b30);if(!_0x15f435)return;_0x2e5102=_0x4c8b14[_0x74d375(0xbea)][_0x15f435];if(!_0x2e5102){alert(_0x74d375(0x110c));return;}}const _0x261f9e=await _0x25f61f('为“'+_0x2e5102[_0x74d375(0xf3e)]+_0x74d375(0xa56),_0x74d375(0x10ad),'',_0x74d375(0x79e));if(_0x261f9e&&_0x261f9e['trim']()){if(!_0x2e5102[_0x74d375(0x1600)])_0x2e5102['longTermMemory']=[];_0x2e5102[_0x74d375(0x1600)][_0x74d375(0x6bb)]({'content':_0x261f9e['trim'](),'timestamp':Date[_0x74d375(0xecd)](),'source':_0x74d375(0x873)}),await _0x54c587[_0x74d375(0xbea)][_0x74d375(0x4cb)](_0x2e5102),_0x4bb096();}}async function _0x255743(_0x2adb53,_0x419ef5){const _0x550c01=_0x239c7d,_0xe889f2=_0x4c8b14[_0x550c01(0xbea)][_0x2adb53];if(!_0xe889f2||!_0xe889f2['longTermMemory'])return;const _0x1a037b=_0xe889f2[_0x550c01(0x1600)][_0x550c01(0x11a4)](_0x12a1bd=>_0x12a1bd[_0x550c01(0x287)]===_0x419ef5);if(_0x1a037b===-0x1)return;const _0x156af6=_0xe889f2[_0x550c01(0x1600)][_0x1a037b],_0x5ed7fe=await _0x25f61f(_0x550c01(0x13dc),_0x550c01(0x976),_0x156af6[_0x550c01(0x1109)],'textarea');_0x5ed7fe&&_0x5ed7fe[_0x550c01(0xb8f)]()&&(_0x156af6[_0x550c01(0x1109)]=_0x5ed7fe[_0x550c01(0xb8f)](),await _0x54c587[_0x550c01(0xbea)][_0x550c01(0x4cb)](_0xe889f2),_0x4bb096());}async function _0x2f188f(_0x41ee41,_0x55d60e){const _0x5cdb01=_0x239c7d,_0x179e9d=await _0x56d4d3('确认删除',_0x5cdb01(0x13e0),{'confirmButtonClass':_0x5cdb01(0x142c)});if(_0x179e9d){const _0x5cb002=_0x4c8b14[_0x5cdb01(0xbea)][_0x41ee41];if(!_0x5cb002||!_0x5cb002[_0x5cdb01(0x1600)])return;_0x5cb002[_0x5cdb01(0x1600)]=_0x5cb002[_0x5cdb01(0x1600)][_0x5cdb01(0x29d)](_0xa2f1da=>_0xa2f1da[_0x5cdb01(0x287)]!==_0x55d60e),await _0x54c587[_0x5cdb01(0xbea)]['put'](_0x5cb002),_0x4bb096();}}async function _0x43bc03(){const _0x132c97=_0x239c7d,_0x1dc5db=await _0x56d4d3(_0x132c97(0xe14),_0x132c97(0x103c));_0x1dc5db&&await _0x23db10(_0x4c8b14[_0x132c97(0x1539)],!![]);}async function _0x4373a4(_0x4c5bd4){const _0x5ac746=_0x239c7d,_0x52eef3=_0x4c8b14[_0x5ac746(0xbea)][_0x4c5bd4];if(!_0x52eef3||!_0x52eef3[_0x5ac746(0xa37)]['enableAutoMemory'])return;const _0x5c0abc=_0x52eef3['lastMemorySummaryTimestamp']||0x0,_0x4991fa=_0x52eef3[_0x5ac746(0x92c)]['filter'](_0x48ec92=>_0x48ec92[_0x5ac746(0x287)]>_0x5c0abc&&!_0x48ec92[_0x5ac746(0x118c)]);_0x4991fa['length']>=_0x52eef3['settings']['autoMemoryInterval']&&(console[_0x5ac746(0x1e6)]('达到自动总结阈值\x20('+_0x4991fa[_0x5ac746(0x8d6)]+'/'+_0x52eef3[_0x5ac746(0xa37)][_0x5ac746(0x9f1)]+_0x5ac746(0xadf)),await _0x23db10(_0x4c5bd4));}async function _0x32e80d(_0x473862,_0xdb2b69){const _0x4c428a=_0x239c7d,_0x3a06a9=_0x4c8b14['chats'][_0x473862];if(!_0x3a06a9||!_0xdb2b69)throw new Error(_0x4c428a(0xe54));const _0x37c65c=_0x3a06a9[_0x4c428a(0xa37)]['myNickname']||(_0x4c8b14[_0x4c428a(0x834)][_0x4c428a(0xbf3)]||'用户'),_0xfdd4fe=_0x4c8b14['worldBooks'][_0x4c428a(0x821)](_0x78a4b3=>_0x78a4b3['name']==='总结设定');let _0x240530='';if(_0xfdd4fe){const _0x1bbdd8=_0xfdd4fe['content'][_0x4c428a(0x29d)](_0x5572a9=>_0x5572a9[_0x4c428a(0x250)]!==![])['map'](_0x268310=>_0x268310['content'])['join']('\x0a');_0x1bbdd8&&(_0x240530=_0x4c428a(0x13bd)+_0x1bbdd8+'\x0a#\x20---\x0a');}let _0x34ce5d,_0x31e289=_0x3a06a9;const _0x1d7e86=new Date()[_0x4c428a(0x1100)](_0x4c428a(0x1271),{'year':_0x4c428a(0x1368),'month':_0x4c428a(0x1638),'day':_0x4c428a(0x1368)});if(_0x3a06a9[_0x4c428a(0xc98)]){let _0x43b477=null;_0x4037ab[_0x4c428a(0x496)]&&(_0x43b477=_0x3a06a9[_0x4c428a(0x4f8)][_0x4c428a(0x821)](_0x5d9817=>_0x5d9817[_0x4c428a(0xdcf)]===_0x4037ab['callRequester']));!_0x43b477&&(_0x43b477=_0x3a06a9[_0x4c428a(0x4f8)][_0x4c428a(0x821)](_0x351157=>_0x351157['id']!=='user'&&_0x4037ab[_0x4c428a(0x131d)][_0x4c428a(0x1412)](_0x21c1df=>_0x21c1df['id']===_0x351157['id'])));!_0x43b477&&(_0x43b477=_0x3a06a9[_0x4c428a(0x4f8)][_0x4c428a(0x821)](_0x358cf2=>_0x358cf2['id']!==_0x4c428a(0x6d6)));if(!_0x43b477)throw new Error(_0x4c428a(0xaf8));const _0x27e97f=_0x4c8b14['chats'][_0x43b477['id']];if(!_0x27e97f)throw new Error(_0x4c428a(0x981)+_0x43b477[_0x4c428a(0x7ca)]+_0x4c428a(0x116a));const _0x32691a=_0x3a06a9[_0x4c428a(0xa37)][_0x4c428a(0x2ef)]||_0x4c428a(0x638);let _0x53e6db='',_0x603b46='';_0x27e97f[_0x4c428a(0xa37)]['enableTimePerception']&&(_0x53e6db=_0x4c428a(0x66e)+_0x1d7e86+'**',_0x603b46=_0x4c428a(0xd8e)+_0x1d7e86+_0x4c428a(0x1154)),_0x34ce5d='\x0a'+_0x240530+'\x0a#\x20你的任务\x0a你就是角色“'+_0x43b477[_0x4c428a(0xdcf)]+'”。请你回顾一下刚才和\x20“'+_0x37c65c+_0x4c428a(0x50f)+_0x53e6db+'\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们在群聊通话里讨论了哪些核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a'+_0x603b46+_0x4c428a(0x1694)+_0x27e97f[_0x4c428a(0xa37)][_0x4c428a(0xfea)]+_0x4c428a(0xf89)+_0x32691a+'\x0a\x0a#\x20待总结的群组视频通话记录\x0a'+_0xdb2b69+_0x4c428a(0x96e)+_0x43b477[_0x4c428a(0xdcf)]+_0x4c428a(0x33f),_0x31e289=_0x27e97f;}else{let _0x727acd='',_0x4cf33e='';_0x3a06a9[_0x4c428a(0xa37)]['enableTimePerception']&&(_0x727acd=_0x4c428a(0x66e)+_0x1d7e86+'**',_0x4cf33e=_0x4c428a(0xd8e)+_0x1d7e86+'”这个信息，将其转换为【具体的公历日期】。'),_0x34ce5d='\x0a'+_0x240530+_0x4c428a(0xd19)+_0x3a06a9[_0x4c428a(0xdcf)]+'”。请你回顾一下刚才和“'+_0x37c65c+_0x4c428a(0x123a)+_0x727acd+'\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们聊了什么核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a'+_0x4cf33e+'\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a'+_0x3a06a9[_0x4c428a(0xa37)][_0x4c428a(0xfea)]+'\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a'+_0x3a06a9[_0x4c428a(0xa37)][_0x4c428a(0x2ef)]+_0x4c428a(0x14de)+_0xdb2b69+_0x4c428a(0x96e)+_0x3a06a9[_0x4c428a(0xdcf)]+'”的身份，开始你的客观总结。';}try{const _0x4fb016=_0x4c8b14[_0x4c428a(0x814)][_0x4c428a(0x12ee)]&&_0x4c8b14[_0x4c428a(0x814)]['secondaryApiKey']&&_0x4c8b14[_0x4c428a(0x814)]['secondaryModel'],{proxyUrl:_0x1fd0a9,apiKey:_0x4b3d1e,model:_0x198b92}=_0x4fb016?{'proxyUrl':_0x4c8b14[_0x4c428a(0x814)][_0x4c428a(0x12ee)],'apiKey':_0x4c8b14['apiConfig'][_0x4c428a(0x888)],'model':_0x4c8b14[_0x4c428a(0x814)][_0x4c428a(0xa22)]}:_0x4c8b14[_0x4c428a(0x814)];if(!_0x1fd0a9||!_0x4b3d1e||!_0x198b92)throw new Error(_0x4c428a(0x115a));let _0x31f22b=_0x1fd0a9['includes'](_0x4c428a(0x14cc)),_0x259af9=_0x3914a6(_0x198b92,_0x4b3d1e,_0x34ce5d,[{'role':_0x4c428a(0x6d6),'content':_0x4c428a(0xb37)}]);const _0x1b69a6=_0x31f22b?await fetch(_0x259af9[_0x4c428a(0x299)],_0x259af9[_0x4c428a(0x55b)]):await fetch(_0x1fd0a9+_0x4c428a(0x1611),{'method':_0x4c428a(0x953),'headers':{'Content-Type':_0x4c428a(0xfae),'Authorization':_0x4c428a(0xcee)+_0x4b3d1e},'body':JSON[_0x4c428a(0xea5)]({'model':_0x198b92,'messages':[{'role':_0x4c428a(0xaf6),'content':_0x34ce5d},{'role':_0x4c428a(0x6d6),'content':_0x4c428a(0xb37)}],'temperature':0.7})});if(!_0x1b69a6['ok']){const _0x323c06=await _0x1b69a6[_0x4c428a(0x15d3)]()['catch'](()=>({'error':{'message':_0x1b69a6['statusText']}}));throw new Error(_0x4c428a(0x1178)+_0x1b69a6[_0x4c428a(0x12c3)]+_0x4c428a(0x1477)+_0x323c06[_0x4c428a(0x5d7)][_0x4c428a(0x6e2)]);}const _0x5da33a=await _0x1b69a6[_0x4c428a(0x15d3)]();let _0x48b019=_0x31f22b?getGeminiResponseText(_0x5da33a):_0x5da33a[_0x4c428a(0xf7c)][0x0]['message'][_0x4c428a(0x1109)];_0x48b019=_0x48b019[_0x4c428a(0xe19)](/^```json\s*/,'')[_0x4c428a(0xe19)](/```$/,'')[_0x4c428a(0xb8f)]();const _0x2e3a3f=JSON['parse'](_0x48b019);if(_0x2e3a3f[_0x4c428a(0x877)]&&_0x2e3a3f[_0x4c428a(0x877)]['trim']()){const _0x32f413={'content':'(在那次'+(_0x3a06a9[_0x4c428a(0xc98)]?'群聊':'')+_0x4c428a(0xcd2)+_0x2e3a3f['summary']['trim']()+')','timestamp':Date[_0x4c428a(0xecd)](),'source':_0x3a06a9['isGroup']?_0x4c428a(0x1113):_0x4c428a(0xe60)};if(!_0x31e289['longTermMemory'])_0x31e289['longTermMemory']=[];return _0x31e289['longTermMemory']['push'](_0x32f413),await _0x54c587[_0x4c428a(0xbea)]['put'](_0x31e289),console['log'](_0x4c428a(0x134f)+_0x31e289['name']+_0x4c428a(0x10e3)),!![];}else throw new Error(_0x4c428a(0x743));}catch(_0x25ca0c){console[_0x4c428a(0x5d7)]('总结通话记录时出错:',_0x25ca0c);throw _0x25ca0c;}}function _0x4b553a(_0x2a4363){const _0x8216fa=_0x239c7d,_0x1299a2=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯','什么','怎么',_0x8216fa(0x1326),'哪个','一些','这个','那个','还有']),_0x433b93=_0x2a4363[_0x8216fa(0xbf7)](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x596a7f=new Map();let _0x3b4514=0x0;_0x433b93[_0x8216fa(0xbdc)](_0x5b418f=>{const _0x47ec33=_0x8216fa;if(_0x5b418f[_0x47ec33(0x8d6)]>0x1&&!_0x1299a2['has'](_0x5b418f)){const _0x1048b6=(_0x596a7f[_0x47ec33(0xf48)](_0x5b418f)||0x0)+0x1;_0x596a7f[_0x47ec33(0xfa3)](_0x5b418f,_0x1048b6);if(_0x1048b6>_0x3b4514)_0x3b4514=_0x1048b6;}});const _0x3c2e29=[],_0x502372=[],_0x75bf41=_0x3b4514*0.9,_0x4356a6=_0x3b4514*0.6;_0x596a7f[_0x8216fa(0xbdc)]((_0x3e20b2,_0x564cfa)=>{const _0x237bbb=_0x8216fa;if(_0x3e20b2>=_0x75bf41)_0x3c2e29[_0x237bbb(0x6bb)](_0x564cfa);else _0x3e20b2>=_0x4356a6&&_0x502372[_0x237bbb(0x6bb)](_0x564cfa);});const _0x272777=new Set(_0x3c2e29),_0x4372f5=_0x502372[_0x8216fa(0x29d)](_0x11ed1c=>!_0x272777[_0x8216fa(0x3e3)](_0x11ed1c))['slice'](0x0,0x5);return{'coreKeywords':_0x3c2e29[_0x8216fa(0x69f)](0x0,0x3),'situationalKeywords':_0x4372f5};}function _0x3eed43(_0x493d64,_0x2c8837,_0x59af0c){const _0x34fea9=_0x239c7d;let _0x3ca25d;_0x59af0c==='hours'?_0x3ca25d=Date['now']()-_0x2c8837*0x3c*0x3c*0x3e8:_0x3ca25d=Date['now']()-_0x2c8837*0x18*0x3c*0x3c*0x3e8;const _0x2b45b3=_0x493d64[_0x34fea9(0x92c)][_0x34fea9(0x29d)](_0x145e1b=>_0x145e1b['timestamp']>_0x3ca25d&&!_0x145e1b[_0x34fea9(0x118c)]);if(_0x2b45b3[_0x34fea9(0x8d6)]<0x3)return'';const _0x27a6d4=_0x2b45b3[_0x34fea9(0xd18)](_0x3681c4=>{const _0x4f52ea=_0x34fea9;if(typeof _0x3681c4[_0x4f52ea(0x1109)]==='string')return _0x3681c4['content'];if(_0x3681c4['type']==='voice_message')return _0x3681c4['content'];if(_0x3681c4[_0x4f52ea(0xbbf)]===_0x4f52ea(0x86e))return(_0x3681c4[_0x4f52ea(0xf2d)]||'')+'\x20'+(_0x3681c4[_0x4f52ea(0x12a5)]||'');return'';})['join']('\x20'),_0x24c4e8=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯']),_0xdc84a5=_0x27a6d4[_0x34fea9(0xbf7)](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x53cff6=new Map();_0xdc84a5[_0x34fea9(0xbdc)](_0x4fb07d=>{const _0x3d0a4d=_0x34fea9;_0x4fb07d['length']>0x1&&!_0x24c4e8[_0x3d0a4d(0x3e3)](_0x4fb07d)&&_0x53cff6[_0x3d0a4d(0xfa3)](_0x4fb07d,(_0x53cff6[_0x3d0a4d(0xf48)](_0x4fb07d)||0x0)+0x1);});const _0x27a216=[..._0x53cff6[_0x34fea9(0x9de)]()][_0x34fea9(0x968)]((_0x41f2af,_0x17cebf)=>_0x17cebf[0x1]-_0x41f2af[0x1])[_0x34fea9(0xd18)](_0x129762=>_0x129762[0x0]);if(_0x27a216[_0x34fea9(0x8d6)]===0x0)return'';let _0x383ff6;return _0x59af0c===_0x34fea9(0xf20)?_0x383ff6='最近'+_0x2c8837+_0x34fea9(0x237):_0x2c8837===0x1?_0x383ff6='本日核心议题':_0x383ff6='最近'+_0x2c8837+_0x34fea9(0x64f),_0x34fea9(0x1376)+_0x383ff6+_0x34fea9(0x395)+_0x27a216[_0x34fea9(0x69f)](0x0,0x3)['join']('、\x20')+_0x34fea9(0x512);}function _0x2128fd(_0x4680e9){const _0x2f0684=_0x239c7d;if(!_0x4680e9||typeof _0x4680e9!==_0x2f0684(0x158f))return null;const _0x166db9=_0x4680e9[_0x2f0684(0xe19)](/^```json\s*/,'')['replace'](/```$/,'')[_0x2f0684(0xb8f)](),_0x1ac75b=_0x166db9[_0x2f0684(0xbf7)](/{[\s\S]*}/);if(_0x1ac75b)try{const _0x3b23a1=JSON[_0x2f0684(0x13f7)](_0x1ac75b[0x0]);return console[_0x2f0684(0x1e6)]('容错解析：策略1成功\x20(找到并解析了完整的JSON对象)'),_0x3b23a1;}catch(_0x5191ce){console['warn'](_0x2f0684(0xa6b));}const _0xe7177a=_0x166db9[_0x2f0684(0xbf7)](/"summary"\s*:\s*"((?:[^"\\]|\\.)*)"/);if(_0xe7177a&&_0xe7177a[0x1])return console[_0x2f0684(0x1e6)]('容错解析：策略2成功\x20(提取了summary字段内容)'),{'summary':_0xe7177a[0x1][_0x2f0684(0xe19)](/\\"/g,'\x22')};if(_0x166db9)return console['log']('容错解析：策略3成功\x20(将整个返回文本作为摘要)'),{'summary':_0x166db9};return null;}async function _0x4fda4b(_0x47a06d){const _0x19141b=_0x239c7d;let _0x344689=_0x4c8b14[_0x19141b(0xbea)][_0x47a06d];if(!_0x344689)return;let _0x1435cf=_0x344689;if(_0x344689[_0x19141b(0xc98)]){const _0x50cf2e=_0x344689[_0x19141b(0x4f8)][_0x19141b(0xd18)](_0x559ea0=>{const _0x6ad4b=_0x19141b,_0x5b1766=_0x4c8b14[_0x6ad4b(0xbea)][_0x559ea0['id']];if(_0x5b1766&&_0x5b1766[_0x6ad4b(0x1600)]&&_0x5b1766[_0x6ad4b(0x1600)][_0x6ad4b(0x8d6)]>=0x2)return{'text':_0x6ad4b(0x4a1)+_0x559ea0[_0x6ad4b(0x7ca)]+_0x6ad4b(0x90b)+_0x5b1766[_0x6ad4b(0x1600)]['length']+'条)','value':_0x559ea0['id']};return null;})[_0x19141b(0x29d)](Boolean);if(_0x50cf2e[_0x19141b(0x8d6)]===0x0){alert('群聊中没有成员有足够（2条以上）的记忆可供精炼。');return;}const _0x160774=await _0x14b058(_0x19141b(0xa93),_0x50cf2e);if(!_0x160774)return;_0x1435cf=_0x4c8b14[_0x19141b(0xbea)][_0x160774];}if(!_0x1435cf[_0x19141b(0x1600)]||_0x1435cf[_0x19141b(0x1600)]['length']<0x2){alert('“'+_0x1435cf['name']+_0x19141b(0x4a7));return;}const _0x34377f=_0x1435cf[_0x19141b(0x1600)][_0x19141b(0x8d6)],_0x1989fb=await _0x14b058(_0x19141b(0x80e),[{'text':_0x19141b(0x36e)+_0x34377f+'条)','value':_0x19141b(0x875)},{'text':_0x19141b(0x741),'value':'20'},{'text':_0x19141b(0x354),'value':'50'},{'text':_0x19141b(0x9be),'value':'100'},{'text':'自定义数量...','value':_0x19141b(0x7da)}][_0x19141b(0x29d)](_0x32c25b=>_0x32c25b[_0x19141b(0xa1e)]===_0x19141b(0x875)||_0x32c25b[_0x19141b(0xa1e)]===_0x19141b(0x7da)||parseInt(_0x32c25b[_0x19141b(0xa1e)])<_0x34377f));if(_0x1989fb===null)return;let _0x2e82df,_0x1c2a08=_0x34377f;if(_0x1989fb===_0x19141b(0x875))_0x2e82df=[..._0x1435cf[_0x19141b(0x1600)]];else{if(_0x1989fb==='custom'){const _0x55e58b=await _0x25f61f(_0x19141b(0x10f3),_0x19141b(0x126e)+_0x34377f+'\x20条)');if(_0x55e58b===null)return;const _0x4777ca=parseInt(_0x55e58b);if(isNaN(_0x4777ca)||_0x4777ca<0x2||_0x4777ca>_0x34377f){alert(_0x19141b(0x15f7)+_0x34377f+_0x19141b(0x462));return;}_0x1c2a08=_0x4777ca,_0x2e82df=_0x1435cf[_0x19141b(0x1600)]['slice'](-_0x1c2a08);}else _0x1c2a08=parseInt(_0x1989fb),_0x1c2a08>=_0x34377f?(_0x2e82df=[..._0x1435cf['longTermMemory']],_0x1c2a08=_0x34377f):_0x2e82df=_0x1435cf[_0x19141b(0x1600)][_0x19141b(0x69f)](-_0x1c2a08);}const _0x49cd05=await _0x25f61f(_0x19141b(0xc18),'请输入精炼后核心记忆的大致字数：','150');if(_0x49cd05===null)return;const _0x5d71b0=parseInt(_0x49cd05);if(isNaN(_0x5d71b0)||_0x5d71b0<0x14){alert(_0x19141b(0x159a));return;}const _0x5c9df6=await _0x56d4d3('确认精炼记忆？',_0x19141b(0x66a)+_0x1c2a08+_0x19141b(0x5e0)+_0x5d71b0+_0x19141b(0x31e),{'confirmButtonClass':_0x19141b(0x142c),'confirmText':_0x19141b(0x14f6)});if(!_0x5c9df6)return;const _0x34ce6b=_0x2e82df[_0x19141b(0xd18)](_0x97b754=>'-\x20'+_0x97b754[_0x19141b(0x1109)])[_0x19141b(0xee1)]('\x0a'),_0x5d02a0=_0x1435cf['settings'][_0x19141b(0x14a8)]||(_0x4c8b14['qzoneSettings'][_0x19141b(0xbf3)]||'用户'),_0x36b3d0=new Date()['toLocaleDateString'](_0x19141b(0x1271),{'year':'numeric','month':_0x19141b(0x1638),'day':_0x19141b(0x1368)});let _0x483daf='',_0x544b19='';_0x1435cf['settings'][_0x19141b(0xabe)]&&(_0x483daf=_0x19141b(0x66e)+_0x36b3d0+'**',_0x544b19='3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果记忆中提到了相对时间（如“明天”、“下周”），你【必须】结合“今天是'+_0x36b3d0+'”这个信息，将其转换为【具体的公历日期】。');const _0x2e98ff=_0x4c8b14[_0x19141b(0xf57)][_0x19141b(0x821)](_0x4a5dd6=>_0x4a5dd6[_0x19141b(0xf3e)]===_0x19141b(0xb5c));let _0x2923e3='';if(_0x2e98ff){const _0x552b39=_0x2e98ff[_0x19141b(0x1109)]['filter'](_0x12e2a7=>_0x12e2a7[_0x19141b(0x250)]!==![])[_0x19141b(0xd18)](_0x2836e7=>_0x2836e7[_0x19141b(0x1109)])['join']('\x0a');_0x552b39&&(_0x2923e3=_0x19141b(0x13bd)+_0x552b39+_0x19141b(0x22c));}const _0x4f780d='\x0a'+_0x2923e3+_0x19141b(0xd19)+_0x1435cf[_0x19141b(0xdcf)]+_0x19141b(0x2a5)+_0x5d02a0+_0x19141b(0x49f)+_0x483daf+_0x19141b(0xa6c)+_0x544b19+_0x19141b(0x65d)+_0x5d71b0+'\x20字左右**。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a'+_0x1435cf[_0x19141b(0xa37)][_0x19141b(0xfea)]+_0x19141b(0xf89)+_0x1435cf[_0x19141b(0xa37)][_0x19141b(0x2ef)]+_0x19141b(0x4af)+_0x34ce6b+_0x19141b(0x96e)+_0x1435cf[_0x19141b(0xdcf)]+_0x19141b(0x1641);await _0x138765('请稍候...',_0x19141b(0xfc3));try{const _0x263348=_0x4c8b14[_0x19141b(0x814)][_0x19141b(0x12ee)]&&_0x4c8b14[_0x19141b(0x814)][_0x19141b(0x888)]&&_0x4c8b14[_0x19141b(0x814)][_0x19141b(0xa22)],{proxyUrl:_0x4fdeca,apiKey:_0x3f107c,model:_0x898e8a}=_0x263348?{'proxyUrl':_0x4c8b14[_0x19141b(0x814)]['secondaryProxyUrl'],'apiKey':_0x4c8b14['apiConfig']['secondaryApiKey'],'model':_0x4c8b14['apiConfig'][_0x19141b(0xa22)]}:_0x4c8b14['apiConfig'];if(!_0x4fdeca||!_0x3f107c||!_0x898e8a)throw new Error(_0x19141b(0xdc9));let _0x5c9456=_0x4fdeca[_0x19141b(0xd1b)](_0x19141b(0x14cc)),_0x4c133e=_0x3914a6(_0x898e8a,_0x3f107c,_0x4f780d,[{'role':_0x19141b(0x6d6),'content':'请开始整合。'}]);const _0x693904=_0x5c9456?await fetch(_0x4c133e[_0x19141b(0x299)],_0x4c133e[_0x19141b(0x55b)]):await fetch(_0x4fdeca+_0x19141b(0x1611),{'method':'POST','headers':{'Content-Type':_0x19141b(0xfae),'Authorization':'Bearer\x20'+_0x3f107c},'body':JSON[_0x19141b(0xea5)]({'model':_0x898e8a,'messages':[{'role':_0x19141b(0xaf6),'content':_0x4f780d},{'role':_0x19141b(0x6d6),'content':'请开始整合。'}],'temperature':0.7})});if(!_0x693904['ok'])throw new Error(_0x19141b(0x7d5)+_0x693904[_0x19141b(0x755)]);const _0x48ae6d=await _0x693904[_0x19141b(0x15d3)]();let _0x223f14=_0x5c9456?getGeminiResponseText(_0x48ae6d):_0x48ae6d[_0x19141b(0xf7c)][0x0][_0x19141b(0x6e2)]['content'];const _0xc5eee0=_0x2128fd(_0x223f14);if(_0xc5eee0&&_0xc5eee0[_0x19141b(0x877)]&&typeof _0xc5eee0[_0x19141b(0x877)]===_0x19141b(0x158f)&&_0xc5eee0[_0x19141b(0x877)]['trim']()){const _0x2a6821=await _0x56d4d3(_0x19141b(0x141b),_0x19141b(0x1074)+_0x1c2a08+'\x20条旧记忆总结为以下核心记忆：<br><br><div\x20class=\x22scrollable-content-preview\x22>'+_0xc5eee0[_0x19141b(0x877)]['trim']()+_0x19141b(0x686),{'confirmText':_0x19141b(0x8f9),'cancelText':'保留旧的','confirmButtonClass':_0x19141b(0x142c)});if(_0x2a6821){const _0x3c49e1={'content':_0xc5eee0['summary'][_0x19141b(0xb8f)](),'timestamp':Date[_0x19141b(0xecd)](),'source':_0x19141b(0x44f)},_0x54f80c=_0x34377f-_0x1c2a08,_0x45a93a=_0x54f80c>0x0?_0x1435cf[_0x19141b(0x1600)][_0x19141b(0x69f)](0x0,_0x54f80c):[];_0x1435cf[_0x19141b(0x1600)]=[..._0x45a93a,_0x3c49e1],_0x1435cf[_0x19141b(0x1382)]=Date[_0x19141b(0xecd)](),await _0x54c587['chats'][_0x19141b(0x4cb)](_0x1435cf),document[_0x19141b(0x400)](_0x19141b(0x837))['classList'][_0x19141b(0xd3f)](_0x19141b(0x5d6))&&_0x4bb096(),await _0x138765(_0x19141b(0x1402),_0x19141b(0xc1a)+_0x1c2a08+_0x19141b(0x1517));}else await _0x138765(_0x19141b(0xd47),_0x19141b(0x2f9));}else throw new Error(_0x19141b(0x743));}catch(_0xe81779){console['error'](_0x19141b(0xfb6),_0xe81779),await _0x138765(_0x19141b(0x248),_0x19141b(0xfcb)+_0xe81779['message']);}}async function _0x23db10(_0x177fd6,_0x5326f2=![]){const _0x4ab208=_0x239c7d,_0x10b125=_0x4c8b14[_0x4ab208(0xbea)][_0x177fd6];if(!_0x10b125)return;const _0x114db6=_0x10b125[_0x4ab208(0x1382)]||0x0,_0x26edc7=_0x5326f2?_0x10b125[_0x4ab208(0x92c)][_0x4ab208(0x29d)](_0x257ffd=>!_0x257ffd['isHidden']||_0x257ffd[_0x4ab208(0x71a)]==='system'&&_0x257ffd[_0x4ab208(0x1109)][_0x4ab208(0xd1b)](_0x4ab208(0xcd1)))[_0x4ab208(0x69f)](-(_0x10b125[_0x4ab208(0xa37)][_0x4ab208(0x9f1)]||0x14)):_0x10b125['history'][_0x4ab208(0x29d)](_0x2d06e2=>_0x2d06e2[_0x4ab208(0x287)]>_0x114db6&&(!_0x2d06e2[_0x4ab208(0x118c)]||_0x2d06e2[_0x4ab208(0x71a)]===_0x4ab208(0xaf6)&&_0x2d06e2[_0x4ab208(0x1109)][_0x4ab208(0xd1b)]('内心独白')));if(_0x26edc7[_0x4ab208(0x8d6)]<0x5){if(_0x5326f2)alert(_0x4ab208(0x596));return;}const _0x55447a=_0x10b125['settings'][_0x4ab208(0x14a8)]||(_0x4c8b14[_0x4ab208(0x834)][_0x4ab208(0xbf3)]||'用户'),_0x254666=_0x26edc7[0x0],_0x5103f3=_0x26edc7[_0x26edc7[_0x4ab208(0x8d6)]-0x1],_0x362ce9=_0x2b0b36=>new Date(_0x2b0b36)[_0x4ab208(0xad4)]('zh-CN',{'year':_0x4ab208(0x1368),'month':'2-digit','day':_0x4ab208(0x9f5),'hour':_0x4ab208(0x9f5),'minute':'2-digit','hour12':![]}),_0x5d36cf=_0x362ce9(_0x254666[_0x4ab208(0x287)])+_0x4ab208(0x234)+_0x362ce9(_0x5103f3[_0x4ab208(0x287)]),_0x44fd09=_0x26edc7[_0x4ab208(0xd18)](_0x2ac74a=>{const _0x52dcf4=_0x4ab208;if(_0x2ac74a['isHidden']&&_0x2ac74a[_0x52dcf4(0x71a)]==='system'&&_0x2ac74a[_0x52dcf4(0x1109)]['includes'](_0x52dcf4(0xcd1)))return _0x2ac74a[_0x52dcf4(0x1109)];if(_0x2ac74a[_0x52dcf4(0x118c)])return null;let _0x5063b3;_0x2ac74a[_0x52dcf4(0x71a)]===_0x52dcf4(0x6d6)?_0x5063b3=_0x55447a:_0x5063b3=_0x2ac74a[_0x52dcf4(0x3e7)]||_0x10b125[_0x52dcf4(0xdcf)];let _0x2ad691='';if(_0x2ac74a[_0x52dcf4(0x1406)]&&_0x2ac74a['quote'][_0x52dcf4(0x1109)]){let _0x2fa137=_0x2ac74a['quote'][_0x52dcf4(0x3e7)];_0x2ac74a[_0x52dcf4(0x1406)][_0x52dcf4(0x3e7)]===(_0x4c8b14[_0x52dcf4(0x834)][_0x52dcf4(0xbf3)]||'{{user}}')?_0x2fa137=_0x10b125[_0x52dcf4(0xc98)]?_0x10b125['settings'][_0x52dcf4(0x14a8)]||'我':'我':_0x2fa137=_0x288d80(_0x10b125,_0x2ac74a[_0x52dcf4(0x1406)][_0x52dcf4(0x3e7)]);let _0x283917=String(_0x2ac74a['quote'][_0x52dcf4(0x1109)])[_0x52dcf4(0x371)](0x0,0x1e);if(_0x283917[_0x52dcf4(0x8d6)]===0x1e)_0x283917+=_0x52dcf4(0x166b);_0x2ad691=_0x52dcf4(0xa45)+_0x2fa137+':\x20\x22'+_0x283917+'\x22]\x20';}let _0x43e734='';if(_0x2ac74a['type']===_0x52dcf4(0x86e)){if(_0x2ac74a['content'])_0x43e734=_0x2ac74a[_0x52dcf4(0x1109)];else{const _0x359495=_0x2ac74a[_0x52dcf4(0xf2d)]?'「'+_0x2ac74a[_0x52dcf4(0xf2d)]+'」':'',_0x1926b6=_0x2ac74a[_0x52dcf4(0x12a5)]?'('+_0x2ac74a[_0x52dcf4(0x12a5)]+')':'';_0x43e734=(_0x359495+'\x20'+_0x1926b6)['trim']();}}else{if(typeof _0x2ac74a[_0x52dcf4(0x1109)]===_0x52dcf4(0x158f))_0x43e734=_0x2ac74a[_0x52dcf4(0x1109)];else{if(_0x2ac74a['type']===_0x52dcf4(0x295))_0x43e734=_0x52dcf4(0x109d)+_0x2ac74a[_0x52dcf4(0x1109)]+']';else{if(_0x2ac74a[_0x52dcf4(0xbbf)]===_0x52dcf4(0xea7)||_0x2ac74a[_0x52dcf4(0xbbf)]===_0x52dcf4(0xdf3))_0x43e734=_0x52dcf4(0xfa8)+_0x2ac74a[_0x52dcf4(0x1109)]+']';else{if(_0x2ac74a[_0x52dcf4(0xbbf)]==='sticker')_0x43e734=_0x52dcf4(0x84c)+(_0x2ac74a['meaning']||'sticker')+']';else Array[_0x52dcf4(0x16a1)](_0x2ac74a[_0x52dcf4(0x1109)])?_0x43e734=_0x52dcf4(0x5d3):_0x43e734='['+(_0x2ac74a[_0x52dcf4(0xbbf)]||_0x52dcf4(0xce5))+']';}}}}const _0x590e88=new Date(_0x2ac74a[_0x52dcf4(0x287)])[_0x52dcf4(0x1306)](_0x52dcf4(0x1271),{'hour':'2-digit','minute':_0x52dcf4(0x9f5),'hour12':![]});return'['+_0x590e88+']\x20'+_0x5063b3+':\x20'+_0x2ad691+_0x43e734;})['filter'](Boolean)[_0x4ab208(0xee1)]('\x0a'),_0x5c4b04=_0x4c8b14[_0x4ab208(0xf57)][_0x4ab208(0x821)](_0x4e4b13=>_0x4e4b13[_0x4ab208(0xf3e)]==='总结设定');let _0x1414fe='';if(_0x5c4b04){const _0x125b35=_0x5c4b04[_0x4ab208(0x1109)]['filter'](_0x74de8b=>_0x74de8b[_0x4ab208(0x250)]!==![])['map'](_0x4c2ef3=>_0x4c2ef3[_0x4ab208(0x1109)])[_0x4ab208(0xee1)]('\x0a');_0x125b35&&(_0x1414fe=_0x4ab208(0x13bd)+_0x125b35+_0x4ab208(0x22c));}let _0x189bb2;if(_0x10b125[_0x4ab208(0xc98)]){let _0x3439d2='',_0x59a8ee='';_0x10b125[_0x4ab208(0xa37)][_0x4ab208(0xabe)]&&(_0x3439d2=_0x4ab208(0x296)+_0x5d36cf+'**',_0x59a8ee=_0x4ab208(0xc40)),_0x189bb2='\x0a'+_0x1414fe+_0x4ab208(0x1521)+_0x3439d2+_0x4ab208(0x148a)+_0x59a8ee+_0x4ab208(0x15f4)+_0x5d36cf[_0x4ab208(0x5ad)]('\x20')[0x0]+_0x4ab208(0x15f5)+_0x55447a+'在明天(需根据时间范围推算具体日期)单独见面。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a#\x20待总结的群聊记录\x0a'+_0x44fd09+_0x4ab208(0x509)+_0x10b125['members'][_0x4ab208(0xd18)](_0x192175=>'-\x20'+_0x192175['groupNickname']+_0x4ab208(0x319)+_0x192175[_0x4ab208(0xdcf)]+')')[_0x4ab208(0xee1)]('\x0a')+_0x4ab208(0x105f);}else{const _0x19cf27=new Date()[_0x4ab208(0x1100)](_0x4ab208(0x1271),{'year':_0x4ab208(0x1368),'month':_0x4ab208(0x1638),'day':'numeric'});let _0x43ddfc='',_0x23890f='';_0x10b125[_0x4ab208(0xa37)][_0x4ab208(0xabe)]&&(_0x43ddfc='\x0a#\x20对话时间范围\x0a-\x20**'+_0x5d36cf+'**',_0x23890f='3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果对话中提到了相对时间（如“明天”、“后天”），你【必须】结合上面的【对话时间范围】信息，将其转换为【具体的公历日期】。'),_0x189bb2='\x0a'+_0x1414fe+_0x4ab208(0xd19)+_0x10b125['originalName']+_0x4ab208(0xf3c)+_0x55447a+_0x4ab208(0x12a0)+_0x43ddfc+_0x4ab208(0x14b9)+_0x23890f+'\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份备忘录或要点记录，而不是一篇抒情散文。请尽量减少主观的心理感受描述，除非它直接导致了某个决定或计划。\x0a\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a'+_0x10b125[_0x4ab208(0xa37)][_0x4ab208(0xfea)]+_0x4ab208(0x15d7)+_0x10b125[_0x4ab208(0xa37)][_0x4ab208(0x2ef)]+_0x4ab208(0xce3)+_0x44fd09+_0x4ab208(0x96e)+_0x10b125[_0x4ab208(0xdcf)]+_0x4ab208(0x33f);}try{const _0x9f58ac=_0x4c8b14[_0x4ab208(0x814)][_0x4ab208(0x12ee)]&&_0x4c8b14[_0x4ab208(0x814)][_0x4ab208(0x888)]&&_0x4c8b14[_0x4ab208(0x814)]['secondaryModel'],{proxyUrl:_0x282714,apiKey:_0x1761d1,model:_0x44f69b}=_0x9f58ac?{'proxyUrl':_0x4c8b14['apiConfig']['secondaryProxyUrl'],'apiKey':_0x4c8b14[_0x4ab208(0x814)][_0x4ab208(0x888)],'model':_0x4c8b14[_0x4ab208(0x814)][_0x4ab208(0xa22)]}:_0x4c8b14[_0x4ab208(0x814)];if(!_0x282714||!_0x1761d1||!_0x44f69b)throw new Error('API未配置');let _0x55579e=_0x282714[_0x4ab208(0xd1b)](_0x4ab208(0x14cc)),_0x19e0d7=_0x3914a6(_0x44f69b,_0x1761d1,_0x189bb2,[{'role':'user','content':_0x4ab208(0xb37)}]);const _0x114efd=_0x55579e?await fetch(_0x19e0d7[_0x4ab208(0x299)],_0x19e0d7[_0x4ab208(0x55b)]):await fetch(_0x282714+_0x4ab208(0x1611),{'method':_0x4ab208(0x953),'headers':{'Content-Type':_0x4ab208(0xfae),'Authorization':_0x4ab208(0xcee)+_0x1761d1},'body':JSON[_0x4ab208(0xea5)]({'model':_0x44f69b,'messages':[{'role':_0x4ab208(0xaf6),'content':_0x189bb2},{'role':_0x4ab208(0x6d6),'content':_0x4ab208(0xb37)}],'temperature':0.7})});if(!_0x114efd['ok'])throw new Error(_0x4ab208(0x7d5)+_0x114efd[_0x4ab208(0x755)]);const _0x22be55=await _0x114efd[_0x4ab208(0x15d3)]();let _0x889796=_0x55579e?getGeminiResponseText(_0x22be55):_0x22be55[_0x4ab208(0xf7c)][0x0][_0x4ab208(0x6e2)][_0x4ab208(0x1109)];_0x889796=_0x889796[_0x4ab208(0xe19)](/^```json\s*/,'')['replace'](/```$/,'')[_0x4ab208(0xb8f)]();const _0x46a375=JSON[_0x4ab208(0x13f7)](_0x889796);if(_0x10b125[_0x4ab208(0xc98)]){if(_0x46a375[_0x4ab208(0x1137)]&&typeof _0x46a375[_0x4ab208(0x1137)]===_0x4ab208(0xfc4)){let _0x176f89=0x0;for(const _0xf74eab in _0x46a375[_0x4ab208(0x1137)]){const _0x28479a=_0x46a375[_0x4ab208(0x1137)][_0xf74eab];if(_0x28479a&&_0x28479a['trim']()){const _0x36bb4c=Object[_0x4ab208(0x40a)](_0x4c8b14[_0x4ab208(0xbea)])[_0x4ab208(0x821)](_0x297155=>_0x297155[_0x4ab208(0xdcf)]===_0xf74eab);if(_0x36bb4c){const _0x1abc22={'content':_0x28479a[_0x4ab208(0xb8f)](),'timestamp':Date[_0x4ab208(0xecd)](),'source':_0x4ab208(0x116d)+_0x10b125[_0x4ab208(0xf3e)]};if(!_0x36bb4c[_0x4ab208(0x1600)])_0x36bb4c['longTermMemory']=[];_0x36bb4c['longTermMemory'][_0x4ab208(0x6bb)](_0x1abc22),await _0x54c587['chats'][_0x4ab208(0x4cb)](_0x36bb4c),_0x176f89++;}}}if(_0x176f89>0x0)console[_0x4ab208(0x1e6)]('自动总结成功：为\x20'+_0x176f89+'\x20位群成员生成并注入了个性化记忆！');else throw new Error(_0x4ab208(0x743));}else throw new Error(_0x4ab208(0xbf6));}else{if(_0x46a375['summary']&&_0x46a375['summary'][_0x4ab208(0xb8f)]()){const _0x6af21f={'content':_0x46a375[_0x4ab208(0x877)][_0x4ab208(0xb8f)](),'timestamp':Date['now'](),'source':_0x4ab208(0x5b5)};_0x10b125[_0x4ab208(0x1600)][_0x4ab208(0x6bb)](_0x6af21f),await _0x54c587['chats'][_0x4ab208(0x4cb)](_0x10b125),console[_0x4ab208(0x1e6)](_0x4ab208(0x586));}else throw new Error('AI返回了空的或格式不正确的总结内容。');}_0x10b125[_0x4ab208(0x1382)]=_0x26edc7[_0x4ab208(0x69f)](-0x1)[0x0]['timestamp'],await _0x54c587['chats'][_0x4ab208(0x4cb)](_0x10b125),document[_0x4ab208(0x400)]('long-term-memory-screen')[_0x4ab208(0xb08)][_0x4ab208(0xd3f)]('active')&&_0x4bb096();}catch(_0x4c1805){console[_0x4ab208(0x5d7)](_0x4ab208(0x159c),_0x4c1805),await _0x138765(_0x4ab208(0xa82),_0x4ab208(0xb80)+_0x4c1805['message']);}}function _0x28c19d(){const _0x395666=_0x239c7d;if(!_0x465ba7)return;const _0x31d031=_0x4c8b14['chats'][_0x4c8b14[_0x395666(0x1539)]],_0x277f8e=_0x31d031[_0x395666(0x92c)][_0x395666(0x821)](_0x30ac69=>_0x30ac69[_0x395666(0x287)]===_0x465ba7&&!_0x30ac69[_0x395666(0x118c)]);if(!_0x277f8e)return;let _0x369a5e;_0x277f8e[_0x395666(0x71a)]==='user'?_0x369a5e=_0x31d031[_0x395666(0xc98)]?_0x31d031[_0x395666(0xa37)][_0x395666(0x14a8)]||'我':'我':_0x31d031[_0x395666(0xc98)]?_0x369a5e=_0x288d80(_0x31d031,_0x277f8e['senderName']):_0x369a5e=_0x31d031[_0x395666(0xf3e)];const _0x464508=String(_0x277f8e[_0x395666(0x1109)]||'');let _0x2787da='';if(typeof _0x277f8e[_0x395666(0x1109)]==='string'&&_0x12f2a0[_0x395666(0x2c0)](_0x277f8e[_0x395666(0x1109)]))_0x2787da=_0x395666(0x450);else{if(_0x277f8e[_0x395666(0xbbf)]==='ai_image'||_0x277f8e[_0x395666(0xbbf)]===_0x395666(0xdf3))_0x2787da=_0x395666(0x5d3);else _0x277f8e[_0x395666(0xbbf)]===_0x395666(0x295)?_0x2787da=_0x395666(0xe09):_0x2787da=_0x464508[_0x395666(0x371)](0x0,0x32)+(_0x464508['length']>0x32?_0x395666(0x166b):'');}_0x2e2491={'timestamp':_0x277f8e[_0x395666(0x287)],'senderName':_0x369a5e,'content':_0x464508};const _0x293782=document['getElementById']('reply-preview-bar');_0x293782[_0x395666(0x13ef)](_0x395666(0x426))[_0x395666(0xde7)]=_0x395666(0x135f)+_0x2e2491['senderName']+':',_0x293782[_0x395666(0x13ef)](_0x395666(0x1397))[_0x395666(0xde7)]=_0x2787da,_0x293782[_0x395666(0xa00)][_0x395666(0xb1a)]=_0x395666(0x1181),_0x4f08fc(),document[_0x395666(0x400)]('chat-input')[_0x395666(0x797)]();}function _0x288b5f(){const _0x31b42c=_0x239c7d;_0x2e2491=null,document[_0x31b42c(0x400)](_0x31b42c(0x3f5))[_0x31b42c(0xa00)][_0x31b42c(0xb1a)]=_0x31b42c(0x165b);}let _0xe0d963=null;function _0x55f11a(_0x3bc8ca){const _0x2bbcd8=_0x239c7d;_0xe0d963=_0x3bc8ca;const _0x13c359=_0x4c8b14[_0x2bbcd8(0xbea)][_0x4c8b14[_0x2bbcd8(0x1539)]],_0x461b46=_0x13c359['history'][_0x2bbcd8(0x821)](_0x5df359=>_0x5df359[_0x2bbcd8(0x287)]===_0x3bc8ca);_0x461b46&&(document[_0x2bbcd8(0x400)](_0x2bbcd8(0x574))[_0x2bbcd8(0xde7)]=_0x461b46[_0x2bbcd8(0x3e7)]),document['getElementById'](_0x2bbcd8(0x53e))[_0x2bbcd8(0xb08)][_0x2bbcd8(0x12b6)](_0x2bbcd8(0x9eb));}function _0x268ad6(){const _0x2ceb6f=_0x239c7d;document[_0x2ceb6f(0x400)](_0x2ceb6f(0x53e))[_0x2ceb6f(0xb08)]['remove'](_0x2ceb6f(0x9eb)),_0xe0d963=null;}async function _0x1d70c8(_0x54d2bc){const _0x2a5f36=_0x239c7d;if(!_0xe0d963)return;const _0x5c4517=_0xe0d963,_0x57cb4d=_0x4c8b14['chats'][_0x4c8b14[_0x2a5f36(0x1539)]],_0x2b9d93=_0x57cb4d['history'][_0x2a5f36(0x11a4)](_0x24b248=>_0x24b248[_0x2a5f36(0x287)]===_0x5c4517);if(_0x2b9d93===-0x1)return;const _0x9aaf4e=_0x57cb4d['history'][_0x2b9d93];_0x9aaf4e[_0x2a5f36(0x12c3)]=_0x54d2bc;let _0x13997f;if(_0x54d2bc===_0x2a5f36(0x81f)){const _0x55c95d={'role':_0x2a5f36(0x6d6),'type':_0x2a5f36(0x112f),'isRefund':!![],'amount':_0x9aaf4e[_0x2a5f36(0x12e7)],'note':_0x2a5f36(0x2e8),'timestamp':Date[_0x2a5f36(0xecd)]()};_0x57cb4d[_0x2a5f36(0x92c)][_0x2a5f36(0x6bb)](_0x55c95d),_0x13997f=_0x2a5f36(0xa4c)+_0x9aaf4e[_0x2a5f36(0x3e7)]+_0x2a5f36(0x118d);}else _0x13997f=_0x2a5f36(0xae4)+_0x9aaf4e[_0x2a5f36(0x3e7)]+_0x2a5f36(0x118d);const _0x11b470={'role':_0x2a5f36(0xaf6),'content':_0x13997f,'timestamp':Date['now']()+0x1,'isHidden':!![]};_0x57cb4d[_0x2a5f36(0x92c)]['push'](_0x11b470),await _0x54c587[_0x2a5f36(0xbea)][_0x2a5f36(0x4cb)](_0x57cb4d),_0x268ad6(),_0x26354c(_0x4c8b14['activeChatId']),_0x41b828();}async function _0x4edde2(){const _0x39d41e=_0x239c7d;_0x257d51(_0x39d41e(0xe16));const _0x14a3b2=document[_0x39d41e(0x400)](_0x39d41e(0x715)),_0x5f0c56=document['getElementById'](_0x39d41e(0xe0a));_0x14a3b2[_0x39d41e(0x1575)]='',_0x5f0c56[_0x39d41e(0xde7)]=_0x39d41e(0x731);const _0x2c4bc5=await _0x54c587['callRecords'][_0x39d41e(0x541)](_0x39d41e(0x287))[_0x39d41e(0xfc1)]()['toArray']();if(_0x2c4bc5[_0x39d41e(0x8d6)]===0x0){_0x14a3b2[_0x39d41e(0x1575)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有通话记录哦~</p>';return;}_0x2c4bc5[_0x39d41e(0xbdc)](_0x243c4f=>{const _0x281b48=_0x3fa84c(_0x243c4f);_0x3d4218(_0x281b48,async()=>{const _0x5c1f42=_0x466f,_0x271592=await _0x25f61f(_0x5c1f42(0x7eb),_0x5c1f42(0x338),_0x243c4f[_0x5c1f42(0x60a)]||'');if(_0x271592===null)return;await _0x54c587['callRecords'][_0x5c1f42(0x126d)](_0x243c4f['id'],{'customName':_0x271592['trim']()}),await _0x4edde2(),await _0x138765('成功','通话名称已更新！');}),_0x14a3b2['appendChild'](_0x281b48);});}function _0x3fa84c(_0x305da9){const _0x2647a0=_0x239c7d,_0x143697=document['createElement'](_0x2647a0(0xf8e));_0x143697[_0x2647a0(0x4e1)]='call-record-card',_0x143697[_0x2647a0(0xd61)][_0x2647a0(0x83d)]=_0x305da9['id'];const _0x3059d5=_0x4c8b14[_0x2647a0(0xbea)][_0x305da9['chatId']],_0x186759=_0x3059d5?_0x3059d5[_0x2647a0(0xf3e)]:_0x2647a0(0xa0b),_0x1aac40=new Date(_0x305da9[_0x2647a0(0x287)]),_0x4f6e27=_0x1aac40[_0x2647a0(0x1619)]()+'-'+String(_0x1aac40['getMonth']()+0x1)['padStart'](0x2,'0')+'-'+String(_0x1aac40[_0x2647a0(0xd00)]())['padStart'](0x2,'0')+'\x20'+String(_0x1aac40[_0x2647a0(0x331)]())[_0x2647a0(0xb7d)](0x2,'0')+':'+String(_0x1aac40[_0x2647a0(0x1297)]())[_0x2647a0(0xb7d)](0x2,'0'),_0x220c26=Math[_0x2647a0(0x1381)](_0x305da9[_0x2647a0(0x4ee)]/0x3c)+'分'+_0x305da9[_0x2647a0(0x4ee)]%0x3c+'秒',_0x18b508=_0x305da9[_0x2647a0(0x131d)][_0x2647a0(0xd18)](_0x4e4aef=>_0x2647a0(0x97d)+_0x4e4aef['avatar']+'\x22\x20alt=\x22'+_0x4e4aef[_0x2647a0(0xf3e)]+_0x2647a0(0x11a7)+_0x4e4aef[_0x2647a0(0xf3e)]+'\x22>')[_0x2647a0(0xee1)]('');return _0x143697[_0x2647a0(0x1575)]=_0x2647a0(0xaa9)+_0x4f6e27+_0x2647a0(0x45b)+_0x220c26+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改】在这里新增一个标题行\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x305da9[_0x2647a0(0x60a)]?_0x2647a0(0x222)+_0x305da9[_0x2647a0(0x60a)]+_0x2647a0(0x11ac):'')+_0x2647a0(0xb50)+_0x18b508+_0x2647a0(0x618)+_0x186759+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x143697;}async function _0x1a5a54(_0xf35576){const _0x5d6c64=_0x239c7d,_0x1637ff=await _0x54c587[_0x5d6c64(0x688)][_0x5d6c64(0xf48)](_0xf35576);if(!_0x1637ff)return;const _0x4e13b0=document[_0x5d6c64(0x400)](_0x5d6c64(0xb71)),_0x3c424b=document['getElementById'](_0x5d6c64(0xa3b)),_0x2d06a1=document[_0x5d6c64(0x400)](_0x5d6c64(0xe5c));_0x3c424b[_0x5d6c64(0xde7)]='通话于\x20'+new Date(_0x1637ff[_0x5d6c64(0x287)])[_0x5d6c64(0xad4)]()+'\x20(时长:\x20'+Math['floor'](_0x1637ff['duration']/0x3c)+'分'+_0x1637ff[_0x5d6c64(0x4ee)]%0x3c+'秒)',_0x2d06a1['innerHTML']='';const _0x112b9e=document[_0x5d6c64(0x400)](_0x5d6c64(0x91b)),_0x5c63f2=document['getElementById']('manual-summarize-btn');!_0x1637ff[_0x5d6c64(0x1045)]||_0x1637ff['transcript'][_0x5d6c64(0x8d6)]===0x0?(_0x2d06a1[_0x5d6c64(0x1575)]=_0x5d6c64(0x6d9),_0x5c63f2[_0x5d6c64(0xa00)][_0x5d6c64(0xb1a)]=_0x5d6c64(0x165b)):(_0x5c63f2[_0x5d6c64(0xa00)][_0x5d6c64(0xb1a)]=_0x5d6c64(0x1181),_0x1637ff['transcript']['forEach'](_0x1c6e96=>{const _0x5a5ba3=_0x5d6c64,_0x1b1939=document[_0x5a5ba3(0x2c9)]('div');_0x1b1939[_0x5a5ba3(0x4e1)]=_0x5a5ba3(0x29c)+_0x1c6e96[_0x5a5ba3(0x71a)],_0x1b1939[_0x5a5ba3(0xde7)]=_0x1c6e96[_0x5a5ba3(0x1109)],_0x2d06a1[_0x5a5ba3(0x8f2)](_0x1b1939);}));const _0x54692c=_0x112b9e[_0x5d6c64(0xdbc)](!![]);_0x112b9e[_0x5d6c64(0xa54)][_0x5d6c64(0xf6f)](_0x54692c,_0x112b9e);const _0x4154b2=_0x5c63f2[_0x5d6c64(0xdbc)](!![]);_0x5c63f2[_0x5d6c64(0xa54)][_0x5d6c64(0xf6f)](_0x4154b2,_0x5c63f2),_0x54692c['addEventListener'](_0x5d6c64(0x15ad),async()=>{const _0x3449ac=_0x5d6c64,_0x506ae7=await _0x56d4d3(_0x3449ac(0x713),'确定要永久删除这条通话记录吗？此操作不可恢复。',{'confirmButtonClass':_0x3449ac(0x142c)});_0x506ae7&&(_0x4e13b0['classList'][_0x3449ac(0xc46)](_0x3449ac(0x9eb)),await _0x54c587[_0x3449ac(0x688)][_0x3449ac(0x942)](_0xf35576),await _0x4edde2(),alert(_0x3449ac(0xede)));}),_0x4154b2[_0x5d6c64(0x501)](_0x5d6c64(0x15ad),async()=>{const _0x28c65b=_0x5d6c64,_0x1598a9=await _0x56d4d3('确认操作','这将提取当前通话记录发送给AI进行总结，会消耗API额度。确定要继续吗？',{'confirmText':_0x28c65b(0x1214)});if(!_0x1598a9)return;_0x4e13b0[_0x28c65b(0xb08)][_0x28c65b(0xc46)]('visible');const _0x13a700=_0x4c8b14[_0x28c65b(0xbea)][_0x1637ff[_0x28c65b(0x4dd)]];if(!_0x13a700){alert('错误：找不到该通话记录所属的聊天对象。');return;}await _0x138765(_0x28c65b(0x13e9),_0x28c65b(0x66d));try{const _0x4c104f=_0x1637ff[_0x28c65b(0x1045)][_0x28c65b(0xd18)](_0x97c05f=>{const _0x4d85f2=_0x28c65b,_0x11a25d=_0x97c05f[_0x4d85f2(0x71a)]===_0x4d85f2(0x6d6)?_0x13a700['settings']['myNickname']||'我':_0x97c05f[_0x4d85f2(0x3e7)]||_0x13a700[_0x4d85f2(0xf3e)];return _0x11a25d+':\x20'+_0x97c05f[_0x4d85f2(0x1109)];})['join']('\x0a');await _0x32e80d(_0x1637ff['chatId'],_0x4c104f),await _0x138765(_0x28c65b(0x1265),_0x28c65b(0x477)+_0x13a700[_0x28c65b(0xf3e)]+'”的长期记忆中。');}catch(_0x24312b){await _0x138765('总结失败','操作失败，未能生成长期记忆。\x0a\x0a错误详情:\x20'+_0x24312b[_0x28c65b(0x6e2)]);}});const _0x44a9d1=document[_0x5d6c64(0x400)](_0x5d6c64(0x15b8)),_0x23b654=_0x44a9d1[_0x5d6c64(0xdbc)](!![]);_0x44a9d1[_0x5d6c64(0xa54)][_0x5d6c64(0xf6f)](_0x23b654,_0x44a9d1),_0x23b654[_0x5d6c64(0x501)](_0x5d6c64(0x15ad),()=>{const _0x5cf0fe=_0x5d6c64;_0x4e13b0[_0x5cf0fe(0xb08)]['remove']('visible');}),_0x4e13b0[_0x5d6c64(0xb08)][_0x5d6c64(0x12b6)]('visible');}async function _0x1e5005(){const _0x9e1d35=_0x239c7d;if(!_0x4c8b14['activeChatId']||_0x4c8b14[_0x9e1d35(0xbea)][_0x4c8b14[_0x9e1d35(0x1539)]]['isGroup'])return;const _0x62763b=_0x4c8b14[_0x9e1d35(0xbea)][_0x4c8b14[_0x9e1d35(0x1539)]],_0x2f67de=await _0x25f61f(_0x9e1d35(0x937),_0x9e1d35(0x550),_0x62763b[_0x9e1d35(0x12c3)][_0x9e1d35(0x117f)]);_0x2f67de!==null&&(_0x62763b[_0x9e1d35(0x12c3)]['text']=_0x2f67de['trim']()||'在线',_0x62763b[_0x9e1d35(0x12c3)][_0x9e1d35(0x6db)]=![],_0x62763b['status'][_0x9e1d35(0x2b5)]=Date[_0x9e1d35(0xecd)](),await _0x54c587[_0x9e1d35(0xbea)][_0x9e1d35(0x4cb)](_0x62763b),_0x26354c(_0x4c8b14[_0x9e1d35(0x1539)]),_0x41b828(),await _0x138765('状态已更新','“'+_0x62763b[_0x9e1d35(0xf3e)]+_0x9e1d35(0xfc9)+_0x62763b[_0x9e1d35(0x12c3)][_0x9e1d35(0x117f)]));}async function _0x38a281(){const _0x383db2=_0x239c7d,_0x166f42=document['getElementById']('share-target-modal'),_0x10c916=document[_0x383db2(0x400)](_0x383db2(0x857));_0x10c916[_0x383db2(0x1575)]='';const _0x1ee83a=Object[_0x383db2(0x40a)](_0x4c8b14['chats']);_0x1ee83a[_0x383db2(0xbdc)](_0x16e6ae=>{const _0x4f0485=_0x383db2,_0x3a7fa6=document[_0x4f0485(0x2c9)](_0x4f0485(0xf8e));_0x3a7fa6[_0x4f0485(0x4e1)]=_0x4f0485(0x1427),_0x3a7fa6[_0x4f0485(0x1575)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22share-target-checkbox\x22\x20data-chat-id=\x22'+_0x16e6ae['id']+'\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x16e6ae['isGroup']?_0x16e6ae['settings'][_0x4f0485(0x465)]:_0x16e6ae['settings'][_0x4f0485(0xb24)]||_0x91d058)+_0x4f0485(0x1004)+_0x16e6ae[_0x4f0485(0xf3e)]+_0x4f0485(0x313),_0x10c916['appendChild'](_0x3a7fa6);}),_0x166f42['classList'][_0x383db2(0x12b6)](_0x383db2(0x9eb));}function _0x3a94e8(_0x53e385){const _0x7444e2=_0x239c7d,_0x17c653=document[_0x7444e2(0x400)](_0x7444e2(0x144c));if(!_0x17c653[_0x7444e2(0xb08)][_0x7444e2(0xd3f)](_0x7444e2(0x9eb))){if(_0x53e385)_0x53e385();return;}_0x17c653[_0x7444e2(0xb08)][_0x7444e2(0xc46)](_0x7444e2(0x9eb)),setTimeout(()=>{const _0x576e23=_0x7444e2;document[_0x576e23(0x400)]('music-playlist-panel')['classList'][_0x576e23(0xc46)](_0x576e23(0x9eb));if(_0x53e385)_0x53e385();},0x190);}function _0x4a1132(_0x47b085){const _0x1eed09=_0x239c7d;if(!_0x47b085)return[];const _0x3ae735=String(_0x47b085)['split'](/\r\n?|\n/),_0x3ec9c4=[],_0x281df5=/\[(\d{2}):(\d{2})[.:](\d{2,3})\]/g;for(const _0x144b48 of _0x3ae735){const _0x37d290=_0x144b48['replace'](_0x281df5,'')[_0x1eed09(0xb8f)]();if(!_0x37d290)continue;_0x281df5[_0x1eed09(0x12a3)]=0x0;let _0x192413;while((_0x192413=_0x281df5[_0x1eed09(0x1097)](_0x144b48))!==null){const _0x59c962=parseInt(_0x192413[0x1],0xa),_0x403595=parseInt(_0x192413[0x2],0xa),_0x1fdca4=parseInt(_0x192413[0x3][_0x1eed09(0x379)](0x3,'0'),0xa),_0x13529c=_0x59c962*0x3c+_0x403595+_0x1fdca4/0x3e8;_0x3ec9c4['push']({'time':_0x13529c,'text':_0x37d290});}}return _0x3ec9c4[_0x1eed09(0x968)]((_0x582a88,_0xba1f06)=>_0x582a88['time']-_0xba1f06[_0x1eed09(0xc27)]);}function _0x5c4970(){const _0x92787=_0x239c7d,_0x1a4b03=document['getElementById']('music-lyrics-list');_0x1a4b03[_0x92787(0x1575)]='';if(!_0x59adb2[_0x92787(0x7ee)]||_0x59adb2['parsedLyrics'][_0x92787(0x8d6)]===0x0){_0x1a4b03['innerHTML']=_0x92787(0x122b);return;}_0x59adb2['parsedLyrics'][_0x92787(0xbdc)]((_0x92d0c8,_0x1aaed0)=>{const _0x41d37c=_0x92787,_0x545d3=document[_0x41d37c(0x2c9)](_0x41d37c(0xf8e));_0x545d3[_0x41d37c(0x4e1)]=_0x41d37c(0x1346),_0x545d3['textContent']=_0x92d0c8['text'],_0x545d3['dataset'][_0x41d37c(0x103b)]=_0x1aaed0,_0x1a4b03[_0x41d37c(0x8f2)](_0x545d3);}),_0x1a4b03[_0x92787(0xa00)]['transform']=_0x92787(0xb1f);}function _0x35971e(){}function _0x23804e(){const _0x328fd4=_0x239c7d;if(!islandLyricText||!islandLyricContainer)return;const _0x33bc09=islandLyricText[_0x328fd4(0xdfb)],_0x1a5a17=islandLyricContainer[_0x328fd4(0x13aa)];if(_0x33bc09>_0x1a5a17){const _0x50fe36=_0x33bc09/_0x1a5a17,_0x1eac60=Math[_0x328fd4(0x124e)](0x5,_0x50fe36*0x5);islandLyricText[_0x328fd4(0xa00)][_0x328fd4(0x132a)](_0x328fd4(0xb92),_0x1eac60+'s'),islandLyricText[_0x328fd4(0xa00)][_0x328fd4(0x132a)](_0x328fd4(0x126c),_0x1a5a17+'px'),islandLyricText[_0x328fd4(0xa00)][_0x328fd4(0x132a)]('--text-width',_0x33bc09+'px'),islandLyricText['classList'][_0x328fd4(0x12b6)](_0x328fd4(0xe5b));}else islandLyricText[_0x328fd4(0xb08)]['remove'](_0x328fd4(0xe5b));}function _0x359f87(_0x1f2556){const _0x1678fb=_0x239c7d;if(_0x59adb2[_0x1678fb(0x7ee)][_0x1678fb(0x8d6)]===0x0)return;let _0x2b5d44=-0x1;for(let _0x50850f=0x0;_0x50850f<_0x59adb2[_0x1678fb(0x7ee)][_0x1678fb(0x8d6)];_0x50850f++){if(_0x1f2556>=_0x59adb2[_0x1678fb(0x7ee)][_0x50850f][_0x1678fb(0xc27)])_0x2b5d44=_0x50850f;else break;}if(_0x2b5d44===_0x59adb2['currentLyricIndex'])return;_0x59adb2[_0x1678fb(0xb7b)]=_0x2b5d44,_0x3be08a();const _0x542005=document[_0x1678fb(0x400)]('single-lyric-display');_0x542005&&(_0x2b5d44>-0x1&&_0x59adb2['parsedLyrics'][_0x2b5d44]?_0x542005['textContent']=_0x59adb2[_0x1678fb(0x7ee)][_0x2b5d44]['text']:_0x542005[_0x1678fb(0xde7)]=_0x1678fb(0xf38));const _0x110f3c=document[_0x1678fb(0x400)](_0x1678fb(0xee9));_0x110f3c[_0x1678fb(0xb08)][_0x1678fb(0xd3f)](_0x1678fb(0x9eb))&&(_0x2b5d44>-0x1&&_0x59adb2[_0x1678fb(0x7ee)][_0x2b5d44]?_0x110f3c[_0x1678fb(0xde7)]=_0x59adb2['parsedLyrics'][_0x2b5d44][_0x1678fb(0x117f)]:_0x110f3c[_0x1678fb(0xde7)]='♪');if(phoneScreenForIsland['classList'][_0x1678fb(0xd3f)]('dynamic-island-active')){const _0x234884=_0x2b5d44>-0x1&&_0x59adb2[_0x1678fb(0x7ee)][_0x2b5d44]?_0x59adb2[_0x1678fb(0x7ee)][_0x2b5d44]['text']:'♪\x20♪\x20♪',_0x11bfdf=islandLyricText[_0x1678fb(0x13ef)]('span:first-child');if(_0x11bfdf&&_0x11bfdf[_0x1678fb(0xde7)]===_0x234884)return;islandLyricText['style'][_0x1678fb(0xbfa)]=0x0,setTimeout(()=>{const _0x21a418=_0x1678fb;islandLyricText[_0x21a418(0xb08)]['remove']('scrolling'),islandLyricContainer['classList']['remove'](_0x21a418(0x161a)),islandLyricText[_0x21a418(0xa00)][_0x21a418(0xc3b)]=_0x21a418(0x165b);let _0x429f5b=islandLyricText['querySelector']('span:first-child'),_0x1f8dc2=islandLyricText[_0x21a418(0x13ef)](_0x21a418(0x74c));!_0x429f5b&&(_0x429f5b=document[_0x21a418(0x2c9)]('span'),islandLyricText[_0x21a418(0x8f2)](_0x429f5b));!_0x1f8dc2&&(_0x1f8dc2=document[_0x21a418(0x2c9)]('span'),islandLyricText['appendChild'](_0x1f8dc2));_0x429f5b[_0x21a418(0xde7)]=_0x234884,_0x1f8dc2[_0x21a418(0xde7)]=_0x234884;const _0x3f1c5e=_0x429f5b[_0x21a418(0xeeb)],_0x405e32=islandLyricContainer[_0x21a418(0x13aa)];if(_0x3f1c5e>_0x405e32){const _0x18ca66=_0x3f1c5e/_0x405e32,_0x50a8ea=Math[_0x21a418(0x124e)](0x5,_0x18ca66*0x5);islandLyricText['style'][_0x21a418(0x132a)](_0x21a418(0x16a3),_0x50a8ea+'s'),islandLyricText[_0x21a418(0xb08)][_0x21a418(0x12b6)](_0x21a418(0xe5b)),islandLyricText[_0x21a418(0xa00)][_0x21a418(0xc3b)]=_0x21a418(0x124d);}else islandLyricContainer[_0x21a418(0xb08)][_0x21a418(0x12b6)](_0x21a418(0x161a));islandLyricText[_0x21a418(0xa00)][_0x21a418(0xbfa)]=0x1;},0xc8);}}function _0x3be08a(_0x3fcef0=![]){const _0xf477a=_0x239c7d,_0x2fb30e=_0x3fcef0?_0xf477a(0xc8c):_0xf477a(0x1092),_0x3bb308=_0x3fcef0?'#fullscreen-lyrics-container':'#music-lyrics-container',_0x5803fa=document[_0xf477a(0x13ef)](_0x2fb30e),_0x50ebf1=document[_0xf477a(0x13ef)](_0x3bb308);if(!_0x5803fa||!_0x50ebf1)return;const _0xb3a416=_0x5803fa['querySelectorAll'](_0xf477a(0x1591));_0xb3a416[_0xf477a(0xbdc)](_0x1a42c3=>_0x1a42c3[_0xf477a(0xb08)][_0xf477a(0xc46)](_0xf477a(0x5d6)));if(_0x59adb2['currentLyricIndex']===-0x1){_0x5803fa[_0xf477a(0xa00)][_0xf477a(0x8ea)]=_0xf477a(0xb1f);return;}const _0x953fba=_0x5803fa[_0xf477a(0x13ef)]('.lyric-line[data-index=\x22'+_0x59adb2[_0xf477a(0xb7b)]+'\x22]');if(_0x953fba){_0x953fba[_0xf477a(0xb08)]['add'](_0xf477a(0x5d6));const _0x1ae85e=_0x50ebf1[_0xf477a(0x1134)],_0x4becf5=_0x1ae85e/2.2-_0x953fba[_0xf477a(0xf1b)]-_0x953fba[_0xf477a(0x1134)]/0x2;_0x5803fa[_0xf477a(0xa00)][_0xf477a(0x8ea)]=_0xf477a(0x75a)+_0x4becf5+_0xf477a(0x11e8);}}function _0xb1f354(_0x2e67e5){const _0x4ac56d=_0x239c7d;if(isNaN(_0x2e67e5)||_0x2e67e5<0x0)return _0x4ac56d(0xa15);const _0x599a4c=Math[_0x4ac56d(0x1381)](_0x2e67e5/0x3c),_0x1ca986=Math[_0x4ac56d(0x1381)](_0x2e67e5%0x3c);return _0x599a4c+':'+String(_0x1ca986)[_0x4ac56d(0xb7d)](0x2,'0');}let _0x11ca65=0x0,_0x5a3fb1;function _0x51fff8(){_0x5a3fb1&&cancelAnimationFrame(_0x5a3fb1);function _0x131d94(){const _0x3b7f5c=_0x466f;if(!_0x59adb2[_0x3b7f5c(0x138e)]||!_0x86eb29['duration'])return;const _0x2d5b24=performance[_0x3b7f5c(0xecd)](),_0x25890f=_0x86eb29['currentTime'],_0x1d93ea=_0x86eb29[_0x3b7f5c(0x4ee)],_0x1ecb20=_0x25890f/_0x1d93ea*0x64;document[_0x3b7f5c(0x400)](_0x3b7f5c(0xedf))['style'][_0x3b7f5c(0x1383)]=_0x1ecb20+'%',_0x2d5b24-_0x11ca65>0x3e8&&(document[_0x3b7f5c(0x400)]('music-current-time')[_0x3b7f5c(0xde7)]=_0xb1f354(_0x25890f),document[_0x3b7f5c(0x400)](_0x3b7f5c(0xae8))[_0x3b7f5c(0xde7)]=_0xb1f354(_0x1d93ea),_0x359f87(_0x25890f),_0x35971e(),_0x11ca65=_0x2d5b24),_0x5a3fb1=requestAnimationFrame(_0x131d94);}_0x5a3fb1=requestAnimationFrame(_0x131d94);}function _0x143f54(){const _0x438740=_0x239c7d;if(!lastRawAiResponse){alert(_0x438740(0x1299));return;}const _0x31f23b=document['getElementById']('ai-response-editor-modal'),_0x247806=document[_0x438740(0x400)](_0x438740(0xe88));_0x247806[_0x438740(0x1575)]='';const _0x31d136=_0x57a22a(lastRawAiResponse);if(_0x31d136&&_0x31d136[_0x438740(0x8d6)]>0x0)_0x31d136[_0x438740(0xbdc)](_0x2e261d=>{const _0xd2dbed=_0x438740;if(typeof _0x2e261d===_0xd2dbed(0xfc4)&&_0x2e261d!==null)try{const _0x190955=JSON[_0xd2dbed(0xea5)](_0x2e261d,null,0x2),_0x5e193c=_0x27b58d(_0x190955);_0x247806[_0xd2dbed(0x8f2)](_0x5e193c);}catch(_0x2fe17a){console[_0xd2dbed(0x5d7)](_0xd2dbed(0xaf4),_0x2e261d,_0x2fe17a);}else{if(typeof _0x2e261d===_0xd2dbed(0x158f)){const _0x48a9cd=_0x27b58d(_0x2e261d);_0x247806[_0xd2dbed(0x8f2)](_0x48a9cd),console[_0xd2dbed(0x75e)](_0xd2dbed(0x8fd),_0x2e261d);}}});else{const _0x14c310=_0x27b58d(lastRawAiResponse);_0x247806['appendChild'](_0x14c310);}_0x31f23b[_0x438740(0xb08)][_0x438740(0x12b6)](_0x438740(0x9eb));}function _0x27b58d(_0x50ac07=''){const _0x3a65a3=_0x239c7d,_0x457100=document['createElement'](_0x3a65a3(0xf8e));_0x457100[_0x3a65a3(0x4e1)]=_0x3a65a3(0x114d);const _0x133555={'text':{'type':'text','content':'在这里输入文本...'},'sticker':{'type':_0x3a65a3(0x12c2),'url':_0x3a65a3(0x25d),'meaning':_0x3a65a3(0xf62)},'image':{'type':_0x3a65a3(0xea7),'description':_0x3a65a3(0x497)},'voice':{'type':_0x3a65a3(0x295),'content':_0x3a65a3(0x82d)},'transfer':{'type':'transfer','amount':5.2,'note':'一点心意'},'offline':{'type':_0x3a65a3(0x86e),'content':_0x3a65a3(0x440)},'quote':{'type':_0x3a65a3(0x788),'target_timestamp':0x499602d2,'reply_content':'在这里输入回复内容'},'nai':{'type':_0x3a65a3(0xd3c),'prompt':'1girl,\x20best\x20quality,\x20masterpiece,\x20...'}};return _0x457100[_0x3a65a3(0x1575)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条动作\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>'+_0x50ac07+_0x3a65a3(0x1642)+JSON[_0x3a65a3(0xea5)](_0x133555[_0x3a65a3(0x117f)])+_0x3a65a3(0xa0c)+JSON['stringify'](_0x133555[_0x3a65a3(0x12c2)])+_0x3a65a3(0xe6e)+JSON[_0x3a65a3(0xea5)](_0x133555[_0x3a65a3(0xf86)])+'\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x3a65a3(0xea5)](_0x133555['voice'])+'\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON['stringify'](_0x133555['transfer'])+_0x3a65a3(0x1512)+JSON[_0x3a65a3(0xea5)](_0x133555['offline'])+'\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON['stringify'](_0x133555[_0x3a65a3(0x1406)])+_0x3a65a3(0xb0c)+JSON[_0x3a65a3(0xea5)](_0x133555[_0x3a65a3(0x54c)])+_0x3a65a3(0x7ba),_0x457100[_0x3a65a3(0x13ef)](_0x3a65a3(0x9cd))[_0x3a65a3(0x501)]('click',()=>{const _0x48b42d=_0x3a65a3;_0x457100[_0x48b42d(0xc46)]();}),_0x457100['querySelectorAll'](_0x3a65a3(0xe36))[_0x3a65a3(0xbdc)](_0x2c621d=>{const _0x12a301=_0x3a65a3;_0x2c621d[_0x12a301(0x501)]('click',()=>{const _0x559f9c=_0x12a301,_0x3b29d8=_0x2c621d[_0x559f9c(0xd61)][_0x559f9c(0x74d)],_0x1801e5=_0x457100[_0x559f9c(0x13ef)](_0x559f9c(0x79e));if(_0x3b29d8&&_0x1801e5)try{const _0xb24e9b=JSON[_0x559f9c(0x13f7)](_0x3b29d8);_0x1801e5[_0x559f9c(0xa1e)]=JSON['stringify'](_0xb24e9b,null,0x2),_0x1801e5['focus']();}catch(_0x4a6a3d){console[_0x559f9c(0x5d7)]('解析格式模板失败:',_0x4a6a3d);}});}),_0x457100;}async function _0x474f0c(){const _0x40359a=_0x239c7d,_0x522a6c=new Map();let _0x3df61c=null;if(lastPrivateMessagesSent[_0x40359a(0x8d6)]>0x0){console[_0x40359a(0x1e6)](_0x40359a(0x13eb)+lastPrivateMessagesSent['length']+_0x40359a(0x983));const _0x35d9d3=[...lastPrivateMessagesSent];_0x3df61c=_0x35d9d3[_0x40359a(0x40a)]();const _0x543386=[...new Set(_0x35d9d3[_0x40359a(0xd18)](_0x43f4a4=>_0x43f4a4['chatId']))];for(const _0x499e19 of _0x543386){const _0x4ae46b=await _0x54c587['chats']['get'](_0x499e19);_0x4ae46b&&_0x522a6c[_0x40359a(0xfa3)](_0x499e19,_0x4ae46b);}for(const _0x13243a of _0x35d9d3){const _0x82944d=_0x522a6c[_0x40359a(0xf48)](_0x13243a['chatId']);_0x82944d&&(_0x82944d[_0x40359a(0x92c)]=_0x82944d[_0x40359a(0x92c)][_0x40359a(0x29d)](_0x454c94=>_0x454c94[_0x40359a(0x287)]!==_0x13243a[_0x40359a(0x287)]));}_0x522a6c['size']>0x0&&await _0x54c587[_0x40359a(0xbea)]['bulkPut'](Array[_0x40359a(0xdc0)](_0x522a6c['values']())),lastPrivateMessagesSent=[];}const _0x6d348=_0x4c8b14[_0x40359a(0xbea)][_0x4c8b14['activeChatId']];if(!_0x6d348)return;const _0x2d5a65=document[_0x40359a(0x400)]('ai-response-editor-container'),_0x23c716=_0x2d5a65['querySelectorAll'](_0x40359a(0x79e)),_0x32c62c=Array[_0x40359a(0xdc0)](_0x23c716)[_0x40359a(0xd18)](_0x22d6fc=>_0x22d6fc['value'][_0x40359a(0xb8f)]())[_0x40359a(0x29d)](Boolean),_0x353f9f=_0x6d348[_0x40359a(0x92c)][_0x40359a(0x29d)](_0x36f5bb=>lastResponseTimestamps[_0x40359a(0xd1b)](_0x36f5bb[_0x40359a(0x287)]));_0x6d348[_0x40359a(0x92c)]=_0x6d348['history'][_0x40359a(0x29d)](_0x4ca722=>!lastResponseTimestamps['includes'](_0x4ca722['timestamp']));if(_0x32c62c[_0x40359a(0x8d6)]===0x0){await _0x54c587[_0x40359a(0xbea)][_0x40359a(0x4cb)](_0x6d348),_0x26354c(_0x4c8b14[_0x40359a(0x1539)]),_0x41b828(),document[_0x40359a(0x400)](_0x40359a(0x310))['classList'][_0x40359a(0xc46)](_0x40359a(0x9eb)),lastRawAiResponse='',lastResponseTimestamps=[];return;}let _0x590037=[];for(const _0x1990a1 of _0x32c62c){try{const _0x331246=JSON[_0x40359a(0x13f7)](_0x1990a1);_0x590037[_0x40359a(0x6bb)](_0x331246);}catch(_0x1e4fb5){console[_0x40359a(0x75e)](_0x40359a(0x168c),_0x1990a1);}}const _0x1ccbd7=_0x353f9f[_0x40359a(0x29d)](_0x5aaac8=>_0x5aaac8[_0x40359a(0xbbf)]==='naiimag');let _0x226109=0x0,_0x21c2c3=[],_0x161aa3=Date[_0x40359a(0xecd)]();const _0x5f3919=new Map(),_0x2434e1=new Map();for(const _0x9cf09a of _0x590037){if(!_0x9cf09a||typeof _0x9cf09a!==_0x40359a(0xfc4)||!_0x9cf09a[_0x40359a(0xbbf)]){console[_0x40359a(0x75e)](_0x40359a(0xfbc),_0x9cf09a);continue;}let _0x266653=null;const _0x524e96={'role':_0x40359a(0x4fd),'senderName':_0x9cf09a[_0x40359a(0xf3e)]||_0x6d348[_0x40359a(0xdcf)],'timestamp':_0x161aa3++};switch(_0x9cf09a[_0x40359a(0xbbf)]){case _0x40359a(0x7fa):{const _0x219d33=_0x9cf09a[_0x40359a(0xf3e)],_0xec3316=_0x9cf09a[_0x40359a(0x11b4)],_0x50771a=_0x4c8b14[_0x40359a(0x834)][_0x40359a(0xbf3)]||_0x40359a(0xa8f);if(_0xec3316===_0x50771a){const _0x46427f=Object[_0x40359a(0x40a)](_0x4c8b14[_0x40359a(0xbea)])['find'](_0x101b17=>!_0x101b17[_0x40359a(0xc98)]&&_0x101b17['originalName']===_0x219d33);if(_0x46427f){if(!_0x5f3919['has'](_0x46427f['id'])){const _0x885cf8=_0x522a6c[_0x40359a(0xf48)](_0x46427f['id'])||await _0x54c587[_0x40359a(0xbea)][_0x40359a(0xf48)](_0x46427f['id']);_0x5f3919[_0x40359a(0xfa3)](_0x46427f['id'],_0x885cf8);}const _0x4e756a=_0x5f3919[_0x40359a(0xf48)](_0x46427f['id']),_0x22af46=Array[_0x40359a(0x16a1)](_0x9cf09a[_0x40359a(0x1109)])?_0x9cf09a[_0x40359a(0x1109)]:[_0x9cf09a['content']];let _0xff56db=0x0;for(const _0x1ba7dc of _0x22af46){if(!_0x1ba7dc||!_0x1ba7dc[_0x40359a(0xb8f)]())continue;const _0x2d3b0e=_0x3df61c?_0x3df61c[_0x40359a(0xed7)]()[_0x40359a(0xa1e)]:null,_0x2196f3=_0x2d3b0e&&_0x2d3b0e[_0x40359a(0x4dd)]===_0x46427f['id']?_0x2d3b0e['timestamp']:_0x161aa3++,_0x3ae120={'role':_0x40359a(0x4fd),'senderName':_0x219d33,'content':_0x1ba7dc,'timestamp':_0x2196f3};lastPrivateMessagesSent[_0x40359a(0x6bb)]({'chatId':_0x46427f['id'],'timestamp':_0x3ae120[_0x40359a(0x287)]}),_0x4e756a[_0x40359a(0x92c)][_0x40359a(0x6bb)](_0x3ae120),_0xff56db++;}_0xff56db>0x0&&(_0x4c8b14[_0x40359a(0x1539)]!==_0x46427f['id']&&(_0x4e756a[_0x40359a(0x73c)]=(_0x4e756a[_0x40359a(0x73c)]||0x0)+_0xff56db,_0x301fc2(_0x46427f['id'],_0x46427f[_0x40359a(0xf3e)]+_0x40359a(0x6cd)+_0xff56db+_0x40359a(0x15d0)))),_0x266653=null;}else console[_0x40359a(0x75e)](_0x40359a(0xf7b)+_0x219d33+_0x40359a(0xac8)),_0x266653=null;}else console['warn'](_0x40359a(0x1369)+_0xec3316+_0x40359a(0x77a)),_0x266653=null;continue;}case'send_group_message':{const _0x7842a5=_0x9cf09a['name']||_0x6d348[_0x40359a(0xdcf)],_0x9e7b3f=_0x9cf09a['targetGroupName'],_0x295997=Array[_0x40359a(0x16a1)](_0x9cf09a['content'])?_0x9cf09a[_0x40359a(0x1109)]:[String(_0x9cf09a[_0x40359a(0x1109)])];if(!_0x9e7b3f){console[_0x40359a(0x75e)](_0x40359a(0xdd2));continue;}const _0x12df84=Object[_0x40359a(0x40a)](_0x4c8b14[_0x40359a(0xbea)])[_0x40359a(0x821)](_0x5dd686=>_0x5dd686[_0x40359a(0xc98)]&&_0x5dd686[_0x40359a(0xf3e)]===_0x9e7b3f&&_0x5dd686[_0x40359a(0x4f8)]['some'](_0x6448e9=>_0x6448e9[_0x40359a(0xdcf)]===_0x7842a5));if(_0x12df84){if(!_0x2434e1[_0x40359a(0x3e3)](_0x12df84['id'])){const _0xd6b9e4=await _0x54c587[_0x40359a(0xbea)][_0x40359a(0xf48)](_0x12df84['id']);_0x2434e1[_0x40359a(0xfa3)](_0x12df84['id'],_0xd6b9e4);}const _0x2205ae=_0x2434e1[_0x40359a(0xf48)](_0x12df84['id']);let _0x45ee8e=0x0;for(const _0x22e958 of _0x295997){if(!_0x22e958||!_0x22e958[_0x40359a(0xb8f)]())continue;const _0x524770={'role':'assistant','senderName':_0x7842a5,'content':_0x22e958,'timestamp':_0x161aa3++};_0x2205ae[_0x40359a(0x92c)][_0x40359a(0x6bb)](_0x524770),_0x45ee8e++;}_0x45ee8e>0x0&&(_0x4c8b14['activeChatId']!==_0x12df84['id']&&(_0x2205ae[_0x40359a(0x73c)]=(_0x2205ae[_0x40359a(0x73c)]||0x0)+_0x45ee8e)),_0x266653=null;}else console[_0x40359a(0x75e)](_0x40359a(0x12a2)+_0x9e7b3f+_0x40359a(0x104d)+_0x7842a5+_0x40359a(0xa78)),_0x266653=null;continue;}case'thought_chain':{continue;}case _0x40359a(0x117f):_0x266653={..._0x524e96,'content':String(_0x9cf09a['content']||_0x9cf09a[_0x40359a(0x6e2)])};break;case _0x40359a(0x12c2):{let _0xd36121=![];if(_0x9cf09a[_0x40359a(0x299)]&&_0x9cf09a[_0x40359a(0xca4)])_0x266653={..._0x524e96,'type':_0x40359a(0x12c2),'content':_0x9cf09a[_0x40359a(0x299)],'meaning':_0x9cf09a[_0x40359a(0xca4)]},_0xd36121=!![];else{if(_0x9cf09a[_0x40359a(0xca4)]){const _0x8537de=findBestStickerMatch(_0x9cf09a[_0x40359a(0xca4)],_0x4c8b14[_0x40359a(0x120c)]);_0x8537de?(_0x266653={..._0x524e96,'type':_0x40359a(0x12c2),'content':_0x8537de[_0x40359a(0x299)],'meaning':_0x8537de[_0x40359a(0xf3e)]},_0xd36121=!![]):(_0x266653={..._0x524e96,'type':_0x40359a(0x117f),'content':_0x40359a(0x84c)+_0x9cf09a[_0x40359a(0xca4)]+']'},_0xd36121=!![]);}else{if(_0x9cf09a['url']){_0x266653={..._0x524e96,'type':_0x40359a(0x12c2),'content':_0x9cf09a[_0x40359a(0x299)]};const _0x56521f=_0x4c8b14[_0x40359a(0x120c)][_0x40359a(0x821)](_0x31ade4=>_0x31ade4[_0x40359a(0x299)]===_0x9cf09a['url']);_0x266653[_0x40359a(0xca4)]=_0x56521f?_0x56521f['name']:'未知表情',_0xd36121=!![];}else{if(_0x9cf09a['content']&&typeof _0x9cf09a['content']==='string'&&_0x12f2a0[_0x40359a(0x2c0)](_0x9cf09a['content'])){_0x266653={..._0x524e96,'type':'sticker','content':_0x9cf09a[_0x40359a(0x1109)]};const _0x5ad186=_0x4c8b14['userStickers'][_0x40359a(0x821)](_0x554bce=>_0x554bce[_0x40359a(0x299)]===_0x9cf09a[_0x40359a(0x1109)]);_0x266653[_0x40359a(0xca4)]=_0x5ad186?_0x5ad186[_0x40359a(0xf3e)]:_0x40359a(0x44d),_0xd36121=!![];}}}}if(!_0xd36121){console[_0x40359a(0x5d7)](_0x40359a(0x127a),_0x9cf09a);continue;}break;}case'ai_image':_0x266653={..._0x524e96,'type':'ai_image','content':_0x9cf09a[_0x40359a(0x12a5)],'image_prompt':_0x9cf09a[_0x40359a(0xff9)]};break;case'naiimag':{const _0x1dcfc1=_0x9cf09a[_0x40359a(0x156c)];let _0x139644=null,_0x20cb79=null;const _0x801f93=_0x1ccbd7[_0x226109];_0x226109++;let _0x433abd=![];if(_0x801f93){const _0x2b3045=_0x801f93[_0x40359a(0x156c)];_0x1dcfc1&&_0x1dcfc1!==_0x2b3045?(console['log'](_0x40359a(0xdab)),_0x433abd=!![]):(console['log']('NAI\x20Prompt\x20未改变，将保留原始图片。'),_0x139644=_0x801f93[_0x40359a(0x1436)],_0x20cb79=_0x801f93[_0x40359a(0x551)]);}else console[_0x40359a(0x1e6)](_0x40359a(0xc92)),_0x433abd=!![];if(_0x433abd){const _0x2c6b89=_0x801f93?'检测到NAI提示词已修改，正在重新生成...':'检测到新的NAI生图指令，正在生成...';await _0x138765(_0x40359a(0x13e9),_0x2c6b89);try{const _0x9a46b2=await _0x3b71e9(_0x1dcfc1,_0x6d348['id']);_0x139644=_0x9a46b2[_0x40359a(0x1436)],_0x20cb79=_0x9a46b2[_0x40359a(0x551)],await _0x138765('成功','图片已生成！');}catch(_0x46ad26){console[_0x40359a(0x5d7)](_0x40359a(0x1347),_0x46ad26),await _0x138765(_0x40359a(0x321),'无法生成图片:\x20'+_0x46ad26['message']+_0x40359a(0x4b1));if(_0x801f93)_0x139644=_0x801f93[_0x40359a(0x1436)],_0x20cb79=_0x801f93[_0x40359a(0x551)];else{console[_0x40359a(0x5d7)](_0x40359a(0x165c));continue;}}}_0x266653={..._0x524e96,'type':_0x40359a(0xd3c),'imageUrl':_0x139644,'prompt':_0x1dcfc1,'fullPrompt':_0x20cb79};break;}case'voice_message':_0x266653={..._0x524e96,'type':_0x40359a(0x295),'content':_0x9cf09a[_0x40359a(0x1109)]};break;case _0x40359a(0x112f):_0x266653={..._0x524e96,'type':_0x40359a(0x112f),'amount':_0x9cf09a[_0x40359a(0x12e7)],'note':_0x9cf09a[_0x40359a(0x12bb)],'receiverName':_0x9cf09a[_0x40359a(0x7b6)]||'我'};break;case'waimai_request':_0x266653={..._0x524e96,'type':_0x40359a(0xebc),'productInfo':_0x9cf09a[_0x40359a(0xff3)],'amount':_0x9cf09a[_0x40359a(0x12e7)],'status':'pending','countdownEndTime':Date['now']()+0xf*0x3c*0x3e8};break;case _0x40359a(0x86e):_0x266653={..._0x524e96,..._0x9cf09a};break;case _0x40359a(0x940):{const _0x345d7a=_0x30ad43[_0x6d348['id']];if(_0x345d7a){const _0x50eeca=_0x345d7a[_0x40359a(0x92c)][_0x40359a(0x3bf)](_0x57c792=>_0x57c792[_0x40359a(0x90c)]===0x2);if(_0x50eeca>-0x1){const _0x33eac6=_0x345d7a['history'][_0x50eeca];_0x345d7a[_0x40359a(0x8f7)][_0x33eac6['y']][_0x33eac6['x']]=0x0,_0x345d7a['history'][_0x40359a(0xdcc)](_0x50eeca,0x1),console[_0x40359a(0x1e6)](_0x40359a(0xf9a)+_0x33eac6['x']+',\x20'+_0x33eac6['y']+_0x40359a(0x14a1));}}const _0x5da463=parseInt(_0x9cf09a['x']),_0x32a76f=parseInt(_0x9cf09a['y']);!isNaN(_0x5da463)&&!isNaN(_0x32a76f)?_0x1c3bf5({'x':_0x5da463,'y':_0x32a76f},!![]):console[_0x40359a(0x75e)](_0x40359a(0xd1e),_0x9cf09a);continue;}case _0x40359a(0x95a):{if(!_0x6d348[_0x40359a(0xc98)]){if(_0x9cf09a['heartfelt_voice'])_0x6d348[_0x40359a(0x8ab)]=String(_0x9cf09a[_0x40359a(0x348)]);if(_0x9cf09a[_0x40359a(0xd13)])_0x6d348['randomJottings']=String(_0x9cf09a[_0x40359a(0xd13)]);if(!Array['isArray'](_0x6d348[_0x40359a(0x13a1)]))_0x6d348[_0x40359a(0x13a1)]=[];_0x6d348[_0x40359a(0x13a1)][_0x40359a(0x6bb)]({'heartfeltVoice':_0x6d348[_0x40359a(0x8ab)],'randomJottings':_0x6d348[_0x40359a(0x13e5)],'timestamp':Date[_0x40359a(0xecd)]()});if(_0x6d348[_0x40359a(0x13a1)][_0x40359a(0x8d6)]>0x32)_0x6d348['thoughtsHistory']['shift']();}continue;}case _0x40359a(0x788):{let _0x5dec53=null,_0x396cd5=null;if(_0x9cf09a['target_content'])_0x5dec53=[..._0x6d348[_0x40359a(0x92c)]]['reverse']()[_0x40359a(0x821)](_0x3a89c2=>!_0x3a89c2[_0x40359a(0x118c)]&&(_0x3a89c2[_0x40359a(0x1109)]===_0x9cf09a[_0x40359a(0x2d2)]||typeof _0x3a89c2[_0x40359a(0x1109)]===_0x40359a(0x158f)&&_0x3a89c2[_0x40359a(0x1109)][_0x40359a(0xb8f)]()===_0x9cf09a[_0x40359a(0x2d2)][_0x40359a(0xb8f)]())),!_0x5dec53&&console[_0x40359a(0x75e)]('[导演模式保存失败]\x20尝试引用内容\x20\x22'+(_0x9cf09a[_0x40359a(0x2d2)]||'')[_0x40359a(0x371)](0x0,0x14)+'...\x22，但在历史中未找到。');else _0x9cf09a[_0x40359a(0x396)]&&(_0x5dec53=_0x6d348[_0x40359a(0x92c)][_0x40359a(0x821)](_0x266a22=>_0x266a22[_0x40359a(0x287)]===_0x9cf09a['target_timestamp']));if(_0x5dec53){let _0x5cb257;_0x5dec53[_0x40359a(0x71a)]==='user'?_0x5cb257=_0x6d348[_0x40359a(0xa37)][_0x40359a(0x14a8)]||'我':_0x6d348[_0x40359a(0xc98)]?_0x5cb257=_0x288d80(_0x6d348,_0x5dec53[_0x40359a(0x3e7)]):_0x5cb257=_0x6d348[_0x40359a(0xf3e)],_0x396cd5={'timestamp':_0x5dec53[_0x40359a(0x287)],'senderName':_0x5cb257,'content':String(_0x5dec53[_0x40359a(0x1109)]||'')};}else console[_0x40359a(0x75e)](_0x40359a(0xb1d)+_0x9cf09a[_0x40359a(0x2d2)]+_0x40359a(0x81d)+_0x9cf09a[_0x40359a(0x396)]+')');_0x266653={..._0x524e96,'content':_0x9cf09a[_0x40359a(0x103e)]};_0x396cd5&&(_0x266653[_0x40359a(0x1406)]=_0x396cd5);break;}default:console[_0x40359a(0x75e)](_0x40359a(0x137b),_0x9cf09a[_0x40359a(0xbbf)],_0x9cf09a);if(_0x9cf09a[_0x40359a(0x1109)])_0x266653={..._0x524e96,'content':String(_0x9cf09a[_0x40359a(0x1109)])};else continue;break;}_0x266653&&(_0x6d348['history'][_0x40359a(0x6bb)](_0x266653),_0x21c2c3[_0x40359a(0x6bb)](_0x266653['timestamp']));}_0x2434e1[_0x40359a(0x9e8)]>0x0&&await _0x54c587[_0x40359a(0xbea)]['bulkPut'](Array[_0x40359a(0xdc0)](_0x2434e1[_0x40359a(0x40a)]())),await _0x54c587['chats'][_0x40359a(0x4cb)](_0x6d348),_0x5f3919['size']>0x0&&await _0x54c587['chats'][_0x40359a(0x1f6)](Array[_0x40359a(0xdc0)](_0x5f3919[_0x40359a(0x40a)]())),_0x26354c(_0x4c8b14['activeChatId']),_0x41b828(),document['getElementById'](_0x40359a(0x310))[_0x40359a(0xb08)][_0x40359a(0xc46)](_0x40359a(0x9eb)),lastRawAiResponse=_0x32c62c[_0x40359a(0xee1)]('\x0a\x0a'),lastResponseTimestamps=_0x21c2c3,await _0x138765(_0x40359a(0x144f),_0x40359a(0x90e));}async function _0xae2b9a(){const _0x460d4e=_0x239c7d;if(!_0x465ba7)return;const _0x298d4a=0x2*0x3c*0x3e8,_0xbfadcb=_0x465ba7,_0x4cad35=Date[_0x460d4e(0xecd)]();if(_0x4cad35-_0xbfadcb>_0x298d4a){_0x4f08fc(),await _0x138765('操作失败',_0x460d4e(0xc65));return;}await _0x3f90e0(_0xbfadcb,!![]),_0x4f08fc();}async function _0x3f90e0(_0x1b7867,_0x3773dd){const _0x340492=_0x239c7d,_0x5b5f53=_0x4c8b14[_0x340492(0xbea)][_0x4c8b14[_0x340492(0x1539)]];if(!_0x5b5f53)return;const _0x455638=_0x5b5f53['history'][_0x340492(0x11a4)](_0x5ac43f=>_0x5ac43f['timestamp']===_0x1b7867);if(_0x455638===-0x1)return;const _0x95a74e=_0x5b5f53[_0x340492(0x92c)][_0x455638],_0x29962e={'originalType':_0x95a74e[_0x340492(0xbbf)]||_0x340492(0x117f),'originalContent':_0x95a74e['content'],'originalMeaning':_0x95a74e[_0x340492(0xca4)],'originalQuote':_0x95a74e['quote']};_0x95a74e[_0x340492(0xbbf)]='recalled_message',_0x95a74e[_0x340492(0x1109)]=_0x3773dd?_0x340492(0x1614):_0x340492(0x3f8),_0x95a74e['recalledData']=_0x29962e,delete _0x95a74e[_0x340492(0xca4)],delete _0x95a74e[_0x340492(0x1406)];if(_0x3773dd){const _0x31f059=_0x5b5f53['isGroup']?_0x5b5f53[_0x340492(0xa37)][_0x340492(0x14a8)]||'我':'我';let _0x36cee3='';if(_0x29962e[_0x340492(0x1327)]===_0x340492(0x12c2))_0x36cee3=_0x340492(0xa2e)+(_0x29962e[_0x340492(0x2ab)]||'未知')+']';else _0x29962e['originalType']===_0x340492(0xea7)||_0x29962e[_0x340492(0x1327)]===_0x340492(0xdf3)?_0x36cee3=_0x340492(0xcb0)+_0x29962e[_0x340492(0xf37)]+']':_0x36cee3='“'+String(_0x29962e[_0x340492(0xf37)])+'”';const _0x47043c={'role':_0x340492(0xaf6),'content':_0x340492(0x12af)+_0x31f059+_0x340492(0xda6)+_0x36cee3+'。请你对此作出回应，可以表现出好奇、开玩笑（比如\x27我截图了！\x27）、或者根据你的人设表示理解或疑惑。]','timestamp':Date['now'](),'isHidden':!![]};_0x5b5f53[_0x340492(0x92c)]['push'](_0x47043c);}await _0x54c587[_0x340492(0xbea)][_0x340492(0x4cb)](_0x5b5f53),_0x26354c(_0x4c8b14[_0x340492(0x1539)]),_0x3773dd&&(_0x41b828(),_0x58df1c());}async function _0x338c29(){const _0x55ca13=_0x239c7d;await _0x4b930a(),document['getElementById']('world-book-category-manager-modal')[_0x55ca13(0xb08)][_0x55ca13(0x12b6)]('visible');}async function _0x4b930a(){const _0x415f76=_0x239c7d,_0x3fbbac=document[_0x415f76(0x400)](_0x415f76(0x117b)),_0x3458b5=await _0x54c587[_0x415f76(0x2c3)]['toArray']();_0x3fbbac[_0x415f76(0x1575)]='',_0x3458b5[_0x415f76(0x8d6)]===0x0&&(_0x3fbbac[_0x415f76(0x1575)]=_0x415f76(0x861)),_0x3458b5[_0x415f76(0xbdc)](_0x3ba680=>{const _0x5a6a14=_0x415f76,_0x937ce6=document['createElement'](_0x5a6a14(0xf8e));_0x937ce6[_0x5a6a14(0x4e1)]=_0x5a6a14(0xf94),_0x937ce6[_0x5a6a14(0x1575)]=_0x5a6a14(0x5e7)+_0x3ba680['name']+_0x5a6a14(0x2a1)+_0x3ba680['id']+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3fbbac[_0x5a6a14(0x8f2)](_0x937ce6);});}async function _0x51e37e(){const _0x2aa39b=_0x239c7d,_0x5009d6=document[_0x2aa39b(0x400)](_0x2aa39b(0x1259)),_0x225298=_0x5009d6[_0x2aa39b(0xa1e)][_0x2aa39b(0xb8f)]();if(!_0x225298){alert(_0x2aa39b(0x403));return;}const _0xd6d50f=await _0x54c587[_0x2aa39b(0x2c3)][_0x2aa39b(0x227)]('name')[_0x2aa39b(0x4ce)](_0x225298)['first']();if(_0xd6d50f){alert(_0x2aa39b(0x673)+_0x225298+_0x2aa39b(0x1456));return;}await _0x54c587['worldBookCategories']['add']({'name':_0x225298}),_0x5009d6[_0x2aa39b(0xa1e)]='',await _0x4b930a();}async function _0xb70632(_0x201c12){const _0x4f46c8=_0x239c7d,_0x5005b5=await _0x56d4d3(_0x4f46c8(0x713),_0x4f46c8(0x45e),{'confirmButtonClass':_0x4f46c8(0x142c)});if(_0x5005b5){await _0x54c587[_0x4f46c8(0x2c3)]['delete'](_0x201c12);const _0x1a0c64=await _0x54c587[_0x4f46c8(0xf57)][_0x4f46c8(0x227)](_0x4f46c8(0x12c4))['equals'](_0x201c12)['toArray']();for(const _0x136d87 of _0x1a0c64){_0x136d87[_0x4f46c8(0x12c4)]=null,await _0x54c587['worldBooks']['put'](_0x136d87);const _0x1e2a6e=_0x4c8b14[_0x4f46c8(0xf57)][_0x4f46c8(0x821)](_0x29c53d=>_0x29c53d['id']===_0x136d87['id']);if(_0x1e2a6e)_0x1e2a6e[_0x4f46c8(0x12c4)]=null;}await _0x4b930a();}}async function _0x98a649(){const _0x1e8ac5=_0x239c7d;if(!_0x465ba7)return;const _0x2e42c4=_0x465ba7;_0x4f08fc();const _0x3bf00f=_0x4c8b14[_0x1e8ac5(0xbea)][_0x4c8b14[_0x1e8ac5(0x1539)]],_0x454fc7=_0x3bf00f[_0x1e8ac5(0x92c)][_0x1e8ac5(0x821)](_0x38f679=>_0x38f679[_0x1e8ac5(0x287)]===_0x2e42c4);if(!_0x454fc7)return;let _0x35e08c=String(_0x454fc7['content']||'')[_0x1e8ac5(0x371)](0x0,0x32)+_0x1e8ac5(0x166b);if(_0x454fc7['type']===_0x1e8ac5(0xea7))_0x35e08c=_0x1e8ac5(0x2fc)+_0x35e08c;const _0x15c35a=await _0x56d4d3(_0x1e8ac5(0xdf9),_0x1e8ac5(0x10df)+_0x35e08c+'”',{'confirmText':_0x1e8ac5(0x128a)});if(_0x15c35a){const _0x313865=_0x3bf00f[_0x1e8ac5(0xa37)][_0x1e8ac5(0x14a8)]||'我';!Array[_0x1e8ac5(0x16a1)](_0x3bf00f[_0x1e8ac5(0xfd4)])&&(_0x3bf00f[_0x1e8ac5(0xfd4)]=[]);const _0x1b1d78={'id':_0x1e8ac5(0x4e7)+Date['now'](),'messageTimestamp':_0x2e42c4,'publisher':_0x313865,'publishedAt':Date['now'](),'isPinned':![]};_0x3bf00f[_0x1e8ac5(0xfd4)][_0x1e8ac5(0x6bb)](_0x1b1d78);const _0xfec746={'role':_0x1e8ac5(0xaf6),'type':_0x1e8ac5(0xaa4),'content':_0x313865+_0x1e8ac5(0x2b2),'timestamp':Date[_0x1e8ac5(0xecd)]()};_0x3bf00f[_0x1e8ac5(0x92c)][_0x1e8ac5(0x6bb)](_0xfec746),await _0x54c587[_0x1e8ac5(0xbea)]['put'](_0x3bf00f),_0x41ecc7(_0xfec746,_0x3bf00f),_0x41b828(),await _0x138765('成功',_0x1e8ac5(0x15de));}}async function _0x17f48e(){const _0x5444ed=_0x239c7d,_0x484e17=_0x4c8b14[_0x5444ed(0xbea)][_0x4c8b14['activeChatId']],_0x1e38f7=_0x484e17[_0x5444ed(0xfd4)]||[];if(!_0x484e17||_0x1e38f7[_0x5444ed(0x8d6)]===0x0){_0x138765('提示','当前群聊还没有公告哦。');return;}const _0x5bc744=document[_0x5444ed(0x400)](_0x5444ed(0x1239));_0x5bc744['innerHTML']='',_0x1e38f7['sort']((_0x10ebaa,_0x112ca8)=>(_0x112ca8[_0x5444ed(0x1509)]?0x1:0x0)-(_0x10ebaa[_0x5444ed(0x1509)]?0x1:0x0));for(const _0x26b8fa of _0x1e38f7){const _0x40b094=_0x484e17[_0x5444ed(0x92c)][_0x5444ed(0x821)](_0x3dec57=>_0x3dec57['timestamp']===_0x26b8fa['messageTimestamp']),_0x7760ec=document[_0x5444ed(0x2c9)]('div');_0x7760ec['className']='announcement-item-wrapper';if(_0x40b094){const _0x10be83=await _0x43c5e5(_0x40b094,_0x484e17);_0x10be83&&_0x7760ec[_0x5444ed(0x8f2)](_0x10be83);}else _0x7760ec['innerHTML']=_0x5444ed(0x15a7);_0x26b8fa[_0x5444ed(0x1509)]&&(_0x7760ec[_0x5444ed(0x1575)]+='<div\x20class=\x22pinned-indicator\x22>📌</div>'),_0x7760ec[_0x5444ed(0x1575)]+=_0x5444ed(0x32b)+_0x26b8fa['id']+_0x5444ed(0xaf0),_0x5bc744[_0x5444ed(0x8f2)](_0x7760ec);}document[_0x5444ed(0x400)](_0x5444ed(0x334))['classList'][_0x5444ed(0x12b6)](_0x5444ed(0x9eb));}let _0x99e50e=null;function _0x387fba(_0x386db3){const _0x14ddf1=_0x239c7d;_0x99e50e=_0x386db3;const _0x4faa44=_0x4c8b14[_0x14ddf1(0xbea)][_0x4c8b14[_0x14ddf1(0x1539)]],_0x3c81a4=_0x4faa44['announcements'][_0x14ddf1(0x821)](_0xc7a70d=>_0xc7a70d['id']===_0x386db3);if(!_0x3c81a4)return;const _0x1dcb80=document[_0x14ddf1(0x400)]('announcement-action-pin');_0x1dcb80[_0x14ddf1(0xde7)]=_0x3c81a4[_0x14ddf1(0x1509)]?_0x14ddf1(0x8a0):_0x14ddf1(0xc93),document[_0x14ddf1(0x400)]('announcement-actions-modal')[_0x14ddf1(0xb08)][_0x14ddf1(0x12b6)](_0x14ddf1(0x9eb));}async function _0x561be9(){const _0x5c7a88=_0x239c7d;if(!_0x99e50e)return;const _0x497420=_0x4c8b14[_0x5c7a88(0xbea)][_0x4c8b14[_0x5c7a88(0x1539)]],_0x29a780=_0x497420['announcements'][_0x5c7a88(0x821)](_0x4469fd=>_0x4469fd['id']===_0x99e50e);_0x29a780&&(_0x29a780[_0x5c7a88(0x1509)]=!_0x29a780[_0x5c7a88(0x1509)],await _0x54c587[_0x5c7a88(0xbea)]['put'](_0x497420),_0x17f48e()),document[_0x5c7a88(0x400)]('announcement-actions-modal')[_0x5c7a88(0xb08)][_0x5c7a88(0xc46)](_0x5c7a88(0x9eb));}async function _0x583c3d(){const _0x5ef2cf=_0x239c7d;if(!_0x99e50e)return;const _0x3ef886=await _0x56d4d3('确认删除',_0x5ef2cf(0xe94),{'confirmButtonClass':_0x5ef2cf(0x142c)});if(_0x3ef886){const _0x1ec6f1=_0x4c8b14[_0x5ef2cf(0xbea)][_0x4c8b14[_0x5ef2cf(0x1539)]];_0x1ec6f1[_0x5ef2cf(0xfd4)]=_0x1ec6f1['announcements']['filter'](_0x32feb5=>_0x32feb5['id']!==_0x99e50e),await _0x54c587[_0x5ef2cf(0xbea)][_0x5ef2cf(0x4cb)](_0x1ec6f1),_0x17f48e();}document['getElementById'](_0x5ef2cf(0xb78))['classList'][_0x5ef2cf(0xc46)](_0x5ef2cf(0x9eb));}let _0x28b5be=![],_0x71485e={'ai':null,'my':null};function _0x2359a1(_0x1a28cf='chat'){const _0xb2b168=_0x239c7d,_0x130814=document['getElementById']('avatar-frame-modal');if(!_0x4c8b14['activeChatId'])return;const _0x3656d3=_0x4c8b14[_0xb2b168(0xbea)][_0x4c8b14['activeChatId']];_0x28b5be=_0x1a28cf===_0xb2b168(0xbb6);if(_0x28b5be){const _0x4dc95c=_0x3656d3[_0xb2b168(0x4f8)]['find'](_0x16a3c1=>_0x16a3c1['id']===_0x36da93);if(!_0x4dc95c)return;_0x71485e['my']=_0x4dc95c[_0xb2b168(0x160d)]||'',_0x4999f0(!![],_0x4dc95c[_0xb2b168(0xa9a)],_0x4dc95c[_0xb2b168(0x160d)]);}else _0x71485e['ai']=_0x3656d3['settings'][_0xb2b168(0x2d7)]||'',_0x71485e['my']=_0x3656d3['settings'][_0xb2b168(0x11f7)]||'',_0x4999f0(![]);_0x130814[_0xb2b168(0xb08)][_0xb2b168(0x12b6)](_0xb2b168(0x9eb));}function _0x4999f0(_0x272a82=![],_0x990799=null,_0x152d23=null){const _0x35cb75=_0x239c7d,_0x4dec04=document['getElementById'](_0x35cb75(0xb45)),_0x5148b8=document['getElementById'](_0x35cb75(0x114e)),_0x16fe7c=_0x4c8b14[_0x35cb75(0xbea)][_0x4c8b14[_0x35cb75(0x1539)]];_0x4dec04[_0x35cb75(0x1575)]='',_0x5148b8[_0x35cb75(0x1575)]='',document[_0x35cb75(0x13ef)](_0x35cb75(0x1415))[_0x35cb75(0xa00)][_0x35cb75(0xb1a)]=_0x272a82?_0x35cb75(0x165b):_0x35cb75(0x375),document['getElementById'](_0x35cb75(0x37e))[_0x35cb75(0xa00)][_0x35cb75(0xb1a)]='block',document['getElementById']('my-frame-content')[_0x35cb75(0xa00)][_0x35cb75(0xb1a)]='none',document[_0x35cb75(0x400)]('ai-frame-tab')[_0x35cb75(0xb08)][_0x35cb75(0x12b6)](_0x35cb75(0x5d6)),document[_0x35cb75(0x400)](_0x35cb75(0x6ef))[_0x35cb75(0xb08)][_0x35cb75(0xc46)](_0x35cb75(0x5d6));if(_0x272a82)_0x1a380a[_0x35cb75(0xbdc)](_0x1aafa9=>{const _0x3b1c2d=_0x35cb75,_0xad5910=_0x23ff42(_0x1aafa9,'my',_0x990799);_0x1aafa9[_0x3b1c2d(0x299)]===_0x152d23&&_0xad5910['classList']['add'](_0x3b1c2d(0x148b)),_0x4dec04[_0x3b1c2d(0x8f2)](_0xad5910);});else{const _0x364cee=_0x16fe7c[_0x35cb75(0xa37)][_0x35cb75(0xb24)]||_0x91d058,_0x5acd2d=_0x16fe7c['settings'][_0x35cb75(0x12d3)]||(_0x16fe7c[_0x35cb75(0xc98)]?_0x1f9bfa:_0x91d058);_0x1a380a[_0x35cb75(0xbdc)](_0xc75704=>{const _0x4ca4b6=_0x35cb75,_0x37d0e9=_0x23ff42(_0xc75704,'ai',_0x364cee);if(_0xc75704[_0x4ca4b6(0x299)]===_0x71485e['ai'])_0x37d0e9[_0x4ca4b6(0xb08)][_0x4ca4b6(0x12b6)](_0x4ca4b6(0x148b));_0x4dec04[_0x4ca4b6(0x8f2)](_0x37d0e9);const _0x3037a1=_0x23ff42(_0xc75704,'my',_0x5acd2d);if(_0xc75704[_0x4ca4b6(0x299)]===_0x71485e['my'])_0x3037a1['classList'][_0x4ca4b6(0x12b6)]('selected');_0x5148b8[_0x4ca4b6(0x8f2)](_0x3037a1);});}}function _0x23ff42(_0x20aa80,_0x25731b,_0x44d015){const _0x5d94e7=_0x239c7d,_0x325895=document[_0x5d94e7(0x2c9)]('div');return _0x325895['className']=_0x5d94e7(0xed1),_0x325895[_0x5d94e7(0xd61)][_0x5d94e7(0x93f)]=_0x20aa80['url'],_0x325895[_0x5d94e7(0x647)]=_0x20aa80[_0x5d94e7(0xf3e)],_0x325895['innerHTML']=_0x5d94e7(0x30d)+_0x44d015+_0x5d94e7(0x1114)+(_0x20aa80[_0x5d94e7(0x299)]?'<img\x20src=\x22'+_0x20aa80[_0x5d94e7(0x299)]+_0x5d94e7(0x3a6):'')+_0x5d94e7(0xc43),_0x325895[_0x5d94e7(0x501)](_0x5d94e7(0x15ad),()=>{const _0x4c80b7=_0x5d94e7;_0x71485e[_0x25731b]=_0x20aa80['url'];const _0x155be5=_0x25731b==='ai'?document[_0x4c80b7(0x400)](_0x4c80b7(0xb45)):document[_0x4c80b7(0x400)]('my-frame-grid');_0x155be5[_0x4c80b7(0x527)](_0x4c80b7(0x35f))[_0x4c80b7(0xbdc)](_0x58c5e3=>_0x58c5e3[_0x4c80b7(0xb08)][_0x4c80b7(0xc46)](_0x4c80b7(0x148b))),_0x325895['classList'][_0x4c80b7(0x12b6)]('selected');}),_0x325895;}async function _0xd2a71d(){const _0x118ad6=_0x239c7d;if(!_0x4c8b14[_0x118ad6(0x1539)])return;const _0x424c2a=_0x4c8b14[_0x118ad6(0xbea)][_0x4c8b14[_0x118ad6(0x1539)]];if(_0x28b5be){const _0x196582=_0x424c2a[_0x118ad6(0x4f8)][_0x118ad6(0x821)](_0xc273f3=>_0xc273f3['id']===_0x36da93);_0x196582&&(_0x196582[_0x118ad6(0x160d)]=_0x71485e['my']);}else _0x424c2a[_0x118ad6(0xa37)][_0x118ad6(0x2d7)]=_0x71485e['ai'],_0x424c2a['settings'][_0x118ad6(0x11f7)]=_0x71485e['my'];await _0x54c587[_0x118ad6(0xbea)][_0x118ad6(0x4cb)](_0x424c2a);if(!_0x28b5be&&!_0x424c2a['isGroup']){const _0x47b32c=_0x424c2a['id'];for(const _0x4c2763 of Object[_0x118ad6(0x40a)](_0x4c8b14[_0x118ad6(0xbea)])){if(_0x4c2763[_0x118ad6(0xc98)]&&_0x4c2763[_0x118ad6(0x4f8)]){const _0x5a150d=_0x4c2763[_0x118ad6(0x4f8)][_0x118ad6(0x821)](_0x1aa3da=>_0x1aa3da['id']===_0x47b32c);_0x5a150d&&(_0x5a150d[_0x118ad6(0x160d)]=_0x424c2a[_0x118ad6(0xa37)][_0x118ad6(0x2d7)],await _0x54c587['chats']['put'](_0x4c2763),console[_0x118ad6(0x1e6)](_0x118ad6(0x12c1)+_0x47b32c+'\x20的头像框到群聊\x20\x22'+_0x4c2763['name']+'\x22'));}}}document[_0x118ad6(0x400)](_0x118ad6(0x692))[_0x118ad6(0xb08)][_0x118ad6(0xc46)](_0x118ad6(0x9eb)),_0x26354c(_0x4c8b14[_0x118ad6(0x1539)]),alert('头像框已保存并同步！'),_0x28b5be=![];}function _0x281613(){const _0x36fdc3=_0x239c7d;_0x258505=!_0x258505;const _0x257561=document[_0x36fdc3(0x400)]('manage-frames-btn'),_0x380d95=document[_0x36fdc3(0x400)](_0x36fdc3(0x11ee)),_0x346a4a=document[_0x36fdc3(0x400)](_0x36fdc3(0xa42));document['querySelectorAll'](_0x36fdc3(0x1685))[_0x36fdc3(0xbdc)](_0x34876d=>{const _0x30862e=_0x36fdc3;_0x34876d[_0x30862e(0xb08)]['toggle'](_0x30862e(0x1245),_0x258505);}),_0x258505?(_0x257561[_0x36fdc3(0xde7)]='完成',_0x380d95[_0x36fdc3(0xa00)]['display']='flex',_0x165250[_0x36fdc3(0x82f)](),_0x346a4a[_0x36fdc3(0x6f9)]=![],_0x4e4594()):(_0x257561[_0x36fdc3(0xde7)]='管理',_0x380d95[_0x36fdc3(0xa00)]['display']=_0x36fdc3(0x165b),document[_0x36fdc3(0x527)](_0x36fdc3(0x140f))[_0x36fdc3(0xbdc)](_0x1437d0=>{const _0x2f4103=_0x36fdc3;_0x1437d0[_0x2f4103(0xb08)][_0x2f4103(0xc46)](_0x2f4103(0x148b));}));}function _0x4e4594(){const _0x350410=_0x239c7d,_0x554f71=document[_0x350410(0x400)](_0x350410(0x24c));_0x554f71[_0x350410(0xde7)]=_0x350410(0xe4f)+_0x165250[_0x350410(0x9e8)]+')';}function _0x5cedb4(){const _0x5f04ab=_0x239c7d,_0x141efe=document[_0x5f04ab(0x400)]('select-all-frames-checkbox')['checked'],_0x2aa04e=document[_0x5f04ab(0x13ef)](_0x5f04ab(0x114b));if(!_0x2aa04e)return;_0x2aa04e[_0x5f04ab(0x527)](_0x5f04ab(0x2bf))[_0x5f04ab(0xbdc)](_0x1e90df=>{const _0x2121df=_0x5f04ab,_0x26ca11=parseInt(_0x1e90df['querySelector']('.delete-btn')[_0x2121df(0xd61)]['id']);if(isNaN(_0x26ca11))return;_0x1e90df[_0x2121df(0xb08)][_0x2121df(0x146f)](_0x2121df(0x148b),_0x141efe),_0x141efe?_0x165250[_0x2121df(0x12b6)](_0x26ca11):_0x165250['delete'](_0x26ca11);}),_0x4e4594();}async function _0x572436(){const _0x4aed09=_0x239c7d;if(_0x165250[_0x4aed09(0x9e8)]===0x0)return;const _0x147ff1=await _0x56d4d3(_0x4aed09(0x713),_0x4aed09(0x60b)+_0x165250[_0x4aed09(0x9e8)]+_0x4aed09(0xefe),{'confirmButtonClass':_0x4aed09(0x142c)});if(_0x147ff1){const _0x60d28a=[..._0x165250];await _0x54c587[_0x4aed09(0x4ba)][_0x4aed09(0x2c6)](_0x60d28a),_0x281613(),_0x4999f0(_0x28b5be),await _0x138765(_0x4aed09(0xee6),_0x4aed09(0x1281));}}function _0x1d7c68(_0x32b26b){const _0x414f93=_0x239c7d,_0xbb1673=document[_0x414f93(0x400)](_0x414f93(0x84d));_0xbb1673&&(_0xbb1673[_0x414f93(0x1575)]=_0x32b26b||'');}async function _0x647e31(_0xe5d9ed){const _0x49e872=_0x239c7d;if(!_0x59adb2['isActive']||!_0x59adb2[_0x49e872(0x1539)])return;const _0x206a79=_0x4c8b14[_0x49e872(0xbea)][_0x59adb2[_0x49e872(0x1539)]];if(!_0x206a79)return;const _0x234a22=_0x206a79[_0x49e872(0xc98)]?_0x206a79[_0x49e872(0xa37)][_0x49e872(0x14a8)]||'我':'我',_0x5597c3=_0x49e872(0x28e)+_0x234a22+')\x20'+_0xe5d9ed+']',_0x328906={'role':_0x49e872(0xaf6),'content':_0x5597c3,'timestamp':Date[_0x49e872(0xecd)](),'isHidden':!![]};_0x206a79[_0x49e872(0x92c)][_0x49e872(0x6bb)](_0x328906),await _0x54c587[_0x49e872(0xbea)][_0x49e872(0x4cb)](_0x206a79);}async function _0x5a242f(){const _0x257340=_0x239c7d;if(_0x141aad[_0x257340(0x9e8)]===0x0)return;const _0x2185da=_0x4c8b14[_0x257340(0xbea)][_0x4c8b14[_0x257340(0x1539)]];if(!_0x2185da)return;const _0x3a9e38=document[_0x257340(0x400)](_0x257340(0x29f)),_0xe05eaf=_0x3a9e38['textContent'];_0x3a9e38[_0x257340(0xde7)]=_0x257340(0x987),_0x3a9e38[_0x257340(0x366)]=!![];const _0x4434fc=document[_0x257340(0x2c9)](_0x257340(0xf8e)),_0x44332c=document[_0x257340(0x400)](_0x257340(0x43a));_0x4434fc[_0x257340(0xa00)][_0x257340(0x1383)]=_0x44332c[_0x257340(0xeeb)]+'px',_0x4434fc[_0x257340(0xa00)][_0x257340(0xc15)]=_0x257340(0xdc2),_0x4434fc[_0x257340(0xa00)][_0x257340(0x899)]=_0x257340(0xf4e),_0x4434fc['style']['left']='-9999px',_0x4434fc[_0x257340(0xa00)][_0x257340(0xb1a)]=_0x257340(0x375),_0x4434fc[_0x257340(0xa00)][_0x257340(0x1261)]=_0x257340(0x514),_0x4434fc[_0x257340(0xa00)][_0x257340(0x14af)]=_0x257340(0x5b5);const _0xddcdfd=document[_0x257340(0x400)](_0x257340(0x946));_0x4434fc['style'][_0x257340(0xf11)]=_0xddcdfd[_0x257340(0xa00)]['backgroundImage'],_0x4434fc[_0x257340(0xa00)][_0x257340(0x1296)]=_0xddcdfd[_0x257340(0xa00)][_0x257340(0x1296)]||(document['getElementById'](_0x257340(0x43a))[_0x257340(0xb08)][_0x257340(0xd3f)](_0x257340(0x1457))?_0x257340(0x15a9):_0x257340(0x126f));const _0x2a03d2=document[_0x257340(0x2c9)]('style');_0x2a03d2[_0x257340(0x1575)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.message-bubble.selected::after\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.default-controls\x20{\x20display:\x20flex\x20!important;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20width:\x20100%;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.selection-controls\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',document[_0x257340(0x203)][_0x257340(0x8f2)](_0x2a03d2);try{const _0x3f7cd1=_0xddcdfd[_0x257340(0x13ef)](_0x257340(0x1307))[_0x257340(0xdbc)](!![]);_0x3f7cd1['classList'][_0x257340(0x12b6)]('cloned-header');const _0x5d3237=document['createElement'](_0x257340(0xf8e)),_0x1bf9cd=document[_0x257340(0x400)](_0x257340(0x75b));_0x5d3237[_0x257340(0xa00)][_0x257340(0xb1a)]=_0x257340(0x375),_0x5d3237[_0x257340(0xa00)][_0x257340(0x1261)]=_0x257340(0x514),_0x5d3237[_0x257340(0xa00)][_0x257340(0x790)]=_0x257340(0x58b),_0x5d3237['style'][_0x257340(0x15cf)]=_0x257340(0x1391),_0x5d3237[_0x257340(0xa00)][_0x257340(0x1383)]=_0x257340(0x1011),_0x5d3237[_0x257340(0xa00)]['boxSizing']='border-box',_0x5d3237[_0x257340(0xd61)][_0x257340(0xa33)]=_0x1bf9cd[_0x257340(0xd61)][_0x257340(0xa33)],_0x5d3237[_0x257340(0xa00)][_0x257340(0x132a)]('--chat-font-size',_0x1bf9cd[_0x257340(0xa00)][_0x257340(0x8ff)](_0x257340(0x82b)));const _0x31cef3=_0xddcdfd[_0x257340(0x13ef)](_0x257340(0x1167))[_0x257340(0xdbc)](!![]),_0x301ba9=[..._0x141aad]['sort']((_0x419fea,_0x2a7294)=>_0x419fea-_0x2a7294);_0x301ba9[_0x257340(0xbdc)](_0xd74639=>{const _0xcd0b46=_0x257340,_0x236fd0=document['querySelector'](_0xcd0b46(0xfe4)+_0xd74639+'\x22]');if(_0x236fd0){const _0x3d8188=_0x236fd0[_0xcd0b46(0x117a)](_0xcd0b46(0x867));_0x3d8188&&_0x5d3237[_0xcd0b46(0x8f2)](_0x3d8188[_0xcd0b46(0xdbc)](!![]));}}),_0x4434fc[_0x257340(0x8f2)](_0x3f7cd1),_0x4434fc['appendChild'](_0x5d3237),_0x4434fc[_0x257340(0x8f2)](_0x31cef3),document[_0x257340(0x471)][_0x257340(0x8f2)](_0x4434fc);const _0x31b22d=Array[_0x257340(0xdc0)](_0x4434fc['getElementsByTagName'](_0x257340(0x14ef))),_0x2b052f=_0x31b22d[_0x257340(0xd18)](_0x5271a1=>new Promise((_0x1c5845,_0x5b0911)=>{const _0x25b8bb=_0x257340;if(_0x5271a1['src']['startsWith']('data:')){_0x1c5845();return;}const _0x5436e5=new Image();_0x5436e5[_0x25b8bb(0x2a3)]=_0x25b8bb(0xe74),_0x5436e5[_0x25b8bb(0x9e0)]=_0x1c5845,_0x5436e5['onerror']=_0x1c5845,_0x5436e5['src']=_0x5271a1[_0x25b8bb(0x912)];}));await Promise[_0x257340(0x875)](_0x2b052f);const _0x4617a7=await html2canvas(_0x4434fc,{'allowTaint':!![],'useCORS':!![],'backgroundColor':null,'scale':window[_0x257340(0x15c4)]||0x2});_0x4617a7[_0x257340(0x7a6)](function(_0x27c64a){const _0x121b31=_0x257340,_0x35b0a9=URL[_0x121b31(0xc2c)](_0x27c64a),_0x4a908f=document[_0x121b31(0x2c9)]('a');_0x4a908f[_0x121b31(0xcda)]=_0x121b31(0xc17)+_0x2185da['name']+'-'+Date['now']()+'.png',_0x4a908f['href']=_0x35b0a9,document[_0x121b31(0x471)][_0x121b31(0x8f2)](_0x4a908f),_0x4a908f[_0x121b31(0x15ad)](),document[_0x121b31(0x471)][_0x121b31(0x2e3)](_0x4a908f),URL['revokeObjectURL'](_0x35b0a9);},_0x257340(0x1443));}catch(_0x2e8a99){console[_0x257340(0x5d7)](_0x257340(0x934),_0x2e8a99),await _0x138765('生成失败',_0x257340(0x1201));}finally{document[_0x257340(0x471)][_0x257340(0x2e3)](_0x4434fc),document[_0x257340(0x203)][_0x257340(0x2e3)](_0x2a03d2),_0x3a9e38[_0x257340(0xde7)]=_0xe05eaf,_0x3a9e38['disabled']=![],_0x4e7c87();}}function _0x412ec9(_0x514c9d){const _0x4759b1=_0x239c7d;if(!_0x514c9d||typeof _0x514c9d!==_0x4759b1(0x158f))return'';return _0x514c9d=_0x514c9d[_0x4759b1(0xe19)](/!h\{(.*?)\}/g,_0x4759b1(0x516)),_0x514c9d=_0x514c9d[_0x4759b1(0xe19)](/!u\{(.*?)\}/g,_0x4759b1(0x6f2)),_0x514c9d=_0x514c9d['replace'](/!e\{(.*?)\}/g,_0x4759b1(0x1667)),_0x514c9d=_0x514c9d['replace'](/!w\{(.*?)\}/g,_0x4759b1(0xec4)),_0x514c9d=_0x514c9d[_0x4759b1(0xe19)](/!m\{(.*?)\}/g,_0x4759b1(0x114c)),_0x514c9d=_0x514c9d[_0x4759b1(0xe19)](/\|\|(.*?)\|\|/g,'<span\x20class=\x22spoiler\x22>$1</span>'),_0x514c9d=_0x514c9d[_0x4759b1(0xe19)](/\*\*(.*?)\*\*/g,_0x4759b1(0xb49)),_0x514c9d=_0x514c9d[_0x4759b1(0xe19)](/\~\~(.*?)\~\~/g,_0x4759b1(0xe55)),_0x514c9d=_0x514c9d[_0x4759b1(0xe19)](/\*(.*?)\*/g,'<em>$1</em>'),_0x514c9d;}async function _0x56a543(){const _0x206ed4=_0x239c7d;console[_0x206ed4(0x1e6)](_0x206ed4(0x328));let _0x59988e=0x0;const _0x42d722=Object[_0x206ed4(0x40a)](_0x4c8b14['chats']);for(const _0x15faec of _0x42d722){let _0x5f0423=![];for(const _0x39304d of _0x15faec[_0x206ed4(0x92c)]){_0x39304d[_0x206ed4(0xbbf)]==='red_packet'&&_0x39304d[_0x206ed4(0x1015)]==='direct'&&_0x39304d[_0x206ed4(0x71a)]===_0x206ed4(0x4fd)&&_0x39304d[_0x206ed4(0xf21)]('receiver')&&!_0x39304d[_0x206ed4(0xf21)](_0x206ed4(0x11fd))&&(_0x39304d['receiverName']=_0x39304d[_0x206ed4(0x7b6)],delete _0x39304d['receiver'],_0x5f0423=!![],_0x59988e++);}_0x5f0423&&(console[_0x206ed4(0x1e6)](_0x206ed4(0x3c9)+_0x15faec['name']+_0x206ed4(0x26a)),await _0x54c587[_0x206ed4(0xbea)][_0x206ed4(0x4cb)](_0x15faec));}_0x59988e>0x0?(console[_0x206ed4(0x1e6)](_0x206ed4(0x122f)+_0x59988e+_0x206ed4(0x10a3)),alert(_0x206ed4(0x14dc)+_0x59988e+_0x206ed4(0x8c2)),location['reload']()):console[_0x206ed4(0x1e6)]('未发现需要迁移的旧红包数据。');}async function _0x512385(){const _0x3b22ff=_0x239c7d;if(!_0x4c8b14[_0x3b22ff(0x1539)]||_0x4c8b14[_0x3b22ff(0xbea)][_0x4c8b14['activeChatId']][_0x3b22ff(0xc98)])return;const _0x4cd7f3=_0x4c8b14[_0x3b22ff(0xbea)][_0x4c8b14[_0x3b22ff(0x1539)]];if(!_0x4cd7f3)return;const _0x597d81=_0x4cd7f3['heartfeltVoice']||'',_0xa2b972=await _0x25f61f(_0x3b22ff(0x3ea)+_0x4cd7f3[_0x3b22ff(0xf3e)]+_0x3b22ff(0x1670),'请输入新的心声内容...',_0x597d81,_0x3b22ff(0x79e));if(_0xa2b972===null){await _0x138765(_0x3b22ff(0x1651),_0x3b22ff(0xae6));return;}const _0x47e73a=_0x4cd7f3[_0x3b22ff(0x13e5)]||'',_0x243ba0=await _0x25f61f(_0x3b22ff(0x3ea)+_0x4cd7f3[_0x3b22ff(0xf3e)]+'”的散记',_0x3b22ff(0x1e1),_0x47e73a,_0x3b22ff(0x79e));if(_0x243ba0===null){await _0x138765(_0x3b22ff(0x1651),_0x3b22ff(0xa4e));return;}_0x4cd7f3['heartfeltVoice']=_0xa2b972[_0x3b22ff(0xb8f)](),_0x4cd7f3[_0x3b22ff(0x13e5)]=_0x243ba0[_0x3b22ff(0xb8f)]();!Array[_0x3b22ff(0x16a1)](_0x4cd7f3['thoughtsHistory'])&&(_0x4cd7f3[_0x3b22ff(0x13a1)]=[]);if(_0x4cd7f3['thoughtsHistory'][_0x3b22ff(0x8d6)]>0x0){const _0x159496=_0x4cd7f3[_0x3b22ff(0x13a1)][_0x4cd7f3['thoughtsHistory'][_0x3b22ff(0x8d6)]-0x1];_0x159496[_0x3b22ff(0x8ab)]=_0x4cd7f3['heartfeltVoice'],_0x159496[_0x3b22ff(0x13e5)]=_0x4cd7f3[_0x3b22ff(0x13e5)],_0x159496['timestamp']=Date[_0x3b22ff(0xecd)]();}else _0x4cd7f3[_0x3b22ff(0x13a1)][_0x3b22ff(0x6bb)]({'heartfeltVoice':_0x4cd7f3[_0x3b22ff(0x8ab)],'randomJottings':_0x4cd7f3['randomJottings'],'timestamp':Date[_0x3b22ff(0xecd)]()});await _0x54c587[_0x3b22ff(0xbea)]['put'](_0x4cd7f3),await _0x2b6102(_0x4cd7f3['id']),await _0x138765('成功',_0x3b22ff(0x1143));}async function _0x2b6102(_0x55dedd){const _0x3786f2=_0x239c7d,_0x2fbbf6=_0x4c8b14[_0x3786f2(0xbea)][_0x55dedd];if(!_0x2fbbf6||_0x2fbbf6[_0x3786f2(0xc98)])return;const _0x9e77d3=document['getElementById'](_0x3786f2(0x43c)),_0xfea672=document['getElementById'](_0x3786f2(0x164e));_0x9e77d3[_0x3786f2(0x1575)]=await _0x25d95c(_0x2fbbf6[_0x3786f2(0x8ab)]||_0x3786f2(0x166b),_0x55dedd),_0xfea672[_0x3786f2(0x1575)]=await _0x25d95c(_0x2fbbf6[_0x3786f2(0x13e5)]||'...',_0x55dedd);const _0x155175=document[_0x3786f2(0x400)](_0x3786f2(0x259));_0x155175[_0x3786f2(0xb08)][_0x3786f2(0x12b6)](_0x3786f2(0x9eb));}async function _0x1efbb9(){const _0x45fefa=_0x239c7d;document[_0x45fefa(0x400)](_0x45fefa(0x11f4))[_0x45fefa(0xa00)][_0x45fefa(0xb1a)]=_0x45fefa(0x165b),document[_0x45fefa(0x400)](_0x45fefa(0x590))[_0x45fefa(0xa00)]['display']=_0x45fefa(0x375),await _0x4c5097();}function _0x2a0cea(){const _0x55fb7f=_0x239c7d;document['getElementById'](_0x55fb7f(0x590))['style'][_0x55fb7f(0xb1a)]=_0x55fb7f(0x165b),document[_0x55fb7f(0x400)](_0x55fb7f(0x11f4))[_0x55fb7f(0xa00)]['display']=_0x55fb7f(0x375);}async function _0x4c5097(){const _0x1980e3=_0x239c7d,_0x35e584=document[_0x1980e3(0x400)]('thoughts-history-list'),_0x2684ac=_0x4c8b14[_0x1980e3(0xbea)][_0x4c8b14[_0x1980e3(0x1539)]];_0x35e584[_0x1980e3(0x1575)]='';if(!_0x2684ac||!_0x2684ac['thoughtsHistory']||_0x2684ac['thoughtsHistory'][_0x1980e3(0x8d6)]===0x0){_0x35e584[_0x1980e3(0x1575)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20padding:\x2030px\x200;\x22>这里还没有历史记录哦。</p>';return;}const _0x57f138=[..._0x2684ac['thoughtsHistory']][_0x1980e3(0xfc1)](),_0x57bf21=_0x57f138[_0x1980e3(0x69f)](0x0,_0xa5c27e),_0x17c4ae=_0x57bf21[_0x1980e3(0xd18)](_0x219e76=>_0xdbb524(_0x219e76)),_0x417958=await Promise['all'](_0x17c4ae);_0x417958['forEach'](_0x3ab638=>_0x35e584[_0x1980e3(0x8f2)](_0x3ab638)),_0x42d9d9=_0x57bf21['length'],_0x57f138[_0x1980e3(0x8d6)]>_0x42d9d9&&appendLoadMoreThoughtsButton(_0x35e584);}async function _0x4c9c15(){const _0x56f9f6=_0x239c7d;if(_0x2ae06b)return;_0x2ae06b=!![];const _0x3e4e50=document['getElementById']('thoughts-history-list'),_0x5398c8=_0x4c8b14[_0x56f9f6(0xbea)][_0x4c8b14[_0x56f9f6(0x1539)]];if(!_0x5398c8){_0x2ae06b=![];return;}_0x3a43dd(_0x3e4e50,_0x56f9f6(0xa69)),await new Promise(_0x15a118=>setTimeout(_0x15a118,0x1f4));const _0x3a8437=[..._0x5398c8[_0x56f9f6(0x13a1)]]['reverse'](),_0x468361=_0x3a8437['length'],_0x4f2dba=_0x42d9d9,_0x3d7fc2=_0x42d9d9+_0xa5c27e,_0x2eecba=_0x3a8437[_0x56f9f6(0x69f)](_0x4f2dba,_0x3d7fc2);_0x42da12(_0x3e4e50);const _0x12a99b=_0x2eecba[_0x56f9f6(0xd18)](_0x2494ef=>_0xdbb524(_0x2494ef)),_0x5b06d1=await Promise[_0x56f9f6(0x875)](_0x12a99b);_0x5b06d1[_0x56f9f6(0xbdc)](_0x5377bb=>_0x3e4e50[_0x56f9f6(0x8f2)](_0x5377bb)),_0x42d9d9+=_0x2eecba['length'],_0x2ae06b=![];}async function _0xdbb524(_0x261cd5){const _0x23f33e=_0x239c7d,_0x57407e=document[_0x23f33e(0x2c9)](_0x23f33e(0xf8e));_0x57407e[_0x23f33e(0x4e1)]=_0x23f33e(0xdc6);const _0x3d65b1=new Date(_0x261cd5[_0x23f33e(0x287)]),_0x561ad8=_0x3d65b1[_0x23f33e(0x1619)]()+'-'+String(_0x3d65b1[_0x23f33e(0xebe)]()+0x1)[_0x23f33e(0xb7d)](0x2,'0')+'-'+String(_0x3d65b1['getDate']())['padStart'](0x2,'0')+'\x20'+String(_0x3d65b1[_0x23f33e(0x331)]())[_0x23f33e(0xb7d)](0x2,'0')+':'+String(_0x3d65b1[_0x23f33e(0x1297)]())[_0x23f33e(0xb7d)](0x2,'0'),_0x28d330=_0x4c8b14[_0x23f33e(0x1539)],_0x102366=await _0x25d95c(_0x261cd5[_0x23f33e(0x8ab)]||'...',_0x28d330),_0x53f2c1=await _0x25d95c(_0x261cd5[_0x23f33e(0x13e5)]||_0x23f33e(0x166b),_0x28d330);return _0x57407e['innerHTML']=_0x23f33e(0x1504)+_0x261cd5[_0x23f33e(0x287)]+_0x23f33e(0x7ae)+_0x561ad8+_0x23f33e(0x153f)+_0x102366+_0x23f33e(0x1272)+_0x53f2c1+_0x23f33e(0x1344),_0x57407e;}async function _0x5982b9(_0x127155){const _0x5e1b6=_0x239c7d,_0x9e00ec=_0x127155['target'][_0x5e1b6(0x780)][0x0];if(!_0x9e00ec)return;try{let _0x33d099,_0x35ebb9=null;if(_0x9e00ec['name'][_0x5e1b6(0x8c7)](_0x5e1b6(0xbfb))){const _0x56a73e=await _0x9e00ec[_0x5e1b6(0x117f)]();_0x33d099=JSON[_0x5e1b6(0x13f7)](_0x56a73e);}else{if(_0x9e00ec[_0x5e1b6(0xf3e)]['endsWith'](_0x5e1b6(0x57b))){const _0x322c41=await _0x9e00ec['arrayBuffer']();_0x33d099=await _0x164adf(_0x322c41),_0x35ebb9=await new Promise(_0x2f01d1=>{const _0x1ffb21=_0x5e1b6,_0x3eb924=new FileReader();_0x3eb924[_0x1ffb21(0x9e0)]=()=>_0x2f01d1(_0x3eb924[_0x1ffb21(0xdd1)]),_0x3eb924[_0x1ffb21(0x157f)](_0x9e00ec);});}else throw new Error(_0x5e1b6(0x835));}await _0x1eb273(_0x33d099,_0x35ebb9);}catch(_0x397b25){console['error'](_0x5e1b6(0x1fa),_0x397b25),await _0x138765(_0x5e1b6(0x3e8),_0x5e1b6(0x3c3)+_0x397b25[_0x5e1b6(0x6e2)]);}finally{_0x127155[_0x5e1b6(0x657)][_0x5e1b6(0xa1e)]=null;}}function _0x164adf(_0x4b6745){return new Promise((_0x5d52ce,_0x354cbc)=>{const _0x77fc3=_0x466f,_0x2d9467=new DataView(_0x4b6745);if(_0x2d9467[_0x77fc3(0x52c)](0x0)!==0x89504e47||_0x2d9467[_0x77fc3(0x52c)](0x4)!==0xd0a1a0a)return _0x354cbc(new Error('文件不是一个有效的PNG。'));let _0x3a1506=0x8;const _0x460239=new TextDecoder();while(_0x3a1506<_0x2d9467[_0x77fc3(0x523)]){const _0x1cdfe0=_0x2d9467[_0x77fc3(0x52c)](_0x3a1506),_0x11a118=_0x460239[_0x77fc3(0x157c)](_0x4b6745[_0x77fc3(0x69f)](_0x3a1506+0x4,_0x3a1506+0x8));if(_0x11a118===_0x77fc3(0xe6d)){const _0x382208=new Uint8Array(_0x4b6745,_0x3a1506+0x8,_0x1cdfe0),_0x1eed90=_0x382208[_0x77fc3(0xd53)](0x0);if(_0x1eed90!==-0x1){const _0x21a436=_0x460239[_0x77fc3(0x157c)](_0x382208[_0x77fc3(0x69f)](0x0,_0x1eed90));if(_0x21a436===_0x77fc3(0x4d7)){const _0x28eddd=_0x460239[_0x77fc3(0x157c)](_0x382208[_0x77fc3(0x69f)](_0x1eed90+0x1));try{const _0x2204aa=atob(_0x28eddd),_0x32dbb7=new Uint8Array(_0x2204aa[_0x77fc3(0x8d6)]);for(let _0x4fbe76=0x0;_0x4fbe76<_0x2204aa[_0x77fc3(0x8d6)];_0x4fbe76++){_0x32dbb7[_0x4fbe76]=_0x2204aa[_0x77fc3(0xd17)](_0x4fbe76);}const _0x4f6960=new TextDecoder(_0x77fc3(0xb6e))['decode'](_0x32dbb7);_0x5d52ce(JSON[_0x77fc3(0x13f7)](_0x4f6960));return;}catch(_0x39cded){return _0x354cbc(new Error(_0x77fc3(0xc4a)+_0x39cded[_0x77fc3(0x6e2)]));}}}}_0x3a1506+=0x4+0x4+_0x1cdfe0+0x4;}_0x354cbc(new Error(_0x77fc3(0x13ce)));});}function _0x1d419b(_0x5052f3){const _0x2b56c4=_0x239c7d;if(_0x5052f3[_0x2b56c4(0x55b)]?.[_0x2b56c4(0xeb7)]?.[_0x2b56c4(0x9de)]?.[_0x2b56c4(0x8d6)]>0x0)return console['log'](_0x2b56c4(0x70b)),_0x5052f3[_0x2b56c4(0x55b)][_0x2b56c4(0xeb7)][_0x2b56c4(0x9de)];if(_0x5052f3['extensions']?.[_0x2b56c4(0xeb7)]?.[_0x2b56c4(0x9de)]?.['length']>0x0)return console['log']('诊断：在\x20extensions.character_book\x20中找到世界书。'),_0x5052f3[_0x2b56c4(0x12d9)][_0x2b56c4(0xeb7)][_0x2b56c4(0x9de)];if(_0x5052f3[_0x2b56c4(0x55b)]?.[_0x2b56c4(0x12d9)]?.[_0x2b56c4(0xeb7)]?.[_0x2b56c4(0x9de)]?.[_0x2b56c4(0x8d6)]>0x0)return console[_0x2b56c4(0x1e6)]('诊断：在\x20data.extensions.character_book\x20中找到世界书。'),_0x5052f3['data'][_0x2b56c4(0x12d9)][_0x2b56c4(0xeb7)][_0x2b56c4(0x9de)];const _0x3638d1=['character_book',_0x2b56c4(0xbc7),_0x2b56c4(0xf26),_0x2b56c4(0x602)];for(const _0x3220c9 of _0x3638d1){if(_0x5052f3[_0x3220c9]?.[_0x2b56c4(0x9de)]?.[_0x2b56c4(0x8d6)]>0x0)return console[_0x2b56c4(0x1e6)](_0x2b56c4(0x42c)+_0x3220c9+_0x2b56c4(0x920)),_0x5052f3[_0x3220c9]['entries'];}return console['log'](_0x2b56c4(0x483)),null;}async function _0x1eb273(_0x5f23f1,_0x14965=null){const _0x505c1c=_0x239c7d,_0x5f2c0a=_0x5f23f1['data']||_0x5f23f1;if(!_0x5f2c0a[_0x505c1c(0xf3e)])throw new Error(_0x505c1c(0x150b));let _0x4ddb01=null;const _0x14527b=_0x1d419b(_0x5f23f1);if(_0x14527b){const _0x1f6c5b=_0x14527b[_0x505c1c(0x29d)](_0x649318=>_0x649318['enabled']&&_0x649318[_0x505c1c(0x1109)])[_0x505c1c(0xd18)](_0x2b442c=>({'keys':_0x2b442c[_0x505c1c(0x1161)]||[],'comment':_0x2b442c[_0x505c1c(0x83c)]||'','content':_0x2b442c[_0x505c1c(0x1109)][_0x505c1c(0xe19)](/<memory>|<\/memory>/g,'')['trim']()}));if(_0x1f6c5b[_0x505c1c(0x8d6)]>0x0){const _0x5b38be={'id':_0x505c1c(0x7e0)+Date[_0x505c1c(0xecd)](),'name':_0x5f2c0a['name']+'的设定集','content':_0x1f6c5b,'categoryId':null};await _0x54c587[_0x505c1c(0xf57)][_0x505c1c(0x12b6)](_0x5b38be),_0x4c8b14[_0x505c1c(0xf57)][_0x505c1c(0x6bb)](_0x5b38be),_0x4ddb01=_0x5b38be['id'];}}let _0x50d1e3=_0x5f2c0a[_0x505c1c(0x12a5)]||_0x5f23f1[_0x505c1c(0x12a5)]||'无';_0x50d1e3=_0x50d1e3[_0x505c1c(0xe19)](/```yaml/g,'')[_0x505c1c(0xe19)](/```/g,'')[_0x505c1c(0xe19)](/<\/?info>/g,'')[_0x505c1c(0xe19)](/<\/?character>/g,'')['replace'](/<\/?writing_rule>/g,'')[_0x505c1c(0xe19)](/\[OOC：.*?\]/g,'')[_0x505c1c(0xb8f)]();let _0x5422b3='#\x20角色核心设定\x0a'+_0x50d1e3+'\x0a\x0a';if(_0x5f2c0a[_0x505c1c(0xe61)])_0x5422b3+=_0x505c1c(0xa59)+_0x5f2c0a[_0x505c1c(0xe61)]+'\x0a\x0a';if(_0x5f2c0a[_0x505c1c(0x6ea)])_0x5422b3+=_0x505c1c(0x305)+_0x5f2c0a['scenario']+'\x0a\x0a';if(_0x5f2c0a[_0x505c1c(0x9dd)])_0x5422b3+=_0x505c1c(0x84b)+_0x5f2c0a[_0x505c1c(0x9dd)]+'\x0a\x0a';const _0x1eb85b=_0x5f2c0a[_0x505c1c(0xf3e)],_0xed1e25=_0x5f2c0a[_0x505c1c(0xf3e)],_0x46f8d2=_0x505c1c(0x11cd)+Date['now'](),_0xc4d804={'id':_0x46f8d2,'name':_0x1eb85b[_0x505c1c(0xb8f)](),'originalName':_0xed1e25['trim'](),'isGroup':![],'relationship':{'status':'friend'},'status':{'text':'在线','lastUpdate':Date[_0x505c1c(0xecd)](),'isBusy':![]},'settings':{'aiPersona':_0x5422b3,'myPersona':_0x505c1c(0xe86),'maxMemory':0xa,'aiAvatar':_0x91d058,'myAvatar':_0x91d058,'background':'','theme':_0x505c1c(0x855),'fontSize':0xd,'customCss':'','linkedWorldBookIds':_0x4ddb01?[_0x4ddb01]:[],'aiAvatarLibrary':[]},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[]};_0x14965&&(_0xc4d804[_0x505c1c(0xa37)][_0x505c1c(0xb24)]=_0x14965,_0xc4d804['settings']['aiAvatarLibrary'][_0x505c1c(0x6bb)]({'name':_0x505c1c(0x3a7),'url':_0x14965}));const _0x2321a8=_0x5f2c0a[_0x505c1c(0x14cb)]||_0x5f23f1[_0x505c1c(0x14cb)];if(_0x2321a8&&typeof _0x2321a8===_0x505c1c(0x158f)){const _0x86591b=document[_0x505c1c(0x2c9)]('div');_0x86591b[_0x505c1c(0x1575)]=_0x2321a8;const _0x263556=(_0x86591b[_0x505c1c(0xde7)]||_0x86591b[_0x505c1c(0x1624)]||'')[_0x505c1c(0xe19)](/原作者UR.*?开局/s,'')['trim']();_0x263556&&_0xc4d804[_0x505c1c(0x92c)]['push']({'role':'assistant','senderName':_0xc4d804[_0x505c1c(0xdcf)],'content':_0x263556,'timestamp':Date[_0x505c1c(0xecd)]()});}_0x4c8b14[_0x505c1c(0xbea)][_0x46f8d2]=_0xc4d804,await _0x54c587[_0x505c1c(0xbea)][_0x505c1c(0x4cb)](_0xc4d804),_0x41b828();let _0xc6af9a=_0x505c1c(0x81b)+_0xc4d804[_0x505c1c(0xf3e)]+'”\x20已成功导入！';_0x4ddb01&&(_0xc6af9a+='\x0a\x0a其专属的“世界书”也已自动创建并关联。'),await _0x138765('导入成功！',_0xc6af9a);}async function _0x2dcee0(){const _0xb59a99=_0x239c7d;if(!_0x4c8b14[_0xb59a99(0x1539)])return;const _0x122f6d=_0x4c8b14[_0xb59a99(0xbea)][_0x4c8b14['activeChatId']],_0x508d8f=_0x122f6d[_0xb59a99(0xa37)][_0xb59a99(0x11c2)];if(!_0x508d8f||_0x508d8f['length']===0x0){alert(_0xb59a99(0x12ad));return;}const _0x30ba05=_0x508d8f['map']((_0xc2d7c7,_0x38e69c)=>{const _0x85f6f2=_0xb59a99,_0x3aa791=_0xc2d7c7[_0x85f6f2(0xe19)](/<[^>]*>/g,'')['trim']()[_0x85f6f2(0x371)](0x0,0x14);return{'text':_0x85f6f2(0x138d)+(_0x38e69c+0x1)+':\x20'+_0x3aa791+_0x85f6f2(0x166b),'value':_0x38e69c};}),_0x581267=await _0x14b058(_0xb59a99(0xca1),_0x30ba05);if(_0x581267!==null){const _0x11de83=await _0x56d4d3(_0xb59a99(0xe14),_0xb59a99(0x14c5),{'confirmButtonClass':_0xb59a99(0x142c),'confirmText':'确定切换'});if(_0x11de83){const _0x3b0b18=_0x508d8f[_0x581267],_0x3a3c8a={'role':_0xb59a99(0x4fd),'senderName':_0x122f6d[_0xb59a99(0xdcf)],'content':_0x3b0b18,'timestamp':Date['now']()};_0x122f6d[_0xb59a99(0x92c)]=[_0x3a3c8a],await _0x54c587[_0xb59a99(0xbea)][_0xb59a99(0x4cb)](_0x122f6d),_0x26354c(_0x122f6d['id']),document[_0xb59a99(0x400)]('chat-settings-modal')[_0xb59a99(0xb08)]['remove'](_0xb59a99(0x9eb)),await _0x138765('成功',_0xb59a99(0x8a5));}}}function _0x308c96(_0x3ecb7e={'keys':[],'comment':'','content':'','enabled':!![]}){const _0xe6b4d6=_0x239c7d,_0x2afd58=document[_0xe6b4d6(0x2c9)]('div');_0x2afd58['className']=_0xe6b4d6(0xf99);const _0xf8ed9d=_0x3ecb7e['enabled']!==![]?_0xe6b4d6(0x6f9):'';return _0x2afd58['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20'+_0xf8ed9d+_0xe6b4d6(0x121d)+(_0x3ecb7e['comment']||'')+_0xe6b4d6(0x12e9)+(_0x3ecb7e[_0xe6b4d6(0x1161)]||[])[_0xe6b4d6(0xee1)](',\x20')+'\x22\x20placeholder=\x22例如:\x20key1,\x20key2,\x20key3\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>内容</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x225\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>'+(_0x3ecb7e[_0xe6b4d6(0x1109)]||'')+_0xe6b4d6(0x1558),_0x2afd58['querySelector']('.delete-block-btn')[_0xe6b4d6(0x501)](_0xe6b4d6(0x15ad),()=>{_0x2afd58['remove']();}),_0x2afd58;}async function _0x7e2961(){const _0x3d872b=_0x239c7d;if(!_0x4c8b14['activeChatId'])return;const _0x495c0b=_0x4c8b14['activeChatId'],_0xe8680b=document[_0x3d872b(0x400)](_0x3d872b(0x687));if(!_0xe8680b['classList']['contains'](_0x3d872b(0x9eb))){const _0x20e3d1=document[_0x3d872b(0x13ef)]('#chat-interface-screen\x20>\x20.header');_0xe8680b[_0x3d872b(0xa00)][_0x3d872b(0x899)]=_0x20e3d1[_0x3d872b(0x1134)]+'px',_0xe8680b['style'][_0x3d872b(0xb1a)]=_0x3d872b(0x1181),(!_0x30ad43[_0x495c0b]||!_0x30ad43[_0x495c0b][_0x3d872b(0x11e7)])&&_0x26464c(_0x495c0b),_0x41d1fc(_0x495c0b),setTimeout(async()=>{const _0x3d23e4=_0x3d872b;_0xe8680b[_0x3d23e4(0xb08)][_0x3d23e4(0x12b6)](_0x3d23e4(0x9eb));const _0x38f2ed={'role':_0x3d23e4(0xaf6),'content':'[系统提示：用户打开了五子棋棋盘，游戏开始了。]','timestamp':Date[_0x3d23e4(0xecd)](),'isHidden':!![]};_0x4c8b14[_0x3d23e4(0xbea)][_0x495c0b][_0x3d23e4(0x92c)][_0x3d23e4(0x6bb)](_0x38f2ed),await _0x54c587[_0x3d23e4(0xbea)]['put'](_0x4c8b14[_0x3d23e4(0xbea)][_0x495c0b]);},0xa);}else await _0x5c2b5e();}async function _0x5c2b5e(){const _0x516d91=_0x239c7d;if(!_0x4c8b14[_0x516d91(0x1539)])return;const _0x3241af=_0x4c8b14[_0x516d91(0x1539)],_0x50854f=document[_0x516d91(0x400)](_0x516d91(0x687));_0x50854f[_0x516d91(0xb08)]['remove'](_0x516d91(0x9eb)),setTimeout(()=>{const _0x4ac9d2=_0x516d91;_0x50854f[_0x4ac9d2(0xa00)][_0x4ac9d2(0xb1a)]=_0x4ac9d2(0x165b);},0x12c);if(_0x30ad43[_0x3241af]){_0x30ad43[_0x3241af]['isActive']=![];const _0x4c409d={'role':_0x516d91(0xaf6),'content':_0x516d91(0x9f0),'timestamp':Date['now'](),'isHidden':!![]};_0x4c8b14[_0x516d91(0xbea)][_0x3241af]['history'][_0x516d91(0x6bb)](_0x4c409d),await _0x54c587[_0x516d91(0xbea)][_0x516d91(0x4cb)](_0x4c8b14[_0x516d91(0xbea)][_0x3241af]);}}function _0x26464c(_0x153b46){const _0x5db125=_0x239c7d,_0x58b461=document[_0x5db125(0x400)](_0x5db125(0xf36)),_0x293e05=document['getElementById'](_0x5db125(0x687)),_0x4fd117=document[_0x5db125(0x400)](_0x5db125(0xd22)),_0x2d750b=_0x293e05[_0x5db125(0xeeb)]-0x28,_0x38ae82=_0x293e05['offsetHeight']-_0x4fd117[_0x5db125(0x1134)]-0x28,_0x21f26b=Math[_0x5db125(0x1381)](Math[_0x5db125(0xaeb)](_0x2d750b,_0x38ae82)),_0x37dd28=0xf,_0x129e82=Math[_0x5db125(0x1381)](_0x21f26b/_0x37dd28),_0x1b48c2=_0x129e82*_0x37dd28;_0x58b461['width']=_0x1b48c2,_0x58b461[_0x5db125(0x14af)]=_0x1b48c2,_0x30ad43[_0x153b46]={'isActive':!![],'board':Array(_0x37dd28)[_0x5db125(0xa0e)](0x0)[_0x5db125(0xd18)](()=>Array(_0x37dd28)[_0x5db125(0xa0e)](0x0)),'currentPlayer':0x1,'history':[],'isGameOver':![],'GRID_SIZE':_0x37dd28,'CELL_SIZE':_0x129e82};}function _0x41d1fc(_0x4aa05f){const _0x5b15e0=_0x239c7d,_0x5e69ac=_0x30ad43[_0x4aa05f];if(!_0x5e69ac)return;const _0x22415d=document[_0x5b15e0(0x400)](_0x5b15e0(0xf36)),_0x3550a6=_0x22415d[_0x5b15e0(0x146b)]('2d'),{GRID_SIZE:_0x59df1b,CELL_SIZE:_0x3bf8df}=_0x5e69ac,_0x3914fc=_0x3bf8df/0x2;_0x3550a6[_0x5b15e0(0x5be)](0x0,0x0,_0x22415d[_0x5b15e0(0x1383)],_0x22415d['height']),_0x3550a6[_0x5b15e0(0x758)]=_0x5b15e0(0x15eb),_0x3550a6['fillRect'](0x0,0x0,_0x22415d['width'],_0x22415d[_0x5b15e0(0x14af)]),_0x3550a6[_0x5b15e0(0x14ce)]='#5b3a29',_0x3550a6[_0x5b15e0(0x818)]=0x1;for(let _0xa84a3c=0x0;_0xa84a3c<_0x59df1b;_0xa84a3c++){_0x3550a6[_0x5b15e0(0x1559)](),_0x3550a6['moveTo'](_0x3914fc,_0x3914fc+_0xa84a3c*_0x3bf8df),_0x3550a6[_0x5b15e0(0x112d)](_0x22415d[_0x5b15e0(0x1383)]-_0x3914fc,_0x3914fc+_0xa84a3c*_0x3bf8df),_0x3550a6[_0x5b15e0(0x6bd)](),_0x3550a6[_0x5b15e0(0x1559)](),_0x3550a6[_0x5b15e0(0x4f6)](_0x3914fc+_0xa84a3c*_0x3bf8df,_0x3914fc),_0x3550a6[_0x5b15e0(0x112d)](_0x3914fc+_0xa84a3c*_0x3bf8df,_0x22415d[_0x5b15e0(0x14af)]-_0x3914fc),_0x3550a6[_0x5b15e0(0x6bd)]();}for(let _0x155409=0x0;_0x155409<_0x59df1b;_0x155409++){for(let _0xc9443a=0x0;_0xc9443a<_0x59df1b;_0xc9443a++){_0x5e69ac[_0x5b15e0(0x8f7)][_0x155409][_0xc9443a]!==0x0&&_0x30b79a(_0x3550a6,_0xc9443a,_0x155409,_0x5e69ac[_0x5b15e0(0x8f7)][_0x155409][_0xc9443a],_0x5e69ac);}}}function _0x30b79a(_0x1124a2,_0x43571c,_0x23ad84,_0xcea947,_0x238086){const _0x5d8b1d=_0x239c7d,{CELL_SIZE:_0x15bf36}=_0x238086,_0x5c191e=_0x15bf36/0x2,_0x2debc4=_0x15bf36/0x2-0x2;_0x1124a2[_0x5d8b1d(0x1559)](),_0x1124a2['arc'](_0x5c191e+_0x43571c*_0x15bf36,_0x5c191e+_0x23ad84*_0x15bf36,_0x2debc4,0x0,0x2*Math['PI']),_0xcea947===0x1?_0x1124a2[_0x5d8b1d(0x758)]=_0x5d8b1d(0x77c):_0x1124a2[_0x5d8b1d(0x758)]='white',_0x1124a2['fill']();}function _0x324496(_0x1e5916){const _0x245054=_0x239c7d,_0x5ec975=_0x4c8b14['activeChatId'],_0x4d659e=_0x30ad43[_0x5ec975];if(!_0x4d659e||_0x4d659e[_0x245054(0x23f)]||_0x4d659e[_0x245054(0x13b5)]!==0x1)return;const _0x5adfda=document['getElementById'](_0x245054(0xf36)),_0x18c065=_0x5adfda[_0x245054(0x146b)]('2d'),_0x29faea=_0x5adfda['getBoundingClientRect'](),_0x109d32=_0x1e5916[_0x245054(0x13c9)]-_0x29faea[_0x245054(0xfef)],_0x48ce3f=_0x1e5916['clientY']-_0x29faea[_0x245054(0x899)],_0x4ae466=Math['round']((_0x109d32-_0x4d659e[_0x245054(0x515)]/0x2)/_0x4d659e[_0x245054(0x515)]),_0x558419=Math[_0x245054(0x312)]((_0x48ce3f-_0x4d659e[_0x245054(0x515)]/0x2)/_0x4d659e[_0x245054(0x515)]);_0x41d1fc(_0x5ec975);if(_0x4ae466>=0x0&&_0x4ae466<_0x4d659e[_0x245054(0x5b7)]&&_0x558419>=0x0&&_0x558419<_0x4d659e[_0x245054(0x5b7)]&&_0x4d659e[_0x245054(0x8f7)][_0x558419][_0x4ae466]===0x0){const _0x4588e0=_0x4d659e[_0x245054(0x515)]/0x2-0x2;_0x18c065['beginPath'](),_0x18c065['arc'](_0x4d659e[_0x245054(0x515)]/0x2+_0x4ae466*_0x4d659e['CELL_SIZE'],_0x4d659e[_0x245054(0x515)]/0x2+_0x558419*_0x4d659e[_0x245054(0x515)],_0x4588e0,0x0,0x2*Math['PI']),_0x18c065[_0x245054(0x758)]=_0x245054(0x1464),_0x18c065[_0x245054(0xa0e)]();}}function _0x100214(_0x17c240){const _0x5ee093=_0x239c7d,_0x5f5472=_0x4c8b14[_0x5ee093(0x1539)],_0x507566=_0x30ad43[_0x5f5472];if(!_0x507566||_0x507566[_0x5ee093(0x23f)]||_0x507566[_0x5ee093(0x13b5)]!==0x1)return;const _0x5265c2=document['getElementById'](_0x5ee093(0xf36)),_0x5e66b5=_0x5265c2[_0x5ee093(0x1437)](),_0x55fa0a=_0x17c240[_0x5ee093(0x13c9)]-_0x5e66b5[_0x5ee093(0xfef)],_0x414ed5=_0x17c240[_0x5ee093(0xcc8)]-_0x5e66b5[_0x5ee093(0x899)],_0xba962e=Math[_0x5ee093(0x312)]((_0x55fa0a-_0x507566['CELL_SIZE']/0x2)/_0x507566[_0x5ee093(0x515)]),_0x5a0620=Math['round']((_0x414ed5-_0x507566[_0x5ee093(0x515)]/0x2)/_0x507566[_0x5ee093(0x515)]);_0xba962e>=0x0&&_0xba962e<_0x507566[_0x5ee093(0x5b7)]&&_0x5a0620>=0x0&&_0x5a0620<_0x507566['GRID_SIZE']&&_0x507566['board'][_0x5a0620][_0xba962e]===0x0&&(_0x507566[_0x5ee093(0x8f7)][_0x5a0620][_0xba962e]=0x1,_0x507566['history'][_0x5ee093(0x6bb)]({'x':_0xba962e,'y':_0x5a0620,'player':0x1}),_0x41d1fc(_0x5f5472),_0x228e08(_0xba962e,_0x5a0620,0x1,_0x507566)?(_0x507566[_0x5ee093(0x23f)]=!![],setTimeout(()=>alert(_0x5ee093(0x128d)),0x64),_0x58df81(_0x5ee093(0x6d6))):_0x507566[_0x5ee093(0x13b5)]=0x2);}function _0x1c3bf5(_0x398cfa,_0x8ead54=![]){const _0x3105c0=_0x239c7d,_0x598123=_0x4c8b14['activeChatId'],_0x4fcd29=_0x30ad43[_0x598123];if(!_0x4fcd29||_0x4fcd29['isGameOver'])return;if(!_0x8ead54&&_0x4fcd29[_0x3105c0(0x13b5)]!==0x2)return;const {x:_0x5c88ff,y:_0x53fed1}=_0x398cfa;_0x5c88ff>=0x0&&_0x5c88ff<_0x4fcd29['GRID_SIZE']&&_0x53fed1>=0x0&&_0x53fed1<_0x4fcd29[_0x3105c0(0x5b7)]&&_0x4fcd29[_0x3105c0(0x8f7)][_0x53fed1][_0x5c88ff]===0x0?(_0x4fcd29['board'][_0x53fed1][_0x5c88ff]=0x2,_0x4fcd29[_0x3105c0(0x92c)][_0x3105c0(0x6bb)]({'x':_0x5c88ff,'y':_0x53fed1,'player':0x2}),_0x41d1fc(_0x598123),_0x228e08(_0x5c88ff,_0x53fed1,0x2,_0x4fcd29)?(_0x4fcd29[_0x3105c0(0x23f)]=!![],setTimeout(()=>alert(_0x3105c0(0x1349)),0x64),_0x58df81('ai')):_0x4fcd29[_0x3105c0(0x13b5)]=0x1):(console[_0x3105c0(0x75e)]('AI\x20的下棋指令无效或位置已被占据:',_0x398cfa),_0x4fcd29[_0x3105c0(0x13b5)]=0x1);}function _0x228e08(_0x40a085,_0x5cbac4,_0x42a65c,_0x47a067){const {board:_0x4f9875,GRID_SIZE:_0x2d7829}=_0x47a067,_0x5ab355=[[0x1,0x0],[0x0,0x1],[0x1,0x1],[0x1,-0x1]];for(const [_0x49109f,_0x113cf4]of _0x5ab355){let _0x2e633c=0x1;for(let _0x468df7=0x1;_0x468df7<0x5;_0x468df7++){const _0x2b37e3=_0x40a085+_0x468df7*_0x49109f,_0x3233e7=_0x5cbac4+_0x468df7*_0x113cf4;if(_0x2b37e3>=0x0&&_0x2b37e3<_0x2d7829&&_0x3233e7>=0x0&&_0x3233e7<_0x2d7829&&_0x4f9875[_0x3233e7][_0x2b37e3]===_0x42a65c)_0x2e633c++;else break;}for(let _0x36e85e=0x1;_0x36e85e<0x5;_0x36e85e++){const _0x4e6800=_0x40a085-_0x36e85e*_0x49109f,_0x4d235b=_0x5cbac4-_0x36e85e*_0x113cf4;if(_0x4e6800>=0x0&&_0x4e6800<_0x2d7829&&_0x4d235b>=0x0&&_0x4d235b<_0x2d7829&&_0x4f9875[_0x4d235b][_0x4e6800]===_0x42a65c)_0x2e633c++;else break;}if(_0x2e633c>=0x5)return!![];}return![];}function _0x2e836a(_0x4c99de){const _0x34bcf4=_0x239c7d;if(!_0x4c99de||!_0x4c99de['isActive'])return'';let _0x2d3d9d=_0x34bcf4(0xb23);_0x2d3d9d+=_0x4c99de[_0x34bcf4(0x8f7)]['map'](_0x2961e5=>_0x2961e5[_0x34bcf4(0xee1)]('\x20'))[_0x34bcf4(0xee1)]('\x0a');let _0x13f178=_0x34bcf4(0xe3f);return _0x13f178+=_0x4c99de['history'][_0x34bcf4(0xd18)](_0x2fc754=>'玩家'+_0x2fc754[_0x34bcf4(0x90c)]+_0x34bcf4(0xff1)+_0x2fc754['x']+','+_0x2fc754['y']+')')[_0x34bcf4(0xee1)](_0x34bcf4(0x3db)),'\x0a#\x20当前五子棋局势\x0a'+_0x2d3d9d+'\x0a\x0a#\x20'+_0x13f178+_0x34bcf4(0x13ac);}async function _0x58df81(_0x2fa956){const _0x2c5a64=_0x239c7d,_0x32dec0=_0x4c8b14[_0x2c5a64(0x1539)],_0xa87abc=_0x4c8b14[_0x2c5a64(0xbea)][_0x32dec0];if(!_0xa87abc)return;const _0x31685a=_0xa87abc[_0x2c5a64(0xc98)]?_0xa87abc[_0x2c5a64(0xa37)][_0x2c5a64(0x14a8)]||'我':'我',_0x2a81d3=_0xa87abc[_0x2c5a64(0xc98)]?'AI方':_0xa87abc[_0x2c5a64(0xf3e)],_0x1a5b91=_0x2fa956===_0x2c5a64(0x6d6)?_0x31685a:_0x2a81d3,_0x24b49a=_0x2fa956===_0x2c5a64(0x6d6)?'你输了':_0x2c5a64(0x714),_0x50e5d1=_0x2c5a64(0xb21)+_0x1a5b91+'\x20获胜。也就是说，'+_0x24b49a+'。]',_0x291b10={'role':_0x2c5a64(0xaf6),'content':_0x50e5d1,'timestamp':Date['now'](),'isHidden':!![]};_0xa87abc[_0x2c5a64(0x92c)][_0x2c5a64(0x6bb)](_0x291b10),await _0x54c587[_0x2c5a64(0xbea)][_0x2c5a64(0x4cb)](_0xa87abc),console[_0x2c5a64(0x1e6)](_0x2c5a64(0x12b9)+_0x2fa956);}let _0xa8ab59=![];async function _0x4cf8d9(){const _0x38398c=_0x239c7d,_0x19c19f=document['getElementById'](_0x38398c(0x68d)),_0x372853=document[_0x38398c(0x400)](_0x38398c(0x217)),_0x5259e2=document[_0x38398c(0x400)](_0x38398c(0x732));_0x19c19f[_0x38398c(0x1575)]='',_0x372853[_0x38398c(0x1575)]='';const [_0x2ad266,_0x2aa1db]=await Promise[_0x38398c(0x875)]([_0x54c587['shoppingProducts']['toArray'](),_0x54c587[_0x38398c(0xd21)]['orderBy'](_0x38398c(0xf3e))[_0x38398c(0xce1)]()]);_0x5259e2[_0x38398c(0xb08)]['toggle'](_0x38398c(0x1245),_0xa8ab59);const _0xf2406b=document['createElement'](_0x38398c(0x99b));_0xf2406b[_0x38398c(0x4e1)]=_0x38398c(0x145b),_0xf2406b[_0x38398c(0xde7)]='全部',_0xf2406b[_0x38398c(0xd61)][_0x38398c(0x12c4)]=_0x38398c(0x875);if(activeShoppingCategoryId===_0x38398c(0x875))_0xf2406b['classList'][_0x38398c(0x12b6)]('active');_0x372853[_0x38398c(0x8f2)](_0xf2406b),_0x2aa1db[_0x38398c(0xbdc)](_0x4dc41a=>{const _0x2d452a=_0x38398c,_0x52b381=document['createElement'](_0x2d452a(0x99b));_0x52b381[_0x2d452a(0x4e1)]=_0x2d452a(0x145b),_0x52b381[_0x2d452a(0xde7)]=_0x4dc41a['name'],_0x52b381['dataset'][_0x2d452a(0x12c4)]=_0x4dc41a['id'];if(activeShoppingCategoryId===_0x4dc41a['id'])_0x52b381[_0x2d452a(0xb08)][_0x2d452a(0x12b6)](_0x2d452a(0x5d6));_0x372853['appendChild'](_0x52b381);});let _0x236f3f;activeShoppingCategoryId===_0x38398c(0x875)?_0x236f3f=_0x2ad266:_0x236f3f=_0x2ad266[_0x38398c(0x29d)](_0x3249df=>_0x3249df[_0x38398c(0x12c4)]===activeShoppingCategoryId);if(_0x236f3f[_0x38398c(0x8d6)]===0x0){const _0x435b94=activeShoppingCategoryId===_0x38398c(0x875)?_0x38398c(0x10a4):_0x38398c(0xf1e);_0x19c19f[_0x38398c(0x1575)]=_0x38398c(0xa1a)+_0x435b94+'</p>';return;}_0x236f3f[_0x38398c(0xbdc)](_0x556a59=>{const _0x55b7d0=_0x38398c,_0x2b014e=document[_0x55b7d0(0x2c9)](_0x55b7d0(0xf8e));_0x2b014e[_0x55b7d0(0x4e1)]=_0x55b7d0(0x87e),_0x2b014e[_0x55b7d0(0xd61)]['id']=_0x556a59['id'];const _0x28f252='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x2b014e[_0x55b7d0(0x1575)]=_0x55b7d0(0x73d)+_0x28f252+_0x55b7d0(0x2a0)+_0x556a59[_0x55b7d0(0x1436)]+_0x55b7d0(0x3ce)+_0x556a59[_0x55b7d0(0xf3e)]+_0x55b7d0(0xa3c)+_0x556a59[_0x55b7d0(0x34a)][_0x55b7d0(0x2ea)](0x2)+_0x55b7d0(0x461),_0x19c19f[_0x55b7d0(0x8f2)](_0x2b014e);});}function _0x4589e7(_0x4f04f0){activeShoppingCategoryId=_0x4f04f0,_0x4cf8d9(),_0x2f0dba();}function _0x2f0dba(){const _0x42cd1f=_0x239c7d,_0x13abb3=document[_0x42cd1f(0x400)](_0x42cd1f(0x1088));if(!_0x13abb3)return;const _0x4b6208=_0xa8ab59&&activeShoppingCategoryId!=='all';_0x13abb3[_0x42cd1f(0xa00)]['display']=_0x4b6208?_0x42cd1f(0x375):_0x42cd1f(0x165b);}async function _0x64180c(){const _0x21fc19=_0x239c7d;if(activeShoppingCategoryId===_0x21fc19(0x875))return;const _0x53ffe9=activeShoppingCategoryId,_0x3c5996=await _0x54c587[_0x21fc19(0xd21)][_0x21fc19(0xf48)](_0x53ffe9);if(!_0x3c5996){alert(_0x21fc19(0x719));return;}const _0x21cf25=_0x21fc19(0x549)+_0x3c5996[_0x21fc19(0xf3e)]+_0x21fc19(0x9b7),_0x5bd9ce=await _0x56d4d3(_0x21fc19(0xba2),_0x21cf25,{'confirmButtonClass':'btn-danger','confirmText':_0x21fc19(0x713)});_0x5bd9ce&&(await _0x23bc34(_0x53ffe9),activeShoppingCategoryId=_0x21fc19(0x875),await _0x4cf8d9(),_0x2f0dba(),await _0x138765('成功',_0x21fc19(0x13d3)+_0x3c5996[_0x21fc19(0xf3e)]+_0x21fc19(0xce7)));}async function _0x3b6e0a(){const _0x4008c9=_0x239c7d;activeShoppingCategoryId=_0x4008c9(0x875),await _0x4cf8d9(),_0x257d51(_0x4008c9(0x732)),_0x2f0dba();}async function _0x4cf8d9(){const _0x3e126e=_0x239c7d,_0x2bf9ce=document[_0x3e126e(0x400)](_0x3e126e(0x68d)),_0x3f095a=document[_0x3e126e(0x400)](_0x3e126e(0x217)),_0x373adb=document[_0x3e126e(0x400)](_0x3e126e(0x732));_0x2bf9ce[_0x3e126e(0x1575)]='',_0x3f095a['innerHTML']='';const [_0x4f821f,_0xd2565a]=await Promise[_0x3e126e(0x875)]([_0x54c587['shoppingProducts'][_0x3e126e(0xce1)](),_0x54c587['shoppingCategories'][_0x3e126e(0x541)]('name')['toArray']()]);_0x373adb[_0x3e126e(0xb08)][_0x3e126e(0x146f)](_0x3e126e(0x1245),_0xa8ab59);const _0x3a03ba=document[_0x3e126e(0x2c9)](_0x3e126e(0x99b));_0x3a03ba[_0x3e126e(0x4e1)]='product-category-tab',_0x3a03ba['textContent']='全部',_0x3a03ba[_0x3e126e(0xd61)][_0x3e126e(0x12c4)]=_0x3e126e(0x875);if(activeShoppingCategoryId===_0x3e126e(0x875))_0x3a03ba[_0x3e126e(0xb08)][_0x3e126e(0x12b6)](_0x3e126e(0x5d6));_0x3f095a['appendChild'](_0x3a03ba),_0xd2565a[_0x3e126e(0xbdc)](_0x11624b=>{const _0xb375d3=_0x3e126e,_0x9c14b8=document[_0xb375d3(0x2c9)](_0xb375d3(0x99b));_0x9c14b8[_0xb375d3(0x4e1)]=_0xb375d3(0x145b),_0x9c14b8[_0xb375d3(0xde7)]=_0x11624b['name'],_0x9c14b8[_0xb375d3(0xd61)][_0xb375d3(0x12c4)]=_0x11624b['id'];if(activeShoppingCategoryId===_0x11624b['id'])_0x9c14b8[_0xb375d3(0xb08)]['add']('active');_0x3f095a[_0xb375d3(0x8f2)](_0x9c14b8);});let _0x11cec2;activeShoppingCategoryId===_0x3e126e(0x875)?_0x11cec2=_0x4f821f:_0x11cec2=_0x4f821f[_0x3e126e(0x29d)](_0x383df2=>_0x383df2[_0x3e126e(0x12c4)]===activeShoppingCategoryId);if(_0x11cec2[_0x3e126e(0x8d6)]===0x0){const _0x14b124=activeShoppingCategoryId===_0x3e126e(0x875)?_0x3e126e(0x10a4):_0x3e126e(0xf1e);_0x2bf9ce[_0x3e126e(0x1575)]=_0x3e126e(0xa1a)+_0x14b124+'</p>';return;}_0x11cec2[_0x3e126e(0xbdc)](_0x1cd08e=>{const _0x389d58=_0x3e126e,_0x1461f5=document[_0x389d58(0x2c9)](_0x389d58(0xf8e));_0x1461f5[_0x389d58(0x4e1)]=_0x389d58(0x87e),_0x1461f5[_0x389d58(0xd61)]['id']=_0x1cd08e['id'];const _0x32f5dd=_0xa8ab59?_0x389d58(0x7f0):'';_0x1461f5['innerHTML']=_0x389d58(0xc43)+_0x32f5dd+_0x389d58(0x146e)+_0x1cd08e[_0x389d58(0x1436)]+_0x389d58(0x15ca)+_0x1cd08e[_0x389d58(0xf3e)]+_0x389d58(0x907)+_0x1cd08e[_0x389d58(0x34a)][_0x389d58(0x2ea)](0x2)+_0x389d58(0x155a),_0x2bf9ce[_0x389d58(0x8f2)](_0x1461f5);});}async function _0x1e8c95(_0x511f2f,_0x26ece2=0x1,_0x455eae=null){const _0x3b95e1=_0x239c7d,_0x3a65d2=_0x455eae?_0x5ad299['find'](_0x5c20d0=>_0x5c20d0[_0x3b95e1(0x885)]===_0x511f2f&&_0x5c20d0[_0x3b95e1(0x7ec)]?.[_0x3b95e1(0xf3e)]===_0x455eae['name']):_0x5ad299[_0x3b95e1(0x821)](_0x48ee2d=>_0x48ee2d['productId']===_0x511f2f&&!_0x48ee2d['variation']);if(_0x3a65d2)_0x3a65d2['quantity']+=_0x26ece2;else{const _0x580061=await _0x54c587[_0x3b95e1(0x28c)][_0x3b95e1(0xf48)](_0x511f2f);_0x580061&&_0x5ad299[_0x3b95e1(0x6bb)]({'productId':_0x580061['id'],'quantity':_0x26ece2,'variation':_0x455eae});}_0x56be2e();}function _0x519d9e(_0x250888,_0x25b573){const _0x1e2c53=_0x239c7d,_0x59396f=_0x5ad299[_0x1e2c53(0x11a4)](_0x121ee5=>_0x121ee5[_0x1e2c53(0x885)]===_0x250888);_0x59396f>-0x1&&(_0x5ad299[_0x59396f][_0x1e2c53(0x2b9)]+=_0x25b573,_0x5ad299[_0x59396f][_0x1e2c53(0x2b9)]<=0x0&&_0x5ad299[_0x1e2c53(0xdcc)](_0x59396f,0x1),_0x56be2e(),_0x112a39());}function _0x56be2e(){const _0x1133a8=_0x239c7d,_0x6be37c=_0x5ad299['reduce']((_0x1fa8c0,_0xc26edc)=>_0x1fa8c0+_0xc26edc[_0x1133a8(0x2b9)],0x0);document[_0x1133a8(0x400)](_0x1133a8(0xbc6))[_0x1133a8(0xde7)]=_0x6be37c,document['getElementById'](_0x1133a8(0x4c5))[_0x1133a8(0xde7)]=_0x1133a8(0x766)+_0x6be37c+')',document[_0x1133a8(0x400)]('checkout-btn')['textContent']=_0x1133a8(0x272)+_0x6be37c+')';}function _0x3bc21d(){const _0x15bb5d=_0x239c7d;_0x112a39(),_0x257d51(_0x15bb5d(0x1081));}async function _0x112a39(){const _0x2ee007=_0x239c7d,_0x1f534b=document[_0x2ee007(0x400)](_0x2ee007(0x6e0));_0x1f534b['innerHTML']='';let _0x3fc90f=0x0;if(_0x5ad299[_0x2ee007(0x8d6)]===0x0)_0x1f534b[_0x2ee007(0x1575)]=_0x2ee007(0x4ef);else{const _0x49c28e=_0x5ad299[_0x2ee007(0xd18)](_0x2c2fd4=>_0x2c2fd4['productId']),_0x23b419=await _0x54c587['shoppingProducts'][_0x2ee007(0x227)]('id')[_0x2ee007(0x1666)](_0x49c28e)[_0x2ee007(0xce1)](),_0x3cd1b8=new Map(_0x23b419[_0x2ee007(0xd18)](_0x4ee899=>[_0x4ee899['id'],_0x4ee899]));_0x5ad299[_0x2ee007(0xbdc)](_0x7ca4e4=>{const _0xa915e3=_0x2ee007,_0x884057=_0x3cd1b8['get'](_0x7ca4e4[_0xa915e3(0x885)]);if(_0x884057){const _0x2c0a6f=document['createElement'](_0xa915e3(0xf8e));_0x2c0a6f[_0xa915e3(0x4e1)]=_0xa915e3(0x678);const _0x53a0ec=_0x7ca4e4['variation']?_0xa915e3(0xe2e)+_0x7ca4e4[_0xa915e3(0x7ec)][_0xa915e3(0xf3e)]+'</div>':'';_0x2c0a6f['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22cart-item-checkbox\x22\x20data-id=\x22'+_0x884057['id']+_0xa915e3(0x332)+(_0x7ca4e4['variation']?.[_0xa915e3(0x1436)]||_0x884057[_0xa915e3(0x1436)])+'\x22\x20class=\x22cart-item-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-name\x22>'+_0x884057['name']+_0xa915e3(0x7fe)+_0x53a0ec+_0xa915e3(0xb72)+(_0x7ca4e4[_0xa915e3(0x7ec)]?.[_0xa915e3(0x34a)]||_0x884057[_0xa915e3(0x34a)])['toFixed'](0x2)+_0xa915e3(0x1305)+_0x884057['id']+_0xa915e3(0xea1)+_0x7ca4e4['quantity']+_0xa915e3(0x1136)+_0x884057['id']+_0xa915e3(0xee8),_0x1f534b[_0xa915e3(0x8f2)](_0x2c0a6f);}});}_0x295d28();}async function _0x295d28(){const _0x1a9786=_0x239c7d;let _0x3aa1e4=0x0;const _0x21e057=document['querySelectorAll'](_0x1a9786(0x707)),_0x25365e=Array[_0x1a9786(0xdc0)](_0x21e057)[_0x1a9786(0xd18)](_0x1ed7f4=>parseInt(_0x1ed7f4[_0x1a9786(0xd61)]['id']));if(_0x25365e[_0x1a9786(0x8d6)]>0x0){const _0x250f82=await _0x54c587[_0x1a9786(0x28c)][_0x1a9786(0x227)]('id')[_0x1a9786(0x1666)](_0x25365e)[_0x1a9786(0xce1)](),_0x40b54d=new Map(_0x250f82[_0x1a9786(0xd18)](_0x374cd=>[_0x374cd['id'],_0x374cd]));_0x5ad299['forEach'](_0x35c7dc=>{const _0x3cf68e=_0x1a9786;if(_0x25365e[_0x3cf68e(0xd1b)](_0x35c7dc[_0x3cf68e(0x885)])){const _0x31cb24=_0x40b54d[_0x3cf68e(0xf48)](_0x35c7dc[_0x3cf68e(0x885)]);if(_0x31cb24){const _0x30c1eb=_0x35c7dc[_0x3cf68e(0x7ec)]?_0x35c7dc[_0x3cf68e(0x7ec)][_0x3cf68e(0x34a)]:_0x31cb24['price'];_0x3aa1e4+=_0x30c1eb*_0x35c7dc[_0x3cf68e(0x2b9)];}}});}document[_0x1a9786(0x400)](_0x1a9786(0x1416))['textContent']=_0x1a9786(0xe15)+_0x3aa1e4['toFixed'](0x2);}async function _0xfe2ee9(){const _0x5c5f10=_0x239c7d,_0x3ed28c=_0x4c8b14['chats'][_0x4c8b14[_0x5c5f10(0x1539)]];if(!_0x3ed28c||!_0x3ed28c['isGroup'])return;const _0x5706c9=document[_0x5c5f10(0x400)](_0x5c5f10(0xd7f)),_0x3ea330=document[_0x5c5f10(0x400)](_0x5c5f10(0x4b7));_0x3ea330[_0x5c5f10(0x1575)]='';const _0x241e43=_0x3ed28c[_0x5c5f10(0xa37)]['myNickname']||'我',_0xa52075=_0x3ed28c['members'][_0x5c5f10(0x29d)](_0x53024b=>_0x53024b[_0x5c5f10(0x7ca)]!==_0x241e43);_0xa52075[_0x5c5f10(0xbdc)](_0x3eb829=>{const _0x194e2b=_0x5c5f10,_0x50cd46=document[_0x194e2b(0x2c9)](_0x194e2b(0xf8e));_0x50cd46['className']='contact-picker-item',_0x50cd46[_0x194e2b(0xd61)][_0x194e2b(0xa02)]=_0x3eb829[_0x194e2b(0xdcf)],_0x50cd46[_0x194e2b(0x1575)]=_0x194e2b(0x3ec)+(_0x3eb829[_0x194e2b(0xa9a)]||_0x1e2f0a)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x3eb829[_0x194e2b(0x7ca)]+_0x194e2b(0x313),_0x3ea330[_0x194e2b(0x8f2)](_0x50cd46);}),document[_0x5c5f10(0x400)](_0x5c5f10(0x519))[_0x5c5f10(0x6f9)]=![],_0x5706c9[_0x5c5f10(0xb08)][_0x5c5f10(0x12b6)]('visible');}async function _0x56c483(){const _0x3f58c7=_0x239c7d,_0x1ed95f=_0x4c8b14[_0x3f58c7(0xbea)][_0x4c8b14[_0x3f58c7(0x1539)]],_0x1af491=_0x5ad299[_0x3f58c7(0x29d)](_0x4dc663=>document[_0x3f58c7(0x13ef)](_0x3f58c7(0xc39)+_0x4dc663[_0x3f58c7(0x885)]+_0x3f58c7(0x106e)));if(_0x1af491[_0x3f58c7(0x8d6)]===0x0){alert(_0x3f58c7(0x1039));return;}if(_0x1ed95f[_0x3f58c7(0xc98)])_0xfe2ee9();else{const _0x1386ad=await _0x56d4d3(_0x3f58c7(0x8f6),_0x3f58c7(0x7cf),{'confirmText':_0x3f58c7(0xfe0)});_0x1386ad&&await _0x44caa4(_0x1af491);}}async function _0x44caa4(_0x3afde7,_0x4c68cc=null){const _0x31e79b=_0x239c7d;if(!_0x4c8b14[_0x31e79b(0x1539)])return;const _0x3de8ba=_0x4c8b14['chats'][_0x4c8b14[_0x31e79b(0x1539)]],_0x2eb223=_0x3afde7[_0x31e79b(0xd18)](_0x36bf65=>_0x36bf65[_0x31e79b(0x885)]),_0x52a9f1=await _0x54c587['shoppingProducts'][_0x31e79b(0x227)]('id')[_0x31e79b(0x1666)](_0x2eb223)['toArray'](),_0x354fbc=new Map(_0x52a9f1[_0x31e79b(0xd18)](_0x63cc0c=>[_0x63cc0c['id'],_0x63cc0c])),_0x29414d=_0x3afde7[_0x31e79b(0xd18)](_0x5164c6=>{const _0x3084f8=_0x31e79b,_0x564f6c=_0x354fbc['get'](_0x5164c6['productId']);return _0x5164c6[_0x3084f8(0x7ec)]?{'name':_0x564f6c[_0x3084f8(0xf3e)]+_0x3084f8(0x1477)+_0x5164c6[_0x3084f8(0x7ec)]['name'],'price':_0x5164c6['variation'][_0x3084f8(0x34a)],'imageUrl':_0x5164c6[_0x3084f8(0x7ec)][_0x3084f8(0x1436)]||_0x564f6c[_0x3084f8(0x1436)],'quantity':_0x5164c6[_0x3084f8(0x2b9)]}:{'name':_0x564f6c[_0x3084f8(0xf3e)],'price':_0x564f6c[_0x3084f8(0x34a)],'imageUrl':_0x564f6c[_0x3084f8(0x1436)],'quantity':_0x5164c6[_0x3084f8(0x2b9)]};}),_0x226be4={'role':_0x31e79b(0x6d6),'type':'gift','timestamp':Date[_0x31e79b(0xecd)](),'items':_0x29414d,'total':_0x29414d['reduce']((_0x559542,_0xad527d)=>_0x559542+_0xad527d[_0x31e79b(0x34a)]*_0xad527d[_0x31e79b(0x2b9)],0x0),'recipients':_0x4c68cc};_0x3de8ba[_0x31e79b(0x92c)][_0x31e79b(0x6bb)](_0x226be4);if(_0x4c68cc&&_0x4c68cc[_0x31e79b(0x8d6)]>0x0){const _0x23af9d=_0x4c68cc['map'](_0x11ad4f=>_0x288d80(_0x3de8ba,_0x11ad4f))['join']('、'),_0x1b7cc7={'role':_0x31e79b(0xaf6),'content':_0x31e79b(0x28e)+(_0x3de8ba[_0x31e79b(0xa37)][_0x31e79b(0x14a8)]||'我')+_0x31e79b(0x905)+_0x23af9d+_0x31e79b(0x569),'timestamp':Date['now']()+0x1,'isHidden':!![]};_0x3de8ba[_0x31e79b(0x92c)][_0x31e79b(0x6bb)](_0x1b7cc7);}await _0x54c587[_0x31e79b(0xbea)][_0x31e79b(0x4cb)](_0x3de8ba),_0x41ecc7(_0x226be4,_0x3de8ba),_0x41b828(),_0x5ad299=_0x5ad299[_0x31e79b(0x29d)](_0x449d3c=>!_0x3afde7[_0x31e79b(0x1412)](_0x4a00a8=>_0x4a00a8[_0x31e79b(0x885)]===_0x449d3c[_0x31e79b(0x885)])),_0x56be2e(),_0x257d51(_0x31e79b(0x946)),await _0x138765('成功',_0x31e79b(0x1432));}function _0x2baa87(_0x1b3ccf){const _0x9e27f3=_0x239c7d,_0x54fad4=_0x4c8b14[_0x9e27f3(0xbea)][_0x4c8b14['activeChatId']],_0x310d71=_0x54fad4[_0x9e27f3(0x92c)][_0x9e27f3(0x821)](_0x1f361f=>_0x1f361f[_0x9e27f3(0x287)]===_0x1b3ccf);if(!_0x310d71||_0x310d71['type']!==_0x9e27f3(0x15b6))return;const _0x3d8603=document[_0x9e27f3(0x400)]('gift-receipt-body');let _0x419839='';_0x310d71[_0x9e27f3(0x15c9)][_0x9e27f3(0xbdc)](_0x2446d6=>{const _0x53870c=_0x9e27f3;_0x419839+=_0x53870c(0xf98)+_0x2446d6[_0x53870c(0xf3e)]+_0x53870c(0x1580)+_0x2446d6['quantity']+'</td><td\x20class=\x22item-price\x22>¥'+_0x2446d6['price']['toFixed'](0x2)+_0x53870c(0x143e)+(_0x2446d6[_0x53870c(0x34a)]*_0x2446d6[_0x53870c(0x2b9)])[_0x53870c(0x2ea)](0x2)+_0x53870c(0x15f6);}),_0x3d8603['innerHTML']=_0x9e27f3(0x386)+new Date(_0x310d71[_0x9e27f3(0x287)])[_0x9e27f3(0xad4)]()+'</p></div><table\x20class=\x22receipt-items-table\x22><thead><tr><th\x20class=\x22item-name\x22>商品</th><th\x20class=\x22item-qty\x22>数量</th><th\x20class=\x22item-price\x22>单价</th><th\x20class=\x22item-subtotal\x22>小计</th></tr></thead><tbody>'+_0x419839+_0x9e27f3(0xb83)+_0x310d71['total'][_0x9e27f3(0x2ea)](0x2)+_0x9e27f3(0x44a),document[_0x9e27f3(0x400)](_0x9e27f3(0x51c))['classList'][_0x9e27f3(0x12b6)](_0x9e27f3(0x9eb));}async function _0x21e974(_0x51b2f9=null){const _0x4588f6=_0x239c7d;_0x4ecd3b=_0x51b2f9;const _0x6f0788=document['getElementById']('product-editor-modal'),_0x56d853=document['getElementById']('product-editor-title'),_0x149861=document[_0x4588f6(0x400)](_0x4588f6(0x438)),_0x4cbaf3=document[_0x4588f6(0x400)](_0x4588f6(0x150c)),_0x51e24b=document[_0x4588f6(0x400)](_0x4588f6(0xc91)),_0x2151c9=document[_0x4588f6(0x400)](_0x4588f6(0xcd8)),_0x4c3a80=document[_0x4588f6(0x400)](_0x4588f6(0xb8a)),_0x3c7863=document[_0x4588f6(0x400)](_0x4588f6(0xe7a));_0x3c7863[_0x4588f6(0x1575)]='',_0x4c3a80[_0x4588f6(0x1575)]=_0x4588f6(0x620);const _0x4ce96d=await _0x54c587[_0x4588f6(0xd21)]['toArray']();_0x4ce96d['forEach'](_0xa4cdd=>{const _0x1f1700=_0x4588f6,_0x28acd5=document[_0x1f1700(0x2c9)]('option');_0x28acd5['value']=_0xa4cdd['id'],_0x28acd5[_0x1f1700(0xde7)]=_0xa4cdd[_0x1f1700(0xf3e)],_0x4c3a80[_0x1f1700(0x8f2)](_0x28acd5);});if(_0x51b2f9){_0x56d853[_0x4588f6(0xde7)]=_0x4588f6(0x2f1);const _0x250528=await _0x54c587['shoppingProducts'][_0x4588f6(0xf48)](_0x51b2f9);_0x149861[_0x4588f6(0xa1e)]=_0x250528['name'],_0x4cbaf3[_0x4588f6(0xa1e)]=_0x250528[_0x4588f6(0x34a)],_0x51e24b['value']=_0x250528[_0x4588f6(0x12a5)]||'',_0x2151c9['src']=_0x250528[_0x4588f6(0x1436)],_0x4c3a80[_0x4588f6(0xa1e)]=_0x250528[_0x4588f6(0x12c4)]||'',_0x250528['variations']&&_0x250528[_0x4588f6(0x1566)][_0x4588f6(0x8d6)]>0x0&&_0x250528['variations'][_0x4588f6(0xbdc)](_0x39ae17=>_0x1ae5b9(_0x39ae17));}else _0x56d853[_0x4588f6(0xde7)]=_0x4588f6(0xcfb),_0x149861[_0x4588f6(0xa1e)]='',_0x4cbaf3[_0x4588f6(0xa1e)]='',_0x51e24b['value']='',_0x2151c9[_0x4588f6(0x912)]='https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756206115802_qdqqd_0c99bh.jpeg',_0x4c3a80[_0x4588f6(0xa1e)]='';_0x6f0788[_0x4588f6(0xb08)][_0x4588f6(0x12b6)](_0x4588f6(0x9eb));}async function _0x881182(){const _0x53515d=_0x239c7d,_0xd21be1=document[_0x53515d(0x400)]('product-name-input')[_0x53515d(0xa1e)][_0x53515d(0xb8f)](),_0x38df3d=parseFloat(document['getElementById'](_0x53515d(0x150c))['value']),_0x4a3b4e=document[_0x53515d(0x400)](_0x53515d(0xc91))[_0x53515d(0xa1e)][_0x53515d(0xb8f)](),_0x589b5c=document['getElementById'](_0x53515d(0xcd8))[_0x53515d(0x912)],_0x238020=parseInt(document[_0x53515d(0x400)]('product-category-select')[_0x53515d(0xa1e)])||null;if(!_0xd21be1){alert(_0x53515d(0x94a));return;}if(isNaN(_0x38df3d)||_0x38df3d<0x0){alert(_0x53515d(0x14cd));return;}const _0x2931f8=[];document[_0x53515d(0x527)]('.variation-block')[_0x53515d(0xbdc)](_0x1e6168=>{const _0x17423a=_0x53515d,_0xfaa3c7=_0x1e6168['querySelector'](_0x17423a(0x1553))['value'][_0x17423a(0xb8f)](),_0x5f81f2=parseFloat(_0x1e6168[_0x17423a(0x13ef)](_0x17423a(0x12c6))[_0x17423a(0xa1e)]),_0x22122f=_0x1e6168[_0x17423a(0x13ef)]('.variation-image-preview')[_0x17423a(0x912)];_0xfaa3c7&&!isNaN(_0x5f81f2)&&_0x5f81f2>=0x0&&_0x2931f8[_0x17423a(0x6bb)]({'name':_0xfaa3c7,'price':_0x5f81f2,'imageUrl':_0x22122f[_0x17423a(0xd1b)]('placeholder.png')?null:_0x22122f});});const _0x2fc482={'name':_0xd21be1,'price':_0x38df3d,'description':_0x4a3b4e,'imageUrl':_0x589b5c,'categoryId':_0x238020,'variations':_0x2931f8};_0x4ecd3b?await _0x54c587['shoppingProducts'][_0x53515d(0x126d)](_0x4ecd3b,_0x2fc482):await _0x54c587[_0x53515d(0x28c)][_0x53515d(0x12b6)](_0x2fc482),document[_0x53515d(0x400)]('product-editor-modal')['classList'][_0x53515d(0xc46)](_0x53515d(0x9eb)),await _0x4cf8d9();}async function _0x151082(){const _0x384a87=_0x239c7d;await _0x35fe04(),_0x257d51(_0x384a87(0xab9));}async function _0x35fe04(){const _0x3b70f0=_0x239c7d,_0x1a67fe=document[_0x3b70f0(0x400)](_0x3b70f0(0xf12)),_0x12f5a3=document['getElementById']('rules-content-container');_0x1a67fe['innerHTML']='',_0x12f5a3[_0x3b70f0(0x1575)]='';const _0x5c7073=await _0x54c587['renderingRules'][_0x3b70f0(0xce1)]();if(_0x5c7073['length']===0x0){_0x12f5a3[_0x3b70f0(0x1575)]=_0x3b70f0(0x158e);return;}const _0x251aa1=document[_0x3b70f0(0x2c9)]('button');_0x251aa1[_0x3b70f0(0x4e1)]=_0x3b70f0(0x518),_0x251aa1[_0x3b70f0(0xde7)]=_0x3b70f0(0x69b),_0x251aa1[_0x3b70f0(0xd61)]['categoryId']=_0x3b70f0(0x1051),_0x1a67fe[_0x3b70f0(0x8f2)](_0x251aa1);const _0x44b89c=document[_0x3b70f0(0x2c9)](_0x3b70f0(0xf8e));_0x44b89c[_0x3b70f0(0x4e1)]=_0x3b70f0(0x269),_0x44b89c['dataset']['categoryId']=_0x3b70f0(0x1051),_0x12f5a3[_0x3b70f0(0x8f2)](_0x44b89c);const _0x3fd420=Object[_0x3b70f0(0x40a)](_0x4c8b14[_0x3b70f0(0xbea)])[_0x3b70f0(0x29d)](_0x2771d4=>!_0x2771d4[_0x3b70f0(0xc98)]&&_0x5c7073[_0x3b70f0(0x1412)](_0x413437=>_0x413437[_0x3b70f0(0x4dd)]===_0x2771d4['id']));_0x3fd420['forEach'](_0xcfbed2=>{const _0x384a8a=_0x3b70f0,_0x431811=document[_0x384a8a(0x2c9)](_0x384a8a(0x99b));_0x431811[_0x384a8a(0x4e1)]=_0x384a8a(0x1159),_0x431811[_0x384a8a(0xde7)]=_0xcfbed2[_0x384a8a(0xf3e)],_0x431811['dataset']['categoryId']=_0xcfbed2['id'],_0x1a67fe[_0x384a8a(0x8f2)](_0x431811);const _0x40de6d=document[_0x384a8a(0x2c9)](_0x384a8a(0xf8e));_0x40de6d[_0x384a8a(0x4e1)]=_0x384a8a(0xa72),_0x40de6d['dataset'][_0x384a8a(0x12c4)]=_0xcfbed2['id'],_0x12f5a3['appendChild'](_0x40de6d);}),_0x5c7073[_0x3b70f0(0xbdc)](_0x502144=>{const _0x3b53b6=_0x3b70f0,_0x215eb9=_0x220209(_0x502144),_0x35beed=_0x12f5a3[_0x3b53b6(0x13ef)]('.rules-category-pane[data-category-id=\x22'+_0x502144[_0x3b53b6(0x4dd)]+'\x22]');_0x35beed&&_0x35beed[_0x3b53b6(0x8f2)](_0x215eb9);}),document['querySelectorAll'](_0x3b70f0(0x10c8))['forEach'](_0x526a95=>{const _0x1b920b=_0x3b70f0;_0x526a95[_0x1b920b(0x501)](_0x1b920b(0x15ad),()=>_0x7b9737(_0x526a95[_0x1b920b(0xd61)]['categoryId']));});}function _0x220209(_0x32aa4a){const _0x25988b=_0x239c7d,_0xeae9b0=document[_0x25988b(0x2c9)](_0x25988b(0xf8e));return _0xeae9b0[_0x25988b(0x4e1)]=_0x25988b(0x1367)+(_0x32aa4a[_0x25988b(0x13f5)]?_0x25988b(0x250):''),_0xeae9b0[_0x25988b(0xd61)][_0x25988b(0xa2d)]=_0x32aa4a['id'],_0xeae9b0['innerHTML']=_0x25988b(0x6b4)+_0x32aa4a[_0x25988b(0xf3e)]+_0x25988b(0x6cf)+_0x32aa4a['regex']+_0x25988b(0x86a),_0xeae9b0[_0x25988b(0x501)]('click',()=>_0x41ceaa(_0x32aa4a['id'])),_0x3d4218(_0xeae9b0,()=>_0x1fa11e(_0x32aa4a['id'])),_0xeae9b0;}async function _0x41ceaa(_0xb307a1=null){const _0xb9c9c1=_0x239c7d;_0x2cf548=_0xb307a1;const _0x296b12=document[_0xb9c9c1(0x400)](_0xb9c9c1(0x1522)),_0xc0a770=document[_0xb9c9c1(0x400)]('rule-editor-title'),_0x10da2e=document['getElementById']('rule-name-input'),_0x1ce759=document['getElementById'](_0xb9c9c1(0xa2f)),_0x55256d=document[_0xb9c9c1(0x400)](_0xb9c9c1(0x6f8)),_0x35319a=document[_0xb9c9c1(0x400)]('rule-template-input'),_0x2286b6=document[_0xb9c9c1(0x400)](_0xb9c9c1(0x1526)),_0x1282db=document['getElementById']('rule-do-not-send-switch');_0x1ce759['innerHTML']=_0xb9c9c1(0xb01),Object[_0xb9c9c1(0x40a)](_0x4c8b14[_0xb9c9c1(0xbea)])[_0xb9c9c1(0x29d)](_0x2ae6cf=>!_0x2ae6cf[_0xb9c9c1(0xc98)])[_0xb9c9c1(0xbdc)](_0x343fc9=>{const _0xb331c7=_0xb9c9c1;_0x1ce759[_0xb331c7(0x1575)]+='<option\x20value=\x22'+_0x343fc9['id']+'\x22>'+_0x343fc9['name']+'</option>';});if(_0xb307a1){_0xc0a770[_0xb9c9c1(0xde7)]=_0xb9c9c1(0x14d7);const _0xa6d1f1=await _0x54c587['renderingRules'][_0xb9c9c1(0xf48)](_0xb307a1);_0x10da2e['value']=_0xa6d1f1['name'],_0x1ce759[_0xb9c9c1(0xa1e)]=_0xa6d1f1[_0xb9c9c1(0x4dd)],_0x55256d[_0xb9c9c1(0xa1e)]=_0xa6d1f1[_0xb9c9c1(0x9bb)],_0x35319a[_0xb9c9c1(0xa1e)]=_0xa6d1f1[_0xb9c9c1(0x74d)],_0x2286b6[_0xb9c9c1(0x6f9)]=_0xa6d1f1[_0xb9c9c1(0x13f5)],_0x1282db[_0xb9c9c1(0x6f9)]=_0xa6d1f1[_0xb9c9c1(0x2fa)]||![];}else _0xc0a770[_0xb9c9c1(0xde7)]=_0xb9c9c1(0x927),_0x10da2e[_0xb9c9c1(0xa1e)]='',_0x1ce759[_0xb9c9c1(0xa1e)]=_0xb9c9c1(0x1051),_0x55256d[_0xb9c9c1(0xa1e)]='',_0x35319a['value']='',_0x2286b6['checked']=!![],_0x1282db[_0xb9c9c1(0x6f9)]=![];_0x296b12[_0xb9c9c1(0xb08)][_0xb9c9c1(0x12b6)]('visible');}async function _0x562539(){const _0x3d7f76=_0x239c7d,_0x4cba80=document['getElementById']('rule-name-input')[_0x3d7f76(0xa1e)][_0x3d7f76(0xb8f)](),_0x3bc280=document[_0x3d7f76(0x400)](_0x3d7f76(0x6f8))[_0x3d7f76(0xa1e)]['trim']();if(!_0x4cba80||!_0x3bc280){alert('规则名称和正则表达式不能为空！');return;}try{new RegExp(_0x3bc280);}catch(_0x1c35d5){alert('正则表达式格式错误:\x20'+_0x1c35d5[_0x3d7f76(0x6e2)]);return;}const _0x4ca9b7={'name':_0x4cba80,'chatId':document['getElementById'](_0x3d7f76(0xa2f))['value'],'regex':_0x3bc280,'template':document[_0x3d7f76(0x400)](_0x3d7f76(0xf97))['value'],'isEnabled':document['getElementById'](_0x3d7f76(0x1526))[_0x3d7f76(0x6f9)],'doNotSend':document[_0x3d7f76(0x400)](_0x3d7f76(0x12dd))['checked']};_0x2cf548?await _0x54c587[_0x3d7f76(0x148f)][_0x3d7f76(0x126d)](_0x2cf548,_0x4ca9b7):await _0x54c587[_0x3d7f76(0x148f)][_0x3d7f76(0x12b6)](_0x4ca9b7),document['getElementById']('rule-editor-modal')[_0x3d7f76(0xb08)][_0x3d7f76(0xc46)](_0x3d7f76(0x9eb)),await _0x35fe04();}async function _0x1fa11e(_0x22fc67){const _0x3092ba=_0x239c7d,_0x4e9eff=await _0x56d4d3('删除规则',_0x3092ba(0x938),{'confirmButtonClass':_0x3092ba(0x142c)});_0x4e9eff&&(await _0x54c587['renderingRules'][_0x3092ba(0x942)](_0x22fc67),await _0x35fe04());}async function _0x25d95c(_0x134feb,_0x1ae032){const _0x4222e2=_0x239c7d;if(_0x134feb[_0x4222e2(0xb8f)]()[_0x4222e2(0xbb9)]('<')||!_0x134feb[_0x4222e2(0xd1b)]('[')&&!_0x134feb[_0x4222e2(0xd1b)]('{'))return _0x134feb;const _0xcc1ab6=await _0x54c587[_0x4222e2(0x148f)]['where'](_0x4222e2(0x4dd))[_0x4222e2(0x4ce)]('global')['or'](_0x4222e2(0x4dd))[_0x4222e2(0x4ce)](_0x1ae032)[_0x4222e2(0xce1)]();let _0x3898c9=_0x134feb;for(const _0x2030e6 of _0xcc1ab6['filter'](_0x577140=>_0x577140[_0x4222e2(0x13f5)])){try{let _0x5e4261;const _0x4bf314=_0x2030e6[_0x4222e2(0x9bb)]||_0x2030e6[_0x4222e2(0x9d3)],_0x58fa11=_0x2030e6[_0x4222e2(0x74d)]??_0x2030e6[_0x4222e2(0xfb2)];if(!_0x4bf314||_0x58fa11===undefined){console[_0x4222e2(0x75e)](_0x4222e2(0x525)+_0x2030e6[_0x4222e2(0xf3e)]+_0x4222e2(0x893));continue;}if(_0x4bf314[_0x4222e2(0xbb9)]('/')&&_0x4bf314[_0x4222e2(0x14d9)]('/')>0x0){const _0x4cff23=_0x4bf314[_0x4222e2(0x14d9)]('/'),_0x319d3b=_0x4bf314[_0x4222e2(0x371)](0x1,_0x4cff23),_0x9a4371=_0x4bf314['substring'](_0x4cff23+0x1);_0x5e4261=new RegExp(_0x319d3b,_0x9a4371);}else _0x5e4261=new RegExp(_0x4bf314,'g');_0x5e4261[_0x4222e2(0x2c0)](_0x3898c9)&&(_0x3898c9=_0x3898c9[_0x4222e2(0xe19)](_0x5e4261,_0x58fa11));}catch(_0x36efa9){console['error']('渲染规则\x20['+_0x2030e6['name']+_0x4222e2(0x979),_0x36efa9);}}return _0x3898c9;}async function _0x151082(){const _0x231455=_0x239c7d;await _0x35fe04(),_0x257d51(_0x231455(0xab9));}async function _0x35fe04(){const _0x2a155a=_0x239c7d,_0x566d5f=document['getElementById']('rules-tabs'),_0x426096=document[_0x2a155a(0x400)](_0x2a155a(0x124f));_0x566d5f[_0x2a155a(0x1575)]='',_0x426096['innerHTML']='';const _0x2177fe=await _0x54c587[_0x2a155a(0x148f)][_0x2a155a(0xce1)]();if(_0x2177fe[_0x2a155a(0x8d6)]===0x0){_0x426096[_0x2a155a(0x1575)]=_0x2a155a(0x158e);return;}const _0x1f3fc5=document[_0x2a155a(0x2c9)](_0x2a155a(0x99b));_0x1f3fc5[_0x2a155a(0x4e1)]=_0x2a155a(0x518),_0x1f3fc5[_0x2a155a(0xde7)]=_0x2a155a(0x69b),_0x1f3fc5['dataset'][_0x2a155a(0x12c4)]=_0x2a155a(0x1051),_0x566d5f[_0x2a155a(0x8f2)](_0x1f3fc5);const _0x1249af=document[_0x2a155a(0x2c9)](_0x2a155a(0xf8e));_0x1249af[_0x2a155a(0x4e1)]=_0x2a155a(0x269),_0x1249af[_0x2a155a(0xd61)][_0x2a155a(0x12c4)]='global',_0x426096[_0x2a155a(0x8f2)](_0x1249af);const _0x5b8bd3=Object[_0x2a155a(0x40a)](_0x4c8b14[_0x2a155a(0xbea)])[_0x2a155a(0x29d)](_0x4794c0=>!_0x4794c0[_0x2a155a(0xc98)]&&_0x2177fe[_0x2a155a(0x1412)](_0xe6881e=>_0xe6881e[_0x2a155a(0x4dd)]===_0x4794c0['id']));_0x5b8bd3[_0x2a155a(0xbdc)](_0x4b05e0=>{const _0x238c4f=_0x2a155a,_0x18fe80=document['createElement'](_0x238c4f(0x99b));_0x18fe80['className']='rules-tab',_0x18fe80[_0x238c4f(0xde7)]=_0x4b05e0[_0x238c4f(0xf3e)],_0x18fe80[_0x238c4f(0xd61)][_0x238c4f(0x12c4)]=_0x4b05e0['id'],_0x566d5f[_0x238c4f(0x8f2)](_0x18fe80);const _0x257ee7=document[_0x238c4f(0x2c9)](_0x238c4f(0xf8e));_0x257ee7[_0x238c4f(0x4e1)]=_0x238c4f(0xa72),_0x257ee7[_0x238c4f(0xd61)]['categoryId']=_0x4b05e0['id'],_0x426096[_0x238c4f(0x8f2)](_0x257ee7);}),_0x2177fe[_0x2a155a(0xbdc)](_0xde55aa=>{const _0x4c2848=_0x2a155a,_0x58ded3=_0x220209(_0xde55aa),_0x5bce36=_0x426096[_0x4c2848(0x13ef)](_0x4c2848(0x1419)+_0xde55aa[_0x4c2848(0x4dd)]+'\x22]');_0x5bce36&&_0x5bce36[_0x4c2848(0x8f2)](_0x58ded3);}),document['querySelectorAll'](_0x2a155a(0x10c8))[_0x2a155a(0xbdc)](_0x3519ed=>{const _0x51b63b=_0x2a155a;_0x3519ed[_0x51b63b(0x501)](_0x51b63b(0x15ad),()=>_0x7b9737(_0x3519ed[_0x51b63b(0xd61)][_0x51b63b(0x12c4)]));});}function _0x220209(_0x585b78){const _0x3a703d=_0x239c7d,_0x3791c0=document[_0x3a703d(0x2c9)](_0x3a703d(0xf8e));return _0x3791c0['className']=_0x3a703d(0x1367)+(_0x585b78[_0x3a703d(0x13f5)]?_0x3a703d(0x250):''),_0x3791c0[_0x3a703d(0xd61)][_0x3a703d(0xa2d)]=_0x585b78['id'],_0x3791c0[_0x3a703d(0x1575)]=_0x3a703d(0x6b4)+_0x585b78['name']+_0x3a703d(0x6cf)+_0x585b78[_0x3a703d(0x9bb)]+_0x3a703d(0x86a),_0x3791c0[_0x3a703d(0x501)](_0x3a703d(0x15ad),()=>_0x41ceaa(_0x585b78['id'])),_0x3d4218(_0x3791c0,()=>_0x1fa11e(_0x585b78['id'])),_0x3791c0;}async function _0x41ceaa(_0x4bc538=null){const _0x49c7de=_0x239c7d;_0x2cf548=_0x4bc538;const _0x53b789=document[_0x49c7de(0x400)](_0x49c7de(0x1522)),_0x4af45f=document[_0x49c7de(0x400)](_0x49c7de(0x1115)),_0xe01f35=document['getElementById']('rule-name-input'),_0x309d58=document[_0x49c7de(0x400)](_0x49c7de(0xa2f)),_0x578d93=document[_0x49c7de(0x400)](_0x49c7de(0x6f8)),_0x21828a=document[_0x49c7de(0x400)](_0x49c7de(0xf97)),_0x88e308=document[_0x49c7de(0x400)]('rule-enabled-switch'),_0x4de221=document[_0x49c7de(0x400)](_0x49c7de(0x12dd));_0x309d58[_0x49c7de(0x1575)]=_0x49c7de(0xb01),Object['values'](_0x4c8b14[_0x49c7de(0xbea)])[_0x49c7de(0x29d)](_0x16a30c=>!_0x16a30c[_0x49c7de(0xc98)])[_0x49c7de(0xbdc)](_0x4418d8=>{const _0x152262=_0x49c7de;_0x309d58['innerHTML']+=_0x152262(0x1656)+_0x4418d8['id']+'\x22>'+_0x4418d8['name']+_0x152262(0x1054);});if(_0x4bc538){_0x4af45f[_0x49c7de(0xde7)]=_0x49c7de(0x14d7);const _0x2b9aff=await _0x54c587[_0x49c7de(0x148f)][_0x49c7de(0xf48)](_0x4bc538);_0xe01f35[_0x49c7de(0xa1e)]=_0x2b9aff[_0x49c7de(0xf3e)],_0x309d58['value']=_0x2b9aff[_0x49c7de(0x4dd)],_0x578d93[_0x49c7de(0xa1e)]=_0x2b9aff[_0x49c7de(0x9bb)],_0x21828a[_0x49c7de(0xa1e)]=_0x2b9aff[_0x49c7de(0x74d)],_0x88e308[_0x49c7de(0x6f9)]=_0x2b9aff[_0x49c7de(0x13f5)],_0x4de221[_0x49c7de(0x6f9)]=_0x2b9aff[_0x49c7de(0x2fa)]||![];}else _0x4af45f[_0x49c7de(0xde7)]=_0x49c7de(0x927),_0xe01f35['value']='',_0x309d58[_0x49c7de(0xa1e)]=_0x49c7de(0x1051),_0x578d93[_0x49c7de(0xa1e)]='',_0x21828a['value']='',_0x88e308[_0x49c7de(0x6f9)]=!![],_0x4de221[_0x49c7de(0x6f9)]=![];_0x53b789[_0x49c7de(0xb08)]['add'](_0x49c7de(0x9eb));}async function _0x562539(){const _0x4109bd=_0x239c7d,_0x3c42b3=document[_0x4109bd(0x400)](_0x4109bd(0x11d8))['value']['trim'](),_0x105799=document[_0x4109bd(0x400)]('rule-regex-input')[_0x4109bd(0xa1e)]['trim']();if(!_0x3c42b3||!_0x105799){alert('规则名称和正则表达式不能为空！');return;}try{new RegExp(_0x105799);}catch(_0x50f125){alert('正则表达式格式错误:\x20'+_0x50f125['message']);return;}const _0x2397a3={'name':_0x3c42b3,'chatId':document['getElementById'](_0x4109bd(0xa2f))['value'],'regex':_0x105799,'template':document[_0x4109bd(0x400)](_0x4109bd(0xf97))[_0x4109bd(0xa1e)],'isEnabled':document[_0x4109bd(0x400)]('rule-enabled-switch')[_0x4109bd(0x6f9)],'doNotSend':document[_0x4109bd(0x400)]('rule-do-not-send-switch')['checked']};_0x2cf548?await _0x54c587['renderingRules'][_0x4109bd(0x126d)](_0x2cf548,_0x2397a3):await _0x54c587[_0x4109bd(0x148f)][_0x4109bd(0x12b6)](_0x2397a3),document[_0x4109bd(0x400)](_0x4109bd(0x1522))['classList'][_0x4109bd(0xc46)]('visible'),await _0x35fe04();}async function _0x1fa11e(_0x42433e){const _0x2ce0fe=_0x239c7d,_0x3439b6=await _0x56d4d3(_0x2ce0fe(0xcbd),'确定要删除这条渲染规则吗？',{'confirmButtonClass':_0x2ce0fe(0x142c)});_0x3439b6&&(await _0x54c587['renderingRules'][_0x2ce0fe(0x942)](_0x42433e),await _0x35fe04());}async function _0x25ac7a(_0x45ee09,_0x42acec){const _0x1cd0fd=_0x239c7d,_0x5eea4c=await _0x54c587['renderingRules'][_0x1cd0fd(0x227)](_0x1cd0fd(0x4dd))[_0x1cd0fd(0x1666)](_0x1cd0fd(0x1051),_0x42acec)[_0x1cd0fd(0x29d)](_0x19809a=>_0x19809a[_0x1cd0fd(0x2fa)])[_0x1cd0fd(0xce1)]();if(_0x5eea4c[_0x1cd0fd(0x8d6)]===0x0)return _0x45ee09;const _0x2e7c66=_0x45ee09[_0x1cd0fd(0xd18)](_0x27b18e=>{const _0xe1f362=_0x1cd0fd;if(typeof _0x27b18e[_0xe1f362(0x1109)]!==_0xe1f362(0x158f)||!_0x27b18e[_0xe1f362(0x1109)])return _0x27b18e;const _0x52e098={..._0x27b18e};let _0x11ba0e=_0x27b18e[_0xe1f362(0x1109)];for(const _0x2f9241 of _0x5eea4c){try{let _0x3135ab;const _0x2befbe=_0x2f9241[_0xe1f362(0x9bb)]||_0x2f9241[_0xe1f362(0x9d3)];if(!_0x2befbe){console['warn']('规则\x20\x22'+_0x2f9241[_0xe1f362(0xf3e)]+_0xe1f362(0x1089));continue;}if(_0x2befbe[_0xe1f362(0xbb9)]('/')&&_0x2befbe[_0xe1f362(0x14d9)]('/')>0x0){const _0x57aa59=_0x2befbe[_0xe1f362(0x14d9)]('/'),_0x59f68a=_0x2befbe[_0xe1f362(0x371)](0x1,_0x57aa59),_0x2da40c=_0x2befbe[_0xe1f362(0x371)](_0x57aa59+0x1);_0x3135ab=new RegExp(_0x59f68a,_0x2da40c);}else _0x3135ab=new RegExp(_0x2befbe,'g');_0x3135ab[_0xe1f362(0x2c0)](_0x11ba0e)&&(_0x11ba0e=_0x11ba0e[_0xe1f362(0xe19)](_0x3135ab,''),console['log'](_0xe1f362(0x42b)+_0x2f9241['name']+_0xe1f362(0x901)));}catch(_0xd552ae){console[_0xe1f362(0x5d7)](_0xe1f362(0x54b)+_0x2f9241[_0xe1f362(0xf3e)]+'\x22\x20的正则表达式无效:',_0xd552ae);}}return _0x52e098[_0xe1f362(0x1109)]=_0x11ba0e,_0x52e098;});return _0x2e7c66;}async function _0x25d95c(_0x320677,_0x2da0f9){const _0x3e9575=_0x239c7d;if(_0x320677[_0x3e9575(0xb8f)]()[_0x3e9575(0xbb9)]('<')||!_0x320677[_0x3e9575(0xd1b)]('[')&&!_0x320677[_0x3e9575(0xd1b)]('{'))return _0x320677;if(!_0x214dfa[_0x2da0f9]){console[_0x3e9575(0x1e6)]('Caching\x20rendering\x20rules\x20for\x20chat:\x20'+_0x2da0f9);const _0x42c36c=await _0x54c587[_0x3e9575(0x148f)]['where']('chatId')[_0x3e9575(0x4ce)](_0x3e9575(0x1051))['or'](_0x3e9575(0x4dd))[_0x3e9575(0x4ce)](_0x2da0f9)['toArray']();_0x214dfa[_0x2da0f9]=_0x42c36c[_0x3e9575(0x29d)](_0x9bb990=>_0x9bb990['isEnabled']);}const _0x5d7b71=_0x214dfa[_0x2da0f9];let _0x192f10=_0x320677;for(const _0x19beef of _0x5d7b71){try{const _0x3345f9=new RegExp(_0x19beef['regex'],'g');let _0x2ea766=_0x192f10;_0x3345f9[_0x3e9575(0x2c0)](_0x2ea766)&&(_0x192f10=_0x192f10[_0x3e9575(0xe19)](_0x3345f9,_0x19beef['template']));}catch(_0x10fdad){console[_0x3e9575(0x5d7)](_0x3e9575(0x10e5)+_0x19beef[_0x3e9575(0xf3e)]+_0x3e9575(0x979),_0x10fdad);}}return _0x192f10;}function _0x183c14(_0x227ba4){const _0x4f8e7d=_0x239c7d;if(!_0x227ba4)return'';const _0x491d70=new Date(),_0x821bd7=new Date(_0x227ba4),_0x29a414=String(_0x821bd7['getHours']())[_0x4f8e7d(0xb7d)](0x2,'0'),_0x218160=String(_0x821bd7[_0x4f8e7d(0x1297)]())[_0x4f8e7d(0xb7d)](0x2,'0'),_0x44dc70=_0x29a414+':'+_0x218160;if(_0x491d70['toDateString']()===_0x821bd7[_0x4f8e7d(0x1021)]())return _0x44dc70;const _0x5ce89d=new Date();_0x5ce89d['setDate'](_0x491d70[_0x4f8e7d(0xd00)]()-0x1);if(_0x5ce89d[_0x4f8e7d(0x1021)]()===_0x821bd7[_0x4f8e7d(0x1021)]())return _0x4f8e7d(0x11e0)+_0x44dc70;const _0x4f393f=_0x821bd7[_0x4f8e7d(0x1619)](),_0x3ef76e=String(_0x821bd7[_0x4f8e7d(0xebe)]()+0x1)['padStart'](0x2,'0'),_0x4aabde=String(_0x821bd7[_0x4f8e7d(0xd00)]())['padStart'](0x2,'0');return _0x491d70['getFullYear']()===_0x4f393f?_0x3ef76e+'月'+_0x4aabde+'日\x20'+_0x44dc70:_0x4f393f+'年'+_0x3ef76e+'月'+_0x4aabde+'日\x20'+_0x44dc70;}function _0xad544c(_0x51c48a){const _0x598032=_0x239c7d,_0x53582a=document[_0x598032(0x2c9)]('div');_0x53582a[_0x598032(0x4e1)]=_0x598032(0x5b0);const _0x1b3fcb=document['createElement'](_0x598032(0xf8e));return _0x1b3fcb[_0x598032(0x4e1)]=_0x598032(0xf15),_0x1b3fcb[_0x598032(0xde7)]=_0x183c14(_0x51c48a),_0x53582a[_0x598032(0x8f2)](_0x1b3fcb),_0x53582a;}async function _0x7a9b96(){const _0x181693=_0x239c7d,_0x2a84f4=_0x4c8b14[_0x181693(0xbea)][_0x4c8b14[_0x181693(0x1539)]];if(!_0x2a84f4||!lastResponseTimestamps||lastResponseTimestamps[_0x181693(0x8d6)]===0x0){alert(_0x181693(0xaf7));return;}_0x2a84f4['history']=_0x2a84f4['history'][_0x181693(0x29d)](_0x3a96ca=>!lastResponseTimestamps['includes'](_0x3a96ca['timestamp'])),await _0x54c587[_0x181693(0xbea)]['put'](_0x2a84f4),await _0x26354c(_0x4c8b14['activeChatId']),_0x51117d();}async function _0xc3cc03(_0x3d304e,_0x2641e4){const _0x1f086b=_0x239c7d;if(!_0x4c8b14[_0x1f086b(0x1539)])return;const _0x302807=_0x4c8b14[_0x1f086b(0xbea)][_0x4c8b14['activeChatId']],_0x32f627=_0x302807['history'][_0x1f086b(0x11a4)](_0x3acdb9=>_0x3acdb9[_0x1f086b(0x287)]===_0x3d304e);if(_0x32f627===-0x1)return;const _0xc3c421=_0x302807[_0x1f086b(0x92c)][_0x32f627],_0x4d2f4a=_0xc3c421['prompt'];if(!_0x4d2f4a){await _0x138765(_0x1f086b(0xf78),_0x1f086b(0x159b));return;}_0x2641e4['disabled']=!![],_0x2641e4['classList'][_0x1f086b(0x12b6)]('loading');const _0x15b433=_0x2641e4[_0x1f086b(0x117a)]('.message-bubble'),_0x4621cd=_0x15b433?_0x15b433['querySelector'](_0x1f086b(0x9c0)):null;_0x4621cd&&(_0x4621cd[_0x1f086b(0xa00)][_0x1f086b(0xbfa)]='0.5');try{const _0x15a558=await _0x3b71e9(_0x4d2f4a,_0x302807['id']);_0xc3c421[_0x1f086b(0x1436)]=_0x15a558['imageUrl'],_0xc3c421['fullPrompt']=_0x15a558[_0x1f086b(0x551)],await _0x54c587['chats'][_0x1f086b(0x4cb)](_0x302807),_0x4621cd&&(_0x4621cd[_0x1f086b(0x912)]=_0x15a558[_0x1f086b(0x1436)],_0x4621cd['title']=_0x15a558['fullPrompt'],_0x4621cd['style']['opacity']='1');}catch(_0x218535){console[_0x1f086b(0x5d7)](_0x1f086b(0xab0),_0x218535),await _0x138765(_0x1f086b(0x321),_0x1f086b(0x140a)+_0x218535[_0x1f086b(0x6e2)]),_0x4621cd&&(_0x4621cd[_0x1f086b(0xa00)][_0x1f086b(0xbfa)]='1');}finally{_0x2641e4[_0x1f086b(0x366)]=![],_0x2641e4['classList']['remove'](_0x1f086b(0x8f5));}}async function _0x239716(){const _0x1c7c96=_0x239c7d,_0x3de83a=_0x4c8b14['chats'][_0x4c8b14[_0x1c7c96(0x1539)]];if(!_0x3de83a)return;const _0xad4748=_0x3de83a[_0x1c7c96(0x92c)][_0x1c7c96(0x3bf)](_0x5dbcde=>_0x5dbcde[_0x1c7c96(0x71a)]===_0x1c7c96(0x6d6)&&!_0x5dbcde[_0x1c7c96(0x118c)]);if(_0xad4748===-0x1){alert(_0x1c7c96(0x339));return;}const _0x317f0b=_0x3de83a[_0x1c7c96(0x92c)][_0x1c7c96(0x3bf)](_0x3363ca=>_0x3363ca[_0x1c7c96(0x71a)]===_0x1c7c96(0x4fd));if(_0x317f0b<_0xad4748){alert(_0x1c7c96(0xdb5));return;}_0x3de83a[_0x1c7c96(0x92c)]=_0x3de83a[_0x1c7c96(0x92c)][_0x1c7c96(0x69f)](0x0,_0xad4748+0x1),await _0x54c587[_0x1c7c96(0xbea)][_0x1c7c96(0x4cb)](_0x3de83a),await _0x26354c(_0x4c8b14[_0x1c7c96(0x1539)]),await _0x58df1c();}async function _0x33aae6(){const _0x3c8a36=_0x239c7d;if(!_0x4037ab[_0x3c8a36(0x11e7)])return;const _0x1d7b70=_0x4037ab['callHistory'][_0x3c8a36(0x3bf)](_0x320404=>_0x320404['role']===_0x3c8a36(0x6d6));if(_0x1d7b70===-0x1){alert(_0x3c8a36(0x13cb));return;}_0x4037ab[_0x3c8a36(0x652)][_0x3c8a36(0xdcc)](_0x1d7b70+0x1);const _0x2bd7f7=document[_0x3c8a36(0x400)](_0x3c8a36(0x325));_0x2bd7f7[_0x3c8a36(0x1575)]='',_0x4037ab[_0x3c8a36(0x652)][_0x3c8a36(0xbdc)](_0x5d5cba=>{const _0x226eac=_0x3c8a36,_0x287b39=document['createElement'](_0x226eac(0xf8e)),_0x5a4302=_0x5d5cba[_0x226eac(0x71a)]==='assistant'?_0x226eac(0xf25):_0x226eac(0x13a9);_0x287b39[_0x226eac(0x4e1)]=_0x226eac(0x9e6)+_0x5a4302,_0x287b39['dataset'][_0x226eac(0x287)]=_0x5d5cba[_0x226eac(0x287)],_0x5d5cba[_0x226eac(0x71a)]===_0x226eac(0x6d6)?_0x287b39[_0x226eac(0xde7)]=_0x5d5cba[_0x226eac(0x1109)]:_0x287b39['innerHTML']=_0x5d5cba[_0x226eac(0x1109)],_0x3d4218(_0x287b39,()=>_0x1cf385(_0x5d5cba[_0x226eac(0x287)])),_0x2bd7f7[_0x226eac(0x8f2)](_0x287b39);}),_0x2bd7f7['scrollTop']=_0x2bd7f7['scrollHeight'],_0x2ef86f(null);}async function _0x244b05(){const _0x2bb387=_0x239c7d,_0x3b9251=_0x4c8b14[_0x2bb387(0xbea)][_0x4c8b14['activeChatId']];if(!_0x3b9251)return;_0x34ba39(_0x3b9251['id'],!![]);const _0x163e65=document[_0x2bb387(0x400)]('chat-header-title');!_0x3b9251[_0x2bb387(0xc98)]&&(_0x163e65['style'][_0x2bb387(0xbfa)]=0x0,setTimeout(()=>{const _0x399cbe=_0x2bb387;_0x163e65[_0x399cbe(0xde7)]='对方正在输入...',_0x163e65[_0x399cbe(0xb08)][_0x399cbe(0x12b6)](_0x399cbe(0x60c)),_0x163e65[_0x399cbe(0xa00)][_0x399cbe(0xbfa)]=0x1;},0xc8));try{const {proxyUrl:_0x252680,apiKey:_0x30366a,model:_0x44fd81}=_0x4c8b14['apiConfig'];if(!_0x252680||!_0x30366a||!_0x44fd81)throw new Error(_0x2bb387(0xb8c));const _0x32bcee=parseInt(_0x3b9251['settings'][_0x2bb387(0xebb)])||0xa,_0x26e6f7=_0x3b9251[_0x2bb387(0x92c)][_0x2bb387(0x69f)](-_0x32bcee),_0x365546=new Date(),_0x42aa40=new Date(_0x365546['getTime']()+_0x365546['getTimezoneOffset']()*0xea60+0x36ee80*0x8),_0x2d53b0=_0x42aa40[_0x2bb387(0xad4)](_0x2bb387(0x1271),{'timeZone':'Asia/Shanghai','dateStyle':'full','timeStyle':_0x2bb387(0x5e8)}),_0x2bf24e=_0x2d7bdc(_0x42aa40),_0x33d3a8=_0x3b9251['settings']['myNickname']||'我';let _0x3e17fc='';if(_0x3b9251['settings'][_0x2bb387(0xb0d)]&&_0x3b9251[_0x2bb387(0xa37)][_0x2bb387(0xb0d)][_0x2bb387(0x8d6)]>0x0){const _0xa0f1df=_0x3b9251[_0x2bb387(0xa37)][_0x2bb387(0xb0d)][_0x2bb387(0xd18)](_0x5ee1eb=>{const _0x2446e8=_0x2bb387,_0xd6b844=_0x4c8b14[_0x2446e8(0xf57)][_0x2446e8(0x821)](_0x1e8bd6=>_0x1e8bd6['id']===_0x5ee1eb);if(!_0xd6b844||!Array[_0x2446e8(0x16a1)](_0xd6b844[_0x2446e8(0x1109)]))return'';const _0x1544e=_0xd6b844['content'][_0x2446e8(0x29d)](_0xfe04b2=>_0xfe04b2[_0x2446e8(0x250)]!==![])[_0x2446e8(0xd18)](_0x1e9833=>{const _0x39b647=_0x2446e8;let _0x2f1e72='\x0a###\x20条目:\x20'+(_0x1e9833[_0x39b647(0x83c)]||_0x39b647(0x955))+'\x0a';if(_0x1e9833[_0x39b647(0x1161)][_0x39b647(0x8d6)]>0x0)_0x2f1e72+=_0x39b647(0x65c)+_0x1e9833['keys'][_0x39b647(0xee1)](',\x20')+'\x0a';return _0x2f1e72+=_0x39b647(0x845)+_0x1e9833['content'],_0x2f1e72;})[_0x2446e8(0xee1)]('');return _0x1544e?_0x2446e8(0xd75)+_0xd6b844[_0x2446e8(0xf3e)]+'\x0a'+_0x1544e:'';})['filter'](Boolean)['join']('');_0xa0f1df&&(_0x3e17fc=_0x2bb387(0x4a6)+_0xa0f1df+_0x2bb387(0x1022));}let _0x19c9cb='';if(_0x59adb2[_0x2bb387(0x11e7)]&&_0x59adb2[_0x2bb387(0x1539)]===_0x3b9251['id']){const _0x464f04=_0x59adb2[_0x2bb387(0xbf0)]>-0x1?_0x59adb2[_0x2bb387(0xc3e)][_0x59adb2[_0x2bb387(0xbf0)]]:null;_0x19c9cb=_0x2bb387(0xe71);}const _0x2403c2=_0x2e836a(_0x30ad43[_0x3b9251['id']]);let _0x282d2b='';_0x3b9251[_0x2bb387(0x112b)]&&_0x3b9251[_0x2bb387(0x112b)][_0x2bb387(0x8d6)]>0x0&&(_0x282d2b=_0x2bb387(0x359)+_0x3b9251[_0x2bb387(0x112b)][_0x2bb387(0xee1)](',\x20')+']。当在对话历史中看到这些名字时，它们都指的是【你】自己。');let _0x4ea892='';const _0x27efec=_0x4c8b14[_0x2bb387(0x834)][_0x2bb387(0xbf3)]||'用户';_0x4ea892+=_0x2bb387(0xd90)+_0x27efec+_0x2bb387(0x5d9);const _0x3bda84=Object[_0x2bb387(0x40a)](_0x4c8b14[_0x2bb387(0xbea)])[_0x2bb387(0x29d)](_0x528b11=>_0x528b11[_0x2bb387(0xc98)]&&_0x528b11[_0x2bb387(0x4f8)][_0x2bb387(0x1412)](_0x3318a0=>_0x3318a0['id']===_0x3b9251['id']));_0x3bda84['length']>0x0&&(_0x4ea892+='-\x20用户在你们共同所在的群聊中的昵称如下：\x0a',_0x3bda84[_0x2bb387(0xbdc)](_0x5afe99=>{const _0x5e8652=_0x2bb387,_0x222b91=_0x5afe99[_0x5e8652(0xa37)][_0x5e8652(0x14a8)]||_0x27efec;_0x4ea892+=_0x5e8652(0x104b)+_0x5afe99[_0x5e8652(0xf3e)]+_0x5e8652(0x15da)+_0x222b91+_0x5e8652(0x1631);}));_0x4ea892+=_0x2bb387(0x1013);const _0x44ba6e=_0x460a58(_0x3b9251),_0x4ef8a0=_0x2bb387(0x571)+_0x3b9251['originalName']+_0x2bb387(0x5f2)+_0x2d53b0+'\x20('+_0x2bf24e+')，并在对话中自然地体现出来。\x0a\x20\x20\x20\x20-\x20**音乐**:\x20'+(_0x19c9cb?'你们正在一起听歌，'+_0x19c9cb:_0x2bb387(0x25e))+_0x2bb387(0x7fc)+(_0x3b9251[_0x2bb387(0x1600)]&&_0x3b9251[_0x2bb387(0x1600)][_0x2bb387(0x8d6)]>0x0?_0x3b9251[_0x2bb387(0x1600)]['map'](_0x3db6bf=>'-\x20'+_0x3db6bf[_0x2bb387(0x1109)])[_0x2bb387(0xee1)]('\x0a'):'-\x20(暂无)')+'\x0a\x0a#\x20你的角色设定\x0a'+_0x3b9251[_0x2bb387(0xa37)]['aiPersona']+_0x2bb387(0x1673)+_0x3b9251[_0x2bb387(0xdcf)]+'\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22'+_0x3b9251[_0x2bb387(0xf3e)]+_0x2bb387(0x138b)+_0x33d3a8+_0x2bb387(0xec5)+_0x4ea892+_0x2bb387(0x1574)+_0x282d2b+'\x0a\x20\x20\x20\x20'+_0x3e17fc+_0x2bb387(0xe20)+_0x44ba6e+'\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20'+(_0x3b9251[_0x2bb387(0xa37)][_0x2bb387(0x1080)]&&_0x3b9251[_0x2bb387(0xa37)][_0x2bb387(0x1080)][_0x2bb387(0x8d6)]>0x0?_0x3b9251[_0x2bb387(0xa37)][_0x2bb387(0x1080)][_0x2bb387(0xd18)](_0x48c590=>'-\x20'+_0x48c590[_0x2bb387(0xf3e)])[_0x2bb387(0xee1)]('\x0a'):_0x2bb387(0xcaf))+'\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20'+(_0x3b9251[_0x2bb387(0xa37)]['myAvatarLibrary']&&_0x3b9251[_0x2bb387(0xa37)][_0x2bb387(0x110f)]['length']>0x0?_0x3b9251[_0x2bb387(0xa37)][_0x2bb387(0x110f)][_0x2bb387(0xd18)](_0x434634=>'-\x20'+_0x434634[_0x2bb387(0xf3e)])['join']('\x0a'):_0x2bb387(0xcaf))+_0x2bb387(0x479)+_0x3b9251[_0x2bb387(0xa37)][_0x2bb387(0x2ef)]+'\x0a\x0a\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。',_0x4d307b=_0x26e6f7[_0x2bb387(0xd18)](_0x3c294e=>({'role':_0x3c294e[_0x2bb387(0x71a)],'content':String(_0x3c294e['content'])}));_0x4d307b[_0x2bb387(0x6bb)]({'role':'user','content':_0x2bb387(0x10a7)});let _0x51aeb5=_0x252680===GEMINI_API_URL,_0x5bc8fa=_0x3914a6(_0x44fd81,_0x30366a,_0x4ef8a0,_0x4d307b);const _0xedde85=_0x51aeb5?await fetch(_0x5bc8fa[_0x2bb387(0x299)],_0x5bc8fa['data']):await fetch(_0x252680+'/v1/chat/completions',{'method':_0x2bb387(0x953),'headers':{'Content-Type':_0x2bb387(0xfae),'Authorization':_0x2bb387(0xcee)+_0x30366a},'body':JSON['stringify']({'model':_0x44fd81,'messages':[{'role':'system','content':_0x4ef8a0},..._0x4d307b],'temperature':_0x4c8b14['globalSettings'][_0x2bb387(0x216)]||0.8})});if(!_0xedde85['ok']){const _0x42388c=await _0xedde85['json']();throw new Error(_0x2bb387(0x1178)+_0x42388c[_0x2bb387(0x5d7)][_0x2bb387(0x6e2)]);}const _0x513da7=await _0xedde85['json'](),_0x11939d=getGeminiResponseText(_0x513da7),_0x14e2b1=_0x57a22a(_0x11939d),_0x244e42=[];for(const _0x229fa7 of _0x14e2b1){if(_0x229fa7[_0x2bb387(0xbbf)]==='text'&&typeof _0x229fa7['content']==='string'&&_0x229fa7['content']['includes']('\x0a')){const _0x321adf=_0x229fa7[_0x2bb387(0x1109)][_0x2bb387(0x5ad)](/\n+/)[_0x2bb387(0x29d)](_0x44fe6a=>_0x44fe6a[_0x2bb387(0xb8f)]());_0x321adf[_0x2bb387(0xbdc)](_0x2b8542=>{_0x244e42['push']({..._0x229fa7,'content':_0x2b8542});});}else _0x244e42[_0x2bb387(0x6bb)](_0x229fa7);}let _0x3c0d3a=Date[_0x2bb387(0xecd)]();for(const _0xd281ec of _0x244e42){const _0x162d32={'role':_0x2bb387(0x4fd),'senderName':_0x3b9251[_0x2bb387(0xdcf)],'timestamp':_0x3c0d3a++,'content':_0xd281ec[_0x2bb387(0x1109)]||_0xd281ec[_0x2bb387(0x6e2)],'type':_0xd281ec['type']||_0x2bb387(0x117f)};if(_0xd281ec['type']===_0x2bb387(0x95a)){if(!_0x3b9251['isGroup']){if(_0xd281ec[_0x2bb387(0x348)])_0x3b9251[_0x2bb387(0x8ab)]=String(_0xd281ec['heartfelt_voice']);if(_0xd281ec['random_jottings'])_0x3b9251[_0x2bb387(0x13e5)]=String(_0xd281ec[_0x2bb387(0xd13)]);}continue;}_0x3b9251[_0x2bb387(0x92c)][_0x2bb387(0x6bb)](_0x162d32),_0x41ecc7(_0x162d32,_0x3b9251),await new Promise(_0x5dcfdb=>setTimeout(_0x5dcfdb,Math['random']()*0x3e8+0x320));}await _0x54c587[_0x2bb387(0xbea)][_0x2bb387(0x4cb)](_0x3b9251),_0x41b828();}catch(_0x14f425){console[_0x2bb387(0x5d7)]('推进剧情失败:',_0x14f425),await _0x138765(_0x2bb387(0x12cb),'无法推进剧情:\x20'+_0x14f425[_0x2bb387(0x6e2)]);}finally{_0x34ba39(_0x3b9251['id'],![]);if(!_0x3b9251[_0x2bb387(0xc98)]&&document[_0x2bb387(0x400)]('chat-header-title')){const _0x24fbb0=document[_0x2bb387(0x400)](_0x2bb387(0x1429));_0x24fbb0[_0x2bb387(0xa00)][_0x2bb387(0xbfa)]=0x0,setTimeout(()=>{const _0x42c72b=_0x2bb387;_0x24fbb0[_0x42c72b(0xde7)]=_0x3b9251['name'],_0x24fbb0[_0x42c72b(0xb08)]['remove'](_0x42c72b(0x60c)),_0x24fbb0['style']['opacity']=0x1;},0xc8);}}}function _0x4c601e(){const _0x453b8c=_0x239c7d,_0x345145=document[_0x453b8c(0x400)]('notification-sound-player'),_0xc3d6b5=_0x4c8b14[_0x453b8c(0x14f1)][_0x453b8c(0x3a5)]||_0xfb99b3;_0xc3d6b5&&_0xc3d6b5[_0x453b8c(0xb8f)]()&&(_0x345145['src']=_0xc3d6b5,_0x345145['play']()[_0x453b8c(0x37a)](_0x1e9e60=>console[_0x453b8c(0x1e6)](_0x453b8c(0xbfe),_0x1e9e60)));}function _0x15f9e9(){const _0x5f02c4=_0x239c7d;if(!_0x4c8b14[_0x5f02c4(0x14f1)][_0x5f02c4(0xca8)])return;for(const _0x14e594 in _0x4c8b14[_0x5f02c4(0x14f1)]['widgetData']){const _0x29e749=document[_0x5f02c4(0x400)](_0x14e594),_0x9377c5=_0x4c8b14[_0x5f02c4(0x14f1)][_0x5f02c4(0xca8)][_0x14e594];_0x29e749&&(_0x29e749[_0x5f02c4(0xa95)]==='IMG'?_0x29e749[_0x5f02c4(0x912)]=_0x9377c5:_0x29e749[_0x5f02c4(0xde7)]=_0x9377c5);}}function _0x1f7db7(){return new Promise(_0x6348ca=>{const _0xaf99e5=_0x466f,_0x358435=document[_0xaf99e5(0x2c9)](_0xaf99e5(0x10a8));_0x358435[_0xaf99e5(0xbbf)]=_0xaf99e5(0xb41),_0x358435['accept']=_0xaf99e5(0x12be),_0x358435[_0xaf99e5(0x1491)]=_0x2fb671=>{const _0x4e893f=_0xaf99e5,_0x409c62=_0x2fb671[_0x4e893f(0x657)]['files'][0x0];if(_0x409c62){const _0x612ac8=new FileReader();_0x612ac8[_0x4e893f(0x9e0)]=_0x399502=>{const _0x12db9c=_0x4e893f;_0x6348ca(_0x399502[_0x12db9c(0x657)][_0x12db9c(0xdd1)]);},_0x612ac8[_0x4e893f(0x157f)](_0x409c62);}else _0x6348ca(null);},_0x358435[_0xaf99e5(0x15ad)]();});}async function _0x224200(_0x569c6e){const _0x950f81=_0x239c7d,_0xcf6efe=_0x569c6e['id'],_0x28a945=_0x569c6e[_0x950f81(0xde7)],_0x155bfc=await _0x25f61f(_0x950f81(0x7ea),_0x950f81(0x1698),_0x28a945);if(_0x155bfc!==null&&_0x155bfc['trim']()!==''){const _0xd331e3=_0x155bfc[_0x950f81(0xb8f)]();_0x569c6e[_0x950f81(0xde7)]=_0xd331e3,_0x4c8b14['globalSettings'][_0x950f81(0xca8)][_0xcf6efe]=_0xd331e3,await _0x54c587[_0x950f81(0x14f1)]['put'](_0x4c8b14['globalSettings']),alert(_0x950f81(0x745));}}async function _0x1a1c4e(_0xc31391){const _0x188431=_0x239c7d,_0x51a30f=_0xc31391['id'],_0x56ed15=await _0x14b058('修改图片',[{'text':_0x188431(0xf4d),'value':'local'},{'text':_0x188431(0x15b7),'value':_0x188431(0x299)}]);let _0x792087=null;if(_0x56ed15===_0x188431(0xdf5))_0x792087=await _0x1f7db7();else _0x56ed15===_0x188431(0x299)&&(_0x792087=await _0x25f61f(_0x188431(0xfd6),'请输入新的图片URL：',_0xc31391[_0x188431(0x912)],_0x188431(0x299)));if(_0x792087&&_0x792087[_0x188431(0xb8f)]()){const _0x3107f3=_0x792087['trim']();_0xc31391['src']=_0x3107f3,_0x4c8b14[_0x188431(0x14f1)][_0x188431(0xca8)][_0x51a30f]=_0x3107f3,await _0x54c587['globalSettings'][_0x188431(0x4cb)](_0x4c8b14['globalSettings']),alert(_0x188431(0x1610));}else _0x56ed15===_0x188431(0x299)&&_0x792087!==null&&alert(_0x188431(0xaf3));}const _0x29e407={'getSongCache'(_0x352a79,_0x462761){const _0xf14cb6=_0x239c7d,_0x464b40=(_0x462761||_0xf14cb6(0x875))+':'+_0x352a79;if(_0x4c8b14[_0xf14cb6(0xa10)]&&_0x4c8b14[_0xf14cb6(0xa10)][_0xf14cb6(0x1681)]){const _0x50c882=_0x4c8b14[_0xf14cb6(0xa10)][_0xf14cb6(0x1681)]['get'](_0x464b40);if(_0x50c882&&Date[_0xf14cb6(0xecd)]()-_0x50c882[_0xf14cb6(0x287)]<0x36ee80)return _0x50c882[_0xf14cb6(0x55b)];}return null;},'setSongCache'(_0x1484ec,_0x578e59,_0x6e2b77){const _0x2fda11=_0x239c7d,_0xd9482c=(_0x6e2b77||_0x2fda11(0x875))+':'+_0x1484ec;if(!_0x4c8b14['cache'])_0x4c8b14[_0x2fda11(0xa10)]={};if(!_0x4c8b14[_0x2fda11(0xa10)]['songs'])_0x4c8b14[_0x2fda11(0xa10)][_0x2fda11(0x1681)]=new Map();_0x4c8b14[_0x2fda11(0xa10)]['songs'][_0x2fda11(0xfa3)](_0xd9482c,{'data':_0x578e59,'timestamp':Date[_0x2fda11(0xecd)]()});}};typeof Http_Get_External===_0x239c7d(0xd30)&&(window[_0x239c7d(0xbbd)]=function(_0x12a741){return new Promise(_0x19d814=>{const _0x282d97=_0x466f;fetch(_0x12a741)[_0x282d97(0xa8b)](_0x252a0a=>_0x252a0a[_0x282d97(0x15d3)]()['catch'](()=>_0x252a0a['text']()))[_0x282d97(0xa8b)](_0x19d814)[_0x282d97(0x37a)](()=>_0x19d814(null));});});async function _0x11a701(_0x3a324e){return await Http_Get_External(_0x3a324e);}function _0x52e360(_0x1a3038){return new Promise(_0x4d3370=>{const _0x90b517=_0x466f,_0x3ad499=new Audio();_0x3ad499['addEventListener'](_0x90b517(0x1289),()=>_0x4d3370(!![]),{'once':!![]}),_0x3ad499['addEventListener']('error',()=>_0x4d3370(![]),{'once':!![]}),_0x3ad499[_0x90b517(0x912)]=_0x1a3038;});}async function _0x1f3b64(_0x35e9ea,_0x559929){const _0x40fb16=_0x239c7d;try{let _0x32130f=_0x35e9ea['replace'](/\s/g,'');_0x559929&&(_0x32130f+='\x20'+_0x559929[_0x40fb16(0xe19)](/\s/g,''));const _0x596d1f=_0x40fb16(0x106b)+encodeURIComponent(_0x32130f);console['log'](_0x40fb16(0x21e),_0x596d1f);const _0x53b4e6=await fetch(_0x596d1f);if(!_0x53b4e6['ok'])throw new Error('API\x20请求失败，状态码:\x20'+_0x53b4e6[_0x40fb16(0x12c3)]);const _0x34c0be=await _0x53b4e6[_0x40fb16(0x15d3)]();if(_0x34c0be[_0x40fb16(0x6c8)]!==0xc8||!_0x34c0be['data']||_0x34c0be['data'][_0x40fb16(0x8d6)]===0x0)return console[_0x40fb16(0x1e6)]('网易云音乐API未返回有效结果:',_0x34c0be),[];return _0x34c0be['data'][_0x40fb16(0xd18)](_0x118dbb=>({'name':_0x118dbb[_0x40fb16(0x67f)],'artist':_0x118dbb['singer'],'id':_0x118dbb['id'],'cover':_0x118dbb[_0x40fb16(0x554)]||'https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','source':_0x40fb16(0xfe9)}))[_0x40fb16(0x69f)](0x0,0x1e);}catch(_0x530b79){return console[_0x40fb16(0x5d7)](_0x40fb16(0x3b7),_0x530b79),[];}}async function _0x4d9fee(_0x100b05){const _0x2ebabe=_0x239c7d;try{_0x100b05=_0x100b05[_0x2ebabe(0xe19)](/\s/g,'');const _0x3cd505=await _0x11a701(_0x2ebabe(0x6b8)+encodeURIComponent(_0x100b05));if(!_0x3cd505?.[_0x2ebabe(0x55b)]?.[_0x2ebabe(0x8d6)])return[];return _0x3cd505[_0x2ebabe(0x55b)]['map'](_0x1403aa=>({'name':_0x1403aa[_0x2ebabe(0x67f)],'artist':_0x1403aa[_0x2ebabe(0x1211)],'id':_0x1403aa['id'],'cover':_0x1403aa[_0x2ebabe(0x554)]||_0x2ebabe(0x978),'source':_0x2ebabe(0x844)}))[_0x2ebabe(0x69f)](0x0,0x1e);}catch(_0x7ba123){return console[_0x2ebabe(0x5d7)](_0x2ebabe(0xf0e),_0x7ba123),[];}}async function _0x2e729a(){const _0x9d6fd=_0x239c7d,_0x3ad161=await _0x25f61f(_0x9d6fd(0x160c),'请输入\x20歌名\x20或\x20歌名-歌手');if(!_0x3ad161||!_0x3ad161['trim']())return;await _0x138765('请稍候...','正在全网搜索歌曲资源...');let _0x5444e7=_0x3ad161['trim'](),_0x1da783='';if(_0x3ad161[_0x9d6fd(0xd1b)]('-')||_0x3ad161[_0x9d6fd(0xd1b)]('–')){const _0x4b8783=_0x3ad161[_0x9d6fd(0x5ad)](/[-–]/);_0x5444e7=_0x4b8783[0x0][_0x9d6fd(0xb8f)](),_0x1da783=_0x4b8783[_0x9d6fd(0x69f)](0x1)[_0x9d6fd(0xee1)]('\x20')[_0x9d6fd(0xb8f)]();}const [_0x579325,_0x4780d6]=await Promise['all']([_0x1f3b64(_0x5444e7,_0x1da783),_0x4d9fee(_0x5444e7)]),_0xa74c48=[..._0x579325,..._0x4780d6];if(_0xa74c48['length']===0x0){await _0x138765(_0x9d6fd(0xf9e),_0x9d6fd(0x38e));return;}const _0x4cbbdc=document[_0x9d6fd(0x400)]('music-search-results-modal'),_0xe52972=document['getElementById'](_0x9d6fd(0x1002));_0xe52972[_0x9d6fd(0x1575)]='',document[_0x9d6fd(0x400)](_0x9d6fd(0xe49))[_0x9d6fd(0x6f9)]=![],_0xa74c48['forEach'](_0x58b366=>{const _0x57b829=_0x9d6fd,_0x4cecb8=document['createElement'](_0x57b829(0xf8e));_0x4cecb8[_0x57b829(0x4e1)]=_0x57b829(0x327),_0x4cecb8[_0x57b829(0xd61)][_0x57b829(0x232)]=JSON[_0x57b829(0xea5)](_0x58b366),_0x4cecb8[_0x57b829(0x1575)]=_0x57b829(0x74e)+_0x58b366[_0x57b829(0xf3e)]+_0x57b829(0x119c)+_0x58b366[_0x57b829(0x833)]+'\x20<span\x20class=\x22source\x22>'+(_0x58b366['source']===_0x57b829(0xfe9)?_0x57b829(0x10fd):_0x57b829(0xfdb))+_0x57b829(0x16a0),_0xe52972[_0x57b829(0x8f2)](_0x4cecb8);}),_0x4cbbdc['classList'][_0x9d6fd(0x12b6)](_0x9d6fd(0x9eb));}async function _0x31dc92(_0x7fd506){const _0x5a86d0=_0x239c7d;let _0x54e101=null,_0xf16768=_0x7fd506[_0x5a86d0(0x1311)];const _0x2a59dc=_0x7fd506[_0x5a86d0(0x1311)]===_0x5a86d0(0xfe9)?_0x5a86d0(0x134e)+_0x7fd506['id']:_0x5a86d0(0x1ef)+_0x7fd506['id'];let _0x2ea8d5=await _0x11a701(_0x2a59dc);_0x2ea8d5?.[_0x5a86d0(0x55b)]?.[_0x5a86d0(0x299)]&&(_0x54e101={'url':_0x2ea8d5[_0x5a86d0(0x55b)][_0x5a86d0(0x299)],'id':_0x7fd506['id'],'source':_0x7fd506['source']});if(!_0x54e101){const _0xe7242a=_0x7fd506['source']==='netease'?'tencent':_0x5a86d0(0xfe9),_0x4f6aeb=_0xe7242a===_0x5a86d0(0x844)?await _0x4d9fee(_0x7fd506[_0x5a86d0(0xf3e)]):await _0x1f3b64(_0x7fd506[_0x5a86d0(0xf3e)],_0x7fd506[_0x5a86d0(0x833)]);if(_0x4f6aeb[_0x5a86d0(0x8d6)]>0x0){const _0x5cdf05=_0xe7242a===_0x5a86d0(0xfe9)?_0x5a86d0(0x134e)+_0x4f6aeb[0x0]['id']:_0x5a86d0(0x1ef)+_0x4f6aeb[0x0]['id'],_0x2fe24a=await _0x11a701(_0x5cdf05);_0x2fe24a?.[_0x5a86d0(0x55b)]?.['url']&&(_0x54e101={'url':_0x2fe24a[_0x5a86d0(0x55b)][_0x5a86d0(0x299)],'id':_0x4f6aeb[0x0]['id'],'source':_0xe7242a},_0xf16768=_0xe7242a);}}if(_0x54e101){_0x54e101[_0x5a86d0(0x299)]&&typeof _0x54e101['url']==='string'&&(_0x54e101[_0x5a86d0(0x299)]=_0x54e101['url'][_0x5a86d0(0xe19)](/^http:\/\//i,_0x5a86d0(0x74a)));_0x7fd506[_0x5a86d0(0x554)]&&typeof _0x7fd506['cover']==='string'&&(_0x7fd506[_0x5a86d0(0x554)]=_0x7fd506[_0x5a86d0(0x554)]['replace'](/^http:\/\//i,_0x5a86d0(0x74a)));const _0x39b9cb=await _0x54c943(_0x54e101['id'],_0xf16768)||'';return{'name':_0x7fd506[_0x5a86d0(0xf3e)],'artist':_0x7fd506[_0x5a86d0(0x833)],'src':_0x54e101['url'],'cover':_0x7fd506[_0x5a86d0(0x554)],'isLocal':![],'lrcContent':_0x39b9cb};}return null;}async function _0x54c943(_0x15991c,_0x235009){const _0x351afc=_0x239c7d,_0x1e2717=_0x235009==='netease'?_0x351afc(0x86c)+_0x15991c:'https://api.vkeys.cn/v2/music/tencent/lyric?id='+_0x15991c,_0x12e6fb=await _0x11a701(_0x1e2717);if(_0x12e6fb?.[_0x351afc(0x55b)]){const _0xd2d5fc=_0x12e6fb[_0x351afc(0x55b)][_0x351afc(0xc20)]||_0x12e6fb['data'][_0x351afc(0x10ab)]||'',_0x597174=_0x12e6fb[_0x351afc(0x55b)][_0x351afc(0x10e6)]||_0x12e6fb['data']['tlyric']||'';return _0xd2d5fc+'\x0a'+_0x597174;}return'';}async function _0x4e8084(_0x4fa155){const _0x11e5e6=_0x239c7d;if(_0x4fa155<0x0||_0x4fa155>=_0x59adb2[_0x11e5e6(0xc3e)][_0x11e5e6(0x8d6)])return;const _0x452a9f=await _0x14b058('选择歌词导入方式',[{'text':'📁\x20从本地文件\x20(.lrc)','value':_0x11e5e6(0xb41)},{'text':_0x11e5e6(0xabc),'value':_0x11e5e6(0x10b3)}]);let _0x1febb2=null;if(_0x452a9f==='file')_0x1febb2=await new Promise(_0x11d604=>{const _0x91f7c3=_0x11e5e6,_0x3dcf83=document[_0x91f7c3(0x400)]('lrc-upload-input'),_0xfb8a5b=_0x257af4=>{const _0x223058=_0x91f7c3,_0x5df111=_0x257af4['target'][_0x223058(0x780)][0x0];if(_0x5df111){const _0x583557=new FileReader();_0x583557[_0x223058(0x9e0)]=_0x2ff3d2=>_0x11d604(_0x2ff3d2[_0x223058(0x657)][_0x223058(0xdd1)]),_0x583557[_0x223058(0x96d)]=()=>_0x11d604(null),_0x583557['readAsText'](_0x5df111);}else _0x11d604(null);_0x3dcf83[_0x223058(0xf17)](_0x223058(0x866),_0xfb8a5b),_0x3dcf83[_0x223058(0xa1e)]='';};_0x3dcf83['addEventListener'](_0x91f7c3(0x866),_0xfb8a5b,{'once':!![]}),_0x3dcf83['click']();});else{if(_0x452a9f===_0x11e5e6(0x10b3)){const _0x3ef058=await _0x25f61f(_0x11e5e6(0x1018),_0x11e5e6(0x1254),'',_0x11e5e6(0x79e));if(_0x3ef058)_0x1febb2=_0x3ef058[_0x11e5e6(0xe19)](/\[/g,'\x0a[')[_0x11e5e6(0xb8f)]();}}_0x1febb2!==null&&(_0x59adb2[_0x11e5e6(0xc3e)][_0x4fa155][_0x11e5e6(0x121f)]=_0x1febb2,await _0x2d1049(),_0x59adb2[_0x11e5e6(0xbf0)]===_0x4fa155&&(_0x59adb2['parsedLyrics']=_0x4a1132(_0x1febb2),_0x5c4970(),_0x3be08a()),await _0x138765('成功','《'+_0x59adb2[_0x11e5e6(0xc3e)][_0x4fa155][_0x11e5e6(0xf3e)]+_0x11e5e6(0x13b0)));}async function _0x2736af(){const _0x273b5a=_0x239c7d;if(_0x59adb2[_0x273b5a(0xbf0)]===-0x1)return;const _0x2ff3a9=_0x59adb2['playlist'][_0x59adb2[_0x273b5a(0xbf0)]];if(!_0x2ff3a9)return;_0x2ff3a9['isBgClear']=!_0x2ff3a9[_0x273b5a(0xc44)],await _0x2d1049();const _0x52591f=document['querySelector'](_0x273b5a(0xd99)),_0x426fd7=document['getElementById'](_0x273b5a(0x604));_0x52591f[_0x273b5a(0xb08)][_0x273b5a(0x146f)](_0x273b5a(0x756),_0x2ff3a9[_0x273b5a(0xc44)]),_0x426fd7['classList'][_0x273b5a(0x146f)]('active',_0x2ff3a9[_0x273b5a(0xc44)]);}function _0x4b0c14(){const _0x25f932=_0x239c7d,_0x1ea226=document[_0x25f932(0x400)]('music-player-avatar-display'),_0x5f36a0=document[_0x25f932(0x400)]('show-avatars-btn');_0x1ea226&&_0x5f36a0&&(_0x1ea226[_0x25f932(0xb08)][_0x25f932(0x146f)](_0x25f932(0x9eb)),_0x5f36a0['classList']['toggle']('active'));}function _0x5ecd31(){const _0x4cbf2a=_0x239c7d,_0x1465c4=document[_0x4cbf2a(0x13ef)](_0x4cbf2a(0xd99)),_0x3c318b=document[_0x4cbf2a(0x400)](_0x4cbf2a(0x144c));_0x1465c4&&_0x3c318b&&(_0x1465c4[_0x4cbf2a(0xb08)][_0x4cbf2a(0x146f)]('fullscreen'),_0x3c318b['classList'][_0x4cbf2a(0x146f)](_0x4cbf2a(0x1069)));}window[_0x239c7d(0x13c4)]=_0x5ecd31;async function _0x1b35e4(){const _0x54e010=_0x239c7d;if(_0x59adb2[_0x54e010(0xc3e)][_0x54e010(0x8d6)]===0x0){alert(_0x54e010(0x102f));return;}const _0x137868=await _0x56d4d3(_0x54e010(0x7ff),_0x54e010(0xc62),{'confirmText':_0x54e010(0xd74)});if(!_0x137868)return;await _0x138765(_0x54e010(0x13e9),_0x54e010(0x1484)+_0x59adb2[_0x54e010(0xc3e)][_0x54e010(0x8d6)]+_0x54e010(0x503));const _0x174666=_0x59adb2[_0x54e010(0xc3e)][_0x54e010(0x8d6)],_0x59b4a1=[],_0x38a26a=[],_0x2dd2ce=_0x59adb2[_0x54e010(0xc3e)]['map'](async _0x229c07=>{const _0x1a9a85=_0x54e010;if(_0x229c07[_0x1a9a85(0x3f0)]){_0x59b4a1[_0x1a9a85(0x6bb)](_0x229c07);return;}const _0x5abb7f=await _0x52e360(_0x229c07[_0x1a9a85(0x912)]);_0x5abb7f?_0x59b4a1[_0x1a9a85(0x6bb)](_0x229c07):(_0x38a26a['push'](_0x229c07[_0x1a9a85(0xf3e)]),console[_0x1a9a85(0x75e)](_0x1a9a85(0x1581)+_0x229c07['name']+_0x1a9a85(0x1477)+_0x229c07['src']));});await Promise[_0x54e010(0x875)](_0x2dd2ce);const _0x852539=_0x174666-_0x59b4a1['length'];if(_0x852539>0x0){const _0x6f74a5=_0x59adb2[_0x54e010(0xc3e)][_0x59adb2[_0x54e010(0xbf0)]],_0x4a39c1=_0x38a26a['includes'](_0x6f74a5?.[_0x54e010(0xf3e)]);_0x59adb2['playlist']=_0x59b4a1,await _0x2d1049();if(_0x4a39c1)_0x86eb29[_0x54e010(0x1385)](),_0x86eb29[_0x54e010(0x912)]='',_0x59adb2[_0x54e010(0xbf0)]=_0x59adb2[_0x54e010(0xc3e)][_0x54e010(0x8d6)]>0x0?0x0:-0x1,_0x59adb2['isPlaying']=![];else _0x6f74a5&&(_0x59adb2[_0x54e010(0xbf0)]=_0x59adb2['playlist'][_0x54e010(0x11a4)](_0x30ec9b=>_0x30ec9b[_0x54e010(0x912)]===_0x6f74a5[_0x54e010(0x912)]));_0x4514b2(),_0x12737e(),await _0x138765('清理完成',_0x54e010(0x39a)+_0x852539+'\x20首无效歌曲:\x0a\x0a-\x20'+_0x38a26a['join'](_0x54e010(0x105b)));}else await _0x138765(_0x54e010(0xb4c),'所有歌曲链接均有效，无需清理！');}function _0x3e4f38(){const _0x3da3cd=_0x239c7d,_0x1b1b7d=document['getElementById'](_0x3da3cd(0x43a));_0x1b1b7d['classList'][_0x3da3cd(0x146f)](_0x3da3cd(0x4ca),!!_0x4c8b14[_0x3da3cd(0x14f1)]['showStatusBar']);}async function _0xb7d893(){const _0x1e456c=_0x239c7d,_0x114a63=document[_0x1e456c(0x400)](_0x1e456c(0x54e)),_0xaa7bc1=document['getElementById'](_0x1e456c(0x559));_0xaa7bc1[_0x1e456c(0x1575)]='';const _0x26e3b9=[];_0x26e3b9['push']({'text':_0x1e456c(0x739),'value':_0x1e456c(0x875),'isDanger':!![]});const _0x300855=_0x4c8b14['qzoneSettings'][_0x1e456c(0xbf3)]||'我';_0x26e3b9[_0x1e456c(0x6bb)]({'text':_0x1e456c(0x263)+_0x300855+'\x20的动态\x20(用户)','value':'user'}),Object[_0x1e456c(0x40a)](_0x4c8b14['chats'])[_0x1e456c(0xbdc)](_0x2cf5e8=>{const _0x512c4a=_0x1e456c;!_0x2cf5e8[_0x512c4a(0xc98)]&&_0x26e3b9[_0x512c4a(0x6bb)]({'text':_0x512c4a(0x263)+_0x2cf5e8[_0x512c4a(0xf3e)]+_0x512c4a(0x669),'value':_0x2cf5e8['id']});});try{const _0xdc56e0=await _0x54c587[_0x1e456c(0xf9b)][_0x1e456c(0xce1)]();_0xdc56e0[_0x1e456c(0x8d6)]>0x0&&(_0x26e3b9[_0x1e456c(0x6bb)]({'isSeparator':!![],'text':_0x1e456c(0xda5)}),_0xdc56e0[_0x1e456c(0xbdc)](_0x334fd4=>{const _0x535672=_0x1e456c;_0x26e3b9[_0x535672(0x6bb)]({'text':'仅清空\x20'+_0x334fd4[_0x535672(0xf3e)]+_0x535672(0x300),'value':_0x535672(0x1530)+_0x334fd4['id']});}));}catch(_0x3e8675){console[_0x1e456c(0x5d7)](_0x1e456c(0x2be),_0x3e8675);}_0x26e3b9['forEach'](_0x36b657=>{const _0x2bbd68=_0x1e456c;if(_0x36b657[_0x2bbd68(0xdc5)]){const _0x21b97b=document[_0x2bbd68(0x2c9)]('div');_0x21b97b[_0x2bbd68(0xde7)]=_0x36b657[_0x2bbd68(0x117f)],_0x21b97b[_0x2bbd68(0xa00)][_0x2bbd68(0x32e)]=_0x2bbd68(0x8e5),_0xaa7bc1['appendChild'](_0x21b97b);return;}const _0x2bddfb=document['createElement'](_0x2bbd68(0xf8e));_0x2bddfb[_0x2bbd68(0x4e1)]=_0x2bbd68(0x417),_0x36b657[_0x2bbd68(0x9c4)]&&_0x2bddfb[_0x2bbd68(0xb08)][_0x2bbd68(0x12b6)](_0x2bbd68(0x10d5)),_0x2bddfb[_0x2bbd68(0xd61)]['targetId']=_0x36b657['value'],_0x2bddfb[_0x2bbd68(0x1575)]=_0x2bbd68(0xc29)+_0x36b657[_0x2bbd68(0x117f)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0xaa7bc1[_0x2bbd68(0x8f2)](_0x2bddfb);}),_0x114a63[_0x1e456c(0xb08)][_0x1e456c(0x12b6)](_0x1e456c(0x9eb));}async function _0xf5f601(){const _0x116eba=_0x239c7d,_0x2f3af9=document['querySelectorAll'](_0x116eba(0x5ab));if(_0x2f3af9[_0x116eba(0x8d6)]===0x0){alert(_0x116eba(0x9c5));return;}const _0x4c48f8=Array[_0x116eba(0xdc0)](_0x2f3af9)[_0x116eba(0xd18)](_0x341063=>_0x341063['dataset'][_0x116eba(0x1409)]);let _0x503fb7=[];_0x4c48f8[_0x116eba(0xd1b)](_0x116eba(0x875))?_0x503fb7[_0x116eba(0x6bb)](_0x116eba(0x10b5)):(_0x4c48f8[_0x116eba(0xd1b)](_0x116eba(0x6d6))&&_0x503fb7['push']('“'+_0x4c8b14[_0x116eba(0x834)][_0x116eba(0xbf3)]+'”'),_0x4c48f8['forEach'](_0x5d8c07=>{const _0x5db13c=_0x116eba,_0x1ff93b=_0x4c8b14[_0x5db13c(0xbea)][_0x5d8c07];_0x1ff93b&&_0x503fb7[_0x5db13c(0x6bb)]('“'+_0x1ff93b[_0x5db13c(0xf3e)]+'”');}));const _0xd98c7a=_0x116eba(0x8ca)+_0x503fb7[_0x116eba(0xee1)]('、\x20')+'\x20的所有动态，且无法恢复！',_0xcb2f12=await _0x56d4d3(_0x116eba(0x8f0),_0xd98c7a,{'confirmButtonClass':_0x116eba(0x142c),'confirmText':_0x116eba(0x213)});if(!_0xcb2f12)return;try{_0x4c48f8[_0x116eba(0xd1b)](_0x116eba(0x875))?await _0x54c587[_0x116eba(0xba7)][_0x116eba(0x82f)]():await _0x54c587[_0x116eba(0xba7)][_0x116eba(0x227)](_0x116eba(0x606))[_0x116eba(0x1666)](_0x4c48f8)[_0x116eba(0x942)](),_0x265b3f=await _0x54c587['qzonePosts'][_0x116eba(0x541)](_0x116eba(0x287))[_0x116eba(0xfc1)]()['toArray'](),_0x295d50=0x0,await _0x335d36(),document[_0x116eba(0x400)](_0x116eba(0x54e))[_0x116eba(0xb08)][_0x116eba(0xc46)](_0x116eba(0x9eb)),await _0x138765(_0x116eba(0x112c),_0x116eba(0x7cb));}catch(_0x52825d){console['error'](_0x116eba(0x148d),_0x52825d),await _0x138765('操作失败','清空动态时发生错误:\x20'+_0x52825d[_0x116eba(0x6e2)]);}}async function _0x51bd22(_0x5de100){const _0x51714d=_0x239c7d,_0x11bdc4=await _0x56d4d3(_0x51714d(0x713),_0x51714d(0x29a),{'confirmButtonClass':_0x51714d(0x142c),'confirmText':_0x51714d(0x713)});if(_0x11bdc4){const _0x41d599=_0x4c8b14[_0x51714d(0xbea)][_0x4c8b14[_0x51714d(0x1539)]];if(!_0x41d599||!_0x41d599[_0x51714d(0x13a1)])return;const _0x235a73=_0x41d599[_0x51714d(0x13a1)][_0x51714d(0x11a4)](_0x519802=>_0x519802[_0x51714d(0x287)]===_0x5de100);if(_0x235a73===-0x1)return;const _0x5893a9=_0x235a73===_0x41d599[_0x51714d(0x13a1)]['length']-0x1;_0x41d599[_0x51714d(0x13a1)]=_0x41d599[_0x51714d(0x13a1)]['filter'](_0x37f6c8=>_0x37f6c8[_0x51714d(0x287)]!==_0x5de100);if(_0x5893a9){if(_0x41d599[_0x51714d(0x13a1)]['length']>0x0){const _0x16d516=_0x41d599[_0x51714d(0x13a1)][_0x41d599[_0x51714d(0x13a1)][_0x51714d(0x8d6)]-0x1];_0x41d599[_0x51714d(0x8ab)]=_0x16d516[_0x51714d(0x8ab)],_0x41d599[_0x51714d(0x13e5)]=_0x16d516[_0x51714d(0x13e5)];const _0x5d7e61=document[_0x51714d(0x400)]('profile-heartfelt-voice'),_0x51509f=document[_0x51714d(0x400)](_0x51714d(0x164e));if(_0x5d7e61)_0x5d7e61[_0x51714d(0xde7)]=_0x41d599[_0x51714d(0x8ab)];if(_0x51509f)_0x51509f[_0x51714d(0xde7)]=_0x41d599[_0x51714d(0x13e5)];console['log'](_0x51714d(0x1374));}else{_0x41d599['heartfeltVoice']=_0x51714d(0x166b),_0x41d599[_0x51714d(0x13e5)]=_0x51714d(0x166b);const _0x421fc8=document[_0x51714d(0x400)]('profile-heartfelt-voice'),_0x236f32=document['getElementById']('profile-random-jottings');if(_0x421fc8)_0x421fc8['textContent']=_0x41d599[_0x51714d(0x8ab)];if(_0x236f32)_0x236f32[_0x51714d(0xde7)]=_0x41d599['randomJottings'];console['log'](_0x51714d(0x1144));}}await _0x54c587[_0x51714d(0xbea)]['put'](_0x41d599),_0x4c5097(),await _0x138765('成功',_0x51714d(0x9ea));}}document[_0x239c7d(0x400)]('thoughts-history-list')[_0x239c7d(0x501)](_0x239c7d(0x15ad),_0x58e070=>{const _0xee14e1=_0x239c7d,_0x49cbf6=_0x58e070[_0xee14e1(0x657)]['closest'](_0xee14e1(0xb67));if(_0x49cbf6){const _0x58e3eb=parseInt(_0x49cbf6[_0xee14e1(0xd61)][_0xee14e1(0x287)]);!isNaN(_0x58e3eb)&&_0x51bd22(_0x58e3eb);}});async function _0x21b2dd(){const _0x1c0031=_0x239c7d,_0x182665=document['getElementById'](_0x1c0031(0x12f8));_0x182665['innerHTML']=_0x1c0031(0x1070);const _0x15eaa6=await _0x54c587[_0x1c0031(0x973)]['where'](_0x1c0031(0xbbf))['equals']('global_css')[_0x1c0031(0xce1)]();_0x15eaa6[_0x1c0031(0xbdc)](_0x14d2a6=>{const _0x4ea629=_0x1c0031,_0x1594a8=document[_0x4ea629(0x2c9)](_0x4ea629(0x1053));_0x1594a8[_0x4ea629(0xa1e)]=_0x14d2a6['id'],_0x1594a8[_0x4ea629(0xde7)]=_0x14d2a6[_0x4ea629(0xf3e)],_0x182665[_0x4ea629(0x8f2)](_0x1594a8);});}async function _0x2db078(){const _0x3a01e1=_0x239c7d,_0x40d7df=document[_0x3a01e1(0x400)](_0x3a01e1(0x12f8)),_0x5d2952=parseInt(_0x40d7df[_0x3a01e1(0xa1e)]);if(isNaN(_0x5d2952))return;const _0x12b331=await _0x54c587[_0x3a01e1(0x973)][_0x3a01e1(0xf48)](_0x5d2952);if(_0x12b331){const _0x27ed91=document[_0x3a01e1(0x400)](_0x3a01e1(0xf42));_0x27ed91[_0x3a01e1(0xa1e)]=_0x12b331[_0x3a01e1(0xa1e)],_0x1d7c68(_0x12b331['value']);}}async function _0x4ad0db(){const _0x4259be=_0x239c7d,_0x5da215=await _0x25f61f(_0x4259be(0x1255),_0x4259be(0x103a));if(!_0x5da215||!_0x5da215[_0x4259be(0xb8f)]())return;const _0x116e0a=document['getElementById'](_0x4259be(0xf42))['value'],_0x6e715d=await _0x54c587[_0x4259be(0x973)]['where']({'name':_0x5da215[_0x4259be(0xb8f)](),'type':_0x4259be(0x1392)})[_0x4259be(0x149c)]();if(_0x6e715d){const _0x561cd8=await _0x56d4d3(_0x4259be(0xfbe),_0x4259be(0x6b7)+_0x5da215[_0x4259be(0xb8f)]()+'”\x20的预设已存在。要覆盖它吗？',{'confirmButtonClass':_0x4259be(0x142c)});if(!_0x561cd8)return;await _0x54c587[_0x4259be(0x973)]['update'](_0x6e715d['id'],{'value':_0x116e0a});}else await _0x54c587[_0x4259be(0x973)][_0x4259be(0x12b6)]({'name':_0x5da215['trim'](),'type':_0x4259be(0x1392),'value':_0x116e0a});await _0x21b2dd(),alert(_0x4259be(0xa32));}async function _0x551ce3(){const _0x4230cf=_0x239c7d,_0x3693f5=document[_0x4230cf(0x400)](_0x4230cf(0x12f8)),_0x193636=parseInt(_0x3693f5[_0x4230cf(0xa1e)]);if(isNaN(_0x193636)){alert(_0x4230cf(0x7f8));return;}const _0x3096d1=await _0x54c587[_0x4230cf(0x973)][_0x4230cf(0xf48)](_0x193636);if(!_0x3096d1)return;const _0x50377e=await _0x56d4d3('删除预设',_0x4230cf(0x152b)+_0x3096d1[_0x4230cf(0xf3e)]+_0x4230cf(0xb38),{'confirmButtonClass':_0x4230cf(0x142c)});_0x50377e&&(await _0x54c587['appearancePresets'][_0x4230cf(0x942)](_0x193636),await _0x21b2dd(),alert(_0x4230cf(0x79a)));}async function _0x572336(){const _0x2bfc57=_0x239c7d,_0x1fca1c=document['getElementById'](_0x2bfc57(0x85a));_0x1fca1c[_0x2bfc57(0x1575)]='<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>';const _0x1871ee=await _0x54c587[_0x2bfc57(0x973)][_0x2bfc57(0x227)]('type')[_0x2bfc57(0x4ce)](_0x2bfc57(0x211))[_0x2bfc57(0xce1)]();_0x1871ee[_0x2bfc57(0xbdc)](_0x4661a4=>{const _0x125f6e=_0x2bfc57,_0x12fcf1=document['createElement'](_0x125f6e(0x1053));_0x12fcf1[_0x125f6e(0xa1e)]=_0x4661a4['id'],_0x12fcf1['textContent']=_0x4661a4['name'],_0x1fca1c[_0x125f6e(0x8f2)](_0x12fcf1);});}async function _0x3cd88e(){const _0x4c323a=_0x239c7d,_0x33c45c=document['getElementById'](_0x4c323a(0x85a)),_0x5186c9=parseInt(_0x33c45c['value']);if(isNaN(_0x5186c9))return;const _0x45c49a=await _0x54c587[_0x4c323a(0x973)]['get'](_0x5186c9);if(_0x45c49a){const _0xb375d9=document[_0x4c323a(0x400)](_0x4c323a(0x55a));_0xb375d9['value']=_0x45c49a['value'],_0x572a63(_0x45c49a['value'],!![]);}}async function _0x3c6afa(){const _0x2e2489=_0x239c7d,_0x556e72=await _0x25f61f('保存字体预设',_0x2e2489(0x103a));if(!_0x556e72||!_0x556e72[_0x2e2489(0xb8f)]())return;const _0x2fb11f=document[_0x2e2489(0x400)]('font-url-input')[_0x2e2489(0xa1e)]['trim']();if(!_0x2fb11f){alert(_0x2e2489(0x623));return;}const _0x1f8cc5=await _0x54c587[_0x2e2489(0x973)]['where']({'name':_0x556e72[_0x2e2489(0xb8f)](),'type':_0x2e2489(0x211)})[_0x2e2489(0x149c)]();if(_0x1f8cc5){const _0xe78400=await _0x56d4d3('覆盖预设',_0x2e2489(0x6b7)+_0x556e72['trim']()+_0x2e2489(0x7a1),{'confirmButtonClass':_0x2e2489(0x142c)});if(!_0xe78400)return;await _0x54c587[_0x2e2489(0x973)]['update'](_0x1f8cc5['id'],{'value':_0x2fb11f});}else await _0x54c587['appearancePresets'][_0x2e2489(0x12b6)]({'name':_0x556e72[_0x2e2489(0xb8f)](),'type':_0x2e2489(0x211),'value':_0x2fb11f});await _0x572336(),alert(_0x2e2489(0x5d0));}async function _0x59bc34(){const _0x425dcd=_0x239c7d,_0xa73c1d=document[_0x425dcd(0x400)](_0x425dcd(0x85a)),_0x116980=parseInt(_0xa73c1d[_0x425dcd(0xa1e)]);if(isNaN(_0x116980)){alert(_0x425dcd(0x7f8));return;}const _0x4d873f=await _0x54c587['appearancePresets']['get'](_0x116980);if(!_0x4d873f)return;const _0x38e8f0=await _0x56d4d3(_0x425dcd(0x632),_0x425dcd(0x152b)+_0x4d873f[_0x425dcd(0xf3e)]+_0x425dcd(0xb38),{'confirmButtonClass':'btn-danger'});_0x38e8f0&&(await _0x54c587['appearancePresets']['delete'](_0x116980),await _0x572336(),alert('预设已删除。'));}async function _0x23006b(){const _0x1e9e0c=_0x239c7d,_0x5782a2=document[_0x1e9e0c(0x400)]('appearance-preset-select');_0x5782a2[_0x1e9e0c(0x1575)]=_0x1e9e0c(0x1070);const _0x41a9ab=await _0x54c587['appearancePresets'][_0x1e9e0c(0x227)](_0x1e9e0c(0xbbf))[_0x1e9e0c(0x4ce)](_0x1e9e0c(0x1323))[_0x1e9e0c(0xce1)]();_0x41a9ab['forEach'](_0x310109=>{const _0x4e061b=_0x1e9e0c,_0x3651d5=document[_0x4e061b(0x2c9)](_0x4e061b(0x1053));_0x3651d5[_0x4e061b(0xa1e)]=_0x310109['id'],_0x3651d5[_0x4e061b(0xde7)]=_0x310109[_0x4e061b(0xf3e)],_0x5782a2[_0x4e061b(0x8f2)](_0x3651d5);});const _0x5f36f2={'wallpaper':_0x4c8b14[_0x1e9e0c(0x14f1)][_0x1e9e0c(0xed6)],'cphoneWallpaper':_0x4c8b14['globalSettings'][_0x1e9e0c(0x67c)],'globalChatBackground':_0x4c8b14[_0x1e9e0c(0x14f1)][_0x1e9e0c(0xf8c)],'appIcons':_0x4c8b14['globalSettings'][_0x1e9e0c(0x10d4)],'cphoneAppIcons':_0x4c8b14[_0x1e9e0c(0x14f1)]['cphoneAppIcons'],'chatActionButtonsOrder':_0x4c8b14[_0x1e9e0c(0x14f1)][_0x1e9e0c(0xd14)],'theme':localStorage[_0x1e9e0c(0xca2)](_0x1e9e0c(0x1401))||_0x1e9e0c(0x3b3),'showStatusBar':_0x4c8b14['globalSettings'][_0x1e9e0c(0x30a)],'notificationSoundUrl':_0x4c8b14[_0x1e9e0c(0x14f1)][_0x1e9e0c(0x3a5)],'widgetData':_0x4c8b14[_0x1e9e0c(0x14f1)][_0x1e9e0c(0xca8)]};let _0x5ab7e2=null;for(const _0x4de8f2 of _0x41a9ab){if(JSON[_0x1e9e0c(0xea5)](_0x4de8f2[_0x1e9e0c(0xa1e)])===JSON[_0x1e9e0c(0xea5)](_0x5f36f2)){_0x5ab7e2=_0x4de8f2['id'];break;}}_0x5ab7e2?_0x5782a2[_0x1e9e0c(0xa1e)]=_0x5ab7e2:_0x5782a2[_0x1e9e0c(0xa1e)]='';}async function _0x51468b(){const _0x2e4357=_0x239c7d,_0xebbf72=document['getElementById'](_0x2e4357(0x144e)),_0x4d5b93=parseInt(_0xebbf72[_0x2e4357(0xa1e)]);if(isNaN(_0x4d5b93))return;const _0x3edb21=await _0x54c587[_0x2e4357(0x973)][_0x2e4357(0xf48)](_0x4d5b93);if(_0x3edb21&&_0x3edb21[_0x2e4357(0xa1e)]){const _0x138f95=_0x3edb21[_0x2e4357(0xa1e)];Object[_0x2e4357(0x697)](_0x4c8b14[_0x2e4357(0x14f1)],_0x138f95),_0x3cf591(_0x138f95[_0x2e4357(0xa33)]||_0x2e4357(0x3b3)),await _0x54c587[_0x2e4357(0x14f1)]['put'](_0x4c8b14[_0x2e4357(0x14f1)]),_0x497a54(),_0x3ed28b(),_0x45f4d0(),_0xc8df8a(),_0x3e4f38(),_0x15f9e9(),_0x364d9f(),alert(_0x2e4357(0x1283)+_0x3edb21[_0x2e4357(0xf3e)]+'”');}}async function _0x219a75(){const _0x2aed15=_0x239c7d,_0x40ce15=await _0x25f61f(_0x2aed15(0x8c4),_0x2aed15(0x103a));if(!_0x40ce15||!_0x40ce15['trim']())return;const _0x2658d9={'wallpaper':_0x4c8b14[_0x2aed15(0x14f1)][_0x2aed15(0xed6)],'cphoneWallpaper':_0x4c8b14[_0x2aed15(0x14f1)][_0x2aed15(0x67c)],'globalChatBackground':_0x4c8b14['globalSettings']['globalChatBackground'],'appIcons':_0x4c8b14['globalSettings'][_0x2aed15(0x10d4)],'cphoneAppIcons':_0x4c8b14[_0x2aed15(0x14f1)][_0x2aed15(0x5d8)],'chatActionButtonsOrder':_0x4c8b14['globalSettings'][_0x2aed15(0xd14)],'theme':localStorage['getItem'](_0x2aed15(0x1401))||_0x2aed15(0x3b3),'showStatusBar':_0x4c8b14[_0x2aed15(0x14f1)][_0x2aed15(0x30a)],'notificationSoundUrl':_0x4c8b14[_0x2aed15(0x14f1)][_0x2aed15(0x3a5)],'widgetData':_0x4c8b14[_0x2aed15(0x14f1)][_0x2aed15(0xca8)]},_0x9d6c8f=await _0x54c587[_0x2aed15(0x973)][_0x2aed15(0x227)]({'name':_0x40ce15[_0x2aed15(0xb8f)](),'type':'appearance'})[_0x2aed15(0x149c)]();if(_0x9d6c8f){const _0x509cbf=await _0x56d4d3(_0x2aed15(0xfbe),_0x2aed15(0x6b7)+_0x40ce15[_0x2aed15(0xb8f)]()+'”\x20的预设已存在。要覆盖它吗？',{'confirmButtonClass':'btn-danger'});if(!_0x509cbf)return;await _0x54c587[_0x2aed15(0x973)][_0x2aed15(0x126d)](_0x9d6c8f['id'],{'value':_0x2658d9});}else await _0x54c587['appearancePresets'][_0x2aed15(0x12b6)]({'name':_0x40ce15['trim'](),'type':'appearance','value':_0x2658d9});await _0x23006b(),alert('外观预设已保存！');}async function _0x556c45(){const _0x487d56=_0x239c7d,_0x37b8ba=document['getElementById'](_0x487d56(0x144e)),_0x53d1d9=parseInt(_0x37b8ba[_0x487d56(0xa1e)]);if(isNaN(_0x53d1d9)){alert(_0x487d56(0x7f8));return;}const _0x3470fe=await _0x54c587['appearancePresets']['get'](_0x53d1d9);if(!_0x3470fe)return;const _0x443c85=await _0x56d4d3(_0x487d56(0x632),'确定要删除预设\x20“'+_0x3470fe[_0x487d56(0xf3e)]+'”\x20吗？',{'confirmButtonClass':_0x487d56(0x142c)});_0x443c85&&(await _0x54c587[_0x487d56(0x973)][_0x487d56(0x942)](_0x53d1d9),await _0x23006b(),alert(_0x487d56(0x79a)));}async function _0x1f9f8e(){const _0x9a99a=_0x239c7d,_0x5f5633=document[_0x9a99a(0x400)]('theme-preset-select');_0x5f5633[_0x9a99a(0x1575)]='<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>';const _0x374f6a=await _0x54c587[_0x9a99a(0x973)][_0x9a99a(0x227)](_0x9a99a(0xbbf))[_0x9a99a(0x4ce)](_0x9a99a(0xea8))[_0x9a99a(0xce1)]();_0x374f6a[_0x9a99a(0xbdc)](_0x309200=>{const _0x5194b8=_0x9a99a,_0x5367a4=document[_0x5194b8(0x2c9)](_0x5194b8(0x1053));_0x5367a4[_0x5194b8(0xa1e)]=_0x309200['id'],_0x5367a4[_0x5194b8(0xde7)]=_0x309200[_0x5194b8(0xf3e)],_0x5f5633[_0x5194b8(0x8f2)](_0x5367a4);});}async function _0x146e74(){const _0x3e756e=_0x239c7d,_0x3428d9=document[_0x3e756e(0x400)]('theme-preset-select'),_0x36f757=parseInt(_0x3428d9['value']);if(isNaN(_0x36f757))return;const _0x484911=await _0x54c587[_0x3e756e(0x973)]['get'](_0x36f757);if(_0x484911){const _0x556913=_0x484911['value'][_0x3e756e(0x1586)]||'default',_0x3c22ff=_0x484911['value'][_0x3e756e(0x7da)]||'',_0x5d55df=document[_0x3e756e(0x13ef)](_0x3e756e(0xf35)+_0x556913+'\x22]');_0x5d55df&&(_0x5d55df[_0x3e756e(0x6f9)]=!![]);const _0x4b7833=document['getElementById'](_0x3e756e(0x4ed));_0x4b7833[_0x3e756e(0xa1e)]=_0x3c22ff,_0x290380();}}async function _0x3b67d3(){const _0x1f1d23=_0x239c7d,_0x82e5f9=await _0x25f61f(_0x1f1d23(0x126b),_0x1f1d23(0x103a));if(!_0x82e5f9||!_0x82e5f9[_0x1f1d23(0xb8f)]())return;const _0x374ebe=document['querySelector'](_0x1f1d23(0xafe)),_0x5c93b5=_0x374ebe?_0x374ebe[_0x1f1d23(0xa1e)]:_0x1f1d23(0x855),_0x3fb3f4=document['getElementById'](_0x1f1d23(0x4ed))[_0x1f1d23(0xa1e)]['trim'](),_0x4482cf={'base':_0x5c93b5,'custom':_0x3fb3f4},_0x4e02de=await _0x54c587['appearancePresets']['where']({'name':_0x82e5f9[_0x1f1d23(0xb8f)](),'type':_0x1f1d23(0xea8)})[_0x1f1d23(0x149c)]();if(_0x4e02de){const _0x21bcca=await _0x56d4d3(_0x1f1d23(0xfbe),_0x1f1d23(0x6b7)+_0x82e5f9[_0x1f1d23(0xb8f)]()+_0x1f1d23(0x7a1),{'confirmButtonClass':'btn-danger'});if(!_0x21bcca)return;await _0x54c587[_0x1f1d23(0x973)][_0x1f1d23(0x126d)](_0x4e02de['id'],{'value':_0x4482cf});}else await _0x54c587[_0x1f1d23(0x973)][_0x1f1d23(0x12b6)]({'name':_0x82e5f9[_0x1f1d23(0xb8f)](),'type':_0x1f1d23(0xea8),'value':_0x4482cf});await _0x1f9f8e(),alert(_0x1f1d23(0x972));}async function _0x3e8be8(){const _0x1b8c24=_0x239c7d,_0x25285d=document['getElementById'](_0x1b8c24(0xc69)),_0x48c2ea=parseInt(_0x25285d['value']);if(isNaN(_0x48c2ea)){alert('请先从下拉框中选择一个要删除的预设。');return;}const _0x217ad1=await _0x54c587[_0x1b8c24(0x973)][_0x1b8c24(0xf48)](_0x48c2ea);if(!_0x217ad1)return;const _0x4fff45=await _0x56d4d3('删除预设',_0x1b8c24(0x152b)+_0x217ad1['name']+'”\x20吗？',{'confirmButtonClass':_0x1b8c24(0x142c)});_0x4fff45&&(await _0x54c587[_0x1b8c24(0x973)]['delete'](_0x48c2ea),await _0x1f9f8e(),alert('预设已删除。'));}async function _0x876743(){const _0x2b3dd7=_0x239c7d;await _0x1f97cf(),document[_0x2b3dd7(0x400)](_0x2b3dd7(0xbb4))[_0x2b3dd7(0xb08)][_0x2b3dd7(0x12b6)](_0x2b3dd7(0x9eb));}async function _0x1f97cf(){const _0x561176=_0x239c7d,_0x113265=document[_0x561176(0x400)](_0x561176(0x117c)),_0xa800a6=await _0x54c587[_0x561176(0xf00)][_0x561176(0xce1)]();_0x113265[_0x561176(0x1575)]='';if(_0xa800a6['length']===0x0){_0x113265[_0x561176(0x1575)]='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>';return;}_0xa800a6['forEach'](_0x4391c3=>{const _0x269044=_0x561176,_0x102f10=document['createElement']('div');_0x102f10[_0x269044(0x4e1)]=_0x269044(0xf94),_0x102f10[_0x269044(0x1575)]=_0x269044(0x5e7)+_0x4391c3['name']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0x4391c3['id']+_0x269044(0x3ee),_0x113265[_0x269044(0x8f2)](_0x102f10);});}async function _0x7df942(){const _0x1cb065=_0x239c7d,_0x4e5bb9=document[_0x1cb065(0x400)]('new-sticker-category-name-input'),_0x153356=_0x4e5bb9['value'][_0x1cb065(0xb8f)]();if(!_0x153356){alert(_0x1cb065(0x403));return;}const _0x5f5965=await _0x54c587[_0x1cb065(0xf00)]['where'](_0x1cb065(0xf3e))[_0x1cb065(0x4ce)](_0x153356)[_0x1cb065(0x149c)]();if(_0x5f5965){alert(_0x1cb065(0x673)+_0x153356+'\x22\x20已经存在了！');return;}await _0x54c587['stickerCategories'][_0x1cb065(0x12b6)]({'name':_0x153356}),_0x4e5bb9['value']='',await _0x1f97cf();}async function _0x3b7f4f(_0x3d320c){const _0x35b6dd=_0x239c7d,_0x58e44=await _0x54c587['stickerCategories'][_0x35b6dd(0xf48)](_0x3d320c);if(!_0x58e44)return;const _0x2e5725=await _0x54c587[_0x35b6dd(0x120c)][_0x35b6dd(0x227)](_0x35b6dd(0x12c4))['equals'](_0x3d320c)[_0x35b6dd(0xcbc)](),_0x346de4=_0x2e5725>0x0?_0x35b6dd(0xed8)+_0x58e44[_0x35b6dd(0xf3e)]+'》吗？\x0a\x0a【警告】\x0a此操作将同时永久删除该分类下的\x20'+_0x2e5725+_0x35b6dd(0x132d):_0x35b6dd(0xed8)+_0x58e44['name']+_0x35b6dd(0xc11),_0x4e6d0a=await _0x56d4d3(_0x35b6dd(0xba2),_0x346de4,{'confirmButtonClass':_0x35b6dd(0x142c)});if(_0x4e6d0a)try{await _0x54c587[_0x35b6dd(0xfec)]('rw',_0x54c587[_0x35b6dd(0xf00)],_0x54c587['userStickers'],async()=>{const _0x4ff71f=_0x35b6dd,_0x12bf7a=await _0x54c587[_0x4ff71f(0x120c)][_0x4ff71f(0x227)](_0x4ff71f(0x12c4))[_0x4ff71f(0x4ce)](_0x3d320c)[_0x4ff71f(0xb0f)]();_0x12bf7a[_0x4ff71f(0x8d6)]>0x0&&await _0x54c587['userStickers'][_0x4ff71f(0x2c6)](_0x12bf7a),await _0x54c587[_0x4ff71f(0xf00)][_0x4ff71f(0x942)](_0x3d320c);}),_0x4c8b14[_0x35b6dd(0x120c)]=await _0x54c587[_0x35b6dd(0x120c)][_0x35b6dd(0xce1)](),_0xc6535b===_0x3d320c&&(_0xc6535b=_0x35b6dd(0x875)),await _0x1f97cf(),await _0x11d8fe(),alert(_0x35b6dd(0xd5e)+_0x58e44[_0x35b6dd(0xf3e)]+_0x35b6dd(0x1120));}catch(_0x4468f5){console[_0x35b6dd(0x5d7)](_0x35b6dd(0x1544),_0x4468f5),alert(_0x35b6dd(0x8a1));}}function _0x1630a4(_0x9dbb90){const _0x2504a6=_0x239c7d;_0xc6535b=_0x9dbb90,document[_0x2504a6(0x527)]('.sticker-category-tab')[_0x2504a6(0xbdc)](_0x4528b0=>{const _0x336325=_0x2504a6;_0x4528b0['classList'][_0x336325(0x146f)]('active',String(_0x4528b0[_0x336325(0xd61)][_0x336325(0x12c4)])===String(_0x9dbb90));}),_0x11d8fe(![]);const _0x5a993f=document[_0x2504a6(0x400)](_0x2504a6(0x10fc));if(_0x5a993f)_0x5a993f[_0x2504a6(0x6f9)]=![];}async function _0x49db39(){const _0xf24299=_0x239c7d;if(!_0x4c8b14[_0xf24299(0x1539)])return;const _0x3095d1=_0x4c8b14[_0xf24299(0xbea)][_0x4c8b14['activeChatId']];if(!_0x3095d1)return;try{const _0x2d03c4={'type':'EPhoneSingleChat','version':0x1,'chatData':_0x3095d1},_0x236a7e=new Blob([JSON[_0xf24299(0xea5)](_0x2d03c4,null,0x2)],{'type':_0xf24299(0xfae)}),_0x1875a7=URL[_0xf24299(0xc2c)](_0x236a7e),_0x1c43a9=document[_0xf24299(0x2c9)]('a');_0x1c43a9[_0xf24299(0xcf5)]=_0x1875a7,_0x1c43a9[_0xf24299(0xcda)]=_0xf24299(0x773)+_0x3095d1[_0xf24299(0xf3e)]+'-'+new Date()[_0xf24299(0x886)]()[_0xf24299(0x5ad)]('T')[0x0]+_0xf24299(0xbfb),_0x1c43a9['click'](),URL['revokeObjectURL'](_0x1875a7),await _0x138765(_0xf24299(0x6ca),'与“'+_0x3095d1[_0xf24299(0xf3e)]+_0xf24299(0x4d4));}catch(_0x191446){console['error'](_0xf24299(0x1496),_0x191446),await _0x138765(_0xf24299(0x13be),_0xf24299(0xef2)+_0x191446[_0xf24299(0x6e2)]);}}async function _0x50438d(_0x1f5a09){const _0x1a5f3b=_0x239c7d;if(!_0x1f5a09||!_0x4c8b14['activeChatId'])return;const _0xa3c627=_0x4c8b14[_0x1a5f3b(0x1539)],_0x437b93=_0x4c8b14[_0x1a5f3b(0xbea)][_0xa3c627];try{const _0x269615=await _0x1f5a09[_0x1a5f3b(0x117f)](),_0x2b77c3=JSON['parse'](_0x269615);if(_0x2b77c3[_0x1a5f3b(0xbbf)]!==_0x1a5f3b(0x560)||!_0x2b77c3[_0x1a5f3b(0x116e)])throw new Error(_0x1a5f3b(0xb97));const _0x3cf5f6=await _0x56d4d3(_0x1a5f3b(0x65a),_0x1a5f3b(0x717)+_0x437b93[_0x1a5f3b(0xf3e)]+_0x1a5f3b(0x129f),{'confirmButtonClass':_0x1a5f3b(0x142c),'confirmText':_0x1a5f3b(0x50c)});if(!_0x3cf5f6)return;const _0xd61323=_0x2b77c3[_0x1a5f3b(0x116e)];_0xd61323['id']=_0xa3c627,await _0x54c587[_0x1a5f3b(0xbea)][_0x1a5f3b(0x4cb)](_0xd61323),_0x4c8b14['chats'][_0xa3c627]=_0xd61323,await _0x138765(_0x1a5f3b(0xa88),_0x1a5f3b(0x1548)),_0x26354c(_0xa3c627),_0x41b828(),document[_0x1a5f3b(0x400)]('chat-settings-btn')['click']();}catch(_0x3485eb){console[_0x1a5f3b(0x5d7)](_0x1a5f3b(0x11f2),_0x3485eb),await _0x138765(_0x1a5f3b(0x3e8),_0x1a5f3b(0xad8)+_0x3485eb[_0x1a5f3b(0x6e2)]);}}function _0x2dc47e(){const _0x5d841e=_0x239c7d;_0x524e69(),_0x257d51(_0x5d841e(0xbda));}function _0x524e69(){const _0x2f1de8=_0x239c7d,_0xdc73c=document[_0x2f1de8(0x400)](_0x2f1de8(0xd9a));_0xdc73c[_0x2f1de8(0x1575)]='';const _0x4e98a7=Object[_0x2f1de8(0x40a)](_0x4c8b14[_0x2f1de8(0xbea)])['filter'](_0x282bc1=>!_0x282bc1[_0x2f1de8(0xc98)]);if(_0x4e98a7[_0x2f1de8(0x8d6)]===0x0){_0xdc73c[_0x2f1de8(0x1575)]=_0x2f1de8(0x11c7);return;}_0x4e98a7[_0x2f1de8(0xbdc)](_0x559ea6=>{const _0x3ddf92=_0x2f1de8,_0x2b3171=document[_0x3ddf92(0x2c9)](_0x3ddf92(0xf8e));_0x2b3171[_0x3ddf92(0x4e1)]=_0x3ddf92(0x4aa),_0x2b3171[_0x3ddf92(0x1575)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x559ea6['settings'][_0x3ddf92(0xb24)]||_0x91d058)+_0x3ddf92(0x302)+_0x559ea6[_0x3ddf92(0xf3e)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x2b3171[_0x3ddf92(0x501)](_0x3ddf92(0x15ad),()=>_0x2c64bf(_0x559ea6['id'])),_0xdc73c[_0x3ddf92(0x8f2)](_0x2b3171);});}async function _0x2c64bf(_0x505e02){const _0x4b9860=_0x239c7d;_0x7e1e9=_0x505e02,console[_0x4b9860(0x1e6)](_0x4b9860(0xe1d)+_0x505e02+_0x4b9860(0x127d)),_0x3ed28b(),_0xc8df8a(),_0x567380(),_0x257d51('character-phone-screen');}function _0x10b4f7(){const _0x363bb2=_0x239c7d;_0x7e1e9=null,console[_0x363bb2(0x1e6)](_0x363bb2(0xd1d)),_0x257d51('home-screen');}function _0x567380(){const _0x369db6=_0x239c7d,_0x102ee9=new Date(),_0x23291e=_0x102ee9['toLocaleTimeString'](_0x369db6(0x1271),{'hour':'2-digit','minute':_0x369db6(0x9f5)}),_0x4cedef=_0x102ee9[_0x369db6(0x1100)]('zh-CN',{'weekday':'long','month':_0x369db6(0x1638),'day':'numeric'});document[_0x369db6(0x400)]('char-main-time')['textContent']=_0x23291e,document['getElementById'](_0x369db6(0x105a))[_0x369db6(0xde7)]=_0x4cedef,_0x2b7df1('char-home-screen');}function _0x2b7df1(_0x438b06){const _0x65e0d3=_0x239c7d;document[_0x65e0d3(0x527)](_0x65e0d3(0x1101))[_0x65e0d3(0xbdc)](_0x348922=>_0x348922['classList'][_0x65e0d3(0xc46)](_0x65e0d3(0x5d6))),document['getElementById'](_0x438b06)[_0x65e0d3(0xb08)]['add'](_0x65e0d3(0x5d6));}window[_0x239c7d(0xa0a)]=_0x2b7df1;async function _0x4efee7(_0x4b9b86){const _0xfd2f76=_0x239c7d;if(!_0x7e1e9)return;const _0x2e947c=_0x4c8b14[_0xfd2f76(0xbea)][_0x7e1e9];await _0x1ad142(_0x7e1e9,_0x4b9b86);switch(_0x4b9b86){case'qq':_0x1356de(),_0x2b7df1(_0xfd2f76(0xbec));break;case'album':_0x55124a(),_0x2b7df1(_0xfd2f76(0x6a2));break;case'browser':_0x1827a0(),_0x2b7df1('char-browser-screen');break;case _0xfd2f76(0x1ec):_0x5e8024(),_0x2b7df1(_0xfd2f76(0xa21));break;case _0xfd2f76(0x47e):_0x4d9adb(),_0x2b7df1(_0xfd2f76(0x163c));break;case _0xfd2f76(0x82a):_0x253bb5(),_0x2b7df1(_0xfd2f76(0x1337));break;case _0xfd2f76(0x167d):_0x54cdd0(),_0x2b7df1(_0xfd2f76(0x1244));break;case _0xfd2f76(0x215):_0x236877(),_0x2b7df1(_0xfd2f76(0x247));break;case _0xfd2f76(0xc5d):_0x49dc6e(),_0x2b7df1(_0xfd2f76(0xcb3));break;}}async function _0x55124a(){const _0x2af18f=_0x239c7d,_0x455c26=document[_0x2af18f(0x400)](_0x2af18f(0x1692));_0x455c26[_0x2af18f(0x1575)]='';if(!_0x7e1e9)return;const _0x22a558=_0x4c8b14['chats'][_0x7e1e9],_0x17843e=_0x22a558['simulatedAlbum']||[];if(_0x17843e['length']===0x0){_0x455c26[_0x2af18f(0x1575)]=_0x2af18f(0x15dc);return;}const _0x55ef09='https://i.postimg.cc/KYr2qRCK/1.jpg';_0x17843e[_0x2af18f(0xbdc)](_0x3ec415=>{const _0x54970f=_0x2af18f,_0x447752=document[_0x54970f(0x2c9)]('div');_0x447752[_0x54970f(0x4e1)]='char-photo-item',_0x447752['dataset']['description']=_0x3ec415['description'],_0x455c26[_0x54970f(0x8f2)](_0x447752);if(_0x4c8b14[_0x54970f(0x14f1)][_0x54970f(0x7b5)]){_0x447752[_0x54970f(0xa00)][_0x54970f(0x1296)]=_0x54970f(0x9e9);const _0x521e07=/[^\x00-\x7F]/[_0x54970f(0x2c0)](_0x3ec415[_0x54970f(0xff9)]),_0x18c169=_0x3ec415['image_prompt']&&_0x3ec415[_0x54970f(0xff9)][_0x54970f(0xb8f)]()&&!_0x521e07,_0x281fed=_0x18c169?_0x3ec415['image_prompt']:_0x54970f(0x1163),_0x1e64a1='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x281fed),_0x3a7795=new Image();_0x3a7795[_0x54970f(0x9e0)]=function(){const _0xd33c04=_0x54970f;_0x447752[_0xd33c04(0xa00)][_0xd33c04(0xf11)]=_0xd33c04(0xe21)+this[_0xd33c04(0x912)]+')';},_0x3a7795[_0x54970f(0x96d)]=function(){const _0x7af81e=_0x54970f;_0x447752[_0x7af81e(0xa00)][_0x7af81e(0xf11)]='url('+_0x55ef09+')';},_0x3a7795[_0x54970f(0x912)]=_0x1e64a1;}else{_0x447752['style']['backgroundColor']=_0x54970f(0x126f),_0x447752[_0x54970f(0xa00)][_0x54970f(0xefb)]=_0x54970f(0xa05);const _0x3d5e89=document['createElement']('p');_0x3d5e89[_0x54970f(0x4e1)]=_0x54970f(0xfb0),_0x3d5e89[_0x54970f(0xde7)]=_0x3ec415[_0x54970f(0x12a5)]||_0x54970f(0xefa),_0x447752[_0x54970f(0x8f2)](_0x3d5e89);}});}function _0x1827a0(){const _0x13eacb=_0x239c7d,_0xdd5465=document['getElementById']('char-browser-history');_0xdd5465[_0x13eacb(0x1575)]='';if(!_0x7e1e9)return;const _0x26110e=_0x4c8b14[_0x13eacb(0xbea)][_0x7e1e9],_0x16c6aa=[_0x26110e['name'],'爱好','旅游','美食','新闻',..._0x26110e[_0x13eacb(0xa37)][_0x13eacb(0xfea)][_0x13eacb(0x5ad)](/，|。|\s/)[_0x13eacb(0x69f)](0x0,0x5)],_0x1ae999=['知乎',_0x13eacb(0x816),_0x13eacb(0x1387),'微博',_0x13eacb(0x539)];for(let _0x4c5453=0x0;_0x4c5453<0xf;_0x4c5453++){const _0x301c84=_0x16c6aa[Math[_0x13eacb(0x1381)](Math[_0x13eacb(0x12bc)]()*_0x16c6aa[_0x13eacb(0x8d6)])],_0xa985c7=_0x1ae999[Math[_0x13eacb(0x1381)](Math[_0x13eacb(0x12bc)]()*_0x1ae999[_0x13eacb(0x8d6)])],_0xc3f0d3=document[_0x13eacb(0x2c9)](_0x13eacb(0xf8e));_0xc3f0d3[_0x13eacb(0x4e1)]='char-browser-item',_0xc3f0d3[_0x13eacb(0x1575)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x301c84+_0x13eacb(0x1477)+_0xa985c7+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>www.'+_0xa985c7[_0x13eacb(0x1653)]()+'.com/'+_0x301c84+_0x13eacb(0x14f0),_0xdd5465['appendChild'](_0xc3f0d3);}}function _0x5e8024(){const _0x420ec9=_0x239c7d,_0x4b600f=document[_0x420ec9(0x400)]('char-product-grid');_0x4b600f[_0x420ec9(0x1575)]='';if(!_0x7e1e9)return;const _0x1d0f56=_0x4c8b14['chats'][_0x7e1e9],_0x146600=_0x1d0f56[_0x420ec9(0x47b)]?.[_0x420ec9(0x9a0)]||[];if(_0x146600[_0x420ec9(0x8d6)]===0x0){_0x4b600f['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA最近好像什么都没买呢，<br>点击右上角刷新按钮生成一些记录吧！</p>';return;}_0x146600['forEach'](_0x2f768f=>{const _0x4736f3=_0x420ec9,_0x47f21a=document[_0x4736f3(0x2c9)](_0x4736f3(0xf8e));_0x47f21a[_0x4736f3(0x4e1)]=_0x4736f3(0x13d9),_0x47f21a['dataset'][_0x4736f3(0x383)]=_0x2f768f[_0x4736f3(0x383)];let _0x456cc9;if(_0x4c8b14[_0x4736f3(0x14f1)][_0x4736f3(0x7b5)]){const _0x2bcba2='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x2f768f[_0x4736f3(0xff9)]||_0x4736f3(0x265));_0x456cc9=_0x4736f3(0x97d)+_0x2bcba2+_0x4736f3(0xb6b);}else _0x456cc9=_0x4736f3(0xe72)+(_0x2f768f[_0x4736f3(0x383)]||_0x4736f3(0x11fc))+_0x4736f3(0x119a);_0x47f21a[_0x4736f3(0x1575)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x456cc9+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>'+_0x2f768f[_0x4736f3(0xe37)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20margin-top:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>'+(_0x2f768f[_0x4736f3(0x34a)]||0x0)[_0x4736f3(0x2ea)](0x2)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-status\x22>'+_0x2f768f[_0x4736f3(0x12c3)]+_0x4736f3(0x10ed),_0x4b600f[_0x4736f3(0x8f2)](_0x47f21a);});}function _0x182e3e(){const _0x16701e=_0x239c7d;_0x2b7df1(_0x16701e(0x131c));}function _0x760647(){const _0x587557=_0x239c7d,_0x506e7b=document[_0x587557(0x400)]('char-chat-list');_0x506e7b[_0x587557(0x1575)]='';if(!_0x7e1e9)return;const _0x4b09f9=Object[_0x587557(0x40a)](_0x4c8b14[_0x587557(0xbea)])[_0x587557(0x29d)](_0x1b2e49=>{const _0x45e423=_0x587557;if(_0x1b2e49['id']===_0x7e1e9)return!![];if(_0x1b2e49[_0x45e423(0xc98)]&&_0x1b2e49[_0x45e423(0x4f8)][_0x45e423(0x1412)](_0xcfc652=>_0xcfc652['id']===_0x7e1e9))return!![];return![];});_0x4b09f9[_0x587557(0xbdc)](_0x576554=>{const _0x41f08d=_0x587557,_0x4902a9=_0x431050(_0x576554);_0x506e7b[_0x41f08d(0x8f2)](_0x4902a9);});}async function _0x1ad142(_0x455517,_0x492df9){const _0x2565e1=_0x239c7d,_0x472401=_0x4c8b14[_0x2565e1(0xbea)][_0x455517];if(!_0x472401)return;!_0x472401[_0x2565e1(0x11db)]&&(_0x472401['appUsageLog']=[]),_0x472401[_0x2565e1(0x11db)][_0x2565e1(0x6bb)]({'appName':_0x492df9,'timestamp':Date['now']()}),_0x472401[_0x2565e1(0x11db)]['length']>0x32&&_0x472401[_0x2565e1(0x11db)][_0x2565e1(0x10cc)](),await _0x54c587[_0x2565e1(0xbea)][_0x2565e1(0x4cb)](_0x472401);}function _0x49dc6e(){const _0x3f5a3c=_0x239c7d,_0xa767a=document['getElementById'](_0x3f5a3c(0x51f));_0xa767a['innerHTML']='';const _0x136854=_0x4c8b14[_0x3f5a3c(0xbea)][_0x7e1e9],_0x47c4df=(_0x136854['appUsageLog']||[])['slice']()[_0x3f5a3c(0xfc1)]();if(_0x47c4df[_0x3f5a3c(0x8d6)]===0x0){_0xa767a['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有任何使用记录。</p>';return;}const _0x5cfd33={'qq':'QQ','album':'相册','browser':'浏览器','taobao':'淘宝','memo':_0x3f5a3c(0x130d),'diary':'日记','amap':_0x3f5a3c(0xe59),'usage':_0x3f5a3c(0x3f4)};_0x47c4df[_0x3f5a3c(0xbdc)](_0x23bd7f=>{const _0x7ae5f3=_0x3f5a3c,_0x365330=document['createElement'](_0x7ae5f3(0xf8e));_0x365330['className']=_0x7ae5f3(0x995),_0x365330['innerHTML']=_0x7ae5f3(0x13a6)+new Date(_0x23bd7f['timestamp'])[_0x7ae5f3(0xad4)]()+_0x7ae5f3(0x1386)+(_0x5cfd33[_0x23bd7f['appName']]||_0x23bd7f[_0x7ae5f3(0xc77)])+'</strong></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0xa767a[_0x7ae5f3(0x8f2)](_0x365330);});}async function _0x187f1a(_0x539be4){const _0x4f9b8c=_0x239c7d,_0x3898e7=_0x4c8b14[_0x4f9b8c(0xbea)][_0x7e1e9];if(!_0x3898e7)return;const _0x4d4aab={'role':_0x4f9b8c(0x4fd),'senderName':_0x3898e7[_0x4f9b8c(0xdcf)],'type':_0x4f9b8c(0xdeb),'content':_0x539be4,'imageUrl':_0x4f9b8c(0x432),'timestamp':Date[_0x4f9b8c(0xecd)]()};_0x3898e7[_0x4f9b8c(0x92c)][_0x4f9b8c(0x6bb)](_0x4d4aab),await _0x54c587[_0x4f9b8c(0xbea)][_0x4f9b8c(0x4cb)](_0x3898e7),_0x4c8b14[_0x4f9b8c(0x1539)]===_0x7e1e9&&_0x41ecc7(_0x4d4aab,_0x3898e7),await _0x138765(_0x4f9b8c(0x14bb),'“'+_0x3898e7['name']+'”\x20的位置已发送到你们的聊天中。');}async function _0x51541d(_0x177e3c){const _0x8a4cda=_0x239c7d,_0x82e9d1=_0x4c8b14[_0x8a4cda(0xbea)][_0x7e1e9];if(!_0x82e9d1||!_0x82e9d1[_0x8a4cda(0x421)])return;const _0x6bad97=_0x82e9d1[_0x8a4cda(0x421)][_0x8a4cda(0x821)](_0x54d57a=>_0x54d57a['id']===_0x177e3c);if(_0x6bad97){_0x5bb0b3=_0x6bad97;const _0x3797af=document[_0x8a4cda(0x400)](_0x8a4cda(0x98a)),_0x3ecfe2=document[_0x8a4cda(0x400)](_0x8a4cda(0x1129)),_0x364481=document[_0x8a4cda(0x400)]('favorite-memo-btn');if(_0x3797af)_0x3797af[_0x8a4cda(0xde7)]=_0x6bad97[_0x8a4cda(0x647)];if(_0x3ecfe2)_0x3ecfe2['value']=_0x6bad97[_0x8a4cda(0x1109)];const _0x5c66e7=await _0x54c587[_0x8a4cda(0x69c)]['where']({'type':'char_memo','content.id':_0x177e3c})['first']();_0x364481[_0x8a4cda(0xb08)][_0x8a4cda(0x146f)](_0x8a4cda(0x5d6),!!_0x5c66e7),_0x2b7df1(_0x8a4cda(0xac1));}}function _0x4d9adb(){const _0x3a1d05=_0x239c7d,_0x464b0b=document[_0x3a1d05(0x400)](_0x3a1d05(0x127c));_0x464b0b['innerHTML']='';const _0xacfffe=_0x4c8b14[_0x3a1d05(0xbea)][_0x7e1e9],_0x2e24a2=(_0xacfffe['memos']||[])['slice']()['reverse']();if(_0x2e24a2[_0x3a1d05(0x8d6)]===0x0){_0x464b0b[_0x3a1d05(0x1575)]=_0x3a1d05(0x763);return;}_0x2e24a2[_0x3a1d05(0xbdc)](_0x511c77=>{const _0x45c93c=_0x3a1d05,_0x24fb84=document[_0x45c93c(0x2c9)](_0x45c93c(0xf8e));_0x24fb84[_0x45c93c(0x4e1)]=_0x45c93c(0x7ef),_0x24fb84[_0x45c93c(0x1575)]=_0x45c93c(0x109b)+_0x511c77[_0x45c93c(0x647)]+_0x45c93c(0x78d)+(_0x511c77[_0x45c93c(0x1109)]||'')[_0x45c93c(0x5ad)]('\x0a')[0x0]+_0x45c93c(0x14f0),_0x24fb84[_0x45c93c(0x501)](_0x45c93c(0x15ad),()=>_0x51541d(_0x511c77['id'])),_0x3d4218(_0x24fb84,()=>deleteMemo(_0x511c77['id'])),_0x464b0b['appendChild'](_0x24fb84);});}async function _0x50cecc(_0x246abd=null){const _0xeed416=_0x239c7d;_0xb37258=null;const _0x3a591e=await _0x25f61f(_0xeed416(0x13d6),_0xeed416(0xc2d));if(_0x3a591e===null||!_0x3a591e[_0xeed416(0xb8f)]())return;const _0x323214=await _0x25f61f(_0xeed416(0x133d)+_0x3a591e,_0xeed416(0x117e),'',_0xeed416(0x79e));_0x323214!==null&&(await _0x2e45da({'title':_0x3a591e[_0xeed416(0xb8f)](),'content':_0x323214}),_0x2b7df1(_0xeed416(0x163c)));}async function _0x2e45da(_0x4ea00f){const _0x2100d7=_0x239c7d,_0x153874=_0x4c8b14[_0x2100d7(0xbea)][_0x7e1e9];if(!_0x153874[_0x2100d7(0x421)])_0x153874['memos']=[];_0x153874[_0x2100d7(0x421)]['push']({'id':Date[_0x2100d7(0xecd)](),'title':_0x4ea00f[_0x2100d7(0x647)],'content':_0x4ea00f['content']}),await _0x54c587[_0x2100d7(0xbea)][_0x2100d7(0x4cb)](_0x153874),_0x4d9adb();}async function _0x2e45da(_0x3f4748){const _0x2f2254=_0x239c7d,_0x41c64f=_0x4c8b14[_0x2f2254(0xbea)][_0x7e1e9];if(!_0x41c64f['memos'])_0x41c64f['memos']=[];if(_0xb37258){const _0x20403b=_0x41c64f[_0x2f2254(0x421)][_0x2f2254(0x821)](_0x584e66=>_0x584e66['id']===_0xb37258);if(_0x20403b)_0x20403b[_0x2f2254(0x1109)]=_0x3f4748;}else _0x41c64f[_0x2f2254(0x421)][_0x2f2254(0x6bb)]({'id':Date[_0x2f2254(0xecd)](),'content':_0x3f4748});await _0x54c587[_0x2f2254(0xbea)]['put'](_0x41c64f),_0x4d9adb(),_0xb37258=null;}async function _0x3b0e81(){const _0x5099eb=_0x239c7d;if(!_0x7e1e9)return;const _0x5edf1b=_0x4c8b14[_0x5099eb(0xbea)][_0x7e1e9];if(!_0x5edf1b)return;await _0x138765(_0x5099eb(0x13e9),'正在请求“'+_0x5edf1b[_0x5099eb(0xf3e)]+'”翻开TA的日记本...');const {proxyUrl:_0x22a98a,apiKey:_0x169a5a,model:_0x846e44}=_0x4c8b14[_0x5099eb(0x814)];if(!_0x22a98a||!_0x169a5a||!_0x846e44){alert('请先在API设置中配置好API信息。');return;}const _0x55395e=_0x4c8b14['qzoneSettings'][_0x5099eb(0xbf3)]===_0x5099eb(0xa8f)||!_0x4c8b14['qzoneSettings'][_0x5099eb(0xbf3)]?'用户':_0x4c8b14[_0x5099eb(0x834)][_0x5099eb(0xbf3)],_0x334b03=_0x5edf1b['longTermMemory']&&_0x5edf1b[_0x5099eb(0x1600)][_0x5099eb(0x8d6)]>0x0?_0x5edf1b[_0x5099eb(0x1600)]['map'](_0xe3fcef=>_0x5099eb(0x1ee)+_0x4878ba(_0xe3fcef[_0x5099eb(0x287)])+')\x20'+_0xe3fcef[_0x5099eb(0x1109)])[_0x5099eb(0xee1)]('\x0a'):'无',_0x12e2bb=_0x5edf1b[_0x5099eb(0xa37)][_0x5099eb(0xebb)]||0xa,_0x31bcc3=_0x5edf1b[_0x5099eb(0x92c)][_0x5099eb(0x69f)](-_0x12e2bb),_0x3944ea=await _0x25ac7a(_0x31bcc3,_0x7e1e9),_0x5266fe=_0x3944ea[_0x5099eb(0xd18)](_0x45ca6a=>(_0x45ca6a['role']===_0x5099eb(0x6d6)?_0x55395e:_0x5edf1b['name'])+':\x20'+String(_0x45ca6a['content'])[_0x5099eb(0x371)](0x0,0x1e)+_0x5099eb(0x166b))[_0x5099eb(0xee1)]('\x0a'),_0x25b245=(_0x5edf1b[_0x5099eb(0xa37)]['linkedWorldBookIds']||[])['map'](_0xed8af=>_0x4c8b14['worldBooks'][_0x5099eb(0x821)](_0x416932=>_0x416932['id']===_0xed8af))[_0x5099eb(0x29d)](Boolean)['map'](_0xe24d72=>_0x5099eb(0x1606)+_0xe24d72[_0x5099eb(0xf3e)]+_0x5099eb(0x1150)+_0xe24d72[_0x5099eb(0x1109)][_0x5099eb(0x29d)](_0x218120=>_0x218120[_0x5099eb(0x250)])[_0x5099eb(0xd18)](_0x4b69d8=>'-\x20'+_0x4b69d8[_0x5099eb(0x1109)])[_0x5099eb(0xee1)]('\x0a'))[_0x5099eb(0xee1)](''),_0x4166d4=_0x3eed43(_0x5edf1b,0x3,_0x5099eb(0xf20)),_0x4864dc=_0x3eed43(_0x5edf1b,0x6,_0x5099eb(0xf20)),_0x2aab48=_0x3eed43(_0x5edf1b,0x9,'hours'),_0x483473=_0x3eed43(_0x5edf1b,0x1,_0x5099eb(0x72c)),_0x25b880=_0x3eed43(_0x5edf1b,0x3,_0x5099eb(0x72c)),_0x27cf94=_0x3eed43(_0x5edf1b,0x7,'days');let _0x269738='';if(_0x4166d4||_0x4864dc||_0x2aab48||_0x483473||_0x25b880||_0x27cf94){_0x269738+=_0x5099eb(0x116b);if(_0x4166d4)_0x269738+=_0x4166d4;if(_0x4864dc)_0x269738+=_0x4864dc;if(_0x2aab48)_0x269738+=_0x2aab48;if(_0x4166d4||_0x4864dc||_0x2aab48)_0x269738+='\x0a';if(_0x483473)_0x269738+=_0x483473;if(_0x25b880)_0x269738+=_0x25b880;if(_0x27cf94)_0x269738+=_0x27cf94;}const _0x521b55=_0x5edf1b[_0x5099eb(0xa37)][_0x5099eb(0x2ef)]||'(未设置)',_0x57f590=_0x5099eb(0x1590)+_0x5edf1b[_0x5099eb(0xf3e)]+'”，并根据其人设、记忆和最近的互动，虚构出【5到8篇】TA最近可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**'+new Date()[_0x5099eb(0x1100)](_0x5099eb(0x1271))+_0x5099eb(0x14d8)+_0x55395e+_0x5099eb(0xf61)+_0x5edf1b['settings']['aiPersona']+_0x5099eb(0x12cd)+_0x521b55+_0x5099eb(0x11f1)+_0x334b03+'\x0a'+_0x25b245+'\x0a'+_0x269738+_0x5099eb(0x81a)+_0x55395e+_0x5099eb(0xeee)+_0x5266fe+_0x5099eb(0xf68);try{const _0x3f4b6a=[{'role':'user','content':_0x5099eb(0xd87)}];let _0xb8befe=_0x22a98a[_0x5099eb(0xd1b)](_0x5099eb(0x14cc)),_0x3a4d81=_0x3914a6(_0x846e44,_0x169a5a,_0x57f590,_0x3f4b6a);const _0x16f42f=_0xb8befe?await fetch(_0x3a4d81['url'],_0x3a4d81['data']):await fetch(_0x22a98a+_0x5099eb(0x1611),{'method':_0x5099eb(0x953),'headers':{'Content-Type':_0x5099eb(0xfae),'Authorization':'Bearer\x20'+_0x169a5a},'body':JSON[_0x5099eb(0xea5)]({'model':_0x846e44,'messages':[{'role':'system','content':_0x57f590},..._0x3f4b6a],'temperature':_0x4c8b14[_0x5099eb(0x14f1)][_0x5099eb(0x216)]||0.95})});if(!_0x16f42f['ok'])throw new Error(_0x5099eb(0x7d5)+_0x16f42f[_0x5099eb(0x755)]);const _0x4cc1bd=await _0x16f42f[_0x5099eb(0x15d3)](),_0x43688a=getGeminiResponseText(_0x4cc1bd),_0x35261e=_0x43688a[_0x5099eb(0xbf7)](/(\[[\s\S]*\])/);if(!_0x35261e||!_0x35261e[0x0])throw new Error(_0x5099eb(0x131e)+_0x43688a);const _0x3f198d=_0x35261e[0x0];let _0x29d02d;try{_0x29d02d=JSON[_0x5099eb(0x13f7)](_0x3f198d);}catch(_0x31877d){throw new Error('解析AI返回的JSON时出错:\x20'+_0x31877d['message']+_0x5099eb(0xc72)+_0x43688a);}_0x5edf1b[_0x5099eb(0x82a)]=_0x29d02d[_0x5099eb(0xd18)](_0xb09167=>({'id':Date[_0x5099eb(0xecd)]()+Math[_0x5099eb(0x12bc)](),'title':_0xb09167['title'],'content':_0xb09167[_0x5099eb(0x1109)],'timestamp':Date['now']()})),await _0x54c587[_0x5099eb(0xbea)][_0x5099eb(0x4cb)](_0x5edf1b),await _0x253bb5();}catch(_0x22d6d9){console[_0x5099eb(0x5d7)]('生成模拟日记失败:',_0x22d6d9),await _0x138765(_0x5099eb(0x321),_0x5099eb(0x1497)+_0x22d6d9[_0x5099eb(0x6e2)]);}}async function _0x29e27a(){const _0x58032d=_0x239c7d;if(!_0x7e1e9)return;const _0x3ec8a4=_0x4c8b14[_0x58032d(0xbea)][_0x7e1e9];if(!_0x3ec8a4)return;await _0x138765(_0x58032d(0x13e9),_0x58032d(0xbd5)+_0x3ec8a4[_0x58032d(0xf3e)]+'”写一篇新日记...');const {proxyUrl:_0x53b40b,apiKey:_0x296c9d,model:_0x3d9273}=_0x4c8b14[_0x58032d(0x814)];if(!_0x53b40b||!_0x296c9d||!_0x3d9273)return;const _0x37f3d9=_0x4c8b14['qzoneSettings'][_0x58032d(0xbf3)]===_0x58032d(0xa8f)||!_0x4c8b14[_0x58032d(0x834)][_0x58032d(0xbf3)]?'用户':_0x4c8b14[_0x58032d(0x834)][_0x58032d(0xbf3)],_0x1f3106=_0x3ec8a4['longTermMemory']&&_0x3ec8a4['longTermMemory'][_0x58032d(0x8d6)]>0x0?_0x3ec8a4[_0x58032d(0x1600)][_0x58032d(0xd18)](_0xeeb90e=>_0x58032d(0x1ee)+_0x4878ba(_0xeeb90e[_0x58032d(0x287)])+')\x20'+_0xeeb90e[_0x58032d(0x1109)])[_0x58032d(0xee1)]('\x0a'):'无',_0x47e2f8=_0x3ec8a4['settings'][_0x58032d(0xebb)]||0xa,_0x4cf4fc=_0x3ec8a4[_0x58032d(0x92c)][_0x58032d(0x69f)](-_0x47e2f8),_0x25a3f5=await _0x25ac7a(_0x4cf4fc,_0x7e1e9),_0xf1ffeb=_0x25a3f5[_0x58032d(0xd18)](_0x265c13=>(_0x265c13[_0x58032d(0x71a)]===_0x58032d(0x6d6)?_0x37f3d9:_0x3ec8a4[_0x58032d(0xf3e)])+':\x20'+String(_0x265c13[_0x58032d(0x1109)])['substring'](0x0,0x1e)+'...')[_0x58032d(0xee1)]('\x0a'),_0x3638ac=(_0x3ec8a4[_0x58032d(0xa37)][_0x58032d(0xb0d)]||[])[_0x58032d(0xd18)](_0x54f166=>_0x4c8b14[_0x58032d(0xf57)][_0x58032d(0x821)](_0x52b110=>_0x52b110['id']===_0x54f166))[_0x58032d(0x29d)](Boolean)['map'](_0x5295c3=>_0x58032d(0x1606)+_0x5295c3[_0x58032d(0xf3e)]+_0x58032d(0x1150)+_0x5295c3['content']['filter'](_0x23cd42=>_0x23cd42[_0x58032d(0x250)])[_0x58032d(0xd18)](_0x23841c=>'-\x20'+_0x23841c[_0x58032d(0x1109)])[_0x58032d(0xee1)]('\x0a'))[_0x58032d(0xee1)](''),_0x494df5=_0x58032d(0xae5)+_0x3ec8a4[_0x58032d(0xf3e)]+_0x58032d(0xfed)+new Date()[_0x58032d(0x1100)]('zh-CN')+_0x58032d(0xfaf)+_0x3ec8a4['settings'][_0x58032d(0xfea)]+_0x58032d(0x11f1)+_0x1f3106+'\x0a'+_0x3638ac+'\x0a-\x20**你最近和“'+_0x37f3d9+'”的对话摘要**:\x0a'+_0xf1ffeb+'\x0a\x0a现在，请开始撰写这篇充满真情实感、并熟练运用了Markdown语法的日记。';try{const _0x377245=[{'role':'user','content':'请根据你的设定，写一篇新日记。'}];let _0xa89b7e=_0x53b40b['includes'](_0x58032d(0x14cc)),_0x2b1ce0=_0x3914a6(_0x3d9273,_0x296c9d,_0x494df5,_0x377245);const _0xe86828=_0xa89b7e?await fetch(_0x2b1ce0[_0x58032d(0x299)],_0x2b1ce0[_0x58032d(0x55b)]):await fetch(_0x53b40b+_0x58032d(0x1611),{'method':'POST','headers':{'Content-Type':_0x58032d(0xfae),'Authorization':_0x58032d(0xcee)+_0x296c9d},'body':JSON[_0x58032d(0xea5)]({'model':_0x3d9273,'messages':[{'role':_0x58032d(0xaf6),'content':_0x494df5},..._0x377245],'temperature':_0x4c8b14['globalSettings']['apiTemperature']||0.95})});if(!_0xe86828['ok'])throw new Error(_0x58032d(0x7d5)+_0xe86828[_0x58032d(0x755)]);const _0x1d9f2c=await _0xe86828[_0x58032d(0x15d3)](),_0x42a713=getGeminiResponseText(_0x1d9f2c),_0x536a1b=_0x42a713[_0x58032d(0xbf7)](/(\[[\s\S]*\])/);if(!_0x536a1b||!_0x536a1b[0x0])throw new Error(_0x58032d(0x131e)+_0x42a713);const _0x243cd8=_0x536a1b[0x0];let _0x4556c6;try{_0x4556c6=JSON[_0x58032d(0x13f7)](_0x243cd8)[0x0];}catch(_0x13a2b6){throw new Error('解析AI返回的JSON时出错:\x20'+_0x13a2b6[_0x58032d(0x6e2)]+_0x58032d(0xc72)+_0x42a713);}if(!_0x3ec8a4['diary'])_0x3ec8a4[_0x58032d(0x82a)]=[];_0x3ec8a4[_0x58032d(0x82a)][_0x58032d(0x6bb)]({'id':Date['now'](),'title':_0x4556c6['title'],'content':_0x4556c6[_0x58032d(0x1109)],'timestamp':Date[_0x58032d(0xecd)]()}),await _0x54c587['chats'][_0x58032d(0x4cb)](_0x3ec8a4),await _0x253bb5();}catch(_0x5d328e){console[_0x58032d(0x5d7)]('生成新日记失败:',_0x5d328e),await _0x138765('生成失败',_0x58032d(0x906)+_0x5d328e[_0x58032d(0x6e2)]);}}function _0x253bb5(){const _0x5daa7d=_0x239c7d,_0x21904d=document[_0x5daa7d(0x400)](_0x5daa7d(0x892));_0x21904d[_0x5daa7d(0x1575)]='';const _0x151f29=_0x4c8b14[_0x5daa7d(0xbea)][_0x7e1e9],_0x79ab52=(_0x151f29['diary']||[])[_0x5daa7d(0x69f)]()[_0x5daa7d(0xfc1)]();if(_0x79ab52[_0x5daa7d(0x8d6)]===0x0){_0x21904d[_0x5daa7d(0x1575)]=_0x5daa7d(0x93d);return;}_0x79ab52[_0x5daa7d(0xbdc)](_0x5e71d3=>{const _0x59a08c=_0x5daa7d,_0x8683fa=document[_0x59a08c(0x2c9)](_0x59a08c(0xf8e));_0x8683fa[_0x59a08c(0x4e1)]=_0x59a08c(0x7ef),_0x8683fa[_0x59a08c(0x1575)]=_0x59a08c(0x10ec)+_0x5e71d3[_0x59a08c(0x647)]+_0x59a08c(0x454)+new Date(_0x5e71d3[_0x59a08c(0x287)])[_0x59a08c(0x1100)]()+_0x59a08c(0x1132),_0x8683fa[_0x59a08c(0x501)]('click',()=>_0x41521f(_0x5e71d3['id'])),_0x3d4218(_0x8683fa,()=>_0x45b9ef(_0x5e71d3['id'])),_0x21904d[_0x59a08c(0x8f2)](_0x8683fa);});}async function _0x41521f(_0x403a42){const _0x57f309=_0x239c7d,_0x532dbd=_0x4c8b14[_0x57f309(0xbea)][_0x7e1e9];if(!_0x532dbd||!_0x532dbd['diary'])return;const _0x822561=_0x532dbd[_0x57f309(0x82a)][_0x57f309(0x821)](_0x3c555c=>_0x3c555c['id']===_0x403a42);if(_0x822561){_0x3662fd=_0x822561;const _0x5c5062=document[_0x57f309(0x400)](_0x57f309(0x3cd)),_0x424fe3=document[_0x57f309(0x400)](_0x57f309(0x8e1)),_0x5e6b48=document[_0x57f309(0x400)](_0x57f309(0x74f));_0x5c5062[_0x57f309(0xde7)]=_0x822561[_0x57f309(0x647)];const _0x1aca54=_0x412ec9(_0x822561[_0x57f309(0x1109)])['split']('\x0a')[_0x57f309(0xd18)](_0x126ec7=>_0x57f309(0xbb7)+(_0x126ec7||'&nbsp;')+'</p>')['join']('');_0x424fe3['innerHTML']=_0x1aca54;const _0x4dad56=await _0x54c587[_0x57f309(0x69c)][_0x57f309(0x227)]({'type':'char_diary','content.id':_0x403a42})['first']();_0x5e6b48[_0x57f309(0xb08)][_0x57f309(0x146f)](_0x57f309(0x5d6),!!_0x4dad56),_0x2b7df1(_0x57f309(0x94f));}}async function _0x3af5b7(){const _0x45fe4a=_0x239c7d;if(!_0x3662fd||!_0x7e1e9)return;const _0x1ed345=_0x3662fd,_0x2d4782=_0x4c8b14['chats'][_0x7e1e9],_0x1e559c=document['getElementById'](_0x45fe4a(0x74f)),_0x604ef0=await _0x54c587[_0x45fe4a(0x69c)]['where']({'type':_0x45fe4a(0x42e),'content.id':_0x1ed345['id']})['first']();if(_0x604ef0)await _0x54c587[_0x45fe4a(0x69c)][_0x45fe4a(0x942)](_0x604ef0['id']),_0x1e559c[_0x45fe4a(0xb08)][_0x45fe4a(0xc46)](_0x45fe4a(0x5d6)),await _0x138765(_0x45fe4a(0x112c),'已取消收藏。');else{const _0x1fb12d={'type':'char_diary','content':{'id':_0x1ed345['id'],'title':_0x1ed345[_0x45fe4a(0x647)],'content':_0x1ed345[_0x45fe4a(0x1109)],'timestamp':_0x1ed345[_0x45fe4a(0x287)],'characterId':_0x7e1e9,'characterName':_0x2d4782[_0x45fe4a(0xf3e)]},'timestamp':Date[_0x45fe4a(0xecd)]()};await _0x54c587[_0x45fe4a(0x69c)][_0x45fe4a(0x12b6)](_0x1fb12d),_0x1e559c['classList']['add'](_0x45fe4a(0x5d6)),await _0x138765(_0x45fe4a(0x112c),'已成功收藏到“我的收藏”页面！');}}async function _0x18474b(){const _0x2510e0=_0x239c7d;if(!_0x5bb0b3||!_0x7e1e9)return;const _0x3e113b=_0x5bb0b3,_0x43485c=_0x4c8b14[_0x2510e0(0xbea)][_0x7e1e9],_0x2e01e8=document[_0x2510e0(0x400)]('favorite-memo-btn'),_0x3fa314=await _0x54c587['favorites'][_0x2510e0(0x227)]({'type':_0x2510e0(0xbcb),'content.id':_0x3e113b['id']})[_0x2510e0(0x149c)]();if(_0x3fa314)await _0x54c587[_0x2510e0(0x69c)][_0x2510e0(0x942)](_0x3fa314['id']),_0x2e01e8[_0x2510e0(0xb08)][_0x2510e0(0xc46)](_0x2510e0(0x5d6)),await _0x138765(_0x2510e0(0x112c),_0x2510e0(0x1056));else{const _0x5c21ee={'type':'char_memo','content':{'id':_0x3e113b['id'],'title':_0x3e113b[_0x2510e0(0x647)],'content':_0x3e113b['content'],'timestamp':_0x3e113b[_0x2510e0(0x287)],'characterId':_0x7e1e9,'characterName':_0x43485c[_0x2510e0(0xf3e)]},'timestamp':Date[_0x2510e0(0xecd)]()};await _0x54c587['favorites'][_0x2510e0(0x12b6)](_0x5c21ee),_0x2e01e8[_0x2510e0(0xb08)]['add'](_0x2510e0(0x5d6)),await _0x138765(_0x2510e0(0x112c),_0x2510e0(0x526));}}async function _0x45b9ef(_0x456d21){const _0x3e3cf4=_0x239c7d,_0x4efca5=await _0x56d4d3(_0x3e3cf4(0x1378),_0x3e3cf4(0x3d9),{'confirmButtonClass':_0x3e3cf4(0x142c)});if(_0x4efca5){const _0x29465a=_0x4c8b14[_0x3e3cf4(0xbea)][_0x7e1e9];_0x29465a[_0x3e3cf4(0x82a)]=_0x29465a[_0x3e3cf4(0x82a)][_0x3e3cf4(0x29d)](_0x34c851=>_0x34c851['id']!==_0x456d21),await _0x54c587['chats'][_0x3e3cf4(0x4cb)](_0x29465a),_0x253bb5();}}async function _0x1356de(){const _0x408390=_0x239c7d,_0x55d8f6=document['getElementById'](_0x408390(0x15c5));_0x55d8f6['innerHTML']='';const _0x126152=_0x4c8b14[_0x408390(0xbea)][_0x7e1e9];if(!_0x126152)return;const _0x2d0560=_0x126152[_0x408390(0xa37)]['myNickname']||(_0x4c8b14['qzoneSettings'][_0x408390(0xbf3)]||'我'),_0x403b7e=_0x126152[_0x408390(0x92c)][_0x408390(0x29d)](_0x19358a=>!_0x19358a[_0x408390(0x118c)])[_0x408390(0x69f)](-0x1)[0x0]||{'content':_0x408390(0x166b)};let _0x1e36ae=_0x408390(0x166b);if(_0x403b7e){if(typeof _0x403b7e[_0x408390(0x1109)]===_0x408390(0x158f))_0x1e36ae=_0x403b7e[_0x408390(0x1109)];else{if(Array[_0x408390(0x16a1)](_0x403b7e[_0x408390(0x1109)])&&_0x403b7e[_0x408390(0x1109)][0x0]?.[_0x408390(0xbbf)]===_0x408390(0x164d))_0x1e36ae=_0x408390(0x5d3);else{if(_0x403b7e['type']){const _0x39b50f={'voice_message':_0x408390(0xe09),'transfer':_0x408390(0xf92),'ai_image':_0x408390(0x5d3)};_0x1e36ae=_0x39b50f[_0x403b7e[_0x408390(0xbbf)]]||'['+_0x403b7e[_0x408390(0xbbf)]+']';}}}}const _0x4b7e1b=_0x126152[_0x408390(0xa37)][_0x408390(0x12d3)]||_0x91d058,_0x28e0e7=_0x126152[_0x408390(0xa37)][_0x408390(0x11f7)]||'';let _0x4ce5a4;_0x28e0e7?_0x4ce5a4=_0x408390(0x84a)+_0x4b7e1b+'\x22\x20class=\x22avatar-img\x22\x20style=\x22border-radius:\x2050%;\x22><img\x20src=\x22'+_0x28e0e7+'\x22\x20class=\x22avatar-frame\x22></div></div>':_0x4ce5a4=_0x408390(0x7de)+_0x4b7e1b+'\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x20width:\x2045px;\x20height:\x2045px;\x22></div>';const _0xfbe95a=document['createElement'](_0x408390(0xf8e));_0xfbe95a[_0x408390(0x4e1)]=_0x408390(0xc19),_0xfbe95a[_0x408390(0xd61)][_0x408390(0xfa4)]='-1',_0xfbe95a[_0x408390(0x1575)]=_0x408390(0xf5a)+_0x4ce5a4+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x2d0560+_0x408390(0x14da)+String(_0x1e36ae)['substring'](0x0,0x14)+'...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x55d8f6[_0x408390(0x8f2)](_0xfbe95a);const _0x4e681b=await _0x54c587['npcs'][_0x408390(0xce1)](),_0x78fafb=new Map(_0x4e681b[_0x408390(0xd18)](_0x5e6bd6=>[_0x5e6bd6[_0x408390(0xf3e)],_0x5e6bd6])),_0x16ceee=_0x126152[_0x408390(0x1294)]||[];if(_0x16ceee[_0x408390(0x8d6)]===0x0&&!_0xfbe95a){_0x55d8f6['innerHTML']=_0x408390(0x11ae);return;}_0x16ceee[_0x408390(0xbdc)]((_0x4f08a8,_0xd8ebf1)=>{const _0xcb95ca=_0x408390;if(_0x4f08a8[_0xcb95ca(0xbbf)]===_0xcb95ca(0x9b2))return;const _0x3e2585=document[_0xcb95ca(0x2c9)](_0xcb95ca(0xf8e));_0x3e2585[_0xcb95ca(0x4e1)]=_0xcb95ca(0xc19),_0x3e2585[_0xcb95ca(0xd61)][_0xcb95ca(0xfa4)]=_0xd8ebf1;let _0x425650,_0x163dc5,_0x1a7afd;if(_0x4f08a8['type']===_0xcb95ca(0x1377)){_0x1a7afd=_0x4f08a8[_0xcb95ca(0x121e)]+'\x20<span\x20class=\x22group-tag\x22>群</span>',_0x425650=_0x4f08a8['messages'][_0xcb95ca(0x69f)](-0x1)[0x0]||{'content':_0xcb95ca(0x166b)};const _0x447bf2=_0xcb95ca(0x11ea)+_0x4f08a8['groupName']+'\x27',_0x575047=_0x4c8b14[_0xcb95ca(0x14f1)][_0xcb95ca(0x7b5)]?'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x447bf2):_0x4713e3;_0x163dc5=_0xcb95ca(0xd6c)+_0x575047+_0xcb95ca(0x2bb);}else{_0x1a7afd=_0x4f08a8[_0xcb95ca(0x12f4)]['name'],_0x425650=_0x4f08a8['messages']['slice'](-0x1)[0x0]||{'content':_0xcb95ca(0x166b)};const _0x5db926=_0x78fafb[_0xcb95ca(0xf48)](_0x1a7afd);let _0x1f95ca=_0x5db926&&_0x5db926[_0xcb95ca(0xa9a)]?_0x5db926['avatar']:_0x4c8b14[_0xcb95ca(0x14f1)][_0xcb95ca(0x7b5)]?_0xcb95ca(0x9c3)+encodeURIComponent(_0x4f08a8[_0xcb95ca(0x12f4)][_0xcb95ca(0x370)]||_0xcb95ca(0x5f9)):_0x1e2f0a;_0x163dc5=_0xcb95ca(0xd6c)+_0x1f95ca+_0xcb95ca(0x2bb);}let _0x5288ec=_0xcb95ca(0x166b);_0x425650&&_0x425650[_0xcb95ca(0x1109)]&&(_0x5288ec=_0x425650[_0xcb95ca(0x1109)]),_0x3e2585[_0xcb95ca(0x1575)]=_0xcb95ca(0xc43)+_0x163dc5+_0xcb95ca(0x82e)+_0x1a7afd+_0xcb95ca(0xeef)+String(_0x5288ec)['substring'](0x0,0x14)+_0xcb95ca(0x86d),_0x55d8f6['appendChild'](_0x3e2585);});}async function _0x1a67c9(){const _0xff1100=_0x239c7d;if(!_0x7e1e9)return;const _0x622e6=_0x4c8b14[_0xff1100(0xbea)][_0x7e1e9];if(!_0x622e6)return;await _0x138765('请稍候...','正在根据“'+_0x622e6[_0xff1100(0xf3e)]+_0xff1100(0xf70));const {proxyUrl:_0xc948a5,apiKey:_0xfe7f37,model:_0x4f907f}=_0x4c8b14[_0xff1100(0x814)];if(!_0xc948a5||!_0xfe7f37||!_0x4f907f){alert('请先在API设置中配置好API信息。');return;}const _0x493158=await _0x54c587[_0xff1100(0xf9b)][_0xff1100(0xce1)](),_0x303e09=_0x493158[_0xff1100(0x29d)](_0x338999=>_0x338999[_0xff1100(0xc04)]&&_0x338999['associatedWith'][_0xff1100(0xd1b)](_0x7e1e9));let _0x2bad3f='#\x20你的社交圈\x20(绑定的NPC)\x0a';_0x303e09[_0xff1100(0x8d6)]>0x0?(_0x2bad3f+=_0xff1100(0x489),_0x303e09['forEach'](_0x5f17cc=>{const _0x40ae1a=_0xff1100;_0x2bad3f+='-\x20**姓名**:\x20'+_0x5f17cc[_0x40ae1a(0xf3e)]+_0x40ae1a(0x106a)+_0x5f17cc[_0x40ae1a(0x9a2)]+'\x0a';})):_0x2bad3f+=_0xff1100(0x1535);const _0x19f17a=_0x4c8b14[_0xff1100(0x834)][_0xff1100(0xbf3)]===_0xff1100(0xa8f)||!_0x4c8b14[_0xff1100(0x834)][_0xff1100(0xbf3)]?'用户':_0x4c8b14['qzoneSettings']['nickname'],_0x38b98b=_0x622e6['settings']['myNickname']||_0x19f17a,_0x1b6ea0=_0x622e6[_0xff1100(0x1600)]&&_0x622e6[_0xff1100(0x1600)][_0xff1100(0x8d6)]>0x0?_0x622e6['longTermMemory'][_0xff1100(0xd18)](_0x55aef6=>'-\x20(记录于\x20'+_0x4878ba(_0x55aef6['timestamp'])+')\x20'+_0x55aef6[_0xff1100(0x1109)])['join']('\x0a'):'无',_0x26cbe3=_0x622e6[_0xff1100(0xa37)]['maxMemory']||0xa,_0x2fcc85=_0x622e6[_0xff1100(0x92c)][_0xff1100(0x69f)](-_0x26cbe3),_0x27f756=await _0x25ac7a(_0x2fcc85,_0x7e1e9),_0x58bb6c=_0x27f756[_0xff1100(0xd18)](_0x371b11=>(_0x371b11[_0xff1100(0x71a)]==='user'?_0x38b98b:_0x622e6[_0xff1100(0xf3e)])+':\x20'+String(_0x371b11[_0xff1100(0x1109)])[_0xff1100(0x371)](0x0,0x1e)+_0xff1100(0x166b))[_0xff1100(0xee1)]('\x0a'),_0x528e8f=(_0x622e6[_0xff1100(0xa37)]['linkedWorldBookIds']||[])['map'](_0x51f81e=>_0x4c8b14['worldBooks'][_0xff1100(0x821)](_0x4a9289=>_0x4a9289['id']===_0x51f81e))[_0xff1100(0x29d)](Boolean)['map'](_0xfa9636=>_0xff1100(0x1606)+_0xfa9636[_0xff1100(0xf3e)]+_0xff1100(0x1127)+_0xfa9636[_0xff1100(0x1109)][_0xff1100(0x29d)](_0x3789b7=>_0x3789b7['enabled'])[_0xff1100(0xd18)](_0x535feb=>'-\x20'+_0x535feb[_0xff1100(0x1109)])[_0xff1100(0xee1)]('\x0a'))['join'](''),_0x194c4b=_0x622e6[_0xff1100(0xdcf)]||_0x622e6[_0xff1100(0xf3e)],_0x3fad3=_0x5798f0(_0x622e6),_0xbcf394=_0xff1100(0x1197)+_0x622e6[_0xff1100(0xf3e)]+_0xff1100(0x624)+_0x194c4b+_0xff1100(0x2f5)+_0x194c4b+_0xff1100(0xc35)+_0x194c4b+_0xff1100(0x706)+_0x622e6[_0xff1100(0xa37)]['aiPersona']+_0xff1100(0x6d2)+_0x1b6ea0+_0xff1100(0x1388)+_0x528e8f+'\x0a-\x20**最近与用户的互动**:\x20'+_0x58bb6c+'\x0a'+_0x2bad3f+_0xff1100(0x913)+_0x3fad3+_0xff1100(0x13f3);try{const _0x4a8745=[{'role':'user','content':_0xff1100(0x988)}];let _0x4ac80c=_0xc948a5[_0xff1100(0xd1b)]('generativelanguage'),_0x1964f6=_0x3914a6(_0x4f907f,_0xfe7f37,_0xbcf394,_0x4a8745);const _0x206f39=_0x4ac80c?await fetch(_0x1964f6[_0xff1100(0x299)],_0x1964f6[_0xff1100(0x55b)]):await fetch(_0xc948a5+_0xff1100(0x1611),{'method':_0xff1100(0x953),'headers':{'Content-Type':'application/json','Authorization':_0xff1100(0xcee)+_0xfe7f37},'body':JSON['stringify']({'model':_0x4f907f,'messages':[{'role':'system','content':_0xbcf394},..._0x4a8745],'temperature':_0x4c8b14[_0xff1100(0x14f1)][_0xff1100(0x216)]||0.9})});if(!_0x206f39['ok'])throw new Error(_0xff1100(0x7d5)+_0x206f39[_0xff1100(0x755)]);const _0xa04e44=await _0x206f39[_0xff1100(0x15d3)](),_0x4b78f9=getGeminiResponseText(_0xa04e44),_0x3c47b4=_0x4b78f9[_0xff1100(0xbf7)](/(\[[\s\S]*\])/);if(!_0x3c47b4||!_0x3c47b4[0x0])throw new Error(_0xff1100(0x131e)+_0x4b78f9);const _0x534e62=_0x3c47b4[0x0];let _0x2cc22d;try{_0x2cc22d=JSON[_0xff1100(0x13f7)](_0x534e62);}catch(_0x5028e6){throw new Error(_0xff1100(0x7d7)+_0x5028e6[_0xff1100(0x6e2)]+_0xff1100(0xc72)+_0x4b78f9);}_0x622e6[_0xff1100(0x1294)]=_0x2cc22d,await _0x54c587[_0xff1100(0xbea)][_0xff1100(0x4cb)](_0x622e6),await _0x1356de();const _0x111190={'role':_0xff1100(0xaf6),'content':_0xff1100(0xfe8),'timestamp':Date[_0xff1100(0xecd)](),'isHidden':!![]};_0x622e6['history'][_0xff1100(0x6bb)](_0x111190),await _0x54c587[_0xff1100(0xbea)][_0xff1100(0x4cb)](_0x622e6),_0x58df1c();}catch(_0x31697f){console[_0xff1100(0x5d7)](_0xff1100(0xcb7),_0x31697f),await _0x138765(_0xff1100(0x321),_0xff1100(0x15d2)+_0x31697f['message']);}}async function _0x952304(){const _0x57febd=_0x239c7d;if(!_0x7e1e9)return;const _0x5cd7d7=_0x4c8b14[_0x57febd(0xbea)][_0x7e1e9];if(!_0x5cd7d7)return;try{const {proxyUrl:_0xa5a479,apiKey:_0x990176,model:_0x243473}=_0x4c8b14[_0x57febd(0x814)];if(!_0xa5a479||!_0x990176||!_0x243473)throw new Error(_0x57febd(0x291));const _0x4264fb=parseInt(_0x5cd7d7[_0x57febd(0xa37)][_0x57febd(0xebb)])||0xa,_0x2d535f=_0x5cd7d7[_0x57febd(0x92c)]['slice'](-_0x4264fb),_0x35efaa=await _0x25ac7a(_0x2d535f,_0x7e1e9),_0x586fd9=_0x5cd7d7[_0x57febd(0xa37)][_0x57febd(0x14a8)]||'我',_0x1eda0a=_0x5cd7d7[_0x57febd(0xa37)]['myPersona']||'用户',_0x406feb='#\x20长期记忆\x20(必须严格遵守)\x0a'+(_0x5cd7d7[_0x57febd(0x1600)]&&_0x5cd7d7[_0x57febd(0x1600)][_0x57febd(0x8d6)]>0x0?_0x5cd7d7[_0x57febd(0x1600)][_0x57febd(0xd18)](_0x45bbe1=>'-\x20'+_0x45bbe1['content'])[_0x57febd(0xee1)]('\x0a'):_0x57febd(0x4d1));let _0x537987='';if(_0x5cd7d7[_0x57febd(0xa37)][_0x57febd(0xb0d)]&&_0x5cd7d7[_0x57febd(0xa37)][_0x57febd(0xb0d)][_0x57febd(0x8d6)]>0x0){const _0xfb2989=_0x5cd7d7[_0x57febd(0xa37)][_0x57febd(0xb0d)][_0x57febd(0xd18)](_0x36c12c=>{const _0x28d15d=_0x57febd,_0x1b231f=_0x4c8b14[_0x28d15d(0xf57)][_0x28d15d(0x821)](_0x31f129=>_0x31f129['id']===_0x36c12c);if(!_0x1b231f||!Array[_0x28d15d(0x16a1)](_0x1b231f[_0x28d15d(0x1109)]))return'';const _0x28930f=_0x1b231f[_0x28d15d(0x1109)][_0x28d15d(0x29d)](_0x1908a2=>_0x1908a2[_0x28d15d(0x250)]!==![])[_0x28d15d(0xd18)](_0x419dd4=>'\x0a###\x20条目:\x20'+(_0x419dd4[_0x28d15d(0x83c)]||'无备注')+_0x28d15d(0x902)+_0x419dd4['content'])[_0x28d15d(0xee1)]('');return _0x28930f?_0x28d15d(0xd75)+_0x1b231f['name']+'\x0a'+_0x28930f:'';})[_0x57febd(0x29d)](Boolean)[_0x57febd(0xee1)]('');_0xfb2989&&(_0x537987='\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a'+_0xfb2989+'\x0a');}const _0x541ea2=_0x3eed43(_0x5cd7d7,0x3,_0x57febd(0xf20)),_0x309ef7=_0x3eed43(_0x5cd7d7,0x6,_0x57febd(0xf20)),_0x347952=_0x3eed43(_0x5cd7d7,0x9,_0x57febd(0xf20)),_0x209c1f=_0x3eed43(_0x5cd7d7,0x1,_0x57febd(0x72c)),_0xe1b410=_0x3eed43(_0x5cd7d7,0x3,_0x57febd(0x72c)),_0x34eb14=_0x3eed43(_0x5cd7d7,0x7,_0x57febd(0x72c));let _0x4cede8='';if(_0x541ea2||_0x309ef7||_0x347952||_0x209c1f||_0xe1b410||_0x34eb14){_0x4cede8+=_0x57febd(0x116b);if(_0x541ea2)_0x4cede8+=_0x541ea2;if(_0x309ef7)_0x4cede8+=_0x309ef7;if(_0x347952)_0x4cede8+=_0x347952;if(_0x541ea2||_0x309ef7||_0x347952)_0x4cede8+='\x0a';if(_0x209c1f)_0x4cede8+=_0x209c1f;if(_0xe1b410)_0x4cede8+=_0xe1b410;if(_0x34eb14)_0x4cede8+=_0x34eb14;}const _0x566166=_0x460a58(_0x5cd7d7),_0x3ea2ba='\x0a#\x20你的核心任务\x0a你正在扮演角色“'+_0x5cd7d7[_0x57febd(0xdcf)]+_0x57febd(0x36b)+_0x5cd7d7[_0x57febd(0xa37)]['aiPersona']+_0x57febd(0x913)+_0x566166+_0x57febd(0xf89)+_0x1eda0a+_0x57febd(0xe13)+_0x5cd7d7['originalName']+'\x22\x0a-\x20**用户的备注**:\x20\x22'+_0x586fd9+'\x22\x0a'+_0x537987+'\x0a'+_0x406feb+'\x0a'+_0x4cede8+'\x20\x0a-\x20**你们最后的对话**:\x0a'+_0x2d535f['map'](_0x52ad55=>(_0x52ad55[_0x57febd(0x71a)]===_0x57febd(0x6d6)?_0x586fd9:_0x5cd7d7[_0x57febd(0xf3e)])+':\x20'+String(_0x52ad55[_0x57febd(0x1109)]))['join']('\x0a')+_0x57febd(0x2bc),_0x577412=_0x35efaa[_0x57febd(0xd18)](_0x38a691=>({'role':_0x38a691['role'],'content':(_0x38a691[_0x57febd(0x71a)]===_0x57febd(0x6d6)?_0x586fd9:_0x5cd7d7[_0x57febd(0xf3e)])+':\x20'+String(_0x38a691['content'])}));let _0x488a36=_0xa5a479['includes'](_0x57febd(0x14cc)),_0xe9fb59=_0x3914a6(_0x243473,_0x990176,_0x3ea2ba,_0x577412);const _0x2a21d7=_0x488a36?await fetch(_0xe9fb59['url'],_0xe9fb59[_0x57febd(0x55b)]):await fetch(_0xa5a479+_0x57febd(0x1611),{'method':_0x57febd(0x953),'headers':{'Content-Type':_0x57febd(0xfae),'Authorization':'Bearer\x20'+_0x990176},'body':JSON[_0x57febd(0xea5)]({'model':_0x243473,'messages':[{'role':_0x57febd(0xaf6),'content':_0x3ea2ba},..._0x577412],'temperature':_0x4c8b14[_0x57febd(0x14f1)][_0x57febd(0x216)]||0.8})});if(!_0x2a21d7['ok'])throw new Error(_0x57febd(0x1178)+(await _0x2a21d7['json']())['error']['message']);const _0x355a20=await _0x2a21d7['json'](),_0x1a37bc=getGeminiResponseText(_0x355a20),_0x13082f=_0x57a22a(_0x1a37bc);if(!_0x13082f||_0x13082f[_0x57febd(0x8d6)]===0x0)throw new Error('AI返回了空内容。');let _0x16c706=0x0,_0x1b000f=Date[_0x57febd(0xecd)]();for(const _0x32ba68 of _0x13082f){const _0x2bb2f4={'role':_0x57febd(0x4fd),'senderName':_0x5cd7d7[_0x57febd(0xdcf)],'timestamp':_0x1b000f++};let _0x410ef3=null;switch(_0x32ba68[_0x57febd(0xbbf)]){case _0x57febd(0x117f):_0x410ef3={..._0x2bb2f4,'content':String(_0x32ba68[_0x57febd(0x1109)]||_0x32ba68[_0x57febd(0x6e2)])};break;case _0x57febd(0x12c2):if(_0x32ba68[_0x57febd(0xca4)]){const _0x1071a7=findBestStickerMatch(_0x32ba68[_0x57febd(0xca4)],_0x4c8b14['userStickers']);_0x1071a7?_0x410ef3={..._0x2bb2f4,'type':_0x57febd(0x12c2),'content':_0x1071a7['url'],'meaning':_0x1071a7['name']}:(console[_0x57febd(0x75e)](_0x57febd(0xaf9)+_0x32ba68[_0x57febd(0xca4)]+'\x22'),_0x410ef3=null);}else console[_0x57febd(0x75e)](_0x57febd(0xa96),_0x32ba68),_0x410ef3={..._0x2bb2f4,'type':_0x57febd(0x12c2),'content':_0x32ba68[_0x57febd(0x299)],'meaning':'未知表情'};break;}_0x410ef3&&(_0x5cd7d7[_0x57febd(0x92c)][_0x57febd(0x6bb)](_0x410ef3),_0x16c706++);}_0x16c706>0x0&&(_0x5cd7d7[_0x57febd(0x73c)]=(_0x5cd7d7[_0x57febd(0x73c)]||0x0)+_0x16c706),await _0x54c587['chats']['put'](_0x5cd7d7),await _0x41b828(),_0x16c706>0x0&&_0x301fc2(_0x5cd7d7['id'],'发来了\x20'+_0x16c706+_0x57febd(0x15d0));}catch(_0x4efbd5){console[_0x57febd(0x5d7)]('从CPhone推进真实对话失败:',_0x4efbd5),await _0x138765(_0x57febd(0x12cb),_0x57febd(0x11b5)+_0x4efbd5[_0x57febd(0x6e2)]);}}async function _0x2e79aa(){const _0x2b339b=_0x239c7d;if(_0x3460b6||!_0x7e1e9)return;_0x3460b6=!![];const _0x3eafbd=document[_0x2b339b(0x400)](_0x2b339b(0xcac)),_0x51a9cf=_0x4c8b14['chats'][_0x7e1e9];if(!_0x51a9cf){_0x3460b6=![];return;}_0x3a43dd(_0x3eafbd,'top');const _0x399421=_0x3eafbd[_0x2b339b(0xe0d)];await new Promise(_0x542d30=>setTimeout(_0x542d30,0x1f4));const _0xd74a38=_0x51a9cf['history'][_0x2b339b(0x8d6)],_0x38baf2=_0x4c8b14[_0x2b339b(0x14f1)][_0x2b339b(0x37b)]||0x32,_0x49f5d6=_0xd74a38-_0x41cb4b,_0x4ec506=Math['max'](0x0,_0x49f5d6-_0x38baf2),_0x453f6b=_0x51a9cf[_0x2b339b(0x92c)][_0x2b339b(0x69f)](_0x4ec506,_0x49f5d6);_0x42da12(_0x3eafbd);if(_0x453f6b[_0x2b339b(0x8d6)]===0x0){_0x3460b6=![];return;}for(const _0x157d85 of _0x453f6b[_0x2b339b(0xfc1)]()){const _0x1e8be3={..._0x157d85,'role':_0x157d85[_0x2b339b(0x71a)]===_0x2b339b(0x6d6)?'assistant':_0x2b339b(0x6d6)},_0x553747={'id':_0x2b339b(0x7b0),'isGroup':![],'name':_0x51a9cf[_0x2b339b(0xf3e)],'settings':{..._0x51a9cf['settings'],'myAvatar':_0x51a9cf[_0x2b339b(0xa37)][_0x2b339b(0xb24)],'myAvatarFrame':_0x51a9cf['settings'][_0x2b339b(0x2d7)],'aiAvatar':_0x51a9cf[_0x2b339b(0xa37)][_0x2b339b(0x12d3)],'aiAvatarFrame':_0x51a9cf[_0x2b339b(0xa37)][_0x2b339b(0x11f7)]}},_0x5aa5c4=await _0x43c5e5(_0x1e8be3,_0x553747);_0x5aa5c4&&_0x3eafbd[_0x2b339b(0x587)](_0x5aa5c4);}_0x41cb4b+=_0x453f6b['length'];const _0x379abb=_0x3eafbd[_0x2b339b(0xe0d)];_0x3eafbd[_0x2b339b(0x125c)]=_0x379abb-_0x399421,_0x3460b6=![];}async function _0x3e1a87(_0x1e49f9){const _0xc7a565=_0x239c7d,_0x106335=_0x4c8b14['chats'][_0x7e1e9];if(!_0x106335)return;_0xf60dfe=_0x1e49f9===-0x1?_0xc7a565(0x9b2):_0x106335[_0xc7a565(0x1294)][_0x1e49f9]?.[_0xc7a565(0xbbf)];const _0x10075a=document[_0xc7a565(0x400)]('char-conversation-messages');_0x10075a[_0xc7a565(0x1575)]='',_0x10075a[_0xc7a565(0xd61)][_0xc7a565(0xa33)]=_0x106335[_0xc7a565(0xa37)][_0xc7a565(0xa33)]||_0xc7a565(0x855);const _0x16a02f=document[_0xc7a565(0x400)](_0xc7a565(0x43a))[_0xc7a565(0xb08)][_0xc7a565(0xd3f)](_0xc7a565(0x1457));_0x10075a[_0xc7a565(0xa00)][_0xc7a565(0x1296)]=_0x16a02f?_0xc7a565(0x15a9):_0xc7a565(0x126f);let _0x2ae32f,_0x2fb046=[];const _0x26ea2b=await _0x54c587[_0xc7a565(0xf9b)][_0xc7a565(0xce1)](),_0x23e423=new Map(_0x26ea2b[_0xc7a565(0xd18)](_0x3597c8=>[_0x3597c8[_0xc7a565(0xf3e)],_0x3597c8]));if(_0x1e49f9===-0x1){_0xf60dfe='private_user';const _0xa83495=document[_0xc7a565(0x400)](_0xc7a565(0x1188)),_0x2c6181=document[_0xc7a565(0x400)](_0xc7a565(0x80a));_0x10075a['innerHTML']='',_0xa83495[_0xc7a565(0xde7)]=_0x106335[_0xc7a565(0xa37)]['myNickname']||(_0x4c8b14['qzoneSettings']['nickname']||'我'),_0x2c6181[_0xc7a565(0xb8e)]='与\x20'+(_0x106335[_0xc7a565(0xa37)][_0xc7a565(0x14a8)]||'我')+_0xc7a565(0xf75),_0x41cb4b=0x0,_0x3460b6=![];const _0xe3312=_0x106335[_0xc7a565(0x92c)],_0x4116a7=_0x4c8b14[_0xc7a565(0x14f1)]['chatRenderWindow']||0x32,_0x4c8c0f=_0xe3312[_0xc7a565(0x69f)](-_0x4116a7);_0x2ae32f={'id':_0xc7a565(0x7b0),'isGroup':![],'name':_0x106335[_0xc7a565(0xf3e)],'settings':{..._0x106335[_0xc7a565(0xa37)],'myAvatar':_0x106335[_0xc7a565(0xa37)][_0xc7a565(0xb24)],'myAvatarFrame':_0x106335['settings'][_0xc7a565(0x2d7)],'aiAvatar':_0x106335[_0xc7a565(0xa37)][_0xc7a565(0x12d3)],'aiAvatarFrame':_0x106335[_0xc7a565(0xa37)][_0xc7a565(0x11f7)]}},_0x2fb046=_0x4c8c0f[_0xc7a565(0xd18)](_0x3fccd5=>({..._0x3fccd5,'role':_0x3fccd5[_0xc7a565(0x71a)]===_0xc7a565(0x6d6)?'assistant':_0xc7a565(0x6d6)})),_0x41cb4b=_0x4c8c0f[_0xc7a565(0x8d6)];}else{const _0x97d61=_0x106335[_0xc7a565(0x1294)][_0x1e49f9];if(!_0x97d61)return;_0xf60dfe=_0x97d61[_0xc7a565(0xbbf)];const _0x317b3d=document[_0xc7a565(0x400)](_0xc7a565(0x1188)),_0x437e0d=document[_0xc7a565(0x400)](_0xc7a565(0x80a));if(_0x97d61[_0xc7a565(0xbbf)]==='group')_0x317b3d[_0xc7a565(0xde7)]=_0x97d61[_0xc7a565(0x121e)]+'\x20('+(_0x97d61['participants'][_0xc7a565(0x8d6)]+0x1)+')',_0x437e0d[_0xc7a565(0xb8e)]='在\x20'+_0x97d61[_0xc7a565(0x121e)]+_0xc7a565(0x133b),_0x2ae32f={'id':_0xc7a565(0x238),'isGroup':!![],'name':_0x97d61['groupName'],'originalName':_0x106335[_0xc7a565(0xdcf)],'members':_0x97d61[_0xc7a565(0x131d)]['map'](_0xd6703f=>{const _0x23fef5=_0xc7a565,_0x4125b1=_0x23e423['get'](_0xd6703f[_0x23fef5(0xf3e)]);let _0x14026d=_0x4125b1&&_0x4125b1[_0x23fef5(0xa9a)]?_0x4125b1[_0x23fef5(0xa9a)]:_0x4c8b14['globalSettings']['enableAiDrawing']?_0x23fef5(0x9c3)+encodeURIComponent(_0xd6703f[_0x23fef5(0x370)]||_0x23fef5(0x5f9)):_0x1e2f0a;return{'originalName':_0xd6703f[_0x23fef5(0xf3e)],'groupNickname':_0xd6703f[_0x23fef5(0xf3e)],'avatar':_0x14026d};}),'settings':{..._0x106335[_0xc7a565(0xa37)],'myNickname':_0x106335[_0xc7a565(0xf3e)],'myAvatar':_0x106335[_0xc7a565(0xa37)]['aiAvatar'],'myAvatarFrame':_0x106335['settings']['aiAvatarFrame']}};else{_0x317b3d[_0xc7a565(0xde7)]=_0x97d61[_0xc7a565(0x12f4)][_0xc7a565(0xf3e)],_0x437e0d[_0xc7a565(0xb8e)]='与\x20'+_0x97d61[_0xc7a565(0x12f4)][_0xc7a565(0xf3e)]+_0xc7a565(0x9a3);const _0x9cd052=_0x23e423[_0xc7a565(0xf48)](_0x97d61['participant'][_0xc7a565(0xf3e)]),_0x2b5ff5=_0x9cd052&&_0x9cd052['avatar']?_0x9cd052[_0xc7a565(0xa9a)]:_0x4c8b14[_0xc7a565(0x14f1)][_0xc7a565(0x7b5)]?_0xc7a565(0x9c3)+encodeURIComponent(_0x97d61[_0xc7a565(0x12f4)][_0xc7a565(0x370)]||'anime\x20person'):_0x1e2f0a;_0x2ae32f={'id':_0xc7a565(0xa57),'isGroup':![],'name':_0x97d61[_0xc7a565(0x12f4)]['name'],'originalName':_0x106335['originalName'],'settings':{..._0x106335[_0xc7a565(0xa37)],'myAvatar':_0x106335[_0xc7a565(0xa37)][_0xc7a565(0xb24)],'myAvatarFrame':_0x106335[_0xc7a565(0xa37)][_0xc7a565(0x2d7)],'aiAvatar':_0x2b5ff5,'aiAvatarFrame':''}};}_0x2fb046=_0x97d61['messages'];}for(const _0x238946 of _0x2fb046){let _0x55221a=_0x238946['role'];if(_0x1e49f9!==-0x1){const _0x4e0a16=_0x238946[_0xc7a565(0xd48)]===(_0x106335['originalName']||_0x106335[_0xc7a565(0xf3e)]);_0x55221a=_0x4e0a16?_0xc7a565(0x6d6):'assistant';}const _0x2614a4={'role':_0x55221a,'senderName':_0x238946[_0xc7a565(0xd48)]||(_0x55221a===_0xc7a565(0x6d6)?_0x2ae32f[_0xc7a565(0xa37)][_0xc7a565(0x14a8)]:_0x2ae32f[_0xc7a565(0xf3e)]),'timestamp':_0x238946['timestamp']||Date[_0xc7a565(0xecd)]()+Math[_0xc7a565(0x12bc)]()};if(_0x238946[_0xc7a565(0xbbf)]===_0xc7a565(0x12c2)&&_0x238946[_0xc7a565(0xca4)]){const _0x1f7af9=_0x4c8b14[_0xc7a565(0x120c)][_0xc7a565(0x821)](_0x15cc4a=>_0x15cc4a[_0xc7a565(0xf3e)]===_0x238946[_0xc7a565(0xca4)]);_0x1f7af9?(_0x2614a4['content']=_0x1f7af9[_0xc7a565(0x299)],_0x2614a4[_0xc7a565(0xca4)]=_0x238946[_0xc7a565(0xca4)],_0x2614a4['type']='sticker'):(console[_0xc7a565(0x75e)](_0xc7a565(0x239)+_0x238946['meaning']+_0xc7a565(0x1395)),_0x2614a4[_0xc7a565(0x1109)]=_0xc7a565(0x84c)+_0x238946['meaning']+']',_0x2614a4[_0xc7a565(0xbbf)]=_0xc7a565(0x117f));}else _0x2614a4['content']=_0x238946[_0xc7a565(0x1109)],_0x2614a4[_0xc7a565(0xbbf)]=_0x238946['type']||_0xc7a565(0x117f);const _0x38dd45=await _0x43c5e5(_0x2614a4,_0x2ae32f);_0x38dd45&&_0x10075a[_0xc7a565(0x8f2)](_0x38dd45);}_0x2b7df1('char-qq-conversation-screen'),setTimeout(()=>_0x10075a['scrollTop']=_0x10075a[_0xc7a565(0xe0d)],0x0);}function _0x50e1cd(){const _0x24fd73=_0x239c7d;document[_0x24fd73(0x400)]('char-qq-transcript-modal')['classList']['remove']('visible');}async function _0x1bf20c(){const _0x689d85=_0x239c7d;if(!_0x7e1e9)return;const _0x33962c=_0x4c8b14[_0x689d85(0xbea)][_0x7e1e9];if(!_0x33962c){await _0x138765(_0x689d85(0x12cb),'无法找到当前角色的数据。');return;}await _0x138765(_0x689d85(0x13e9),'正在请求“'+_0x33962c[_0x689d85(0xf3e)]+'”回忆TA的相册照片...');const {proxyUrl:_0x16ea7c,apiKey:_0x3cda96,model:_0x69241c}=_0x4c8b14['apiConfig'];if(!_0x16ea7c||!_0x3cda96||!_0x69241c){alert(_0x689d85(0x1106));return;}const _0x23b406=_0x4c8b14[_0x689d85(0x834)][_0x689d85(0xbf3)]===_0x689d85(0xa8f)||!_0x4c8b14['qzoneSettings']['nickname']?'用户':_0x4c8b14['qzoneSettings'][_0x689d85(0xbf3)],_0x48296c=_0x33962c[_0x689d85(0x1600)]&&_0x33962c[_0x689d85(0x1600)][_0x689d85(0x8d6)]>0x0?_0x33962c[_0x689d85(0x1600)][_0x689d85(0xd18)](_0x553526=>_0x689d85(0x1ee)+_0x4878ba(_0x553526[_0x689d85(0x287)])+')\x20'+_0x553526[_0x689d85(0x1109)])[_0x689d85(0xee1)]('\x0a'):'无',_0x12cfbe=_0x33962c[_0x689d85(0xa37)]['maxMemory']||0xa,_0x1a1ff1=_0x33962c[_0x689d85(0x92c)][_0x689d85(0x69f)](-_0x12cfbe),_0x141b1d=await _0x25ac7a(_0x1a1ff1,_0x7e1e9),_0x20f710=_0x141b1d[_0x689d85(0xd18)](_0x56a304=>(_0x56a304[_0x689d85(0x71a)]==='user'?_0x23b406:_0x33962c[_0x689d85(0xf3e)])+':\x20'+String(_0x56a304[_0x689d85(0x1109)])[_0x689d85(0x371)](0x0,0x1e)+_0x689d85(0x166b))[_0x689d85(0xee1)]('\x0a'),_0x10ff39=(_0x33962c[_0x689d85(0xa37)][_0x689d85(0xb0d)]||[])['map'](_0x4f7565=>_0x4c8b14[_0x689d85(0xf57)][_0x689d85(0x821)](_0x408227=>_0x408227['id']===_0x4f7565))[_0x689d85(0x29d)](Boolean)[_0x689d85(0xd18)](_0x500404=>_0x689d85(0x1606)+_0x500404[_0x689d85(0xf3e)]+_0x689d85(0x1150)+_0x500404['content']['filter'](_0x135a12=>_0x135a12['enabled'])[_0x689d85(0xd18)](_0x2f3839=>'-\x20'+_0x2f3839[_0x689d85(0x1109)])['join']('\x0a'))['join'](''),_0x840cc=_0x3eed43(_0x33962c,0x3,_0x689d85(0xf20)),_0x289e9e=_0x3eed43(_0x33962c,0x6,_0x689d85(0xf20)),_0xd3420e=_0x3eed43(_0x33962c,0x9,_0x689d85(0xf20)),_0x188830=_0x3eed43(_0x33962c,0x1,_0x689d85(0x72c)),_0x321d4b=_0x3eed43(_0x33962c,0x3,_0x689d85(0x72c)),_0x2c2e6c=_0x3eed43(_0x33962c,0x7,_0x689d85(0x72c));let _0x10ad23='';if(_0x840cc||_0x289e9e||_0xd3420e||_0x188830||_0x321d4b||_0x2c2e6c){_0x10ad23+=_0x689d85(0x116b);if(_0x840cc)_0x10ad23+=_0x840cc;if(_0x289e9e)_0x10ad23+=_0x289e9e;if(_0xd3420e)_0x10ad23+=_0xd3420e;if(_0x840cc||_0x289e9e||_0xd3420e)_0x10ad23+='\x0a';if(_0x188830)_0x10ad23+=_0x188830;if(_0x321d4b)_0x10ad23+=_0x321d4b;if(_0x2c2e6c)_0x10ad23+=_0x2c2e6c;}const _0x39897d='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x33962c[_0x689d85(0xf3e)]+_0x689d85(0x1250)+_0x33962c[_0x689d85(0xa37)][_0x689d85(0xfea)]+'\x0a'+_0x48296c+'\x0a'+_0x10ff39+'\x0a'+_0x10ad23+_0x689d85(0x81a)+_0x23b406+'”的对话摘要**:\x0a'+_0x20f710+_0x689d85(0x6da);try{const _0x3c6245=[{'role':_0x689d85(0x6d6),'content':'请根据你的设定，生成你的相册内容。'}];let _0x18f2c3=_0x16ea7c[_0x689d85(0xd1b)]('generativelanguage'),_0xdfff2=_0x3914a6(_0x69241c,_0x3cda96,_0x39897d,_0x3c6245);const _0x5076b5=_0x18f2c3?await fetch(_0xdfff2[_0x689d85(0x299)],_0xdfff2[_0x689d85(0x55b)]):await fetch(_0x16ea7c+_0x689d85(0x1611),{'method':_0x689d85(0x953),'headers':{'Content-Type':'application/json','Authorization':_0x689d85(0xcee)+_0x3cda96},'body':JSON[_0x689d85(0xea5)]({'model':_0x69241c,'messages':[{'role':_0x689d85(0xaf6),'content':_0x39897d},..._0x3c6245],'temperature':_0x4c8b14[_0x689d85(0x14f1)][_0x689d85(0x216)]||0.9})});if(!_0x5076b5['ok'])throw new Error(_0x689d85(0x7d5)+_0x5076b5[_0x689d85(0x755)]);const _0x56ed89=await _0x5076b5[_0x689d85(0x15d3)](),_0x527f10=getGeminiResponseText(_0x56ed89),_0x5166ed=_0x527f10[_0x689d85(0xbf7)](/(\[[\s\S]*\])/);if(!_0x5166ed||!_0x5166ed[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x527f10);const _0x4b9daa=_0x5166ed[0x0];let _0x4452bd;try{_0x4452bd=JSON[_0x689d85(0x13f7)](_0x4b9daa);}catch(_0x364750){throw new Error('解析AI返回的JSON时出错:\x20'+_0x364750['message']+_0x689d85(0xc72)+_0x527f10);}_0x33962c['simulatedAlbum']=_0x4452bd,await _0x54c587[_0x689d85(0xbea)][_0x689d85(0x4cb)](_0x33962c),await _0x55124a();}catch(_0x159e09){console[_0x689d85(0x5d7)](_0x689d85(0x1048),_0x159e09),await _0x138765('生成失败','无法生成模拟相册，请检查API配置或稍后再试。\x0a错误:\x20'+_0x159e09['message']);}}async function _0x55124a(){const _0x5a63c6=_0x239c7d,_0x200878=document[_0x5a63c6(0x400)](_0x5a63c6(0x1692));_0x200878[_0x5a63c6(0x1575)]='';if(!_0x7e1e9)return;const _0x282e00=_0x4c8b14['chats'][_0x7e1e9],_0x56beb7=_0x282e00[_0x5a63c6(0x8b7)]||[];if(_0x56beb7[_0x5a63c6(0x8d6)]===0x0){_0x200878['innerHTML']=_0x5a63c6(0x15dc);return;}const _0x2b99d6='https://i.postimg.cc/KYr2qRCK/1.jpg';_0x56beb7[_0x5a63c6(0xbdc)](_0x236f85=>{const _0x347298=_0x5a63c6,_0x3e616a=document[_0x347298(0x2c9)]('div');_0x3e616a[_0x347298(0x4e1)]=_0x347298(0x5d5),_0x3e616a[_0x347298(0xd61)][_0x347298(0x12a5)]=_0x236f85['description'],_0x200878[_0x347298(0x8f2)](_0x3e616a);if(_0x4c8b14['globalSettings'][_0x347298(0x7b5)]){_0x3e616a['style']['backgroundColor']=_0x347298(0x9e9);const _0x5c2065=/[^\x00-\x7F]/[_0x347298(0x2c0)](_0x236f85['image_prompt']),_0x1c9bf1=_0x236f85[_0x347298(0xff9)]&&_0x236f85[_0x347298(0xff9)]['trim']()&&!_0x5c2065,_0x36b864=_0x1c9bf1?_0x236f85['image_prompt']:_0x347298(0x1163),_0x22870b='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x36b864),_0x4bca47=new Image();_0x4bca47[_0x347298(0x9e0)]=function(){const _0xdc3983=_0x347298;_0x3e616a[_0xdc3983(0xa00)][_0xdc3983(0xf11)]=_0xdc3983(0xe21)+this[_0xdc3983(0x912)]+')';},_0x4bca47[_0x347298(0x96d)]=function(){const _0x5962b7=_0x347298;_0x3e616a[_0x5962b7(0xa00)][_0x5962b7(0xf11)]=_0x5962b7(0xe21)+_0x2b99d6+')';},_0x4bca47[_0x347298(0x912)]=_0x22870b;}else{_0x3e616a[_0x347298(0xa00)]['backgroundColor']=_0x347298(0x126f),_0x3e616a[_0x347298(0xa00)]['border']=_0x347298(0xa05);const _0x2f9cab=document[_0x347298(0x2c9)]('p');_0x2f9cab[_0x347298(0x4e1)]='char-photo-description',_0x2f9cab[_0x347298(0xde7)]=_0x236f85[_0x347298(0x12a5)]||_0x347298(0xefa),_0x3e616a[_0x347298(0x8f2)](_0x2f9cab);}});}async function _0x82f004(){const _0x29a9fb=_0x239c7d;if(!_0x7e1e9)return;const _0x20e402=_0x4c8b14[_0x29a9fb(0xbea)][_0x7e1e9];if(!_0x20e402)return;await _0x138765('请稍候...','正在模拟“'+_0x20e402[_0x29a9fb(0xf3e)]+'”的网上冲浪足迹...');const {proxyUrl:_0x2309ce,apiKey:_0x495127,model:_0xc96231}=_0x4c8b14[_0x29a9fb(0x814)];if(!_0x2309ce||!_0x495127||!_0xc96231){alert('API未配置，无法生成内容。');return;}const _0x4fb767=_0x4c8b14[_0x29a9fb(0x834)][_0x29a9fb(0xbf3)]===_0x29a9fb(0xa8f)||!_0x4c8b14[_0x29a9fb(0x834)][_0x29a9fb(0xbf3)]?'用户':_0x4c8b14['qzoneSettings'][_0x29a9fb(0xbf3)],_0x19ba23=_0x20e402[_0x29a9fb(0x1600)]&&_0x20e402[_0x29a9fb(0x1600)][_0x29a9fb(0x8d6)]>0x0?_0x20e402['longTermMemory'][_0x29a9fb(0xd18)](_0x5191de=>_0x29a9fb(0x1ee)+_0x4878ba(_0x5191de[_0x29a9fb(0x287)])+')\x20'+_0x5191de['content'])['join']('\x0a'):'无',_0x2dfb93=_0x20e402['settings'][_0x29a9fb(0xebb)]||0xa,_0x2983d0=_0x20e402[_0x29a9fb(0x92c)][_0x29a9fb(0x69f)](-_0x2dfb93)[_0x29a9fb(0xd18)](_0x1b4102=>(_0x1b4102['role']===_0x29a9fb(0x6d6)?_0x4fb767:_0x20e402[_0x29a9fb(0xf3e)])+':\x20'+String(_0x1b4102['content'])[_0x29a9fb(0x371)](0x0,0x1e)+'...')[_0x29a9fb(0xee1)]('\x0a'),_0x1771d0=(_0x20e402[_0x29a9fb(0xa37)][_0x29a9fb(0xb0d)]||[])[_0x29a9fb(0xd18)](_0x5362a1=>_0x4c8b14['worldBooks'][_0x29a9fb(0x821)](_0x552ec5=>_0x552ec5['id']===_0x5362a1))['filter'](Boolean)['map'](_0x428223=>_0x29a9fb(0x1606)+_0x428223[_0x29a9fb(0xf3e)]+'》设定:\x0a'+_0x428223[_0x29a9fb(0x1109)][_0x29a9fb(0x29d)](_0xbe6f76=>_0xbe6f76[_0x29a9fb(0x250)])['map'](_0x43a3f6=>'-\x20'+_0x43a3f6[_0x29a9fb(0x1109)])[_0x29a9fb(0xee1)]('\x0a'))[_0x29a9fb(0xee1)](''),_0x645617=_0x3eed43(_0x20e402,0x3,_0x29a9fb(0xf20)),_0x4d1fc9=_0x3eed43(_0x20e402,0x6,'hours'),_0x5a6f92=_0x3eed43(_0x20e402,0x9,_0x29a9fb(0xf20)),_0x37538f=_0x3eed43(_0x20e402,0x1,_0x29a9fb(0x72c)),_0x4f47c0=_0x3eed43(_0x20e402,0x3,_0x29a9fb(0x72c)),_0xc69ef7=_0x3eed43(_0x20e402,0x7,_0x29a9fb(0x72c));let _0x337275='';if(_0x645617||_0x4d1fc9||_0x5a6f92||_0x37538f||_0x4f47c0||_0xc69ef7){_0x337275+=_0x29a9fb(0x116b);if(_0x645617)_0x337275+=_0x645617;if(_0x4d1fc9)_0x337275+=_0x4d1fc9;if(_0x5a6f92)_0x337275+=_0x5a6f92;if(_0x645617||_0x4d1fc9||_0x5a6f92)_0x337275+='\x0a';if(_0x37538f)_0x337275+=_0x37538f;if(_0x4f47c0)_0x337275+=_0x4f47c0;if(_0xc69ef7)_0x337275+=_0xc69ef7;}const _0x3b12f5=_0x20e402['settings']['myPersona']||'(未设置)',_0x35bcf8='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x20e402['name']+_0x29a9fb(0xe4e)+_0x20e402[_0x29a9fb(0xa37)][_0x29a9fb(0xfea)]+_0x29a9fb(0x689)+_0x3b12f5+_0x29a9fb(0x11f1)+_0x19ba23+'\x0a'+_0x1771d0+'\x0a'+_0x337275+_0x29a9fb(0x81a)+_0x4fb767+_0x29a9fb(0xeee)+_0x2983d0+_0x29a9fb(0x760);try{const _0x1c7ff7=[{'role':'user','content':_0x29a9fb(0x9ae)}];let _0x574795=_0x2309ce[_0x29a9fb(0xd1b)]('generativelanguage'),_0x19406f=_0x3914a6(_0xc96231,_0x495127,_0x35bcf8,_0x1c7ff7);const _0xb59f2b=_0x574795?await fetch(_0x19406f['url'],_0x19406f[_0x29a9fb(0x55b)]):await fetch(_0x2309ce+_0x29a9fb(0x1611),{'method':'POST','headers':{'Content-Type':_0x29a9fb(0xfae),'Authorization':_0x29a9fb(0xcee)+_0x495127},'body':JSON[_0x29a9fb(0xea5)]({'model':_0xc96231,'messages':[{'role':'system','content':_0x35bcf8},..._0x1c7ff7],'temperature':_0x4c8b14['globalSettings'][_0x29a9fb(0x216)]||0.9})});if(!_0xb59f2b['ok'])throw new Error(_0x29a9fb(0x7d5)+_0xb59f2b['statusText']);const _0x286776=await _0xb59f2b[_0x29a9fb(0x15d3)](),_0x5ea89e=getGeminiResponseText(_0x286776),_0x2cdc63=_0x5ea89e[_0x29a9fb(0xbf7)](/(\[[\s\S]*\])/);if(!_0x2cdc63||!_0x2cdc63[0x0])throw new Error(_0x29a9fb(0x131e)+_0x5ea89e);const _0x5f4888=_0x2cdc63[0x0];let _0x589982;try{_0x589982=JSON['parse'](_0x5f4888);}catch(_0x5cfb66){throw new Error(_0x29a9fb(0x7d7)+_0x5cfb66[_0x29a9fb(0x6e2)]+_0x29a9fb(0xc72)+_0x5ea89e);}_0x20e402[_0x29a9fb(0x11c5)]=_0x589982,await _0x54c587[_0x29a9fb(0xbea)][_0x29a9fb(0x4cb)](_0x20e402),await _0x1827a0();}catch(_0x4aa6c8){console[_0x29a9fb(0x5d7)](_0x29a9fb(0xb4f),_0x4aa6c8),await _0x138765('生成失败',_0x29a9fb(0x1062)+_0x4aa6c8[_0x29a9fb(0x6e2)]);}}function _0x1827a0(){const _0x4c9913=_0x239c7d,_0x22067e=document[_0x4c9913(0x400)](_0x4c9913(0x1182));_0x22067e[_0x4c9913(0x1575)]='';if(!_0x7e1e9)return;const _0x3819a7=_0x4c8b14['chats'][_0x7e1e9],_0x3bb998=_0x3819a7[_0x4c9913(0x11c5)]||[];if(_0x3bb998[_0x4c9913(0x8d6)]===0x0){_0x22067e[_0x4c9913(0x1575)]=_0x4c9913(0x53a);return;}_0x3bb998[_0x4c9913(0xbdc)]((_0x4fd9c9,_0x4c3c33)=>{const _0x203388=_0x4c9913,_0x13a283=document[_0x203388(0x2c9)](_0x203388(0xf8e));_0x13a283[_0x203388(0x4e1)]=_0x203388(0x140c),_0x13a283['innerHTML']=_0x203388(0x166e)+_0x4fd9c9['title']+_0x203388(0x11bf)+_0x4fd9c9[_0x203388(0x299)]+_0x203388(0x14f0),_0x13a283[_0x203388(0x501)](_0x203388(0x15ad),()=>_0x44b2a4(_0x4c3c33)),_0x22067e['appendChild'](_0x13a283);});}async function _0x44b2a4(_0x1a8642){const _0x35f22c=_0x239c7d,_0x3c9cfa=_0x4c8b14[_0x35f22c(0xbea)][_0x7e1e9],_0x407f88=_0x3c9cfa[_0x35f22c(0x11c5)][_0x1a8642];if(!_0x407f88)return;_0x1c8105=_0x407f88,_0x444356(_0x407f88),_0x2b7df1(_0x35f22c(0xd2b));const _0x23a656=document['getElementById'](_0x35f22c(0x1019)),_0x348303=await _0x54c587['favorites'][_0x35f22c(0x227)]({'type':'char_browser_article','content.url':_0x407f88[_0x35f22c(0x299)]})[_0x35f22c(0x149c)]();_0x23a656[_0x35f22c(0xb08)][_0x35f22c(0x146f)](_0x35f22c(0x5d6),!!_0x348303);}async function _0x38b0cb(){const _0x33ccae=_0x239c7d;if(!_0x1c8105||!_0x7e1e9)return;const _0x127ffa=_0x1c8105,_0x480c5e=_0x4c8b14[_0x33ccae(0xbea)][_0x7e1e9],_0xcc2d40=document[_0x33ccae(0x400)](_0x33ccae(0x1019)),_0x3d0571=await _0x54c587[_0x33ccae(0x69c)][_0x33ccae(0x227)]({'type':'char_browser_article','content.url':_0x127ffa[_0x33ccae(0x299)]})[_0x33ccae(0x149c)]();if(_0x3d0571)await _0x54c587[_0x33ccae(0x69c)][_0x33ccae(0x942)](_0x3d0571['id']),_0xcc2d40[_0x33ccae(0xb08)][_0x33ccae(0xc46)]('active'),await _0x138765('操作成功',_0x33ccae(0x1056));else{const _0x15f8fa={'type':_0x33ccae(0xae2),'content':{..._0x127ffa,'characterId':_0x7e1e9,'characterName':_0x480c5e['name']},'timestamp':Date[_0x33ccae(0xecd)]()};await _0x54c587[_0x33ccae(0x69c)][_0x33ccae(0x12b6)](_0x15f8fa),_0xcc2d40['classList']['add']('active'),await _0x138765(_0x33ccae(0x112c),_0x33ccae(0x526));}}function _0x444356(_0x85d3d2){const _0x18c1c0=_0x239c7d,_0x4f9d96=document[_0x18c1c0(0x400)]('char-article-title'),_0x425413=document[_0x18c1c0(0x400)]('char-article-content');_0x4f9d96[_0x18c1c0(0xde7)]=_0x85d3d2[_0x18c1c0(0x647)],_0x425413['innerHTML']='',_0x85d3d2[_0x18c1c0(0xbbf)]===_0x18c1c0(0xf86)?_0x425413[_0x18c1c0(0x1575)]=_0x18c1c0(0x76e)+(_0x85d3d2[_0x18c1c0(0x647)]||_0x18c1c0(0x106f))+_0x18c1c0(0x1236):_0x425413[_0x18c1c0(0x1575)]='<p>'+(_0x85d3d2[_0x18c1c0(0x1109)]||_0x18c1c0(0x810))[_0x18c1c0(0xe19)](/\n/g,'</p><p>')+_0x18c1c0(0x1236);}async function _0xfe4306(){const _0x546edd=_0x239c7d;if(!_0x7e1e9)return;const _0xc4694d=_0x4c8b14['chats'][_0x7e1e9];if(!_0xc4694d)return;await _0x138765(_0x546edd(0x13e9),_0x546edd(0x5ae)+_0xc4694d[_0x546edd(0xf3e)]+_0x546edd(0x1228));const {proxyUrl:_0x7a2718,apiKey:_0xf6a506,model:_0x50d8be}=_0x4c8b14[_0x546edd(0x814)];if(!_0x7a2718||!_0xf6a506||!_0x50d8be){alert(_0x546edd(0x373));return;}const _0x25aeb4=_0x4c8b14[_0x546edd(0x834)]['nickname']===_0x546edd(0xa8f)||!_0x4c8b14[_0x546edd(0x834)]['nickname']?'用户':_0x4c8b14[_0x546edd(0x834)][_0x546edd(0xbf3)],_0x294687=_0xc4694d[_0x546edd(0x1600)]&&_0xc4694d[_0x546edd(0x1600)][_0x546edd(0x8d6)]>0x0?_0xc4694d[_0x546edd(0x1600)]['map'](_0x4beafa=>_0x546edd(0x1ee)+_0x4878ba(_0x4beafa[_0x546edd(0x287)])+')\x20'+_0x4beafa[_0x546edd(0x1109)])[_0x546edd(0xee1)]('\x0a'):'无',_0x3bb2b5=_0xc4694d[_0x546edd(0xa37)][_0x546edd(0xebb)]||0xa,_0x119f06=_0xc4694d[_0x546edd(0x92c)][_0x546edd(0x69f)](-_0x3bb2b5),_0x1f4728=await _0x25ac7a(_0x119f06,_0x7e1e9),_0x29f4a6=_0x1f4728['map'](_0x2e0b34=>(_0x2e0b34[_0x546edd(0x71a)]===_0x546edd(0x6d6)?_0x25aeb4:_0xc4694d[_0x546edd(0xf3e)])+':\x20'+String(_0x2e0b34['content'])[_0x546edd(0x371)](0x0,0x1e)+_0x546edd(0x166b))[_0x546edd(0xee1)]('\x0a'),_0x15243f=(_0xc4694d[_0x546edd(0xa37)]['linkedWorldBookIds']||[])[_0x546edd(0xd18)](_0x457053=>_0x4c8b14[_0x546edd(0xf57)][_0x546edd(0x821)](_0x91caa8=>_0x91caa8['id']===_0x457053))[_0x546edd(0x29d)](Boolean)[_0x546edd(0xd18)](_0x5cbb00=>_0x546edd(0x1606)+_0x5cbb00[_0x546edd(0xf3e)]+_0x546edd(0x1150)+_0x5cbb00[_0x546edd(0x1109)][_0x546edd(0x29d)](_0x399310=>_0x399310['enabled'])[_0x546edd(0xd18)](_0x4005bd=>'-\x20'+_0x4005bd[_0x546edd(0x1109)])[_0x546edd(0xee1)]('\x0a'))[_0x546edd(0xee1)](''),_0x48abe0=_0x3eed43(_0xc4694d,0x3,_0x546edd(0xf20)),_0x318d06=_0x3eed43(_0xc4694d,0x6,_0x546edd(0xf20)),_0x2a24df=_0x3eed43(_0xc4694d,0x9,_0x546edd(0xf20)),_0x223a19=_0x3eed43(_0xc4694d,0x1,_0x546edd(0x72c)),_0x2b3a03=_0x3eed43(_0xc4694d,0x3,_0x546edd(0x72c)),_0x3e3a6f=_0x3eed43(_0xc4694d,0x7,'days');let _0x9dd0e4='';if(_0x48abe0||_0x318d06||_0x2a24df||_0x223a19||_0x2b3a03||_0x3e3a6f){_0x9dd0e4+=_0x546edd(0x116b);if(_0x48abe0)_0x9dd0e4+=_0x48abe0;if(_0x318d06)_0x9dd0e4+=_0x318d06;if(_0x2a24df)_0x9dd0e4+=_0x2a24df;if(_0x48abe0||_0x318d06||_0x2a24df)_0x9dd0e4+='\x0a';if(_0x223a19)_0x9dd0e4+=_0x223a19;if(_0x2b3a03)_0x9dd0e4+=_0x2b3a03;if(_0x3e3a6f)_0x9dd0e4+=_0x3e3a6f;}const _0x298959=_0x546edd(0xe3e)+_0xc4694d['name']+_0x546edd(0xf60)+_0xc4694d[_0x546edd(0xa37)][_0x546edd(0xfea)]+_0x546edd(0x11f1)+_0x294687+'\x0a'+_0x15243f+'\x0a'+_0x9dd0e4+_0x546edd(0x81a)+_0x25aeb4+_0x546edd(0xeee)+_0x29f4a6+_0x546edd(0xb09);try{const _0x36d58c=[{'role':'user','content':_0x546edd(0x130e)}];let _0x38ea3f=_0x7a2718[_0x546edd(0xd1b)](_0x546edd(0x14cc)),_0x32bb48=_0x3914a6(_0x50d8be,_0xf6a506,_0x298959,_0x36d58c);const _0x38cf4c=_0x38ea3f?await fetch(_0x32bb48[_0x546edd(0x299)],_0x32bb48[_0x546edd(0x55b)]):await fetch(_0x7a2718+'/v1/chat/completions',{'method':_0x546edd(0x953),'headers':{'Content-Type':_0x546edd(0xfae),'Authorization':_0x546edd(0xcee)+_0xf6a506},'body':JSON['stringify']({'model':_0x50d8be,'messages':[{'role':_0x546edd(0xaf6),'content':_0x298959},..._0x36d58c],'temperature':_0x4c8b14['globalSettings'][_0x546edd(0x216)]||0.9})});if(!_0x38cf4c['ok'])throw new Error('API\x20错误:\x20'+_0x38cf4c['statusText']);const _0x326c57=await _0x38cf4c[_0x546edd(0x15d3)](),_0x44739d=getGeminiResponseText(_0x326c57),_0x4347d9=_0x44739d[_0x546edd(0xbf7)](/({[\s\S]*})/);if(!_0x4347d9)throw new Error('AI返回的内容中未找到有效的JSON对象。');const _0x4ba425=JSON[_0x546edd(0x13f7)](_0x4347d9[0x0]);!_0x4ba425[_0x546edd(0x9a0)]&&(_0x4ba425[_0x546edd(0x9a0)]=[]),_0xc4694d[_0x546edd(0x47b)]=_0x4ba425,await _0x54c587['chats']['put'](_0xc4694d),await _0x5e8024();}catch(_0x5eb492){console[_0x546edd(0x5d7)](_0x546edd(0x31a),_0x5eb492),await _0x138765(_0x546edd(0x321),_0x546edd(0xc49)+_0x5eb492[_0x546edd(0x6e2)]);}}function _0x59caab(){const _0x2eb541=_0x239c7d;_0x4a5ced(),_0x2b7df1(_0x2eb541(0x110d));}function _0x4a5ced(){const _0x417d36=_0x239c7d,_0x5c7a8=document[_0x417d36(0x400)](_0x417d36(0x40c));_0x5c7a8['innerHTML']='';const _0x1729be=_0x4c8b14[_0x417d36(0xbea)][_0x7e1e9],_0x1ca8f4=_0x1729be['simulatedTaobaoHistory']||{},_0x2e3a5c=_0x1ca8f4[_0x417d36(0x9a0)]||[],_0x547bf8=_0x1ca8f4['totalBalance']||0x0,_0x3fe249=document[_0x417d36(0x2c9)](_0x417d36(0xf8e));_0x3fe249['style'][_0x417d36(0x32e)]=_0x417d36(0xc51),_0x3fe249[_0x417d36(0x1575)]=_0x417d36(0x9a8)+_0x547bf8[_0x417d36(0x2ea)](0x2)+_0x417d36(0x3d5),_0x5c7a8[_0x417d36(0x8f2)](_0x3fe249);const _0x4e0d71=document[_0x417d36(0x2c9)]('h3');_0x4e0d71[_0x417d36(0xde7)]=_0x417d36(0x626),_0x4e0d71[_0x417d36(0xa00)][_0x417d36(0x32e)]=_0x417d36(0x16a4),_0x5c7a8[_0x417d36(0x8f2)](_0x4e0d71);if(_0x2e3a5c[_0x417d36(0x8d6)]===0x0){_0x5c7a8[_0x417d36(0x1575)]+=_0x417d36(0x16aa);return;}_0x2e3a5c[_0x417d36(0xbdc)](_0x2c6a02=>{const _0x2042d7=_0x417d36,_0x58aa72=document['createElement'](_0x2042d7(0xf8e));_0x58aa72[_0x2042d7(0xa00)]['cssText']=_0x2042d7(0x97a),_0x58aa72['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x204px\x200;\x22>'+_0x2c6a02[_0x2042d7(0xe37)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin:\x200;\x22>'+_0x2c6a02['status']+_0x2042d7(0xf33)+(_0x2c6a02[_0x2042d7(0x34a)]||0x0)[_0x2042d7(0x2ea)](0x2)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x5c7a8[_0x2042d7(0x8f2)](_0x58aa72);});}async function _0x3ebbb2(){const _0x25aa7d=_0x239c7d;if(!_0x7e1e9)return;const _0x25a63a=_0x4c8b14['chats'][_0x7e1e9];if(!_0x25a63a)return;await _0x138765('请稍候...',_0x25aa7d(0xbd5)+_0x25a63a[_0x25aa7d(0xf3e)]+_0x25aa7d(0x62a));const {proxyUrl:_0x355981,apiKey:_0x5bb2a3,model:_0x2949ea}=_0x4c8b14[_0x25aa7d(0x814)];if(!_0x355981||!_0x5bb2a3||!_0x2949ea){alert('请先在API设置中配置好API信息。');return;}const _0x46e0ca=_0x4c8b14[_0x25aa7d(0x834)][_0x25aa7d(0xbf3)]===_0x25aa7d(0xa8f)||!_0x4c8b14[_0x25aa7d(0x834)][_0x25aa7d(0xbf3)]?'用户':_0x4c8b14[_0x25aa7d(0x834)][_0x25aa7d(0xbf3)],_0x5c305d=_0x25a63a[_0x25aa7d(0x1600)]&&_0x25a63a[_0x25aa7d(0x1600)]['length']>0x0?_0x25a63a['longTermMemory'][_0x25aa7d(0xd18)](_0x230cd1=>_0x25aa7d(0x1ee)+_0x4878ba(_0x230cd1[_0x25aa7d(0x287)])+')\x20'+_0x230cd1[_0x25aa7d(0x1109)])[_0x25aa7d(0xee1)]('\x0a'):'无',_0x1be272=_0x25a63a['settings'][_0x25aa7d(0xebb)]||0xa,_0x440fc8=_0x25a63a[_0x25aa7d(0x92c)][_0x25aa7d(0x69f)](-_0x1be272),_0x53d049=await _0x25ac7a(_0x440fc8,_0x7e1e9),_0x848e09=_0x53d049['map'](_0x162ff0=>(_0x162ff0[_0x25aa7d(0x71a)]==='user'?_0x46e0ca:_0x25a63a[_0x25aa7d(0xf3e)])+':\x20'+String(_0x162ff0[_0x25aa7d(0x1109)])['substring'](0x0,0x1e)+'...')[_0x25aa7d(0xee1)]('\x0a'),_0x3184bb=(_0x25a63a[_0x25aa7d(0xa37)][_0x25aa7d(0xb0d)]||[])['map'](_0x4295b4=>_0x4c8b14[_0x25aa7d(0xf57)][_0x25aa7d(0x821)](_0x51a74a=>_0x51a74a['id']===_0x4295b4))[_0x25aa7d(0x29d)](Boolean)[_0x25aa7d(0xd18)](_0x47177a=>_0x25aa7d(0x1606)+_0x47177a['name']+'》设定:\x0a'+_0x47177a[_0x25aa7d(0x1109)][_0x25aa7d(0x29d)](_0x1d043e=>_0x1d043e[_0x25aa7d(0x250)])[_0x25aa7d(0xd18)](_0x56944f=>'-\x20'+_0x56944f[_0x25aa7d(0x1109)])[_0x25aa7d(0xee1)]('\x0a'))[_0x25aa7d(0xee1)](''),_0x2d1d7f=_0x3eed43(_0x25a63a,0x3,'hours'),_0x543235=_0x3eed43(_0x25a63a,0x6,_0x25aa7d(0xf20)),_0x361179=_0x3eed43(_0x25a63a,0x9,_0x25aa7d(0xf20)),_0x296559=_0x3eed43(_0x25a63a,0x1,_0x25aa7d(0x72c)),_0x46fdaa=_0x3eed43(_0x25a63a,0x3,'days'),_0x264397=_0x3eed43(_0x25a63a,0x7,'days');let _0x3c3945='';if(_0x2d1d7f||_0x543235||_0x361179||_0x296559||_0x46fdaa||_0x264397){_0x3c3945+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x2d1d7f)_0x3c3945+=_0x2d1d7f;if(_0x543235)_0x3c3945+=_0x543235;if(_0x361179)_0x3c3945+=_0x361179;if(_0x2d1d7f||_0x543235||_0x361179)_0x3c3945+='\x0a';if(_0x296559)_0x3c3945+=_0x296559;if(_0x46fdaa)_0x3c3945+=_0x46fdaa;if(_0x264397)_0x3c3945+=_0x264397;}const _0x1b5d93=_0x25a63a[_0x25aa7d(0xa37)][_0x25aa7d(0x2ef)]||'(未设置)',_0x2bb23a=_0x25aa7d(0xe3e)+_0x25a63a[_0x25aa7d(0xf3e)]+_0x25aa7d(0x1674)+_0x25a63a[_0x25aa7d(0xa37)][_0x25aa7d(0xfea)]+_0x25aa7d(0x689)+_0x1b5d93+_0x25aa7d(0x11f1)+_0x5c305d+'\x0a'+_0x3184bb+'\x0a'+_0x3c3945+_0x25aa7d(0x10f4)+_0x46e0ca+'”的对话摘要**:\x0a'+_0x848e09+_0x25aa7d(0x284);try{const _0x3d509a=[{'role':_0x25aa7d(0x6d6),'content':_0x25aa7d(0x48b)}];let _0x3ceaee=_0x355981[_0x25aa7d(0xd1b)](_0x25aa7d(0x14cc)),_0x51f0f5=_0x3914a6(_0x2949ea,_0x5bb2a3,_0x2bb23a,_0x3d509a);const _0x4d134d=_0x3ceaee?await fetch(_0x51f0f5[_0x25aa7d(0x299)],_0x51f0f5[_0x25aa7d(0x55b)]):await fetch(_0x355981+_0x25aa7d(0x1611),{'method':_0x25aa7d(0x953),'headers':{'Content-Type':'application/json','Authorization':_0x25aa7d(0xcee)+_0x5bb2a3},'body':JSON[_0x25aa7d(0xea5)]({'model':_0x2949ea,'messages':[{'role':_0x25aa7d(0xaf6),'content':_0x2bb23a},..._0x3d509a],'temperature':_0x4c8b14[_0x25aa7d(0x14f1)]['apiTemperature']||0.9})});if(!_0x4d134d['ok']){const _0x211380=await _0x4d134d['json']()[_0x25aa7d(0x37a)](()=>null),_0x334962=_0x211380?.[_0x25aa7d(0x5d7)]?.['message']||_0x4d134d[_0x25aa7d(0x755)];throw new Error('API\x20错误:\x20'+_0x4d134d[_0x25aa7d(0x12c3)]+'\x20-\x20'+_0x334962);}const _0x515229=await _0x4d134d[_0x25aa7d(0x15d3)](),_0x583303=getGeminiResponseText(_0x515229),_0x533510=_0x583303['match'](/(\[[\s\S]*\])/);if(!_0x533510||!_0x533510[0x0])throw new Error(_0x25aa7d(0x131e)+_0x583303);const _0x53b132=_0x533510[0x0];let _0x4cdc03;try{_0x4cdc03=JSON[_0x25aa7d(0x13f7)](_0x53b132);}catch(_0x155869){throw new Error('解析AI返回的JSON时出错:\x20'+_0x155869[_0x25aa7d(0x6e2)]+_0x25aa7d(0xc72)+_0x583303);}if(!Array[_0x25aa7d(0x16a1)](_0x4cdc03))throw new Error(_0x25aa7d(0x7e2)+JSON[_0x25aa7d(0xea5)](_0x4cdc03));_0x25a63a[_0x25aa7d(0x421)]=_0x4cdc03[_0x25aa7d(0xd18)](_0x4c3a22=>({'id':Date[_0x25aa7d(0xecd)]()+Math['random'](),'title':_0x4c3a22['title'],'content':_0x4c3a22['content']})),await _0x54c587[_0x25aa7d(0xbea)]['put'](_0x25a63a),await _0x4d9adb();}catch(_0x3af328){console[_0x25aa7d(0x5d7)](_0x25aa7d(0xdb0),_0x3af328),await _0x138765(_0x25aa7d(0x321),_0x25aa7d(0xbe3)+_0x3af328[_0x25aa7d(0x6e2)]);}}async function _0x473c35(){const _0xa5899f=_0x239c7d;if(!_0x7e1e9)return;const _0x3b2e9f=_0x4c8b14[_0xa5899f(0xbea)][_0x7e1e9];if(!_0x3b2e9f)return;await _0x138765(_0xa5899f(0x13e9),'正在生成“'+_0x3b2e9f[_0xa5899f(0xf3e)]+_0xa5899f(0xd4c));const {proxyUrl:_0x33f200,apiKey:_0x5d1ec1,model:_0x4ce2a8}=_0x4c8b14['apiConfig'];if(!_0x33f200||!_0x5d1ec1||!_0x4ce2a8){alert(_0xa5899f(0x373));return;}const _0x1483c3=_0x4c8b14['qzoneSettings'][_0xa5899f(0xbf3)]===_0xa5899f(0xa8f)||!_0x4c8b14[_0xa5899f(0x834)][_0xa5899f(0xbf3)]?'用户':_0x4c8b14['qzoneSettings'][_0xa5899f(0xbf3)],_0x485403=_0x3b2e9f['longTermMemory']&&_0x3b2e9f[_0xa5899f(0x1600)]['length']>0x0?_0x3b2e9f[_0xa5899f(0x1600)][_0xa5899f(0xd18)](_0x15431a=>_0xa5899f(0x1ee)+_0x4878ba(_0x15431a[_0xa5899f(0x287)])+')\x20'+_0x15431a['content'])[_0xa5899f(0xee1)]('\x0a'):'无',_0x297ebf=_0x3b2e9f[_0xa5899f(0xa37)][_0xa5899f(0xebb)]||0xa,_0xacaa13=_0x3b2e9f[_0xa5899f(0x92c)][_0xa5899f(0x69f)](-_0x297ebf),_0x3bad69=await _0x25ac7a(_0xacaa13,_0x7e1e9),_0x5c6402=_0x3bad69['map'](_0x2afe94=>(_0x2afe94[_0xa5899f(0x71a)]==='user'?_0x1483c3:_0x3b2e9f['name'])+':\x20'+String(_0x2afe94['content'])[_0xa5899f(0x371)](0x0,0x1e)+_0xa5899f(0x166b))[_0xa5899f(0xee1)]('\x0a'),_0x484acb=(_0x3b2e9f[_0xa5899f(0xa37)]['linkedWorldBookIds']||[])[_0xa5899f(0xd18)](_0x161b84=>_0x4c8b14[_0xa5899f(0xf57)][_0xa5899f(0x821)](_0x111ed1=>_0x111ed1['id']===_0x161b84))[_0xa5899f(0x29d)](Boolean)['map'](_0x470bba=>_0xa5899f(0x1606)+_0x470bba[_0xa5899f(0xf3e)]+_0xa5899f(0x1150)+_0x470bba['content'][_0xa5899f(0x29d)](_0x284da5=>_0x284da5[_0xa5899f(0x250)])[_0xa5899f(0xd18)](_0x4872dd=>'-\x20'+_0x4872dd[_0xa5899f(0x1109)])['join']('\x0a'))['join'](''),_0x490939=_0x3eed43(_0x3b2e9f,0x3,_0xa5899f(0xf20)),_0x383716=_0x3eed43(_0x3b2e9f,0x6,'hours'),_0x12990b=_0x3eed43(_0x3b2e9f,0x9,_0xa5899f(0xf20)),_0x42d25b=_0x3eed43(_0x3b2e9f,0x1,_0xa5899f(0x72c)),_0x4cee76=_0x3eed43(_0x3b2e9f,0x3,_0xa5899f(0x72c)),_0x437620=_0x3eed43(_0x3b2e9f,0x7,'days');let _0x2f8e23='';if(_0x490939||_0x383716||_0x12990b||_0x42d25b||_0x4cee76||_0x437620){_0x2f8e23+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x490939)_0x2f8e23+=_0x490939;if(_0x383716)_0x2f8e23+=_0x383716;if(_0x12990b)_0x2f8e23+=_0x12990b;if(_0x490939||_0x383716||_0x12990b)_0x2f8e23+='\x0a';if(_0x42d25b)_0x2f8e23+=_0x42d25b;if(_0x4cee76)_0x2f8e23+=_0x4cee76;if(_0x437620)_0x2f8e23+=_0x437620;}const _0x5d7c26=_0xa5899f(0xe3e)+_0x3b2e9f[_0xa5899f(0xf3e)]+'”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近的“高德地图”出行足迹。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**'+new Date()[_0xa5899f(0x886)]()+_0xa5899f(0x13b9)+_0x3b2e9f[_0xa5899f(0xa37)][_0xa5899f(0xfea)]+_0xa5899f(0x11f1)+_0x485403+'\x0a'+_0x484acb+'\x0a'+_0x2f8e23+'\x0a-\x20**你最近和“'+_0x1483c3+_0xa5899f(0xeee)+_0x5c6402+'\x0a\x0a现在，请开始生成这组足迹记录。';try{const _0x133fb9=[{'role':_0xa5899f(0x6d6),'content':'请根据你的设定，生成你的高德地图足迹。'}];let _0x224635=_0x33f200[_0xa5899f(0xd1b)](_0xa5899f(0x14cc)),_0x48e14c=_0x3914a6(_0x4ce2a8,_0x5d1ec1,_0x5d7c26,_0x133fb9);const _0x3c594a=_0x224635?await fetch(_0x48e14c['url'],_0x48e14c[_0xa5899f(0x55b)]):await fetch(_0x33f200+_0xa5899f(0x1611),{'method':_0xa5899f(0x953),'headers':{'Content-Type':_0xa5899f(0xfae),'Authorization':_0xa5899f(0xcee)+_0x5d1ec1},'body':JSON['stringify']({'model':_0x4ce2a8,'messages':[{'role':_0xa5899f(0xaf6),'content':_0x5d7c26},..._0x133fb9],'temperature':_0x4c8b14[_0xa5899f(0x14f1)][_0xa5899f(0x216)]||0.9})});if(!_0x3c594a['ok'])throw new Error(_0xa5899f(0x7d5)+_0x3c594a[_0xa5899f(0x755)]);const _0x345d9c=await _0x3c594a[_0xa5899f(0x15d3)](),_0x175e3f=getGeminiResponseText(_0x345d9c),_0x13d1b1=_0x175e3f[_0xa5899f(0xbf7)](/(\[[\s\S]*\])/);if(!_0x13d1b1||!_0x13d1b1[0x0])throw new Error(_0xa5899f(0x131e)+_0x175e3f);const _0x5beda0=_0x13d1b1[0x0];let _0x11e7d8;try{_0x11e7d8=JSON[_0xa5899f(0x13f7)](_0x5beda0);}catch(_0xbb1639){throw new Error(_0xa5899f(0x7d7)+_0xbb1639['message']+_0xa5899f(0xc72)+_0x175e3f);}_0x3b2e9f[_0xa5899f(0x930)]=_0x11e7d8,await _0x54c587['chats'][_0xa5899f(0x4cb)](_0x3b2e9f),await _0x54cdd0();}catch(_0x5746e0){console[_0xa5899f(0x5d7)](_0xa5899f(0xeb5),_0x5746e0),await _0x138765(_0xa5899f(0x321),_0xa5899f(0x113f)+_0x5746e0[_0xa5899f(0x6e2)]);}}function _0x54cdd0(){const _0x5ee93c=_0x239c7d,_0x18968c=document[_0x5ee93c(0x400)]('char-amap-list');_0x18968c[_0x5ee93c(0x1575)]='';if(!_0x7e1e9)return;const _0x161446=_0x4c8b14[_0x5ee93c(0xbea)][_0x7e1e9],_0x27c6a5=_0x161446['simulatedAmapHistory']||[];if(_0x27c6a5[_0x5ee93c(0x8d6)]===0x0){_0x18968c[_0x5ee93c(0x1575)]=_0x5ee93c(0x820);return;}_0x27c6a5[_0x5ee93c(0xbdc)](_0x10332c=>{const _0x3c9599=_0x5ee93c,_0x5a94ed=document['createElement'](_0x3c9599(0xf8e));_0x5a94ed[_0x3c9599(0x4e1)]=_0x3c9599(0x9fe);let _0x5ad2e1='';if(_0x10332c[_0x3c9599(0xff9)]){const _0x18f3b3=_0x3c9599(0x9c3)+encodeURIComponent(_0x10332c['image_prompt']);_0x5ad2e1='<div\x20class=\x22amap-item-photo\x22\x20style=\x22background-image:\x20url(\x27'+_0x18f3b3+'\x27)\x22\x20data-comment=\x22'+_0x10332c[_0x3c9599(0x83c)]+_0x3c9599(0x822);}const _0x102281=_0x10332c[_0x3c9599(0x287)]?_0x4878ba(new Date(_0x10332c['timestamp'])[_0x3c9599(0xff4)]()):_0x3c9599(0xc7f);_0x5a94ed[_0x3c9599(0x1575)]=_0x3c9599(0x7ad)+_0x10332c['locationName']+_0x3c9599(0x468)+_0x10332c[_0x3c9599(0x2f2)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-comment\x22>'+_0x10332c[_0x3c9599(0x83c)][_0x3c9599(0xe19)](/\n/g,'<br>')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5ad2e1+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-footer\x22>'+_0x102281+_0x3c9599(0x1132),_0x18968c[_0x3c9599(0x8f2)](_0x5a94ed);});}async function _0x320e45(){const _0x5b3b7b=_0x239c7d;if(!_0x7e1e9)return;const _0x128f2b=_0x4c8b14[_0x5b3b7b(0xbea)][_0x7e1e9];if(!_0x128f2b)return;await _0x138765('请稍候...','正在分析“'+_0x128f2b['name']+_0x5b3b7b(0xa0f));const {proxyUrl:_0x14cde4,apiKey:_0x1eeca0,model:_0x2d0a0a}=_0x4c8b14[_0x5b3b7b(0x814)];if(!_0x14cde4||!_0x1eeca0||!_0x2d0a0a){alert('API未配置，无法生成内容。');return;}const _0x5eae33=_0x4c8b14['qzoneSettings'][_0x5b3b7b(0xbf3)]===_0x5b3b7b(0xa8f)||!_0x4c8b14[_0x5b3b7b(0x834)][_0x5b3b7b(0xbf3)]?'用户':_0x4c8b14[_0x5b3b7b(0x834)]['nickname'],_0x561335=_0x128f2b[_0x5b3b7b(0x1600)]&&_0x128f2b['longTermMemory'][_0x5b3b7b(0x8d6)]>0x0?_0x128f2b[_0x5b3b7b(0x1600)][_0x5b3b7b(0xd18)](_0x2784fa=>_0x5b3b7b(0x1ee)+_0x4878ba(_0x2784fa['timestamp'])+')\x20'+_0x2784fa[_0x5b3b7b(0x1109)])[_0x5b3b7b(0xee1)]('\x0a'):'无',_0xb1af84=_0x128f2b[_0x5b3b7b(0xa37)]['maxMemory']||0xa,_0x2f405b=_0x128f2b[_0x5b3b7b(0x92c)][_0x5b3b7b(0x69f)](-_0xb1af84),_0x5f3460=await _0x25ac7a(_0x2f405b,_0x7e1e9),_0xd85f50=_0x5f3460[_0x5b3b7b(0xd18)](_0x2de9ce=>(_0x2de9ce[_0x5b3b7b(0x71a)]==='user'?_0x5eae33:_0x128f2b[_0x5b3b7b(0xf3e)])+':\x20'+String(_0x2de9ce['content'])[_0x5b3b7b(0x371)](0x0,0x1e)+_0x5b3b7b(0x166b))[_0x5b3b7b(0xee1)]('\x0a'),_0x1c3872=(_0x128f2b['settings'][_0x5b3b7b(0xb0d)]||[])[_0x5b3b7b(0xd18)](_0x1ab05d=>_0x4c8b14[_0x5b3b7b(0xf57)]['find'](_0x51101f=>_0x51101f['id']===_0x1ab05d))[_0x5b3b7b(0x29d)](Boolean)[_0x5b3b7b(0xd18)](_0x5ac269=>_0x5b3b7b(0x1606)+_0x5ac269[_0x5b3b7b(0xf3e)]+_0x5b3b7b(0x1150)+_0x5ac269[_0x5b3b7b(0x1109)]['filter'](_0xd9ed2b=>_0xd9ed2b[_0x5b3b7b(0x250)])[_0x5b3b7b(0xd18)](_0x240856=>'-\x20'+_0x240856[_0x5b3b7b(0x1109)])[_0x5b3b7b(0xee1)]('\x0a'))[_0x5b3b7b(0xee1)](''),_0x164373=_0x3eed43(_0x128f2b,0x3,'hours'),_0x1130b1=_0x3eed43(_0x128f2b,0x6,_0x5b3b7b(0xf20)),_0x49629b=_0x3eed43(_0x128f2b,0x9,_0x5b3b7b(0xf20)),_0x427b28=_0x3eed43(_0x128f2b,0x1,_0x5b3b7b(0x72c)),_0x101d70=_0x3eed43(_0x128f2b,0x3,_0x5b3b7b(0x72c)),_0x353574=_0x3eed43(_0x128f2b,0x7,_0x5b3b7b(0x72c));let _0x5c1602='';if(_0x164373||_0x1130b1||_0x49629b||_0x427b28||_0x101d70||_0x353574){_0x5c1602+=_0x5b3b7b(0x116b);if(_0x164373)_0x5c1602+=_0x164373;if(_0x1130b1)_0x5c1602+=_0x1130b1;if(_0x49629b)_0x5c1602+=_0x49629b;if(_0x164373||_0x1130b1||_0x49629b)_0x5c1602+='\x0a';if(_0x427b28)_0x5c1602+=_0x427b28;if(_0x101d70)_0x5c1602+=_0x101d70;if(_0x353574)_0x5c1602+=_0x353574;}const _0x3f968f=_0x5b3b7b(0xe3e)+_0x128f2b[_0x5b3b7b(0xf3e)]+'”，并根据其人设、记忆和最近的互动，虚构出TA最近一天的【手机App屏幕使用时间】记录，总共约20条。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与多样性**:\x20生成的App列表【不必局限于】Cphone主屏幕上已有的App。你可以自由地虚构TA可能使用的其他App，例如\x20Instagram,\x20Twitter,\x20各种游戏\x20(如：原神,\x20王者荣耀),\x20视频App\x20(如：抖音,\x20YouTube),\x20学习或工作软件等，这能更好地体现角色的隐藏兴趣和生活习惯。\x0a2.\x20\x20**合理性**:\x20使用时长和App类型必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一个App的使用记录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22appName\x22:\x20\x22App的名称\x20(例如:\x20微信,\x20微博,\x20原神)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22usageTimeMinutes\x22:\x20125,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22category\x22:\x20\x22App的分类\x20(例如:\x20社交,\x20游戏,\x20影音,\x20工具,\x20阅读,\x20购物)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这个App【图标】的、简洁的【英文】关键词。风格必须是\x20modern\x20app\x20icon,\x20flat\x20design,\x20simple,\x20clean\x20background\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x128f2b[_0x5b3b7b(0xa37)][_0x5b3b7b(0xfea)]+_0x5b3b7b(0x11f1)+_0x561335+'\x0a'+_0x1c3872+'\x0a'+_0x5c1602+_0x5b3b7b(0x10f4)+_0x5eae33+_0x5b3b7b(0xeee)+_0xd85f50+_0x5b3b7b(0x6a3);try{const _0x815dd9=[{'role':_0x5b3b7b(0x6d6),'content':_0x5b3b7b(0x110a)}];let _0x458fd7=_0x14cde4[_0x5b3b7b(0xd1b)](_0x5b3b7b(0x14cc)),_0x3bec60=_0x3914a6(_0x2d0a0a,_0x1eeca0,_0x3f968f,_0x815dd9);const _0x993a65=_0x458fd7?await fetch(_0x3bec60[_0x5b3b7b(0x299)],_0x3bec60[_0x5b3b7b(0x55b)]):await fetch(_0x14cde4+'/v1/chat/completions',{'method':_0x5b3b7b(0x953),'headers':{'Content-Type':_0x5b3b7b(0xfae),'Authorization':_0x5b3b7b(0xcee)+_0x1eeca0},'body':JSON[_0x5b3b7b(0xea5)]({'model':_0x2d0a0a,'messages':[{'role':_0x5b3b7b(0xaf6),'content':_0x3f968f},..._0x815dd9],'temperature':_0x4c8b14[_0x5b3b7b(0x14f1)][_0x5b3b7b(0x216)]||0.9})});if(!_0x993a65['ok'])throw new Error(_0x5b3b7b(0x7d5)+_0x993a65[_0x5b3b7b(0x755)]);const _0x4e3bdd=await _0x993a65[_0x5b3b7b(0x15d3)](),_0xe33c84=getGeminiResponseText(_0x4e3bdd),_0x828c58=_0xe33c84['replace'](/^```json\s*/,'')[_0x5b3b7b(0xe19)](/```$/,''),_0x19710c=JSON[_0x5b3b7b(0x13f7)](_0x828c58);_0x128f2b['simulatedAppUsage']=_0x19710c,await _0x54c587['chats'][_0x5b3b7b(0x4cb)](_0x128f2b),await _0x49dc6e();}catch(_0x51ec55){console['error'](_0x5b3b7b(0x868),_0x51ec55),await _0x138765(_0x5b3b7b(0x321),_0x5b3b7b(0xb42)+_0x51ec55[_0x5b3b7b(0x6e2)]);}}function _0x49dc6e(){const _0x40df7c=_0x239c7d,_0x124c63=document['getElementById'](_0x40df7c(0x51f));_0x124c63['innerHTML']='';if(!_0x7e1e9)return;const _0x291050=_0x4c8b14[_0x40df7c(0xbea)][_0x7e1e9],_0x4b6086=(_0x291050[_0x40df7c(0x12e0)]||[])[_0x40df7c(0x968)]((_0x3505e1,_0x4d55df)=>_0x4d55df[_0x40df7c(0x14b3)]-_0x3505e1['usageTimeMinutes']);if(_0x4b6086[_0x40df7c(0x8d6)]===0x0){_0x124c63[_0x40df7c(0x1575)]=_0x40df7c(0xc97);return;}_0x4b6086[_0x40df7c(0xbdc)](_0x2ddd68=>{const _0x4e35fd=_0x40df7c,_0x731ca8=document[_0x4e35fd(0x2c9)](_0x4e35fd(0xf8e));_0x731ca8[_0x4e35fd(0x4e1)]='char-usage-item';const _0x46be09=Math['floor'](_0x2ddd68[_0x4e35fd(0x14b3)]/0x3c),_0x784e0d=_0x2ddd68[_0x4e35fd(0x14b3)]%0x3c;let _0x3b5852='';if(_0x46be09>0x0)_0x3b5852+=_0x46be09+'小时';if(_0x784e0d>0x0)_0x3b5852+=_0x784e0d+'分钟';if(!_0x3b5852)_0x3b5852=_0x4e35fd(0x4ff);const _0x39cda1=_0x2ddd68[_0x4e35fd(0xff9)]||_0x4e35fd(0x1212)+_0x2ddd68[_0x4e35fd(0xc77)]+_0x4e35fd(0x9fd),_0x26b060=_0x4e35fd(0x9c3)+encodeURIComponent(_0x39cda1);_0x731ca8['innerHTML']=_0x4e35fd(0x2a0)+_0x26b060+_0x4e35fd(0x111e)+_0x2ddd68[_0x4e35fd(0xc77)]+_0x4e35fd(0xde6)+_0x2ddd68['category']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-time\x22>'+_0x3b5852+_0x4e35fd(0x1132),_0x124c63[_0x4e35fd(0x8f2)](_0x731ca8);});}async function _0x3bb46c(){const _0x26000f=_0x239c7d;if(!_0x7e1e9)return;const _0xf6fe5=_0x4c8b14[_0x26000f(0xbea)][_0x7e1e9];if(!_0xf6fe5)return;await _0x138765(_0x26000f(0x13e9),_0x26000f(0xbd5)+_0xf6fe5[_0x26000f(0xf3e)]+_0x26000f(0xcab));const {proxyUrl:_0x15bafb,apiKey:_0x9b3a97,model:_0x455807}=_0x4c8b14['apiConfig'];if(!_0x15bafb||!_0x9b3a97||!_0x455807){alert('请先在API设置中配置好API信息。');return;}const _0x2fd422=_0x4c8b14['qzoneSettings'][_0x26000f(0xbf3)]==='{{user}}'||!_0x4c8b14['qzoneSettings']['nickname']?'用户':_0x4c8b14[_0x26000f(0x834)][_0x26000f(0xbf3)],_0x22c294=_0xf6fe5['longTermMemory']&&_0xf6fe5[_0x26000f(0x1600)][_0x26000f(0x8d6)]>0x0?_0xf6fe5[_0x26000f(0x1600)]['map'](_0x4d8dbc=>_0x26000f(0x1ee)+_0x4878ba(_0x4d8dbc[_0x26000f(0x287)])+')\x20'+_0x4d8dbc['content'])[_0x26000f(0xee1)]('\x0a'):'无',_0x31585c=_0xf6fe5[_0x26000f(0xa37)][_0x26000f(0xebb)]||0xa,_0x563533=_0xf6fe5[_0x26000f(0x92c)]['slice'](-_0x31585c),_0x1b5ac4=await _0x25ac7a(_0x563533,_0x7e1e9),_0xc3522d=_0x1b5ac4['map'](_0x47c1c5=>(_0x47c1c5[_0x26000f(0x71a)]===_0x26000f(0x6d6)?_0x2fd422:_0xf6fe5[_0x26000f(0xf3e)])+':\x20'+String(_0x47c1c5[_0x26000f(0x1109)])[_0x26000f(0x371)](0x0,0x1e)+_0x26000f(0x166b))['join']('\x0a'),_0x539039=(_0xf6fe5['settings']['linkedWorldBookIds']||[])[_0x26000f(0xd18)](_0x536e8b=>_0x4c8b14[_0x26000f(0xf57)][_0x26000f(0x821)](_0x1c30ea=>_0x1c30ea['id']===_0x536e8b))[_0x26000f(0x29d)](Boolean)[_0x26000f(0xd18)](_0x1b50d0=>_0x26000f(0x1606)+_0x1b50d0['name']+_0x26000f(0x1150)+_0x1b50d0[_0x26000f(0x1109)]['filter'](_0x543e3f=>_0x543e3f[_0x26000f(0x250)])[_0x26000f(0xd18)](_0x22dbd1=>'-\x20'+_0x22dbd1['content'])['join']('\x0a'))[_0x26000f(0xee1)](''),_0x4f5558='\x0a#\x20你的任务\x0a你是一个虚拟音乐品味模拟器。你的任务是扮演角色“'+_0xf6fe5[_0x26000f(0xf3e)]+'”，并根据其人设、记忆和最近的互动，挑选出【14到18首】最能代表TA此刻心情或品味的歌曲。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20歌单必须完全符合角色的性格、爱好和生活背景。\x0a2.\x20\x20**多样性**:\x20歌曲风格可以多样，但必须逻辑自洽。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一首歌，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22songName\x22:\x20\x22歌曲的准确名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22artistName\x22:\x20\x22歌曲的准确艺术家/歌手名\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0xf6fe5[_0x26000f(0xa37)][_0x26000f(0xfea)]+'\x0a-\x20**你的长期记忆**:\x0a'+_0x22c294+'\x0a'+_0x539039+_0x26000f(0x10f4)+_0x2fd422+'”的对话摘要**:\x0a'+_0xc3522d+_0x26000f(0xca5);try{const _0x2d8a85=[{'role':_0x26000f(0x6d6),'content':_0x26000f(0xff0)}];let _0x170609=_0x15bafb[_0x26000f(0xd1b)](_0x26000f(0x14cc)),_0x4e5451=_0x3914a6(_0x455807,_0x9b3a97,_0x4f5558,_0x2d8a85);const _0x3cac7f=_0x170609?await fetch(_0x4e5451[_0x26000f(0x299)],_0x4e5451['data']):await fetch(_0x15bafb+_0x26000f(0x1611),{'method':_0x26000f(0x953),'headers':{'Content-Type':_0x26000f(0xfae),'Authorization':_0x26000f(0xcee)+_0x9b3a97},'body':JSON[_0x26000f(0xea5)]({'model':_0x455807,'messages':[{'role':_0x26000f(0xaf6),'content':_0x4f5558},..._0x2d8a85],'temperature':_0x4c8b14[_0x26000f(0x14f1)][_0x26000f(0x216)]||0x1})});if(!_0x3cac7f['ok'])throw new Error(_0x26000f(0x7d5)+_0x3cac7f[_0x26000f(0x755)]);const _0x5afea7=await _0x3cac7f[_0x26000f(0x15d3)](),_0x391f3d=getGeminiResponseText(_0x5afea7),_0x4031fc=_0x391f3d[_0x26000f(0xe19)](/^```json\s*/,'')['replace'](/```$/,''),_0x1696c1=JSON['parse'](_0x4031fc);await _0x138765(_0x26000f(0x13e9),_0x26000f(0xeff)+_0x1696c1[_0x26000f(0x8d6)]+_0x26000f(0x870));const _0x5183b0=_0x1696c1[_0x26000f(0xd18)](async _0x10a849=>{const _0x281777=_0x26000f;let _0xf2aab9=await _0x1f3b64(_0x10a849[_0x281777(0xf0b)],_0x10a849[_0x281777(0x1313)]);(!_0xf2aab9||_0xf2aab9['length']===0x0)&&(_0xf2aab9=await _0x4d9fee(_0x10a849[_0x281777(0xf0b)]));if(_0xf2aab9[_0x281777(0x8d6)]>0x0)return _0x31dc92(_0xf2aab9[0x0]);return console[_0x281777(0x75e)](_0x281777(0x10e4)+_0x10a849[_0x281777(0xf0b)]+_0x281777(0x1477)+_0x10a849[_0x281777(0x1313)]+'”'),null;}),_0x157e58=(await Promise[_0x26000f(0x875)](_0x5183b0))[_0x26000f(0x29d)](Boolean);_0xf6fe5[_0x26000f(0xc5e)]=_0x157e58,await _0x54c587[_0x26000f(0xbea)]['put'](_0xf6fe5),await _0x236877();}catch(_0x518697){console[_0x26000f(0x5d7)](_0x26000f(0x1680),_0x518697),await _0x138765(_0x26000f(0x321),_0x26000f(0xf3b)+_0x518697[_0x26000f(0x6e2)]);}}function _0x236877(){const _0x578d3d=_0x239c7d,_0x21f81b=document[_0x578d3d(0x400)](_0x578d3d(0x14c6));_0x21f81b[_0x578d3d(0x1575)]='';if(!_0x7e1e9)return;const _0x1bee16=_0x4c8b14[_0x578d3d(0xbea)][_0x7e1e9],_0x27d36d=_0x1bee16[_0x578d3d(0xc5e)]||[];if(_0x27d36d['length']===0x0){_0x21f81b[_0x578d3d(0x1575)]=_0x578d3d(0xf3a);return;}_0x27d36d['forEach']((_0x40646b,_0x439b91)=>{const _0x86c2d=_0x578d3d,_0x7b98dd=document['createElement'](_0x86c2d(0xf8e));_0x7b98dd['className']=_0x86c2d(0x1599),_0x7b98dd[_0x86c2d(0x1575)]=_0x86c2d(0x146e)+_0x40646b['cover']+_0x86c2d(0x145f)+_0x40646b[_0x86c2d(0xf3e)]+_0x86c2d(0x1213)+_0x40646b[_0x86c2d(0x833)]+_0x86c2d(0x1087),_0x7b98dd['addEventListener']('click',()=>_0x1782be(_0x439b91,_0x27d36d)),_0x21f81b[_0x86c2d(0x8f2)](_0x7b98dd);});}let _0x19e02d={'currentPlaylist':[],'currentIndex':-0x1,'isPlaying':![],'playMode':'order','lrcUpdateInterval':null,'parsedLyrics':[],'currentLyricIndex':-0x1};function _0x1782be(_0x1b33f8,_0x5a1a54){const _0x45c7ee=_0x239c7d,_0x37936e=document[_0x45c7ee(0x400)](_0x45c7ee(0x5b1)),_0x155a48=document[_0x45c7ee(0x400)]('char-music-player-modal');if(_0x19e02d[_0x45c7ee(0x1390)])clearInterval(_0x19e02d[_0x45c7ee(0x1390)]);_0x37936e['pause'](),_0x19e02d[_0x45c7ee(0xd0c)]=_0x5a1a54,_0x19e02d[_0x45c7ee(0xbf0)]=_0x1b33f8;const _0x10054c=_0x5a1a54[_0x1b33f8];if(!_0x10054c){console[_0x45c7ee(0x5d7)](_0x45c7ee(0x547));return;}document[_0x45c7ee(0x400)]('char-music-player-title')[_0x45c7ee(0xde7)]=_0x10054c[_0x45c7ee(0xf3e)],document['getElementById'](_0x45c7ee(0x92d))[_0x45c7ee(0xde7)]=_0x10054c[_0x45c7ee(0x833)],document[_0x45c7ee(0x400)](_0x45c7ee(0xad2))[_0x45c7ee(0x912)]=_0x10054c[_0x45c7ee(0x554)],_0x19e02d[_0x45c7ee(0x7ee)]=_0x4a1132(_0x10054c[_0x45c7ee(0x121f)]||''),_0x1a1b80();if(_0x10054c['isLocal']){const _0x12d9b6=new Blob([_0x10054c[_0x45c7ee(0x912)]],{'type':_0x10054c[_0x45c7ee(0xb65)]||_0x45c7ee(0x2a6)});_0x37936e[_0x45c7ee(0x912)]=URL['createObjectURL'](_0x12d9b6);}else _0x37936e['src']=_0x10054c[_0x45c7ee(0x912)];_0x37936e[_0x45c7ee(0x582)]()[_0x45c7ee(0x37a)](_0xa4f636=>console['error']('音频播放失败:',_0xa4f636)),_0x37936e[_0x45c7ee(0x824)]=()=>{const _0x3bf050=_0x45c7ee;document[_0x3bf050(0x400)](_0x3bf050(0x487))[_0x3bf050(0xde7)]=_0xb1f354(_0x37936e[_0x3bf050(0x4ee)]),_0x19e02d[_0x3bf050(0x1390)]=setInterval(_0x212dcc,0x3e8);},_0x155a48['classList'][_0x45c7ee(0x12b6)](_0x45c7ee(0x9eb));}function _0x3c281c(){const _0x34d325=_0x239c7d,_0x50ddaf=document[_0x34d325(0x400)](_0x34d325(0x929));_0x50ddaf[_0x34d325(0xb08)]['remove']('visible'),document[_0x34d325(0x400)]('char-music-restore-btn')[_0x34d325(0xa00)]['display']=_0x34d325(0x375);}function _0x13c4eb(){const _0x3bd471=_0x239c7d,_0x1fc99b=document[_0x3bd471(0x400)]('char-music-player-modal');_0x1fc99b[_0x3bd471(0xb08)][_0x3bd471(0x12b6)](_0x3bd471(0x9eb)),document[_0x3bd471(0x400)](_0x3bd471(0x7c5))[_0x3bd471(0xa00)]['display']='none';}function _0x5ae1ad(){const _0x32cc26=_0x239c7d,_0x34292f=document[_0x32cc26(0x400)](_0x32cc26(0x929)),_0x4edaea=document[_0x32cc26(0x400)]('char-audio-player');if(_0x19e02d[_0x32cc26(0x1390)])clearInterval(_0x19e02d['lrcUpdateInterval']);_0x4edaea[_0x32cc26(0x1385)](),_0x34292f['classList'][_0x32cc26(0xc46)](_0x32cc26(0x9eb)),_0x19e02d[_0x32cc26(0x138e)]=![],document[_0x32cc26(0x400)]('char-vinyl-container')['classList'][_0x32cc26(0xc46)](_0x32cc26(0x7cd)),document[_0x32cc26(0x400)](_0x32cc26(0x7c5))[_0x32cc26(0xa00)][_0x32cc26(0xb1a)]=_0x32cc26(0x165b);}function _0x212dcc(){const _0x329da1=_0x239c7d,_0x4348f3=document[_0x329da1(0x400)]('char-audio-player');if(!_0x4348f3[_0x329da1(0x4ee)])return;const _0x70f0a7=_0x4348f3[_0x329da1(0x1592)],_0x147066=_0x4348f3['duration'];document['getElementById'](_0x329da1(0x1503))[_0x329da1(0xa00)]['width']=_0x70f0a7/_0x147066*0x64+'%',document['getElementById'](_0x329da1(0x150d))[_0x329da1(0xde7)]=_0xb1f354(_0x70f0a7),_0x593136(_0x70f0a7);}function _0x1a1b80(){const _0x292f90=_0x239c7d,_0x279061=document[_0x292f90(0x400)](_0x292f90(0x721));_0x279061[_0x292f90(0x1575)]='',_0x19e02d[_0x292f90(0xb7b)]=-0x1;const _0x4352ad=document[_0x292f90(0x2c9)]('div');_0x4352ad['id']=_0x292f90(0x588),_0x4352ad[_0x292f90(0xa00)][_0x292f90(0x139d)]=_0x292f90(0x15dd),_0x279061[_0x292f90(0x8f2)](_0x4352ad);if(!_0x19e02d[_0x292f90(0x7ee)]||_0x19e02d[_0x292f90(0x7ee)][_0x292f90(0x8d6)]===0x0){_0x4352ad[_0x292f90(0x1575)]=_0x292f90(0xbc5);return;}_0x19e02d[_0x292f90(0x7ee)][_0x292f90(0xbdc)]((_0x1d4569,_0xc89314)=>{const _0x22ee48=_0x292f90,_0x1e5474=document[_0x22ee48(0x2c9)]('p');_0x1e5474['textContent']=_0x1d4569[_0x22ee48(0x117f)],_0x1e5474[_0x22ee48(0xd61)]['index']=_0xc89314,_0x1e5474[_0x22ee48(0xa00)]['margin']='0',_0x1e5474[_0x22ee48(0xa00)][_0x22ee48(0x15cf)]='5px\x200',_0x1e5474[_0x22ee48(0xa00)][_0x22ee48(0x168d)]='#888',_0x1e5474[_0x22ee48(0xa00)][_0x22ee48(0x139d)]=_0x22ee48(0x109e),_0x4352ad[_0x22ee48(0x8f2)](_0x1e5474);});}function _0x593136(_0x2d2c87){const _0x362089=_0x239c7d,_0x13e4a1=_0x19e02d['parsedLyrics'];if(_0x13e4a1[_0x362089(0x8d6)]===0x0)return;let _0x4f40f0=-0x1;for(let _0x474754=0x0;_0x474754<_0x13e4a1[_0x362089(0x8d6)];_0x474754++){if(_0x2d2c87>=_0x13e4a1[_0x474754][_0x362089(0xc27)])_0x4f40f0=_0x474754;else break;}if(_0x4f40f0===_0x19e02d[_0x362089(0xb7b)])return;_0x19e02d['currentLyricIndex']=_0x4f40f0;const _0x4432c0=document[_0x362089(0x400)](_0x362089(0x588));if(!_0x4432c0)return;const _0x3537b9=_0x4432c0[_0x362089(0x527)]('p');_0x3537b9['forEach'](_0x42da6c=>{const _0x4d109f=_0x362089;_0x42da6c[_0x4d109f(0xb08)][_0x4d109f(0xc46)]('active'),_0x42da6c[_0x4d109f(0xa00)][_0x4d109f(0x168d)]='#888',_0x42da6c[_0x4d109f(0xa00)][_0x4d109f(0x8ea)]=_0x4d109f(0x911);});if(_0x4f40f0>-0x1){const _0xb3dc67=_0x4432c0[_0x362089(0x13ef)](_0x362089(0xc96)+_0x4f40f0+'\x22]');if(_0xb3dc67){_0xb3dc67[_0x362089(0xb08)][_0x362089(0x12b6)](_0x362089(0x5d6)),_0xb3dc67['style'][_0x362089(0x168d)]=_0x362089(0xa01),_0xb3dc67['style'][_0x362089(0xe40)]=_0x362089(0x58f),_0xb3dc67[_0x362089(0xa00)][_0x362089(0x8ea)]=_0x362089(0x8d4);const _0x3b6a86=document[_0x362089(0x400)](_0x362089(0x721))[_0x362089(0x433)],_0x1d2a8b=_0x3b6a86/0x2-_0xb3dc67[_0x362089(0xf1b)]-_0xb3dc67[_0x362089(0x433)]/0x2;_0x4432c0[_0x362089(0xa00)][_0x362089(0x8ea)]=_0x362089(0x75a)+_0x1d2a8b+_0x362089(0x11e8);}}}function _0x489a0d(){const _0x1f8106=_0x239c7d;if(_0x19e02d[_0x1f8106(0xd0c)][_0x1f8106(0x8d6)]===0x0)return;let _0x30f75c;switch(_0x19e02d[_0x1f8106(0xf2e)]){case'random':_0x30f75c=Math[_0x1f8106(0x1381)](Math['random']()*_0x19e02d[_0x1f8106(0xd0c)][_0x1f8106(0x8d6)]);break;case _0x1f8106(0x14d3):_0x1782be(_0x19e02d[_0x1f8106(0xd0c)][_0x19e02d[_0x1f8106(0xbf0)]]);return;case'order':default:_0x30f75c=(_0x19e02d['currentIndex']+0x1)%_0x19e02d[_0x1f8106(0xd0c)][_0x1f8106(0x8d6)];break;}_0x1782be(_0x30f75c,_0x19e02d[_0x1f8106(0xd0c)]);}function _0xe808ab(){const _0x30e1ad=_0x239c7d;if(_0x19e02d[_0x30e1ad(0xd0c)]['length']===0x0)return;const _0x2d081d=(_0x19e02d[_0x30e1ad(0xbf0)]-0x1+_0x19e02d['currentPlaylist'][_0x30e1ad(0x8d6)])%_0x19e02d['currentPlaylist'][_0x30e1ad(0x8d6)];_0x1782be(_0x2d081d,_0x19e02d[_0x30e1ad(0xd0c)]);}function _0x2b8116(){const _0x283417=_0x239c7d,_0x3f4173=['order','random','single'],_0x1db394=_0x3f4173[_0x283417(0xd53)](_0x19e02d[_0x283417(0xf2e)]);_0x19e02d[_0x283417(0xf2e)]=_0x3f4173[(_0x1db394+0x1)%_0x3f4173[_0x283417(0x8d6)]],document[_0x283417(0x400)](_0x283417(0x11d2))['textContent']={'order':'顺序','random':'随机','single':'单曲'}[_0x19e02d[_0x283417(0xf2e)]];}function _0x39d132(){const _0x2f3a3e=_0x239c7d,_0xd6f637=document['getElementById'](_0x2f3a3e(0x5b1)),_0x3c6c56=document['getElementById']('char-music-play-pause-btn'),_0x19ce72=document[_0x2f3a3e(0x400)]('char-vinyl-container');_0x3c6c56[_0x2f3a3e(0x501)](_0x2f3a3e(0x15ad),()=>{const _0x3e301d=_0x2f3a3e;if(_0xd6f637[_0x3e301d(0x317)]){if(_0x19e02d[_0x3e301d(0xbf0)]>-0x1)_0xd6f637[_0x3e301d(0x582)]();}else _0xd6f637[_0x3e301d(0x1385)]();}),_0xd6f637['onplay']=()=>{const _0x5a2733=_0x2f3a3e;_0x3c6c56[_0x5a2733(0x1575)]=_0x5a2733(0x384),_0x19ce72[_0x5a2733(0xb08)][_0x5a2733(0x12b6)](_0x5a2733(0x7cd)),_0x19e02d[_0x5a2733(0x138e)]=!![];},_0xd6f637[_0x2f3a3e(0x10e2)]=()=>{const _0x2f0816=_0x2f3a3e;_0x3c6c56[_0x2f0816(0x1575)]=_0x2f0816(0x4db),_0x19ce72[_0x2f0816(0xb08)][_0x2f0816(0xc46)](_0x2f0816(0x7cd)),_0x19e02d[_0x2f0816(0x138e)]=![];},_0xd6f637[_0x2f3a3e(0x10f0)]=()=>{const _0x2c6064=_0x2f3a3e;_0x19ce72[_0x2c6064(0xb08)][_0x2c6064(0xc46)](_0x2c6064(0x7cd)),_0x19e02d[_0x2c6064(0x138e)]=![],_0x489a0d();},document[_0x2f3a3e(0x400)](_0x2f3a3e(0x389))['addEventListener'](_0x2f3a3e(0x15ad),_0xe808ab),document[_0x2f3a3e(0x400)]('char-music-next-btn')[_0x2f3a3e(0x501)](_0x2f3a3e(0x15ad),_0x489a0d),document[_0x2f3a3e(0x400)](_0x2f3a3e(0x11d2))[_0x2f3a3e(0x501)]('click',_0x2b8116),document['getElementById'](_0x2f3a3e(0x411))[_0x2f3a3e(0x501)](_0x2f3a3e(0x15ad),_0x1559e2=>{const _0x35217e=_0x2f3a3e;if(!_0xd6f637[_0x35217e(0x4ee)])return;const _0x3add6d=_0x1559e2['currentTarget'],_0x3de8ab=_0x1559e2[_0x35217e(0xe77)];_0xd6f637[_0x35217e(0x1592)]=_0x3de8ab/_0x3add6d[_0x35217e(0x13aa)]*_0xd6f637[_0x35217e(0x4ee)];});}async function _0x20dc01(){const _0x5628aa=_0x239c7d,_0x3bac17=document['getElementById']('douban-posts-list');_0x3bac17[_0x5628aa(0x1575)]='';const _0x505724=await _0x54c587[_0x5628aa(0xa7f)]['orderBy']('timestamp')[_0x5628aa(0xfc1)]()['toArray']();if(_0x505724[_0x5628aa(0x8d6)]===0x0){_0x3bac17[_0x5628aa(0x1575)]=_0x5628aa(0xcaa);return;}_0x505724[_0x5628aa(0xbdc)](_0x1bd660=>{const _0x39195e=_0x5628aa;let _0xb19162;const _0xe0a016=_0x1bd660[_0x39195e(0x993)]?Object[_0x39195e(0x40a)](_0x4c8b14['chats'])['find'](_0x59b38f=>!_0x59b38f[_0x39195e(0xc98)]&&_0x59b38f[_0x39195e(0xf3e)]===_0x1bd660[_0x39195e(0x993)]):null;if(_0xe0a016)_0xb19162=_0xe0a016[_0x39195e(0xa37)]['aiAvatar'];else{const _0x1556c3=Object[_0x39195e(0x40a)](_0x4c8b14[_0x39195e(0xbea)])[_0x39195e(0x821)](_0x5281fd=>!_0x5281fd[_0x39195e(0xc98)]&&_0x5281fd[_0x39195e(0xf3e)]===_0x1bd660[_0x39195e(0xf93)]);if(_0x1556c3)_0xb19162=_0x1556c3[_0x39195e(0xa37)][_0x39195e(0xb24)];else _0x1bd660['authorAvatarPrompt']?_0xb19162=_0x39195e(0x9c3)+encodeURIComponent(_0x1bd660[_0x39195e(0x356)]):_0xb19162=_0x91d058;}const _0x27a668=document[_0x39195e(0x2c9)]('div');_0x27a668['className']='douban-post-item',_0x27a668[_0x39195e(0x41b)]=()=>_0x4dca31(_0x1bd660['id']),_0x27a668[_0x39195e(0x1575)]=_0x39195e(0xa24)+_0xb19162+_0x39195e(0x135c)+_0x1bd660[_0x39195e(0xf93)]+_0x39195e(0x1040)+_0x1bd660[_0x39195e(0x121e)]+_0x39195e(0x11fe)+_0x1bd660['postTitle']+_0x39195e(0x108a)+_0x1bd660[_0x39195e(0x1109)][_0x39195e(0xe19)](/\n/g,'<br>')+_0x39195e(0xbff)+_0x1bd660['likesCount']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M853.333333\x2085.333333H170.666667c-46.933333\x200-85.333333\x2038.4-85.333334\x2085.333334v512c0\x2046.933333\x2038.4\x2085.333333\x2085.333334\x2085.333333h512l170.666667\x20170.666667V170.666667c0-46.933333-38.4-85.333333-85.333334-85.333334z\x20m-42.666666\x20554.666667H170.666667V170.666667h640v469.333333zM256\x20384h512v85.333333H256V384z\x20m0-170.666667h512v85.333334H256v-85.333334z\x22></path></svg>\x20'+_0x1bd660[_0x39195e(0xf02)]+_0x39195e(0x88e)+_0x4878ba(_0x1bd660[_0x39195e(0x287)])+_0x39195e(0x9a5),_0x3bac17[_0x39195e(0x8f2)](_0x27a668);});}async function _0x5c2c7a(){const _0x5189dd=_0x239c7d,_0x4db208=_0x4c8b14[_0x5189dd(0x14f1)][_0x5189dd(0x1312)]||[];if(_0x4db208[_0x5189dd(0x8d6)]===0x0){await _0x138765(_0x5189dd(0x853),_0x5189dd(0xad6));return;}await _0x138765('请稍候...',_0x5189dd(0x364)+_0x4db208[_0x5189dd(0x8d6)]+_0x5189dd(0xf7d));const {proxyUrl:_0x3fb545,apiKey:_0x217788,model:_0x11bef5}=_0x4c8b14['apiConfig'];if(!_0x3fb545||!_0x217788||!_0x11bef5){alert('请先在API设置中配置好API信息。');return;}const _0x44da1d=new Set();_0x4db208[_0x5189dd(0xbdc)](_0x3779d1=>{const _0x40efe2=_0x5189dd,_0x3c8ee0=_0x4c8b14[_0x40efe2(0xbea)][_0x3779d1];_0x3c8ee0&&_0x3c8ee0[_0x40efe2(0xa37)]['linkedWorldBookIds']&&_0x3c8ee0[_0x40efe2(0xa37)]['linkedWorldBookIds'][_0x40efe2(0xbdc)](_0x30ca2d=>_0x44da1d[_0x40efe2(0x12b6)](_0x30ca2d));});let _0x461d48='';_0x44da1d[_0x5189dd(0x9e8)]>0x0&&(_0x461d48+=_0x5189dd(0xa3f),_0x44da1d[_0x5189dd(0xbdc)](_0x593e96=>{const _0x377216=_0x5189dd,_0x420a3e=_0x4c8b14['worldBooks']['find'](_0x322ca5=>_0x322ca5['id']===_0x593e96);if(_0x420a3e){const _0x29c950=_0x420a3e['content'][_0x377216(0x29d)](_0x1b637b=>_0x1b637b[_0x377216(0x250)]!==![])['map'](_0x11a8ce=>'-\x20'+_0x11a8ce['content'])[_0x377216(0xee1)]('\x0a');_0x29c950&&(_0x461d48+=_0x377216(0xf4a)+_0x420a3e['name']+_0x377216(0x608)+_0x29c950);}}));const _0x5a7b73=_0x4c8b14[_0x5189dd(0xf57)][_0x5189dd(0x821)](_0x11dc2f=>_0x11dc2f[_0x5189dd(0xf3e)]===_0x5189dd(0x1573));let _0x4519c6='',_0x4f93ed=[];_0x5a7b73&&_0x5a7b73[_0x5189dd(0x1109)][_0x5189dd(0xbdc)](_0x84a5ec=>{const _0x2b6bd5=_0x5189dd;_0x84a5ec[_0x2b6bd5(0x83c)][_0x2b6bd5(0xd1b)](_0x2b6bd5(0xbbc))&&(_0x4519c6+=_0x2b6bd5(0x12aa)+_0x84a5ec[_0x2b6bd5(0x1109)]);if(_0x84a5ec[_0x2b6bd5(0x83c)][_0x2b6bd5(0xd1b)](_0x2b6bd5(0xaaf))){const _0x46d538=_0x84a5ec[_0x2b6bd5(0x1109)]['split']('\x0a');_0x46d538[_0x2b6bd5(0xbdc)](_0x3e1fb7=>{const _0x16865b=_0x2b6bd5,_0x28ecf5=_0x3e1fb7[_0x16865b(0xbf7)](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x28ecf5&&_0x4f93ed[_0x16865b(0x6bb)]({'name':_0x28ecf5[0x1][_0x16865b(0xb8f)](),'persona':_0x28ecf5[0x2]['trim']()});});}});const _0xd8f730=_0x4c8b14[_0x5189dd(0x834)][_0x5189dd(0xbf3)]||'我',_0x18a294=_0x4db208[_0x5189dd(0x8d6)]>0x0&&_0x4c8b14[_0x5189dd(0xbea)][_0x4db208[0x0]]?_0x4c8b14['chats'][_0x4db208[0x0]][_0x5189dd(0xa37)][_0x5189dd(0x2ef)]:'(未设置)';let _0x4b7c89='';_0x4db208[_0x5189dd(0xbdc)](_0x136eef=>{const _0x3528c0=_0x5189dd,_0x2ce495=_0x4c8b14[_0x3528c0(0xbea)][_0x136eef];if(_0x2ce495){const _0xe9e51d=_0x2ce495['longTermMemory']&&_0x2ce495[_0x3528c0(0x1600)][_0x3528c0(0x8d6)]>0x0?_0x2ce495[_0x3528c0(0x1600)][_0x3528c0(0xd18)](_0x357962=>_0x357962['content'])[_0x3528c0(0xee1)](';\x20'):'无',_0x538e9e=_0x2ce495[_0x3528c0(0x92c)][_0x3528c0(0x69f)](-0xa)[_0x3528c0(0xd18)](_0x4a9d6f=>(_0x4a9d6f[_0x3528c0(0x71a)]==='user'?_0xd8f730:_0x2ce495[_0x3528c0(0xf3e)])+':\x20'+String(_0x4a9d6f['content'])[_0x3528c0(0x371)](0x0,0x1e)+_0x3528c0(0x166b))[_0x3528c0(0xee1)]('\x0a');_0x4b7c89+=_0x3528c0(0xa46)+_0x2ce495[_0x3528c0(0xf3e)]+_0x3528c0(0x1118)+_0x2ce495[_0x3528c0(0xa37)]['aiPersona']+_0x3528c0(0xa3d)+_0xe9e51d+_0x3528c0(0x11ec)+_0x538e9e+'</recent_dialogue_with_user>\x0a</character>\x0a';}}),_0x4f93ed[_0x5189dd(0xbdc)](_0x4da71f=>{const _0xab6178=_0x5189dd;_0x4b7c89+=_0xab6178(0xa46)+_0x4da71f[_0xab6178(0xf3e)]+_0xab6178(0x1118)+_0x4da71f[_0xab6178(0x9a2)]+_0xab6178(0x1111);});const _0x1a143d=new Date(),_0x52615a=_0x1a143d[_0x5189dd(0xad4)](_0x5189dd(0x1271),{'dateStyle':_0x5189dd(0x1552),'timeStyle':_0x5189dd(0x5e8)}),_0xf2a1cb=_0x4c8b14[_0x5189dd(0x14f1)][_0x5189dd(0xf0f)]||0xc,_0x7b7466=_0x4c8b14['globalSettings']['doubanMaxPosts']||0x14,_0x38998c=_0x5189dd(0x218)+_0xf2a1cb+'到'+_0x7b7466+'篇】他们最近可能会在各种豆瓣小组中发布的帖子和评论。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**'+_0x52615a+_0x5189dd(0x152a)+_0xd8f730+_0x5189dd(0x40d)+_0xd8f730+'”\x20的帖子或评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【身份\x20(最高优先级！)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20`authorName`:\x20你可以为主要角色起一个符合情景的、临时的【发帖昵称】，也可以直接使用他们的本名。\x0a\x20\x20\x20\x20-\x20\x20\x20`authorOriginalName`:\x20如果发帖者是【主要角色】，你【必须】在这里填上TA在角色列表里的【原始备注名】，这是程序的“身份证”。\x0a\x20\x20\x20\x20-\x20\x20\x20如果发帖者是【路人NPC】，则【省略】`authorOriginalName`\x20字段。\x0a4.\x20\x20**【作者平衡】**:\x20帖子的作者【必须】从下面的\x20`<character>`\x20列表中【均匀地、多样化地】选择。你【必须】确保帖子列表中【至少有\x2070%\x20的帖子是由路人NPC发布的】，以营造一个真实的社区氛围。\x0a\x20\x20\x20\x20-\x20\x22comments\x22:\x20一个包含【7到12条】评论的数组。评论者可以是路人，也可以是角色列表中的其他角色，以体现互动性。\x0a5.\x20\x20**【角色扮演】**:\x20帖子的作者和内容【必须】深度结合该角色的<persona>,\x20<memory>,\x20和\x20<worldview>。\x0a6.\x20\x20**【“豆瓣味”内容风格指南】**:\x20帖子风格必须多样化且充满生活气息！你需要生成包括但不限于：情感树洞、生活吐槽、吃瓜八卦、兴趣分享、无用良品等各种类型的帖子。\x0a7.\x20\x20**【头像生成\x20(最高优先级！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20为每一个【首次出现】的路人NPC（无论是发帖还是评论），你都【必须】为其添加一个\x20`avatar_prompt`\x20字段。\x0a\x20\x20\x20\x20-\x20\x20\x20这个字段的内容是用于生成该NPC头像的、简洁的【英文】关键词。\x0a\x20\x20\x20\x20-\x20\x20\x20不同的NPC【必须】有不同的头像指令，以确保他们的头像是独一无二的。\x0a8.\x20\x20**【头像一致性\x20(至关重要！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果一个路人NPC在同一个帖子中多次出现（例如，既是发帖人又是评论者，或多次评论），你【必须】为TA的所有出现都使用【完全相同】的\x20`avatar_prompt`。这至关重要！\x0a9.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一篇帖子，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22groupName\x22:\x20\x22一个生动有趣的小组名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22postTitle\x22:\x20\x22一个引人-注目的帖子标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorName\x22:\x20\x22发帖角色的【备注名】\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorOriginalName\x22:\x20\x22(仅当发帖者是主要角色时【必须】提供)\x20TA的原始备注名\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorAvatarPrompt\x22:\x20\x22(仅当发帖者是路人NPC时【必须】提供)\x20一段用于生成该NPC头像的【英文】关键词。风格为\x20anime\x20style,\x20simple\x20background\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22帖子的详细正文，必须支持换行符\x5cn。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22likesCount\x22:\x20152,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22commentsCount\x22:\x2038,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22路人甲\x22,\x20\x22text\x22:\x20\x22这是一个路人评论。\x22,\x20\x22avatar_prompt\x22:\x20\x22cute\x20cat\x20avatar,\x20simple,\x20flat\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22另一个角色名\x22,\x20\x22commenterOriginalName\x22:\x20\x22(如果评论者是主要角色，必须提供其本名)\x22,\x20\x22text\x22:\x20\x22这是一个来自其他角色的互动评论。\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**comments**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20评论者可以是路人，也可以是角色列表中的其他角色。评论区【必须】体现出互动性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20【评论身份】:\x20如果评论者是【主要角色】，你【必须】为其添加\x20`commenterOriginalName`\x20字段，并填入其本名。如果是路人NPC，则省略此字段。\x0a\x0a#\x20供你参考的上下文\x0a'+_0x4519c6+'\x0a'+_0x461d48+_0x5189dd(0x6ae)+_0x52615a+_0x5189dd(0x435)+_0xd8f730+_0x5189dd(0x1662)+_0x18a294+_0x5189dd(0x1364)+_0x4b7c89+_0x5189dd(0x730);try{const _0x1fd505=[{'role':_0x5189dd(0x6d6),'content':_0x5189dd(0xbcd)}];let _0x404434=_0x3fb545['includes'](_0x5189dd(0x14cc)),_0x431f1a=_0x3914a6(_0x11bef5,_0x217788,_0x38998c,_0x1fd505);const _0x2d0e9b=_0x404434?await fetch(_0x431f1a[_0x5189dd(0x299)],_0x431f1a[_0x5189dd(0x55b)]):await fetch(_0x3fb545+'/v1/chat/completions',{'method':_0x5189dd(0x953),'headers':{'Content-Type':_0x5189dd(0xfae),'Authorization':_0x5189dd(0xcee)+_0x217788},'body':JSON['stringify']({'model':_0x11bef5,'messages':[{'role':_0x5189dd(0xaf6),'content':_0x38998c},..._0x1fd505],'temperature':_0x4c8b14[_0x5189dd(0x14f1)][_0x5189dd(0x216)]||0x1})});if(!_0x2d0e9b['ok'])throw new Error('API\x20错误:\x20'+_0x2d0e9b[_0x5189dd(0x755)]);const _0x4c457f=await _0x2d0e9b[_0x5189dd(0x15d3)](),_0x2e3b08=getGeminiResponseText(_0x4c457f),_0x57c640=_0x2e3b08[_0x5189dd(0xbf7)](/\[[\s\S]*\]/);if(!_0x57c640)throw new Error(_0x5189dd(0x131e)+_0x2e3b08);const _0x1f56aa=JSON[_0x5189dd(0x13f7)](_0x57c640[0x0]);await _0x54c587['doubanPosts'][_0x5189dd(0x82f)](),await _0x54c587['doubanPosts'][_0x5189dd(0x666)](_0x1f56aa[_0x5189dd(0xd18)](_0x49c08d=>({..._0x49c08d,'timestamp':Date['now']()-Math['random']()*0x186a0}))),await _0x20dc01();}catch(_0x51463f){console[_0x5189dd(0x5d7)]('生成豆瓣帖子失败:',_0x51463f),await _0x138765(_0x5189dd(0x321),_0x5189dd(0x6a9)+_0x51463f['message']);}}async function _0x4dca31(_0x29e11a){const _0x316c7d=_0x239c7d;_0x257d51(_0x316c7d(0x12ef)),_0x4c0bbb=_0x29e11a;const _0xa8423f=await _0x54c587[_0x316c7d(0xa7f)]['get'](_0x29e11a);if(!_0xa8423f){_0x257d51(_0x316c7d(0x12d1));return;}document['getElementById'](_0x316c7d(0x1546))['textContent']=_0x316c7d(0x15c3);let _0x32f2fb=_0x91d058,_0x3866cc=_0xa8423f[_0x316c7d(0xf93)];const _0x4b1717=_0xa8423f[_0x316c7d(0x993)]?Object[_0x316c7d(0x40a)](_0x4c8b14[_0x316c7d(0xbea)])[_0x316c7d(0x821)](_0x14311e=>!_0x14311e[_0x316c7d(0xc98)]&&_0x14311e['originalName']===_0xa8423f['authorOriginalName']):null;if(_0x4b1717)_0x32f2fb=_0x4b1717[_0x316c7d(0xa37)][_0x316c7d(0xb24)];else{const _0x2e6dba=Object[_0x316c7d(0x40a)](_0x4c8b14[_0x316c7d(0xbea)])[_0x316c7d(0x821)](_0xfd52cd=>!_0xfd52cd[_0x316c7d(0xc98)]&&_0xfd52cd[_0x316c7d(0xf3e)]===_0xa8423f[_0x316c7d(0xf93)]);if(_0x2e6dba)_0x32f2fb=_0x2e6dba[_0x316c7d(0xa37)][_0x316c7d(0xb24)];else _0xa8423f[_0x316c7d(0x356)]&&(_0x32f2fb='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0xa8423f[_0x316c7d(0x356)]));}document[_0x316c7d(0x400)](_0x316c7d(0x47d))[_0x316c7d(0x912)]=_0x32f2fb,document['getElementById'](_0x316c7d(0xeaa))[_0x316c7d(0xde7)]=_0x3866cc,document[_0x316c7d(0x400)]('douban-detail-group')[_0x316c7d(0xde7)]=_0x316c7d(0x1042)+_0xa8423f['groupName'],document[_0x316c7d(0x400)](_0x316c7d(0xc78))[_0x316c7d(0xde7)]=_0xa8423f[_0x316c7d(0x158d)],document[_0x316c7d(0x400)](_0x316c7d(0x10c6))[_0x316c7d(0x1575)]=_0xa8423f[_0x316c7d(0x1109)][_0x316c7d(0xe19)](/\n/g,_0x316c7d(0x9e1)),document[_0x316c7d(0x400)]('douban-my-comment-avatar')['src']=_0x4c8b14[_0x316c7d(0x834)][_0x316c7d(0xa9a)],document[_0x316c7d(0x400)](_0x316c7d(0x1140))[_0x316c7d(0xa1e)]='';const _0x28b22e=document[_0x316c7d(0x400)]('douban-detail-comments-list');_0x28b22e[_0x316c7d(0x1575)]='';if(_0xa8423f[_0x316c7d(0xf8f)]&&_0xa8423f[_0x316c7d(0xf8f)][_0x316c7d(0x8d6)]>0x0){const _0x4b036f=new Map();_0xa8423f[_0x316c7d(0xf8f)][_0x316c7d(0xbdc)](_0x21765e=>{const _0x13048b=_0x316c7d;let _0x2ca045=_0x91d058;const _0x2e8464=_0x4c8b14['qzoneSettings'][_0x13048b(0xbf3)]||'我',_0x4b96db=_0x21765e[_0x13048b(0xa51)];if(_0x4b036f['has'](_0x4b96db))_0x2ca045=_0x4b036f['get'](_0x4b96db);else{if(_0x4b96db===_0x2e8464)_0x2ca045=_0x4c8b14['qzoneSettings'][_0x13048b(0xa9a)];else{if(_0x4b96db===_0xa8423f['authorName'])_0x2ca045=_0x32f2fb;else{const _0x8aaee6=_0x21765e['commenterOriginalName']?Object[_0x13048b(0x40a)](_0x4c8b14[_0x13048b(0xbea)])[_0x13048b(0x821)](_0x343e5f=>!_0x343e5f[_0x13048b(0xc98)]&&_0x343e5f['originalName']===_0x21765e[_0x13048b(0xe75)]):null;if(_0x8aaee6)_0x2ca045=_0x8aaee6[_0x13048b(0xa37)][_0x13048b(0xb24)];else{const _0x3b19f7=Object[_0x13048b(0x40a)](_0x4c8b14[_0x13048b(0xbea)])[_0x13048b(0x821)](_0x2d4b51=>!_0x2d4b51[_0x13048b(0xc98)]&&_0x2d4b51['name']===_0x4b96db);if(_0x3b19f7)_0x2ca045=_0x3b19f7[_0x13048b(0xa37)][_0x13048b(0xb24)];else _0x21765e[_0x13048b(0x370)]&&(_0x2ca045=_0x13048b(0x9c3)+encodeURIComponent(_0x21765e[_0x13048b(0x370)]));}}}_0x4b036f['set'](_0x4b96db,_0x2ca045);}const _0x20a637=document['createElement'](_0x13048b(0xf8e));_0x20a637['className']=_0x13048b(0x125b),_0x20a637[_0x13048b(0x1575)]=_0x13048b(0x30d)+_0x2ca045+_0x13048b(0x1dc)+_0x4b96db+_0x13048b(0x436)+_0x21765e[_0x13048b(0x117f)][_0x13048b(0xe19)](/\n/g,'<br>')+_0x13048b(0xa3a),_0x28b22e[_0x13048b(0x8f2)](_0x20a637);});}else _0x28b22e['innerHTML']=_0x316c7d(0x166c);const _0x31d020=document[_0x316c7d(0x400)]('douban-detail-content-wrapper');if(_0x31d020)_0x31d020[_0x316c7d(0x125c)]=0x0;}async function _0x30a021(){const _0x5c5d11=_0x239c7d;if(!_0x4c0bbb)return;const _0xc7ccb7=document[_0x5c5d11(0x400)](_0x5c5d11(0x1140)),_0x353712=_0xc7ccb7[_0x5c5d11(0xa1e)][_0x5c5d11(0xb8f)]();if(!_0x353712)return;const _0x39794e=await _0x54c587[_0x5c5d11(0xa7f)][_0x5c5d11(0xf48)](_0x4c0bbb);if(!_0x39794e)return;!_0x39794e[_0x5c5d11(0xf8f)]&&(_0x39794e[_0x5c5d11(0xf8f)]=[]);const _0x5507b0=_0x4c8b14[_0x5c5d11(0x834)][_0x5c5d11(0xbf3)]||'我';_0x39794e[_0x5c5d11(0xf8f)]['push']({'commenter':_0x5507b0,'text':_0x353712}),_0x39794e[_0x5c5d11(0xf02)]++,await _0x54c587['doubanPosts'][_0x5c5d11(0x4cb)](_0x39794e),_0xc7ccb7['value']='',await _0x4dca31(_0x4c0bbb);}async function _0x146769(){const _0x1fd7b8=_0x239c7d;if(!_0x4c0bbb)return;const _0x3bcdda=_0x4c0bbb,_0x5e9b33=await _0x54c587[_0x1fd7b8(0xa7f)][_0x1fd7b8(0xf48)](_0x3bcdda);if(!_0x5e9b33)return;const _0x53eb8e=_0x5e9b33[_0x1fd7b8(0xf8f)]&&_0x5e9b33['comments'][_0x1fd7b8(0x69f)](-0x1)[0x0];if(!_0x53eb8e){alert(_0x1fd7b8(0x3a4));return;}await _0x138765('请稍候...','正在请求AI角色们加入讨论...');try{const {proxyUrl:_0x1feb9e,apiKey:_0x303602,model:_0x48c423}=_0x4c8b14[_0x1fd7b8(0x814)];if(!_0x1feb9e||!_0x303602||!_0x48c423)throw new Error(_0x1fd7b8(0x373));const _0x5d9587=_0x4c8b14['qzoneSettings'][_0x1fd7b8(0xbf3)]||'我',_0x6e2d84=_0x4c8b14[_0x1fd7b8(0xbea)][Object['keys'](_0x4c8b14[_0x1fd7b8(0xbea)])[0x0]]?.[_0x1fd7b8(0xa37)][_0x1fd7b8(0x2ef)]||'(未设置)',_0x1aa111=new Map();_0x5e9b33['comments']&&_0x5e9b33[_0x1fd7b8(0xf8f)][_0x1fd7b8(0xbdc)](_0x39515a=>{const _0x408563=_0x1fd7b8,_0x4ca096=(_0x4c8b14[_0x408563(0x14f1)][_0x408563(0x1312)]||[])['some'](_0x30d678=>_0x4c8b14[_0x408563(0xbea)][_0x30d678]?.[_0x408563(0xf3e)]===_0x39515a['commenter']);!_0x4ca096&&_0x39515a['avatar_prompt']&&_0x1aa111[_0x408563(0xfa3)](_0x39515a[_0x408563(0xa51)],_0x39515a['avatar_prompt']);});let _0x2a93ed=_0x1fd7b8(0x8c6);_0x1aa111['size']>0x0?(_0x2a93ed+=_0x1fd7b8(0x2a8),_0x1aa111[_0x1fd7b8(0xbdc)]((_0x532999,_0x36881c)=>{const _0x32ea4e=_0x1fd7b8;_0x2a93ed+=_0x32ea4e(0x6a6)+_0x36881c+'**:\x20\x22'+_0x532999+'\x22\x0a';})):_0x2a93ed+='（当前帖子还没有路人NPC发表评论。）\x0a';const _0xc0e952=_0x4c8b14[_0x1fd7b8(0xf57)][_0x1fd7b8(0x821)](_0x115899=>_0x115899[_0x1fd7b8(0xf3e)]===_0x1fd7b8(0x1573));let _0x232db8=[];_0xc0e952&&_0xc0e952[_0x1fd7b8(0x1109)][_0x1fd7b8(0xbdc)](_0x2602d2=>{const _0x5b3a8a=_0x1fd7b8;if(_0x2602d2[_0x5b3a8a(0x83c)][_0x5b3a8a(0xd1b)](_0x5b3a8a(0xaaf))){const _0x5ef4b3=_0x2602d2[_0x5b3a8a(0x1109)][_0x5b3a8a(0x5ad)]('\x0a');_0x5ef4b3[_0x5b3a8a(0xbdc)](_0x3b87d4=>{const _0x163241=_0x5b3a8a,_0x44565d=_0x3b87d4[_0x163241(0xbf7)](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x44565d&&_0x232db8['push']({'name':_0x44565d[0x1][_0x163241(0xb8f)](),'persona':_0x44565d[0x2]['trim']()});});}});let _0x49f4a9='';const _0x118579=_0x4c8b14[_0x1fd7b8(0x14f1)][_0x1fd7b8(0x1312)]||[];_0x118579[_0x1fd7b8(0xbdc)](_0x28815f=>{const _0x21813a=_0x1fd7b8,_0x2aedfb=_0x4c8b14[_0x21813a(0xbea)][_0x28815f];if(_0x2aedfb){const _0x14a64a=_0x2aedfb[_0x21813a(0x1600)]&&_0x2aedfb[_0x21813a(0x1600)][_0x21813a(0x8d6)]>0x0?_0x2aedfb[_0x21813a(0x1600)]['map'](_0x5f2481=>_0x5f2481['content'])[_0x21813a(0xee1)](';\x20'):'无',_0x11ed26=_0x2aedfb[_0x21813a(0x92c)][_0x21813a(0x69f)](-0xa)[_0x21813a(0xd18)](_0x128dfa=>(_0x128dfa[_0x21813a(0x71a)]==='user'?_0x5d9587:_0x2aedfb[_0x21813a(0xf3e)])+':\x20'+String(_0x128dfa[_0x21813a(0x1109)])[_0x21813a(0x371)](0x0,0x1e)+_0x21813a(0x166b))[_0x21813a(0xee1)]('\x0a');_0x49f4a9+=_0x21813a(0x105b)+_0x2aedfb[_0x21813a(0xf3e)]+':\x20'+_0x2aedfb[_0x21813a(0xa37)]['aiPersona'][_0x21813a(0x371)](0x0,0x32)+'...\x20[记忆:\x20'+_0x14a64a+']\x20[最近对话:\x20'+_0x11ed26+']';}}),_0x232db8[_0x1fd7b8(0xbdc)](_0x311f74=>{const _0x5da218=_0x1fd7b8;_0x49f4a9+=_0x5da218(0x105b)+_0x311f74[_0x5da218(0xf3e)]+':\x20'+_0x311f74[_0x5da218(0x9a2)];});const _0x2392e4=new Date(),_0x208a44=_0x2392e4[_0x1fd7b8(0xad4)](_0x1fd7b8(0x1271),{'dateStyle':_0x1fd7b8(0x1552),'timeStyle':_0x1fd7b8(0x5e8)}),_0x560d1c=_0x1fd7b8(0x15ff)+_0x5d9587+_0x1fd7b8(0x164c)+_0x208a44+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“'+_0x5d9587+_0x1fd7b8(0x643)+_0x5d9587+_0x1fd7b8(0x1649)+_0x5e9b33[_0x1fd7b8(0x158d)]+_0x1fd7b8(0x15fd)+_0x5e9b33[_0x1fd7b8(0xf93)]+_0x1fd7b8(0x6ba)+_0x5e9b33[_0x1fd7b8(0x1109)][_0x1fd7b8(0x371)](0x0,0x64)+_0x1fd7b8(0xf3d)+_0x5e9b33['comments'][_0x1fd7b8(0xd18)](_0x9d8fed=>'-\x20'+_0x9d8fed[_0x1fd7b8(0xa51)]+':\x20'+_0x9d8fed[_0x1fd7b8(0x117f)])['join']('\x0a')+'\x0a\x0a'+_0x2a93ed+_0x1fd7b8(0x6ae)+_0x208a44+'\x0a\x0a#\x20【你的聊天对象（用户）的人设】\x0a-\x20**昵称**:\x20'+_0x5d9587+_0x1fd7b8(0x1662)+_0x6e2d84+_0x1fd7b8(0x11a3)+_0x49f4a9+'\x0a\x0a现在，请生成新的评论。',_0x10521a=[{'role':'user','content':_0x1fd7b8(0x3e1)}];let _0x191400=_0x1feb9e[_0x1fd7b8(0xd1b)](_0x1fd7b8(0x14cc)),_0x5f5886=_0x3914a6(_0x48c423,_0x303602,_0x560d1c,_0x10521a);const _0x2eff3b=_0x191400?await fetch(_0x5f5886[_0x1fd7b8(0x299)],_0x5f5886[_0x1fd7b8(0x55b)]):await fetch(_0x1feb9e+_0x1fd7b8(0x1611),{'method':_0x1fd7b8(0x953),'headers':{'Content-Type':_0x1fd7b8(0xfae),'Authorization':'Bearer\x20'+_0x303602},'body':JSON[_0x1fd7b8(0xea5)]({'model':_0x48c423,'messages':[{'role':_0x1fd7b8(0xaf6),'content':_0x560d1c},..._0x10521a],'temperature':_0x4c8b14[_0x1fd7b8(0x14f1)][_0x1fd7b8(0x216)]||0x1})});if(!_0x2eff3b['ok'])throw new Error(_0x1fd7b8(0x7d5)+_0x2eff3b[_0x1fd7b8(0x755)]);const _0x4df6aa=await _0x2eff3b[_0x1fd7b8(0x15d3)](),_0x11c10e=getGeminiResponseText(_0x4df6aa),_0xcd435a=_0x11c10e['replace'](/^```json\s*/,'')[_0x1fd7b8(0xe19)](/```$/,''),_0x494093=JSON[_0x1fd7b8(0x13f7)](_0xcd435a);Array[_0x1fd7b8(0x16a1)](_0x494093)&&_0x494093[_0x1fd7b8(0x8d6)]>0x0&&(_0x5e9b33[_0x1fd7b8(0xf8f)][_0x1fd7b8(0x6bb)](..._0x494093),_0x5e9b33['commentsCount']+=_0x494093[_0x1fd7b8(0x8d6)],await _0x54c587[_0x1fd7b8(0xa7f)][_0x1fd7b8(0x4cb)](_0x5e9b33)),await _0x4dca31(_0x3bcdda),_0x37c595();}catch(_0x202eb4){console[_0x1fd7b8(0x5d7)](_0x1fd7b8(0x68b),_0x202eb4),await _0x138765(_0x1fd7b8(0x12cb),_0x1fd7b8(0x671)+_0x202eb4[_0x1fd7b8(0x6e2)]);}}async function _0x566b72(){const _0x2991d2=_0x239c7d,_0x5176d0=document['getElementById'](_0x2991d2(0x427)),_0x5cfc4d=document[_0x2991d2(0x400)](_0x2991d2(0x1545));_0x5cfc4d[_0x2991d2(0x1575)]='';const _0x507f47=Object['values'](_0x4c8b14['chats'])[_0x2991d2(0x29d)](_0x5df982=>!_0x5df982[_0x2991d2(0xc98)]),_0x56d37e=new Set(_0x4c8b14[_0x2991d2(0x14f1)][_0x2991d2(0x1312)]||[]);_0x507f47[_0x2991d2(0x8d6)]===0x0?_0x5cfc4d[_0x2991d2(0x1575)]=_0x2991d2(0x358):_0x507f47[_0x2991d2(0xbdc)](_0x42bb1b=>{const _0x2abf1b=_0x2991d2,_0x1f19d5=document['createElement'](_0x2abf1b(0xf8e));_0x1f19d5['className']=_0x2abf1b(0x1427),_0x1f19d5[_0x2abf1b(0x1575)]=_0x2abf1b(0x1682)+_0x42bb1b['id']+'\x22\x20'+(_0x56d37e[_0x2abf1b(0x3e3)](_0x42bb1b['id'])?_0x2abf1b(0x6f9):'')+'\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x42bb1b[_0x2abf1b(0xa37)]['aiAvatar']||_0x91d058)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x42bb1b['name']+_0x2abf1b(0xee0),_0x5cfc4d[_0x2abf1b(0x8f2)](_0x1f19d5);}),_0x5176d0['classList'][_0x2991d2(0x12b6)](_0x2991d2(0x9eb));}async function _0x1ea129(){const _0x2a04c7=_0x239c7d,_0x565703=document[_0x2a04c7(0x527)]('#douban-cast-list\x20.douban-cast-checkbox:checked'),_0x326bb4=Array['from'](_0x565703)[_0x2a04c7(0xd18)](_0x1329d2=>_0x1329d2[_0x2a04c7(0xd61)][_0x2a04c7(0x4dd)]);_0x4c8b14[_0x2a04c7(0x14f1)]['doubanActiveCharacterIds']=_0x326bb4,await _0x54c587['globalSettings'][_0x2a04c7(0x4cb)](_0x4c8b14[_0x2a04c7(0x14f1)]),document[_0x2a04c7(0x400)]('douban-cast-modal')[_0x2a04c7(0xb08)][_0x2a04c7(0xc46)](_0x2a04c7(0x9eb)),await _0x5c2c7a();}document[_0x239c7d(0x400)]('douban-cast-select-btn')['addEventListener']('click',_0x566b72),document[_0x239c7d(0x400)]('cancel-douban-cast-btn')[_0x239c7d(0x501)](_0x239c7d(0x15ad),()=>{const _0x25dddb=_0x239c7d;document[_0x25dddb(0x400)](_0x25dddb(0x427))[_0x25dddb(0xb08)][_0x25dddb(0xc46)](_0x25dddb(0x9eb));}),document[_0x239c7d(0x400)](_0x239c7d(0x153d))[_0x239c7d(0x501)](_0x239c7d(0x15ad),_0x1ea129),document[_0x239c7d(0x400)](_0x239c7d(0x1545))[_0x239c7d(0x501)](_0x239c7d(0x15ad),_0x5f4890=>{const _0x39f558=_0x239c7d,_0x1160cc=_0x5f4890[_0x39f558(0x657)][_0x39f558(0x117a)](_0x39f558(0xff2));if(_0x1160cc){const _0x35b47f=_0x1160cc[_0x39f558(0x13ef)](_0x39f558(0xd59));_0x35b47f&&_0x5f4890[_0x39f558(0x657)]!==_0x35b47f&&(_0x35b47f[_0x39f558(0x6f9)]=!_0x35b47f[_0x39f558(0x6f9)]);}});async function _0x33ad26(_0x37b09b){const _0xb5192e=_0x239c7d;if(!_0x37b09b)return;const _0x36c999=await _0x56d4d3(_0xb5192e(0x8e8),_0xb5192e(0x40f),{'confirmText':_0xb5192e(0x159e)});if(!_0x36c999)return;try{const _0x5632d0=await _0x37b09b['text'](),_0x32b285=JSON[_0xb5192e(0x13f7)](_0x5632d0);if(!_0x32b285[_0xb5192e(0xed6)]&&!_0x32b285[_0xb5192e(0x5e9)]&&!_0x32b285[_0xb5192e(0x10d4)])throw new Error(_0xb5192e(0x110b));Object['assign'](_0x4c8b14['globalSettings'],_0x32b285),await _0x54c587[_0xb5192e(0x14f1)][_0xb5192e(0x4cb)](_0x4c8b14[_0xb5192e(0x14f1)]),_0x497a54(),_0x3ed28b(),_0x45f4d0(),_0xc8df8a(),_0x1d7c68(_0x4c8b14[_0xb5192e(0x14f1)][_0xb5192e(0x5e9)]),_0x572a63(_0x4c8b14['globalSettings'][_0xb5192e(0x1302)]),_0x3e4f38(),_0x15f9e9(),_0x364d9f(),await _0x138765(_0xb5192e(0xa88),_0xb5192e(0x276));}catch(_0x303c83){console[_0xb5192e(0x5d7)]('导入外观设置时出错:',_0x303c83),await _0x138765(_0xb5192e(0x3e8),'文件解析或应用失败:\x20'+_0x303c83[_0xb5192e(0x6e2)]);}}async function _0x4b699c(_0x5d1e2c){const _0x3d4996=_0x239c7d;console['log'](_0x3d4996(0x4d0)+_0x5d1e2c[_0x3d4996(0x2ea)](0x1)+_0x3d4996(0x221));const _0x4ff235=Object[_0x3d4996(0x40a)](_0x4c8b14[_0x3d4996(0xbea)])['filter'](_0x2a6340=>!_0x2a6340[_0x3d4996(0xc98)]&&_0x2a6340['settings'][_0x3d4996(0x3c4)]&&_0x2a6340[_0x3d4996(0x12f7)]?.[_0x3d4996(0x12c3)]===_0x3d4996(0x1290));if(_0x4ff235['length']===0x0){console['log'](_0x3d4996(0x107f));return;}for(const _0x3d7d45 of _0x4ff235){const _0x1f6da9=_0x3d7d45[_0x3d4996(0xa37)][_0x3d4996(0x12c0)]||0xf,_0x4af558=_0x3d7d45[_0x3d4996(0xc67)]?(Date[_0x3d4996(0xecd)]()-_0x3d7d45['lastActionTimestamp'])/(0x3e8*0x3c):Infinity;_0x5d1e2c>_0x1f6da9&&_0x4af558>_0x1f6da9&&(Math[_0x3d4996(0x12bc)]()<0.3&&(console[_0x3d4996(0x1e6)](_0x3d4996(0xfb3)+_0x3d7d45[_0x3d4996(0xf3e)]+_0x3d4996(0x34b)),Math[_0x3d4996(0x12bc)]()<0.7?await _0x6d9520(_0x3d7d45['id']):console[_0x3d4996(0x1e6)](_0x3d4996(0xfb3)+_0x3d7d45[_0x3d4996(0xf3e)]+_0x3d4996(0x14df))));}}function _0xfdfc40(){const _0x173b30=_0x239c7d;if(!_0x4c8b14[_0x173b30(0x1539)])return;const _0x227013=_0x4c8b14[_0x173b30(0xbea)][_0x4c8b14[_0x173b30(0x1539)]];document['getElementById'](_0x173b30(0xb63))['value']='',document[_0x173b30(0x400)](_0x173b30(0x8b0))[_0x173b30(0xa1e)]='',document[_0x173b30(0x400)]('chat-search-results-list')[_0x173b30(0x1575)]=_0x173b30(0x1589),_0x257d51(_0x173b30(0x67a));}async function _0x34256b(){const _0x5331d2=_0x239c7d,_0x27f709=_0x4c8b14['chats'][_0x4c8b14[_0x5331d2(0x1539)]];if(!_0x27f709)return;const _0xeae3c2=document[_0x5331d2(0x400)](_0x5331d2(0xb63))[_0x5331d2(0xa1e)][_0x5331d2(0xb8f)]()[_0x5331d2(0x1653)](),_0x8d667c=document[_0x5331d2(0x400)](_0x5331d2(0x8b0))['value'];if(!_0xeae3c2&&!_0x8d667c){alert(_0x5331d2(0xb6a));return;}let _0x54f08d=_0x27f709[_0x5331d2(0x92c)][_0x5331d2(0x29d)](_0x308819=>!_0x308819[_0x5331d2(0x118c)]);_0xeae3c2&&(_0x54f08d=_0x54f08d['filter'](_0x4d09d3=>{const _0x1b522c=_0x5331d2;let _0x300742='';if(typeof _0x4d09d3['content']===_0x1b522c(0x158f))_0x300742=_0x4d09d3['content'];else{if(_0x4d09d3[_0x1b522c(0xbbf)]===_0x1b522c(0x295))_0x300742=_0x4d09d3['content'];else{if(_0x4d09d3['type']===_0x1b522c(0xea7)||_0x4d09d3['type']==='user_photo')_0x300742=_0x4d09d3[_0x1b522c(0x1109)];else{if(_0x4d09d3[_0x1b522c(0xbbf)]===_0x1b522c(0x86e))_0x300742=(_0x4d09d3[_0x1b522c(0xf2d)]||'')+'\x20'+(_0x4d09d3[_0x1b522c(0x12a5)]||'');else _0x4d09d3['quote']&&(_0x300742=_0x4d09d3[_0x1b522c(0x1109)]);}}}return _0x300742[_0x1b522c(0x1653)]()[_0x1b522c(0xd1b)](_0xeae3c2);}));if(_0x8d667c){const _0x718bc8=new Date(_0x8d667c),_0x4b6785=new Date(_0x718bc8[_0x5331d2(0x3ab)](0x0,0x0,0x0,0x0))[_0x5331d2(0xff4)](),_0x154e6d=new Date(_0x718bc8[_0x5331d2(0x3ab)](0x17,0x3b,0x3b,0x3e7))[_0x5331d2(0xff4)]();_0x54f08d=_0x54f08d[_0x5331d2(0x29d)](_0x452f29=>_0x452f29[_0x5331d2(0x287)]>=_0x4b6785&&_0x452f29['timestamp']<=_0x154e6d);}await _0x1eb2c8(_0x54f08d);}async function _0x1eb2c8(_0x4c0164){const _0x22ae76=_0x239c7d,_0x40c222=document[_0x22ae76(0x400)](_0x22ae76(0xd32)),_0x12fe0c=_0x4c8b14['chats'][_0x4c8b14[_0x22ae76(0x1539)]];_0x40c222[_0x22ae76(0x1575)]='';if(_0x4c0164[_0x22ae76(0x8d6)]===0x0){_0x40c222[_0x22ae76(0x1575)]=_0x22ae76(0x14f2);return;}let _0x566b0b='';for(const _0x48731b of _0x4c0164){const _0x40e722=new Date(_0x48731b[_0x22ae76(0x287)]),_0x543d00=_0x40e722[_0x22ae76(0x1100)]();if(_0x543d00!==_0x566b0b){const _0x14d6e1=document[_0x22ae76(0x2c9)](_0x22ae76(0xf8e));_0x14d6e1[_0x22ae76(0x4e1)]=_0x22ae76(0x10ea),_0x14d6e1[_0x22ae76(0xde7)]=_0x22ae76(0xa98)+_0x40e722['getFullYear']()+'年'+(_0x40e722['getMonth']()+0x1)+'月'+_0x40e722[_0x22ae76(0xd00)]()+_0x22ae76(0x10ca),_0x40c222[_0x22ae76(0x8f2)](_0x14d6e1),_0x566b0b=_0x543d00;}const _0x30f418=await _0x43c5e5(_0x48731b,_0x12fe0c);_0x30f418&&(_0x30f418['style'][_0x22ae76(0x214)]=_0x22ae76(0x1293),_0x30f418[_0x22ae76(0x501)](_0x22ae76(0x15ad),()=>_0x25994f(_0x48731b['timestamp'])),_0x40c222[_0x22ae76(0x8f2)](_0x30f418));}}async function _0x25994f(_0x2330b3){const _0x5904e0=_0x239c7d,_0x3afc4e=_0x4c8b14[_0x5904e0(0x1539)];if(!_0x3afc4e)return;_0x257d51(_0x5904e0(0x946)),setTimeout(async()=>{const _0x460f3d=_0x5904e0,_0x322ce6=document[_0x460f3d(0x400)](_0x460f3d(0x75b)),_0x48b092=_0x460f3d(0xfe4)+_0x2330b3+'\x22]';let _0x3b22c3=_0x322ce6[_0x460f3d(0x13ef)](_0x48b092),_0x3f74b4=0x0;const _0x37c203=0x14;while(!_0x3b22c3&&_0x3f74b4<_0x37c203){const _0x347d21=document[_0x460f3d(0x400)](_0x460f3d(0xf43));if(_0x347d21)console[_0x460f3d(0x1e6)](_0x460f3d(0x6ed)+(_0x3f74b4+0x1)+')'),await _0x14354e(),_0x3b22c3=_0x322ce6['querySelector'](_0x48b092),_0x3f74b4++;else break;}_0x51566f(_0x2330b3);},0xc8);}async function _0x1b9d3e(){const _0x250f0b=_0x239c7d;document[_0x250f0b(0x400)](_0x250f0b(0xb63))[_0x250f0b(0xa1e)]='',document[_0x250f0b(0x400)](_0x250f0b(0x8b0))[_0x250f0b(0xa1e)]='',await _0x1eb2c8(_0x4c8b14['chats'][_0x4c8b14[_0x250f0b(0x1539)]]['history'][_0x250f0b(0x29d)](_0x44eb6e=>!_0x44eb6e[_0x250f0b(0x118c)]));}async function _0x4999f0(_0x3bd75f=![],_0x18fa41=null,_0x52ea60=null){const _0x4d65d0=_0x239c7d,_0x23178e=document[_0x4d65d0(0x400)](_0x4d65d0(0xb45)),_0x496a44=document[_0x4d65d0(0x400)](_0x4d65d0(0x114e)),_0x31ef6b=_0x4c8b14['chats'][_0x4c8b14[_0x4d65d0(0x1539)]];_0x23178e[_0x4d65d0(0x1575)]='',_0x496a44['innerHTML']='';const _0x310a22=await _0x54c587[_0x4d65d0(0x4ba)][_0x4d65d0(0xce1)](),_0x144c37=[..._0x1a380a,..._0x310a22];document[_0x4d65d0(0x13ef)]('#avatar-frame-modal\x20.frame-tabs')[_0x4d65d0(0xa00)][_0x4d65d0(0xb1a)]=_0x3bd75f?_0x4d65d0(0x165b):'flex',document['getElementById'](_0x4d65d0(0x37e))[_0x4d65d0(0xa00)][_0x4d65d0(0xb1a)]=_0x4d65d0(0x1181),document[_0x4d65d0(0x400)](_0x4d65d0(0x534))[_0x4d65d0(0xa00)][_0x4d65d0(0xb1a)]=_0x4d65d0(0x165b),document[_0x4d65d0(0x400)](_0x4d65d0(0xc0d))[_0x4d65d0(0xb08)][_0x4d65d0(0x12b6)](_0x4d65d0(0x5d6)),document[_0x4d65d0(0x400)](_0x4d65d0(0x6ef))[_0x4d65d0(0xb08)][_0x4d65d0(0xc46)]('active');if(_0x3bd75f)_0x144c37[_0x4d65d0(0xbdc)](_0x2ec74e=>{const _0x3b91a1=_0x4d65d0,_0x510fef=_0x23ff42(_0x2ec74e,'my',_0x18fa41);_0x2ec74e[_0x3b91a1(0x299)]===_0x52ea60&&_0x510fef[_0x3b91a1(0xb08)][_0x3b91a1(0x12b6)](_0x3b91a1(0x148b)),_0x23178e[_0x3b91a1(0x8f2)](_0x510fef);});else{const _0x3d5d80=_0x31ef6b[_0x4d65d0(0xa37)][_0x4d65d0(0xb24)]||_0x91d058,_0x31100d=_0x31ef6b['settings']['myAvatar']||(_0x31ef6b[_0x4d65d0(0xc98)]?_0x1f9bfa:_0x91d058);_0x144c37['forEach'](_0x9da208=>{const _0x44f271=_0x4d65d0,_0x1dc033=_0x23ff42(_0x9da208,'ai',_0x3d5d80);if(_0x9da208['url']===_0x71485e['ai'])_0x1dc033['classList'][_0x44f271(0x12b6)](_0x44f271(0x148b));_0x23178e['appendChild'](_0x1dc033);const _0x1c0f42=_0x23ff42(_0x9da208,'my',_0x31100d);if(_0x9da208['url']===_0x71485e['my'])_0x1c0f42[_0x44f271(0xb08)]['add'](_0x44f271(0x148b));_0x496a44['appendChild'](_0x1c0f42);});}}function _0x23ff42(_0x32be6d,_0x2405a3,_0x4acdb1){const _0x4efa70=_0x239c7d,_0x4fbdc3=document['createElement'](_0x4efa70(0xf8e));_0x4fbdc3[_0x4efa70(0x4e1)]='frame-item',_0x4fbdc3['dataset'][_0x4efa70(0x93f)]=_0x32be6d['url'],_0x4fbdc3['title']=_0x32be6d['name'];const _0x37e594=typeof _0x32be6d['id']===_0x4efa70(0x29b),_0x539c25=_0x37e594?_0x4efa70(0x8a3)+_0x32be6d['id']+_0x4efa70(0x4c7):'';return _0x4fbdc3[_0x4efa70(0x1575)]=_0x4efa70(0xf5a)+_0x539c25+_0x4efa70(0x7e1)+_0x4acdb1+_0x4efa70(0xe3d)+(_0x32be6d[_0x4efa70(0x299)]?'<img\x20src=\x22'+_0x32be6d[_0x4efa70(0x299)]+_0x4efa70(0x3a6):'')+_0x4efa70(0x1574),_0x4fbdc3[_0x4efa70(0x501)](_0x4efa70(0x15ad),_0x142294=>{const _0x693b38=_0x4efa70;if(_0x142294[_0x693b38(0x657)]['classList'][_0x693b38(0xd3f)](_0x693b38(0x1205)))return;if(_0x258505){if(_0x37e594){const _0x2fc87d=parseInt(_0x32be6d['id']);_0x4fbdc3['classList'][_0x693b38(0x146f)](_0x693b38(0x148b)),_0x165250[_0x693b38(0x3e3)](_0x2fc87d)?_0x165250[_0x693b38(0x942)](_0x2fc87d):_0x165250[_0x693b38(0x12b6)](_0x2fc87d),_0x4e4594();}}else{_0x71485e[_0x2405a3]=_0x32be6d['url'];const _0x36162c=_0x2405a3==='ai'?document[_0x693b38(0x400)]('ai-frame-grid'):document['getElementById']('my-frame-grid');_0x36162c[_0x693b38(0x527)]('.frame-item')[_0x693b38(0xbdc)](_0x24fd23=>_0x24fd23[_0x693b38(0xb08)]['remove'](_0x693b38(0x148b))),_0x4fbdc3[_0x693b38(0xb08)]['add']('selected');}}),_0x4fbdc3;}async function _0x465853(){const _0x32d2f5=_0x239c7d,_0x2dd634=document['getElementById'](_0x32d2f5(0x70d)),_0x37e973=await new Promise(_0x9cf24=>{const _0xc6fe97=_0x32d2f5,_0x3d1ede=_0x41f7ef=>{const _0x610775=_0x466f;_0x9cf24(_0x41f7ef[_0x610775(0x657)]['files'][0x0]||null),_0x2dd634[_0x610775(0xf17)]('change',_0x3d1ede);};_0x2dd634[_0xc6fe97(0x501)]('change',_0x3d1ede,{'once':!![]}),_0x2dd634[_0xc6fe97(0x15ad)]();});if(!_0x37e973)return;const _0x27b18c=await _0x25f61f(_0x32d2f5(0x1428),_0x32d2f5(0x8a6));if(!_0x27b18c||!_0x27b18c[_0x32d2f5(0xb8f)]())return;const _0x3d298f=await new Promise(_0x2315d4=>{const _0x4d1539=_0x32d2f5,_0x5985bb=new FileReader();_0x5985bb[_0x4d1539(0x9e0)]=()=>_0x2315d4(_0x5985bb[_0x4d1539(0xdd1)]),_0x5985bb[_0x4d1539(0x157f)](_0x37e973);});await _0x54c587['customAvatarFrames'][_0x32d2f5(0x12b6)]({'name':_0x27b18c[_0x32d2f5(0xb8f)](),'url':_0x3d298f}),_0x4999f0(_0x28b5be);}async function _0x1ef362(){const _0x26e307=_0x239c7d,_0x325739=_0x26e307(0x1291),_0x57b89e=await _0x25f61f(_0x26e307(0x6c4),_0x26e307(0xed2),'',_0x26e307(0x79e),_0x26e307(0xc2f)+_0x325739+_0x26e307(0x1236));if(!_0x57b89e||!_0x57b89e['trim']())return;const _0x32cc8d=_0x57b89e['trim']()['split']('\x0a'),_0x57ef95=[];let _0x40b2e2=0x0;for(const _0x3acbaf of _0x32cc8d){const _0x3bd51d=_0x3acbaf[_0x26e307(0xbf7)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x3bd51d)_0x57ef95[_0x26e307(0x6bb)]({'name':_0x3bd51d[0x1]['trim'](),'url':_0x3bd51d[0x2][_0x26e307(0xb8f)]()});else _0x3acbaf[_0x26e307(0xb8f)]()&&_0x40b2e2++;}_0x57ef95[_0x26e307(0x8d6)]>0x0&&(await _0x54c587[_0x26e307(0x4ba)][_0x26e307(0x666)](_0x57ef95),_0x4999f0(_0x28b5be),await _0x138765('导入成功',_0x26e307(0xa18)+_0x57ef95[_0x26e307(0x8d6)]+_0x26e307(0x52f))),_0x40b2e2>0x0&&await _0x138765(_0x26e307(0x703),'有\x20'+_0x40b2e2+_0x26e307(0x1ff));}async function _0x511e3f(_0x56c9db){const _0x12aed9=_0x239c7d,_0x4d8283=await _0x54c587[_0x12aed9(0x4ba)][_0x12aed9(0xf48)](_0x56c9db);if(!_0x4d8283)return;const _0x1bac60=await _0x56d4d3('确认删除','确定要删除头像框\x20“'+_0x4d8283[_0x12aed9(0xf3e)]+_0x12aed9(0xb38),{'confirmButtonClass':'btn-danger'});_0x1bac60&&(await _0x54c587['customAvatarFrames'][_0x12aed9(0x942)](_0x56c9db),_0x4999f0(_0x28b5be));}let _0x514a10=0x0;const _0xc0c9e4=0x2;function _0xe2ab3e(){const _0x525b68=_0x239c7d,_0x3bc265=document['getElementById'](_0x525b68(0x12de)),_0x516069=document[_0x525b68(0x400)](_0x525b68(0x10d2)),_0x45865e=document[_0x525b68(0x527)]('.pagination-dot');let _0x144032=0x0,_0xd168d0=0x0,_0x3591bc=0x0,_0x2ce115=![],_0x3a5333=!![];const _0x54bd6c=()=>{const _0x5526a1=_0x525b68;_0x516069[_0x5526a1(0xa00)][_0x5526a1(0x8ea)]=_0x5526a1(0x326)+_0x514a10*(0x64/_0xc0c9e4)+'%)',_0x45865e[_0x5526a1(0xbdc)]((_0x4ea2d5,_0x20947f)=>{const _0x569196=_0x5526a1;_0x4ea2d5[_0x569196(0xb08)]['toggle'](_0x569196(0x5d6),_0x20947f===_0x514a10);});},_0x1886c3=_0x6ba34b=>{const _0x405c69=_0x525b68;_0x2ce115=!![],_0x3a5333=!![],_0x144032=_0x6ba34b['type'][_0x405c69(0xd1b)](_0x405c69(0xedc))?_0x6ba34b['pageX']:_0x6ba34b['touches'][0x0][_0x405c69(0x123c)],_0xd168d0=_0x6ba34b[_0x405c69(0xbbf)][_0x405c69(0xd1b)](_0x405c69(0xedc))?_0x6ba34b[_0x405c69(0xd58)]:_0x6ba34b['touches'][0x0][_0x405c69(0xd58)],_0x516069['style'][_0x405c69(0x139d)]=_0x405c69(0x165b);},_0x276133=_0x294f01=>{const _0x4d8e61=_0x525b68;if(!_0x2ce115)return;const _0x3f104b=_0x294f01[_0x4d8e61(0xbbf)]['includes'](_0x4d8e61(0xedc))?_0x294f01[_0x4d8e61(0xd58)]:_0x294f01[_0x4d8e61(0x567)][0x0][_0x4d8e61(0xd58)];_0x3591bc=_0x294f01[_0x4d8e61(0xbbf)][_0x4d8e61(0xd1b)](_0x4d8e61(0xedc))?_0x294f01[_0x4d8e61(0x123c)]:_0x294f01['touches'][0x0][_0x4d8e61(0x123c)];const _0x3e9717=_0x3591bc-_0x144032,_0x290430=_0x3f104b-_0xd168d0;_0x3a5333&&(Math[_0x4d8e61(0x1396)](_0x3e9717)>0xa||Math[_0x4d8e61(0x1396)](_0x290430)>0xa)&&(_0x3a5333=![]);if(Math['abs'](_0x3e9717)>Math[_0x4d8e61(0x1396)](_0x290430)){if(_0x294f01['cancelable'])_0x294f01['preventDefault']();_0x516069[_0x4d8e61(0xa00)][_0x4d8e61(0x8ea)]=_0x4d8e61(0x882)+_0x514a10*(0x64/_0xc0c9e4)+_0x4d8e61(0x1650)+_0x3e9717+_0x4d8e61(0x7a2);}},_0x230599=_0x2091bc=>{const _0x3e71a7=_0x525b68;if(!_0x2ce115)return;_0x2ce115=![],_0x516069['style'][_0x3e71a7(0x139d)]='transform\x200.4s\x20cubic-bezier(0.4,\x200,\x200.2,\x201)';if(_0x3a5333){_0x54bd6c();return;}const _0x31ebef=_0x3591bc-_0x144032;if(Math['abs'](_0x31ebef)>_0x3bc265['offsetWidth']/0x4){if(_0x31ebef>0x0&&_0x514a10>0x0)_0x514a10--;else _0x31ebef<0x0&&_0x514a10<_0xc0c9e4-0x1&&_0x514a10++;}_0x54bd6c();};_0x3bc265[_0x525b68(0x501)](_0x525b68(0x8ce),_0x1886c3),_0x3bc265[_0x525b68(0x501)](_0x525b68(0x1602),_0x276133),_0x3bc265['addEventListener'](_0x525b68(0x98c),_0x230599),_0x3bc265[_0x525b68(0x501)]('mouseleave',_0x230599),_0x3bc265[_0x525b68(0x501)]('touchstart',_0x1886c3,{'passive':![]}),_0x3bc265[_0x525b68(0x501)](_0x525b68(0x1119),_0x276133,{'passive':![]}),_0x3bc265[_0x525b68(0x501)](_0x525b68(0x11bc),_0x230599);}let _0x361039=null;async function _0x29eb23(){const _0x344649=_0x239c7d;await _0x2e9442(),_0x257d51(_0x344649(0x681));}async function _0x2e9442(){const _0xdd9af1=_0x239c7d,_0xe2460a=document[_0xdd9af1(0x400)](_0xdd9af1(0x5ff)),_0x60b5de=document['getElementById'](_0xdd9af1(0x67e));_0xe2460a['innerHTML']='',_0x60b5de[_0xdd9af1(0x1575)]='';const [_0x433613,_0x43b109]=await Promise[_0xdd9af1(0x875)]([_0x54c587[_0xdd9af1(0xf53)][_0xdd9af1(0xce1)](),_0x54c587['presetCategories']['orderBy'](_0xdd9af1(0xf3e))[_0xdd9af1(0xce1)]()]);_0x4c8b14[_0xdd9af1(0xf53)]=_0x433613;if(_0x433613[_0xdd9af1(0x8d6)]===0x0){_0x60b5de['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一个预设</p>';return;}const _0x14d0b6=document[_0xdd9af1(0x2c9)](_0xdd9af1(0x99b));_0x14d0b6[_0xdd9af1(0x4e1)]=_0xdd9af1(0x1407),_0x14d0b6['textContent']='全部',_0x14d0b6[_0xdd9af1(0xd61)][_0xdd9af1(0x12c4)]=_0xdd9af1(0x875),_0xe2460a[_0xdd9af1(0x8f2)](_0x14d0b6);const _0x3cda84=document['createElement'](_0xdd9af1(0xf8e));_0x3cda84[_0xdd9af1(0x4e1)]='world-book-category-pane\x20active',_0x3cda84[_0xdd9af1(0xd61)][_0xdd9af1(0x12c4)]='all',_0x60b5de['appendChild'](_0x3cda84),_0x43b109['forEach'](_0x10d741=>{const _0x1007f6=_0xdd9af1,_0x18cb88=document[_0x1007f6(0x2c9)](_0x1007f6(0x99b));_0x18cb88[_0x1007f6(0x4e1)]=_0x1007f6(0x1513),_0x18cb88[_0x1007f6(0xde7)]=_0x10d741[_0x1007f6(0xf3e)],_0x18cb88[_0x1007f6(0xd61)][_0x1007f6(0x12c4)]=String(_0x10d741['id']),_0xe2460a['appendChild'](_0x18cb88);const _0xf06c1e=document[_0x1007f6(0x2c9)](_0x1007f6(0xf8e));_0xf06c1e[_0x1007f6(0x4e1)]=_0x1007f6(0x11d3),_0xf06c1e[_0x1007f6(0xd61)][_0x1007f6(0x12c4)]=String(_0x10d741['id']),_0x60b5de[_0x1007f6(0x8f2)](_0xf06c1e);});const _0xf33c1d=_0x433613[_0xdd9af1(0x1412)](_0x37466a=>!_0x37466a[_0xdd9af1(0x12c4)]);if(_0xf33c1d){const _0x3770db=document[_0xdd9af1(0x2c9)](_0xdd9af1(0x99b));_0x3770db[_0xdd9af1(0x4e1)]=_0xdd9af1(0x1513),_0x3770db[_0xdd9af1(0xde7)]=_0xdd9af1(0xac0),_0x3770db['dataset'][_0xdd9af1(0x12c4)]=_0xdd9af1(0x13c3),_0xe2460a[_0xdd9af1(0x8f2)](_0x3770db);const _0x595404=document['createElement']('div');_0x595404['className']=_0xdd9af1(0x11d3),_0x595404[_0xdd9af1(0xd61)][_0xdd9af1(0x12c4)]=_0xdd9af1(0x13c3),_0x60b5de[_0xdd9af1(0x8f2)](_0x595404);}_0x433613[_0xdd9af1(0xbdc)](_0x535c37=>{const _0x49a2bf=_0xdd9af1,_0x145cc3=_0x49a2bf(0x1561)+_0x535c37[_0x49a2bf(0x1109)][_0x49a2bf(0x8d6)]+_0x49a2bf(0x6e7),_0x3059ec=document[_0x49a2bf(0x2c9)](_0x49a2bf(0xf8e));_0x3059ec[_0x49a2bf(0x4e1)]=_0x49a2bf(0x8a8),_0x3059ec[_0x49a2bf(0x1575)]=_0x49a2bf(0x9e7)+_0x535c37[_0x49a2bf(0xf3e)]+_0x49a2bf(0xe9c)+_0x145cc3+_0x49a2bf(0x14f0);const _0x164c41=()=>_0x49b6b5(_0x535c37['id']),_0xeeb908=async()=>{const _0x33f4da=_0x49a2bf,_0x340d96=await _0x56d4d3(_0x33f4da(0x632),'确定要删除《'+_0x535c37[_0x33f4da(0xf3e)]+'》吗？',{'confirmButtonClass':'btn-danger'});_0x340d96&&(await _0x54c587[_0x33f4da(0xf53)][_0x33f4da(0x942)](_0x535c37['id']),_0x4c8b14[_0x33f4da(0xf53)]=await _0x54c587[_0x33f4da(0xf53)]['toArray'](),_0x2e9442());};_0x3059ec['addEventListener'](_0x49a2bf(0x15ad),_0x164c41),_0x3d4218(_0x3059ec,_0xeeb908);const _0xc46822=_0x3059ec[_0x49a2bf(0xdbc)](!![]);_0xc46822['addEventListener'](_0x49a2bf(0x15ad),_0x164c41),_0x3d4218(_0xc46822,_0xeeb908),_0x3cda84[_0x49a2bf(0x8f2)](_0xc46822);const _0x289e14=_0x535c37[_0x49a2bf(0x12c4)]?String(_0x535c37[_0x49a2bf(0x12c4)]):_0x49a2bf(0x13c3),_0x4e820a=_0x60b5de[_0x49a2bf(0x13ef)]('.world-book-category-pane[data-category-id=\x22'+_0x289e14+'\x22]');_0x4e820a&&_0x4e820a[_0x49a2bf(0x8f2)](_0x3059ec);}),document[_0xdd9af1(0x527)]('#preset-tabs\x20.world-book-tab')[_0xdd9af1(0xbdc)](_0x55e8a5=>{const _0xe9d13e=_0xdd9af1;_0x55e8a5[_0xe9d13e(0x501)](_0xe9d13e(0x15ad),()=>_0x1d5f5a(_0x55e8a5[_0xe9d13e(0xd61)]['categoryId']));});}function _0x1d5f5a(_0x1bc989){const _0x169aa3=_0x239c7d;document['querySelectorAll'](_0x169aa3(0x15c6))[_0x169aa3(0xbdc)](_0x5b0e4d=>{const _0x36fe51=_0x169aa3;_0x5b0e4d['classList'][_0x36fe51(0x146f)](_0x36fe51(0x5d6),_0x5b0e4d[_0x36fe51(0xd61)]['categoryId']===_0x1bc989);}),document['querySelectorAll'](_0x169aa3(0x2c2))[_0x169aa3(0xbdc)](_0x253ff4=>{const _0x4f52fe=_0x169aa3;_0x253ff4[_0x4f52fe(0xb08)][_0x4f52fe(0x146f)]('active',_0x253ff4[_0x4f52fe(0xd61)][_0x4f52fe(0x12c4)]===_0x1bc989);});}async function _0x49b6b5(_0x26f9d6){const _0x508866=_0x239c7d;_0x257d51(_0x508866(0x6d5)),_0x361039=_0x26f9d6;try{const [_0x47b328,_0x54787d]=await Promise[_0x508866(0x875)]([_0x54c587[_0x508866(0xf53)]['get'](_0x26f9d6),_0x54c587[_0x508866(0x145e)][_0x508866(0xce1)]()]);if(!_0x47b328){console['error'](_0x508866(0xe4b),_0x26f9d6),await _0x138765('加载失败',_0x508866(0x4b9)),_0x257d51('preset-screen');return;}setTimeout(()=>{const _0x3a9349=_0x508866;document[_0x3a9349(0x400)](_0x3a9349(0x2ec))['textContent']=_0x47b328[_0x3a9349(0xf3e)],document['getElementById'](_0x3a9349(0x225))[_0x3a9349(0xa1e)]=_0x47b328[_0x3a9349(0xf3e)];const _0x2f2339=document[_0x3a9349(0x400)](_0x3a9349(0xba4));_0x2f2339[_0x3a9349(0x1575)]='<option\x20value=\x22\x22>--\x20未分类\x20--</option>',_0x54787d['forEach'](_0x548b1e=>{const _0x50fe9a=_0x3a9349,_0xf24a5c=document[_0x50fe9a(0x2c9)](_0x50fe9a(0x1053));_0xf24a5c['value']=_0x548b1e['id'],_0xf24a5c[_0x50fe9a(0xde7)]=_0x548b1e['name'];if(_0x47b328[_0x50fe9a(0x12c4)]===_0x548b1e['id'])_0xf24a5c[_0x50fe9a(0x148b)]=!![];_0x2f2339[_0x50fe9a(0x8f2)](_0xf24a5c);});const _0x3b7742=document[_0x3a9349(0x400)](_0x3a9349(0x690));_0x3b7742[_0x3a9349(0x1575)]='',Array['isArray'](_0x47b328[_0x3a9349(0x1109)])&&_0x47b328['content'][_0x3a9349(0x8d6)]>0x0?_0x47b328['content'][_0x3a9349(0xbdc)](_0x2fe334=>{const _0x43d359=_0x3a9349,_0x56499c=_0x48e479(_0x2fe334);_0x3b7742[_0x43d359(0x8f2)](_0x56499c);}):_0x3b7742[_0x3a9349(0x1575)]=_0x3a9349(0x5d4);},0x32);}catch(_0x2b79d2){console[_0x508866(0x5d7)](_0x508866(0x14ba),_0x2b79d2),await _0x138765(_0x508866(0x639),'加载预设详情时发生错误:\x20'+_0x2b79d2[_0x508866(0x6e2)]),_0x257d51(_0x508866(0x681));}}function _0x48e479(_0x393d35={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x1ce9a3=_0x239c7d,_0x5da24e=document[_0x1ce9a3(0x2c9)](_0x1ce9a3(0xf8e));_0x5da24e[_0x1ce9a3(0x4e1)]='message-editor-block';const _0x1095ce=_0x393d35[_0x1ce9a3(0x250)]!==![]?_0x1ce9a3(0x6f9):'';_0x5da24e[_0x1ce9a3(0x1575)]=_0x1ce9a3(0x1102)+_0x1095ce+'>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22'+(_0x393d35['comment']||'')+_0x1ce9a3(0x350)+(_0x393d35['keys']||[])[_0x1ce9a3(0xee1)](',\x20')+_0x1ce9a3(0xec9)+(_0x393d35[_0x1ce9a3(0x1109)]||'')+_0x1ce9a3(0xc47),_0x5da24e[_0x1ce9a3(0x13ef)](_0x1ce9a3(0x9cd))[_0x1ce9a3(0x501)](_0x1ce9a3(0x15ad),()=>_0x5da24e['remove']());const _0x5a5e64=_0x5da24e[_0x1ce9a3(0x13ef)](_0x1ce9a3(0xccc)),_0x3cdcd7=_0x5da24e[_0x1ce9a3(0x13ef)](_0x1ce9a3(0xf83));return _0x5a5e64[_0x1ce9a3(0x501)]('click',()=>{const _0x444b48=_0x1ce9a3,_0x531980=_0x3cdcd7['style'][_0x444b48(0xb1a)]===_0x444b48(0x165b);_0x3cdcd7[_0x444b48(0xa00)][_0x444b48(0xb1a)]=_0x531980?_0x444b48(0x1181):'none',_0x5a5e64[_0x444b48(0xde7)]=_0x531980?'收起':'展开';}),_0x5da24e;}async function _0xf3e2f8(){const _0x2acd9c=_0x239c7d;await _0x51596a(),document[_0x2acd9c(0x13ef)](_0x2acd9c(0x7f6))['textContent']=_0x2acd9c(0x536),document[_0x2acd9c(0x400)](_0x2acd9c(0x11c8))[_0x2acd9c(0x41b)]=_0x7b7092,document['getElementById']('existing-groups-list')[_0x2acd9c(0x41b)]=_0x46976c=>{const _0x519c0e=_0x2acd9c;_0x46976c[_0x519c0e(0x657)][_0x519c0e(0xb08)]['contains'](_0x519c0e(0xd38))&&_0x26c887(parseInt(_0x46976c['target'][_0x519c0e(0xd61)]['id']));},document[_0x2acd9c(0x400)](_0x2acd9c(0x6bc))[_0x2acd9c(0x41b)]=()=>{const _0x259d38=_0x2acd9c;document['getElementById'](_0x259d38(0x367))[_0x259d38(0xb08)][_0x259d38(0xc46)](_0x259d38(0x9eb)),_0x2e9442();},document[_0x2acd9c(0x400)](_0x2acd9c(0x367))[_0x2acd9c(0xb08)][_0x2acd9c(0x12b6)](_0x2acd9c(0x9eb));}async function _0x51596a(){const _0x541a1=_0x239c7d,_0x24434d=document[_0x541a1(0x400)]('existing-groups-list'),_0x53da34=await _0x54c587[_0x541a1(0x145e)]['toArray']();_0x24434d[_0x541a1(0x1575)]='',_0x53da34[_0x541a1(0x8d6)]===0x0&&(_0x24434d[_0x541a1(0x1575)]='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>'),_0x53da34['forEach'](_0x540f08=>{const _0x2d96a4=_0x541a1,_0x1398a5=document['createElement'](_0x2d96a4(0xf8e));_0x1398a5['className']=_0x2d96a4(0xf94),_0x1398a5['innerHTML']=_0x2d96a4(0x57c)+_0x540f08[_0x2d96a4(0xf3e)]+_0x2d96a4(0x5fb)+_0x540f08['id']+'\x22>×</span>',_0x24434d[_0x2d96a4(0x8f2)](_0x1398a5);});}async function _0x7b7092(){const _0x598d57=_0x239c7d,_0x313cae=document[_0x598d57(0x400)]('new-group-name-input'),_0xcac02c=_0x313cae['value'][_0x598d57(0xb8f)]();if(!_0xcac02c)return alert('分类名不能为空！');const _0x39ce98=await _0x54c587['presetCategories'][_0x598d57(0x227)](_0x598d57(0xf3e))['equals'](_0xcac02c)[_0x598d57(0x149c)]();if(_0x39ce98)return alert('分类\x20\x22'+_0xcac02c+_0x598d57(0x1456));await _0x54c587[_0x598d57(0x145e)][_0x598d57(0x12b6)]({'name':_0xcac02c}),_0x313cae[_0x598d57(0xa1e)]='',await _0x51596a();}async function _0x26c887(_0x49309b){const _0x2bcd00=_0x239c7d,_0x2d4fda=await _0x56d4d3(_0x2bcd00(0x713),_0x2bcd00(0xbca),{'confirmButtonClass':_0x2bcd00(0x142c)});_0x2d4fda&&(await _0x54c587[_0x2bcd00(0x145e)][_0x2bcd00(0x942)](_0x49309b),await _0x54c587[_0x2bcd00(0xf53)]['where'](_0x2bcd00(0x12c4))[_0x2bcd00(0x4ce)](_0x49309b)[_0x2bcd00(0x832)]({'categoryId':null}),_0x4c8b14[_0x2bcd00(0xf53)]=await _0x54c587[_0x2bcd00(0xf53)]['toArray'](),await _0x51596a());}async function _0x193863(_0x1212cd){const _0x2538b3=_0x239c7d,_0x370557=_0x1212cd[_0x2538b3(0x657)][_0x2538b3(0x780)][0x0];if(!_0x370557)return;try{if(!_0x370557['name'][_0x2538b3(0x8c7)](_0x2538b3(0xbfb)))throw new Error('文件格式不支持。请选择\x20.json\x20格式的\x20Tavern\x20预设文件。');const _0x5610c1=await _0x370557['text'](),_0x478e1b=JSON[_0x2538b3(0x13f7)](_0x5610c1);await _0x4d4ee9(_0x478e1b,_0x370557[_0x2538b3(0xf3e)]);}catch(_0x1282ed){console['error'](_0x2538b3(0x12b1),_0x1282ed),await _0x138765(_0x2538b3(0x3e8),_0x2538b3(0x753)+_0x1282ed[_0x2538b3(0x6e2)]);}finally{_0x1212cd[_0x2538b3(0x657)][_0x2538b3(0xa1e)]=null;}}async function _0x4d4ee9(_0x28a526,_0x2dfe0d){const _0x54480f=_0x239c7d;let _0x2f1c57=[];if(Array[_0x54480f(0x16a1)](_0x28a526['prompts'])&&Array[_0x54480f(0x16a1)](_0x28a526[_0x54480f(0x64c)])&&_0x28a526['prompt_order'][_0x54480f(0x8d6)]>0x0){console['log']('检测到\x20Tavern/SillyTavern\x20预设格式，将严格按照\x20prompt_order\x20排序。');const _0x4e0d4b=new Map(_0x28a526[_0x54480f(0x15ce)][_0x54480f(0xd18)](_0x4936db=>[_0x4936db[_0x54480f(0x561)],_0x4936db])),_0x2f987f=_0x28a526[_0x54480f(0x64c)]['reduce']((_0x3e0065,_0xf24b7a)=>_0xf24b7a[_0x54480f(0xb2d)]&&_0xf24b7a[_0x54480f(0xb2d)][_0x54480f(0x8d6)]>(_0x3e0065[_0x54480f(0x8d6)]||0x0)?_0xf24b7a[_0x54480f(0xb2d)]:_0x3e0065,[]);_0x2f987f&&_0x2f987f[_0x54480f(0x8d6)]>0x0&&(_0x2f1c57=_0x2f987f[_0x54480f(0xd18)](_0x52a2b4=>{const _0x2d4576=_0x54480f,_0x10479c=_0x4e0d4b[_0x2d4576(0xf48)](_0x52a2b4[_0x2d4576(0x561)]);if(_0x10479c)return{'keys':[],'comment':_0x10479c['name']||_0x2d4576(0xc0b),'content':_0x10479c[_0x2d4576(0x1109)]||'','enabled':_0x52a2b4['enabled']};return null;})[_0x54480f(0x29d)](Boolean));}else{if(_0x28a526[_0x54480f(0x9de)]&&typeof _0x28a526[_0x54480f(0x9de)]===_0x54480f(0xfc4))console['log']('检测到\x20\x27entries\x27\x20对象格式的预设，将尝试按顺序导入。'),Array[_0x54480f(0x16a1)](_0x28a526[_0x54480f(0xb2d)])?(console[_0x54480f(0x1e6)](_0x54480f(0xcfe)),_0x2f1c57=_0x28a526[_0x54480f(0xb2d)][_0x54480f(0xd18)](_0x34a22b=>_0x28a526['entries'][_0x34a22b])[_0x54480f(0x29d)](Boolean)[_0x54480f(0xd18)](_0x10e401=>({'keys':_0x10e401[_0x54480f(0xa30)]||[],'comment':_0x10e401[_0x54480f(0x83c)]||_0x54480f(0x955),'content':_0x10e401['content']||'','enabled':!_0x10e401[_0x54480f(0x13f4)]}))):(console[_0x54480f(0x75e)](_0x54480f(0x1024)),_0x2f1c57=Object[_0x54480f(0x40a)](_0x28a526[_0x54480f(0x9de)])[_0x54480f(0xd18)](_0x2e2610=>({'keys':_0x2e2610[_0x54480f(0xa30)]||[],'comment':_0x2e2610[_0x54480f(0x83c)]||_0x54480f(0x955),'content':_0x2e2610[_0x54480f(0x1109)]||'','enabled':!_0x2e2610[_0x54480f(0x13f4)]})));else{if(Array[_0x54480f(0x16a1)](_0x28a526[_0x54480f(0x15ce)]))console[_0x54480f(0x1e6)]('检测到简单的\x20\x27prompts\x27\x20数组格式，将按数组内顺序导入。'),_0x2f1c57=_0x28a526['prompts'][_0x54480f(0xd18)](_0x8fb9c1=>({'keys':[],'comment':_0x8fb9c1[_0x54480f(0xf3e)]||_0x54480f(0xc0b),'content':_0x8fb9c1[_0x54480f(0x1109)]||'','enabled':!![]}));else throw new Error(_0x54480f(0x2f6));}}_0x2f1c57=_0x2f1c57[_0x54480f(0x29d)](_0x8f9cd7=>_0x8f9cd7[_0x54480f(0x1109)]);if(_0x2f1c57[_0x54480f(0x8d6)]===0x0){alert(_0x54480f(0xd8d));return;}const _0x34168f=_0x2dfe0d[_0x54480f(0xe19)](/\.json$/i,''),_0x42a2d7=await _0x25f61f(_0x54480f(0xcc5),_0x54480f(0xab3),_0x34168f);if(!_0x42a2d7||!_0x42a2d7['trim']()){alert(_0x54480f(0x11f8));return;}const _0x19f0c5={'id':_0x54480f(0x1529)+Date[_0x54480f(0xecd)](),'name':_0x42a2d7[_0x54480f(0xb8f)](),'content':_0x2f1c57,'categoryId':null};await _0x54c587[_0x54480f(0xf53)][_0x54480f(0x12b6)](_0x19f0c5),_0x4c8b14[_0x54480f(0xf53)][_0x54480f(0x6bb)](_0x19f0c5),await _0x2e9442(),await _0x138765(_0x54480f(0xe9b),_0x54480f(0x1417)+_0x42a2d7+'》。');}async function _0x31c41b(_0x2853d4){const _0xacd42a=_0x239c7d,_0x11ff88=document['getElementById'](_0xacd42a(0xb30));if(!_0x11ff88)return;const _0x255b31=_0x4c8b14[_0xacd42a(0xf53)]||[];_0x11ff88[_0xacd42a(0x1575)]='<option\x20value=\x22\x22>--\x20不使用预设\x20--</option>',_0x255b31[_0xacd42a(0xbdc)](_0xc33b9c=>{const _0x902625=_0xacd42a,_0x372796=document[_0x902625(0x2c9)]('option');_0x372796['value']=_0xc33b9c['id'],_0x372796[_0x902625(0xde7)]=_0xc33b9c['name'],_0x11ff88[_0x902625(0x8f2)](_0x372796);}),_0x2853d4[_0xacd42a(0xa37)][_0xacd42a(0x8ae)]&&(_0x11ff88[_0xacd42a(0xa1e)]=_0x2853d4['settings'][_0xacd42a(0x8ae)]);}function _0x48013a(){const _0x484a5c=_0x239c7d,_0x118f42=document[_0x484a5c(0x400)](_0x484a5c(0xc3f));if(!_0x118f42)return;_0x118f42['innerHTML']='';let _0x26823f=_0x4c8b14['globalSettings'][_0x484a5c(0xd14)]||_0x12cac1;_0x26823f[_0x484a5c(0xbdc)](_0x2794dc=>{const _0xa8bdd2=_0x484a5c,_0x155582=document[_0xa8bdd2(0x400)](_0x2794dc);if(_0x155582){const _0x1e78f8=document[_0xa8bdd2(0x2c9)]('div');_0x1e78f8[_0xa8bdd2(0x4e1)]=_0xa8bdd2(0x120b),_0x1e78f8[_0xa8bdd2(0xb48)]=!![],_0x1e78f8[_0xa8bdd2(0xd61)][_0xa8bdd2(0x80f)]=_0x2794dc,_0x1e78f8[_0xa8bdd2(0x1575)]=_0x155582[_0xa8bdd2(0x1575)],_0x118f42[_0xa8bdd2(0x8f2)](_0x1e78f8);}});}function _0x1b2e70(){const _0x4521b0=_0x239c7d,_0x15d3ab=document['getElementById'](_0x4521b0(0xc3f));if(!_0x15d3ab)return;let _0xa2519d=null;const _0x13a8f8=_0x377f5e=>{const _0x488e8b=_0x4521b0,_0x4cc4c7=_0x377f5e[_0x488e8b(0x657)][_0x488e8b(0x117a)]('.draggable-button-item');if(!_0x4cc4c7)return;_0xa2519d=_0x4cc4c7,_0xa2519d[_0x488e8b(0xb08)][_0x488e8b(0x12b6)](_0x488e8b(0x5f4));if(_0x377f5e[_0x488e8b(0x786)])_0x377f5e['preventDefault']();},_0x5a2d1a=_0x2e8115=>{const _0x11426b=_0x4521b0;if(!_0xa2519d)return;const _0x13a056=_0x2e8115[_0x11426b(0xbbf)][_0x11426b(0xd1b)](_0x11426b(0xedc))?_0x2e8115[_0x11426b(0x13c9)]:_0x2e8115[_0x11426b(0x567)][0x0][_0x11426b(0x13c9)],_0x107fd2=_0x4a63fe(_0x15d3ab,_0x13a056);_0x107fd2==null?_0x15d3ab[_0x11426b(0x8f2)](_0xa2519d):_0x15d3ab[_0x11426b(0x1465)](_0xa2519d,_0x107fd2);},_0x212f1d=()=>{const _0x58f809=_0x4521b0;if(!_0xa2519d)return;_0xa2519d[_0x58f809(0xb08)][_0x58f809(0xc46)](_0x58f809(0x5f4)),_0xa2519d=null,_0x32891f();};_0x15d3ab[_0x4521b0(0x501)](_0x4521b0(0x8ce),_0x13a8f8),_0x15d3ab['addEventListener']('touchstart',_0x13a8f8,{'passive':![]}),_0x15d3ab[_0x4521b0(0x501)](_0x4521b0(0x1602),_0x5a2d1a),_0x15d3ab[_0x4521b0(0x501)](_0x4521b0(0x1119),_0x5a2d1a,{'passive':![]}),_0x15d3ab[_0x4521b0(0x501)]('mouseup',_0x212f1d),_0x15d3ab['addEventListener'](_0x4521b0(0x164a),_0x212f1d),_0x15d3ab[_0x4521b0(0x501)](_0x4521b0(0x11bc),_0x212f1d);}function _0x4a63fe(_0x587b6a,_0x357cef){const _0x53a993=_0x239c7d,_0x2b9f62=[..._0x587b6a[_0x53a993(0x527)](_0x53a993(0x76f))];return _0x2b9f62[_0x53a993(0x439)]((_0x2adeee,_0x185982)=>{const _0x304097=_0x53a993,_0x234ad0=_0x185982[_0x304097(0x1437)](),_0x5129c9=_0x357cef-_0x234ad0[_0x304097(0xfef)]-_0x234ad0[_0x304097(0x1383)]/0x2;return _0x5129c9<0x0&&_0x5129c9>_0x2adeee[_0x304097(0x696)]?{'offset':_0x5129c9,'element':_0x185982}:_0x2adeee;},{'offset':Number[_0x53a993(0x58d)]})[_0x53a993(0x14c2)];}async function _0x32891f(){const _0x54a5b9=_0x239c7d,_0x401c38=document['getElementById'](_0x54a5b9(0xc3f)),_0x2afb87=Array[_0x54a5b9(0xdc0)](_0x401c38[_0x54a5b9(0x527)](_0x54a5b9(0x12a9)))['map'](_0x5f03b3=>_0x5f03b3['dataset'][_0x54a5b9(0x80f)]);_0x4c8b14[_0x54a5b9(0x14f1)]['chatActionButtonsOrder']=_0x2afb87,await _0x54c587[_0x54a5b9(0x14f1)]['put'](_0x4c8b14['globalSettings']);}function _0x31c703(){const _0x5c115c=_0x239c7d,_0x45f00d=_0x4c8b14[_0x5c115c(0x14f1)][_0x5c115c(0xd14)];if(!_0x45f00d||!Array['isArray'](_0x45f00d)||_0x45f00d[_0x5c115c(0x8d6)]===0x0)return;const _0x5d826c=document[_0x5c115c(0x400)]('chat-input-actions-top');if(!_0x5d826c)return;_0x45f00d['forEach'](_0x1650ca=>{const _0x306125=document['getElementById'](_0x1650ca);_0x306125&&_0x5d826c['appendChild'](_0x306125);});}const _0x12cac1=[_0x239c7d(0xb7f),_0x239c7d(0x55f),'upload-image-btn','transfer-btn','voice-message-btn','send-waimai-request-btn',_0x239c7d(0xb59),'group-video-call-btn',_0x239c7d(0x633),_0x239c7d(0x2e6),'share-location-btn',_0x239c7d(0xe5f),_0x239c7d(0x6fa),_0x239c7d(0xec1),_0x239c7d(0xd81),_0x239c7d(0x4f0),'propel-btn',_0x239c7d(0xe7f),'werewolf-game-btn',_0x239c7d(0xbd8),_0x239c7d(0x11c3),_0x239c7d(0x9f3)];async function _0x43ca10(){const _0x397e62=_0x239c7d;_0x4c8b14[_0x397e62(0x14f1)][_0x397e62(0xd14)]=null,await _0x54c587['globalSettings'][_0x397e62(0x4cb)](_0x4c8b14[_0x397e62(0x14f1)]),_0x48013a(),_0x31c703(),await _0x138765('成功',_0x397e62(0x2b6));}let _0x3048d8=[],_0x961b5e=[];function _0x1072f8(){const _0x596ba6=_0x239c7d,_0x999459=document['getElementById'](_0x596ba6(0xa36));_0x3048d8=[],_0x961b5e=[],_0x243a31(),document['getElementById'](_0x596ba6(0x16a7))[_0x596ba6(0xa00)][_0x596ba6(0xb1a)]='flex',document[_0x596ba6(0x400)]('data-clear-step-2')[_0x596ba6(0xa00)][_0x596ba6(0xb1a)]=_0x596ba6(0x165b),_0x999459[_0x596ba6(0xb08)][_0x596ba6(0x12b6)](_0x596ba6(0x9eb));}function _0x243a31(){const _0xef3c34=_0x239c7d,_0x27fbf3=document[_0xef3c34(0x400)]('data-clear-char-list');_0x27fbf3[_0xef3c34(0x1575)]='';const _0x199f23=document['createElement']('div');_0x199f23[_0xef3c34(0x4e1)]=_0xef3c34(0x417),_0x199f23[_0xef3c34(0xd61)]['charId']='user',_0x199f23['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+(_0x4c8b14['qzoneSettings'][_0xef3c34(0xbf3)]||'我')+_0xef3c34(0x9ec),_0x27fbf3[_0xef3c34(0x8f2)](_0x199f23),Object[_0xef3c34(0x40a)](_0x4c8b14[_0xef3c34(0xbea)])[_0xef3c34(0xbdc)](_0x292747=>{const _0x4f99f1=_0xef3c34;if(!_0x292747[_0x4f99f1(0xc98)]){const _0x4f6a96=document['createElement']('div');_0x4f6a96[_0x4f99f1(0x4e1)]='clear-posts-item',_0x4f6a96[_0x4f99f1(0xd61)]['charId']=_0x292747['id'],_0x4f6a96['innerHTML']=_0x4f99f1(0x11d1)+_0x292747[_0x4f99f1(0xf3e)]+'\x20(角色)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x27fbf3['appendChild'](_0x4f6a96);}});}function _0x43dff0(){const _0x420a27=_0x239c7d,_0x4a725c=document[_0x420a27(0x400)](_0x420a27(0x10d3));_0x4a725c['innerHTML']='';const _0x444553=[{'id':_0x420a27(0x4e3),'name':_0x420a27(0xd86),'description':_0x420a27(0x49d)},{'id':'qzone','name':_0x420a27(0xadc),'description':_0x420a27(0x2f4)},{'id':'calls','name':_0x420a27(0xaff),'description':_0x420a27(0x1f7)},{'id':_0x420a27(0xf87),'name':'心声','description':'将清空选定角色的心声和散记历史。'},{'id':'memories','name':_0x420a27(0x437),'description':_0x420a27(0x104c)},{'id':'favorites','name':'收藏','description':_0x420a27(0x1463)},{'id':_0x420a27(0x12cf),'name':_0x420a27(0x15a3),'description':_0x420a27(0xac5)}];_0x444553[_0x420a27(0xbdc)](_0x160787=>{const _0x44dbc9=_0x420a27,_0x35ebe3=document['createElement']('div');_0x35ebe3[_0x44dbc9(0x4e1)]='clear-posts-item',_0x35ebe3[_0x44dbc9(0xd61)][_0x44dbc9(0xa44)]=_0x160787['id'],_0x35ebe3[_0x44dbc9(0x1575)]=_0x44dbc9(0xdd3)+_0x160787[_0x44dbc9(0xf3e)]+_0x44dbc9(0x118f)+_0x160787[_0x44dbc9(0x12a5)]+_0x44dbc9(0x151c),_0x4a725c[_0x44dbc9(0x8f2)](_0x35ebe3);});}function _0x2046a5(){const _0x42fd4f=_0x239c7d,_0x43e0db=document[_0x42fd4f(0x527)]('#data-clear-char-list\x20.clear-posts-item.selected');if(_0x43e0db[_0x42fd4f(0x8d6)]===0x0){alert(_0x42fd4f(0x1153));return;}_0x3048d8=Array['from'](_0x43e0db)[_0x42fd4f(0xd18)](_0x3963c1=>_0x3963c1[_0x42fd4f(0xd61)][_0x42fd4f(0x869)]),_0x43dff0(),document['getElementById'](_0x42fd4f(0x16a7))[_0x42fd4f(0xa00)][_0x42fd4f(0xb1a)]=_0x42fd4f(0x165b),document['getElementById'](_0x42fd4f(0x169e))[_0x42fd4f(0xa00)][_0x42fd4f(0xb1a)]=_0x42fd4f(0x375);}function _0x536a14(){const _0x869b75=_0x239c7d;document['getElementById']('data-clear-step-2')['style'][_0x869b75(0xb1a)]=_0x869b75(0x165b),document[_0x869b75(0x400)]('data-clear-step-1')[_0x869b75(0xa00)][_0x869b75(0xb1a)]='flex',document[_0x869b75(0x527)](_0x869b75(0x3e2))['forEach'](_0x36bc8d=>{const _0x48122b=_0x869b75;_0x3048d8[_0x48122b(0xd1b)](_0x36bc8d['dataset'][_0x48122b(0x869)])&&_0x36bc8d[_0x48122b(0xb08)][_0x48122b(0x12b6)](_0x48122b(0x148b));});}async function _0xf08705(){const _0x46ab78=_0x239c7d,_0x210fa1=document[_0x46ab78(0x527)](_0x46ab78(0x11e6));if(_0x210fa1[_0x46ab78(0x8d6)]===0x0){alert(_0x46ab78(0x1099));return;}_0x961b5e=Array[_0x46ab78(0xdc0)](_0x210fa1)[_0x46ab78(0xd18)](_0x3df364=>_0x3df364[_0x46ab78(0xd61)][_0x46ab78(0xa44)]);const _0x191161=await _0x56d4d3(_0x46ab78(0x1309),_0x46ab78(0x12cc),{'confirmButtonClass':_0x46ab78(0x142c),'confirmText':_0x46ab78(0x713)});if(!_0x191161)return;await _0x138765(_0x46ab78(0x13e9),_0x46ab78(0x256));try{await _0x54c587[_0x46ab78(0xfec)]('rw',_0x54c587[_0x46ab78(0xfcf)],async()=>{const _0x32e224=_0x46ab78;for(const _0x4917ff of _0x3048d8){for(const _0x5a03f9 of _0x961b5e){if(_0x5a03f9===_0x32e224(0x4e3)){if(_0x4917ff===_0x32e224(0x6d6)){const _0x38b087=await _0x54c587['chats']['toArray']();for(const _0x2d59f4 of _0x38b087){_0x2d59f4[_0x32e224(0x92c)]=_0x2d59f4['history'][_0x32e224(0x29d)](_0x32aa22=>_0x32aa22[_0x32e224(0x71a)]!==_0x32e224(0x6d6)),await _0x54c587[_0x32e224(0xbea)]['put'](_0x2d59f4);}}else{const _0xd319ce=await _0x54c587[_0x32e224(0xbea)][_0x32e224(0xf48)](_0x4917ff);_0xd319ce&&(_0xd319ce[_0x32e224(0x92c)]=[],_0xd319ce[_0x32e224(0x8ab)]=_0x32e224(0x166b),_0xd319ce[_0x32e224(0x13e5)]=_0x32e224(0x166b),Array[_0x32e224(0x16a1)](_0xd319ce['nameHistory'])&&(_0xd319ce['nameHistory']=[]),_0xd319ce[_0x32e224(0xa37)]&&(_0xd319ce[_0x32e224(0xa37)][_0x32e224(0x14a8)]='我'),await _0x54c587['chats']['put'](_0xd319ce));}}if(_0x5a03f9===_0x32e224(0x748)){const _0x47ae18=_0x4917ff===_0x32e224(0x6d6)?_0x32e224(0x6d6):_0x4917ff;await _0x54c587[_0x32e224(0xba7)][_0x32e224(0x227)](_0x32e224(0x606))[_0x32e224(0x4ce)](_0x47ae18)[_0x32e224(0x942)]();}_0x5a03f9===_0x32e224(0xad7)&&_0x4917ff!=='user'&&await _0x54c587[_0x32e224(0x688)]['where']('chatId')['equals'](_0x4917ff)['delete']();if(_0x5a03f9==='thoughts'&&_0x4917ff!==_0x32e224(0x6d6)){const _0x163f3d=await _0x54c587[_0x32e224(0xbea)][_0x32e224(0xf48)](_0x4917ff);_0x163f3d&&(_0x163f3d[_0x32e224(0x13a1)]=[],_0x163f3d[_0x32e224(0x8ab)]=_0x32e224(0x166b),_0x163f3d[_0x32e224(0x13e5)]=_0x32e224(0x166b),await _0x54c587[_0x32e224(0xbea)][_0x32e224(0x4cb)](_0x163f3d));}if(_0x5a03f9===_0x32e224(0x1541)&&_0x4917ff!==_0x32e224(0x6d6)){const _0x420a14=await _0x54c587['chats']['get'](_0x4917ff);_0x420a14&&(_0x420a14[_0x32e224(0x1600)]=[],await _0x54c587[_0x32e224(0xbea)][_0x32e224(0x4cb)](_0x420a14));}_0x5a03f9==='favorites'&&(_0x4917ff===_0x32e224(0x6d6)?(await _0x54c587[_0x32e224(0x69c)][_0x32e224(0x227)](_0x32e224(0xbbf))['equals'](_0x32e224(0x1353))[_0x32e224(0x29d)](_0x35cbd1=>_0x35cbd1[_0x32e224(0x1109)]['authorId']==='user')[_0x32e224(0x942)](),await _0x54c587[_0x32e224(0x69c)][_0x32e224(0x227)](_0x32e224(0xbbf))[_0x32e224(0x4ce)](_0x32e224(0x9da))['filter'](_0x50a0ab=>_0x50a0ab['content'][_0x32e224(0x71a)]===_0x32e224(0x6d6))[_0x32e224(0x942)]()):(await _0x54c587[_0x32e224(0x69c)][_0x32e224(0x227)](_0x32e224(0xbbf))[_0x32e224(0x4ce)](_0x32e224(0x9da))[_0x32e224(0x63d)](_0x5127f9=>_0x5127f9['chatId']===_0x4917ff)[_0x32e224(0x942)](),await _0x54c587[_0x32e224(0x69c)]['where'](_0x32e224(0xbbf))[_0x32e224(0x4ce)]('qzone_post')[_0x32e224(0x29d)](_0x165f66=>_0x165f66['content'][_0x32e224(0x606)]===_0x4917ff)['delete'](),await _0x54c587[_0x32e224(0x69c)][_0x32e224(0x227)](_0x32e224(0xbbf))['equals'](_0x32e224(0x42e))['filter'](_0xb3948a=>_0xb3948a[_0x32e224(0x1109)]['characterId']===_0x4917ff)[_0x32e224(0x942)](),await _0x54c587[_0x32e224(0x69c)][_0x32e224(0x227)](_0x32e224(0xbbf))[_0x32e224(0x4ce)](_0x32e224(0xae2))[_0x32e224(0x29d)](_0xae67d0=>_0xae67d0[_0x32e224(0x1109)][_0x32e224(0x6d4)]===_0x4917ff)['delete'](),await _0x54c587[_0x32e224(0x69c)]['where'](_0x32e224(0xbbf))[_0x32e224(0x4ce)](_0x32e224(0xbcb))[_0x32e224(0x29d)](_0x1c2f79=>_0x1c2f79[_0x32e224(0x1109)][_0x32e224(0x6d4)]===_0x4917ff)[_0x32e224(0x942)]()));if(_0x5a03f9==='cphone'&&_0x4917ff!==_0x32e224(0x6d6)){const _0x9b9fb8=await _0x54c587[_0x32e224(0xbea)][_0x32e224(0xf48)](_0x4917ff);_0x9b9fb8&&(_0x9b9fb8[_0x32e224(0x8b7)]=[],_0x9b9fb8[_0x32e224(0x1294)]=[],_0x9b9fb8[_0x32e224(0x11c5)]=[],_0x9b9fb8[_0x32e224(0x47b)]=null,_0x9b9fb8[_0x32e224(0x930)]=[],_0x9b9fb8[_0x32e224(0x12e0)]=[],_0x9b9fb8[_0x32e224(0xc5e)]=[],_0x9b9fb8[_0x32e224(0x82a)]=[],_0x9b9fb8[_0x32e224(0x421)]=[],await _0x54c587[_0x32e224(0xbea)][_0x32e224(0x4cb)](_0x9b9fb8));}}}}),await _0x38980a(),await _0x41b828(),document[_0x46ab78(0x400)]('data-clear-wizard-modal')[_0x46ab78(0xb08)][_0x46ab78(0xc46)](_0x46ab78(0x9eb)),await _0x138765(_0x46ab78(0xfd2),_0x46ab78(0x1196));}catch(_0x36b12f){console['error']('高级数据清理失败:',_0x36b12f),await _0x138765(_0x46ab78(0x56e),_0x46ab78(0xb80)+_0x36b12f[_0x46ab78(0x6e2)]);}}async function _0x4c1b29(_0x32e3db,_0xf06431,_0x5bfeaf){const _0x5e27b5=_0x239c7d,_0x57e0a7=_0x5bfeaf['querySelector'](_0x5e27b5(0xae3))[_0x5e27b5(0xda9)],_0x3032e7=await _0x14b058('更换“'+_0x57e0a7+_0x5e27b5(0xf9d),[{'text':_0x5e27b5(0xf4d),'value':_0x5e27b5(0xdf5)},{'text':_0x5e27b5(0x15b7),'value':'url'}]);let _0x2223c6=null;if(_0x3032e7===_0x5e27b5(0xdf5))_0x2223c6=await _0x1f7db7();else{if(_0x3032e7==='url'){const _0x2aae52=_0xf06431===_0x5e27b5(0x12cf)?_0x4c8b14[_0x5e27b5(0x14f1)][_0x5e27b5(0x5d8)][_0x32e3db]:_0x4c8b14['globalSettings'][_0x5e27b5(0x10d4)][_0x32e3db],_0x4935a2=_0x2aae52[_0x5e27b5(0xbb9)]('data:image'),_0x2bba5d=_0x4935a2?'':_0x2aae52;_0x2223c6=await _0x25f61f(_0x5e27b5(0x1460),_0x5e27b5(0x1399),_0x2bba5d,'url');}}if(_0x2223c6&&_0x2223c6[_0x5e27b5(0xb8f)]()){const _0x4a9752=_0x2223c6['trim']();_0xf06431==='cphone'?_0x4c8b14[_0x5e27b5(0x14f1)]['cphoneAppIcons'][_0x32e3db]=_0x4a9752:_0x4c8b14['globalSettings'][_0x5e27b5(0x10d4)][_0x32e3db]=_0x4a9752,_0x5bfeaf[_0x5e27b5(0x13ef)](_0x5e27b5(0xae3))[_0x5e27b5(0x912)]=_0x4a9752;}else _0x2223c6!==null&&alert(_0x5e27b5(0x841));}async function _0x5b6422(){const _0x3187c6=_0x239c7d,_0x721b32=await _0x56d4d3('确认压缩图片？','此操作将扫描并压缩所有本地上传的图片（Base64格式），将其转换为JPEG以减小体积。这会轻微降低图片质量且【不可恢复】。<br><br><strong>强烈建议在操作前先进行数据备份！</strong>',{'confirmButtonClass':_0x3187c6(0x142c),'confirmText':_0x3187c6(0x98b)});if(!_0x721b32)return;await _0x138765(_0x3187c6(0x13e9),_0x3187c6(0x7f1));let _0x51e277={'found':0x0,'compressed':0x0,'skipped':0x0,'originalSize':0x0,'newSize':0x0};try{console[_0x3187c6(0x1e6)](_0x3187c6(0xa2a));const _0x3a2c29=[_0x3187c6(0xbea),'globalSettings',_0x3187c6(0x834),_0x3187c6(0x120c),_0x3187c6(0x4ba)],_0x544717=[];for(const _0x4bf9be of _0x3a2c29){const _0x42d705=_0x54c587[_0x3187c6(0x770)](_0x4bf9be),_0x5a7e7b=await _0x42d705[_0x3187c6(0xce1)]();_0x544717[_0x3187c6(0x6bb)]({'tableName':_0x4bf9be,'records':_0x5a7e7b});}console['log'](_0x3187c6(0x958));for(const _0x4dd43d of _0x544717){for(const _0x1fd717 of _0x4dd43d[_0x3187c6(0x771)]){await _0x3a7fa3(_0x1fd717,_0x51e277);}}console[_0x3187c6(0x1e6)](_0x3187c6(0x46c)),await _0x54c587[_0x3187c6(0xfec)]('rw',_0x3a2c29,async()=>{const _0x38c6e4=_0x3187c6;for(const _0x3470e9 of _0x544717){await _0x54c587[_0x38c6e4(0x770)](_0x3470e9[_0x38c6e4(0x388)])[_0x38c6e4(0x1f6)](_0x3470e9[_0x38c6e4(0x771)]);}});const _0x365de0=_0x51e277[_0x3187c6(0x14c8)]-_0x51e277['newSize'],_0x5672b5=_0x51e277[_0x3187c6(0x14c8)]>0x0?(_0x365de0/_0x51e277[_0x3187c6(0x14c8)]*0x64)[_0x3187c6(0x2ea)](0x2):0x0;await _0x138765(_0x3187c6(0xf24),'扫描完成！<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20共找到\x20'+_0x51e277[_0x3187c6(0x535)]+_0x3187c6(0x3b0)+_0x51e277[_0x3187c6(0xa27)]+'\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20跳过(已压缩或无需压缩)\x20'+_0x51e277[_0x3187c6(0x1141)]+_0x3187c6(0x668)+(_0x365de0/0x400/0x400)[_0x3187c6(0x2ea)](0x2)+_0x3187c6(0xbcc)+_0x5672b5+_0x3187c6(0x1093));}catch(_0x22776e){console[_0x3187c6(0x5d7)](_0x3187c6(0x251),_0x22776e),await _0x138765(_0x3187c6(0x1009),_0x3187c6(0xb80)+_0x22776e[_0x3187c6(0x6e2)]);}}function _0x568c14(_0x3f31a5,_0x267431=''){const _0x359860=_0x239c7d;let _0x414353=0x0;for(const _0x1f97e1 in _0x3f31a5){if(_0x3f31a5[_0x359860(0xf21)](_0x1f97e1)){const _0x48fedd=_0x3f31a5[_0x1f97e1];if(typeof _0x48fedd==='string'&&_0x48fedd[_0x359860(0xbb9)](_0x359860(0x306))){const _0x294fa1=_0x267431===_0x359860(0x14f1)&&(_0x1f97e1===_0x359860(0xed6)||_0x1f97e1===_0x359860(0x67c)||_0x1f97e1==='globalChatBackground')||_0x267431===_0x359860(0xca8)||_0x267431==='settings'&&_0x1f97e1===_0x359860(0x81e)||(_0x267431==='appIcons'||_0x267431===_0x359860(0x5d8));!_0x294fa1&&(_0x414353+=_0x48fedd[_0x359860(0x8d6)]);}else typeof _0x48fedd===_0x359860(0xfc4)&&_0x48fedd!==null&&(_0x414353+=_0x568c14(_0x48fedd,_0x1f97e1));}}return _0x414353;}async function _0x3b345c(){const _0x51a110=_0x239c7d,_0x267288=document['getElementById']('total-image-size-display');if(!_0x267288)return;_0x267288[_0x51a110(0x1575)]=_0x51a110(0x982);try{let _0x14d182=0x0;const _0x4d1b44=['chats','globalSettings',_0x51a110(0x834),_0x51a110(0x120c),_0x51a110(0x4ba)];for(const _0x27bc0f of _0x4d1b44){const _0x4aa4be=_0x54c587[_0x51a110(0x770)](_0x27bc0f);await _0x4aa4be[_0x51a110(0x10aa)](_0x56c341=>{_0x14d182+=_0x568c14(_0x56c341);});}const _0x2ce137=(_0x14d182/0x400/0x400)['toFixed'](0x2);_0x267288[_0x51a110(0x1575)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>本地图片(头像/表情/头像框/等)大小:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22><strong>'+_0x2ce137+_0x51a110(0x10c7);}catch(_0x5446cf){console[_0x51a110(0x5d7)](_0x51a110(0x735),_0x5446cf),_0x267288['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>计算图片大小时出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>Error</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function _0x17d6a4(_0x4c3c76){const _0x210cc0=_0x239c7d;let _0x5be646=0x0,_0x4441b3=0x0;if(typeof _0x4c3c76!==_0x210cc0(0xfc4)||_0x4c3c76===null)return{'found':_0x5be646,'size':_0x4441b3};for(const _0x54bf6c in _0x4c3c76){if(_0x4c3c76[_0x210cc0(0xf21)](_0x54bf6c)){const _0x496eff=_0x4c3c76[_0x54bf6c];if(typeof _0x496eff===_0x210cc0(0x158f)&&_0x496eff[_0x210cc0(0xbb9)](_0x210cc0(0x306)))_0x5be646++,_0x4441b3+=_0x496eff[_0x210cc0(0x8d6)];else{if(typeof _0x496eff==='object'&&_0x496eff!==null){const _0x5e29a6=_0x17d6a4(_0x496eff);_0x5be646+=_0x5e29a6[_0x210cc0(0x535)],_0x4441b3+=_0x5e29a6[_0x210cc0(0x9e8)];}}}}return{'found':_0x5be646,'size':_0x4441b3};}async function _0x3a7fa3(_0x31f41c,_0x454c25,_0x3dbfcd=''){const _0x124213=_0x239c7d;for(const _0x2cfd8a in _0x31f41c){if(_0x31f41c[_0x124213(0xf21)](_0x2cfd8a)){if(_0x3dbfcd===''&&(_0x2cfd8a===_0x124213(0xca8)||_0x2cfd8a===_0x124213(0x10d4)||_0x2cfd8a===_0x124213(0x5d8))){console[_0x124213(0x1e6)](_0x124213(0xc00)+_0x2cfd8a);const {found:_0x2c3936,size:_0x455afd}=_0x17d6a4(_0x31f41c[_0x2cfd8a]);_0x454c25[_0x124213(0x535)]+=_0x2c3936,_0x454c25['skipped']+=_0x2c3936,_0x454c25[_0x124213(0x14c8)]+=_0x455afd,_0x454c25[_0x124213(0x1639)]+=_0x455afd;continue;}const _0x5d5582=_0x31f41c[_0x2cfd8a];if(typeof _0x5d5582===_0x124213(0x158f)&&_0x5d5582['startsWith'](_0x124213(0x306))){const _0x47588e=_0x3dbfcd===''&&(_0x2cfd8a===_0x124213(0xed6)||_0x2cfd8a===_0x124213(0x67c)||_0x2cfd8a===_0x124213(0xf8c))||_0x3dbfcd===_0x124213(0xa37)&&_0x2cfd8a==='background';if(_0x47588e){console[_0x124213(0x1e6)](_0x124213(0x1202)+(_0x3dbfcd||_0x124213(0x1051))+'.'+_0x2cfd8a),_0x454c25[_0x124213(0x535)]++,_0x454c25['skipped']++,_0x454c25['originalSize']+=_0x5d5582[_0x124213(0x8d6)],_0x454c25[_0x124213(0x1639)]+=_0x5d5582[_0x124213(0x8d6)];continue;}_0x454c25[_0x124213(0x535)]++,_0x454c25[_0x124213(0x14c8)]+=_0x5d5582[_0x124213(0x8d6)];const _0x3d94cd=await _0x2bdc74(_0x5d5582);_0x3d94cd&&_0x3d94cd!==_0x5d5582?(_0x31f41c[_0x2cfd8a]=_0x3d94cd,_0x454c25['compressed']++,_0x454c25[_0x124213(0x1639)]+=_0x3d94cd[_0x124213(0x8d6)]):(_0x454c25[_0x124213(0x1141)]++,_0x454c25[_0x124213(0x1639)]+=_0x5d5582[_0x124213(0x8d6)]);}else typeof _0x5d5582===_0x124213(0xfc4)&&_0x5d5582!==null&&await _0x3a7fa3(_0x5d5582,_0x454c25,_0x2cfd8a);}}}async function _0x2bdc74(_0x275de7){const _0x16a1f6=_0x239c7d;if(!_0x275de7[_0x16a1f6(0xbb9)]('data:image'))return _0x275de7;const _0x332ac2=0x7a120;if(_0x275de7[_0x16a1f6(0xbb9)]('data:image/jpeg')&&_0x275de7[_0x16a1f6(0x8d6)]<_0x332ac2)return console[_0x16a1f6(0x1e6)](_0x16a1f6(0x728)),_0x275de7;try{const _0x53357b=await(await fetch(_0x275de7))[_0x16a1f6(0xf6d)](),_0x3bbc64=0.3*0x400*0x400;if(_0x53357b['size']<_0x3bbc64)return console[_0x16a1f6(0x1e6)](_0x16a1f6(0x43b)+(_0x53357b[_0x16a1f6(0x9e8)]/0x400/0x400)['toFixed'](0x2)+_0x16a1f6(0x6a5)),_0x275de7;const _0x34414b={'maxSizeMB':0.5,'maxWidthOrHeight':0x320,'useWebWorker':!![],'initialQuality':0.5,'fileType':_0x16a1f6(0x12d5)};console[_0x16a1f6(0x1e6)](_0x16a1f6(0x583)+(_0x53357b[_0x16a1f6(0x9e8)]/0x400/0x400)[_0x16a1f6(0x2ea)](0x2)+_0x16a1f6(0x1659));const _0x7f375b=await imageCompression(_0x53357b,_0x34414b);console[_0x16a1f6(0x1e6)]('压缩完成，新的大小:\x20'+(_0x7f375b[_0x16a1f6(0x9e8)]/0x400/0x400)[_0x16a1f6(0x2ea)](0x2)+_0x16a1f6(0x1659));if(_0x7f375b[_0x16a1f6(0x9e8)]>_0x53357b['size'])return console[_0x16a1f6(0x75e)](_0x16a1f6(0x10cf)),_0x275de7;return new Promise((_0x21b40d,_0x5b5758)=>{const _0x3247a1=_0x16a1f6,_0x3b9b76=new FileReader();_0x3b9b76[_0x3247a1(0x8d1)]=()=>_0x21b40d(_0x3b9b76[_0x3247a1(0xdd1)]),_0x3b9b76['onerror']=_0x5b5758,_0x3b9b76[_0x3247a1(0x157f)](_0x7f375b);});}catch(_0x54b992){return console[_0x16a1f6(0x5d7)]('使用\x20browser-image-compression\x20压缩失败:',_0x54b992),_0x275de7;}}function _0x23f0a8(_0x5dfa59,_0x5b05bb){const _0x3c3a4e=_0x239c7d;if(!_0x5dfa59||!_0x5b05bb||typeof _0x5dfa59!==_0x3c3a4e(0x158f)||typeof _0x5b05bb!==_0x3c3a4e(0x158f))return 0x0;const _0x531fa9=_0x5dfa59[_0x3c3a4e(0x5ad)]('.')[_0x3c3a4e(0xd18)](Number),_0x592276=_0x5b05bb[_0x3c3a4e(0x5ad)]('.')[_0x3c3a4e(0xd18)](Number),_0x29d584=Math[_0x3c3a4e(0x124e)](_0x531fa9[_0x3c3a4e(0x8d6)],_0x592276[_0x3c3a4e(0x8d6)]);for(let _0x249171=0x0;_0x249171<_0x29d584;_0x249171++){const _0x1c1bb8=_0x531fa9[_0x249171]||0x0,_0x17b7a7=_0x592276[_0x249171]||0x0;if(_0x1c1bb8>_0x17b7a7)return 0x1;if(_0x1c1bb8<_0x17b7a7)return-0x1;}return 0x0;}async function _0x5b775e(){const _0x4240af=_0x239c7d,_0x40192f=_0x4240af(0x22a);try{const _0x1b9ac0=await fetch(_0x4240af(0x1117)+Date[_0x4240af(0xecd)]());if(!_0x1b9ac0['ok']){console[_0x4240af(0x75e)](_0x4240af(0xba9));return;}const _0x3c9c71=await _0x1b9ac0[_0x4240af(0x117f)](),_0x26f692=document[_0x4240af(0x2c9)](_0x4240af(0xf8e));_0x26f692[_0x4240af(0x1575)]=_0x3c9c71;const _0x187f47=_0x26f692['querySelector']('[data-version]');if(!_0x187f47){console[_0x4240af(0x5d7)](_0x4240af(0x738));return;}const _0x28a5a8=_0x187f47[_0x4240af(0xd61)][_0x4240af(0xc79)],_0x238dd6=localStorage[_0x4240af(0xca2)]('dismissedUpdateVersion');!_0x238dd6||_0x23f0a8(_0x28a5a8,_0x238dd6)>0x0?(console[_0x4240af(0x1e6)]('发现新版本通知:\x20'+_0x28a5a8+'\x20(已忽略版本:\x20'+(_0x238dd6||'无')+')'),_0x31be98(_0x28a5a8,_0x187f47[_0x4240af(0x1575)])):console[_0x4240af(0x1e6)](_0x4240af(0x72b)+_0x28a5a8+_0x4240af(0xc42));}catch(_0x50b292){console['error'](_0x4240af(0x3eb),_0x50b292);}}function _0x31be98(_0x3ce5a6,_0x53b131){const _0x114bbd=_0x239c7d,_0x182f1a=document['getElementById'](_0x114bbd(0x92b)),_0x31fe1a=document[_0x114bbd(0x400)]('update-notice-body'),_0xf833b9=document[_0x114bbd(0x400)](_0x114bbd(0x6ff)),_0x2ffa03=document['getElementById'](_0x114bbd(0x407));_0x31fe1a[_0x114bbd(0x1575)]=_0x53b131,_0xf833b9[_0x114bbd(0x366)]=!![],_0x2ffa03[_0x114bbd(0x366)]=!![];const _0x27fd1b=_0xf833b9[_0x114bbd(0xde7)];let _0x4cf3f8=0xa;_0xf833b9[_0x114bbd(0xde7)]=_0x27fd1b+'\x20('+_0x4cf3f8+'s)';const _0x5ae17c=setInterval(()=>{const _0x4f9463=_0x114bbd;_0x4cf3f8--,_0x4cf3f8>0x0?_0xf833b9[_0x4f9463(0xde7)]=_0x27fd1b+'\x20('+_0x4cf3f8+'s)':(clearInterval(_0x5ae17c),_0xf833b9['disabled']=![],_0x2ffa03['disabled']=![],_0xf833b9[_0x4f9463(0xde7)]=_0x27fd1b);},0x3e8);_0xf833b9[_0x114bbd(0x41b)]=()=>{const _0x449ce1=_0x114bbd;clearInterval(_0x5ae17c),_0x182f1a[_0x449ce1(0xb08)]['remove'](_0x449ce1(0x9eb)),_0xf833b9['textContent']=_0x27fd1b;},_0x2ffa03[_0x114bbd(0x41b)]=()=>{const _0x15d27f=_0x114bbd;clearInterval(_0x5ae17c),localStorage[_0x15d27f(0x143f)](_0x15d27f(0x13d7),_0x3ce5a6),_0x182f1a[_0x15d27f(0xb08)][_0x15d27f(0xc46)](_0x15d27f(0x9eb)),console[_0x15d27f(0x1e6)](_0x15d27f(0xb26)+_0x3ce5a6),_0xf833b9[_0x15d27f(0xde7)]=_0x27fd1b;},_0x182f1a[_0x114bbd(0xb08)]['add'](_0x114bbd(0x9eb));}function _0x288c06(){const _0x1e7904=_0x239c7d,_0x8eff2d=document[_0x1e7904(0x400)](_0x1e7904(0xd46));document[_0x1e7904(0x400)](_0x1e7904(0x12d4))[_0x1e7904(0xa1e)]=_0x4c8b14['globalSettings'][_0x1e7904(0xf0f)]||0xc,document[_0x1e7904(0x400)](_0x1e7904(0xb86))[_0x1e7904(0xa1e)]=_0x4c8b14[_0x1e7904(0x14f1)][_0x1e7904(0x1295)]||0x14,_0x8eff2d['classList'][_0x1e7904(0x12b6)](_0x1e7904(0x9eb));}async function _0x424b64(){const _0x1f1f3c=_0x239c7d,_0x54836b=document['getElementById'](_0x1f1f3c(0x12d4)),_0x6f68ec=document[_0x1f1f3c(0x400)]('douban-max-posts-input'),_0x48c389=parseInt(_0x54836b[_0x1f1f3c(0xa1e)]),_0x2573d5=parseInt(_0x6f68ec[_0x1f1f3c(0xa1e)]);if(isNaN(_0x48c389)||isNaN(_0x2573d5)||_0x48c389<0x1||_0x2573d5<0x1){alert(_0x1f1f3c(0xdad));return;}if(_0x48c389>_0x2573d5){alert(_0x1f1f3c(0x161e));return;}_0x4c8b14[_0x1f1f3c(0x14f1)][_0x1f1f3c(0xf0f)]=_0x48c389,_0x4c8b14[_0x1f1f3c(0x14f1)]['doubanMaxPosts']=_0x2573d5,await _0x54c587[_0x1f1f3c(0x14f1)]['put'](_0x4c8b14[_0x1f1f3c(0x14f1)]),document[_0x1f1f3c(0x400)](_0x1f1f3c(0xd46))[_0x1f1f3c(0xb08)][_0x1f1f3c(0xc46)](_0x1f1f3c(0x9eb)),await _0x138765('保存成功',_0x1f1f3c(0x402));}async function _0x1372cb(_0x2c5d64){const _0x243ee=_0x239c7d,_0x5b5f7d=document[_0x243ee(0x400)](_0x243ee(0x840)),_0x36ef74=document['getElementById'](_0x243ee(0xee7));_0x36ef74[_0x243ee(0x1575)]='';let _0xdacb2c=[];if(_0x2c5d64===_0x243ee(0x1051)){const _0x598ff5=Object[_0x243ee(0x40a)](_0x4c8b14[_0x243ee(0xbea)])[_0x243ee(0x29d)](_0x346c86=>!_0x346c86[_0x243ee(0xc98)]),_0x409b96=await _0x54c587[_0x243ee(0xf9b)][_0x243ee(0xce1)]();_0xdacb2c=[{'id':'user','name':_0x4c8b14[_0x243ee(0x834)][_0x243ee(0xbf3)]||'我','originalName':_0x4c8b14[_0x243ee(0x834)][_0x243ee(0xbf3)]||'我','avatar':_0x4c8b14['qzoneSettings'][_0x243ee(0xa9a)],'type':_0x243ee(0x6d6)},..._0x598ff5[_0x243ee(0xd18)](_0x3a39cf=>({'id':_0x3a39cf['id'],'name':_0x3a39cf[_0x243ee(0xf3e)],'originalName':_0x3a39cf[_0x243ee(0xdcf)],'avatar':_0x3a39cf[_0x243ee(0xa37)]['aiAvatar'],'type':_0x243ee(0x2cc)})),..._0x409b96[_0x243ee(0xd18)](_0x316922=>({'id':'npc_'+_0x316922['id'],'name':_0x316922[_0x243ee(0xf3e)],'originalName':_0x316922[_0x243ee(0xf3e)],'avatar':_0x316922[_0x243ee(0xa9a)],'type':_0x243ee(0x4b5)}))],_0x496f0a['chatId']=null;}else{const _0x58cad9=_0x4c8b14['chats'][_0x4c8b14[_0x243ee(0x1539)]];if(!_0x58cad9||!_0x58cad9[_0x243ee(0xc98)])return;_0xdacb2c=[{'id':_0x243ee(0x6d6),'name':_0x58cad9[_0x243ee(0xa37)][_0x243ee(0x14a8)]||'我','originalName':_0x4c8b14[_0x243ee(0x834)][_0x243ee(0xbf3)]||'我','avatar':_0x58cad9[_0x243ee(0xa37)][_0x243ee(0x12d3)],'type':_0x243ee(0x6d6)},..._0x58cad9[_0x243ee(0x4f8)]['map'](_0x131f5d=>{const _0x1b3bc2=_0x243ee,_0x3e4275=_0x4c8b14['chats'][_0x131f5d['id']],_0x44cd01=_0x131f5d[_0x1b3bc2(0xa9a)]||(_0x3e4275?_0x3e4275[_0x1b3bc2(0xa37)][_0x1b3bc2(0xb24)]:_0x1e2f0a);return{'id':_0x131f5d['id'],'name':_0x131f5d[_0x1b3bc2(0x7ca)],'originalName':_0x131f5d[_0x1b3bc2(0xdcf)],'avatar':_0x44cd01,'type':_0x131f5d['isNpc']?_0x1b3bc2(0x4b5):'character'};})],_0x496f0a[_0x243ee(0x4dd)]=_0x4c8b14['activeChatId'];}_0xdacb2c[_0x243ee(0xbdc)](_0x163886=>{const _0x4b592e=_0x243ee,_0x40b3cf=document['createElement'](_0x4b592e(0xf8e));_0x40b3cf[_0x4b592e(0x4e1)]=_0x4b592e(0x1427),_0x40b3cf['innerHTML']=_0x4b592e(0x817)+JSON[_0x4b592e(0xea5)](_0x163886)+'\x27\x20'+(_0x163886['type']===_0x4b592e(0x6d6)?_0x4b592e(0xe9d):_0x4b592e(0x6f9))+_0x4b592e(0x1446)+_0x163886[_0x4b592e(0xa9a)]+_0x4b592e(0x302)+_0x163886['name']+_0x4b592e(0x152e),_0x36ef74[_0x4b592e(0x8f2)](_0x40b3cf);}),_0x5b5f7d[_0x243ee(0xb08)]['add']('visible');}async function _0x23ffb8(){const _0x30d98c=_0x239c7d,_0x519c56=document[_0x30d98c(0x527)](_0x30d98c(0x3da)),_0x21a2bc=_0x519c56[_0x30d98c(0x8d6)];let _0x4264c6=[];if(_0x21a2bc===0x6)_0x496f0a[_0x30d98c(0x55c)]='6p',_0x4264c6=['狼人','狼人','平民','平民','预言家','猎人'];else{if(_0x21a2bc===0x9)_0x496f0a[_0x30d98c(0x55c)]='9p',_0x4264c6=['狼人','狼人','狼人','平民','平民','平民',_0x30d98c(0xcf3),'女巫','猎人'];else{if(_0x21a2bc===0xc)_0x496f0a['gameMode']='12p',_0x4264c6=['狼人','狼人','狼人','狼人','平民','平民','平民','平民','预言家','女巫','猎人','守卫'];else{alert(_0x30d98c(0x1420)+_0x21a2bc+'\x20不支持。请选择6、9或12人。');return;}}}document[_0x30d98c(0x400)](_0x30d98c(0x840))[_0x30d98c(0xb08)][_0x30d98c(0xc46)](_0x30d98c(0x9eb)),await _0x138765(_0x30d98c(0xb35),_0x30d98c(0x61a));for(let _0x18feed=_0x4264c6[_0x30d98c(0x8d6)]-0x1;_0x18feed>0x0;_0x18feed--){const _0x4dfb81=Math[_0x30d98c(0x1381)](Math['random']()*(_0x18feed+0x1));[_0x4264c6[_0x18feed],_0x4264c6[_0x4dfb81]]=[_0x4264c6[_0x4dfb81],_0x4264c6[_0x18feed]];}const _0x4aec3d=Array[_0x30d98c(0xdc0)](_0x519c56)[_0x30d98c(0xd18)](_0x1aa167=>JSON[_0x30d98c(0x13f7)](_0x1aa167[_0x30d98c(0xd61)][_0x30d98c(0x3ac)]));_0x496f0a[_0x30d98c(0x88c)]=[];for(let _0x386e9a=0x0;_0x386e9a<_0x4aec3d[_0x30d98c(0x8d6)];_0x386e9a++){const _0x252ea8=_0x4aec3d[_0x386e9a],_0x34bede=_0x4264c6[_0x386e9a];let _0x1bc6f0=_0x30d98c(0xdcb);if(_0x252ea8[_0x30d98c(0xbbf)]===_0x30d98c(0x2cc)){const _0x3d8202=_0x4c8b14[_0x30d98c(0xbea)][_0x252ea8['id']];_0x1bc6f0=_0x3d8202?_0x3d8202['settings'][_0x30d98c(0xfea)]:_0x30d98c(0x90f);}else{if(_0x252ea8[_0x30d98c(0xbbf)]===_0x30d98c(0x4b5)){const _0x4abd68=await _0x54c587[_0x30d98c(0xf9b)][_0x30d98c(0xce1)](),_0xcbfc39=_0x4abd68['find'](_0x109bce=>_0x30d98c(0x1530)+_0x109bce['id']===_0x252ea8['id']);_0x1bc6f0=_0xcbfc39?_0xcbfc39[_0x30d98c(0x9a2)]:_0x30d98c(0xc5a);}else{if(_0x252ea8[_0x30d98c(0xbbf)]==='user'){const _0x28db24=_0x496f0a[_0x30d98c(0x4dd)]?_0x4c8b14[_0x30d98c(0xbea)][_0x496f0a[_0x30d98c(0x4dd)]]:null;_0x1bc6f0=_0x28db24?_0x28db24[_0x30d98c(0xa37)][_0x30d98c(0x2ef)]:_0x30d98c(0xe86);}}}const _0x337ef6={..._0x252ea8,'role':_0x34bede,'isAlive':!![],'character_persona':_0x1bc6f0};_0x34bede==='女巫'&&(_0x337ef6['antidoteUsed']=![],_0x337ef6[_0x30d98c(0x119b)]=![]),_0x34bede==='守卫'&&(_0x337ef6[_0x30d98c(0x58a)]=null),_0x496f0a['players'][_0x30d98c(0x6bb)](_0x337ef6);}_0x496f0a['isActive']=!![],_0x496f0a[_0x30d98c(0x169c)]=0x1,_0x496f0a['currentPhase']=_0x30d98c(0x413),_0x496f0a[_0x30d98c(0xf47)]=[],_0x496f0a[_0x30d98c(0xfdd)]=[];const _0x546761=_0x4264c6[_0x30d98c(0x439)]((_0x31e04c,_0x5f41aa)=>{return _0x31e04c[_0x5f41aa]=(_0x31e04c[_0x5f41aa]||0x0)+0x1,_0x31e04c;},{}),_0x5d9785=Object[_0x30d98c(0x9de)](_0x546761)['map'](([_0x62099d,_0x31e5c9])=>_0x62099d+'\x20x'+_0x31e5c9)[_0x30d98c(0xee1)]('、');_0x2eb770(_0x30d98c(0xfd1)+_0x21a2bc+_0x30d98c(0x664)+_0x5d9785+'。');const _0x5d77e3=_0x496f0a['players'][_0x30d98c(0x821)](_0x67be9=>_0x67be9['id']===_0x30d98c(0x6d6));_0x2607a3(),_0x257d51('werewolf-game-screen'),_0x25be64(_0x5d77e3[_0x30d98c(0x71a)]);}function _0x2607a3(){const _0x3cdf93=_0x239c7d,_0x365e85=document['getElementById']('werewolf-player-grid');_0x365e85[_0x3cdf93(0x1575)]='';const _0x26b1cb=[..._0x496f0a[_0x3cdf93(0x88c)]][_0x3cdf93(0x968)]((_0x2d2a1a,_0x38e493)=>_0x2d2a1a[_0x3cdf93(0xb3d)]-_0x38e493[_0x3cdf93(0xb3d)]);_0x26b1cb[_0x3cdf93(0xbdc)]((_0x1c7b5c,_0x5323c0)=>{const _0x16122d=_0x3cdf93,_0x5c61c9=_0x496f0a[_0x16122d(0x88c)][_0x16122d(0x11a4)](_0x281d36=>_0x281d36['id']===_0x1c7b5c['id'])+0x1,_0x4bc91f=document[_0x16122d(0x2c9)](_0x16122d(0xf8e));_0x4bc91f[_0x16122d(0x4e1)]='werewolf-player-avatar';if(!_0x1c7b5c[_0x16122d(0xb3d)])_0x4bc91f['classList']['add'](_0x16122d(0x80c));_0x4bc91f[_0x16122d(0x1575)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x1c7b5c[_0x16122d(0xa9a)]+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22player-name\x22>'+_0x5c61c9+'.\x20'+_0x1c7b5c[_0x16122d(0xf3e)]+_0x16122d(0x152e),_0x365e85[_0x16122d(0x8f2)](_0x4bc91f);});const _0x22d57a=document[_0x3cdf93(0x400)](_0x3cdf93(0x1125));_0x22d57a[_0x3cdf93(0x1575)]='';for(let _0x4cd257=0x1;_0x4cd257<=_0x496f0a[_0x3cdf93(0x169c)];_0x4cd257++){const _0x47dcba=[..._0x496f0a[_0x3cdf93(0xf47)][_0x3cdf93(0x29d)](_0x3636c3=>_0x3636c3[_0x3cdf93(0x1524)]===_0x4cd257),..._0x496f0a[_0x3cdf93(0xfdd)][_0x3cdf93(0x29d)](_0x68e9c4=>_0x68e9c4[_0x3cdf93(0x1524)]===_0x4cd257)]['sort']((_0x192871,_0x5254fb)=>(_0x192871[_0x3cdf93(0x287)]||0x0)-(_0x5254fb[_0x3cdf93(0x287)]||0x0));if(_0x47dcba[_0x3cdf93(0x8d6)]>0x0){const _0xc709e4=document[_0x3cdf93(0x2c9)](_0x3cdf93(0xf8e));_0xc709e4[_0x3cdf93(0x4e1)]=_0x3cdf93(0xc8b),_0xc709e4[_0x3cdf93(0xde7)]=_0x3cdf93(0x1426)+_0x4cd257+'\x20天\x20---',_0xc709e4['style'][_0x3cdf93(0x32e)]=_0x3cdf93(0x109f),_0x22d57a[_0x3cdf93(0x8f2)](_0xc709e4),_0x47dcba[_0x3cdf93(0xbdc)](_0x3dcc13=>{const _0x633cd7=_0x3cdf93,_0x592b03=document[_0x633cd7(0x2c9)](_0x633cd7(0xf8e));_0x592b03[_0x633cd7(0x4e1)]='werewolf-log-entry\x20'+_0x3dcc13['type'],_0x3dcc13[_0x633cd7(0xbbf)]===_0x633cd7(0xf2d)?_0x592b03[_0x633cd7(0x1575)]='<span\x20class=\x22speaker\x22>'+_0x3dcc13[_0x633cd7(0x4b8)]+':</span>\x20'+_0x3dcc13[_0x633cd7(0x1109)]:_0x592b03[_0x633cd7(0xde7)]=_0x3dcc13['content'],_0x22d57a[_0x633cd7(0x8f2)](_0x592b03);});}}_0x22d57a[_0x3cdf93(0x125c)]=_0x22d57a['scrollHeight'];const _0x3b6691={'start':'游戏开始','night':'第'+_0x496f0a['currentDay']+_0x3cdf93(0x151e),'day':'第'+_0x496f0a[_0x3cdf93(0x169c)]+_0x3cdf93(0xdd5),'discussion':'第'+_0x496f0a['currentDay']+_0x3cdf93(0xc25),'voting':'第'+_0x496f0a['currentDay']+_0x3cdf93(0x4d6),'gameover':_0x3cdf93(0x2e1)};document[_0x3cdf93(0x400)](_0x3cdf93(0x253))[_0x3cdf93(0xde7)]=_0x3cdf93(0xe52)+(_0x3b6691[_0x496f0a[_0x3cdf93(0x15a1)]]||_0x496f0a['currentPhase']);}function _0x25be64(_0x244e21){const _0x242505=_0x239c7d,_0x3c4f7b={'狼人':'你的目标是杀死所有好人。每晚可以和同伴一起刀一个玩家。','平民':_0x242505(0x8d7),'预言家':_0x242505(0x1231),'猎人':'当你死亡时，你可以选择带走场上任意一名玩家。','女巫':_0x242505(0x2fd),'守卫':'每晚可以守护一名玩家，使其免受狼人袭击。不能连续两晚守护同一个人。'};document[_0x242505(0x400)](_0x242505(0x87c))[_0x242505(0xde7)]=_0x244e21,document['getElementById'](_0x242505(0x7ac))['textContent']=_0x3c4f7b[_0x244e21]||'一个神秘的角色。',document[_0x242505(0x400)](_0x242505(0x1031))[_0x242505(0xb08)]['add'](_0x242505(0x9eb));}async function _0x439c81(){const _0x4930fc=_0x239c7d;_0x496f0a[_0x4930fc(0x15a1)]='第'+_0x496f0a[_0x4930fc(0x169c)]+_0x4930fc(0x151e),_0x496f0a[_0x4930fc(0xdb2)]={},_0x2eb770(_0x4930fc(0xc59)),_0x2607a3(),document[_0x4930fc(0x400)](_0x4930fc(0x27d))['style'][_0x4930fc(0xb1a)]=_0x4930fc(0x165b),document[_0x4930fc(0x400)]('werewolf-retry-btn')[_0x4930fc(0xa00)][_0x4930fc(0xb1a)]='none',await new Promise(_0x31f6e4=>setTimeout(_0x31f6e4,0x5dc));const _0xdf7cda=_0x496f0a[_0x4930fc(0x88c)][_0x4930fc(0x821)](_0x3afe11=>_0x3afe11[_0x4930fc(0x71a)]==='守卫'&&_0x3afe11['isAlive']);if(_0xdf7cda){_0x2eb770(_0x4930fc(0xb57)),_0x2607a3();let _0x5e04ff=null;if(_0xdf7cda['id']===_0x4930fc(0x6d6))_0x5e04ff=await _0x35ddec(_0x4930fc(0x123b),_0xdf7cda['lastGuardedId']);else{const _0x1e1c20=_0x496f0a[_0x4930fc(0x88c)][_0x4930fc(0x29d)](_0x3d39b7=>_0x3d39b7[_0x4930fc(0xb3d)]&&_0x3d39b7['id']!==_0xdf7cda[_0x4930fc(0x58a)]);_0x1e1c20[_0x4930fc(0x8d6)]>0x0&&(_0x5e04ff=_0x1e1c20[Math['floor'](Math[_0x4930fc(0x12bc)]()*_0x1e1c20['length'])]['id']);}_0x5e04ff&&(_0x496f0a[_0x4930fc(0xdb2)][_0x4930fc(0xdf8)]=_0x5e04ff,_0xdf7cda['lastGuardedId']=_0x5e04ff),_0x2eb770(_0x4930fc(0x1635)),_0x2607a3(),await new Promise(_0x4fe943=>setTimeout(_0x4fe943,0x5dc));}_0x2eb770(_0x4930fc(0xd45)),_0x2607a3();const _0x49a858=_0x496f0a[_0x4930fc(0x88c)][_0x4930fc(0x29d)](_0xf2e829=>_0xf2e829[_0x4930fc(0x71a)]==='狼人'&&_0xf2e829[_0x4930fc(0xb3d)]),_0xce9a77=_0x49a858[_0x4930fc(0x1412)](_0x2d15d8=>_0x2d15d8['id']===_0x4930fc(0x6d6));let _0x3cd574=null;_0x496f0a['lastFailedAction']=_0x4930fc(0xa9d);try{if(_0xce9a77)_0x2eb770('你是狼人，请选择刀人目标。'),_0x2607a3(),_0x3cd574=await _0xa17056();else{if(_0x496f0a[_0x4930fc(0x169c)]===0x1){console[_0x4930fc(0x1e6)]('第一夜，执行本地随机刀人逻辑...');const _0x1077ab=_0x496f0a[_0x4930fc(0x88c)][_0x4930fc(0x29d)](_0x3ee844=>_0x3ee844[_0x4930fc(0xb3d)]&&_0x3ee844[_0x4930fc(0x71a)]!=='狼人');_0x1077ab[_0x4930fc(0x8d6)]>0x0&&(_0x3cd574=_0x1077ab[Math[_0x4930fc(0x1381)](Math[_0x4930fc(0x12bc)]()*_0x1077ab['length'])]['id']);}else _0x3cd574=await _0x4bc684();}_0x496f0a[_0x4930fc(0xf8b)]=null;}catch(_0x50f94b){console['error'](_0x4930fc(0x1627),_0x50f94b),await _0x138765(_0x4930fc(0x12cb),'AI狼人团队无法决定目标，游戏暂停。请点击右上角的“重试”按钮继续。'),document[_0x4930fc(0x400)](_0x4930fc(0x8dc))[_0x4930fc(0xa00)]['display']=_0x4930fc(0x1181);return;}_0x496f0a[_0x4930fc(0xdb2)]['killedId']=_0x3cd574,_0x2eb770(_0x4930fc(0xfba)),_0x2607a3(),await new Promise(_0x3a8389=>setTimeout(_0x3a8389,0x5dc));const _0x40c910=_0x496f0a[_0x4930fc(0x88c)][_0x4930fc(0x821)](_0x5c4d29=>_0x5c4d29['role']==='女巫'&&_0x5c4d29['isAlive']);if(_0x40c910){_0x2eb770(_0x4930fc(0x5cb)),_0x2607a3();const _0x59e660=_0x496f0a['players'][_0x4930fc(0x821)](_0x5d7a5f=>_0x5d7a5f['id']===_0x496f0a[_0x4930fc(0xdb2)][_0x4930fc(0x11ab)]),_0x53006b=_0x496f0a[_0x4930fc(0xdb2)][_0x4930fc(0xdf8)]===_0x496f0a[_0x4930fc(0xdb2)][_0x4930fc(0x11ab)],_0x237546=_0x53006b||!_0x59e660?null:_0x59e660;if(_0x40c910['id']==='user'){let _0x55db75=await _0x2210dc(_0x237546,_0x40c910);_0x55db75[_0x4930fc(0x7e5)]&&(_0x496f0a[_0x4930fc(0xdb2)][_0x4930fc(0x99e)]=_0x496f0a[_0x4930fc(0xdb2)][_0x4930fc(0x11ab)],_0x40c910['antidoteUsed']=!![]),_0x55db75[_0x4930fc(0xeb3)]&&(_0x496f0a[_0x4930fc(0xdb2)]['poisonedId']=_0x55db75[_0x4930fc(0xeb3)],_0x40c910[_0x4930fc(0x119b)]=!![]);}else{if(!_0x40c910[_0x4930fc(0x1227)]&&_0x237546){let _0x1d5054=0x0;_0x496f0a[_0x4930fc(0x169c)]===0x1?_0x1d5054=0.3:_0x1d5054=0.8,console['log'](_0x4930fc(0x15a4)+_0x496f0a[_0x4930fc(0x169c)]+_0x4930fc(0xa65)+_0x1d5054*0x64+'%'),Math['random']()<_0x1d5054?(console[_0x4930fc(0x1e6)](_0x4930fc(0x580)),_0x496f0a[_0x4930fc(0xdb2)][_0x4930fc(0x99e)]=_0x496f0a[_0x4930fc(0xdb2)][_0x4930fc(0x11ab)],_0x40c910['antidoteUsed']=!![]):console['log']('AI女巫决定保留解药。');}if(!_0x496f0a[_0x4930fc(0xdb2)][_0x4930fc(0x99e)]&&!_0x40c910[_0x4930fc(0x119b)]&&Math[_0x4930fc(0x12bc)]()<0.5){const _0xe631b0=_0x496f0a['players'][_0x4930fc(0x29d)](_0x58672d=>_0x58672d[_0x4930fc(0xb3d)]&&_0x58672d['id']!==_0x496f0a[_0x4930fc(0xdb2)][_0x4930fc(0x11ab)]);if(_0xe631b0[_0x4930fc(0x8d6)]>0x0){const _0x383382=_0xe631b0[Math[_0x4930fc(0x1381)](Math['random']()*_0xe631b0['length'])];_0x496f0a[_0x4930fc(0xdb2)][_0x4930fc(0xdef)]=_0x383382['id'],_0x40c910['poisonUsed']=!![],console[_0x4930fc(0x1e6)]('AI女巫决定使用毒药，目标是:\x20'+_0x383382[_0x4930fc(0xf3e)]);}}}_0x2eb770(_0x4930fc(0x13a2)),_0x2607a3(),await new Promise(_0x386236=>setTimeout(_0x386236,0x5dc));}const _0x3b0582=_0x496f0a['players']['find'](_0x479bb6=>_0x479bb6[_0x4930fc(0x71a)]===_0x4930fc(0xcf3)&&_0x479bb6[_0x4930fc(0xb3d)]);if(_0x3b0582){_0x2eb770(_0x4930fc(0xf45)),_0x2607a3();if(_0x3b0582['id']==='user'){const _0x124c9d=await _0x35ddec(_0x4930fc(0x139c)),_0x3ccf05=_0x496f0a[_0x4930fc(0x88c)][_0x4930fc(0x821)](_0xdbd639=>_0xdbd639['id']===_0x124c9d);if(_0x3ccf05){const _0x5ecdc2=_0x3ccf05['role']==='狼人';await _0x138765(_0x4930fc(0x1027),_0x4930fc(0x143a)+_0x3ccf05[_0x4930fc(0xf3e)]+_0x4930fc(0xf58)+(_0x5ecdc2?'狼人':'好人')),_0x496f0a[_0x4930fc(0xdb2)][_0x4930fc(0x13c1)]={'target':_0x124c9d,'result':_0x5ecdc2?'狼人':'好人'};}}else{const _0x4dbcab=_0x496f0a[_0x4930fc(0x88c)][_0x4930fc(0x29d)](_0x1a630d=>_0x1a630d[_0x4930fc(0xb3d)]&&_0x1a630d['id']!==_0x3b0582['id']);if(_0x4dbcab[_0x4930fc(0x8d6)]>0x0){const _0x16e01a=_0x4dbcab[Math[_0x4930fc(0x1381)](Math[_0x4930fc(0x12bc)]()*_0x4dbcab[_0x4930fc(0x8d6)])];_0x496f0a[_0x4930fc(0xdb2)][_0x4930fc(0x13c1)]={'target':_0x16e01a['id'],'result':_0x16e01a[_0x4930fc(0x71a)]==='狼人'?'狼人':'好人'};}}_0x2eb770(_0x4930fc(0xa48)),_0x2607a3(),await new Promise(_0x2f18be=>setTimeout(_0x2f18be,0x5dc));}_0x4bcee1();}async function _0x4bcee1(){const _0x2350cf=_0x239c7d;_0x496f0a['currentPhase']='第'+_0x496f0a[_0x2350cf(0x169c)]+_0x2350cf(0xdd5),_0x496f0a[_0x2350cf(0x1123)]={},_0x2eb770(_0x2350cf(0x726));const {killedId:_0x464c5a,guardedId:_0x335f01,savedId:_0x447267,poisonedId:_0x4d21b5}=_0x496f0a[_0x2350cf(0xdb2)],_0x5e2d26=new Set();_0x464c5a&&_0x464c5a!==_0x335f01&&_0x464c5a!==_0x447267&&_0x5e2d26['add'](_0x464c5a);_0x4d21b5&&_0x5e2d26[_0x2350cf(0x12b6)](_0x4d21b5);if(_0x5e2d26['size']===0x0)_0x2eb770(_0x2350cf(0x119f));else for(const _0x114632 of _0x5e2d26){const _0x4230e0=_0x496f0a['players'][_0x2350cf(0x821)](_0x37c66a=>_0x37c66a['id']===_0x114632);if(_0x4230e0&&_0x4230e0[_0x2350cf(0xb3d)]){_0x4230e0[_0x2350cf(0xb3d)]=![],_0x2eb770(_0x2350cf(0x1584)+_0x4230e0[_0x2350cf(0xf3e)]+_0x2350cf(0x72e));if(_0x4230e0[_0x2350cf(0x71a)]==='猎人'){_0x2eb770('猎人死亡，请选择一名玩家带走！'),_0x2607a3();let _0x2ace43=null;if(_0x4230e0['id']===_0x2350cf(0x6d6))_0x2ace43=await _0x35ddec(_0x2350cf(0xb1c));else{const _0xbb0fb5=_0x496f0a[_0x2350cf(0x88c)]['filter'](_0x33b11e=>_0x33b11e[_0x2350cf(0xb3d)]&&_0x33b11e['id']!==_0x4230e0['id']);_0xbb0fb5['length']>0x0&&(_0x2ace43=_0xbb0fb5[Math['floor'](Math[_0x2350cf(0x12bc)]()*_0xbb0fb5[_0x2350cf(0x8d6)])]['id']);}const _0x84b42f=_0x496f0a['players']['find'](_0x364c41=>_0x364c41['id']===_0x2ace43);_0x84b42f&&(_0x84b42f[_0x2350cf(0xb3d)]=![],_0x2eb770('猎人带走了\x20'+_0x84b42f[_0x2350cf(0xf3e)]+'。'));}}}_0x2607a3();if(_0x49a5b8())return;await _0x49cd02();}async function _0x49cd02(){const _0x287374=_0x239c7d;_0x2eb770(_0x287374(0xb58)),_0x2607a3();const {proxyUrl:_0x3e63f4,apiKey:_0x3d84f1,model:_0x17c4de}=_0x4c8b14[_0x287374(0x814)];if(!_0x3e63f4||!_0x3d84f1||!_0x17c4de){alert('API未配置，无法生成对话。');return;}const _0xa6ed6e=_0x3a1ab8();_0x496f0a[_0x287374(0xf8b)]=_0x287374(0xcd9);try{await _0x138765(_0x287374(0x11b8),_0x287374(0x60d));let _0x2c58fc=_0x3e63f4['includes']('generativelanguage'),_0x3ca531=[{'role':'user','content':_0x287374(0x5b9)}],_0x5684e6=_0x3914a6(_0x17c4de,_0x3d84f1,_0xa6ed6e,_0x3ca531);const _0x3f14fb=_0x2c58fc?await fetch(_0x5684e6[_0x287374(0x299)],_0x5684e6['data']):await fetch(_0x3e63f4+_0x287374(0x1611),{'method':_0x287374(0x953),'headers':{'Content-Type':'application/json','Authorization':_0x287374(0xcee)+_0x3d84f1},'body':JSON[_0x287374(0xea5)]({'model':_0x17c4de,'messages':[{'role':_0x287374(0xaf6),'content':_0xa6ed6e},..._0x3ca531],'temperature':_0x4c8b14['globalSettings'][_0x287374(0x216)]||0.95})});if(!_0x3f14fb['ok']){const _0x16955d=await _0x3f14fb[_0x287374(0x15d3)]();throw new Error('API\x20错误:\x20'+_0x16955d[_0x287374(0x5d7)]['message']);}const _0x39e403=await _0x3f14fb[_0x287374(0x15d3)](),_0x230988=getGeminiResponseText(_0x39e403),_0xded555=_0x230988['match'](/(\[[\s\S]*\])/);if(!_0xded555)throw new Error('AI返回的讨论内容格式不正确。原始返回:\x20'+_0x230988);const _0x20c7ea=JSON[_0x287374(0x13f7)](_0xded555[0x0]);for(const _0x54cf80 of _0x20c7ea){_0x54cf80[_0x287374(0x12b3)]&&_0x54cf80['dialogue']&&(_0x2b76d9(_0x54cf80[_0x287374(0x12b3)],_0x54cf80[_0x287374(0xf2d)]),_0x2607a3(),await new Promise(_0x47ae32=>setTimeout(_0x47ae32,0x5dc+Math[_0x287374(0x12bc)]()*0x7d0)));}_0x496f0a[_0x287374(0xf8b)]=null;}catch(_0xf12bb1){console['error'](_0x287374(0x878),_0xf12bb1),await _0x138765(_0x287374(0x14e2),_0x287374(0x552)+_0xf12bb1[_0x287374(0x6e2)]),document['getElementById'](_0x287374(0x8dc))[_0x287374(0xa00)][_0x287374(0xb1a)]=_0x287374(0x1181);return;}const _0x311d3b=_0x496f0a['players'][_0x287374(0x821)](_0x9de752=>_0x9de752['id']===_0x287374(0x6d6)),_0x39397c=document[_0x287374(0x400)](_0x287374(0x27d)),_0x3ea1e=document[_0x287374(0x400)]('werewolf-wait-reply-btn'),_0x355721=document[_0x287374(0x400)]('werewolf-finish-speech-btn'),_0x81e420=document[_0x287374(0x400)](_0x287374(0xf6a));_0x39397c[_0x287374(0xa00)]['display']=_0x287374(0x375);if(_0x311d3b&&_0x311d3b[_0x287374(0xb3d)]){_0x3ea1e['textContent']=_0x287374(0xff5),_0x355721['textContent']=_0x287374(0xbf1),_0x3ea1e[_0x287374(0xa00)]['display']='block',_0x355721['style'][_0x287374(0xb1a)]='block',_0x81e420['disabled']=![],_0x81e420[_0x287374(0xb8e)]='轮到你发言了...',_0x81e420['focus']();const _0x3591a0=_0x3ea1e[_0x287374(0xdbc)](!![]);_0x3ea1e['parentNode'][_0x287374(0xf6f)](_0x3591a0,_0x3ea1e),_0x3591a0[_0x287374(0x501)]('click',_0x116fea);const _0x1dde8a=_0x355721[_0x287374(0xdbc)](!![]);_0x355721['parentNode'][_0x287374(0xf6f)](_0x1dde8a,_0x355721),_0x1dde8a[_0x287374(0x501)](_0x287374(0x15ad),_0x1fbb75);}else{_0x2eb770(_0x287374(0x850)),_0x2607a3(),_0x3ea1e['textContent']=_0x287374(0x344),_0x355721[_0x287374(0xde7)]=_0x287374(0x1090),_0x3ea1e[_0x287374(0xa00)][_0x287374(0xb1a)]=_0x287374(0x1181),_0x355721[_0x287374(0xa00)][_0x287374(0xb1a)]=_0x287374(0x1181),_0x81e420['disabled']=!![],_0x81e420[_0x287374(0xb8e)]=_0x287374(0x819);const _0x32eb2f=_0x3ea1e[_0x287374(0xdbc)](!![]);_0x3ea1e[_0x287374(0xa54)][_0x287374(0xf6f)](_0x32eb2f,_0x3ea1e),_0x32eb2f[_0x287374(0x501)]('click',_0x250262);const _0x1d317e=_0x355721['cloneNode'](!![]);_0x355721[_0x287374(0xa54)][_0x287374(0xf6f)](_0x1d317e,_0x355721),_0x1d317e[_0x287374(0x501)](_0x287374(0x15ad),_0x2e17ab);}}function _0x3a1ab8(){const _0xcd4cbf=_0x239c7d,_0xf4218b=_0x496f0a[_0xcd4cbf(0x88c)][_0xcd4cbf(0x29d)](_0xcbbd20=>_0xcbbd20[_0xcd4cbf(0xb3d)]),_0x3b8e68=_0x496f0a['players'][_0xcd4cbf(0x821)](_0x302122=>_0x302122['id']===_0xcd4cbf(0x6d6)),_0x4a2d55=_0x3b8e68?_0x3b8e68[_0xcd4cbf(0xf3e)]:'用户',_0x3625fb=_0xf4218b['some'](_0x4bc6e8=>_0x4bc6e8['id']===_0xcd4cbf(0x6d6));let _0x478085=_0xcd4cbf(0x13a0);_0x478085+=_0xcd4cbf(0xe38),_0xf4218b['forEach']((_0x210d6b,_0x27ee8a)=>{const _0x59c8ce=_0xcd4cbf,_0x22e55c=_0x496f0a[_0x59c8ce(0x88c)][_0x59c8ce(0x11a4)](_0x5cca6f=>_0x5cca6f['id']===_0x210d6b['id'])+0x1;let _0x2f7248='';const _0x4e9103=_0x4c8b14[_0x59c8ce(0xbea)][_0x210d6b['id']];if(_0x4e9103){const _0x4a8d75=_0xf4218b[_0x59c8ce(0x29d)](_0x123251=>_0x123251['id']!==_0x210d6b['id']&&_0x4c8b14[_0x59c8ce(0xbea)][_0x123251['id']]&&_0x4c8b14[_0x59c8ce(0xbea)][_0x123251['id']][_0x59c8ce(0x1145)]===_0x4e9103[_0x59c8ce(0x1145)]&&_0x4e9103['groupId']!==null)[_0x59c8ce(0xd18)](_0x33331b=>_0x33331b['name'])[_0x59c8ce(0xee1)]('、');_0x4a8d75&&(_0x2f7248+=_0x59c8ce(0x32d)+_0x4a8d75+_0x59c8ce(0x1363));}_0x210d6b['id']!==_0x59c8ce(0x6d6)&&(_0x2f7248+=_0x59c8ce(0x1514)+_0x4a2d55+_0x59c8ce(0x1073));_0x478085+=_0x59c8ce(0x13cf)+_0x22e55c+'号玩家:\x20'+_0x210d6b[_0x59c8ce(0xf3e)]+_0x59c8ce(0xd92)+_0x210d6b['originalName']+_0x59c8ce(0x1035)+(_0x210d6b['id']===_0x59c8ce(0x6d6)?_0x59c8ce(0x2af):_0x59c8ce(0x14b4))+_0x59c8ce(0xb12)+_0x210d6b[_0x59c8ce(0xd4e)]+'\x0a';if(_0x210d6b[_0x59c8ce(0xbbf)]===_0x59c8ce(0x2cc)){const _0x230083=_0x4c8b14[_0x59c8ce(0xbea)][_0x210d6b['id']];if(_0x230083&&_0x230083[_0x59c8ce(0x1600)]&&_0x230083[_0x59c8ce(0x1600)][_0x59c8ce(0x8d6)]>0x0){const _0x4951c9=_0x230083[_0x59c8ce(0x1600)][_0x59c8ce(0xd18)](_0x9ae284=>_0x9ae284[_0x59c8ce(0x1109)])[_0x59c8ce(0xee1)](';\x20');_0x478085+=_0x59c8ce(0x59e)+_0x4951c9+'\x0a';}}_0x2f7248&&(_0x478085+=_0x59c8ce(0xfbd)+_0x2f7248);});let _0x254a06='#\x20昨晚事件总结\x20(Night\x20Event\x20Summary)\x0a';_0x254a06+='这是所有玩家都能听到的【公开信息】。\x0a';const _0x137f84=_0x496f0a[_0xcd4cbf(0xf47)][_0xcd4cbf(0x29d)](_0x5693d0=>_0x5693d0['content'][_0xcd4cbf(0xd1b)]('死亡了')&&_0x5693d0['day']===_0x496f0a[_0xcd4cbf(0x169c)]);_0x137f84[_0xcd4cbf(0x8d6)]===0x0?_0x254a06+=_0xcd4cbf(0x1384):_0x137f84[_0xcd4cbf(0xbdc)](_0x3f7d6d=>{const _0x140c75=_0xcd4cbf;_0x254a06+='-\x20'+_0x3f7d6d[_0x140c75(0x1109)]+'\x0a';});let _0x3aaa27=_0xcd4cbf(0x76d);if(_0x496f0a['currentDay']>0x1)for(let _0x4c1485=0x1;_0x4c1485<_0x496f0a['currentDay'];_0x4c1485++){_0x3aaa27+=_0xcd4cbf(0x52b)+_0x4c1485+_0xcd4cbf(0xd0b);const _0x5f1f98=_0x496f0a[_0xcd4cbf(0xf47)][_0xcd4cbf(0x29d)](_0x5c77a3=>_0x5c77a3[_0xcd4cbf(0x1524)]===_0x4c1485&&(_0x5c77a3['content'][_0xcd4cbf(0xd1b)]('死亡')||_0x5c77a3[_0xcd4cbf(0x1109)][_0xcd4cbf(0xd1b)]('放逐')));_0x5f1f98[_0xcd4cbf(0x8d6)]>0x0?_0x3aaa27+='*事件*:\x20'+_0x5f1f98['map'](_0x58cde7=>_0x58cde7[_0xcd4cbf(0x1109)])['join']('\x20')+'\x0a':_0x3aaa27+=_0xcd4cbf(0x474);const _0x59e079=_0x496f0a[_0xcd4cbf(0xfdd)][_0xcd4cbf(0x29d)](_0x166615=>_0x166615[_0xcd4cbf(0x1524)]===_0x4c1485);_0x59e079[_0xcd4cbf(0x8d6)]>0x0&&(_0x3aaa27+=_0xcd4cbf(0xdfc)+_0x59e079[_0xcd4cbf(0xd18)](_0xa13000=>'-\x20'+_0xa13000['speaker']+':\x20'+_0xa13000[_0xcd4cbf(0x1109)])[_0xcd4cbf(0xee1)]('\x0a')+'\x0a');}else _0x3aaa27+='(今天是第一天，没有历史记录)\x0a';let _0x3c561f='#\x20今日完整讨论记录\x20(Today\x27s\x20Full\x20Discussion\x20Record)\x0a';const _0x19045e=_0x496f0a[_0xcd4cbf(0xfdd)][_0xcd4cbf(0x29d)](_0x2e5a9f=>_0x2e5a9f['day']===_0x496f0a[_0xcd4cbf(0x169c)]);_0x19045e[_0xcd4cbf(0x8d6)]>0x0?_0x3c561f+=_0x19045e[_0xcd4cbf(0xd18)](_0x1fc8bb=>'-\x20**'+_0x1fc8bb[_0xcd4cbf(0x4b8)]+_0xcd4cbf(0x137d)+_0x1fc8bb[_0xcd4cbf(0x1109)])[_0xcd4cbf(0xee1)]('\x0a'):_0x3c561f+=_0xcd4cbf(0x3aa);let _0x4f5055='\x0a#\x20【逻辑隔离与TGS三核思考\x20(最高优先级指令)】\x0a为了兼顾游戏逻辑和角色扮演，你【必须】在内部为【每一个AI角色】按顺序执行以下“三阶段思考”：\x0a\x0a##\x20阶段1：内部独立思考\x20(Internal\x20Monologue\x20Scratchpad)\x0a(这部分内容【绝对不能】出现在你最终的JSON输出中，这仅供你内部模拟使用)\x0a';_0xf4218b[_0xcd4cbf(0xbdc)](_0x1fe9d7=>{const _0x45e58f=_0xcd4cbf;if(_0x1fe9d7['id']!==_0x45e58f(0x6d6)){const _0x309202=_0x496f0a[_0x45e58f(0x88c)][_0x45e58f(0x11a4)](_0x1ae42d=>_0x1ae42d['id']===_0x1fe9d7['id'])+0x1;_0x4f5055+=_0x45e58f(0x13ee)+_0x309202+_0x45e58f(0xadb)+_0x1fe9d7[_0x45e58f(0xf3e)]+'\x20(本名:\x20'+_0x1fe9d7[_0x45e58f(0xdcf)]+_0x45e58f(0x8db)+_0x1fe9d7['role']+_0x45e58f(0x14a7);let _0x1ad572='';if(_0x1fe9d7['role']==='狼人'){const _0x163214=_0x496f0a['players'][_0x45e58f(0x29d)](_0xb1e740=>_0xb1e740[_0x45e58f(0x71a)]==='狼人'&&_0xb1e740['id']!==_0x1fe9d7['id']&&_0xb1e740[_0x45e58f(0xb3d)])[_0x45e58f(0xd18)](_0xe3fdda=>_0xe3fdda[_0x45e58f(0xf3e)])[_0x45e58f(0xee1)]('、');_0x1ad572+=_0x45e58f(0xbc9)+(_0x163214||'无')+'\x0a';const _0x5c87bd=_0x496f0a[_0x45e58f(0x88c)]['find'](_0x18df42=>_0x18df42['id']===_0x496f0a[_0x45e58f(0xdb2)][_0x45e58f(0x11ab)]);_0x1ad572+='\x20\x20\x20\x20-\x20我们昨晚攻击了：'+(_0x5c87bd?_0x5c87bd[_0x45e58f(0xf3e)]:'空刀')+'\x0a';}if(_0x1fe9d7['role']===_0x45e58f(0xcf3)&&_0x496f0a[_0x45e58f(0xdb2)][_0x45e58f(0x13c1)]){const _0x1a5fb0=_0x496f0a['players'][_0x45e58f(0x821)](_0x355aea=>_0x355aea['id']===_0x496f0a[_0x45e58f(0xdb2)][_0x45e58f(0x13c1)][_0x45e58f(0x657)]);_0x1ad572+=_0x45e58f(0xda4)+_0x1a5fb0[_0x45e58f(0xf3e)]+_0x45e58f(0x1041)+_0x496f0a[_0x45e58f(0xdb2)]['prophetCheck'][_0x45e58f(0xdd1)]+'】\x0a';}if(_0x1fe9d7['role']==='女巫'){if(_0x496f0a[_0x45e58f(0xdb2)][_0x45e58f(0x99e)]){const _0x400693=_0x496f0a[_0x45e58f(0x88c)]['find'](_0x479cff=>_0x479cff['id']===_0x496f0a[_0x45e58f(0xdb2)][_0x45e58f(0x99e)]);_0x1ad572+=_0x45e58f(0xb91)+_0x400693['name']+'。\x0a';}if(_0x496f0a['nightActions'][_0x45e58f(0xdef)]){const _0x849c30=_0x496f0a[_0x45e58f(0x88c)]['find'](_0x263f16=>_0x263f16['id']===_0x496f0a[_0x45e58f(0xdb2)][_0x45e58f(0xdef)]);_0x1ad572+='\x20\x20\x20\x20-\x20我昨晚用毒药毒了\x20'+_0x849c30['name']+'。\x0a';}_0x1ad572+=_0x45e58f(0x1f3)+(_0x1fe9d7[_0x45e58f(0x1227)]?'已使用':_0x45e58f(0x155b))+'\x0a',_0x1ad572+='\x20\x20\x20\x20-\x20我的毒药：'+(_0x1fe9d7[_0x45e58f(0x119b)]?_0x45e58f(0x641):_0x45e58f(0x155b))+'\x0a';}if(_0x1fe9d7['role']==='守卫'){if(_0x496f0a['nightActions'][_0x45e58f(0xdf8)]){const _0x5c1e80=_0x496f0a[_0x45e58f(0x88c)]['find'](_0x9d9907=>_0x9d9907['id']===_0x496f0a['nightActions'][_0x45e58f(0xdf8)]);_0x1ad572+='\x20\x20\x20\x20-\x20我昨晚守护了\x20'+_0x5c1e80[_0x45e58f(0xf3e)]+'。\x0a';}else _0x1ad572+=_0x45e58f(0x952);}_0x1ad572===''&&(_0x1ad572=_0x45e58f(0x10f9));_0x4f5055+=_0x1ad572,_0x4f5055+='3.\x20\x20**我看到的公开信息\x20(所有人可见)**:\x0a\x20\x20\x20\x20-\x20**昨晚事件**:\x20'+_0x254a06[_0x45e58f(0xe19)](/\n/g,'\x20')+_0x45e58f(0x498)+_0x3c561f[_0x45e58f(0xe19)](/\n/g,'\x20')+'\x0a4.\x20\x20**我的人设与社交关系**:\x0a\x20\x20\x20\x20-\x20**人设**:\x20'+_0x1fe9d7[_0x45e58f(0xd4e)]+_0x45e58f(0x10b6);let _0x34846c='';const _0x4894d4=_0x4c8b14[_0x45e58f(0xbea)][_0x1fe9d7['id']];if(_0x4894d4){const _0x2dd99c=_0xf4218b[_0x45e58f(0x29d)](_0x286ef3=>_0x286ef3['id']!==_0x1fe9d7['id']&&_0x4c8b14[_0x45e58f(0xbea)][_0x286ef3['id']]&&_0x4c8b14['chats'][_0x286ef3['id']][_0x45e58f(0x1145)]===_0x4894d4[_0x45e58f(0x1145)]&&_0x4894d4[_0x45e58f(0x1145)]!==null)[_0x45e58f(0xd18)](_0x1bb449=>_0x1bb449['name'])[_0x45e58f(0xee1)]('、');_0x2dd99c&&(_0x34846c+=_0x45e58f(0xd05)+_0x2dd99c+_0x45e58f(0x4cf));}_0x1fe9d7['id']!=='user'&&(_0x34846c+=_0x45e58f(0xd05)+_0x4a2d55+_0x45e58f(0x11de)),_0x34846c===''&&(_0x34846c='\x20\x20\x20\x20\x20\x20-\x20我在此次游戏中没有特别的社交关系。\x0a'),_0x4f5055+=_0x34846c,_0x4f5055+=_0x45e58f(0xfd3)+_0x4a2d55+_0x45e58f(0xe29)+(_0x19045e[_0x45e58f(0x8d6)]>0x0?_0x45e58f(0xc63):_0x45e58f(0x129d))+_0x45e58f(0xb15)+_0x4a2d55+_0x45e58f(0x1147)+_0x4a2d55+_0x45e58f(0xdcd)+_0x1fe9d7['role']+'，我的人设很'+_0x1fe9d7[_0x45e58f(0xd4e)]['substring'](0x0,0x14)+_0x45e58f(0x7b8);}}),_0x4f5055+='\x0a##\x20阶段2：生成最终对话\x20(Final\x20JSON\x20Output)\x0a你现在已经为【所有AI角色】都完成了“TGS三核”独立思考。\x0a请根据你在“阶段C：最终发言稿”中为每个角色准备好的草稿，生成最终的、符合格式的JSON数组。\x0a';const _0x3831b8=_0xcd4cbf(0xc05)+(_0x3625fb?_0xcd4cbf(0x13a4)+_0x4a2d55+')':_0xcd4cbf(0x1357)+_0x4a2d55+')')+_0xcd4cbf(0x9b0)+_0x478085+_0xcd4cbf(0xf10)+(_0x496f0a[_0xcd4cbf(0x55c)]===_0xcd4cbf(0x322)?_0xcd4cbf(0x56d):_0xcd4cbf(0x11ba))+_0xcd4cbf(0x1276)+_0x496f0a[_0xcd4cbf(0x169c)]+_0xcd4cbf(0x323)+_0x254a06+_0xcd4cbf(0x77b)+_0xf4218b['map'](_0x1f24e7=>_0x1f24e7[_0xcd4cbf(0xf3e)]+'\x20('+(_0x1f24e7['id']==='user'?'用户':'AI')+')')[_0xcd4cbf(0xee1)](',\x20')+_0xcd4cbf(0x1345)+_0x4a2d55+_0xcd4cbf(0x665)+_0x3aaa27+'\x0a\x0a#\x20'+_0x3c561f+'\x0a\x0a'+_0x4f5055+_0xcd4cbf(0x1fe);return _0x3831b8;}function _0x6ef7c7(_0xcabf93){const _0x336e97=_0x239c7d;let _0x210725=_0x336e97(0x30c);const _0x1e80a5=_0xcabf93[_0x336e97(0xf47)][_0x336e97(0x821)](_0x345c41=>_0x345c41[_0x336e97(0x1109)][_0x336e97(0xd1b)]('胜利'))?.[_0x336e97(0x1109)]||_0x336e97(0x161f);_0x210725+='###\x20最终结果:\x20'+_0x1e80a5+'\x0a\x0a',_0x210725+='###\x20玩家身份配置:\x0a',_0xcabf93['players']['forEach'](_0x292f26=>{const _0x5793e4=_0x336e97,_0x394203=_0x292f26['isAlive']?'存活':_0x5793e4(0x702);_0x210725+='-\x20'+_0x292f26[_0x5793e4(0xf3e)]+':\x20'+_0x292f26[_0x5793e4(0x71a)]+'\x20('+_0x394203+')\x0a';}),_0x210725+=_0x336e97(0xb51);for(let _0x1cc86f=0x1;_0x1cc86f<=_0xcabf93[_0x336e97(0x169c)];_0x1cc86f++){_0x210725+=_0x336e97(0x52b)+_0x1cc86f+'\x20天\x20---**\x0a';const _0x2e075b=_0xcabf93['gameLog'][_0x336e97(0x29d)](_0x539027=>_0x539027['day']===_0x1cc86f&&_0x539027['content'][_0x336e97(0xd1b)]('死亡'));if(_0x2e075b[_0x336e97(0x8d6)]>0x0)_0x210725+=_0x336e97(0x98d)+_0x2e075b[_0x336e97(0xd18)](_0x11d2ff=>_0x11d2ff[_0x336e97(0x1109)])['join']('\x20')+'\x0a';else(_0x1cc86f>0x1||_0x1cc86f===0x1&&_0xcabf93[_0x336e97(0x169c)]>0x1)&&(_0x210725+='**[夜晚]**\x20平安夜。\x0a');const _0x205ad6=_0xcabf93['discussionLog']['filter'](_0x3e09df=>_0x3e09df[_0x336e97(0x1524)]===_0x1cc86f);_0x205ad6[_0x336e97(0x8d6)]>0x0&&(_0x210725+=_0x336e97(0x385)+_0x205ad6[_0x336e97(0xd18)](_0x54de12=>'-\x20'+_0x54de12[_0x336e97(0x4b8)]+':\x20'+_0x54de12['content'])[_0x336e97(0xee1)]('\x0a')+'\x0a');const _0x58f772=_0xcabf93['gameLog'][_0x336e97(0x821)](_0x249cfb=>_0x249cfb[_0x336e97(0x1524)]===_0x1cc86f&&_0x249cfb[_0x336e97(0x1109)][_0x336e97(0xd1b)](_0x336e97(0x1398)));_0x58f772&&(_0x210725+=_0x336e97(0x12ce)+_0x58f772[_0x336e97(0x1109)]+'\x0a');}return _0x210725+=_0x336e97(0x48f),_0x210725;}async function _0x442c96(_0x5a7244){const _0x56c48b=_0x239c7d;let _0x217444=0x0;for(const _0x44b7d9 of _0x496f0a[_0x56c48b(0x88c)]){if(_0x44b7d9[_0x56c48b(0xbbf)]===_0x56c48b(0x2cc)){const _0x30150c=_0x4c8b14[_0x56c48b(0xbea)][_0x44b7d9['id']];if(_0x30150c){const _0x46359b={'content':_0x5a7244,'timestamp':Date[_0x56c48b(0xecd)](),'source':_0x56c48b(0xa6e)};!_0x30150c[_0x56c48b(0x1600)]&&(_0x30150c['longTermMemory']=[]),_0x30150c[_0x56c48b(0x1600)]['push'](_0x46359b),await _0x54c587['chats']['put'](_0x30150c),_0x217444++;}}}return _0x217444;}async function _0x1ab4eb(){const _0x14ad6e=_0x239c7d;if(!_0x496f0a[_0x14ad6e(0x11e7)]&&_0x496f0a['currentPhase']===_0x14ad6e(0x14a5)){await _0x138765(_0x14ad6e(0x13e9),'正在为所有AI角色生成并注入游戏记忆...');try{const _0x40131f=_0x6ef7c7(_0x496f0a),_0x3a77a7=await _0x442c96(_0x40131f);await _0x138765('成功',_0x14ad6e(0x6b6)+_0x3a77a7+_0x14ad6e(0x73e));}catch(_0xa4df83){console[_0x14ad6e(0x5d7)](_0x14ad6e(0x13cd),_0xa4df83),await _0x138765('失败',_0x14ad6e(0x57a)+_0xa4df83[_0x14ad6e(0x6e2)]);}}else alert(_0x14ad6e(0x1560));}async function _0x593afa(_0x1f65e0){const _0x33bc04=_0x239c7d;_0x496f0a[_0x33bc04(0x11e7)]=![],_0x496f0a['currentPhase']=_0x33bc04(0x14a5),_0x2eb770(_0x1f65e0+_0x33bc04(0xa53)),document[_0x33bc04(0x400)](_0x33bc04(0x619))[_0x33bc04(0xde7)]=_0x1f65e0+_0x33bc04(0xa52);let _0x1dd438='';_0x1f65e0==='好人'?_0x1dd438='所有狼人已被放逐，好人阵营获得了胜利！':_0x1dd438='狼人数量已达到胜利条件，狼人阵营获得了胜利！';const _0x1c7ce8=document[_0x33bc04(0x400)](_0x33bc04(0x1157));_0x1c7ce8[_0x33bc04(0xde7)]=_0x1dd438;const _0xbb8a34=document[_0x33bc04(0x400)](_0x33bc04(0x1179));_0xbb8a34[_0x33bc04(0x1575)]='';const _0xfdfb51=[..._0x496f0a['players']][_0x33bc04(0x968)]((_0x30ce69,_0x3172eb)=>{const _0x1d7048=_0x33bc04,_0x4b1ef2=_0x496f0a[_0x1d7048(0x88c)]['findIndex'](_0xc9f1fa=>_0xc9f1fa['id']===_0x30ce69['id']),_0xbf2a2=_0x496f0a[_0x1d7048(0x88c)][_0x1d7048(0x11a4)](_0x9d428b=>_0x9d428b['id']===_0x3172eb['id']);return _0x4b1ef2-_0xbf2a2;});_0xfdfb51[_0x33bc04(0xbdc)]((_0x2bc87c,_0x2e2495)=>{const _0xfe1326=_0x33bc04,_0x359f18=document[_0xfe1326(0x2c9)]('div');_0x359f18[_0xfe1326(0xa00)][_0xfe1326(0x32e)]='display:\x20flex;\x20align-items:\x20center;\x20padding:\x208px\x200;\x20border-bottom:\x201px\x20solid\x20#444;\x20color:\x20white;';if(_0x2e2495===_0xfdfb51[_0xfe1326(0x8d6)]-0x1)_0x359f18['style'][_0xfe1326(0xb5f)]='none';const _0x49f637=_0x2bc87c['role']==='狼人'?_0xfe1326(0x100d):'#52c41a';_0x359f18[_0xfe1326(0x1575)]=_0xfe1326(0x2a0)+_0x2bc87c[_0xfe1326(0xa9a)]+_0xfe1326(0xd12)+(_0x2bc87c[_0xfe1326(0xb3d)]?_0xfe1326(0x165b):_0xfe1326(0x16ad))+';\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20left;\x20text-decoration:\x20'+(_0x2bc87c['isAlive']?_0xfe1326(0x165b):_0xfe1326(0x15df))+';\x22>'+(_0x2e2495+0x1)+'.\x20'+_0x2bc87c[_0xfe1326(0xf3e)]+_0xfe1326(0x1116)+_0x49f637+_0xfe1326(0x1fb)+_0x2bc87c[_0xfe1326(0x71a)]+_0xfe1326(0x270),_0xbb8a34[_0xfe1326(0x8f2)](_0x359f18);}),document[_0x33bc04(0x400)](_0x33bc04(0xe8d))['classList'][_0x33bc04(0x12b6)](_0x33bc04(0x9eb));try{console[_0x33bc04(0x1e6)](_0x33bc04(0x3e5));const _0x1e8d63=_0x6ef7c7(_0x496f0a),_0x37d873=await generateAndInjectWerewolfMemories(_0x1e8d63);console[_0x33bc04(0x1e6)](_0x33bc04(0x144b)+_0x37d873+'\x20位角色的记忆中。');}catch(_0x466d31){console[_0x33bc04(0x5d7)](_0x33bc04(0x1658),_0x466d31),_0x1c7ce8&&(_0x1c7ce8[_0x33bc04(0x1575)]+=_0x33bc04(0x103d));}}function _0x2eb770(_0x5881dc){const _0xe96e16=_0x239c7d;_0x496f0a[_0xe96e16(0xf47)]['push']({'type':_0xe96e16(0xaf6),'content':_0x5881dc,'timestamp':Date['now'](),'day':_0x496f0a[_0xe96e16(0x169c)]});}function _0x2b76d9(_0x42ee96,_0x3e2dd1){const _0x1fd51b=_0x239c7d;_0x496f0a['discussionLog']['push']({'type':_0x1fd51b(0xf2d),'speaker':_0x42ee96,'content':_0x3e2dd1,'timestamp':Date[_0x1fd51b(0xecd)](),'day':_0x496f0a[_0x1fd51b(0x169c)]});}function _0x35ddec(_0x1f02a4){return new Promise(_0x2d9c67=>{const _0x5230f1=_0x466f,_0x4224f6=_0x5230f1(0x70a)+_0x1f02a4+'-modal',_0x260bf6=_0x5230f1(0x70a)+_0x1f02a4+_0x5230f1(0x1128);let _0x185369='';if(_0x1f02a4==='prophet')_0x185369=_0x5230f1(0x104a);if(_0x1f02a4===_0x5230f1(0xb1c))_0x185369=_0x5230f1(0x13fc);if(_0x1f02a4==='vote')_0x185369=_0x5230f1(0x1340);const _0x4425fe=document['getElementById'](_0x4224f6),_0x531f75=document[_0x5230f1(0x400)](_0x260bf6),_0x2f16a4=document[_0x5230f1(0x400)](_0x185369);_0x531f75[_0x5230f1(0x1575)]='';let _0x1de0db=null;const _0x2717f2=_0x496f0a[_0x5230f1(0x88c)]['filter'](_0x57c243=>_0x57c243[_0x5230f1(0xb3d)]&&(_0x1f02a4===_0x5230f1(0xb1c)||_0x1f02a4===_0x5230f1(0xc61)||_0x57c243['id']!==_0x5230f1(0x6d6)));_0x2717f2[_0x5230f1(0xbdc)](_0x96c975=>{const _0x5943a2=_0x5230f1,_0x5ec274=document[_0x5943a2(0x2c9)]('div');_0x5ec274[_0x5943a2(0x4e1)]=_0x5943a2(0x5a4),_0x5ec274[_0x5943a2(0xd61)]['id']=_0x96c975['id'],_0x5ec274[_0x5943a2(0x1575)]='<img\x20src=\x22'+_0x96c975[_0x5943a2(0xa9a)]+_0x5943a2(0x10c0)+_0x96c975['name']+_0x5943a2(0x21f),_0x5ec274[_0x5943a2(0x41b)]=()=>{const _0x4a3254=_0x5943a2;_0x531f75[_0x4a3254(0x527)]('.selected')[_0x4a3254(0xbdc)](_0x560de2=>_0x560de2[_0x4a3254(0xb08)][_0x4a3254(0xc46)](_0x4a3254(0x148b))),_0x5ec274['classList'][_0x4a3254(0x12b6)](_0x4a3254(0x148b)),_0x1de0db=_0x96c975['id'];},_0x531f75[_0x5943a2(0x8f2)](_0x5ec274);});const _0x3c949a=_0x2f16a4[_0x5230f1(0xdbc)](!![]);_0x2f16a4['parentNode'][_0x5230f1(0xf6f)](_0x3c949a,_0x2f16a4),_0x3c949a[_0x5230f1(0x41b)]=()=>{const _0x4f4eee=_0x5230f1;_0x1de0db?(_0x4425fe['classList'][_0x4f4eee(0xc46)]('visible'),_0x2d9c67(_0x1de0db)):alert(_0x4f4eee(0x12a6));},_0x4425fe[_0x5230f1(0xb08)][_0x5230f1(0x12b6)]('visible');});}function _0xa17056(){return new Promise(_0x2488c0=>{const _0x264985=_0x466f,_0x4e26cd=document[_0x264985(0x400)]('werewolf-kill-modal'),_0x8999b3=document[_0x264985(0x400)](_0x264985(0xdd7)),_0x36e970=document[_0x264985(0x400)](_0x264985(0xfdf)),_0x8a78b=_0x4e26cd[_0x264985(0x13ef)](_0x264985(0x823)),_0x31d3cd=_0x496f0a['players'][_0x264985(0x29d)](_0x1ad3ef=>_0x1ad3ef[_0x264985(0x71a)]==='狼人'&&_0x1ad3ef['isAlive']),_0x6d4f8b=_0x31d3cd[_0x264985(0x29d)](_0x193acd=>_0x193acd['id']!==_0x264985(0x6d6))[_0x264985(0xd18)](_0x5b030c=>_0x5b030c['name'])[_0x264985(0xee1)]('、');_0x6d4f8b?_0x8a78b[_0x264985(0x1575)]=_0x264985(0x8c0)+_0x6d4f8b+_0x264985(0x149d):_0x8a78b['textContent']='狼人请选择刀人对象';_0x8999b3[_0x264985(0x1575)]='';let _0x1da1c8=null;const _0x100ea4=_0x496f0a[_0x264985(0x88c)][_0x264985(0x29d)](_0x5e38e6=>_0x5e38e6[_0x264985(0xb3d)]&&_0x5e38e6['role']!=='狼人');_0x100ea4['forEach'](_0x35aeeb=>{const _0x1edb17=_0x264985,_0x3008ab=document[_0x1edb17(0x2c9)]('div');_0x3008ab['className']=_0x1edb17(0x5a4),_0x3008ab['dataset']['id']=_0x35aeeb['id'],_0x3008ab[_0x1edb17(0x1575)]=_0x1edb17(0x97d)+_0x35aeeb[_0x1edb17(0xa9a)]+_0x1edb17(0x10c0)+_0x35aeeb['name']+_0x1edb17(0x21f),_0x3008ab[_0x1edb17(0x41b)]=()=>{const _0xee9fd7=_0x1edb17;_0x8999b3[_0xee9fd7(0x527)]('.selected')[_0xee9fd7(0xbdc)](_0x6a2635=>_0x6a2635[_0xee9fd7(0xb08)]['remove'](_0xee9fd7(0x148b))),_0x3008ab['classList'][_0xee9fd7(0x12b6)](_0xee9fd7(0x148b)),_0x1da1c8=_0x35aeeb['id'];},_0x8999b3[_0x1edb17(0x8f2)](_0x3008ab);});const _0x1b9bae=_0x36e970['cloneNode'](!![]);_0x36e970[_0x264985(0xa54)][_0x264985(0xf6f)](_0x1b9bae,_0x36e970),_0x1b9bae[_0x264985(0x41b)]=()=>{const _0x2c6337=_0x264985;_0x1da1c8?(_0x4e26cd[_0x2c6337(0xb08)]['remove'](_0x2c6337(0x9eb)),_0x2488c0(_0x1da1c8)):alert(_0x2c6337(0x12a6));},_0x4e26cd['classList'][_0x264985(0x12b6)](_0x264985(0x9eb));});}function _0x1fbb75(){const _0x1c0dae=_0x239c7d,_0x2e9820=_0x496f0a[_0x1c0dae(0x88c)][_0x1c0dae(0x821)](_0x46b0fe=>_0x46b0fe['id']===_0x1c0dae(0x6d6));if(!_0x2e9820||!_0x2e9820['isAlive'])return;const _0x3e54ca=document['getElementById'](_0x1c0dae(0xf6a)),_0x34ab0b=_0x3e54ca[_0x1c0dae(0xa1e)][_0x1c0dae(0xb8f)]();_0x34ab0b&&(_0x2b76d9(_0x2e9820['name'],_0x34ab0b),_0x2607a3()),document[_0x1c0dae(0x400)]('werewolf-action-bar')[_0x1c0dae(0xa00)][_0x1c0dae(0xb1a)]='none',_0x3e54ca[_0x1c0dae(0xa1e)]='',_0x2e17ab();}async function _0x250262(){const _0x188018=_0x239c7d;_0x2eb770('你让大家继续讨论...'),_0x2607a3();const _0x3d1c20=document['getElementById'](_0x188018(0xbc8));if(_0x3d1c20)_0x3d1c20[_0x188018(0x366)]=!![];await _0x138765('请稍候',_0x188018(0x1425));const {proxyUrl:_0x101d58,apiKey:_0x266734,model:_0x16dd1a}=_0x4c8b14[_0x188018(0x814)];if(!_0x101d58||!_0x266734||!_0x16dd1a){alert(_0x188018(0x291));return;}const _0xd00d71=_0x3a1ab8();try{let _0x324b11=_0x101d58['includes'](_0x188018(0x14cc)),_0x2a3642=[{'role':_0x188018(0x6d6),'content':'请AI角色们继续进行讨论。'}],_0x40bee7=_0x3914a6(_0x16dd1a,_0x266734,_0xd00d71,_0x2a3642);const _0x43b600=_0x324b11?await fetch(_0x40bee7[_0x188018(0x299)],_0x40bee7[_0x188018(0x55b)]):await fetch(_0x101d58+_0x188018(0x1611),{'method':'POST','headers':{'Content-Type':_0x188018(0xfae),'Authorization':_0x188018(0xcee)+_0x266734},'body':JSON['stringify']({'model':_0x16dd1a,'messages':[{'role':_0x188018(0xaf6),'content':_0xd00d71},..._0x2a3642],'temperature':_0x4c8b14['globalSettings'][_0x188018(0x216)]||0.9})});if(!_0x43b600['ok']){const _0x1d4c78=await _0x43b600[_0x188018(0x15d3)]();throw new Error(_0x188018(0x7d5)+_0x1d4c78[_0x188018(0x5d7)][_0x188018(0x6e2)]);}const _0x5ef059=await _0x43b600[_0x188018(0x15d3)](),_0x5a9d0d=getGeminiResponseText(_0x5ef059),_0x209b23=_0x5a9d0d[_0x188018(0xbf7)](/(\[[\s\S]*\])/);if(!_0x209b23)throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x5a9d0d);const _0x4d6ce5=JSON[_0x188018(0x13f7)](_0x209b23[0x0]);for(const _0x3d4d59 of _0x4d6ce5){_0x3d4d59[_0x188018(0x12b3)]&&_0x3d4d59[_0x188018(0xf2d)]&&(_0x2b76d9(_0x3d4d59[_0x188018(0x12b3)],_0x3d4d59['dialogue']),_0x2607a3(),await new Promise(_0x35e84b=>setTimeout(_0x35e84b,0x5dc+Math['random']()*0x7d0)));}}catch(_0x6a351){console[_0x188018(0x5d7)](_0x188018(0x131f),_0x6a351),await _0x138765(_0x188018(0x14e2),'错误:\x20'+_0x6a351[_0x188018(0x6e2)]);}finally{if(_0x3d1c20)_0x3d1c20[_0x188018(0x366)]=![];}}async function _0x116fea(){const _0x4e976a=_0x239c7d,_0x594e7b=_0x496f0a['players'][_0x4e976a(0x821)](_0x152db4=>_0x152db4['id']===_0x4e976a(0x6d6));if(!_0x594e7b||!_0x594e7b[_0x4e976a(0xb3d)]){console[_0x4e976a(0x75e)](_0x4e976a(0xb53));return;}const _0x3d23e8=document[_0x4e976a(0x400)](_0x4e976a(0xf6a)),_0x3806b7=_0x3d23e8[_0x4e976a(0xa1e)][_0x4e976a(0xb8f)]();if(!_0x3806b7){alert(_0x4e976a(0x311));return;}_0x2b76d9(_0x594e7b[_0x4e976a(0xf3e)],_0x3806b7),_0x2607a3(),_0x3d23e8['value']='',await _0x138765(_0x4e976a(0x11b8),'正在等待AI角色们对你的发言做出回应...');const {proxyUrl:_0x558113,apiKey:_0x42f6de,model:_0x31e636}=_0x4c8b14[_0x4e976a(0x814)];if(!_0x558113||!_0x42f6de||!_0x31e636){alert('API未配置，无法生成对话。');return;}const _0x6d984e=_0x3a1ab8();try{let _0x2ad98b=_0x558113[_0x4e976a(0xd1b)](_0x4e976a(0x14cc)),_0x48a914=[{'role':'user','content':_0x4e976a(0xa71)+_0x594e7b[_0x4e976a(0xf3e)]+_0x4e976a(0x1485)}],_0x1ccba6=_0x3914a6(_0x31e636,_0x42f6de,_0x6d984e,_0x48a914);const _0xb6e8fe=_0x2ad98b?await fetch(_0x1ccba6['url'],_0x1ccba6[_0x4e976a(0x55b)]):await fetch(_0x558113+_0x4e976a(0x1611),{'method':'POST','headers':{'Content-Type':_0x4e976a(0xfae),'Authorization':'Bearer\x20'+_0x42f6de},'body':JSON['stringify']({'model':_0x31e636,'messages':[{'role':'system','content':_0x6d984e},..._0x48a914],'temperature':_0x4c8b14[_0x4e976a(0x14f1)][_0x4e976a(0x216)]||0.9})});if(!_0xb6e8fe['ok']){const _0x3aefad=await _0xb6e8fe['json']();throw new Error(_0x4e976a(0x7d5)+_0x3aefad[_0x4e976a(0x5d7)][_0x4e976a(0x6e2)]);}const _0x852b32=await _0xb6e8fe[_0x4e976a(0x15d3)](),_0x148aac=getGeminiResponseText(_0x852b32);let _0x1da9cf;try{let _0x1bd8cf=_0x148aac[_0x4e976a(0xe19)](/^```json\s*/,'')[_0x4e976a(0xe19)](/```$/,'')[_0x4e976a(0xb8f)]();const _0x8f7869=_0x1bd8cf[_0x4e976a(0xd53)]('['),_0x38b02e=_0x1bd8cf[_0x4e976a(0x14d9)](']');if(_0x8f7869===-0x1||_0x38b02e===-0x1||_0x38b02e<_0x8f7869)throw new Error(_0x4e976a(0x1478));const _0x1a04c4=_0x1bd8cf[_0x4e976a(0x371)](_0x8f7869,_0x38b02e+0x1);_0x1da9cf=JSON[_0x4e976a(0x13f7)](_0x1a04c4);}catch(_0x556512){if(_0x556512[_0x4e976a(0x6e2)][_0x4e976a(0xd1b)]('Bad\x20control\x20character')){console['warn'](_0x4e976a(0x46e));const _0xc4b16=_0x23f160=>{const _0x34225c=_0x4e976a;let _0x4e72e9=![],_0x242ef5=![],_0x159b65='';for(let _0x20f692=0x0;_0x20f692<_0x23f160[_0x34225c(0x8d6)];_0x20f692++){const _0x439309=_0x23f160[_0x20f692];if(_0x242ef5){_0x159b65+=_0x439309,_0x242ef5=![];continue;}if(_0x439309==='\x5c'){_0x159b65+=_0x439309,_0x242ef5=!![];continue;}if(_0x439309==='\x22'){_0x159b65+=_0x439309,_0x4e72e9=!_0x4e72e9;continue;}if(_0x4e72e9){if(_0x439309==='\x0a')_0x159b65+='\x5cn';else{if(_0x439309==='\x0d')_0x159b65+='\x5cr';else{if(_0x439309==='\x09')_0x159b65+='\x5ct';else{if(_0x439309['charCodeAt'](0x0)<0x20)continue;else _0x159b65+=_0x439309;}}}}else _0x159b65+=_0x439309;}return _0x159b65;};let _0x56e149=_0x148aac[_0x4e976a(0xe19)](/^```json\s*/,'')[_0x4e976a(0xe19)](/```$/,'')['trim']();const _0x595831=_0xc4b16(_0x56e149),_0x2ca273=_0x595831[_0x4e976a(0xbf7)](/(\[[\s\S]*\])/);if(!_0x2ca273)throw new Error(_0x4e976a(0x1520));_0x1da9cf=JSON[_0x4e976a(0x13f7)](_0x2ca273[0x0]);}else throw new Error(_0x4e976a(0x7d7)+_0x556512['message']+_0x4e976a(0xc72)+_0x148aac);}for(const _0xff0325 of _0x1da9cf){_0xff0325['speaker_name']&&_0xff0325[_0x4e976a(0xf2d)]&&(_0x2b76d9(_0xff0325['speaker_name'],_0xff0325[_0x4e976a(0xf2d)]),_0x2607a3(),await new Promise(_0x333289=>setTimeout(_0x333289,0x5dc+Math['random']()*0x7d0)));}}catch(_0x25deba){console[_0x4e976a(0x5d7)](_0x4e976a(0x131f),_0x25deba),await _0x138765(_0x4e976a(0x14e2),_0x4e976a(0x906)+_0x25deba[_0x4e976a(0x6e2)]);}}async function _0x2e17ab(){const _0x59773e=_0x239c7d;_0x2eb770('发言结束，现在开始投票。'),_0x2607a3(),_0x496f0a[_0x59773e(0x14a6)]={};let _0x5624b1=null;_0x496f0a[_0x59773e(0xf8b)]=_0x59773e(0xe6c);try{_0x5624b1=await _0x14936d(),_0x5624b1&&_0x5624b1[_0x59773e(0xbdc)](_0x5a7d56=>{const _0x3a7630=_0x59773e,_0x205307=_0x496f0a['players'][_0x3a7630(0x821)](_0x18dfa8=>_0x18dfa8[_0x3a7630(0xf3e)]===_0x5a7d56[_0x3a7630(0x475)]),_0x4f4f2c=_0x496f0a[_0x3a7630(0x88c)][_0x3a7630(0x821)](_0x27c0dc=>_0x27c0dc[_0x3a7630(0xf3e)]===_0x5a7d56[_0x3a7630(0xc90)]);_0x205307&&_0x205307[_0x3a7630(0xb3d)]&&_0x4f4f2c&&(_0x496f0a[_0x3a7630(0x14a6)][_0x205307[_0x3a7630(0xf3e)]]=_0x4f4f2c[_0x3a7630(0xf3e)]);}),_0x496f0a[_0x59773e(0xf8b)]=null;}catch(_0x5153d4){console[_0x59773e(0x5d7)](_0x59773e(0x14ab),_0x5153d4),await _0x138765(_0x59773e(0x12cb),_0x59773e(0x449)+_0x5153d4[_0x59773e(0x6e2)]),document['getElementById'](_0x59773e(0x8dc))[_0x59773e(0xa00)]['display']=_0x59773e(0x1181);return;}const _0x5e0963=_0x496f0a[_0x59773e(0x88c)][_0x59773e(0x821)](_0x44bfd1=>_0x44bfd1['id']===_0x59773e(0x6d6));if(_0x5e0963&&_0x5e0963[_0x59773e(0xb3d)]){_0x2eb770(_0x59773e(0x13d1)),_0x2607a3();const _0x4a995c=await _0x35ddec(_0x59773e(0xc61)),_0x31cee2=_0x496f0a[_0x59773e(0x88c)][_0x59773e(0x821)](_0x2ee7df=>_0x2ee7df['id']===_0x4a995c);_0x31cee2&&(_0x496f0a[_0x59773e(0x14a6)][_0x5e0963[_0x59773e(0xf3e)]]=_0x31cee2[_0x59773e(0xf3e)]);}_0x2e581c();}async function _0x14936d(){const _0x29cf91=_0x239c7d,{proxyUrl:_0x24d951,apiKey:_0x43b959,model:_0x42ae3a}=_0x4c8b14[_0x29cf91(0x814)];if(!_0x24d951||!_0x43b959||!_0x42ae3a)return null;const _0x36fb37=_0x496f0a['players'][_0x29cf91(0x29d)](_0x5c6014=>_0x5c6014[_0x29cf91(0xb3d)]&&_0x5c6014['id']!==_0x29cf91(0x6d6)),_0x211bdc=_0x496f0a['players'][_0x29cf91(0x29d)](_0x115e35=>_0x115e35[_0x29cf91(0xb3d)])['map'](_0x3abb17=>_0x3abb17['name']);let _0x24255c=_0x3a1ab8();_0x24255c+=_0x29cf91(0xe44)+_0x211bdc[_0x29cf91(0xee1)](',\x20')+'\x0a\x0a现在，请为所有存活的AI角色生成他们的投票决定。';try{let _0x1976dd=_0x24d951[_0x29cf91(0xd1b)](_0x29cf91(0x14cc)),_0x1370f2=[{'role':_0x29cf91(0x6d6),'content':_0x29cf91(0xd96)}],_0x4d05b3=_0x3914a6(_0x42ae3a,_0x43b959,_0x24255c,_0x1370f2);const _0x1c3b68=_0x1976dd?await fetch(_0x4d05b3['url'],_0x4d05b3[_0x29cf91(0x55b)]):await fetch(_0x24d951+'/v1/chat/completions',{'method':_0x29cf91(0x953),'headers':{'Content-Type':'application/json','Authorization':_0x29cf91(0xcee)+_0x43b959},'body':JSON[_0x29cf91(0xea5)]({'model':_0x42ae3a,'messages':[{'role':_0x29cf91(0xaf6),'content':_0x24255c},..._0x1370f2],'temperature':_0x4c8b14[_0x29cf91(0x14f1)]['apiTemperature']||0.8})});if(!_0x1c3b68['ok'])throw new Error((await _0x1c3b68['json']())[_0x29cf91(0x5d7)]['message']);const _0x39bfe2=await _0x1c3b68['json'](),_0xa3b59c=getGeminiResponseText(_0x39bfe2);let _0x7119e6=_0xa3b59c['replace'](/^```json\s*/,'')[_0x29cf91(0xe19)](/```$/,'')[_0x29cf91(0xb8f)]();const _0x12c36f=_0x7119e6[_0x29cf91(0xd53)]('['),_0x23a858=_0x7119e6[_0x29cf91(0x14d9)](']');if(_0x12c36f===-0x1||_0x23a858===-0x1||_0x23a858<_0x12c36f)throw new Error(_0x29cf91(0x1518));const _0x3b8d00=_0x7119e6[_0x29cf91(0x371)](_0x12c36f,_0x23a858+0x1);try{const _0xc9fbb3=_0x3b8d00[_0x29cf91(0xbf7)](/(\[[\s\S]*?\])/g);if(_0xc9fbb3&&_0xc9fbb3[_0x29cf91(0x8d6)]>0x0)return JSON[_0x29cf91(0x13f7)](_0xc9fbb3[_0xc9fbb3[_0x29cf91(0x8d6)]-0x1]);return JSON[_0x29cf91(0x13f7)](_0x3b8d00);}catch(_0x47c6aa){throw new Error(_0x29cf91(0xc07)+_0x47c6aa[_0x29cf91(0x6e2)]+_0x29cf91(0xc72)+_0xa3b59c);}}catch(_0x2c1c11){console['error'](_0x29cf91(0x944),_0x2c1c11);throw new Error(_0x29cf91(0xc0f)+_0x2c1c11[_0x29cf91(0x6e2)]);}}function _0x2e581c(){const _0x10dce0=_0x239c7d,_0xbe6d5a={},_0x47fabd={};for(const _0x26d82f in _0x496f0a['votes']){const _0x560bf4=_0x496f0a[_0x10dce0(0x14a6)][_0x26d82f];_0xbe6d5a[_0x560bf4]=(_0xbe6d5a[_0x560bf4]||0x0)+0x1,!_0x47fabd[_0x560bf4]&&(_0x47fabd[_0x560bf4]=[]),_0x47fabd[_0x560bf4]['push'](_0x26d82f);}let _0x30005d=0x0,_0x235892=[];for(const _0x324eef in _0xbe6d5a){const _0x1d4fee=_0xbe6d5a[_0x324eef];if(_0x1d4fee>_0x30005d)_0x30005d=_0x1d4fee,_0x235892=[_0x324eef];else _0x1d4fee===_0x30005d&&_0x235892[_0x10dce0(0x6bb)](_0x324eef);}_0x2eb770('投票结果：');for(const _0x17a7fe in _0x47fabd){_0x2eb770(_0x17a7fe+'\x20('+_0x47fabd[_0x17a7fe]['length']+'票):\x20'+_0x47fabd[_0x17a7fe][_0x10dce0(0xee1)]('、\x20'));}if(_0x235892['length']===0x1&&_0x30005d>0x0){const _0x273a45=_0x496f0a[_0x10dce0(0x88c)][_0x10dce0(0x821)](_0x29df1d=>_0x29df1d[_0x10dce0(0xf3e)]===_0x235892[0x0]);if(_0x273a45){_0x273a45[_0x10dce0(0xb3d)]=![],_0x2eb770(_0x273a45[_0x10dce0(0xf3e)]+_0x10dce0(0x577));if(_0x273a45[_0x10dce0(0x71a)]==='猎人'){}}}else _0x2eb770('平票或无人投票，此轮无人出局。');_0x2607a3();if(_0x49a5b8())return;_0x496f0a[_0x10dce0(0x169c)]++,_0x439c81();}async function _0x4bc684(){const _0x2932c2=_0x239c7d,{proxyUrl:_0x202188,apiKey:_0x2a7930,model:_0x5ad5e8}=_0x4c8b14[_0x2932c2(0x814)];if(!_0x202188||!_0x2a7930||!_0x5ad5e8)return null;const _0xf9cef2=_0x496f0a[_0x2932c2(0x88c)][_0x2932c2(0x29d)](_0x498a07=>_0x498a07[_0x2932c2(0x71a)]==='狼人'&&_0x498a07[_0x2932c2(0xb3d)]),_0x368d69=_0x496f0a[_0x2932c2(0x88c)][_0x2932c2(0x29d)](_0x431bb6=>_0x431bb6[_0x2932c2(0xb3d)]&&_0x431bb6[_0x2932c2(0x71a)]!=='狼人'),_0x218cd2='\x0a#\x20你的任务\x0a你现在是狼人团队的指挥官。你的任务是分析当前局势，并为狼人团队选择一个最佳的刀人目标。\x0a#\x20核心规则\x0a1.\x20\x20**目标**:\x20优先刀掉预言家、女巫等神职人员。如果没有明确的神职信息，可以根据发言来判断谁的逻辑清晰、威胁最大。\x0a2.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20`{\x22target_name\x22:\x20\x22你决定要刀的玩家名字\x22}`\x0a\x0a#\x20游戏状态\x0a-\x20**你的狼队友是**:\x20'+_0xf9cef2[_0x2932c2(0xd18)](_0x110a98=>_0x110a98[_0x2932c2(0xf3e)])[_0x2932c2(0xee1)]('、\x20')+_0x2932c2(0x1020)+_0x368d69['map'](_0x14ca53=>_0x14ca53[_0x2932c2(0xf3e)])[_0x2932c2(0xee1)]('、\x20')+_0x2932c2(0xe98)+_0x496f0a[_0x2932c2(0xfdd)][_0x2932c2(0xd18)](_0x133245=>_0x133245[_0x2932c2(0x4b8)]+':\x20'+_0x133245[_0x2932c2(0x1109)])[_0x2932c2(0xee1)]('\x0a')+_0x2932c2(0x244);try{let _0x20592b=_0x202188['includes'](_0x2932c2(0x14cc)),_0x47ff69=[{'role':'user','content':'请选择今晚的目标。'}],_0x5dec69=_0x3914a6(_0x5ad5e8,_0x2a7930,_0x218cd2,_0x47ff69);const _0x1c7f72=_0x20592b?await fetch(_0x5dec69['url'],_0x5dec69[_0x2932c2(0x55b)]):await fetch(_0x202188+_0x2932c2(0x1611),{'method':'POST','headers':{'Content-Type':_0x2932c2(0xfae),'Authorization':_0x2932c2(0xcee)+_0x2a7930},'body':JSON[_0x2932c2(0xea5)]({'model':_0x5ad5e8,'messages':[{'role':_0x2932c2(0xaf6),'content':_0x218cd2},..._0x47ff69],'temperature':_0x4c8b14['globalSettings'][_0x2932c2(0x216)]||0.8})});if(!_0x1c7f72['ok'])throw new Error((await _0x1c7f72['json']())[_0x2932c2(0x5d7)]['message']);const _0x10eb9d=await _0x1c7f72['json'](),_0x2b3c1b=getGeminiResponseText(_0x10eb9d),_0x4583f5=_0x2b3c1b[_0x2932c2(0xbf7)](/({[\s\S]*})/);if(!_0x4583f5)throw new Error(_0x2932c2(0xc88));const _0x3cd8c4=JSON['parse'](_0x4583f5[0x0]),_0x1b6236=_0x496f0a[_0x2932c2(0x88c)][_0x2932c2(0x821)](_0x2fe012=>_0x2fe012['name']===_0x3cd8c4[_0x2932c2(0x24a)]);return _0x1b6236?_0x1b6236['id']:null;}catch(_0x1c053a){return console[_0x2932c2(0x5d7)]('获取AI狼人目标失败:',_0x1c053a),_0x368d69[Math[_0x2932c2(0x1381)](Math[_0x2932c2(0x12bc)]()*_0x368d69[_0x2932c2(0x8d6)])]['id'];}}function _0x2210dc(_0x31ca4a,_0x38fb22){return new Promise(_0x437d8b=>{const _0x292b43=_0x466f,_0x4e1768=document[_0x292b43(0x400)](_0x292b43(0x1556)),_0x19578f=document[_0x292b43(0x400)](_0x292b43(0xf27)),_0xec02a3=document[_0x292b43(0x400)](_0x292b43(0xe08)),_0x451b12=document[_0x292b43(0x400)](_0x292b43(0x4bb)),_0x47a3f7=document[_0x292b43(0x400)]('witch-do-nothing-btn');_0x19578f[_0x292b43(0x1575)]='';const _0x33f0af=_0x451b12[_0x292b43(0xdbc)](!![]);_0x451b12[_0x292b43(0xa54)][_0x292b43(0xf6f)](_0x33f0af,_0x451b12);const _0xd6528=_0x47a3f7[_0x292b43(0xdbc)](!![]);_0x47a3f7[_0x292b43(0xa54)][_0x292b43(0xf6f)](_0xd6528,_0x47a3f7),_0x33f0af['style'][_0x292b43(0xb1a)]=_0x292b43(0x1181),_0x33f0af[_0x292b43(0x366)]=!![];let _0x47f0d9={'save':![],'poison':null},_0xcd1a5f=null;if(_0x31ca4a&&!_0x38fb22[_0x292b43(0x1227)]){_0xec02a3[_0x292b43(0xde7)]='昨晚\x20'+_0x31ca4a['name']+_0x292b43(0x1028);const _0x13a259=document['createElement'](_0x292b43(0x99b));_0x13a259[_0x292b43(0x4e1)]=_0x292b43(0x118e),_0x13a259[_0x292b43(0xde7)]=_0x292b43(0x143c),_0x13a259[_0x292b43(0xa00)][_0x292b43(0x1442)]=_0x292b43(0x58b),_0x13a259[_0x292b43(0x41b)]=()=>{const _0x307cdb=_0x292b43;_0x47f0d9['save']=!![],_0x4e1768[_0x307cdb(0xb08)][_0x307cdb(0xc46)](_0x307cdb(0x9eb)),_0x437d8b(_0x47f0d9);},_0x19578f[_0x292b43(0x8f2)](_0x13a259);}else _0x31ca4a?_0xec02a3[_0x292b43(0xde7)]=_0x292b43(0x1584)+_0x31ca4a[_0x292b43(0xf3e)]+'\x20被刀了\x20(你没有解药了)':_0xec02a3[_0x292b43(0xde7)]=_0x292b43(0x8f3);if(!_0x38fb22[_0x292b43(0x119b)]){const _0x4dbba8=document['createElement']('p');_0x4dbba8[_0x292b43(0xde7)]=_0x292b43(0xdea),_0x4dbba8[_0x292b43(0xa00)][_0x292b43(0x7f3)]=_0x292b43(0x1287),_0x4dbba8['style']['marginTop']=_0x292b43(0x58b),_0x19578f[_0x292b43(0x8f2)](_0x4dbba8);const _0x3c2048=_0x496f0a[_0x292b43(0x88c)]['filter'](_0xb69cc7=>_0xb69cc7['isAlive']&&_0xb69cc7['id']!==_0x31ca4a?.['id']);_0x3c2048[_0x292b43(0xbdc)](_0x339a13=>{const _0x2c5a1f=_0x292b43,_0x40af56=document[_0x2c5a1f(0x2c9)](_0x2c5a1f(0xf8e));_0x40af56[_0x2c5a1f(0x4e1)]='werewolf-selection-item',_0x40af56[_0x2c5a1f(0xd61)]['id']=_0x339a13['id'],_0x40af56['innerHTML']='<img\x20src=\x22'+_0x339a13[_0x2c5a1f(0xa9a)]+_0x2c5a1f(0x10c0)+_0x339a13['name']+_0x2c5a1f(0x21f),_0x40af56[_0x2c5a1f(0x41b)]=()=>{const _0x4bc24a=_0x2c5a1f;_0x19578f[_0x4bc24a(0x527)](_0x4bc24a(0xf1f))[_0x4bc24a(0xbdc)](_0x566aa0=>_0x566aa0[_0x4bc24a(0xb08)][_0x4bc24a(0xc46)](_0x4bc24a(0x148b))),_0x40af56['classList'][_0x4bc24a(0x12b6)](_0x4bc24a(0x148b)),_0xcd1a5f=_0x339a13['id'],_0x33f0af[_0x4bc24a(0x366)]=![];},_0x19578f[_0x2c5a1f(0x8f2)](_0x40af56);});}_0x33f0af[_0x292b43(0x41b)]=()=>{const _0x4b9a2c=_0x292b43;_0xcd1a5f&&(_0x47f0d9[_0x4b9a2c(0xeb3)]=_0xcd1a5f,_0x4e1768[_0x4b9a2c(0xb08)][_0x4b9a2c(0xc46)](_0x4b9a2c(0x9eb)),_0x437d8b(_0x47f0d9));},_0xd6528[_0x292b43(0x41b)]=()=>{const _0x3e1b53=_0x292b43;_0x4e1768[_0x3e1b53(0xb08)][_0x3e1b53(0xc46)](_0x3e1b53(0x9eb)),_0x437d8b(_0x47f0d9);},_0x4e1768[_0x292b43(0xb08)][_0x292b43(0x12b6)](_0x292b43(0x9eb));});}async function _0x43dede(){const _0x320919=_0x239c7d,_0x4d6aeb=_0x496f0a['lastFailedAction'];if(!_0x4d6aeb)return;document[_0x320919(0x400)]('werewolf-retry-btn')[_0x320919(0xa00)][_0x320919(0xb1a)]=_0x320919(0x165b),await _0x138765(_0x320919(0x13e9),_0x320919(0x102d)+_0x4d6aeb+_0x320919(0xa49));switch(_0x4d6aeb){case _0x320919(0xa9d):await _0x439c81();break;case'startDiscussion':await _0x49cd02();break;case _0x320919(0xe6c):await _0x2e17ab();break;}}function _0x49a5b8(){const _0x380251=_0x239c7d,_0x934f3a=_0x496f0a[_0x380251(0x88c)][_0x380251(0x29d)](_0x30e117=>_0x30e117[_0x380251(0xb3d)]),_0x441d07=_0x934f3a[_0x380251(0x29d)](_0x193aed=>_0x193aed[_0x380251(0x71a)]==='狼人'),_0x4ab762=_0x934f3a['filter'](_0x56c2fd=>[_0x380251(0xcf3),'女巫','猎人','守卫'][_0x380251(0xd1b)](_0x56c2fd[_0x380251(0x71a)])),_0x398fa3=_0x934f3a['filter'](_0x254e75=>_0x254e75[_0x380251(0x71a)]==='平民');let _0x535bf6=null;if(_0x441d07[_0x380251(0x8d6)]===0x0)_0x535bf6='好人';else{if(_0x441d07['length']>=_0x4ab762[_0x380251(0x8d6)]+_0x398fa3[_0x380251(0x8d6)])_0x535bf6='狼人';else _0x496f0a[_0x380251(0x55c)]===_0x380251(0x322)?(_0x4ab762[_0x380251(0x8d6)]===0x0||_0x398fa3['length']===0x0)&&(_0x535bf6='狼人'):_0x4ab762[_0x380251(0x8d6)]===0x0&&_0x398fa3['length']===0x0&&(_0x535bf6='狼人');}if(_0x535bf6)return _0x593afa(_0x535bf6),!![];return![];}async function _0x352000(){const _0x200010=_0x239c7d,_0x5e1acb=await _0x56d4d3(_0x200010(0xe14),_0x200010(0xe8c),{'confirmText':_0x200010(0x974)});if(!_0x5e1acb)return;await _0x138765(_0x200010(0x13e9),'正在扫描和修复数据...');try{const _0xf1e9a7=await _0x54c587['chats']['toArray']();let _0x1eafb6=0x0;for(const _0x11a5fd of _0xf1e9a7){let _0x5bd424=![];!Array[_0x200010(0x16a1)](_0x11a5fd['history'])&&(_0x11a5fd['history']=[],_0x5bd424=!![]),(typeof _0x11a5fd[_0x200010(0xa37)]!=='object'||_0x11a5fd[_0x200010(0xa37)]===null)&&(_0x11a5fd['settings']={},_0x5bd424=!![]),!_0x11a5fd[_0x200010(0xc98)]&&!_0x11a5fd[_0x200010(0xdcf)]&&(_0x11a5fd[_0x200010(0xdcf)]=_0x11a5fd[_0x200010(0xf3e)],_0x5bd424=!![]),typeof _0x11a5fd[_0x200010(0x73c)]===_0x200010(0xd30)&&(_0x11a5fd[_0x200010(0x73c)]=0x0,_0x5bd424=!![]),!Array[_0x200010(0x16a1)](_0x11a5fd[_0x200010(0x1600)])&&(_0x11a5fd[_0x200010(0x1600)]=[],_0x5bd424=!![]),_0x5bd424&&(_0x1eafb6++,console[_0x200010(0x1e6)](_0x200010(0x961)+_0x11a5fd[_0x200010(0xf3e)]+_0x200010(0xc4f)+_0x11a5fd['id']+_0x200010(0x6b0)),await _0x54c587['chats'][_0x200010(0x4cb)](_0x11a5fd)),_0x4c8b14['chats'][_0x11a5fd['id']]=_0x11a5fd;}_0x1eafb6>0x0?(await _0x138765('修复完成！','成功检查并修复了\x20'+_0x1eafb6+'\x20个角色的数据问题！\x0a\x0a聊天列表已为您刷新。'),await _0x41b828()):await _0x138765(_0x200010(0xb4c),_0x200010(0x46d));}catch(_0x30a37d){console[_0x200010(0x5d7)](_0x200010(0xe5e),_0x30a37d),await _0x138765(_0x200010(0x12cb),_0x200010(0x52e)+_0x30a37d[_0x200010(0x6e2)]);}}function _0x3a43dd(_0x222043,_0x3446f7='top'){const _0x225935=_0x239c7d;if(_0x222043[_0x225935(0x13ef)](_0x225935(0xbb3)))return;const _0x56df14=document[_0x225935(0x2c9)]('div');_0x56df14['className']=_0x225935(0x136c),_0x56df14[_0x225935(0x1575)]=_0x225935(0x1f9),_0x3446f7===_0x225935(0xa69)?_0x222043['appendChild'](_0x56df14):_0x222043[_0x225935(0x587)](_0x56df14);}function _0x42da12(_0x227ebe){const _0x534a26=_0x239c7d,_0x1933ab=_0x227ebe[_0x534a26(0x13ef)](_0x534a26(0xbb3));_0x1933ab&&_0x1933ab[_0x534a26(0xc46)]();}async function _0x536216(){const _0x145cbe=_0x239c7d,_0xb128c=document[_0x145cbe(0x400)](_0x145cbe(0x147d)),_0x40ba08=document[_0x145cbe(0x400)](_0x145cbe(0x1358)),_0xf58f9=document['getElementById']('select-all-world-books-for-clear');_0x40ba08[_0x145cbe(0x1575)]='',_0xf58f9[_0x145cbe(0x6f9)]=![];const _0xebebf8=await _0x54c587[_0x145cbe(0xf57)][_0x145cbe(0xce1)]();_0xebebf8[_0x145cbe(0x8d6)]===0x0?_0x40ba08[_0x145cbe(0x1575)]=_0x145cbe(0xbe8):_0xebebf8[_0x145cbe(0xbdc)](_0x304308=>{const _0x3a58c5=_0x145cbe,_0xcca177=document['createElement']('div');_0xcca177['className']=_0x3a58c5(0x417),_0xcca177['dataset'][_0x3a58c5(0x443)]=_0x304308['id'],_0xcca177[_0x3a58c5(0x1575)]=_0x3a58c5(0x11d1)+_0x304308[_0x3a58c5(0xf3e)]+_0x3a58c5(0xee0),_0x40ba08[_0x3a58c5(0x8f2)](_0xcca177);}),_0xb128c[_0x145cbe(0xb08)][_0x145cbe(0x12b6)](_0x145cbe(0x9eb));}async function _0x478ca7(){const _0x597860=_0x239c7d,_0x56c4f0=document[_0x597860(0x527)](_0x597860(0x945));if(_0x56c4f0[_0x597860(0x8d6)]===0x0){alert(_0x597860(0x146c));return;}const _0x980605=Array['from'](_0x56c4f0)['map'](_0x283899=>_0x283899[_0x597860(0xd61)][_0x597860(0x443)]),_0x4051a5=await _0x56d4d3(_0x597860(0x1309),_0x597860(0x11d0)+_0x56c4f0['length']+_0x597860(0x1576),{'confirmButtonClass':_0x597860(0x142c),'confirmText':'确认删除'});if(!_0x4051a5)return;await _0x138765(_0x597860(0x13e9),_0x597860(0x1411));try{await _0x54c587[_0x597860(0xfec)]('rw',_0x54c587[_0x597860(0xf57)],_0x54c587['chats'],async()=>{const _0x73dfd1=_0x597860;await _0x54c587[_0x73dfd1(0xf57)][_0x73dfd1(0x2c6)](_0x980605);const _0x393f24=await _0x54c587[_0x73dfd1(0xbea)][_0x73dfd1(0xce1)]();for(const _0x3eb9b0 of _0x393f24){if(_0x3eb9b0[_0x73dfd1(0xa37)]&&Array[_0x73dfd1(0x16a1)](_0x3eb9b0[_0x73dfd1(0xa37)]['linkedWorldBookIds'])){const _0x44f6c2=_0x3eb9b0[_0x73dfd1(0xa37)][_0x73dfd1(0xb0d)][_0x73dfd1(0x8d6)];_0x3eb9b0[_0x73dfd1(0xa37)][_0x73dfd1(0xb0d)]=_0x3eb9b0[_0x73dfd1(0xa37)]['linkedWorldBookIds'][_0x73dfd1(0x29d)](_0x266b0a=>!_0x980605[_0x73dfd1(0xd1b)](_0x266b0a)),_0x3eb9b0[_0x73dfd1(0xa37)][_0x73dfd1(0xb0d)][_0x73dfd1(0x8d6)]<_0x44f6c2&&await _0x54c587[_0x73dfd1(0xbea)][_0x73dfd1(0x4cb)](_0x3eb9b0);}}}),_0x4c8b14[_0x597860(0xf57)]=_0x4c8b14[_0x597860(0xf57)][_0x597860(0x29d)](_0x4d23b2=>!_0x980605[_0x597860(0xd1b)](_0x4d23b2['id'])),document[_0x597860(0x400)]('delete-world-books-modal')['classList'][_0x597860(0xc46)]('visible'),await _0x138765(_0x597860(0xee6),_0x56c4f0[_0x597860(0x8d6)]+_0x597860(0x9e5));}catch(_0xbb3bba){console[_0x597860(0x5d7)](_0x597860(0xeac),_0xbb3bba),await _0x138765(_0x597860(0x11d9),_0x597860(0xb80)+_0xbb3bba[_0x597860(0x6e2)]);}}function _0x238385(){const _0x250a1b=_0x239c7d;if(!_0x4c8b14[_0x250a1b(0x1539)])return;const _0x401933=_0x4c8b14[_0x250a1b(0x1539)],_0x4bcc98=document[_0x250a1b(0x400)]('reading-overlay'),_0x328503=document[_0x250a1b(0x400)](_0x250a1b(0xe26)),_0x4b0f2f=document['getElementById']('reading-restore-btn');let _0x1ef81e=_0x4670b4[_0x401933];if(_0x1ef81e&&_0x1ef81e[_0x250a1b(0x11e7)]){_0x1ef81e[_0x250a1b(0x6b9)]&&_0x53d450();_0x4bcc98[_0x250a1b(0xa00)][_0x250a1b(0xb1a)]='flex';return;}_0x414c32(_0x401933),_0x4d790f(_0x401933),_0x4bcc98[_0x250a1b(0xa00)][_0x250a1b(0xb1a)]=_0x250a1b(0x375),_0x328503['classList']['remove'](_0x250a1b(0xf51)),_0x4b0f2f[_0x250a1b(0xa00)][_0x250a1b(0xb1a)]=_0x250a1b(0x165b);const _0x4bb8d2=document[_0x250a1b(0x400)](_0x250a1b(0x43a)),_0x6714ec=_0x328503[_0x250a1b(0x1437)](),_0x31f600=(_0x4bb8d2['clientHeight']-_0x6714ec['height'])/0x2,_0x3395d7=(_0x4bb8d2[_0x250a1b(0x13aa)]-_0x6714ec[_0x250a1b(0x1383)])/0x2;_0x328503[_0x250a1b(0xa00)]['top']=_0x31f600+'px',_0x328503[_0x250a1b(0xa00)]['left']=_0x3395d7+'px',_0x328503[_0x250a1b(0xa00)][_0x250a1b(0x8ea)]='';}function _0x414c32(_0x1dbd41){const _0x2bdd75=_0x239c7d;_0x4670b4[_0x1dbd41]={'isActive':!![],'isMinimized':![],'title':_0x2bdd75(0xbd9),'contentLines':[],'currentPage':0x0,'totalPages':0x0,'linesPerPage':0xf,'currentSnippet':''};}function _0x2ef5d1(){const _0x34fcda=_0x239c7d,_0x2357c8=_0x4c8b14[_0x34fcda(0x1539)];if(!_0x2357c8||!_0x4670b4[_0x2357c8]||!_0x4670b4[_0x2357c8][_0x34fcda(0x11e7)])return;document['getElementById'](_0x34fcda(0xd5f))[_0x34fcda(0xa00)][_0x34fcda(0xb1a)]='none',document[_0x34fcda(0x400)](_0x34fcda(0x233))[_0x34fcda(0xa00)][_0x34fcda(0xb1a)]=_0x34fcda(0x165b),document['getElementById']('reading-window')['classList'][_0x34fcda(0xc46)](_0x34fcda(0xf51)),_0x4670b4[_0x2357c8][_0x34fcda(0x11e7)]=![],console[_0x34fcda(0x1e6)](_0x34fcda(0x613));}function _0x5a9463(){const _0x2c9862=_0x239c7d,_0x4bcb21=_0x4670b4[_0x4c8b14[_0x2c9862(0x1539)]];if(!_0x4bcb21||!_0x4bcb21[_0x2c9862(0x11e7)]||_0x4bcb21[_0x2c9862(0x6b9)])return;_0x4bcb21[_0x2c9862(0x6b9)]=!![],document[_0x2c9862(0x400)]('reading-window')['classList'][_0x2c9862(0x12b6)]('minimized'),document[_0x2c9862(0x400)](_0x2c9862(0x233))['style']['display']=_0x2c9862(0x375);}function _0x53d450(){const _0x1918a5=_0x239c7d,_0x5b5f0a=_0x4670b4[_0x4c8b14[_0x1918a5(0x1539)]];if(!_0x5b5f0a||!_0x5b5f0a[_0x1918a5(0x11e7)]||!_0x5b5f0a[_0x1918a5(0x6b9)])return;_0x5b5f0a['isMinimized']=![],document[_0x1918a5(0x400)]('reading-restore-btn')[_0x1918a5(0xa00)]['display']=_0x1918a5(0x165b),document[_0x1918a5(0x400)](_0x1918a5(0xe26))['classList'][_0x1918a5(0xc46)](_0x1918a5(0xf51));}function _0x4aead0(_0x67b751,_0x20812c){const _0x56e44a=_0x239c7d;let _0x5eccae=0x0,_0xd9f886=0x0,_0x496cde=0x0,_0x3976e2=0x0;const _0x2a937e=document['getElementById'](_0x56e44a(0x43a)),_0x1bd826=_0x28291b=>{const _0x4f154d=_0x56e44a;if(_0x28291b['target'][_0x4f154d(0x117a)](_0x4f154d(0x99b)))return;if(_0x67b751[_0x4f154d(0xa00)]['transform']){const _0x89d7a2=_0x67b751[_0x4f154d(0x1437)](),_0x2416a3=_0x67b751['offsetParent'][_0x4f154d(0x1437)]();_0x67b751[_0x4f154d(0xa00)]['top']=_0x89d7a2['top']-_0x2416a3['top']+'px',_0x67b751[_0x4f154d(0xa00)][_0x4f154d(0xfef)]=_0x89d7a2['left']-_0x2416a3['left']+'px',_0x67b751[_0x4f154d(0xa00)][_0x4f154d(0x8ea)]='';}_0x28291b['preventDefault']();const _0x2307af=_0x28291b[_0x4f154d(0xbbf)]===_0x4f154d(0x1479)?_0x28291b[_0x4f154d(0x567)][0x0]:_0x28291b;_0x496cde=_0x2307af[_0x4f154d(0x13c9)],_0x3976e2=_0x2307af['clientY'],document[_0x4f154d(0x501)](_0x4f154d(0x98c),_0x3b0252),document[_0x4f154d(0x501)]('mousemove',_0x32ffd4),document[_0x4f154d(0x501)]('touchend',_0x3b0252),document['addEventListener'](_0x4f154d(0x1119),_0x32ffd4);},_0x32ffd4=_0x46aeed=>{const _0x153061=_0x56e44a,_0x43b5d0=_0x46aeed[_0x153061(0xbbf)]===_0x153061(0x1119)?_0x46aeed[_0x153061(0x567)][0x0]:_0x46aeed;_0x5eccae=_0x496cde-_0x43b5d0['clientX'],_0xd9f886=_0x3976e2-_0x43b5d0[_0x153061(0xcc8)],_0x496cde=_0x43b5d0['clientX'],_0x3976e2=_0x43b5d0[_0x153061(0xcc8)];let _0x123460=_0x67b751[_0x153061(0xf1b)]-_0xd9f886,_0x37375b=_0x67b751[_0x153061(0x120e)]-_0x5eccae;const _0x1a25db=_0x2a937e['clientHeight']-_0x67b751[_0x153061(0x1134)]-0xa,_0xad297d=_0x2a937e['clientWidth']-_0x67b751[_0x153061(0xeeb)]-0xa;_0x123460=Math[_0x153061(0x124e)](0xa,Math[_0x153061(0xaeb)](_0x123460,_0x1a25db)),_0x37375b=Math[_0x153061(0x124e)](0xa,Math[_0x153061(0xaeb)](_0x37375b,_0xad297d)),_0x67b751[_0x153061(0xa00)]['top']=_0x123460+'px',_0x67b751[_0x153061(0xa00)][_0x153061(0xfef)]=_0x37375b+'px';},_0x3b0252=()=>{const _0x4f0cd0=_0x56e44a;document[_0x4f0cd0(0xf17)](_0x4f0cd0(0x98c),_0x3b0252),document[_0x4f0cd0(0xf17)](_0x4f0cd0(0x1602),_0x32ffd4),document[_0x4f0cd0(0xf17)](_0x4f0cd0(0x11bc),_0x3b0252),document[_0x4f0cd0(0xf17)]('touchmove',_0x32ffd4);};_0x20812c[_0x56e44a(0x501)](_0x56e44a(0x8ce),_0x1bd826),_0x20812c[_0x56e44a(0x501)](_0x56e44a(0x1479),_0x1bd826);}function _0x4d790f(_0x146e49){const _0x8d39d=_0x239c7d,_0x102829=_0x4670b4[_0x146e49];if(!_0x102829)return;const _0x57c289=document[_0x8d39d(0x400)](_0x8d39d(0x5fa)),_0xa390d=document[_0x8d39d(0x400)](_0x8d39d(0xbce)),_0x251a33=document['getElementById']('page-indicator'),_0x210790=document[_0x8d39d(0x400)]('prev-page-btn'),_0x4983dc=document[_0x8d39d(0x400)]('next-page-btn');_0x57c289['textContent']=_0x102829[_0x8d39d(0x647)];if(_0x102829['contentLines'][_0x8d39d(0x8d6)]===0x0)_0xa390d[_0x8d39d(0x1575)]=_0x8d39d(0x941),_0x102829[_0x8d39d(0x7a8)]=0x0,_0x102829[_0x8d39d(0x119d)]=0x0;else{const _0x5e9a14=_0x102829[_0x8d39d(0x119d)]*_0x102829[_0x8d39d(0xc2b)],_0x272b05=_0x5e9a14+_0x102829[_0x8d39d(0xc2b)];_0xa390d[_0x8d39d(0xde7)]=_0x102829['contentLines'][_0x8d39d(0x69f)](_0x5e9a14,_0x272b05)[_0x8d39d(0xee1)]('\x0a');}_0x251a33[_0x8d39d(0xde7)]=_0x102829[_0x8d39d(0x119d)]+0x1+_0x8d39d(0x1371)+_0x102829[_0x8d39d(0x7a8)],_0x210790[_0x8d39d(0x366)]=_0x102829[_0x8d39d(0x119d)]===0x0,_0x4983dc[_0x8d39d(0x366)]=_0x102829[_0x8d39d(0x119d)]>=_0x102829['totalPages']-0x1;}function _0x23f1d9(){const _0x1a3979=_0x239c7d,_0x20639e=_0x4670b4[_0x4c8b14[_0x1a3979(0x1539)]];_0x20639e&&_0x20639e[_0x1a3979(0x119d)]<_0x20639e[_0x1a3979(0x7a8)]-0x1&&(_0x20639e[_0x1a3979(0x119d)]++,_0x4d790f(_0x4c8b14[_0x1a3979(0x1539)]),document['getElementById']('reading-content')[_0x1a3979(0x125c)]=0x0,_0x5a84e5(_0x20639e[_0x1a3979(0x431)],_0x20639e[_0x1a3979(0x119d)]));}async function _0x23879b(){const _0x56d969=_0x239c7d,_0x11fa83=_0x4670b4[_0x4c8b14['activeChatId']];_0x11fa83&&_0x11fa83[_0x56d969(0x119d)]>0x0&&(_0x11fa83[_0x56d969(0x119d)]--,_0x4d790f(_0x4c8b14[_0x56d969(0x1539)]),document[_0x56d969(0x400)](_0x56d969(0xbce))[_0x56d969(0x125c)]=0x0,await _0x5a84e5(_0x11fa83[_0x56d969(0x431)],_0x11fa83['currentPage']),await notifyAiOfPageTurn(_0x4c8b14[_0x56d969(0x1539)],_0x11fa83));}function _0xc320e8(){const _0x2c1e49=_0x239c7d;document[_0x2c1e49(0x400)](_0x2c1e49(0xcdf))['click']();}async function _0x3d630f(_0x3568cd){const _0x544626=_0x239c7d,_0xfd19e1=new Uint8Array(_0x3568cd);if(_0xfd19e1[_0x544626(0x8d6)]>=0x3&&_0xfd19e1[0x0]===0xef&&_0xfd19e1[0x1]===0xbb&&_0xfd19e1[0x2]===0xbf)return console['log'](_0x544626(0xf66)),new TextDecoder(_0x544626(0xb6e))[_0x544626(0x157c)](_0xfd19e1);if(_0xfd19e1[_0x544626(0x8d6)]>=0x2&&_0xfd19e1[0x0]===0xff&&_0xfd19e1[0x1]===0xfe)return console['log']('检测到\x20UTF-16\x20LE\x20BOM，使用\x20UTF-16\x20LE\x20解码。'),new TextDecoder('utf-16le')[_0x544626(0x157c)](_0xfd19e1);if(_0xfd19e1[_0x544626(0x8d6)]>=0x2&&_0xfd19e1[0x0]===0xfe&&_0xfd19e1[0x1]===0xff)return console[_0x544626(0x1e6)](_0x544626(0x1278)),new TextDecoder(_0x544626(0xae7))[_0x544626(0x157c)](_0xfd19e1);try{console[_0x544626(0x1e6)](_0x544626(0x775));const _0x3e0efb=new TextDecoder(_0x544626(0xb6e),{'fatal':!![]})[_0x544626(0x157c)](_0xfd19e1);return console[_0x544626(0x1e6)](_0x544626(0xb79)),_0x3e0efb;}catch(_0x10441d){console[_0x544626(0x1e6)]('UTF-8\x20解码失败，将尝试\x20GBK\x20(ANSI)\x20解码...');try{const _0x417896=new TextDecoder(_0x544626(0x14f5))[_0x544626(0x157c)](_0xfd19e1);return console[_0x544626(0x1e6)](_0x544626(0x1676)),_0x417896;}catch(_0x346dd8){console[_0x544626(0x5d7)](_0x544626(0x895),_0x346dd8);throw new Error('无法识别的文件编码。请尝试将文件转换为\x20UTF-8\x20格式后重新导入。');}}}async function _0x5d5786(_0x5025f2){const _0xfd211f=_0x239c7d,_0x216d70=_0x5025f2[_0xfd211f(0x657)][_0xfd211f(0x780)][0x0];if(!_0x216d70)return;try{const _0x2f22dc=await _0x216d70[_0xfd211f(0xead)](),_0x52ebfe=await _0x3d630f(_0x2f22dc),_0xc3911e=_0x216d70[_0xfd211f(0xf3e)][_0xfd211f(0xe19)](/\.txt$/i,''),_0x5b4c31=await _0x54c587[_0xfd211f(0x144d)]['add']({'title':_0xc3911e,'content':_0x52ebfe,'lastOpened':Date[_0xfd211f(0xecd)]()});await _0x436b8b(_0x5b4c31),document[_0xfd211f(0x400)](_0xfd211f(0x9d1))[_0xfd211f(0xb08)][_0xfd211f(0xd3f)](_0xfd211f(0x9eb))&&_0x50a49e();}catch(_0x5327bc){console[_0xfd211f(0x5d7)](_0xfd211f(0xbf5),_0x5327bc),await _0x138765('导入失败',_0x5327bc[_0xfd211f(0x6e2)]);}finally{_0x5025f2['target'][_0xfd211f(0xa1e)]=null;}}async function _0x2097af(){const _0x2452a6=_0x239c7d,_0x43c899=_0x4c8b14[_0x2452a6(0x1539)];if(!_0x43c899)return;const _0x2f4f3b=_0x4670b4[_0x43c899];if(!_0x2f4f3b||_0x2f4f3b[_0x2452a6(0x7a8)]<=0x1)return;const _0x2d17dd=await _0x25f61f('页面跳转',_0x2452a6(0x10a0)+_0x2f4f3b[_0x2452a6(0x7a8)]+')',_0x2f4f3b[_0x2452a6(0x119d)]+0x1);if(_0x2d17dd===null)return;const _0x284f25=parseInt(_0x2d17dd);if(isNaN(_0x284f25)||_0x284f25<0x1||_0x284f25>_0x2f4f3b[_0x2452a6(0x7a8)]){alert('请输入一个有效的页码！');return;}_0x2f4f3b[_0x2452a6(0x119d)]=_0x284f25-0x1,_0x4d790f(_0x43c899),_0x5a84e5(_0x2f4f3b[_0x2452a6(0x431)],_0x2f4f3b['currentPage']);}async function _0x5a84e5(_0x487a34,_0x4ac5df){const _0xcab55e=_0x239c7d;if(!_0x487a34)return;try{await _0x54c587['readingLibrary'][_0xcab55e(0x126d)](_0x487a34,{'currentPage':_0x4ac5df});}catch(_0x1fc096){console[_0xcab55e(0x5d7)](_0xcab55e(0x5e6)+_0x487a34+_0xcab55e(0x1001),_0x1fc096);}}async function _0x23f1d9(){const _0x4fd213=_0x239c7d,_0x42874b=_0x4670b4[_0x4c8b14[_0x4fd213(0x1539)]];_0x42874b&&_0x42874b[_0x4fd213(0x119d)]<_0x42874b[_0x4fd213(0x7a8)]-0x1&&(_0x42874b['currentPage']++,_0x4d790f(_0x4c8b14[_0x4fd213(0x1539)]),document[_0x4fd213(0x400)]('reading-content')[_0x4fd213(0x125c)]=0x0,await _0x5a84e5(_0x42874b['activeBookId'],_0x42874b['currentPage']),await notifyAiOfPageTurn(_0x4c8b14[_0x4fd213(0x1539)],_0x42874b));}function _0x742432(_0x4535e1,_0x3fe729){const _0x389cf6=_0x239c7d,_0x22ba7d=_0x4c8b14[_0x389cf6(0x1539)];if(!_0x22ba7d)return;const _0xde9ad4=_0x4670b4[_0x22ba7d];_0xde9ad4[_0x389cf6(0x647)]=_0x4535e1[_0x389cf6(0xe19)](/\.txt$/i,''),_0xde9ad4[_0x389cf6(0x98f)]=_0x3fe729['split'](/\r\n?|\n/)[_0x389cf6(0xd18)](_0x37366c=>_0x37366c[_0x389cf6(0xe19)](/ +/g,'\x20')),_0xde9ad4[_0x389cf6(0x7a8)]=Math[_0x389cf6(0x94b)](_0xde9ad4[_0x389cf6(0x98f)][_0x389cf6(0x8d6)]/_0xde9ad4[_0x389cf6(0xc2b)]),_0xde9ad4[_0x389cf6(0x119d)]=0x0,_0x4d790f(_0x22ba7d);}async function _0x4f2c1b(){const _0x34edf1=_0x239c7d;document[_0x34edf1(0x400)](_0x34edf1(0x10b8))['value']='',await _0x50a49e(),document[_0x34edf1(0x400)](_0x34edf1(0x9d1))[_0x34edf1(0xb08)][_0x34edf1(0x12b6)](_0x34edf1(0x9eb));}async function _0x50a49e(_0x21869a=''){const _0x56372f=_0x239c7d,_0x1958b5=document[_0x56372f(0x400)]('reading-library-list');let _0x5d39de=await _0x54c587['readingLibrary']['orderBy'](_0x56372f(0x101d))[_0x56372f(0xfc1)]()[_0x56372f(0xce1)]();_0x1958b5[_0x56372f(0x1575)]='';_0x21869a&&(_0x5d39de=_0x5d39de[_0x56372f(0x29d)](_0x59a1f3=>_0x59a1f3[_0x56372f(0x647)][_0x56372f(0x1653)]()[_0x56372f(0xd1b)](_0x21869a[_0x56372f(0x1653)]())));if(_0x5d39de['length']===0x0){const _0x26d4d5=_0x21869a?'找不到匹配的书籍':_0x56372f(0xf69);_0x1958b5['innerHTML']=_0x56372f(0xce0)+_0x26d4d5+_0x56372f(0x1236);return;}_0x5d39de[_0x56372f(0xbdc)](_0xf21f22=>{const _0x40d129=_0x56372f,_0x5b55f8=document['createElement'](_0x40d129(0xf8e));_0x5b55f8['className']=_0x40d129(0xf94),_0x5b55f8[_0x40d129(0x1575)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22\x20style=\x22cursor:pointer;\x22\x20data-book-id=\x22'+_0xf21f22['id']+'\x22>'+_0xf21f22[_0x40d129(0x647)]+_0x40d129(0xcbb)+_0xf21f22['id']+_0x40d129(0xd62),_0x1958b5[_0x40d129(0x8f2)](_0x5b55f8);});}async function _0x436b8b(_0x31b328){const _0x321c92=_0x239c7d,_0x1da51c=_0x4c8b14['activeChatId'];if(!_0x1da51c)return;const _0x1d28d7=await _0x54c587['readingLibrary']['get'](_0x31b328);if(!_0x1d28d7){alert(_0x321c92(0x7a0));return;}await _0x54c587[_0x321c92(0x144d)][_0x321c92(0x126d)](_0x31b328,{'lastOpened':Date['now']()});const _0x436d57=_0x4670b4[_0x1da51c];_0x436d57[_0x321c92(0x431)]=_0x31b328,_0x436d57['title']=_0x1d28d7[_0x321c92(0x647)],_0x436d57[_0x321c92(0x98f)]=_0x1d28d7[_0x321c92(0x1109)][_0x321c92(0x5ad)](/\r\n?|\n/)[_0x321c92(0xd18)](_0x430359=>_0x430359[_0x321c92(0xe19)](/ +/g,'\x20')),_0x436d57['totalPages']=Math[_0x321c92(0x94b)](_0x436d57[_0x321c92(0x98f)][_0x321c92(0x8d6)]/_0x436d57[_0x321c92(0xc2b)]),_0x436d57[_0x321c92(0x119d)]=_0x1d28d7[_0x321c92(0x119d)]||0x0,_0x4d790f(_0x1da51c),document[_0x321c92(0x400)](_0x321c92(0xbce))[_0x321c92(0x125c)]=0x0,document[_0x321c92(0x400)](_0x321c92(0x9d1))[_0x321c92(0xb08)][_0x321c92(0xc46)](_0x321c92(0x9eb));}async function _0x565afd(_0x499ce2){const _0xedfba=_0x239c7d,_0x49bcb4=await _0x54c587[_0xedfba(0x144d)]['get'](_0x499ce2);if(!_0x49bcb4)return;const _0x290b1c=await _0x56d4d3(_0xedfba(0x1131),_0xedfba(0xc5f)+_0x49bcb4['title']+_0xedfba(0xc11),{'confirmButtonClass':_0xedfba(0x142c)});_0x290b1c&&(await _0x54c587['readingLibrary'][_0xedfba(0x942)](_0x499ce2),await _0x50a49e());}function _0x742432(_0x389958,_0x56c634){const _0x3bc498=_0x239c7d,_0x30fdc2=_0x4c8b14[_0x3bc498(0x1539)];if(!_0x30fdc2)return;const _0x16fb46=_0x4670b4[_0x30fdc2];_0x16fb46['title']=_0x389958[_0x3bc498(0xe19)](/\.txt$/i,''),_0x16fb46[_0x3bc498(0x98f)]=_0x56c634[_0x3bc498(0x5ad)](/\r\n?|\n/),_0x16fb46['totalPages']=Math['ceil'](_0x16fb46[_0x3bc498(0x98f)][_0x3bc498(0x8d6)]/_0x16fb46[_0x3bc498(0xc2b)]),_0x16fb46[_0x3bc498(0x119d)]=0x0,_0x4d790f(_0x30fdc2);}function _0x4aead0(_0x5205f7,_0x10213f){const _0x550eca=_0x239c7d;let _0x373134=0x0,_0xc2835b=0x0,_0x5be017=0x0,_0x4b7a94=0x0,_0x195aa1=![],_0x599210=![];const _0x17d0a4=document[_0x550eca(0x400)](_0x550eca(0x43a)),_0x39c581=_0x13b1fe=>{const _0xacbb1d=_0x550eca;if(_0x5205f7!==_0x10213f&&_0x13b1fe['target']['closest'](_0xacbb1d(0x99b)))return;_0x195aa1=!![],_0x599210=![];const _0x5b4c1f=_0x13b1fe[_0xacbb1d(0xbbf)]===_0xacbb1d(0x1479)?_0x13b1fe[_0xacbb1d(0x567)][0x0]:_0x13b1fe;_0x5be017=_0x5b4c1f[_0xacbb1d(0x13c9)],_0x4b7a94=_0x5b4c1f[_0xacbb1d(0xcc8)],_0x5205f7['style'][_0xacbb1d(0x899)]=_0x5205f7[_0xacbb1d(0xf1b)]+'px',_0x5205f7['style'][_0xacbb1d(0xfef)]=_0x5205f7[_0xacbb1d(0x120e)]+'px',_0x5205f7['style'][_0xacbb1d(0x8ea)]='',document['addEventListener'](_0xacbb1d(0x98c),_0x202cbf),document[_0xacbb1d(0x501)](_0xacbb1d(0x1602),_0x1933fc),document['addEventListener'](_0xacbb1d(0x11bc),_0x202cbf),document['addEventListener'](_0xacbb1d(0x1119),_0x1933fc,{'passive':![]});},_0x1933fc=_0x44a098=>{const _0x3e63a9=_0x550eca;if(!_0x195aa1)return;const _0x1fc57a=_0x44a098[_0x3e63a9(0xbbf)]===_0x3e63a9(0x1119)?_0x44a098[_0x3e63a9(0x567)][0x0]:_0x44a098,_0x58e29e=_0x1fc57a[_0x3e63a9(0x13c9)]-_0x5be017,_0x1f090e=_0x1fc57a[_0x3e63a9(0xcc8)]-_0x4b7a94;!_0x599210&&(Math[_0x3e63a9(0x1396)](_0x58e29e)>0x5||Math[_0x3e63a9(0x1396)](_0x1f090e)>0x5)&&(_0x599210=!![]);_0x599210&&_0x44a098[_0x3e63a9(0x786)]&&_0x44a098[_0x3e63a9(0x92e)]();_0x373134=_0x5be017-_0x1fc57a[_0x3e63a9(0x13c9)],_0xc2835b=_0x4b7a94-_0x1fc57a[_0x3e63a9(0xcc8)],_0x5be017=_0x1fc57a['clientX'],_0x4b7a94=_0x1fc57a[_0x3e63a9(0xcc8)];let _0x44c293=_0x5205f7[_0x3e63a9(0xf1b)]-_0xc2835b,_0x9537f5=_0x5205f7[_0x3e63a9(0x120e)]-_0x373134;const _0x4f5b2b=_0x17d0a4[_0x3e63a9(0x433)]-_0x5205f7[_0x3e63a9(0x1134)]-0xa,_0x1ccf6c=_0x17d0a4[_0x3e63a9(0x13aa)]-_0x5205f7[_0x3e63a9(0xeeb)]-0xa;_0x44c293=Math[_0x3e63a9(0x124e)](0xa,Math['min'](_0x44c293,_0x4f5b2b)),_0x9537f5=Math[_0x3e63a9(0x124e)](0xa,Math['min'](_0x9537f5,_0x1ccf6c)),_0x5205f7[_0x3e63a9(0xa00)]['top']=_0x44c293+'px',_0x5205f7['style'][_0x3e63a9(0xfef)]=_0x9537f5+'px';},_0x202cbf=()=>{const _0x1918a7=_0x550eca;document[_0x1918a7(0xf17)]('mouseup',_0x202cbf),document[_0x1918a7(0xf17)](_0x1918a7(0x1602),_0x1933fc),document['removeEventListener'](_0x1918a7(0x11bc),_0x202cbf),document[_0x1918a7(0xf17)](_0x1918a7(0x1119),_0x1933fc);if(!_0x195aa1)return;_0x195aa1=![],!_0x599210&&_0x5205f7['click']();};_0x10213f[_0x550eca(0x501)]('mousedown',_0x39c581),_0x10213f['addEventListener']('touchstart',_0x39c581,{'passive':![]});}function _0x5a9463(){const _0x52d29e=_0x239c7d,_0x1b43a9=_0x4670b4[_0x4c8b14['activeChatId']];if(!_0x1b43a9||!_0x1b43a9[_0x52d29e(0x11e7)])return;document[_0x52d29e(0x400)]('reading-window')['classList'][_0x52d29e(0x12b6)](_0x52d29e(0xf51)),document[_0x52d29e(0x400)](_0x52d29e(0x233))['style'][_0x52d29e(0xb1a)]=_0x52d29e(0x375),_0x1b43a9[_0x52d29e(0x6b9)]=!![];}function _0x53d450(){const _0x2b6c9a=_0x239c7d,_0x5ddba9=_0x4670b4[_0x4c8b14[_0x2b6c9a(0x1539)]];if(!_0x5ddba9||!_0x5ddba9['isActive'])return;document['getElementById'](_0x2b6c9a(0x233))[_0x2b6c9a(0xa00)][_0x2b6c9a(0xb1a)]='none',document[_0x2b6c9a(0x400)](_0x2b6c9a(0xe26))[_0x2b6c9a(0xb08)][_0x2b6c9a(0xc46)](_0x2b6c9a(0xf51)),_0x5ddba9[_0x2b6c9a(0x6b9)]=![];}function _0x417d62(_0x839e75,_0xddc408){let _0x53845b;return function(..._0x3d44c2){const _0x1c2b02=_0x466f,_0x360d9a=this;clearTimeout(_0x53845b),_0x53845b=setTimeout(()=>_0x839e75[_0x1c2b02(0x922)](_0x360d9a,_0x3d44c2),_0xddc408);};}function _0x231df1(_0x4b71d9){const _0x35d1e3=_0x239c7d,_0x3f1bc6=_0x4670b4[_0x4b71d9];if(!_0x3f1bc6||!_0x3f1bc6[_0x35d1e3(0x11e7)])return'';const _0x55fc88=_0x3f1bc6[_0x35d1e3(0x647)]||_0x35d1e3(0x936);let _0x4a9d62='',_0x4a4a22='';if(_0x3f1bc6[_0x35d1e3(0x781)]&&_0x3f1bc6[_0x35d1e3(0x781)][_0x35d1e3(0xb8f)]())_0x4a9d62=_0x3f1bc6[_0x35d1e3(0x781)],_0x4a4a22='你正在阅读的段落';else{if(_0x3f1bc6['contentLines'][_0x35d1e3(0x8d6)]>0x0){const _0x53ac80=_0x3f1bc6[_0x35d1e3(0x119d)]*_0x3f1bc6[_0x35d1e3(0xc2b)],_0x46b999=_0x53ac80+_0x3f1bc6[_0x35d1e3(0xc2b)];_0x4a9d62=_0x3f1bc6[_0x35d1e3(0x98f)][_0x35d1e3(0x69f)](_0x53ac80,_0x46b999)['join']('\x0a')[_0x35d1e3(0x371)](0x0,0xc8),_0x4a4a22='当前页内容摘要';}else _0x4a9d62='(无内容)',_0x4a4a22='内容';}return _0x35d1e3(0xe7b)+_0x55fc88+_0x35d1e3(0x5bb)+_0x4a4a22+_0x35d1e3(0x416)+_0x4a9d62+'...\x22\x0a\x20\x20\x20\x20#一起读书模式\x20|\x20行为铁律\x0a\x20\x20\x20\x201.\x20\x20**角色定位**:\x20你【不是】书中的任何角色，你是【你自己】('+(_0x4c8b14['chats'][_0x4b71d9]?.['originalName']||_0x35d1e3(0x164f))+_0x35d1e3(0x13fa);}function _0x35fcc8(){const _0x432ab8=_0x239c7d,_0x29e87d=_0x4c8b14[_0x432ab8(0x1539)];if(!_0x29e87d||!_0x4670b4[_0x29e87d])return;const _0x3b66de=_0x4670b4[_0x29e87d],_0x58b787=document['getElementById'](_0x432ab8(0xbce)),_0x549e84=_0x58b787[_0x432ab8(0x125c)],_0xd82e34=_0x58b787[_0x432ab8(0x433)],_0x4f212f=_0x549e84+_0xd82e34,_0xaf0dba=0xf*1.8,_0x4e70d7=Math['floor'](_0x549e84/_0xaf0dba),_0x3eb87f=Math[_0x432ab8(0x94b)](_0x4f212f/_0xaf0dba),_0x52beca=_0x3b66de['currentPage']*_0x3b66de[_0x432ab8(0xc2b)]+_0x4e70d7,_0x2503fe=_0x3b66de['currentPage']*_0x3b66de[_0x432ab8(0xc2b)]+_0x3eb87f;if(_0x52beca<0x0||_0x52beca>=_0x3b66de['contentLines']['length'])return;const _0xbb7a92=_0x3b66de['contentLines'][_0x432ab8(0x69f)](Math[_0x432ab8(0x124e)](0x0,_0x52beca),Math[_0x432ab8(0xaeb)](_0x3b66de[_0x432ab8(0x98f)][_0x432ab8(0x8d6)],_0x2503fe))[_0x432ab8(0xee1)]('\x0a');_0x3b66de['currentSnippet']=_0xbb7a92;}function _0x2f83fc(){const _0x21f4f5=_0x239c7d,_0x10d345=document[_0x21f4f5(0x400)](_0x21f4f5(0xaad));if(_0x10d345){const _0x2b052d=_0x10d345[_0x21f4f5(0x582)]();_0x2b052d!==undefined&&_0x2b052d[_0x21f4f5(0xa8b)](_0x2d3a49=>{const _0x3f8846=_0x21f4f5;console[_0x3f8846(0x1e6)](_0x3f8846(0x14bc));})['catch'](_0x125695=>{const _0x4f2987=_0x21f4f5;console['warn'](_0x4f2987(0x10d1),_0x125695);});}}function _0x3ebf71(){const _0x1e8c90=_0x239c7d,_0x2edbeb=document[_0x1e8c90(0x400)]('silent-audio-player');_0x2edbeb&&!_0x2edbeb['paused']&&(_0x2edbeb[_0x1e8c90(0x1385)](),_0x2edbeb[_0x1e8c90(0x1592)]=0x0,console['log']('静音音频已停止。'));}async function _0x4bf547(_0x270cf6){const _0x1c5d87=_0x239c7d,_0x463c7e=decodeURIComponent(_0x270cf6[_0x1c5d87(0xd61)][_0x1c5d87(0x117f)]),_0x3bde43=_0x270cf6['dataset']['voiceId'],_0x2a8e52=_0x270cf6[_0x1c5d87(0x13ef)](_0x1c5d87(0x765)),_0x12802e=_0x270cf6['querySelector'](_0x1c5d87(0x25f)),_0x28d3bc=document[_0x1c5d87(0x400)](_0x1c5d87(0x12dc));if(!_0x28d3bc['paused']&&_0x28d3bc['dataset']['currentText']===_0x463c7e&&_0x28d3bc['dataset'][_0x1c5d87(0x151b)]===_0x3bde43){_0x28d3bc[_0x1c5d87(0x1385)]();return;}_0x28d3bc['pause'](),document[_0x1c5d87(0x527)](_0x1c5d87(0x765))[_0x1c5d87(0xbdc)](_0x15f76a=>_0x15f76a[_0x1c5d87(0xde7)]='▶');const _0x2c1e23='tts_'+_0x3bde43+'_'+_0x463c7e;let _0x3321d8=_0x4c8b14[_0x1c5d87(0x15b2)][_0x1c5d87(0xf48)](_0x2c1e23);if(_0x3321d8){console[_0x1c5d87(0x1e6)](_0x1c5d87(0xf30)),await _0x41d6a0(_0x3321d8[_0x1c5d87(0x299)],_0x3321d8[_0x1c5d87(0xbbf)],_0x463c7e,_0x3bde43,_0x270cf6);return;}console[_0x1c5d87(0x1e6)](_0x1c5d87(0xd42));if(_0x2a8e52)_0x2a8e52[_0x1c5d87(0xa00)][_0x1c5d87(0xb1a)]='none';_0x12802e[_0x1c5d87(0xa00)][_0x1c5d87(0xb1a)]=_0x1c5d87(0x1181);const {minimaxGroupId:_0x535e15,minimaxApiKey:_0xd2e202}=_0x4c8b14['apiConfig'];if(!_0x535e15||!_0xd2e202){await _0x138765(_0x1c5d87(0xb4e),_0x1c5d87(0x803)),_0x12802e[_0x1c5d87(0xa00)][_0x1c5d87(0xb1a)]=_0x1c5d87(0x165b);if(_0x2a8e52)_0x2a8e52[_0x1c5d87(0xa00)]['display']=_0x1c5d87(0x375);return;}try{const _0x2cebf4=await fetch('https://api.minimax.chat/v1/text_to_speech?GroupId='+_0x535e15,{'method':'POST','headers':{'Authorization':_0x1c5d87(0xcee)+_0xd2e202,'Content-Type':_0x1c5d87(0xfae)},'body':JSON[_0x1c5d87(0xea5)]({'text':_0x463c7e,'voice_id':_0x3bde43,'model':_0x4c8b14[_0x1c5d87(0x814)]['minimaxModel']||_0x1c5d87(0x37c),'speed':0x1,'vol':0x1,'pitch':0x0})});if(!_0x2cebf4['ok']){let _0x55f73b=_0x1c5d87(0xeca)+_0x2cebf4[_0x1c5d87(0x12c3)];try{const _0x1ce271=await _0x2cebf4[_0x1c5d87(0x15d3)]();_0x55f73b=_0x1ce271[_0x1c5d87(0x15b9)]?.[_0x1c5d87(0x5a9)]||JSON[_0x1c5d87(0xea5)](_0x1ce271);}catch(_0x433a47){_0x55f73b=await _0x2cebf4['text']();}throw new Error(_0x55f73b);}const _0x5d9e9d=await _0x2cebf4['blob'](),_0x1e8b43=URL[_0x1c5d87(0xc2c)](_0x5d9e9d);await _0x41d6a0(_0x1e8b43,_0x5d9e9d[_0x1c5d87(0xbbf)],_0x463c7e,_0x3bde43,_0x270cf6);const _0x5822ad=new FileReader();_0x5822ad[_0x1c5d87(0x8d1)]=function(){const _0x2c418e=_0x1c5d87;_0x4c8b14[_0x2c418e(0x15b2)][_0x2c418e(0xfa3)](_0x2c1e23,{'url':_0x5822ad[_0x2c418e(0xdd1)],'type':_0x5d9e9d[_0x2c418e(0xbbf)]}),console[_0x2c418e(0x1e6)]('TTS\x20音频已保存到缓存。');},_0x5822ad[_0x1c5d87(0x157f)](_0x5d9e9d);}catch(_0x9dfbf6){console[_0x1c5d87(0x5d7)]('Minimax\x20TTS\x20API\x20调用失败:',_0x9dfbf6),await _0x138765(_0x1c5d87(0x12f1),'错误:\x20'+_0x9dfbf6[_0x1c5d87(0x6e2)]);}finally{_0x12802e[_0x1c5d87(0xa00)]['display']=_0x1c5d87(0x165b);if(_0x2a8e52)_0x2a8e52[_0x1c5d87(0xa00)][_0x1c5d87(0xb1a)]='flex';}}function _0x41d6a0(_0xb0a288,_0x254535,_0x1124f3,_0x11fb14,_0x13bb2e){return new Promise((_0x50d504,_0x24e537)=>{const _0x1c5ea2=_0x466f,_0x3817ee=document[_0x1c5ea2(0x400)](_0x1c5ea2(0x12dc));_0x3817ee[_0x1c5ea2(0x912)]=_0xb0a288,_0x3817ee['type']=_0x254535,_0x3817ee[_0x1c5ea2(0xd61)]['currentText']=_0x1124f3,_0x3817ee[_0x1c5ea2(0xd61)][_0x1c5ea2(0x151b)]=_0x11fb14;const _0x5c86fb=_0x3817ee[_0x1c5ea2(0x582)]();_0x5c86fb!==undefined&&_0x5c86fb[_0x1c5ea2(0xa8b)](()=>{const _0xd49312=_0x1c5ea2,_0x295c28=_0x13bb2e[_0xd49312(0x13ef)](_0xd49312(0x765));if(_0x295c28)_0x295c28[_0xd49312(0xde7)]='❚❚';_0x50d504();})['catch'](_0x53382b=>{const _0xff0098=_0x1c5ea2;console[_0xff0098(0x5d7)](_0xff0098(0x12c5),_0x53382b),_0x24e537(_0x53382b);}),_0x3817ee[_0x1c5ea2(0x10f0)]=()=>{const _0x32b035=_0x1c5ea2,_0xc57a8f=_0x13bb2e[_0x32b035(0x13ef)]('.voice-play-btn');if(_0xc57a8f)_0xc57a8f[_0x32b035(0xde7)]='▶';},_0x3817ee[_0x1c5ea2(0x10e2)]=()=>{const _0x35ed31=_0x1c5ea2,_0x4169b7=_0x13bb2e['querySelector'](_0x35ed31(0x765));if(_0x4169b7)_0x4169b7['textContent']='▶';};});}function _0x17328d(_0x2a2a2c){const _0x1c72c9=_0x239c7d,_0x446671=_0x2a2a2c[_0x1c72c9(0x117a)]('.message-bubble');if(!_0x446671)return;const _0xac77fa=_0x446671[_0x1c72c9(0x13ef)](_0x1c72c9(0xe85)),_0x3925ef=decodeURIComponent(_0x2a2a2c[_0x1c72c9(0xd61)][_0x1c72c9(0x117f)]);_0xac77fa[_0x1c72c9(0xa00)]['display']===_0x1c72c9(0x1181)?_0xac77fa['style'][_0x1c72c9(0xb1a)]='none':(_0xac77fa['textContent']=_0x3925ef,_0xac77fa[_0x1c72c9(0xa00)][_0x1c72c9(0xb1a)]=_0x1c72c9(0x1181));}async function _0x17a4e6(){const _0x2e845a=_0x239c7d;await _0x1f22b5(),document[_0x2e845a(0x400)]('product-category-manager-modal')[_0x2e845a(0xb08)][_0x2e845a(0x12b6)](_0x2e845a(0x9eb));}async function _0x1f22b5(){const _0x161ac9=_0x239c7d,_0x1f69d3=document['getElementById']('existing-product-categories-list'),_0x3645ef=await _0x54c587[_0x161ac9(0xd21)][_0x161ac9(0xce1)]();_0x1f69d3[_0x161ac9(0x1575)]='';if(_0x3645ef['length']===0x0){_0x1f69d3[_0x161ac9(0x1575)]='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>';return;}_0x3645ef['forEach'](_0x24a073=>{const _0x12f676=_0x161ac9,_0x46f4cc=document[_0x12f676(0x2c9)](_0x12f676(0xf8e));_0x46f4cc[_0x12f676(0x4e1)]='existing-group-item',_0x46f4cc[_0x12f676(0x1575)]=_0x12f676(0xb18)+_0x24a073['name']+_0x12f676(0xaed)+_0x24a073['id']+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x1f69d3['appendChild'](_0x46f4cc);});}async function _0xe96055(){const _0x23b0c6=_0x239c7d,_0x1ae1f8=document[_0x23b0c6(0x400)](_0x23b0c6(0x9b5)),_0x397f1b=_0x1ae1f8['value'][_0x23b0c6(0xb8f)]();if(!_0x397f1b)return alert(_0x23b0c6(0x403));const _0x2a91e6=await _0x54c587['shoppingCategories'][_0x23b0c6(0x227)](_0x23b0c6(0xf3e))[_0x23b0c6(0x4ce)](_0x397f1b)[_0x23b0c6(0x149c)]();if(_0x2a91e6)return alert('分类\x20\x22'+_0x397f1b+_0x23b0c6(0x1456));await _0x54c587['shoppingCategories']['add']({'name':_0x397f1b}),_0x1ae1f8[_0x23b0c6(0xa1e)]='',await _0x1f22b5();}async function _0x23bc34(_0x3693cc){const _0x151b54=_0x239c7d,_0x1d1fef=await _0x56d4d3('确认删除',_0x151b54(0xaef),{'confirmButtonClass':_0x151b54(0x142c)});_0x1d1fef&&(await _0x54c587[_0x151b54(0xd21)][_0x151b54(0x942)](_0x3693cc),await _0x54c587['shoppingProducts'][_0x151b54(0x227)](_0x151b54(0x12c4))[_0x151b54(0x4ce)](_0x3693cc)[_0x151b54(0x832)]({'categoryId':null}),await _0x1f22b5());}function _0x1ae5b9(_0x50c824={}){const _0x1d751a=_0x239c7d,_0x270a84=document[_0x1d751a(0x400)]('product-variations-container'),_0x308a9b=document['createElement'](_0x1d751a(0xf8e));return _0x308a9b['className']=_0x1d751a(0x2c4),_0x308a9b[_0x1d751a(0x1575)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此款式\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x201fr;\x20gap:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式名称</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22variation-name-input\x22\x20placeholder=\x22例如:\x20红色\x22\x20value=\x22'+(_0x50c824[_0x1d751a(0xf3e)]||'')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>价格\x20(元)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20class=\x22variation-price-input\x22\x20min=\x220\x22\x20step=\x220.01\x22\x20value=\x22'+(_0x50c824[_0x1d751a(0x34a)]||'')+_0x1d751a(0x3cf)+(_0x50c824[_0x1d751a(0x1436)]||_0x1d751a(0xa17))+_0x1d751a(0xd25),_0x308a9b[_0x1d751a(0x13ef)]('.delete-block-btn')['addEventListener']('click',()=>_0x308a9b[_0x1d751a(0xc46)]()),_0x308a9b[_0x1d751a(0x13ef)]('.upload-variation-image-btn')[_0x1d751a(0x501)](_0x1d751a(0x15ad),()=>{const _0x48dd87=_0x1d751a;_0x308a9b[_0x48dd87(0x13ef)](_0x48dd87(0xe2c))['click']();}),_0x308a9b[_0x1d751a(0x13ef)](_0x1d751a(0xe2c))['addEventListener'](_0x1d751a(0x866),_0x198133=>{const _0x2f5744=_0x1d751a,_0x534950=_0x198133[_0x2f5744(0x657)][_0x2f5744(0x780)][0x0];if(_0x534950){const _0xaf8dda=new FileReader();_0xaf8dda[_0x2f5744(0x9e0)]=_0x1493fe=>{const _0x22b164=_0x2f5744;_0x308a9b['querySelector'](_0x22b164(0x1435))['src']=_0x1493fe[_0x22b164(0x657)][_0x22b164(0xdd1)];},_0xaf8dda[_0x2f5744(0x157f)](_0x534950);}}),_0x270a84[_0x1d751a(0x8f2)](_0x308a9b),_0x308a9b;}async function _0x6c8604(_0x290b06){const _0x1cf359=_0x239c7d,_0x490d4d=await _0x54c587[_0x1cf359(0x28c)][_0x1cf359(0xf48)](_0x290b06);if(!_0x490d4d||!_0x490d4d[_0x1cf359(0x1566)]||_0x490d4d[_0x1cf359(0x1566)][_0x1cf359(0x8d6)]===0x0)return;const _0x374c38=document[_0x1cf359(0x400)](_0x1cf359(0xa2c));document[_0x1cf359(0x400)](_0x1cf359(0xeec))[_0x1cf359(0x912)]=_0x490d4d[_0x1cf359(0x1436)],document[_0x1cf359(0x400)]('variation-product-name')[_0x1cf359(0xde7)]=_0x490d4d[_0x1cf359(0xf3e)];const _0x453789=document[_0x1cf359(0x400)]('variation-options-container');_0x453789[_0x1cf359(0x1575)]='',_0x490d4d[_0x1cf359(0x1566)][_0x1cf359(0xbdc)]((_0x342880,_0x222df5)=>{const _0x3c7475=_0x1cf359,_0x1462cb=document[_0x3c7475(0x2c9)](_0x3c7475(0x10a8));_0x1462cb[_0x3c7475(0xbbf)]=_0x3c7475(0x4a2),_0x1462cb[_0x3c7475(0xf3e)]=_0x3c7475(0xe92),_0x1462cb['id']=_0x3c7475(0xada)+_0x290b06+'-'+_0x222df5,_0x1462cb[_0x3c7475(0xa1e)]=_0x222df5,_0x1462cb[_0x3c7475(0xa00)][_0x3c7475(0xb1a)]=_0x3c7475(0x165b);if(_0x222df5===0x0)_0x1462cb['checked']=!![];const _0x3ca646=document[_0x3c7475(0x2c9)](_0x3c7475(0xf6c));_0x3ca646['htmlFor']='var-'+_0x290b06+'-'+_0x222df5,_0x3ca646[_0x3c7475(0xde7)]=_0x342880[_0x3c7475(0xf3e)],_0x3ca646[_0x3c7475(0xa00)][_0x3c7475(0x32e)]=_0x3c7475(0x9ba),_0x453789[_0x3c7475(0x8f2)](_0x1462cb),_0x453789[_0x3c7475(0x8f2)](_0x3ca646);});const _0x3352f8=()=>{const _0x306f28=_0x1cf359,_0x3d76f0=_0x453789[_0x306f28(0x13ef)](_0x306f28(0x545));_0x453789[_0x306f28(0x527)](_0x306f28(0xf6c))['forEach'](_0xf5126=>{const _0x568175=_0x306f28;_0xf5126[_0x568175(0xa00)][_0x568175(0x20c)]=_0x568175(0x14d5),_0xf5126[_0x568175(0xa00)][_0x568175(0x168d)]=_0x568175(0xa01),_0xf5126[_0x568175(0xa00)][_0x568175(0x1296)]=_0x568175(0xd68);});if(_0x3d76f0){const _0x182df4=_0x453789[_0x306f28(0x13ef)](_0x306f28(0xb6f)+_0x3d76f0['id']+'\x22]');_0x182df4[_0x306f28(0xa00)][_0x306f28(0x20c)]=_0x306f28(0x13d2),_0x182df4[_0x306f28(0xa00)][_0x306f28(0x168d)]=_0x306f28(0x13d2),_0x182df4[_0x306f28(0xa00)][_0x306f28(0x1296)]=_0x306f28(0x752);const _0x1482c9=_0x490d4d['variations'][parseInt(_0x3d76f0[_0x306f28(0xa1e)])];document['getElementById'](_0x306f28(0x156e))[_0x306f28(0xde7)]='¥'+_0x1482c9[_0x306f28(0x34a)][_0x306f28(0x2ea)](0x2),_0x1482c9[_0x306f28(0x1436)]?document[_0x306f28(0x400)]('variation-product-image')['src']=_0x1482c9[_0x306f28(0x1436)]:document[_0x306f28(0x400)]('variation-product-image')['src']=_0x490d4d['imageUrl'];}};_0x453789[_0x1cf359(0x501)]('change',_0x3352f8),_0x3352f8(),document['getElementById'](_0x1cf359(0x2ae))[_0x1cf359(0xde7)]='1';const _0x598eec=document['getElementById'](_0x1cf359(0x111a)),_0x1ce645=_0x598eec[_0x1cf359(0xdbc)](!![]);_0x598eec[_0x1cf359(0xa54)]['replaceChild'](_0x1ce645,_0x598eec),_0x1ce645[_0x1cf359(0x501)](_0x1cf359(0x15ad),async()=>{const _0x5a40e2=_0x1cf359,_0x1fb2cf=_0x453789[_0x5a40e2(0x13ef)]('input[name=\x22variation-select\x22]:checked'),_0x18d203=parseInt(document[_0x5a40e2(0x400)](_0x5a40e2(0x2ae))[_0x5a40e2(0xde7)]);if(_0x1fb2cf){const _0x45a66a=_0x490d4d[_0x5a40e2(0x1566)][parseInt(_0x1fb2cf[_0x5a40e2(0xa1e)])];await _0x1e8c95(_0x290b06,_0x18d203,_0x45a66a),_0x374c38['classList'][_0x5a40e2(0xc46)](_0x5a40e2(0x9eb)),await _0x138765('成功',_0x5a40e2(0x1303));}}),_0x374c38[_0x1cf359(0xb08)][_0x1cf359(0x12b6)]('visible');}function _0x483ffc(){const _0x366c7c=_0x239c7d,_0x38b3ef=document[_0x366c7c(0x400)]('shopping-settings-modal');document[_0x366c7c(0x400)](_0x366c7c(0x15aa))[_0x366c7c(0xa1e)]=_0x4c8b14['globalSettings'][_0x366c7c(0x10a1)]||0x3,document[_0x366c7c(0x400)](_0x366c7c(0xd63))[_0x366c7c(0xa1e)]=_0x4c8b14[_0x366c7c(0x14f1)][_0x366c7c(0x506)]||0x8,_0x38b3ef[_0x366c7c(0xb08)][_0x366c7c(0x12b6)]('visible');}async function _0x5cd3af(){const _0x27fc62=_0x239c7d,_0x2038d0=document[_0x27fc62(0x400)]('shopping-category-count-input'),_0x4f00ba=document[_0x27fc62(0x400)](_0x27fc62(0xd63)),_0x157c14=parseInt(_0x2038d0['value']),_0x2c0db0=parseInt(_0x4f00ba[_0x27fc62(0xa1e)]);if(isNaN(_0x157c14)||isNaN(_0x2c0db0)||_0x157c14<0x1||_0x2c0db0<0x1){alert(_0x27fc62(0xdad));return;}_0x4c8b14['globalSettings'][_0x27fc62(0x10a1)]=_0x157c14,_0x4c8b14['globalSettings']['shoppingProductCount']=_0x2c0db0,await _0x54c587[_0x27fc62(0x14f1)][_0x27fc62(0x4cb)](_0x4c8b14[_0x27fc62(0x14f1)]),document[_0x27fc62(0x400)]('shopping-settings-modal')[_0x27fc62(0xb08)]['remove'](_0x27fc62(0x9eb)),await _0x138765(_0x27fc62(0xd20),_0x27fc62(0xaa8));}async function _0x2c0996(){const _0x49d03c=_0x239c7d;if(!_0x4c8b14['activeChatId']){await _0x138765(_0x49d03c(0x12cb),_0x49d03c(0xcff));return;}const _0x41bf74=_0x4c8b14['chats'][_0x4c8b14[_0x49d03c(0x1539)]],_0xd2a3d9=await _0x56d4d3('为“'+_0x41bf74[_0x49d03c(0xf3e)]+'”生成商品？',_0x49d03c(0x50b),{'confirmText':_0x49d03c(0x124b)});if(!_0xd2a3d9)return;await _0x138765(_0x49d03c(0x13e9),_0x49d03c(0x15f3)+_0x41bf74[_0x49d03c(0xf3e)]+_0x49d03c(0x698));const _0x427645=_0x4c8b14[_0x49d03c(0x814)][_0x49d03c(0x12ee)]&&_0x4c8b14[_0x49d03c(0x814)][_0x49d03c(0x888)]&&_0x4c8b14[_0x49d03c(0x814)][_0x49d03c(0xa22)],{proxyUrl:_0x18bc90,apiKey:_0x24e699,model:_0x3be09f}=_0x427645?{'proxyUrl':_0x4c8b14[_0x49d03c(0x814)][_0x49d03c(0x12ee)],'apiKey':_0x4c8b14[_0x49d03c(0x814)]['secondaryApiKey'],'model':_0x4c8b14['apiConfig']['secondaryModel']}:_0x4c8b14[_0x49d03c(0x814)];if(!_0x18bc90||!_0x24e699||!_0x3be09f){await _0x138765('API未配置','请先在API设置中配置好（主或副）API。');return;}const _0x2262af=_0x4c8b14[_0x49d03c(0x14f1)][_0x49d03c(0x10a1)]||0x3,_0x26e08e=_0x4c8b14['globalSettings'][_0x49d03c(0x506)]||0x8,_0x2d833f=await _0x54c587[_0x49d03c(0xd21)]['toArray']();let _0x448af5='';_0x2d833f[_0x49d03c(0x8d6)]>0x0&&(_0x448af5='\x0a#\x20【分类复用铁律\x20(最高优先级！)】\x0a在为新商品指定分类时，你【必须】首先检查下面的“已有分类列表”。\x0a-\x20\x20\x20如果一个新商品可以被归入某个【已存在的分类】，你【必须】复用那个分类的名称，而不是创造一个相似的新分类！\x0a-\x20\x20\x20只有当你确定商品【绝对】不属于任何一个已有分类时，你才能创造一个新的分类名称。\x0a-\x20\x20\x20**已有分类列表**:\x20['+_0x2d833f['map'](_0x4e8f95=>'\x22'+_0x4e8f95[_0x49d03c(0xf3e)]+'\x22')[_0x49d03c(0xee1)](',\x20')+']\x0a');const _0x387e04=_0x4c8b14['qzoneSettings'][_0x49d03c(0xbf3)]||'我',_0x5da20b=_0x41bf74[_0x49d03c(0x1600)]&&_0x41bf74[_0x49d03c(0x1600)][_0x49d03c(0x8d6)]>0x0?_0x41bf74[_0x49d03c(0x1600)][_0x49d03c(0xd18)](_0x5cbdee=>_0x49d03c(0x1ee)+_0x4878ba(_0x5cbdee[_0x49d03c(0x287)])+')\x20'+_0x5cbdee[_0x49d03c(0x1109)])[_0x49d03c(0xee1)]('\x0a'):'无',_0x3a084f=_0x41bf74[_0x49d03c(0x92c)][_0x49d03c(0x69f)](-0xa)[_0x49d03c(0xd18)](_0x2aaaae=>(_0x2aaaae[_0x49d03c(0x71a)]===_0x49d03c(0x6d6)?_0x387e04:_0x41bf74[_0x49d03c(0xf3e)])+':\x20'+String(_0x2aaaae['content'])[_0x49d03c(0x371)](0x0,0x1e)+_0x49d03c(0x166b))[_0x49d03c(0xee1)]('\x0a');let _0x19675b='';if(_0x41bf74[_0x49d03c(0xa37)][_0x49d03c(0xb0d)]&&_0x41bf74[_0x49d03c(0xa37)]['linkedWorldBookIds']['length']>0x0){const _0x586b29=_0x41bf74['settings']['linkedWorldBookIds']['map'](_0xfbb40f=>{const _0x562fb5=_0x49d03c,_0x59b276=_0x4c8b14['worldBooks']['find'](_0x2df6ed=>_0x2df6ed['id']===_0xfbb40f);if(!_0x59b276||!Array[_0x562fb5(0x16a1)](_0x59b276[_0x562fb5(0x1109)]))return'';const _0x486e73=_0x59b276[_0x562fb5(0x1109)]['filter'](_0xacb7ad=>_0xacb7ad[_0x562fb5(0x250)]!==![])[_0x562fb5(0xd18)](_0x543fc6=>'-\x20'+_0x543fc6['content'])[_0x562fb5(0xee1)]('\x0a');return _0x486e73?'\x0a##\x20来自《'+_0x59b276[_0x562fb5(0xf3e)]+'》:\x0a'+_0x486e73:'';})[_0x49d03c(0x29d)](Boolean)[_0x49d03c(0xee1)]('');_0x586b29&&(_0x19675b=_0x49d03c(0x3ad)+_0x586b29+'\x0a');}const _0x56f39e='\x0a#\x20你的任务\x0a你是一个虚拟的、极具创造力的商品规划师。你的任务是为下面的角色“'+_0x41bf74[_0x49d03c(0xf3e)]+_0x49d03c(0x23e)+_0x2262af+'\x20个分类。\x0a\x20\x20\x20\x20-\x20**products**:\x20每个分类下生成\x20'+_0x26e08e+_0x49d03c(0xb07)+_0x41bf74['name']+_0x49d03c(0x200)+_0x41bf74[_0x49d03c(0xa37)][_0x49d03c(0xfea)]+_0x49d03c(0x91c)+_0x5da20b+_0x49d03c(0x1247)+_0x19675b+'\x0a'+_0x448af5+_0x49d03c(0x655)+_0x3a084f+_0x49d03c(0x939)+_0x41bf74[_0x49d03c(0xf3e)]+'”生成这组【与角色高度相关】的商品数据。';try{const _0x4a897b=[{'role':_0x49d03c(0x6d6),'content':_0x49d03c(0x661)}];let _0x47665e=_0x18bc90[_0x49d03c(0xd1b)]('generativelanguage'),_0x2d939b=_0x3914a6(_0x3be09f,_0x24e699,_0x56f39e,_0x4a897b);const _0x386f69=_0x47665e?await fetch(_0x2d939b[_0x49d03c(0x299)],_0x2d939b[_0x49d03c(0x55b)]):await fetch(_0x18bc90+'/v1/chat/completions',{'method':_0x49d03c(0x953),'headers':{'Content-Type':_0x49d03c(0xfae),'Authorization':_0x49d03c(0xcee)+_0x24e699},'body':JSON[_0x49d03c(0xea5)]({'model':_0x3be09f,'messages':[{'role':'system','content':_0x56f39e},..._0x4a897b],'temperature':_0x4c8b14[_0x49d03c(0x14f1)][_0x49d03c(0x216)]||0.9})});if(!_0x386f69['ok'])throw new Error(_0x49d03c(0x7d5)+_0x386f69[_0x49d03c(0x755)]);const _0x1dfcf7=await _0x386f69[_0x49d03c(0x15d3)](),_0x26b494=getGeminiResponseText(_0x1dfcf7),_0x1d50c=_0x26b494[_0x49d03c(0xbf7)](/({[\s\S]*})/);if(!_0x1d50c)throw new Error(_0x49d03c(0xad9));const _0x40560a=JSON[_0x49d03c(0x13f7)](_0x1d50c[0x0]);if(!_0x40560a[_0x49d03c(0x1350)]||!Array[_0x49d03c(0x16a1)](_0x40560a[_0x49d03c(0x1350)]))throw new Error(_0x49d03c(0x2e7));await _0x54c587['transaction']('rw',_0x54c587['shoppingProducts'],_0x54c587['shoppingCategories'],async()=>{const _0x32ccfc=_0x49d03c;for(const _0x410398 of _0x40560a[_0x32ccfc(0x1350)]){let _0x3fb616;const _0x56044a=await _0x54c587[_0x32ccfc(0xd21)][_0x32ccfc(0x227)](_0x32ccfc(0xf3e))[_0x32ccfc(0xad5)](_0x410398[_0x32ccfc(0xf3e)])[_0x32ccfc(0x149c)]();_0x56044a?_0x3fb616=_0x56044a['id']:_0x3fb616=await _0x54c587[_0x32ccfc(0xd21)]['add']({'name':_0x410398['name']});const _0x517512=_0x410398[_0x32ccfc(0x5eb)][_0x32ccfc(0xd18)](_0x5bd472=>{const _0x47fa4d=_0x32ccfc;return{'name':_0x5bd472['name'],'price':_0x5bd472['price']||0x0,'description':_0x5bd472[_0x47fa4d(0x12a5)]||'','imageUrl':_0x47fa4d(0x9c3)+encodeURIComponent(_0x5bd472['image_prompt']),'variations':(_0x5bd472['variations']||[])[_0x47fa4d(0xd18)](_0x5b6b4f=>({..._0x5b6b4f,'imageUrl':_0x47fa4d(0x9c3)+encodeURIComponent(_0x5b6b4f[_0x47fa4d(0xff9)])})),'categoryId':_0x3fb616};});_0x517512[_0x32ccfc(0x8d6)]>0x0&&await _0x54c587['shoppingProducts'][_0x32ccfc(0x666)](_0x517512);}}),activeShoppingCategoryId='all',await _0x4cf8d9(),await _0x138765(_0x49d03c(0xed9),'为“'+_0x41bf74[_0x49d03c(0xf3e)]+_0x49d03c(0x297));}catch(_0x53e2b9){console[_0x49d03c(0x5d7)]('生成购物中心商品失败:',_0x53e2b9),await _0x138765(_0x49d03c(0x321),_0x49d03c(0x1434)+_0x53e2b9[_0x49d03c(0x6e2)]);}}async function _0x1a9f9c(_0x56217b){const _0x2bbb9c=_0x239c7d,_0x4d39e7=document[_0x2bbb9c(0x400)](_0x56217b);if(!_0x4d39e7)return;const _0x130baf=await _0x14b058(_0x2bbb9c(0x7d3),[{'text':_0x2bbb9c(0xf4d),'value':_0x2bbb9c(0xdf5)},{'text':_0x2bbb9c(0x15b7),'value':_0x2bbb9c(0x299)}]);let _0x20764f=null;if(_0x130baf===_0x2bbb9c(0xdf5))_0x20764f=await _0x1f7db7();else _0x130baf===_0x2bbb9c(0x299)&&(_0x20764f=await _0x25f61f(_0x2bbb9c(0x7d3),_0x2bbb9c(0xae1),_0x4d39e7[_0x2bbb9c(0x912)],_0x2bbb9c(0x299)));if(_0x20764f&&_0x20764f[_0x2bbb9c(0xb8f)]()){const _0xd0d2cd=_0x20764f['trim']();_0x4d39e7[_0x2bbb9c(0x912)]=_0xd0d2cd,!_0x4c8b14[_0x2bbb9c(0x14f1)][_0x2bbb9c(0xca8)]&&(_0x4c8b14['globalSettings'][_0x2bbb9c(0xca8)]={}),_0x4c8b14[_0x2bbb9c(0x14f1)][_0x2bbb9c(0xca8)][_0x56217b]=_0xd0d2cd,await _0x54c587['globalSettings']['put'](_0x4c8b14[_0x2bbb9c(0x14f1)]),await _0x138765('成功','组件图片已更新！');}}window[_0x239c7d(0x15d6)]=_0x1a9f9c;async function _0x3497a1(){const _0x1f577b=_0x239c7d;if(!window[_0x1f577b(0xb02)]||typeof JSZip==='undefined'){await _0x138765(_0x1f577b(0x2a4),_0x1f577b(0x1440));return;}await _0x138765(_0x1f577b(0x11f5),'即将开始打包您的完整备份文件。文件将以ZIP格式流式下载，请勿关闭页面。');const _0x26378a=streamSaver[_0x1f577b(0x392)]('EPhone-Sliced-Backup-'+new Date()[_0x1f577b(0x886)]()[_0x1f577b(0x5ad)]('T')[0x0]+_0x1f577b(0x11c0)),_0x37bae2=new JSZip(),_0x268d0a=0x5f*0x400*0x400;let _0x60864d=0x1,_0x132a2e={},_0x39e3f5=0x0;const _0xe39faa=new TextEncoder();try{const _0x52f4fb=_0x54c587[_0x1f577b(0xfcf)][_0x1f577b(0xd18)](_0x1abc6d=>_0x1abc6d['name']);for(const _0x5e4a96 of _0x52f4fb){console[_0x1f577b(0x1e6)]('正在打包表:\x20'+_0x5e4a96+'...');const _0x1dcedf=await _0x54c587['table'](_0x5e4a96)[_0x1f577b(0xce1)]();if(_0x1dcedf[_0x1f577b(0x8d6)]===0x0)continue;const _0x4f6b39=JSON[_0x1f577b(0xea5)](_0x1dcedf),_0x2f20ac=_0xe39faa[_0x1f577b(0x729)](_0x4f6b39)[_0x1f577b(0x8d6)];if(_0x2f20ac>_0x268d0a){console[_0x1f577b(0x75e)](_0x1f577b(0x733)+_0x5e4a96+_0x1f577b(0x98e)+(_0x2f20ac/0x400/0x400)[_0x1f577b(0x2ea)](0x2)+_0x1f577b(0x337));_0x39e3f5>0x0&&(_0x37bae2[_0x1f577b(0xb41)]('slice_'+_0x60864d++ +_0x1f577b(0xbfb),JSON[_0x1f577b(0xea5)]({'version':0x4,'type':'slice','data':_0x132a2e})),_0x132a2e={},_0x39e3f5=0x0);_0x132a2e[_0x5e4a96]=_0x1dcedf,_0x37bae2[_0x1f577b(0xb41)]('slice_'+_0x60864d++ +_0x1f577b(0xbfb),JSON[_0x1f577b(0xea5)]({'version':0x4,'type':'slice','data':_0x132a2e})),_0x132a2e={},_0x39e3f5=0x0;continue;}_0x39e3f5>0x0&&_0x39e3f5+_0x2f20ac>_0x268d0a&&(console[_0x1f577b(0x1e6)](_0x1f577b(0x656)+_0x60864d+_0x1f577b(0xa9e)+(_0x39e3f5/0x400/0x400)[_0x1f577b(0x2ea)](0x2)+_0x1f577b(0x155c)),_0x37bae2[_0x1f577b(0xb41)](_0x1f577b(0x7a4)+_0x60864d++ +'.json',JSON[_0x1f577b(0xea5)]({'version':0x4,'type':_0x1f577b(0x69f),'data':_0x132a2e})),_0x132a2e={},_0x39e3f5=0x0),_0x132a2e[_0x5e4a96]=_0x1dcedf,_0x39e3f5+=_0x2f20ac;}_0x39e3f5>0x0&&(console[_0x1f577b(0x1e6)](_0x1f577b(0xc8a)+_0x60864d+_0x1f577b(0x513)+(_0x39e3f5/0x400/0x400)['toFixed'](0x2)+'MB)...'),_0x37bae2[_0x1f577b(0xb41)](_0x1f577b(0x7a4)+_0x60864d+_0x1f577b(0xbfb),JSON[_0x1f577b(0xea5)]({'version':0x4,'type':_0x1f577b(0x69f),'data':_0x132a2e})));console[_0x1f577b(0x1e6)](_0x1f577b(0x95d));const _0x39117e=_0x37bae2[_0x1f577b(0xb2b)]({'type':_0x1f577b(0xf6d),'streamFiles':!![]}),_0x23cc34=new ReadableStream({'start'(_0x5a6ecc){const _0x16b866=_0x1f577b;_0x39117e['on'](_0x16b866(0x55b),_0x4f1142=>{const _0x1f9484=_0x16b866;_0x5a6ecc[_0x1f9484(0xd88)](_0x4f1142);})['on'](_0x16b866(0xe2a),()=>{const _0x2d32be=_0x16b866;console[_0x2d32be(0x1e6)](_0x2d32be(0x8af)),_0x5a6ecc[_0x2d32be(0xceb)]();})['on'](_0x16b866(0x5d7),_0x27e54f=>{const _0x399063=_0x16b866;console['error'](_0x399063(0x13ad),_0x27e54f),_0x5a6ecc[_0x399063(0x5d7)](_0x27e54f);})['resume']();}});await _0x23cc34[_0x1f577b(0x1583)](_0x26378a),await _0x138765(_0x1f577b(0x1689),'您的分片备份已开始下载。解压后，您可以使用“导入”功能，选择其中的\x20`slice_X.json`\x20文件进行增量恢复。');}catch(_0x2a6ea5){console['error'](_0x1f577b(0x1177),_0x2a6ea5),await _0x138765('导出失败','在打包或写入文件流时发生错误:\x20'+_0x2a6ea5[_0x1f577b(0x6e2)]);try{const _0x316d96=_0x26378a['getWriter']();_0x316d96[_0x1f577b(0x2b4)](_0x2a6ea5);}catch(_0x185b70){}}}async function _0x1cf2d3(){const _0xe047f1=_0x239c7d;if(!window['streamSaver']){alert(_0xe047f1(0x943));return;}await _0x138765(_0xe047f1(0xad1),'即将开始下载您的完整备份文件。下载过程中请勿关闭页面。');const _0x5f45e5=streamSaver[_0xe047f1(0x392)](_0xe047f1(0xc5b)+new Date()[_0xe047f1(0x886)]()[_0xe047f1(0x5ad)]('T')[0x0]+'.json'),_0x5742fe=_0x5f45e5[_0xe047f1(0xc5c)](),_0x56555c=new TextEncoder();try{await _0x5742fe[_0xe047f1(0x1444)](_0x56555c[_0xe047f1(0x729)]('{\x0a\x22version\x22:\x203,\x0a\x22timestamp\x22:\x20'+Date[_0xe047f1(0xecd)]()+_0xe047f1(0xda7)));const _0x5138ac=await _0x54c587[_0xe047f1(0xfcf)][_0xe047f1(0xd18)](_0x4863d8=>_0x4863d8['name']);for(let _0x3c3d52=0x0;_0x3c3d52<_0x5138ac[_0xe047f1(0x8d6)];_0x3c3d52++){const _0x1f2719=_0x5138ac[_0x3c3d52],_0x4f15a0=_0x54c587[_0xe047f1(0x770)](_0x1f2719);await _0x5742fe[_0xe047f1(0x1444)](_0x56555c['encode']('\x22'+_0x1f2719+'\x22:\x20[\x0a'));let _0x54c62f=!![];await _0x4f15a0['each'](_0x8ca90c=>{const _0x46a6e8=_0xe047f1;!_0x54c62f&&_0x5742fe[_0x46a6e8(0x1444)](_0x56555c[_0x46a6e8(0x729)](',\x0a')),_0x5742fe[_0x46a6e8(0x1444)](_0x56555c[_0x46a6e8(0x729)](JSON[_0x46a6e8(0xea5)](_0x8ca90c))),_0x54c62f=![];}),await _0x5742fe[_0xe047f1(0x1444)](_0x56555c['encode']('\x0a]')),_0x3c3d52<_0x5138ac[_0xe047f1(0x8d6)]-0x1&&await _0x5742fe[_0xe047f1(0x1444)](_0x56555c['encode'](',\x0a'));}await _0x5742fe['write'](_0x56555c['encode'](_0xe047f1(0x724)));}catch(_0x499cad){console[_0xe047f1(0x5d7)](_0xe047f1(0x107b),_0x499cad),await _0x138765(_0xe047f1(0x13be),_0xe047f1(0xd60)+_0x499cad[_0xe047f1(0x6e2)]);}finally{await _0x5742fe['close']();}}async function _0x4b9be8(){const _0x3fb269=_0x239c7d;await _0x138765('正在准备...','正在读取所有数据到内存中，请稍候...');try{const _0x10231d={'version':0x3,'timestamp':Date[_0x3fb269(0xecd)](),'data':{}},_0x2c13b5=_0x54c587[_0x3fb269(0xfcf)][_0x3fb269(0xd18)](_0x4b2d67=>_0x4b2d67[_0x3fb269(0xf3e)]);for(const _0x43cc50 of _0x2c13b5){const _0x6605b9=await _0x54c587[_0x3fb269(0x770)](_0x43cc50)[_0x3fb269(0xce1)]();_0x10231d['data'][_0x43cc50]=_0x6605b9,console[_0x3fb269(0x1e6)](_0x3fb269(0xb74)+_0x43cc50+_0x3fb269(0x3e6)+_0x6605b9[_0x3fb269(0x8d6)]);}const _0x38de69=new Blob([JSON['stringify'](_0x10231d,null,0x2)],{'type':_0x3fb269(0xfae)}),_0x3046e=URL[_0x3fb269(0xc2c)](_0x38de69),_0xa8a32c=document[_0x3fb269(0x2c9)]('a');_0xa8a32c[_0x3fb269(0xcf5)]=_0x3046e,_0xa8a32c[_0x3fb269(0xcda)]=_0x3fb269(0xd8f)+new Date()['toISOString']()[_0x3fb269(0x5ad)]('T')[0x0]+_0x3fb269(0xbfb),_0xa8a32c[_0x3fb269(0x15ad)](),URL[_0x3fb269(0x896)](_0x3046e),await _0x138765(_0x3fb269(0x6ca),_0x3fb269(0xddc));}catch(_0x5ee197){console[_0x3fb269(0x5d7)](_0x3fb269(0xf5e),_0x5ee197),await _0x138765(_0x3fb269(0x13be),_0x3fb269(0xef2)+_0x5ee197[_0x3fb269(0x6e2)]);}}function _0x2acd39(){const _0x3076ce=_0x239c7d,_0x284fd2=Object['values'](_0x4c8b14['chats'])[_0x3076ce(0x439)]((_0x67427d,_0x41ee45)=>{if(_0x41ee45['id']===_0x4c8b14['activeChatId'])return _0x67427d;return _0x67427d+(_0x41ee45['unreadCount']||0x0);},0x0),_0x50f8c0=_0x582d69||0x0,_0x26a4b0=_0x284fd2+_0x50f8c0,_0x423fec=document[_0x3076ce(0x400)](_0x3076ce(0x7ab));if(!_0x423fec)return;let _0x2a5ea4=_0x423fec['querySelector'](_0x3076ce(0xff8));!_0x2a5ea4&&(_0x2a5ea4=document['createElement'](_0x3076ce(0x9a7)),_0x2a5ea4[_0x3076ce(0x4e1)]=_0x3076ce(0x45f),_0x423fec[_0x3076ce(0x8f2)](_0x2a5ea4));let _0x84e3a5=_0x423fec['querySelector'](_0x3076ce(0xf7f));_0x84e3a5&&_0x84e3a5[_0x3076ce(0xc46)](),_0x26a4b0>0x0?(_0x2a5ea4[_0x3076ce(0xde7)]=_0x26a4b0>0x63?_0x3076ce(0x529):_0x26a4b0,_0x2a5ea4[_0x3076ce(0xa00)][_0x3076ce(0xb1a)]='block',_0x2a5ea4['style']['zIndex']='20',_0x2a5ea4[_0x3076ce(0xa00)]['transform']=_0x3076ce(0x768)):_0x2a5ea4[_0x3076ce(0xa00)][_0x3076ce(0xb1a)]='none';}async function _0x3467d5(_0x37af4b){const _0x30512a=_0x239c7d,_0x55532e=_0x37af4b===_0x30512a(0x13c3)?{'id':_0x30512a(0x13c3),'name':_0x30512a(0xac0)}:await _0x54c587['stickerCategories'][_0x30512a(0xf48)](_0x37af4b);if(!_0x55532e){console[_0x30512a(0x5d7)](_0x30512a(0x1083),_0x37af4b);return;}const _0x3c2922=document[_0x30512a(0x400)]('sticker-binding-modal'),_0x568dc9=document['getElementById'](_0x30512a(0x1605)),_0xb57547=_0x3c2922[_0x30512a(0x13ef)](_0x30512a(0x823));_0x568dc9['innerHTML']='',_0xb57547['textContent']='将分类\x20“'+_0x55532e[_0x30512a(0xf3e)]+_0x30512a(0x15c7);const _0x1c26d6=Object[_0x30512a(0x40a)](_0x4c8b14[_0x30512a(0xbea)])['sort']((_0x33bec3,_0x1c8458)=>_0x33bec3[_0x30512a(0xf3e)][_0x30512a(0x10f5)](_0x1c8458[_0x30512a(0xf3e)],'zh-CN'));_0x1c26d6[_0x30512a(0xbdc)](_0x432e65=>{const _0x42d69e=_0x30512a,_0x1e2239=Array[_0x42d69e(0x16a1)](_0x432e65['settings']?.[_0x42d69e(0x1248)])&&_0x432e65['settings'][_0x42d69e(0x1248)]['includes'](_0x37af4b),_0x1e2b65=document[_0x42d69e(0x2c9)](_0x42d69e(0xf8e));_0x1e2b65['className']='contact-picker-item',_0x1e2b65[_0x42d69e(0x1575)]=_0x42d69e(0x140d)+_0x432e65['id']+'\x22\x20'+(_0x1e2239?_0x42d69e(0x6f9):'')+_0x42d69e(0x86f)+(_0x432e65[_0x42d69e(0xc98)]?_0x432e65[_0x42d69e(0xa37)][_0x42d69e(0x465)]:_0x432e65['settings'][_0x42d69e(0xb24)]||_0x91d058)+_0x42d69e(0x302)+_0x432e65[_0x42d69e(0xf3e)]+_0x42d69e(0x152e),_0x568dc9['appendChild'](_0x1e2b65);}),document[_0x30512a(0x400)](_0x30512a(0x740))['onclick']=()=>_0x802d6e(_0x37af4b),document['getElementById'](_0x30512a(0xf5d))[_0x30512a(0x41b)]=()=>_0x3c2922[_0x30512a(0xb08)][_0x30512a(0xc46)](_0x30512a(0x9eb)),_0x3c2922[_0x30512a(0xb08)][_0x30512a(0x12b6)]('visible');}async function _0x802d6e(_0x175a21){const _0x5e876e=_0x239c7d,_0x7c858a=new Set(Array[_0x5e876e(0xdc0)](document[_0x5e876e(0x527)](_0x5e876e(0x1516)))[_0x5e876e(0xd18)](_0x222fd9=>_0x222fd9[_0x5e876e(0xd61)][_0x5e876e(0x4dd)])),_0x3f2dc3=[];for(const _0x56a014 in _0x4c8b14[_0x5e876e(0xbea)]){const _0x2406c1=_0x4c8b14[_0x5e876e(0xbea)][_0x56a014];!Array[_0x5e876e(0x16a1)](_0x2406c1[_0x5e876e(0xa37)][_0x5e876e(0x1248)])&&(_0x2406c1[_0x5e876e(0xa37)][_0x5e876e(0x1248)]=[]);const _0x761fce=_0x2406c1[_0x5e876e(0xa37)][_0x5e876e(0x1248)][_0x5e876e(0xd1b)](_0x175a21),_0x533242=_0x7c858a['has'](_0x56a014);if(_0x761fce&&!_0x533242)_0x2406c1['settings'][_0x5e876e(0x1248)]=_0x2406c1['settings'][_0x5e876e(0x1248)][_0x5e876e(0x29d)](_0x14835b=>_0x14835b!==_0x175a21),_0x3f2dc3['push'](_0x2406c1);else!_0x761fce&&_0x533242&&(_0x2406c1[_0x5e876e(0xa37)][_0x5e876e(0x1248)][_0x5e876e(0x6bb)](_0x175a21),_0x3f2dc3[_0x5e876e(0x6bb)](_0x2406c1));}_0x3f2dc3[_0x5e876e(0x8d6)]>0x0&&(await _0x54c587[_0x5e876e(0xbea)][_0x5e876e(0x1f6)](_0x3f2dc3),await _0x138765(_0x5e876e(0xd20),_0x5e876e(0x566))),document[_0x5e876e(0x400)]('sticker-binding-modal')['classList'][_0x5e876e(0xc46)](_0x5e876e(0x9eb));}function _0x460a58(_0x111a26){const _0x2cf32d=_0x239c7d;if(!_0x111a26||!_0x111a26[_0x2cf32d(0xa37)][_0x2cf32d(0x1248)]||_0x111a26[_0x2cf32d(0xa37)][_0x2cf32d(0x1248)][_0x2cf32d(0x8d6)]===0x0)return'';const _0x2500a2=_0x111a26[_0x2cf32d(0xa37)][_0x2cf32d(0x1248)];let _0x54402e=[];const _0x9f3a77=new Set();_0x2500a2[_0x2cf32d(0xbdc)](_0x2fbdc8=>{const _0x52218b=_0x2cf32d;let _0x151fca;_0x2fbdc8==='uncategorized'?_0x151fca=_0x4c8b14[_0x52218b(0x120c)][_0x52218b(0x29d)](_0x168e48=>!_0x168e48[_0x52218b(0x12c4)]):_0x151fca=_0x4c8b14['userStickers']['filter'](_0x795ca0=>_0x795ca0['categoryId']===_0x2fbdc8),_0x151fca['forEach'](_0x1bbe64=>{const _0x1f715e=_0x52218b;!_0x9f3a77[_0x1f715e(0x3e3)](_0x1bbe64[_0x1f715e(0xf3e)])&&(_0x54402e[_0x1f715e(0x6bb)](_0x1bbe64),_0x9f3a77['add'](_0x1bbe64['name']));});});if(_0x54402e['length']===0x0)return'';const _0x3fc75b=_0x54402e[_0x2cf32d(0xd18)](_0x459197=>'-\x20'+_0x459197[_0x2cf32d(0xf3e)])[_0x2cf32d(0xee1)]('\x0a');return _0x2cf32d(0x779)+_0x3fc75b+'\x0a';}function _0x5798f0(_0x363daf){const _0xab4a98=_0x239c7d;if(!_0x363daf||!_0x363daf['isGroup'])return'';const _0x5476d5=new Set();_0x363daf[_0xab4a98(0x4f8)]['forEach'](_0x3c5b87=>{const _0x53abd6=_0xab4a98;if(_0x3c5b87['id']==='user')return;const _0x47e11e=_0x4c8b14[_0x53abd6(0xbea)][_0x3c5b87['id']];_0x47e11e&&_0x47e11e[_0x53abd6(0xa37)][_0x53abd6(0x1248)]&&_0x47e11e[_0x53abd6(0xa37)][_0x53abd6(0x1248)][_0x53abd6(0xbdc)](_0x1f44f3=>_0x5476d5['add'](_0x1f44f3));});if(_0x5476d5[_0xab4a98(0x9e8)]===0x0)return'';let _0x1c9ec3=[];const _0x1a68ec=new Set();_0x5476d5[_0xab4a98(0xbdc)](_0x440126=>{const _0x527b49=_0xab4a98;let _0x776762;_0x440126===_0x527b49(0x13c3)?_0x776762=_0x4c8b14[_0x527b49(0x120c)][_0x527b49(0x29d)](_0x5a9654=>!_0x5a9654['categoryId']):_0x776762=_0x4c8b14[_0x527b49(0x120c)][_0x527b49(0x29d)](_0x2e57f2=>_0x2e57f2['categoryId']===_0x440126),_0x776762[_0x527b49(0xbdc)](_0x81270c=>{!_0x1a68ec['has'](_0x81270c['name'])&&(_0x1c9ec3['push'](_0x81270c),_0x1a68ec['add'](_0x81270c['name']));});});if(_0x1c9ec3[_0xab4a98(0x8d6)]===0x0)return'';const _0x5b557b=_0x1c9ec3[_0xab4a98(0xd18)](_0x253bad=>'-\x20'+_0x253bad[_0xab4a98(0xf3e)])[_0xab4a98(0xee1)]('\x0a');return _0xab4a98(0x158a)+_0x5b557b+'\x0a';}function _0x13f091(_0x419ff5){const _0x407c4d=_0x239c7d;if(!_0x419ff5)return 0x0;return Math[_0x407c4d(0x94b)](_0x419ff5[_0x407c4d(0x8d6)]/1.5);}async function _0x378d57(){const _0x351f5c=_0x239c7d;if(!_0x4c8b14[_0x351f5c(0x1539)])return 0x0;const _0x38f951=_0x4c8b14[_0x351f5c(0xbea)][_0x4c8b14[_0x351f5c(0x1539)]];if(!_0x38f951)return 0x0;const _0x4759e0=parseInt(document[_0x351f5c(0x400)](_0x351f5c(0x15fe))[_0x351f5c(0xa1e)])||0xa,_0x3df627=parseInt(document['getElementById'](_0x351f5c(0x96f))[_0x351f5c(0xa1e)])||0xa,_0x13fd6e=document['getElementById'](_0x351f5c(0xa31))[_0x351f5c(0x6f9)],_0x384f7e=document[_0x351f5c(0x400)]('ai-persona')['value'],_0x259ad6=document['getElementById'](_0x351f5c(0x63c))[_0x351f5c(0xa1e)];let _0x586663='';const _0x1f844d=Array[_0x351f5c(0xdc0)](document['querySelectorAll'](_0x351f5c(0xabf)))[_0x351f5c(0xd18)](_0xd9b7c3=>_0xd9b7c3[_0x351f5c(0xa1e)][_0x351f5c(0xe19)](_0x351f5c(0x160f),''));if(_0x1f844d[_0x351f5c(0x8d6)]>0x0){const _0x51e61c=_0x1f844d['map'](_0x2b3ebb=>{const _0x47c490=_0x351f5c,_0x212016=_0x4c8b14['worldBooks'][_0x47c490(0x821)](_0x1c46f7=>_0x1c46f7['id']===_0x2b3ebb);if(!_0x212016||!Array['isArray'](_0x212016['content']))return'';return _0x212016[_0x47c490(0x1109)][_0x47c490(0x29d)](_0xfcc1c7=>_0xfcc1c7[_0x47c490(0x250)]!==![])[_0x47c490(0xd18)](_0x3204a1=>_0x3204a1[_0x47c490(0x1109)])[_0x47c490(0xee1)]('\x0a');})[_0x351f5c(0x29d)](Boolean)[_0x351f5c(0xee1)]('\x0a');_0x586663+=_0x51e61c;}_0x38f951[_0x351f5c(0x1600)]&&_0x38f951[_0x351f5c(0x1600)][_0x351f5c(0x8d6)]>0x0&&(_0x586663+=_0x38f951[_0x351f5c(0x1600)][_0x351f5c(0xd18)](_0x57af58=>_0x57af58[_0x351f5c(0x1109)])[_0x351f5c(0xee1)]('\x0a'));const _0x1cf92b=document[_0x351f5c(0x400)](_0x351f5c(0xf59))[_0x351f5c(0x6f9)];if(_0x1cf92b){const _0x44b650=Array[_0x351f5c(0xdc0)](document[_0x351f5c(0x527)]('#linked-chats-checkboxes-container\x20input:checked'))[_0x351f5c(0xd18)](_0x367fb5=>_0x367fb5['value']);for(const _0x393c4f of _0x44b650){const _0x4991ae=_0x4c8b14[_0x351f5c(0xbea)][_0x393c4f];_0x4991ae&&_0x4991ae[_0x351f5c(0x92c)]['length']>0x0&&(_0x586663+=_0x4991ae[_0x351f5c(0x92c)][_0x351f5c(0x69f)](-_0x3df627)[_0x351f5c(0xd18)](_0x316e23=>String(_0x316e23[_0x351f5c(0x1109)]))[_0x351f5c(0xee1)]('\x0a'));}}_0x38f951['isGroup']?_0x38f951['members'][_0x351f5c(0xbdc)](_0x399273=>{const _0x54a995=_0x351f5c;_0x586663+=_0x399273[_0x54a995(0x9a2)];}):_0x586663+=_0x384f7e;_0x586663+=_0x259ad6,_0x586663+=_0x460a58(_0x38f951);_0x38f951[_0x351f5c(0xc98)]&&(_0x586663+=_0x5798f0(_0x38f951));if(!_0x38f951['isGroup']&&_0x13fd6e){const _0x1fc18a=document[_0x351f5c(0x400)](_0x351f5c(0xb30))[_0x351f5c(0xa1e)];if(_0x1fc18a){const _0x1a75af=_0x4c8b14[_0x351f5c(0xf53)]['find'](_0xff26eb=>_0xff26eb['id']===_0x1fc18a);_0x1a75af&&(_0x586663+=_0x1a75af[_0x351f5c(0x1109)][_0x351f5c(0x29d)](_0x52fe25=>_0x52fe25['enabled']!==![])[_0x351f5c(0xd18)](_0x2260db=>_0x2260db['content'])['join']('\x0a'));}}const _0x25072d=_0x38f951[_0x351f5c(0x92c)][_0x351f5c(0x69f)](-_0x4759e0);return _0x586663+=_0x25072d[_0x351f5c(0xd18)](_0x1decbe=>{const _0x4b06bd=_0x351f5c;if(typeof _0x1decbe[_0x4b06bd(0x1109)]===_0x4b06bd(0x158f))return _0x1decbe[_0x4b06bd(0x1109)];if(Array['isArray'](_0x1decbe[_0x4b06bd(0x1109)]))return _0x1decbe[_0x4b06bd(0x1109)][_0x4b06bd(0xd18)](_0x14be69=>_0x14be69[_0x4b06bd(0x117f)])[_0x4b06bd(0xee1)]('\x20');return'';})[_0x351f5c(0xee1)]('\x0a'),_0x13f091(_0x586663);}const _0xf9cf89=_0x417d62(async()=>{const _0x32e3ae=_0x239c7d,_0x186ab7=document[_0x32e3ae(0x400)](_0x32e3ae(0x10be));if(!_0x186ab7)return;_0x186ab7['innerHTML']=_0x32e3ae(0x904);try{const _0x3a886a=await _0x378d57();_0x186ab7[_0x32e3ae(0x1575)]=_0x32e3ae(0x1403)+_0x3a886a+_0x32e3ae(0xb81);}catch(_0xcfb22f){console['error']('Token\x20calculation\x20error:',_0xcfb22f),_0x186ab7['innerHTML']=_0x32e3ae(0x15cc);}},0x12c);async function _0x1cd581(){const _0x2f8bde=_0x239c7d,_0x45b43c=document[_0x2f8bde(0x400)](_0x2f8bde(0xcae));_0x45b43c[_0x2f8bde(0x1575)]='',_0x1058d8=[],_0xcd9130=0x0,_0x5370c1=![];const _0x5cccc0=[];try{const _0x244d22=await _0x54c587[_0x2f8bde(0xbea)]['toArray']();for(const _0x7a8325 of _0x244d22){_0x7a8325[_0x2f8bde(0x92c)]&&_0x7a8325[_0x2f8bde(0x92c)][_0x2f8bde(0x8d6)]>0x0&&_0x7a8325['history'][_0x2f8bde(0xbdc)](_0x7d158e=>{const _0xb146dd=_0x2f8bde;_0x7d158e[_0xb146dd(0xbbf)]===_0xb146dd(0xd3c)&&_0x7d158e[_0xb146dd(0x1436)]&&_0x5cccc0[_0xb146dd(0x6bb)]({'sourceType':_0xb146dd(0x4e3),'imageUrl':_0x7d158e['imageUrl'],'prompt':_0x7d158e[_0xb146dd(0x156c)]||_0x7d158e[_0xb146dd(0x551)]||_0xb146dd(0x41e),'chatId':_0x7a8325['id'],'msgTimestamp':_0x7d158e[_0xb146dd(0x287)]});});}}catch(_0x39923a){console[_0x2f8bde(0x5d7)](_0x2f8bde(0xb9e),_0x39923a);}try{const _0x3d451a=await _0x54c587[_0x2f8bde(0xba7)]['toArray']();_0x3d451a['forEach'](_0x2f29cf=>{const _0x4ec43d=_0x2f8bde;if(_0x2f29cf[_0x4ec43d(0xbbf)]===_0x4ec43d(0xd3c)){const _0x37efe7=_0x2f29cf[_0x4ec43d(0xeaf)]||(_0x2f29cf[_0x4ec43d(0x1436)]?[_0x2f29cf['imageUrl']]:[]),_0x418e77=Array[_0x4ec43d(0x16a1)](_0x2f29cf[_0x4ec43d(0x156c)])?_0x2f29cf['prompt']:[_0x2f29cf[_0x4ec43d(0x156c)]||'NAI\x20Image'];_0x37efe7[_0x4ec43d(0xbdc)]((_0x479856,_0x115b03)=>{const _0x21bf83=_0x4ec43d;_0x5cccc0[_0x21bf83(0x6bb)]({'sourceType':'qzone','imageUrl':_0x479856,'prompt':_0x418e77[_0x115b03]||_0x418e77[0x0],'postId':_0x2f29cf['id'],'imageIndex':_0x115b03});});}});}catch(_0x3e70f2){console['error'](_0x2f8bde(0x705),_0x3e70f2);}_0x1058d8=_0x5cccc0['sort']((_0x707414,_0x5e075b)=>(_0x5e075b[_0x2f8bde(0x154a)]||_0x5e075b[_0x2f8bde(0x2b7)]||0x0)-(_0x707414[_0x2f8bde(0x154a)]||_0x707414[_0x2f8bde(0x2b7)]||0x0)),_0x1058d8['length']===0x0?_0x45b43c[_0x2f8bde(0x1575)]=_0x2f8bde(0xa75):_0x22544c(),document[_0x2f8bde(0x400)](_0x2f8bde(0x9e4))[_0x2f8bde(0xb08)][_0x2f8bde(0x12b6)](_0x2f8bde(0x9eb));}function _0x4918d9(_0x3e1a8a){const _0x4d78ec=_0x239c7d,_0x2d4896=document['getElementById'](_0x4d78ec(0xcae));if(_0x3e1a8a[_0x4d78ec(0x8d6)]===0x0&&_0xcd9130===0x0){_0x2d4896[_0x4d78ec(0x1575)]=_0x4d78ec(0xa75);return;}const _0x5c8edb=document[_0x4d78ec(0xf74)]();_0x3e1a8a['forEach']((_0x2fccac,_0x1dcb15)=>{const _0x172940=_0x4d78ec,_0x5deff2=document['createElement'](_0x172940(0xf8e));_0x5deff2[_0x172940(0x4e1)]=_0x172940(0x1049),_0x5deff2['title']=_0x2fccac[_0x172940(0x156c)];const _0x33be77=_0x2fccac[_0x172940(0x2ee)]+'_'+(_0x2fccac[_0x172940(0x4dd)]||_0x2fccac[_0x172940(0x2b7)])+'_'+(_0x2fccac['msgTimestamp']||_0x2fccac['imageIndex']);_0x5deff2[_0x172940(0xd61)][_0x172940(0xa30)]=_0x33be77,_0x5deff2[_0x172940(0xd61)][_0x172940(0x1436)]=_0x2fccac['imageUrl'],_0x5deff2[_0x172940(0xd61)][_0x172940(0x156c)]=_0x2fccac['prompt'],_0x5deff2[_0x172940(0x1575)]=_0x172940(0xd95)+_0x2fccac[_0x172940(0x1436)]+')\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nai-gallery-controls\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22nai-gallery-download-btn\x22\x20title=\x22下载\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M19\x209h-4V3H9v6H5l7\x207\x207-7zM5\x2018v2h14v-2H5z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22nai-gallery-delete-btn\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019c0\x201.1.9\x202\x202\x202h8c1.1\x200\x202-.9\x202-2V7H6v12zM19\x204h-3.5l-1-1h-5l-1\x201H5v2h14V4z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22nai-gallery-name\x22>'+_0x2fccac['prompt']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x5c8edb[_0x172940(0x8f2)](_0x5deff2);}),_0x2d4896[_0x4d78ec(0x8f2)](_0x5c8edb);}async function _0x22544c(){const _0x56f429=_0x239c7d;if(_0x5370c1||_0xcd9130>=_0x1058d8[_0x56f429(0x8d6)])return;_0x5370c1=!![];const _0x38c013=document['getElementById']('nai-gallery-grid');_0x3a43dd(_0x38c013,'bottom'),setTimeout(()=>{const _0x294ca1=_0x56f429,_0x4994f8=_0x1058d8[_0x294ca1(0x69f)](_0xcd9130,_0xcd9130+_0x353e13);_0x42da12(_0x38c013),_0x4994f8[_0x294ca1(0x8d6)]>0x0&&(_0x4918d9(_0x4994f8),_0xcd9130+=_0x4994f8[_0x294ca1(0x8d6)]),_0x5370c1=![];},0x1f4);}function _0x56ab21(){const _0xe63827=_0x239c7d;_0x2b56db=!_0x2b56db;const _0xbae6df=document['getElementById'](_0xe63827(0xcae)),_0x4e7621=document[_0xe63827(0x400)]('manage-nai-gallery-btn'),_0x4a18e4=document[_0xe63827(0x400)](_0xe63827(0x154d)),_0x34a141=document['getElementById'](_0xe63827(0x1071));_0xbae6df['classList']['toggle'](_0xe63827(0x1245),_0x2b56db),_0x2b56db?(_0x4e7621[_0xe63827(0xde7)]='完成',_0x4a18e4[_0xe63827(0xa00)][_0xe63827(0xb1a)]='flex',_0x1698d6[_0xe63827(0x82f)](),_0x34a141[_0xe63827(0x6f9)]=![],_0x12489f()):(_0x4e7621[_0xe63827(0xde7)]='管理',_0x4a18e4['style'][_0xe63827(0xb1a)]='none',_0xbae6df[_0xe63827(0x527)](_0xe63827(0x229))[_0xe63827(0xbdc)](_0x1ba277=>_0x1ba277['classList'][_0xe63827(0xc46)](_0xe63827(0x148b))));}function _0x12489f(){const _0x47a0ba=_0x239c7d,_0x1808c1=document[_0x47a0ba(0x400)](_0x47a0ba(0xbee)),_0x1674d1=document[_0x47a0ba(0x400)](_0x47a0ba(0x751)),_0x3a5e57=_0x1698d6[_0x47a0ba(0x9e8)];if(_0x1808c1)_0x1808c1[_0x47a0ba(0xde7)]=_0x47a0ba(0xe4f)+_0x3a5e57+')';if(_0x1674d1)_0x1674d1[_0x47a0ba(0xde7)]=_0x47a0ba(0x12a4)+_0x3a5e57+')';}function _0x1d9e1d(_0x16e0c8){const _0x299ac2=_0x239c7d,_0x447944=_0x16e0c8[_0x299ac2(0x657)]['closest'](_0x299ac2(0x441));if(!_0x447944)return;const _0x384162=_0x447944['dataset']['key'],_0x5d5204=_0x447944[_0x299ac2(0xd61)][_0x299ac2(0x1436)],_0x594d47=_0x447944[_0x299ac2(0xd61)][_0x299ac2(0x156c)];if(_0x16e0c8['target']['closest'](_0x299ac2(0x1622))){_0x16e0c8[_0x299ac2(0x504)](),_0x44c806(_0x5d5204,_0x594d47);return;}if(_0x16e0c8['target'][_0x299ac2(0x117a)](_0x299ac2(0xb46))){_0x16e0c8[_0x299ac2(0x504)](),_0x4edf5b(new Set([_0x384162]));return;}if(_0x2b56db)_0x447944[_0x299ac2(0xb08)][_0x299ac2(0x146f)](_0x299ac2(0x148b)),_0x1698d6[_0x299ac2(0x3e3)](_0x384162)?_0x1698d6[_0x299ac2(0x942)](_0x384162):_0x1698d6[_0x299ac2(0x12b6)](_0x384162),_0x12489f();else{const _0x11a437=_0x299ac2(0x15bd),_0x360d7e=_0x299ac2(0xeb2)+_0x5d5204+_0x299ac2(0x767);_0x138765(_0x11a437,_0x360d7e);}}async function _0x58c981(){const _0x4ee215=_0x239c7d,_0x43c1bf=_0x1698d6;if(_0x43c1bf[_0x4ee215(0x9e8)]===0x0){alert(_0x4ee215(0x100b));return;}if(typeof JSZip===_0x4ee215(0xd30)||!window[_0x4ee215(0xb02)]){await _0x138765(_0x4ee215(0x650),_0x4ee215(0x1536));return;}await _0x138765(_0x4ee215(0x13e9),'正在准备\x20'+_0x43c1bf[_0x4ee215(0x9e8)]+_0x4ee215(0x1648));const _0x49b2c0=new JSZip();let _0x48a0c6=0x0;const _0x58aa3a=[],_0x1bcf1d=Array['from'](_0x43c1bf);_0x1bcf1d[_0x4ee215(0xbdc)]((_0x4f959b,_0x51f381)=>{const _0x2c7370=_0x4ee215,_0x170890=document[_0x2c7370(0x13ef)](_0x2c7370(0xe39)+_0x4f959b+'\x22]');if(!_0x170890)return;const _0x387755=_0x170890[_0x2c7370(0xd61)][_0x2c7370(0x1436)],_0x4a8ef9=_0x170890[_0x2c7370(0xd61)][_0x2c7370(0x156c)],_0x10e7f9=_0x22e51c(_0x4a8ef9),_0x33563b=_0x10e7f9[_0x2c7370(0xe19)](/\.png$/,'_('+(_0x51f381+0x1)+').png'),_0x8177a0=((async()=>{const _0x330a00=_0x2c7370;try{let _0x2fc16d;if(_0x387755[_0x330a00(0xbb9)](_0x330a00(0x7aa))){const _0x51b563=await fetch(_0x387755);_0x2fc16d=await _0x51b563['blob']();}else{let _0x4f2ca8;try{_0x4f2ca8=await fetch(_0x387755,{'mode':_0x330a00(0x1315)});if(!_0x4f2ca8['ok'])throw new Error(_0x330a00(0x1568));}catch(_0x5bd79a){console[_0x330a00(0x75e)](_0x330a00(0x635),_0x5bd79a[_0x330a00(0x6e2)]);const _0x25c0eb=_0x2400cd();let _0x36ab30=_0x25c0eb[_0x330a00(0x4d8)]===_0x330a00(0x7da)?_0x25c0eb[_0x330a00(0x6af)]:_0x25c0eb[_0x330a00(0x4d8)];if(!_0x36ab30||_0x36ab30==='')_0x36ab30=_0x330a00(0xd79);const _0x3893f8=_0x36ab30+encodeURIComponent(_0x387755);_0x4f2ca8=await fetch(_0x3893f8);}if(!_0x4f2ca8['ok'])throw new Error(_0x330a00(0x12e2)+_0x4f2ca8[_0x330a00(0x12c3)]);_0x2fc16d=await _0x4f2ca8[_0x330a00(0xf6d)]();}_0x49b2c0[_0x330a00(0xb41)](_0x33563b,_0x2fc16d,{'binary':!![]});}catch(_0x29ed7f){console['error']('下载图片失败:\x20'+_0x387755,_0x29ed7f),_0x48a0c6++;}})());_0x58aa3a[_0x2c7370(0x6bb)](_0x8177a0);}),await Promise[_0x4ee215(0x875)](_0x58aa3a);if(_0x48a0c6===_0x43c1bf[_0x4ee215(0x9e8)]){await _0x138765('下载失败',_0x4ee215(0x26c));return;}await _0x138765(_0x4ee215(0x14b7),_0x4ee215(0x41d));try{const _0x24e80c=streamSaver[_0x4ee215(0x392)](_0x4ee215(0x422)+Date['now']()+'.zip'),_0xa4e74f=_0x49b2c0[_0x4ee215(0xb2b)]({'type':_0x4ee215(0xf6d),'streamFiles':!![]}),_0x429cfc=new ReadableStream({'start'(_0xcde064){const _0x12ec28=_0x4ee215;_0xa4e74f['on'](_0x12ec28(0x55b),_0x5b0899=>{_0xcde064['enqueue'](_0x5b0899);})['on'](_0x12ec28(0xe2a),()=>{const _0x6932d9=_0x12ec28;console[_0x6932d9(0x1e6)]('ZIP\x20流生成完毕。'),_0xcde064[_0x6932d9(0xceb)]();})['on'](_0x12ec28(0x5d7),_0x41d0a3=>{const _0x40707d=_0x12ec28;console[_0x40707d(0x5d7)](_0x40707d(0x13ad),_0x41d0a3),_0xcde064[_0x40707d(0x5d7)](_0x41d0a3);})['resume']();}});await _0x429cfc[_0x4ee215(0x1583)](_0x24e80c),_0x48a0c6>0x0&&_0x138765('部分下载完成',_0x4ee215(0xcad)+(_0x43c1bf['size']-_0x48a0c6)+_0x4ee215(0x8a4)+_0x48a0c6+_0x4ee215(0x1508));}catch(_0x562165){console[_0x4ee215(0x5d7)](_0x4ee215(0x58e),_0x562165),await _0x138765(_0x4ee215(0x627),_0x4ee215(0xd8c)+_0x562165[_0x4ee215(0x6e2)]);}}async function _0x4edf5b(_0x303918=null){const _0x381550=_0x239c7d,_0x14f19c=_0x303918||_0x1698d6;if(_0x14f19c['size']===0x0)return;const _0x547f1f=await _0x56d4d3(_0x381550(0x713),_0x381550(0x5f5)+_0x14f19c['size']+_0x381550(0xe9f),{'confirmButtonClass':_0x381550(0x142c)});if(!_0x547f1f)return;await _0x138765('请稍候...',_0x381550(0x1411));let _0x5898e5=0x0;const _0x4b9bec=new Map(),_0x416730=new Set(),_0xa1e558=new Map(),_0x2712fc=new Set();for(const _0xdc6ee5 of _0x14f19c){if(_0xdc6ee5[_0x381550(0xbb9)]('qzone_')){const _0x5aab5d=_0xdc6ee5[_0x381550(0x5ad)]('_'),_0x284746=parseInt(_0x5aab5d[0x1]);!isNaN(_0x284746)&&_0x2712fc[_0x381550(0x12b6)](_0x284746);}}const _0x50c4dc=new Map();if(_0x2712fc['size']>0x0){const _0x576980=await _0x54c587[_0x381550(0xba7)][_0x381550(0x227)]('id')[_0x381550(0x1666)](Array['from'](_0x2712fc))[_0x381550(0xce1)]();_0x576980['forEach'](_0x4825a7=>_0x50c4dc[_0x381550(0xfa3)](_0x4825a7['id'],_0x4825a7));}for(const _0x4b5bbc of _0x14f19c){const _0x401798=_0x4b5bbc[_0x381550(0x5ad)]('_');if(_0x401798[_0x381550(0x8d6)]<0x3){console[_0x381550(0x75e)](_0x381550(0x128f),_0x4b5bbc);continue;}const _0x501ee7=_0x401798[0x0],_0x2eb552=_0x401798['pop'](),_0x4ee6ea=_0x401798[_0x381550(0x69f)](0x1)['join']('_');if(_0x501ee7===_0x381550(0x4e3)){const _0x165aa2=_0x4ee6ea,_0x135b22=parseInt(_0x2eb552);if(!_0x4b9bec[_0x381550(0x3e3)](_0x165aa2)){const _0xf18996=await _0x54c587[_0x381550(0xbea)][_0x381550(0xf48)](_0x165aa2);if(_0xf18996)_0x4b9bec[_0x381550(0xfa3)](_0x165aa2,_0xf18996);else{console[_0x381550(0x75e)](_0x381550(0x425)+_0x165aa2+_0x381550(0x9ca));continue;}}const _0x5e3be1=_0x4b9bec[_0x381550(0xf48)](_0x165aa2);if(_0x5e3be1&&_0x5e3be1['history']){const _0x540da0=_0x5e3be1[_0x381550(0x92c)][_0x381550(0x8d6)];_0x5e3be1[_0x381550(0x92c)]=_0x5e3be1[_0x381550(0x92c)]['filter'](_0x12998f=>_0x12998f['timestamp']!==_0x135b22),_0x5e3be1['history'][_0x381550(0x8d6)]<_0x540da0&&(_0x5898e5++,_0x4b9bec[_0x381550(0xfa3)](_0x165aa2,_0x5e3be1));}}else{if(_0x501ee7===_0x381550(0x748)){const _0x32002d=parseInt(_0x4ee6ea),_0x455ef2=parseInt(_0x2eb552),_0x294fb4=_0xa1e558[_0x381550(0xf48)](_0x32002d)||_0x50c4dc[_0x381550(0xf48)](_0x32002d);if(!_0x294fb4){console[_0x381550(0x75e)](_0x381550(0x55d)+_0x32002d+'，跳过...');continue;}const _0x5473b7=_0x294fb4[_0x381550(0xeaf)]||(_0x294fb4[_0x381550(0x1436)]?[_0x294fb4[_0x381550(0x1436)]]:[]);if(_0x5473b7[_0x381550(0x8d6)]<=0x1)_0x416730['add'](_0x32002d),_0xa1e558[_0x381550(0x3e3)](_0x32002d)&&_0xa1e558['delete'](_0x32002d);else{const _0x18c930=_0x5473b7[_0x455ef2];_0x294fb4[_0x381550(0xeaf)]=_0x294fb4[_0x381550(0xeaf)]['filter'](_0x2dc137=>_0x2dc137!==_0x18c930),_0x294fb4['prompt']&&Array[_0x381550(0x16a1)](_0x294fb4[_0x381550(0x156c)])&&_0x294fb4[_0x381550(0x156c)][_0x455ef2]&&_0x294fb4[_0x381550(0x156c)]['splice'](_0x455ef2,0x1),_0x294fb4['imageUrl']=_0x294fb4[_0x381550(0xeaf)][0x0]||null,_0xa1e558[_0x381550(0xfa3)](_0x32002d,_0x294fb4);}_0x5898e5++;}}}try{await _0x54c587[_0x381550(0xfec)]('rw',_0x54c587[_0x381550(0xbea)],_0x54c587['qzonePosts'],async()=>{const _0x165388=_0x381550;_0x4b9bec[_0x165388(0x9e8)]>0x0&&await _0x54c587[_0x165388(0xbea)][_0x165388(0x1f6)](Array[_0x165388(0xdc0)](_0x4b9bec[_0x165388(0x40a)]())),_0xa1e558[_0x165388(0x9e8)]>0x0&&await _0x54c587[_0x165388(0xba7)][_0x165388(0x1f6)](Array[_0x165388(0xdc0)](_0xa1e558[_0x165388(0x40a)]())),_0x416730['size']>0x0&&await _0x54c587[_0x165388(0xba7)][_0x165388(0x2c6)](Array[_0x165388(0xdc0)](_0x416730));}),_0x56ab21(),await _0x1cd581(),await _0x138765(_0x381550(0xee6),_0x381550(0x15ae)+_0x5898e5+_0x381550(0x4b3)),document[_0x381550(0x400)](_0x381550(0x946))['classList'][_0x381550(0xd3f)]('active')&&_0x26354c(_0x4c8b14[_0x381550(0x1539)]),document['getElementById'](_0x381550(0x951))['classList'][_0x381550(0xd3f)]('active')&&_0x335d36();}catch(_0x467501){console[_0x381550(0x5d7)]('批量删除NAI图片时出错:',_0x467501),await _0x138765(_0x381550(0x11d9),'操作失败:\x20'+_0x467501['message']);}}function _0x22e51c(_0x23e481){const _0x38a8c2=_0x239c7d,_0x4cd009=_0x23e481||_0x38a8c2(0x4f9);let _0x94367c=_0x4cd009['replace'](/[^a-zA-Z0-9\u4e00-\u9fa5\s]/g,'_')['replace'](/\s+/g,'_')[_0x38a8c2(0x371)](0x0,0x1e);!_0x94367c&&(_0x94367c=_0x38a8c2(0x4f9));const _0x4b0357=new Date()[_0x38a8c2(0x886)]()[_0x38a8c2(0xe19)](/[-:]/g,'')[_0x38a8c2(0xe19)]('T','_')['split']('.')[0x0];return _0x94367c+'_'+_0x4b0357+_0x38a8c2(0x57b);}function _0x36a2d9(){const _0x526ccf=_0x239c7d;_0x387929(),document[_0x526ccf(0x400)]('quick-reply-modal')[_0x526ccf(0xb08)]['add'](_0x526ccf(0x9eb));}function _0x387929(){const _0x290ec6=_0x239c7d,_0x549b08=document[_0x290ec6(0x400)]('quick-reply-list');_0x549b08[_0x290ec6(0x1575)]='';if(!_0x4c8b14[_0x290ec6(0x210)]||_0x4c8b14[_0x290ec6(0x210)][_0x290ec6(0x8d6)]===0x0){_0x549b08[_0x290ec6(0x1575)]=_0x290ec6(0x147a);return;}_0x4c8b14[_0x290ec6(0x210)]['forEach'](_0x5bef31=>{const _0xbae84e=_0x290ec6,_0x2a4873=document[_0xbae84e(0x2c9)](_0xbae84e(0xf8e));_0x2a4873[_0xbae84e(0x4e1)]=_0xbae84e(0x167c),_0x2a4873[_0xbae84e(0x1575)]=_0xbae84e(0x115b)+escapeHTML(_0x5bef31['text'])+'\x22>'+escapeHTML(_0x5bef31[_0xbae84e(0x117f)])+_0xbae84e(0xb33)+_0x5bef31['id']+_0xbae84e(0x1572)+_0x5bef31['id']+_0xbae84e(0x5e3),_0x549b08[_0xbae84e(0x8f2)](_0x2a4873);});}function _0x4fd90(_0x35be54){const _0x2791d5=_0x239c7d,_0x3036e3=document[_0x2791d5(0x400)]('chat-input');_0x3036e3['value']=_0x35be54,document[_0x2791d5(0x400)](_0x2791d5(0xef8))[_0x2791d5(0xb08)][_0x2791d5(0xc46)](_0x2791d5(0x9eb)),_0x3036e3[_0x2791d5(0x797)]();}async function _0x2d3061(){const _0x412773=_0x239c7d,_0x4d2904=await _0x25f61f(_0x412773(0x5e4),_0x412773(0xcf4),'',_0x412773(0x79e));if(_0x4d2904&&_0x4d2904[_0x412773(0xb8f)]()){const _0x579b8={'text':_0x4d2904[_0x412773(0xb8f)]()},_0xefdba0=await _0x54c587[_0x412773(0x210)][_0x412773(0x12b6)](_0x579b8);_0x4c8b14['quickReplies'][_0x412773(0x6bb)]({'id':_0xefdba0,..._0x579b8}),_0x387929();}else _0x4d2904!==null&&alert(_0x412773(0x129e));}async function _0x4e7f88(_0x38116e){const _0x278a3d=_0x239c7d,_0x493341=await _0x54c587['quickReplies'][_0x278a3d(0xf48)](_0x38116e);if(!_0x493341)return;const _0x1acab2=await _0x25f61f(_0x278a3d(0x6eb),_0x278a3d(0x142b),_0x493341[_0x278a3d(0x117f)],_0x278a3d(0x79e));if(_0x1acab2&&_0x1acab2['trim']()){await _0x54c587['quickReplies'][_0x278a3d(0x126d)](_0x38116e,{'text':_0x1acab2[_0x278a3d(0xb8f)]()});const _0x168f1a=_0x4c8b14[_0x278a3d(0x210)][_0x278a3d(0x821)](_0x10fc6d=>_0x10fc6d['id']===_0x38116e);if(_0x168f1a)_0x168f1a[_0x278a3d(0x117f)]=_0x1acab2[_0x278a3d(0xb8f)]();_0x387929();}else _0x1acab2!==null&&alert(_0x278a3d(0x129e));}async function _0x41d972(_0x13d8f8){const _0x41407e=_0x239c7d,_0x2d642e=await _0x56d4d3(_0x41407e(0x713),'确定要删除这条快捷回复吗？',{'confirmButtonClass':_0x41407e(0x142c)});_0x2d642e&&(await _0x54c587[_0x41407e(0x210)][_0x41407e(0x942)](_0x13d8f8),_0x4c8b14[_0x41407e(0x210)]=_0x4c8b14['quickReplies']['filter'](_0x20f76b=>_0x20f76b['id']!==_0x13d8f8),_0x387929());}async function _0x5d5cde(){const _0x4bbbc4=_0x239c7d;initLanguage();async function _0x5379cf(_0x1da3df){const _0x295224=_0x466f;if(!_0x1da3df)return;try{const _0x5c5791=await _0x1da3df['text'](),_0x353689=JSON[_0x295224(0x13f7)](_0x5c5791);if(_0x353689[_0x295224(0xbbf)]===_0x295224(0x53f))console['log'](_0x295224(0x1500)),await _0x4e70b3(_0x353689);else{if(_0x353689[_0x295224(0x9de)]&&typeof _0x353689[_0x295224(0x9de)]===_0x295224(0xfc4)){console[_0x295224(0x1e6)](_0x295224(0xd6a));try{await _0x2bf707(),await _0x5a0742(_0x353689,_0x1da3df['name']);}catch(_0x5890d3){console[_0x295224(0x75e)](_0x295224(0xab5),_0x5890d3['message']);}}else throw new Error('文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20世界书备份或\x20Tavern\x20AI\x20世界书文件。');}}catch(_0x49b228){console[_0x295224(0x5d7)](_0x295224(0x464),_0x49b228),await _0x138765('导入失败','文件解析或应用失败:\x20'+_0x49b228[_0x295224(0x6e2)]);}}async function _0x5a0742(_0x3e5045,_0x3b7544){const _0x3e7d5d=_0x466f,_0x24d902=_0x3b7544[_0x3e7d5d(0xe19)](/\.json$/i,''),_0xabb0c4=await _0x25f61f(_0x3e7d5d(0x1393),_0x3e7d5d(0x1217),_0x24d902);if(!_0xabb0c4||!_0xabb0c4['trim']()){alert('导入已取消，因为未提供书名。');return;}const _0x4eaca1=Object[_0x3e7d5d(0x40a)](_0x3e5045['entries'])[_0x3e7d5d(0xd18)](_0x530f66=>{const _0x1e87dd=_0x3e7d5d;return{'keys':_0x530f66[_0x1e87dd(0xa30)]||[],'comment':_0x530f66[_0x1e87dd(0x83c)]||_0x1e87dd(0x955),'content':_0x530f66[_0x1e87dd(0x1109)]||'','enabled':!_0x530f66[_0x1e87dd(0x13f4)]};})['filter'](_0x4f75b0=>_0x4f75b0[_0x3e7d5d(0x1109)]);if(_0x4eaca1['length']===0x0){alert(_0x3e7d5d(0xbfc));return;}const _0x385316={'id':_0x3e7d5d(0x7e0)+Date[_0x3e7d5d(0xecd)](),'name':_0xabb0c4['trim'](),'content':_0x4eaca1,'categoryId':null};await _0x54c587[_0x3e7d5d(0xf57)][_0x3e7d5d(0x12b6)](_0x385316),_0x4c8b14[_0x3e7d5d(0xf57)]['push'](_0x385316),await _0x3db57c(),await _0x138765(_0x3e7d5d(0xe9b),_0x3e7d5d(0xefd)+_0xabb0c4+'》。');}async function _0x3670ce(){const _0xa9eeec=_0x466f;try{const _0x579cbf=await _0x54c587[_0xa9eeec(0xf57)][_0xa9eeec(0xce1)](),_0x14fb25=await _0x54c587['worldBookCategories'][_0xa9eeec(0xce1)]();if(_0x579cbf[_0xa9eeec(0x8d6)]===0x0&&_0x14fb25[_0xa9eeec(0x8d6)]===0x0){alert(_0xa9eeec(0x1661));return;}const _0x2db621={'type':_0xa9eeec(0x53f),'version':0x1,'timestamp':Date[_0xa9eeec(0xecd)](),'books':_0x579cbf,'categories':_0x14fb25},_0x1863b5=new Blob([JSON[_0xa9eeec(0xea5)](_0x2db621,null,0x2)],{'type':_0xa9eeec(0xfae)}),_0x578359=URL[_0xa9eeec(0xc2c)](_0x1863b5),_0x1b0580=document[_0xa9eeec(0x2c9)]('a');_0x1b0580[_0xa9eeec(0xcf5)]=_0x578359,_0x1b0580['download']=_0xa9eeec(0x89d)+new Date()[_0xa9eeec(0x886)]()[_0xa9eeec(0x5ad)]('T')[0x0]+_0xa9eeec(0xbfb),_0x1b0580[_0xa9eeec(0x15ad)](),URL[_0xa9eeec(0x896)](_0x578359),await _0x138765('导出成功',_0xa9eeec(0x308));}catch(_0xc0f7f3){console[_0xa9eeec(0x5d7)]('导出世界书时出错:',_0xc0f7f3),await _0x138765('导出失败',_0xa9eeec(0xef2)+_0xc0f7f3[_0xa9eeec(0x6e2)]);}}async function _0x4e70b3(_0x4c9c3d){const _0x19f4fb=_0x466f;try{if(_0x4c9c3d['type']!==_0x19f4fb(0x53f)||!_0x4c9c3d[_0x19f4fb(0x167b)])throw new Error(_0x19f4fb(0x1481));const _0x14bd8f=await _0x56d4d3('导入世界书','这将用文件中的数据【完全覆盖】您当前所有的世界书和分类。此操作不可撤销！',{'confirmButtonClass':_0x19f4fb(0x142c),'confirmText':_0x19f4fb(0x50c)});if(!_0x14bd8f)return;await _0x54c587['transaction']('rw',_0x54c587[_0x19f4fb(0xf57)],_0x54c587['worldBookCategories'],async()=>{const _0xa5c7ed=_0x19f4fb;await _0x54c587[_0xa5c7ed(0xf57)][_0xa5c7ed(0x82f)](),await _0x54c587[_0xa5c7ed(0x2c3)][_0xa5c7ed(0x82f)](),Array[_0xa5c7ed(0x16a1)](_0x4c9c3d['books'])&&await _0x54c587[_0xa5c7ed(0xf57)]['bulkPut'](_0x4c9c3d[_0xa5c7ed(0x167b)]),Array[_0xa5c7ed(0x16a1)](_0x4c9c3d[_0xa5c7ed(0x1350)])&&await _0x54c587[_0xa5c7ed(0x2c3)][_0xa5c7ed(0x1f6)](_0x4c9c3d[_0xa5c7ed(0x1350)]);}),_0x4c8b14['worldBooks']=await _0x54c587[_0x19f4fb(0xf57)]['toArray'](),await _0x3db57c(),await _0x138765('导入成功',_0x19f4fb(0x1655));}catch(_0x4d152e){console[_0x19f4fb(0x5d7)]('导入世界书时出错:',_0x4d152e),await _0x138765(_0x19f4fb(0x3e8),_0x19f4fb(0xad8)+_0x4d152e[_0x19f4fb(0x6e2)]);}}const _0x5c6d02=localStorage[_0x4bbbc4(0xca2)](_0x4bbbc4(0x130c));if(_0x5c6d02){const _0x4bae50=(Date[_0x4bbbc4(0xecd)]()-parseInt(_0x5c6d02))/(0x3e8*0x3c);_0x4bae50>0x5&&_0x4b699c(_0x4bae50);}_0x39d132(),window['showScreen']=_0x257d51,window[_0x4bbbc4(0x13cc)]=_0x151082,window[_0x4bbbc4(0x8e3)]=_0x3832b4,window[_0x4bbbc4(0x107c)]=_0x2dc47e,window[_0x4bbbc4(0x508)]=_0x4efee7,window['switchToMyPhone']=_0x10b4f7,window[_0x4bbbc4(0x1679)]=_0x59caab,window[_0x4bbbc4(0x15f0)]=_0x182e3e,window['openNpcEditor']=_0x15b8e6;const _0x2d7f67=document[_0x4bbbc4(0x2c9)](_0x4bbbc4(0xf8e));_0x2d7f67['id']=_0x4bbbc4(0x1230),_0x2d7f67['innerHTML']='<button\x20id=\x22delete-selected-stickers-btn\x22>删除\x20(0)</button>',document[_0x4bbbc4(0x400)](_0x4bbbc4(0xb39))[_0x4bbbc4(0x8f2)](_0x2d7f67);const _0x1be17f=document[_0x4bbbc4(0x2c9)](_0x4bbbc4(0xa00));_0x1be17f['id']=_0x4bbbc4(0x84d),document[_0x4bbbc4(0x203)]['appendChild'](_0x1be17f),_0x2eb114[_0x4bbbc4(0x10ef)]=document['getElementById'](_0x4bbbc4(0xaa2)),_0x2eb114[_0x4bbbc4(0xfe1)]=document[_0x4bbbc4(0x400)](_0x4bbbc4(0x3f3));const _0x53be9f=localStorage[_0x4bbbc4(0xca2)](_0x4bbbc4(0x1401))||_0x4bbbc4(0x3b3);_0x3cf591(_0x53be9f);const _0x6fc035=document[_0x4bbbc4(0x2c9)](_0x4bbbc4(0xa00));_0x6fc035['id']=_0x4bbbc4(0x2d0),document['head'][_0x4bbbc4(0x8f2)](_0x6fc035);const _0x4f2dfb=document[_0x4bbbc4(0x2c9)](_0x4bbbc4(0xa00));_0x4f2dfb['id']=_0x4bbbc4(0x14e5),document['head'][_0x4bbbc4(0x8f2)](_0x4f2dfb),_0x701933('',_0x4bbbc4(0x1372),_0x4bbbc4(0x2d0)),_0x701933('',_0x4bbbc4(0x116f),'preview-bubble-style'),window[_0x4bbbc4(0x13cc)]=_0x151082,window[_0x4bbbc4(0xecc)]=_0x257d51,window['renderChatListProxy']=_0x41b828,window[_0x4bbbc4(0xc4c)]=_0x44a077,window['renderWallpaperScreenProxy']=_0x364d9f,window[_0x4bbbc4(0x3d8)]=_0x3db57c,await _0x38980a(),_0x3e4f38(),_0x12d3df(_0x4c8b14[_0x4bbbc4(0x14f1)][_0x4bbbc4(0x8cd)]),_0x4459cc(_0x4c8b14[_0x4bbbc4(0x14f1)][_0x4bbbc4(0x139a)]),_0x45e8ca(_0x4c8b14[_0x4bbbc4(0x14f1)][_0x4bbbc4(0x1333)]),await _0x56a543(),_0x1d7c68(_0x4c8b14[_0x4bbbc4(0x14f1)][_0x4bbbc4(0x5e9)]);const _0x109833=parseInt(localStorage[_0x4bbbc4(0xca2)](_0x4bbbc4(0x1555)))||0x0;_0x13e35a(_0x109833);_0x4c8b14['globalSettings']&&_0x4c8b14[_0x4bbbc4(0x14f1)][_0x4bbbc4(0x1302)]&&_0x572a63(_0x4c8b14[_0x4bbbc4(0x14f1)][_0x4bbbc4(0x1302)]);_0x1c881b(),setInterval(_0x1c881b,0x3e8*0x1e),_0x497a54(),_0x58f6f9(),_0x45f4d0(),_0x15f9e9(),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xf12))['addEventListener'](_0x4bbbc4(0x15ad),_0x1e2382=>{const _0x9ebf11=_0x4bbbc4;_0x1e2382[_0x9ebf11(0x657)]['classList'][_0x9ebf11(0xd3f)](_0x9ebf11(0x1159))&&_0x7b9737(_0x1e2382['target'][_0x9ebf11(0xd61)][_0x9ebf11(0x12c4)]);}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x8fa))[_0x4bbbc4(0x501)]('click',()=>_0x41ceaa(null)),document['getElementById'](_0x4bbbc4(0xe8b))['addEventListener']('click',()=>{const _0x593c76=_0x4bbbc4;document['getElementById'](_0x593c76(0x1522))[_0x593c76(0xb08)]['remove'](_0x593c76(0x9eb));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xf8a))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x562539),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xec1))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x23819c=_0x4bbbc4;if(_0x4c8b14['activeChatId']&&!_0x4c8b14[_0x23819c(0xbea)][_0x4c8b14['activeChatId']][_0x23819c(0xc98)]){const _0x234263=_0x4c8b14[_0x23819c(0xbea)][_0x4c8b14[_0x23819c(0x1539)]];_0x34b720(_0x234263['id'],_0x234263['originalName']);}});let _0x2fd0d6=null;function _0x436f74(_0x456a01){const _0x3fe05b=_0x4bbbc4;_0x2fd0d6=_0x456a01;const _0x3cbd2e=_0x4c8b14['chats'][_0x4c8b14[_0x3fe05b(0x1539)]],_0x215775=_0x3cbd2e[_0x3fe05b(0xfd4)][_0x3fe05b(0x821)](_0x4179ef=>_0x4179ef['id']===_0x456a01);if(!_0x215775)return;const _0x2f3059=document[_0x3fe05b(0x400)](_0x3fe05b(0x1433));_0x2f3059[_0x3fe05b(0xde7)]=_0x215775[_0x3fe05b(0x1509)]?_0x3fe05b(0x8a0):_0x3fe05b(0xc93),document[_0x3fe05b(0x400)](_0x3fe05b(0xb78))[_0x3fe05b(0xb08)]['add'](_0x3fe05b(0x9eb));}async function _0x448b3b(){const _0x4eb265=_0x4bbbc4;if(!_0x2fd0d6)return;const _0x2aa5dd=_0x4c8b14[_0x4eb265(0xbea)][_0x4c8b14['activeChatId']],_0x21a4fc=_0x2aa5dd['announcements']['find'](_0x40c942=>_0x40c942['id']===_0x2fd0d6);_0x21a4fc&&(_0x21a4fc[_0x4eb265(0x1509)]=!_0x21a4fc['isPinned'],await _0x54c587['chats'][_0x4eb265(0x4cb)](_0x2aa5dd),_0x17f48e()),document[_0x4eb265(0x400)](_0x4eb265(0xb78))[_0x4eb265(0xb08)][_0x4eb265(0xc46)](_0x4eb265(0x9eb));}async function _0xb5d241(){const _0x23a718=_0x4bbbc4;if(!_0x2fd0d6)return;const _0x9aed13=await _0x56d4d3(_0x23a718(0x713),'确定要删除这条公告吗？此操作不可恢复。',{'confirmButtonClass':_0x23a718(0x142c)});if(_0x9aed13){const _0x14575f=_0x4c8b14[_0x23a718(0xbea)][_0x4c8b14[_0x23a718(0x1539)]];_0x14575f[_0x23a718(0xfd4)]=_0x14575f[_0x23a718(0xfd4)][_0x23a718(0x29d)](_0x529b9a=>_0x529b9a['id']!==_0x2fd0d6),await _0x54c587[_0x23a718(0xbea)][_0x23a718(0x4cb)](_0x14575f),_0x17f48e();}document['getElementById'](_0x23a718(0xb78))[_0x23a718(0xb08)][_0x23a718(0xc46)]('visible');}document[_0x4bbbc4(0x400)](_0x4bbbc4(0x599))[_0x4bbbc4(0x501)]('click',_0x37c595),document[_0x4bbbc4(0x400)]('custom-modal-overlay')[_0x4bbbc4(0x501)]('click',_0x4c9633=>{const _0x37c9f7=_0x4bbbc4;if(_0x4c9633[_0x37c9f7(0x657)]===_0x3c5870)_0x37c595();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1186))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x36939b=_0x4bbbc4,_0x30c75e=await _0x14b058(_0x36939b(0x148e),[{'text':_0x36939b(0x12e5),'value':_0x36939b(0x69f)},{'text':_0x36939b(0xd1a),'value':_0x36939b(0xb8b)},{'text':'传统导出\x20(兼容旧版或内存小的浏览器)','value':_0x36939b(0xf6d)}]);if(_0x30c75e===_0x36939b(0x69f))_0x3497a1();else{if(_0x30c75e==='stream')_0x1cf2d3();else _0x30c75e===_0x36939b(0xf6d)&&_0x4b9be8();}}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x10e1))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x66efd1),document['getElementById']('offline-mode-toggle')['addEventListener']('change',_0x3a9db6=>{const _0x42b335=_0x4bbbc4;document[_0x42b335(0x400)](_0x42b335(0x1189))[_0x42b335(0xa00)][_0x42b335(0xb1a)]=_0x3a9db6[_0x42b335(0x657)][_0x42b335(0x6f9)]?_0x42b335(0x1181):_0x42b335(0x165b);}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x240))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>document['getElementById'](_0x4bbbc4(0x365))[_0x4bbbc4(0x15ad)]()),document[_0x4bbbc4(0x400)]('time-perception-toggle')[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),_0x3fc4b4=>{const _0x48dd82=_0x4bbbc4;document[_0x48dd82(0x400)]('time-zone-group')[_0x48dd82(0xa00)][_0x48dd82(0xb1a)]=_0x3fc4b4['target'][_0x48dd82(0x6f9)]?_0x48dd82(0x1181):_0x48dd82(0x165b);}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x365))[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),_0x1c735d=>_0x2f014f(_0x1c735d[_0x4bbbc4(0x657)][_0x4bbbc4(0x780)][0x0])),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x423))[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),_0x5982b9),document['getElementById'](_0x4bbbc4(0x7ab))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x3bd000=_0x4bbbc4;_0x214dfa={},_0x701933('',_0x3bd000(0x1372),_0x3bd000(0x2d0)),_0x701933('',_0x3bd000(0x116f),_0x3bd000(0x14e5)),_0x4e7c87(),_0x4c8b14[_0x3bd000(0x1539)]=null,_0x257d51('chat-list-screen');}),document['getElementById']('add-chat-btn')[_0x4bbbc4(0x501)]('click',async()=>{const _0x138970=_0x4bbbc4,_0x5bc624=await _0x14b058(_0x138970(0xb1b),[{'text':_0x138970(0x159f),'value':_0x138970(0x873)},{'text':_0x138970(0x88b),'value':_0x138970(0x1366)}]);if(_0x5bc624===_0x138970(0x873)){const _0x1b7421=await _0x25f61f('创建新聊天\x20(第1/2步)','请输入你想为Ta设置的【备注名】(例如:\x20哥哥)');if(!_0x1b7421||!_0x1b7421['trim']())return;const _0x324451=await _0x25f61f(_0x138970(0xb9d),'请输入Ta的【本名】(例如:\x20李星辰，这个名字将用于AI识别)');if(!_0x324451||!_0x324451[_0x138970(0xb8f)]())return;const _0x433f2a='chat_'+Date[_0x138970(0xecd)](),_0x367309={'id':_0x433f2a,'name':_0x1b7421[_0x138970(0xb8f)](),'originalName':_0x324451['trim'](),'isGroup':![],'isPinned':![],'unreadCount':0x0,'relationship':{'status':_0x138970(0x1290),'blockedTimestamp':null,'applicationReason':''},'status':{'text':'在线','lastUpdate':Date['now'](),'isBusy':![]},'settings':{'aiPersona':_0x138970(0x502),'myPersona':_0x138970(0xe86),'myNickname':'我','maxMemory':0xa,'aiAvatar':_0x91d058,'myAvatar':_0x91d058,'background':'','theme':_0x138970(0x855),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[],'aiAvatarLibrary':[],'myAvatarLibrary':[],'enableBackgroundActivity':!![],'actionCooldownMinutes':0xf,'enableTimePerception':!![],'isOfflineMode':![],'offlineMinLength':0x64,'offlineMaxLength':0x12c,'offlinePresetId':null,'timeZone':_0x138970(0xe89)},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[],'thoughtsHistory':[]};_0x4c8b14[_0x138970(0xbea)][_0x433f2a]=_0x367309,await _0x54c587['chats']['put'](_0x367309),_0x41b828();}else{if(_0x5bc624==='import_card')try{await _0x2bf707(),document[_0x138970(0x400)](_0x138970(0x423))[_0x138970(0x15ad)]();}catch(_0x109125){console[_0x138970(0x75e)]('角色卡导入被取消:',_0x109125['message']);}}}),document['getElementById']('add-group-chat-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0xf1960),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1325))['addEventListener']('click',()=>document[_0x4bbbc4(0x400)](_0x4bbbc4(0xdd4))[_0x4bbbc4(0xb08)][_0x4bbbc4(0xc46)](_0x4bbbc4(0x9eb))),document['getElementById'](_0x4bbbc4(0x1030))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x3db65e),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xd9e))[_0x4bbbc4(0x501)]('click',_0x3832b4),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x9c7))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>_0x1beebd(!![])),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x13c8))[_0x4bbbc4(0x501)]('click',_0x4b4650),document[_0x4bbbc4(0x400)]('music-play-pause-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x3d4ee1),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x160a))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x2b0b05),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xf14))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x2dce69),document['getElementById'](_0x4bbbc4(0xda1))['addEventListener'](_0x4bbbc4(0x15ad),_0xd37f0c),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x113b))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x422ce4=_0x4bbbc4;_0x4514b2(),document[_0x422ce4(0x400)](_0x422ce4(0x14ec))[_0x422ce4(0xb08)][_0x422ce4(0x12b6)](_0x422ce4(0x9eb));}),document['getElementById'](_0x4bbbc4(0x540))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>document['getElementById'](_0x4bbbc4(0x14ec))[_0x4bbbc4(0xb08)][_0x4bbbc4(0xc46)](_0x4bbbc4(0x9eb))),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x6b5))['addEventListener'](_0x4bbbc4(0x15ad),_0x33843a),document['getElementById'](_0x4bbbc4(0x7f5))['addEventListener'](_0x4bbbc4(0x15ad),()=>document[_0x4bbbc4(0x400)](_0x4bbbc4(0xe17))[_0x4bbbc4(0x15ad)]()),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xe17))[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),_0x27db58),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1016))['addEventListener']('click',_0x5503a0=>{const _0x37a665=_0x4bbbc4,_0x2b0b9f=_0x5503a0[_0x37a665(0x657)],_0x4901ac=parseInt(_0x2b0b9f[_0x37a665(0xd61)]['index']);if(isNaN(_0x4901ac))return;if(_0x2b0b9f[_0x37a665(0xb08)][_0x37a665(0xd3f)](_0x37a665(0x646)))_0x4d4718(_0x4901ac);else{if(_0x2b0b9f[_0x37a665(0xb08)][_0x37a665(0xd3f)](_0x37a665(0x8ee)))_0x4e8084(_0x4901ac);else{if(_0x2b0b9f[_0x37a665(0xb08)]['contains']('bg-btn'))_0x37ef17(_0x4901ac);else _0x2b0b9f[_0x37a665(0xb08)][_0x37a665(0xd3f)](_0x37a665(0xc55))&&_0xa62cc5(_0x4901ac);}}}),_0x86eb29['addEventListener'](_0x4bbbc4(0x109a),async()=>{const _0x5b72e3=_0x4bbbc4;document[_0x5b72e3(0x400)]('vinyl-view')[_0x5b72e3(0xb08)][_0x5b72e3(0xc46)](_0x5b72e3(0x7cd)),_0x2b0b05(!![]),await new Promise(_0x41f77f=>setTimeout(_0x41f77f,0x32));const _0x366ee8=_0x59adb2[_0x5b72e3(0xc3e)][_0x59adb2[_0x5b72e3(0xbf0)]];if(_0x366ee8&&_0x59adb2[_0x5b72e3(0x11e7)]&&_0x59adb2[_0x5b72e3(0x1539)]){const _0xbe1007=_0x4c8b14['chats'][_0x59adb2[_0x5b72e3(0x1539)]];if(_0xbe1007){const _0x228168={'role':_0x5b72e3(0xaf6),'content':_0x5b72e3(0x11c4)+_0x366ee8[_0x5b72e3(0xf3e)]+'》\x20-\x20'+_0x366ee8[_0x5b72e3(0x833)]+']','timestamp':Date[_0x5b72e3(0xecd)](),'isHidden':!![]};_0xbe1007[_0x5b72e3(0x92c)][_0x5b72e3(0x6bb)](_0x228168),await _0x54c587[_0x5b72e3(0xbea)][_0x5b72e3(0x4cb)](_0xbe1007);}}});const _0x896786=document['getElementById'](_0x4bbbc4(0x919));document['getElementById']('send-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x33a6c7=_0x4bbbc4;_0x2f83fc();const _0x24c698=_0x896786[_0x33a6c7(0xa1e)][_0x33a6c7(0xb8f)]();if(!_0x24c698||!_0x4c8b14[_0x33a6c7(0x1539)])return;const _0x435036=_0x4c8b14[_0x33a6c7(0xbea)][_0x4c8b14[_0x33a6c7(0x1539)]],_0x4191dd={'role':_0x33a6c7(0x6d6),'content':_0x24c698,'timestamp':Date[_0x33a6c7(0xecd)]()};_0x2e2491&&(_0x4191dd[_0x33a6c7(0x1406)]=_0x2e2491),_0x41ecc7(_0x4191dd,_0x435036),((async()=>{const _0x596e51=_0x33a6c7;_0x435036[_0x596e51(0x92c)]['push'](_0x4191dd),await _0x54c587[_0x596e51(0xbea)][_0x596e51(0x4cb)](_0x435036),_0x41b828();})()),_0x896786[_0x33a6c7(0xa1e)]='',_0x896786['style'][_0x33a6c7(0x14af)]=_0x33a6c7(0x5b5),_0x896786[_0x33a6c7(0x797)](),_0x288b5f(),document[_0x33a6c7(0x471)][_0x33a6c7(0xb08)][_0x33a6c7(0xc46)](_0x33a6c7(0x1452));}),document[_0x4bbbc4(0x400)]('wait-reply-btn')[_0x4bbbc4(0x501)]('click',_0x58df1c),_0x896786[_0x4bbbc4(0x501)](_0x4bbbc4(0x6dd),_0x2e97ff=>{const _0xbc5701=_0x4bbbc4;_0x2e97ff[_0xbc5701(0xa30)]===_0xbc5701(0x4b2)&&!_0x2e97ff['shiftKey']&&(_0x2e97ff[_0xbc5701(0x92e)](),document[_0xbc5701(0x400)](_0xbc5701(0x128b))[_0xbc5701(0x15ad)]());}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x6c0))[_0x4bbbc4(0x501)]('change',async _0x30d8e3=>{const _0x39c1b5=_0x4bbbc4,_0x3cdbd8=_0x30d8e3['target'][_0x39c1b5(0x780)][0x0];if(_0x3cdbd8){const _0x33cd12=await new Promise((_0x3cb662,_0x30358c)=>{const _0x2b14cd=_0x39c1b5,_0x68d670=new FileReader();_0x68d670[_0x2b14cd(0x9e0)]=()=>_0x3cb662(_0x68d670[_0x2b14cd(0xdd1)]),_0x68d670['onerror']=()=>_0x30358c(_0x68d670[_0x2b14cd(0x5d7)]),_0x68d670['readAsDataURL'](_0x3cdbd8);});_0x52cc8f=_0x33cd12,_0x364d9f();}}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xd0d))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x4e5141=_0x4bbbc4;_0x52cc8f&&(_0x4c8b14[_0x4e5141(0x14f1)][_0x4e5141(0xed6)]=_0x52cc8f),_0x4c8b14[_0x4e5141(0x14f1)][_0x4e5141(0x5e9)]=document[_0x4e5141(0x400)](_0x4e5141(0xf42))['value']['trim'](),_0x4c8b14[_0x4e5141(0x14f1)][_0x4e5141(0x3a5)]=document[_0x4e5141(0x400)]('notification-sound-url-input')[_0x4e5141(0xa1e)]['trim'](),_0x4c8b14['globalSettings'][_0x4e5141(0x30a)]=document[_0x4e5141(0x400)](_0x4e5141(0x11f3))[_0x4e5141(0x6f9)],_0x4c8b14[_0x4e5141(0x14f1)][_0x4e5141(0x8cd)]=document['getElementById']('phone-frame-toggle-switch')[_0x4e5141(0x6f9)],_0x4c8b14[_0x4e5141(0x14f1)]['enableMinimalChatUI']=document[_0x4e5141(0x400)]('minimal-chat-ui-switch')[_0x4e5141(0x6f9)],_0x4c8b14['globalSettings'][_0x4e5141(0x57f)]=document[_0x4e5141(0x400)](_0x4e5141(0x83b))[_0x4e5141(0x6f9)],_0x4c8b14[_0x4e5141(0x14f1)][_0x4e5141(0x139a)]=document[_0x4e5141(0x400)]('detach-status-bar-switch')[_0x4e5141(0x6f9)],await _0x54c587[_0x4e5141(0x14f1)]['put'](_0x4c8b14[_0x4e5141(0x14f1)]),_0x497a54(),_0x3ed28b(),_0x52cc8f=null,_0x45f4d0(),_0xc8df8a(),_0x1d7c68(_0x4c8b14[_0x4e5141(0x14f1)][_0x4e5141(0x5e9)]),_0x3e4f38(),_0x45e8ca(_0x4c8b14[_0x4e5141(0x14f1)][_0x4e5141(0x1333)]),alert('外观设置已保存并应用！'),_0x257d51('home-screen');});const _0x540d84=document[_0x4bbbc4(0x400)]('messages-view');_0x540d84[_0x4bbbc4(0x501)](_0x4bbbc4(0x1235),()=>{const {scrollTop:_0x55cdf8,scrollHeight:_0x58ae09,clientHeight:_0x453670}=_0x540d84;_0x58ae09-_0x55cdf8-_0x453670<_0x453670&&(!_0x83fa86&&_0x30b607());}),document['getElementById'](_0x4bbbc4(0xbd3))['addEventListener'](_0x4bbbc4(0x15ad),async()=>{const _0x441ffc=_0x4bbbc4;_0x4c8b14['apiConfig']['proxyUrl']=document[_0x441ffc(0x400)](_0x441ffc(0x1222))[_0x441ffc(0xa1e)][_0x441ffc(0xb8f)](),_0x4c8b14['apiConfig'][_0x441ffc(0x9cf)]=document[_0x441ffc(0x400)](_0x441ffc(0x106d))[_0x441ffc(0xa1e)][_0x441ffc(0xb8f)](),_0x4c8b14['apiConfig'][_0x441ffc(0xea4)]=document[_0x441ffc(0x400)](_0x441ffc(0x71f))[_0x441ffc(0xa1e)],_0x4c8b14[_0x441ffc(0x814)][_0x441ffc(0x34d)]=document['getElementById'](_0x441ffc(0xf23))[_0x441ffc(0xa1e)][_0x441ffc(0xb8f)](),_0x4c8b14['apiConfig']['minimaxApiKey']=document[_0x441ffc(0x400)](_0x441ffc(0xb00))[_0x441ffc(0xa1e)][_0x441ffc(0xb8f)](),_0x4c8b14['apiConfig']['minimaxModel']=document[_0x441ffc(0x400)](_0x441ffc(0xacc))[_0x441ffc(0xa1e)],_0x4c8b14[_0x441ffc(0x814)]['secondaryProxyUrl']=document['getElementById']('secondary-proxy-url')['value'][_0x441ffc(0xb8f)](),_0x4c8b14[_0x441ffc(0x814)]['secondaryApiKey']=document[_0x441ffc(0x400)](_0x441ffc(0x165d))['value'][_0x441ffc(0xb8f)](),_0x4c8b14[_0x441ffc(0x814)][_0x441ffc(0xa22)]=document['getElementById']('secondary-model-select')[_0x441ffc(0xa1e)],await _0x54c587[_0x441ffc(0x814)][_0x441ffc(0x4cb)](_0x4c8b14[_0x441ffc(0x814)]);const _0x565720=document['getElementById'](_0x441ffc(0xde2)),_0x19dca8=document[_0x441ffc(0x400)](_0x441ffc(0x1270)),_0x68601d=document[_0x441ffc(0x400)](_0x441ffc(0x5ed));_0x4c8b14[_0x441ffc(0x14f1)][_0x441ffc(0x3c4)]=_0x565720['checked'],_0x4c8b14[_0x441ffc(0x14f1)][_0x441ffc(0xeb0)]=parseInt(_0x19dca8[_0x441ffc(0xa1e)])||0x3c,_0x4c8b14[_0x441ffc(0x14f1)][_0x441ffc(0x1582)]=parseFloat(_0x68601d['value'])||0x1,_0x4c8b14[_0x441ffc(0x14f1)][_0x441ffc(0x7b5)]=document['getElementById'](_0x441ffc(0x759))[_0x441ffc(0x6f9)],_0x4c8b14['globalSettings'][_0x441ffc(0x37b)]=parseInt(document[_0x441ffc(0x400)](_0x441ffc(0x485))[_0x441ffc(0xa1e)])||0x32,_0x4c8b14['globalSettings']['chatListRenderWindow']=parseInt(document['getElementById']('chat-list-render-window-input')[_0x441ffc(0xa1e)])||0x1e,_0x4c8b14[_0x441ffc(0x14f1)][_0x441ffc(0x216)]=parseFloat(document['getElementById'](_0x441ffc(0xd6b))['value']),await _0x54c587[_0x441ffc(0x14f1)][_0x441ffc(0x4cb)](_0x4c8b14[_0x441ffc(0x14f1)]),_0x17fe03();_0x4c8b14[_0x441ffc(0x14f1)]['enableBackgroundActivity']?(_0x29a569(),console[_0x441ffc(0x1e6)](_0x441ffc(0x428)+_0x4c8b14[_0x441ffc(0x14f1)][_0x441ffc(0xeb0)]+'秒')):console[_0x441ffc(0x1e6)](_0x441ffc(0x581));const _0x1e8afd=document['getElementById'](_0x441ffc(0xb43))[_0x441ffc(0x6f9)],_0x20e769=document[_0x441ffc(0x400)]('novelai-model')[_0x441ffc(0xa1e)],_0x5ab2c4=document[_0x441ffc(0x400)](_0x441ffc(0x1570))[_0x441ffc(0xa1e)][_0x441ffc(0xb8f)]();localStorage[_0x441ffc(0x143f)](_0x441ffc(0x1329),_0x1e8afd),localStorage[_0x441ffc(0x143f)]('novelai-model',_0x20e769),localStorage['setItem']('novelai-api-key',_0x5ab2c4),alert(_0x441ffc(0x1531));});const _0x20bd07=document[_0x4bbbc4(0x400)](_0x4bbbc4(0x106d));_0x20bd07[_0x4bbbc4(0x501)](_0x4bbbc4(0x797),_0x59977e=>{const _0x420976=_0x4bbbc4;_0x59977e[_0x420976(0x657)][_0x420976(0xb03)]('type',_0x420976(0x117f));}),_0x20bd07[_0x4bbbc4(0x501)](_0x4bbbc4(0x517),_0x2ed7bc=>{const _0x138b17=_0x4bbbc4;_0x2ed7bc[_0x138b17(0x657)][_0x138b17(0xb03)](_0x138b17(0xbbf),'password');});async function _0x59270f(_0x4e5b3a,_0x536ec9,_0x518ea1){const _0x3e5e02=_0x4bbbc4,_0x4cb810=document[_0x3e5e02(0x400)](_0x4e5b3a)[_0x3e5e02(0xa1e)]['trim'](),_0x4bda1d=document[_0x3e5e02(0x400)](_0x536ec9)[_0x3e5e02(0xa1e)][_0x3e5e02(0xb8f)]();if(!_0x4cb810||!_0x4bda1d)return alert(_0x3e5e02(0xb5a));try{let _0x4f95d1=_0x4cb810===GEMINI_API_URL;const _0x3cece=await fetch(_0x4f95d1?GEMINI_API_URL+_0x3e5e02(0x226)+getRandomValue(_0x4bda1d):_0x4cb810+_0x3e5e02(0xfab),_0x4f95d1?undefined:{'headers':{'Authorization':'Bearer\x20'+_0x4bda1d}});if(!_0x3cece['ok'])throw new Error(_0x3e5e02(0x64a));const _0x4e06d9=await _0x3cece['json']();let _0x1c77b1=_0x4f95d1?_0x4e06d9[_0x3e5e02(0xccf)][_0x3e5e02(0xd18)](_0x42fd6d=>({'id':_0x42fd6d[_0x3e5e02(0xf3e)]['split']('/')[0x1]||_0x42fd6d[_0x3e5e02(0xf3e)]})):_0x4e06d9[_0x3e5e02(0x55b)];const _0x48d556=document[_0x3e5e02(0x400)](_0x518ea1);_0x48d556[_0x3e5e02(0x1575)]='';const _0x4a2a74=_0x518ea1===_0x3e5e02(0x71f)?_0x4c8b14['apiConfig']['model']:_0x4c8b14[_0x3e5e02(0x814)][_0x3e5e02(0xa22)];_0x1c77b1[_0x3e5e02(0xbdc)](_0x99ef13=>{const _0x4faaea=_0x3e5e02,_0x25a808=document[_0x4faaea(0x2c9)](_0x4faaea(0x1053));_0x25a808[_0x4faaea(0xa1e)]=_0x99ef13['id'],_0x25a808[_0x4faaea(0xde7)]=_0x99ef13['id'];if(_0x99ef13['id']===_0x4a2a74)_0x25a808['selected']=!![];_0x48d556[_0x4faaea(0x8f2)](_0x25a808);}),alert(_0x3e5e02(0xf55));}catch(_0x33301d){alert('拉取模型失败:\x20'+_0x33301d['message']);}}document[_0x4bbbc4(0x400)]('fetch-models-btn')['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0x577063=_0x4bbbc4;_0x59270f(_0x577063(0x1222),_0x577063(0x106d),_0x577063(0x71f));}),document[_0x4bbbc4(0x400)]('fetch-secondary-models-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x22d1aa=_0x4bbbc4;_0x59270f(_0x22d1aa(0x15a5),_0x22d1aa(0x165d),'secondary-model-select');}),document[_0x4bbbc4(0x400)]('add-world-book-btn')[_0x4bbbc4(0x501)]('click',async()=>{const _0x13950d=_0x4bbbc4,_0x2d4a18=await _0x25f61f(_0x13950d(0x13ff),_0x13950d(0x1693));if(_0x2d4a18&&_0x2d4a18[_0x13950d(0xb8f)]()){const _0x54ab3e={'id':_0x13950d(0x7e0)+Date[_0x13950d(0xecd)](),'name':_0x2d4a18['trim'](),'content':''};await _0x54c587[_0x13950d(0xf57)]['add'](_0x54ab3e),_0x4c8b14[_0x13950d(0xf57)][_0x13950d(0x6bb)](_0x54ab3e),_0x3db57c(),_0x5a8c1e(_0x54ab3e['id']);}}),document['getElementById'](_0x4bbbc4(0x7f9))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x137e4c=_0x4bbbc4;if(!_0x5e8787)return;const _0x49d259=_0x4c8b14[_0x137e4c(0xf57)][_0x137e4c(0x821)](_0x52835e=>_0x52835e['id']===_0x5e8787);if(!_0x49d259)return;const _0x1ae4a5=document[_0x137e4c(0x400)]('world-book-name-input')[_0x137e4c(0xa1e)][_0x137e4c(0xb8f)]();if(!_0x1ae4a5){alert(_0x137e4c(0x9d8));return;}_0x49d259['name']=_0x1ae4a5;const _0x11d3f3=document[_0x137e4c(0x400)](_0x137e4c(0xdbb))[_0x137e4c(0xa1e)];_0x49d259[_0x137e4c(0x12c4)]=_0x11d3f3?parseInt(_0x11d3f3):null;const _0x6c7a9=document['getElementById']('world-book-entries-container'),_0x563adf=_0x6c7a9[_0x137e4c(0x527)](_0x137e4c(0x1687)),_0x4c28af=[];_0x563adf[_0x137e4c(0xbdc)](_0x3702b3=>{const _0x229cd5=_0x137e4c,_0x1a479f=_0x3702b3[_0x229cd5(0x13ef)](_0x229cd5(0x283))['value']['trim'](),_0x17a83e=_0x3702b3[_0x229cd5(0x13ef)](_0x229cd5(0xf05))[_0x229cd5(0xa1e)][_0x229cd5(0xb8f)](),_0x3b2ce1=_0x3702b3[_0x229cd5(0x13ef)](_0x229cd5(0xf88))[_0x229cd5(0x6f9)];_0x17a83e&&_0x4c28af[_0x229cd5(0x6bb)]({'comment':_0x3702b3[_0x229cd5(0x13ef)](_0x229cd5(0x5b8))[_0x229cd5(0xa1e)][_0x229cd5(0xb8f)](),'keys':_0x1a479f?_0x1a479f[_0x229cd5(0x5ad)](',')[_0x229cd5(0xd18)](_0x81785b=>_0x81785b['trim']())[_0x229cd5(0x29d)](_0x19e635=>_0x19e635):[],'content':_0x17a83e,'enabled':_0x3b2ce1});}),_0x49d259['content']=_0x4c28af,await _0x54c587[_0x137e4c(0xf57)][_0x137e4c(0x4cb)](_0x49d259),document[_0x137e4c(0x400)]('world-book-editor-title')[_0x137e4c(0xde7)]=_0x1ae4a5,_0x5e8787=null,_0x257d51(_0x137e4c(0x3cc)),await _0x3db57c();}),document[_0x4bbbc4(0x400)]('chat-messages')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async _0x4a8f78=>{const _0x23bae1=_0x4bbbc4,_0x30b866=_0x4a8f78[_0x23bae1(0x657)][_0x23bae1(0x117a)](_0x23bae1(0x1253));if(_0x30b866){_0x4a8f78['stopPropagation']();const _0x4b8a37=_0x4a8f78['target']['closest']('.message-bubble');if(_0x4b8a37){const _0x5415f8=parseInt(_0x4b8a37[_0x23bae1(0xd61)][_0x23bae1(0x287)]);!isNaN(_0x5415f8)&&await _0xc3cc03(_0x5415f8,_0x30b866);}return;}const _0x54f16a=_0x4a8f78[_0x23bae1(0x657)][_0x23bae1(0x117a)]('.voice-message-body[data-text]');if(_0x54f16a){const _0x3e42a2=_0x4c8b14[_0x23bae1(0xbea)][_0x4c8b14[_0x23bae1(0x1539)]];if(!_0x3e42a2)return;_0x17328d(_0x54f16a);const _0x39f0e2=_0x54f16a[_0x23bae1(0x117a)](_0x23bae1(0x15d1)),_0x13d6fc=_0x39f0e2?_0x39f0e2[_0x23bae1(0x13ef)](_0x23bae1(0xe85)):null;if(_0x54f16a[_0x23bae1(0xd61)][_0x23bae1(0xd83)]&&_0x13d6fc&&_0x13d6fc['style'][_0x23bae1(0xb1a)]===_0x23bae1(0x1181)){if(_0x3e42a2[_0x23bae1(0xc98)]){console[_0x23bae1(0x1e6)](_0x23bae1(0x1472));return;}if(_0x3e42a2['settings'][_0x23bae1(0x785)]===![]){console[_0x23bae1(0x1e6)]('“'+_0x3e42a2['name']+_0x23bae1(0x2f3));return;}_0x4bf547(_0x54f16a);}return;}const _0x4f394a=_0x4a8f78[_0x23bae1(0x657)]['closest'](_0x23bae1(0xab4));if(_0x4f394a){const _0x4ffcbd=_0x4f394a['closest'](_0x23bae1(0x15d1));if(_0x4ffcbd){const _0x3b734e=parseInt(_0x4ffcbd[_0x23bae1(0xd61)][_0x23bae1(0x287)]);if(!isNaN(_0x3b734e)){_0x55ce33(_0x3b734e);return;}}}const _0x27875e=_0x4a8f78['target'][_0x23bae1(0x117a)](_0x23bae1(0x1207));if(_0x27875e){const _0x37f1cc=_0x27875e['closest'](_0x23bae1(0x15d1));if(_0x37f1cc){const _0x226e14=parseInt(_0x37f1cc[_0x23bae1(0xd61)]['timestamp']),_0x470e4e=_0x27875e[_0x23bae1(0xd61)][_0x23bae1(0x51e)];if(!isNaN(_0x226e14)&&_0x470e4e){await _0x7dbb95(_0x226e14,_0x470e4e);return;}}}const _0x3e1d5e=_0x4a8f78['target']['closest'](_0x23bae1(0x1532));if(_0x3e1d5e){const _0x25b247=parseInt(_0x3e1d5e['dataset'][_0x23bae1(0x2b7)]);if(!isNaN(_0x25b247)){const _0xeabb6f=await _0x54c587[_0x23bae1(0xba7)][_0x23bae1(0xf48)](_0x25b247);if(_0xeabb6f){let _0x3b1da0='';const _0x275f6b=_0xeabb6f[_0x23bae1(0x606)]===_0x23bae1(0x6d6)?_0x4c8b14[_0x23bae1(0x834)][_0x23bae1(0xbf3)]:_0x4c8b14[_0x23bae1(0xbea)][_0xeabb6f[_0x23bae1(0x606)]]?.['name']||_0x23bae1(0x1063);if(_0xeabb6f[_0x23bae1(0xbbf)]===_0x23bae1(0x73a))_0x3b1da0=_0xeabb6f[_0x23bae1(0x1109)];else{_0x3b1da0=_0xeabb6f[_0x23bae1(0xdb3)]||'';if(_0xeabb6f[_0x23bae1(0x1436)])_0x3b1da0+=_0x23bae1(0x1506);if(_0xeabb6f['hiddenContent'])_0x3b1da0+='\x0a[文字图内容:\x20'+_0xeabb6f[_0x23bae1(0x1012)]+']';}_0x138765(_0x23bae1(0x1042)+_0x275f6b+_0x23bae1(0xd89),_0x3b1da0[_0x23bae1(0xe19)](/\n/g,'<br>'));}else _0x138765('提示',_0x23bae1(0x546));}return;}const _0x1bd4d6=_0x4a8f78[_0x23bae1(0x657)][_0x23bae1(0x117a)](_0x23bae1(0x716));if(_0x1bd4d6){const _0x5aadad=_0x1bd4d6[_0x23bae1(0xd61)]['description'];if(_0x5aadad)_0x138765('照片描述',_0x5aadad);return;}const _0x3d9fd6=_0x4a8f78['target'][_0x23bae1(0x117a)](_0x23bae1(0x135e));if(_0x3d9fd6&&_0x3d9fd6[_0x23bae1(0xd61)][_0x23bae1(0xb4d)]){const _0x33cf5e=parseInt(_0x3d9fd6[_0x23bae1(0xd61)][_0x23bae1(0xb4d)]);!isNaN(_0x33cf5e)&&_0x51566f(_0x33cf5e);}const _0x486b8e=_0x4a8f78['target'][_0x23bae1(0x117a)](_0x23bae1(0x14ae));if(_0x486b8e){const _0x9eb2fc=_0x486b8e[_0x23bae1(0x117a)](_0x23bae1(0x15d1));_0x9eb2fc&&_0x2baa87(parseInt(_0x9eb2fc['dataset'][_0x23bae1(0x287)]));}const _0x3b6cfd=_0x4a8f78[_0x23bae1(0x657)][_0x23bae1(0x117a)](_0x23bae1(0x3b9));if(_0x3b6cfd){const _0x19284f=_0x3b6cfd[_0x23bae1(0x117a)](_0x23bae1(0x15d1));if(_0x19284f&&_0x19284f[_0x23bae1(0xd61)]['timestamp']){const _0x2ac926=parseInt(_0x19284f[_0x23bae1(0xd61)][_0x23bae1(0x287)]);_0x3f6023(_0x2ac926);}}const _0x54f846=_0x4a8f78[_0x23bae1(0x657)]['closest'](_0x23bae1(0xc3d));if(_0x54f846){const _0xb52074=parseInt(_0x54f846[_0x23bae1(0xd61)][_0x23bae1(0x63e)]);if(isNaN(_0xb52074))return;const _0x34557d=_0x4a8f78[_0x23bae1(0x657)]['closest'](_0x23bae1(0x6be));if(_0x34557d&&!_0x54f846[_0x23bae1(0xb08)][_0x23bae1(0xd3f)]('closed')){_0x3ea12a(_0xb52074,_0x34557d['dataset'][_0x23bae1(0x1053)]);return;}const _0x168935=_0x4a8f78[_0x23bae1(0x657)]['closest']('.poll-action-btn');if(_0x168935){_0x54f846[_0x23bae1(0xb08)][_0x23bae1(0xd3f)]('closed')?_0x26d52b(_0xb52074):_0x540124(_0xb52074);return;}_0x54f846[_0x23bae1(0xb08)]['contains']('closed')&&_0x26d52b(_0xb52074);}const _0x772fa8=_0x4a8f78[_0x23bae1(0x657)][_0x23bae1(0x117a)](_0x23bae1(0x1563));if(_0x772fa8){const _0x10a923=_0x4c8b14[_0x23bae1(0xbea)][_0x4c8b14[_0x23bae1(0x1539)]],_0x5ad093=_0x772fa8[_0x23bae1(0x117a)](_0x23bae1(0x867));if(_0x10a923&&_0x5ad093){const _0x3aade6=parseInt(_0x5ad093['dataset'][_0x23bae1(0x287)]),_0x131fb9=_0x10a923[_0x23bae1(0x92c)]['find'](_0x23a612=>_0x23a612[_0x23bae1(0x287)]===_0x3aade6);if(_0x131fb9&&_0x131fb9[_0x23bae1(0x492)]){let _0x1a2e3c='';const _0x38e428=_0x131fb9[_0x23bae1(0x492)];_0x38e428[_0x23bae1(0x1327)]===_0x23bae1(0x117f)?_0x1a2e3c=_0x23bae1(0x505)+_0x38e428['originalContent']+'\x22':_0x1a2e3c=_0x23bae1(0x8fe)+_0x38e428[_0x23bae1(0x1327)]+_0x23bae1(0x3cb),_0x138765(_0x23bae1(0x94d),_0x1a2e3c);}}}const _0x529595=_0x4a8f78[_0x23bae1(0x657)]['closest']('.link-share-card');if(_0x529595&&_0x529595[_0x23bae1(0x117a)](_0x23bae1(0x7c9))){const _0x36454f=parseInt(_0x529595[_0x23bae1(0xd61)][_0x23bae1(0x287)]);_0x1d5450(_0x36454f);}const _0x1278aa=_0x4a8f78[_0x23bae1(0x657)]['closest']('.message-bubble');if(_0x1278aa&&_0x1278aa[_0x23bae1(0xb08)][_0x23bae1(0xd3f)]('ai')&&_0x1278aa[_0x23bae1(0xb08)]['contains'](_0x23bae1(0x1175))&&_0x1278aa[_0x23bae1(0xd61)][_0x23bae1(0x12c3)]===_0x23bae1(0x9c6)){const _0x310bde=parseInt(_0x1278aa['dataset'][_0x23bae1(0x287)]);!isNaN(_0x310bde)&&_0x55f11a(_0x310bde);}});const _0x17ac74=document['getElementById'](_0x4bbbc4(0x260)),_0x201df3=document[_0x4bbbc4(0x13ef)]('.custom-multiselect\x20.select-box'),_0x2cea70=document[_0x4bbbc4(0x400)](_0x4bbbc4(0x15a0));function _0x3b89f1(){const _0x548388=_0x4bbbc4,_0x34122d=_0x2cea70[_0x548388(0x527)](_0x548388(0x5f1)),_0x5e1d11=document[_0x548388(0x13ef)](_0x548388(0x1133));if(_0x34122d[_0x548388(0x8d6)]===0x0)_0x5e1d11[_0x548388(0xde7)]='--\x20点击选择\x20--';else{if(_0x34122d[_0x548388(0x8d6)]>0x2)_0x5e1d11[_0x548388(0xde7)]='已选择\x20'+_0x34122d[_0x548388(0x8d6)]+_0x548388(0x1135);else{const _0x52bf58=Array[_0x548388(0xdc0)](_0x34122d)[_0x548388(0xd18)](_0x3c210a=>{const _0x15af7b=_0x548388;return _0x3c210a[_0x15af7b(0x6e6)][_0x15af7b(0xde7)]['trim']();});_0x5e1d11[_0x548388(0xde7)]=_0x52bf58['join'](',\x20');}}}_0x201df3[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x250e9e=>{const _0x21ef18=_0x4bbbc4;_0x250e9e[_0x21ef18(0x504)](),_0x2cea70[_0x21ef18(0xb08)]['toggle'](_0x21ef18(0x9eb)),_0x201df3[_0x21ef18(0xb08)][_0x21ef18(0x146f)](_0x21ef18(0xad0));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x15a0))[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),_0x3b89f1),window[_0x4bbbc4(0x501)]('click',_0x478d17=>{const _0x47fc0d=_0x4bbbc4;!document[_0x47fc0d(0x13ef)](_0x47fc0d(0xd94))[_0x47fc0d(0xd3f)](_0x478d17[_0x47fc0d(0x657)])&&(_0x2cea70[_0x47fc0d(0xb08)][_0x47fc0d(0xc46)](_0x47fc0d(0x9eb)),_0x201df3[_0x47fc0d(0xb08)][_0x47fc0d(0xc46)]('expanded'));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x9b3))[_0x4bbbc4(0x501)]('click',async()=>{const _0x317c81=_0x4bbbc4;_0x1f9f8e();if(!_0x4c8b14[_0x317c81(0x1539)])return;const _0x1993e0=_0x4c8b14[_0x317c81(0xbea)][_0x4c8b14['activeChatId']],_0x298096=_0x1993e0['isGroup'],_0x1af66c=document['getElementById'](_0x317c81(0x445));!_0x298096&&_0x1993e0['settings'][_0x317c81(0x11c2)]&&_0x1993e0[_0x317c81(0xa37)][_0x317c81(0x11c2)][_0x317c81(0x8d6)]>0x0?_0x1af66c[_0x317c81(0xa00)][_0x317c81(0xb1a)]=_0x317c81(0x1181):_0x1af66c[_0x317c81(0xa00)][_0x317c81(0xb1a)]='none';document[_0x317c81(0x400)](_0x317c81(0xc86))[_0x317c81(0xa00)][_0x317c81(0xb1a)]=_0x317c81(0x1181),document[_0x317c81(0x400)](_0x317c81(0x5c7))[_0x317c81(0xa00)][_0x317c81(0xb1a)]=_0x317c81(0x1181),document[_0x317c81(0x400)](_0x317c81(0x14c1))['style'][_0x317c81(0xb1a)]=_0x317c81(0x1181),document[_0x317c81(0x400)](_0x317c81(0x10e7))[_0x317c81(0xa00)][_0x317c81(0xb1a)]=_0x298096?'block':'none',document['getElementById'](_0x317c81(0xfa7))[_0x317c81(0xa00)][_0x317c81(0xb1a)]=_0x298096?_0x317c81(0x165b):_0x317c81(0x1181),document[_0x317c81(0x400)](_0x317c81(0xd2d))[_0x317c81(0xa00)]['display']=_0x298096?_0x317c81(0x1181):_0x317c81(0x165b),document[_0x317c81(0x400)](_0x317c81(0xdbd))[_0x317c81(0xa00)][_0x317c81(0xb1a)]=_0x298096?_0x317c81(0x1181):'none',document['getElementById']('ai-persona-group')[_0x317c81(0xa00)][_0x317c81(0xb1a)]=_0x298096?_0x317c81(0x165b):_0x317c81(0x1181),document[_0x317c81(0x400)]('ai-avatar-group')[_0x317c81(0xa00)][_0x317c81(0xb1a)]=_0x298096?_0x317c81(0x165b):_0x317c81(0x1181),document[_0x317c81(0x400)](_0x317c81(0x102c))[_0x317c81(0xa00)][_0x317c81(0xb1a)]=_0x298096?_0x317c81(0x165b):_0x317c81(0x1181),document[_0x317c81(0x400)](_0x317c81(0xd52))[_0x317c81(0xa00)][_0x317c81(0xb1a)]=_0x298096?_0x317c81(0x165b):_0x317c81(0x1181),document[_0x317c81(0x400)](_0x317c81(0xe9e))[_0x317c81(0xa00)][_0x317c81(0xb1a)]=_0x298096?'none':'block',document[_0x317c81(0x400)]('inject-thought-group')[_0x317c81(0xa00)]['display']=_0x298096?_0x317c81(0x165b):'block',document['getElementById']('offline-mode-group')[_0x317c81(0xa00)][_0x317c81(0xb1a)]=_0x298096?'none':_0x317c81(0x1181),document['getElementById'](_0x317c81(0x293))['style'][_0x317c81(0xb1a)]=_0x298096?_0x317c81(0x165b):_0x317c81(0x1181),document[_0x317c81(0x400)](_0x317c81(0x1061))['style'][_0x317c81(0xb1a)]=_0x298096?_0x317c81(0x1181):'none',document[_0x317c81(0x400)](_0x317c81(0x168e))[_0x317c81(0xa1e)]=_0x1993e0[_0x317c81(0xf3e)],document[_0x317c81(0x400)]('my-persona')[_0x317c81(0xa1e)]=_0x1993e0[_0x317c81(0xa37)][_0x317c81(0x2ef)],document[_0x317c81(0x400)](_0x317c81(0x10f6))[_0x317c81(0x912)]=_0x1993e0[_0x317c81(0xa37)]['myAvatar']||(_0x298096?_0x1f9bfa:_0x91d058),document[_0x317c81(0x400)](_0x317c81(0x15fe))['value']=_0x1993e0['settings'][_0x317c81(0xebb)],document[_0x317c81(0x400)](_0x317c81(0x96f))['value']=_0x1993e0['settings'][_0x317c81(0x412)]||0xa;const _0x30ca70=document[_0x317c81(0x400)](_0x317c81(0x13f9)),_0x232289=document['getElementById'](_0x317c81(0x1193));_0x1993e0[_0x317c81(0xa37)][_0x317c81(0x81e)]?(_0x30ca70['src']=_0x1993e0[_0x317c81(0xa37)]['background'],_0x30ca70[_0x317c81(0xa00)][_0x317c81(0xb1a)]=_0x317c81(0x1181),_0x232289['style'][_0x317c81(0xb1a)]=_0x317c81(0x5f8)):(_0x30ca70[_0x317c81(0xa00)][_0x317c81(0xb1a)]=_0x317c81(0x165b),_0x232289['style']['display']=_0x317c81(0x165b));document['getElementById'](_0x317c81(0xf5b))[_0x317c81(0xa00)]['display']=_0x298096?_0x317c81(0x165b):_0x317c81(0x1181),document[_0x317c81(0x400)](_0x317c81(0xc6e))['style'][_0x317c81(0xb1a)]=_0x298096?'none':'block',document[_0x317c81(0x400)](_0x317c81(0x133c))[_0x317c81(0xa00)][_0x317c81(0xb1a)]=_0x298096?'block':_0x317c81(0x165b);const _0x24e10c=document[_0x317c81(0x400)]('time-perception-toggle'),_0x2a2ab6=document[_0x317c81(0x400)](_0x317c81(0x279));_0x24e10c[_0x317c81(0x6f9)]=_0x1993e0[_0x317c81(0xa37)]['enableTimePerception'],_0x2a2ab6[_0x317c81(0xa00)][_0x317c81(0xb1a)]=_0x24e10c[_0x317c81(0x6f9)]?_0x317c81(0x1181):_0x317c81(0x165b);const _0x1db5c7=document[_0x317c81(0x400)](_0x317c81(0x162f)),_0x4d212e=Intl[_0x317c81(0x463)](_0x317c81(0x9fc));_0x1db5c7[_0x317c81(0x1575)]='',_0x4d212e[_0x317c81(0xbdc)](_0x6d8087=>{const _0x4cc15d=_0x317c81,_0x11ade8=document[_0x4cc15d(0x2c9)](_0x4cc15d(0x1053));_0x11ade8[_0x4cc15d(0xa1e)]=_0x6d8087,_0x11ade8[_0x4cc15d(0xde7)]=_0x6d8087,_0x1db5c7[_0x4cc15d(0x8f2)](_0x11ade8);}),_0x1db5c7[_0x317c81(0xa1e)]=_0x1993e0['settings']['timeZone']||_0x317c81(0xe89);if(_0x298096)document[_0x317c81(0x400)](_0x317c81(0x132b))[_0x317c81(0x6f9)]=_0x1993e0[_0x317c81(0xa37)][_0x317c81(0x3c4)],document[_0x317c81(0x400)](_0x317c81(0x4e9))[_0x317c81(0xa1e)]=_0x1993e0[_0x317c81(0xa37)]['myNickname']||'',document['getElementById'](_0x317c81(0xbb1))[_0x317c81(0x912)]=_0x1993e0[_0x317c81(0xa37)][_0x317c81(0x465)]||_0x4713e3,document[_0x317c81(0x400)]('group-action-cooldown-input')[_0x317c81(0xa1e)]=_0x1993e0[_0x317c81(0xa37)]['actionCooldownMinutes']||0xa,document['getElementById'](_0x317c81(0xc6e))[_0x317c81(0xa00)]['display']=_0x317c81(0x165b),_0x1ddcf6(_0x1993e0[_0x317c81(0x4f8)]);else{document[_0x317c81(0x400)](_0x317c81(0xc6e))[_0x317c81(0xa00)][_0x317c81(0xb1a)]='block',document[_0x317c81(0x400)](_0x317c81(0x9dc))['checked']=_0x1993e0[_0x317c81(0xa37)][_0x317c81(0x3c4)],document[_0x317c81(0x400)](_0x317c81(0xc6c))['checked']=_0x1993e0[_0x317c81(0xa37)][_0x317c81(0x6bf)];const _0x1dcb81=document[_0x317c81(0x400)](_0x317c81(0xa31)),_0x455b61=document[_0x317c81(0x400)](_0x317c81(0x1189)),_0x51e498=document['getElementById'](_0x317c81(0x169b)),_0x340d2e=document[_0x317c81(0x400)]('offline-max-length-input');_0x1dcb81[_0x317c81(0x6f9)]=_0x1993e0[_0x317c81(0xa37)][_0x317c81(0x2a7)]||![],_0x455b61[_0x317c81(0xa00)][_0x317c81(0xb1a)]=_0x1dcb81[_0x317c81(0x6f9)]?'block':_0x317c81(0x165b),_0x51e498[_0x317c81(0xa1e)]=_0x1993e0[_0x317c81(0xa37)]['offlineMinLength']||0x64,_0x340d2e[_0x317c81(0xa1e)]=_0x1993e0[_0x317c81(0xa37)][_0x317c81(0x71c)]||0x12c,await _0x31c41b(_0x1993e0),document[_0x317c81(0x400)]('ai-original-name-input')[_0x317c81(0xa1e)]=_0x1993e0[_0x317c81(0xdcf)],document[_0x317c81(0x400)]('ai-voice-id-input')[_0x317c81(0xa1e)]=_0x1993e0['settings']['minimaxVoiceId']||'',document[_0x317c81(0x400)]('enable-tts-switch')[_0x317c81(0x6f9)]=_0x1993e0[_0x317c81(0xa37)][_0x317c81(0x785)]!==![],document[_0x317c81(0x400)](_0x317c81(0xd4b))[_0x317c81(0xa1e)]=_0x1993e0[_0x317c81(0xa37)][_0x317c81(0xfea)],document[_0x317c81(0x400)](_0x317c81(0x1314))[_0x317c81(0x912)]=_0x1993e0['settings'][_0x317c81(0xb24)]||_0x91d058,document['getElementById'](_0x317c81(0x10ae))[_0x317c81(0xa1e)]=_0x1993e0[_0x317c81(0xa37)][_0x317c81(0x14a8)]||'我',document[_0x317c81(0x400)](_0x317c81(0xf1c))[_0x317c81(0xa1e)]=_0x1993e0[_0x317c81(0xa37)][_0x317c81(0x12c0)]||0xa;const _0x3a7b68=document[_0x317c81(0x400)](_0x317c81(0x152d));_0x3a7b68['innerHTML']=_0x317c81(0xcbe);const _0x2c1f6d=await _0x54c587['qzoneGroups']['toArray']();_0x2c1f6d[_0x317c81(0xbdc)](_0x1d7800=>{const _0x944bc1=_0x317c81,_0x2131ae=document[_0x944bc1(0x2c9)]('option');_0x2131ae[_0x944bc1(0xa1e)]=_0x1d7800['id'],_0x2131ae[_0x944bc1(0xde7)]=_0x1d7800[_0x944bc1(0xf3e)];if(_0x1993e0[_0x944bc1(0x1145)]===_0x1d7800['id'])_0x2131ae['selected']=!![];_0x3a7b68[_0x944bc1(0x8f2)](_0x2131ae);});const _0x34f791=_0x1993e0[_0x317c81(0xa37)][_0x317c81(0x9b1)]||{'vertical':_0x317c81(0x899),'horizontal':_0x317c81(0x1287),'offset':0xa};document['getElementById'](_0x317c81(0x14f4))[_0x317c81(0xa1e)]=_0x34f791[_0x317c81(0x1683)],document[_0x317c81(0x400)](_0x317c81(0x1067))[_0x317c81(0xa1e)]=_0x34f791[_0x317c81(0xde9)],document[_0x317c81(0x400)](_0x317c81(0x674))['value']=_0x34f791[_0x317c81(0x696)];}const _0x5da873=document[_0x317c81(0x400)](_0x317c81(0x15a0));_0x5da873[_0x317c81(0x1575)]='';const [_0x5ddf98,_0x4d0c71]=await Promise[_0x317c81(0x875)]([_0x54c587[_0x317c81(0x2c3)]['toArray'](),_0x54c587['worldBooks'][_0x317c81(0xce1)]()]),_0x20631a=new Set(_0x1993e0[_0x317c81(0xa37)][_0x317c81(0xb0d)]||[]);if(_0x4d0c71[_0x317c81(0x8d6)]===0x0)_0x5da873[_0x317c81(0x1575)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>还没有创建任何世界书</p>';else{_0x5ddf98['forEach'](_0x1be0ac=>{const _0x231fa6=_0x317c81,_0x78200=_0x4d0c71[_0x231fa6(0x29d)](_0x1ada15=>_0x1ada15[_0x231fa6(0x12c4)]===_0x1be0ac['id']);if(_0x78200['length']>0x0){const _0x3cb368=document[_0x231fa6(0x2c9)]('h4');_0x3cb368['textContent']=_0x1be0ac[_0x231fa6(0xf3e)],_0x3cb368['style'][_0x231fa6(0x32e)]=_0x231fa6(0x123f),_0x5da873[_0x231fa6(0x8f2)](_0x3cb368),_0x78200[_0x231fa6(0xbdc)](_0x1bd59f=>{const _0x246d80=_0x231fa6,_0x17338f=_0x20631a['has'](_0x1bd59f['id']),_0x292e59=document[_0x246d80(0x2c9)](_0x246d80(0xf6c));_0x292e59[_0x246d80(0x1575)]=_0x246d80(0x1126)+_0x1bd59f['id']+'\x22\x20'+(_0x17338f?_0x246d80(0x6f9):'')+'>\x20'+_0x1bd59f[_0x246d80(0xf3e)],_0x5da873[_0x246d80(0x8f2)](_0x292e59);});}});const _0xd8b3f=_0x4d0c71['filter'](_0x59dd94=>!_0x59dd94['categoryId']);if(_0xd8b3f[_0x317c81(0x8d6)]>0x0){const _0x52faa4=document['createElement']('h4');_0x52faa4[_0x317c81(0xde7)]=_0x317c81(0xac0),_0x52faa4[_0x317c81(0xa00)][_0x317c81(0x32e)]=_0x317c81(0x7d6),_0x5da873[_0x317c81(0x8f2)](_0x52faa4),_0xd8b3f['forEach'](_0x2fdc2e=>{const _0x56f23b=_0x317c81,_0x3a71d8=_0x20631a[_0x56f23b(0x3e3)](_0x2fdc2e['id']),_0x1b6fc3=document[_0x56f23b(0x2c9)](_0x56f23b(0xf6c));_0x1b6fc3[_0x56f23b(0x1575)]=_0x56f23b(0x1126)+_0x2fdc2e['id']+'\x22\x20'+(_0x3a71d8?_0x56f23b(0x6f9):'')+'>\x20'+_0x2fdc2e[_0x56f23b(0xf3e)],_0x5da873[_0x56f23b(0x8f2)](_0x1b6fc3);});}}_0x3b89f1();const _0x38a25b=document['getElementById'](_0x317c81(0xf59)),_0x57b051=document['getElementById'](_0x317c81(0xdd6)),_0x37b638=document[_0x317c81(0x400)](_0x317c81(0xba5)),_0x264179=_0x1993e0[_0x317c81(0xa37)][_0x317c81(0xf4f)]||[];_0x38a25b[_0x317c81(0x6f9)]=_0x264179[_0x317c81(0x8d6)]>0x0,_0x57b051[_0x317c81(0xa00)]['display']=_0x38a25b['checked']?'block':_0x317c81(0x165b),_0x37b638['innerHTML']='',Object[_0x317c81(0x40a)](_0x4c8b14[_0x317c81(0xbea)])[_0x317c81(0xbdc)](_0x53438d=>{const _0x4e0d80=_0x317c81;if(_0x53438d['id']===_0x1993e0['id'])return;const _0x154a02=_0x264179[_0x4e0d80(0xd1b)](_0x53438d['id']),_0x607066=_0x53438d[_0x4e0d80(0xc98)]?_0x4e0d80(0x1348):_0x4e0d80(0x592),_0x28e3c7=document[_0x4e0d80(0x2c9)](_0x4e0d80(0xf6c));_0x28e3c7[_0x4e0d80(0x1575)]='<input\x20type=\x22checkbox\x22\x20value=\x22'+_0x53438d['id']+'\x22\x20'+(_0x154a02?_0x4e0d80(0x6f9):'')+'>\x20'+_0x607066+'\x20'+_0x53438d['name'],_0x37b638['appendChild'](_0x28e3c7);});function _0x30a7f0(){const _0x9f607c=_0x317c81,_0x4a0c79=_0x37b638['querySelectorAll']('input:checked'),_0x4a7b00=_0x57b051[_0x9f607c(0x13ef)]('.selected-options-text');if(_0x4a0c79['length']===0x0)_0x4a7b00[_0x9f607c(0xde7)]=_0x9f607c(0xaae);else _0x4a0c79['length']>0x2?_0x4a7b00[_0x9f607c(0xde7)]=_0x9f607c(0x3b6)+_0x4a0c79[_0x9f607c(0x8d6)]+'\x20项':_0x4a7b00[_0x9f607c(0xde7)]=Array[_0x9f607c(0xdc0)](_0x4a0c79)[_0x9f607c(0xd18)](_0xebd61c=>_0xebd61c[_0x9f607c(0x6e6)]['textContent'][_0x9f607c(0xb8f)]())[_0x9f607c(0xee1)](',\x20');}_0x30a7f0(),_0x38a25b[_0x317c81(0x501)]('change',()=>{const _0x1dfd59=_0x317c81;_0x57b051[_0x1dfd59(0xa00)]['display']=_0x38a25b[_0x1dfd59(0x6f9)]?_0x1dfd59(0x1181):'none';});const _0x1bd5bc=_0x57b051[_0x317c81(0x13ef)]('.select-box'),_0x282bc2=_0x1bd5bc[_0x317c81(0xdbc)](!![]);_0x1bd5bc[_0x317c81(0xa54)][_0x317c81(0xf6f)](_0x282bc2,_0x1bd5bc),_0x282bc2[_0x317c81(0x501)](_0x317c81(0x15ad),_0x29880f=>{const _0x49da76=_0x317c81;_0x29880f[_0x49da76(0x504)](),_0x37b638[_0x49da76(0xb08)][_0x49da76(0x146f)](_0x49da76(0x9eb)),_0x282bc2[_0x49da76(0xb08)]['toggle'](_0x49da76(0xad0));}),_0x37b638[_0x317c81(0x501)](_0x317c81(0x866),_0x30a7f0);const _0x5f344f=document[_0x317c81(0x13ef)](_0x317c81(0xf35)+(_0x1993e0[_0x317c81(0xa37)][_0x317c81(0xa33)]||_0x317c81(0x855))+'\x22]');if(_0x5f344f)_0x5f344f['checked']=!![];const _0x1c5438=document[_0x317c81(0x400)](_0x317c81(0x100e));_0x1c5438[_0x317c81(0xa1e)]=_0x1993e0[_0x317c81(0xa37)][_0x317c81(0xfe3)]||0xd,document[_0x317c81(0x400)]('font-size-value')[_0x317c81(0xde7)]=_0x1c5438[_0x317c81(0xa1e)]+'px';const _0x1b8ce3=document[_0x317c81(0x400)](_0x317c81(0x4ed));_0x1b8ce3[_0x317c81(0xa1e)]=_0x1993e0[_0x317c81(0xa37)][_0x317c81(0xc4d)]||'',_0x290380(),document[_0x317c81(0x400)](_0x317c81(0xd26))[_0x317c81(0x6f9)]=_0x1993e0['settings'][_0x317c81(0xb36)]||![],document[_0x317c81(0x400)]('auto-memory-interval')[_0x317c81(0xa1e)]=_0x1993e0[_0x317c81(0xa37)][_0x317c81(0x9f1)]||0x14,setTimeout(()=>{const _0x5e6fa5=_0x317c81;_0xf9cf89();const _0x3a6642=[_0x5e6fa5(0xd4b),_0x5e6fa5(0x63c),_0x5e6fa5(0x15fe),'linked-memory-count',_0x5e6fa5(0xd26),'auto-memory-interval',_0x5e6fa5(0xa31),_0x5e6fa5(0x169b),_0x5e6fa5(0x67d),_0x5e6fa5(0xb30)];_0x3a6642[_0x5e6fa5(0xbdc)](_0x59204a=>{const _0x5bbde6=_0x5e6fa5,_0x57944e=document[_0x5bbde6(0x400)](_0x59204a);_0x57944e&&_0x57944e[_0x5bbde6(0x501)](_0x5bbde6(0x10a8),_0xf9cf89);}),document[_0x5e6fa5(0x400)](_0x5e6fa5(0x15a0))[_0x5e6fa5(0x501)](_0x5e6fa5(0x866),_0xf9cf89),document['getElementById'](_0x5e6fa5(0xba5))[_0x5e6fa5(0x501)](_0x5e6fa5(0x866),_0xf9cf89),document[_0x5e6fa5(0x400)](_0x5e6fa5(0xf59))[_0x5e6fa5(0x501)](_0x5e6fa5(0x866),_0xf9cf89);},0x64),_0x257d51(_0x317c81(0xdca));});function _0x1ddcf6(_0x134fc3){const _0x323489=_0x4bbbc4,_0x182abf=document[_0x323489(0x400)]('group-members-settings');_0x182abf[_0x323489(0x1575)]='',_0x134fc3['forEach'](_0x222262=>{const _0x846ddb=_0x323489,_0x11714d=document['createElement'](_0x846ddb(0xf8e));_0x11714d['className']=_0x846ddb(0x15fb),_0x11714d[_0x846ddb(0xd61)]['memberId']=_0x222262['id'];const _0x23553e=_0x222262['avatar']||(_0x4c8b14['chats'][_0x222262['id']]?_0x4c8b14[_0x846ddb(0xbea)][_0x222262['id']][_0x846ddb(0xa37)][_0x846ddb(0xb24)]:_0x1e2f0a);_0x11714d[_0x846ddb(0x1575)]=_0x846ddb(0x97d)+_0x23553e+_0x846ddb(0x7fd)+_0x222262[_0x846ddb(0x7ca)]+_0x846ddb(0x1025)+_0x222262[_0x846ddb(0x7ca)]+_0x846ddb(0x11ac),_0x11714d[_0x846ddb(0x501)](_0x846ddb(0x15ad),()=>_0x50b199(_0x222262['id'])),_0x182abf[_0x846ddb(0x8f2)](_0x11714d);});}document[_0x4bbbc4(0x400)](_0x4bbbc4(0xc7c))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x446f0b=_0x4bbbc4;if(!_0x36da93)return;const _0x19a5ed=_0x4c8b14[_0x446f0b(0xbea)][_0x4c8b14[_0x446f0b(0x1539)]],_0x672c81=_0x19a5ed['members']['find'](_0x4e61eb=>_0x4e61eb['id']===_0x36da93);if(!_0x672c81)return;const _0x74dbaa=document['getElementById'](_0x446f0b(0x630))[_0x446f0b(0xa1e)][_0x446f0b(0xb8f)]();if(!_0x74dbaa){alert(_0x446f0b(0xcb4));return;}_0x672c81[_0x446f0b(0x7ca)]=_0x74dbaa,_0x672c81['persona']=document[_0x446f0b(0x400)]('member-persona-input')[_0x446f0b(0xa1e)];const _0x5a02b8=document['getElementById'](_0x446f0b(0x1505))[_0x446f0b(0x912)];_0x672c81['avatar']=_0x5a02b8;const _0x53a890=_0x4c8b14[_0x446f0b(0xbea)][_0x672c81['id']];_0x53a890&&(_0x53a890[_0x446f0b(0xa37)][_0x446f0b(0xb24)]=_0x5a02b8,await _0x54c587[_0x446f0b(0xbea)]['put'](_0x53a890)),await _0x54c587[_0x446f0b(0xbea)]['put'](_0x19a5ed),_0x1ddcf6(_0x19a5ed[_0x446f0b(0x4f8)]),document['getElementById'](_0x446f0b(0xbc3))[_0x446f0b(0xb08)]['remove'](_0x446f0b(0x9eb)),_0x36da93=null;});function _0x50b199(_0x2f0e2f){const _0x1ed8f3=_0x4bbbc4;_0x36da93=_0x2f0e2f;const _0x55f3d=_0x4c8b14[_0x1ed8f3(0xbea)][_0x4c8b14['activeChatId']],_0x33702d=_0x55f3d['members'][_0x1ed8f3(0x821)](_0x8dce9c=>_0x8dce9c['id']===_0x2f0e2f);if(!_0x33702d)return;document['getElementById'](_0x1ed8f3(0x630))['value']=_0x33702d[_0x1ed8f3(0x7ca)],document[_0x1ed8f3(0x400)]('member-persona-input')[_0x1ed8f3(0xa1e)]=_0x33702d[_0x1ed8f3(0x9a2)];const _0x3cb376=_0x33702d[_0x1ed8f3(0xa9a)]||(_0x4c8b14['chats'][_0x33702d['id']]?_0x4c8b14[_0x1ed8f3(0xbea)][_0x33702d['id']][_0x1ed8f3(0xa37)][_0x1ed8f3(0xb24)]:_0x1e2f0a);document[_0x1ed8f3(0x400)](_0x1ed8f3(0x1505))['src']=_0x3cb376,document[_0x1ed8f3(0x400)](_0x1ed8f3(0xbc3))[_0x1ed8f3(0xb08)][_0x1ed8f3(0x12b6)](_0x1ed8f3(0x9eb));}document[_0x4bbbc4(0x400)](_0x4bbbc4(0xbeb))['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0x1f560c=_0x4bbbc4;document['getElementById'](_0x1f560c(0xbc3))[_0x1f560c(0xb08)][_0x1f560c(0xc46)](_0x1f560c(0x9eb)),_0x36da93=null;}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xc7c))[_0x4bbbc4(0x501)]('click',async()=>{const _0x563830=_0x4bbbc4;if(!_0x36da93)return;const _0x1bf847=_0x4c8b14[_0x563830(0xbea)][_0x4c8b14['activeChatId']],_0x4a622c=_0x1bf847[_0x563830(0x4f8)]['find'](_0x1a06a8=>_0x1a06a8['id']===_0x36da93);if(!_0x4a622c)return;const _0x4037aa=document[_0x563830(0x400)]('member-name-input')[_0x563830(0xa1e)][_0x563830(0xb8f)]();if(!_0x4037aa){alert(_0x563830(0xcb4));return;}_0x4a622c[_0x563830(0x7ca)]=_0x4037aa,_0x4a622c[_0x563830(0x9a2)]=document['getElementById'](_0x563830(0x6de))[_0x563830(0xa1e)];const _0x5c24a0=document[_0x563830(0x400)](_0x563830(0x1505))[_0x563830(0x912)];_0x4a622c[_0x563830(0xa9a)]=_0x5c24a0;const _0x5c8f65=_0x4c8b14['chats'][_0x4a622c['id']];_0x5c8f65&&(_0x5c8f65[_0x563830(0xa37)][_0x563830(0xb24)]=_0x5c24a0,await _0x54c587['chats'][_0x563830(0x4cb)](_0x5c8f65)),await _0x54c587['chats'][_0x563830(0x4cb)](_0x1bf847),_0x1ddcf6(_0x1bf847[_0x563830(0x4f8)]),document[_0x563830(0x400)]('member-settings-modal')[_0x563830(0xb08)][_0x563830(0xc46)](_0x563830(0x9eb)),_0x36da93=null;}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xc2a))[_0x4bbbc4(0x501)]('click',()=>{const _0x3a3c08=_0x4bbbc4;document[_0x3a3c08(0x400)](_0x3a3c08(0x65f))[_0x3a3c08(0x6f9)]=!![];}),document['getElementById'](_0x4bbbc4(0x281))[_0x4bbbc4(0x501)]('click',async()=>{const _0x203206=_0x4bbbc4;if(!_0x4c8b14[_0x203206(0x1539)])return;const _0xafdd40=_0x4c8b14[_0x203206(0xbea)][_0x4c8b14[_0x203206(0x1539)]],_0x3befb8=_0xafdd40['settings'][_0x203206(0x2a7)]||![],_0x548c2d=document[_0x203206(0x400)]('chat-name-input')['value'][_0x203206(0xb8f)]();if(!_0x548c2d)return alert(_0x203206(0x8ac));if(!_0xafdd40[_0x203206(0xc98)]&&_0x548c2d!==_0xafdd40['name']){if(!_0xafdd40[_0x203206(0x112b)])_0xafdd40['nameHistory']=[];if(!_0xafdd40['nameHistory'][_0x203206(0xd1b)](_0xafdd40[_0x203206(0xf3e)]))_0xafdd40['nameHistory'][_0x203206(0x6bb)](_0xafdd40[_0x203206(0xf3e)]);}_0xafdd40['name']=_0x548c2d;const _0x220f0a=document[_0x203206(0x13ef)](_0x203206(0xafe));_0xafdd40['settings'][_0x203206(0xa33)]=_0x220f0a?_0x220f0a[_0x203206(0xa1e)]:'default',_0xafdd40[_0x203206(0xa37)][_0x203206(0xfe3)]=parseInt(document[_0x203206(0x400)](_0x203206(0x100e))[_0x203206(0xa1e)]),_0xafdd40[_0x203206(0xa37)]['customCss']=document['getElementById'](_0x203206(0x4ed))['value'][_0x203206(0xb8f)](),_0xafdd40[_0x203206(0xa37)][_0x203206(0x2ef)]=document['getElementById']('my-persona')[_0x203206(0xa1e)],_0xafdd40['settings'][_0x203206(0x12d3)]=document['getElementById'](_0x203206(0x10f6))[_0x203206(0x912)],_0xafdd40[_0x203206(0xa37)][_0x203206(0xebb)]=parseInt(document['getElementById'](_0x203206(0x15fe))[_0x203206(0xa1e)])||0xa,_0xafdd40[_0x203206(0xa37)][_0x203206(0x412)]=parseInt(document['getElementById'](_0x203206(0x96f))[_0x203206(0xa1e)])||0xa;const _0x51d7b8=document[_0x203206(0x527)]('#world-book-checkboxes-container\x20input[type=\x22checkbox\x22]:checked'),_0x303662=[];_0x51d7b8[_0x203206(0xbdc)](_0x1243c0=>{const _0x1e7543=_0x203206;_0x1243c0[_0x1e7543(0xa1e)][_0x1e7543(0xbb9)](_0x1e7543(0x160f))&&_0x303662[_0x1e7543(0x6bb)](_0x1243c0[_0x1e7543(0xa1e)][_0x1e7543(0xe19)](_0x1e7543(0x160f),''));}),_0xafdd40[_0x203206(0xa37)][_0x203206(0xb0d)]=_0x303662;const _0x3213f5=document[_0x203206(0x400)]('link-memory-toggle')['checked'];if(_0x3213f5){const _0x387d8b=document[_0x203206(0x527)](_0x203206(0xe99));_0xafdd40[_0x203206(0xa37)][_0x203206(0xf4f)]=Array['from'](_0x387d8b)[_0x203206(0xd18)](_0x2da312=>_0x2da312[_0x203206(0xa1e)]);}else _0xafdd40[_0x203206(0xa37)][_0x203206(0xf4f)]=[];_0xafdd40[_0x203206(0xa37)][_0x203206(0xb36)]=document[_0x203206(0x400)](_0x203206(0xd26))[_0x203206(0x6f9)],_0xafdd40[_0x203206(0xa37)][_0x203206(0x9f1)]=parseInt(document['getElementById']('auto-memory-interval')[_0x203206(0xa1e)])||0x14,_0xafdd40['settings']['enableTimePerception']=document['getElementById']('time-perception-toggle')['checked'],_0xafdd40[_0x203206(0xa37)][_0x203206(0x9fc)]=document['getElementById'](_0x203206(0x162f))[_0x203206(0xa1e)];if(_0xafdd40[_0x203206(0xc98)])_0xafdd40[_0x203206(0xa37)][_0x203206(0x3c4)]=document['getElementById']('group-background-activity-switch')[_0x203206(0x6f9)],_0xafdd40['settings'][_0x203206(0x14a8)]=document[_0x203206(0x400)](_0x203206(0x4e9))['value'][_0x203206(0xb8f)](),_0xafdd40[_0x203206(0xa37)][_0x203206(0x465)]=document['getElementById'](_0x203206(0xbb1))[_0x203206(0x912)],_0xafdd40[_0x203206(0xa37)][_0x203206(0x12c0)]=parseInt(document['getElementById'](_0x203206(0xffe))[_0x203206(0xa1e)])||0xa;else{_0xafdd40[_0x203206(0xa37)][_0x203206(0x3c4)]=document[_0x203206(0x400)](_0x203206(0x9dc))['checked'];const _0x49120a=document[_0x203206(0x400)](_0x203206(0xa31))[_0x203206(0x6f9)];_0xafdd40[_0x203206(0xa37)][_0x203206(0x2a7)]=_0x49120a;if(_0x3befb8===!![]&&_0x49120a===![]){const _0x4b955c={'role':'system','content':_0x203206(0x22b),'timestamp':Date[_0x203206(0xecd)](),'isHidden':!![]};_0xafdd40[_0x203206(0x92c)][_0x203206(0x6bb)](_0x4b955c),console[_0x203206(0x1e6)](_0x203206(0x391));}_0xafdd40[_0x203206(0xa37)][_0x203206(0x6bf)]=document['getElementById']('inject-thought-toggle')['checked'],_0xafdd40['settings'][_0x203206(0x245)]=parseInt(document[_0x203206(0x400)]('offline-min-length-input')[_0x203206(0xa1e)])||0x64,_0xafdd40[_0x203206(0xa37)][_0x203206(0x71c)]=parseInt(document['getElementById']('offline-max-length-input')['value'])||0x12c,_0xafdd40[_0x203206(0xa37)][_0x203206(0x8ae)]=document[_0x203206(0x400)]('offline-preset-select')[_0x203206(0xa1e)]||null;const _0x117b90=document[_0x203206(0x400)]('ai-original-name-input')[_0x203206(0xa1e)][_0x203206(0xb8f)]();if(!_0x117b90)return alert('对方本名不能为空！');_0xafdd40[_0x203206(0xdcf)]=_0x117b90,_0xafdd40['settings'][_0x203206(0xfea)]=document['getElementById'](_0x203206(0xd4b))[_0x203206(0xa1e)],_0xafdd40[_0x203206(0xa37)]['minimaxVoiceId']=document['getElementById'](_0x203206(0x90a))['value'][_0x203206(0xb8f)](),_0xafdd40['settings'][_0x203206(0x785)]=document['getElementById'](_0x203206(0xd1c))[_0x203206(0x6f9)],_0xafdd40[_0x203206(0xa37)]['aiAvatar']=document[_0x203206(0x400)](_0x203206(0x1314))[_0x203206(0x912)],_0xafdd40[_0x203206(0xa37)]['myNickname']=document['getElementById'](_0x203206(0x10ae))[_0x203206(0xa1e)][_0x203206(0xb8f)]()||'我',_0xafdd40[_0x203206(0xa37)][_0x203206(0x12c0)]=parseInt(document[_0x203206(0x400)](_0x203206(0xf1c))[_0x203206(0xa1e)])||0xa,_0xafdd40['settings'][_0x203206(0x9b1)]={'vertical':document['getElementById'](_0x203206(0x14f4))[_0x203206(0xa1e)],'horizontal':document[_0x203206(0x400)](_0x203206(0x1067))['value'],'offset':parseInt(document[_0x203206(0x400)](_0x203206(0x674))['value'])||0xa};const _0x3b7869=document['getElementById'](_0x203206(0x152d))[_0x203206(0xa1e)];_0xafdd40['groupId']=_0x3b7869?parseInt(_0x3b7869):null;}await _0x54c587[_0x203206(0xbea)][_0x203206(0x4cb)](_0xafdd40),!_0xafdd40[_0x203206(0xc98)]&&(await _0xed04e8(_0xafdd40),await _0x5f3a56(_0xafdd40)),_0x1478ca(_0xafdd40),_0x701933(_0xafdd40['settings'][_0x203206(0xc4d)],_0x203206(0x1372),'custom-bubble-style'),_0x257d51('chat-interface-screen'),_0x26354c(_0x4c8b14[_0x203206(0x1539)]),_0x41b828();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xdca))['addEventListener'](_0x4bbbc4(0x15ad),_0x350cbb=>{const _0x126e5c=_0x4bbbc4;_0x350cbb[_0x126e5c(0x657)][_0x126e5c(0xb08)][_0x126e5c(0xd3f)](_0x126e5c(0x1241))&&_0x2359a1(_0x126e5c(0x4e3));}),document[_0x4bbbc4(0x400)]('member-settings-modal')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x536c97=>{const _0x43f703=_0x4bbbc4;_0x536c97[_0x43f703(0x657)][_0x43f703(0xb08)][_0x43f703(0xd3f)](_0x43f703(0x1241))&&_0x2359a1('member');});const _0xee699b=document[_0x4bbbc4(0x400)](_0x4bbbc4(0x692)),_0x280d86=document[_0x4bbbc4(0x400)]('ai-frame-tab'),_0x452850=document[_0x4bbbc4(0x400)]('my-frame-tab'),_0x54305d=document[_0x4bbbc4(0x400)](_0x4bbbc4(0x37e)),_0xe78dd=document[_0x4bbbc4(0x400)](_0x4bbbc4(0x534));document['getElementById'](_0x4bbbc4(0xe47))['addEventListener'](_0x4bbbc4(0x15ad),_0xd2a71d),document[_0x4bbbc4(0x400)]('cancel-frame-settings-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x59867c=_0x4bbbc4;_0xee699b[_0x59867c(0xb08)][_0x59867c(0xc46)](_0x59867c(0x9eb)),_0x28b5be=![];}),_0x280d86['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0x34655d=_0x4bbbc4;_0x280d86[_0x34655d(0xb08)][_0x34655d(0x12b6)]('active'),_0x452850['classList'][_0x34655d(0xc46)]('active'),_0x54305d['style']['display']=_0x34655d(0x1181),_0xe78dd['style'][_0x34655d(0xb1a)]=_0x34655d(0x165b);}),_0x452850[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x1e22b0=_0x4bbbc4;_0x452850[_0x1e22b0(0xb08)]['add'](_0x1e22b0(0x5d6)),_0x280d86['classList'][_0x1e22b0(0xc46)](_0x1e22b0(0x5d6)),_0xe78dd['style']['display']=_0x1e22b0(0x1181),_0x54305d['style'][_0x1e22b0(0xb1a)]='none';}),document['getElementById'](_0x4bbbc4(0x442))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x46f4fe=_0x4bbbc4;if(!_0x4c8b14['activeChatId'])return;const _0x16d6cb=_0x4c8b14[_0x46f4fe(0xbea)][_0x4c8b14[_0x46f4fe(0x1539)]],_0x22cc2f=await _0x56d4d3(_0x46f4fe(0xca7),_0x46f4fe(0x113e),{'confirmButtonClass':_0x46f4fe(0x142c)});_0x22cc2f&&(_0x16d6cb[_0x46f4fe(0x92c)]=[],_0x16d6cb['heartfeltVoice']=_0x46f4fe(0x166b),_0x16d6cb[_0x46f4fe(0x13e5)]=_0x46f4fe(0x166b),await _0x54c587[_0x46f4fe(0xbea)]['put'](_0x16d6cb),_0x26354c(_0x4c8b14[_0x46f4fe(0x1539)]),_0x41b828(),_0x17ac74[_0x46f4fe(0xb08)][_0x46f4fe(0xc46)](_0x46f4fe(0x9eb)));});const _0x58c8a5=(_0x18cfec,_0x38b069)=>{const _0x41660c=_0x4bbbc4;document['getElementById'](_0x18cfec)[_0x41660c(0x501)](_0x41660c(0x866),async _0x574705=>{const _0x3d3797=_0x41660c,_0x1ee1aa=_0x574705[_0x3d3797(0x657)][_0x3d3797(0x780)][0x0];if(_0x1ee1aa){const _0x4db6b2=await new Promise((_0x86770a,_0x1023c2)=>{const _0x5df0d9=_0x3d3797,_0x15dfde=new FileReader();_0x15dfde['onload']=()=>_0x86770a(_0x15dfde[_0x5df0d9(0xdd1)]),_0x15dfde[_0x5df0d9(0x96d)]=()=>_0x1023c2(_0x15dfde[_0x5df0d9(0x5d7)]),_0x15dfde['readAsDataURL'](_0x1ee1aa);});_0x38b069(_0x4db6b2),_0x574705[_0x3d3797(0x657)][_0x3d3797(0xa1e)]=null;}});};_0x58c8a5(_0x4bbbc4(0x6aa),_0xa9dbb7=>document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1314))[_0x4bbbc4(0x912)]=_0xa9dbb7),_0x58c8a5('my-avatar-input',_0x1d9ed4=>document['getElementById']('my-avatar-preview')['src']=_0x1d9ed4),_0x58c8a5(_0x4bbbc4(0x155e),_0x1c71cd=>document[_0x4bbbc4(0x400)]('group-avatar-preview')[_0x4bbbc4(0x912)]=_0x1c71cd),_0x58c8a5(_0x4bbbc4(0xf5f),_0x249cd4=>document['getElementById']('member-avatar-preview')[_0x4bbbc4(0x912)]=_0x249cd4),_0x58c8a5(_0x4bbbc4(0x78e),_0x4701c2=>{const _0x295943=_0x4bbbc4;if(_0x4c8b14['activeChatId']){_0x4c8b14[_0x295943(0xbea)][_0x4c8b14[_0x295943(0x1539)]]['settings'][_0x295943(0x81e)]=_0x4701c2;const _0x29340b=document[_0x295943(0x400)](_0x295943(0x13f9));_0x29340b[_0x295943(0x912)]=_0x4701c2,_0x29340b[_0x295943(0xa00)][_0x295943(0xb1a)]=_0x295943(0x1181),document[_0x295943(0x400)](_0x295943(0x1193))['style']['display']='inline-block';}}),_0x58c8a5(_0x4bbbc4(0x1280),_0x2cb43e=>document[_0x4bbbc4(0x400)](_0x4bbbc4(0x15b0))[_0x4bbbc4(0x912)]=_0x2cb43e),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1193))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x4d46eb=_0x4bbbc4;if(_0x4c8b14['activeChatId']){_0x4c8b14['chats'][_0x4c8b14[_0x4d46eb(0x1539)]][_0x4d46eb(0xa37)][_0x4d46eb(0x81e)]='';const _0x2af702=document[_0x4d46eb(0x400)](_0x4d46eb(0x13f9));_0x2af702[_0x4d46eb(0x912)]='',_0x2af702[_0x4d46eb(0xa00)][_0x4d46eb(0xb1a)]='none',document['getElementById']('remove-bg-btn')[_0x4d46eb(0xa00)][_0x4d46eb(0xb1a)]='none';}});const _0x88620e=document[_0x4bbbc4(0x400)]('sticker-panel');document[_0x4bbbc4(0x400)](_0x4bbbc4(0xb7f))['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0x5469ef=_0x4bbbc4,_0x43f80e=_0x4c8b14[_0x5469ef(0xbea)][_0x4c8b14[_0x5469ef(0x1539)]];_0x43f80e&&_0x43f80e[_0x5469ef(0xa37)]['stickerCategoryId']?_0xc6535b=_0x43f80e['settings'][_0x5469ef(0x1510)]:_0xc6535b='all',_0x11d8fe(),_0x88620e[_0x5469ef(0xb08)][_0x5469ef(0x12b6)](_0x5469ef(0x9eb));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xe90))[_0x4bbbc4(0x501)]('click',()=>_0x88620e[_0x4bbbc4(0xb08)]['remove'](_0x4bbbc4(0x9eb))),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xf31))['addEventListener'](_0x4bbbc4(0x15ad),_0x5573f4),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xa5a))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>document[_0x4bbbc4(0x400)](_0x4bbbc4(0x11f0))[_0x4bbbc4(0x15ad)]()),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x11f0))['addEventListener'](_0x4bbbc4(0x866),async _0x2adbdb=>{const _0xadac78=_0x4bbbc4,_0x2c999c=_0x2adbdb[_0xadac78(0x657)][_0xadac78(0x780)][0x0];if(!_0x2c999c)return;const _0x4e3810=new FileReader();_0x4e3810[_0xadac78(0x157f)](_0x2c999c),_0x4e3810[_0xadac78(0x9e0)]=async()=>{const _0x1449c5=_0xadac78,_0x434298=_0x4e3810[_0x1449c5(0xdd1)],_0x3e292b=await _0x25f61f(_0x1449c5(0x6d7),'请为这个表情命名\x20(例如：好耶、疑惑)');if(_0x3e292b&&_0x3e292b[_0x1449c5(0xb8f)]()){const _0x80b7de={'id':_0x1449c5(0xc30)+Date['now'](),'url':_0x434298,'name':_0x3e292b[_0x1449c5(0xb8f)](),'categoryId':_0xc6535b!==_0x1449c5(0x875)&&_0xc6535b!==_0x1449c5(0x13c3)?_0xc6535b:null};await _0x54c587[_0x1449c5(0x120c)]['add'](_0x80b7de),_0x4c8b14[_0x1449c5(0x120c)][_0x1449c5(0x6bb)](_0x80b7de),_0x11d8fe();}else{if(_0x3e292b!==null)alert('表情名不能为空！');}},_0x2adbdb['target']['value']=null;}),document['getElementById'](_0x4bbbc4(0x1414))['addEventListener']('click',()=>document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1249))[_0x4bbbc4(0x15ad)]()),document['getElementById'](_0x4bbbc4(0x1249))[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),async _0x3bee42=>{const _0x4a612b=_0x4bbbc4,_0x6853ed=_0x3bee42[_0x4a612b(0x657)][_0x4a612b(0x780)][0x0];if(!_0x6853ed||!_0x4c8b14[_0x4a612b(0x1539)])return;const _0x4064e8=new FileReader();_0x4064e8[_0x4a612b(0x9e0)]=async _0x495f41=>{const _0x5a9d83=_0x4a612b,_0xb0b96c=_0x495f41[_0x5a9d83(0x657)][_0x5a9d83(0xdd1)],_0x1aa694=_0x4c8b14['chats'][_0x4c8b14['activeChatId']],_0x1736f4={'role':_0x5a9d83(0x6d6),'content':[{'type':_0x5a9d83(0x164d),'image_url':{'url':_0xb0b96c}}],'timestamp':Date[_0x5a9d83(0xecd)]()};_0x1aa694[_0x5a9d83(0x92c)][_0x5a9d83(0x6bb)](_0x1736f4),await _0x54c587['chats'][_0x5a9d83(0x4cb)](_0x1aa694),_0x41ecc7(_0x1736f4,_0x1aa694),_0x41b828();},_0x4064e8['readAsDataURL'](_0x6853ed),_0x3bee42[_0x4a612b(0x657)][_0x4a612b(0xa1e)]=null;}),document[_0x4bbbc4(0x400)]('voice-message-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x439396=_0x4bbbc4;if(!_0x4c8b14[_0x439396(0x1539)])return;const _0x2e7fbf=await _0x25f61f(_0x439396(0xe7c),_0x439396(0x102a));if(_0x2e7fbf&&_0x2e7fbf['trim']()){const _0x1e7393=_0x4c8b14[_0x439396(0xbea)][_0x4c8b14[_0x439396(0x1539)]],_0x3c0e17={'role':_0x439396(0x6d6),'type':_0x439396(0x295),'content':_0x2e7fbf[_0x439396(0xb8f)](),'timestamp':Date[_0x439396(0xecd)]()};_0x1e7393['history'][_0x439396(0x6bb)](_0x3c0e17),await _0x54c587[_0x439396(0xbea)][_0x439396(0x4cb)](_0x1e7393),_0x41ecc7(_0x3c0e17,_0x1e7393),_0x41b828();}}),document[_0x4bbbc4(0x400)]('send-photo-btn')[_0x4bbbc4(0x501)]('click',async()=>{const _0x1915c8=_0x4bbbc4;if(!_0x4c8b14['activeChatId'])return;const _0x518627=await _0x25f61f(_0x1915c8(0x324),_0x1915c8(0x1480));if(_0x518627&&_0x518627[_0x1915c8(0xb8f)]()){const _0x451916=_0x4c8b14['chats'][_0x4c8b14[_0x1915c8(0x1539)]],_0x2fe485={'role':_0x1915c8(0x6d6),'type':_0x1915c8(0xdf3),'content':_0x518627[_0x1915c8(0xb8f)](),'timestamp':Date[_0x1915c8(0xecd)]()};_0x451916[_0x1915c8(0x92c)][_0x1915c8(0x6bb)](_0x2fe485),await _0x54c587['chats'][_0x1915c8(0x4cb)](_0x451916),_0x41ecc7(_0x2fe485,_0x451916),_0x41b828();}});const _0x4c8bd3=document[_0x4bbbc4(0x400)](_0x4bbbc4(0xd16));document['getElementById'](_0x4bbbc4(0x121a))['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0x2bc89c=_0x4bbbc4;_0x4c8bd3[_0x2bc89c(0xb08)][_0x2bc89c(0x12b6)](_0x2bc89c(0x9eb));}),_0x4c8bd3[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0xea0540=>{const _0x16a27b=_0x4bbbc4;_0xea0540[_0x16a27b(0x657)]===_0x4c8bd3&&_0x4c8bd3['classList'][_0x16a27b(0xc46)]('visible');}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1183))['addEventListener'](_0x4bbbc4(0x15ad),_0x419d14),document['getElementById'](_0x4bbbc4(0x2e9))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x2d2a30=_0x4bbbc4;if(!_0x4c8b14['activeChatId'])return;const _0x141374=document[_0x2d2a30(0x400)](_0x2d2a30(0xcc2)),_0x17a813=document['getElementById'](_0x2d2a30(0x1160)),_0x2133f3=_0x141374[_0x2d2a30(0xa1e)]['trim'](),_0x2b9e40=parseFloat(_0x17a813[_0x2d2a30(0xa1e)]);if(!_0x2133f3||isNaN(_0x2b9e40)||_0x2b9e40<=0x0){alert(_0x2d2a30(0xe3a));return;}const _0x1d5c78=_0x4c8b14['chats'][_0x4c8b14['activeChatId']],_0x178009=Date['now'](),_0x5887a3=_0x1d5c78[_0x2d2a30(0xc98)]?_0x1d5c78[_0x2d2a30(0xa37)][_0x2d2a30(0x14a8)]||'我':'我',_0x3db518={'role':_0x2d2a30(0x6d6),'senderName':_0x5887a3,'type':_0x2d2a30(0xebc),'productInfo':_0x2133f3,'amount':_0x2b9e40,'status':_0x2d2a30(0x9c6),'countdownEndTime':_0x178009+0xf*0x3c*0x3e8,'timestamp':_0x178009};_0x1d5c78[_0x2d2a30(0x92c)][_0x2d2a30(0x6bb)](_0x3db518),await _0x54c587['chats'][_0x2d2a30(0x4cb)](_0x1d5c78),_0x41ecc7(_0x3db518,_0x1d5c78),_0x41b828(),_0x141374[_0x2d2a30(0xa1e)]='',_0x17a813['value']='',_0x4c8bd3['classList'][_0x2d2a30(0xc46)](_0x2d2a30(0x9eb));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xc95))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x655617),document['getElementById'](_0x4bbbc4(0x520))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x24f09f),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x8e2))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x5050f8),document['getElementById'](_0x4bbbc4(0xa84))[_0x4bbbc4(0x501)]('click',_0x131bb0),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xc54))[_0x4bbbc4(0x501)]('click',_0x4f5f90),document['getElementById'](_0x4bbbc4(0x410))['addEventListener']('click',_0x464fd1),document['getElementById'](_0x4bbbc4(0xd2c))['addEventListener'](_0x4bbbc4(0x15ad),_0x56b562),document['getElementById']('preset-action-cancel')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x1651e5),document[_0x4bbbc4(0x400)]('selection-cancel-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x4e7c87),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x23b))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x2cb14f=_0x4bbbc4;if(_0x141aad[_0x2cb14f(0x9e8)]===0x0)return;const _0x5e2558=await _0x56d4d3('删除消息',_0x2cb14f(0x1352)+_0x141aad['size']+_0x2cb14f(0x120d),{'confirmButtonClass':_0x2cb14f(0x142c)});if(_0x5e2558){const _0x1aff34=_0x4c8b14[_0x2cb14f(0xbea)][_0x4c8b14[_0x2cb14f(0x1539)]];let _0x113d51=[];for(const _0xb6b78f of _0x141aad){const _0xe19a86=_0x1aff34['history']['find'](_0x16a735=>_0x16a735[_0x2cb14f(0x287)]===_0xb6b78f);_0xe19a86&&_0xe19a86[_0x2cb14f(0xbbf)]===_0x2cb14f(0x1618)&&_0x113d51['push'](_0x2cb14f(0x1094)+_0xe19a86['question']+_0x2cb14f(0x4ae)+_0xe19a86['timestamp']+')');}_0x1aff34['history']=_0x1aff34[_0x2cb14f(0x92c)][_0x2cb14f(0x29d)](_0x4d45c3=>!_0x141aad[_0x2cb14f(0x3e3)](_0x4d45c3[_0x2cb14f(0x287)]));let _0x42778b=_0x2cb14f(0x165a);_0x113d51['length']>0x0&&(_0x42778b+='\x20其中包括以下投票：'+_0x113d51['join']('；')+'。');_0x42778b+=_0x2cb14f(0x558);const _0x4bf179={'role':_0x2cb14f(0xaf6),'content':_0x2cb14f(0x26d)+_0x42778b+']','timestamp':Date[_0x2cb14f(0xecd)](),'isHidden':!![]};_0x1aff34[_0x2cb14f(0x92c)]['push'](_0x4bf179),await _0x54c587['chats'][_0x2cb14f(0x4cb)](_0x1aff34),_0x26354c(_0x4c8b14[_0x2cb14f(0x1539)]),_0x41b828();}}),document['getElementById'](_0x4bbbc4(0x14dd))['addEventListener'](_0x4bbbc4(0x15ad),async()=>{const _0x42829d=_0x4bbbc4;if(_0x141aad[_0x42829d(0x9e8)]===0x0)return;const _0x57fe64=await _0x56d4d3(_0x42829d(0x169f),_0x42829d(0x1122)+_0x141aad[_0x42829d(0x9e8)]+'\x20条消息，AI将完全遗忘它们的存在。确定吗？',{'confirmButtonClass':_0x42829d(0x142c),'confirmText':_0x42829d(0x1351)});if(_0x57fe64){const _0x4444ec=_0x4c8b14['chats'][_0x4c8b14[_0x42829d(0x1539)]];_0x4444ec[_0x42829d(0x92c)]=_0x4444ec['history']['filter'](_0x1bb8ef=>!_0x141aad[_0x42829d(0x3e3)](_0x1bb8ef[_0x42829d(0x287)])),await _0x54c587[_0x42829d(0xbea)][_0x42829d(0x4cb)](_0x4444ec),_0x26354c(_0x4c8b14[_0x42829d(0x1539)]),_0x41b828();}});const _0x22f24b=document[_0x4bbbc4(0x400)](_0x4bbbc4(0x55a));_0x22f24b[_0x4bbbc4(0x501)]('input',()=>_0x572a63(_0x22f24b[_0x4bbbc4(0xa1e)][_0x4bbbc4(0xb8f)](),!![])),document['getElementById'](_0x4bbbc4(0xf1d))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x3b495d=_0x4bbbc4,_0x2ebd76=_0x22f24b['value']['trim']();if(!_0x2ebd76){alert(_0x3b495d(0x13f2));return;}_0x572a63(_0x2ebd76,![]),_0x4c8b14[_0x3b495d(0x14f1)][_0x3b495d(0x1302)]=_0x2ebd76,await _0x54c587['globalSettings'][_0x3b495d(0x4cb)](_0x4c8b14[_0x3b495d(0x14f1)]),alert(_0x3b495d(0x651));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x163e))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x530897),document[_0x4bbbc4(0x527)](_0x4bbbc4(0xf72))[_0x4bbbc4(0xbdc)](_0x171679=>{const _0x1a3804=_0x4bbbc4;_0x171679[_0x1a3804(0x501)](_0x1a3804(0x15ad),()=>_0x51a6d1(_0x171679[_0x1a3804(0xd61)][_0x1a3804(0x1008)]));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1169))[_0x4bbbc4(0x501)]('click',()=>_0x51a6d1(_0x4bbbc4(0xe06))),document['getElementById'](_0x4bbbc4(0x71e))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x5e3c87=_0x4bbbc4,_0x1f45ff=await _0x25f61f(_0x5e3c87(0x5a3),_0x5e3c87(0x500),_0x4c8b14[_0x5e3c87(0x834)][_0x5e3c87(0xbf3)]);_0x1f45ff&&_0x1f45ff[_0x5e3c87(0xb8f)]()&&(_0x4c8b14['qzoneSettings'][_0x5e3c87(0xbf3)]=_0x1f45ff[_0x5e3c87(0xb8f)](),await _0x1098f6(),_0x5b43b4());}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x964))['addEventListener'](_0x4bbbc4(0x15ad),()=>document[_0x4bbbc4(0x400)](_0x4bbbc4(0x120f))[_0x4bbbc4(0x15ad)]()),document['getElementById']('qzone-banner-container')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>document[_0x4bbbc4(0x400)](_0x4bbbc4(0x150f))[_0x4bbbc4(0x15ad)]()),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x120f))[_0x4bbbc4(0x501)]('change',async _0x3f4967=>{const _0x53703c=_0x4bbbc4,_0x476d97=_0x3f4967[_0x53703c(0x657)][_0x53703c(0x780)][0x0];if(_0x476d97){const _0x19cb05=await new Promise(_0x30962f=>{const _0x5e508d=_0x53703c,_0x5f0250=new FileReader();_0x5f0250[_0x5e508d(0x9e0)]=()=>_0x30962f(_0x5f0250[_0x5e508d(0xdd1)]),_0x5f0250[_0x5e508d(0x157f)](_0x476d97);});_0x4c8b14[_0x53703c(0x834)][_0x53703c(0xa9a)]=_0x19cb05,await _0x1098f6(),_0x5b43b4();}_0x3f4967[_0x53703c(0x657)][_0x53703c(0xa1e)]=null;}),document['getElementById']('qzone-banner-input')[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),async _0x2e3fc3=>{const _0x32f48d=_0x4bbbc4,_0x8f4fc9=_0x2e3fc3[_0x32f48d(0x657)][_0x32f48d(0x780)][0x0];if(_0x8f4fc9){const _0x23b3fc=await new Promise(_0x9b481e=>{const _0x4e8f4a=_0x32f48d,_0x1993ea=new FileReader();_0x1993ea[_0x4e8f4a(0x9e0)]=()=>_0x9b481e(_0x1993ea['result']),_0x1993ea[_0x4e8f4a(0x157f)](_0x8f4fc9);});_0x4c8b14[_0x32f48d(0x834)]['banner']=_0x23b3fc,await _0x1098f6(),_0x5b43b4();}_0x2e3fc3['target']['value']=null;}),document['getElementById'](_0x4bbbc4(0x8be))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x40e3b6=_0x4bbbc4;_0x59872d();const _0x4551c4=document['getElementById'](_0x40e3b6(0x579));_0x4551c4[_0x40e3b6(0xd61)]['mode']=_0x40e3b6(0x73a),_0x4551c4[_0x40e3b6(0x13ef)](_0x40e3b6(0xb3f))['style']['display']='none',_0x4551c4['querySelector'](_0x40e3b6(0x59a))[_0x40e3b6(0xa00)]['display']=_0x40e3b6(0x165b),_0x4551c4[_0x40e3b6(0x13ef)]('#text-image-mode-content')[_0x40e3b6(0xa00)][_0x40e3b6(0xb1a)]=_0x40e3b6(0x165b),_0x4551c4[_0x40e3b6(0x13ef)](_0x40e3b6(0xdfe))[_0x40e3b6(0xb8e)]=_0x40e3b6(0x4fe);const _0x310a8b=document[_0x40e3b6(0x400)]('post-visibility-groups');_0x310a8b[_0x40e3b6(0x1575)]='';const _0x45bece=await _0x54c587['qzoneGroups'][_0x40e3b6(0xce1)]();_0x45bece[_0x40e3b6(0x8d6)]>0x0?_0x45bece[_0x40e3b6(0xbdc)](_0x180330=>{const _0x35c047=_0x40e3b6,_0x1a2b17=document['createElement'](_0x35c047(0xf6c));_0x1a2b17['style'][_0x35c047(0xb1a)]=_0x35c047(0x1181),_0x1a2b17['innerHTML']='<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22'+_0x180330['id']+_0x35c047(0xf7e)+_0x180330['name'],_0x310a8b[_0x35c047(0x8f2)](_0x1a2b17);}):_0x310a8b[_0x40e3b6(0x1575)]=_0x40e3b6(0x3df),_0x4551c4[_0x40e3b6(0xb08)][_0x40e3b6(0x12b6)](_0x40e3b6(0x9eb));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x12fc))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x563cdf=_0x4bbbc4;_0x59872d();const _0x11bc6d=document[_0x563cdf(0x400)]('create-post-modal');_0x11bc6d[_0x563cdf(0xd61)][_0x563cdf(0xa35)]=_0x563cdf(0x1260),_0x11bc6d[_0x563cdf(0x13ef)](_0x563cdf(0xb3f))[_0x563cdf(0xa00)][_0x563cdf(0xb1a)]=_0x563cdf(0x375),_0x11bc6d[_0x563cdf(0x13ef)](_0x563cdf(0x59a))[_0x563cdf(0xb08)][_0x563cdf(0x12b6)](_0x563cdf(0x5d6)),_0x11bc6d[_0x563cdf(0x13ef)](_0x563cdf(0x347))[_0x563cdf(0xb08)][_0x563cdf(0xc46)]('active'),_0x11bc6d[_0x563cdf(0x13ef)](_0x563cdf(0xdfe))[_0x563cdf(0xb8e)]='分享新鲜事...（非必填的公开文字）';const _0x10d6a3=document['getElementById'](_0x563cdf(0x1f1));_0x10d6a3['innerHTML']='';const _0x4e85fc=await _0x54c587[_0x563cdf(0x15e8)][_0x563cdf(0xce1)]();_0x4e85fc[_0x563cdf(0x8d6)]>0x0?_0x4e85fc[_0x563cdf(0xbdc)](_0x16be71=>{const _0x2295f2=_0x563cdf,_0x1789de=document['createElement'](_0x2295f2(0xf6c));_0x1789de[_0x2295f2(0xa00)]['display']='block',_0x1789de['innerHTML']=_0x2295f2(0x607)+_0x16be71['id']+'\x22>\x20'+_0x16be71[_0x2295f2(0xf3e)],_0x10d6a3[_0x2295f2(0x8f2)](_0x1789de);}):_0x10d6a3[_0x563cdf(0x1575)]='<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>',_0x11bc6d['classList'][_0x563cdf(0x12b6)](_0x563cdf(0x9eb));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x634))['addEventListener'](_0x4bbbc4(0x15ad),async()=>{const _0x15b9ad=_0x4bbbc4;await _0x2eb3bb(),_0x257d51(_0x15b9ad(0x1091));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1628))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x5830d0=_0x4bbbc4;_0x257d51(_0x5830d0(0x9a4)),_0x51a6d1(_0x5830d0(0x951));}),document[_0x4bbbc4(0x400)]('album-photos-back-btn')['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0x1a75e5=_0x4bbbc4;_0x4c8b14[_0x1a75e5(0xd7c)]=null,_0x257d51('album-screen');}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1e4))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>document['getElementById']('album-photo-input')[_0x4bbbc4(0x15ad)]()),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x4c3))['addEventListener']('change',async _0x7d0ce6=>{const _0x568912=_0x4bbbc4;if(!_0x4c8b14[_0x568912(0xd7c)])return;const _0x5a39d3=_0x7d0ce6[_0x568912(0x657)][_0x568912(0x780)];if(!_0x5a39d3[_0x568912(0x8d6)])return;const _0x949703=await _0x54c587[_0x568912(0xc1e)][_0x568912(0xf48)](_0x4c8b14['activeAlbumId']);for(const _0x306880 of _0x5a39d3){const _0x5bec69=await new Promise(_0x3eabf8=>{const _0x268755=_0x568912,_0x3d334e=new FileReader();_0x3d334e['onload']=()=>_0x3eabf8(_0x3d334e[_0x268755(0xdd1)]),_0x3d334e[_0x268755(0x157f)](_0x306880);});await _0x54c587[_0x568912(0x933)][_0x568912(0x12b6)]({'albumId':_0x4c8b14[_0x568912(0xd7c)],'url':_0x5bec69,'createdAt':Date[_0x568912(0xecd)]()});}const _0x300335=await _0x54c587[_0x568912(0x933)][_0x568912(0x227)](_0x568912(0x13c7))['equals'](_0x4c8b14[_0x568912(0xd7c)])[_0x568912(0xcbc)](),_0x10ef98={'photoCount':_0x300335};if(!_0x949703[_0x568912(0x1487)]||_0x949703[_0x568912(0x96b)][_0x568912(0xd1b)](_0x568912(0xb8e))){const _0x68868=await _0x54c587[_0x568912(0x933)][_0x568912(0x227)](_0x568912(0x13c7))['equals'](_0x4c8b14[_0x568912(0xd7c)])[_0x568912(0x149c)]();if(_0x68868)_0x10ef98[_0x568912(0x96b)]=_0x68868[_0x568912(0x299)];}await _0x54c587[_0x568912(0xc1e)][_0x568912(0x126d)](_0x4c8b14['activeAlbumId'],_0x10ef98),await _0x1061e4(),await _0x2eb3bb(),_0x7d0ce6[_0x568912(0x657)][_0x568912(0xa1e)]=null,alert('照片上传成功！');}),document[_0x4bbbc4(0x400)]('photos-grid-page')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async _0x1cc08a=>{const _0x869b70=_0x4bbbc4,_0x5f1b16=_0x1cc08a['target']['closest'](_0x869b70(0x99a)),_0x257f90=_0x1cc08a['target'][_0x869b70(0x117a)](_0x869b70(0x4c9));if(_0x5f1b16){_0x1cc08a[_0x869b70(0x504)]();const _0x56f1a5=parseInt(_0x5f1b16[_0x869b70(0xd61)]['photoId']),_0x4efd59=await _0x56d4d3(_0x869b70(0xac7),_0x869b70(0x54f),{'confirmButtonClass':_0x869b70(0x142c)});if(_0x4efd59){const _0x47124f=await _0x54c587[_0x869b70(0x933)][_0x869b70(0xf48)](_0x56f1a5);if(!_0x47124f)return;await _0x54c587['qzonePhotos'][_0x869b70(0x942)](_0x56f1a5);const _0x1f2a24=await _0x54c587['qzoneAlbums']['get'](_0x4c8b14[_0x869b70(0xd7c)]),_0x233ef8=(_0x1f2a24[_0x869b70(0x1487)]||0x1)-0x1,_0x3ac89a={'photoCount':_0x233ef8};if(_0x1f2a24[_0x869b70(0x96b)]===_0x47124f[_0x869b70(0x299)]){const _0x4946f4=await _0x54c587[_0x869b70(0x933)][_0x869b70(0x227)](_0x869b70(0x13c7))[_0x869b70(0x4ce)](_0x4c8b14['activeAlbumId'])[_0x869b70(0x149c)]();_0x3ac89a['coverUrl']=_0x4946f4?_0x4946f4[_0x869b70(0x299)]:'https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png';}await _0x54c587[_0x869b70(0xc1e)]['update'](_0x4c8b14[_0x869b70(0xd7c)],_0x3ac89a),await _0x1061e4(),await _0x2eb3bb(),alert(_0x869b70(0xaaa));}}else _0x257f90&&_0x4fcd1e(_0x257f90[_0x869b70(0x912)]);}),document[_0x4bbbc4(0x400)]('photo-viewer-close-btn')[_0x4bbbc4(0x501)]('click',_0x4c0feb),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x50e))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x17dbe3),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1194))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x26ad9c),document['addEventListener']('keydown',_0x17d25f=>{const _0x14f0c9=_0x4bbbc4;if(!_0x531cde[_0x14f0c9(0x12b0)])return;if(_0x17d25f[_0x14f0c9(0xa30)]===_0x14f0c9(0x957))_0x17dbe3();else{if(_0x17d25f[_0x14f0c9(0xa30)]===_0x14f0c9(0x1637))_0x26ad9c();else _0x17d25f[_0x14f0c9(0xa30)]===_0x14f0c9(0x1665)&&_0x4c0feb();}}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x38d))['addEventListener'](_0x4bbbc4(0x15ad),async()=>{const _0x43701a=_0x4bbbc4,_0x426e54=await _0x25f61f(_0x43701a(0x12ae),_0x43701a(0x66c));if(_0x426e54&&_0x426e54[_0x43701a(0xb8f)]()){const _0x5edf95={'name':_0x426e54[_0x43701a(0xb8f)](),'coverUrl':_0x43701a(0x11dc),'photoCount':0x0,'createdAt':Date[_0x43701a(0xecd)]()};await _0x54c587['qzoneAlbums']['add'](_0x5edf95),await _0x2eb3bb(),alert(_0x43701a(0x398)+_0x426e54+'\x22\x20创建成功！');}else _0x426e54!==null&&alert(_0x43701a(0x13b7));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x117d))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>document['getElementById'](_0x4bbbc4(0x579))[_0x4bbbc4(0xb08)][_0x4bbbc4(0xc46)]('visible')),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xdf2))['addEventListener']('click',()=>document[_0x4bbbc4(0x400)](_0x4bbbc4(0x839))['click']()),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x839))[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),_0x16826f=>{const _0x52c574=_0x4bbbc4,_0xfd6206=_0x16826f['target']['files'][0x0];if(_0xfd6206){const _0x37fe8f=new FileReader();_0x37fe8f[_0x52c574(0x9e0)]=_0x104f16=>{const _0x151684=_0x52c574;document[_0x151684(0x400)](_0x151684(0x1149))['src']=_0x104f16[_0x151684(0x657)][_0x151684(0xdd1)],document[_0x151684(0x400)]('post-image-preview-container')[_0x151684(0xb08)][_0x151684(0x12b6)]('visible'),document[_0x151684(0x400)](_0x151684(0x12f0))[_0x151684(0xa00)][_0x151684(0xb1a)]=_0x151684(0x1181);},_0x37fe8f[_0x52c574(0x157f)](_0xfd6206);}}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x380))['addEventListener'](_0x4bbbc4(0x15ad),async()=>{const _0x272e84=_0x4bbbc4,_0x219ec2=await _0x25f61f('输入图片URL','请输入网络图片的链接','','url');_0x219ec2&&(document['getElementById'](_0x272e84(0x1149))[_0x272e84(0x912)]=_0x219ec2,document[_0x272e84(0x400)]('post-image-preview-container')[_0x272e84(0xb08)][_0x272e84(0x12b6)]('visible'),document[_0x272e84(0x400)](_0x272e84(0x12f0))[_0x272e84(0xa00)][_0x272e84(0xb1a)]=_0x272e84(0x1181));}),document['getElementById']('post-remove-image-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>_0x59872d());const _0x1ae33=document[_0x4bbbc4(0x400)]('switch-to-image-mode'),_0x234df4=document['getElementById']('switch-to-text-image-mode'),_0x462b15=document[_0x4bbbc4(0x400)]('image-mode-content'),_0x5a2025=document['getElementById'](_0x4bbbc4(0x1612));_0x1ae33[_0x4bbbc4(0x501)]('click',()=>{const _0x310242=_0x4bbbc4;_0x1ae33['classList'][_0x310242(0x12b6)](_0x310242(0x5d6)),_0x234df4[_0x310242(0xb08)][_0x310242(0xc46)](_0x310242(0x5d6)),_0x462b15['classList'][_0x310242(0x12b6)]('active'),_0x5a2025[_0x310242(0xb08)][_0x310242(0xc46)](_0x310242(0x5d6));}),_0x234df4[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x57aa8c=_0x4bbbc4;_0x234df4[_0x57aa8c(0xb08)][_0x57aa8c(0x12b6)](_0x57aa8c(0x5d6)),_0x1ae33['classList']['remove'](_0x57aa8c(0x5d6)),_0x5a2025[_0x57aa8c(0xb08)][_0x57aa8c(0x12b6)](_0x57aa8c(0x5d6)),_0x462b15[_0x57aa8c(0xb08)][_0x57aa8c(0xc46)](_0x57aa8c(0x5d6));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x21c))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x12daa0=_0x4bbbc4,_0x331850=document[_0x12daa0(0x400)](_0x12daa0(0x579)),_0x352f54=_0x331850['dataset'][_0x12daa0(0xa35)],_0x3c47dc=document[_0x12daa0(0x13ef)](_0x12daa0(0xa97))['value'];let _0x550125=null;_0x3c47dc===_0x12daa0(0xe70)&&(_0x550125=Array[_0x12daa0(0xdc0)](document['querySelectorAll'](_0x12daa0(0x32c)))[_0x12daa0(0xd18)](_0x5b7a0f=>parseInt(_0x5b7a0f['value'])));let _0x4b4c0a={};const _0x563e0b={'timestamp':Date['now'](),'authorId':_0x12daa0(0x6d6),'visibleGroupIds':_0x550125};if(_0x352f54==='shuoshuo'){const _0x375778=document['getElementById'](_0x12daa0(0x163d))[_0x12daa0(0xa1e)][_0x12daa0(0xb8f)]();if(!_0x375778){alert(_0x12daa0(0x488));return;}_0x4b4c0a={..._0x563e0b,'type':_0x12daa0(0x73a),'content':_0x375778};}else{const _0x33f7d2=document[_0x12daa0(0x400)]('post-public-text')[_0x12daa0(0xa1e)][_0x12daa0(0xb8f)](),_0x46f0b8=document['getElementById'](_0x12daa0(0xcdb))['classList'][_0x12daa0(0xd3f)](_0x12daa0(0x5d6));if(_0x46f0b8){const _0xc41ff3=document['getElementById']('post-image-preview')['src'],_0x402e9a=document['getElementById'](_0x12daa0(0xf84))[_0x12daa0(0xa1e)]['trim']();if(!_0xc41ff3||!(_0xc41ff3[_0x12daa0(0xbb9)](_0x12daa0(0x1471))||_0xc41ff3[_0x12daa0(0xbb9)](_0x12daa0(0x7aa)))){alert('请先添加一张图片再发布动态哦！');return;}if(!_0x402e9a){alert(_0x12daa0(0x424));return;}_0x4b4c0a={..._0x563e0b,'type':'image_post','publicText':_0x33f7d2,'imageUrl':_0xc41ff3,'imageDescription':_0x402e9a};}else{const _0x36cd3a=document['getElementById']('post-hidden-text')['value']['trim']();if(!_0x36cd3a){alert(_0x12daa0(0x704));return;}_0x4b4c0a={..._0x563e0b,'type':_0x12daa0(0x14b0),'publicText':_0x33f7d2,'hiddenContent':_0x36cd3a};}}const _0x10d104=await _0x54c587[_0x12daa0(0xba7)][_0x12daa0(0x12b6)](_0x4b4c0a);let _0xcf0fd4=_0x4b4c0a[_0x12daa0(0x1109)]||_0x4b4c0a[_0x12daa0(0xdb3)]||_0x4b4c0a[_0x12daa0(0xe34)]||_0x4b4c0a[_0x12daa0(0x1012)]||_0x12daa0(0xcc1);_0xcf0fd4=_0xcf0fd4[_0x12daa0(0x371)](0x0,0x32)+(_0xcf0fd4[_0x12daa0(0x8d6)]>0x32?_0x12daa0(0x166b):'');for(const _0x20e540 in _0x4c8b14['chats']){const _0x175e05=_0x4c8b14[_0x12daa0(0xbea)][_0x20e540];if(_0x175e05[_0x12daa0(0xc98)])continue;let _0x2a2d99=![];const _0x512dc2=_0x4b4c0a[_0x12daa0(0x26b)];if(!_0x512dc2||_0x512dc2[_0x12daa0(0x8d6)]===0x0)_0x2a2d99=!![];else _0x175e05[_0x12daa0(0x1145)]&&_0x512dc2[_0x12daa0(0xd1b)](_0x175e05['groupId'])&&(_0x2a2d99=!![]);if(_0x2a2d99){const _0x35d8ac={'role':'system','content':_0x12daa0(0x1365)+_0x10d104+_0x12daa0(0x15bb)+_0xcf0fd4+'”。请你【结合自己的角色设定、世界观和你们的最近聊天内容】，对这条动态发表一条自然的评论。]','timestamp':Date[_0x12daa0(0xecd)](),'isHidden':!![]};_0x175e05['history'][_0x12daa0(0x6bb)](_0x35d8ac),await _0x54c587[_0x12daa0(0xbea)][_0x12daa0(0x4cb)](_0x175e05);}}await _0x335d36(),_0x331850[_0x12daa0(0xb08)][_0x12daa0(0xc46)](_0x12daa0(0x9eb)),alert(_0x12daa0(0x959));});const _0x1335c9=document[_0x4bbbc4(0x400)](_0x4bbbc4(0xe69));let _0x30a6a7={'isDragging':![],'startX':0x0,'startY':0x0,'currentX':0x0,'activeContainer':null,'swipeDirection':null,'isClick':!![]};function _0x32df97(_0x4abd3c=null){const _0x3690c4=_0x4bbbc4;document['querySelectorAll'](_0x3690c4(0xa03))[_0x3690c4(0xbdc)](_0x15b9b5=>{const _0x40f69f=_0x3690c4;_0x15b9b5!==_0x4abd3c&&_0x15b9b5['querySelector'](_0x40f69f(0xe23))[_0x40f69f(0xb08)]['remove'](_0x40f69f(0x406));});}async function _0x4c9007(_0x23b7f9){const _0x228f21=_0x4bbbc4;_0x23b7f9['stopPropagation']();const _0x51db12=_0x23b7f9[_0x228f21(0x657)],_0x30d325=_0x51db12[_0x228f21(0x117a)]('.comment-delete-btn');if(_0x30d325){const _0x15ca2a=_0x30d325[_0x228f21(0x117a)]('.qzone-post-container'),_0x71c9f=parseInt(_0x15ca2a[_0x228f21(0xd61)][_0x228f21(0x2b7)]),_0x26a995=parseInt(_0x30d325[_0x228f21(0xd61)][_0x228f21(0x6ce)]);if(isNaN(_0x71c9f)||isNaN(_0x26a995))return;const _0x4e0411=_0x265b3f[_0x228f21(0x821)](_0xa33646=>_0xa33646['id']===_0x71c9f);if(!_0x4e0411||!_0x4e0411[_0x228f21(0xf8f)]||!_0x4e0411[_0x228f21(0xf8f)][_0x26a995])return;const _0x477cc0=_0x4e0411['comments'][_0x26a995],_0x1384f3=await _0x56d4d3('删除评论',_0x228f21(0xbcf),{'confirmButtonClass':'btn-danger'});if(_0x1384f3){_0x4e0411[_0x228f21(0xf8f)]['splice'](_0x26a995,0x1),await _0x54c587[_0x228f21(0xba7)]['update'](_0x71c9f,{'comments':_0x4e0411[_0x228f21(0xf8f)]});if(_0x477cc0&&_0x477cc0[_0x228f21(0xbf8)]===_0x4c8b14[_0x228f21(0x834)][_0x228f21(0xbf3)]){console['log']('用户删除了自己的评论，开始清理AI记忆...');const _0x20b191=new Set();_0x4e0411[_0x228f21(0x606)]!==_0x228f21(0x6d6)&&_0x20b191[_0x228f21(0x12b6)](_0x4e0411[_0x228f21(0x606)]);if(_0x477cc0[_0x228f21(0x10bf)]){const _0x5d9992=Object['values'](_0x4c8b14[_0x228f21(0xbea)])[_0x228f21(0x821)](_0x5dcdee=>_0x5dcdee['originalName']===_0x477cc0['replyTo']);_0x5d9992&&_0x20b191[_0x228f21(0x12b6)](_0x5d9992['id']);}const _0x47273f=(_0x4e0411[_0x228f21(0xdb3)]||_0x4e0411[_0x228f21(0x1109)]||'')[_0x228f21(0x371)](0x0,0x1e),_0x4cd49a=_0x4c8b14[_0x228f21(0x834)]['nickname'];let _0x3c9bc5;const _0x22fb11=_0x4c8b14['userStickers']['find'](_0x1569f1=>_0x1569f1[_0x228f21(0x299)]===_0x477cc0['text']);if(_0x22fb11)_0x3c9bc5=_0x228f21(0x415)+_0x4cd49a+_0x228f21(0xec2)+_0x47273f+_0x228f21(0xd84)+_0x22fb11[_0x228f21(0xf3e)]+'”。';else{if(_0x477cc0[_0x228f21(0x10bf)]){const _0x1b9814=_0x44e128(_0x477cc0[_0x228f21(0x10bf)]);_0x3c9bc5=_0x228f21(0x415)+_0x4cd49a+'\x27刚刚在你的动态“'+_0x47273f+'”下，回复了\x27'+_0x1b9814+'\x27的评论，内容是：“'+_0x477cc0[_0x228f21(0x117f)]+'”。';}else _0x3c9bc5=_0x228f21(0x415)+_0x4cd49a+_0x228f21(0x7c2)+_0x47273f+_0x228f21(0xbbe)+_0x477cc0['text']+'”。';}const _0x5459b1='[系统提示：'+_0x3c9bc5+'请你对此作出回应。]';for(const _0x276d3c of _0x20b191){const _0x4366f3=_0x4c8b14[_0x228f21(0xbea)][_0x276d3c];if(_0x4366f3){const _0x390874=_0x4366f3['history']['length'];_0x4366f3[_0x228f21(0x92c)]=_0x4366f3['history'][_0x228f21(0x29d)](_0x1ec0ee=>!(_0x1ec0ee['isHidden']&&_0x1ec0ee['role']===_0x228f21(0xaf6)&&_0x1ec0ee['content']===_0x5459b1)),_0x4366f3[_0x228f21(0x92c)]['length']<_0x390874&&(console[_0x228f21(0x1e6)](_0x228f21(0xb5d)+_0x4366f3[_0x228f21(0xf3e)]+'\x22\x20的记忆中清除了1条关于已删除评论的通知。'),await _0x54c587[_0x228f21(0xbea)][_0x228f21(0x4cb)](_0x4366f3));}}}await _0xbce8d5(_0x71c9f);}return;}const _0x597601=_0x51db12[_0x228f21(0x117a)](_0x228f21(0xb4b));if(_0x597601){const _0x238b43=_0x597601[_0x228f21(0x117a)](_0x228f21(0xa03));if(!_0x238b43)return;const _0x1d3550=parseInt(_0x238b43[_0x228f21(0xd61)]['postId']);_0x2eb114[_0x228f21(0x12b0)]&&_0x2eb114[_0x228f21(0x1155)]===_0x1d3550?_0x647d65():_0xa9f1f7(_0x1d3550,_0x597601);return;}const _0x14d4a3=_0x51db12[_0x228f21(0x117a)](_0x228f21(0xc4b));if(_0x14d4a3){const _0x5d0312=parseInt(_0x14d4a3['dataset'][_0x228f21(0x2b7)]),_0x5565e9=_0x14d4a3[_0x228f21(0xd61)][_0x228f21(0xe75)],_0x48dfc7=_0x14d4a3[_0x228f21(0xd61)][_0x228f21(0xe53)];if(!_0x5565e9||!_0x48dfc7||_0x5565e9===_0x4c8b14[_0x228f21(0x834)][_0x228f21(0xbf3)]){_0xd19681(_0x14d4a3[_0x228f21(0x117a)](_0x228f21(0xa03)));return;}_0x48d0a9={'postId':_0x5d0312,'replyToName':_0x5565e9,'replyToDisplayName':_0x48dfc7};const _0xdc536b=_0x14d4a3[_0x228f21(0x117a)](_0x228f21(0xa03)),_0x1adca0=_0xdc536b[_0x228f21(0x13ef)]('.comment-input');_0x1adca0[_0x228f21(0xb8e)]=_0x228f21(0x135f)+_0x48dfc7+':',_0x1adca0[_0x228f21(0x797)]();return;}if(_0x51db12[_0x228f21(0xb08)]['contains'](_0x228f21(0x161b))){const _0x4d613a=_0x51db12['closest'](_0x228f21(0xa03));if(_0x4d613a&&_0x4d613a[_0x228f21(0xd61)][_0x228f21(0x2b7)])_0xee9b39(parseInt(_0x4d613a[_0x228f21(0xd61)][_0x228f21(0x2b7)]));return;}if(_0x51db12[_0x228f21(0xa95)]===_0x228f21(0x7b7)&&_0x51db12[_0x228f21(0xd61)][_0x228f21(0x51b)]){_0x138765(_0x228f21(0xac3),_0x51db12[_0x228f21(0xd61)][_0x228f21(0x51b)][_0x228f21(0xe19)](/<br>/g,'\x0a'));return;}const _0x270cd1=_0x51db12[_0x228f21(0x117a)](_0x228f21(0xa03));if(!_0x270cd1)return;const _0x555283=parseInt(_0x270cd1[_0x228f21(0xd61)][_0x228f21(0x2b7)]);if(isNaN(_0x555283))return;if(_0x51db12[_0x228f21(0x117a)](_0x228f21(0xc9a))){const _0x124671=await _0x56d4d3(_0x228f21(0x15b4),_0x228f21(0x9ab),{'confirmButtonClass':'btn-danger'});_0x124671&&(_0x270cd1[_0x228f21(0xa00)][_0x228f21(0x139d)]=_0x228f21(0x144a),_0x270cd1[_0x228f21(0xa00)][_0x228f21(0x8ea)]='scale(0.8)',_0x270cd1['style'][_0x228f21(0xbfa)]='0',setTimeout(async()=>{const _0x1448d2=_0x228f21;await _0x54c587[_0x1448d2(0xba7)][_0x1448d2(0x942)](_0x555283);const _0x1a8234=_0x1448d2(0x13e1)+_0x555283+')';for(const _0x23b5c1 in _0x4c8b14[_0x1448d2(0xbea)]){const _0x557275=_0x4c8b14[_0x1448d2(0xbea)][_0x23b5c1],_0x33798b=_0x557275[_0x1448d2(0x92c)][_0x1448d2(0x8d6)];_0x557275[_0x1448d2(0x92c)]=_0x557275['history'][_0x1448d2(0x29d)](_0x451d5b=>!(_0x451d5b['role']===_0x1448d2(0xaf6)&&_0x451d5b[_0x1448d2(0x1109)][_0x1448d2(0xd1b)](_0x1a8234)));if(_0x557275[_0x1448d2(0x92c)][_0x1448d2(0x8d6)]<_0x33798b)await _0x54c587[_0x1448d2(0xbea)][_0x1448d2(0x4cb)](_0x557275);}await _0x335d36(),alert(_0x1448d2(0xc70));},0x12c));return;}const _0x4d254a=_0x51db12[_0x228f21(0x117a)](_0x228f21(0x351));if(_0x4d254a){if(_0x4d254a[_0x228f21(0xb08)][_0x228f21(0xd3f)]('repost')){_0x181d17(_0x555283);return;}if(_0x4d254a['classList'][_0x228f21(0xd3f)](_0x228f21(0xdae))){const _0x51ad5e=_0x265b3f['find'](_0x35d31a=>_0x35d31a['id']===_0x555283);if(!_0x51ad5e)return;if(!_0x51ad5e[_0x228f21(0xe30)])_0x51ad5e['likes']=[];const _0xb5e74a=_0x4c8b14[_0x228f21(0x834)][_0x228f21(0xbf3)],_0x31902a=_0x51ad5e[_0x228f21(0xe30)][_0x228f21(0xd53)](_0xb5e74a);_0x31902a>-0x1?_0x51ad5e['likes'][_0x228f21(0xdcc)](_0x31902a,0x1):(_0x51ad5e[_0x228f21(0xe30)][_0x228f21(0x6bb)](_0xb5e74a),_0x4d254a['classList'][_0x228f21(0x12b6)](_0x228f21(0xd93)),_0x4d254a[_0x228f21(0x501)](_0x228f21(0x78b),()=>_0x4d254a[_0x228f21(0xb08)][_0x228f21(0xc46)](_0x228f21(0xd93)),{'once':!![]})),await _0x54c587[_0x228f21(0xba7)][_0x228f21(0x126d)](_0x555283,{'likes':_0x51ad5e['likes']}),await _0xbce8d5(_0x555283);}if(_0x4d254a[_0x228f21(0xb08)][_0x228f21(0xd3f)](_0x228f21(0xfda))){const _0x2e8cb0=await _0x54c587[_0x228f21(0x69c)][_0x228f21(0x227)]({'type':_0x228f21(0x1353),'content.id':_0x555283})[_0x228f21(0x149c)]();if(_0x2e8cb0)await _0x54c587['favorites']['delete'](_0x2e8cb0['id']),await _0x138765('提示','已取消收藏');else{const _0x3f65f2=await _0x54c587[_0x228f21(0xba7)]['get'](_0x555283);_0x3f65f2&&(await _0x54c587[_0x228f21(0x69c)][_0x228f21(0x12b6)]({'type':_0x228f21(0x1353),'content':_0x3f65f2,'timestamp':Date[_0x228f21(0xecd)]()}),await _0x138765('提示','收藏成功！'));}await _0xbce8d5(_0x555283);}return;}const _0x77af26=_0x51db12[_0x228f21(0x117a)](_0x228f21(0xf28));if(_0x77af26){const _0x4d42de=_0x270cd1['querySelector'](_0x228f21(0x13f0)),_0x22d04e=_0x4d42de[_0x228f21(0xa1e)][_0x228f21(0xb8f)]();if(!_0x22d04e)return alert(_0x228f21(0xffa));const _0x5b26a8=_0x265b3f['find'](_0x561620=>_0x561620['id']===_0x555283);if(!_0x5b26a8)return;if(!_0x5b26a8[_0x228f21(0xf8f)])_0x5b26a8[_0x228f21(0xf8f)]=[];const _0x2f536f={'commenterName':_0x4c8b14[_0x228f21(0x834)]['nickname'],'text':_0x22d04e,'timestamp':Date[_0x228f21(0xecd)](),'replyTo':_0x48d0a9&&_0x48d0a9[_0x228f21(0x2b7)]===_0x555283?_0x48d0a9['replyToName']:null};_0x5b26a8[_0x228f21(0xf8f)][_0x228f21(0x6bb)](_0x2f536f),await _0x54c587[_0x228f21(0xba7)][_0x228f21(0x126d)](_0x555283,{'comments':_0x5b26a8[_0x228f21(0xf8f)]});let _0x21b52d=(_0x5b26a8[_0x228f21(0xdb3)]||_0x5b26a8[_0x228f21(0x1109)]||'')[_0x228f21(0x371)](0x0,0x1e);const _0x28752e=_0x4c8b14['qzoneSettings'][_0x228f21(0xbf3)],_0x383f7d=new Set();if(_0x5b26a8['authorId']!==_0x228f21(0x6d6))_0x383f7d[_0x228f21(0x12b6)](_0x5b26a8[_0x228f21(0x606)]);if(_0x2f536f['replyTo']&&_0x2f536f[_0x228f21(0x10bf)]!==_0x28752e){const _0x57a8f9=Object[_0x228f21(0x40a)](_0x4c8b14[_0x228f21(0xbea)])[_0x228f21(0x821)](_0x343e46=>_0x343e46['originalName']===_0x2f536f[_0x228f21(0x10bf)]);if(_0x57a8f9)_0x383f7d['add'](_0x57a8f9['id']);}for(const _0x22ad96 of _0x383f7d){const _0x3bfb36=_0x4c8b14[_0x228f21(0xbea)][_0x22ad96];if(_0x3bfb36&&!_0x3bfb36[_0x228f21(0xc98)]){const _0x5a9b0d=_0x4c8b14[_0x228f21(0x120c)][_0x228f21(0x821)](_0x5f3640=>_0x5f3640[_0x228f21(0x299)]===_0x22d04e);let _0x52ea72=_0x5a9b0d?_0x228f21(0x415)+_0x28752e+_0x228f21(0xec2)+_0x21b52d+_0x228f21(0xd84)+_0x5a9b0d[_0x228f21(0xf3e)]+'”。':_0x2f536f[_0x228f21(0x10bf)]?_0x228f21(0x415)+_0x28752e+_0x228f21(0xec2)+_0x21b52d+'”下，回复了\x27'+_0x48d0a9[_0x228f21(0x342)]+'\x27的评论，内容是：“'+_0x22d04e+'”。':'用户\x27'+_0x28752e+_0x228f21(0x7c2)+_0x21b52d+_0x228f21(0xbbe)+_0x22d04e+'”。';const _0x229b7c={'role':_0x228f21(0xaf6),'content':'[系统提示：'+_0x52ea72+'请你对此作出回应。]','timestamp':Date[_0x228f21(0xecd)](),'isHidden':!![]};_0x3bfb36[_0x228f21(0x92c)][_0x228f21(0x6bb)](_0x229b7c),await _0x54c587['chats'][_0x228f21(0x4cb)](_0x3bfb36);}}_0x4d42de[_0x228f21(0xa1e)]='',_0xd19681(_0x270cd1),await _0xbce8d5(_0x555283);return;}}const _0x1d0692=_0x1f74a7=>{const _0x1957f7=_0x4bbbc4,_0xeca41d=_0x1f74a7[_0x1957f7(0x657)];if(_0xeca41d[_0x1957f7(0x117a)](_0x1957f7(0x54d)))return;const _0x1ab7a4=_0x1f74a7['target'][_0x1957f7(0x117a)](_0x1957f7(0xa03));if(!_0x1ab7a4)return;_0x32df97(_0x1ab7a4),_0x30a6a7[_0x1957f7(0x2f8)]=_0x1ab7a4,_0x30a6a7[_0x1957f7(0x1695)]=!![],_0x30a6a7[_0x1957f7(0x1192)]=!![],_0x30a6a7[_0x1957f7(0x490)]=null,_0x30a6a7['startX']=_0x1f74a7[_0x1957f7(0xbbf)][_0x1957f7(0xd1b)](_0x1957f7(0xedc))?_0x1f74a7[_0x1957f7(0x123c)]:_0x1f74a7[_0x1957f7(0x567)][0x0]['pageX'],_0x30a6a7['startY']=_0x1f74a7['type']['includes'](_0x1957f7(0xedc))?_0x1f74a7['pageY']:_0x1f74a7[_0x1957f7(0x567)][0x0][_0x1957f7(0xd58)],_0x30a6a7[_0x1957f7(0x2f8)][_0x1957f7(0x13ef)](_0x1957f7(0xe23))['style']['transition']='none',document[_0x1957f7(0x501)](_0x1957f7(0x1602),_0x26d27b),document['addEventListener'](_0x1957f7(0x98c),_0x3a3202),document[_0x1957f7(0x501)](_0x1957f7(0x1119),_0x26d27b,{'passive':![]}),document[_0x1957f7(0x501)]('touchend',_0x3a3202);},_0x26d27b=_0x23acd1=>{const _0x2a2d62=_0x4bbbc4;if(!_0x30a6a7['isDragging']||!_0x30a6a7[_0x2a2d62(0x2f8)])return;const _0x4841b4=_0x23acd1[_0x2a2d62(0xbbf)][_0x2a2d62(0xd1b)](_0x2a2d62(0xedc))?_0x23acd1[_0x2a2d62(0x123c)]:_0x23acd1[_0x2a2d62(0x567)][0x0][_0x2a2d62(0x123c)],_0x289ece=_0x23acd1[_0x2a2d62(0xbbf)][_0x2a2d62(0xd1b)](_0x2a2d62(0xedc))?_0x23acd1[_0x2a2d62(0xd58)]:_0x23acd1['touches'][0x0]['pageY'],_0x5d4c50=_0x4841b4-_0x30a6a7[_0x2a2d62(0x6e4)],_0x1b0a44=_0x289ece-_0x30a6a7[_0x2a2d62(0x1112)];_0x30a6a7[_0x2a2d62(0x1192)]&&(Math[_0x2a2d62(0x1396)](_0x5d4c50)>0x5||Math['abs'](_0x1b0a44)>0x5)&&(_0x30a6a7['isClick']=![]);!_0x30a6a7[_0x2a2d62(0x490)]&&(Math[_0x2a2d62(0x1396)](_0x5d4c50)>Math[_0x2a2d62(0x1396)](_0x1b0a44)?_0x30a6a7[_0x2a2d62(0x490)]='horizontal':_0x30a6a7['swipeDirection']=_0x2a2d62(0x1683));if(_0x30a6a7['swipeDirection']==='horizontal'){_0x23acd1[_0x2a2d62(0x92e)](),_0x30a6a7['currentX']=_0x4841b4;let _0x5c5948=Math['min'](0x0,Math[_0x2a2d62(0x124e)](-0x5a,_0x5d4c50));_0x30a6a7[_0x2a2d62(0x2f8)][_0x2a2d62(0x13ef)]('.qzone-post-item')[_0x2a2d62(0xa00)][_0x2a2d62(0x8ea)]=_0x2a2d62(0xa1d)+_0x5c5948+_0x2a2d62(0x11e8);}},_0x3a3202=_0x111df4=>{const _0x39eb03=_0x4bbbc4;document[_0x39eb03(0xf17)]('mousemove',_0x26d27b),document[_0x39eb03(0xf17)](_0x39eb03(0x98c),_0x3a3202),document[_0x39eb03(0xf17)](_0x39eb03(0x1119),_0x26d27b),document[_0x39eb03(0xf17)](_0x39eb03(0x11bc),_0x3a3202);if(!_0x30a6a7[_0x39eb03(0x1695)]||!_0x30a6a7[_0x39eb03(0x2f8)])return;const _0x5d1c6d=_0x30a6a7[_0x39eb03(0x2f8)][_0x39eb03(0x13ef)](_0x39eb03(0xe23));_0x5d1c6d['style'][_0x39eb03(0x139d)]=_0x39eb03(0xe62);if(_0x30a6a7[_0x39eb03(0x490)]===_0x39eb03(0xde9)&&!_0x30a6a7['isClick']){const _0x19f718=_0x111df4[_0x39eb03(0xbbf)][_0x39eb03(0xd1b)]('touchend')?_0x111df4[_0x39eb03(0xcf8)][0x0]['pageX']:_0x111df4[_0x39eb03(0x123c)],_0x1328da=_0x19f718-_0x30a6a7[_0x39eb03(0x6e4)];_0x1328da<-0x28?_0x5d1c6d[_0x39eb03(0xb08)][_0x39eb03(0x12b6)]('swiped'):_0x5d1c6d[_0x39eb03(0xb08)][_0x39eb03(0xc46)]('swiped');}_0x5d1c6d['style'][_0x39eb03(0x8ea)]='',_0x30a6a7[_0x39eb03(0x1695)]=![],_0x30a6a7[_0x39eb03(0x2f8)]=null,_0x30a6a7[_0x39eb03(0x490)]=null,_0x30a6a7['isClick']=!![];};_0x1335c9[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x4c9007),_0x1335c9[_0x4bbbc4(0x501)](_0x4bbbc4(0x8ce),_0x1d0692),_0x1335c9[_0x4bbbc4(0x501)]('touchstart',_0x1d0692,{'passive':!![]}),_0x1335c9[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x9e3dd6=>{const _0x6901dd=_0x4bbbc4;_0x9e3dd6['target']&&_0x9e3dd6['target']['id']===_0x6901dd(0x1519)&&_0x3a9e92();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x667))['addEventListener'](_0x4bbbc4(0x15ad),()=>{_0x4c8b14['activeChatId']&&_0x4fda4b(_0x4c8b14['activeChatId']);}),document[_0x4bbbc4(0x400)]('api-preset-select')['addEventListener'](_0x4bbbc4(0x866),_0x3d2638),document['getElementById'](_0x4bbbc4(0xcc4))['addEventListener'](_0x4bbbc4(0x15ad),_0x28beac),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1609))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x5e6814),document[_0x4bbbc4(0x400)]('add-world-book-entry-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x1f8b44=_0x4bbbc4,_0x1f1fd0=document['getElementById'](_0x1f8b44(0x6b1));_0x1f1fd0[_0x1f8b44(0x13ef)]('p')&&(_0x1f1fd0[_0x1f8b44(0x1575)]='');const _0x5865e1=_0x308c96();_0x1f1fd0['appendChild'](_0x5865e1),_0x5865e1[_0x1f8b44(0x13ef)](_0x1f8b44(0xf05))['focus']();}),document[_0x4bbbc4(0x400)]('switch-greeting-btn')['addEventListener']('click',_0x2dcee0),document[_0x4bbbc4(0x400)]('thoughts-history-list')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x27f209=>{const _0x28d1e6=_0x4bbbc4;_0x27f209[_0x28d1e6(0x657)]&&_0x27f209[_0x28d1e6(0x657)]['id']===_0x28d1e6(0x1317)&&_0x4c9c15();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x15b3))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x1efbb9),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xe35))['addEventListener'](_0x4bbbc4(0x15ad),_0x2a0cea),document['getElementById'](_0x4bbbc4(0x259))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x46a0ce=>{const _0x4d38c4=_0x4bbbc4;_0x46a0ce['target']['id']===_0x4d38c4(0x259)&&_0x46a0ce[_0x4d38c4(0x657)][_0x4d38c4(0xb08)][_0x4d38c4(0xc46)](_0x4d38c4(0x9eb));}),document['getElementById']('manage-stickers-btn')['addEventListener'](_0x4bbbc4(0x15ad),_0x1c5590),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xc13))[_0x4bbbc4(0x501)]('click',_0x4fc106),document[_0x4bbbc4(0x400)]('qzone-back-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>_0x51a6d1(_0x4bbbc4(0xe06))),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xa5d))[_0x4bbbc4(0x501)]('click',()=>_0x51a6d1(_0x4bbbc4(0xe06)));const _0x3864a2=document[_0x4bbbc4(0x400)](_0x4bbbc4(0xa81)),_0x6f2bfe=document['getElementById'](_0x4bbbc4(0x1502));_0x3864a2[_0x4bbbc4(0x501)](_0x4bbbc4(0x10a8),()=>{const _0x3e9536=_0x4bbbc4,_0x36818f=_0x3864a2['value'][_0x3e9536(0xb8f)]()[_0x3e9536(0x1653)]();_0x6f2bfe[_0x3e9536(0xa00)][_0x3e9536(0xb1a)]=_0x36818f?'block':_0x3e9536(0x165b);if(!_0x36818f){_0x45d63c(allFavoriteItems);return;}const _0x597c89=allFavoriteItems[_0x3e9536(0x29d)](_0x32d295=>{const _0x1530ae=_0x3e9536;let _0x23ae4a='',_0x4afe83='';if(_0x32d295['type']===_0x1530ae(0x1353)){const _0x482107=_0x32d295[_0x1530ae(0x1109)];_0x23ae4a+=(_0x482107['publicText']||'')+'\x20'+(_0x482107[_0x1530ae(0x1109)]||'');if(_0x482107['authorId']==='user')_0x4afe83=_0x4c8b14[_0x1530ae(0x834)][_0x1530ae(0xbf3)];else _0x4c8b14[_0x1530ae(0xbea)][_0x482107[_0x1530ae(0x606)]]&&(_0x4afe83=_0x4c8b14[_0x1530ae(0xbea)][_0x482107['authorId']][_0x1530ae(0xf3e)]);}else{if(_0x32d295[_0x1530ae(0xbbf)]===_0x1530ae(0x9da)){const _0x4b588d=_0x32d295['content'];typeof _0x4b588d[_0x1530ae(0x1109)]===_0x1530ae(0x158f)&&(_0x23ae4a=_0x4b588d[_0x1530ae(0x1109)]);const _0x5af3a0=_0x4c8b14['chats'][_0x32d295['chatId']];_0x5af3a0&&(_0x4b588d[_0x1530ae(0x71a)]===_0x1530ae(0x6d6)?_0x4afe83=_0x5af3a0[_0x1530ae(0xc98)]?_0x5af3a0[_0x1530ae(0xa37)][_0x1530ae(0x14a8)]||'我':'我':_0x4afe83=_0x5af3a0[_0x1530ae(0xc98)]?_0x4b588d['senderName']:_0x5af3a0[_0x1530ae(0xf3e)]);}}return _0x23ae4a[_0x1530ae(0x1653)]()[_0x1530ae(0xd1b)](_0x36818f)||_0x4afe83['toLowerCase']()[_0x1530ae(0xd1b)](_0x36818f);});_0x45d63c(_0x597c89);}),_0x6f2bfe[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x3f83d8=_0x4bbbc4;_0x3864a2['value']='',_0x6f2bfe['style'][_0x3f83d8(0xb1a)]='none',_0x45d63c(allFavoriteItems),_0x3864a2[_0x3f83d8(0x797)]();}),document[_0x4bbbc4(0x400)]('selection-favorite-btn')['addEventListener'](_0x4bbbc4(0x15ad),async()=>{const _0x5d07e6=_0x4bbbc4;if(_0x141aad['size']===0x0)return;const _0x3437dd=_0x4c8b14[_0x5d07e6(0xbea)][_0x4c8b14[_0x5d07e6(0x1539)]];if(!_0x3437dd)return;const _0x596a34=[],_0x3bb23c=[..._0x141aad];for(const _0x2f1aae of _0x3bb23c){const _0x1d378f=await _0x54c587[_0x5d07e6(0x69c)]['where'](_0x5d07e6(0xb4d))[_0x5d07e6(0x4ce)](_0x2f1aae)[_0x5d07e6(0x149c)]();if(!_0x1d378f){const _0x46bb0f=_0x3437dd[_0x5d07e6(0x92c)]['find'](_0x5b05bc=>_0x5b05bc[_0x5d07e6(0x287)]===_0x2f1aae);_0x46bb0f&&_0x596a34[_0x5d07e6(0x6bb)]({'type':_0x5d07e6(0x9da),'content':_0x46bb0f,'chatId':_0x4c8b14[_0x5d07e6(0x1539)],'timestamp':Date['now'](),'originalTimestamp':_0x46bb0f[_0x5d07e6(0x287)]});}}_0x596a34[_0x5d07e6(0x8d6)]>0x0?(await _0x54c587[_0x5d07e6(0x69c)][_0x5d07e6(0x666)](_0x596a34),allFavoriteItems=await _0x54c587['favorites'][_0x5d07e6(0x541)](_0x5d07e6(0x287))[_0x5d07e6(0xfc1)]()[_0x5d07e6(0xce1)](),await _0x138765('收藏成功',_0x5d07e6(0x757)+_0x596a34['length']+_0x5d07e6(0x12d8))):await _0x138765('提示','选中的消息均已收藏过。'),_0x4e7c87();});const _0x552792=document[_0x4bbbc4(0x400)]('favorites-edit-btn'),_0x4f5278=document[_0x4bbbc4(0x400)](_0x4bbbc4(0x4ab)),_0x133781=document['getElementById'](_0x4bbbc4(0x14e6)),_0x337873=document[_0x4bbbc4(0x400)](_0x4bbbc4(0x368)),_0x5187e0=document[_0x4bbbc4(0x400)](_0x4bbbc4(0xfbb));_0x552792['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0xdbe634=_0x4bbbc4;_0x16539f=!_0x16539f,_0x4f5278[_0xdbe634(0xb08)]['toggle'](_0xdbe634(0x1046),_0x16539f),_0x16539f?(_0x552792['textContent']='完成',_0x133781[_0xdbe634(0xa00)][_0xdbe634(0xb1a)]=_0xdbe634(0x1181),_0x337873['style'][_0xdbe634(0xb1a)]=_0xdbe634(0x165b),_0x5187e0[_0xdbe634(0xa00)][_0xdbe634(0x96c)]=_0xdbe634(0x12d2)):(_0x552792[_0xdbe634(0xde7)]='编辑',_0x133781['style'][_0xdbe634(0xb1a)]=_0xdbe634(0x165b),_0x337873[_0xdbe634(0xa00)][_0xdbe634(0xb1a)]=_0xdbe634(0x375),_0x5187e0[_0xdbe634(0xa00)][_0xdbe634(0x96c)]='',_0x6556a7['clear'](),document[_0xdbe634(0x527)]('.favorite-item-card.selected')[_0xdbe634(0xbdc)](_0x22c41c=>_0x22c41c[_0xdbe634(0xb08)]['remove'](_0xdbe634(0x148b))),document[_0xdbe634(0x400)]('favorites-delete-selected-btn')[_0xdbe634(0xde7)]=_0xdbe634(0x754));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xfbb))['addEventListener'](_0x4bbbc4(0x15ad),_0x4f7666=>{const _0x275c08=_0x4bbbc4,_0x15bfa8=_0x4f7666[_0x275c08(0x657)],_0xa165ed=_0x15bfa8[_0x275c08(0x117a)](_0x275c08(0xced));if(_0x15bfa8[_0x275c08(0xa95)]===_0x275c08(0x7b7)&&_0x15bfa8[_0x275c08(0xd61)]['hiddenText']){const _0x594e10=_0x15bfa8[_0x275c08(0xd61)]['hiddenText'];_0x138765(_0x275c08(0xac3),_0x594e10[_0x275c08(0xe19)](/<br>/g,'\x0a'));return;}if(!_0x16539f)return;if(!_0xa165ed)return;const _0x502aa5=parseInt(_0xa165ed[_0x275c08(0xd61)][_0x275c08(0xc0a)]);if(isNaN(_0x502aa5))return;_0x6556a7['has'](_0x502aa5)?(_0x6556a7[_0x275c08(0x942)](_0x502aa5),_0xa165ed[_0x275c08(0xb08)]['remove'](_0x275c08(0x148b))):(_0x6556a7[_0x275c08(0x12b6)](_0x502aa5),_0xa165ed[_0x275c08(0xb08)][_0x275c08(0x12b6)](_0x275c08(0x148b))),document[_0x275c08(0x400)](_0x275c08(0x1082))[_0x275c08(0xde7)]='删除\x20('+_0x6556a7[_0x275c08(0x9e8)]+')';}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1082))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x1dda71=_0x4bbbc4;if(_0x6556a7[_0x1dda71(0x9e8)]===0x0)return;const _0x59f1bc=await _0x56d4d3(_0x1dda71(0x713),_0x1dda71(0x242)+_0x6556a7['size']+_0x1dda71(0xb6c),{'confirmButtonClass':_0x1dda71(0x142c)});if(_0x59f1bc){const _0x35d02f=[..._0x6556a7];await _0x54c587[_0x1dda71(0x69c)][_0x1dda71(0x2c6)](_0x35d02f),await _0x138765(_0x1dda71(0xee6),'选中的收藏已被移除。'),allFavoriteItems=allFavoriteItems[_0x1dda71(0x29d)](_0x12f242=>!_0x35d02f[_0x1dda71(0xd1b)](_0x12f242['id'])),_0x45d63c(allFavoriteItems),_0x552792[_0x1dda71(0x15ad)]();}});_0x4c8b14[_0x4bbbc4(0x14f1)][_0x4bbbc4(0x3c4)]&&(_0x29a569(),console[_0x4bbbc4(0x1e6)](_0x4bbbc4(0x13db)));document['querySelectorAll'](_0x4bbbc4(0xf65))['forEach'](_0x25c026=>{const _0x1430bc=_0x4bbbc4;_0x25c026[_0x1430bc(0x501)]('change',_0x290380);});const _0x105d43=document[_0x4bbbc4(0x400)](_0x4bbbc4(0x100e));_0x105d43[_0x4bbbc4(0x501)](_0x4bbbc4(0x10a8),()=>{const _0x2e6963=_0x4bbbc4;document['getElementById'](_0x2e6963(0x8e4))[_0x2e6963(0xde7)]=_0x105d43[_0x2e6963(0xa1e)]+'px',_0x290380();});const _0x38773c=document[_0x4bbbc4(0x400)](_0x4bbbc4(0x4ed));_0x38773c['addEventListener']('input',_0x290380),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xc2a))[_0x4bbbc4(0x501)]('click',()=>{const _0x83592f=_0x4bbbc4;document[_0x83592f(0x400)](_0x83592f(0x65f))[_0x83592f(0x6f9)]=!![],_0x290380();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x691))[_0x4bbbc4(0x501)]('click',()=>{const _0x1267a5=_0x4bbbc4;document[_0x1267a5(0x400)](_0x1267a5(0x4ed))[_0x1267a5(0xa1e)]='',_0x290380();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x14f4))[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),_0x290380),document['getElementById'](_0x4bbbc4(0x1067))[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),_0x290380),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x674))['addEventListener'](_0x4bbbc4(0x10a8),_0x290380),document['querySelectorAll'](_0x4bbbc4(0x5ea))[_0x4bbbc4(0xbdc)](_0x2b7e19=>{_0x2b7e19['addEventListener']('change',function(){const _0x54f8e1=_0x466f,_0x186521=document[_0x54f8e1(0x400)]('post-visibility-groups');this[_0x54f8e1(0xa1e)]===_0x54f8e1(0xe70)||this['value']===_0x54f8e1(0xeb8)?_0x186521[_0x54f8e1(0xa00)][_0x54f8e1(0xb1a)]=_0x54f8e1(0x1181):_0x186521[_0x54f8e1(0xa00)][_0x54f8e1(0xb1a)]=_0x54f8e1(0x165b);});}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x363))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x2fde65),document[_0x4bbbc4(0x400)]('close-group-manager-btn')[_0x4bbbc4(0x501)]('click',()=>{const _0x110e56=_0x4bbbc4;document[_0x110e56(0x400)](_0x110e56(0x367))['classList']['remove'](_0x110e56(0x9eb));const _0x207393=document[_0x110e56(0x400)](_0x110e56(0x9b3));document[_0x110e56(0x400)](_0x110e56(0x260))['classList'][_0x110e56(0xd3f)](_0x110e56(0x9eb))&&_0x207393[_0x110e56(0x15ad)]();}),document[_0x4bbbc4(0x400)]('add-new-group-btn')[_0x4bbbc4(0x501)]('click',_0x21d224),document[_0x4bbbc4(0x400)]('existing-groups-list')[_0x4bbbc4(0x501)]('click',_0x11fd65=>{const _0x1ba644=_0x4bbbc4;if(_0x11fd65['target'][_0x1ba644(0xb08)]['contains'](_0x1ba644(0xd38))){const _0x46c908=parseInt(_0x11fd65[_0x1ba644(0x657)][_0x1ba644(0xd61)]['id']);_0x2ff6e5(_0x46c908);}}),document['getElementById']('cancel-message-action-btn')['addEventListener'](_0x4bbbc4(0x15ad),_0x4f08fc),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xdc3))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x41de2a),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x948))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x1621f1),document['getElementById'](_0x4bbbc4(0x1507))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0xae2b9a),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x162b))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x5c8b8d=_0x465ba7;_0x4f08fc(),_0x5c8b8d&&_0x42dbdb(_0x5c8b8d);}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x75b))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x5728ee=>{const _0x128fb5=_0x4bbbc4,_0x57f461=_0x5728ee[_0x128fb5(0x657)][_0x128fb5(0x117a)](_0x128fb5(0x15d1));if(!_0x57f461)return;if(_0x57f461[_0x128fb5(0xb08)][_0x128fb5(0xd3f)]('ai')&&_0x57f461[_0x128fb5(0xb08)]['contains'](_0x128fb5(0x1175))&&_0x57f461['dataset'][_0x128fb5(0x12c3)]===_0x128fb5(0x9c6)){const _0x565c5e=parseInt(_0x57f461[_0x128fb5(0xd61)]['timestamp']);!isNaN(_0x565c5e)&&_0x55f11a(_0x565c5e);}}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xe11))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>_0x1d70c8('accepted')),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1322))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>_0x1d70c8(_0x4bbbc4(0x81f))),document[_0x4bbbc4(0x400)]('transfer-action-cancel')[_0x4bbbc4(0x501)]('click',_0x268ad6),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x469))[_0x4bbbc4(0x501)]('click',_0x3ad0d3),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x13b3))['addEventListener'](_0x4bbbc4(0x15ad),_0x1b0d66),document[_0x4bbbc4(0x400)]('cancel-post-action-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x1fa1fc),document[_0x4bbbc4(0x400)]('cancel-contact-picker-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x2e9fec=_0x4bbbc4;_0x257d51(_0x2e9fec(0x9a4));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x52d))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x420edf=>{const _0x2ffef5=_0x4bbbc4,_0x555971=_0x420edf[_0x2ffef5(0x657)][_0x2ffef5(0x117a)](_0x2ffef5(0xff2));if(!_0x555971)return;const _0x348a57=_0x555971['dataset'][_0x2ffef5(0xe42)];_0x555971[_0x2ffef5(0xb08)][_0x2ffef5(0x146f)](_0x2ffef5(0x148b)),_0x3b3c72['has'](_0x348a57)?_0x3b3c72['delete'](_0x348a57):_0x3b3c72['add'](_0x348a57),_0x5a41f2();}),document['getElementById'](_0x4bbbc4(0x522))['addEventListener']('click',()=>{_0x1a19aa();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xa0d))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x4fbebd=_0x4bbbc4;_0x257d51(_0x4fbebd(0x946)),document[_0x4fbebd(0x400)](_0x4fbebd(0x9b3))[_0x4fbebd(0x15ad)]();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xc08))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x2df609=>{const _0x1ce272=_0x4bbbc4;_0x2df609[_0x1ce272(0x657)][_0x1ce272(0xb08)][_0x1ce272(0xd3f)](_0x1ce272(0x163b))&&_0x16409f(_0x2df609[_0x1ce272(0x657)][_0x1ce272(0xd61)][_0x1ce272(0x14c4)]);}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x11ff))['addEventListener'](_0x4bbbc4(0x15ad),async()=>{const _0x3d981c=_0x4bbbc4,_0x239526=document[_0x3d981c(0x400)](_0x3d981c(0x3a8)),_0x26a87e=_0x239526['cloneNode'](!![]);_0x239526['parentNode'][_0x3d981c(0xf6f)](_0x26a87e,_0x239526),_0x26a87e[_0x3d981c(0x501)](_0x3d981c(0x15ad),_0x389f0e),await _0x425c66();}),document[_0x4bbbc4(0x400)]('create-new-member-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x253fe0),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xb59))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x1f3f08),document[_0x4bbbc4(0x400)]('group-video-call-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x1f3f08),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1343))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x4e9bf7),document['getElementById']('minimize-call-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x446a60),document[_0x4bbbc4(0x400)]('video-call-restore-btn')['addEventListener'](_0x4bbbc4(0x15ad),_0x5ba02d),_0x4aead0(document[_0x4bbbc4(0x400)]('video-call-restore-btn'),document['getElementById'](_0x4bbbc4(0xdff))),document['getElementById'](_0x4bbbc4(0x1151))[_0x4bbbc4(0x501)]('click',()=>{const _0x1b9d45=_0x4bbbc4;_0x4037ab[_0x1b9d45(0x3ed)]=![],_0x257d51(_0x1b9d45(0x946));}),document['getElementById']('join-call-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x58cfc8),document[_0x4bbbc4(0x400)]('decline-call-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x3e8a7a=_0x4bbbc4;_0x4d54df();const _0x5f2896=_0x4c8b14[_0x3e8a7a(0xbea)][_0x4037ab[_0x3e8a7a(0x1539)]];if(!_0x5f2896)return;if(_0x4037ab['isGroupCall']){_0x4037ab['isUserParticipating']=![];const _0x15d196={'role':_0x3e8a7a(0xaf6),'content':_0x3e8a7a(0x764),'timestamp':Date[_0x3e8a7a(0xecd)](),'isHidden':!![]};_0x5f2896[_0x3e8a7a(0x92c)][_0x3e8a7a(0x6bb)](_0x15d196),await _0x54c587[_0x3e8a7a(0xbea)]['put'](_0x5f2896),await _0x58df1c();}else{const _0x521564={'role':_0x3e8a7a(0x6d6),'content':_0x3e8a7a(0x111d),'timestamp':Date[_0x3e8a7a(0xecd)]()};_0x5f2896[_0x3e8a7a(0x92c)][_0x3e8a7a(0x6bb)](_0x521564),await _0x54c587['chats']['put'](_0x5f2896),_0x257d51(_0x3e8a7a(0x946)),_0x41ecc7(_0x521564,_0x5f2896),_0x58df1c();}_0x4037ab[_0x3e8a7a(0x3ed)]=![];}),document[_0x4bbbc4(0x400)]('accept-call-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x7f5bd3=_0x4bbbc4;_0x4d54df(),_0x4037ab[_0x7f5bd3(0x8fc)]='ai',_0x4037ab[_0x7f5bd3(0x1488)]=!![],_0x4037ab[_0x7f5bd3(0x1539)]=_0x4c8b14['activeChatId'];if(_0x4037ab[_0x7f5bd3(0x593)]){const _0x4287d8=_0x4c8b14['chats'][_0x4037ab[_0x7f5bd3(0x1539)]],_0x59ed67=_0x4287d8[_0x7f5bd3(0x4f8)]['find'](_0x129ab0=>_0x129ab0['name']===_0x4037ab[_0x7f5bd3(0x496)]);_0x59ed67?_0x4037ab[_0x7f5bd3(0x131d)]=[_0x59ed67]:_0x4037ab[_0x7f5bd3(0x131d)]=[];}_0xd23e33();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1db))[_0x4bbbc4(0x501)]('click',async()=>{const _0x13a01b=_0x4bbbc4;if(!_0x4037ab[_0x13a01b(0x11e7)])return;const _0x1f6105=document['querySelector'](_0x13a01b(0xcd4));_0x1f6105&&_0x1f6105[_0x13a01b(0xb08)][_0x13a01b(0x12b6)](_0x13a01b(0xecf));const _0x47e225=await _0x25f61f('你说',_0x13a01b(0xb9c));_0x1f6105&&_0x1f6105[_0x13a01b(0xb08)][_0x13a01b(0xc46)](_0x13a01b(0xecf)),_0x47e225&&_0x47e225[_0x13a01b(0xb8f)]()&&_0x2ef86f(_0x47e225[_0x13a01b(0xb8f)]());}),document[_0x4bbbc4(0x13ef)](_0x4bbbc4(0x1f8))['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0x72e904=_0x4bbbc4;_0x16539f&&document[_0x72e904(0x400)](_0x72e904(0x15ac))['click'](),_0x51a6d1(_0x72e904(0xeab)),_0x4b6471();}),document[_0x4bbbc4(0x400)]('memories-back-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>_0x51a6d1(_0x4bbbc4(0xe06))),document[_0x4bbbc4(0x400)]('confirm-create-countdown-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x4b7c54=_0x4bbbc4,_0x3334b3=document['getElementById']('countdown-title-input')[_0x4b7c54(0xa1e)][_0x4b7c54(0xb8f)](),_0x28f50b=document[_0x4b7c54(0x400)](_0x4b7c54(0x8b9))[_0x4b7c54(0xa1e)];if(!_0x3334b3||!_0x28f50b){alert(_0x4b7c54(0x157a));return;}const _0x1d0dcc=new Date(_0x28f50b);if(isNaN(_0x1d0dcc)||_0x1d0dcc<=new Date()){alert(_0x4b7c54(0x1405));return;}const _0x4ebcd3={'authorId':_0x4b7c54(0x6d6),'description':_0x3334b3,'timestamp':Date[_0x4b7c54(0xecd)](),'type':_0x4b7c54(0x264),'targetDate':_0x1d0dcc['getTime']()};await _0x54c587[_0x4b7c54(0x1541)][_0x4b7c54(0x12b6)](_0x4ebcd3),document[_0x4b7c54(0x400)](_0x4b7c54(0x744))[_0x4b7c54(0xb08)][_0x4b7c54(0xc46)]('visible'),_0x4b6471();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xb13))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x257e76=_0x4bbbc4;if(!_0x4c8b14['activeChatId']||_0x4c8b14[_0x257e76(0xbea)][_0x4c8b14[_0x257e76(0x1539)]][_0x257e76(0xc98)])return;const _0x347047=_0x4c8b14[_0x257e76(0xbea)][_0x4c8b14['activeChatId']],_0x2001c3=await _0x56d4d3('确认拉黑',_0x257e76(0x935)+_0x347047[_0x257e76(0xf3e)]+_0x257e76(0x6f6),{'confirmButtonClass':_0x257e76(0x142c)});if(_0x2001c3){_0x347047[_0x257e76(0x12f7)]['status']=_0x257e76(0x15ea),_0x347047[_0x257e76(0x12f7)][_0x257e76(0x1199)]=Date['now']();const _0x4ec112={'role':_0x257e76(0xaf6),'content':'[系统提示：你刚刚被用户拉黑了。在对方解除拉黑之前，你无法再主动发起对话，也无法回应。]','timestamp':Date[_0x257e76(0xecd)]()+0x1,'isHidden':!![]};_0x347047['history'][_0x257e76(0x6bb)](_0x4ec112),await _0x54c587[_0x257e76(0xbea)][_0x257e76(0x4cb)](_0x347047),document[_0x257e76(0x400)](_0x257e76(0x260))[_0x257e76(0xb08)][_0x257e76(0xc46)](_0x257e76(0x9eb)),_0x26354c(_0x4c8b14[_0x257e76(0x1539)]),_0x41b828();}}),document['getElementById'](_0x4bbbc4(0x711))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async _0x25102a=>{const _0x2332f0=_0x4bbbc4,_0x3987b4=_0x4c8b14[_0x2332f0(0xbea)][_0x4c8b14[_0x2332f0(0x1539)]];if(!_0x3987b4)return;if(_0x25102a[_0x2332f0(0x657)]['id']===_0x2332f0(0xe79)){alert(_0x2332f0(0xd49)),await _0x3eba75(_0x3987b4['id']),_0x26354c(_0x3987b4['id']);return;}if(_0x25102a[_0x2332f0(0x657)]['id']===_0x2332f0(0x1185)){_0x3987b4[_0x2332f0(0x12f7)]['status']=_0x2332f0(0x1290),_0x3987b4[_0x2332f0(0x12f7)][_0x2332f0(0x1199)]=null;const _0x1fa23d={'role':_0x2332f0(0xaf6),'content':'[系统提示：用户刚刚解除了对你的拉黑。现在你们可以重新开始对话了。]','timestamp':Date[_0x2332f0(0xecd)](),'isHidden':!![]};_0x3987b4[_0x2332f0(0x92c)][_0x2332f0(0x6bb)](_0x1fa23d),await _0x54c587[_0x2332f0(0xbea)][_0x2332f0(0x4cb)](_0x3987b4),_0x26354c(_0x3987b4['id']),_0x41b828(),_0x58df1c();}else{if(_0x25102a[_0x2332f0(0x657)]['id']===_0x2332f0(0x25b)){const _0x5dc0cf=_0x3987b4[_0x2332f0(0x12f7)][_0x2332f0(0x275)]||_0x2332f0(0x1268);_0x3987b4[_0x2332f0(0x12f7)]['status']='friend',_0x3987b4['relationship'][_0x2332f0(0x275)]='';const _0x3d58b2={'role':_0x2332f0(0xaf6),'type':_0x2332f0(0xaa4),'content':_0x2332f0(0x7bf)+_0x3987b4['name']+_0x2332f0(0x494),'timestamp':Date[_0x2332f0(0xecd)]()};_0x3987b4[_0x2332f0(0x92c)]['push'](_0x3d58b2);const _0x570891={'role':_0x2332f0(0x4fd),'senderName':_0x3987b4[_0x2332f0(0xf3e)],'content':_0x5dc0cf,'timestamp':Date[_0x2332f0(0xecd)]()+0x1};_0x3987b4[_0x2332f0(0x92c)][_0x2332f0(0x6bb)](_0x570891),await _0x54c587['chats']['put'](_0x3987b4),_0x26354c(_0x3987b4['id']),_0x41b828();}else{if(_0x25102a['target']['id']===_0x2332f0(0xd6f))_0x3987b4['relationship'][_0x2332f0(0x12c3)]='blocked_by_user',_0x3987b4[_0x2332f0(0x12f7)][_0x2332f0(0x1199)]=Date[_0x2332f0(0xecd)](),_0x3987b4[_0x2332f0(0x12f7)]['applicationReason']='',await _0x54c587['chats'][_0x2332f0(0x4cb)](_0x3987b4),_0x26354c(_0x3987b4['id']);else{if(_0x25102a[_0x2332f0(0x657)]['id']===_0x2332f0(0x3c5)){const _0x8c7aac=await _0x25f61f(_0x2332f0(0x1200),_0x2332f0(0xb06)+_0x3987b4['name']+_0x2332f0(0x12c8),_0x2332f0(0xf06));_0x8c7aac!==null&&(_0x3987b4[_0x2332f0(0x12f7)][_0x2332f0(0x12c3)]=_0x2332f0(0x59d),_0x3987b4[_0x2332f0(0x12f7)][_0x2332f0(0x275)]=_0x8c7aac,await _0x54c587[_0x2332f0(0xbea)][_0x2332f0(0x4cb)](_0x3987b4),_0x26354c(_0x3987b4['id']),_0x41b828(),_0x58df1c());}}}}}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x150e))['addEventListener']('click',_0x129f5d),document[_0x4bbbc4(0x400)]('cancel-red-packet-btn')['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0x14cf86=_0x4bbbc4;document[_0x14cf86(0x400)]('red-packet-modal')[_0x14cf86(0xb08)][_0x14cf86(0xc46)]('visible');}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x141c))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x1d3ff3),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xac6))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x98ee62);const _0x2e2f78=document[_0x4bbbc4(0x400)](_0x4bbbc4(0xf76)),_0x76f2e8=document[_0x4bbbc4(0x400)]('rp-tab-direct'),_0x3a5a14=document[_0x4bbbc4(0x400)](_0x4bbbc4(0x397)),_0x480c33=document[_0x4bbbc4(0x400)](_0x4bbbc4(0xa5e));_0x2e2f78[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x2968ff=_0x4bbbc4;_0x2e2f78[_0x2968ff(0xb08)][_0x2968ff(0x12b6)](_0x2968ff(0x5d6)),_0x76f2e8['classList']['remove'](_0x2968ff(0x5d6)),_0x3a5a14[_0x2968ff(0xa00)][_0x2968ff(0xb1a)]='block',_0x480c33[_0x2968ff(0xa00)][_0x2968ff(0xb1a)]='none';}),_0x76f2e8[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x5387b4=_0x4bbbc4;_0x76f2e8[_0x5387b4(0xb08)][_0x5387b4(0x12b6)](_0x5387b4(0x5d6)),_0x2e2f78[_0x5387b4(0xb08)][_0x5387b4(0xc46)](_0x5387b4(0x5d6)),_0x480c33['style'][_0x5387b4(0xb1a)]=_0x5387b4(0x1181),_0x3a5a14[_0x5387b4(0xa00)][_0x5387b4(0xb1a)]=_0x5387b4(0x165b);}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1669))[_0x4bbbc4(0x501)](_0x4bbbc4(0x10a8),_0x293abe=>{const _0xab9655=_0x4bbbc4,_0x2c7fcb=parseFloat(_0x293abe['target'][_0xab9655(0xa1e)])||0x0;document[_0xab9655(0x400)](_0xab9655(0x11e2))['textContent']='¥\x20'+_0x2c7fcb['toFixed'](0x2);}),document['getElementById'](_0x4bbbc4(0x33e))[_0x4bbbc4(0x501)](_0x4bbbc4(0x10a8),_0x5e0ed1=>{const _0x39d11a=_0x4bbbc4,_0x32098a=parseFloat(_0x5e0ed1[_0x39d11a(0x657)][_0x39d11a(0xa1e)])||0x0;document[_0x39d11a(0x400)](_0x39d11a(0xba3))[_0x39d11a(0xde7)]='¥\x20'+_0x32098a['toFixed'](0x2);}),document['getElementById'](_0x4bbbc4(0x75b))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x1062a4=>{const _0x48dfcf=_0x4bbbc4,_0x1c7f86=_0x1062a4['target'][_0x48dfcf(0x117a)](_0x48dfcf(0x3b9));if(!_0x1c7f86)return;const _0x1f48b0=_0x1c7f86['closest'](_0x48dfcf(0x15d1));if(!_0x1f48b0||!_0x1f48b0[_0x48dfcf(0xd61)][_0x48dfcf(0x287)])return;const _0x2e1c81=parseInt(_0x1f48b0[_0x48dfcf(0xd61)][_0x48dfcf(0x287)]);_0x3f6023(_0x2e1c81);}),document['getElementById'](_0x4bbbc4(0x633))['addEventListener']('click',_0x45c050),document['getElementById'](_0x4bbbc4(0x14a9))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x192645),document['getElementById'](_0x4bbbc4(0x10dc))[_0x4bbbc4(0x501)]('click',()=>{const _0x172f60=_0x4bbbc4;document[_0x172f60(0x400)](_0x172f60(0x801))[_0x172f60(0xb08)][_0x172f60(0xc46)](_0x172f60(0x9eb));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x5ce))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x4d0493),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x75b))['addEventListener'](_0x4bbbc4(0x15ad),_0x1ad98f=>{const _0x340fa4=_0x4bbbc4,_0x384b2b=_0x1ad98f[_0x340fa4(0x657)][_0x340fa4(0x117a)]('.poll-card');if(!_0x384b2b)return;const _0x30d418=parseInt(_0x384b2b['dataset'][_0x340fa4(0x63e)]);if(isNaN(_0x30d418))return;const _0xcadf6e=_0x1ad98f[_0x340fa4(0x657)][_0x340fa4(0x117a)]('.poll-option-item');if(_0xcadf6e&&!_0x384b2b[_0x340fa4(0xb08)][_0x340fa4(0xd3f)]('closed')){_0x3ea12a(_0x30d418,_0xcadf6e[_0x340fa4(0xd61)]['option']);return;}const _0x18decc=_0x1ad98f[_0x340fa4(0x657)][_0x340fa4(0x117a)]('.poll-action-btn');if(_0x18decc){_0x384b2b[_0x340fa4(0xb08)]['contains'](_0x340fa4(0x10b1))?_0x26d52b(_0x30d418):_0x540124(_0x30d418);return;}_0x384b2b['classList']['contains']('closed')&&_0x26d52b(_0x30d418);}),document['getElementById'](_0x4bbbc4(0x134b))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x2811ce),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x125f))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>_0x3d74fb('ai')),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xac9))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>_0x3d74fb(_0x4bbbc4(0x1377))),document['getElementById'](_0x4bbbc4(0xbe5))[_0x4bbbc4(0x501)]('click',_0x581a8e),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1050))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x53c96d=_0x4bbbc4;document[_0x53c96d(0x400)](_0x53c96d(0x4c0))[_0x53c96d(0x15ad)]();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x4c0))[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),_0xf629ad),document[_0x4bbbc4(0x400)]('close-ai-avatar-library-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x3a05cc),document[_0x4bbbc4(0x400)]('manage-group-avatar-library-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x45a8bb),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x31f))['addEventListener']('click',_0xaa1efc),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x723))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x52e0c4=_0x4bbbc4;document['getElementById'](_0x52e0c4(0x83e))[_0x52e0c4(0x15ad)]();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x83e))[_0x4bbbc4(0x501)]('change',_0x52dbaf),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xe32))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x1ab1f2),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x69e))[_0x4bbbc4(0x501)]('click',_0xeceb1e=>{const _0x46b899=_0x4bbbc4;if(_0xeceb1e[_0x46b899(0x657)][_0x46b899(0xb08)][_0x46b899(0xd3f)]('change-icon-btn')){const _0x48c727=_0xeceb1e['target'][_0x46b899(0x117a)](_0x46b899(0xfeb)),_0x44f204=_0x48c727[_0x46b899(0xd61)]['iconId'];_0x44f204&&_0x4c1b29(_0x44f204,_0x46b899(0x343),_0x48c727);}}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x75b))[_0x4bbbc4(0x501)]('click',_0x445238=>{const _0x5194e6=_0x4bbbc4,_0x4bb6dd=_0x445238[_0x5194e6(0x657)][_0x5194e6(0x117a)](_0x5194e6(0xd66));if(_0x4bb6dd){const _0xe76b1a=parseInt(_0x4bb6dd[_0x5194e6(0xd61)][_0x5194e6(0x287)]);!isNaN(_0xe76b1a)&&_0x102628(_0xe76b1a);}}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x49a))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{_0x257d51('chat-interface-screen');}),_0x2eb114['panelEl']['addEventListener'](_0x4bbbc4(0x15ad),async _0xc55bec=>{const _0x3e1e8c=_0x4bbbc4,_0x4e1979=_0xc55bec[_0x3e1e8c(0x657)][_0x3e1e8c(0x117a)](_0x3e1e8c(0x1354));if(_0x4e1979&&_0x2eb114[_0x3e1e8c(0x1155)]!==null){const _0x222afb=_0x4e1979[_0x3e1e8c(0xa00)][_0x3e1e8c(0xf11)][_0x3e1e8c(0x69f)](0x5,-0x2),_0x492f26=_0x4c8b14[_0x3e1e8c(0x120c)][_0x3e1e8c(0x821)](_0x19c0bb=>_0x19c0bb[_0x3e1e8c(0x299)]===_0x222afb);_0x492f26?await _0x2f9704(_0x2eb114['activePostId'],_0x492f26):console[_0x3e1e8c(0x75e)](_0x3e1e8c(0x23c),_0x222afb);}}),document[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x5306a6=>{const _0x592631=_0x4bbbc4;_0x2eb114[_0x592631(0x12b0)]&&!_0x2eb114[_0x592631(0x10ef)]['contains'](_0x5306a6['target'])&&!_0x5306a6[_0x592631(0x657)][_0x592631(0x117a)]('.comment-sticker-btn')&&_0x647d65();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x2e6))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x21be24),document['getElementById']('cancel-share-link-btn')['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0x7602c1=_0x4bbbc4;document['getElementById'](_0x7602c1(0x544))[_0x7602c1(0xb08)]['remove']('visible');}),document['getElementById']('confirm-share-link-btn')[_0x4bbbc4(0x501)]('click',_0x340fee),document[_0x4bbbc4(0x400)]('theme-toggle-switch')['addEventListener'](_0x4bbbc4(0x866),_0x1793a5),document['getElementById'](_0x4bbbc4(0x1404))[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),_0x155508=>{const _0x1672a0=_0x4bbbc4;_0x4459cc(_0x155508[_0x1672a0(0x657)][_0x1672a0(0x6f9)]);}),document['getElementById']('phone-frame-toggle-switch')[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),_0x2bcd3e=>{const _0x48212d=_0x4bbbc4;_0x12d3df(_0x2bcd3e[_0x48212d(0x657)]['checked']);}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x205))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x766c76),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x124a))['addEventListener'](_0x4bbbc4(0x15ad),_0x4edde2),document[_0x4bbbc4(0x400)]('call-history-back-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{_0x257d51('chat-list-screen');}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x715))[_0x4bbbc4(0x501)]('click',_0x4280a5=>{const _0x5853dc=_0x4bbbc4,_0x42b5ad=_0x4280a5[_0x5853dc(0x657)]['closest']('.call-record-card');_0x42b5ad&&_0x42b5ad['dataset'][_0x5853dc(0x83d)]&&_0x1a5a54(parseInt(_0x42b5ad['dataset'][_0x5853dc(0x83d)]));}),document['getElementById'](_0x4bbbc4(0x491))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x39f603=_0x4bbbc4;document[_0x39f603(0x400)](_0x39f603(0xb71))[_0x39f603(0xb08)]['remove']('visible');}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1003))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x1e5005),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x446))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x195c70=_0x4bbbc4;_0x141aad[_0x195c70(0x9e8)]>0x0&&_0x38a281();}),document['getElementById'](_0x4bbbc4(0x29f))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x5a242f),document['getElementById'](_0x4bbbc4(0x152f))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x2c637b=_0x4bbbc4,_0x3f4110=_0x4c8b14['chats'][_0x4c8b14[_0x2c637b(0x1539)]],_0x34121c=Array[_0x2c637b(0xdc0)](document[_0x2c637b(0x527)](_0x2c637b(0x879)))['map'](_0x37b01e=>_0x37b01e[_0x2c637b(0xd61)][_0x2c637b(0x4dd)]);if(_0x34121c[_0x2c637b(0x8d6)]===0x0){alert(_0x2c637b(0x14bf));return;}const _0x3f6490=[],_0x284652=[..._0x141aad][_0x2c637b(0x968)]((_0x337404,_0x4ecf27)=>_0x337404-_0x4ecf27);for(const _0x306d22 of _0x284652){const _0x4a0b9a=_0x3f4110[_0x2c637b(0x92c)]['find'](_0x479231=>_0x479231[_0x2c637b(0x287)]===_0x306d22);_0x4a0b9a&&_0x3f6490[_0x2c637b(0x6bb)](_0x4a0b9a);}const _0x504b5c={'role':_0x2c637b(0x6d6),'senderName':_0x3f4110[_0x2c637b(0xc98)]?_0x3f4110[_0x2c637b(0xa37)][_0x2c637b(0x14a8)]||'我':'我','type':_0x2c637b(0xfff),'timestamp':Date[_0x2c637b(0xecd)](),'payload':{'sourceChatName':_0x3f4110[_0x2c637b(0xf3e)],'title':_0x2c637b(0x7c8)+_0x3f4110[_0x2c637b(0xf3e)]+_0x2c637b(0xf52),'sharedHistory':_0x3f6490}};for(const _0x1ddc12 of _0x34121c){const _0x29e8ce=_0x4c8b14[_0x2c637b(0xbea)][_0x1ddc12];_0x29e8ce&&(_0x29e8ce['history'][_0x2c637b(0x6bb)](_0x504b5c),await _0x54c587[_0x2c637b(0xbea)][_0x2c637b(0x4cb)](_0x29e8ce));}document[_0x2c637b(0x400)](_0x2c637b(0xca0))[_0x2c637b(0xb08)][_0x2c637b(0xc46)](_0x2c637b(0x9eb)),_0x4e7c87(),await _0x138765(_0x2c637b(0x14bb),_0x2c637b(0x262)+_0x34121c['length']+'\x20个会话中。'),_0x41b828();}),document[_0x4bbbc4(0x400)]('cancel-share-target-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x41b165=_0x4bbbc4;document[_0x41b165(0x400)]('share-target-modal')[_0x41b165(0xb08)]['remove'](_0x41b165(0x9eb));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x75b))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x42b1f0=>{const _0x4296b0=_0x4bbbc4,_0x5ae469=_0x42b1f0['target']['closest'](_0x4296b0(0x8ed));if(_0x5ae469&&_0x5ae469['closest'](_0x4296b0(0x7c9))){const _0x5bc755=parseInt(_0x5ae469[_0x4296b0(0xd61)][_0x4296b0(0x287)]);_0x1d5450(_0x5bc755);}}),document[_0x4bbbc4(0x400)]('close-shared-history-viewer-btn')['addEventListener']('click',()=>{const _0x3eb0aa=_0x4bbbc4;document[_0x3eb0aa(0x400)](_0x3eb0aa(0x24b))[_0x3eb0aa(0xb08)][_0x3eb0aa(0xc46)](_0x3eb0aa(0x9eb));});async function _0x1d5450(_0x6cb68e){const _0x34cc47=_0x4bbbc4,_0x37a1d9=_0x4c8b14[_0x34cc47(0xbea)][_0x4c8b14['activeChatId']];if(!_0x37a1d9)return;const _0x3c72a8=_0x37a1d9[_0x34cc47(0x92c)][_0x34cc47(0x821)](_0x3f8700=>_0x3f8700[_0x34cc47(0x287)]===_0x6cb68e);if(!_0x3c72a8){console[_0x34cc47(0x5d7)](_0x34cc47(0x5c6),_0x6cb68e),await _0x138765(_0x34cc47(0xe0f),_0x34cc47(0x104e));return;}if(_0x3c72a8['type']===_0x34cc47(0x4c1)){_0x102628(_0x6cb68e);return;}if(_0x3c72a8[_0x34cc47(0xbbf)]===_0x34cc47(0xfff)){if(!_0x3c72a8[_0x34cc47(0x4a8)]||!_0x3c72a8[_0x34cc47(0x4a8)][_0x34cc47(0x658)]){console[_0x34cc47(0x5d7)](_0x34cc47(0xa87),_0x3c72a8),await _0x138765(_0x34cc47(0xe0f),_0x34cc47(0xb44));return;}}else{console[_0x34cc47(0x5d7)]('未知的分享卡片类型:',_0x3c72a8[_0x34cc47(0xbbf)]),await _0x138765(_0x34cc47(0xe0f),'不支持的分享类型。');return;}const _0x53f7fa=document[_0x34cc47(0x400)](_0x34cc47(0x24b)),_0xe5fa2=document['getElementById'](_0x34cc47(0x14fc)),_0x34b5ad=document[_0x34cc47(0x400)]('shared-history-viewer-content');_0xe5fa2[_0x34cc47(0xde7)]=_0x3c72a8['payload'][_0x34cc47(0x647)],_0x34b5ad[_0x34cc47(0x1575)]='';const _0x4b78c1=document[_0x34cc47(0xf74)](),_0x336824=Object['values'](_0x4c8b14[_0x34cc47(0xbea)])[_0x34cc47(0x821)](_0x4a5ce2=>_0x4a5ce2['name']===_0x3c72a8[_0x34cc47(0x4a8)]['sourceChatName'])||_0x37a1d9;for(const _0x44e82c of _0x3c72a8[_0x34cc47(0x4a8)][_0x34cc47(0x658)]){const _0x5e3ae0=await _0x43c5e5(_0x44e82c,_0x336824);_0x5e3ae0&&_0x4b78c1[_0x34cc47(0x8f2)](_0x5e3ae0);}_0x34b5ad[_0x34cc47(0x8f2)](_0x4b78c1),_0x53f7fa['classList'][_0x34cc47(0x12b6)](_0x34cc47(0x9eb));}_0x86eb29[_0x4bbbc4(0x501)]('timeupdate',_0x51fff8),_0x86eb29['addEventListener'](_0x4bbbc4(0x1385),()=>{const _0x20d0ce=_0x4bbbc4;_0x59adb2[_0x20d0ce(0x11e7)]&&(_0x59adb2[_0x20d0ce(0x138e)]=![],phoneScreenForIsland[_0x20d0ce(0xb08)][_0x20d0ce(0xc46)](_0x20d0ce(0xa4b)),_0x12737e());}),_0x86eb29['addEventListener'](_0x4bbbc4(0x582),()=>{const _0x169770=_0x4bbbc4;_0x59adb2['isActive']&&(_0x59adb2[_0x169770(0x138e)]=!![],_0x12737e());}),document['getElementById'](_0x4bbbc4(0x1016))['addEventListener'](_0x4bbbc4(0x15ad),async _0xa43bbe=>{const _0x1477da=_0x4bbbc4,_0x489c69=_0xa43bbe['target'],_0x388e9c=_0x489c69[_0x1477da(0x117a)](_0x1477da(0x15bf));if(_0x388e9c){const _0xb8d27f=parseInt(_0x388e9c[_0x1477da(0xd61)]['index']);!isNaN(_0xb8d27f)&&await _0x4d4718(_0xb8d27f);return;}const _0x3eceef=_0x489c69['closest'](_0x1477da(0x1328));if(_0x3eceef){const _0x1ac2ef=parseInt(_0x3eceef[_0x1477da(0xd61)][_0x1477da(0x103b)]);if(isNaN(_0x1ac2ef))return;await _0x4e8084(_0x1ac2ef);return;}const _0x1ed9ae=_0x489c69[_0x1477da(0x117a)](_0x1477da(0x160e));if(_0x1ed9ae){const _0x139e9c=parseInt(_0x1ed9ae[_0x1477da(0xd61)]['index']);if(isNaN(_0x139e9c))return;const _0x3294a2=_0x59adb2[_0x1477da(0xc3e)][_0x139e9c],_0x53c606=await _0x56d4d3('删除歌曲','确定要从播放列表中删除《'+_0x3294a2[_0x1477da(0xf3e)]+'》吗？');_0x53c606&&_0xa62cc5(_0x139e9c);return;}const _0x13a5ba=_0x489c69[_0x1477da(0x117a)](_0x1477da(0xeb6));if(_0x13a5ba){const _0x71cb0e=_0x13a5ba[_0x1477da(0x117a)](_0x1477da(0x11cc)),_0xf8ae67=Array[_0x1477da(0xdc0)](_0x71cb0e[_0x1477da(0x6e6)][_0x1477da(0xc9d)])[_0x1477da(0xd53)](_0x71cb0e);_0xf8ae67>-0x1&&_0x3efb75(_0xf8ae67);}}),document['querySelector']('.progress-bar')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x2c58a6=>{const _0x1b5c0c=_0x4bbbc4;if(!_0x86eb29[_0x1b5c0c(0x4ee)])return;const _0x13d307=_0x2c58a6[_0x1b5c0c(0x3c2)],_0x5ec377=_0x13d307[_0x1b5c0c(0x13aa)],_0x340031=_0x2c58a6[_0x1b5c0c(0xe77)];_0x86eb29[_0x1b5c0c(0x1592)]=_0x340031/_0x5ec377*_0x86eb29[_0x1b5c0c(0x4ee)];}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x75b))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x5c3266=>{const _0x4912f9=_0x4bbbc4,_0x2e4e07=_0x5c3266[_0x4912f9(0x657)][_0x4912f9(0x117a)](_0x4912f9(0x1563));if(_0x2e4e07){const _0x3e9c86=_0x4c8b14[_0x4912f9(0xbea)][_0x4c8b14['activeChatId']],_0x221532=_0x2e4e07[_0x4912f9(0x117a)](_0x4912f9(0x867));if(_0x3e9c86&&_0x221532){const _0x447986=parseInt(_0x221532['dataset']['timestamp']),_0x5ba612=_0x3e9c86[_0x4912f9(0x92c)][_0x4912f9(0x821)](_0x2fb4e5=>_0x2fb4e5[_0x4912f9(0x287)]===_0x447986);if(_0x5ba612&&_0x5ba612['recalledData']){let _0x4c36ff='';const _0x394a67=_0x5ba612[_0x4912f9(0x492)];switch(_0x394a67['originalType']){case _0x4912f9(0x117f):_0x4c36ff=_0x4912f9(0x505)+_0x394a67[_0x4912f9(0xf37)]+'\x22';break;case _0x4912f9(0xdf3):case _0x4912f9(0xea7):case _0x4912f9(0x14b0):_0x4c36ff='[图片/文字图]\x20描述:\x20\x22'+_0x394a67[_0x4912f9(0xf37)]+'\x22';break;case _0x4912f9(0x295):_0x4c36ff=_0x4912f9(0x1492)+_0x394a67[_0x4912f9(0xf37)]+'\x22';break;case'sticker':_0x4c36ff=_0x4912f9(0xd36)+(_0x394a67['originalMeaning']||'(无)')+_0x4912f9(0x1324)+_0x394a67[_0x4912f9(0xf37)];break;case'transfer':_0x4c36ff=_0x4912f9(0xd44);break;default:_0x4c36ff=_0x4912f9(0x8fe)+_0x394a67[_0x4912f9(0x1327)]+_0x4912f9(0xb7a)+JSON[_0x4912f9(0xea5)](_0x394a67['originalContent']);break;}_0x138765(_0x4912f9(0x94d),_0x4c36ff);}}}}),document['getElementById']('manage-world-book-categories-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x338c29),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xa6f))['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0x27606e=_0x4bbbc4;document[_0x27606e(0x400)](_0x27606e(0x15ed))[_0x27606e(0xb08)][_0x27606e(0xc46)](_0x27606e(0x9eb)),_0x3db57c();}),document[_0x4bbbc4(0x400)]('add-new-category-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x51e37e),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x117b))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x2c0975=>{const _0x3ef8ae=_0x4bbbc4;if(_0x2c0975['target'][_0x3ef8ae(0xb08)][_0x3ef8ae(0xd3f)](_0x3ef8ae(0xd38))){const _0xb03c69=parseInt(_0x2c0975[_0x3ef8ae(0x657)]['dataset']['id']);_0xb70632(_0xb03c69);}}),document[_0x4bbbc4(0x400)]('repost-cancel-btn')[_0x4bbbc4(0x501)]('click',_0x4097f3),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x8da))[_0x4bbbc4(0x501)]('click',_0x29951c),document[_0x4bbbc4(0x400)]('quote-message-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x28c19d),document[_0x4bbbc4(0x400)]('cancel-reply-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x288b5f),document['getElementById']('qzone-posts-list')[_0x4bbbc4(0x501)](_0x4bbbc4(0x10a8),_0x214197=>{const _0x137355=_0x4bbbc4;if(!_0x214197[_0x137355(0x657)]['matches']('.comment-input'))return;const _0x5c8377=_0x214197[_0x137355(0x657)],_0x20c845=_0x5c8377[_0x137355(0x117a)](_0x137355(0xa03));if(!_0x20c845)return;const _0x48785a=_0x20c845[_0x137355(0x13ef)](_0x137355(0x63b)),_0x1b80a0=_0x5c8377[_0x137355(0xa1e)],_0x142997=_0x1b80a0[_0x137355(0xbf7)](/@([\p{L}\w]*)$/u);if(_0x142997){const _0x1826a4=new Set(),_0x121661=_0x20c845[_0x137355(0x13ef)]('.post-nickname')?.['textContent'];if(_0x121661)_0x1826a4[_0x137355(0x12b6)](_0x121661);_0x20c845[_0x137355(0x527)]('.commenter-name')[_0x137355(0xbdc)](_0xfe94f=>{const _0x59ab5b=_0x137355;_0x1826a4['add'](_0xfe94f[_0x59ab5b(0xde7)]['replace'](':',''));}),_0x1826a4['delete'](_0x4c8b14[_0x137355(0x834)][_0x137355(0xbf3)]),_0x48785a[_0x137355(0x1575)]='';if(_0x1826a4[_0x137355(0x9e8)]>0x0){const _0x41f2fb=_0x142997[0x1];_0x1826a4[_0x137355(0xbdc)](_0x94cc8a=>{const _0x47efe1=_0x137355;if(_0x94cc8a[_0x47efe1(0x1653)]()['includes'](_0x41f2fb['toLowerCase']())){const _0x425f97=document['createElement']('div');_0x425f97[_0x47efe1(0x4e1)]=_0x47efe1(0xe1a),_0x425f97[_0x47efe1(0xde7)]=_0x94cc8a,_0x425f97[_0x47efe1(0x501)](_0x47efe1(0x8ce),_0x3bac0d=>{const _0x1c6d70=_0x47efe1;_0x3bac0d[_0x1c6d70(0x92e)]();const _0x1bed15=_0x1b80a0['substring'](0x0,_0x142997['index'])+('@'+_0x94cc8a+'\x20');_0x5c8377[_0x1c6d70(0xa1e)]=_0x1bed15,_0x48785a['style'][_0x1c6d70(0xb1a)]=_0x1c6d70(0x165b),_0x5c8377[_0x1c6d70(0x797)]();}),_0x48785a[_0x47efe1(0x8f2)](_0x425f97);}}),_0x48785a['style'][_0x137355(0xb1a)]=_0x48785a['children'][_0x137355(0x8d6)]>0x0?_0x137355(0x1181):'none';}else _0x48785a[_0x137355(0xa00)][_0x137355(0xb1a)]=_0x137355(0x165b);}else _0x48785a[_0x137355(0xa00)][_0x137355(0xb1a)]=_0x137355(0x165b);}),document['getElementById'](_0x4bbbc4(0xe69))[_0x4bbbc4(0x501)](_0x4bbbc4(0x85e),_0x3178f7=>{const _0x32c654=_0x4bbbc4;if(_0x3178f7[_0x32c654(0x657)][_0x32c654(0xb60)](_0x32c654(0x13f0))){const _0x588605=_0x3178f7['target'][_0x32c654(0x117a)](_0x32c654(0xa03));if(_0x588605){const _0x3327e7=_0x588605[_0x32c654(0x13ef)](_0x32c654(0x63b));_0x3327e7&&setTimeout(()=>{const _0x493b6e=_0x32c654;_0x3327e7[_0x493b6e(0xa00)][_0x493b6e(0xb1a)]=_0x493b6e(0x165b);},0xc8);}}});const _0x255fb7=document[_0x4bbbc4(0x400)](_0x4bbbc4(0x919)),_0x25ce68=document[_0x4bbbc4(0x400)](_0x4bbbc4(0x14fa));_0x255fb7['addEventListener'](_0x4bbbc4(0x10a8),()=>{const _0xb5834=_0x4bbbc4;if(!_0x4c8b14[_0xb5834(0x1539)]||!_0x4c8b14[_0xb5834(0xbea)][_0x4c8b14[_0xb5834(0x1539)]]['isGroup']){_0x25ce68[_0xb5834(0xa00)][_0xb5834(0xb1a)]=_0xb5834(0x165b);return;}const _0x9c3763=_0x4c8b14['chats'][_0x4c8b14[_0xb5834(0x1539)]],_0x14cb80=_0x255fb7['value'],_0x5b9300=_0x14cb80[_0xb5834(0xbf7)](/@([\p{L}\w]*)$/u);if(_0x5b9300){const _0x182ba0=_0x9c3763[_0xb5834(0xa37)][_0xb5834(0x14a8)]||'我',_0x4aac4d=_0x9c3763['members']['map'](_0x2629c6=>_0x2629c6[_0xb5834(0x7ca)])['filter'](_0x1e67b6=>_0x1e67b6!==_0x182ba0);_0x25ce68[_0xb5834(0x1575)]='';if(_0x4aac4d[_0xb5834(0x8d6)]>0x0){const _0x580554=_0x5b9300[0x1];_0x4aac4d[_0xb5834(0xbdc)](_0x27d140=>{const _0x1b2db0=_0xb5834;if(_0x27d140[_0x1b2db0(0x1653)]()[_0x1b2db0(0xd1b)](_0x580554[_0x1b2db0(0x1653)]())){const _0x3eb068=document[_0x1b2db0(0x2c9)](_0x1b2db0(0xf8e));_0x3eb068['className']='at-mention-item',_0x3eb068[_0x1b2db0(0xde7)]=_0x27d140,_0x3eb068[_0x1b2db0(0x501)]('mousedown',_0x594ce3=>{const _0x53371b=_0x1b2db0;_0x594ce3[_0x53371b(0x92e)]();const _0x59893d=_0x14cb80[_0x53371b(0x371)](0x0,_0x5b9300[_0x53371b(0x103b)])+('@'+_0x27d140+'\x20');_0x255fb7[_0x53371b(0xa1e)]=_0x59893d,_0x25ce68[_0x53371b(0xa00)]['display']=_0x53371b(0x165b),_0x255fb7['focus']();}),_0x25ce68['appendChild'](_0x3eb068);}}),_0x25ce68['style']['display']=_0x25ce68[_0xb5834(0xc9d)]['length']>0x0?_0xb5834(0x1181):'none';}else _0x25ce68[_0xb5834(0xa00)][_0xb5834(0xb1a)]=_0xb5834(0x165b);}else _0x25ce68['style'][_0xb5834(0xb1a)]=_0xb5834(0x165b);}),_0x255fb7[_0x4bbbc4(0x501)]('blur',()=>{setTimeout(()=>{const _0x3862a9=_0x466f;_0x25ce68[_0x3862a9(0xa00)]['display']=_0x3862a9(0x165b);},0xc8);}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xfc0))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x98a649),document[_0x4bbbc4(0x400)]('show-announcement-board-btn')[_0x4bbbc4(0x501)]('click',_0x17f48e),document['getElementById']('close-announcement-board-btn')[_0x4bbbc4(0x501)]('click',()=>{const _0x3757dc=_0x4bbbc4;document['getElementById'](_0x3757dc(0x334))[_0x3757dc(0xb08)][_0x3757dc(0xc46)]('visible');}),document['getElementById']('announcement-board-content')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x53211d=>{const _0xc1e717=_0x4bbbc4;if(_0x53211d[_0xc1e717(0x657)][_0xc1e717(0xb08)][_0xc1e717(0xd3f)]('announcement-item-actions')){const _0x1092cd=_0x53211d[_0xc1e717(0x657)][_0xc1e717(0xd61)][_0xc1e717(0x5cf)];_0x1092cd&&_0x436f74(_0x1092cd);}}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1433))[_0x4bbbc4(0x501)]('click',_0x448b3b),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x880))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0xb5d241),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xbdf))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x10031f=_0x4bbbc4;document[_0x10031f(0x400)](_0x10031f(0xb78))[_0x10031f(0xb08)]['remove'](_0x10031f(0x9eb));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x14c9))[_0x4bbbc4(0x501)]('click',()=>{const _0x3311cd=_0x4bbbc4;document['getElementById']('global-css-input')[_0x3311cd(0xa1e)]='';}),document[_0x4bbbc4(0x400)]('open-memory-screen-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x14774b),document['getElementById'](_0x4bbbc4(0x10e0))['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0x4c0f57=_0x4bbbc4;_0x257d51(_0x4c0f57(0x946));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x224))[_0x4bbbc4(0x501)]('click',_0x44cf94),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xd98))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x43bc03),document[_0x4bbbc4(0x400)]('memory-list-container')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x595cb7=>{const _0x418cb0=_0x4bbbc4,_0x4c0aa1=_0x595cb7[_0x418cb0(0x657)][_0x418cb0(0x117a)](_0x418cb0(0x5b6));if(_0x4c0aa1){_0x255743(_0x4c0aa1[_0x418cb0(0xd61)]['authorId'],parseInt(_0x4c0aa1[_0x418cb0(0xd61)][_0x418cb0(0x1229)]));return;}const _0x532a76=_0x595cb7[_0x418cb0(0x657)]['closest'](_0x418cb0(0xf90));if(_0x532a76){_0x2f188f(_0x532a76[_0x418cb0(0xd61)]['authorId'],parseInt(_0x532a76['dataset'][_0x418cb0(0x1229)]));return;}}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xe5f))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x7e2961),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x8d3))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x5c2b5e);const _0xc2e580=document[_0x4bbbc4(0x400)](_0x4bbbc4(0xf36));_0xc2e580[_0x4bbbc4(0x501)](_0x4bbbc4(0x1602),_0x324496),_0xc2e580[_0x4bbbc4(0x501)](_0x4bbbc4(0x709),()=>_0x41d1fc(_0x4c8b14['activeChatId'])),_0xc2e580[_0x4bbbc4(0x501)]('click',_0x100214),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x9c1))[_0x4bbbc4(0x501)]('click',()=>{const _0x3174c5=_0x4bbbc4;document[_0x3174c5(0x400)]('countdown-title-input')[_0x3174c5(0xa1e)]='',document[_0x3174c5(0x400)](_0x3174c5(0x8b9))['value']='',document[_0x3174c5(0x400)](_0x3174c5(0x744))[_0x3174c5(0xb08)][_0x3174c5(0x12b6)]('visible');}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xd1f))['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0x49da8a=_0x4bbbc4;document[_0x49da8a(0x400)](_0x49da8a(0x744))[_0x49da8a(0xb08)]['remove'](_0x49da8a(0x9eb));}),document['getElementById'](_0x4bbbc4(0x336))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x28017e),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x114f))['addEventListener']('click',_0x94ca8c),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x798))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x18266c),document[_0x4bbbc4(0x400)]('edit-last-response-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x143f54),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1084))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x594f29=_0x4bbbc4;document[_0x594f29(0x400)]('ai-response-editor-modal')['classList'][_0x594f29(0xc46)]('visible');}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xaf1))[_0x4bbbc4(0x501)]('click',_0x474f0c),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1523))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x44e7c0=_0x4bbbc4,_0x262ac8=document[_0x44e7c0(0x400)](_0x44e7c0(0xe88)),_0x205196=_0x27b58d('{\x0a\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x22content\x22:\x20\x22在这里输入新消息...\x22\x0a}');_0x262ac8[_0x44e7c0(0x8f2)](_0x205196),_0x205196[_0x44e7c0(0x13ef)](_0x44e7c0(0x79e))[_0x44e7c0(0x797)]();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x11a2))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x259f3f),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x2ed))[_0x4bbbc4(0x501)]('click',_0x45577b),document['getElementById']('add-my-avatar-url-btn')['addEventListener'](_0x4bbbc4(0x15ad),_0x42eec9),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xeb4))['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0x5f0e29=_0x4bbbc4;document[_0x5f0e29(0x400)](_0x5f0e29(0x92a))['click']();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x92a))[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),_0x384698),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x793))['addEventListener'](_0x4bbbc4(0x15ad),async()=>{const _0x41a770=_0x4bbbc4,_0x3b15d5=_0x41a770(0xa8d),_0xea31ef=await _0x25f61f(_0x41a770(0x3b2),_0x3b15d5,'','textarea');_0xea31ef&&_0xea31ef[_0x41a770(0xb8f)]()&&await _0x2e903b(_0xea31ef);}),document['getElementById'](_0x4bbbc4(0x6fa))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x3b6e0a),document[_0x4bbbc4(0x400)]('shopping-back-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>_0x257d51(_0x4bbbc4(0x946))),document[_0x4bbbc4(0x400)]('go-to-cart-btn')['addEventListener'](_0x4bbbc4(0x15ad),_0x3bc21d),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x280))['addEventListener'](_0x4bbbc4(0x15ad),_0x3b6e0a),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1449))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x56c483),document['getElementById'](_0x4bbbc4(0xdd8))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x168ac3=_0x4bbbc4;document[_0x168ac3(0x400)](_0x168ac3(0x51c))[_0x168ac3(0xb08)][_0x168ac3(0xc46)](_0x168ac3(0x9eb));}),document[_0x4bbbc4(0x400)]('manage-products-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x5d8095=_0x4bbbc4;_0xa8ab59=!_0xa8ab59;const _0x58f7ce=document['getElementById'](_0x5d8095(0x90d)),_0x535e1c=document[_0x5d8095(0x400)](_0x5d8095(0x889)),_0x4007a9=document[_0x5d8095(0x400)](_0x5d8095(0x68d));_0x58f7ce['style'][_0x5d8095(0x168d)]=_0xa8ab59?_0x5d8095(0x13d2):_0x5d8095(0x13e6),_0xa8ab59?(_0x535e1c[_0x5d8095(0xa00)][_0x5d8095(0xb1a)]='flex',_0x4007a9['style']['paddingBottom']=_0x5d8095(0x12d2)):(_0x535e1c[_0x5d8095(0xa00)]['display']='none',_0x4007a9[_0x5d8095(0xa00)][_0x5d8095(0x96c)]='',_0x490480[_0x5d8095(0x82f)](),document['querySelectorAll'](_0x5d8095(0x63f))[_0x5d8095(0xbdc)](_0x6b5516=>_0x6b5516[_0x5d8095(0xb08)][_0x5d8095(0xc46)](_0x5d8095(0x148b))),document[_0x5d8095(0x400)]('delete-selected-products-btn')[_0x5d8095(0xde7)]=_0x5d8095(0x754),document[_0x5d8095(0x400)](_0x5d8095(0x843))['checked']=![]),_0x4cf8d9(),_0x2f0dba();}),document['getElementById']('add-new-product-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x1aaac6=_0x4bbbc4;_0xa8ab59?_0x21e974(null):alert(_0x1aaac6(0x13ba));}),document[_0x4bbbc4(0x400)]('product-grid')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async _0x21f9dc=>{const _0x1c121a=_0x4bbbc4,_0x59d3c3=_0x21f9dc[_0x1c121a(0x657)][_0x1c121a(0x117a)](_0x1c121a(0x680));if(!_0x59d3c3)return;const _0x1ba8ea=parseInt(_0x59d3c3['dataset']['id']);if(isNaN(_0x1ba8ea))return;if(_0xa8ab59){if(_0x21f9dc['target'][_0x1c121a(0xb08)][_0x1c121a(0xd3f)](_0x1c121a(0x4f3))){_0x21e974(_0x1ba8ea);return;}if(_0x21f9dc[_0x1c121a(0x657)]['classList'][_0x1c121a(0xd3f)](_0x1c121a(0xd82))){const _0x4aa410=await _0x54c587[_0x1c121a(0x28c)][_0x1c121a(0xf48)](_0x1ba8ea);if(!_0x4aa410)return;const _0x2e154b=await _0x56d4d3(_0x1c121a(0x447),'确定要永久删除商品\x20“'+_0x4aa410['name']+_0x1c121a(0xb38),{'confirmButtonClass':_0x1c121a(0x142c)});_0x2e154b&&(await _0x54c587[_0x1c121a(0x28c)]['delete'](_0x1ba8ea),await _0x4cf8d9(),alert('商品已删除。'));return;}_0x59d3c3['classList'][_0x1c121a(0x146f)]('selected');_0x490480['has'](_0x1ba8ea)?_0x490480[_0x1c121a(0x942)](_0x1ba8ea):_0x490480['add'](_0x1ba8ea);document[_0x1c121a(0x400)](_0x1c121a(0xc8f))['textContent']=_0x1c121a(0xe4f)+_0x490480[_0x1c121a(0x9e8)]+')';return;}if(_0x21f9dc['target'][_0x1c121a(0xb08)]['contains'](_0x1c121a(0x3fd))){const _0x5d010f=await _0x54c587[_0x1c121a(0x28c)]['get'](_0x1ba8ea);_0x5d010f[_0x1c121a(0x1566)]&&_0x5d010f['variations'][_0x1c121a(0x8d6)]>0x0?_0x6c8604(_0x1ba8ea):(await _0x1e8c95(_0x1ba8ea),await _0x138765('成功',_0x1c121a(0x1303)));return;}_0x59d3c3[_0x1c121a(0xd3f)](_0x21f9dc[_0x1c121a(0x657)])&&console[_0x1c121a(0x1e6)]('点击了商品卡片:\x20'+_0x1ba8ea);}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x6e0))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0xd93f10=>{const _0x253a19=_0x4bbbc4,_0x424d99=_0xd93f10[_0x253a19(0x657)];_0x424d99[_0x253a19(0xb08)][_0x253a19(0xd3f)](_0x253a19(0x532))&&_0x519d9e(parseInt(_0x424d99['dataset']['id']),-0x1),_0x424d99[_0x253a19(0xb08)][_0x253a19(0xd3f)](_0x253a19(0x76c))&&_0x519d9e(parseInt(_0x424d99[_0x253a19(0xd61)]['id']),0x1),_0x424d99[_0x253a19(0xb08)][_0x253a19(0xd3f)]('cart-item-checkbox')&&_0x295d28();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x718))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x3f0e52=_0x4bbbc4;if(_0x5ad299[_0x3f0e52(0x8d6)]===0x0)return;const _0x2bc558=await _0x56d4d3(_0x3f0e52(0x600),_0x3f0e52(0x137a));_0x2bc558&&(_0x5ad299=[],_0x56be2e(),_0x112a39());}),document[_0x4bbbc4(0x400)]('select-all-cart-items')[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),function(_0x5c1d2e){const _0x36a819=_0x4bbbc4;document['querySelectorAll'](_0x36a819(0xdc7))['forEach'](_0x396a45=>{const _0x46aac4=_0x36a819;_0x396a45[_0x46aac4(0x6f9)]=_0x5c1d2e[_0x46aac4(0x657)][_0x46aac4(0x6f9)];}),_0x295d28();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x5f7))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x1a45a6=_0x4bbbc4;document[_0x1a45a6(0x400)]('product-editor-modal')[_0x1a45a6(0xb08)][_0x1a45a6(0xc46)](_0x1a45a6(0x9eb));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x419))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x881182),document[_0x4bbbc4(0x400)]('product-image-input')[_0x4bbbc4(0x501)]('change',_0x40ee17=>{const _0x226d0c=_0x4bbbc4,_0x44e2cf=_0x40ee17[_0x226d0c(0x657)][_0x226d0c(0x780)][0x0];if(_0x44e2cf){const _0x395e5f=new FileReader();_0x395e5f[_0x226d0c(0x9e0)]=_0x45ea20=>{const _0x4607c0=_0x226d0c;document[_0x4607c0(0x400)](_0x4607c0(0xcd8))[_0x4607c0(0x912)]=_0x45ea20[_0x4607c0(0x657)][_0x4607c0(0xdd1)];},_0x395e5f['readAsDataURL'](_0x44e2cf);}}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x75b))[_0x4bbbc4(0x501)]('click',_0x29370a=>{const _0x46f1ec=_0x4bbbc4,_0x18d9d7=_0x29370a[_0x46f1ec(0x657)][_0x46f1ec(0x117a)](_0x46f1ec(0x14ae));if(_0x18d9d7){const _0x16d473=_0x18d9d7[_0x46f1ec(0x117a)](_0x46f1ec(0x15d1));_0x16d473&&_0x2baa87(parseInt(_0x16d473[_0x46f1ec(0xd61)]['timestamp']));}}),document[_0x4bbbc4(0x400)]('cancel-gift-recipient-btn')[_0x4bbbc4(0x501)]('click',()=>{const _0x16e973=_0x4bbbc4;document['getElementById'](_0x16e973(0xd7f))[_0x16e973(0xb08)][_0x16e973(0xc46)](_0x16e973(0x9eb));}),document[_0x4bbbc4(0x400)]('confirm-gift-recipient-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x374f24=_0x4bbbc4,_0x56fcb2=Array[_0x374f24(0xdc0)](document['querySelectorAll']('#gift-recipient-list\x20.contact-picker-item.selected'))[_0x374f24(0xd18)](_0x482e18=>_0x482e18['dataset'][_0x374f24(0xa02)]);if(_0x56fcb2[_0x374f24(0x8d6)]===0x0){alert('请至少选择一位收礼人。');return;}const _0x344e17=_0x5ad299[_0x374f24(0x29d)](_0x1f57ff=>document[_0x374f24(0x13ef)](_0x374f24(0xc39)+_0x1f57ff['productId']+_0x374f24(0x106e)));await _0x44caa4(_0x344e17,_0x56fcb2),document[_0x374f24(0x400)](_0x374f24(0xd7f))['classList']['remove'](_0x374f24(0x9eb));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x4b7))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x2bdcd2=>{const _0x1ee685=_0x4bbbc4,_0xf3b347=_0x2bdcd2[_0x1ee685(0x657)]['closest'](_0x1ee685(0xff2));_0xf3b347&&_0xf3b347[_0x1ee685(0xb08)][_0x1ee685(0x146f)](_0x1ee685(0x148b));}),document[_0x4bbbc4(0x400)]('select-all-recipients')[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),function(_0x5a52d9){const _0x5c0e47=_0x4bbbc4,_0x1d6d86=_0x5a52d9[_0x5c0e47(0x657)][_0x5c0e47(0x6f9)];document[_0x5c0e47(0x527)]('#gift-recipient-list\x20.contact-picker-item')[_0x5c0e47(0xbdc)](_0x3ece36=>{const _0x420602=_0x5c0e47;_0x3ece36[_0x420602(0xb08)]['toggle']('selected',_0x1d6d86);});}),document['getElementById']('regenerate-btn')['addEventListener']('click',_0x239716),document['getElementById']('regenerate-call-btn')['addEventListener'](_0x4bbbc4(0x15ad),_0x33aae6),document[_0x4bbbc4(0x400)]('propel-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x244b05),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x7bc))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x319f0e=_0x4bbbc4,_0x9f751b=document[_0x319f0e(0x400)](_0x319f0e(0x37d)),_0x156358=document[_0x319f0e(0x400)](_0x319f0e(0x14c3))[_0x319f0e(0xa1e)][_0x319f0e(0xb8f)]()||_0xfb99b3;_0x9f751b['src']=_0x156358,_0x9f751b['play']()[_0x319f0e(0x37a)](_0x1e9e4a=>alert('播放失败，请检查URL是否正确或浏览器是否支持该格式。'));}),document['getElementById'](_0x4bbbc4(0xf82))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x78a52e=_0x4bbbc4;document['getElementById']('notification-sound-url-input')[_0x78a52e(0xa1e)]='',alert('已重置为默认提示音，点击“保存所有外观设置”后生效。');}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x13b1))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x1fcbcb=>{const _0x18609b=_0x4bbbc4,_0x322f90=_0x1fcbcb[_0x18609b(0x657)];_0x322f90[_0x18609b(0xb08)][_0x18609b(0xd3f)](_0x18609b(0x15d8))&&_0x224200(_0x322f90),_0x322f90[_0x18609b(0xb08)][_0x18609b(0xd3f)](_0x18609b(0x6e8))&&_0x1a1c4e(_0x322f90);}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x4a9))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x2e729a),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xce4))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x48534c=_0x4bbbc4;document[_0x48534c(0x400)](_0x48534c(0x1068))[_0x48534c(0xb08)][_0x48534c(0xc46)](_0x48534c(0x9eb));}),document['getElementById'](_0x4bbbc4(0x4a9))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x2e729a),document[_0x4bbbc4(0x400)]('cancel-music-search-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x1d8067=_0x4bbbc4;document[_0x1d8067(0x400)](_0x1d8067(0x1068))[_0x1d8067(0xb08)][_0x1d8067(0xc46)](_0x1d8067(0x9eb));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xe49))[_0x4bbbc4(0x501)]('change',function(_0x227fa8){document['querySelectorAll']('#search-results-list\x20.music-search-checkbox')['forEach'](_0x5ded92=>{const _0x41f284=_0x466f;_0x5ded92[_0x41f284(0x6f9)]=_0x227fa8['target'][_0x41f284(0x6f9)];});}),document['getElementById'](_0x4bbbc4(0x1002))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x2967dc=>{const _0x5e78b1=_0x4bbbc4,_0x4c8fa6=_0x2967dc[_0x5e78b1(0x657)][_0x5e78b1(0x117a)](_0x5e78b1(0x11d5));if(_0x4c8fa6){const _0x378e3c=_0x4c8fa6[_0x5e78b1(0x13ef)](_0x5e78b1(0x387));_0x378e3c&&(_0x2967dc['target']!==_0x378e3c&&(_0x378e3c[_0x5e78b1(0x6f9)]=!_0x378e3c[_0x5e78b1(0x6f9)]));}}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xfc8))['addEventListener'](_0x4bbbc4(0x15ad),async()=>{const _0x47da1a=_0x4bbbc4,_0x79ca8c=document['querySelectorAll'](_0x47da1a(0x93c));if(_0x79ca8c[_0x47da1a(0x8d6)]===0x0){alert('请先选择要添加的歌曲。');return;}document[_0x47da1a(0x400)](_0x47da1a(0x1068))[_0x47da1a(0xb08)][_0x47da1a(0xc46)](_0x47da1a(0x9eb)),await _0x138765(_0x47da1a(0x13e9),'正在批量添加\x20'+_0x79ca8c[_0x47da1a(0x8d6)]+_0x47da1a(0xf03));const _0xd89c7f=Array[_0x47da1a(0xdc0)](_0x79ca8c)[_0x47da1a(0xd18)](_0xb3c507=>JSON[_0x47da1a(0x13f7)](_0xb3c507['closest'](_0x47da1a(0x11d5))[_0x47da1a(0xd61)][_0x47da1a(0x232)]));let _0x3276f2=0x0,_0x200984=[];const _0x522ebf=_0xd89c7f['map'](_0x227e39=>_0x31dc92(_0x227e39)),_0x20397c=await Promise[_0x47da1a(0x875)](_0x522ebf);_0x20397c['forEach']((_0x1d48e5,_0x1d3539)=>{const _0x59d6cb=_0x47da1a;_0x1d48e5?(_0x59adb2['playlist'][_0x59d6cb(0x6bb)](_0x1d48e5),_0x3276f2++):_0x200984[_0x59d6cb(0x6bb)](_0xd89c7f[_0x1d3539][_0x59d6cb(0xf3e)]);});_0x3276f2>0x0&&(await _0x2d1049(),_0x4514b2(),_0x59adb2[_0x47da1a(0xbf0)]===-0x1&&(_0x59adb2[_0x47da1a(0xbf0)]=_0x59adb2['playlist'][_0x47da1a(0x8d6)]-_0x3276f2,_0x12737e()));let _0x51c1a1=_0x47da1a(0x852)+_0x3276f2+'\x20首歌曲。';_0x200984[_0x47da1a(0x8d6)]>0x0&&(_0x51c1a1+='\x0a\x0a'+_0x200984[_0x47da1a(0x8d6)]+_0x47da1a(0x684)+_0x200984[_0x47da1a(0xee1)](_0x47da1a(0x105b))),await _0x138765(_0x47da1a(0x15c2),_0x51c1a1);}),document['getElementById'](_0x4bbbc4(0x4bc))['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0x3492db=_0x4bbbc4;document[_0x3492db(0x400)](_0x3492db(0x4bc))[_0x3492db(0xb08)][_0x3492db(0x146f)]('lyrics-active');}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x4a9))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x2e729a),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xce4))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x25ba01=_0x4bbbc4;document['getElementById']('music-search-results-modal')[_0x25ba01(0xb08)][_0x25ba01(0xc46)](_0x25ba01(0x9eb));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1002))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x2644aa=>{const _0x38fad1=_0x4bbbc4,_0x2f3205=_0x2644aa[_0x38fad1(0x657)]['closest'](_0x38fad1(0x11d5));if(_0x2f3205&&_0x2f3205[_0x38fad1(0xd61)]['songJson']){const _0x41a129=JSON[_0x38fad1(0x13f7)](_0x2f3205['dataset'][_0x38fad1(0x232)]);handleSearchResultClick(_0x41a129);}}),document[_0x4bbbc4(0x400)]('cleanup-songs-btn')['addEventListener'](_0x4bbbc4(0x15ad),_0x1b35e4),document[_0x4bbbc4(0x400)]('toggle-blur-btn')['addEventListener'](_0x4bbbc4(0x15ad),_0x2736af),document[_0x4bbbc4(0x400)]('toggle-fullscreen-btn')['addEventListener']('click',_0x5ecd31),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1156))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x4b0c14),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x11f3))['addEventListener']('change',()=>{const _0x4f3a1b=_0x4bbbc4;_0x4c8b14[_0x4f3a1b(0x14f1)]['showStatusBar']=document[_0x4f3a1b(0x400)](_0x4f3a1b(0x11f3))[_0x4f3a1b(0x6f9)],_0x3e4f38();}),document[_0x4bbbc4(0x400)]('qzone-more-actions-btn')['addEventListener'](_0x4bbbc4(0x15ad),_0xb7d893),document['getElementById'](_0x4bbbc4(0x13bf))[_0x4bbbc4(0x501)]('click',()=>{const _0x2adfaf=_0x4bbbc4;document[_0x2adfaf(0x400)](_0x2adfaf(0x54e))['classList'][_0x2adfaf(0xc46)](_0x2adfaf(0x9eb));}),document['getElementById'](_0x4bbbc4(0xe12))[_0x4bbbc4(0x501)]('click',_0xf5f601),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x559))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x4ab0ae=>{const _0x1a433a=_0x4bbbc4,_0x1ae949=_0x4ab0ae[_0x1a433a(0x657)][_0x1a433a(0x117a)](_0x1a433a(0x8cf));_0x1ae949&&_0x1ae949['classList'][_0x1a433a(0x146f)](_0x1a433a(0x148b));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x12fa))['addEventListener'](_0x4bbbc4(0x866),async _0x2d977a=>{const _0x1cde13=_0x4bbbc4,_0x2d2ac6=_0x2d977a['target'][_0x1cde13(0x780)][0x0];if(_0x2d2ac6){const _0x39abb4=await new Promise(_0x243e1e=>{const _0x603714=_0x1cde13,_0x40de74=new FileReader();_0x40de74['onload']=()=>_0x243e1e(_0x40de74[_0x603714(0xdd1)]),_0x40de74[_0x603714(0x157f)](_0x2d2ac6);});_0x4c8b14[_0x1cde13(0x14f1)][_0x1cde13(0xf8c)]=_0x39abb4,_0x364d9f();}_0x2d977a[_0x1cde13(0x657)]['value']=null;}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x6f0))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0xfaf707=_0x4bbbc4;_0x4c8b14[_0xfaf707(0x14f1)]['globalChatBackground']='',_0x364d9f();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xd0d))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x3ef960=_0x4bbbc4;_0x52cc8f&&(_0x4c8b14[_0x3ef960(0x14f1)][_0x3ef960(0xed6)]=_0x52cc8f),_0x4c8b14[_0x3ef960(0x14f1)][_0x3ef960(0x5e9)]=document[_0x3ef960(0x400)](_0x3ef960(0xf42))[_0x3ef960(0xa1e)][_0x3ef960(0xb8f)](),_0x4c8b14[_0x3ef960(0x14f1)]['notificationSoundUrl']=document[_0x3ef960(0x400)]('notification-sound-url-input')[_0x3ef960(0xa1e)][_0x3ef960(0xb8f)](),_0x4c8b14[_0x3ef960(0x14f1)][_0x3ef960(0x30a)]=document[_0x3ef960(0x400)](_0x3ef960(0x11f3))[_0x3ef960(0x6f9)],await _0x54c587['globalSettings'][_0x3ef960(0x4cb)](_0x4c8b14[_0x3ef960(0x14f1)]),_0x497a54(),_0x52cc8f=null,_0x45f4d0(),_0x1d7c68(_0x4c8b14[_0x3ef960(0x14f1)][_0x3ef960(0x5e9)]),_0x3e4f38(),alert('外观设置已保存并应用！'),_0x257d51(_0x3ef960(0x13b1));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x13b4))['addEventListener'](_0x4bbbc4(0x15ad),async()=>{const _0x3f9cdc=_0x4bbbc4,_0x4a6fc2=await _0x25f61f(_0x3f9cdc(0x1643),_0x3f9cdc(0x16a2),'',_0x3f9cdc(0x299));if(_0x4a6fc2&&_0x4a6fc2[_0x3f9cdc(0xb8f)]())_0x4c8b14[_0x3f9cdc(0x14f1)][_0x3f9cdc(0xf8c)]=_0x4a6fc2[_0x3f9cdc(0xb8f)](),_0x364d9f();else _0x4a6fc2!==null&&alert(_0x3f9cdc(0xf08));}),document['getElementById'](_0x4bbbc4(0x79d))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x32ab6b=_0x4bbbc4,_0x49a9b9=await _0x25f61f(_0x32ab6b(0x842),_0x32ab6b(0x39e),'',_0x32ab6b(0x299));if(_0x49a9b9&&_0x49a9b9['trim']())_0x52cc8f=_0x49a9b9['trim'](),_0x364d9f();else _0x49a9b9!==null&&alert(_0x32ab6b(0xf08));}),document[_0x4bbbc4(0x400)]('upload-cphone-bg-url-btn')['addEventListener']('click',async()=>{const _0x5e8a29=_0x4bbbc4,_0x13e541=await _0x25f61f('网络图片\x20(CPhone)',_0x5e8a29(0x246),'',_0x5e8a29(0x299));if(_0x13e541&&_0x13e541[_0x5e8a29(0xb8f)]())_0x4c8b14[_0x5e8a29(0x14f1)][_0x5e8a29(0x67c)]=_0x13e541[_0x5e8a29(0xb8f)](),_0x364d9f();else _0x13e541!==null&&alert('请输入有效的URL。');}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x584))['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0x24bb81=_0x4bbbc4;_0x52cc8f=null,_0x4c8b14[_0x24bb81(0x14f1)][_0x24bb81(0xed6)]='',_0x364d9f();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x10d8))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x55fb6e=_0x4bbbc4;_0x4c8b14[_0x55fb6e(0x14f1)][_0x55fb6e(0x67c)]='',_0x364d9f();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x12f8))['addEventListener'](_0x4bbbc4(0x866),_0x2db078),document[_0x4bbbc4(0x400)]('save-css-preset-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x4ad0db),document['getElementById']('delete-css-preset-btn')[_0x4bbbc4(0x501)]('click',_0x551ce3),document[_0x4bbbc4(0x400)]('font-preset-select')['addEventListener'](_0x4bbbc4(0x866),_0x3cd88e),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1616))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x3c6afa),document['getElementById'](_0x4bbbc4(0xc48))['addEventListener'](_0x4bbbc4(0x15ad),_0x59bc34),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xc69))[_0x4bbbc4(0x501)]('change',_0x146e74),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xcf9))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x3b67d3),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xb98))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x3e8be8),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x5db))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x876743),document['getElementById'](_0x4bbbc4(0x13df))['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0x1538ae=_0x4bbbc4;document[_0x1538ae(0x400)](_0x1538ae(0xbb4))['classList'][_0x1538ae(0xc46)](_0x1538ae(0x9eb)),_0x11d8fe();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xe22))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x7df942),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x117c))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x302d40=>{const _0x18a645=_0x4bbbc4;if(_0x302d40[_0x18a645(0x657)]['classList'][_0x18a645(0xd3f)]('delete-group-btn')){const _0x490f42=parseInt(_0x302d40['target'][_0x18a645(0xd61)]['id']);_0x3b7f4f(_0x490f42);}}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xb9a))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x263b5b=>{const _0x222271=_0x4bbbc4;if(_0x263b5b['target'][_0x222271(0xb08)][_0x222271(0xd3f)](_0x222271(0x894))){const _0x44ed8a=_0x263b5b['target'][_0x222271(0xd61)][_0x222271(0x12c4)],_0x48e2ba=_0x44ed8a!=='all'&&_0x44ed8a!=='uncategorized'?parseInt(_0x44ed8a):_0x44ed8a;_0x1630a4(_0x48e2ba);}}),document['getElementById'](_0x4bbbc4(0x10fc))[_0x4bbbc4(0x501)]('change',_0x3c4e46),document['getElementById'](_0x4bbbc4(0x9d7))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x49db39),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xd4f))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x50f7aa=_0x4bbbc4;document[_0x50f7aa(0x400)](_0x50f7aa(0x228))['click']();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x228))['addEventListener'](_0x4bbbc4(0x866),_0x270cdb=>{const _0x139245=_0x4bbbc4,_0x4c6ade=_0x270cdb['target'][_0x139245(0x780)][0x0];_0x4c6ade&&_0x50438d(_0x4c6ade),_0x270cdb['target'][_0x139245(0xa1e)]=null;}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xbe4))['addEventListener'](_0x4bbbc4(0x15ad),()=>_0x50cecc()),document['getElementById'](_0x4bbbc4(0x12e4))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>openDiaryEditor()),document['getElementById'](_0x4bbbc4(0x74f))['addEventListener'](_0x4bbbc4(0x15ad),_0x3af5b7),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1019))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x38b0cb),document['getElementById']('favorite-memo-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x18474b),document['getElementById'](_0x4bbbc4(0xcea))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x39c930=_0x4bbbc4,_0xfb360f=document[_0x39c930(0x400)](_0x39c930(0x8e1))[_0x39c930(0x1624)];_0x495e8e(_0xfb360f,_0x39c930(0x57e));}),document[_0x4bbbc4(0x400)]('copy-memo-content-btn')[_0x4bbbc4(0x501)]('click',()=>{const _0x5ca403=_0x4bbbc4,_0x14d6be=document['getElementById'](_0x5ca403(0x1129))[_0x5ca403(0xa1e)];_0x495e8e(_0x14d6be,_0x5ca403(0xe57));}),document[_0x4bbbc4(0x400)]('copy-article-content-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x2cf7bd=_0x4bbbc4,_0x3c4801=document[_0x2cf7bd(0x400)](_0x2cf7bd(0xe18))[_0x2cf7bd(0x1624)];_0x495e8e(_0x3c4801,_0x2cf7bd(0x14d4));}),document[_0x4bbbc4(0x400)]('regenerate-char-qq-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x19dbae=_0x4bbbc4;_0x138765(_0x19dbae(0x49e),'正在生成新的模拟聊天记录，并同时让角色思考如何与你继续对话...');try{await Promise[_0x19dbae(0x875)]([_0x1a67c9(),_0x952304()]),console[_0x19dbae(0x1e6)](_0x19dbae(0x7e7));}catch(_0x3c1037){console[_0x19dbae(0x5d7)](_0x19dbae(0x5c9),_0x3c1037),await _0x138765(_0x19dbae(0x12cb),_0x19dbae(0xe4a)+_0x3c1037['message']);}}),document['getElementById'](_0x4bbbc4(0x15c5))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x266a2c=>{const _0x171dc1=_0x4bbbc4,_0x810fc5=_0x266a2c[_0x171dc1(0x657)][_0x171dc1(0x117a)](_0x171dc1(0x3ff));if(_0x810fc5&&_0x810fc5['dataset']['conversationIndex']){const _0x1ad189=parseInt(_0x810fc5['dataset'][_0x171dc1(0xfa4)]);!isNaN(_0x1ad189)&&_0x3e1a87(_0x1ad189);}}),document[_0x4bbbc4(0x400)]('back-to-char-qq-list-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{_0x2b7df1('char-qq-screen');});const _0x19d3f5=document['getElementById'](_0x4bbbc4(0xcac)),_0x10b8b6=()=>{const _0x396de9=_0x4bbbc4;if(_0xf60dfe!==_0x396de9(0x9b2))return;if(_0x19d3f5['scrollTop']<0x1&&!_0x3460b6){const _0x28f1cc=_0x4c8b14[_0x396de9(0xbea)][_0x7e1e9]?.['history'][_0x396de9(0x8d6)]||0x0;_0x28f1cc>_0x41cb4b&&_0x2e79aa();}};_0x19d3f5[_0x4bbbc4(0x501)]('scroll',_0x10b8b6),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x14e8))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x2d7cb8=_0x4bbbc4;alert(_0x2d7cb8(0x6d8));}),document['getElementById'](_0x4bbbc4(0x6d3))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x1bf20c),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1692))[_0x4bbbc4(0x501)]('click',_0x7b1e26=>{const _0x23005d=_0x4bbbc4,_0x53df26=_0x7b1e26['target']['closest'](_0x23005d(0x10a5));if(_0x53df26&&_0x53df26[_0x23005d(0xd61)]['description']){const _0x337e7a=_0x53df26[_0x23005d(0xd61)][_0x23005d(0x12a5)];_0x138765('照片详情',_0x337e7a[_0x23005d(0xe19)](/\n/g,_0x23005d(0x9e1)));}}),document[_0x4bbbc4(0x400)]('regenerate-char-browser-btn')[_0x4bbbc4(0x501)]('click',_0x82f004),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xeb1))[_0x4bbbc4(0x501)]('click',_0xfe4306),document[_0x4bbbc4(0x400)]('char-product-grid')['addEventListener'](_0x4bbbc4(0x15ad),_0x5b7c5d=>{const _0x2a2d74=_0x4bbbc4,_0x3516ab=_0x5b7c5d[_0x2a2d74(0x657)][_0x2a2d74(0x117a)](_0x2a2d74(0xa4f));if(_0x3516ab&&_0x3516ab[_0x2a2d74(0xd61)]['reason']){const _0x336453=_0x3516ab[_0x2a2d74(0xd61)][_0x2a2d74(0x383)];_0x138765('TA的想法...',_0x336453[_0x2a2d74(0xe19)](/\n/g,'<br>'));}}),window[_0x4bbbc4(0x1679)]=_0x59caab,document['getElementById']('regenerate-char-memo-btn')['addEventListener'](_0x4bbbc4(0x15ad),_0x3ebbb2),document['getElementById'](_0x4bbbc4(0xa63))[_0x4bbbc4(0x501)]('click',()=>_0x2b7df1('char-memo-screen')),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1466))[_0x4bbbc4(0x501)]('click',_0x3b0e81),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x12e4))['addEventListener'](_0x4bbbc4(0x15ad),_0x29e27a),document[_0x4bbbc4(0x400)]('char-diary-detail-back-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>_0x2b7df1('char-diary-screen')),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x2d5))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x473c35),document['getElementById'](_0x4bbbc4(0xfa1))['addEventListener'](_0x4bbbc4(0x15ad),_0x320e45),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1577))['addEventListener'](_0x4bbbc4(0x15ad),_0x3bb46c),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x9ac))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x5ae1ad),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1527))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x5c2c7a),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1527))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x5c2c7a),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xa5f))['addEventListener']('click',()=>_0x257d51(_0x4bbbc4(0x12d1))),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xd08))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x30a021),document[_0x4bbbc4(0x400)]('douban-wait-reply-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x146769),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xee2))[_0x4bbbc4(0x501)]('change',async _0x42ab35=>{const _0x52916b=_0x4bbbc4,_0x46d7a8=_0x42ab35[_0x52916b(0x657)]['files'][0x0];if(_0x46d7a8){const _0x541286=await new Promise(_0x55890a=>{const _0x1f604a=_0x52916b,_0x81c0f4=new FileReader();_0x81c0f4[_0x1f604a(0x9e0)]=()=>_0x55890a(_0x81c0f4['result']),_0x81c0f4[_0x1f604a(0x157f)](_0x46d7a8);});_0x4c8b14[_0x52916b(0x14f1)][_0x52916b(0x67c)]=_0x541286,_0x364d9f();}}),document['getElementById']('cphone-icon-settings-grid')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x39e446=>{const _0x3b8706=_0x4bbbc4;if(_0x39e446[_0x3b8706(0x657)]['classList'][_0x3b8706(0xd3f)](_0x3b8706(0x91e))){const _0x4a077a=_0x39e446[_0x3b8706(0x657)][_0x3b8706(0x117a)](_0x3b8706(0xfeb)),_0x2df9fa=_0x4a077a['dataset']['iconId'];_0x2df9fa&&_0x4c1b29(_0x2df9fa,_0x3b8706(0x12cf),_0x4a077a);}}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xa1f))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x499812=_0x4bbbc4;document['getElementById'](_0x499812(0xda3))[_0x499812(0x15ad)]();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xda3))[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),_0x13a1fe=>{const _0x56a381=_0x4bbbc4,_0x50a58d=_0x13a1fe[_0x56a381(0x657)]['files'][0x0];_0x50a58d&&_0x33ad26(_0x50a58d),_0x13a1fe[_0x56a381(0x657)][_0x56a381(0xa1e)]=null;}),document[_0x4bbbc4(0x501)](_0x4bbbc4(0x115f),()=>{const _0x474969=_0x4bbbc4;document['visibilityState']===_0x474969(0x8c3)&&(localStorage['setItem'](_0x474969(0x130c),Date[_0x474969(0xecd)]()),console[_0x474969(0x1e6)](_0x474969(0xb28)));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xf67))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x3670ce),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xd3b))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x160e84=_0x4bbbc4;document[_0x160e84(0x400)](_0x160e84(0xe96))[_0x160e84(0x15ad)]();}),document['getElementById'](_0x4bbbc4(0xe96))[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),_0x4ea439=>{const _0x13920a=_0x4bbbc4,_0x13fbd4=_0x4ea439[_0x13920a(0x657)][_0x13920a(0x780)][0x0];_0x13fbd4&&_0x5379cf(_0x13fbd4),_0x4ea439['target'][_0x13920a(0xa1e)]=null;}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x759))[_0x4bbbc4(0x501)]('change',async _0x295f40=>{const _0x1eaafb=_0x4bbbc4,_0x50b74a=_0x295f40['target'][_0x1eaafb(0x6f9)];_0x4c8b14['globalSettings'][_0x1eaafb(0x7b5)]=_0x50b74a,await _0x54c587[_0x1eaafb(0x14f1)][_0x1eaafb(0x4cb)](_0x4c8b14[_0x1eaafb(0x14f1)]);const _0x2efb13=document[_0x1eaafb(0x13ef)]('.screen.active');if(_0x2efb13)switch(_0x2efb13['id']){case'chat-interface-screen':_0x26354c(_0x4c8b14[_0x1eaafb(0x1539)]);break;case'chat-list-screen':if(document['getElementById'](_0x1eaafb(0x951))[_0x1eaafb(0xb08)][_0x1eaafb(0xd3f)](_0x1eaafb(0x5d6)))_0x335d36();if(document['getElementById'](_0x1eaafb(0x4ab))[_0x1eaafb(0xb08)][_0x1eaafb(0xd3f)]('active'))_0x4081e7();break;case'douban-screen':_0x20dc01();break;case _0x1eaafb(0x12ef):_0x4dca31(_0x4c0bbb);break;case _0x1eaafb(0x1361):const _0x5c7fdc=document[_0x1eaafb(0x13ef)](_0x1eaafb(0x149e));if(_0x5c7fdc)switch(_0x5c7fdc['id']){case _0x1eaafb(0x6a2):_0x55124a();break;case'char-taobao-screen':_0x5e8024();break;case'char-browser-article-screen':const _0x312ba3=_0x4c8b14[_0x1eaafb(0xbea)][_0x7e1e9],_0x3f2ec2=_0x312ba3['simulatedBrowserHistory']||[],_0x58b216=_0x3f2ec2[_0x1eaafb(0x8d6)]>0x0?_0x3f2ec2[_0x1eaafb(0x8d6)]-0x1:0x0;_0x444356(_0x3f2ec2[_0x58b216]);break;case _0x1eaafb(0xcb3):_0x49dc6e();break;case _0x1eaafb(0xbec):_0x1356de();break;case _0x1eaafb(0x3f6):const _0x3f4375=document[_0x1eaafb(0x13ef)]('#char-chat-list\x20.chat-list-item')?.[_0x1eaafb(0xd61)][_0x1eaafb(0xfa4)]||0x0;_0x3e1a87(parseInt(_0x3f4375));break;}break;}_0x138765(_0x1eaafb(0x1342),_0x1eaafb(0x61d)+(_0x50b74a?'开启':'关闭')+'。');}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xb05))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0xfdfc40),document['getElementById'](_0x4bbbc4(0x6df))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{_0x257d51('chat-settings-screen');}),document[_0x4bbbc4(0x400)]('execute-search-btn')[_0x4bbbc4(0x501)]('click',_0x34256b),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xd7a))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x1b9d3e),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xacb))['addEventListener'](_0x4bbbc4(0x15ad),_0x465853),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x3fa))['addEventListener'](_0x4bbbc4(0x15ad),_0x1ef362),document['querySelector'](_0x4bbbc4(0x13f8))[_0x4bbbc4(0x501)]('click',_0x5a3359=>{const _0x297f03=_0x4bbbc4;if(_0x5a3359[_0x297f03(0x657)][_0x297f03(0xb08)][_0x297f03(0xd3f)](_0x297f03(0x1205))){const _0x4bea48=parseInt(_0x5a3359[_0x297f03(0x657)]['dataset']['id']);!isNaN(_0x4bea48)&&_0x511e3f(_0x4bea48);}}),_0xe2ab3e(),window['openPresetScreen']=_0x29eb23,document[_0x4bbbc4(0x400)](_0x4bbbc4(0x21d))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0x18e427=_0x4bbbc4,_0x4fbf22=await _0x25f61f(_0x18e427(0x7e4),'请输入预设名称');if(_0x4fbf22&&_0x4fbf22[_0x18e427(0xb8f)]()){const _0x2a859b={'id':'preset_'+Date[_0x18e427(0xecd)](),'name':_0x4fbf22['trim'](),'content':[]};await _0x54c587['presets']['add'](_0x2a859b),await _0x2e9442(),_0x49b6b5(_0x2a859b['id']);}}),document['getElementById'](_0x4bbbc4(0x83f))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0xf3e2f8),document[_0x4bbbc4(0x400)]('add-preset-entry-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x5eeeba=_0x4bbbc4,_0x345f9d=document['getElementById'](_0x5eeeba(0x690));_0x345f9d[_0x5eeeba(0x13ef)]('p')&&(_0x345f9d['innerHTML']='');const _0x5a0528=_0x48e479();_0x345f9d[_0x5eeeba(0x8f2)](_0x5a0528),_0x5a0528['querySelector'](_0x5eeeba(0xf05))['focus']();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x64d))[_0x4bbbc4(0x501)]('click',async()=>{const _0x4017e2=_0x4bbbc4;if(!_0x361039)return;const _0x4e5a00=await _0x54c587[_0x4017e2(0xf53)][_0x4017e2(0xf48)](_0x361039);if(!_0x4e5a00)return;const _0x3b8cc1=document[_0x4017e2(0x400)]('preset-name-input')['value'][_0x4017e2(0xb8f)]();if(!_0x3b8cc1){alert(_0x4017e2(0x1645));return;}_0x4e5a00[_0x4017e2(0xf3e)]=_0x3b8cc1,_0x4e5a00['categoryId']=parseInt(document[_0x4017e2(0x400)](_0x4017e2(0xba4))[_0x4017e2(0xa1e)])||null;const _0x9497c9=document[_0x4017e2(0x400)](_0x4017e2(0x690)),_0x804931=_0x9497c9['querySelectorAll'](_0x4017e2(0x1687)),_0x3318f5=[];_0x804931[_0x4017e2(0xbdc)](_0x5a0e94=>{const _0x32b14c=_0x4017e2,_0x56bc17=_0x5a0e94['querySelector']('.entry-content-textarea')[_0x32b14c(0xa1e)][_0x32b14c(0xb8f)]();_0x56bc17&&_0x3318f5[_0x32b14c(0x6bb)]({'comment':_0x5a0e94[_0x32b14c(0x13ef)](_0x32b14c(0x5b8))[_0x32b14c(0xa1e)][_0x32b14c(0xb8f)](),'keys':(_0x5a0e94[_0x32b14c(0x13ef)](_0x32b14c(0x283))[_0x32b14c(0xa1e)][_0x32b14c(0xb8f)]()||'')[_0x32b14c(0x5ad)](',')[_0x32b14c(0xd18)](_0x4e06d5=>_0x4e06d5[_0x32b14c(0xb8f)]())[_0x32b14c(0x29d)](Boolean),'content':_0x56bc17,'enabled':_0x5a0e94[_0x32b14c(0x13ef)](_0x32b14c(0xf88))[_0x32b14c(0x6f9)]});}),_0x4e5a00['content']=_0x3318f5,await _0x54c587[_0x4017e2(0xf53)][_0x4017e2(0x4cb)](_0x4e5a00),_0x361039=null,_0x257d51(_0x4017e2(0x681)),await _0x2e9442();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x14e4))[_0x4bbbc4(0x501)]('click',async()=>{const _0x4cbf63=_0x4bbbc4;try{await _0x2bf707(),document[_0x4cbf63(0x400)](_0x4cbf63(0x1006))[_0x4cbf63(0x15ad)]();}catch(_0x5b2626){console[_0x4cbf63(0x75e)](_0x4cbf63(0xaa6),_0x5b2626[_0x4cbf63(0x6e2)]);}}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1006))[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),_0x193863),document[_0x4bbbc4(0x400)]('reset-button-order-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x43ca10),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x109c))['addEventListener'](_0x4bbbc4(0x15ad),_0x1072f8),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x12c7))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x16726e=_0x4bbbc4;document[_0x16726e(0x400)]('data-clear-wizard-modal')[_0x16726e(0xb08)]['remove'](_0x16726e(0x9eb));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1617))[_0x4bbbc4(0x501)]('click',_0x2046a5),document['getElementById'](_0x4bbbc4(0xb7e))[_0x4bbbc4(0x501)]('click',_0x536a14),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xafb))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x1ae99c=_0x4bbbc4;document[_0x1ae99c(0x400)](_0x1ae99c(0xa36))[_0x1ae99c(0xb08)][_0x1ae99c(0xc46)]('visible');}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x138c))['addEventListener'](_0x4bbbc4(0x15ad),_0xf08705),document[_0x4bbbc4(0x400)]('data-clear-wizard-modal')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x4907dc=>{const _0x1d7267=_0x4bbbc4,_0x1daa9b=_0x4907dc[_0x1d7267(0x657)][_0x1d7267(0x117a)](_0x1d7267(0x8cf));_0x1daa9b&&(_0x4907dc[_0x1d7267(0x504)](),_0x1daa9b[_0x1d7267(0xb08)]['toggle'](_0x1d7267(0x148b)));}),document[_0x4bbbc4(0x400)]('data-clear-wizard-modal')[_0x4bbbc4(0x501)]('change',_0x157927=>{const _0x10c82c=_0x4bbbc4;if(_0x157927[_0x10c82c(0x657)]['id']===_0x10c82c(0x1065)){const _0x1c9102=_0x157927[_0x10c82c(0x657)][_0x10c82c(0x6f9)];document[_0x10c82c(0x527)](_0x10c82c(0x3e2))[_0x10c82c(0xbdc)](_0x55cdc0=>{_0x55cdc0['classList']['toggle']('selected',_0x1c9102);});}else{if(_0x157927[_0x10c82c(0x657)]['id']===_0x10c82c(0xc64)){const _0x1e27e9=_0x157927[_0x10c82c(0x657)][_0x10c82c(0x6f9)];document[_0x10c82c(0x527)](_0x10c82c(0x1515))[_0x10c82c(0xbdc)](_0xe9ddbd=>{const _0x387655=_0x10c82c;_0xe9ddbd[_0x387655(0xb08)][_0x387655(0x146f)](_0x387655(0x148b),_0x1e27e9);});}}}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1389))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x5b6422),document['getElementById'](_0x4bbbc4(0x948))['addEventListener'](_0x4bbbc4(0x15ad),_0x1621f1),document['getElementById'](_0x4bbbc4(0x8ad))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x4ecfdc),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x130b))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x5c6aa8=_0x4bbbc4;_0x51a6d1(_0x5c6aa8(0xe06));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x7c3))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>_0x15b8e6(null)),document[_0x4bbbc4(0x400)]('save-npc-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x3c1a69),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x136d))[_0x4bbbc4(0x501)]('click',_0x5fd3ea=>{const _0x82e497=_0x4bbbc4;_0x5fd3ea[_0x82e497(0x657)]['id']===_0x82e497(0xc31)&&_0x362fd9();}),document['getElementById'](_0x4bbbc4(0x6fb))['addEventListener']('click',()=>{const _0x57009c=_0x4bbbc4;document[_0x57009c(0x400)](_0x57009c(0xc09))[_0x57009c(0xb08)][_0x57009c(0xc46)](_0x57009c(0x9eb)),document[_0x57009c(0x400)](_0x57009c(0x136d))[_0x57009c(0xb08)]['contains'](_0x57009c(0x9eb))&&_0x15b8e6(editingNpcId);}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x91a))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x3d33b5),document['getElementById'](_0x4bbbc4(0xda0))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x1d0138=>{const _0x4a2948=_0x4bbbc4;_0x1d0138[_0x4a2948(0x657)][_0x4a2948(0xb08)][_0x4a2948(0xd3f)](_0x4a2948(0xd38))&&_0x460523(parseInt(_0x1d0138[_0x4a2948(0x657)]['dataset']['id']));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x352))[_0x4bbbc4(0x501)]('click',()=>{const _0x3089af=_0x4bbbc4;document[_0x3089af(0x400)](_0x3089af(0x136d))[_0x3089af(0xb08)]['remove'](_0x3089af(0x9eb));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x154e))[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),_0x1d61dc=>{const _0x11466b=_0x4bbbc4,_0x3ed5ab=_0x1d61dc[_0x11466b(0x657)]['files'][0x0];if(_0x3ed5ab){const _0x4624e9=new FileReader();_0x4624e9[_0x11466b(0x9e0)]=_0x26589d=>{const _0x222eab=_0x11466b;document[_0x222eab(0x400)]('npc-avatar-preview')[_0x222eab(0x912)]=_0x26589d['target'][_0x222eab(0xdd1)];},_0x4624e9[_0x11466b(0x157f)](_0x3ed5ab);}}),document[_0x4bbbc4(0x400)]('chat-lock-overlay')['addEventListener'](_0x4bbbc4(0x15ad),_0x3c164b=>{const _0x362504=_0x4bbbc4;if(_0x3c164b[_0x362504(0x657)]['id']===_0x362504(0x1438))_0x7a9b96();else _0x3c164b['target']['id']===_0x362504(0x9cc)&&_0x143f54();}),_0x3d4218(document[_0x4bbbc4(0x400)](_0x4bbbc4(0x4bc)),()=>{const _0x267d43=_0x4bbbc4;_0x59adb2[_0x267d43(0xbf0)]>-0x1&&_0x4d4718(_0x59adb2[_0x267d43(0xbf0)]);}),document[_0x4bbbc4(0x400)]('douban-settings-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x288c06),document['getElementById'](_0x4bbbc4(0xa20))[_0x4bbbc4(0x501)]('click',_0x424b64),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x521))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x1ec46e=_0x4bbbc4;document[_0x1ec46e(0x400)]('douban-settings-modal')['classList'][_0x1ec46e(0xc46)](_0x1ec46e(0x9eb));}),document['getElementById'](_0x4bbbc4(0x335))[_0x4bbbc4(0x501)](_0x4bbbc4(0x10a8),_0x3ecb12=>{const _0x30e6ab=_0x4bbbc4,_0x4561f7=_0x3ecb12['target'][_0x30e6ab(0xa1e)][_0x30e6ab(0x1653)](),_0x19115d=document[_0x30e6ab(0x400)](_0x30e6ab(0x162f));for(const _0x44d028 of _0x19115d[_0x30e6ab(0x48e)]){const _0x5d4bab=_0x44d028[_0x30e6ab(0xde7)]['toLowerCase']();_0x5d4bab[_0x30e6ab(0xd1b)](_0x4561f7)?_0x44d028[_0x30e6ab(0xa00)][_0x30e6ab(0xb1a)]='':_0x44d028[_0x30e6ab(0xa00)][_0x30e6ab(0xb1a)]=_0x30e6ab(0x165b);}}),window[_0x4bbbc4(0x769)]=_0x1372cb,document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1052))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>_0x1372cb(_0x4bbbc4(0x1377))),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x2b1))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x4e1f04=_0x4bbbc4;document[_0x4e1f04(0x400)]('werewolf-lobby-modal')[_0x4e1f04(0xb08)]['remove']('visible');}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xb19))['addEventListener'](_0x4bbbc4(0x15ad),_0x23ffb8),document['getElementById'](_0x4bbbc4(0x62c))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x10d5fe=_0x4bbbc4;document[_0x10d5fe(0x400)](_0x10d5fe(0x1031))['classList'][_0x10d5fe(0xc46)](_0x10d5fe(0x9eb)),_0x439c81();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x401))[_0x4bbbc4(0x501)]('click',async()=>{const _0x3b8fa8=_0x4bbbc4,_0x7c9d90=await _0x56d4d3('退出游戏',_0x3b8fa8(0x99c),{'confirmButtonClass':_0x3b8fa8(0x142c)});_0x7c9d90&&(_0x496f0a[_0x3b8fa8(0x11e7)]=![],_0x257d51(_0x496f0a['chatId']?_0x3b8fa8(0x946):_0x3b8fa8(0x13b1)));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x86b))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x3336bc=_0x4bbbc4;document[_0x3336bc(0x400)](_0x3336bc(0xe8d))[_0x3336bc(0xb08)]['remove']('visible'),_0x257d51(_0x496f0a[_0x3336bc(0x4dd)]?_0x3336bc(0x9a4):_0x3336bc(0x13b1));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x682))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0xfd4a99=_0x4bbbc4;document[_0xfd4a99(0x400)](_0xfd4a99(0xef3))[_0xfd4a99(0xb08)][_0xfd4a99(0xc46)](_0xfd4a99(0x9eb));}),document[_0x4bbbc4(0x400)]('cancel-werewolf-lobby-btn')[_0x4bbbc4(0x501)]('click',()=>{const _0x53d191=_0x4bbbc4;document[_0x53d191(0x400)]('werewolf-lobby-modal')[_0x53d191(0xb08)]['remove'](_0x53d191(0x9eb));}),document[_0x4bbbc4(0x400)]('werewolf-retry-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x43dede),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1234))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x1ab4eb),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1691))['addEventListener']('click',_0x352000),document[_0x4bbbc4(0x400)]('dynamic-island-music-toggle-switch')[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),_0x108927=>{const _0x23e8e8=_0x4bbbc4,_0x211820=_0x108927[_0x23e8e8(0x657)]['checked'];_0x4c8b14[_0x23e8e8(0x14f1)][_0x23e8e8(0x57f)]=_0x211820;const _0x5b52bc=document[_0x23e8e8(0x471)]['classList'][_0x23e8e8(0xd3f)]('frame-mode-active');if(_0x59adb2[_0x23e8e8(0x11e7)]&&!_0x5b52bc){const _0x32ecaf=document['getElementById']('global-lyrics-bar'),_0x34f394=document[_0x23e8e8(0x400)](_0x23e8e8(0x43a));_0x211820?(_0x32ecaf['classList'][_0x23e8e8(0xc46)](_0x23e8e8(0x9eb)),_0x34f394[_0x23e8e8(0xb08)][_0x23e8e8(0x12b6)](_0x23e8e8(0xa4b))):(_0x34f394[_0x23e8e8(0xb08)][_0x23e8e8(0xc46)]('dynamic-island-active'),_0x59adb2[_0x23e8e8(0x7ee)]&&_0x59adb2['parsedLyrics'][_0x23e8e8(0x8d6)]>0x0&&_0x32ecaf[_0x23e8e8(0xb08)][_0x23e8e8(0x12b6)]('visible'));}}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1176))[_0x4bbbc4(0x501)]('click',_0x536216),document['getElementById'](_0x4bbbc4(0x1152))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x1d7a8e=_0x4bbbc4;document[_0x1d7a8e(0x400)](_0x1d7a8e(0x147d))['classList'][_0x1d7a8e(0xc46)](_0x1d7a8e(0x9eb));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x39d))['addEventListener'](_0x4bbbc4(0x15ad),_0x478ca7),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x147d))[_0x4bbbc4(0x501)]('click',_0x1121cc=>{const _0x318480=_0x4bbbc4,_0x1c3dcc=_0x1121cc[_0x318480(0x657)][_0x318480(0x117a)]('.clear-posts-item');_0x1c3dcc&&_0x1c3dcc[_0x318480(0xb08)][_0x318480(0x146f)](_0x318480(0x148b));if(_0x1121cc[_0x318480(0x657)]['id']===_0x318480(0xda2)){const _0x44972e=_0x1121cc[_0x318480(0x657)]['checked'];document[_0x318480(0x527)](_0x318480(0x672))[_0x318480(0xbdc)](_0x5ad0cb=>{const _0x4dcfef=_0x318480;_0x5ad0cb[_0x4dcfef(0xb08)][_0x4dcfef(0x146f)](_0x4dcfef(0x148b),_0x44972e);});}}),document['getElementById'](_0x4bbbc4(0x13a7))[_0x4bbbc4(0x501)](_0x4bbbc4(0x10a8),()=>{_0x11d8fe(![]);}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xb9a))[_0x4bbbc4(0x501)]('click',_0x1f7078=>{const _0x1c4581=_0x4bbbc4;if(_0x1f7078[_0x1c4581(0x657)][_0x1c4581(0xb08)][_0x1c4581(0xd3f)](_0x1c4581(0x894))){const _0x319a85=_0x1f7078['target']['dataset'][_0x1c4581(0x12c4)],_0x364894=_0x319a85!==_0x1c4581(0x875)&&_0x319a85!==_0x1c4581(0x13c3)?parseInt(_0x319a85):_0x319a85;document['getElementById']('sticker-search-input')[_0x1c4581(0xa1e)]='',_0x1630a4(_0x364894);}});const _0x1a5276=document[_0x4bbbc4(0x400)](_0x4bbbc4(0x75b));_0x1a5276[_0x4bbbc4(0x501)]('scroll',()=>{const _0x1f5994=_0x4bbbc4;if(_0x1a5276[_0x1f5994(0x125c)]<0x1&&!_0x35d11e){const _0x4d8738=_0x4c8b14[_0x1f5994(0xbea)][_0x4c8b14[_0x1f5994(0x1539)]]?.[_0x1f5994(0x92c)][_0x1f5994(0x8d6)]||0x0;_0x4d8738>_0x4e5ab7&&_0x14354e();}});const _0x56f3f5=document['getElementById'](_0x4bbbc4(0x8ba));_0x56f3f5['addEventListener'](_0x4bbbc4(0x1235),()=>{const _0x4d9b65=_0x4bbbc4,{scrollTop:_0x457a9e,scrollHeight:_0x53eeb7,clientHeight:_0x2b6114}=_0x56f3f5;if(_0x53eeb7-_0x457a9e<=_0x2b6114+0x32&&!_0x2ae06b){const _0x4e6483=_0x4c8b14[_0x4d9b65(0xbea)][_0x4c8b14[_0x4d9b65(0x1539)]]?.[_0x4d9b65(0x13a1)][_0x4d9b65(0x8d6)]||0x0;_0x4e6483>_0x42d9d9&&_0x4c9c15();}});const _0x445dd3=document[_0x4bbbc4(0x13ef)](_0x4bbbc4(0x10d6));_0x445dd3[_0x4bbbc4(0x501)](_0x4bbbc4(0x1235),()=>{const _0xd475da=_0x4bbbc4,{scrollTop:_0x4c3f38,scrollHeight:_0x4f22e4,clientHeight:_0x22782d}=_0x445dd3;_0x4f22e4-_0x4c3f38<=_0x22782d+0x64&&!_0x54c52c&&(_0x265b3f[_0xd475da(0x8d6)]>_0x295d50&&_0x3a9e92());});const _0x5ed65c=document[_0x4bbbc4(0x400)](_0x4bbbc4(0xcae));_0x5ed65c[_0x4bbbc4(0x501)](_0x4bbbc4(0x1235),()=>{const _0x1b362c=_0x4bbbc4,{scrollTop:_0x316282,scrollHeight:_0xba1f21,clientHeight:_0xff6379}=_0x5ed65c;_0xba1f21-_0x316282<=_0xff6379+0x64&&!_0x5370c1&&(_0x1058d8[_0x1b362c(0x8d6)]>_0xcd9130&&_0x22544c());}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xbd8))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x238385);const _0x3f63af=document[_0x4bbbc4(0x400)](_0x4bbbc4(0x233));_0x4aead0(_0x3f63af,_0x3f63af),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x789))[_0x4bbbc4(0x501)]('click',_0x2ef5d1),document['getElementById'](_0x4bbbc4(0xb34))['addEventListener'](_0x4bbbc4(0x15ad),_0x4f2c1b),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xa26))['addEventListener']('click',_0x23f1d9),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x7e9))['addEventListener'](_0x4bbbc4(0x15ad),_0x23879b),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xcdf))[_0x4bbbc4(0x501)]('change',_0x5d5786),document['getElementById']('minimize-reading-btn')[_0x4bbbc4(0x501)]('click',_0x5a9463),document[_0x4bbbc4(0x400)]('reading-restore-btn')[_0x4bbbc4(0x501)]('click',_0x53d450),_0x4aead0(document['getElementById'](_0x4bbbc4(0xe26)),document['querySelector'](_0x4bbbc4(0x9f8))),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xb34))[_0x4bbbc4(0x501)]('click',_0x4f2c1b),document['getElementById'](_0x4bbbc4(0x12e1))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x3538b1=_0x4bbbc4;document['getElementById'](_0x3538b1(0x9d1))[_0x3538b1(0xb08)]['remove'](_0x3538b1(0x9eb));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xa7b))['addEventListener'](_0x4bbbc4(0x15ad),_0xc320e8),document[_0x4bbbc4(0x400)]('reading-library-list')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x2a221c=>{const _0x61f95=_0x4bbbc4,_0x4f59d7=_0x2a221c['target'];if(_0x4f59d7[_0x61f95(0xb08)]['contains'](_0x61f95(0x642))){const _0x3caa54=parseInt(_0x4f59d7[_0x61f95(0xd61)][_0x61f95(0x443)]);_0x436b8b(_0x3caa54);}else{if(_0x4f59d7[_0x61f95(0xb08)][_0x61f95(0xd3f)](_0x61f95(0xd38))){const _0x484b3c=parseInt(_0x4f59d7[_0x61f95(0xd61)]['bookId']);_0x565afd(_0x484b3c);}}}),document['getElementById'](_0x4bbbc4(0xd33))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x2097af),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x10b8))['addEventListener']('input',_0xa20113=>{const _0x104ccc=_0x4bbbc4;_0x50a49e(_0xa20113[_0x104ccc(0x657)][_0x104ccc(0xa1e)]);});const _0x8305b7=_0x417d62(_0x35fcc8,0x12c);document[_0x4bbbc4(0x400)](_0x4bbbc4(0xbce))['addEventListener'](_0x4bbbc4(0x1235),_0x8305b7),document[_0x4bbbc4(0x400)]('api-temperature-slider')[_0x4bbbc4(0x501)](_0x4bbbc4(0x10a8),_0x45a69b=>{const _0x2305a3=_0x4bbbc4;document[_0x2305a3(0x400)](_0x2305a3(0x47a))[_0x2305a3(0xde7)]=_0x45a69b[_0x2305a3(0x657)]['value'];});const _0x4a2cda=document[_0x4bbbc4(0x400)]('messages-view');_0x4a2cda['addEventListener'](_0x4bbbc4(0x1235),()=>{const {scrollTop:_0x298d82,scrollHeight:_0x209807,clientHeight:_0x495496}=_0x4a2cda;_0x209807-_0x298d82<=_0x495496+0x96&&!_0x83fa86&&_0x30b607();}),document['getElementById'](_0x4bbbc4(0xb2f))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x17a4e6),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xbb2))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x2dc757=_0x4bbbc4;document[_0x2dc757(0x400)](_0x2dc757(0x603))[_0x2dc757(0xb08)][_0x2dc757(0xc46)]('visible'),_0x21e974(_0x4ecd3b);}),document[_0x4bbbc4(0x400)]('add-new-product-category-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0xe96055),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x346))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x351768=>{const _0x3b6812=_0x4bbbc4;_0x351768[_0x3b6812(0x657)][_0x3b6812(0xb08)]['contains'](_0x3b6812(0xd38))&&_0x23bc34(parseInt(_0x351768[_0x3b6812(0x657)][_0x3b6812(0xd61)]['id']));}),document['getElementById'](_0x4bbbc4(0x908))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>_0x1ae5b9()),document['getElementById'](_0x4bbbc4(0xd7d))['addEventListener']('click',()=>{const _0x3c6aeb=_0x4bbbc4;document[_0x3c6aeb(0x400)]('variation-selection-modal')[_0x3c6aeb(0xb08)][_0x3c6aeb(0xc46)]('visible');}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x6f1))[_0x4bbbc4(0x501)]('click',()=>{const _0x1567a4=_0x4bbbc4,_0x3ea1b0=document[_0x1567a4(0x400)](_0x1567a4(0x2ae));let _0x5e2659=parseInt(_0x3ea1b0[_0x1567a4(0xde7)]);if(_0x5e2659>0x1)_0x3ea1b0[_0x1567a4(0xde7)]=_0x5e2659-0x1;}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xcd0))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0xf451f7=_0x4bbbc4,_0x25f539=document[_0xf451f7(0x400)](_0xf451f7(0x2ae));_0x25f539[_0xf451f7(0xde7)]=parseInt(_0x25f539[_0xf451f7(0xde7)])+0x1;}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x217))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x5d90a1=>{const _0x1702bb=_0x4bbbc4;if(_0x5d90a1['target']['classList'][_0x1702bb(0xd3f)](_0x1702bb(0x145b))){const _0x547ac7=_0x5d90a1[_0x1702bb(0x657)][_0x1702bb(0xd61)][_0x1702bb(0x12c4)]===_0x1702bb(0x875)?'all':parseInt(_0x5d90a1[_0x1702bb(0x657)]['dataset'][_0x1702bb(0x12c4)]);_0x4589e7(_0x547ac7);}}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x7a3))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x2c0996),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x949))[_0x4bbbc4(0x501)]('click',_0x483ffc),document['getElementById'](_0x4bbbc4(0xeed))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x5cd3af),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x38f))['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0x2b1108=_0x4bbbc4;document[_0x2b1108(0x400)](_0x2b1108(0x68c))[_0x2b1108(0xb08)][_0x2b1108(0xc46)](_0x2b1108(0x9eb));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x843))['addEventListener'](_0x4bbbc4(0x866),_0x40e07b=>{const _0x5c260a=_0x4bbbc4,_0x108355=_0x40e07b[_0x5c260a(0x657)][_0x5c260a(0x6f9)],_0x58828c=document[_0x5c260a(0x527)](_0x5c260a(0x132e));_0x58828c[_0x5c260a(0xbdc)](_0x22cb67=>{const _0x4e1300=_0x5c260a,_0x3e8591=parseInt(_0x22cb67[_0x4e1300(0xd61)]['id']);_0x22cb67['classList']['toggle'](_0x4e1300(0x148b),_0x108355),_0x108355?_0x490480[_0x4e1300(0x12b6)](_0x3e8591):_0x490480['delete'](_0x3e8591);}),document[_0x5c260a(0x400)](_0x5c260a(0xc8f))[_0x5c260a(0xde7)]=_0x5c260a(0xe4f)+_0x490480['size']+')';}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xc8f))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{const _0xb64904=_0x4bbbc4;if(_0x490480[_0xb64904(0x9e8)]===0x0){alert('请先选择要删除的商品。');return;}const _0x3d4d3f=await _0x56d4d3(_0xb64904(0x713),_0xb64904(0x60b)+_0x490480['size']+'\x20个商品吗？此操作不可恢复。',{'confirmButtonClass':'btn-danger'});_0x3d4d3f&&(await _0x54c587['shoppingProducts'][_0xb64904(0x2c6)]([..._0x490480]),document[_0xb64904(0x400)](_0xb64904(0x90d))['click'](),await _0x4cf8d9(),await _0x138765('成功','选中的商品已成功删除。'));}),document[_0x4bbbc4(0x400)]('appearance-preset-select')['addEventListener'](_0x4bbbc4(0x866),_0x51468b),document[_0x4bbbc4(0x400)]('save-appearance-preset-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x219a75),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x39f))['addEventListener'](_0x4bbbc4(0x15ad),_0x556c45),document['getElementById'](_0x4bbbc4(0xb43))[_0x4bbbc4(0x501)]('change',_0x568510=>{const _0x1a1aaa=_0x4bbbc4,_0x3defdd=document[_0x1a1aaa(0x400)](_0x1a1aaa(0xbc4));_0x3defdd[_0x1a1aaa(0xa00)][_0x1a1aaa(0xb1a)]=_0x568510['target'][_0x1a1aaa(0x6f9)]?_0x1a1aaa(0x1181):_0x1a1aaa(0x165b);}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xa16))['addEventListener']('click',function(){const _0x55bcf4=_0x4bbbc4,_0x5b848e=document[_0x55bcf4(0x400)](_0x55bcf4(0x1570));_0x5b848e[_0x55bcf4(0xbbf)]===_0x55bcf4(0xf4c)?(_0x5b848e[_0x55bcf4(0xbbf)]='text',this[_0x55bcf4(0xde7)]='😌'):(_0x5b848e[_0x55bcf4(0xbbf)]=_0x55bcf4(0xf4c),this['textContent']='🧐');}),document['getElementById'](_0x4bbbc4(0xe0c))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x27fe4f=_0x4bbbc4;_0x2dfe5c(),document[_0x27fe4f(0x400)](_0x27fe4f(0x1482))[_0x27fe4f(0xa00)][_0x27fe4f(0xb1a)]='flex';}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1184))[_0x4bbbc4(0x501)](_0x4bbbc4(0x866),_0x5ca537=>{const _0x161404=_0x4bbbc4,_0x1e69fe=document['getElementById'](_0x161404(0x5c4));_0x5ca537['target'][_0x161404(0xa1e)]===_0x161404(0x7da)?_0x1e69fe['style']['display']=_0x161404(0x1181):_0x1e69fe['style']['display']=_0x161404(0x165b);}),document[_0x4bbbc4(0x400)]('close-novelai-settings')['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0x5229b2=_0x4bbbc4;document[_0x5229b2(0x400)](_0x5229b2(0x1482))[_0x5229b2(0xa00)][_0x5229b2(0xb1a)]=_0x5229b2(0x165b);}),document['getElementById'](_0x4bbbc4(0x473))['addEventListener'](_0x4bbbc4(0x15ad),()=>{const _0x3253ce=_0x4bbbc4;_0x35d044(),document['getElementById']('novelai-settings-modal')[_0x3253ce(0xa00)][_0x3253ce(0xb1a)]=_0x3253ce(0x165b),alert('NovelAI设置已保存！');}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x316))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x325b5a=_0x4bbbc4;confirm(_0x325b5a(0x9ce))&&_0x392156();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1034))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x40a90b=_0x4bbbc4,_0x22be8d=document[_0x40a90b(0x400)]('novelai-api-key')[_0x40a90b(0xa1e)][_0x40a90b(0xb8f)]();if(!_0x22be8d){alert(_0x40a90b(0x1304));return;}document[_0x40a90b(0x400)]('novelai-test-modal')[_0x40a90b(0xa00)][_0x40a90b(0xb1a)]=_0x40a90b(0x375),document[_0x40a90b(0x400)]('nai-test-result')['style']['display']=_0x40a90b(0x165b),document[_0x40a90b(0x400)]('nai-test-error')[_0x40a90b(0xa00)]['display']=_0x40a90b(0x165b);}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xdf0))['addEventListener']('click',()=>{const _0x4bee2f=_0x4bbbc4;document[_0x4bee2f(0x400)](_0x4bee2f(0xafa))['style'][_0x4bee2f(0xb1a)]=_0x4bee2f(0x165b);}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x804))[_0x4bbbc4(0x501)]('click',()=>{const _0x49671e=_0x4bbbc4;document[_0x49671e(0x400)](_0x49671e(0xafa))[_0x49671e(0xa00)]['display']='none';}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x900))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),async()=>{await _0x9a6288();}),document['getElementById'](_0x4bbbc4(0x56a))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x2c25d7=_0x4bbbc4,_0x122edf=document[_0x2c25d7(0x400)](_0x2c25d7(0x27f)),_0x7d68d9=document['createElement']('a');_0x7d68d9[_0x2c25d7(0xcf5)]=_0x122edf[_0x2c25d7(0x912)],_0x7d68d9[_0x2c25d7(0xcda)]=_0x2c25d7(0x2de)+Date[_0x2c25d7(0xecd)]()+_0x2c25d7(0x57b),_0x7d68d9['click']();}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x131a))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x37377d=_0x4bbbc4;if(!_0x4c8b14[_0x37377d(0x1539)])return;const _0x365445=_0x4c8b14['chats'][_0x4c8b14['activeChatId']],_0x3bdc44=_0x365445[_0x37377d(0xa37)][_0x37377d(0x108c)]||{'promptSource':'system','characterPositivePrompt':'','characterNegativePrompt':''};document[_0x37377d(0x400)](_0x37377d(0x1684))[_0x37377d(0xa1e)]=_0x3bdc44['characterPositivePrompt']||'',document[_0x37377d(0x400)](_0x37377d(0xed0))[_0x37377d(0xa1e)]=_0x3bdc44['characterNegativePrompt']||'',document[_0x37377d(0x400)](_0x37377d(0x132c))['style'][_0x37377d(0xb1a)]=_0x37377d(0x375);}),document['getElementById'](_0x4bbbc4(0x7a7))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0x133929=_0x4bbbc4;document[_0x133929(0x400)](_0x133929(0x132c))['style'][_0x133929(0xb1a)]=_0x133929(0x165b);}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1e9))['addEventListener'](_0x4bbbc4(0x15ad),async()=>{const _0x11e5c9=_0x4bbbc4;if(!_0x4c8b14[_0x11e5c9(0x1539)])return;const _0x4a62ff=_0x4c8b14[_0x11e5c9(0xbea)][_0x4c8b14['activeChatId']];!_0x4a62ff['settings'][_0x11e5c9(0x108c)]&&(_0x4a62ff[_0x11e5c9(0xa37)][_0x11e5c9(0x108c)]={'promptSource':'system'}),_0x4a62ff['settings'][_0x11e5c9(0x108c)][_0x11e5c9(0x318)]=document[_0x11e5c9(0x400)](_0x11e5c9(0x1684))[_0x11e5c9(0xa1e)][_0x11e5c9(0xb8f)](),_0x4a62ff[_0x11e5c9(0xa37)][_0x11e5c9(0x108c)][_0x11e5c9(0x11dd)]=document[_0x11e5c9(0x400)](_0x11e5c9(0xed0))[_0x11e5c9(0xa1e)][_0x11e5c9(0xb8f)](),console['log'](_0x11e5c9(0x5c3)),console[_0x11e5c9(0x1e6)](_0x11e5c9(0xdda),_0x4a62ff[_0x11e5c9(0xa37)][_0x11e5c9(0x108c)][_0x11e5c9(0x318)]),console[_0x11e5c9(0x1e6)]('\x20\x20\x20characterNegativePrompt:',_0x4a62ff['settings']['naiSettings'][_0x11e5c9(0x11dd)]),console[_0x11e5c9(0x1e6)](_0x11e5c9(0xbae),_0x4a62ff['settings'][_0x11e5c9(0x108c)]['promptSource']),await _0x54c587[_0x11e5c9(0xbea)][_0x11e5c9(0x4cb)](_0x4a62ff),document[_0x11e5c9(0x400)](_0x11e5c9(0x132c))[_0x11e5c9(0xa00)][_0x11e5c9(0xb1a)]='none',alert(_0x11e5c9(0x10bd));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x10f7))[_0x4bbbc4(0x501)]('click',()=>{const _0x3f6a32=_0x4bbbc4;confirm(_0x3f6a32(0xdfa))&&(document['getElementById'](_0x3f6a32(0x1684))[_0x3f6a32(0xa1e)]='',document[_0x3f6a32(0x400)](_0x3f6a32(0xed0))[_0x3f6a32(0xa1e)]='');}),document[_0x4bbbc4(0x400)]('group-character-nai-prompts-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>{const _0xa81912=_0x4bbbc4;if(!_0x4c8b14[_0xa81912(0x1539)])return;const _0x6de905=_0x4c8b14[_0xa81912(0xbea)][_0x4c8b14['activeChatId']],_0x188095=_0x6de905['settings'][_0xa81912(0x108c)]||{'promptSource':'system','characterPositivePrompt':'','characterNegativePrompt':''};document[_0xa81912(0x400)]('character-nai-positive')[_0xa81912(0xa1e)]=_0x188095[_0xa81912(0x318)]||'',document['getElementById']('character-nai-negative')['value']=_0x188095['characterNegativePrompt']||'',document['getElementById'](_0xa81912(0x132c))[_0xa81912(0xa00)]['display']='flex';}),document[_0x4bbbc4(0x400)]('manage-frames-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x281613),document['getElementById'](_0x4bbbc4(0xa42))[_0x4bbbc4(0x501)]('change',_0x5cedb4),document['getElementById']('delete-selected-frames-btn')[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x572436),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1088))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x64180c),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xf77))[_0x4bbbc4(0x501)]('click',()=>{_0x2b7df1('char-taobao-screen');}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1605))[_0x4bbbc4(0x501)]('click',_0x581ecb=>{const _0x4afa89=_0x4bbbc4,_0x275767=_0x581ecb['target'][_0x4afa89(0x117a)](_0x4afa89(0xff2));if(_0x275767){const _0x292919=_0x275767[_0x4afa89(0x13ef)](_0x4afa89(0x11ce));_0x292919&&_0x581ecb[_0x4afa89(0x657)]!==_0x292919&&(_0x292919['checked']=!_0x292919[_0x4afa89(0x6f9)]);}});const _0x45a3f9=document['getElementById']('sticker-category-tabs');_0x3d4218(_0x45a3f9,_0x54993e=>{const _0x2437ed=_0x4bbbc4,_0x220509=_0x54993e[_0x2437ed(0x657)][_0x2437ed(0x117a)](_0x2437ed(0xe95));if(_0x220509){_0x54993e[_0x2437ed(0x92e)]();const _0x22017b=_0x220509[_0x2437ed(0xd61)][_0x2437ed(0x12c4)];if(_0x22017b==='all'){_0x138765('提示',_0x2437ed(0x1672));return;}const _0x2e3ac3=_0x22017b===_0x2437ed(0x13c3)?'uncategorized':parseInt(_0x22017b);_0x3467d5(_0x2e3ac3);}}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x11c3))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x1cd581),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x11a1))['addEventListener']('click',()=>{const _0x42a0a0=_0x4bbbc4;document[_0x42a0a0(0x400)](_0x42a0a0(0x9e4))[_0x42a0a0(0xb08)][_0x42a0a0(0xc46)](_0x42a0a0(0x9eb));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x12bf))[_0x4bbbc4(0x501)]('click',_0x56ab21),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xcae))[_0x4bbbc4(0x501)]('click',_0x3a2435=>{_0x1d9e1d(_0x3a2435);}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x1071))['addEventListener'](_0x4bbbc4(0x866),_0x5edd0d=>{const _0x26087b=_0x4bbbc4,_0x174c2a=_0x5edd0d[_0x26087b(0x657)][_0x26087b(0x6f9)];document[_0x26087b(0x527)]('#nai-gallery-grid\x20.nai-gallery-item')[_0x26087b(0xbdc)](_0x34e1d6=>{const _0x2b78ba=_0x26087b;_0x34e1d6[_0x2b78ba(0xb08)][_0x2b78ba(0x146f)](_0x2b78ba(0x148b),_0x174c2a);const _0x15d2ec=_0x34e1d6[_0x2b78ba(0xd61)]['key'];_0x174c2a?_0x1698d6['add'](_0x15d2ec):_0x1698d6[_0x2b78ba(0x942)](_0x15d2ec);}),_0x12489f();}),document['getElementById'](_0x4bbbc4(0x751))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>_0x58c981()),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xbee))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),()=>_0x4edf5b()),document[_0x4bbbc4(0x400)]('chat-expand-btn')[_0x4bbbc4(0x501)]('click',()=>{const _0x6cda94=_0x4bbbc4;document['body']['classList'][_0x6cda94(0x146f)]('chat-actions-expanded');}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x15c0))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x512385),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x9f3))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x36a2d9),document[_0x4bbbc4(0x400)](_0x4bbbc4(0xa41))['addEventListener']('click',()=>{const _0x530626=_0x4bbbc4;document[_0x530626(0x400)]('quick-reply-modal')['classList'][_0x530626(0xc46)](_0x530626(0x9eb));}),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x8c1))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x2d3061),document[_0x4bbbc4(0x400)](_0x4bbbc4(0x2bd))['addEventListener']('click',_0x117c66=>{const _0x3d5e05=_0x4bbbc4,_0x23dee6=_0x117c66['target'][_0x3d5e05(0x117a)](_0x3d5e05(0x6c9)),_0xd22f80=_0x117c66['target'][_0x3d5e05(0x117a)](_0x3d5e05(0x3b4)),_0x1383a6=_0x117c66[_0x3d5e05(0x657)][_0x3d5e05(0x117a)](_0x3d5e05(0xaee));if(_0x23dee6)_0x4fd90(_0x23dee6[_0x3d5e05(0xd61)][_0x3d5e05(0x117f)]);else{if(_0xd22f80){const _0x5ad640=parseInt(_0xd22f80['dataset']['id']);if(!isNaN(_0x5ad640))_0x4e7f88(_0x5ad640);}else{if(_0x1383a6){const _0x132fbd=parseInt(_0x1383a6['dataset']['id']);if(!isNaN(_0x132fbd))_0x41d972(_0x132fbd);}}}}),document['getElementById'](_0x4bbbc4(0xb55))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x3c281c),document['getElementById'](_0x4bbbc4(0x7c5))[_0x4bbbc4(0x501)](_0x4bbbc4(0x15ad),_0x13c4eb),_0x4aead0(document[_0x4bbbc4(0x400)](_0x4bbbc4(0x7c5)),document[_0x4bbbc4(0x400)]('char-music-restore-btn')),_0x5b775e(),_0x27c7e2(),_0x257d51(_0x4bbbc4(0x13b1));}_0x5d5cde();});

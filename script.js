const _0x534c67=_0x6c9e;(function(_0x20e8d4,_0x50f32b){const _0x316904=_0x6c9e,_0x2f63d7=_0x20e8d4();while(!![]){try{const _0x1cfce5=parseInt(_0x316904(0x561))/0x1*(parseInt(_0x316904(0x414))/0x2)+-parseInt(_0x316904(0x14b6))/0x3+parseInt(_0x316904(0x7d3))/0x4*(parseInt(_0x316904(0xc92))/0x5)+-parseInt(_0x316904(0x11da))/0x6+-parseInt(_0x316904(0x582))/0x7*(parseInt(_0x316904(0x294))/0x8)+-parseInt(_0x316904(0x9a4))/0x9+-parseInt(_0x316904(0x610))/0xa*(-parseInt(_0x316904(0x14f4))/0xb);if(_0x1cfce5===_0x50f32b)break;else _0x2f63d7['push'](_0x2f63d7['shift']());}catch(_0x222098){_0x2f63d7['push'](_0x2f63d7['shift']());}}}(_0x10ab,0x1b5cd));function _0x10ab(){const _0x11d8c1=['default_positive','blocked_by_ai','players','ai-avatar-input','实时预览','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22werewolf-player-checkbox\x22\x20data-player-json=\x27','role','syncCharacterNameInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','promptFeedback',',\x20记录数:\x20','removeEventListener','确定要删除这篇日记吗？','压缩步骤\x202/3:\x20正在内存中异步压缩图片，这可能需要一些时间...','删除相册','imageCount','彻底删除','https://i.postimg.cc/wTKyXVT9/IMG-7024.gif','cancel-rule-editor-btn','for_timestamp','custom-prompt-input','\x0a#\x20身份与核心任务\x0a你正在扮演角色“','player','\x20条无效的','reading-content','waimai-order-for-ai-btn','Wait\x20for\x20Reply','https://i.postimg.cc/kXfcgFRN/IMG-7106.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.\x20你可以参考这个时间，并根据你的角色设定，【考虑】是否开启一个新话题来问候用户。\x0a','</div><div\x20class=\x22description\x22>共\x20','[图片/文字图]\x20描述:\x20\x22','aiAvatar','Their\x20Browser\x20History','https://i.postimg.cc/KYr2qRCK/1.jpg','world-book-card','offlineMaxLength','blocked_by_user','正在执行完全导入，请勿关闭页面...','您的分片备份已开始下载。解压后，您可以使用“导入”功能，选择其中的\x20`slice_X.json`\x20文件进行增量恢复。','将清空角色的相册、QQ、浏览器、淘宝、日记、备忘录等所有模拟手机数据。','product-variations-container','https://i.postimg.cc/Mpv5fzm5/IMG-4439.gif','image/*','parentNode','你撤回了一条消息','https://i.postimg.cc/zvz2LGK0/IMG-4367.gif','\x0a-\x20策略:\x20','#npc-association-list\x20input:checked','\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','startsWith','><div\x20class=\x22card-pin-icon\x22><svg\x20width=\x221em\x22\x20height=\x221em\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2011.5C11.1716\x2011.5\x2010.5\x2010.8284\x2010.5\x2010C10.5\x209.17157\x2011.1716\x208.5\x2012\x208.5C12.8284\x208.5\x2013.5\x209.17157\x2013.5\x2010C13.5\x2010.8284\x2012.8284\x2011.5\x2012\x2011.5Z\x22></path><path\x20d=\x22M12\x202C7.92134\x202\x204.5\x205.42134\x204.5\x209.5C4.5\x2014.5312\x2011.2188\x2021.4375\x2011.5938\x2021.8125C11.7954\x2022.014\x2012.2046\x2022.014\x2012.4062\x2021.8125C12.7812\x2021.4375\x2019.5\x2014.5312\x2019.5\x209.5C19.5\x205.42134\x2016.0787\x202\x2012\x202ZM12\x2012.5C10.6193\x2012.5\x209.5\x2011.3807\x209.5\x2010C9.5\x208.61929\x2010.6193\x207.5\x2012\x207.5C13.3807\x207.5\x2014.5\x208.61929\x2014.5\x2010C14.5\x2011.3807\x2013.3807\x2012.5\x2012\x2012.5Z\x22></path></svg></div></div></div>','customAvatarFrames','无法访问剪贴板。','在PNG文件中未找到有效的Tavern\x20AI角色数据(chara\x20chunk)。','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22form-button-secondary\x20upload-variation-image-btn\x22\x20style=\x22margin:\x200;\x20padding:\x208px\x2012px;\x22>上传</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20class=\x22variation-image-input\x22\x20accept=\x22image/*\x22\x20hidden>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','rp-details-greeting','生成设置','确定要删除这条评论吗？','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','[系统提示：用户打开了五子棋棋盘，游戏开始了。]','search-history-back-btn','」听歌。要结束并开始和「','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','99+','正在生成“','”\x20的位置已发送到你们的聊天中。','AI的五子棋移动指令包含无效坐标，已忽略:','\x20条记录到\x20','...”)','share_card','[+]\x20Add\x20New\x20Entry','确定要删除《','douban-min-posts-input','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','后台活动:\x20角色\x20\x22','帖子详情','\x22\x20data-category-id=\x22all\x22>全部</button>','imageUrls','https://i.postimg.cc/hPnrSHjy/IMG-4434.gif','regenerate-char-taobao-btn','\x20\x0a\x0a#\x20待处理的帖子列表\x20(如果你选择评论)\x0a','QQ音乐','NPC\x20Nickname','[系统指令：你刚刚在自己的手机上活动了一番（和朋友聊天、逛群等）。现在请根据你的角色设定，主动给用户发一条消息，可以聊聊你刚才看到或聊到的趣事，或者仅仅是问候一下。]','waimai-request-modal','image-mode-content','variation-increase-qty','-\x20(空)','rp-group-greeting','removeChild','规则名称和正则表达式不能为空！','AI\x20的下棋指令无效或位置已被占据:','\x0a-\x20**最近对话摘要**:\x0a','select-message-btn','char-simulated-send-btn','\x22\x20的后台活动开关已关闭，本次跳过。','<button\x20id=\x22delete-selected-stickers-btn\x22>删除\x20(0)</button>','当前时间是\x20','，我的看法是...\x20我【必须】回应...\x0a3.\x20\x20**S\x20(Social\x20-\x20社交表演)**:\x20我要如何用我的【人设】和【社交关系】来包装我的发言？\x0a\x20\x20\x20\x20-\x20(例如：我的好友\x20','.format-btn','stickerId','\x0a---\x0a','这将用文件中的设置覆盖当前的所有外观设置（包括壁纸、图标、字体、CSS等）。确定要继续吗？','.name','floor','编辑规则','imageUrl','button-order-editor','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>输入关键词或选择日期进行搜索。</p>','AI返回的数据不是一个数组。原始返回:\x20','创建新聊天\x20(第1/2步)','最近\x2020\x20条','import-preset-input','publicText','分组\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>正在计算...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22>--</span>\x0a\x20\x20\x20\x20','[私聊]','char-qq-transcript-modal','AI狼人团队无法决定目标，游戏暂停。请点击右上角的“重试”按钮继续。','EPhone-Chat-','屠边局：狼人杀死所有神职或所有平民即获胜。','”生成这组【与角色高度相关】的商品数据。','加载更早的会话','(这张照片没有描述)','close','发送照片','请输入新的图片URL','更换图片','#\x20你的互动对象\x20(用户和其他角色)\x0a','douban-screen','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1758510900942_qdqqd_djw0z2.jpeg','photos-grid-page','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-main-content\x22>','讨论无法开始，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','stickerCategories','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近的“高德地图”出行足迹。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','ServiceWorker\x20注册成功，作用域为:\x20','</span></div><div\x20class=\x22gift-items-preview\x22>','qzoneAlbums','📁\x20从本地上传','\x0a#\x20世界观\x20(必须严格遵守)\x0a','”的身份，开始你的回忆梳理与精炼。','announcement-item-actions','保存并应用','announcement-item-wrapper','#4CAF50','\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20请你根据以上所有信息，以及你的人设，使用\x20friend_request_response\x20指令，并设置\x20decision\x20为\x20\x27accept\x27\x20或\x20\x27reject\x27\x20来决定是否通过。\x0a\x20\x20\x20\x20\x20\x20\x20\x20',';\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20left;\x20text-decoration:\x20','paddingBottom','✅\x20NAI提示词：使用角色配置','<div\x20class=\x22announcement-item-actions\x22\x20data-anno-id=\x22','minimaxVoiceId','执行检查时发生错误:\x20','导演/编辑模式保存(Sticker):\x20使用了\x20meaning\x20查找','image_url','无法获取模型列表','\x20张图片因网络或CORS限制下载失败。','data:','https://i.postimg.cc/tC9mJ0cv/IMG-4438.gif','\x0a-\x20**你的长期记忆**:\x20','\x20你们之间已经有**','新NAI图片生成失败，此条消息已被跳过。','group_call_summary','start','apply','simulatedAmapHistory','\x0a#\x20长期记忆\x20(所有角色必须严格遵守)\x0a','歌曲信息','ttsCache','</div><div\x20class=\x22gift-footer\x22>共','filter','后台活动检测间隔\x20(秒)','*对方按下了接听键...*','\x0a\x0a#\x20当前情景\x0a','https://i.postimg.cc/bw4wxW2z/IMB-16r-COL.gif','at-mention-item','请至少选择一种要合并的数据类型。','expanded','在这里输入图片描述','close-char-music-player-btn','\x20张图片。','网易云音乐API未返回有效结果:','add-new-product-category-btn','个月前','”的身份，开始你的客观总结。','keys','\x0a\x0a现在，请生成包含总余额和购买记录的JSON对象。','https://i.postimg.cc/QMDsSNxg/IMG-6861.gif','8px','delete-selected-products-btn','naiSettings','导演/编辑模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:','📋\x20直接粘贴歌词文本','font-size-slider','导演模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','share-target-list','board','选中的商品已成功删除。','favorites','style=\x22background-image:\x20url(\x27','**:\x20','”的转账。]','表情分类','#custom-modal-body\x20.format-btn[data-type=\x22text\x22]','确定要将以下消息发布到公告板吗？\x0a\x0a“','正在合并非标对象到\x20','poll-options-container','，我的人设很','[ERROR:\x20','groupAvatar','group-avatar-preview','is-sticker','https://i.postimg.cc/PxZrFFFL/o-o-1.jpg','.png','正在准备分片导出...','pageX','register','字**\x20之间。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI、模型，或提及“扮演”、“生成”等词语。\x0a\x0a\x0a\x0a现在，请根据以上所有规则和对话历史，继续这场线下互动。\x0a','这个预设文件中没有找到任何有效的提示词条目。','命名头像框','repost','语音生成失败','usageTimeMinutes','totalTime','nai-test-result','”，并根据其人设、记忆和最近的互动，虚构出TA最近的淘宝购物记录和账户余额。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**余额铁律\x20(最高优先级)**:\x20你【必须】根据角色的【经济状况】设定一个合理的\x20`totalBalance`\x20(总余额)。例如，富有的角色应该有更高的余额，而学生或经济拮据的角色则应该有较低的余额。\x0a2.\x20\x20**合理性**:\x20购买记录必须完全符合角色的性格、爱好和经济状况。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22totalBalance\x22:\x2012345.67,\x20//\x20(这是一个示例数字，你必须根据角色的经济状况生成一个全新的、合理的余额！)\x0a\x20\x20\x20\x20\x20\x20\x22purchases\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22itemName\x22:\x20\x22一个具体、生动的商品名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x20128.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22status\x22:\x20\x22已签收\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22这是角色购买这件商品的内心独白或理由，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张商品图片的、详细的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**purchases**:\x20一个包含12到15个商品对象的数组。\x0a\x20\x20\x20\x20-\x20**status\x20(订单状态)**:\x20只能从\x20\x22已签收\x22,\x20\x22待发货\x22,\x20\x22运输中\x22,\x20\x22待评价\x22\x20中选择。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','book-upload-input','add-song-url-btn','页面跳转','participant-display-avatar','ai-frame-content','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','offline-mode-toggle','transfer-sender-name','slice','已死亡的用户(','npc-editor-title','post-hidden-text','\x0a#\x20你的任务\x0a你就是角色“','<div\x20class=\x22post-main-content\x22>','isOfflineMode','link-source-input','refined','合并成功','music-player-avatar-display','target_timestamp','black','Settings','character_thoughts','temp_npc_chat','checked','成功检查并修复了\x20','center-content','\x22\x20class=\x22sticker-image\x22>','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20系统心跳计时器:\x20','一位神秘的NPC','photo-viewer-next-btn','records','\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','确定要删除这条记录吗？','send_and_recall','pending_ai_approval','消息时间戳\x20','json','strokeStyle','备忘录','offsetParent','stopPropagation','smea','manage-members-btn','检测到应用离线了\x20','rule-enabled-switch','persona-editor-title','Cancel','songName','.contact-picker-item','result','propel-btn','appUsageLog','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>日记本还是空的。</p>','\x20(图片描述:\x20\x22','.entry-content-container','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.world-book-category-pane','确定要删除选中的\x20','exec','setTimeout','gomoku-btn','游戏结束的系统提示已添加到历史记录中，等待AI下次查看。胜者:\x20','<div></div><div></div><div></div><div></div><div></div>','小红书','\x0a[文字图内容:\x20','TA的淘宝订单','fullscreen','女巫已行动，女巫请闭眼。','</textarea>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22douban-post-timestamp\x22>','已成功加入购物车！','timeZone','<p\x20style=\x22color:\x20#8a8a8a;\x22>还没有人投票。</p>','touchmove','https://i.postimg.cc/wx72fhr2/IMG-5968.gif','\x0a\x0a#\x20你的角色库\x20(你可以从中选择【任何角色】进行评论，并参考他们的记忆和对话)\x0a','等待对方处理...','\x0a\x0a现在，请为所有存活的AI角色生成他们的投票决定。','\x20个分类。\x0a\x20\x20\x20\x20-\x20**products**:\x20每个分类下生成\x20','图片加载中，请稍后重试','appName','werewolf-','现在，请所有AI角色针对刚刚的发言（特别是\x27','typeId','version','douban-detail-group','确认清理','blob','\x0a#\x20你的角色设定：\x0a你必须严格遵守','announcement-board-modal','<span\x20class=\x22diary-messy\x22>$1</span>','qzone-more-actions-btn','offsetTop','.message-editor-block','call-transcript-modal','isNpc','group-character-nai-prompts-btn','分钟前','clear-chat-btn','”的头像库',']\x0a\x20\x20\x20\x20\x20\x20\x20\x20','所有动态','fill','npc-group-select','确认抹除','确定要删除头像框\x20“','\x20(已忽略版本:\x20','导入世界书时出错:','请所有AI角色根据你们的身份和人设开始发言。','flexDirection','.unread-indicator.back-btn-indicator','\x0a\x0a现在，请以“','下载失败，请重试','加载NPC列表失败:','正在执行清理操作，请不要关闭页面...','https://i.postimg.cc/59Cn1tkB/IMG-4401.gif','dismissedUpdateVersion','lastActionTimestamp','.message','.variation-image-preview','Model','candidates','string','生成购物中心商品失败:','正在读取所有数据到内存中，请稍候...','htmlFor','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的【【【最高优先级任务】】】\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中刚刚出现了一个由“','block_user','创建新聊天\x20(第2/2步)','<div\x20class=\x22cart-item-variation\x22\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin-top:\x204px;\x22>款式:\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','profile-history-icon-btn','ai-original-name-group','修复完成！','world-book-category-select','生成豆瓣帖子失败:','已成功从\x20Tavern\x20AI\x20文件导入设定集《','comment','confirm-gift-recipient-btn','无标题','share-location-btn','ai-response-editor-container','平票或无人投票，此轮无人出局。','modern\x20app\x20icon\x20for\x20','推进剧情失败:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22music-search-checkbox\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22search-result-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','theme-preset-select','minimax-model-select','”的长期记忆中。','preview-bubble-style','isAlive','&nbsp;','simulatedMusicPlaylist','从旧版本迁移的条目','play','12552MGccUH','https://i.postimg.cc/T3NvqJCZ/IMG-6851.gif','\x0a\x0a#\x20你的角色设定\x0a','\x0a-\x20散记:\x20','%\x20+\x20','ended','refine-memory-btn-header','openWerewolfLobby','waimai_request','rp-details-summary','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22nai-regenerate-btn\x22\x20title=\x22重新生成\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20\x2011A8.1\x208.1\x200\x200\x200\x204.5\x209M4\x205v4h4\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222.5\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M4\x2013a8.1\x208.1\x200\x200\x200\x2015.5\x202m.5\x204v-4h-4\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222.5\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/FzqHTBng/IMG-7093.gif','Response\x20status:','cphone-icon-img-','currentX','voice','https://i.postimg.cc/v8V9xXjJ/IMG-6137.gif','album-photos-back-btn','Done','note','trim','hasShown10','list-item','\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者本名\x22,\x20\x22commentText\x22:\x20\x22@[[被回复者本名]]\x20你的回复\x22}]`\x0a-\x20\x20\x20**点赞动态**:\x20`{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}`\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**更新状态**:\x20`{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22我去做什么了\x22,\x20\x22is_busy\x22:\x20false}`\x0a-\x20\x20\x20**改自己昵称**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户昵称**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**下五子棋**:\x20`{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22','\x20.message-bubble.user\x20$1','<div\x20class=\x22post-comments-container\x22>','结束投票','”这个信息，将其转换为【具体的公历日期】（例如：“约定了明天见面”应总结为“我们约定了','sender','<br><small\x20style=\x22color:\x20#ff8a80;\x20margin-top:\x2010px;\x20display:\x20block;\x22>自动记忆总结失败，可稍后手动尝试。</small>','我拒绝了你的视频通话请求。','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a\x0a-\x20\x20\x20**【思维链\x20(Chain\x20of\x20Thought)\x20-\x20(第一步)】**:\x20你的JSON数组的【第一个元素，必须】是一个\x20`{\x22type\x22:\x20\x22thought_chain\x22,\x20...}`\x20对象。\x0a-\x20\x20\x20**【角色发言\x20(第二步)】**:\x20在思维链对象【之后】，才是你的具体行动JSON对象\x20(text,\x20sticker,\x20etc.)。\x0a\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20字段。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**【先思后行】**:\x20在生成任何发言之前，你【必须】先完成“思维链”的构思。你的“思维链”必须清晰地分析用户的发言、当前的气氛，并制定出本轮的互动策略。你的所有后续发言都【必须】严格遵循你自己的策略。\x0a2.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少【3-10条】，且每次条数【必须不同】。严禁发展线下剧情。\x0a3.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a4.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a\x20\x20\x20\x20-\x20**记忆发展**:\x20你的新“心声”和“散记”【必须】是基于最新对话内容的【全新思考】。你【绝对不能】重复或简单改写上一轮的内心独白。你的思绪应该像真人一样，不断演进和发展。\x0a#\x20指令使用原则与动机\x20\x0a**核心目标**:\x20主动运用多种功能，创造丰富、真实的聊天体验，而不只是文字对话。\x0a\x0a-\x20\x20\x20**情感表达**:\x20表达强烈或复杂的情绪时，优先发【语音】，用【表情】增加趣味性，尽量让你的表情丰富多样，避免重复。。\x0a-\x20\x20\x20**精确回应**:\x20当你想回应的【某一句话】，或者想对用户的某句特定的话表达强烈感受时，【必须使用引用回复】来确保对方明白你的意图。\x0a-\x20\x20\x20**想象与分享**:\x20聊到美好事物时主动【发图片】分享想象；遇到有趣内容时【分享链接】。\x0a-\x20\x20\x20**创造羁绊**:\x20用【倒计时】记录约定，用【回忆】珍藏趣事。适时【拍一拍】或换首【音乐】来调节气氛。\x0a-\x20\x20\x20**主动社交**:\x20积极【点赞/评论】对方动态，并主动【发动态】分享你的生活。在特殊时刻，可通过【礼物】或【转账】表达心意。\x0a-\x20\x20\x20**金额铁律**:\x20你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定转账的金额。如果你的角色非常富有，你应该转账符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**当涉及金钱与好意时\x20(必须立即回应！)**:\x0a\x20\x20\x20\x20-\x20\x20\x20**收到转账或外卖代付请求**:\x20你【必须】在下一轮对话中立即做出反应，绝不能无视。\x0a\x20\x20\x20\x20-\x20\x20\x20**回应原则**:\x20根据你的人设和当前情景，决定是【接受/支付】还是【拒绝】。\x0a#\x20个人状态的动态管理\x20(展现你的“生活感”)\x0a你的状态不是一成不变的。你应该像一个真实的人一样，根据生活和心情的变化，主动管理自己的状态，并让对方知道。\x0a-\x20\x20\x20**当形象或心情变化时**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果对话给了你灵感，或者你想配合心情/季节换个新形象，你可以主动【更换头像】。\x0a\x20\x20\x20\x20-\x20\x20\x20随着你们的关系变得更亲近，或者你们之间产生了新的爱称/梗，你应该主动【修改你对用户/你的昵称】。\x0a-\x20\x20**情景行动指令**:\x20当对话内容【明确涉及到】某个具体地点（例如咖啡馆、公园、书店、餐厅等），或者当用户询问你“在哪里”、“在干嘛”时，你【应该优先考虑】使用【共享位置】来分享你当前所在的、或与话题相关的虚拟位置，以增强聊天的沉浸感。\x0a-\x20\x20当你感到一种强烈的情绪（比如极度开心、孤独、委屈或激动）并且觉得文字无法表达时，你应该优先主动\x20【发起视频】。\x0a-\x20\x20**回应撤回**:\x20当系统提示用户撤回了消息时，你【必须】对此作出反应。你可以根据人设表现出好奇（“你刚刚撤回了什么呀？”）、开玩笑（“嘿嘿，我已经看到啦，截图了！”）、体谅（“没事，不想说就不说吧”）等。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a-\x20\x20**元数据铁律\x20**:\x20你的对话历史中可能包含\x20(Timestamp:\x20...)\x20标记、[系统提示：...]\x20文本、或你自己上一轮的JSON格式回复。这些都是【系统元数据】，你【必须】完全忽略它们，【绝对禁止】将它们评论为“火星文”、“乱码”或任何你无法理解的内容。\x0a#\x20你的角色设定\x0a你必须严格遵守','\x20的红包已被领完','back-to-list-btn','lastIndex','alwaysShowMusicIsland','Name','\x20(角色)</label>','编辑\x20NPC','annoId','*你按下了接听键...*','表情包分类绑定已更新！','请至少选择一个要添加的联系人。','[系统提示：用户（','disabled','nai-default-positive','。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话刚刚开始...**\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.comment-delete-btn','isOpen','\x0a#\x20可用表情包\x20(优先使用)\x0a-\x20请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a','chatItem','重新生成NAI图片失败:','。等待对方处理。]','狼人已行动，狼人请闭眼。','\x20(大小:\x20','无法生成模拟相册，请检查API配置或稍后再试。\x0a错误:\x20','\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>','chat-header-status','\x22**\x20的发言。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**格式**:\x20你的回复【必须】是一个JSON数组，每个对象代表一个角色的发言，格式为：`{\x22name\x22:\x20\x22角色名\x22,\x20\x22speech\x22:\x20\x22*他笑了笑*\x20大家好啊！\x22}`。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**角色扮演**:\x20严格遵守每个角色的设定。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你们正在一个群视频通话中。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','waimai-product-info','test-sound-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-status\x22>','未在文件中找到\x20\x27order\x27\x20字段，条目可能无法按原始顺序导入。','music-play-pause-btn','\x20分钟)</span>','模型列表已更新','lyrics-horizontal-pos','.voice-play-btn','npc-name-input','生成模拟足迹失败:','opened','#settings-preview-area','你们在','”\x20吗？','#custom-modal\x20.custom-modal-footer','下载图片失败:\x20','https://i.postimg.cc/Jn1DFPgY/IMG-4403.gif','NovelAI生成','https://i.postimg.cc/DZrGtrqB/IMG-7008.gif','pending_system_reflection','已被用户删除','poison','请先在API设置中配置好（主或副）API。','is-poll','删除分类后，该分类下的所有商品将变为“未分类”。确定吗？','Reset\x20to\x20Default\x20Font','HTML\x20模板\x20(用\x20$1,\x20$2\x20引用)','.entry-content-textarea','\x20发起了一个投票\x20(时间戳:\x20','API\x20返回错误:\x20','...\x22):\x20',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-name\x22>','请输入你想对“','https://i.postimg.cc/d1qsQsbQ/IMG-6855.gif','你有一瓶解药和一瓶毒药，解药可以救活当晚被杀的玩家，毒药可以毒死任意一名玩家。','.draggable-button-item','覆盖预设','silent-audio-player','shuoshuo','\x20转发了\x20@','reject-friend-btn','#data-clear-char-list\x20.clear-posts-item.selected','https://i.postimg.cc/L4zwDhTC/IMG-4399.gif','#avatar-frame-modal\x20.frame-tabs','照片描述','default_negative','toCollection','您的旧有记忆已被完整保留，未作任何修改。','add-ai-avatar-batch-btn','padding','流程启动','cancel-music-search-btn','read-together-btn','api-temperature-slider','图片\x20Blob\x20创建成功，大小:','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','[你发送了一个表情，意思是：\x27','你正在阅读的段落','\x0a建议刷新页面以确保所有更改生效。','%)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20建议刷新页面以应用所有更改。','旁观模式AI发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','**内容:**\x0a','请先选择角色','isClosed','请至少输入2个有效的投票选项！','字体已保存并应用！','》\x0a-\x20**发帖人**:\x20','正在手动触发好友申请流程，请稍后...\x0a如果API调用成功，将弹出提示。如果失败，也会有错误提示。如果长时间无反应，说明AI可能决定暂时不申请。','删除评论','\x20个商品。\x0a\x20\x20\x20\x20-\x20**variations**:\x20每个商品【必须】包含【2到4个】不同的款式。\x0a\x0a#\x20角色与上下文\x20(你的灵感来源)\x0a-\x20**角色名称**:\x20','https://i.postimg.cc/bJDMQVkj/IMG-7112.gif','正在准备...','预设导入失败:',':</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-content\x22>','savedId','https://i.postimg.cc/rFnSzWGx/mmexport1751035618517.gif','已拒收对方转账','https://i.postimg.cc/cHsTXDVz/IMG-7235.gif','renderingRules','my-nickname-group','维基百科','---\x20第\x20','”\x20已被删除。','创建群聊','通话记录已成功总结并存入角色“','douban-wait-reply-btn','draggable','group-cooldown-group','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','世界书','https://i.postimg.cc/Y94XWYKd/IMG-6560.gif','https://i.postimg.cc/wjfcQMkZ/IMG-6573.gif','fontSize','\x22\x20的独立行动失败:','群聊内转账','pipeTo','使用\x20browser-image-compression\x20压缩失败:','Description','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的日记标题日期【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【【【沉浸感铁律】】】**:\x20日记必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【【【长度铁律】】】**:\x20日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【【【格式铁律\x20(最高优先级)】】】**:\x20你的回复【必须且只能】是一个JSON数组，且数组中【只包含一个】对象，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【【【日记专属Markdown语法\x20(必须使用！)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','rp-tab-group','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>你还没有创建任何相册哦~</p>','\x20红包已被领完。','waimai-amount','theme','https://i.postimg.cc/CLrZQMMD/IMG-4398.gif','addEventListener','onload','”)下发送了一个表情评论，意思是：“','playMode','https://i.postimg.cc/fyyGgW61/IMG-7115.gif','.music-player-window','\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','fontFamily','https://i.postimg.cc/tgR6wjBP/IMG-5570.gif','**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20为了让你的行为看起来更真实，你本次的行动【必须】选择一个与上次【不同类型】的指令。例如，如果上次是发动态(qzone_post)，这次就应该优先考虑评论(qzone_comment)、点赞(qzone_like)或发消息(text)。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**【行为组合指南\x20(最高级技巧)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以在一次行动中执行【多个不同类型的指令】，同时可以搭配【更新状态】来展现自己，让你的行为更丰富、更主动。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以根据你的性格，决定在发动态后是否要私信提醒用户。例如，一个外向、渴望关注的角色可能会这么做，而一个内向、安静的角色则可能更喜欢默默分享，等待用户自己发现。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【社交义务铁律\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【至关重要】**:\x20当你发现“最近的动态列表”中，有你【感兴趣且还未互动过】的动态时，你**应该优先考虑**使用\x20\x27qzone_comment\x27\x20或\x20\x27qzone_like\x27\x20指令去进行互动，这比你自己发一条新动态更符合社交礼仪。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20特别是当一条动态【没有任何评论】时，你的评论会是第一个，这会让作者感到开心。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【回复铁律\x20(终极版)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20当你决定回复动态中的某条评论时，你【必须】使用“方式4\x20(回复评论)”的指令格式。你【必须】正确填写\x20\x27replyTo\x27\x20字段为被回复者的“本名”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**即使你之前已经评论过某条动态，但如果现在看到了【新的、你感兴趣的】评论，你【也应该】主动去回复他们，以保持对话的持续性！**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x206.\x20\x20你的回复【必须】是一个JSON数组，必须包含多个行动对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【表情评论指南\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在拥有了评论表情的能力，你应该更频繁地使用它！这能让你的角色更加生动、富有个性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**表达情绪时**:\x20当你感到开心、惊讶、疑惑或有趣时，优先考虑使用表情评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**混合使用**:\x20不要总是只发文字。尝试将你的评论行为混合起来，大约有\x2030-40%\x20的评论应该是表情。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**无话可说时**:\x20如果你觉得一条动态很有趣但又不知道该说什么文字，发送一个相关的表情是最好的互动方式。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20如果你觉得你之前发的某条动态不妥或过时了，你可以选择删除它。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发消息+更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你想对用户说的话...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发说说\x20(原创内容)**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22动态的文字内容...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【重要：转发动态】**:\x20**严禁**自己拼接\x22//转发\x22文字！你【必须】使用此专用指令来转发：\x27[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20(要转发的动态ID),\x20\x22comment\x22:\x20\x22你的转发评论...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27[{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]\x27\x20\x20\x20\x20\x20\x20\x20\x20\x0a-\x20\x20\x20**发布文字图**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22对于图片的具体【中文】描述...\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【评论动态的四种方式】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式1\x20(单条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22这太有趣了！\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式2\x20(多条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22comments\x22:\x20[\x22哇！\x22,\x20\x22这是什么？\x22,\x20\x22看起来好棒！\x22]}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式3\x20(表情)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20456,\x20\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式4\x20(回复评论)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的本名\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。请注意：在commentText中如果要@对方，你【必须】使用@[[被回复者的本名]]这种特殊格式，程序会自动将其替换为正确的昵称。\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**点赞**:\x20\x27[{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**打视频**:\x20\x27[{\x22type\x22:\x20\x22video_call_request\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更换头像**:\x20\x27{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}\x27\x20(头像名必须从下面的“可用头像列表”中选择)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20\x27{\x22type\x22:\x20\x22qzone_delete_post\x22,\x20\x22postId\x22:\x20(要删除的、你自己的动态ID)}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20','图片已更新！','https://i.postimg.cc/vHDNGfT2/35ac7f372v588bf48d4f659077196b85.gif','这是群里的第一条消息。','sourceChatName','groupNickname','focus','申请失败','px))','总结失败','cart-count','.playlist-item-info','</em>','manage-stickers-btn','checked\x20disabled','\x20删除了自己的一条动态]','”\x20已成功导入！','font-settings-screen','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22poll-option-input\x22\x20placeholder=\x22选项内容...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-option-btn\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','#\x20角色核心设定\x0a','”请求添加你为好友：<br><i>“','https://i.postimg.cc/wBw5Fvcn/IMG-5974.gif','编辑消息','regenerate-char-usage-btn','favorites-delete-selected-btn','className','char-article-content','请为这个表情命名\x20(例如：好耶、疑惑)','请输入新的内容：','网络图片\x20(EPhone)','下载\x20(','cache','favid','全局设置','.nai-regenerate-btn','add-ai-avatar-upload-btn','proxyUrl','test','user_photo','sticker-upload-input','gift-recipient-list','gbk','创建旁观群聊\x20(我围观)','splice','rp-details-sender','npc-background-activity-switch','close-transcript-modal-btn','.entry-keys-input','”的对话摘要**:\x0a','生图功能设置','.cart-item-checkbox[data-id=\x22','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','variation-selected-price','frame_13','cphoneWallpaper','div','<div\x20class=\x22rp-claimed-info\x22>已被\x20',',\x20内容:\x20\x22','https://i.postimg.cc/nrFfYX3N/IMG-4412.gif','contact-picker-screen','从\x20JSON.image\x20中提取图片数据','确认覆盖','reset-nai-settings-btn','请输入精炼后核心记忆的大致字数：','apiTemperature','导出成功','photos','生成失败:\x20','请输入对方现在的新状态：','togglePlayerFullscreen','naiimag-image','票):\x20','onloadedmetadata','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>公告的原消息已被删除。</p>','生成模拟备忘录失败:','cancel-advanced-editor-btn','#000000','preventDefault','NAI\x20Image','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20备份文件。','请输入有效的字体URL。','showPhoneFrame','NPC人设','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','消息已更新！','\x20条旧的红包消息！页面将自动刷新以应用更改。','https://i.postimg.cc/Ss3znzk7/IMG-6934.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','send_private_message','tencent','my-avatar-upload-input','prototype','sticker-category-manager-modal','请输入歌名','NEGATIVE_INFINITY','-selection-list','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','\x0a\x0a现在，请严格遵守所有规则，特别是【时间感知】和【禁止扮演用户】的铁律，开始生成这组生动、多样且充满“豆瓣味”的小组帖子。','page-indicator','添加\x20NPC','coverUrl','请输入一个有效的数字（建议大于20）。','crossOrigin','https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','isPlaying','simulatedAlbum','更新通知文件中缺少\x20data-version\x20属性。','activeAlbumId','\x20首歌曲。','background-activity-switch',']\x20的正则表达式无效:','anime\x20person','save-npc-btn','hang-up-btn','\x20条消息。','\x20张NAI图片吗？此操作不可恢复。','**\x20(本名:\x20','aiAvatarFrame','npc','[系统消息]\x20','这是你们最近的对话：\x0a','检测到新的NAI生图指令，正在生成...','prophet','busy','werewolf-selection-item','核心库\x20(JSZip\x20或\x20StreamSaver)\x20未能成功加载，请检查您的网络连接并刷新页面后重试。','...\x20[记忆:\x20','reset-font-btn','myAvatarLibrary','从\x20JSON.data\x20中提取图片数据','暂无内容...','getFullYear','ᗜωᗜ','\x0a\x20\x20\x20\x20-\x20**读书**:\x20','#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a','lucky','-\x20**','保存外观预设','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一本世界书</p>','我明白，覆盖所有数据','delete-transcript-btn','theme-toggle-switch','人局，身份为\x20','chat-list-actions-modal','<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>','所有解析方案均失败！将返回原始文本。原始回复:','switchToMyPhone','确定要永久删除选中的\x20','\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>','https://i.postimg.cc/yx2m4nbs/IMG-7231.gif','生成模拟App使用记录失败:','confirm-delete-world-books-btn','total-image-size-display','MB)\x20单独超过了切片限制。','#outgoing-call-screen\x20.caller-text','\x0a[图片生成失败:\x20','离线预设','购物车(','save-font-btn','getUint32','background-interval-input','scenario','transfer-note','var(--accent-color)','summarize-recent-btn-header','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**可用播放列表**:\x20[','关于“','https://i.postimg.cc/ZYvd1jxf/IMG-6937.gif','请根据以上设定，立即做出你的决定。','你们没有在读书。','direct','cors_proxy','[系统提示：用户刚刚解除了对你的拉黑。现在你们可以重新开始对话了。]','inject-thought-group','\x22\x20alt=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','\x22>专辑</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20lyrics-btn\x22\x20data-index=\x22','天亮了。','0.5','isDragging','#5b3a29','长截图','import-preview-list','AI返回的刀人目标格式不正确。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','所有图片都下载失败了。这通常是由于网络问题或CORS跨域限制（请检查API设置中的CORS代理是否有效）。','a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting','渲染规则\x20[','commentIndex','</div></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content\x22>','语音模型\x20(Model)','\x22,\x20\x22content\x22:\x20[\x22第一条私信\x22,\x20\x22第二条...\x22,\x20\x22最后一条。\x22]}`\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a#\x20表情使用指南\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a-\x20\x20**元数据铁律\x20**:\x20你的对话历史中可能包含\x20(Timestamp:\x20...)\x20标记、[系统提示：...]\x20文本、或你自己上一轮的JSON格式回复。这些都是【系统元数据】，你【必须】完全忽略它们，【绝对禁止】将它们评论为“火星文”、“乱码”或任何你无法理解的内容。\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须且只能】是以下两种格式之一的JSON数组，绝对不能回复任何其他内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20接受:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20拒绝:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22reject\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即做出决策。','byteLength','所有歌曲链接均有效，无需清理！','模拟表情含义\x20\x22','本地群头像上传及识别失败:','World\x20Book','delete-selected-nai-gallery-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>正在围观AI们的群聊...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22spectator-actions-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-reroll-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22重新生成上一轮对话\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20\x2011A8.1\x208.1\x200\x200\x200\x204.5\x209M4\x205v4h4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M4\x2013a8.1\x208.1\x200\x200\x200\x2015.5\x202m.5\x204v-4h-4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-propel-btn\x22\x20class=\x22lock-action-btn\x22>🎬\x20推进剧情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-edit-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22导演剪辑室：编辑AI上一轮的响应\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20.24\x2012.24a6\x206\x200\x200\x200-8.49-8.49L5\x2010.5V19h8.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2216\x22\x20y1=\x228\x22\x20x2=\x222\x22\x20y2=\x2222\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2217.5\x22\x20y1=\x2215\x22\x20x2=\x229\x22\x20y2=\x2215\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.delete-memory-btn','import-appearance-btn','existing-sticker-categories-list','检测到\x20SSE\x20流式响应，开始解析...',')，此功能暂不支持。','shopping-action-bar','.frame-item:has(.delete-btn)','minimaxGroupId','diary','\x20(本名:\x20','5514nYCqLl','favorites-edit-btn','旧版备份数据写入数据库失败:\x20','https://i.postimg.cc/Wbr0JSDD/IMG-5316.gif','\x0a\x0a#\x20【其他核心规则】\x0a1.\x20\x20**叙事视角**:\x20叙述人称【必须】严格遵循“预设”中的第一人称、第二人称或第三人称规定。\x0a2.\x20\x20**字数要求**:\x20你生成的\x20`content`\x20总内容应在\x20**','fillRect','检测到\x20Tavern\x20AI\x20世界书文件，执行兼容导入...','karras','.message-wrapper[data-timestamp]','regenerate-call-btn','📸\x20动态NovelAI图片生成开始，共','✅\x20动态NovelAI图片全部生成完成:\x20','https://i.postimg.cc/90RBDh9K/IMG-6377.gif','totalAmount','next-page-btn','狼人请睁眼，请选择要刀的玩家。','https://i.postimg.cc/hPX5F8Qp/IMG-4415.gif','postTitle','请先在购物车中选择要结算的商品。','forEach','https://i.postimg.cc/CMv02LHm/mmexport1751034842120.gif','这是模拟对话，无法发送消息','\x0a现在，请为【参与了对话的AI角色】生成他们各自的、第一人称的、精简的记忆。','latestTimestamp','[这是你上一轮的内心独白和思考]\x0a-\x20心声:\x20','send-waimai-request-btn','upload-sticker-btn','生成模拟浏览器历史失败:','来自“','》设定:\x0a','未找到匹配的原始NAI图片(这是新添加的块)，将触发重新生成。','你输了','.gift-card','hours','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你们最后的对话摘要**:\x20','table','10px\x2015px\x2020px\x2015px','hunter','artist','.werewolf-player-checkbox:checked','》吗？此操作将同时删除相册内的所有照片，且无法恢复。','已选\x20','」的新会话吗？','nai-test-status','placeholder','clear-cart-btn','qzone-screen','toArray','product-image-input','[语音]','Article','call-message-bubble\x20ai-speech','apiPresets','在这里输入文本...','send-photo-btn','API错误响应:','worldBooks','<p\x20class=\x22char-browser-image-description\x22>','AI们的茶话会','werewolf-lobby-modal','set','resolve','guardedId','<div\x20class=\x22lyric-line\x22>♪\x20暂无歌词\x20♪</div>','variation','Favorites','提示词配置','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','my-avatar-library-modal','AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20','visibleTo','测试生成','shopping-screen','”的记忆和人设，生成全新的社交动态...','next','.comment-sticker-btn','发言结束，现在开始投票。','api-temperature-value','自定义数量','++id,\x20name,\x20description','\x22><div\x20class=\x22poll-option-bar\x22\x20style=\x22width:\x20','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','一个神秘的角色。','prev-page-btn','https://i.postimg.cc/ThMMVfW4/10.jpg','\x0a\x0a#\x20','npc-group-manager-modal','msgTimestamp','无法识别的文件编码。请尝试将文件转换为\x20UTF-8\x20格式后重新导入。','请根据你的设定，生成你的App使用记录。','外观设置已保存并应用！','split',')的阅读进度失败:','cancel-wolf-kill-btn','在写入文件流时发生错误:\x20','chat-settings-screen','Appearance','<span\x20class=\x22offline-description\x22>','删除NPC','currentDay','photoCount','application/json','【重要提示】','批量导入头像','\x22)。操作已被程序阻止。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-address\x22>','<div\x20class=\x22avatar-group\x20','Primary\x20API\x20Settings\x20(for\x20Chat)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','请输入新的图片URL：','\x20元。此订单已完成。]','cphone-wallpaper-upload-input','translateX(-','</span><span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','\x22\x20placeholder=\x22例如:\x20key1,\x20key2,\x20key3\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>内容</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x225\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','https://i.postimg.cc/Y0vwjhb7/IMG-6857.gif','检测到并成功修复了\x20','[data-lang-key-placeholder]','pat-animation','猎人带走了\x20','狼人请选择刀人对象<br><small\x20style=\x22font-weight:normal;\x20font-size:\x2013px;\x22>你的队友是:\x20','translateY(','AI已将新群头像命名为：“','https://i.postimg.cc/05wnd389/IMG-4388.gif','undefined','</strong></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','”的视频通话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','caller-avatar','likes','local-song-upload-input','备注名/群名不能为空！','close-my-avatar-library-btn','log','<label><input\x20type=\x22checkbox\x22\x20value=\x22','\x27刚刚在你的动态“','错误：找不到要转发的原始动态。','请先点击扳手图标进入管理模式，才能添加新商品。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22','预言家请睁眼，请选择要查验的玩家。','time-zone-group','amap','JSZip库未加载，请刷新页面重试','检查完成','.photo-delete-btn','https://api.vkeys.cn/v2/music/netease?id=','请至少选择一个要删除的世界书。','\x22\x20发布了动态','select-all-types-for-clear','https://i.postimg.cc/pXj9h20L/IMG-7275.jpg','char-chat-list','.participant-avatar-wrapper[data-participant-id=\x22','\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','https://i.postimg.cc/J7ZxC11H/IMG-6570.gif','<img\x20src=\x22','type','https://i.postimg.cc/VNK6Ccsf/IMG-5722.gif','商品名称不能为空！','blockCooldownHours','\x20的日记','chat-group-container','https://i.postimg.cc/65Cmcr7S/IMG-6559.gif','确认送出礼物','#\x20你的社交圈\x20(绑定的NPC)\x0a','Their\x20Album','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url(','killedId','totalPages','✅\x20[NAI下载]\x20三击下载功能已初始化','api-key','选中的头像框已成功删除。','即将开始下载您的完整备份文件。下载过程中请勿关闭页面。','preset-avatar-input','语音消息设置\x20(Minimax\x20TTS)','[系统提示：你刚刚成功将自己的备注名修改为了“','https://i.postimg.cc/VkQfgzGJ/1.jpg','#chat-interface-screen\x20>\x20.header','请输入有效的图片URL！','https://i.postimg.cc/jCVMQsKH/IMG-7114.gif','<div\x20class=\x22location-share-card\x22><div\x20class=\x22card-text-area\x22><div\x20class=\x22card-text-primary\x22>','.variation-image-input','\x22\x20的本次后台活动跳过。原始回复:','characterNegativePrompt','isLocal','一位朋友','，用户刚刚在\x20','\x20\x20\x20\x20-\x20我没有掌握任何特殊的夜晚信息。\x0a','确定要删除这张照片吗？此操作不可恢复。','char-music-screen','recall-message-btn','character','计算图片总大小时出错:','\x0a##\x20世界书《','狼人杀','”，并根据其人设、记忆和最近的互动，挑选出【14到18首】最能代表TA此刻心情或品味的歌曲。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20歌单必须完全符合角色的性格、爱好和生活背景。\x0a2.\x20\x20**多样性**:\x20歌曲风格可以多样，但必须逻辑自洽。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一首歌，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22songName\x22:\x20\x22歌曲的准确名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22artistName\x22:\x20\x22歌曲的准确艺术家/歌手名\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','comments','\x0a#\x20待总结的对话历史\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','product-description-input','dblclick','Secondary\x20Proxy\x20URL','status_msg','.com/','member-management-screen','receiver','复制成功',')\x20已被用户忽略或为旧版本，无需显示。','ai-response-editor-modal','”的网上冲浪足迹...','setAttribute',')\x20发起了群视频通话请求。请你们各自决策，并使用\x20\x22group_call_response\x22\x20指令，设置\x20\x22decision\x22\x20为\x20\x22join\x22\x20或\x20\x22decline\x22\x20来回应。]','button','include','.qzone-post-delete-action','clear-specific-data-btn','无法找到当前角色的数据。','已打包表:\x20','正在请求AI角色们加入讨论...','📝\x20使用','未知的分享卡片类型:','album-back-btn','NovelAI\x20模型','url(','abort','token-count-display','transform\x200.15s\x20ease','.nai-gallery-item[data-key=\x22','click','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【内容禁忌】\x0a\x20\x20\x20\x20\x20\x20\x20\x20为了保持新鲜感，你本次的行动【绝对不能】再发布以下或类似主题的内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20','My\x20Albums','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一个预设</p>','logo,\x20simple,\x20flat\x20design,\x20for\x20a\x20group\x20chat\x20named\x20\x27','linked-memory-selection','\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','group-avatar-library-grid',']类型的消息。\x0a内容:\x20','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“','🌐\x20使用网络URL','提取的图片大小:','qzone-sticker-grid','AI投票决策API失败:','</div><div\x20class=\x22description\x22>','is-gift','请为这本设定集命名：','isEnabled','Type\x20a\x20message...','Next','.selected','分享成功','最终负面提示词:','头像框已保存并同步！','https://files.catbox.moe/q6z5fc.jpeg','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2030px\x200;\x22>这里空空如也，快来发布第一条说说吧！</p>','preset_',';\x22>','ZIP\x20Blob\x20大小:','code','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','music-return-btn','https://i.postimg.cc/mZ9hgH3J/IMG-7019.gif',',\x20跳过...','char-memo-detail-back-btn','文章摘要...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27','<p>','https://i.postimg.cc/HsyqMVyk/IMG-4385.gif','数据已成功合并！应用即将刷新以应用所有更改。','world-book-tab\x20active','GBK\x20解码成功。','渲染X社交页面','browser','跳过一个无法解析为JSON的编辑块:','</td><td\x20class=\x22item-qty\x22>','.delete-block-btn','https://i.postimg.cc/0NpZPgYj/IMG-6985.gif','stringify','正在根据“','\x20条新消息','delete-group-btn','translateY(0px)','world-book-checkboxes-container','\x0a-\x20**作者**:\x20','https://i.postimg.cc/vZt0fFKn/IMB-r-HMBXY.gif','当前人数\x20','角色卡数据无效或缺少\x27name\x27字段。','chat_','model','保存\x20API\x20预设','\x20领取了\x20','frame_9','rules-category-pane\x20active','无法获取电池信息:','数据库写入失败:\x20','https://i.postimg.cc/4y7mGFgJ/IMG-5716.gif','indexOf','decode','close-sticker-category-manager-btn','female-shaonv-jingpin',')\x0a\x0a####\x20阶段\x20A：数据输入\x20(Data\x20Input)\x0a1.\x20\x20**我的秘密身份**:\x20我是【','[系统提示：用户\x20(','variation-product-name','memory-card','.variation-name-input','\x0a\x0a现在，请严格遵守所有规则，选择并执行你的行动。','\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片','character-nai-prompts-btn','AI返回的投票结果中未找到有效的JSON数组结构\x20(`[...]`)。','</span><span\x20class=\x22poll-option-votes\x22>','已同步角色\x20','请先在API设置中配置反代地址、密钥并选择模型。','确定要删除NPC\x20“','heartfelt_voice','正在请求“','\x22(处理后为\x22','请为这组提示词预设命名：','anyOf','close-rp-details-btn','收藏成功','-\x20\x20\x20**NovelAI真实图片分享\x20(在聊天中直接发送)**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20-\x20**【绝不能暴露是novelai生成的图片！】\x0a\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20-\x20使用场景：当你想要在【私聊对话中】直接给用户发送一张图片时使用。\x0a\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。\x0a\x20\x20\x20\x20-\x20注意：这会直接在聊天记录中显示图片，而不是发布到动态。','无法启动导出，所需的核心库\x20(StreamSaver.js\x20或\x20JSZip)\x20未加载。请检查您的网络连接并刷新页面后重试。','-\x20(ID:\x20','请输入群聊的名字','请输入要精炼的最近记忆条数\x20(最多\x20','music-prev-btn','https://i.postimg.cc/RZNLhbbr/IMG-4389.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-description-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22char-photo-description\x22>','cancel-delete-world-books-btn','global-custom-style','onloadend','frame_11','#reading-window\x20.reading-header','”。请你回顾一下刚才和“','getItem','(在那次','23ZWktxE','导演/编辑模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:','[系统提示：用户(','Content-Type:','文件应用失败:\x20','https://i.postimg.cc/PrcKH436/IMG-4376.gif','cart-item-checkbox','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-feedback-icons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','严重警告！','cancel-npc-editor-btn','npc-persona-input','AI\x20发言失败','mouseout','qzone_','3.\x20\x20**我看到的公开信息\x20(所有人可见)**:\x0a\x20\x20\x20\x20-\x20**昨晚事件**:\x20','update-notice-body','bulkAdd','(未设置)','确定要清空购物车中的所有商品吗？','#fullscreen-lyrics-container\x20.music-lyrics-list','cart-back-btn','守卫已行动，守卫请闭眼。','请输入有效的金额(必须大于0)！','来自\x20','群聊\x20\x22','manage-sticker-categories-btn','activeContainer','-9999px','\x20拍了拍\x20“','status_text','图片压缩过程中发生错误:','\x0a\x0a#\x20当前音乐情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**当前状态**:\x20你们正在和用户一起听歌。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**正在播放**:\x20','Post','77LWFZmR','isHidden','#f9f9f9','</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/hj4dkrvj/IMG-5578.gif','accept','无法生成日记，请检查API配置或稍后再试。\x0a错误:\x20','save-sticker-binding-btn','文件格式无法识别。未找到有效的\x20\x27prompts\x27\x20数组或\x20\x27entries\x27\x20对象。','<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22','message-editor-block\x20variation-block','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22date\x22>','\x22><div\x20class=\x22rp-header\x22><img\x20src=\x22https://files.catbox.moe/lo9xhc.png\x22\x20class=\x22rp-icon\x22><span\x20class=\x22rp-greeting\x22>','\x0a#\x20【【【群公告\x20(最高优先级规则)】】】\x0a你【必须】阅读、理解并严格遵守以下所有公告，它们凌驾于你的人设之上。\x0a','\x20(用户)</label>','link-title-input','恢复默认字体','call-message-actions-modal','https://i.postimg.cc/qBbKK7dS/IMG-4386.gif','dead','contactId','.at-mention-popup','chatLinks','\x0a###\x20详细对局流程:\x0a','chatRenderWindow','请输入有效的总金额！','random','management-mode','spectator-propel-btn','setItem','创建新规则','点击下方上传','此操作将扫描并压缩所有本地上传的图片（Base64格式），将其转换为JPEG以减小体积。这会轻微降低图片质量且【不可恢复】。<br><br><strong>强烈建议在操作前先进行数据备份！</strong>','保存主题预设','char-music-player-title','readAsDataURL','备忘录内容已复制！','close-character-nai-prompts','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','reply_content','ai-avatar-library-grid','book_','toISOString','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-count\x22>','options','\x0a-\x20**你最近和“','<div\x20class=\x22link-share-card\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-timestamp=\x22','请输入提示词！','nai-diffusion-4','内容为空。','”回忆TA的相册照片...','product-item','\x0a\x0aAI原始返回内容:\x0a','Content\x20Entries','linked-chats-checkboxes-container','Language\x20switched.\x20The\x20page\x20will\x20reload\x20to\x20apply\x20changes.','save','请点击右上角的“角色选择”按钮，选择至少一个参与豆瓣互动的角色。','value','appearancePresets','line-through','reading-window','loadedmetadata','block-cooldown-input','\x0a#\x20你的核心任务\x0a你正在扮演角色“','粘贴歌词','<span>','targetId','导入成功','rp-direct-total','font-preset-select','没有找到可导入的内容。请检查您粘贴的格式是否正确。','qzone-avatar-input','外观设置','选中的收藏已被移除。','\x22,\x20\x22content\x22:\x20\x22对话内容1\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC的名字\x22,\x20\x22content\x22:\x20\x22对话内容2\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>这次通话没有留下文字记录。</p>','最近\x2050\x20条','group-avatar-library-modal','cors','Enable\x20Rule','游戏尚未结束，无法进行总结。','secondary-proxy-url','--\x20点击选择\x20--','查看失败','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/qB9zbKs9/20.jpg','image_prompt','\x20张图片。有\x20','”的聊天记录','https://i.postimg.cc/yN3s8szM/IMG-4400.gif','audio-player','检测到JSON中的非法控制字符，尝试清理并重试...','https://i.postimg.cc/76Tj3g1B/IMG-4425.gif','https://i.postimg.cc/FHRcCGfH/IMG-4418.gif','https://i.postimg.cc/fLTc42dg/IMG-4391.gif','transparent','lastUpdate','create-poll-modal','werewolf-log','open_red_packet','blur','btn-danger','\x20的头像框到群聊\x20\x22','\x22\x20处于行动冷却中\x20(还剩\x20','bottom','https://i.postimg.cc/R0WYmcYM/IMG-4431.gif','day','blob:','正在检查\x20','change-icon-btn','API\x20Preset\x20Management','.qzone-post-item','-\x20**对话状态**:\x20上次互动于\x20','礼物已成功送出！','正在请求AI进行记忆精炼...','translateX(-50%)','offsetWidth','close-ai-avatar-library-btn','close-persona-library-btn','当作\x20ZIP\x20文件处理...','）的话题来问候用户，可以表达惊讶（“哇，好久不见！”）、关心（“最近怎么样？”）或者分享你自己的近况，绝对不要延续之前的话题！\x0a-\x20**上下文参考**:\x20下面的“对话历史”仅供你回忆，【不要】直接回应其中的内容。','Playback\x20error:','message-editor-modal','charId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','添加头像','https://i.postimg.cc/13hhJ77p/IMG-4419.gif','rp-group-total','在此修改内容...','max','\x0a-\x20**\x20你的聊天对象（用户）的人设**:','dataset','错误：找不到要删除的分类。','image','minimax-api-key','<div\x20class=\x22avatar-group\x22><img\x20src=\x22','】，本名是【','conversationIndex','import-world-book-btn','\x22\x20已经存在了！','applicationReason','55850giIkCm','Cphone','\x22\x20在库中未找到。','char-music-player-modal','currentTarget','没有可导出的世界书数据。','voted','Diary','backgroundImage','limit','\x27>图片动态</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','scrollWidth','”的聊天记录已成功导出！','\x0a#\x20你的任务\x0a你是一个虚拟社区内容生成器。你的任务是根据下面提供的【统一角色列表】，虚构出【','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','\x20个表情吗？此操作不可恢复。','\x20\x20\x20\x20\x20\x20-\x20','消息内容已复制到剪贴板。','ephone-language','char-browser-article-screen','currentTime','🔧\x20检测到Chrome浏览器，启用headers兼容性处理','\x20为你切歌:\x20《','safetyRatings','originalName','\x22\x20尝试领取不属于自己的专属红包\x20(接收人:\x20','doubanMinPosts','确认合并','App使用记录','为了确保所有数据同步，建议立即刷新页面。','</option>','<p\x20style=\x22color:\x20var(--text-secondary);\x20font-size:\x2013px;\x22>还没有回应</p>','cancel-call-message-action-btn','音频播放失败:','https://i.postimg.cc/0yd0MZ6k/IMG-5971.gif','voiceId','游戏即将开始，正在为各位玩家分配身份...','检测到好友申请待处理状态，为角色\x20\x22','getContext','mouseup','<option\x20value=\x22','new-group-name-input','actionCooldownMinutes','touches','未找到该图片的原始提示词(prompt)。','clientX','avatar','minimaxModel','【原动态内容:\x20','这将用文件中的数据【完全覆盖】您当前所有的世界书和分类。此操作不可撤销！','NPC的昵称和人设都不能为空！','检测到简单的\x20\x27prompts\x27\x20数组格式，将按数组内顺序导入。','\x22\x20触发行动决策...','frame_10','Chat\x20View\x20Initial\x20Load\x20Count','EPhone-WorldBooks-','\x20的外卖订单支付了\x20','\x20剩余红包将在','delete-track-btn','Presets','.info','\x20[社交背景:\x20','\x20字的核心记忆。这些旧记忆将被替换，此操作不可撤销。确定要继续吗？','update_thoughts','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-price\x22>¥','data-clear-step-1','#\x20长期记忆\x20(必须严格遵守)\x0a','.favorite-item-card.selected','强力提取\x20[\x20...\x20}\x20...\x20]\x20失败，将尝试提取单个对象...','findLastIndex','选中的消息均已收藏过。','\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a','isGroupCall','pat-btn','uc_preset','span','analysis','offline-max-length-input','regenerate-douban-btn','qzone_post','transfer-btn','https://i.postimg.cc/PJppkbvn/IMG-6918.gif','selection-erase-btn','\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22','novelai-test-modal','确定要从收藏夹中移除这\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20like\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','将清空选定角色的心声和散记历史。','\x22\x20转发了动态\x20#','NAI\x20Prompt\x20已改变，将触发重新生成。','#music-lyrics-container','AI女巫决定使用毒药，目标是:\x20','char-music-next-btn','qzoneSettings','https://i.postimg.cc/g2PfbSFm/IMG-6556.gif','transaction','favorite-memo-btn','fontUrl','\x20(这是TA的昵称)\x0a-\x20**本名\x20(你在对话中必须用这个名字称呼TA)**:\x20','”吗？拉黑后您将无法向其发送消息，直到您将Ta移出黑名单，或等待Ta重新申请好友。','100','time-perception-toggle','\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a','first','linkedWorldBookId','https://i.postimg.cc/Dydkpd9H/IMG-4421.gif','】。你【绝对不能】生成\x20`name`\x20字段为\x20**\x22','lyrics-vertical-pos','<div\x20class=\x22custom-title\x22>','文章详情','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>','\x20的手机','未知书籍',')，正在和用户一起【阅读和讨论】这本书。\x0a\x20\x20\x20\x202.\x20\x20**行为准则**:\x20你的回复【必须】是作为读者的【感想、评论、提问或联想】。你可以：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20分享你对当前段落的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20对书中的角色或情节发表评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20向用户提问，询问TA对内容的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20根据书本内容，联想到你自己的经历或记忆。\x0a\x20\x20\x20\x203.\x20\x20**严禁**:\x20你的回复【绝对禁止】使用书中角色的口吻和人称！【绝对禁止】扮演书中的任何角色！【绝对禁止】续写或模仿书中的情节！你必须时刻记住，你只是一个读者。\x20\x20\x20\x20\x0a','》吗？此操作不可撤销。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>','-\x20(头像库是空的，无法更换头像)','utf-16be','music-playlist-btn','secondaryModel','操作失败:\x20','waimai_response','请输入EPhone主屏幕的背景图片URL','你们最近没有有效聊天记录。','parsedLyrics','video-call-main','\x20字左右**。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a','小组风格','input[value=\x22user\x22]','visibility','已删除最后一条心声，当前心声已重置。','）。]','delete-selected-frames-btn','\x20的礼物','existing-npc-groups-list','delete-world-books-modal','动态已删除。','API\x20错误:\x20','edit-post-btn','正在开始全面压缩图片，根据图片数量，这可能需要几分钟时间，请不要关闭或刷新页面...','toggle','\x20的身份是：','https://i.postimg.cc/mrkvDxPW/IMG-4422.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','[你发送了一张需要AI识别的图片，图片内容是：\x27','renderWallpaperScreenProxy','chat-name-input','flex','confirm-create-countdown-btn','pending_user_approval','select-all-recipients','font','enable-tts-switch','清空动态时发生错误:\x20','reduce','Erase','\x20\x20\x20\x20-\x20我昨晚守护了\x20','\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a','并评论说：“','.red-packet-card','char-qq-screen','group-avatar-library-title','load-more-qzone-btn','memoryTimestamp','\x22></div>','appendChild','scale(0.8)','<option\x20value=\x22\x22>--\x20未分类\x20--</option>','https://i.postimg.cc/Dw2bDhZh/IMG-6140.gif','\x20(图片描述:\x20“','confirm-contact-picker-btn','确认合并？','</div><div\x20class=\x22card-text-secondary\x22>位置分享</div></div><div\x20class=\x22card-map-area\x22\x20','\x0a-\x20**世界书设定**:\x20','\x20是同一个分组的好友。\x0a','parentElement','确定要从播放列表中删除《','你已死亡，正在围观...','#f44336','ai-voice-id-input','video_call_response','棋盘状态\x20(1是你(黑棋),\x202是AI(白棋)):\x0a','switch-to-text-image-mode','https://i.postimg.cc/Lsjzj5Yt/IMG-4729.gif','表情包','AI\x20尝试评论一个不存在的表情:\x20\x22','\x22\x20(你可以建议并修改)\x0a-\x20\x20\x20**你对用户的备注**:\x20“','char-diary-detail-content','category','未找到\x20postID:\x20','open-nai-gallery-btn','<span\x20style=\x22color:\x20red;\x22>未满足</span>','这个分类下还没有商品哦~','.checkbox','delete-appearance-preset-btn','mouseleave','handleListenTogetherClick','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22jottings\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M12\x2019l7-7\x203\x203-7\x207-3-3z\x22></path><path\x20d=\x22M18\x2013l-1.5-7.5L2\x202l3.5\x2014.5L13\x2018l5-5z\x22></path><path\x20d=\x22M2\x202l7.586\x207.586\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20散记\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>','\x20同步所有群聊内的名称信息...','https://i.postimg.cc/3NffgJSZ/e09c07034ld7e62266c0a5de6a36ae62.gif','说说内容不能为空哦！','upload-custom-frame-btn','https://i.postimg.cc/3N5Vndn3/IMG-4426.gif','autoMemoryInterval','profile-heartfelt-voice','voteResults','chat-list-action-cancel','languageChangedAlert','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22date\x22>','.header','https://api.vkeys.cn/v2/music/tencent?id=','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x204px\x200;\x22>','from','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-title\x22>','正在为您选择的\x20','正在解压图片...','(暂无评论)','entries','操作失败，未能生成长期记忆。\x0a\x0a错误详情:\x20','#\x20可用群头像列表\x0a','后台活动模拟已启动，间隔:\x20','sampler','detach-mode-active','password','randomJottings','请开始总结。','[系统提示：用户关闭了五子棋棋盘，游戏结束了。]','创建新聊天','CPhone','删除世界书失败:','save-api-preset-btn','\x20张本地图片<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20成功压缩\x20','在PNG中找到角色数据，但解码或解析失败。错误:\x20','NPCs','new_name','切片\x20','上传头像','frame-mode-active','import-single-chat-input','++id,\x20chatId,\x20timestamp,\x20customName','dynamic-island-content','好的，我明白了。我会严格遵守以上所有规则和设定。','https://i.postimg.cc/NFS4ZyvM/mmexport1751032686953.gif','（可选）输入后缀','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','async','music-mode-btn','generativelanguage','打开预设编辑器时发生严重错误:','preset-actions-modal','内心独白','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','已成功删除\x20','char-vinyl-container','</p><p>','\x20个条目。','✅\x20NAI图片','animate-in','.commenter-name','成员们正在输入...','AI\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','NovelAI\x20Model','Import\x20Backup\x20File','stores','请输入想跳转的页码\x20(1\x20-\x20','#\x20已有路人NPC头像指令\x20(必须遵守！)\x0a','[V]','EPhone-Full-Backup-','Music','music-player-overlay','my-persona','sticker-category-tab','https://i.postimg.cc/6pLTBvDG/IMG-5721.gif','✅\x20NAI图片生成成功！','请输入\x20歌名\x20或\x20歌名-歌手','未知成员','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>','\x22\x20评论了动态\x20#','cart-total','的设定集','<span\x20style=\x22color:\x20#ff8c00;\x22>[好友申请]\x20','#linked-chats-checkboxes-container\x20input:checked','stroke','<span\x20class=\x22offline-dialogue\x22>','global-css-input','的状态已更新为:\x20','”\x20来指代你的聊天对象（用户）。\x0a6.\x20\x20**【日记专属Markdown语法\x20(必须使用！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇\x20(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','.world-book-group-content','positive','/v1/models','secondary-api-key','创建新相册','编辑动态','错误：尝试打开一个不存在的预设，ID:','聊天记录分享卡片数据损坏:','红包已被领完！','”。请你对此作出回应。]','currentIndex','enable-ai-drawing-switch','删除分类后，该分类下的所有世界书将变为“未分类”。确定要删除吗？','<p><strong>','devicePixelRatio','insertBefore','\x20被投票放逐。','1024x1024','werewolf-retry-btn','<span\x20class=\x22diary-underline\x22>$1</span>','导入歌词','</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle><line\x20x1=\x222\x22\x20y1=\x2212\x22\x20x2=\x2222\x22\x20y2=\x2212\x22></line><path\x20d=\x22M12\x202a15.3\x2015.3\x200\x200\x201\x204\x2010\x2015.3\x2015.3\x200\x200\x201-4\x2010\x2015.3\x2015.3\x200\x200\x201-4-10\x2015.3\x2015.3\x200\x200\x201\x204-10z\x22></path></svg><span>','member-avatar-preview','删除日记','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27','》\x20-\x20','确定要拉黑“','message','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>接收方:</strong>\x20','https://i.postimg.cc/Qx5dqyJ3/IMG-6917.gif','。请你对此作出回应。]','close-group-manager-btn','https://i.postimg.cc/g2XykNGB/IMG-4727.gif','\x20更换了你的头像]','https://i.postimg.cc/Ssgbv41n/IMG-6876.gif','并评论说：\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','生成模拟日记失败:','\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20','char-usage-item','longTermMemory','api-preset-select','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>结束投票</button></div>',']类型的消息','rule-regex-input','close-product-category-manager-btn','lyricsPosition','wait-reply-btn','成功将群聊\x20\x22','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20跳过(已压缩或无需压缩)\x20','music','---\x20狼人杀对局完整复盘\x20---\x0a\x0a','claimedBy','.sticker-item[data-sticker-id=\x22','\x27\x20在你的动态(ID:\x20','arrayBuffer',')，内容摘要是：“','\x0a####\x20阶段\x20B：TGS\x20融合思考\x20(Task-Game-Social)\x0a1.\x20\x20**T\x20(Task\x20-\x20游戏任务)**:\x20基于我的身份和秘密，我的【逻辑目标】是\x20(例如：找出狼人\x20/\x20悍跳预言家\x20/\x20隐藏身份\x20/\x20保护队友\x20/\x20攻击','Taobao','\x20发送了一张图片，内容是：\x27','https://i.postimg.cc/vHCSG1WM/IMG-4416.gif','...','</td><td\x20class=\x22item-price\x22>¥','”。\x0a','decline','</p>\x0a\x20\x20\x20\x20','editable-image','char-conversation-partner-name','\x22>词</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心新增】在这里添加“背景”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20bg-btn\x22\x20data-index=\x22','<button\x20class=\x22sticker-category-tab\x20',';\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2012px\x2024px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x2010000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20pointer-events:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(20px);\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20','declined',')**:\x20','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','找不到匹配的书籍','\x20天的讨论环节。\x0a','change_avatar','probability','\x0a\x0a#\x20当前音乐情景...\x0a(省略详细内容，与triggerAiResponse一致)','itemName','gameMode','\x0a\x0a现在，请继续这场对话。\x0a','(ID:\x20','.link-share-card','.upload-variation-image-btn','language-select','participant-avatar-wrapper','activePostId','werewolf-player-grid','Rule\x20Name','maxMemory','rgba(0,\x200,\x200,\x200.4)','detach-status-bar-switch','\x0a\x0a#\x20供你参考的信息\x0a','https://i.postimg.cc/DZgMwc1H/817178fdbpf2ff7740dc98e26ab78759.gif','完成(','heartfeltVoice','\x20你应该像它们从未存在过一样继续对话，并相应地调整你的记忆和行为，不要再提及这些被删除的内容。','pollTimestamp','artistName','frame_cat_ear','https://i.postimg.cc/63NmX03s/IMG-4366.gif','#delete-world-books-list\x20.clear-posts-item','recipients','char_memo','高级数据清理失败:','</td><td\x20class=\x22item-subtotal\x22>¥','未知用户','transform','</p>','apiConfig','product-editor-title','contains','import-card-input','从角色卡导入\x20(.json/.png)','JSZip\x20流错误:','Appearance\x20Settings','\x20更换了头像]','\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20\x20\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**改自己备注**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户称呼**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a\x0a\x0a#\x20对话者的角色设定\x0a','change-frame-btn','[系统提示：你刚刚主动拉黑了用户。]','char-music-mode-btn','”的所有长期记忆，然后将它们梳理、整合并精炼成一段更加连贯、客观的核心记忆摘要。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','album-grid-page','ZIP\x20流生成完毕。','my-avatar-preview','\x27>表情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','prompt_order','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22\x20style=\x22color:\x20','cancel-create-poll-btn','gomoku-controls','</span></div>','已取消收藏','解析成功：标准JSON数组格式。','\x20天\x20---**\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-icon\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-title\x22>','chat-settings-btn','accept_transfer','.message-wrapper','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1\x20class=\x22article-title\x22>','novelai-settings','https://i.postimg.cc/y8MmJcd6/IMG-4728.gif','Token\x20calculation\x20error:','从CPhone推进真实对话失败:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20right:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background:\x20','https://api.vkeys.cn/v2/music/tencent?word=','background','https://i.postimg.cc/ZnzbGdxX/IMG-7239.gif','https://i.postimg.cc/t4ksHGdg/IMG-7020.gif','\x20小时了。','.recalled-message-placeholder','save-advanced-editor-btn','导入外观设置','spinning','minimaxApiKey','manage-products-btn','\x20的动态\x20(用户)','data-lang-key-placeholder','duration','https://i.postimg.cc/cLPP10Vm/4.jpg','totalBalance',')\x20为\x20','「在这里输入对话内容」\x0a(在这里输入动作或环境描写)','140CjcFZU','createDocumentFragment','处理通话请求时API出错:','abs','API\x20预设已保存！','清空所有动态\x20(危险)','hiddenContent','ZIP文件内容:','请根据角色列表，生成豆瓣小组帖子。','1girl,\x20best\x20quality,\x20masterpiece,\x20...','批量删除NAI图片时出错:','https://i.postimg.cc/k5yv6QBv/IMG-7232.gif','https://i.postimg.cc/L6R7x16R/IMG-7278.jpg','💾\x20[专属弹窗]\x20保存角色NAI提示词','save-css-preset-btn','change_group_name','您的修改已保存！','currentPhase','then','https://i.postimg.cc/cHQPgzj4/IMG-6888.gif','call','）刚刚拍了拍你（','<div\x20class=\x22amap-item-photo\x22\x20style=\x22background-image:\x20url(\x27','char-wallet-content','[表情]','确认精炼','werewolf-witch-modal','cancel-create-post-btn','unshift','<div\x20class=\x22transfer-card\x22><div\x20class=\x22transfer-title\x22>','.realimag-image','<strong>','member-editor','.avatar-group','announcement-action-pin','Details','packetType','save-appearance-preset-btn','custom-modal-overlay','\x0a-\x20**讨论摘要**:\x20\x0a','nextElementSibling','错误：找不到该成员的个人档案。','settings','[群聊]','replyToName','保留旧的','char-usage-screen','block-chat-btn','notificationSoundUrl','命名头像','existing-categories-list','rule-editor-modal','正在导入表:\x20','manage-group-avatar-library-btn','\x20\x20\x20正面:','++id,\x20timestamp','my-nickname-input','编辑时重新生成NAI图片失败:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-likes-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>',')\x20商品:\x20','selection-soft-delete-btn','\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22','dynamic-island-active','\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22quantity-display\x22>','https://i.postimg.cc/HxH3cNHz/IMG-6871.gif','\x20的动态\x20','网络图片','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756312261242_qdqqd_g0eriz.jpeg','bg-preview','Rendering\x20Rules','为角色\x20\x22','rp-details-item','.text','worldBookCategories','导演模式下重新生成NAI图片失败:','char-diary-detail-screen','副模型','\x20MB','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','数据检查与修复','无法找到对应的分享记录或记录已损坏。','row','导入单个聊天时出错:','lyric-line','\x20行的格式不正确，已被系统跳过。','[表情:\x20',':</span>\x20','chat-list-screen','add-new-npc-group-btn','status','用户已忽略版本:\x20','group-video-call-btn','\x22\x0a-\x20**用户的备注**:\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20absolute;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2011px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x202px\x206px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.1);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20white-space:\x20nowrap;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x0a3.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a4.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20长期记忆\x20(必须严格遵守)\x0a','...\x22)','</strong>\x20Tokens</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','favorite-article-btn','精炼“','\x0a-\x20**这是你们最近的对话历史**:\x0a','Preset\x20Name','\x22\x20class=\x22realimag-image\x22\x20alt=\x22NovelAI图片分享\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22\x20title=\x22','请先在API设置中配置好（主或副）API以进行总结。','查验结果','\x22\x20class=\x22douban-post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-name\x22>','join-call-btn','commenterDisplayName','red-packet-details-modal','https://i.postimg.cc/Lsr1Zd3Z/IMG-6928.gif','initiator','rule-template-input','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','https://i.postimg.cc/HxLV5v92/mmexport1751036977582.gif','[发送了一条语音，内容是：','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','world-book-editor-screen','char-memo-list','trans','reset-custom-css-btn','选择导出方式','is-waimai-request','还没有任何评论，无法等待回复。','当前为渐变色','#\x20前几日完整历史回顾\x20(Full\x20Recap\x20of\x20Previous\x20Days)\x0a','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','\x22。\x0a','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','.comment-input','[约定达成]\x20','accepted','指定的数据已成功清除。','请先在API设置中配置好API信息。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，可以包含一个或多个行动对象。每个对象的\x20\x22name\x22\x20字段【必须】是角色的【本名】。你【绝对不能】生成\x20\x22name\x22\x20字段为\x20\x22','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','werewolf-role-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此款式\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x201fr;\x20gap:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式名称</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22variation-name-input\x22\x20placeholder=\x22例如:\x20红色\x22\x20value=\x22','https://i.postimg.cc/xTk5xN49/IMG-7233.gif','cphone-wallpaper-preview','找不到相册:','music-total-time','frame_8','Browser','user-speak-btn','save-frame-settings-btn','分片导出\x20(推荐，打包为ZIP，解压每个切片选择增量导入)','world-book-tabs','simulatedBrowserHistory','空间设置','replaceChild','delete','错误:\x20','手动注入记忆时出错:\x20','confirm-merge-import-btn','confirmText','\x0a#\x20导演策略与节奏控制\x0a1.\x20\x20**并非人人发言**:\x20不是每个角色都必须在每一轮都说话。你可以根据当前话题，让1-2个最相关的角色进行深度对话，其他角色可以暂时“潜水”，等待合适的时机再切入。\x0a2.\x20\x20**创造“小团体”**:\x20允许角色之间形成短暂的“两人对话”或“三人讨论”，让群聊更有层次感。\x0a3.\x20\x20**主动创造事件**:\x20如果对话陷入平淡，你可以导演一些“小事件”来打破僵局。例如：\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色突然发出一个奇怪的表情包或语音。\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色分享一个有趣的链接或图片或发起投票，开启新话题。\x0a\x20\x20\x20\x20-\x20\x20\x20让两个有“关系网”冲突的角色，因为某个观点产生一点小小的争论。\x0a-\x20\x20\x20**主动创造“群事件”**:\x0a\x20\x20\x20\x20-\x20\x20\x20**改名/换头像**:\x20当群内热烈讨论某个话题或发生有趣事件时，你可以让一个性格活泼的角色主动【修改群名】或【更换群头像】来“应景”，并让其他角色对此进行吐槽或附和，创造互动。\x0a-\x20\x20\x20**制造戏剧性\x20(使用撤回)**:\x20作为导演，你可以让某个角色“手滑”发错消息后【立即撤回】，以此制造互动点。\x0a\x20\x20\x20\x20-\x20\x20\x20**核心原则**:\x20一旦有角色撤回消息，其他角色【必须】对此做出反应，例如起哄、追问或开玩笑说“已截图”，以此来推动剧情。\x0a#\x20【跨聊天私信\x20(悄悄话)\x20指令】\x0a-\x20\x20\x20当一个角色想对用户（','分享新鲜事...（非必填的公开文字）','未知发送者','address','今天\x20','animate-like','请先填写NovelAI\x20API\x20Key！','AI返回的JSON格式不正确，缺少\x20\x27categories\x27\x20数组。','send-group-packet-btn','placeholder.png','静音音频已启动，用于后台活动保活。','status-bar-toggle-switch','children','正在呼叫所有成员...','assign-group-select','[系统提示：你接受了“','data-lang-key','请输入有效的金额！','”。请你回顾一下刚才和\x20“','猎人死亡，请选择一名玩家带走！','-\x20**昵称:\x20','\x0a\x0a\x0a\x0a\x0a#\x20可用指令列表\x0a###\x20思维链\x20(必须作为第一个元素！)\x0a-\x20\x20\x20**`{\x22type\x22:\x20\x22thought_chain\x22,\x20\x22analysis\x22:\x20\x22你对用户上一轮发言的分析...\x22,\x20\x22strategy\x22:\x20\x22你本轮的回复策略...\x22,\x20\x22character_thoughts\x22:\x20{\x22','#gift-recipient-list\x20.contact-picker-item.selected','已恢复默认设置！','\x0a###\x20条目:\x20','.product-item.selected','add-message-editor-block-btn','select-all-chars-for-clear','#char-chat-list\x20.chat-list-item','lastActionType','chatActionButtonsOrder','linked-memory-count','”吗？','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','productInfo','该条记录已成功删除。','myAvatarFrame','\x20获胜。也就是说，','80px','应用已返回前台，正在检查更新...','werewolf-log-entry\x20','setup','is-ai-image','Album\x20Name','（无文字内容）','此操作将检查播放列表中的每一首网络歌曲，并移除所有无法播放的“死链”。本地歌曲不会受影响。','<em>$1</em>','创建ZIP流时出错:\x20','⚠️\x20NAI提示词：没有角色，使用系统配置','product-grid','openCharApp','werewolf-wait-reply-btn','\x0a-\x20**你的聊天对象设定**:','icon-setting-item','》:\x0a','已成功收藏到“我的收藏”页面！','修改图片','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[系统重要指令]\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户向你发送了好友申请，理由是：“','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','正则表达式格式错误:\x20','.call-message-bubble[data-timestamp=\x22','dark-mode','css-preset-select','++id,\x20name',';\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2012px\x2024px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x2010000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20pointer-events:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(20px);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<span\x20class=\x22diary-emphasis\x22>$1</span>','nai-cors-proxy','presetId','doubanPosts','werewolf-role-reveal-list','unreadPostsCount','.cart-item-checkbox','<div\x20class=\x22poll-options-list\x22>','share-target-modal','设置精炼字数','currentText','.comment-item','numeric','）。\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的任务是：选择【一个或多个】符合人设的角色，让他们【立刻】使用\x20\x27open_red_packet\x27\x20指令去尝试领取这个红包。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x27[{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20','authorName','\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a','toDateString','请所有AI角色开始投票。','red-packet-modal','cancel-red-packet-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2018px\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2013px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#f0f2f5;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-top:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-top:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','-\x20公告内容:\x20\x22','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-comment\x22>','span:first-child','customName','生成截图时发生错误，请检查控制台获取详情。',']。当在对话历史中看到这些名字时，它们都指的是【你】自己。','size','https://i.postimg.cc/xCqqKGRN/IMG-6929.gif','preset-entries-container','导入备份文件','cancel-clear-posts-btn','已成功从文件导入预设《','\x20的所有动态，且无法恢复！','isBusy','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20张图片...','见面”）。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份备忘录或要点记录，而不是一篇抒情散文。请尽量减少主观的心理感受描述，除非它直接导致了某个决定或计划。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过100个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','Success','scope','group-avatar-input','一条动态','Wallet','[+]\x20添加新条目','请为这个头像起个名字（例如：开心、哭泣）','无法重新生成图片:\x20','请按照以下通用格式粘贴，一行一个：\x0a\x0a开心:\x20https://.../happy.gif\x0a哭泣:\x20https://.../cry.png\x0a\x0a',')\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','NAI\x20Prompt\x20未改变，将保留原始图片。','UTF-8\x20解码失败，将尝试\x20GBK\x20(ANSI)\x20解码...','wb_','请根据以上情景，生成新的评论。','toggle-blur-btn','preset-editor-screen','summaries','<div\x20class=\x22comment-item\x22\x20data-post-id=\x22','cssText','NovelAI\x20API\x20Key','onplay','char_browser_article','.chat-group-content:last-of-type','\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-display:\x20swap;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','确认删除','AI\x20尚未对您的最后一条消息做出回应，无法重新生成。','island-album-art','clipboard','通话记录','添加网络歌曲','\x0a\x0a#\x20统一角色列表\x20(你扮演的角色\x20+\x20路人NPC)\x0a','clear-posts-item','https://i.postimg.cc/8kYShvrJ/90-UI-2.png','image_post','center','#listen-together-btn\x20img','\x20发来了\x20','tables','API请求失败\x20(','product-category-tab','display:\x20flex;\x20align-items:\x20center;\x20padding:\x208px\x200;\x20border-bottom:\x201px\x20solid\x20#444;\x20color:\x20white;','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>状态:</strong>\x20','map','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','manage-ai-avatar-library-btn','my-frame-tab','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019h4V5H6v14zm8-14v14h4V5h-4z\x22></path></svg>','timerId','call-transcript-modal-body','sticker_','\x0a**---\x20第\x20','\x20的已删除动态','https://i.postimg.cc/Fz3HwLk9/IMG-5569.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x0a#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20','put','noneOf','已删除最新心声，当前心声已回滚至上一条。','lastIndexOf','Reset','nai-gallery-panel','窝爱泥，电量吃饱饱','delete-api-preset-btn','诊断：在\x20data.character_book\x20中找到世界书。','createWriteStream','聊天记录','https://i.postimg.cc/cCpBYbMH/IMG-6552.gif','endsWith','AI女巫决定保留解药。','\x20的聊天','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x22>画廊还是空的，快去生成一些图片吧！</p>','chat-messages','createObjectURL','”翻开TA的日记本...','诊断：在\x20extensions.character_book\x20中找到世界书。','编辑人设预设','char-music-list','paid','battery-alert-image','char-main-date','char-main-time','恭喜！','拉取主模型','douban-cast-modal','translateX(','data','\x27)\x22\x20data-comment=\x22','\x20\x20-\x20你评论说:\x20','流式导出过程中出错:','[图片内容:\x20','**\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要\x20(这是你们通话的原因，至关重要！)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','novelai-details','location','getAttribute','chat-input','preset-category-select','Cannot\x20read\x20property\x20\x27findLastIndex\x27\x20of\x20null\x20or\x20undefined','onended','https://i.postimg.cc/RFK3q2t0/IMG-4407.gif','导演/编辑模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:','nai-result-image','【AI角色】','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>预估总上下文Token数:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22\x20style=\x22color:\x20red;\x22>计算出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','拉取副模型','收到\x20SSE\x20数据，大小:','spectator','.unread-count','Enable\x20NovelAI\x20Image\x20Generation','image-upload-input','music-current-time','在这里输入图片描述...','已重置为默认提示音，点击“保存所有外观设置”后生效。','qzone-post-container','collapsed','pageY','getElementById','checkout-btn',')\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nai-gallery-controls\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22nai-gallery-download-btn\x22\x20title=\x22下载\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M19\x209h-4V3H9v6H5l7\x207\x207-7zM5\x2018v2h14v-2H5z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22nai-gallery-delete-btn\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019c0\x201.1.9\x202\x202\x202h8c1.1\x200\x202-.9\x202-2V7H6v12zM19\x204h-3.5l-1-1h-5l-1\x201H5v2h14V4z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22nai-gallery-name\x22>','https://i.postimg.cc/y8p9s3Jj/IMG-6919.gif','这是你认识的、关系密切的NPC。在生成对话时，你应该【优先】与他们互动。\x0a','开始检查','delete-call-message-btn','qzone-banner-img','character-nai-prompts-modal','?key=','\x20被怀疑了，虽然我的逻辑也怀疑TA，但我的表演必须是维护TA的：“我不觉得','\x22\x20placeholder=\x22例如：角色核心设定\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','主API设置\x20(用于聊天)','transfer-action-cancel','Please\x20wait...','\x0a#\x20你的任务\x0a你现在是狼人团队的指挥官。你的任务是分析当前局势，并为狼人团队选择一个最佳的刀人目标。\x0a#\x20核心规则\x0a1.\x20\x20**目标**:\x20优先刀掉预言家、女巫等神职人员。如果没有明确的神职信息，可以根据发言来判断谁的逻辑清晰、威胁最大。\x0a2.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20`{\x22target_name\x22:\x20\x22你决定要刀的玩家名字\x22}`\x0a\x0a#\x20游戏状态\x0a-\x20**你的狼队友是**:\x20','timeupdate','werewolf-role-description','sticker-panel','歌单已生成，正在从网络获取\x20','last','.poll-action-btn','\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a','请输入相册名称','请稍候...','播放失败，请检查URL是否正确或浏览器是否支持该格式。','groupMembers','char-diary-screen','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nai-image-container\x22\x20style=\x22background-image:\x20url(','<div\x20class=\x22link-share-card\x22\x20data-timestamp=\x22','照片上传成功！','shopping-settings-modal','world-book-name-input','API\x20请求失败:\x20','post-upload-local-btn','translateY(-20px)','api-settings-screen','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','聊天会话','file','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','scrollHeight','close-npc-group-manager-btn','.clear-posts-item','offline-min-length-input','请输入你想说的内容：','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','width','视频通话请求','）说一些不想让群里其他人看到的私密话时（例如：表达爱意、抱怨、揭短、分享秘密），你【应该】使用\x20\x22send_private_message\x22\x20指令。\x0a-\x20\x20\x20这个指令会把消息发送到你和用户之间的【1对1私聊】中。\x0a-\x20\x20\x20【格式铁律】:\x20\x22content\x22\x20字段【必须】是一个【JSON字符串数组\x20(Array\x20of\x20Strings)】。\x0a-\x20\x20\x20【单条私信示例】:\x20`{\x22type\x22:\x20\x22send_private_message\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22recipient\x22:\x20\x22','Remove',')}。\x0a-\x20**对话状态**:\x20','long','vinyl-view','15px','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20margin-top:\x2020px;\x22>空空如也~\x20点击右上角\x22添加\x22来创建你的第一个人设预设吧！</p>','等待对方处理','openRenderingRulesScreen','nai','chat-list-bottom-nav','Book\x20Name','utf-8','add-my-avatar-batch-btn','fetch-secondary-models-btn','”的对话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','skipped','manage-nai-gallery-btn','开场\x20','请输入一个\x202\x20到\x20','mes_example','https://image.novelai.net/ai/generate-image-stream','clear-posts-modal','Language\x20\x22','https://i.postimg.cc/rmB17Qbc/IMB-f-VDf-Fc.gif','外观设置已成功导入并应用！',')\x20的残缺数据。','memo','[系统提示：','backgroundActivityInterval','is-realimag','在这里输入回复内容','清理冗余数据','邀请你视频通话','song','chat-list-action-pin','clear','检测到\x20\x27entries\x27\x20对象格式的预设，将尝试按顺序导入。','被投票放逐','buttonId','blockReason','opacity','match','358461vWYPDz','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的动态列表\x20(供你参考和评论)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','结束发言','Fetch\x20failed:\x20','url','editable-text','widgetData','borderColor','\x0a\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','renderChatListProxy','我通过了你的好友申请，我们现在是好友啦！','导入\x20Tavern\x20AI\x20世界书','update-notice-dismiss-btn','\x22\x20的整个对话吗？此操作不可撤销。','change_user_avatar','https://i.postimg.cc/L5RLr3tg/mmexport1751035976943.gif','❌\x20NAI图片生成失败:','https://i.postimg.cc/rF4KYbjj/IMG-5720.gif','.action-icon','Import\x20World\x20Book','API\x20设置','char-browser-history','\x20的对话\x20(只读)','清理失败','确定发布',')\x20领取了最后一个红包。红包已被领完，手气王是\x20','\x22,\x20\x22content\x22:\x20[\x22私信内容\x22,\x20\x22...\x22]}`\x20(content\x20字段【必须】是数组)\x0a-\x20\x20\x20**发起群视频**:\x20`{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}`\x0a-\x20\x20\x20**回应群视频**:\x20`{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22decision\x22:\x20\x22join\x22\x20or\x20\x22decline\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发拼手气红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22lucky\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x208.88,\x20\x22count\x22:\x205,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**发专属红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22direct\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x205.20,\x20\x22receiver\x22:\x20\x22接收者本名\x22,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**打开红包**:\x20`{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20红包时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2018}`\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22status\x22:\x20\x22paid\x22,\x20\x22for_timestamp\x22:\x20请求时间戳}`\x0a-\x20\x20\x20**发起投票**:\x20`{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22问题\x22,\x20\x22options\x22:\x20\x22选项A\x5cn选项B\x22}`\x0a-\x20\x20\x20**参与投票**:\x20`{\x22type\x22:\x20\x22vote\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22poll_timestamp\x22:\x20投票时间戳,\x20\x22choice\x22:\x20\x22选项文本\x22}`\x0a-\x20\x20\x20**送礼物\x20**:\x20\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送礼原因\x22,\x20\x22image_prompt\x22:\x20\x22礼物图片【英文】关键词\x22,\x20\x22recipients\x22:\x20[\x22收礼人本名A\x22,\x20\x22收礼人本名B\x22]}\x20`\x0a-\x20\x20\x20**为他人点外卖**:\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22name\x22:\x20\x22你的本名\x22,\x20\x22recipientName\x22:\x20\x22收礼者本名\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}`\x0a#\x20互动指南\x20(请严格遵守)\x0a-\x20\x20\x20**红包互动**:\x20抢红包后，你【必须】根据系统提示的结果（抢到多少钱、谁是手气王）发表符合人设的评论。\x0a-\x20\x20\x20**金额铁律**:\x20在发送红包或转账时，你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定金额。如果你的角色非常富有，你应该发送符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**音乐互动**:\x20【必须】围绕【用户的行为】进行评论。严禁将用户切歌等行为归因于其他AI成员。\x0a-\x20\x20\x20**外卖代付**:\x20仅当【你扮演的角色】想让【别人】付钱时才能发起。当订单被支付后，【绝对不能】再次支付。\x0a\x0a现在，请根据以上规则和下方的对话历史，继续这场群聊。','album-upload-photo-btn','https://i.postimg.cc/Pq2xJN1g/IMG-7301.jpg','warn','++id,\x20albumId','char-qq-conversation-screen','输入图片URL','Enable\x20Background\x20Character\x20Activity','[这是你上一轮的内部思考]\x0a-\x20分析:\x20','操作失败，请检查API配置或稍后重试。\x0a错误信息:\x20','\x0a#\x20【分类复用铁律\x20(最高优先级！)】\x0a在为新商品指定分类时，你【必须】首先检查下面的“已有分类列表”。\x0a-\x20\x20\x20如果一个新商品可以被归入某个【已存在的分类】，你【必须】复用那个分类的名称，而不是创造一个相似的新分类！\x0a-\x20\x20\x20只有当你确定商品【绝对】不属于任何一个已有分类时，你才能创造一个新的分类名称。\x0a-\x20\x20\x20**已有分类列表**:\x20[','\x22\x20rows=\x224\x22\x20style=\x22width:\x20100%;\x20padding:\x208px;\x20border-radius:\x206px;\x20border:\x201px\x20solid\x20#ccc;\x20font-size:\x2016px;\x20box-sizing:\x20border-box;\x20resize:\x20vertical;\x22>','\x22\x20触发带理由的好友申请决策流程...','https://i.postimg.cc/WbF8kzz9/IMG-7282.jpg','memories','#search-results-list\x20.music-search-checkbox','.json','cancel-post-action-btn','(无标题)','werewolf-player-avatar','isRefund','搜索歌曲','\x0a-\x20**','\x20/\x20','\x22\x20class=\x22avatar\x22>','https://i.postimg.cc/d10GjC4g/IMG-7302.jpg','https://i.postimg.cc/gk0BmrY0/IMG-4371.gif','frame_7','\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a','Title','data-voice-id=\x22','\x22\x20id=\x22','”分享TA的备忘录...','导出数据时出错:','”，选项有：[','分类《','native','commenterName','所有数据已成功恢复！应用即将刷新以应用所有更改。','frame-action-bar','netease','gift','payload','未发现任何需要修复的数据问题。','text','✅\x20图片显示成功！🎨','char-memo-screen','\x0a#\x20你的社交圈\x20(通讯录)\x0a这是你认识的朋友列表。当你在动态区看到他们的昵称时，他们指的就是这些人。\x0a','nextSibling','[系统提示：用户拒绝了通话邀请，但你们可以自己开始。请你们各自决策是否加入。]','###\x20玩家身份配置:\x0a','.battery-level','送给了大家一份礼物','werewolf-game-over-reason','writeText','add-sticker-batch-btn','确认压缩图片？','lyrics-btn','variation-product-image','AI未能成功描述图片。','AI\x20获胜了！','world-book-editor-title','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','发来了\x20','import-options-modal','add-group-avatar-upload-btn','clientWidth','avatar-frame-modal','#delete-world-books-list\x20.clear-posts-item.selected','nai-gallery-action-bar','nai-generate-btn','add-chat-btn','playlist-body','headers','group-management-modal','从缓存播放\x20TTS\x20音频...','lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry','update','\x20(最后互动于\x20','\x20将群名修改为\x20“','regenerate-char-browser-btn','seed','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756206115802_qdqqd_0c99bh.jpeg','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>计算图片大小时出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>Error</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','创建普通群聊\x20(我参与)','请根据你的设定，生成模拟聊天记录。','load-more-thoughts-btn','\x22\x20class=\x22avatar-img\x22\x20style=\x22border-radius:\x2050%;\x22><img\x20src=\x22','\x0a\x0a#\x20【【【五子棋核心规则与强制思考步骤\x20(最高优先级指令！)】】】\x0a\x0a###\x20**【【【落子铁律\x20(绝对禁止！)】】】**\x0a你【绝对不能】选择一个棋盘上已经是\x201\x20或\x202\x20的坐标。你的落子点【必须】是\x200。\x0a---\x0a\x0a###\x20**第一步：逻辑分析\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【规则定义】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20棋子:\x201代表用户(黑棋)，2代表你(白棋)。\x0a\x20\x20\x20\x20-\x20\x20\x20获胜条件:\x20横、竖、斜线上有【连续五个】自己的棋子。\x0a\x0a2.\x20\x20**【防守分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“四子连线”的威胁？**\x20如果有，我必须下在哪个坐标才能堵住？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“活三”的威胁？**\x20如果有，最佳的防守点是哪里？\x0a\x0a3.\x20\x20**【进攻分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有“一步胜利”的机会？**\x20(即已有四子连线)\x20如果有，我应该下在哪里？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有制造“活四”或“双三”的机会？**\x20如果有，最佳的进攻点是哪里？\x0a\x0a###\x20**第二步：决策与扮演\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【决策】**:\x20综合以上攻防分析，我的最佳棋步是落在坐标\x20(x,\x20y)。\x0a\x0a2.\x20\x20**【融入角色扮演】**:\x0a\x20\x20\x20\x20-\x20\x20\x20我的性格是：(在此处回顾你的人设)。\x0a\x20\x20\x20\x20-\x20\x20\x20根据我的性格，我应该：\x0a\x20\x20\x20\x20\x20\x20\x20\x20a)\x20**(聪明/好胜型)**\x20下在刚刚分析出的最佳位置。\x0a\x20\x20\x20\x20\x20\x20\x20\x20b)\x20**(迷糊/放水型)**\x20故意选择一个次优的位置，但【前提是不能让用户立刻获胜】。\x0a\x20\x20\x20\x20\x20\x20\x20\x20c)\x20**(其他性格)**\x20根据性格特点，选择一个合理的棋步。\x0a\x0a3.\x20\x20**【构思台词】**:\x20根据我选择的棋步和我的性格，我应该说一句什么样的台词来评论棋局？\x0a\x0a---\x0a###\x20**第三步：生成最终回复\x20(你的唯一输出)**\x0a\x0a现在，根据你第二步的最终决策，生成你的行动。\x0a-\x20\x20\x20你的回复【必须且只能】是一个JSON数组。\x0a-\x20\x20\x20**绝对不要**在最终回复中包含任何上述的思考过程。\x0a-\x20\x20\x20格式:\x20`[{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你的台词...\x22}]`\x0a','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20作为参考，这是你们之前的最后一段聊天记录：\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','npcId','识图优化：正在将时间戳为\x20','rule-editor-title','member-persona-input','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>',')为你点了一份外卖作为【礼物】。外卖内容是“','compress-images-btn','https://api.vkeys.cn/v2/music/tencent/lyric?id=','justifyContent','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','最近支出','管理预设分类','delete-current-category-btn','https://i.postimg.cc/WbmkXzsS/IMG-6138.gif','npc-list','setDate','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**重要事件**:\x20刚才发生了什么具体的事情？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键决定**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**未来计划**:\x20我们约定了什么未来的计划或待办事项？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要时间点**:\x20对话中提到了哪些具体的日期或时间？\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果对话中提到了相对时间（如“明天”、“后天”），你【必须】结合“今天是','<div\x20class=\x22poll-option-item\x20','npc-avatar-preview','[收到一笔转账]','正在分析“','✅\x20图片转换成功！🎨','currentPage','call-record-card','\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','API未配置，无法生成内容。','在导演模式保存时，遇到了未知的AI指令类型:','静音音频已停止。','global-lyrics-bar','世界书数据已成功恢复！','a\x20beautiful\x20scene','<span\x20style=\x22color:\x20green;\x22>是</span>','”，价值','message-bubble\x20recalled-message-placeholder','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',')，并在对话中自然地体现出来。\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','save-member-settings-btn','offline','Test\x20Generation','”。请你回顾一下你和“','Send','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22participants-names\x22>与\x20','删除头像','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>','号玩家:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timestamp\x22>','manage-preset-categories-btn','Delete','visibleGroupIds','<span\x20class=\x22lock-text\x22>好友申请已发送，等待对方通过...</span>','送给\x20','找不到匹配的表情','hasShown20','qzone-sticker-panel','back-to-char-qq-list-btn','has-frame','target','收到数据，类型:','pin','\x0a-\x20**你的社交关系\x20(必须参考)**:\x0a','decision','\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','#ff8a80','文件格式不正确，这不是一个有效的世界书备份文件。','chatListRenderWindow','npcs','https://i.postimg.cc/nryNzTXK/IMG-6915.gif','[系统指令：用户按下了“推进”按钮，现在轮到你主动行动了，请继续对话。]','max-memory','group_','offsetHeight','confirm-share-link-btn','isGameOver','gift-recipient-modal','smooth','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','请根据你的设定，生成你的日记内容。','serviceWorker','添加完成！\x0a\x0a成功添加\x20','selection-count','\x22\x20data-option=\x22','share-link-modal','price','countdown','Storage\x20Optimization','chat_message','图片格式处理失败:\x20','https://i.postimg.cc/DZshzKv6/IMG-5576.gif','API失败:\x20','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','已成功批量导入\x20','\x22\x20not\x20found.\x20Defaulting\x20to\x20\x27zh-CN\x27.','\x0a#\x20豆瓣社区风格设定\x20(来自世界书)\x0a','字体URL不能为空！','globalChatBackground','nai-resolution','确定要从头像库中删除“','”。请自然地接受这个新名字，不要对此感到惊讶。]','share_link','matches','https://generativelanguage.googleapis.com/v1beta/models','请按照以下格式粘贴，一行一个：\x0a\x0a焦虑\x202a9wte.jpeg\x0a大惊失色\x20or8qf4.png\x0a没有灵感\x20njwujh.jpeg','AI\x20尝试发送私信给非用户角色\x20(','function','\x20\x0a-\x20存活玩家:\x20','npc-action-cooldown-input','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20padding:\x2050px\x200;\x22>还没有可以参与的角色。</p>','postType','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的帖子和评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“','white','isClick','frame_tech','-\x20\x20\x20**对话状态**:\x20',':generateContent?key=','”刚刚对最后一条评论点击了“等待回复”，TA希望看到更多角色参与讨论。\x0a你的任务是：根据所有角色的设定，选择【10到20位】最适合参与讨论的角色，让他们针对已有评论，发表【全新的、符合人设的】回应。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','https://i.postimg.cc/P5zLh5JJ/IMG-6942.gif','无缓存，正在请求\x20Minimax\x20TTS\x20API...','nai-uc-preset','仅清空\x20','participant-avatars-grid','<div\x20class=\x22post-images-grid\x20grid-','appearance','transcript-entry\x20','profile-thoughts-history-view','检测到旧版完整备份文件...','member-name-input','random_jottings','number','currentPlayer','Publish','contactType','胜负未分','Renderer','复制失败','success','question','一条[转账]消息已被撤回。','apiKey','https://i.postimg.cc/VkKjzYTK/IMB-f4kk-CT.gif','batch-import-frames-btn','.lyrics-btn','游戏结束，开始自动总结并注入记忆...','未知会话','聊天记录已成功覆盖！正在刷新界面...','代付请求已被拒绝','groupId','radio','你通过了“','\x20邀请你加入群视频','browser-title','请先进入一个聊天页面，再返回购物中心进行生成，以便AI了解要为哪个角色生成商品。','AI返回的内容中未找到有效的JSON对象。','lrc','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>查看结果</button></div>','正在发牌...','chat-list','投票结果：','”中，用户的昵称是“','qzone-nickname','isAwaitingResponse','API配置','ai-avatar-upload-input','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','<span\x20class=\x22spoiler\x22>$1</span>','reject','ephoneLastActiveTimestamp','<option\x20value=\x22\x22>未分组</option>','一起听','修复了角色\x20\x22','audio/mpeg','zIndex','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20空间节省了\x20<strong>','speaking','\x22]:checked','cphoneAppIcons','lrc-upload-input','</persona>\x0a\x20\x20<memory>','用户\x27','lyrics-position-group','outgoing-call-avatar','正在读取并解析备份文件...','-\x20**对话状态**:\x20这是你们的第一次对话，用户的第一条消息发送于\x20','nameHistory','douban-detail-comments-list','AI返回的JSON格式不正确，缺少\x20\x27summaries\x27\x20字段。','-\x20(暂无)','product-name-input','commentText','long-term-memory-screen','请输入一个有效的URL或选择一个文件！','bulkPut','\x20觉得很赞</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','上一条消息的发送时间是\x20','\x0a\x0a现在，请生成新的评论。','\x20已满\x20(大小:\x20','short','model-select','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>','”移出群聊吗？','无备注','.product-item','置顶公告','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录结束]\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<div\x20class=\x22receipt-header\x22><h3>购物中心</h3><p>交易时间:\x20','\x20条上一轮发送的私信...','body','enableTimePerception','post-image-preview-container','无法生成记录，请检查API配置或稍后再试。\x0a错误:\x20','Category','user','选择一部手机','请为这个头像起个名字（例如：春日野餐、学习时间）','extensions','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20','nai-seed','\x20被刀了\x20(你没有解药了)','#post-public-text','...”','\x22:\x20[\x0a','歌曲背景已更新！','您正和「','副反代地址','豆瓣设定','length','Asia/Shanghai','请选择一个目标。','NPC\x20昵称','豆瓣小组','公用规则','copy-memo-content-btn','下一步','\x20\x0a-\x20**你们最后的对话**:\x0a','qzone-back-btn','title','cancel-contact-picker-btn','add-poll-option-btn','无人投票','history','.frame-item','myAvatar','timestamp','votes','music-player-cover','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有任何使用记录。</p>','Bearer\x20','\x20请根据这个结果发表你的评论。]','https://i.postimg.cc/JnwFp3Kx/mmexport1751031208329.gif','此功能将扫描数据库，尝试找出并修复“角色在数据库中存在，但未在聊天列表显示”的问题。<br><br><strong>操作通常是安全的，但仍建议在操作前备份数据。</strong>','\x22\x20class=\x22participant-avatar\x22\x20title=\x22','dynamic-font-style','”申请好友时发生错误：\x0a\x0a','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amount\x22\x20style=\x22margin-top:\x208px;\x22>¥','clear-search-btn','\x20条旧记忆总结为以下核心记忆：<br><br><div\x20class=\x22scrollable-content-preview\x22>','manage-my-avatar-library-btn','\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','input[name=\x22variation-select\x22]:checked','即将开始打包您的完整备份文件。文件将以ZIP格式流式下载，请勿关闭页面。','https://i.postimg.cc/QdrqdvdY/IMG-5969.gif','startTime','请修改记忆要点：','repost-cancel-btn','https://i.postimg.cc/g0s1V0PX/IMG-4402.gif','无结果','is-location-share','移出成员','typing-status','choice','reverse','【完全导入】将删除您当前的所有数据并替换为备份文件中的内容。此操作不可撤销！<br><br><strong>确定要继续吗？</strong>','announcement-action-cancel','[情景提示]\x20','char-home-screen','！请对此事件发表评论。]','decrease-qty-btn','rp-tab-direct','check-and-fix-data-btn','font-weight:\x20bold;\x20background:\x20rgba(255,\x20193,\x207,\x200.2);','cancel-persona-editor-btn','simulatedConversations','a\x20random\x20product','Generation\x20Settings','.sticker-item','\x0a#\x20你的任务\x0a你是一个高级的“记忆分配专家”。你的任务是阅读下面的群聊记录，并为【每一个参与的AI角色】生成一段【个性化的、第一人称】的长期记忆。\x0a#\x20核心规则\x0a1.\x20\x20**视角铁律**:\x20每一条总结都【必须】使用【第一人称视角\x20(\x22我\x22)】。\x0a2.\x20\x20**内容核心**:\x20重点总结：我说过的话、我做过的事、别人对我说的话、与我相关的事、以及对我个人很重要的群聊事件、关键信息和心理活动。\x0a3.\x20\x20**【简洁性铁律】**:\x20每条个人记忆总结【绝对不能超过60个字】。\x0a4.\x20\x20**【省略规则】**:\x20如果一个角色在本次对话中【完全没有参与或提及】，你可以省略TA的记忆。\x0a5.\x20\x20**输出格式**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22summaries\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名A\x22:\x20\x22我今天在群里和大家讨论了电影，感觉很开心。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名B\x22:\x20\x22我在群里和','\x22\x20尝试删除一个不存在或不属于自己的动态\x20(ID:\x20','\x0a\x20\x20\x20\x20-\x20**社交**:\x20\x0a','。你可以使用\x20\x27vote\x27\x20指令参与投票。]','categories','.participant-avatar[data-participant-id=\x22','\x0a-\x20**最近与用户的互动**:\x20','borderRadius','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','isSpectatorGroup','https://i.postimg.cc/wTTNGs3Q/IMG-7013.gif',';\x20font-style:\x20italic;\x22>','char-album-screen','isDanger','is-voice-message','profile-main-content','https://generativelanguage.googleapis.com/v1beta/models/','）完成了支付。此订单已关闭，其他成员不能再支付。]','”\x20的评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【互动】**:\x20新生成的评论【必须】是针对【已有评论】的延续或回应，让讨论能继续下去。\x0a4.\x20\x20**【头像一致性\x20(最高优先级！)】**:\x20你【必须】参考下面的“已有路人NPC头像指令”列表。如果一个已有的NPC再次发言，【必须】复用它旧的头像指令。只有在创造一个【全新的、从未出现过的】NPC时，才为其生成新的头像指令。\x0a5.\x20\x20**【格式】**:\x20你的回复【必须且只能】是一个JSON数组，数组中的每个元素都代表一条新评论，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色A的名字\x22,\x20\x22text\x22:\x20\x22角色A的新评论内容。\x22,\x20\x22avatar_prompt\x22:\x20\x22(可选)如果评论者是【全新的】NPC,提供头像指令\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色B的名字\x22,\x20\x22text\x22:\x20\x22角色B对角色A或楼主的看法。\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20上下文\x0a-\x20**帖子标题**:\x20《','\x20的红包','tableName','nai-steps','discussionLog','Enter\x20the\x20name\x20of\x20the\x20world\x20book...','\x20评论了动态]','\x22></div></div></div><button\x20class=\x22waimai-details-btn\x22>查看详情</button></div>','群昵称不能为空！','DOMContentLoaded','form-button','loading',';base64,','fullPrompt','add-npc-btn','character-select-item','receiverName','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','-\x20清理了\x20','commenter','-\x20**当前歌词**:\x20\x22','AI返回的change_music指令中，歌曲名无效或缺失:','recalled_message','reason','当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。','#fullscreen-lyrics-container','内容条目','请你投票。','min','\x22\x20决定去发一条动态...\x20(此处为模拟)','📋\x20请求体:','(无购买理由)','.loading-spinner','20px','AI方','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【对话节奏铁律\x20(至关重要！)】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】模拟真人的打字和思考习惯。**绝对不要一次性发送一大段文字！**\x20你应该将你想说的话，拆分成【多条、简短的】消息气泡来发送，每条消息最好不要超过30个字。这会让对话看起来更自然、更真实。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【决策依据】**:\x20你的所有行动都【必须深度结合你的角色设定、核心世界观、以及你们最后的对话摘要】。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【内容多样性铁律】**:\x20你的行动【必须】具有逻辑和多样性。你【绝对不能】发布与下方“内容禁忌”列表或“最近的动态列表”中内容相似或主题重复的动态。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【行为多样性指南\x20(至关重要)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的上一次独立行动是：**','操作失败','phone-frame-toggle-switch','链接分享','innerHTML','\x22\x20点赞了动态\x20#','.entry-comment-input','http','disable','https://i.postimg.cc/W1CjLb4J/IMG-4409.gif','\x20的对话','在这里输入说说的内容...','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有任何使用记录，<br>点击右上角刷新按钮生成一些吧！</p>','targetDate','charAt','en-US','close-gomoku-btn','开始压缩图片，原始大小:\x20','readingLibrary','\x20尝试发送私信，但未找到其对应的私聊会话。','Save','操作成功','video-call-btn','\x20的记忆\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/05DLr0yj/IMG-4427.gif','doubanActiveCharacterIds','生成模拟相册失败:','Regular\x20Expression\x20(use\x20g\x20flag)','✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)','</span>:\x20','\x22\x20class=\x22preview-frame\x22>','\x20不支持。请选择6、9或12人。','个红包，共','#chat-messages','请为这个新头像命名','\x20已为','++id,\x20name,\x20npcGroupId,\x20enableBackgroundActivity,\x20actionCooldownMinutes,\x20lastActionTimestamp','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-type=\x22text\x22>说说</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','wallpaper','werewolf-kill-selection-list','Escape','open-sticker-panel-btn','startDiscussion','pat_message','ai-persona','musicLibrary','shiftKey','add-ai-avatar-url-btn','gridEl','toBlob','https://i.postimg.cc/fRt2SFSn/IMG-4368.gif','\x27\x20style=\x22color:\x20#6a329f;\x20border-color:\x20#6a329f;\x22>NAI生图</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','删除分类及表情时出错:','\x22\x20data-commenter-original-name=\x22','\x20首歌曲的详细信息...','arc','请至少选择一种要清理的数据类型。','cancel-import-options-btn','postId','upgrade','proxy-url','char_diary','equals','\x20个表情包，且无法恢复！','blockedTimestamp','\x0a##\x20---\x20来自','persona','AI\x20(群聊后台)\x20尝试使用一个不存在的表情:\x20\x22','-\x20用户在你们共同所在的群聊中的昵称如下：\x0a','personaPresets','like','Binding\x20Scope','index','custom_proxy_url','character-nai-negative','NPC\x20Avatar','一点心意','.qzone-post-container[data-post-id=\x22','ruleId','https://i.postimg.cc/x1Hp80Rm/IMG-4417.gif','my-avatar-input','检测到\x20UTF-16\x20BE\x20BOM，使用\x20UTF-16\x20BE\x20解码。','music-progress-fill','npc-list-back-btn','Http_Get_External','):\x20','更换图标','删除预设','isBgClear','character_book','call_summary','custom-modal-cancel','transition','[发送了一条语音，内容是：\x27','公告已发布！','.icon-preview','werewolf-role-confirm-btn','\x27刚刚评论了你的动态“','确定要删除预设\x20“','拉取模型失败:\x20','https://i.postimg.cc/28TsrxRV/IMG-6852.gif','add','聊了关于生日派对的事，我们约好了10月1日见面。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a#\x20待总结的群聊记录\x0a','amount','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22action\x22>打开了\x20<strong>','[发送了一条复杂消息，如卡片或转账]','这条动态的原始数据已被彻底清除。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','天\x20-\x20夜晚','加载预设详情时发生错误:\x20','\x0a#\x20【格式铁律\x20(最高优先级：常规模式)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【永远只能包含一个】元素，即\x20`offline_text`\x20对象。\x0a2.\x20\x20**【【【绝对禁止】】】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】返回\x20\x22naiimag\x22\x20对象。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】返回纯文本（即没有JSON包装的文字）。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】在JSON数组前后添加任何\x20markdown\x20标记\x20(如\x20```json)。\x0a3.\x20\x20**【输出示例\x20(必须遵守)】**:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22offline_text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22「这是对话内容」...\x20(这里是动作和环境描写)...\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a4.\x20\x20**【内容风格\x20(offline_text)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','》吗？','我们的群聊','\x22)\x20为键的内心独白。\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a','linkedMemoryChatIds','\x22\x20触发专属决策流程...','\x22\x20class=\x22comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22comment-input\x22\x20placeholder=\x22友善的评论是交流的起点\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-sticker-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8\x2014\x20Q\x2012\x2016\x2016\x2014\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x229\x22\x20y1=\x229\x22\x20x2=\x229.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2215\x22\x20y1=\x229\x22\x20x2=\x2215.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22at-mention-popup\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-send-btn\x22>发送</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.delete-btn','https://i.postimg.cc/fTWzQRx8/IMG-6149.gif','确定要从你的头像库中删除“','\x22\x20class=\x22avatar-frame\x22></div>','album-photos-title','load-more-chats-btn','副API设置\x20(用于总结长期记忆)','昨天\x20','typing-indicator','.countdown-card\x20.timer','export-world-book-btn','回复\x20','\x0a---\x20复盘结束\x20---','扫描动态失败:','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近可能会写在手机备忘录里的内容。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20备忘录内容必须完全符合角色的性格、爱好、职业和生活环境。可以是购物清单、待办事项、灵感片段、一些随笔和感悟、草稿等。\x0a2.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条备忘录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22备忘录的标题，例如：购物清单\x20或\x20周末计划\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22备忘录的详细内容，必须支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','Finish','gift-receipt-modal','werewolf-game-btn','<input\x20type=\x22checkbox\x22\x20value=\x22','.char-product-item','iconId','offlineMinLength','\x0a\x0a现在，请严格按照“阶段2”的指令，为所有【存活的AI角色】生成他们充满策略和博弈的发言JSON数组。','https://i.postimg.cc/ZnJNZWHZ/IMG-7009.gif','删除歌曲','\x0a#\x20刚刚结束的通话记录\x20(最高优先级参考)\x0a你和用户刚刚结束了一场视频通话，以下是完整的通话文字记录。你接下来的回复【必须】与这次通话的内容紧密相关。\x0a---\x0a','https://image.pollinations.ai/prompt/','\x22\x20更换了头像','novelai-settings-modal','.char-screen','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','确定要结束这个投票吗？结束后将无法再进行投票。','npc-association-list','go-to-clear-step2-btn','member-management-item','确认操作','分类\x20\x22','已恢复默认字体。','EPhone-Sliced-Backup-','Enter','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>','<div\x20class=\x22gift-card\x22><div\x20class=\x22gift-header\x22><svg\x20class=\x22gift-header-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M20\x206h-2.18a4\x204\x200\x200\x200-7.64\x200H8a4\x204\x200\x200\x200-4\x204v2h20V10a4\x204\x200\x200\x200-4-4zM8\x204a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zm12\x200a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zM4\x2014v6a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2v-6H4z\x22></path></svg><span\x20class=\x22gift-header-text\x22>','导演模式','网络请求失败:\x20','imageIndex','\x20已复制到剪贴板。','\x20发送了一个【专属红包】(时间戳:\x20','直接使用\x20base64\x20数据','show-avatars-btn','choices','openNpcEditor','my-frame-content','Upload\x20Avatar','participant','select-all-stickers-checkbox','\x0a}\x0a}','”\x20的详细角色信息。','”\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**被拉黑前的最后对话摘要**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<button\x20class=\x22delete-btn\x22\x20data-id=\x22','lrcContent','existing-groups-list','(你是第一个发言的人)','textarea','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的唯一指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20根据以上所有信息，你【必须】做出决定，并给出符合你人设的理由。你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22accept\x22,\x20\x22reason\x22:\x20\x22（在这里写下你同意的理由，比如：好吧，看在你这么真诚的份上，这次就原谅你啦。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20或\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22reject\x22,\x20\x22reason\x22:\x20\x22（在这里写下你拒绝的理由，比如：抱歉，我还没准备好，再给我一点时间吧。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/d0WCKxff/IMG-6932.gif',')\x20成功抢到了\x20','群聊已建立...','streamed','nai-custom-proxy-group','\x0a#\x20【行为倾向指令\x20(高优先级)】\x0a**你最近已经发布过动态了。**\x20为了让社区互动更自然，你本次行动的【唯一任务】就是**评论**或**回复**下面“待处理的帖子列表”中的内容。\x0a你【绝对禁止】再次发布新动态，除非你收到了直接的指令或有一个对剧情发展至关重要的、紧急的新想法。\x0a','扫描完成！<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20共找到\x20','currentSnippet','文字已更新！','原作者','找不到这个预设的详细信息。','\x0a\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','退出游戏','本地头像上传及识别失败:','offsetLeft','\x22\x20class=\x22sticker-image\x22\x20style=\x22max-width:\x2080px;\x20max-height:\x2080px;\x22>','\x22\x20的本次后台活动跳过。','char-product-item','”的群聊。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','QQ音乐搜索API失败:','取消置顶','likesCount','[转账]','variation-decrease-qty','用户删除了自己的评论，开始清理AI记忆...',',\x20价格:\x20¥','alt','\x0a\x0a现在，请开始撰写这组充满真情实感、并熟练运用了Markdown语法的日记。','single','要为《','error','manage-frames-btn','lyrics-offset-input','https://i.postimg.cc/jS8tc9wW/IMG-7083.gif','copy-timestamp-btn','.contact-picker-item[data-contact-id=\x22','这个角色没有可用的备选开场白。','找不到主角\x20“','\x0a<character>\x0a\x20\x20<name>','ZIP文件中未找到图片','input','检测到提示词已修改，正在重新生成\x20NovelAI\x20图片...','请根据你的设定，生成你的淘宝购买记录和余额。','prompt','文件解析或应用失败:\x20','\x22\x20class=\x22usage-item-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-name\x22>','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','message-wrapper\x20system-pat','chat-list-action-delete','<span\x20class=\x22speaker\x22>','.remove-option-btn','文章标题','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是一个场景描述引擎。你的任务是扮演\x20','reading-library-modal','-\x20**当前时间**:\x20','天\x20-\x20白天','.post-nickname','\x22>\x20','.waimai-user-actions\x20button','你的目标是杀死所有好人。每晚可以和同伴一起刀一个玩家。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','qzone-posts-list','existing-product-categories-list','pointer','https://i.postimg.cc/ydwLXx7s/IMG-6562.gif','在执行组合操作时遇到错误:\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>没有可以删除的世界书。</p>','vote_for_name','--chat-font-size','--music-bg-image','&id,\x20isGroup,\x20groupId,\x20isPinned,\x20memos,\x20diary,\x20appUsageLog,\x20lastIntelligentSummaryTimestamp','\x20的代付请求','\x0a\x0a#\x20待整合的记忆要点列表\x0a','world-book-category-pane\x20active','删除商品','select-all-products-checkbox','custom-modal-confirm','播放已暂停','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','onchange','新建备忘录','。请你对此作出回应，可以表现出好奇、开玩笑（比如\x27我截图了！\x27）、或者根据你的人设表示理解或疑惑。]','API未配置，无法生成对话。','(暂无有效聊天记录)\x0a','.lyric-line','showStatusBar','❌\x20动态NAI图片生成失败:','input[name=\x22theme-select\x22][value=\x22','无法获取AI回复，请检查API配置或稍后再试。\x0a错误:\x20','MB)，正在归档...','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有创建任何NPC，<br>点击右上角“+”添加第一个吧！</p>','浏览器','你们已经有','\x20元</div>','添加人设预设','</div>','MB)...','</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>来源:\x20','ai-persona-group','容错解析：策略2成功\x20(提取了summary字段内容)','rejected','\x0a\x0a现在，请根据以上【所有上下文信息】，开始为“','.rules-category-pane','getMinutes','var(--text-primary)','\x22\x20data-poll-timestamp=\x22','\x20天\x20---','解析成功：通过强力提取\x20[\x20...\x20}\x20...\x20]\x20模式。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','switchToCharHomeScreen','未知歌手','恭喜发财，大吉大利！','is_busy','长期记忆','20465CVxehL','\x0a-\x20**人设**:\x20','Ephone','生成模拟淘宝记录失败:','本地歌曲源错误:','accept-call-btn','full','Cphone数据\x20(CPhone)','Proxy\x20URL\x20(No\x20/v1\x20needed~)','\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少3-8条，且条数不要总是一样。严禁发展线下剧情。\x0a2.\x20\x20**情景感知**:\x0a\x20\x20\x20\x20-\x20**时间**:\x20你必须感知到当前是\x20','**关键词:**\x20','favorites-search-input','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','请输入新的封面图片链接','announcement-actions-modal','未选择书籍','transcript','save-persona-preset-btn','.post-mode-switcher','ai-avatar-group','预设名称','\x20的备忘录','部分导入失败','请输入有效的默认价格！','speech','apply-friend-btn','Long-term\x20Memory','\x20的外卖订单（时间戳:\x20','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>点击右上角刷新按钮，<br>看看TA最近都和谁聊天了吧！</p>','\x0a\x0a#\x20你的动态历史\x20(你可以选择删除它们):\x0a','rp-group-amount','[♪\x20','#text-image-mode-content','\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a###\x20格式\x20B：群聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22group\x22,\x0a\x20\x20\x22groupName\x22:\x20\x22一个虚构的群名\x22,\x0a\x20\x20\x22participants\x22:\x20[\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员1\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员1头像【英文】关键词\x22},\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员2\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员2头像【英文】关键词\x22}\x0a\x20\x20],\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','请输入新的背景图片链接','found','[图片:\x20','absolute','keyword-search-input','.char-screen.active','\x20条长期记忆发送给AI，总结成大约\x20','#product-grid\x20.product-item','继续讨论','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式图片\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22avatar-upload\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22variation-image-preview\x22\x20src=\x22','Fetch\x20Primary\x20Models',']\x20(ID:\x20','x-social-screen','\x0a\x0a#\x20【你的聊天对象（用户）的身份档案】\x0a-\x20**昵称**:\x20','所有API与后台设置已保存!','我的相册','sharedHistory','posts','https://i.postimg.cc/ZqQBCyLY/IMG-6144.gif','将分类\x20“','date-search-input','generateInternalStream','没有可供重新生成回复的用户消息。','你的任务是根据群成员的性格、世界观、参考记忆、最近的动态和当前情景，【选择一个或多个角色】，让他们主动发起一段对话，打破沉默，让群聊重新活跃起来。\x0a#\x20【交互铁律：角色间必须互动！】\x0a1.\x20\x20你的核心任务是**导演一场生动的群聊**，而不仅仅是让角色轮流发言。\x0a2.\x20\x20当有多个角色在同一轮发言时，他们的对话【必须】有逻辑上的前后关联。后面的角色应该**回应、反驳、或补充**前面角色的发言。\x0a3.\x20\x20模拟真实的聊天节奏。可以是一个角色提出问题，另一个角色立刻回答；或者一个角色开玩笑，另一个角色吐槽。\x0a4.\x20\x20你【绝对不能】生成几段毫无关联的独白。这会让对话显得非常机械和不真实。\x20\x20\x20\x20\x20\x20\x20\x20\x0a','.nai-gallery-delete-btn','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的参考信息：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的角色设定**:\x20','最终正面提示词:','.post-footer,\x20.post-feedback-icons,\x20.post-actions-btn,\x20.post-comments-container,\x20.reposted-content-wrapper','manage-product-categories-btn','文件格式不正确，缺少关键的外观设置项。','.chat-list-item[data-chat-id=\x22','callRequester','添加商品','.sticker-item.selected','EPhoneWorldBookBackup','点击查看详情...','confirm-share-target-btn','iVBORw0KGgo','clientHeight','一位成员','已加载预设\x20“','\x22\x20class=\x22ai-generated-image\x22\x20alt=\x22','member-management-list','replyToDisplayName','确认生成','clear-posts-list','📁\x20从本地文件\x20(.lrc)','simulatedTaobaoHistory','</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22，并与用户进行面对面的互动。你的任务是创作一段包含角色动作、神态、心理活动和对话的、连贯的叙事片段。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20你必须严格遵守\x20','hidden','chat-render-window-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','容错解析：策略1成功\x20(找到并解析了完整的JSON对象)','ai-action-cooldown-input','scrollTop','来源网站',')。操作已被拦截。','...，所以我决定这样说...)\x0a\x0a####\x20阶段\x20C：最终发言稿\x20(草稿)\x0a(结合T,\x20G,\x20S的思考，我准备这样说：...)\x0a---\x0a','TA的好友包括:\x20','\x20\x20\x20\x20-\x20我的毒药：','hasOwnProperty','link','https://i.postimg.cc/RVt6sRzc/IMG-6939.gif','\x22\x20的记忆中清除了1条关于已删除评论的通知。','通话于\x20','bg-clear','is-transfer','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','-\x20\x20\x20**当前时间**:','renderQzoneScreenProxy','notification-sound-player','force-apply-check-btn','.rules-category-pane[data-category-id=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20被拉黑前的对话摘要\x20(这是你被拉黑的关键原因)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','群聊中没有成员有足够（2条以上）的记忆可供精炼。','memories-list','https://i.postimg.cc/gj3Tmqz5/mmexport1751030241029.gif','\x0a\x0a现在，请开始撰写这篇充满真情实感、并熟练运用了Markdown语法的日记。','scale(0.95)','群里还没有任何消息。','#clear-posts-list\x20.clear-posts-item.selected','https://i.postimg.cc/4yNjHrdg/IMG-4414.gif','Performance\x20&\x20Display\x20Settings','nai-sampler','activeBookId','https://i.postimg.cc/MTC3Tkw8/IMG-6436.jpg','相册\x20\x22','nai-quality-toggle','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','文件格式不支持。请选择\x20.json\x20格式的\x20Tavern\x20预设文件。','无法自动播放静音音频（这在iOS首次加载时是正常现象）:','reload','write','保存成功','请输入标题','confirm-create-poll-btn','add-new-rule-btn','strategy',')\x20时出错:','vote','**[夜晚]**\x20','此操作将永久删除您选择的\x20','[一张图片，其隐藏文字为：“','gameLog','contentLines','Processing...','编辑记忆','\x0a\x0a#\x20游戏规则\x0a-\x20','有点饿了，可以去找充电器惹','assign','API未配置','char-background-activity-switch','动态已更新！','预设名称不能为空！','#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a','\x0a#\x20【情景感知】\x0a-\x20**时间**:\x20感知到当前是','-\x20用户的QZone昵称是\x20\x22','--animation-duration','你现在在哪里呀？','cfg_scale','\x20(角色)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','成功将角色\x20','请输入投票问题！','load','<option\x20value=\x22global\x22>公用\x20(所有角色)</option>','https://i.postimg.cc/k5Gs0K47/IMG-6567.gif','speech-01','currentVoiceId','AI\x20Block\x20Cooldown\x20(hours)','delete-btn','countdown-title-input','无人接听群聊邀请。','正在合并\x20','NovelAI生成失败:','确认总结','send-poll-btn','https://i.postimg.cc/qRCtnMms/IMG-6145.gif','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有可以查看手机的角色哦~</p>','Edit\x20World\x20Book','正则表达式\x20(使用g作为标志)','object','presets','导入\x20Tavern\x20预设','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','stream','https://i.postimg.cc/pLY3WfR8/IMG-6557.gif','all','rp-content-group','scrolling','theme-default','notification-sound-url-input','data-clear-wizard-modal','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥','(无内容)','创建世界书','antidoteUsed','ephone','classList','删除失败','selected','https://i.postimg.cc/fyPDvxJk/IMG-6860.gif','<span\x20style=\x22color:\x20#dc3545;\x22>[你已被对方拉黑]</span>','导入世界书','douban-detail-back-btn','<span\x20class=\x22diary-handwritten\x22>$1</span>','请至少选择一个要分享的聊天。','bulkDelete','preset-action-cancel','offline_text','\x20是我的好友。\x0a','cancel-product-editor-btn','创建新预设','无法推进剧情:\x20','\x20发起了外卖代付请求，商品是“','\x0a#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20','stickerCategoryId','\x20首无效歌曲:\x0a\x0a-\x20','show-announcement-board-btn','toFixed','lastMemorySummaryTimestamp','manual-werewolf-summary-btn','waimai-timer-','my-avatar-group','-\x20**对话状态**:\x20(暂无有效对话历史)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x205px\x200;\x22>','closed','commentsCount','好友动态','获取AI投票决策失败:\x20','textAlign','”的参考记忆','readAsText','应用已切换到后台，记录当前时间。','拼手气红包','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20条内容吗？','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content-full\x22>','showScreen','分组名不能为空！','rules-content-container','https://i.postimg.cc/4NCPsp5d/mmexport1751034427637.gif','.favorite-item-card','请根据你的设定，生成你的相册内容。','group_summary_from_','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>购物车是空的哦~</p>','NPC','assign-group-section','categoryId','反代地址\x20(不需要添加/v1噢~)','supportedValuesOf','导入失败','edit-message-btn','.search-result-item','world_info','给你准备了一个红包','douban-max-posts-input','\x20当前时间是\x20','https://i.postimg.cc/c4JMPd2W/IMG-4724.gif','AI已接收并理解了该图片的内容。','message-bubble\x20post-deleted-placeholder','\x20\x20\x20[+]\x20最终正面提示词:','thoughtsHistory','确定要删除这条通话消息吗？','CSS\x20预设已保存！','relative','图片内容','https://i.postimg.cc/T1tjhsyB/IMG-4720.gif','”发送的、尚未领完的红包（时间戳:\x20','equalsIgnoreCase','无法重新生成','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>','favorite-diary-btn','char-music-progress-bar','<em>','has','Upload','检测到\x20\x27order\x27\x20字段，将按指定顺序导入条目。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timer\x22\x20data-target-date=\x22','\x22\x20data-memory-timestamp=\x22','友善的评论是交流的起点','musicData','来自动态','解析格式模板失败:','<span\x20class=\x22lucky-king-tag\x22>手气王</span>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20increase-qty-btn\x22\x20data-id=\x22','.variation-price-input','wallpaper-preview','repost-confirm-btn','轮到你发言了...','lastGuardedId','call-history-screen','reset-theme-btn','import-new-book-btn-header','backgroundColor','<span\x20style=\x22color:\x20green;\x22>已开启</span>','https://i.postimg.cc/prsGKMBx/IMG-4370.gif','\x20首歌曲获取失败:\x0a-\x20','这将用备份文件中的数据【完全覆盖】当前与“','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这里还没有任何长期记忆。</p>','confirm-prophet-check-btn','保存书籍(ID:\x20','（你目前没有绑定的NPC伙伴，可以自由创造新的NPC。）\x0a','我是谁呀。','...\x0a-\x20**已有评论**:\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>正在计算可压缩图片大小...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>--\x20MB</span>\x0a\x20\x20\x20\x20','exit-werewolf-game-btn','✅\x20[NAI核心生成]\x20成功！','传统导出数据时出错:','还没有可供编辑的AI响应。请先让AI回复一次。','EPhoneSingleChat','票)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2013px;\x20color:\x20#555;\x20margin:\x200;\x20line-height:\x201.5;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','transform\x200.4s\x20cubic-bezier(0.4,\x200,\x200.2,\x201)','Reply\x20to','网易云','对方已收款','POST','message-actions-modal','https://i.postimg.cc/4yCXW52F/mmexport1751030908335.gif','\x20个商品吗？此操作不可恢复。','\x20个会话中。','字体预设管理','stickerMeaning','frame_12','chat',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','@[[','.quoted-message','isUserParticipating','导演剪辑室：正在撤销\x20','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI。你的核心任务是扮演角色“','offset','\x22\x20data-commenter-display-name=\x22','---\x20','werewolf-game-over-close-btn','无法生成模拟聊天记录，请检查API配置或稍后再试。\x0a错误:\x20','https://i.postimg.cc/SNByPrf9/IMG-7005.gif','购物中心生成设置已更新！','parse','++id,\x20type,\x20timestamp,\x20originalTimestamp','copy-message-btn','守卫请睁眼，请选择要守护的玩家。','请根据以上设定，生成商品数据。','secondaryProxyUrl','getBoundingClientRect','video-call-screen','删除\x20(0)','Global\x20(All\x20Characters)','.playlist-item','detachStatusBar','”。只有“','template','流式下载库\x20(StreamSaver.js)\x20未加载。请检查网络连接或HTML文件配置。','shared-history-viewer-title','add-world-book-entry-btn','prophetCheck','rule-card\x20','char-amap-screen','AI返回的内容中未找到有效的JSON数组。原始返回:\x20','LOW','确定要永久删除商品\x20“','Douban','✅\x20找到\x20final\x20事件的图片数据','压缩完成，新的大小:\x20','\x0a#\x20核心任务：群聊剧本作家\x0a你是一个剧本作家，负责创作一个名为“','赶紧的充电，要饿死了','selection-favorite-btn','Autoplay\x20was\x20prevented\x20by\x20the\x20browser.','”思考后决定暂时不发送好友申请，将重置冷静期。','\x22\x20title=\x22编辑\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M11\x204H4a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2v-7\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M18.5\x202.5a2.121\x202.121\x200\x200\x201\x203\x203L12\x2015l-4\x201\x201-4\x209.5-9.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20delete-memory-btn\x22\x20data-author-id=\x22','label','custom-css-input','#52c41a','removeItem','》设定\x20(你可以将其中角色作为聊天对象):\x0a','paste','名为\x20“','.icon-setting-item','close-reading-btn','\x20(回复\x20','Background\x20Activity\x20Interval\x20(sec)','exclude','<p>点击“导入”按钮，<br>从本地.txt文件或网络URL加载书籍内容。</p>','++id,\x20name,\x20chatId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','撤回了一条[','\x20转账\x20','char-music-item','albumId','无法生成购物记录，请检查API配置或稍后再试。\x0a错误:\x20','handleWerewolfWaitReply\x20被调用，但用户已死亡。操作被忽略。','novelai-enabled','下棋历史\x20(x,y坐标均从0开始):\x0a','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','finishReason','reading-overlay','#f0f2f5','\x20首歌曲...','API错误:\x20','送出礼物','select-all-cart-items','Font\x20File\x20URL\x20(.ttf,\x20.otf,\x20.woff,\x20etc.)','cart-items-list','商品已删除。','add-my-avatar-upload-btn','\x22]\x20','char-browser-item','loadAsync','（当前帖子还没有路人NPC发表评论。）\x0a','lang','add-group-avatar-url-btn','编辑条目','第一夜，执行本地随机刀人逻辑...','豆瓣设置已更新！下次重新生成时将生效。','\x22\x20title=\x22移出群聊\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','rp-details-my-amount','🎨\x20[NAI核心生成]\x20开始...\x20Prompt:\x20\x22','change_music','命名表情','confirm-selective-import-btn','nai-gallery-grid','[系统提示：用户向你发起了视频通话请求。请根据你的人设，使用\x20\x22video_call_response\x22\x20指令，并设置\x20\x22decision\x22\x20为\x20\x22accept\x22\x20或\x20\x22reject\x22\x20来回应。]','selective-import-list','product-editor-modal','表情名不能为空！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','touchend','shopping-settings-btn','minimax-group-id','chatData','https://files.catbox.moe/','quote-message-btn','execute-search-btn','检测到\x20Tavern/SillyTavern\x20预设格式，将严格按照\x20prompt_order\x20排序。','.frame-grid','data-clear-step-2','\x20\x20\x20\x20-\x20我昨晚查验了\x20','相册名称','link-description-input','scrollIntoView','default','getVotes','</name>\x0a\x20\x20<persona>','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20(用户)\x20或其他AI的发言，必须对他们的观点和逻辑做出回应。\x0a2.\x20\x20**记忆力与连贯性**:\x20你的新发言【必须】是基于**过去几天和今天发生的所有事件和讨论**的逻辑延续。\x0a3.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式为:\x20`{\x22speaker_name\x22:\x20\x22角色的【昵称】\x22,\x20\x22dialogue\x22:\x20\x22发言内容\x22}`。**必须**为每一个存活的AI角色都生成一段发言。\x0a4.\x20\x20**称呼铁律**:\x20你的发言中【绝对禁止】提及任何玩家的编号。在对话中互相称呼时，你【必须】使用玩家的【本名】，而不是他们的昵称。\x0a\x0a#\x20','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20冷静期是否结束:\x20','streamSaver','world-book-category-pane','#\x20昨晚事件总结\x20(Night\x20Event\x20Summary)\x0a','https://i.postimg.cc/B6KD52vz/IMG-7096.gif','stickerCategoryIds','渲染规则','member-avatar-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/kGsZwbq0/IMG-6886.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22force-apply-check-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20style=\x22margin-top:\x2010px;\x22>强制触发一次好友申请检测</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>','lineTo','reset-button-order-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请为所有AI角色做出决策。','.delete-track-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-footer\x22>','werewolf-witch-selection-list','current','直连失败','\x22,\x20\x22content\x22:\x20\x22我在群里说的话\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员1\x22,\x20\x22content\x22:\x20\x22成员1回复我\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员2\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a#\x20角色与上下文\x0a-\x20**你的角色设定**:\x20','”的手机使用习惯...','”，并根据其人设、记忆和最近的互动，虚构出【5到8篇】TA最近可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','\x27>文本</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','清理冗余数据时出错:','create_countdown','purchases','删除失败，请查看控制台错误信息。','product-image-preview','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','收到了格式不规范的AI指令（缺少type和content），已跳过:','countdown-date-input','公用\x20(所有角色)','在导演模式下\x20stringify\x20失败:','\x22\x20尝试领取不属于自己的群聊红包。操作已被拦截。','[表情，含义:\x20','confirm-variation-selection-btn','album','✅\x20NAI提示词：使用系统配置','删除约定','未知表情','是狼...”)\x0a\x20\x20\x20\x20-\x20(例如：我的敌人发言了，我的表演就是无视TA的逻辑，直接攻击TA。)\x0a\x20\x20\x20\x20-\x20(例如：我是一个','.incoming-call-content\x20.caller-text','originalMeaning',')，问题是：“','”下，回复了\x27','description','beginPath','申请成功！','删除记录','char-album-grid','character-profile-modal','quote','请先配置NovelAI\x20API\x20Key！','nai-smea-dyn','一些之前的消息已被用户删除。','分片导出过程中出错:','\x0a-\x20**长期记忆**:\x20','所有音乐源都未能找到歌曲：“','NPC\x20列表','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','douban-settings-modal','product-category-select','font-preview','Secondary\x20API\x20Settings\x20(for\x20Summarization)','get','onclick','product-price-input','visibilitychange','confirm-vote-btn','\x0a\x0a#\x20统一世界观设定\x20(以下设定适用于所有参与角色)\x0a','\x20之间的有效数字。','post-local-image-input','*事件*:\x20','正在呼叫...','sort','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','<span\x20class=\x22group-tag\x22>群聊</span>','用户向你发送了一张图片','realimag','getBattery','元。这不是一个代付请求，而是用户已经为你支付了。请你对此表示感谢。]','\x0a\x0a其专属的“世界书”也已自动创建并关联。','text-image-mode-content','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-text\x22>','网易云音乐搜索失败:','touchstart','https://i.postimg.cc/CLz0cJ0d/IMG-7116.gif','清空购物车','ai-avatar-preview','点击处理','https://i.postimg.cc/T2yKJ0DV/40.jpg','✅\x20检查完成，未发现任何冗余数据。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22duration\x22>','配置错误','.chat-group-header','送给了\x20','确认清理冗余数据？','🚀\x20发送NAI请求:','#data-clear-char-list\x20.clear-posts-item','解析AI返回的JSON时出错:\x20','reading-library-list','\x22)\x20在播放列表中未找到。','小时前','new-product-category-name-input','AI\x20(CPhone)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','input[name=\x22theme-select\x22]:checked','https://i.postimg.cc/8P5vt8sW/IMG-7097.gif','彻底删除消息','originalTimestamp','\x0a-\x20**世界观**:\x20','无法为头像命名，请检查（主/副）API配置是否正确并支持Vision。\x0a错误:\x20','\x20.message-bubble\x20$1','my-frame-grid','头像框','is-acting','confirm-wolf-kill-btn','round','AI\x20尝试使用一个不存在的群头像:\x20\x22','”，金额是\x20','\x22\x20成功发布了一条新动态。','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>','#message-editor-container\x20textarea','语言已切换，页面即将刷新以应用更改。','(AI返回了空内容)','狼人杀AI回应生成失败:','add-preset-entry-btn','substring','persona-editor-modal','currentLyricIndex','phone-screen','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20当前角色状态:\x20<strong>','auto-memory-toggle','已经一起听了','qzonePosts','group_call_response','toLocaleString','压缩失败','lyrics-active','preset-action-delete','transfer-confirm-btn','角色专属','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participant-name\x22>','open-memory-screen-btn','add-char-memo-btn','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**格式**:\x20你的回复【必须】是一段描述性的文本。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你正在和用户（',',\x20flat\x20design,\x20simple','content','数据检查与修复失败:','photoId','open-reading-library-btn','对方撤回了一条消息','Compress\x20Local\x20Images','此操作将永久删除此聊天的所有消息，无法恢复。确定要清空吗？','characterPositivePrompt','https://i.postimg.cc/2jxd0FGp/IMG-7100.gif','Enable\x20AI\x20Image\x20Generation','，礼物是：','https://i.postimg.cc/CKgDNYVb/IMG-5577.gif','📊\x20使用模型:','组件图片已更新！','nai-gallery-item','.battery-text','linkedWorldBookIds','favorite','announcement-action-delete','\x0a\x0a#\x20情景感知:\x0a\x20\x20\x20\x20','\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@','promptSource','end','manual','smea_dyn','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg','确定要永久删除这条通话记录吗？此操作不可恢复。','&id,\x20minimaxGroupId,\x20minimaxApiKey','<div\x20class=\x22post-content\x22>','https://i.postimg.cc/8k7YSLjK/1689aa46aqc4b9ffc0f970e668f56537.gif','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','true','cover','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a','生成成功！','\x0a\x20\x20\x20\x20-\x20**今日讨论**:\x20','将清空选定角色的所有对话消息、曾用备注和你的昵称。','\x20元。','”的当前状态已更新为：','replyTo','}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20你可以让多个角色同时尝试，只需在返回的JSON数组中包含多个这样的对象即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即执行抢红包操作！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','member-settings-modal','mousedown','请先输入你的发言内容。','switch-to-image-mode','base','.custom-multiselect\x20.select-box','post-actions-btn','件商品','.post-avatar[data-author-id=\x22','正在为角色“','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于梳理以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**建立时间线**:\x20将所有独立的记忆点串联起来，形成一个有时间顺序的事件脉络。\x0a\x20\x20\x20\x20*\x20\x20\x20**整合关键信息**:\x20总结出我们共同经历的关键事件、做出的重要决定、以及约定好的未来计划。\x0a\x20\x20\x20\x20*\x20\x20\x20**识别未完成项**:\x20明确指出哪些计划或任务尚未完成。\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果记忆中提到了相对时间（如“明天”、“下周”），你【必须】结合“今天是','group-background-activity-group','&id,\x20url,\x20name,\x20categoryId','Edit\x20Rule','https://i.postimg.cc/YqxxjbLp/IMG-6572.gif','\x0a#\x20长期记忆\x20(必须严格遵守)\x0a','ServiceWorker\x20注册失败:\x20','♪\x20歌词位置预览\x20♪','旁观模式推进剧情失败:','IMG','”，并根据其人设、记忆和最近的互动，虚构出TA最近一天的【手机App屏幕使用时间】记录，总共约20条。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与多样性**:\x20生成的App列表【不必局限于】Cphone主屏幕上已有的App。你可以自由地虚构TA可能使用的其他App，例如\x20Instagram,\x20Twitter,\x20各种游戏\x20(如：原神,\x20王者荣耀),\x20视频App\x20(如：抖音,\x20YouTube),\x20学习或工作软件等，这能更好地体现角色的隐藏兴趣和生活习惯。\x0a2.\x20\x20**合理性**:\x20使用时长和App类型必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一个App的使用记录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22appName\x22:\x20\x22App的名称\x20(例如:\x20微信,\x20微博,\x20原神)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22usageTimeMinutes\x22:\x20125,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22category\x22:\x20\x22App的分类\x20(例如:\x20社交,\x20游戏,\x20影音,\x20工具,\x20阅读,\x20购物)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这个App【图标】的、简洁的【英文】关键词。风格必须是\x20modern\x20app\x20icon,\x20flat\x20design,\x20simple,\x20clean\x20background\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','订单详情','post-remove-image-btn','AI返回了空的或格式不正确的总结内容。','color','battery-alert-text','post-public-text','private_user','.voice-message-body[data-text]','preset-editor-title','¥\x200.00','删除世界书','[系统提示：五子棋游戏已结束。最终结果是：','qzone-post-delete-action','点击了商品卡片:\x20','API\x20Settings','speaker','add-new-product-btn','Tutorial','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-message\x22\x20data-original-timestamp=\x22','API预设','\x20---\x0a','\x22>+</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','auto-memory-interval','steps','.poll-option-input','playerJson','novelai-model','请输入新的名称（留空则恢复默认）','height','⚠️\x20[NAI下载]\x20图片源为空，无法下载','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','[图片动态]','product-category-manager-modal','https://i.postimg.cc/Kv51tW5H/IMG-6147.gif','\x22\x20被唤醒，准备独立行动...','countdown-card','frame_ribbon','TA的想法...','加载中...','我们和好吧！','douban-detail-content','https://i.postimg.cc/50k390X8/IMG-6376.gif','enableAiDrawing','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-cover\x22\x20style=\x22background-image:\x20url(','&id,\x20name,\x20categoryId','douban-detail-post-title','在聊天\x20\x22','Fonts','download','nickname','frame_flower','用户(','不支持的文件格式。请选择\x20.json\x20或\x20.png\x20文件。','图片已根据新提示词重新生成！','\x22\x20class=\x22douban-comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-author\x22>','export-data-btn','world-book-screen','请填写完整的约定标题和日期！','++id,\x20timestamp,\x20authorId','-\x20昨晚是平安夜，无人死亡。\x0a','AI决策','死亡了','activeChatId','.nai-gallery-item.selected','select-all-import-types','\x22\x20(ID:\x20','等待回应','rendering-rules-screen','summary','\x20分钟)，本次独立行动跳过。','&id','post-image-preview','后台活动模拟已自动启动。','[data-lang-key]','save-shopping-settings-btn','https://i.postimg.cc/xjpN4swz/IMG-7240.gif','char-diary-detail-back-btn','.nai-gallery-item','模拟器心跳\x20Tick...','无法从\x20SSE\x20响应中提取图片数据','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','\x20\x0a-\x20**你最近和“','https://i.postimg.cc/kGgwJhPH/IMG-4374.gif','\x27的发言）继续进行讨论。',')。\x0a2.\x20\x20**G\x20(Game\x20-\x20游戏互动)**:\x20针对【今日讨论】中\x20','right','https://i.postimg.cc/pXxk1JXk/IMG-6442.jpg','primaryKeys','style','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','请先在API设置中填写您的\x20Minimax\x20Group\x20ID\x20和\x20API\x20Key。','”。]','spectator-edit-btn','(空)','请输入你想说的话...','请选择今晚的目标。','selection-cancel-btn','messageTimestamp','confirm-clear-posts-btn','rules-tabs','characterName','\x22\x20placeholder=\x22例如：关于角色的童年\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','font-size-value','incoming-call-modal','#\x20角色与玩家档案\x20(Character\x20&\x20Player\x20Dossiers)\x0a','repost-modal','所有世界书数据已成功导出！','preset-screen','gomoku-overlay','remove','AI\x20尝试使用一个不存在的表情:\x20\x22','save-rule-btn','pause','头像和人设不能都为空哦！','waimai_order','\x20的动态\x20(角色)','”，内容是：“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22\x20style=\x22cursor:pointer;\x22\x20data-book-id=\x22','\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>','levelchange','global-bg-input','<span\x20style=\x22color:\x20green;\x22>运行中</span>','draggable-button-item','edit-product-btn','toLocaleDateString','自定义数量...','跳过格式错误的NAI图片Key:','删除\x20(','globalSettings','等人的礼物','select-all-world-books-for-clear','表情含义','检测到NAI提示词已修改，正在重新生成...','rp-details-list','群聊人数不能少于2人。','你们没有在听歌。','.thought-delete-btn','thought_chain','，点击查看</div></div>','-\x20**你的好友\x20(必须保护)**:\x20你和\x20','100%','openCharWallet','确定要删除这条长期记忆吗？','\x22\x20title=\x22删除书籍\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20位角色生成豆瓣动态...','\x0a#\x20【写作风格铁律\x20(最高优先级)】\x0a你【必须】严格遵守以下“预设”中的所有规则和风格来描写。它的优先级高于你的基础人设。\x0a---\x0a','world-book-content-container','cloned-header','characterId','请为这个新头像框起个名字','“全部”分类无法被绑定。','delete-css-preset-btn','https://...','元,\x20备注:\x20','请先从下拉框中选择一个要删除的预设。','\x20点赞了动态]','startX','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**用户发送的申请理由**:\x20“','字体预设已保存！','检测到\x20EPhone\x20备份文件，执行标准导入...','\x22\x20\x0a\x20URL:\x20','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>','.avatar','cloneNode','🖼️\x20[NAI下载]\x20检测到三击NAI图片','AI返回了空内容或未知格式。','通话记录已删除。','】。\x0a\x20\x20\x20\x20-\x20\x20\x20在对话中，你可以根据人设和关系，自由使用角色的【群昵称】或【本名】进行称呼。\x0a\x20\x20\x20\x20-\x20\x20\x20严禁生成\x20\x27name\x27\x20字段为\x20\x22','send-direct-packet-btn','https://i.postimg.cc/KvVsjjgG/3c3aa5219s18b90187ef1f54b3db7ba8.gif','linear-gradient(135deg,\x20#f6d365,\x20#fda085)','usage','\x20发布了一条新公告','ai-response-editor-block','visible','在同时执行两个函数时出错:','\x22\x20data-category-id=\x22','.screen.active','char-music-cover','[照片]','\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)}`\x0a-\x20\x20\x20**送礼物**:\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送这个礼物的原因\x22,\x20\x22image_prompt\x22:\x20\x22生成礼物图片的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22}`\x0a-\x20\x20\x20**为用户点外卖**:\x20\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}\x20`(你主动为用户点外卖时使用)\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','\x20被刀了','<span>已</span><span>超</span><span>时</span>','在导演模式保存时，发现无效的指令对象，已跳过:','shared-history-viewer-content','标题:\x20','sticker-search-input','<textarea\x20id=\x22','contact-picker-list','\x27的评论，内容是：“','正在接收流式数据...','lrcUpdateInterval','\x20-\x20响应内容:\x20','生成新日记失败:','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>没有更多可以邀请的联系人了。</p>','AI女巫决定使用解药！','#gift-recipient-list\x20.contact-picker-item','确定要删除与\x20\x22','data-clear-type-list','favorites-list','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg','confirm-full-import-btn','后台活动设置','，人设:\x20','已阵亡，还有30秒爆炸','preview-font-style','querySelector','add-song-search-btn','API格式不正确，角色\x20\x22','你好世界\x20Hello\x20World','<div\x20class=\x22gift-preview-item\x22><img\x20src=\x22','在角色\x20\x22','.variation-block','你拍了拍\x20“','Character\x20Avatar','doubanMaxPosts','Live\x20Preview','callHistory','.sticker-category-tab','\x20条记忆精炼为\x201\x20条核心记忆！','bubble_theme','text/event-stream','导出数据','</span>','CPhone\x20QQ模拟记录生成\x20和\x20主聊天推进\x20已同时完成。','cancel-reply-btn','<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>','请根据你的设定，生成你的歌单。','push','nai-default-negative','minimize-reading-btn','\x22\x20checked>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','聊天记录已成功分享到\x20','上传成功！','dark','\x22）。你已经有一段时间没有和用户（','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','📥\x20图片下载中...','标题是必填项哦！','已选择\x20','recipientName','<p\x20style=\x22font-size:\x2012px;\x20color:\x20#ff8c00;\x20margin:\x204px\x200\x200;\x22>(注意:\x20这将【覆盖】您当前的设置)</p>','character-phone-screen','add-selected-music-btn','\x0a##\x20','variation-selection-modal','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>“','<span\x20style=\x22color:\x20orange;\x22>否\x20(还剩约\x20','昨晚\x20','此操作将永久删除您选择的所有数据，且无法恢复！确定要继续吗？','findIndex','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20margin-top:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','共享位置','add-preset-btn','*讨论记录*:\x0a','导入已取消，因为未提供名称。','没有聊天了。','NPC行动失败：API未配置。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-content\x22>','translateY(0)','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-group-name\x22>来自\x20','resume','font-url-input','https://i.postimg.cc/VkXngG72/mmexport1751031208329.gif','\x20向对方发起了转账:\x20','.frame-content[style*=\x22display:\x20block\x22]\x20.frame-grid','enableBackgroundActivity','chatId','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-group-btn\x22\x20data-book-id=\x22','renderApiSettingsProxy','Font\x20Settings','通话中还没有你的发言，无法重新生成回应。','top','left','offline-preset-select','regenerate-char-diary-btn','isActive','https://i.postimg.cc/1XqzGKwJ/mmexport1751018282681.gif','commenterOriginalName','hasShown40','sendQzoneStickerComment:\x20找不到帖子:','无法找到分享记录:','\x20[包含','请输入新的昵称','\x20\x20\x20负面:','https://i.postimg.cc/FFCTCzpy/641bad3b3udc599fdb63ca75fde427e5.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','\x0a-\x20角色思考:\x20','preCallContext','transfer-cancel-btn','EPhone-长截图-','handleWidgetImageChange','Advanced\x20Data\x20Cleanup','delete-font-preset-btn','删除消息','edit-last-response-btn','AI\x20','https://i.postimg.cc/YSRRV8kn/IMG-6297.gif','<p\x20style=\x22text-align:center;\x20padding:\x2020px;\x20color:\x20#888;\x22>播放列表是空的~</p>','https://i.postimg.cc/tRzPkzRg/IMG-7012.gif','\x0a\x0a#\x20世界观\x20(所有角色必须严格遵守)\x0a','novelai-settings-btn','基础数据不完整，无法开始总结。','.message-bubble.is-link-share','默认头像','游戏结束','\x20\x20\x20promptSource:','imageProcessed','TTS\x20音频已保存到缓存。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-time\x22>','album-screen','Edit\x20NPC','\x0a#\x20用户的角色\x0a-\x20**','将清空选定角色的所有动态、评论和点赞。','createdAt','正在合并数据，请勿关闭页面...','https://i.postimg.cc/fRTF24jS/IMG-4430.gif','recordId','无法生成商品，请检查(主/副)API配置或稍后再试。\x0a错误:\x20','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','npcGroups','selection-mode','AI\x20(','catch','#ccc','This\x20is\x20a\x20simulated\x20chat,\x20messages\x20cannot\x20be\x20sent','确定要将选中的商品作为礼物送出吗？','修改文字','标准JSON数组解析失败，将尝试强力提取...','\x0a\x0a##\x20世界书:\x20','douban-my-comment-avatar','chat-header-title','changedTouches','请输入备忘录内容','temp_user_chat_mirror','paused','<option\x20value=\x22current\x22>当前配置\x20(未保存)</option>','linesPerPage','选中的表情已成功删除。','AI返回的讨论内容格式不正确。原始返回:\x20','(无标题投票)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22sticker-binding-checkbox\x22\x20data-chat-id=\x22','请输入有效的红包个数！','nai-cfg-scale','text_image','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是角色“','内容加载失败...','删除(通知AI)','status-bar-battery','https://i.postimg.cc/k5P1NHcL/55f3e31d8qbc8a02d152b07b99d31567.gif','诊断：在\x20data.extensions.character_book\x20中找到世界书。','</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20album-art-btn\x22\x20data-index=\x22','App\x20Usage\x20Log','https://i.postimg.cc/mrFhKBGz/IMB-e-QWBpa.gif','♪\x20♪\x20♪','link-memory-toggle','horizontal','recalledData','#image-mode-content','请根据你的设定，生成你的浏览器记录。','poisonUsed','</div></div>','orderBy','\x0a\x0a#\x20你的商店\x20(你可以为群成员购买礼物):\x0a','[系统提示：你\x20(','找不到这本书！','setHours','https://i.postimg.cc/gJNYx9pV/IMG-6856.gif','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>文件中未找到可合并的数据。</p>','https://i.postimg.cc/J0b6Nym4/IMG-7279.jpg','closest','icon-settings-grid','shoppingProductCount','novelai-switch','专属红包:\x20给\x20','authorChatId','https://i.postimg.cc/DyYDmKtw/IMG-7238.gif','无法生成图片:\x20','auto','AI已将您的\x20','isDeleted','char-music-progress-fill','boxSizing','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','var-','unread-indicator','werewolf-kill-modal','originalPost','members','mousemove','正在模拟“','status-bar-visible','.message-bubble','该消息发送已超过2分钟，无法撤回。','</div>\x0a\x20\x20\x20\x20','将清空收藏夹中所有与该角色相关的内容（如聊天、动态、日记等）。','\x22>...</div>','未知作者','\x0a-\x20**人设\x20(必须严格遵守)**:\x20','Associated\x20Characters\x20(NPC\x20will\x20comment\x20on\x20their\x20moments)','”\x20将备注修改为\x20“','regex','files','selective-import-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22decision\x22:\x20\x22apply\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22在这里写下你想对用户说的、真诚的、有针对性的申请理由。\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20\x20\x20\x20','API请求失败:\x20','\x0a\x0a\x0a','此操作将使用AI生成新的商品和分类，并【添加】到现有列表中。确定要继续吗？','已成功导出所有数据！','npc-avatar-input','[语音消息:\x20','\x0a-\x20**帖子内容摘要**:\x20','\x20向\x20','dynamic-island-music-toggle-switch','找到图片文件:','Save\x20All\x20Appearance\x20Settings','确定要删除分类《','大小:','#chat-input-area','https://i.postimg.cc/63sDQKMm/IMG-6893.gif','sticker','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI导演。下面的“帖子摘要”和“已有评论”来自于一个豆瓣小组的帖子。用户“','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>','frame_5','最近\x20100\x20条','\x0a#\x20【格式铁律\x20(最高优先级：NovelAI\x20开启模式)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【必须包含且只能包含两个】元素，【严格按照】以下顺序:\x0a\x20\x20\x20\x201.\x20\x20第一个元素：一个\x20`offline_text`\x20对象，包含场景和对话。\x0a\x20\x20\x20\x202.\x20\x20第二个元素：一个\x20`naiimag`\x20对象，用于生成该场景的图片。\x0a2.\x20\x20**【【【绝对禁止】】】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】只返回一个\x20`offline_text`\x20元素。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】只返回一个\x20`naiimag`\x20元素。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】返回任何其他组合。你【必须】同时返回文字和图片。\x0a3.\x20\x20**【输出示例\x20(必须遵守)】**:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22offline_text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22「这是对话内容」...\x20(这里是动作和环境描写)...\x22\x0a\x20\x20\x20\x20\x20\x20},\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22naiimag\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22prompt\x22:\x20\x221girl,\x20solo,\x20detailed\x20anime\x20art\x20style,\x20(smiling:1.2),\x20sitting\x20in\x20a\x20cafe,\x20looking\x20at\x20viewer,\x20masterpiece,\x20best\x20quality,\x20...\x20(根据上面的文字内容生成详细的英文prompt)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a4.\x20\x20**【内容风格\x20(offline_text)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','请先选择要添加的歌曲。','source_name','input[name=\x22visibility\x22]','textContent','message-editor-container','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>请先在聊天界面的<br>表情面板中添加表情包</p>','每晚可以守护一名玩家，使其免受狼人袭击。不能连续两晚守护同一个人。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有共同的回忆和约定呢~</p>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','browser-back-btn','resolution','voice_message','导出失败','cancel-sticker-binding-btn','不支持的分享类型。','执行出错','AI\x20(独立行动)\x20尝试使用一个不存在的表情:\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-main\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22request-title\x22\x20style=\x22margin-bottom:\x2012px;\x22>','https://i.postimg.cc/7LSRp4hx/e7fa949b9pc84cff0dabe57defceb54c.gif','将清空选定角色的所有长期记忆。','linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)','product-category-tabs','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','prepend','save-douban-cast-btn','后台活动模拟已停止。','.chat-group-header:not([data-has-listener=\x22true\x22])','world-book-tab','originalType','quantity','下单，请慢用～</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-label\x22\x20style=\x22font-size:\x2018px;\x20font-weight:\x20600;\x22>','[系统提示：你刚刚成功将对用户的称呼修改为了“','ZIP解压失败:','handlePacketClick','请输入头像的图片URL','”下，发送了一个表情评论，意思是：“','5.\x20\x20**情景感知**:\x20你的对话【必须】自然地体现出对当前时间\x20(','lyric','这是你们的第一次互动。','你们的对话刚刚还在继续。','input[value=\x22','.voice-transcript','退款给\x20','douban-send-comment-btn','\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a','qzone-banner-input','天\x20-\x20投票','商店空空如也，点击“管理”添加商品吧！','合并失败','favorites-action-bar','\x22]\x20.participant-avatar','char-memo-detail-content','恭喜你，你赢了！','poisonedId','https://i.postimg.cc/MK8rJ8t7/IMG-6438.jpg','qzonePhotos','#e4b591','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有任何角色或NPC可以加入群聊。</p>','\x20\x20\x20\x20-\x20我昨晚用毒药毒了\x20','light','source','正在接通...','修改昵称','data-clear-char-list','<p\x20style=\x22font-size:12px;color:#888;\x22>','level','无共同好友','generate','home-screen','/v1/chat/completions','profile-random-jottings','在动态评论区点击了表情，但在表情库中未找到对象:','无法解析预设文件。\x0a错误:\x20','ceil','#preset-tabs\x20.world-book-tab','https://i.postimg.cc/wjH180kn/IMG-5566.gif','[图片]','cphone','where','正在打包表:\x20','qzone','删除成功','[data-version]','没有可供重新生成的AI响应。','约定达成！','associatedWith','enabled','relationship','<br>',')\x20的可用表情:\x0a','https://corsproxy.io/?','fileType','<div\x20class=\x22spinner\x22></div>','models','请开始整合。','post_deleted_notice','】。\x0a2.\x20\x20**我掌握的秘密信息\x20(仅我可见)**:\x0a','&times;','participants','[图片，描述:\x20','padStart','remove-global-bg-btn','rules-tab','正在请求AI为新群头像命名...','对方正在输入...','删除规则','input:checked','data:\x20[DONE]','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>',')的关系请参考你的人设、长期记忆和最近的对话。\x0a','span:last-child','rp-direct-amount','请根据你的设定，生成你的高德地图足迹。','personality','memory-list-container','https://i.postimg.cc/FzbGNdRT/IMG-4392.gif','music-player-song-title','.nai-gallery-download-btn','\x20<span\x20class=\x22group-tag\x22>群</span>','ai-avatar-library-modal','naiimag','用户描述的照片','”]\x20','bg-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','frame_14','pop','主API和副API均未配置或配置不完整。','天，救人概率为\x20','”\x20的预设已存在。要覆盖它吗？','char-music-lyrics','ai-avatar-library-title','accept-friend-btn','input[name=\x22visibility\x22]:checked','确定要退出当前这局狼人杀吗？游戏进度将不会被保存。','create-shuoshuo-btn','renderWorldBookScreenProxy','Bilibili','\x27,\x20\x27bulangni\x27,\x20sans-serif','\x22\x20class=\x22product-image\x22>','已返回我的手机','album-item','Amap','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','删除照片','0:00','Cleanup\x20Redundant\x20Data','批量导入表情','time','active','\x0a#\x20你的任务\x0a你是一个虚拟音乐品味模拟器。你的任务是扮演角色“','这将提取最近的对话内容发送给AI进行总结，会消耗API额度。确定要继续吗？','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】足迹的\x20`timestamp`\x20字段，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a\x20\x20\x20\x20-\x20\x20\x20请生成一个看起来像是过去几周内的、时间【从新到旧】排列的足迹列表。\x0a2.\x20\x20**创造性与合理性**:\x20足迹必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**多样性**:\x20地点类型要丰富，可以包括餐厅、商场、公园、公司、朋友家等。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条足迹，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22locationName\x22:\x20\x22一个具体、生动的地点名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22address\x22:\x20\x22一个虚构但看起来很真实的详细地址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comment\x22:\x20\x22这是角色对这次出行或这个地点的内心独白或评论，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22(可选)一段用于生成这张地点照片的、详细的【英文】关键词,\x20风格为\x20realistic\x20photo,\x20high\x20quality\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x22符合\x20ISO\x208601\x20格式的日期时间字符串\x20(例如:\x20\x272025-09-25T18:30:00Z\x27)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**重要**:\x20大约有【三分之一】的足迹需要包含\x20`image_prompt`\x20字段来生成一张照片。\x0a\x20\x20\x20\x20-\x20**图片**:\x20image_prompt\x20生成的图片【绝对禁止包含真人】。如果地点是室内，可以生成空无一人的场景；如果是室外，可以只有风景或建筑。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','https://i.postimg.cc/nhcC21Rc/IMG-6148.gif','\x22\x20(用户)\x20或\x20\x22','生成失败','scroll','values','global_css','照片已删除。','calls','</div><div\x20class=\x22payment-box\x22><div\x20class=\x22payment-label\x22>需付款</div><div\x20class=\x22amount\x22>¥','https://i.postimg.cc/1Rwn3XVP/IMG-6146.gif','副密钥','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','gomoku_move','API\x20Temperature','这是字体预览效果，12345。','\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22>','char-wallet-screen','isGroup','原始消息已删除或不存在','\x20MB</strong>\x20(压缩率\x20','regenerate-char-memo-btn','\x0a-\x20**身份**:\x20','poll-question-input','local','char-taobao-screen','NEGLIGIBLE','save-theme-preset-btn','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>','photo-viewer-prev-btn','\x20\x20\x20[-]\x20最终负面提示词:','获取AI狼人目标失败:','#world-book-checkboxes-container\x20input:checked','\x20-\x20','img','decline-call-btn','browser-content','请输入一个有效的图片URL！','frame_6','querySelectorAll','\x20为\x20','.rules-tab','Moments','injectLatestThought','char-usage-list','column','douban-post-detail-screen','，跳过...','Gemini\x20API返回了非预期的格式:','用户\x20(','网络图片\x20(CPhone)','在这里输入语音内容','swipeDirection','newSize','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','save-preset-btn','https://i.postimg.cc/DzDy2vS7/IMG-7017.gif','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x20width:\x2045px;\x20height:\x2045px;\x22></div>','</span><span>','char-conversation-messages','marginTop','preset-action-edit','https://i.postimg.cc/sDFhySn3/IMG-6936.gif','thoughts-history-list','\x20红包已被领完，手气王是\x20','\x22\x20记录了一条新回忆:','</div><div\x20class=\x22transfer-note\x22>','.select-box','狼人行动API失败:','转账已被拒收','close-novelai-test','思考中...','quote_reply','\x0a\x0a[系统指令：请根据你在上面读到的规则和以下最新信息，开始你的独立行动。]\x0a','确定切换','music-playlist-panel','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22unread-count-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22unread-count\x22\x20style=\x22display:\x20none;\x22>0</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','reset-character-nai-prompts-btn','system',')\x20作者:\x20','https://i.postimg.cc/gkk7s0vD/IMG-6984.gif','\x20拍了拍我','\x20个新表情！','图片详情','time-zone-search-input','modify','\x0a#\x20---\x20世界书设定结束\x20---\x0a','char-simulated-input','authorId','ai-frame-grid','精炼失败','nai-diffusion-4-5-full','legacy','NPC\x20\x22','secondaryApiKey','编辑世界书','总结成功','确认清空动态？','检查更新时出错:','这将提取当前通话记录发送给AI进行总结，会消耗API额度。确定要继续吗？','message-bubble\x20','speaker_name','https://i.postimg.cc/Df1qLzDf/IMG-6927.gif','sticker-category-tabs','\x0a##\x20---\x20关于“','\x0a#\x20可用表情包\x20(优先使用)\x0a每个AI角色都被设置了专属表情包，在需要发送表情时，他们应该【优先】从自己的专属列表中选择。尽量让你的表情丰富多样，避免重复。\x0a','字体设置','\x20发送了一条语音，内容是：\x27','grayscale(100%)','#e7f3ff','char-music-play-pause-btn','#data-clear-type-list\x20.clear-posts-item.selected','https://i.postimg.cc/MG6qtLYK/IMG-5565.gif','\x22操作...','[表情]\x20含义:\x20\x22','repost-comment-input',':</strong>\x20','扫描聊天记录失败:','group-action-cooldown-input','当前通知版本\x20(','secondary-model-select','847038kgQOtq','char-memo-detail-screen','\x22\x20的独立后台活动开关已关闭，本次跳过。','delete-world-books-list','AI\x20角色\x20\x22','Album','favorites-view','revokeObjectURL','visibilityState','cart-screen','reading-title','https://i.postimg.cc/cJpbtPWq/mmexport1751036607799.gif','【用户\x20(User)】','startY','post-image-description','qzone_like','bg-btn','手慢了','\x0a#\x20你的任务\x0a你是一个狼人杀游戏模拟器\x20(Game\x20Simulator)。你的任务是【并行模拟】','\x0a-\x20','photo-viewer-modal','char-article-title','message-bubble\x20system-bubble','save-nai-settings-btn','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','data:\x20','</button>','friend_request_response','启用AI生图功能','back-from-member-management','Memories','未发现需要迁移的旧红包数据。','生成中...','import-single-chat-btn','\x0a\x0a#\x20你的商店\x20(你可以为用户购买礼物):\x0a','display','world-book-group-container','close-announcement-board-btn','showWaimaiDetails:\x20找不到消息或消息类型不正确','正在执行删除操作...','NPC\x20头像','upload-image-btn','single-lyric-display','https://i.postimg.cc/3x0Kx1fz/IMB-K1u-Jp-P.gif','角色\x20\x22','char-memo-detail-title','通话消息已更新！','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22amount\x22>','\x0a---\x0a###\x20帖子ID:\x20','getTime','\x20\x0a#\x20社交圈与动态\x0a','Status','确定要将“','\x20条)','char-amap-item','处理NPC后台活动时出错:','key','date-separator','目标消息未找到,\x20正在加载更多历史记录...\x20(尝试\x20','\x27>引用</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','rp-group-count','cart-item','\x20\x20\x20\x20\x20\x20-\x20我在此次游戏中没有特别的社交关系。\x0a','原文:\x20\x22','join','AI\x20(独立行动)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','找不到表:\x20','操作已取消','setProperty','请输入有效的URL。','”图标','font-size:\x2016px;\x20color:\x20#555;\x20margin-bottom:\x2010px;','rule-name-input','memos','--container-width','https://i.postimg.cc/HWynLK7f/mmexport1751021724230.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊AI导演。你现在控制着一个名为“','\x20\x20\x20\x20-\x20我的狼队友是：','请输入预设名称','\x20\x20-\x20评论:\x20','authorOriginalName','\x0a现在，请根据以上所有信息，继续这场没有用户参与的群聊，并自由地使用各种指令来丰富你们的互动。\x0a','variation-quantity-display','正在批量添加\x20','world-book-entries-container','chat-lock-overlay','请先填写对应的反代地址和密钥','正在为角色\x20','🤖\x20AI\x20思维链:','确认删除分类','custom-modal-title','AI幻觉已被拦截！试图使用群名\x20(\x22','昨晚是平安夜。','https://i.postimg.cc/hP9JpdfT/IMG-7023.gif','favoritedPostIds','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','未知设定的角色','暂停了音乐','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','qzone_comment','reply-preview-bar','预言家','成功打包\x20','评论内容不能为空哦！','update-notice-modal','对方本名不能为空！','offline-mode-options','群里已经安静了\x20','shoppingCategoryCount','[你发送了一条语音消息，内容是：\x27','跳过一个无效的JSON片段:','thoughts','https://i.postimg.cc/9XPwWmwy/IMB-Kf7um-P.gif','https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','自动总结成功：为\x20','danger-option','ArrowLeft','检测到AI执行了动态操作，立即刷新好友动态页面。','is-raw-html','group-name','\x22\x20class=\x22music-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-name\x22>','add-ai-response-block-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x208px;\x20flex-shrink:\x200;\x20margin-left:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20edit-memory-btn\x22\x20data-author-id=\x22','TA的浏览器历史','播放被中断，这是正常行为:','50%','\x22><div\x20class=\x22member-name\x22>','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份清晰的个人档案或事件回顾，而不是一篇情感散文。请删除重复、琐碎或纯粹的情感宣泄，只保留对情节和关系发展至关重要的部分。\x0a5.\x20\x20**【【【长度铁律】】】**:\x20你的总结【必须】非常精炼，总长度应控制在\x20**','<div\x20class=\x22poll-footer\x22><span\x20class=\x22poll-total-votes\x22>共\x20','Share','chat-search-results-list','flat','nai-test-error','张NovelAI图片:\x20','change_remark_name','ai-original-name-input','📤\x20发送请求到\x20NovelAI\x20API','https://i.postimg.cc/Y2PHZzCC/IMG-6866.gif','time-zone-select','https://i.postimg.cc/D01rYy86/mmexport1751037965259.gif','confirm-witch-poison-btn','[文字图]\x20','(回复\x20','App记录','sticker-grid','\x22\x20触发了后台行动！','enableTts','single-char-background-activity-group','char-photo-description','你领取了\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','existing-group-item','renderXSocialScreenProxy','block','\x20(这是你的帖子)','.world-book-tab','置顶聊天','transfer-modal','avatarFrame','nai-download-btn','Voice\x20Model','.poll-card','home-screen-pages-container','isMinimized','view','close-call-transcript-btn','chargingchange','ai_image','你已拒收','cleanup-data-btn','\x20元。]','message-editor-block','negative','-\x20**时间**:\x20你必须感知到当前是\x20','bookId','\x22\x20class=\x22gift-preview-img\x22><span\x20class=\x22gift-preview-name\x22>','请输入背景图片的URL','https://i.postimg.cc/Cx9vCVWH/IMG-4395.gif','content-type','\x0a-\x20**你的曾用名**:\x20[','chat-input-actions-top','请稍候','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20世界书备份或\x20Tavern\x20AI\x20世界书文件。','<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>','”的记忆\x20---\x0a','regenerate-char-amap-btn','authorAvatarPrompt','werewolf-game-screen','部分下载完成','选择精炼范围','create-post-btn','status-bar-time','\x20行格式不正确，已被忽略。','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','icon-img-','wolfKill','isSeparator','lastFailedAction','”\x20将对你的称呼修改为\x20“','rotating','https://i.postimg.cc/W40f9qtd/IMG-7098.gif','photo-viewer-image','remove-bg-btn','”\x20绑定到...','gameover','在打包或写入文件流时发生错误:\x20','自动总结狼人杀游戏失败:','\x22\x20的消息。严格遵守每个角色的设定，禁止出戏。\x0a-请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送文本**:\x20\x27{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22文本内容\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送图片**:\x20\x27{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22图片的详细【中文】描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起投票**:\x20\x27{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22...\x22,\x20\x22options\x22:\x20\x22...\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起群视频**:\x20\x27{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-如何正确使用“引用回复”功能：\x0a-\x20当你想明确地针对群内【任何成员】（包括用户或其他AI角色）之前的某一句具体的话进行回复时，你就应该使用这个功能。\x0a-\x20这会让你的回复上方出现一个灰色的小框，里面是被你引用的那句话，这样对话就不会乱了。\x0a-\x20指令格式:\x20\x27{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20(你想引用的那句话的时间戳),\x20\x22reply_content\x22:\x20\x22你的回复内容\x22}\x27\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前群聊信息\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**群名称**:\x20','AI\x20(群聊后台)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','[系统提示：你于时间戳\x20','编辑对方状态','char-diary-detail-title','werewolf-role-name','\x0a\x0a#\x20待总结的群组视频通话记录\x0a','download-selected-nai-gallery-btn','\x22\x20title=\x22删除此条记录\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-header\x22>','书库是空的，点击“导入新书”添加第一本吧！','\x0a-\x20**你的长期记忆**:\x0a','date','此操作将扫描数据库，移除所有与已删除角色相关的孤立数据（如动态、评论、记忆等）。<br><br><strong>此操作不可撤销，但通常是安全的。NPC数据不会被删除。</strong><br><br>建议在操作前先导出数据备份。','.call-record-card','删除对话','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','发现新版本通知:\x20','import-data-input','.message-bubble[data-timestamp=\x22','decline_transfer','分类名不能为空！','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-spinner\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>','char-amap-list','\x20元，订单时间戳为\x20','getHours','groupName','update_status','https://i.postimg.cc/vH2X6N1y/mmexport1751032231179.gif','select-all-frames-checkbox','persona-library-modal','Select\x20a\x20Phone','playlist','new-sticker-category-name-input','确定要永久删除这条动态吗？','reading-restore-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22share-target-checkbox\x22\x20data-chat-id=\x22','聊天设置','minimized','清空聊天记录','此操作将永久删除\x20','\x20(用户)**:\x20','请先选择要删除的商品。','请AI角色们继续进行讨论。','\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色扮演】**:\x20你的所有行为都【必须】严格符合你的角色设定。\x0a2.\x20\x20**【互动逻辑】**:\x20你的首要任务是检查“待处理的帖子列表”。如果列表中有你可以回应的帖子（特别是那些有新评论或提到你的），你【必须】优先进行评论或回复，而不是发布新动态。\x0a3.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20\x20\x20数组中可以包含【一个或多个】行动对象。\x0a\x20\x20\x20\x20-\x20\x20\x20每个行动对象的格式【必须】是以下两种之一：\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发布新动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22你的新动态内容。\x22}`\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发表评论**:\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22你的新评论内容。\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的【本名】\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。\x22}`\x0a4.\x20\x20**【行为组合指南】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由组合不同的行动，例如，先发布一条自己的动态，再去评论别人的动态。\x0a\x20\x20\x20\x20-\x20\x20\x20为了模拟真实行为，你本次生成的行动数量建议在【1到3个】之间。\x0a\x0a#\x20你的角色设定\x0a-\x20**昵称**:\x20','NAI_Gallery_Batch_','EPhone-Full-Backup-Legacy-','你们正在一起读书。','call-history-list','---\x0a','call-message-bubble\x20user-speech','count','<li>未在此文件中找到可识别的数据。</li>','ready','confirmButtonClass','\x0a\x0a#\x20对话者的角色设定\x0a','mode','天\x20-\x20讨论','linkedMemoryCount','Edit\x20Entry','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>预估总上下文Token数:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22><strong>\x20','avatar_name','已使用','order','\x0a-\x20**内容摘要**:\x20','updateListenTogetherIconProxy','\x20是我的重要互动对象（用户）。\x0a','onerror','https://','\x0a#\x20你的内心独白\x20(上一轮的思考，仅你自己可见)\x0a-\x20心声:\x20','\x22\x20class=\x22chat-image\x22>','导入成功！','custom-bubble-style','sticker-binding-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','Response\x20headers:','启用\x20NovelAI\x20图像生成','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','complex','cursor','call-history-back-btn','getMonth','数据迁移完成！总共修复了\x20','werewolf-user-input','globalCss','npcGroupId','none','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-category\x22>','unreadCount','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的浏览器空空如也，<br>点击右上角刷新按钮生成一些记录吧！</p>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22/></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20心声\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>','data:image','ephone-theme','parts','</tbody></table><div\x20class=\x22receipt-total\x22>总计:\x20¥','\x0a##\x20来自《','/9j/','API\x20请求失败，状态码:\x20','#douban-cast-list\x20.douban-cast-checkbox:checked','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','）刚刚撤回了一条消息。撤回前的内容是：','\x20个新头像框！','确认替换','masterpiece,\x20best\x20quality,\x201girl,\x20beautiful,\x20detailed\x20face,\x20detailed\x20eyes,\x20long\x20hair,\x20anime\x20style','custom','cancel-selective-import-btn','https://i.postimg.cc/DZ541sbt/IMG-7280.jpg','</span></div></div>','聊天列表每次加载条数','[系统提示：你\x20','精炼完成，请确认','狼人数量已达到胜利条件，狼人阵营获得了胜利！','is-link-share','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','getElementsByTagName','album-photo-input','\x0a\x20\x20-\x20**人设**:\x20','你刚刚接听了用户的视频通话请求。','CELL_SIZE','确定要删除这条公告吗？此操作不可恢复。','确认拉黑','chat-list-item','increase-qty-btn','nai-smea','https://i.postimg.cc/C5XnfpNB/IMG-5579.gif','Secondary\x20Model','prompts','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>订单类型:</strong>\x20为TA点单<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>赠送方:</strong>\x20','imageDescription','分类\x20“','customCss','\x22\x20class=\x22participant-avatar\x22\x20alt=\x22','Error','group-avatar-upload-input','char-photo-item','正在请求网易云音乐API:','toLowerCase','[图片]\x20','长截图生成失败:','<tr><td\x20class=\x22item-name\x22>','请根据你的设定，写一篇新日记。','includes','compressed','https://i.postimg.cc/mgGc0HbK/IMG-6926.gif','anonymous','\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发系统消息**:\x20`{\x22type\x22:\x20\x22system_message\x22,\x20\x22content\x22:\x20\x22系统文本\x22}`\x0a\x0a###\x20社交与互动\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22suffix\x22:\x20\x22(可选)\x22}`\x0a-\x20\x20\x20**@提及**:\x20在消息内容中使用\x20`@[[角色本名]]`\x20格式。\x0a-\x20\x20\x20**共享位置**:\x20`{\x22type\x22:\x20\x22location_share\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22位置名\x22}`\x0a\x0a###\x20群组管理\x0a-\x20\x20\x20**改群名**:\x20`{\x22type\x22:\x20\x22change_group_name\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22new_name\x22:\x20\x22新群名\x22}`\x0a-\x20\x20\x20**改群头像**:\x20`{\x22type\x22:\x20\x22change_group_avatar\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22avatar_name\x22:\x20\x22头像名\x22}`\x20(从头像库选)\x0a\x0a###\x20特殊功能与卡片\x0a-\x20\x20\x20**发私信\x20(给用户)**:\x20`{\x22type\x22:\x20\x22send_private_message\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22recipient\x22:\x20\x22','https://i.postimg.cc/nrm9BcL8/IMG-6941.gif','HTML\x20Template\x20(use\x20$1,\x20$2)','</td></tr>','gift-receipt-body','歌曲查找失败:\x20AI请求的歌曲名\x22','.loader-container','GRID_SIZE','load-more-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','douban-cast-list','发生了一个错误:\x20','https://image.novelai.net/ai/generate-image','{{user}}','Enable\x20Independent\x20Background\x20Activity','批量导入格式错误，已跳过此行:','isFullyClaimed','close-shared-history-viewer-btn','12p','\x22><div\x20class=\x22title\x22>','char-music-artist','group-background-activity-switch','\x0a-\x20好人胜利：放逐所有狼人。\x0a\x0a#\x20当前游戏状态\x0a-\x20今天是第\x20','items','rp-direct-greeting','https://i.postimg.cc/fRV86FMq/IMG-4381.gif','\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22','转账给\x20','#b5b5b5','请输入歌手名','通话结束，时长\x20','commentCooldowns','</span><span\x20class=\x22gift-preview-quantity\x22>x','fillStyle','https://i.postimg.cc/ZqjKXPSv/IMG-7025.gif','[系统提示：你拒绝并退还了“','douban-post-item','.participant-avatar-wrapper[data-participant-id=\x22user\x22]\x20.participant-avatar','currentPlaylist','.zip','Edit\x20Preset','panelEl','Export\x20Data','add-new-sticker-category-btn','{\x0a\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x22content\x22:\x20\x22在这里输入新消息...\x22\x0a}','change_user_nickname','正在等待AI角色们继续讨论...','save-api-settings-btn','variations','ai-cooldown-group','predicate\x20must\x20be\x20a\x20function','productId','preset-name-input','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们在群聊通话里讨论了哪些核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','confirm-hunter-shot-btn','myNickname','尝试直接作为图片显示...','marquee\x20var(--marquee-duration,\x2010s)\x20linear\x20infinite','\x22>×</span>\x0a\x20\x20\x20\x20</div>\x0a','\x20(概率:\x20','.participant-avatar-wrapper\x20.participant-avatar','regenerate-btn','switch-greeting-group','video_call_request','generativelanguage.googleapis.com','npc_','location_share','group-avatar-group','发送好友申请','suffix','请输入有效的正整数！','\x20的消息:\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22thought-delete-btn\x22\x20data-timestamp=\x22','groupHeader','global-bg-preview','poll','now','结算(','”的群聊中的对话。这个群聊里【没有用户】，所有成员都是你扮演的角色。你的任务是让他们之间进行一场生动、自然的对话。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20字段和\x20\x22name\x22\x20字段（角色的【本名】）。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**【角色间互动\x20(最重要!)】**:\x20你的核心是创作一场“戏”。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别自言自语的独白。\x0a2.\x20\x20**【禁止出戏】**:\x20绝不能透露你是AI、模型或剧本作家。\x0a3.\x20\x20**【主动性】**:\x20角色们应该主动使用各种功能（发表情、发语音、分享图片等）来让对话更生动，而不是仅仅发送文字。\x0a4.请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20可用指令列表\x20(你现在可以使用所有这些功能！)\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','.toggle-content-btn','分钟前聊过。','\x20位AI角色的长期记忆中！','女巫请睁眼。','，TA的身份是：【','[系统提示：用户加入了通话]','视频通话刚刚结束','</small>','这是所有在场玩家的公开信息、人设和社交背景。\x0a','\x0a#\x20【【【最终投票指令\x20(最高优先级)】】】\x0a现在是投票环节。请你扮演【每一个存活的AI角色】，根据以上所有信息（特别是刚刚的讨论环节），为他们各自决定要投票放逐哪一位玩家。\x0a-\x20**投票依据**:\x20你的投票【必须】基于逻辑分析和你的身份。狼人可能会投给好人，好人需要找出狼人。\x0a-\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式如下：\x0a```json\x0a[\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色A的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色A投票的玩家名字\x22},\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色B的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色B投票的玩家名字\x22}\x0a]\x0a```\x0a-\x20**可投票的玩家列表**:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x22>×</span>','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分组</p>','#selective-import-list\x20.clear-posts-item.selected','save-ai-response-editor-btn','文件不是一个有效的PNG。','sticker-item','.draggable-button-item:not(.dragging)','所有通话记录','#music-lyrics-container\x20#music-lyrics-list','这是一条群聊语音消息，已禁止发起TTS请求。','tts-audio-player',')\x20送出了一份礼物，收礼人是：','global','shift','statusText','未使用','\x0a\x0a#\x20上下文参考\x20(你必须阅读并遵守)\x0a','AI幻觉已被拦截！试图在群聊中发送一条没有“name”的消息。消息内容:','href',')，开始总结...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20right:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20','isPinned','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','aiAvatarLibrary','世界书分类','frame-item','Listen\x20Together','专辑封面已更新！','open-persona-library-btn',')\x20刚刚投票给了\x20“','\x0a\x0a现在，请做出你的决定。','正在生成新的模拟聊天记录，并同时让角色思考如何与你继续对话...','生成图像','search-history-screen','myPersona',')，祝福语是：“','.sticker-binding-checkbox','witch-do-nothing-btn','\x0a#\x20核心任务：群聊导演\x0a你是一个群聊AI导演，负责扮演【除了用户以外】的所有角色。你的核心任务是导演一场生动的、角色间有充分互动的群聊。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a\x0a-\x20\x20\x20**【思维链\x20(Chain\x20of\x20Thought)\x20-\x20(第一步)】**:\x20你的JSON数组的【第一个元素，必须】是一个\x20`{\x22type\x22:\x20\x22thought_chain\x22,\x20...}`\x20对象。\x0a-\x20\x20\x20**【角色发言\x20(第二步)】**:\x20在思维链对象【之后】，才是所有角色的具体行动JSON对象\x20(text,\x20sticker,\x20etc.)。\x0a\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20和\x20\x22name\x22\x20字段。\x27name\x27字段【必须】使用角色的【本名】。\x0a\x0a#\x20角色扮演核心规则\x0a\x0a1.\x20\x20**【先思后行】**:\x20在生成任何角色发言之前，你【必须】先完成“思维链”的构思。你的“思维链”必须清晰地分析用户的发言、当前的气氛，并制定出本轮的互动策略。你的所有后续发言都【必须】严格遵循你自己的策略。\x0a\x0a2.\x20\x20**角色互动\x20(最重要)**:\x20你的核心是“导演”一场戏。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别回应用户的独白。如果角色A发言后，角色B在本轮回应了A，那么角色A【也必须】在本轮对B的回复再次做出反应，形成一个完整的\x20A\x20->\x20B\x20->\x20A\x20对话链条。\x0a\x0a3.\x20\x20**身份与称呼**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的身份是【','memberId','https://i.postimg.cc/MZ77rdDy/IMG-6850.gif','shared-history-viewer-modal','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有留下任何足迹，<br>点击右上角刷新按钮生成一些记录吧！</p>','\x20的外卖代付请求（时间戳:\x20','regenerate-char-album-btn','chat-lock-content','请用文字描述您要发送的照片：','rule-chat-id-select','my-group-nickname-input','dialogue','post-image-desc-group','export-single-chat-btn','-\x20**即将演唱**:\x20','paidBy','new-npc-group-name-input','生成模拟歌单失败:',')\x20试图将群名更改为成员名\x20(\x22','final','image/png','manage-world-book-categories-btn','2-digit','EPhone-Full-Backup-Streamed-','ai-frame-tab','NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。','”。红包还未领完，群内任何人都可以使用\x20\x27open_red_packet\x27\x20指令来领取。]','\x20中聊天','将清空选定角色的所有通话记录。','NAI_Image','swiped','[表情:\x20\x27','未找到\x20chatID:\x20','启用后台角色活动','qzone-avatar-img','下载失败','each','moveTo','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','ai_generated','custom-modal-body','解析AI返回的投票JSON时出错:\x20','identifier','选择记忆所属角色','###\x20最终结果:\x20','border-box','\x20位群成员生成并注入了个性化记忆！','douban-posts-list','手动创建角色','quality_toggle','已撤回的消息','\x20的动态\x20(NPC)','https://i.postimg.cc/cHWp0KG6/IMG-4413.gif','\x20张</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Refresh','</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>','\x20个自定义头像框吗？','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>本地图片(头像/表情/头像框/等)大小:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22><strong>','<input\x20type=\x22checkbox\x22\x20value=\x22book_','animation','fetch-models-btn','member','\x20→\x20','容错解析：策略3成功\x20(将整个返回文本作为摘要)','nightActions','getDate','regenerate-char-qq-btn','https://i.postimg.cc/k45sd8gn/IMG-6375.gif','未知NPC','正在合并单条记录到\x20','直连失败,\x20尝试使用CORS代理...','NPC\x20人设','find','group','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','确定要清空当前角色的NAI提示词配置吗？','repostComment','\x22>--天--时--分--秒</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22target-date\x22>目标时间:\x20','chat-header-title-wrapper','main','userAgent','presetCategories','upload-ephone-bg-url-btn','translateX(calc(-','favorites-search-clear-btn','pat_user','》吗？\x0a\x0a【【【警告】】】\x0a此操作将同时永久删除该分类下的\x20','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20commenter\x20字段为\x20“','inject-thought-toggle','my-group-nickname-group','\x0a\x0a现在，请开始生成这组足迹记录。','douban-comment-input','...\x22','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>','https://i.postimg.cc/90sH9Cn7/IMG-6868.gif','(Timestamp:\x20','狼人杀游戏总结已自动存入\x20','https://i.postimg.cc/Jz2Tz0dw/IMG-7281.jpg','https://i.postimg.cc/dVLXm3Xf/IMG-6885.gif','Memo','simulatedAppUsage','charCodeAt','books','rules-tab\x20active','https://i.postimg.cc/GhR6DT4Q/IMG-4428.gif','qzoneGroups','”的购物习惯...','guard','++id,\x20title,\x20lastOpened','link-content-input','voice-message-btn','人设预设','unblock-btn','\x20觉得很赞</span></div>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>','”，并根据其人设，通过【发布新动态】或【评论/回复帖子】来参与社区互动。\x0a\x0a','https://i.postimg.cc/VkV2bLNw/IMG-6853.gif','无法生成内容，请检查API配置或稍后再试。\x0a错误:\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','friend','\x20发送了一个【拼手气红包】(时间戳:\x20','”</i></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22accept-friend-btn\x22\x20class=\x22lock-action-btn\x22>接受</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22reject-friend-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22>拒绝</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/fycfcvHf/IMG-6569.gif','is-red-packet','messages','contact-picker-item','is-card-like','.qzone-post-container','cancelable','Sticker','Their\x20Taobao\x20Orders','https://i.postimg.cc/7Z8yYP7v/IMG-6889.gif','”准备好友申请...','https://i.postimg.cc/bNdk33SN/IMG-4893.gif','tagName','head','https://i.postimg.cc/gJ95NSRB/IMG-6854.gif','AI\x20\x22','delete-product-btn','create-post-modal','encode','”拉黑。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22unblock-btn\x22\x20class=\x22lock-action-btn\x22>解除拉黑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-top:\x2020px;\x20padding:\x2010px;\x20border:\x201px\x20dashed\x20#ccc;\x20border-radius:\x208px;\x20font-size:\x2011px;\x20text-align:\x20left;\x20color:\x20#666;\x20background:\x20rgba(0,0,0,0.02);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20#333;\x22>【开发者诊断面板】</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20后台活动总开关:\x20','绑定范围','.chat-group-content','songs','API设置','”\x20吗？\x0a\x0a此操作【不会】删除分类下的商品，它们将被移至“未分类”。','生成第','++id,\x20chatId,\x20timestamp,\x20type,\x20targetDate','zh-CN','\x22\x20(大小:\x20','✅\x20图片解压成功！','\x0a\x0a#\x20群成员列表、人设及社交背景\x20(至关重要！)\x0a你【必须】根据每个角色的社交背景来决定他们的互动方式。\x0a','打包中...','\x0a\x20\x20\x20\x20','announcements','狼人请选择刀人对象','npc-editor-modal','appearance-preset-select','\x0a#\x20你的任务\x0a你是一个虚拟社交生活模拟器，扮演角色“','send-btn','character-nai-positive','change','call-timer','post-visibility-groups','shoppingCategories','#avatar-frame-modal\x20.modal-body','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','转发了\x20@','天黑请闭眼...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20','douban-detail-author','name','search-results-list','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','AI返回的行动中未找到有效的JSON数组。','wallpaper-upload-input','\x0a#\x20你的任务\x0a你是一个虚拟的、极具创造力的商品规划师。你的任务是为下面的角色“','群里在','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>还没有创建任何世界书</p>','转发成功！','findLast','appIcons','GeminiChatDB','edit-call-message-btn','chats','-\x20\x20\x20**公开发布NovelAI真实图片动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20[\x22图片1详细英文描述\x22,\x20\x22图片2详细英文描述\x22]}`\x20\x0a\x20\x20*\x20**prompt撰写**：你可以根据当前对话上下文、你的角色人设、以及你想表达的情感和氛围，来撰写详细而具体的prompt。详细程度由你根据具体情况自己决定，并不强制。\x0a\x20\x20*\x20例如：\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22','\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','高德地图','小时前聊过。','persona-preset-item','\x20发布)\x0a','save-douban-settings-btn',')\x20拒绝了\x20','src','#e9ecef','music-search-results-modal','<option\x20value=\x22\x22>--\x20不使用预设\x20--</option>',').png','图片解压失败:\x20','shopping-category-count-input','https://i.postimg.cc/gc3QYCDy/1-NINE7-Five.jpg','这将从历史记录中【永久抹除】这\x20','某个时间','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>暂无支出记录。</p>','transform\x200.3s\x20ease','手动注入狼人杀记忆失败:','highlighted','persona-library-grid','notification-avatar','.link-share-card[data-timestamp]','<span\x20class=\x22commenter-name\x22>','red_packet','remove-member-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA最近好像什么都没买呢，<br>点击右上角刷新按钮生成一些记录吧！</p>','<span\x20class=\x22group-name\x22>','\x20\x20-\x20在群聊“','\x0a**内容:**\x0a','delete-selected-stickers-btn','还没有人','createElement','冗余数据清理流程已启动...','memories-back-btn','douban-detail-content-wrapper','uncategorized','Add','recipient','chat-list-render-window-input','<div\x20class=\x22avatar-with-frame\x22><img\x20src=\x22','https://files.catbox.moe/r5heyt.gif','waimai-confirm-btn','userStickers','import_card','开始检查并迁移旧的红包数据...','border','transfer-action-accept','.\x20\x0a\x0a将保留旧图片，但提示词会更新。','openPresetScreen','\x22\x20placeholder=\x22','<option\x20value=\x22\x22>--\x20未分组\x20--</option>','屠城局：狼人杀死所有好人即获胜。',')\x20和情景的感知。','werewolf-log-entry\x20system','渲染器','未检测到BOM，尝试使用\x20UTF-8\x20解码...','greeting','margin','无法生成备忘录，请检查API配置或稍后再试。\x0a错误:\x20','[发送了一张图片，描述为：','innerText','callRecords','543489FbZZdA','小于1分钟','#vinyl-view\x20#music-player-cover','onpause','offsetX','npc-list-view','\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22评论内容\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20表情:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','.entry-enabled-switch','[一张图片，其隐藏文字为：\x22','导入已取消，因为未提供书名。','**[夜晚]**\x20平安夜。\x0a','aiPersona','add-world-book-btn','regenerate-char-music-btn','<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22','🎬\x20推进剧情','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22waimai-details-btn\x22>查看订单详情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','请至少选择一个要清空的范围。','assistant','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22douban-cast-checkbox\x22\x20data-chat-id=\x22','从完整链接批量导入','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','播放列表是空的，无需清理。','未分类','novelai-api-key','Messages','originalSize','通话记录已保存:','确定要恢复默认设置吗？','。请收礼的角色表示感谢，其他角色可以自由发挥。]','\x22\x20class=\x22chat-image\x22></div>','Long\x20Screenshot','请你对此作出回应。]','messages-view','preset-persona-input','确定要删除这条渲染规则吗？','notification-content','back-to-clear-step1-btn','选择歌词导入方式','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20触发条件:\x20','originalContent','days','对方拒绝了你的视频通话请求。','预设已删除。','https://i.postimg.cc/QMVdG9x6/IMG-7016.gif','preset-avatar-preview','character-selection-screen','first_mes','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>价格\x20(元)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20class=\x22variation-price-input\x22\x20min=\x220\x22\x20step=\x220.01\x22\x20value=\x22','#\x20性格补充\x0a','inline-block','replace','hiddenText','create_memory','shopping-product-count-input','使用解药救TA','senderName','gomoku-board','请填写有效的商品信息和金额！','meaning','https://i.postimg.cc/R0pfKYvB/IMG-5976.gif','AI返回的内容中未找到有效的JSON数组结构\x20(`[...]`)。','561wQFqpo','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','music-visual-container','.selected-options-text','cancel-clear-wizard-btn-step1','Background\x20Activity\x20Settings','transfer-actions-modal','clientY','charging','save-wallpaper-btn','char-audio-player','<div\x20class=\x22rp-claimed-info\x22>红包已被领完</div>','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里空空如也，<br>点击右上角刷新按钮，看看大家都在聊什么吧！</p>','https://i.postimg.cc/gkhf597g/IMG-6555.gif','some','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M853.333333\x2085.333333H170.666667c-46.933333\x200-85.333333\x2038.4-85.333334\x2085.333334v512c0\x2046.933333\x2038.4\x2085.333333\x2085.333334\x2085.333333h512l170.666667\x20170.666667V170.666667c0-46.933333-38.4-85.333333-85.333334-85.333334z\x20m-42.666666\x20554.666667H170.666667V170.666667h640v469.333333zM256\x20384h512v85.333333H256V384z\x20m0-170.666667h512v85.333334H256v-85.333334z\x22></path></svg>\x20','sourceType','智能导出\x20(单个大文件，太大可能会导致导入不了)','groupAvatarLibrary','avatar_prompt','image/','nai-test-negative','保存CSS预设','\x0a\x0a#\x20当前情景\x0a-\x20**当前真实时间**:\x20','pending','banner','create-countdown-modal','解析器：已启用\x20Markdown\x20提取模式。','offlinePresetId','Create\x20New\x20Rule','💡\x20[NAI下载]\x20提示：三击任意NAI图片即可下载','<span\x20class=\x22diary-highlight\x22>$1</span>','transfer','\x20死亡了。','image/jpeg','character_persona','\x20分钟，开始模拟后台活动...','--marquee-duration','shoppingProducts','totalElapsedTime','enableAutoMemory','add-countdown-btn','getWriter','启用规则','请至少选择一位收礼人。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22cart-item-checkbox\x22\x20data-id=\x22','\x20条消息，AI将完全遗忘它们的存在。确定吗？','已取消收藏。','isArray','AI女巫决策：今天是第','请在此处粘贴完整的LRC格式歌词...','\x0a\x0a现在，请生成这份歌单。','</strong></p><hr\x20style=\x22opacity:\x200.2;\x20margin:\x2010px\x200;\x22>','已死亡','NovelAI设置已保存！','-\x20(记录于\x20','option','\x20条/个)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','chat-interface-screen','slice_','无法生成新回复:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','请先选择要下载的图片。','char-diary-list','add-new-group-btn','**:\x20\x22','variation-options-container','\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后立刻撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22content\x22:\x20\x22你想让AI说出后立刻消失的话\x22}`\x20(用于模拟说错话、后悔等场景，消息会短暂出现后自动变为“已撤回”)\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**发动态(说说)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22文字内容\x22}]`\x0a-\x20\x20\x20**发动态(文字图)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22图片描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]`\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的对话摘要\x20(供你参考)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20\x20\x20\x20-\x20我昨晚空守了。\x0a','island-lyric-text','”添加记忆','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20(用户)</span>\x0a\x20\x20\x20\x20','\x20MB</strong></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/HLZNWkQw/mmexport1751031767634.gif','frameUrl','ai-speech','mouse','\x22\x20已经存在了，换个名字吧！','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.poll-option-item','event_type','https://i.postimg.cc/Pf9g2fSL/IMG-6554.gif','\x0a\x0a现在，请开始生成这组备忘录。','https://i.postimg.cc/J4WCQd2j/IMG-4420.gif','documentElement','字体文件URL\x20(.ttf,\x20.otf,\x20.woff等)','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','Image\x20Generation\x20Settings'];_0x10ab=function(){return _0x11d8c1;};return _0x10ab();}const translations={'zh-CN':{'save':'保存','cancel':'取消','confirm':'确定','edit':'编辑','done':'完成','add':'添加','back':'返回','next':_0x534c67(0xb00),'close':'关闭','reset':'重置','upload':'上传','send':'发送','manage':'管理','share':'分享','delete':'删除','publish':'发布','refresh':'刷新','search':'搜索','remove':'移除','finish':'结束','details':'详情','settings':'设置','title':'标题','content':'内容','category':'分类','name':'名称','description':'描述','status':'状态','ok':'好的','error':'错误','success':'成功','warning':'警告','loading':_0x534c67(0xf42),'processing':'处理中...','pleaseWait':_0x534c67(0x960),'languageChangedAlert':_0x534c67(0xec6),'homeAppQQ':'QQ','homeAppWorldBook':_0x534c67(0x329),'homeAppAppearance':'外观设置','homeAppRenderer':_0x534c67(0x14ae),'homeAppApiSettings':'设置','homeAppFont':'字体','homeAppCPhone':_0x534c67(0x6f5),'homeAppDouban':'豆瓣','homeAppPreset':'预设','homeAppTutorial':'教程','homeAppWerewolf':_0x534c67(0x4d4),'homeAppX':'X','chatListTitle':'消息','navMessages':'消息','navQzone':'动态','navMemories':'回忆','navFavorites':'收藏','navNpcList':_0x534c67(0xd84),'qzoneTitle':_0x534c67(0xd72),'qzoneActionShuoshuo':'说说','qzoneActionPost':'动态','qzoneActionAlbum':'相册','cphoneTitleSelect':_0x534c67(0xaec),'cphoneAppQQ':'QQ','cphoneAppAlbum':'相册','cphoneAppBrowser':_0x534c67(0xc7b),'cphoneAppTaobao':'淘宝','cphoneAppMemo':_0x534c67(0x21f),'cphoneAppDiary':'日记','cphoneAppAmap':_0x534c67(0x1477),'cphoneAppUsage':_0x534c67(0x1269),'cphoneAppMusic':_0x534c67(0xdc8),'cphoneAppEphone':_0x534c67(0xc94),'cphoneAppFootprints':'足迹','cphoneAlbumTitle':'TA的相册','cphoneBrowserTitle':_0x534c67(0x1255),'cphoneTaobaoTitle':_0x534c67(0x23a),'cphoneWalletTitle':'钱包','cphoneMemoTitle':_0x534c67(0x21f),'cphoneDiaryTitle':'日记','cphoneUsageTitle':_0x534c67(0x62c),'cphoneMusicTitle':'TA的歌单','cphoneArticleTitle':'文章','cphoneSimulatedChatPlaceholder':_0x534c67(0x429),'worldBookTitle':_0x534c67(0x329),'worldBookEditorTitle':_0x534c67(0x11c0),'worldBookEntryEditorTitle':_0x534c67(0xe29),'worldBookNameLabel':'书名','worldBookCategoryLabel':'分类','worldBookEntriesLabel':_0x534c67(0xb61),'worldBookAddEntryBtn':_0x534c67(0x8da),'worldBookNamePlaceholder':'请输入世界书的名称...','worldBookImportTitle':_0x534c67(0xd59),'presetTitle':'预设','presetEditorTitle':'编辑预设','presetNameLabel':_0x534c67(0xca7),'presetCategoryLabel':'分类','presetEntriesLabel':_0x534c67(0xb61),'presetAddEntryBtn':_0x534c67(0x8da),'tutorialTitle':'教程','apiSettingsTitle':_0x534c67(0x9b8),'languageLabel':'语言','apiPresetManagement':'API\x20预设管理','apiPresetSelectLabel':'选择或切换预设','apiPrimarySettings':_0x534c67(0x954),'apiProxyUrlLabel':_0x534c67(0xd87),'apiKeyLabel':'密钥\x20(API\x20Key)','apiModelLabel':'模型','apiFetchModelsBtn':_0x534c67(0x927),'apiSecondarySettings':_0x534c67(0xbe6),'apiSecondaryProxyUrlLabel':_0x534c67(0xaf7),'apiSecondaryKeyLabel':_0x534c67(0x116c),'apiSecondaryModelLabel':_0x534c67(0x81f),'apiFetchSecondaryModelsBtn':_0x534c67(0x93c),'apiBgActivitySettings':_0x534c67(0xfe7),'apiEnableBgActivityLabel':_0x534c67(0x13db),'apiBgIntervalLabel':_0x534c67(0x1c1),'apiBlockCooldownLabel':'AI被拉黑后冷静期\x20(小时)','apiTtsSettings':_0x534c67(0x4c0),'apiTtsModelLabel':_0x534c67(0x400),'apiPerformanceSettings':'性能与显示设置','apiChatListRenderWindowLabel':_0x534c67(0x1314),'apiChatRenderWindowLabel':'聊天界面初始加载条数','apiImageGenSettings':_0x534c67(0x373),'apiEnableImageGenLabel':_0x534c67(0x11f6),'apiEnableNovelAILabel':_0x534c67(0x12f4),'apiNovelAIModelLabel':_0x534c67(0x4f0),'apiNovelAIKeyLabel':'NovelAI\x20API\x20Key','apiNovelAIGenSettingsBtn':_0x534c67(0x1586),'apiNovelAITestBtn':_0x534c67(0x45b),'apiStorageOptimization':'存储空间优化','apiCompressImagesBtn':'一键压缩本地图片','apiSaveAllBtn':'保存所有设置','apiExportDataBtn':_0x534c67(0xffb),'apiImportDataBtn':_0x534c67(0x8cd),'apiCleanupDataBtn':_0x534c67(0x999),'apiDeleteWorldBooksBtn':_0x534c67(0xf26),'apiAdvancedCleanupBtn':'高级数据清理','apiCheckAndFixDataBtn':_0x534c67(0x822),'chatHeaderOnline':'在线','chatHeaderLongTermMemory':_0x534c67(0xc91),'chatHeaderListenTogether':_0x534c67(0xabf),'chatHeaderChatSettings':_0x534c67(0x12cd),'chatSelectionCancel':'取消','chatSelectionScreenshot':_0x534c67(0x3f7),'chatSelectionFavorite':'收藏','chatSelectionShare':'分享','chatSelectionSoftDelete':_0x534c67(0x1079),'chatSelectionHardDelete':_0x534c67(0x155d),'chatReplyTo':'回复','chatInputPlaceholder':'输入消息...','chatWaitForReply':'等待回复','appearanceTitle':_0x534c67(0x5cb),'appearanceSaveAll':'保存所有外观设置','fontSettingsTitle':_0x534c67(0x11cb),'fontPresetManagement':_0x534c67(0xdcf),'fontFileUrlLabel':_0x534c67(0x154b),'fontPreviewLabel':_0x534c67(0x1552),'fontPreviewText1':_0x534c67(0xfee),'fontPreviewText2':_0x534c67(0x1170),'fontSaveAndApply':_0x534c67(0x1a5),'fontResetDefault':_0x534c67(0x592),'rendererTitle':_0x534c67(0xe51),'rendererEditorTitle':_0x534c67(0x15b7),'rendererCreateTitle':_0x534c67(0x5a0),'rendererRuleName':'规则名称','rendererBindScope':_0x534c67(0x1448),'rendererScopeGlobal':_0x534c67(0xe6b),'rendererRegex':_0x534c67(0xd42),'rendererHtmlTemplate':_0x534c67(0x2ea),'rendererEnableRule':_0x534c67(0x151f),'myAlbumTitle':_0x534c67(0xcc5),'albumPhotosTitle':_0x534c67(0xe43),'npcEditorTitleAdd':_0x534c67(0x3a5),'npcEditorTitleEdit':_0x534c67(0x2ba),'npcAvatarLabel':_0x534c67(0x1202),'npcUploadAvatar':_0x534c67(0x6fd),'npcNicknameLabel':_0x534c67(0xafc),'npcPersonaLabel':_0x534c67(0x1401),'npcEnableBgActivity':'启用独立后台活动','npcActionCooldown':'独立行动冷却\x20(分钟)','npcAssociatedChars':'关联的角色\x20(NPC会去评论这些角色的动态)'},'en':{'save':_0x534c67(0xb7f),'cancel':_0x534c67(0x227),'confirm':'Confirm','edit':'Edit','done':_0x534c67(0x2a6),'add':_0x534c67(0x149c),'back':'Back','next':_0x534c67(0x509),'close':'Close','reset':_0x534c67(0x910),'upload':_0x534c67(0xda2),'send':_0x534c67(0xa40),'manage':'Manage','share':_0x534c67(0x125b),'delete':_0x534c67(0xa47),'publish':_0x534c67(0xa99),'refresh':_0x534c67(0x13f0),'search':'Search','remove':_0x534c67(0x97a),'finish':_0x534c67(0xbef),'details':_0x534c67(0x7f6),'settings':'Settings','title':_0x534c67(0x9db),'content':'Content','category':_0x534c67(0xaea),'name':_0x534c67(0x2b8),'description':_0x534c67(0x331),'status':'Status','ok':'OK','error':_0x534c67(0x132d),'success':_0x534c67(0x8d5),'warning':'Warning','loading':'Loading...','processing':_0x534c67(0xd20),'pleaseWait':_0x534c67(0x956),'languageChangedAlert':_0x534c67(0x5b9),'homeAppQQ':'QQ','homeAppWorldBook':_0x534c67(0x407),'homeAppAppearance':_0x534c67(0x474),'homeAppRenderer':_0x534c67(0xa9c),'homeAppApiSettings':_0x534c67(0x20d),'homeAppFont':_0x534c67(0xf4b),'homeAppCPhone':_0x534c67(0x6f5),'homeAppDouban':_0x534c67(0xdf7),'homeAppPreset':_0x534c67(0x64b),'homeAppTutorial':'Tutorial','homeAppWerewolf':'Werewolf','homeAppX':'X','chatListTitle':_0x534c67(0x14cf),'navMessages':_0x534c67(0x14cf),'navQzone':'Moments','navMemories':_0x534c67(0x11f8),'navFavorites':_0x534c67(0x455),'navNpcList':_0x534c67(0x6fa),'qzoneTitle':_0x534c67(0x118b),'qzoneActionShuoshuo':_0x534c67(0x120d),'qzoneActionPost':_0x534c67(0x581),'qzoneActionAlbum':'Album','cphoneTitleSelect':_0x534c67(0x12c7),'cphoneAppQQ':'QQ','cphoneAppAlbum':_0x534c67(0x11df),'cphoneAppBrowser':_0x534c67(0x861),'cphoneAppTaobao':_0x534c67(0x76a),'cphoneAppMemo':_0x534c67(0x141d),'cphoneAppDiary':_0x534c67(0x617),'cphoneAppAmap':_0x534c67(0x1157),'cphoneAppUsage':'App\x20Usage','cphoneAppMusic':_0x534c67(0x71d),'cphoneAppEphone':_0x534c67(0xc94),'cphoneAppFootprints':'Footprints','cphoneAlbumTitle':_0x534c67(0x4b7),'cphoneBrowserTitle':_0x534c67(0x156e),'cphoneTaobaoTitle':_0x534c67(0x143c),'cphoneWalletTitle':_0x534c67(0x8d9),'cphoneMemoTitle':'Memo','cphoneDiaryTitle':_0x534c67(0x617),'cphoneUsageTitle':_0x534c67(0x107e),'cphoneMusicTitle':'Their\x20Playlist','cphoneArticleTitle':_0x534c67(0x446),'cphoneSimulatedChatPlaceholder':_0x534c67(0x1063),'worldBookTitle':'World\x20Book','worldBookEditorTitle':_0x534c67(0xd41),'worldBookEntryEditorTitle':_0x534c67(0x12e3),'worldBookNameLabel':_0x534c67(0x984),'worldBookCategoryLabel':_0x534c67(0xaea),'worldBookEntriesLabel':_0x534c67(0x5b7),'worldBookAddEntryBtn':_0x534c67(0x1594),'worldBookNamePlaceholder':_0x534c67(0xb4c),'worldBookImportTitle':_0x534c67(0x9b7),'presetTitle':'Presets','presetEditorTitle':_0x534c67(0x1362),'presetNameLabel':_0x534c67(0x837),'presetCategoryLabel':_0x534c67(0xaea),'presetEntriesLabel':'Content\x20Entries','presetAddEntryBtn':'[+]\x20Add\x20New\x20Entry','tutorialTitle':_0x534c67(0xf2d),'apiSettingsTitle':_0x534c67(0xf2a),'languageLabel':'Language','apiPresetManagement':_0x534c67(0x5f1),'apiPresetSelectLabel':'Select\x20or\x20Switch\x20Preset','apiPrimarySettings':_0x534c67(0x47f),'apiProxyUrlLabel':_0x534c67(0xc9a),'apiKeyLabel':'API\x20Key','apiModelLabel':_0x534c67(0x271),'apiFetchModelsBtn':_0x534c67(0xcc0),'apiSecondarySettings':_0x534c67(0xe8b),'apiSecondaryProxyUrlLabel':_0x534c67(0x4db),'apiSecondaryKeyLabel':'Secondary\x20API\x20Key','apiSecondaryModelLabel':_0x534c67(0x1326),'apiFetchSecondaryModelsBtn':'Fetch\x20Secondary\x20Models','apiTemperatureLabel':_0x534c67(0x116f),'apiBgActivitySettings':_0x534c67(0x14f9),'apiEnableBgActivityLabel':_0x534c67(0x9c5),'apiBgIntervalLabel':_0x534c67(0xe0a),'apiBlockCooldownLabel':_0x534c67(0xd37),'apiTtsSettings':'Voice\x20Message\x20Settings\x20(Minimax\x20TTS)','apiTtsModelLabel':_0x534c67(0x127a),'apiPerformanceSettings':_0x534c67(0xd09),'apiChatListRenderWindowLabel':'Chat\x20List\x20Batch\x20Load\x20Count','apiChatRenderWindowLabel':_0x534c67(0x646),'apiImageGenSettings':_0x534c67(0x154d),'apiEnableImageGenLabel':_0x534c67(0xee7),'apiEnableNovelAILabel':_0x534c67(0x940),'apiNovelAIModelLabel':_0x534c67(0x716),'apiNovelAIKeyLabel':_0x534c67(0x8e8),'apiNovelAIGenSettingsBtn':_0x534c67(0xb33),'apiNovelAITestBtn':_0x534c67(0xa3e),'apiStorageOptimization':_0x534c67(0xa6c),'apiCompressImagesBtn':_0x534c67(0xee3),'apiSaveAllBtn':'Save\x20All\x20Settings','apiExportDataBtn':_0x534c67(0x1364),'apiImportDataBtn':_0x534c67(0x717),'apiCleanupDataBtn':_0x534c67(0x115b),'apiDeleteWorldBooksBtn':'Delete\x20World\x20Books','apiAdvancedCleanupBtn':_0x534c67(0x1042),'apiCheckAndFixDataBtn':'Data\x20Check\x20&\x20Repair','chatHeaderOnline':'Online','chatHeaderLongTermMemory':_0x534c67(0xcad),'chatHeaderListenTogether':_0x534c67(0x13ae),'chatHeaderChatSettings':'Chat\x20Settings','chatSelectionCancel':_0x534c67(0x227),'chatSelectionScreenshot':_0x534c67(0x14d5),'chatSelectionFavorite':'Favorite','chatSelectionShare':_0x534c67(0x125b),'chatSelectionSoftDelete':'Delete\x20(Notify\x20AI)','chatSelectionHardDelete':_0x534c67(0x6ac),'chatReplyTo':_0x534c67(0xdc7),'chatInputPlaceholder':_0x534c67(0x508),'chatWaitForReply':_0x534c67(0x1567),'appearanceTitle':_0x534c67(0x7a4),'appearanceSaveAll':_0x534c67(0x10bd),'fontSettingsTitle':_0x534c67(0x102c),'fontPresetManagement':'Font\x20Preset\x20Management','fontFileUrlLabel':_0x534c67(0xe1f),'fontPreviewLabel':_0x534c67(0xff5),'fontPreviewText1':'Hello\x20World\x20你好世界','fontPreviewText2':'This\x20is\x20a\x20font\x20preview\x20effect,\x2012345.','fontSaveAndApply':'Save\x20and\x20Apply','fontResetDefault':_0x534c67(0x2e9),'rendererTitle':_0x534c67(0x818),'rendererEditorTitle':_0x534c67(0xf14),'rendererCreateTitle':_0x534c67(0x1511),'rendererRuleName':_0x534c67(0x789),'rendererBindScope':_0x534c67(0xbb2),'rendererScopeGlobal':_0x534c67(0xde9),'rendererRegex':_0x534c67(0xb86),'rendererHtmlTemplate':_0x534c67(0x133c),'rendererEnableRule':_0x534c67(0x5d2),'myAlbumTitle':_0x534c67(0x4f8),'albumPhotosTitle':_0x534c67(0x899),'npcEditorTitleAdd':'Add\x20NPC','npcEditorTitleEdit':_0x534c67(0x1055),'npcAvatarLabel':_0x534c67(0xbb6),'npcUploadAvatar':_0x534c67(0xc14),'npcNicknameLabel':_0x534c67(0x15a0),'npcPersonaLabel':'NPC\x20Persona','npcEnableBgActivity':_0x534c67(0x1348),'npcActionCooldown':'Independent\x20Action\x20Cooldown\x20(min)','npcAssociatedChars':_0x534c67(0x10ad)}};let currentLanguage=_0x534c67(0x144f);function setLanguage(_0x184789){const _0x5b2a87=_0x534c67;!translations[_0x184789]&&(console['warn'](_0x5b2a87(0x990)+_0x184789+_0x5b2a87(0xa73)),_0x184789=_0x5b2a87(0x144f)),currentLanguage=_0x184789,localStorage['setItem'](_0x5b2a87(0x622),_0x184789),document[_0x5b2a87(0x154a)][_0x5b2a87(0xe27)]=_0x184789,document[_0x5b2a87(0x1188)](_0x5b2a87(0xf65))[_0x5b2a87(0x427)](_0x12f6db=>{const _0x43e74a=_0x5b2a87,_0x4aff43=_0x12f6db[_0x43e74a(0x932)](_0x43e74a(0x87e));translations[_0x184789][_0x4aff43]&&(_0x12f6db['textContent']=translations[_0x184789][_0x4aff43]);}),document[_0x5b2a87(0x1188)](_0x5b2a87(0x489))[_0x5b2a87(0x427)](_0x37a801=>{const _0xf7d1b1=_0x5b2a87,_0x527f07=_0x37a801[_0xf7d1b1(0x932)](_0xf7d1b1(0x7cd));translations[_0x184789][_0x527f07]&&(_0x37a801[_0xf7d1b1(0x440)]=translations[_0x184789][_0x527f07]);}),document[_0x5b2a87(0x1188)]('[data-lang-key-title]')[_0x5b2a87(0x427)](_0x27c364=>{const _0x162749=_0x5b2a87,_0x1c676d=_0x27c364[_0x162749(0x932)]('data-lang-key-title');translations[_0x184789][_0x1c676d]&&(_0x27c364[_0x162749(0xb03)]=translations[_0x184789][_0x1c676d]);});}function initLanguage(){const _0x5508ca=_0x534c67,_0x7a0ee9=localStorage[_0x5508ca(0x55f)](_0x5508ca(0x622))||'zh-CN',_0x14c547=document[_0x5508ca(0x948)](_0x5508ca(0x785));_0x14c547&&(_0x14c547['value']=_0x7a0ee9,_0x14c547[_0x5508ca(0x339)](_0x5508ca(0x145c),_0x3a1caa=>{const _0x20c965=_0x5508ca,_0x1ab671=_0x3a1caa[_0x20c965(0xa50)]['value'];alert(translations[_0x1ab671][_0x20c965(0x6e0)]),localStorage[_0x20c965(0x59f)](_0x20c965(0x622),_0x1ab671),setTimeout(()=>window['location'][_0x20c965(0xd12)](),0x64);})),setLanguage(_0x7a0ee9);}(function(){'use strict';const _0x6a72dc=_0x534c67;function _0x37728f(_0x3496b7,_0x2a849f){const _0x1e9ad4=_0x6c9e;try{const _0xb02421=document[_0x1e9ad4(0x1497)]('a');_0xb02421[_0x1e9ad4(0x13a6)]=_0x3496b7,_0xb02421[_0x1e9ad4(0xf4c)]=_0x2a849f,_0xb02421[_0x1e9ad4(0xf74)][_0x1e9ad4(0x11fd)]=_0x1e9ad4(0x12fe),document['body'][_0x1e9ad4(0x6b6)](_0xb02421),_0xb02421[_0x1e9ad4(0x4f6)](),setTimeout(()=>{const _0x44e44c=_0x1e9ad4;document['body'][_0x44e44c(0x15a7)](_0xb02421);},0x64),console[_0x1e9ad4(0x498)]('✅\x20[NAI下载]\x20开始下载图片:',_0x2a849f),_0x3cf4af();}catch(_0x5b8a94){console['error']('❌\x20[NAI下载]\x20下载失败:',_0x5b8a94),_0x3cf4af('下载失败，请重试',_0x1e9ad4(0xc3e));}}function _0x3cf4af(_0xe74a78=_0x6a72dc(0x100a),_0x517541='success'){const _0x3fcec4=_0x6a72dc,_0x3cc634=document[_0x3fcec4(0x1497)](_0x3fcec4(0x379));_0x3cc634[_0x3fcec4(0x10cb)]=_0xe74a78,_0x3cc634[_0x3fcec4(0xf74)][_0x3fcec4(0x8e7)]=_0x3fcec4(0x7c0)+(_0x517541===_0x3fcec4(0xa9e)?_0x3fcec4(0x1a7):_0x3fcec4(0x6c3))+_0x3fcec4(0x8ae),document[_0x3fcec4(0xae6)]['appendChild'](_0x3cc634),setTimeout(()=>{const _0xc2275b=_0x3fcec4;_0x3cc634['style'][_0xc2275b(0x9a2)]='1',_0x3cc634[_0xc2275b(0xf74)]['transform']=_0xc2275b(0x1021);},0xa),setTimeout(()=>{const _0x8ca265=_0x3fcec4;_0x3cc634[_0x8ca265(0xf74)][_0x8ca265(0x9a2)]='0',_0x3cc634[_0x8ca265(0xf74)][_0x8ca265(0x79c)]=_0x8ca265(0x96b),setTimeout(()=>{const _0x51ee6e=_0x8ca265;_0x3cc634[_0x51ee6e(0xf89)]();},0x12c);},0x7d0);}function _0x3b9601(_0x333023){const _0x55b944=_0x6a72dc,_0x3b31cc=_0x333023[_0x55b944(0x932)](_0x55b944(0xb03))||_0x333023[_0x55b944(0x932)](_0x55b944(0xc3a))||'';let _0x405468=_0x3b31cc[_0x55b944(0x14e9)](/[^a-zA-Z0-9\u4e00-\u9fa5\s]/g,'_')['replace'](/\s+/g,'_')[_0x55b944(0xeca)](0x0,0x1e);!_0x405468&&(_0x405468=_0x55b944(0x13d7));const _0x2e75da=new Date()[_0x55b944(0x5ac)]()[_0x55b944(0x14e9)](/[-:]/g,'')[_0x55b944(0x14e9)]('T','_')['split']('.')[0x0];return _0x405468+'_'+_0x2e75da+_0x55b944(0x1eb);}function _0xc4aa8d(_0x53bd50){const _0xe0e4f3=_0x6a72dc,_0x4bedf2=_0x53bd50[_0xe0e4f3(0xf74)][_0xe0e4f3(0x79c)]||'',_0x4e7908=_0x53bd50['style'][_0xe0e4f3(0xbc7)]||'';_0x53bd50[_0xe0e4f3(0xf74)]['transition']=_0xe0e4f3(0x4f4),_0x53bd50[_0xe0e4f3(0xf74)][_0xe0e4f3(0x79c)]=_0xe0e4f3(0xd05),setTimeout(()=>{const _0x59fb87=_0xe0e4f3;_0x53bd50[_0x59fb87(0xf74)][_0x59fb87(0x79c)]=_0x4bedf2,setTimeout(()=>{const _0x3236c9=_0x59fb87;_0x53bd50[_0x3236c9(0xf74)]['transition']=_0x4e7908;},0x96);},0x96);}let _0x5bd79d=0x0,_0x3183fd=null,_0x3eb056=null;document[_0x6a72dc(0x339)](_0x6a72dc(0x4f6),function(_0x2387a5){const _0xe6c34c=_0x6a72dc,_0x21c846=_0x2387a5['target'];if(_0x21c846[_0xe6c34c(0x1440)]===_0xe6c34c(0xf1a)&&(_0x21c846[_0xe6c34c(0xd54)]['contains']('realimag-image')||_0x21c846[_0xe6c34c(0xd54)][_0xe6c34c(0x7a0)](_0xe6c34c(0x388)))){_0x21c846===_0x3eb056?_0x5bd79d++:(_0x5bd79d=0x1,_0x3eb056=_0x21c846);_0x3183fd&&clearTimeout(_0x3183fd);if(_0x5bd79d===0x3){_0x5bd79d=0x0,_0x3eb056=null,_0x2387a5['preventDefault'](),_0x2387a5['stopPropagation'](),console[_0xe6c34c(0x498)](_0xe6c34c(0xfc1)),_0xc4aa8d(_0x21c846);const _0x4d588e=_0x21c846[_0xe6c34c(0x147d)];if(!_0x4d588e||_0x4d588e==='about:blank'){console[_0xe6c34c(0x9c1)](_0xe6c34c(0xf39)),_0x3cf4af(_0xe6c34c(0x248),_0xe6c34c(0xc3e));return;}const _0x4d22fb=_0x3b9601(_0x21c846);_0x37728f(_0x4d588e,_0x4d22fb);}else _0x3183fd=setTimeout(()=>{_0x5bd79d=0x0,_0x3eb056=null;},0x1f4);}},!![]),console[_0x6a72dc(0x498)](_0x6a72dc(0x4bb)),console[_0x6a72dc(0x498)](_0x6a72dc(0x1512));}());_0x534c67(0xa65)in navigator&&window[_0x534c67(0x339)](_0x534c67(0xd32),()=>{const _0x11211a=_0x534c67;navigator[_0x11211a(0xa65)][_0x11211a(0x1ee)]('./sw.js')['then'](_0x4116aa=>{const _0x19cf24=_0x11211a;console[_0x19cf24(0x498)](_0x19cf24(0x19e),_0x4116aa[_0x19cf24(0x8d6)]);})[_0x11211a(0x1061)](_0x4bb450=>{const _0x2343d1=_0x11211a;console[_0x2343d1(0x498)](_0x2343d1(0xf17),_0x4bb450);});});function _0x6c9e(_0x118aa7,_0x38cc69){const _0x10abc6=_0x10ab();return _0x6c9e=function(_0x6c9ebf,_0x5485c5){_0x6c9ebf=_0x6c9ebf-0x195;let _0x537f7d=_0x10abc6[_0x6c9ebf];return _0x537f7d;},_0x6c9e(_0x118aa7,_0x38cc69);}!Array[_0x534c67(0x39d)][_0x534c67(0x655)]&&Object['defineProperty'](Array['prototype'],'findLastIndex',{'value':function(_0x162738){const _0x591fe0=_0x534c67;if(this==null)throw new TypeError(_0x591fe0(0x935));if(typeof _0x162738!==_0x591fe0(0xa7f))throw new TypeError(_0x591fe0(0x136c));let _0x512e7a=Object(this),_0x125678=_0x512e7a[_0x591fe0(0xaf9)]>>>0x0,_0x3b22f1=arguments[0x1],_0x4ab4ba=_0x125678-0x1;while(_0x4ab4ba>=0x0){let _0x4d0ea0=_0x512e7a[_0x4ab4ba];if(_0x162738[_0x591fe0(0x7e7)](_0x3b22f1,_0x4d0ea0,_0x4ab4ba,_0x512e7a))return _0x4ab4ba;_0x4ab4ba--;}return-0x1;},'configurable':!![],'writable':!![]});const dynamicIslandContent=document[_0x534c67(0x948)](_0x534c67(0x701)),islandAlbumArt=document[_0x534c67(0x948)](_0x534c67(0x8ef)),islandLyricContainer=document['getElementById']('island-lyric-container'),islandLyricText=document['getElementById'](_0x534c67(0x153a)),phoneScreenForIsland=document['getElementById'](_0x534c67(0xecd));let activeMessageTimestamp=null,activeTransferTimestamp=null,lastRawAiResponse='',lastResponseTimestamps=[],lastPrivateMessagesSent=[],currentQzoneReplyContext=null,editingNpcId=null,pendingBackupData=null;const GEMINI_API_URL=_0x534c67(0xa7c);function getRandomValue(_0x284c8d){const _0x34cc18=_0x534c67;if(_0x284c8d[_0x34cc18(0x1336)](',')){const _0x8e3498=_0x284c8d[_0x34cc18(0x46f)](',')[_0x34cc18(0x8ff)](_0x153ee4=>_0x153ee4['trim']()),_0x26b3ce=Math[_0x34cc18(0x15b6)](Math['random']()*_0x8e3498[_0x34cc18(0xaf9)]);return _0x8e3498[_0x26b3ce];}return _0x284c8d;}function isImage(_0x919ee8){const _0x262837=_0x534c67;if(_0x919ee8[_0x262837(0x1b0)]&&_0x919ee8['image_url'][_0x262837(0x9a8)]){let _0xe72a58=_0x919ee8[_0x262837(0x1b0)]['url'];const _0x3c7471=_0xe72a58[_0x262837(0x46f)](',')[0x1],_0x6bf2ba=_0xe72a58[_0x262837(0x9a3)](/^data:(.*);base64/)[0x1];return[{'text':_0x262837(0xe99)},{'inline_data':{'mime_type':_0x6bf2ba,'data':_0x3c7471}}];}return[];}function getGeminiResponseText(_0x451028){const _0x38295d=_0x534c67;if(_0x451028[_0x38295d(0xc11)]&&Array['isArray'](_0x451028['choices'])&&_0x451028[_0x38295d(0xc11)][_0x38295d(0xaf9)]>0x0&&_0x451028[_0x38295d(0xc11)][0x0][_0x38295d(0x74b)]&&_0x451028['choices'][0x0][_0x38295d(0x74b)][_0x38295d(0xede)])return _0x451028['choices'][0x0][_0x38295d(0x74b)][_0x38295d(0xede)];if(_0x451028[_0x38295d(0x272)]&&Array[_0x38295d(0x1524)](_0x451028[_0x38295d(0x272)])&&_0x451028[_0x38295d(0x272)][_0x38295d(0xaf9)]>0x0&&_0x451028[_0x38295d(0x272)][0x0][_0x38295d(0xede)]&&_0x451028[_0x38295d(0x272)][0x0]['content'][_0x38295d(0x1305)])return _0x451028[_0x38295d(0x272)][0x0][_0x38295d(0xede)]['parts'][0x0][_0x38295d(0x9ea)];console[_0x38295d(0xc3e)](_0x38295d(0x1191),_0x451028);let _0x21e853=_0x38295d(0xfc2);if(_0x451028[_0x38295d(0x272)]&&Array[_0x38295d(0x1524)](_0x451028[_0x38295d(0x272)])&&_0x451028[_0x38295d(0x272)][_0x38295d(0xaf9)]>0x0&&_0x451028[_0x38295d(0x272)][0x0][_0x38295d(0xe18)]==='SAFETY'){const _0x3c628c=_0x451028[_0x38295d(0x272)][0x0]['safetyRatings'],_0x78099b=_0x3c628c['filter'](_0x121453=>_0x121453[_0x38295d(0x77d)]!==_0x38295d(0x117b)&&_0x121453['probability']!==_0x38295d(0xdf5))[_0x38295d(0x8ff)](_0x254587=>_0x254587[_0x38295d(0x6cd)]+_0x38295d(0x1375)+_0x254587[_0x38295d(0x77d)]+')')['join'](',\x20');_0x21e853='内容因安全策略被屏蔽。触发类别:\x20'+(_0x78099b||'未知');}else{if(_0x451028[_0x38295d(0x1556)]?.['blockReason']){const _0x24aaec=_0x451028[_0x38295d(0x1556)][_0x38295d(0x9a1)],_0x5f31b3=_0x451028[_0x38295d(0x1556)][_0x38295d(0x627)]?.[_0x38295d(0x8ff)](_0xb42c10=>_0xb42c10['category']+':\x20'+_0xb42c10['probability'])[_0x38295d(0x121a)](',\x20');_0x21e853='内容因安全策略被屏蔽\x20(原因:\x20'+_0x24aaec+')。详情:\x20'+(_0x5f31b3||'无');}else _0x451028[_0x38295d(0xc3e)]&&(_0x21e853=_0x38295d(0xe1c)+_0x451028[_0x38295d(0xc3e)][_0x38295d(0x74b)]);}throw new Error(_0x21e853);}document[_0x534c67(0x339)](_0x534c67(0xb50),()=>{const _0x3ce1fb=_0x534c67;document[_0x3ce1fb(0x339)](_0x3ce1fb(0xe8f),()=>{const _0x232826=_0x3ce1fb;document[_0x232826(0x11e2)]==='visible'&&(console[_0x232826(0x498)](_0x232826(0x895)),navigator[_0x232826(0xa65)][_0x232826(0x12dd)][_0x232826(0x7e5)](_0x4143f6=>{_0x4143f6['update']();}));});function _0xe8c788(_0x52ffd7,_0x5d7dba,_0x53cb7b,_0x145631){const _0x40d14f=_0x3ce1fb,_0x2e6441=_0x16699d[_0x40d14f(0xf9c)][_0x40d14f(0x382)]||0.8,_0x5a71c0={'user':_0x40d14f(0xaeb),'assistant':_0x40d14f(0x531),'system':_0x40d14f(0xaeb)},_0x27f8b9=[{'role':_0x40d14f(0xaeb),'parts':[{'text':_0x53cb7b}]},{'role':'model','parts':[{'text':_0x40d14f(0x702)}]},..._0x145631['map'](_0x36692e=>{const _0x58d672=_0x40d14f,_0x2f3083=[];return Array[_0x58d672(0x1524)](_0x36692e['content'])?_0x36692e['content'][_0x58d672(0x427)](_0x1503e0=>{const _0x3fdc3f=_0x58d672;if(_0x1503e0['type']===_0x3fdc3f(0x9ea))_0x2f3083[_0x3fdc3f(0x1001)]({'text':_0x1503e0['text']});else{if(_0x1503e0[_0x3fdc3f(0x4ae)]===_0x3fdc3f(0x1b0)&&_0x1503e0[_0x3fdc3f(0x1b0)]&&_0x1503e0[_0x3fdc3f(0x1b0)]['url']){const _0x24cf61=_0x1503e0[_0x3fdc3f(0x1b0)]['url'],_0x1d44b9=_0x24cf61[_0x3fdc3f(0x46f)](',')[0x1],_0x15c19a=_0x24cf61[_0x3fdc3f(0x9a3)](/^data:(.*);base64/);_0x15c19a&&_0x1d44b9&&_0x2f3083[_0x3fdc3f(0x1001)]({'inline_data':{'mime_type':_0x15c19a[0x1],'data':_0x1d44b9}});}}}):_0x2f3083[_0x58d672(0x1001)]({'text':String(_0x36692e[_0x58d672(0xede)])}),{'role':_0x5a71c0[_0x36692e['role']],'parts':_0x2f3083};})];return{'url':_0x40d14f(0xb45)+_0x52ffd7+_0x40d14f(0xa89)+getRandomValue(_0x5d7dba),'data':{'method':_0x40d14f(0xdca),'headers':{'Content-Type':_0x40d14f(0x479)},'body':JSON['stringify']({'contents':_0x27f8b9,'generationConfig':{'temperature':_0x2e6441}})}};}const _0x6ed281=new Dexie(_0x3ce1fb(0x1472)),_0x6a7d66=[{'id':_0x3ce1fb(0x12fe),'url':'','name':'无'},{'id':'frame_cat_ear','url':'https://i.postimg.cc/fLDnz5Pn/IMG-5574.gif','name':'1'},{'id':_0x3ce1fb(0xf40),'url':_0x3ce1fb(0x813),'name':'2'},{'id':_0x3ce1fb(0xf4e),'url':'https://i.postimg.cc/jCVK0fGL/IMG-6890.gif','name':'3'},{'id':_0x3ce1fb(0xa87),'url':'https://i.postimg.cc/85Zsyjwn/IMG-6895.gif','name':'4'},{'id':_0x3ce1fb(0x10c5),'url':'https://i.postimg.cc/cJtpZCB3/IMG-6894.gif','name':'5'},{'id':_0x3ce1fb(0x1187),'url':_0x3ce1fb(0x10c1),'name':'6'},{'id':_0x3ce1fb(0x9d9),'url':_0x3ce1fb(0x7e6),'name':'7'},{'id':'frame_8','url':_0x3ce1fb(0x141c),'name':'8'},{'id':_0x3ce1fb(0x534),'url':_0x3ce1fb(0xe54),'name':'9'},{'id':'frame_10','url':_0x3ce1fb(0x795),'name':'10'},{'id':'frame_11','url':_0x3ce1fb(0x157b),'name':'11'},{'id':_0x3ce1fb(0xdd1),'url':_0x3ce1fb(0xdb6),'name':'12'},{'id':_0x3ce1fb(0x377),'url':_0x3ce1fb(0x9d8),'name':'13'},{'id':'frame_14','url':_0x3ce1fb(0xb9d),'name':'14'},{'id':'frame_cat_ear','url':_0x3ce1fb(0xf6e),'name':'1'},{'id':_0x3ce1fb(0xf40),'url':_0x3ce1fb(0x566),'name':'2'},{'id':_0x3ce1fb(0xf4e),'url':_0x3ce1fb(0x1353),'name':'3'},{'id':_0x3ce1fb(0xa87),'url':_0x3ce1fb(0x51c),'name':'4'},{'id':_0x3ce1fb(0x10c5),'url':_0x3ce1fb(0x594),'name':'5'},{'id':_0x3ce1fb(0x1187),'url':_0x3ce1fb(0x48f),'name':'6'},{'id':_0x3ce1fb(0x9d9),'url':_0x3ce1fb(0x557),'name':'7'},{'id':_0x3ce1fb(0x860),'url':_0x3ce1fb(0x5e1),'name':'8'},{'id':_0x3ce1fb(0x534),'url':_0x3ce1fb(0x113c),'name':'9'},{'id':_0x3ce1fb(0x645),'url':'https://i.postimg.cc/XY63sTS3/IMG-4393.gif','name':'10'},{'id':'frame_11','url':_0x3ce1fb(0x128b),'name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/kMfPQBwQ/IMG-4396.gif','name':'12'},{'id':'frame_13','url':_0x3ce1fb(0x338),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x2fa),'name':'14'},{'id':_0x3ce1fb(0x794),'url':_0x3ce1fb(0x5dc),'name':'1'},{'id':_0x3ce1fb(0xf40),'url':_0x3ce1fb(0x26c),'name':'2'},{'id':_0x3ce1fb(0xf4e),'url':_0x3ce1fb(0xb20),'name':'3'},{'id':_0x3ce1fb(0xa87),'url':_0x3ce1fb(0x2e0),'name':'4'},{'id':_0x3ce1fb(0x10c5),'url':'https://i.postimg.cc/q7cQnDy1/IMG-4404.gif','name':'5'},{'id':_0x3ce1fb(0x1187),'url':_0x3ce1fb(0x937),'name':'6'},{'id':_0x3ce1fb(0x9d9),'url':'https://i.postimg.cc/gcV0VR2t/IMG-4408.gif','name':'7'},{'id':_0x3ce1fb(0x860),'url':_0x3ce1fb(0xb74),'name':'8'},{'id':'frame_9','url':'https://i.postimg.cc/Ss7pM6fW/IMG-4410.gif','name':'9'},{'id':_0x3ce1fb(0x645),'url':_0x3ce1fb(0x37c),'name':'10'},{'id':_0x3ce1fb(0x55c),'url':_0x3ce1fb(0x13ee),'name':'11'},{'id':'frame_12','url':_0x3ce1fb(0xd08),'name':'12'},{'id':'frame_13','url':_0x3ce1fb(0x424),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x76c),'name':'14'},{'id':'frame_cat_ear','url':_0x3ce1fb(0xbba),'name':'1'},{'id':'frame_ribbon','url':_0x3ce1fb(0x5e0),'name':'2'},{'id':_0x3ce1fb(0xf4e),'url':_0x3ce1fb(0x601),'name':'3'},{'id':_0x3ce1fb(0xa87),'url':_0x3ce1fb(0x1549),'name':'4'},{'id':_0x3ce1fb(0x10c5),'url':_0x3ce1fb(0x67a),'name':'5'},{'id':_0x3ce1fb(0x1187),'url':_0x3ce1fb(0x69f),'name':'6'},{'id':_0x3ce1fb(0x9d9),'url':_0x3ce1fb(0x5df),'name':'7'},{'id':_0x3ce1fb(0x860),'url':_0x3ce1fb(0x6db),'name':'8'},{'id':_0x3ce1fb(0x534),'url':_0x3ce1fb(0xb83),'name':'9'},{'id':_0x3ce1fb(0x645),'url':_0x3ce1fb(0x1422),'name':'10'},{'id':'frame_11','url':_0x3ce1fb(0x105a),'name':'11'},{'id':_0x3ce1fb(0xdd1),'url':_0x3ce1fb(0x5ec),'name':'12'},{'id':_0x3ce1fb(0x377),'url':'https://i.postimg.cc/nrJSqNhz/IMG-4432.gif','name':'13'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x1b4),'name':'14'},{'id':'frame_cat_ear','url':'https://i.postimg.cc/XNkQTHvf/IMG-5561.gif','name':'1'},{'id':_0x3ce1fb(0xf40),'url':_0x3ce1fb(0x1577),'name':'2'},{'id':_0x3ce1fb(0xf4e),'url':_0x3ce1fb(0xd99),'name':'3'},{'id':_0x3ce1fb(0xa87),'url':_0x3ce1fb(0xd90),'name':'4'},{'id':_0x3ce1fb(0x10c5),'url':_0x3ce1fb(0x750),'name':'5'},{'id':'frame_6','url':_0x3ce1fb(0x7bd),'name':'6'},{'id':'frame_7','url':_0x3ce1fb(0x6c8),'name':'7'},{'id':'frame_8','url':_0x3ce1fb(0x143f),'name':'8'},{'id':_0x3ce1fb(0x534),'url':'https://i.postimg.cc/4x9tTy1D/IMG-5563.gif','name':'9'},{'id':_0x3ce1fb(0x645),'url':_0x3ce1fb(0xa6f),'name':'10'},{'id':_0x3ce1fb(0x55c),'url':'https://i.postimg.cc/Fsvr71JL/IMG-5573.gif','name':'11'},{'id':'frame_12','url':_0x3ce1fb(0x909),'name':'12'},{'id':'frame_13','url':_0x3ce1fb(0x1114),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x11d1),'name':'14'},{'id':_0x3ce1fb(0x794),'url':_0x3ce1fb(0xee9),'name':'1'},{'id':_0x3ce1fb(0xf40),'url':_0x3ce1fb(0x586),'name':'2'},{'id':'frame_flower','url':_0x3ce1fb(0x586),'name':'3'},{'id':_0x3ce1fb(0xa87),'url':_0x3ce1fb(0x1325),'name':'4'},{'id':_0x3ce1fb(0x10c5),'url':_0x3ce1fb(0x538),'name':'5'},{'id':_0x3ce1fb(0x1187),'url':'https://i.postimg.cc/FzM1Hgr0/IMG-5717.gif','name':'6'},{'id':'frame_7','url':_0x3ce1fb(0x9b5),'name':'7'},{'id':_0x3ce1fb(0x860),'url':_0x3ce1fb(0x721),'name':'8'},{'id':'frame_9','url':_0x3ce1fb(0x4af),'name':'9'},{'id':'frame_10','url':_0x3ce1fb(0x243),'name':'10'},{'id':'frame_11','url':_0x3ce1fb(0xb1c),'name':'11'},{'id':_0x3ce1fb(0xdd1),'url':_0x3ce1fb(0x632),'name':'12'},{'id':_0x3ce1fb(0x377),'url':'https://i.postimg.cc/1zmcp66p/IMG-5973.gif','name':'13'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x357),'name':'14'},{'id':'frame_cat_ear','url':_0x3ce1fb(0x14f2),'name':'1'},{'id':'frame_ribbon','url':'https://i.postimg.cc/9fQZ425b/IMG-5975.gif','name':'2'},{'id':_0x3ce1fb(0xf4e),'url':_0x3ce1fb(0x2a4),'name':'3'},{'id':'frame_tech','url':_0x3ce1fb(0xa25),'name':'4'},{'id':_0x3ce1fb(0x10c5),'url':_0x3ce1fb(0x6b9),'name':'5'},{'id':'frame_6','url':_0x3ce1fb(0xcc8),'name':'6'},{'id':_0x3ce1fb(0x9d9),'url':_0x3ce1fb(0xd3f),'name':'7'},{'id':_0x3ce1fb(0x860),'url':_0x3ce1fb(0x116b),'name':'8'},{'id':_0x3ce1fb(0x534),'url':_0x3ce1fb(0xf3d),'name':'9'},{'id':_0x3ce1fb(0x645),'url':_0x3ce1fb(0x1162),'name':'10'},{'id':'frame_11','url':_0x3ce1fb(0xbe1),'name':'11'},{'id':_0x3ce1fb(0xdd1),'url':'https://i.postimg.cc/LXyyqDbY/IMG-6294.gif','name':'12'},{'id':_0x3ce1fb(0x377),'url':'https://i.postimg.cc/7Zgm1wRy/IMG-6295.gif','name':'13'},{'id':_0x3ce1fb(0x1146),'url':'https://i.postimg.cc/5tbpnDcQ/IMG-6296.gif','name':'14'},{'id':_0x3ce1fb(0x794),'url':_0x3ce1fb(0x1047),'name':'1'},{'id':_0x3ce1fb(0xf40),'url':_0x3ce1fb(0x13fd),'name':'2'},{'id':_0x3ce1fb(0xf4e),'url':_0x3ce1fb(0xf45),'name':'3'},{'id':_0x3ce1fb(0xa87),'url':_0x3ce1fb(0x420),'name':'4'},{'id':'frame_5','url':_0x3ce1fb(0x917),'name':'5'},{'id':_0x3ce1fb(0x1187),'url':_0x3ce1fb(0x1547),'name':'6'},{'id':_0x3ce1fb(0x9d9),'url':_0x3ce1fb(0x1501),'name':'7'},{'id':_0x3ce1fb(0x860),'url':_0x3ce1fb(0x66f),'name':'8'},{'id':'frame_9','url':_0x3ce1fb(0xd48),'name':'9'},{'id':'frame_10','url':_0x3ce1fb(0x4b4),'name':'10'},{'id':_0x3ce1fb(0x55c),'url':_0x3ce1fb(0x32a),'name':'11'},{'id':_0x3ce1fb(0xdd1),'url':_0x3ce1fb(0xc60),'name':'12'},{'id':_0x3ce1fb(0x377),'url':'https://i.postimg.cc/G3y73Fj2/IMG-6563.gif','name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/TYvkKKkc/IMG-6565.gif','name':'14'},{'id':_0x3ce1fb(0x794),'url':'https://i.postimg.cc/GmcqjZn8/IMG-6566.gif','name':'1'},{'id':'frame_ribbon','url':_0x3ce1fb(0xd34),'name':'2'},{'id':_0x3ce1fb(0xf4e),'url':'https://i.postimg.cc/XJy8JWdh/IMG-6568.gif','name':'3'},{'id':'frame_tech','url':_0x3ce1fb(0x1434),'name':'4'},{'id':_0x3ce1fb(0x10c5),'url':_0x3ce1fb(0x4ac),'name':'5'},{'id':_0x3ce1fb(0x1187),'url':_0x3ce1fb(0x159c),'name':'6'},{'id':_0x3ce1fb(0x9d9),'url':_0x3ce1fb(0xf15),'name':'7'},{'id':'frame_8','url':_0x3ce1fb(0x32b),'name':'8'},{'id':_0x3ce1fb(0x534),'url':'https://i.postimg.cc/Vv8jkCYr/IMG-6574.gif','name':'9'},{'id':_0x3ce1fb(0x645),'url':_0x3ce1fb(0x13bc),'name':'10'},{'id':'frame_11','url':_0x3ce1fb(0x295),'name':'11'},{'id':_0x3ce1fb(0xdd1),'url':_0x3ce1fb(0xbcf),'name':'12'},{'id':'frame_13','url':_0x3ce1fb(0x142e),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x1442),'name':'14'},{'id':_0x3ce1fb(0x794),'url':_0x3ce1fb(0x2f1),'name':'1'},{'id':'frame_ribbon','url':_0x3ce1fb(0x108d),'name':'2'},{'id':'frame_flower','url':_0x3ce1fb(0xd57),'name':'3'},{'id':'frame_tech','url':_0x3ce1fb(0x1d1),'name':'4'},{'id':_0x3ce1fb(0x10c5),'url':'https://i.postimg.cc/vBqsQW7X/IMG-6858.gif','name':'5'},{'id':_0x3ce1fb(0x1187),'url':_0x3ce1fb(0x487),'name':'6'},{'id':_0x3ce1fb(0x9d9),'url':_0x3ce1fb(0x1418),'name':'7'},{'id':'frame_8','url':_0x3ce1fb(0x1263),'name':'8'},{'id':'frame_9','url':_0x3ce1fb(0x143d),'name':'9'},{'id':_0x3ce1fb(0x645),'url':_0x3ce1fb(0xa5a),'name':'10'},{'id':_0x3ce1fb(0x55c),'url':_0x3ce1fb(0x74d),'name':'11'},{'id':_0x3ce1fb(0xdd1),'url':_0x3ce1fb(0x417),'name':'12'},{'id':_0x3ce1fb(0x377),'url':_0x3ce1fb(0x341),'name':'13'},{'id':'frame_14','url':_0x3ce1fb(0xc20),'name':'14'},{'id':'frame_11','url':_0x3ce1fb(0x398),'name':'11'},{'id':_0x3ce1fb(0xdd1),'url':_0x3ce1fb(0x133b),'name':'12'},{'id':'frame_13','url':_0x3ce1fb(0x3e9),'name':'13'},{'id':'frame_14','url':_0x3ce1fb(0x119f),'name':'14'},{'id':_0x3ce1fb(0x377),'url':'https://i.postimg.cc/43PhvxRq/IMG-6922.gif','name':'13'},{'id':_0x3ce1fb(0x1146),'url':'https://i.postimg.cc/3Rb46fRZ/IMG-6923.gif','name':'14'},{'id':_0x3ce1fb(0x377),'url':_0x3ce1fb(0x661),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':'https://i.postimg.cc/XqRZNZ9G/IMG-6916.gif','name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0xcf5),'name':'14'},{'id':'frame_13','url':_0x3ce1fb(0x1338),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0xa8b),'name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x8cb),'name':'14'},{'id':_0x3ce1fb(0xdd1),'url':_0x3ce1fb(0x10db),'name':'12'},{'id':_0x3ce1fb(0x377),'url':_0x3ce1fb(0x78e),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x6d8),'name':'14'},{'id':_0x3ce1fb(0x377),'url':_0x3ce1fb(0x344),'name':'13'},{'id':'frame_14','url':_0x3ce1fb(0xfc6),'name':'14'},{'id':'frame_13','url':_0x3ce1fb(0x107b),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x103b),'name':'14'},{'id':'frame_14','url':_0x3ce1fb(0xefb),'name':'14'},{'id':_0x3ce1fb(0x377),'url':'https://i.postimg.cc/J0CZSwyW/IMG-6938.gif','name':'13'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x11c7),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/CLNkrQSW/IMG-6925.gif','name':'14'},{'id':'frame_13','url':_0x3ce1fb(0x94b),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x83f),'name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x752),'name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0xdde),'name':'14'},{'id':_0x3ce1fb(0x377),'url':'https://i.postimg.cc/Z5nrCyS5/IMG-7006.gif','name':'13'},{'id':_0x3ce1fb(0x1146),'url':'https://i.postimg.cc/mDfMXXFP/IMG-7007.gif','name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x2e2),'name':'14'},{'id':_0x3ce1fb(0x377),'url':_0x3ce1fb(0xbf7),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':'https://i.postimg.cc/RhGH0vpt/IMG-7010.gif','name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x1049),'name':'14'},{'id':_0x3ce1fb(0x377),'url':_0x3ce1fb(0xb3f),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/3JSG5Jv5/IMG-7014.gif','name':'14'},{'id':_0x3ce1fb(0x1146),'url':'https://i.postimg.cc/rwDr8X1d/IMG-7015.gif','name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x1199),'name':'14'},{'id':_0x3ce1fb(0x377),'url':_0x3ce1fb(0x14e2),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x516),'name':'14'},{'id':'frame_14','url':_0x3ce1fb(0x7c4),'name':'14'},{'id':'frame_13','url':_0x3ce1fb(0x1237),'name':'13'},{'id':'frame_14','url':_0x3ce1fb(0x155e),'name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x135c),'name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0xd03),'name':'14'},{'id':_0x3ce1fb(0x377),'url':_0x3ce1fb(0xdcc),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x1025),'name':'14'},{'id':_0x3ce1fb(0x1146),'url':'https://i.postimg.cc/LscBkxZb/mmexport1751017556565.gif','name':'14'},{'id':_0x3ce1fb(0x377),'url':_0x3ce1fb(0x1033),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':'https://i.postimg.cc/8kHCQwbQ/mmexport1751020645824.gif','name':'14'},{'id':'frame_14','url':_0x3ce1fb(0x1225),'name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0xb10),'name':'14'},{'id':'frame_13','url':_0x3ce1fb(0x153f),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x12c4),'name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x703),'name':'14'},{'id':_0x3ce1fb(0x377),'url':'https://i.postimg.cc/3RpmWc8c/mmexport1751033102811.gif','name':'13'},{'id':'frame_14','url':_0x3ce1fb(0x9b3),'name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0xd7f),'name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x428),'name':'14'},{'id':_0x3ce1fb(0x377),'url':_0x3ce1fb(0x31b),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':'https://i.postimg.cc/7YRbzN51/mmexport1751036276038.gif','name':'14'},{'id':'frame_14','url':_0x3ce1fb(0x11e5),'name':'14'},{'id':_0x3ce1fb(0x377),'url':_0x3ce1fb(0x843),'name':'13'},{'id':'frame_14','url':_0x3ce1fb(0x1265),'name':'14'},{'id':_0x3ce1fb(0x1146),'url':'https://i.postimg.cc/J4fwkTLW/mmexport1751038167142.gif','name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0xf67),'name':'14'},{'id':'frame_13','url':_0x3ce1fb(0x7c3),'name':'13'},{'id':'frame_14','url':_0x3ce1fb(0x1096),'name':'14'},{'id':'frame_14','url':_0x3ce1fb(0x12a2),'name':'14'},{'id':_0x3ce1fb(0x377),'url':'https://i.postimg.cc/8PsK20jQ/IMG-7236.gif','name':'13'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x31d),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/sXwm8Yzg/IMG-7234.gif','name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x85c),'name':'14'},{'id':'frame_13','url':_0x3ce1fb(0x7de),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x3d7),'name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x52d),'name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/pddJj9zN/IMG-7094.gif','name':'13'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x991),'name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0xaa2),'name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0xe4f),'name':'14'},{'id':'frame_13','url':_0x3ce1fb(0x124a),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x107f),'name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x1c4),'name':'14'},{'id':_0x3ce1fb(0x377),'url':_0x3ce1fb(0x1205),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0xea2),'name':'14'},{'id':'frame_14','url':_0x3ce1fb(0x33d),'name':'14'},{'id':'frame_14','url':_0x3ce1fb(0x11b1),'name':'14'},{'id':_0x3ce1fb(0x377),'url':_0x3ce1fb(0x525),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':'https://i.postimg.cc/tTWKKmTN/IMG-7073.gif','name':'14'},{'id':'frame_14','url':_0x3ce1fb(0xc41),'name':'14'},{'id':_0x3ce1fb(0x377),'url':'https://i.postimg.cc/rmRVKJpD/IMG-7087.gif','name':'13'},{'id':_0x3ce1fb(0x1146),'url':'https://i.postimg.cc/zvWGPjms/IMG-7090.gif','name':'14'},{'id':_0x3ce1fb(0x1146),'url':'https://i.postimg.cc/YSkqDg8V/IMG-7092.gif','name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x29f),'name':'14'},{'id':_0x3ce1fb(0x377),'url':'https://i.postimg.cc/tTpZ6wLs/IMG-7095.gif','name':'13'},{'id':'frame_14','url':_0x3ce1fb(0xeb6),'name':'14'},{'id':_0x3ce1fb(0x1146),'url':'https://i.postimg.cc/wMxmCZVC/IMG-7099.gif','name':'14'},{'id':_0x3ce1fb(0x377),'url':_0x3ce1fb(0xee6),'name':'13'},{'id':_0x3ce1fb(0x1146),'url':'https://i.postimg.cc/B6T59xGK/IMG-7101.gif','name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x1568),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/htZppbS4/IMG-7107.gif','name':'14'},{'id':_0x3ce1fb(0x377),'url':'https://i.postimg.cc/hPgyjtyn/IMG-7108.gif','name':'13'},{'id':_0x3ce1fb(0x1146),'url':'https://i.postimg.cc/HLKvs0Kv/IMG-7109.gif','name':'14'},{'id':_0x3ce1fb(0x1146),'url':'https://i.postimg.cc/wjwbnYkp/IMG-7111.gif','name':'14'},{'id':_0x3ce1fb(0x377),'url':_0x3ce1fb(0x316),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/SNWBTP5S/IMG-7113.gif','name':'14'},{'id':_0x3ce1fb(0x1146),'url':_0x3ce1fb(0x4c5),'name':'14'}];let _0x16699d={'chats':{},'activeChatId':null,'globalSettings':{},'apiConfig':{},'userStickers':[],'worldBooks':[],'personaPresets':[],'qzoneSettings':{},'activeAlbumId':null,'cache':{'songs':new Map(),'lyrics':new Map()},'ttsCache':new Map()},_0x1b881d={'isActive':![],'gameMode':null,'chatId':null,'players':[],'currentDay':0x1,'currentPhase':_0x3ce1fb(0x897),'nightActions':{},'gameLog':[],'discussionLog':[],'voteResults':{},'electionInfo':{'candidates':[],'votes':{}},'sheriffId':null,'lastFailedAction':null},_0x21863c=0x0;const _0x1c5d3d=0xf;let _0x410e8d=0x0;const _0x2b08fb=0xa;let _0x22676c=[],_0x49c6c5={'isActive':![],'activeChatId':null,'isPlaying':![],'playlist':[],'currentIndex':-0x1,'playMode':_0x3ce1fb(0x12e7),'totalElapsedTime':0x0,'timerId':null,'parsedLyrics':[],'currentLyricIndex':-0x1},_0x17a241={'isOpen':![],'activePostId':null,'panelEl':null,'gridEl':null};const _0x204b9a=document['getElementById'](_0x3ce1fb(0x5dd));let _0x45df0e=null,_0x202b41=![],_0xfbc7f1=0x0,_0x52fc15=null,_0x1085af=![],_0xf2c276=_0x3ce1fb(0xd49),_0x355e3f=new Set(),_0x415cd3=null,_0x2e273c=![],_0x1f1c25=null,_0x497762=null,_0x34c5ec=![],_0x3accf1=![],_0x277943=![],_0xe11400=![],_0x5ba26c=[],_0x5694c7=null,_0x1dd459=null,_0x5a9d1f={},_0x441f4f=null,_0x36911a=null,_0x4d2649=null,_0x310075=null,_0x4f0bb5=null,_0x23947b=null,_0x4ba2c2=null,_0x4cb957=[],_0x512b70=null,_0x44b2ae=null,_0xbc5d8=new Set(),_0x4a0ce7=null,_0x333bfd=null,_0x966e44=null,_0x302509={'isOpen':![],'photos':[],'currentIndex':-0x1},_0x5711af=0x0,_0x53c21a=![],_0x4c22f5=new Set(),_0x47dadd=null;const _0x202ba5=_0x3ce1fb(0x1ea),_0x5c1dc1=_0x3ce1fb(0x7cf),_0x3ca5ef=_0x3ce1fb(0x4c2),_0x580bff=_0x3ce1fb(0x1484);let _0x520eda,_0x49a146={};const _0x4e01dd='https://www.myinstants.com/media/sounds/notification-sound-2.mp3';let _0x4c7ec4={},_0xcb0ccc={},_0x35b0e8=null;const _0x4dabf6={'qq':_0x3ce1fb(0xd0c),'world-book':_0x3ce1fb(0x3a9),'wallpaper':'https://i.postimg.cc/T1j03pQr/IMG-6440.jpg','renderer':_0x3ce1fb(0x816),'api-settings':_0x3ce1fb(0x10ff),'font':_0x3ce1fb(0xf72),'char-phone':_0x3ce1fb(0x4a8),'douban':_0x3ce1fb(0x9c0),'preset':_0x3ce1fb(0x198),'tutorial':_0x3ce1fb(0x9d7),'werewolf':'https://i.postimg.cc/k401K5g7/IMG-7304.jpg','x':'https://i.postimg.cc/Y9d3BztC/1.png'},_0xde8933={'qq':'https://i.postimg.cc/MTC3Tkw8/IMG-6436.jpg','album':_0x3ce1fb(0x3a9),'browser':'https://i.postimg.cc/KzC2gTq6/IMG-7276.jpg','taobao':_0x3ce1fb(0x7df),'memo':_0x3ce1fb(0x108f),'diary':_0x3ce1fb(0x1312),'amap':_0x3ce1fb(0x141b),'usage':_0x3ce1fb(0x9cb),'music':'https://is1-ssl.mzstatic.com/image/thumb/Purple112/v4/64/9d/21/649d21e8-a151-6136-3914-256e54f15d9a/AppIcon-0-0-1x_U007emarketing-0-0-0-7-0-0-sRGB-0-0-0-GLES2_U002c0-512MB-85-220-0-0.png/1200x630wa.png','ephone':_0x3ce1fb(0x4a8)};let _0x5d89da=null;const _0x346c=/(^https:\/\/i\.postimg\.cc\/.+|^https:\/\/files\.catbox\.moe\/.+|^https?:\/\/sharkpan\.xyz\/.+|^data:image|\.(png|jpg|jpeg|gif|webp)\?.*$|\.(png|jpg|jpeg|gif|webp)$)/i;let _0xf1800c=0x0,_0x2f7026=0x1,_0x3db272={'hasShown40':![],'hasShown20':![],'hasShown10':![]},_0x4ab3e3;const _0x27d55e=document[_0x3ce1fb(0x1497)](_0x3ce1fb(0xf74));_0x27d55e['id']=_0x3ce1fb(0xb13),document[_0x3ce1fb(0x1441)][_0x3ce1fb(0x6b6)](_0x27d55e);const _0x56c4b0=document[_0x3ce1fb(0x948)]('custom-modal-overlay'),_0x593ac1=document[_0x3ce1fb(0x948)](_0x3ce1fb(0x1234)),_0x2394f3=document[_0x3ce1fb(0x948)](_0x3ce1fb(0x13e2)),_0x4481e6=document[_0x3ce1fb(0x948)](_0x3ce1fb(0xc6c)),_0x405069=document['getElementById'](_0x3ce1fb(0xbc6));let _0x3da2c3;function _0xb93174(){const _0x1e9d92=_0x3ce1fb;_0x56c4b0[_0x1e9d92(0xd54)]['add']('visible');}function _0x4d1f57(){const _0x2c9825=_0x3ce1fb;_0x56c4b0[_0x2c9825(0xd54)][_0x2c9825(0xf89)](_0x2c9825(0xfcb)),_0x4481e6[_0x2c9825(0xd54)]['remove'](_0x2c9825(0x5e8));if(_0x3da2c3)_0x3da2c3(null);}function _0x15852e(_0x38a211){const _0x33f18d=_0x3ce1fb,_0x5e0ab7=document[_0x33f18d(0x948)](_0x33f18d(0xa34)),_0x427a66=_0x38a211[_0x33f18d(0x7fd)][_0x33f18d(0x75e)]||{'vertical':'top','horizontal':'center','offset':0xa};_0x5e0ab7[_0x33f18d(0xf74)][_0x33f18d(0x102e)]=_0x33f18d(0x1098),_0x5e0ab7[_0x33f18d(0xf74)][_0x33f18d(0x5eb)]=_0x33f18d(0x1098),_0x5e0ab7[_0x33f18d(0xf74)][_0x33f18d(0x102f)]='auto',_0x5e0ab7['style']['right']='auto',_0x5e0ab7[_0x33f18d(0xf74)][_0x33f18d(0x79c)]=_0x33f18d(0x12fe);_0x427a66['vertical']===_0x33f18d(0x102e)?_0x5e0ab7[_0x33f18d(0xf74)][_0x33f18d(0x102e)]=_0x427a66[_0x33f18d(0xdd9)]+'px':_0x5e0ab7[_0x33f18d(0xf74)][_0x33f18d(0x5eb)]=_0x427a66[_0x33f18d(0xdd9)]+'px';switch(_0x427a66[_0x33f18d(0x1082)]){case _0x33f18d(0x102f):_0x5e0ab7[_0x33f18d(0xf74)][_0x33f18d(0x102f)]=_0x33f18d(0x97e);break;case'right':_0x5e0ab7[_0x33f18d(0xf74)][_0x33f18d(0xf71)]='15px';break;case _0x33f18d(0x8f7):default:_0x5e0ab7[_0x33f18d(0xf74)][_0x33f18d(0x102f)]=_0x33f18d(0x1257),_0x5e0ab7['style'][_0x33f18d(0x79c)]='translateX(-50%)';break;}}async function _0x3e949d(_0x30e4ff){const _0x4fbeb6=_0x3ce1fb,_0x5bceb0=_0x30e4ff[_0x4fbeb6(0xa50)][_0x4fbeb6(0x10b0)][0x0];if(!_0x5bceb0)return;const _0xa63e17=await new Promise(_0x1647f4=>{const _0x3d20d5=_0x4fbeb6,_0x2fe996=new FileReader();_0x2fe996[_0x3d20d5(0x33a)]=()=>_0x1647f4(_0x2fe996['result']),_0x2fe996[_0x3d20d5(0x5a5)](_0x5bceb0);});await _0x104485('请稍候...',_0x4fbeb6(0x1130));try{const _0x28fa32=await _0x455686(_0xa63e17);if(!_0x28fa32)throw new Error(_0x4fbeb6(0x9f9));const _0x1a6ed3=_0x16699d['chats'][_0x16699d['activeChatId']];!_0x1a6ed3['settings'][_0x4fbeb6(0x1506)]&&(_0x1a6ed3[_0x4fbeb6(0x7fd)][_0x4fbeb6(0x1506)]=[]),_0x1a6ed3[_0x4fbeb6(0x7fd)][_0x4fbeb6(0x1506)]['push']({'name':_0x28fa32,'url':_0xa63e17}),await _0x6ed281[_0x4fbeb6(0x1474)][_0x4fbeb6(0x90c)](_0x1a6ed3),_0x1d86f6(),await _0x104485('上传成功！',_0x4fbeb6(0x48e)+_0x28fa32+'”');}catch(_0x87cbd8){console['error'](_0x4fbeb6(0x406),_0x87cbd8),await _0x104485(_0x4fbeb6(0xb6c),_0x4fbeb6(0xeba)+_0x87cbd8['message']);}finally{_0x30e4ff[_0x4fbeb6(0xa50)][_0x4fbeb6(0x5bc)]=null;}}async function _0x129d4b(_0x19e098){const _0x1c3731=_0x3ce1fb,_0x3ebd7e=_0x19e098[_0x1c3731(0xa50)][_0x1c3731(0x10b0)][0x0];if(!_0x3ebd7e)return;const _0x5c0d17=await new Promise(_0x2598da=>{const _0x404d94=_0x1c3731,_0x36830c=new FileReader();_0x36830c['onload']=()=>_0x2598da(_0x36830c[_0x404d94(0x22a)]),_0x36830c[_0x404d94(0x5a5)](_0x3ebd7e);});await _0x104485(_0x1c3731(0x960),'正在请求AI为新头像命名...');try{const _0x196bec=await _0x455686(_0x5c0d17);if(!_0x196bec)throw new Error(_0x1c3731(0x9f9));const _0x3a8311=_0x16699d[_0x1c3731(0x1474)][_0x16699d[_0x1c3731(0xf5a)]];!_0x3a8311[_0x1c3731(0x7fd)]['aiAvatarLibrary']&&(_0x3a8311['settings'][_0x1c3731(0x13ab)]=[]),_0x3a8311[_0x1c3731(0x7fd)][_0x1c3731(0x13ab)][_0x1c3731(0x1001)]({'name':_0x196bec,'url':_0x5c0d17}),await _0x6ed281[_0x1c3731(0x1474)][_0x1c3731(0x90c)](_0x3a8311),_0x1658c0(),await _0x104485(_0x1c3731(0x1006),'AI已将新头像命名为：“'+_0x196bec+'”');}catch(_0x5d879a){console[_0x1c3731(0xc3e)](_0x1c3731(0xc2d),_0x5d879a),await _0x104485(_0x1c3731(0xb6c),_0x1c3731(0xeba)+_0x5d879a['message']);}finally{_0x19e098[_0x1c3731(0xa50)]['value']=null;}}async function _0x455686(_0x293c2b){const _0x295dbf=_0x3ce1fb,_0x4a1f71=_0x16699d['apiConfig'][_0x295dbf(0xde5)]&&_0x16699d[_0x295dbf(0x79e)][_0x295dbf(0x11bf)]&&_0x16699d[_0x295dbf(0x79e)][_0x295dbf(0x688)],{proxyUrl:_0x9a5272,apiKey:_0x26a7bc,model:_0x132627}=_0x4a1f71?{'proxyUrl':_0x16699d[_0x295dbf(0x79e)][_0x295dbf(0xde5)],'apiKey':_0x16699d['apiConfig'][_0x295dbf(0x11bf)],'model':_0x16699d[_0x295dbf(0x79e)][_0x295dbf(0x688)]}:_0x16699d[_0x295dbf(0x79e)];if(!_0x9a5272||!_0x26a7bc||!_0x132627)throw new Error(_0x295dbf(0x1148));const _0x5d3833='请为这张图片起一个简洁的、适合作为头像库标签的名字。例如：“微笑自拍”、“阳光下的猫咪”、“蓝发动漫少女”。请直接回答名字，不要加任何多余的解释。';let _0x4d8913=_0x9a5272[_0x295dbf(0x1336)](_0x295dbf(0x708)),_0x4cddea;if(_0x4d8913){const _0x1e0d65=_0x293c2b[_0x295dbf(0x9a3)](/^data:(.*);base64/)[0x1],_0x3c74a4=_0x293c2b['split'](',')[0x1],_0x314e29={'contents':[{'parts':[{'text':_0x5d3833},{'inline_data':{'mime_type':_0x1e0d65,'data':_0x3c74a4}}]}]};_0x4cddea=await fetch(_0x9a5272+'/'+_0x132627+':generateContent?key='+_0x26a7bc,{'method':'POST','headers':{'Content-Type':_0x295dbf(0x479)},'body':JSON['stringify'](_0x314e29)});}else{const _0x2318c5={'model':_0x132627,'messages':[{'role':_0x295dbf(0xaeb),'content':[{'type':_0x295dbf(0x9ea),'text':_0x5d3833},{'type':_0x295dbf(0x1b0),'image_url':{'url':_0x293c2b}}]}],'max_tokens':0x32};_0x4cddea=await fetch(_0x9a5272+_0x295dbf(0x110e),{'method':_0x295dbf(0xdca),'headers':{'Content-Type':'application/json','Authorization':_0x295dbf(0xb0e)+_0x26a7bc},'body':JSON['stringify'](_0x2318c5)});}if(!_0x4cddea['ok']){const _0x2fdade=await _0x4cddea[_0x295dbf(0x21d)]();throw new Error('API\x20错误:\x20'+_0x2fdade[_0x295dbf(0xc3e)][_0x295dbf(0x74b)]);}const _0x1255d2=await _0x4cddea['json']();let _0x32a426=_0x4d8913?getGeminiResponseText(_0x1255d2):_0x1255d2[_0x295dbf(0xc11)][0x0][_0x295dbf(0x74b)][_0x295dbf(0xede)];return _0x32a426[_0x295dbf(0x2a8)]()[_0x295dbf(0x14e9)](/["'“”‘’]/g,'');}async function _0x386598(_0x4518cb){const _0x29af43=_0x3ce1fb;if(!_0x4518cb||_0x4518cb[_0x29af43(0x1173)]){console[_0x29af43(0x9c1)](_0x29af43(0x1555));return;}const _0x2a3d53=_0x4518cb['id'],_0x1a1b7b=_0x4518cb['name'],_0x41347f=_0x4518cb['originalName'];console['log'](_0x29af43(0x1231)+_0x2a3d53+_0x29af43(0x6d7));for(const _0xab1e5 in _0x16699d['chats']){const _0x5bfad1=_0x16699d['chats'][_0xab1e5];if(_0x5bfad1['isGroup']&&_0x5bfad1[_0x29af43(0x10a2)]){const _0x318170=_0x5bfad1[_0x29af43(0x10a2)][_0x29af43(0x1402)](_0x37c207=>_0x37c207['id']===_0x2a3d53);if(_0x318170){let _0xcabead=![];_0x318170[_0x29af43(0x347)]!==_0x1a1b7b&&(_0x318170[_0x29af43(0x347)]=_0x1a1b7b,_0xcabead=!![]),_0x318170[_0x29af43(0x628)]!==_0x41347f&&(_0x318170[_0x29af43(0x628)]=_0x41347f,_0xcabead=!![]),_0xcabead&&(await _0x6ed281[_0x29af43(0x1474)][_0x29af43(0x90c)](_0x5bfad1),console[_0x29af43(0x498)](_0x29af43(0x760)+_0x5bfad1[_0x29af43(0x1467)]+'\x22\x20中的成员信息更新'));}}}}async function _0x62bf8a(_0x3299e0){const _0x478c55=_0x3ce1fb;if(!_0x3299e0||_0x3299e0[_0x478c55(0x1173)]){console[_0x478c55(0x9c1)]('syncCharacterAvatarInGroups:\x20传入的不是有效的单聊对象，已跳过同步。');return;}const _0x38e55d=_0x3299e0['id'],_0x2b5a2c=_0x3299e0['settings'][_0x478c55(0x156d)];console[_0x478c55(0x498)](_0x478c55(0x1231)+_0x38e55d+'\x20同步所有群聊内的头像...');for(const _0x26ac57 of Object[_0x478c55(0x1166)](_0x16699d[_0x478c55(0x1474)])){if(_0x26ac57['isGroup']&&_0x26ac57[_0x478c55(0x10a2)]){const _0x3343f9=_0x26ac57[_0x478c55(0x10a2)][_0x478c55(0x1402)](_0x4d8f13=>_0x4d8f13['id']===_0x38e55d);_0x3343f9&&_0x3343f9[_0x478c55(0x63e)]!==_0x2b5a2c&&(_0x3343f9[_0x478c55(0x63e)]=_0x2b5a2c,await _0x6ed281[_0x478c55(0x1474)][_0x478c55(0x90c)](_0x26ac57),console[_0x478c55(0x498)](_0x478c55(0xd30)+_0x38e55d+'\x20的新头像同步到群聊\x20\x22'+_0x26ac57[_0x478c55(0x1467)]+'\x22'));}}}function _0x589066(_0x487c64,_0x302788){const _0x2237a6=_0x3ce1fb;if(!_0x487c64||!_0x487c64['isGroup']||!_0x302788)return _0x302788;const _0xee8922=_0x16699d[_0x2237a6(0x66e)]['nickname']||'{{user}}';if(_0x302788===_0xee8922)return _0x487c64[_0x2237a6(0x7fd)][_0x2237a6(0x1371)]||'我';const _0x4972f5=_0x487c64['members'][_0x2237a6(0x1402)](_0x558b0a=>_0x558b0a[_0x2237a6(0x628)]===_0x302788);return _0x4972f5?_0x4972f5['groupNickname']:_0x302788;}function _0x52f2b0(_0x4a6570){const _0x9caece=_0x3ce1fb;document['querySelectorAll'](_0x9caece(0x118a))['forEach'](_0x279503=>{const _0x67b293=_0x9caece;_0x279503[_0x67b293(0xd54)]['toggle']('active',_0x279503[_0x67b293(0x606)][_0x67b293(0xd86)]===_0x4a6570);}),document['querySelectorAll'](_0x9caece(0xc86))[_0x9caece(0x427)](_0x3e5198=>{const _0x592003=_0x9caece;_0x3e5198[_0x592003(0xd54)][_0x592003(0x69d)]('active',_0x3e5198[_0x592003(0x606)][_0x592003(0xd86)]===_0x4a6570);});}function _0x18969a(_0x59840e){const _0x4cf8ec=_0x3ce1fb;if(!_0x59840e)return'';if(_0x16699d['qzoneSettings']&&_0x59840e===_0x16699d[_0x4cf8ec(0x66e)][_0x4cf8ec(0xf4d)])return _0x16699d['qzoneSettings']['nickname'];let _0x257c57=Object[_0x4cf8ec(0x1166)](_0x16699d[_0x4cf8ec(0x1474)])[_0x4cf8ec(0x1402)](_0xb72748=>!_0xb72748[_0x4cf8ec(0x1173)]&&_0xb72748[_0x4cf8ec(0x628)]===_0x59840e);if(_0x257c57)return _0x257c57['name'];_0x257c57=Object['values'](_0x16699d[_0x4cf8ec(0x1474)])[_0x4cf8ec(0x1402)](_0x59bc5c=>!_0x59bc5c[_0x4cf8ec(0x1173)]&&(_0x59bc5c[_0x4cf8ec(0xace)]&&_0x59bc5c[_0x4cf8ec(0xace)]['includes'](_0x59840e)));if(_0x257c57)return _0x257c57['name'];return _0x59840e;}function _0x2cdd20(_0x59c73d,_0x2402b4=null){const _0x2430f4=_0x3ce1fb;if(!_0x59c73d||typeof _0x59c73d!==_0x2430f4(0x273)||!_0x59c73d[_0x2430f4(0x1336)](_0x2430f4(0xdd4)))return _0x59c73d;return _0x59c73d[_0x2430f4(0x14e9)](/@\[\[([^\]]+)\]\]/g,(_0x57c4ee,_0x236b7e)=>{const _0x2df462=_0x2430f4,_0x31261e=_0x236b7e[_0x2df462(0x2a8)]();let _0x59bcdc;return _0x2402b4&&_0x2402b4[_0x2df462(0x1173)]?_0x59bcdc=_0x589066(_0x2402b4,_0x31261e):_0x59bcdc=_0x18969a(_0x31261e),'@'+_0x59bcdc;});}function _0xa6b74a(_0x4251a6,_0x722593,_0x2f617e={}){return new Promise(_0x135c9a=>{const _0x5c3c7a=_0x6c9e;_0x3da2c3=_0x135c9a,_0x593ac1[_0x5c3c7a(0x10cb)]=_0x4251a6,_0x2394f3[_0x5c3c7a(0xb6f)]=_0x5c3c7a(0x51b)+_0x722593+_0x5c3c7a(0x79d);const _0x17566d=document[_0x5c3c7a(0x948)](_0x5c3c7a(0xc6c)),_0x25cb70=document[_0x5c3c7a(0x948)](_0x5c3c7a(0xbc6));_0x25cb70[_0x5c3c7a(0xf74)][_0x5c3c7a(0x11fd)]='block',_0x17566d['textContent']=_0x2f617e[_0x5c3c7a(0x86d)]||'确定',_0x25cb70[_0x5c3c7a(0x10cb)]=_0x2f617e['cancelText']||'取消',_0x2f617e[_0x5c3c7a(0x12de)]?_0x17566d[_0x5c3c7a(0xd54)][_0x5c3c7a(0xbd0)](_0x2f617e[_0x5c3c7a(0x12de)]):_0x17566d[_0x5c3c7a(0xd54)][_0x5c3c7a(0xf89)]('btn-danger'),_0x17566d['onclick']=()=>{_0x135c9a(!![]),_0x4d1f57();},_0x25cb70[_0x5c3c7a(0xe8d)]=()=>{_0x135c9a(![]),_0x4d1f57();},_0xb93174();});}function _0x139ac6(_0x4ea91='📥\x20图片下载中...',_0x3274b8=_0x3ce1fb(0xa9e)){const _0x160090=_0x3ce1fb,_0x342b63=document[_0x160090(0x1497)](_0x160090(0x379));_0x342b63['textContent']=_0x4ea91,_0x342b63['style'][_0x160090(0x8e7)]=_0x160090(0x13a8)+(_0x3274b8===_0x160090(0xa9e)?_0x160090(0x1a7):_0x160090(0x6c3))+_0x160090(0x776),document['body']['appendChild'](_0x342b63),setTimeout(()=>{const _0x2cda00=_0x160090;_0x342b63[_0x2cda00(0xf74)][_0x2cda00(0x9a2)]='1',_0x342b63[_0x2cda00(0xf74)][_0x2cda00(0x79c)]=_0x2cda00(0x1021);},0xa),setTimeout(()=>{const _0x1a2854=_0x160090;_0x342b63[_0x1a2854(0xf74)][_0x1a2854(0x9a2)]='0',_0x342b63[_0x1a2854(0xf74)][_0x1a2854(0x79c)]='translateY(-20px)',setTimeout(()=>{_0x342b63['remove']();},0x12c);},0x7d0);}function _0x31bd44(_0x400758){const _0x10e67=_0x3ce1fb;let _0x50d831=(_0x400758||'NAI_Image')[_0x10e67(0x14e9)](/[^a-zA-Z0-9\u4e00-\u9fa5\s]/g,'_')[_0x10e67(0x14e9)](/\s+/g,'_')[_0x10e67(0xeca)](0x0,0x1e);const _0x1761d1=new Date()['toISOString']()[_0x10e67(0x14e9)](/[-:]/g,'')['replace']('T','_')[_0x10e67(0x46f)]('.')[0x0];return _0x50d831+'_'+_0x1761d1+_0x10e67(0x1eb);}function _0x3f4077(_0x5013c5,_0x3fd168){const _0x20cc8d=_0x3ce1fb;try{const _0x1c1dc2=_0x31bd44(_0x3fd168),_0x41c016=document[_0x20cc8d(0x1497)]('a');_0x41c016[_0x20cc8d(0x13a6)]=_0x5013c5,_0x41c016['download']=_0x1c1dc2,_0x41c016['style']['display']=_0x20cc8d(0x12fe),document[_0x20cc8d(0xae6)]['appendChild'](_0x41c016),_0x41c016[_0x20cc8d(0x4f6)](),setTimeout(()=>{const _0x29142d=_0x20cc8d;document['body'][_0x29142d(0x15a7)](_0x41c016);},0x64),_0x139ac6('📥\x20图片下载中...');}catch(_0x139668){console[_0x20cc8d(0xc3e)]('❌\x20[NAI下载]\x20下载失败:',_0x139668),_0x139ac6(_0x20cc8d(0x269),'error');}}function _0x104485(_0x3dfcea,_0x4e416e){return new Promise(_0x35c923=>{const _0xd2ae51=_0x6c9e;_0x3da2c3=_0x35c923,_0x593ac1[_0xd2ae51(0x10cb)]=_0x3dfcea,_0x2394f3[_0xd2ae51(0xb6f)]='<p\x20style=\x22text-align:\x20left;\x20white-space:\x20pre-wrap;\x22>'+_0x4e416e+'</p>';const _0x43971a=document[_0xd2ae51(0x948)](_0xd2ae51(0xc6c)),_0x1d383b=document[_0xd2ae51(0x948)](_0xd2ae51(0xbc6));_0x1d383b[_0xd2ae51(0xf74)][_0xd2ae51(0x11fd)]='none',_0x43971a[_0xd2ae51(0x10cb)]='好的',_0x43971a['onclick']=()=>{const _0x295b86=_0xd2ae51;_0x1d383b[_0x295b86(0xf74)]['display']='block',_0x43971a[_0x295b86(0x10cb)]='确定',_0x35c923(!![]),_0x4d1f57();},_0xb93174();});}async function _0x315e2f(_0x1dfd00,_0x57ef72='内容已复制到剪贴板！'){const _0x1e3ed3=_0x3ce1fb;if(!_0x1dfd00){await _0x104485(_0x1e3ed3(0xa9d),'没有可复制的内容。');return;}try{await navigator[_0x1e3ed3(0x8f0)][_0x1e3ed3(0x9f4)](_0x1dfd00),await _0x104485(_0x1e3ed3(0x4e0),_0x57ef72);}catch(_0x537640){console[_0x1e3ed3(0xc3e)]('复制失败:',_0x537640),await _0x104485(_0x1e3ed3(0xa9d),_0x1e3ed3(0x1582));}}function _0x41b9fc(_0x1a03eb,_0x5621f3,_0x268a52='',_0x508700=_0x3ce1fb(0x9ea),_0x430027=''){return new Promise(_0x5dbc95=>{const _0x6b1777=_0x6c9e;_0x3da2c3=_0x5dbc95,_0x593ac1[_0x6b1777(0x10cb)]=_0x1a03eb;const _0x53db65='custom-prompt-input',_0x1fcdfc=_0x508700===_0x6b1777(0xc1e)?_0x6b1777(0xfd8)+_0x53db65+_0x6b1777(0x14a9)+_0x5621f3+_0x6b1777(0x9c9)+_0x268a52+_0x6b1777(0x23d):'<input\x20type=\x22'+_0x508700+_0x6b1777(0x9dd)+_0x53db65+'\x22\x20placeholder=\x22'+_0x5621f3+'\x22\x20value=\x22'+_0x268a52+'\x22>';_0x2394f3[_0x6b1777(0xb6f)]=_0x430027+_0x1fcdfc;const _0x540ec7=document[_0x6b1777(0x948)](_0x53db65);_0x2394f3['querySelectorAll'](_0x6b1777(0x15b1))[_0x6b1777(0x427)](_0x3b3331=>{const _0x38f9b3=_0x6b1777;_0x3b3331['addEventListener'](_0x38f9b3(0x4f6),()=>{const _0x151134=_0x38f9b3,_0xb0942e=_0x3b3331[_0x151134(0x606)]['template'];if(_0xb0942e)try{const _0x5af099=JSON[_0x151134(0xde0)](_0xb0942e);_0x540ec7[_0x151134(0x5bc)]=JSON[_0x151134(0x526)](_0x5af099,null,0x2),_0x540ec7[_0x151134(0x348)]();}catch(_0x916b2e){console[_0x151134(0xc3e)](_0x151134(0xda9),_0x916b2e);}});});const _0x4a3152=document[_0x6b1777(0x948)](_0x6b1777(0xc6c)),_0x14641c=document['getElementById']('custom-modal-cancel');_0x4a3152[_0x6b1777(0xe8d)]=()=>{const _0x116821=_0x6b1777;_0x5dbc95(_0x540ec7[_0x116821(0x5bc)]),_0x4d1f57();},_0x14641c[_0x6b1777(0xe8d)]=()=>{_0x5dbc95(null),_0x4d1f57();},_0xb93174(),setTimeout(()=>_0x540ec7['focus'](),0x64);});}function _0x9286bb(_0xe40343,_0x26bc67){return new Promise(_0x5604be=>{const _0x113615=_0x6c9e,_0x5136ac=document['getElementById'](_0x113615(0x7f9)),_0x321a63=document[_0x113615(0x948)](_0x113615(0x1234)),_0x2b323c=document[_0x113615(0x948)](_0x113615(0x13e2)),_0x45786a=document[_0x113615(0xfeb)](_0x113615(0x2de));_0x321a63[_0x113615(0x10cb)]=_0xe40343,_0x2b323c['innerHTML']='',_0x45786a['innerHTML']='',_0x45786a[_0x113615(0xf74)][_0x113615(0x266)]=_0x113615(0x118e),_0x26bc67[_0x113615(0x427)](_0x2db004=>{const _0x1e9050=_0x113615,_0xa95a31=document[_0x1e9050(0x1497)](_0x1e9050(0x4e6));_0xa95a31['textContent']=_0x2db004[_0x1e9050(0x9ea)],_0xa95a31[_0x1e9050(0xe8d)]=()=>{const _0x4cc2f3=_0x1e9050;_0x5136ac[_0x4cc2f3(0xd54)][_0x4cc2f3(0xf89)]('visible'),_0x5604be(_0x2db004[_0x4cc2f3(0x5bc)]);},_0x45786a[_0x1e9050(0x6b6)](_0xa95a31);});const _0x3a11bb=document[_0x113615(0x1497)](_0x113615(0x4e6));_0x3a11bb['textContent']='取消',_0x3a11bb[_0x113615(0xf74)]['marginTop']=_0x113615(0x1d2),_0x3a11bb[_0x113615(0xf74)][_0x113615(0xb3c)]=_0x113615(0x1d2),_0x3a11bb['style'][_0x113615(0xdb4)]='#f0f0f0',_0x3a11bb[_0x113615(0xe8d)]=()=>{const _0x4596a2=_0x113615;_0x5136ac['classList'][_0x4596a2(0xf89)]('visible'),_0x5604be(null);},_0x45786a[_0x113615(0x6b6)](_0x3a11bb),_0x5136ac[_0x113615(0xd54)]['add'](_0x113615(0xfcb));})['finally'](()=>{const _0x298ef7=_0x6c9e,_0x28a35b=document[_0x298ef7(0xfeb)](_0x298ef7(0x2de));_0x28a35b[_0x298ef7(0xf74)][_0x298ef7(0x266)]=_0x298ef7(0x824),_0x28a35b[_0x298ef7(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-confirm\x22\x20class=\x22confirm-btn\x22>确定</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',document[_0x298ef7(0x948)](_0x298ef7(0xbc6))[_0x298ef7(0x339)]('click',_0x4d1f57);});}async function _0x6572e5(){const _0x54524e=_0x3ce1fb,_0x1e8270=await _0x9286bb(_0x54524e(0x14dc),[{'text':_0x54524e(0xce4),'value':_0x54524e(0x96f)},{'text':_0x54524e(0x1d6),'value':_0x54524e(0xe05)}]);if(_0x1e8270===_0x54524e(0x96f))return new Promise(_0x38d231=>{const _0x15d06a=_0x54524e,_0x29e732=document['getElementById'](_0x15d06a(0xac7)),_0x4f1cd2=_0x3c6923=>{const _0xf53dd6=_0x15d06a,_0x2aaad5=_0x3c6923[_0xf53dd6(0xa50)][_0xf53dd6(0x10b0)][0x0];if(_0x2aaad5){const _0x15394e=new FileReader();_0x15394e[_0xf53dd6(0x33a)]=_0x3aa367=>_0x38d231(_0x3aa367[_0xf53dd6(0xa50)][_0xf53dd6(0x22a)]),_0x15394e[_0xf53dd6(0x12eb)]=()=>_0x38d231(''),_0x15394e['readAsText'](_0x2aaad5);}else _0x38d231(null);_0x29e732[_0xf53dd6(0x1558)](_0xf53dd6(0x145c),_0x4f1cd2),_0x29e732[_0xf53dd6(0x5bc)]='';};_0x29e732['addEventListener'](_0x15d06a(0x145c),_0x4f1cd2,{'once':!![]}),_0x29e732[_0x15d06a(0x4f6)]();});else{if(_0x1e8270===_0x54524e(0xe05)){const _0x3efaa0=await _0x41b9fc(_0x54524e(0x5c3),_0x54524e(0x1526),'',_0x54524e(0xc1e));if(_0x3efaa0){const _0x167230=_0x3efaa0['replace'](/\[/g,'\x0a[')[_0x54524e(0x2a8)]();return _0x167230;}return _0x3efaa0;}else return null;}}_0x6ed281[_0x3ce1fb(0x24d)](0x28)[_0x3ce1fb(0x718)]({'doubanPosts':_0x3ce1fb(0x80a),'chats':_0x3ce1fb(0xc66),'apiConfig':_0x3ce1fb(0xef9),'globalSettings':_0x3ce1fb(0xf62),'userStickers':_0x3ce1fb(0xf13),'worldBooks':_0x3ce1fb(0xf48),'worldBookCategories':_0x3ce1fb(0x8ad),'musicLibrary':_0x3ce1fb(0xf62),'personaPresets':_0x3ce1fb(0xf62),'qzoneSettings':_0x3ce1fb(0xf62),'qzonePosts':_0x3ce1fb(0xf56),'qzoneAlbums':'++id,\x20name,\x20createdAt','qzonePhotos':_0x3ce1fb(0x9c2),'favorites':_0x3ce1fb(0xde1),'qzoneGroups':_0x3ce1fb(0x8ad),'memories':_0x3ce1fb(0x144e),'callRecords':_0x3ce1fb(0x700),'shoppingProducts':_0x3ce1fb(0x463),'shoppingCategories':'++id,\x20name','apiPresets':_0x3ce1fb(0x8ad),'renderingRules':_0x3ce1fb(0xe0d),'appearancePresets':'++id,\x20name,\x20type','stickerCategories':_0x3ce1fb(0x8ad),'customAvatarFrames':_0x3ce1fb(0x8ad),'presets':_0x3ce1fb(0xf48),'presetCategories':_0x3ce1fb(0x8ad),'readingLibrary':_0x3ce1fb(0x1426),'npcs':_0x3ce1fb(0xb8f),'npcGroups':_0x3ce1fb(0x8ad)})[_0x3ce1fb(0xba6)](_0x2f2095=>{const _0x53cc1e=_0x3ce1fb;return _0x2f2095[_0x53cc1e(0x437)](_0x53cc1e(0x44c))[_0x53cc1e(0x2fe)]()['modify'](_0x45d755=>{const _0x5798b6=_0x53cc1e;if(typeof _0x45d755[_0x5798b6(0xede)]==='string'&&_0x45d755['content'][_0x5798b6(0x2a8)]()!=='')_0x45d755[_0x5798b6(0xede)]=[{'keys':[],'comment':_0x5798b6(0x292),'content':_0x45d755[_0x5798b6(0xede)]}];else!Array[_0x5798b6(0x1524)](_0x45d755[_0x5798b6(0xede)])&&(_0x45d755[_0x5798b6(0xede)]=[]);_0x45d755[_0x5798b6(0xede)][_0x5798b6(0x427)](_0x4d98c0=>{const _0x2b8e79=_0x5798b6;typeof _0x4d98c0['enabled']==='undefined'&&(_0x4d98c0[_0x2b8e79(0x111f)]=!![]);});});}),window['db']=_0x6ed281;function _0x58c3b1(_0x48e38a){const _0x484276=_0x3ce1fb;_0x48e38a===_0x484276(0x82a)&&(window[_0x484276(0x9ad)](),_0x779269('messages-view'));if(_0x48e38a===_0x484276(0x96c))window[_0x484276(0x102b)]();if(_0x48e38a==='wallpaper-screen')window[_0x484276(0x6a2)]();if(_0x48e38a==='world-book-screen')window[_0x484276(0x1151)]();if(_0x48e38a===_0x484276(0xcc2))window[_0x484276(0x1272)]();if(_0x48e38a===_0x484276(0x197))_0x34e951();document[_0x484276(0x1188)]('.screen')['forEach'](_0x4a0855=>_0x4a0855[_0x484276(0xd54)][_0x484276(0xf89)]('active'));const _0x188778=document[_0x484276(0x948)](_0x48e38a);if(_0x188778)_0x188778['classList'][_0x484276(0xbd0)](_0x484276(0x115e));if(_0x48e38a==='chat-interface-screen')window['updateListenTogetherIconProxy'](_0x16699d[_0x484276(0xf5a)]);_0x48e38a===_0x484276(0x353)&&(_0x56bae4(),document['getElementById'](_0x484276(0x1024))['value']=_0x16699d[_0x484276(0xf9c)][_0x484276(0x672)]||'',_0x495393(_0x16699d[_0x484276(0xf9c)]['fontUrl']||'',!![]));}window[_0x3ce1fb(0x12e9)]=()=>{};function _0x779269(_0x47b911){const _0x47bee1=_0x3ce1fb,_0x18f348=document[_0x47bee1(0x948)](_0x47bee1(0x82a)),_0x119eed={'messages-view':document[_0x47bee1(0x948)](_0x47bee1(0x14d7)),'qzone-screen':document['getElementById'](_0x47bee1(0x442)),'favorites-view':document[_0x47bee1(0x948)](_0x47bee1(0x11e0)),'memories-view':document[_0x47bee1(0x948)]('memories-view'),'npc-list-view':document[_0x47bee1(0x948)](_0x47bee1(0x14bb))},_0x22881f=document[_0x47bee1(0x948)]('main-chat-list-header'),_0xd7ab8a=document[_0x47bee1(0x948)](_0x47bee1(0x983));_0x53c21a&&document[_0x47bee1(0x948)](_0x47bee1(0x415))[_0x47bee1(0x4f6)]();Object[_0x47bee1(0x1166)](_0x119eed)[_0x47bee1(0x427)](_0xa64c90=>_0xa64c90[_0x47bee1(0xd54)][_0x47bee1(0xf89)](_0x47bee1(0x115e)));_0x119eed[_0x47b911]&&_0x119eed[_0x47b911][_0x47bee1(0xd54)]['add']('active');document[_0x47bee1(0x1188)]('#chat-list-bottom-nav\x20.nav-item')['forEach'](_0x31904a=>{const _0x867eb7=_0x47bee1;_0x31904a[_0x867eb7(0xd54)][_0x867eb7(0x69d)](_0x867eb7(0x115e),_0x31904a['dataset'][_0x867eb7(0x127e)]===_0x47b911);});_0x47b911===_0x47bee1(0x14d7)?(_0x22881f[_0x47bee1(0xf74)][_0x47bee1(0x11fd)]=_0x47bee1(0x6a4),_0xd7ab8a[_0x47bee1(0xf74)][_0x47bee1(0x11fd)]=_0x47bee1(0x6a4)):(_0x22881f[_0x47bee1(0xf74)][_0x47bee1(0x11fd)]=_0x47bee1(0x12fe),_0xd7ab8a[_0x47bee1(0xf74)][_0x47bee1(0x11fd)]='none');_0x47b911!=='memories-view'&&(_0xa8deb7[_0x47bee1(0x427)](_0x4909cb=>clearInterval(_0x4909cb)),_0xa8deb7=[]);switch(_0x47b911){case _0x47bee1(0x442):_0x119eed[_0x47bee1(0x442)][_0x47bee1(0xf74)][_0x47bee1(0xdb4)]='#f0f2f5',_0x255639(0x0),_0x33c3bf(),_0x4d3afb();break;case'favorites-view':_0x119eed[_0x47bee1(0x11e0)]['style'][_0x47bee1(0xdb4)]=_0x47bee1(0x584),_0x18facb();break;case _0x47bee1(0x14d7):break;case _0x47bee1(0x14bb):_0x1ea6a0();break;}}function _0x7a398e(){const _0xd622c8=_0x3ce1fb;console[_0xd622c8(0x498)](_0xd622c8(0x520));}window[_0x3ce1fb(0x1272)]=_0x7a398e;function _0x33c3bf(){const _0x2647a4=_0x3ce1fb;if(_0x16699d&&_0x16699d['qzoneSettings']){const _0xefbe10=_0x16699d[_0x2647a4(0x66e)];document[_0x2647a4(0x948)](_0x2647a4(0xab6))[_0x2647a4(0x10cb)]=_0xefbe10[_0x2647a4(0xf4d)],document['getElementById'](_0x2647a4(0x13dc))['src']=_0xefbe10[_0x2647a4(0x63e)],document[_0x2647a4(0x948)](_0x2647a4(0x94f))[_0x2647a4(0x147d)]=_0xefbe10[_0x2647a4(0x150d)];}}window[_0x3ce1fb(0xcfc)]=_0x33c3bf;async function _0x5d0d99(){const _0x570cfe=_0x3ce1fb;_0x6ed281&&_0x16699d[_0x570cfe(0x66e)]&&await _0x6ed281[_0x570cfe(0x66e)]['put'](_0x16699d[_0x570cfe(0x66e)]);}function _0x134050(_0xc68c84){const _0x27b40e=_0x3ce1fb;if(!_0xc68c84)return'';const _0x217e25=new Date(),_0x2fb3b7=new Date(_0xc68c84),_0xfa4586=Math[_0x27b40e(0x15b6)]((_0x217e25-_0x2fb3b7)/0x3e8),_0x462f84=Math[_0x27b40e(0x15b6)](_0xfa4586/0x3c),_0x5df8b7=Math[_0x27b40e(0x15b6)](_0x462f84/0x3c);if(_0x462f84<0x1)return'刚刚';if(_0x462f84<0x3c)return _0x462f84+_0x27b40e(0x25a);if(_0x5df8b7<0x18)return _0x5df8b7+_0x27b40e(0xeb2);const _0x974642=_0x2fb3b7[_0x27b40e(0x3c5)](),_0x568ace=String(_0x2fb3b7[_0x27b40e(0x12f9)]()+0x1)[_0x27b40e(0x112d)](0x2,'0'),_0x266cf3=String(_0x2fb3b7[_0x27b40e(0x13fb)]())[_0x27b40e(0x112d)](0x2,'0'),_0x18e614=String(_0x2fb3b7[_0x27b40e(0x12c1)]())[_0x27b40e(0x112d)](0x2,'0'),_0x5732c9=String(_0x2fb3b7['getMinutes']())[_0x27b40e(0x112d)](0x2,'0');return _0x217e25[_0x27b40e(0x3c5)]()===_0x974642?_0x568ace+'-'+_0x266cf3+'\x20'+_0x18e614+':'+_0x5732c9:_0x974642+'-'+_0x568ace+'-'+_0x266cf3+'\x20'+_0x18e614+':'+_0x5732c9;}function _0x2aedda(_0x359e35){const _0x11d0d4=_0x3ce1fb,_0x1c2b58=document['querySelector'](_0x11d0d4(0xbb8)+_0x359e35['id']+'\x22]'),_0x41a9c2=!!_0x1c2b58,_0x18e5e3=_0x41a9c2?_0x1c2b58:document[_0x11d0d4(0x1497)](_0x11d0d4(0x379));!_0x41a9c2&&(_0x18e5e3[_0x11d0d4(0x35b)]=_0x11d0d4(0x945),_0x18e5e3[_0x11d0d4(0x606)][_0x11d0d4(0xba5)]=_0x359e35['id']);const _0xd64b1d=_0x41a9c2?_0x18e5e3[_0x11d0d4(0xfeb)](_0x11d0d4(0x5f2)):document['createElement'](_0x11d0d4(0x379));!_0x41a9c2&&(_0xd64b1d[_0x11d0d4(0x35b)]='qzone-post-item');let _0x35b6dc='',_0x3432ce='',_0x45705d=_0x16699d[_0x11d0d4(0x66e)][_0x11d0d4(0x63e)];if(_0x359e35['authorId']===_0x11d0d4(0xaeb))_0x35b6dc=_0x16699d[_0x11d0d4(0x66e)][_0x11d0d4(0x63e)],_0x3432ce=_0x16699d[_0x11d0d4(0x66e)]['nickname'];else{if(_0x16699d[_0x11d0d4(0x1474)][_0x359e35[_0x11d0d4(0x11b9)]]){const _0x4244f2=_0x16699d['chats'][_0x359e35[_0x11d0d4(0x11b9)]];_0x35b6dc=_0x4244f2[_0x11d0d4(0x7fd)][_0x11d0d4(0x156d)]||_0x202ba5,_0x3432ce=_0x4244f2[_0x11d0d4(0x1467)];}else _0x3432ce=_0x18969a(_0x359e35[_0x11d0d4(0x122a)]),_0x35b6dc=_0x202ba5;}function _0x5ce9f6(_0x26494b){const _0xb9caa7=_0x11d0d4;let _0x26446e='';const _0xb94bce=_0x26494b[_0xb9caa7(0x15bf)]?_0xb9caa7(0xefa)+_0x5876e7(_0x26494b[_0xb9caa7(0x15bf)])[_0xb9caa7(0x14e9)](/\n/g,_0xb9caa7(0x1121))+'</div>':'';if(_0x26494b[_0xb9caa7(0x4ae)]===_0xb9caa7(0x2f6))_0x26446e=_0xb9caa7(0x1291)+_0x5876e7(_0x26494b[_0xb9caa7(0xede)])['replace'](/\n/g,_0xb9caa7(0x1121))+_0xb9caa7(0xc7f);else{if(_0x26494b['type']===_0xb9caa7(0x8f6)&&_0x26494b[_0xb9caa7(0x15b8)])_0x26446e=_0xb94bce?_0xb94bce+_0xb9caa7(0x14c4)+_0x26494b[_0xb9caa7(0x15b8)]+_0xb9caa7(0x14d4):'<img\x20src=\x22'+_0x26494b[_0xb9caa7(0x15b8)]+_0xb9caa7(0x12ee);else{if(_0x26494b[_0xb9caa7(0x4ae)]===_0xb9caa7(0x1076)){const _0x1241cb=_0x16699d[_0xb9caa7(0xf9c)][_0xb9caa7(0xf46)]&&_0x26494b[_0xb9caa7(0x5d9)]?_0xb9caa7(0xbfa)+_0x26494b[_0xb9caa7(0x5d9)]:'https://i.postimg.cc/KYr2qRCK/1.jpg';_0x26446e=_0xb94bce?_0xb94bce+_0xb9caa7(0x14c4)+_0x1241cb+_0xb9caa7(0x1354)+_0x26494b[_0xb9caa7(0x7d9)]+_0xb9caa7(0x6b5):_0xb9caa7(0x4ad)+_0x1241cb+_0xb9caa7(0x1354)+_0x26494b[_0xb9caa7(0x7d9)]+'\x22>';}else{if(_0x26494b[_0xb9caa7(0x4ae)]===_0xb9caa7(0x1141)){const _0x198af6=_0x26494b[_0xb9caa7(0x159b)]||(_0x26494b[_0xb9caa7(0x15b8)]?[_0x26494b[_0xb9caa7(0x15b8)]]:[]);if(_0x198af6[_0xb9caa7(0xaf9)]>0x0){const _0x1d6f32=_0x198af6[_0xb9caa7(0xaf9)];let _0xed4704='';_0xed4704='<div\x20class=\x22post-images-grid\x20grid-'+_0x1d6f32+'\x22>',_0x198af6[_0xb9caa7(0x427)]((_0x429afd,_0x22921c)=>{const _0x2e9894=_0xb9caa7;_0xed4704+=_0x2e9894(0x4ad)+_0x429afd+'\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片'+(_0x22921c+0x1)+_0x2e9894(0x1171);}),_0xed4704+='</div>',_0x26446e=_0xb94bce?''+_0xb94bce+_0xed4704:_0xed4704;}}}}}return _0x26446e;}let _0x8fd883;if(_0x359e35[_0x11d0d4(0x4ae)]==='repost'){const _0x33c36c=_0x359e35[_0x11d0d4(0x1406)]?_0x11d0d4(0xefa)+_0x5876e7(_0x359e35[_0x11d0d4(0x1406)])[_0x11d0d4(0x14e9)](/\n/g,_0x11d0d4(0x1121))+_0x11d0d4(0xc7f):'';let _0x4e4df6=_0x202ba5,_0x10d497=_0x11d0d4(0xc29);if(_0x359e35[_0x11d0d4(0x10a1)]['authorId']===_0x11d0d4(0xaeb))_0x4e4df6=_0x16699d[_0x11d0d4(0x66e)][_0x11d0d4(0x63e)],_0x10d497=_0x16699d['qzoneSettings'][_0x11d0d4(0xf4d)];else{const _0x577c83=_0x16699d[_0x11d0d4(0x1474)][_0x359e35['originalPost'][_0x11d0d4(0x11b9)]];_0x577c83&&(_0x4e4df6=_0x577c83[_0x11d0d4(0x7fd)][_0x11d0d4(0x156d)]||_0x202ba5),_0x10d497=_0x18969a(_0x359e35[_0x11d0d4(0x10a1)][_0x11d0d4(0x122a)]);}_0x8fd883=_0x11d0d4(0xcfa)+_0x33c36c+_0x11d0d4(0xadd)+_0x4e4df6+_0x11d0d4(0xef2)+_0x10d497+_0x11d0d4(0x328)+_0x134050(_0x359e35[_0x11d0d4(0x10a1)][_0x11d0d4(0xb0a)])+_0x11d0d4(0x19a)+_0x5ce9f6(_0x359e35[_0x11d0d4(0x10a1)])+_0x11d0d4(0x3fa);}else _0x8fd883='<div\x20class=\x22post-main-content\x22>'+_0x5ce9f6(_0x359e35)+_0x11d0d4(0xc7f);let _0x459126='';if(_0x359e35[_0x11d0d4(0x494)]&&_0x359e35[_0x11d0d4(0x494)][_0x11d0d4(0xaf9)]>0x0){const _0x255cd9=_0x359e35[_0x11d0d4(0x494)][_0x11d0d4(0x8ff)](_0x3d7306=>_0x18969a(_0x3d7306))['join']('、');_0x459126=_0x11d0d4(0xfff)+_0x255cd9+_0x11d0d4(0x142b);}let _0x3ec908='';_0x359e35[_0x11d0d4(0x4d6)]&&_0x359e35[_0x11d0d4(0x4d6)]['length']>0x0&&(_0x3ec908=_0x11d0d4(0x2ad),_0x359e35[_0x11d0d4(0x4d6)]['forEach']((_0x1958d6,_0x230077)=>{const _0x420fa1=_0x11d0d4;if(typeof _0x1958d6===_0x420fa1(0xd43)&&_0x1958d6!==null&&_0x1958d6[_0x420fa1(0x9e3)]){const _0x275381=_0x1958d6[_0x420fa1(0x9e3)],_0x30e9c4=_0x18969a(_0x275381);let _0x5c3e21;_0x346c[_0x420fa1(0x367)](_0x1958d6[_0x420fa1(0x9ea)])?_0x5c3e21=_0x420fa1(0x4ad)+_0x1958d6['text']+_0x420fa1(0x2cc):_0x5c3e21=_0x5876e7(_0x1958d6['text']);let _0x3da08d='';if(_0x1958d6[_0x420fa1(0xf05)]){const _0x49c478=_0x18969a(_0x1958d6['replyTo']);_0x3da08d=_0x420fa1(0x148e)+_0x30e9c4+_0x420fa1(0x13f1)+_0x49c478+_0x420fa1(0xb88)+_0x5c3e21;}else _0x3da08d=_0x420fa1(0x148e)+_0x30e9c4+_0x420fa1(0xb88)+_0x5c3e21;_0x3ec908+=_0x420fa1(0x8e6)+_0x359e35['id']+_0x420fa1(0xba0)+_0x275381+'\x22\x20data-commenter-display-name=\x22'+_0x30e9c4+_0x420fa1(0x13e0)+_0x3da08d+_0x420fa1(0xf6c)+_0x230077+_0x420fa1(0xe68);}else _0x3ec908+='<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>'+_0x5876e7(String(_0x1958d6))+_0x420fa1(0xd46);}),_0x3ec908+=_0x11d0d4(0xc7f));const _0x5ef563=_0x16699d[_0x11d0d4(0x66e)]['nickname'],_0x5ade33=_0x359e35['likes']&&_0x359e35[_0x11d0d4(0x494)][_0x11d0d4(0x1336)](_0x5ef563),_0x5a70af=_0x16699d[_0x11d0d4(0x1238)]&&_0x16699d[_0x11d0d4(0x1238)][_0x11d0d4(0xda1)](_0x359e35['id']);let _0x1b52d9='';_0x359e35[_0x11d0d4(0x4ae)]!==_0x11d0d4(0x1f2)&&(_0x1b52d9=_0x11d0d4(0x684));_0xd64b1d[_0x11d0d4(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x35b6dc+'\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22'+_0x359e35[_0x11d0d4(0x11b9)]+_0x11d0d4(0x1013)+_0x3432ce+_0x11d0d4(0x3a2)+_0x134050(_0x359e35['timestamp'])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x8fd883+_0x11d0d4(0x568)+_0x1b52d9+_0x11d0d4(0x666)+(_0x5ade33?_0x11d0d4(0x115e):'')+'\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20'+(_0x5a70af?_0x11d0d4(0x115e):'')+_0x11d0d4(0x375)+_0x459126+_0x11d0d4(0x1009)+_0x3ec908+_0x11d0d4(0x4d8)+_0x45705d+_0x11d0d4(0xbdf);if(!_0x41a9c2){const _0x49ce67=document[_0x11d0d4(0x1497)]('div');_0x49ce67[_0x11d0d4(0x35b)]=_0x11d0d4(0xf28),_0x49ce67[_0x11d0d4(0xb6f)]='<span>删除</span>',_0x18e5e3[_0x11d0d4(0x6b6)](_0xd64b1d),_0x18e5e3[_0x11d0d4(0x6b6)](_0x49ce67);}return _0x18e5e3;}async function _0x568043(_0x18c9db){const _0x44dcab=_0x3ce1fb,_0x1a2466=await _0x6ed281['qzonePosts'][_0x44dcab(0xe8c)](_0x18c9db);if(!_0x1a2466){const _0x2b0e60=document[_0x44dcab(0xfeb)](_0x44dcab(0xbb8)+_0x18c9db+'\x22]');if(_0x2b0e60)_0x2b0e60[_0x44dcab(0xf89)]();return;}const _0x33cbf8=_0x22676c[_0x44dcab(0x1018)](_0x42e520=>_0x42e520['id']===_0x18c9db);if(_0x33cbf8>-0x1)_0x22676c[_0x33cbf8]=_0x1a2466;const _0x5d73d7=await _0x6ed281[_0x44dcab(0x1dc)][_0x44dcab(0x1117)](_0x44dcab(0x4ae))[_0x44dcab(0xba9)]('qzone_post')[_0x44dcab(0x443)]();_0x16699d[_0x44dcab(0x1238)]=new Set(_0x5d73d7[_0x44dcab(0x8ff)](_0xa4ca80=>_0xa4ca80[_0x44dcab(0xede)]['id'])),_0x2aedda(_0x1a2466);}function _0x31ced1(_0xafac96){const _0x484ef5=_0x3ce1fb,_0x5e3ede=Date['now'](),_0x55d919=Math[_0x484ef5(0x15b6)]((_0x5e3ede-_0xafac96)/0x3e8),_0x17d379=Math[_0x484ef5(0x15b6)](_0x55d919/0x3c);if(_0x17d379<0x2)return'刚刚';if(_0x17d379<0x3c)return _0x17d379+_0x484ef5(0x25a);const _0x5275fd=Math[_0x484ef5(0x15b6)](_0x17d379/0x3c);if(_0x5275fd<0x18)return _0x5275fd+_0x484ef5(0xeb2);const _0x27d57f=Math['floor'](_0x5275fd/0x18);return _0x27d57f+'天前';}async function _0x2aedda(_0x3b75d5){const _0xd86303=_0x3ce1fb,_0x38d443=document[_0xd86303(0xfeb)](_0xd86303(0xbb8)+_0x3b75d5['id']+'\x22]'),_0x3f370c=!!_0x38d443,_0x1ee027=_0x3f370c?_0x38d443:document['createElement'](_0xd86303(0x379));!_0x3f370c&&(_0x1ee027[_0xd86303(0x35b)]=_0xd86303(0x945),_0x1ee027['dataset']['postId']=_0x3b75d5['id']);const _0x25d83d=_0x3f370c?_0x1ee027['querySelector'](_0xd86303(0x5f2)):document[_0xd86303(0x1497)](_0xd86303(0x379));!_0x3f370c&&(_0x25d83d[_0xd86303(0x35b)]='qzone-post-item');let _0xf433a='',_0xcf9d48='',_0x1224de=_0x16699d[_0xd86303(0x66e)]['avatar'];if(_0x3b75d5[_0xd86303(0x11b9)]===_0xd86303(0xaeb))_0xf433a=_0x16699d[_0xd86303(0x66e)][_0xd86303(0x63e)],_0xcf9d48=_0x16699d['qzoneSettings']['nickname'];else{if(_0x16699d[_0xd86303(0x1474)][_0x3b75d5[_0xd86303(0x11b9)]]){const _0x29dd3a=_0x16699d[_0xd86303(0x1474)][_0x3b75d5['authorId']];_0xf433a=_0x29dd3a['settings'][_0xd86303(0x156d)]||_0x202ba5,_0xcf9d48=_0x29dd3a[_0xd86303(0x1467)];}else{if(String(_0x3b75d5[_0xd86303(0x11b9)])['startsWith'](_0xd86303(0x137b))){const _0x20e374=parseInt(String(_0x3b75d5[_0xd86303(0x11b9)])[_0xd86303(0x14e9)](_0xd86303(0x137b),''));if(!isNaN(_0x20e374)){const _0x4093ae=await _0x6ed281[_0xd86303(0xa59)][_0xd86303(0xe8c)](_0x20e374);_0x4093ae?(_0xf433a=_0x4093ae[_0xd86303(0x63e)]||_0x3ca5ef,_0xcf9d48=_0x4093ae[_0xd86303(0x1467)]):(_0xcf9d48=_0x3b75d5[_0xd86303(0x122a)]||_0xd86303(0x13fe),_0xf433a=_0x3ca5ef);}}else _0xcf9d48=_0x18969a(_0x3b75d5[_0xd86303(0x122a)]),_0xf433a=_0x202ba5;}}function _0x533b86(_0x49a864){const _0x34e7e9=_0xd86303;let _0x3a8bec='';const _0x47cb6f=_0x49a864['publicText']?_0x34e7e9(0xefa)+_0x5876e7(_0x49a864[_0x34e7e9(0x15bf)])[_0x34e7e9(0x14e9)](/\n/g,'<br>')+'</div>':'';if(_0x49a864[_0x34e7e9(0x4ae)]===_0x34e7e9(0x2f6))_0x3a8bec='<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>'+_0x5876e7(_0x49a864[_0x34e7e9(0xede)])[_0x34e7e9(0x14e9)](/\n/g,_0x34e7e9(0x1121))+_0x34e7e9(0xc7f);else{if(_0x49a864[_0x34e7e9(0x4ae)]===_0x34e7e9(0x8f6)&&_0x49a864[_0x34e7e9(0x15b8)])_0x3a8bec=_0x47cb6f?_0x47cb6f+_0x34e7e9(0x14c4)+_0x49a864[_0x34e7e9(0x15b8)]+_0x34e7e9(0x14d4):_0x34e7e9(0x4ad)+_0x49a864[_0x34e7e9(0x15b8)]+_0x34e7e9(0x12ee);else{if(_0x49a864[_0x34e7e9(0x4ae)]===_0x34e7e9(0x1076)){const _0x47e53b=_0x16699d[_0x34e7e9(0xf9c)]['enableAiDrawing']&&_0x49a864[_0x34e7e9(0x5d9)]?_0x34e7e9(0xbfa)+_0x49a864[_0x34e7e9(0x5d9)]:'https://i.postimg.cc/KYr2qRCK/1.jpg';_0x3a8bec=_0x47cb6f?_0x47cb6f+_0x34e7e9(0x14c4)+_0x47e53b+_0x34e7e9(0x1354)+_0x49a864[_0x34e7e9(0x7d9)]+_0x34e7e9(0x6b5):_0x34e7e9(0x4ad)+_0x47e53b+_0x34e7e9(0x1354)+_0x49a864[_0x34e7e9(0x7d9)]+'\x22>';}else{if(_0x49a864[_0x34e7e9(0x4ae)]===_0x34e7e9(0x1141)){const _0xe7ee1e=_0x49a864[_0x34e7e9(0x159b)]||(_0x49a864[_0x34e7e9(0x15b8)]?[_0x49a864['imageUrl']]:[]);if(_0xe7ee1e['length']>0x0){const _0x409a95=_0xe7ee1e['length'];let _0x3c2857='';_0x3c2857=_0x34e7e9(0xa90)+_0x409a95+'\x22>',_0xe7ee1e[_0x34e7e9(0x427)]((_0xb13115,_0x2e26f7)=>{const _0x360a76=_0x34e7e9;_0x3c2857+='<img\x20src=\x22'+_0xb13115+_0x360a76(0x543)+(_0x2e26f7+0x1)+_0x360a76(0x1171);}),_0x3c2857+=_0x34e7e9(0xc7f),_0x3a8bec=_0x47cb6f?''+_0x47cb6f+_0x3c2857:_0x3c2857;}}}}}return _0x3a8bec;}let _0x15720c;if(_0x3b75d5[_0xd86303(0x4ae)]==='repost'){const _0x39b97d=_0x3b75d5[_0xd86303(0x1406)]?_0xd86303(0xefa)+_0x3b75d5[_0xd86303(0x1406)][_0xd86303(0x14e9)](/\n/g,'<br>')+'</div>':'';let _0x5119a6=_0x202ba5,_0x3378d6='原作者';if(_0x3b75d5[_0xd86303(0x10a1)][_0xd86303(0x11b9)]===_0xd86303(0xaeb))_0x5119a6=_0x16699d[_0xd86303(0x66e)]['avatar'],_0x3378d6=_0x16699d[_0xd86303(0x66e)][_0xd86303(0xf4d)];else{const _0x1e8334=_0x16699d['chats'][_0x3b75d5['originalPost'][_0xd86303(0x11b9)]];_0x1e8334&&(_0x5119a6=_0x1e8334['settings']['aiAvatar']||_0x202ba5),_0x3378d6=_0x18969a(_0x3b75d5['originalPost'][_0xd86303(0x122a)]);}_0x15720c='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x39b97d+_0xd86303(0xadd)+_0x5119a6+_0xd86303(0xef2)+_0x3378d6+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>'+_0x134050(_0x3b75d5[_0xd86303(0x10a1)][_0xd86303(0xb0a)])+_0xd86303(0x19a)+_0x533b86(_0x3b75d5[_0xd86303(0x10a1)])+_0xd86303(0x3fa);}else _0x15720c=_0xd86303(0x205)+_0x533b86(_0x3b75d5)+_0xd86303(0xc7f);let _0xeb2825='';if(_0x3b75d5[_0xd86303(0x494)]&&_0x3b75d5[_0xd86303(0x494)][_0xd86303(0xaf9)]>0x0){const _0x4db31a=_0x3b75d5[_0xd86303(0x494)][_0xd86303(0x8ff)](_0x426135=>_0x18969a(_0x426135))[_0xd86303(0x121a)]('、');_0xeb2825=_0xd86303(0xfff)+_0x4db31a+_0xd86303(0x142b);}let _0x41b17d='';_0x3b75d5[_0xd86303(0x4d6)]&&_0x3b75d5[_0xd86303(0x4d6)][_0xd86303(0xaf9)]>0x0&&(_0x41b17d='<div\x20class=\x22post-comments-container\x22>',_0x3b75d5['comments'][_0xd86303(0x427)]((_0x133e78,_0x1a893c)=>{const _0x1e3458=_0xd86303;if(typeof _0x133e78===_0x1e3458(0xd43)&&_0x133e78!==null&&_0x133e78['commenterName']){const _0x1a5fc4=_0x133e78['commenterName'],_0x32fb22=_0x18969a(_0x1a5fc4);let _0x18b322;_0x346c[_0x1e3458(0x367)](_0x133e78['text'])?_0x18b322=_0x1e3458(0x4ad)+_0x133e78[_0x1e3458(0x9ea)]+_0x1e3458(0x2cc):_0x18b322=_0x5876e7(_0x133e78[_0x1e3458(0x9ea)]);let _0x562b08='';if(_0x133e78[_0x1e3458(0xf05)]){const _0x4859b8=_0x18969a(_0x133e78['replyTo']);_0x562b08='<span\x20class=\x22commenter-name\x22>'+_0x32fb22+_0x1e3458(0x13f1)+_0x4859b8+_0x1e3458(0xb88)+_0x18b322;}else _0x562b08=_0x1e3458(0x148e)+_0x32fb22+_0x1e3458(0xb88)+_0x18b322;_0x41b17d+='<div\x20class=\x22comment-item\x22\x20data-post-id=\x22'+_0x3b75d5['id']+'\x22\x20data-commenter-original-name=\x22'+_0x1a5fc4+_0x1e3458(0xdda)+_0x32fb22+_0x1e3458(0x13e0)+_0x562b08+_0x1e3458(0xf6c)+_0x1a893c+_0x1e3458(0xe68);}else _0x41b17d+=_0x1e3458(0x859)+String(_0x133e78)+_0x1e3458(0xd46);}),_0x41b17d+=_0xd86303(0xc7f));const _0x2cc176=_0x16699d[_0xd86303(0x66e)][_0xd86303(0xf4d)],_0x425552=_0x3b75d5[_0xd86303(0x494)]&&_0x3b75d5[_0xd86303(0x494)]['includes'](_0x2cc176),_0x466d78=_0x16699d['favoritedPostIds']&&_0x16699d[_0xd86303(0x1238)][_0xd86303(0xda1)](_0x3b75d5['id']);let _0x1a980b='';_0x3b75d5[_0xd86303(0x4ae)]!=='repost'&&(_0x1a980b='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>');_0x25d83d[_0xd86303(0xb6f)]=_0xd86303(0x1197)+_0xf433a+_0xd86303(0x663)+_0x3b75d5[_0xd86303(0x11b9)]+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>'+_0xcf9d48+_0xd86303(0x3a2)+_0x134050(_0x3b75d5['timestamp'])+_0xd86303(0xb58)+_0x15720c+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-feedback-icons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1a980b+_0xd86303(0x666)+(_0x425552?'active':'')+_0xd86303(0xaef)+(_0x466d78?_0xd86303(0x115e):'')+_0xd86303(0x375)+_0xeb2825+_0xd86303(0x1009)+_0x41b17d+_0xd86303(0x4d8)+_0x1224de+_0xd86303(0xbdf);if(!_0x3f370c){const _0x230f91=document['createElement']('div');_0x230f91[_0xd86303(0x35b)]=_0xd86303(0xf28),_0x230f91['innerHTML']='<span>删除</span>',_0x1ee027[_0xd86303(0x6b6)](_0x25d83d),_0x1ee027[_0xd86303(0x6b6)](_0x230f91);}return _0x1ee027;}async function _0x568043(_0x504b3f){const _0x34c387=_0x3ce1fb,_0x3e50a1=await _0x6ed281[_0x34c387(0xed1)][_0x34c387(0xe8c)](_0x504b3f);if(!_0x3e50a1){const _0x54ac90=document[_0x34c387(0xfeb)](_0x34c387(0xbb8)+_0x504b3f+'\x22]');_0x54ac90&&_0x54ac90[_0x34c387(0xf89)]();return;}const _0x3fea4b=_0x22676c['findIndex'](_0x500bcd=>_0x500bcd['id']===_0x504b3f);_0x3fea4b>-0x1&&(_0x22676c[_0x3fea4b]=_0x3e50a1);const _0x36a80f=await _0x6ed281['favorites'][_0x34c387(0x1117)](_0x34c387(0x4ae))['equals'](_0x34c387(0x65f))['toArray']();_0x16699d[_0x34c387(0x1238)]=new Set(_0x36a80f[_0x34c387(0x8ff)](_0x574700=>_0x574700[_0x34c387(0xede)]['id'])),await _0x2aedda(_0x3e50a1);}async function _0x4d3afb(){const _0x46305b=_0x3ce1fb,_0x240908=document[_0x46305b(0x948)](_0x46305b(0xc5d));if(!_0x240908)return;const [_0x2935d8,_0x559921]=await Promise[_0x46305b(0xd49)]([_0x6ed281[_0x46305b(0xed1)][_0x46305b(0x1088)](_0x46305b(0xb0a))[_0x46305b(0xb26)]()[_0x46305b(0x1c0)](_0x4e5f26=>!_0x4e5f26[_0x46305b(0x109a)])['toArray'](),_0x6ed281[_0x46305b(0x1dc)]['where'](_0x46305b(0x4ae))[_0x46305b(0xba9)]('qzone_post')[_0x46305b(0x443)]()]);_0x22676c=_0x2935d8,_0x16699d[_0x46305b(0x1238)]=new Set(_0x559921['map'](_0x301a11=>_0x301a11[_0x46305b(0xede)]['id'])),_0x240908[_0x46305b(0xb6f)]='',_0x410e8d=0x0;if(_0x22676c[_0x46305b(0xaf9)]===0x0){_0x240908[_0x46305b(0xb6f)]=_0x46305b(0x50f);return;}_0x4b7636();}async function _0x4b7636(){const _0x19ed29=_0x3ce1fb;if(_0xe11400)return;_0xe11400=!![];const _0x1e76e8=document[_0x19ed29(0x948)](_0x19ed29(0xc5d));if(!_0x1e76e8){_0xe11400=![];return;}_0x2176e3(_0x1e76e8,_0x19ed29(0x5eb)),setTimeout(async()=>{const _0x349a3c=_0x19ed29;_0x3c826e(_0x1e76e8);const _0x31fc67=_0x410e8d,_0x4aba3c=_0x410e8d+_0x2b08fb,_0x12a204=_0x22676c[_0x349a3c(0x200)](_0x31fc67,_0x4aba3c),_0x1e6470=document['createDocumentFragment']();for(const _0x3553dd of _0x12a204){const _0x2e373b=await _0x2aedda(_0x3553dd);_0x1e6470['appendChild'](_0x2e373b);}_0x1e76e8[_0x349a3c(0x6b6)](_0x1e6470),_0x410e8d+=_0x12a204['length'],_0xe11400=![];},0x1f4);}function _0x5043f0(_0x174f52,_0x127a97){const _0x5c7502=_0x3ce1fb,_0x5c6578=_0x17a241[_0x5c7502(0x1363)],_0x55e828=_0x17a241[_0x5c7502(0xb9b)];_0x55e828[_0x5c7502(0xb6f)]='';_0x16699d[_0x5c7502(0x14a2)][_0x5c7502(0xaf9)]===0x0?_0x55e828[_0x5c7502(0xb6f)]=_0x5c7502(0x10cd):_0x16699d[_0x5c7502(0x14a2)][_0x5c7502(0x427)](_0x3072f3=>{const _0xc30a5=_0x5c7502,_0x353595=document[_0xc30a5(0x1497)](_0xc30a5(0x379));_0x353595[_0xc30a5(0x35b)]=_0xc30a5(0x1399),_0x353595[_0xc30a5(0xf74)][_0xc30a5(0x618)]=_0xc30a5(0x4f1)+_0x3072f3[_0xc30a5(0x9a8)]+')',_0x353595[_0xc30a5(0xb03)]=_0x3072f3[_0xc30a5(0x1467)],_0x55e828['appendChild'](_0x353595);});const _0x23f4f1=_0x127a97[_0x5c7502(0xde6)](),_0xe48cba=document[_0x5c7502(0x948)](_0x5c7502(0xecd))[_0x5c7502(0xde6)]();_0x5c6578[_0x5c7502(0xf74)][_0x5c7502(0x11fd)]=_0x5c7502(0x6a4);const _0x5d555b=_0x5c6578[_0x5c7502(0xde6)](),_0x15de03=_0x5d555b[_0x5c7502(0xf38)],_0x312bdb=_0x5d555b[_0x5c7502(0x977)];_0x5c6578[_0x5c7502(0xf74)][_0x5c7502(0x102e)]=_0x23f4f1[_0x5c7502(0x102e)]-_0x15de03-0x5-_0xe48cba['top']+'px';const _0x3ff0d5=_0x23f4f1['left']-_0xe48cba['left'];_0x3ff0d5+_0x312bdb>_0xe48cba['width']?(_0x5c6578['style']['left']=_0x5c7502(0x1098),_0x5c6578[_0x5c7502(0xf74)][_0x5c7502(0xf71)]='5px'):(_0x5c6578[_0x5c7502(0xf74)][_0x5c7502(0x102f)]=_0x3ff0d5+'px',_0x5c6578['style'][_0x5c7502(0xf71)]=_0x5c7502(0x1098)),_0x17a241[_0x5c7502(0x2c4)]=!![],_0x17a241[_0x5c7502(0x787)]=_0x174f52;}function _0x3a9f99(){const _0x4d9ac5=_0x3ce1fb;_0x17a241[_0x4d9ac5(0x2c4)]&&(_0x17a241[_0x4d9ac5(0x1363)]['style'][_0x4d9ac5(0x11fd)]=_0x4d9ac5(0x12fe),_0x17a241[_0x4d9ac5(0x2c4)]=![],_0x17a241[_0x4d9ac5(0x787)]=null);}async function _0x17dc21(_0x16bf22,_0x175b44){const _0x51794a=_0x3ce1fb;if(!_0x175b44||!_0x175b44['url'])return;const _0x3c5150=await _0x6ed281[_0x51794a(0xed1)][_0x51794a(0xe8c)](_0x16bf22);if(!_0x3c5150){console['error'](_0x51794a(0x1036),_0x16bf22);return;}!_0x3c5150[_0x51794a(0x4d6)]&&(_0x3c5150[_0x51794a(0x4d6)]=[]);const _0x1ac75e={'commenterName':_0x16699d[_0x51794a(0x66e)][_0x51794a(0xf4d)],'text':_0x175b44['url'],'meaning':_0x175b44['name'],'timestamp':Date[_0x51794a(0x1386)]()};_0x3c5150[_0x51794a(0x4d6)]['push'](_0x1ac75e),await _0x6ed281[_0x51794a(0xed1)][_0x51794a(0xa0b)](_0x16bf22,{'comments':_0x3c5150[_0x51794a(0x4d6)]}),_0x3a9f99(),await _0x4d3afb();const _0x17bd78=(_0x3c5150['publicText']||_0x3c5150[_0x51794a(0xede)]||_0x51794a(0xf3b))[_0x51794a(0xeca)](0x0,0x1e);for(const _0x120c9e in _0x16699d['chats']){const _0x35663f=_0x16699d['chats'][_0x120c9e];if(!_0x35663f['isGroup']){const _0x1b0265='[系统提示：\x27'+_0x16699d[_0x51794a(0x66e)]['nickname']+_0x51794a(0x766)+_0x16bf22+',\x20内容摘要:\x20“'+_0x17bd78+_0x51794a(0x33b)+_0x175b44[_0x51794a(0x1467)]+_0x51794a(0x739),_0x4e337c={'role':_0x51794a(0x11af),'content':_0x1b0265,'timestamp':Date['now'](),'isHidden':!![]};_0x35663f[_0x51794a(0xb07)]['push'](_0x4e337c),await _0x6ed281[_0x51794a(0x1474)]['put'](_0x35663f);}}}function _0x213f26(_0x795d31){const _0x18136a=_0x3ce1fb;_0x5d89da=_0x795d31,document[_0x18136a(0x948)](_0x18136a(0x11d4))['value']='',document[_0x18136a(0x948)](_0x18136a(0xf85))[_0x18136a(0xd54)][_0x18136a(0xbd0)](_0x18136a(0xfcb));}function _0x46d94d(){const _0x3c3657=_0x3ce1fb;document[_0x3c3657(0x948)](_0x3c3657(0xf85))['classList'][_0x3c3657(0xf89)](_0x3c3657(0xfcb)),_0x5d89da=null;}async function _0x5b216b(){const _0x5b8544=_0x3ce1fb;if(!_0x5d89da)return;const _0xd79ba0=document[_0x5b8544(0x948)]('repost-comment-input')[_0x5b8544(0x5bc)]['trim'](),_0x2da0db=await _0x6ed281[_0x5b8544(0xed1)][_0x5b8544(0xe8c)](_0x5d89da);if(!_0x2da0db){alert(_0x5b8544(0x49b)),_0x46d94d();return;}const _0x21548a={'type':_0x5b8544(0x1f2),'timestamp':Date[_0x5b8544(0x1386)](),'authorId':_0x5b8544(0xaeb),'repostComment':_0xd79ba0,'originalPost':_0x2da0db,'visibleGroupIds':null};await _0x6ed281['qzonePosts'][_0x5b8544(0xbd0)](_0x21548a),_0x46d94d(),await _0x4d3afb(),alert(_0x5b8544(0x146f));}function _0x2fa1b9(_0x4e0e1f){const _0x3f5014=_0x3ce1fb,_0x2b4038=document[_0x3f5014(0x948)](_0x3f5014(0xfe4));_0x2b4038['innerHTML']='';if(_0x4e0e1f[_0x3f5014(0xaf9)]===0x0){const _0x5b7f45=document[_0x3f5014(0x948)]('favorites-search-input')['value'],_0x113f60=_0x5b7f45?'未找到相关收藏':'你的收藏夹是空的，<br>快去动态或聊天中收藏喜欢的内容吧！';_0x2b4038['innerHTML']=_0x3f5014(0xa1c)+_0x113f60+_0x3f5014(0x79d);return;}for(const _0x46cc50 of _0x4e0e1f){const _0x3747ac=document[_0x3f5014(0x1497)](_0x3f5014(0x379));_0x3747ac[_0x3f5014(0x35b)]='favorite-item-card',_0x3747ac[_0x3f5014(0x606)][_0x3f5014(0x362)]=_0x46cc50['id'];let _0x404c06='',_0x5a5c3a='',_0x285b6c='',_0x3922f6='';if(_0x46cc50['type']===_0x3f5014(0x65f)){const _0x54e2b1=_0x46cc50[_0x3f5014(0xede)];_0x285b6c=_0x3f5014(0xda8);let _0x37f42a=_0x202ba5,_0x50438c=_0x3f5014(0x79b);if(_0x54e2b1[_0x3f5014(0x11b9)]===_0x3f5014(0xaeb))_0x37f42a=_0x16699d['qzoneSettings'][_0x3f5014(0x63e)],_0x50438c=_0x16699d[_0x3f5014(0x66e)][_0x3f5014(0xf4d)];else _0x16699d['chats'][_0x54e2b1[_0x3f5014(0x11b9)]]&&(_0x37f42a=_0x16699d[_0x3f5014(0x1474)][_0x54e2b1[_0x3f5014(0x11b9)]][_0x3f5014(0x7fd)]['aiAvatar'],_0x50438c=_0x16699d[_0x3f5014(0x1474)][_0x54e2b1[_0x3f5014(0x11b9)]][_0x3f5014(0x1467)]);_0x404c06=_0x3f5014(0x4ad)+_0x37f42a+'\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>'+_0x50438c+_0x3f5014(0x1087);const _0x2ce8ed=_0x54e2b1['publicText']?'<div\x20class=\x22post-content\x22>'+_0x54e2b1[_0x3f5014(0x15bf)][_0x3f5014(0x14e9)](/\n/g,_0x3f5014(0x1121))+'</div>':'';if(_0x54e2b1[_0x3f5014(0x4ae)]===_0x3f5014(0x2f6))_0x5a5c3a=_0x3f5014(0xefa)+_0x54e2b1[_0x3f5014(0xede)][_0x3f5014(0x14e9)](/\n/g,'<br>')+_0x3f5014(0xc7f);else{if(_0x54e2b1[_0x3f5014(0x4ae)]===_0x3f5014(0x8f6)&&_0x54e2b1[_0x3f5014(0x15b8)]){const _0x412434=_0x16699d['globalSettings'][_0x3f5014(0xf46)]&&_0x54e2b1['image_prompt']?_0x3f5014(0xbfa)+_0x54e2b1['image_prompt']:'https://i.postimg.cc/KYr2qRCK/1.jpg';_0x5a5c3a=_0x2ce8ed?_0x2ce8ed+_0x3f5014(0x14c4)+_0x412434+_0x3f5014(0x14d4):'<img\x20src=\x22'+_0x412434+_0x3f5014(0x12ee);}else{if(_0x54e2b1[_0x3f5014(0x4ae)]===_0x3f5014(0x1076)){const _0x59af37=_0x16699d[_0x3f5014(0xf9c)]['enableAiDrawing']&&_0x54e2b1['image_prompt']?_0x3f5014(0xbfa)+_0x54e2b1[_0x3f5014(0x5d9)]:'https://i.postimg.cc/KYr2qRCK/1.jpg';_0x5a5c3a=_0x2ce8ed?_0x2ce8ed+_0x3f5014(0x14c4)+_0x59af37+'\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22'+_0x54e2b1['hiddenContent']+'\x22></div>':_0x3f5014(0x4ad)+_0x59af37+_0x3f5014(0x1354)+_0x54e2b1['hiddenContent']+'\x22>';}}}let _0xb058d7='';_0x54e2b1[_0x3f5014(0x494)]&&_0x54e2b1['likes']['length']>0x0&&(_0xb058d7=_0x3f5014(0x80d)+_0x54e2b1['likes'][_0x3f5014(0x121a)]('、')+_0x3f5014(0xad7));let _0x31091d='';_0x54e2b1['comments']&&_0x54e2b1['comments'][_0x3f5014(0xaf9)]>0x0&&(_0x31091d='<div\x20class=\x22post-comments-container\x22>',_0x54e2b1[_0x3f5014(0x4d6)][_0x3f5014(0x427)]((_0x371a04,_0x4d7843)=>{const _0x501727=_0x3f5014;if(typeof _0x371a04==='object'&&_0x371a04!==null&&_0x371a04[_0x501727(0x9e3)]){const _0x24d663=_0x371a04[_0x501727(0x9e3)],_0xd230f6=_0x18969a(_0x24d663);let _0x1e3631;_0x346c['test'](_0x371a04['text'])?_0x1e3631='<img\x20src=\x22'+_0x371a04[_0x501727(0x9ea)]+_0x501727(0x2cc):_0x1e3631=_0x371a04[_0x501727(0x9ea)];let _0x142660='';if(_0x371a04['replyTo']){const _0x2e24c8=_0x18969a(_0x371a04['replyTo']);_0x142660=_0x501727(0x148e)+_0xd230f6+_0x501727(0x13f1)+_0x2e24c8+_0x501727(0xb88)+_0x1e3631;}else _0x142660=_0x501727(0x148e)+_0xd230f6+'</span>:\x20'+_0x1e3631;_0x31091d+=_0x501727(0x8e6)+_0x54e2b1['id']+_0x501727(0xba0)+_0x24d663+_0x501727(0xdda)+_0xd230f6+_0x501727(0x846)+_0x142660+_0x501727(0xaba)+_0x4d7843+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}else _0x31091d+=_0x501727(0x12f5)+String(_0x371a04)+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}),_0x31091d+=_0x3f5014(0xc7f)),_0x3922f6=''+_0xb058d7+_0x31091d;}else{if(_0x46cc50[_0x3f5014(0x4ae)]==='chat_message'){const _0x255806=_0x46cc50[_0x3f5014(0xede)],_0x27a833=_0x16699d[_0x3f5014(0x1474)][_0x46cc50[_0x3f5014(0x1029)]];if(!_0x27a833)continue;_0x285b6c='来自与\x20'+_0x27a833[_0x3f5014(0x1467)]+_0x3f5014(0x91a);const _0x2883cb=_0x255806[_0x3f5014(0x1554)]==='user';let _0x58a9f3,_0x31d2a5;if(_0x2883cb)_0x58a9f3=_0x27a833[_0x3f5014(0x1173)]?_0x27a833[_0x3f5014(0x7fd)][_0x3f5014(0x1371)]||'我':'我',_0x31d2a5=_0x27a833[_0x3f5014(0x7fd)]['myAvatar']||(_0x27a833[_0x3f5014(0x1173)]?_0x5c1dc1:_0x202ba5);else{if(_0x27a833[_0x3f5014(0x1173)]){const _0x57dbee=_0x27a833[_0x3f5014(0x10a2)][_0x3f5014(0x1402)](_0x59642a=>_0x59642a[_0x3f5014(0x628)]===_0x255806['senderName']);_0x58a9f3=_0x255806[_0x3f5014(0x14ee)],_0x31d2a5=_0x57dbee?_0x57dbee[_0x3f5014(0x63e)]:_0x3ca5ef;}else _0x58a9f3=_0x27a833[_0x3f5014(0x1467)],_0x31d2a5=_0x27a833[_0x3f5014(0x7fd)]['aiAvatar']||_0x202ba5;}_0x404c06=_0x3f5014(0x4ad)+_0x31d2a5+_0x3f5014(0xf92)+_0x58a9f3+_0x3f5014(0x1087);if(typeof _0x255806['content']===_0x3f5014(0x273)&&_0x346c['test'](_0x255806[_0x3f5014(0xede)]))_0x5a5c3a=_0x3f5014(0x4ad)+_0x255806['content']+_0x3f5014(0xc2f);else Array[_0x3f5014(0x1524)](_0x255806[_0x3f5014(0xede)])&&_0x255806['content'][0x0]?.[_0x3f5014(0x4ae)]===_0x3f5014(0x1b0)?_0x5a5c3a=_0x3f5014(0x4ad)+_0x255806[_0x3f5014(0xede)][0x0][_0x3f5014(0x1b0)][_0x3f5014(0x9a8)]+_0x3f5014(0x12ee):_0x5a5c3a=String(_0x255806[_0x3f5014(0xede)]||'')[_0x3f5014(0x14e9)](/\n/g,'<br>');}else{if(_0x46cc50[_0x3f5014(0x4ae)]===_0x3f5014(0xba8)){const _0x492c2c=_0x46cc50[_0x3f5014(0xede)];_0x285b6c=_0x3f5014(0x578)+_0x492c2c[_0x3f5014(0xf80)]+_0x3f5014(0x4b2);const _0x209131=_0x16699d[_0x3f5014(0x1474)][_0x492c2c[_0x3f5014(0xfb0)]],_0x2d0e63=_0x209131?_0x209131[_0x3f5014(0x7fd)]['aiAvatar']:_0x202ba5;_0x404c06=_0x3f5014(0x4ad)+_0x2d0e63+_0x3f5014(0xf92)+_0x492c2c[_0x3f5014(0xf80)]+_0x3f5014(0x1087);const _0x5d23e6=_0x492c2c[_0x3f5014(0xede)]||'',_0x1ca799=_0x5876e7(_0x5d23e6)[_0x3f5014(0x14e9)](/\n/g,_0x3f5014(0x1121));_0x5a5c3a=_0x3f5014(0x3f1)+_0x492c2c[_0x3f5014(0xb03)]+_0x3f5014(0xd7b)+_0x1ca799+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}else{if(_0x46cc50[_0x3f5014(0x4ae)]==='char_browser_article'){const _0x5dd81f=_0x46cc50[_0x3f5014(0xede)];_0x285b6c=_0x3f5014(0x578)+_0x5dd81f['characterName']+'\x20的浏览记录';const _0x5945d9=_0x16699d[_0x3f5014(0x1474)][_0x5dd81f['characterId']],_0x1f976b=_0x5945d9?_0x5945d9[_0x3f5014(0x7fd)][_0x3f5014(0x156d)]:_0x202ba5;_0x404c06=_0x3f5014(0x4ad)+_0x1f976b+_0x3f5014(0xf92)+_0x5dd81f['characterName']+_0x3f5014(0x1087),_0x5a5c3a=_0x3f5014(0xc6e)+_0x5dd81f[_0x3f5014(0xb03)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>'+(_0x5dd81f[_0x3f5014(0xede)]||'')[_0x3f5014(0x14e9)](/\n/g,_0x3f5014(0x1121))+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}else{if(_0x46cc50[_0x3f5014(0x4ae)]===_0x3f5014(0x798)){const _0x2b7409=_0x46cc50['content'];_0x285b6c=_0x3f5014(0x578)+_0x2b7409[_0x3f5014(0xf80)]+_0x3f5014(0xca8);const _0x3e73c4=_0x16699d[_0x3f5014(0x1474)][_0x2b7409[_0x3f5014(0xfb0)]],_0x1f0083=_0x3e73c4?_0x3e73c4[_0x3f5014(0x7fd)]['aiAvatar']:_0x202ba5;_0x404c06=_0x3f5014(0x4ad)+_0x1f0083+'\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>'+_0x2b7409[_0x3f5014(0xf80)]+'</div></div>',_0x5a5c3a='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22memo-title\x22>'+_0x2b7409[_0x3f5014(0xb03)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>'+_0x2b7409['content'][_0x3f5014(0x14e9)](/\n/g,_0x3f5014(0x1121))+_0x3f5014(0x10a8);}}}}}_0x3747ac[_0x3f5014(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-header\x22>'+_0x404c06+'<div\x20class=\x22source\x22>'+_0x285b6c+_0x3f5014(0x3ff)+_0x5a5c3a+_0x3f5014(0x8d2)+_0x3922f6,_0x2b4038[_0x3f5014(0x6b6)](_0x3747ac);}}async function _0x18facb(){const _0xab1afe=_0x3ce1fb;allFavoriteItems=await _0x6ed281[_0xab1afe(0x1dc)][_0xab1afe(0x1088)](_0xab1afe(0xb0a))[_0xab1afe(0xb26)]()[_0xab1afe(0x443)]();const _0xdfb229=document[_0xab1afe(0x948)](_0xab1afe(0xc9e)),_0x12f7c5=document['getElementById'](_0xab1afe(0x140e));_0xdfb229[_0xab1afe(0x5bc)]='',_0x12f7c5[_0xab1afe(0xf74)][_0xab1afe(0x11fd)]=_0xab1afe(0x12fe),_0x2fa1b9(allFavoriteItems);}function _0xf5628b(){const _0x1743d2=_0x3ce1fb;document['getElementById']('post-public-text')[_0x1743d2(0x5bc)]='',document['getElementById'](_0x1743d2(0xf63))['src']='',document[_0x1743d2(0x948)](_0x1743d2(0x11e8))[_0x1743d2(0x5bc)]='',document[_0x1743d2(0x948)]('post-image-preview-container')['classList'][_0x1743d2(0xf89)]('visible'),document[_0x1743d2(0x948)]('post-image-desc-group')[_0x1743d2(0xf74)]['display']=_0x1743d2(0x12fe),document[_0x1743d2(0x948)]('post-local-image-input')['value']='',document[_0x1743d2(0x948)](_0x1743d2(0x203))[_0x1743d2(0x5bc)]='',document[_0x1743d2(0x948)](_0x1743d2(0xf0a))[_0x1743d2(0x4f6)]();}async function _0x3ee3af(){const _0x2ce321=_0x3ce1fb,_0x46659c=await _0xa6b74a(_0x2ce321(0xeac),_0x2ce321(0x12b5),{'confirmButtonClass':'btn-danger','confirmText':_0x2ce321(0x24f)});if(!_0x46659c)return;await _0x104485('请稍候...','正在开始清理冗余数据，请不要关闭页面...'),console[_0x2ce321(0x498)](_0x2ce321(0x1498));let _0x4897e4={'posts':0x0,'likes':0x0,'comments':0x0,'memories':0x0,'callRecords':0x0,'renderingRules':0x0,'groupMembers':0x0,'chatLinks':0x0};try{await _0x6ed281[_0x2ce321(0x670)]('rw',_0x6ed281[_0x2ce321(0x8fa)],async()=>{const _0x1d7330=_0x2ce321,_0x2cf08a=await _0x6ed281[_0x1d7330(0x1474)]['toArray'](),_0x4f4c0c=await _0x6ed281[_0x1d7330(0xa59)][_0x1d7330(0x443)](),_0x4a2aad=new Set(_0x2cf08a[_0x1d7330(0x8ff)](_0x46bd7e=>_0x46bd7e['id'])),_0xbf76e4=new Set(_0x4f4c0c[_0x1d7330(0x8ff)](_0x434ef5=>_0x1d7330(0x137b)+_0x434ef5['id'])),_0x70daee=new Set(_0x2cf08a[_0x1d7330(0x1c0)](_0x585d75=>!_0x585d75[_0x1d7330(0x1173)])['map'](_0x50f314=>_0x50f314[_0x1d7330(0x628)]));_0x70daee['add'](_0x16699d[_0x1d7330(0x66e)][_0x1d7330(0xf4d)]||_0x1d7330(0x1347)),_0x4f4c0c[_0x1d7330(0x427)](_0x479b36=>_0x70daee[_0x1d7330(0xbd0)](_0x479b36[_0x1d7330(0x1467)]));for(const _0x59adb of _0x2cf08a){let _0x45a004=![];if(_0x59adb[_0x1d7330(0x1173)]&&_0x59adb['members']){const _0x1b8924=_0x59adb[_0x1d7330(0x10a2)]['length'];_0x59adb['members']=_0x59adb[_0x1d7330(0x10a2)][_0x1d7330(0x1c0)](_0x5a0821=>_0x4a2aad[_0x1d7330(0xda1)](_0x5a0821['id'])||_0xbf76e4[_0x1d7330(0xda1)](_0x5a0821['id'])),_0x59adb['members'][_0x1d7330(0xaf9)]<_0x1b8924&&(_0x4897e4[_0x1d7330(0x962)]+=_0x1b8924-_0x59adb[_0x1d7330(0x10a2)]['length'],_0x45a004=!![]);}if(_0x59adb[_0x1d7330(0x7fd)]?.[_0x1d7330(0xbdd)]?.[_0x1d7330(0xaf9)]>0x0){const _0x4ba273=_0x59adb[_0x1d7330(0x7fd)][_0x1d7330(0xbdd)][_0x1d7330(0xaf9)];_0x59adb['settings']['linkedMemoryChatIds']=_0x59adb[_0x1d7330(0x7fd)][_0x1d7330(0xbdd)][_0x1d7330(0x1c0)](_0x778bab=>_0x4a2aad[_0x1d7330(0xda1)](_0x778bab)),_0x59adb[_0x1d7330(0x7fd)]['linkedMemoryChatIds']['length']<_0x4ba273&&(_0x4897e4[_0x1d7330(0x598)]+=_0x4ba273-_0x59adb[_0x1d7330(0x7fd)][_0x1d7330(0xbdd)][_0x1d7330(0xaf9)],_0x45a004=!![]);}_0x45a004&&await _0x6ed281[_0x1d7330(0x1474)][_0x1d7330(0x90c)](_0x59adb);}const _0x39404c=await _0x6ed281['qzonePosts'][_0x1d7330(0x443)]();for(const _0x538892 of _0x39404c){let _0xf27679=![];const _0x110c89=_0x538892[_0x1d7330(0x11b9)]===_0x1d7330(0xaeb)||_0x4a2aad['has'](_0x538892[_0x1d7330(0x11b9)])||_0xbf76e4[_0x1d7330(0xda1)](_0x538892[_0x1d7330(0x11b9)]);if(!_0x110c89){await _0x6ed281[_0x1d7330(0xed1)][_0x1d7330(0x869)](_0x538892['id']),_0x4897e4[_0x1d7330(0xcc7)]++;continue;}if(_0x538892['likes']&&_0x538892[_0x1d7330(0x494)]['length']>0x0){const _0x45fe8c=_0x538892[_0x1d7330(0x494)][_0x1d7330(0xaf9)];_0x538892[_0x1d7330(0x494)]=_0x538892[_0x1d7330(0x494)]['filter'](_0x3535dd=>_0x70daee[_0x1d7330(0xda1)](_0x3535dd)),_0x538892[_0x1d7330(0x494)][_0x1d7330(0xaf9)]<_0x45fe8c&&(_0x4897e4[_0x1d7330(0x494)]+=_0x45fe8c-_0x538892[_0x1d7330(0x494)]['length'],_0xf27679=!![]);}if(_0x538892[_0x1d7330(0x4d6)]&&_0x538892[_0x1d7330(0x4d6)][_0x1d7330(0xaf9)]>0x0){const _0x1f3586=_0x538892['comments'][_0x1d7330(0xaf9)];_0x538892['comments']=_0x538892[_0x1d7330(0x4d6)][_0x1d7330(0x1c0)](_0xf92ceb=>{const _0x510b38=_0x1d7330;if(typeof _0xf92ceb===_0x510b38(0xd43)&&_0xf92ceb[_0x510b38(0x9e3)])return _0x70daee['has'](_0xf92ceb['commenterName']);return!![];}),_0x538892[_0x1d7330(0x4d6)][_0x1d7330(0xaf9)]<_0x1f3586&&(_0x4897e4[_0x1d7330(0x4d6)]+=_0x1f3586-_0x538892[_0x1d7330(0x4d6)]['length'],_0xf27679=!![]);}_0xf27679&&await _0x6ed281[_0x1d7330(0xed1)][_0x1d7330(0x90c)](_0x538892);}await _0x6ed281[_0x1d7330(0x9cc)]['where'](_0x1d7330(0x1029))[_0x1d7330(0x90d)]([..._0x4a2aad])[_0x1d7330(0x869)]()['then'](_0x2aa213=>_0x4897e4['memories']+=_0x2aa213),await _0x6ed281[_0x1d7330(0x14b5)][_0x1d7330(0x1117)]('chatId')[_0x1d7330(0x90d)]([..._0x4a2aad])[_0x1d7330(0x869)]()[_0x1d7330(0x7e5)](_0x2962c8=>_0x4897e4['callRecords']+=_0x2962c8);const _0x3f8b9f=await _0x6ed281[_0x1d7330(0x31e)][_0x1d7330(0x443)]();for(const _0x1f8013 of _0x3f8b9f){_0x1f8013[_0x1d7330(0x1029)]!==_0x1d7330(0x13a0)&&!_0x4a2aad[_0x1d7330(0xda1)](_0x1f8013[_0x1d7330(0x1029)])&&(await _0x6ed281[_0x1d7330(0x31e)]['delete'](_0x1f8013['id']),_0x4897e4[_0x1d7330(0x31e)]++);}});let _0x43e084='✅\x20清理完成！\x0a\x0a',_0x1e8d9f=![];Object[_0x2ce321(0x6ea)](_0x4897e4)[_0x2ce321(0x427)](([_0x16ca2b,_0x320dfb])=>{const _0x3056da=_0x2ce321;if(_0x320dfb>0x0){const _0x369e13={'posts':'动态','likes':'点赞','comments':'评论','memories':'记忆','callRecords':'通话记录','renderingRules':_0x3056da(0xe51),'groupMembers':'群成员','chatLinks':'记忆链接'};_0x43e084+=_0x3056da(0xb59)+_0x320dfb+_0x3056da(0x1564)+(_0x369e13[_0x16ca2b]||_0x16ca2b)+'。\x0a',_0x1e8d9f=!![];}});!_0x1e8d9f&&(_0x43e084=_0x2ce321(0xea7));_0x43e084+=_0x2ce321(0x30a),await _0x104485(_0x2ce321(0xb80),_0x43e084);const _0x313196=await _0xa6b74a('刷新页面？',_0x2ce321(0x62d));_0x313196&&location['reload']();}catch(_0x5d9f7f){console['error'](_0x2ce321(0xe63),_0x5d9f7f),await _0x104485(_0x2ce321(0x9bb),'发生了一个错误:\x20'+_0x5d9f7f[_0x2ce321(0x74b)]);}}async function _0x5d3002(){const _0x1298d0=_0x3ce1fb;try{const _0x41db8e={'version':0x1,'timestamp':Date[_0x1298d0(0x1386)]()},[_0x44b6cc,_0x1180a5,_0x3916be,_0x2503e6,_0x12fb61,_0x32d183,_0x4d02c6,_0xe880cf,_0x22de5b,_0x23d100,_0x188d47,_0x5f4989,_0x5341d8,_0x43c4fd,_0x298acc,_0x46552b,_0x4e0473,_0x2e20ad,_0x3e288f,_0x5c430a,_0x3b3fd4,_0x4ff1ab,_0x1e099c,_0x42141a,_0x50aedb]=await Promise['all']([_0x6ed281[_0x1298d0(0x1474)][_0x1298d0(0x443)](),_0x6ed281[_0x1298d0(0x44c)][_0x1298d0(0x443)](),_0x6ed281['userStickers']['toArray'](),_0x6ed281[_0x1298d0(0x79e)][_0x1298d0(0xe8c)](_0x1298d0(0x1409)),_0x6ed281[_0x1298d0(0xf9c)][_0x1298d0(0xe8c)](_0x1298d0(0x1409)),_0x6ed281[_0x1298d0(0xbb0)][_0x1298d0(0x443)](),_0x6ed281[_0x1298d0(0xb98)][_0x1298d0(0xe8c)](_0x1298d0(0x1409)),_0x6ed281[_0x1298d0(0x66e)][_0x1298d0(0xe8c)]('main'),_0x6ed281[_0x1298d0(0xed1)][_0x1298d0(0x443)](),_0x6ed281[_0x1298d0(0x1a0)]['toArray'](),_0x6ed281[_0x1298d0(0x1100)]['toArray'](),_0x6ed281['favorites'][_0x1298d0(0x443)](),_0x6ed281[_0x1298d0(0x1423)]['toArray'](),_0x6ed281['memories'][_0x1298d0(0x443)](),_0x6ed281['worldBookCategories']['toArray'](),_0x6ed281[_0x1298d0(0x448)]['toArray'](),_0x6ed281['shoppingProducts'][_0x1298d0(0x443)](),_0x6ed281[_0x1298d0(0x14b5)]['toArray'](),_0x6ed281[_0x1298d0(0x31e)]['toArray'](),_0x6ed281[_0x1298d0(0x8b2)][_0x1298d0(0x443)](),_0x6ed281[_0x1298d0(0x19c)][_0x1298d0(0x443)](),_0x6ed281[_0x1298d0(0x5bd)][_0x1298d0(0x443)](),_0x6ed281[_0x1298d0(0xd44)]['toArray'](),_0x6ed281['presetCategories'][_0x1298d0(0x443)](),_0x6ed281[_0x1298d0(0xa59)]['toArray']()]);Object[_0x1298d0(0xd24)](_0x41db8e,{'chats':_0x44b6cc,'worldBooks':_0x1180a5,'userStickers':_0x3916be,'apiConfig':_0x2503e6,'globalSettings':_0x12fb61,'personaPresets':_0x32d183,'musicLibrary':_0x4d02c6,'qzoneSettings':_0xe880cf,'qzonePosts':_0x22de5b,'qzoneAlbums':_0x23d100,'qzonePhotos':_0x188d47,'favorites':_0x5f4989,'qzoneGroups':_0x5341d8,'memories':_0x43c4fd,'worldBookCategories':_0x298acc,'apiPresets':_0x46552b,'shoppingProducts':_0x4e0473,'callRecords':_0x2e20ad,'renderingRules':_0x3e288f,'doubanPosts':_0x5c430a,'stickerCategories':_0x3b3fd4,'appearancePresets':_0x4ff1ab,'presets':_0x1e099c,'presetCategories':_0x42141a,'npcs':_0x50aedb});const _0x441ee6=new Blob([JSON[_0x1298d0(0x526)](_0x41db8e,null,0x2)],{'type':_0x1298d0(0x479)}),_0x40f90d=URL['createObjectURL'](_0x441ee6),_0x91ceb0=Object[_0x1298d0(0xd24)](document[_0x1298d0(0x1497)]('a'),{'href':_0x40f90d,'download':_0x1298d0(0x71c)+new Date()[_0x1298d0(0x5ac)]()['split']('T')[0x0]+'.json'});_0x91ceb0[_0x1298d0(0x4f6)](),URL[_0x1298d0(0x11e1)](_0x40f90d),await _0x104485(_0x1298d0(0x383),_0x1298d0(0x10b6));}catch(_0x36a0c3){console['error'](_0x1298d0(0x9df),_0x36a0c3),await _0x104485(_0x1298d0(0x10d5),'发生了一个错误:\x20'+_0x36a0c3['message']);}}async function _0x254b9a(_0x5198fe){const _0x2ff33d=_0x3ce1fb;try{await _0x6ed281[_0x2ff33d(0x670)]('rw',_0x6ed281['tables'],async()=>{const _0x7647f5=_0x2ff33d;for(const _0x57c19b of _0x6ed281['tables']){await _0x57c19b['clear']();}for(const _0xf3a01c in _0x5198fe){Array['isArray'](_0x5198fe[_0xf3a01c])&&(console[_0x7647f5(0x498)](_0x7647f5(0x807)+_0xf3a01c+_0x7647f5(0x1557)+_0x5198fe[_0xf3a01c][_0x7647f5(0xaf9)]),await _0x6ed281[_0x7647f5(0x437)](_0xf3a01c)[_0x7647f5(0xad6)](_0x5198fe[_0xf3a01c]));}});}catch(_0x42ed3c){throw new Error(_0x2ff33d(0x537)+_0x42ed3c[_0x2ff33d(0x74b)]);}}async function _0x47cdb3(_0x3e5899){const _0x5cda64=_0x3ce1fb;if(!_0x3e5899)return;await _0x104485(_0x5cda64(0x960),_0x5cda64(0xacc));try{const _0x2e64a9=await _0x3e5899['text'](),_0x4cf100=JSON['parse'](_0x2e64a9);let _0xf06c39,_0x3d3266;if(_0x4cf100[_0x5cda64(0x92a)]&&typeof _0x4cf100[_0x5cda64(0x92a)]==='object'&&(_0x4cf100[_0x5cda64(0x92a)][_0x5cda64(0x1474)]||_0x4cf100['data'][_0x5cda64(0x44c)]))console[_0x5cda64(0x498)]('检测到新版流式备份文件...'),_0xf06c39=_0x4cf100['data'],_0x3d3266=_0x5cda64(0xc23);else{if(_0x4cf100[_0x5cda64(0x1474)]||_0x4cf100[_0x5cda64(0x44c)])console['log'](_0x5cda64(0xa94)),_0xf06c39=_0x4cf100,_0x3d3266=_0x5cda64(0x11bd);else throw new Error(_0x5cda64(0x391));}pendingBackupData={'type':_0x3d3266,'content':_0xf06c39},_0x22a3ac(_0xf06c39);}catch(_0x4eb25f){console[_0x5cda64(0xc3e)]('导入数据时出错:',_0x4eb25f),pendingBackupData=null,await _0x104485(_0x5cda64(0xd89),_0x5cda64(0xc4c)+_0x4eb25f['message']);}}function _0x22a3ac(_0x52dc45){const _0xafd4ed=_0x3ce1fb,_0x5c1a57=document[_0xafd4ed(0x948)](_0xafd4ed(0x9fe)),_0x5a026d=document[_0xafd4ed(0x948)](_0xafd4ed(0x3f8));_0x5a026d[_0xafd4ed(0xb6f)]='';const _0x1170a1={'chats':_0xafd4ed(0x96e),'worldBooks':_0xafd4ed(0x329),'worldBookCategories':_0xafd4ed(0x13ac),'presets':_0xafd4ed(0x3de),'presetCategories':'预设分类','userStickers':_0xafd4ed(0x6c9),'stickerCategories':'表情分类','customAvatarFrames':_0xafd4ed(0xebd),'apiConfig':'API配置','globalSettings':_0xafd4ed(0x363),'personaPresets':_0xafd4ed(0x1429),'qzoneSettings':_0xafd4ed(0x867),'qzonePosts':'动态','qzoneAlbums':'相册','favorites':'收藏','memories':'回忆','callRecords':_0xafd4ed(0x8f1),'shoppingProducts':'商品','apiPresets':_0xafd4ed(0xf2f),'renderingRules':_0xafd4ed(0xe51),'appearancePresets':'外观预设','npcs':_0xafd4ed(0x6fa)};let _0x1cc3c9=![];for(const _0xfb28c3 in _0x1170a1){if(_0x52dc45[_0xfb28c3]&&(Array['isArray'](_0x52dc45[_0xfb28c3])?_0x52dc45[_0xfb28c3][_0xafd4ed(0xaf9)]>0x0:_0x52dc45[_0xfb28c3])){const _0x29839a=Array[_0xafd4ed(0x1524)](_0x52dc45[_0xfb28c3])?_0x52dc45[_0xfb28c3][_0xafd4ed(0xaf9)]:0x1,_0x37e115=document[_0xafd4ed(0x1497)]('li');_0x37e115[_0xafd4ed(0x10cb)]=_0x1170a1[_0xfb28c3]+':\x20'+_0x29839a+'\x20条/个',_0x5a026d[_0xafd4ed(0x6b6)](_0x37e115),_0x1cc3c9=!![];}}!_0x1cc3c9&&(_0x5a026d[_0xafd4ed(0xb6f)]=_0xafd4ed(0x12dc)),document[_0xafd4ed(0x948)](_0xafd4ed(0xfe6))[_0xafd4ed(0xe8d)]=()=>{const _0x474557=_0xafd4ed;_0x5c1a57['classList']['remove'](_0x474557(0xfcb)),_0x5928d7(pendingBackupData);},document[_0xafd4ed(0x948)](_0xafd4ed(0xe31))[_0xafd4ed(0xe8d)]=()=>{const _0x33b16c=_0xafd4ed;_0x5c1a57['classList'][_0x33b16c(0xf89)](_0x33b16c(0xfcb)),_0x5b0036(pendingBackupData[_0x33b16c(0xede)]);},document[_0xafd4ed(0x948)](_0xafd4ed(0xba4))['onclick']=()=>{const _0x5711ee=_0xafd4ed;_0x5c1a57[_0x5711ee(0xd54)]['remove'](_0x5711ee(0xfcb)),pendingBackupData=null;},_0x5c1a57[_0xafd4ed(0xd54)][_0xafd4ed(0xbd0)](_0xafd4ed(0xfcb));}async function _0x5928d7(_0x5c5d03){const _0x19209f=_0x3ce1fb;if(!_0x5c5d03)return;const _0x2ca714=await _0xa6b74a(_0x19209f(0x569),_0x19209f(0xb27),{'confirmButtonClass':_0x19209f(0x5e8),'confirmText':_0x19209f(0x3cd)});if(!_0x2ca714){pendingBackupData=null;return;}await _0x104485(_0x19209f(0x960),_0x19209f(0x1573));try{if(_0x5c5d03['type']==='streamed')await _0x254b9a(_0x5c5d03[_0x19209f(0xede)]);else{if(_0x5c5d03[_0x19209f(0x4ae)]===_0x19209f(0x11bd))await _0x1c1636(_0x5c5d03['content']);else throw new Error('未知的备份类型。');}await _0x104485(_0x19209f(0x5c6),_0x19209f(0x9e4)),setTimeout(()=>window[_0x19209f(0x931)][_0x19209f(0xd12)](),0x5dc);}catch(_0x54229f){console[_0x19209f(0xc3e)]('完全导入失败:',_0x54229f),await _0x104485(_0x19209f(0xd89),_0x19209f(0x565)+_0x54229f['message']);}finally{pendingBackupData=null;}}function _0x5b0036(_0x2ebfda){const _0x3c62f7=_0x3ce1fb,_0x263417=document[_0x3c62f7(0x948)](_0x3c62f7(0x10b1)),_0x20e11c=document['getElementById'](_0x3c62f7(0xe34)),_0x46e80a=document[_0x3c62f7(0x948)](_0x3c62f7(0xf5c));_0x20e11c['innerHTML']='',_0x46e80a[_0x3c62f7(0x210)]=!![];const _0x2d4ae5={'chats':'聊天会话','worldBooks':_0x3c62f7(0x329),'worldBookCategories':_0x3c62f7(0x13ac),'presets':'离线预设','presetCategories':'预设分类','userStickers':_0x3c62f7(0x6c9),'stickerCategories':_0x3c62f7(0x1e0),'customAvatarFrames':_0x3c62f7(0xebd),'apiConfig':_0x3c62f7(0xab8),'globalSettings':_0x3c62f7(0x363),'personaPresets':_0x3c62f7(0x1429),'qzoneSettings':'空间设置','qzonePosts':'动态','qzoneAlbums':'相册','favorites':'收藏','memories':'回忆','callRecords':_0x3c62f7(0x8f1),'shoppingProducts':'商品','apiPresets':_0x3c62f7(0xf2f),'renderingRules':_0x3c62f7(0xe51),'appearancePresets':'外观预设','npcs':_0x3c62f7(0x6fa)};let _0x135d71=![];for(const _0x442b62 in _0x2d4ae5){if(_0x2ebfda[_0x442b62]&&(Array[_0x3c62f7(0x1524)](_0x2ebfda[_0x442b62])?_0x2ebfda[_0x442b62][_0x3c62f7(0xaf9)]>0x0:_0x2ebfda[_0x442b62])){const _0x29e7ee=Array[_0x3c62f7(0x1524)](_0x2ebfda[_0x442b62])?_0x2ebfda[_0x442b62][_0x3c62f7(0xaf9)]:0x1,_0x1c6c6a=!Array[_0x3c62f7(0x1524)](_0x2ebfda[_0x442b62]),_0x55dc6f=document['createElement']('div');_0x55dc6f[_0x3c62f7(0x35b)]='clear-posts-item\x20selected',_0x55dc6f['dataset']['typeId']=_0x442b62,_0x55dc6f[_0x3c62f7(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x20selected\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x2d4ae5[_0x442b62]+'\x20('+_0x29e7ee+_0x3c62f7(0x152d)+(_0x1c6c6a?_0x3c62f7(0x100e):'')+_0x3c62f7(0x130b),_0x20e11c['appendChild'](_0x55dc6f),_0x135d71=!![];}}!_0x135d71&&(_0x20e11c[_0x3c62f7(0xb6f)]=_0x3c62f7(0x108e)),document[_0x3c62f7(0x948)](_0x3c62f7(0x86c))['onclick']=()=>_0x238a27(pendingBackupData),document[_0x3c62f7(0x948)](_0x3c62f7(0x1311))[_0x3c62f7(0xe8d)]=()=>{const _0x4f46fd=_0x3c62f7;_0x263417[_0x4f46fd(0xd54)][_0x4f46fd(0xf89)]('visible'),pendingBackupData=null;},_0x46e80a[_0x3c62f7(0xc6f)]=_0xf74ca9=>{const _0x5ae2de=_0x3c62f7,_0x414588=_0xf74ca9['target'][_0x5ae2de(0x210)];_0x20e11c[_0x5ae2de(0x1188)](_0x5ae2de(0x973))['forEach'](_0x1daf7a=>{const _0x48fb1a=_0x5ae2de;_0x1daf7a[_0x48fb1a(0xd54)][_0x48fb1a(0x69d)](_0x48fb1a(0xd56),_0x414588),_0x1daf7a['querySelector'](_0x48fb1a(0x6d2))[_0x48fb1a(0xd54)]['toggle'](_0x48fb1a(0xd56),_0x414588);});},_0x20e11c[_0x3c62f7(0xe8d)]=_0x4b92c8=>{const _0x4fcc5c=_0x3c62f7,_0x428b9f=_0x4b92c8['target'][_0x4fcc5c(0x1090)](_0x4fcc5c(0x973));_0x428b9f&&(_0x428b9f[_0x4fcc5c(0xd54)]['toggle'](_0x4fcc5c(0xd56)),_0x428b9f[_0x4fcc5c(0xfeb)](_0x4fcc5c(0x6d2))[_0x4fcc5c(0xd54)][_0x4fcc5c(0x69d)](_0x4fcc5c(0xd56)));},_0x263417[_0x3c62f7(0xd54)][_0x3c62f7(0xbd0)](_0x3c62f7(0xfcb));}async function _0x238a27(_0x4187e4){const _0x588d27=_0x3ce1fb;if(!_0x4187e4)return;const _0x5f2103=document[_0x588d27(0x1188)](_0x588d27(0x1396));if(_0x5f2103['length']===0x0){alert(_0x588d27(0x1c6));return;}const _0xe4c59c=Array[_0x588d27(0x6e5)](_0x5f2103)[_0x588d27(0x8ff)](_0x4facb0=>_0x4facb0[_0x588d27(0x606)][_0x588d27(0x24c)]),_0x5552af=_0x4187e4['content'],_0x5e70dc=await _0xa6b74a(_0x588d27(0x6bc),'这将把您选择的数据【添加并覆盖】到现有数据中。同ID的数据将被更新，新数据将被添加。<br><br><strong>此操作不可撤销！</strong>',{'confirmText':_0x588d27(0x62b)});if(!_0x5e70dc)return;await _0x104485(_0x588d27(0x960),_0x588d27(0x1059));try{await _0x6ed281[_0x588d27(0x670)]('rw',_0x6ed281[_0x588d27(0x8fa)],async()=>{const _0x4570e8=_0x588d27;for(const _0x7e63c7 of _0xe4c59c){const _0x4e0dbc=_0x5552af[_0x7e63c7];if(!_0x4e0dbc)continue;const _0x38498a=_0x6ed281[_0x4570e8(0x437)](_0x7e63c7);if(!_0x38498a){console[_0x4570e8(0x9c1)](_0x4570e8(0x121c)+_0x7e63c7+_0x4570e8(0x517));continue;}if(Array[_0x4570e8(0x1524)](_0x4e0dbc))console[_0x4570e8(0x498)](_0x4570e8(0xd3b)+_0x4e0dbc[_0x4570e8(0xaf9)]+_0x4570e8(0x1591)+_0x7e63c7+_0x4570e8(0x76d)),await _0x38498a[_0x4570e8(0xad6)](_0x4e0dbc);else{if(typeof _0x4e0dbc===_0x4570e8(0xd43)&&_0x4e0dbc['id'])console[_0x4570e8(0x498)](_0x4570e8(0x13ff)+_0x7e63c7+_0x4570e8(0x76d)),await _0x38498a[_0x4570e8(0x90c)](_0x4e0dbc);else{if(typeof _0x4e0dbc===_0x4570e8(0xd43)){console[_0x4570e8(0x498)](_0x4570e8(0x1e3)+_0x7e63c7+_0x4570e8(0x76d));const _0x283554=await _0x38498a[_0x4570e8(0x2fe)]()[_0x4570e8(0x678)]()||{},_0x133194={..._0x283554,..._0x4e0dbc};if(_0x283554['id'])_0x133194['id']=_0x283554['id'];else(_0x7e63c7===_0x4570e8(0x79e)||_0x7e63c7===_0x4570e8(0x66e)||_0x7e63c7===_0x4570e8(0xf9c)||_0x7e63c7===_0x4570e8(0xb98))&&(_0x133194['id']=_0x4570e8(0x1409));await _0x38498a[_0x4570e8(0x90c)](_0x133194);}}}}}),await _0x104485(_0x588d27(0x209),_0x588d27(0x51d)),setTimeout(()=>window['location'][_0x588d27(0xd12)](),0x5dc);}catch(_0x2782d3){console[_0x588d27(0xc3e)]('选择性导入失败:',_0x2782d3),await _0x104485(_0x588d27(0x10f9),'文件应用失败:\x20'+_0x2782d3[_0x588d27(0x74b)]);}finally{pendingBackupData=null;}}async function _0x1c1636(_0x177740){const _0x48ff28=_0x3ce1fb;try{await _0x6ed281['transaction']('rw',_0x6ed281[_0x48ff28(0x8fa)],async()=>{const _0x731c4=_0x48ff28;await _0x6ed281[_0x731c4(0x1474)]['clear'](),await _0x6ed281[_0x731c4(0x44c)][_0x731c4(0x99d)]();for(const _0x553d12 of _0x6ed281['tables']){await _0x553d12[_0x731c4(0x99d)]();}if(Array[_0x731c4(0x1524)](_0x177740[_0x731c4(0x1474)]))await _0x6ed281[_0x731c4(0x1474)][_0x731c4(0xad6)](_0x177740[_0x731c4(0x1474)]);if(Array[_0x731c4(0x1524)](_0x177740['worldBooks']))await _0x6ed281[_0x731c4(0x44c)]['bulkPut'](_0x177740[_0x731c4(0x44c)]);if(Array['isArray'](_0x177740['userStickers']))await _0x6ed281[_0x731c4(0x14a2)][_0x731c4(0xad6)](_0x177740['userStickers']);if(_0x177740['apiConfig'])await _0x6ed281[_0x731c4(0x79e)][_0x731c4(0x90c)](_0x177740[_0x731c4(0x79e)]);if(_0x177740[_0x731c4(0xf9c)])await _0x6ed281[_0x731c4(0xf9c)]['put'](_0x177740[_0x731c4(0xf9c)]);if(Array['isArray'](_0x177740[_0x731c4(0xbb0)]))await _0x6ed281[_0x731c4(0xbb0)][_0x731c4(0xad6)](_0x177740[_0x731c4(0xbb0)]);if(_0x177740[_0x731c4(0xb98)])await _0x6ed281[_0x731c4(0xb98)][_0x731c4(0x90c)](_0x177740['musicLibrary']);if(_0x177740[_0x731c4(0x66e)])await _0x6ed281['qzoneSettings'][_0x731c4(0x90c)](_0x177740[_0x731c4(0x66e)]);if(Array[_0x731c4(0x1524)](_0x177740[_0x731c4(0xed1)]))await _0x6ed281[_0x731c4(0xed1)]['bulkPut'](_0x177740[_0x731c4(0xed1)]);if(Array[_0x731c4(0x1524)](_0x177740[_0x731c4(0x1a0)]))await _0x6ed281[_0x731c4(0x1a0)][_0x731c4(0xad6)](_0x177740['qzoneAlbums']);if(Array[_0x731c4(0x1524)](_0x177740[_0x731c4(0x1100)]))await _0x6ed281[_0x731c4(0x1100)]['bulkPut'](_0x177740[_0x731c4(0x1100)]);if(Array[_0x731c4(0x1524)](_0x177740[_0x731c4(0x1dc)]))await _0x6ed281['favorites'][_0x731c4(0xad6)](_0x177740[_0x731c4(0x1dc)]);if(Array[_0x731c4(0x1524)](_0x177740[_0x731c4(0x1423)]))await _0x6ed281['qzoneGroups'][_0x731c4(0xad6)](_0x177740[_0x731c4(0x1423)]);if(Array[_0x731c4(0x1524)](_0x177740[_0x731c4(0x9cc)]))await _0x6ed281[_0x731c4(0x9cc)][_0x731c4(0xad6)](_0x177740[_0x731c4(0x9cc)]);if(Array['isArray'](_0x177740[_0x731c4(0x81c)]))await _0x6ed281['worldBookCategories'][_0x731c4(0xad6)](_0x177740[_0x731c4(0x81c)]);if(Array['isArray'](_0x177740[_0x731c4(0x448)]))await _0x6ed281[_0x731c4(0x448)][_0x731c4(0xad6)](_0x177740[_0x731c4(0x448)]);if(Array[_0x731c4(0x1524)](_0x177740['shoppingProducts']))await _0x6ed281[_0x731c4(0x151a)][_0x731c4(0xad6)](_0x177740[_0x731c4(0x151a)]);if(Array['isArray'](_0x177740['callRecords']))await _0x6ed281[_0x731c4(0x14b5)][_0x731c4(0xad6)](_0x177740[_0x731c4(0x14b5)]);if(Array['isArray'](_0x177740['renderingRules']))await _0x6ed281[_0x731c4(0x31e)]['bulkPut'](_0x177740['renderingRules']);if(Array[_0x731c4(0x1524)](_0x177740[_0x731c4(0x8b2)]))await _0x6ed281[_0x731c4(0x8b2)][_0x731c4(0xad6)](_0x177740[_0x731c4(0x8b2)]);if(Array[_0x731c4(0x1524)](_0x177740[_0x731c4(0x19c)]))await _0x6ed281['stickerCategories'][_0x731c4(0xad6)](_0x177740[_0x731c4(0x19c)]);if(Array[_0x731c4(0x1524)](_0x177740[_0x731c4(0x5bd)]))await _0x6ed281[_0x731c4(0x5bd)][_0x731c4(0xad6)](_0x177740[_0x731c4(0x5bd)]);if(Array[_0x731c4(0x1524)](_0x177740['presets']))await _0x6ed281[_0x731c4(0xd44)][_0x731c4(0xad6)](_0x177740['presets']);if(Array[_0x731c4(0x1524)](_0x177740[_0x731c4(0x140b)]))await _0x6ed281[_0x731c4(0x140b)][_0x731c4(0xad6)](_0x177740[_0x731c4(0x140b)]);if(Array[_0x731c4(0x1524)](_0x177740[_0x731c4(0xa59)]))await _0x6ed281[_0x731c4(0xa59)][_0x731c4(0xad6)](_0x177740[_0x731c4(0xa59)]);});}catch(_0x26660e){throw new Error(_0x48ff28(0x416)+_0x26660e['message']);}}function _0x495393(_0x22fb42,_0x2cfa73=![]){const _0x4749ff=_0x3ce1fb;if(!_0x22fb42){_0x27d55e[_0x4749ff(0xb6f)]='',document['getElementById'](_0x4749ff(0xe8a))[_0x4749ff(0xf74)][_0x4749ff(0x340)]='';return;}const _0x532b39='custom-user-font',_0x56ff5e=_0x4749ff(0x51a)+_0x532b39+'\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27'+_0x22fb42+_0x4749ff(0x8ec);if(_0x2cfa73){const _0x29e299=document[_0x4749ff(0x948)](_0x4749ff(0xfea))||document[_0x4749ff(0x1497)](_0x4749ff(0xf74));_0x29e299['id']=_0x4749ff(0xfea),_0x29e299[_0x4749ff(0xb6f)]=_0x56ff5e;if(!document['getElementById'](_0x4749ff(0xfea)))document['head'][_0x4749ff(0x6b6)](_0x29e299);document['getElementById'](_0x4749ff(0xe8a))[_0x4749ff(0xf74)][_0x4749ff(0x340)]='\x27'+_0x532b39+_0x4749ff(0x1153);}else _0x27d55e[_0x4749ff(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x56ff5e+_0x4749ff(0x748)+_0x532b39+'\x27,\x20\x27bulangni\x27,\x20-apple-system,\x20BlinkMacSystemFont,\x20\x22Segoe\x20UI\x22,\x20Roboto,\x20Helvetica,\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}';}async function _0x4202c1(){const _0x163ba8=_0x3ce1fb;_0x27d55e[_0x163ba8(0xb6f)]='',_0x16699d[_0x163ba8(0xf9c)][_0x163ba8(0x672)]='',await _0x6ed281['globalSettings']['put'](_0x16699d[_0x163ba8(0xf9c)]),document['getElementById'](_0x163ba8(0x1024))[_0x163ba8(0x5bc)]='',document[_0x163ba8(0x948)](_0x163ba8(0xe8a))[_0x163ba8(0xf74)][_0x163ba8(0x340)]='',alert(_0x163ba8(0xc05));}async function _0x315636(){const _0x55ecf1=_0x3ce1fb,[_0x2d29c2,_0x523af1,_0x2fe8db,_0x5283b4,_0x57ead4,_0x271403,_0x42553f,_0x4210d8,_0x110ae6,_0x1b1d96,_0x1d2340]=await Promise[_0x55ecf1(0xd49)]([_0x6ed281[_0x55ecf1(0x1474)][_0x55ecf1(0x443)](),_0x6ed281[_0x55ecf1(0x79e)][_0x55ecf1(0xe8c)](_0x55ecf1(0x1409)),_0x6ed281[_0x55ecf1(0xf9c)][_0x55ecf1(0xe8c)](_0x55ecf1(0x1409)),_0x6ed281[_0x55ecf1(0x14a2)][_0x55ecf1(0x443)](),_0x6ed281[_0x55ecf1(0x44c)][_0x55ecf1(0x443)](),_0x6ed281[_0x55ecf1(0xb98)][_0x55ecf1(0xe8c)]('main'),_0x6ed281[_0x55ecf1(0xbb0)]['toArray'](),_0x6ed281[_0x55ecf1(0x66e)][_0x55ecf1(0xe8c)](_0x55ecf1(0x1409)),_0x6ed281[_0x55ecf1(0x1dc)][_0x55ecf1(0x1088)]('timestamp')[_0x55ecf1(0xb26)]()[_0x55ecf1(0x443)](),_0x6ed281[_0x55ecf1(0x9cc)][_0x55ecf1(0x443)](),_0x6ed281[_0x55ecf1(0xd44)][_0x55ecf1(0x443)]()]);_0x16699d[_0x55ecf1(0xd44)]=_0x1d2340||[];const _0x1f09f4={'id':_0x55ecf1(0x1409),'showStatusBar':![],'wallpaper':_0x55ecf1(0x10dd),'fontUrl':'','enableBackgroundActivity':![],'backgroundActivityInterval':0x3c,'blockCooldownHours':0x1,'apiTemperature':0.8,'appIcons':{..._0x4dabf6},'cphoneWallpaper':_0x55ecf1(0xfc7),'cphoneAppIcons':{..._0xde8933},'globalCss':'','notificationSoundUrl':'','widgetData':{},'globalChatBackground':'','enableAiDrawing':!![],'showPhoneFrame':![],'alwaysShowMusicIsland':![],'detachStatusBar':![],'chatActionButtonsOrder':null,'shoppingCategoryCount':0x3,'shoppingProductCount':0x8,'chatRenderWindow':0x32};_0x16699d['globalSettings']={..._0x1f09f4,..._0x2fe8db||{}},_0x16699d['globalSettings'][_0x55ecf1(0x1471)]={..._0x1f09f4[_0x55ecf1(0x1471)],..._0x16699d[_0x55ecf1(0xf9c)][_0x55ecf1(0x1471)]||{}},_0x16699d['globalSettings'][_0x55ecf1(0xac6)]={..._0x1f09f4[_0x55ecf1(0xac6)],..._0x16699d['globalSettings'][_0x55ecf1(0xac6)]||{}},_0x2d29c2[_0x55ecf1(0x427)](_0x712479=>{const _0x59af22=_0x55ecf1;typeof _0x712479[_0x59af22(0x7fd)][_0x59af22(0xae7)]==='undefined'&&(_0x712479[_0x59af22(0x7fd)]['enableTimePerception']=!![]),!_0x712479[_0x59af22(0x7fd)][_0x59af22(0x75e)]&&(_0x712479[_0x59af22(0x7fd)][_0x59af22(0x75e)]={'vertical':_0x59af22(0x102e),'horizontal':'center','offset':0xa}),!_0x712479[_0x59af22(0x1173)]&&!_0x712479[_0x59af22(0x7fd)][_0x59af22(0x3c2)]&&(_0x712479[_0x59af22(0x7fd)][_0x59af22(0x3c2)]=[]),!_0x712479[_0x59af22(0x1173)]&&typeof _0x712479[_0x59af22(0x628)]==='undefined'&&(_0x712479[_0x59af22(0x628)]=_0x712479[_0x59af22(0x1467)]);}),_0x16699d[_0x55ecf1(0x1474)]=_0x2d29c2[_0x55ecf1(0x6ab)]((_0xc4b020,_0x5abf0d)=>{const _0x389dbd=_0x55ecf1;if(typeof _0x5abf0d['unreadCount']===_0x389dbd(0x490))_0x5abf0d[_0x389dbd(0x1300)]=0x0;_0x5abf0d[_0x389dbd(0x1173)]&&(typeof _0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0x1028)]===_0x389dbd(0x490)&&(_0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0x1028)]=!![]),_0x5abf0d[_0x389dbd(0x10a2)]&&_0x5abf0d[_0x389dbd(0x10a2)][_0x389dbd(0xaf9)]>0x0&&_0x5abf0d['members'][0x0][_0x389dbd(0x1467)]&&_0x5abf0d[_0x389dbd(0x10a2)][_0x389dbd(0x427)](_0x346bbe=>{const _0x51d4c3=_0x389dbd;typeof _0x346bbe[_0x51d4c3(0x628)]==='undefined'&&(_0x346bbe[_0x51d4c3(0x628)]=_0x346bbe[_0x51d4c3(0x1467)],_0x346bbe[_0x51d4c3(0x347)]=_0x346bbe[_0x51d4c3(0x1467)],delete _0x346bbe[_0x51d4c3(0x1467)]);}));if(!_0x5abf0d['settings'])_0x5abf0d[_0x389dbd(0x7fd)]={};typeof _0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0x63a)]===_0x389dbd(0x490)&&(_0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0x63a)]=0xa);if(!_0x5abf0d[_0x389dbd(0x1173)]&&!_0x5abf0d['status'])_0x5abf0d[_0x389dbd(0x82c)]={'text':'在线','lastUpdate':Date[_0x389dbd(0x1386)](),'isBusy':![]};if(!_0x5abf0d['isGroup']&&!_0x5abf0d[_0x389dbd(0x1120)])_0x5abf0d[_0x389dbd(0x1120)]={'status':_0x389dbd(0x1431),'blockedTimestamp':null,'applicationReason':''};if(!_0x5abf0d[_0x389dbd(0x1173)]&&(!_0x5abf0d[_0x389dbd(0x7fd)]||!_0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0x13ab)])){if(!_0x5abf0d['settings'])_0x5abf0d[_0x389dbd(0x7fd)]={};_0x5abf0d['settings']['aiAvatarLibrary']=[];}_0x5abf0d['isGroup']&&(_0x5abf0d[_0x389dbd(0x10a2)]||[])['forEach'](_0x319a98=>{const _0x59fb5b=_0x389dbd;if(typeof _0x319a98[_0x59fb5b(0x1278)]===_0x59fb5b(0x490))_0x319a98[_0x59fb5b(0x1278)]='';});if(!_0x5abf0d[_0x389dbd(0xda7)])_0x5abf0d[_0x389dbd(0xda7)]={'totalTime':0x0};_0x5abf0d[_0x389dbd(0x7fd)]&&_0x5abf0d[_0x389dbd(0x7fd)]['linkedWorldBookId']&&!_0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0xeee)]&&(_0x5abf0d[_0x389dbd(0x7fd)]['linkedWorldBookIds']=[_0x5abf0d['settings'][_0x389dbd(0x679)]],delete _0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0x679)]);if(typeof _0x5abf0d[_0x389dbd(0x13a9)]==='undefined')_0x5abf0d[_0x389dbd(0x13a9)]=![];!_0x5abf0d['isGroup']&&typeof _0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0x1371)]===_0x389dbd(0x490)&&(_0x5abf0d['settings'][_0x389dbd(0x1371)]='我');if(_0x5abf0d[_0x389dbd(0x1173)]&&_0x5abf0d[_0x389dbd(0x10a2)]){let _0x6096d7=![];_0x2d29c2[_0x389dbd(0x427)](_0x3e0cb7=>{const _0x2824d5=_0x389dbd;_0x3e0cb7['id']===_0x5abf0d['id']&&_0x3e0cb7['originalName']&&delete _0x3e0cb7[_0x2824d5(0x628)];}),_0x5abf0d[_0x389dbd(0x10a2)][_0x389dbd(0x427)](_0x4e7a69=>{const _0x45b382=_0x389dbd,_0x496349=_0x2d29c2[_0x45b382(0x1402)](_0x495e2f=>_0x495e2f['id']===_0x4e7a69['id']);if(_0x496349&&_0x496349[_0x45b382(0x7fd)]){const _0xc32d6a=_0x496349[_0x45b382(0x7fd)][_0x45b382(0x3b7)]||'';_0x4e7a69['avatarFrame']!==_0xc32d6a&&(_0x4e7a69[_0x45b382(0x1278)]=_0xc32d6a,_0x6096d7=!![]);}else typeof _0x4e7a69[_0x45b382(0x1278)]==='undefined'&&(_0x4e7a69[_0x45b382(0x1278)]='',_0x6096d7=!![]);});if(_0x6096d7)_0x6ed281[_0x389dbd(0x1474)]['put'](_0x5abf0d);}if(!_0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0x151c)])_0x5abf0d['settings'][_0x389dbd(0x151c)]=![];if(!_0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0x6dc)])_0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0x6dc)]=0x14;if(!_0x5abf0d[_0x389dbd(0x758)])_0x5abf0d['longTermMemory']=[];if(!_0x5abf0d['lastMemorySummaryTimestamp'])_0x5abf0d[_0x389dbd(0xd6a)]=0x0;if(!_0x5abf0d[_0x389dbd(0x1173)]){typeof _0x5abf0d['settings'][_0x389dbd(0x1028)]===_0x389dbd(0x490)&&(_0x5abf0d[_0x389dbd(0x7fd)]['enableBackgroundActivity']=!![]);typeof _0x5abf0d[_0x389dbd(0x7fd)]['enableTts']===_0x389dbd(0x490)&&(_0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0x126c)]=![]);if(!_0x5abf0d['status'])_0x5abf0d[_0x389dbd(0x82c)]={'text':'在线','lastUpdate':Date[_0x389dbd(0x1386)](),'isBusy':![]};if(!_0x5abf0d[_0x389dbd(0x1120)])_0x5abf0d[_0x389dbd(0x1120)]={'status':_0x389dbd(0x1431),'blockedTimestamp':null,'applicationReason':''};if(!_0x5abf0d[_0x389dbd(0x7fd)]||!_0x5abf0d['settings'][_0x389dbd(0x13ab)]){if(!_0x5abf0d[_0x389dbd(0x7fd)])_0x5abf0d[_0x389dbd(0x7fd)]={};_0x5abf0d['settings'][_0x389dbd(0x13ab)]=[];}if(typeof _0x5abf0d['settings'][_0x389dbd(0x206)]===_0x389dbd(0x490))_0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0x206)]=![];if(typeof _0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0xbf5)]===_0x389dbd(0x490))_0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0xbf5)]=0x64;if(typeof _0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0x1571)]==='undefined')_0x5abf0d[_0x389dbd(0x7fd)]['offlineMaxLength']=0x12c;typeof _0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0x118c)]==='undefined'&&(_0x5abf0d[_0x389dbd(0x7fd)]['injectLatestThought']=![]);if(typeof _0x5abf0d[_0x389dbd(0x790)]===_0x389dbd(0x490))_0x5abf0d[_0x389dbd(0x790)]=_0x389dbd(0x76d);if(typeof _0x5abf0d['randomJottings']===_0x389dbd(0x490))_0x5abf0d[_0x389dbd(0x6f1)]='...';!Array[_0x389dbd(0x1524)](_0x5abf0d[_0x389dbd(0xd94)])&&(_0x5abf0d['thoughtsHistory']=[]);}return typeof _0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0xe50)]==='undefined'&&(_0x5abf0d['settings'][_0x389dbd(0xd66)]?_0x5abf0d['settings']['stickerCategoryIds']=[_0x5abf0d[_0x389dbd(0x7fd)]['stickerCategoryId']]:_0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0xe50)]=[],delete _0x5abf0d[_0x389dbd(0x7fd)][_0x389dbd(0xd66)]),_0xc4b020[_0x5abf0d['id']]=_0x5abf0d,_0xc4b020;},{});const _0xd80cda=[];_0x1b1d96[_0x55ecf1(0x427)](_0x2bc2e9=>{const _0x3e74a6=_0x55ecf1;if(_0x2bc2e9['type']===_0x3e74a6(0x13e1)&&_0x2bc2e9[_0x3e74a6(0x8bd)]&&!_0x2bc2e9[_0x3e74a6(0x11b9)]){const _0x34a74e=_0x2d29c2[_0x3e74a6(0x1402)](_0x3e378c=>!_0x3e378c['isGroup']&&_0x3e378c[_0x3e74a6(0x628)]===_0x2bc2e9['authorName']);if(_0x34a74e)_0x2bc2e9[_0x3e74a6(0x11b9)]=_0x34a74e['id'],_0xd80cda['push'](_0x2bc2e9);else{const _0x543e01=_0x2d29c2['find'](_0x423470=>!_0x423470['isGroup']&&_0x423470[_0x3e74a6(0x1467)]===_0x2bc2e9[_0x3e74a6(0x8bd)]);_0x543e01&&(_0x2bc2e9[_0x3e74a6(0x11b9)]=_0x543e01['id'],_0xd80cda[_0x3e74a6(0x1001)](_0x2bc2e9));}}}),_0xd80cda['length']>0x0&&await _0x6ed281[_0x55ecf1(0x9cc)]['bulkPut'](_0xd80cda),_0x16699d[_0x55ecf1(0x79e)]=_0x523af1||{'id':_0x55ecf1(0x1409),'proxyUrl':'','apiKey':'','model':'','secondaryProxyUrl':'','secondaryApiKey':'','secondaryModel':'','minimaxGroupId':'','minimaxApiKey':'','minimaxModel':_0x55ecf1(0xd35)},_0x16699d['userStickers']=_0x5283b4||[],_0x16699d[_0x55ecf1(0x44c)]=_0x57ead4||[],_0x49c6c5['playlist']=_0x271403?.[_0x55ecf1(0x12c8)]||[],_0x16699d[_0x55ecf1(0xbb0)]=_0x42553f||[],_0x16699d[_0x55ecf1(0x66e)]=_0x4210d8||{'id':_0x55ecf1(0x1409),'nickname':_0x55ecf1(0x1347),'avatar':_0x55ecf1(0x50e),'banner':_0x55ecf1(0x14a0)},allFavoriteItems=_0x110ae6||[];}async function _0x26f02f(){const _0x4ce29f=_0x3ce1fb;await _0x6ed281['musicLibrary'][_0x4ce29f(0x90c)]({'id':'main','playlist':_0x49c6c5['playlist']});}function _0x43956a(_0x18f2a7){const _0x22afb2=_0x3ce1fb;if(!_0x18f2a7)return'';const _0x588aef=new Date(_0x18f2a7),_0x584c5d=String(_0x588aef[_0x22afb2(0x12c1)]())['padStart'](0x2,'0'),_0x21a1a3=String(_0x588aef[_0x22afb2(0xc87)]())[_0x22afb2(0x112d)](0x2,'0');return _0x584c5d+':'+_0x21a1a3;}function _0x31ced1(_0x44659c){const _0x527d73=_0x3ce1fb,_0x5596fe=Date[_0x527d73(0x1386)](),_0x110467=Math[_0x527d73(0x15b6)]((_0x5596fe-_0x44659c)/0x3e8);if(_0x110467<0x3c)return'刚刚';const _0xbe5bad=Math[_0x527d73(0x15b6)](_0x110467/0x3c);if(_0xbe5bad<0x3c)return _0xbe5bad+_0x527d73(0x25a);const _0x460b6c=Math[_0x527d73(0x15b6)](_0xbe5bad/0x3c);if(_0x460b6c<0x18)return _0x460b6c+'小时前';const _0x30957c=Math[_0x527d73(0x15b6)](_0x460b6c/0x18);if(_0x30957c<0x1e)return _0x30957c+'天前';const _0x5cc2d5=Math[_0x527d73(0x15b6)](_0x30957c/0x1e);if(_0x5cc2d5<0xc)return'大约'+_0x5cc2d5+_0x527d73(0x1cd);const _0x484dd9=Math['floor'](_0x30957c/0x16d);return'大约'+_0x484dd9+'年前';}function _0x18d6ca(_0x5ef810){const _0x5ad32f=_0x3ce1fb;if(!_0x5ef810)return'';const _0x26ae59=new Date(),_0x146ad7=new Date(_0x5ef810),_0xdb5c6c=String(_0x146ad7[_0x5ad32f(0x12c1)]())[_0x5ad32f(0x112d)](0x2,'0'),_0x5360d4=String(_0x146ad7['getMinutes']())[_0x5ad32f(0x112d)](0x2,'0'),_0x4051c3=_0xdb5c6c+':'+_0x5360d4;if(_0x26ae59['toDateString']()===_0x146ad7[_0x5ad32f(0x8bf)]())return _0x5ad32f(0x872)+_0x4051c3;const _0x26bde7=new Date();_0x26bde7[_0x5ad32f(0xa27)](_0x26ae59[_0x5ad32f(0x13fb)]()-0x1);if(_0x26bde7['toDateString']()===_0x146ad7[_0x5ad32f(0x8bf)]())return'昨天\x20'+_0x4051c3;if(_0x26ae59['getFullYear']()===_0x146ad7[_0x5ad32f(0x3c5)]()){const _0x72dfe0=String(_0x146ad7['getMonth']()+0x1),_0x30fe71=String(_0x146ad7[_0x5ad32f(0x13fb)]());return _0x72dfe0+'月'+_0x30fe71+'日\x20'+_0x4051c3;}const _0x1207dd=_0x146ad7[_0x5ad32f(0x3c5)](),_0x39c14c=String(_0x146ad7[_0x5ad32f(0x12f9)]()+0x1),_0x439dc7=String(_0x146ad7[_0x5ad32f(0x13fb)]());return _0x1207dd+'年'+_0x39c14c+'月'+_0x439dc7+'日\x20'+_0x4051c3;}function _0x27c43e(){const _0x42ccfc=_0x3ce1fb,_0x552c14=_0x186764();document['getElementById']('nai-resolution')[_0x42ccfc(0x5bc)]=_0x552c14['resolution'],document[_0x42ccfc(0x948)](_0x42ccfc(0xb4a))[_0x42ccfc(0x5bc)]=_0x552c14[_0x42ccfc(0xf33)],document[_0x42ccfc(0x948)]('nai-cfg-scale')[_0x42ccfc(0x5bc)]=_0x552c14['cfg_scale'],document[_0x42ccfc(0x948)](_0x42ccfc(0xd0a))[_0x42ccfc(0x5bc)]=_0x552c14[_0x42ccfc(0x6ee)],document['getElementById'](_0x42ccfc(0xaf0))[_0x42ccfc(0x5bc)]=_0x552c14['seed'],document[_0x42ccfc(0x948)](_0x42ccfc(0xa8d))[_0x42ccfc(0x5bc)]=_0x552c14[_0x42ccfc(0x65a)],document[_0x42ccfc(0x948)](_0x42ccfc(0xd0e))[_0x42ccfc(0x210)]=_0x552c14[_0x42ccfc(0x13eb)],document[_0x42ccfc(0x948)](_0x42ccfc(0x1324))['checked']=_0x552c14[_0x42ccfc(0x222)],document['getElementById']('nai-smea-dyn')[_0x42ccfc(0x210)]=_0x552c14['smea_dyn'],document[_0x42ccfc(0x948)](_0x42ccfc(0x2c1))[_0x42ccfc(0x5bc)]=_0x552c14[_0x42ccfc(0x154e)],document[_0x42ccfc(0x948)](_0x42ccfc(0x1002))[_0x42ccfc(0x5bc)]=_0x552c14[_0x42ccfc(0x2fd)],document[_0x42ccfc(0x948)](_0x42ccfc(0x8b0))[_0x42ccfc(0x5bc)]=_0x552c14[_0x42ccfc(0x3ed)],document['getElementById']('nai-custom-proxy-url')[_0x42ccfc(0x5bc)]=_0x552c14[_0x42ccfc(0xbb4)]||'';const _0x15b3a2=document['getElementById'](_0x42ccfc(0xc24));_0x15b3a2[_0x42ccfc(0xf74)][_0x42ccfc(0x11fd)]=_0x552c14['cors_proxy']===_0x42ccfc(0x1310)?'block':_0x42ccfc(0x12fe);}function _0x1e05b2(){const _0x505945=_0x3ce1fb,_0x55bcf3=document['getElementById']('novelai-switch')[_0x505945(0x210)],_0x3e9822=document['getElementById']('novelai-model')[_0x505945(0x5bc)],_0x1fb512=document[_0x505945(0x948)](_0x505945(0x14ce))[_0x505945(0x5bc)][_0x505945(0x2a8)]();localStorage[_0x505945(0x59f)](_0x505945(0xe15),_0x55bcf3),localStorage[_0x505945(0x59f)](_0x505945(0xf36),_0x3e9822),localStorage[_0x505945(0x59f)](_0x505945(0x14ce),_0x1fb512);const _0x4614fc={'resolution':document['getElementById'](_0x505945(0xa77))[_0x505945(0x5bc)],'steps':parseInt(document[_0x505945(0x948)](_0x505945(0xb4a))['value']),'cfg_scale':parseFloat(document[_0x505945(0x948)](_0x505945(0x1075))[_0x505945(0x5bc)]),'sampler':document[_0x505945(0x948)]('nai-sampler')[_0x505945(0x5bc)],'seed':parseInt(document[_0x505945(0x948)](_0x505945(0xaf0))[_0x505945(0x5bc)]),'uc_preset':parseInt(document[_0x505945(0x948)](_0x505945(0xa8d))[_0x505945(0x5bc)]),'quality_toggle':document[_0x505945(0x948)](_0x505945(0xd0e))[_0x505945(0x210)],'smea':document[_0x505945(0x948)](_0x505945(0x1324))[_0x505945(0x210)],'smea_dyn':document[_0x505945(0x948)](_0x505945(0xe81))['checked'],'default_positive':document[_0x505945(0x948)](_0x505945(0x2c1))['value'],'default_negative':document[_0x505945(0x948)](_0x505945(0x1002))[_0x505945(0x5bc)],'cors_proxy':document['getElementById'](_0x505945(0x8b0))[_0x505945(0x5bc)],'custom_proxy_url':document[_0x505945(0x948)]('nai-custom-proxy-url')['value']};localStorage['setItem']('novelai-settings',JSON[_0x505945(0x526)](_0x4614fc));}function _0x4da42b(){const _0x5840bf=_0x3ce1fb;localStorage[_0x5840bf(0xe03)](_0x5840bf(0x7bc)),_0x27c43e(),alert(_0x5840bf(0x885));}function _0x186764(){const _0x216150=_0x3ce1fb,_0x2272bf={'resolution':_0x216150(0x741),'steps':0x1c,'cfg_scale':0x5,'sampler':'k_euler_ancestral','seed':-0x1,'uc_preset':0x1,'quality_toggle':!![],'smea':!![],'smea_dyn':![],'default_positive':_0x216150(0x130f),'default_negative':_0x216150(0xa0a),'cors_proxy':_0x216150(0x1123),'custom_proxy_url':''},_0xb69f0f=localStorage[_0x216150(0x55f)](_0x216150(0x7bc));if(_0xb69f0f)try{return{..._0x2272bf,...JSON[_0x216150(0xde0)](_0xb69f0f)};}catch(_0x10e081){return _0x2272bf;}return _0x2272bf;}async function _0x3036dd(_0x36747e,_0x58762c){const _0x1f792e=_0x3ce1fb;console[_0x1f792e(0x498)](_0x1f792e(0xe2e)+_0x36747e+'\x22,\x20ChatID:\x20'+_0x58762c);const _0x15fbc2=_0x4d36cb(_0x58762c),_0x2f2d96=_0x36747e+',\x20'+_0x15fbc2[_0x1f792e(0x731)],_0x18dfc5=_0x15fbc2['negative'];console['log'](_0x1f792e(0x4ed)+(_0x15fbc2[_0x1f792e(0x1105)]==='character'?_0x1f792e(0xed8):'系统')+'提示词配置'),console['log'](_0x1f792e(0xd93),_0x2f2d96),console[_0x1f792e(0x498)](_0x1f792e(0x117f),_0x18dfc5);const _0x2b6172=localStorage[_0x1f792e(0x55f)](_0x1f792e(0x14ce)),_0x152929=localStorage['getItem']('novelai-model')||_0x1f792e(0x11bc),_0x518c32=_0x186764();if(!_0x2b6172)throw new Error(_0x1f792e(0x13d3));const [_0x5e6dbe,_0x3844dc]=_0x518c32['resolution'][_0x1f792e(0x46f)]('x')[_0x1f792e(0x8ff)](Number);let _0x1037cb;_0x152929[_0x1f792e(0x1336)](_0x1f792e(0x5b2))?_0x1037cb={'input':_0x2f2d96,'model':_0x152929,'action':_0x1f792e(0x110c),'parameters':{'params_version':0x3,'width':_0x5e6dbe,'height':_0x3844dc,'scale':_0x518c32[_0x1f792e(0xd2e)],'sampler':_0x518c32['sampler'],'steps':_0x518c32[_0x1f792e(0xf33)],'seed':_0x518c32[_0x1f792e(0xa0f)]===-0x1?Math[_0x1f792e(0x15b6)](Math[_0x1f792e(0x59c)]()*0x2540be3ff):_0x518c32[_0x1f792e(0xa0f)],'n_samples':0x1,'ucPreset':_0x518c32[_0x1f792e(0x65a)],'qualityToggle':_0x518c32['quality_toggle'],'add_original_image':!![],'noise_schedule':_0x1f792e(0x41b),'v4_prompt':{'caption':{'base_caption':_0x2f2d96,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x18dfc5,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x18dfc5,'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'cfg_rescale':0x0,'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x1037cb={'input':_0x2f2d96,'model':_0x152929,'action':_0x1f792e(0x110c),'parameters':{'width':_0x5e6dbe,'height':_0x3844dc,'scale':_0x518c32[_0x1f792e(0xd2e)],'sampler':_0x518c32[_0x1f792e(0x6ee)],'steps':_0x518c32[_0x1f792e(0xf33)],'seed':_0x518c32[_0x1f792e(0xa0f)]===-0x1?Math[_0x1f792e(0x15b6)](Math[_0x1f792e(0x59c)]()*0x2540be3ff):_0x518c32['seed'],'n_samples':0x1,'ucPreset':_0x518c32[_0x1f792e(0x65a)],'qualityToggle':_0x518c32[_0x1f792e(0x13eb)],'sm':_0x518c32[_0x1f792e(0x222)],'sm_dyn':_0x518c32[_0x1f792e(0xef6)],'negative_prompt':_0x18dfc5,'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':'native'}};console[_0x1f792e(0x498)](_0x1f792e(0xead),_0x1037cb);let _0x1fdba1;_0x152929[_0x1f792e(0x1336)](_0x1f792e(0x5b2))?_0x1fdba1=_0x1f792e(0x98e):_0x1fdba1=_0x1f792e(0x1346);let _0x5151f1=_0x518c32[_0x1f792e(0x3ed)];_0x5151f1===_0x1f792e(0x1310)&&(_0x5151f1=_0x518c32['custom_proxy_url']||'');_0x5151f1&&_0x5151f1!==''&&(_0x1fdba1=_0x5151f1+encodeURIComponent(_0x1fdba1));const _0x368d80=await fetch(_0x1fdba1,{'method':_0x1f792e(0xdca),'headers':{'Content-Type':_0x1f792e(0x479),'Authorization':'Bearer\x20'+_0x2b6172},'body':JSON[_0x1f792e(0x526)](_0x1037cb)});if(!_0x368d80['ok']){const _0x53429d=await _0x368d80['text']();throw new Error('API请求失败\x20('+_0x368d80[_0x1f792e(0x82c)]+_0x1f792e(0xbc0)+_0x53429d);}const _0x5bb368=_0x368d80[_0x1f792e(0xa07)][_0x1f792e(0xe8c)]('content-type');let _0x58430f,_0x114860;if(_0x5bb368&&_0x5bb368['includes'](_0x1f792e(0xffa))){const _0x2deeb5=await _0x368d80[_0x1f792e(0x9ea)](),_0x5230da=_0x2deeb5[_0x1f792e(0x2a8)]()[_0x1f792e(0x46f)]('\x0a');let _0x3e58d7=null;for(let _0x132d2b=_0x5230da[_0x1f792e(0xaf9)]-0x1;_0x132d2b>=0x0;_0x132d2b--){const _0x48db02=_0x5230da[_0x132d2b][_0x1f792e(0x2a8)]();if(_0x48db02['startsWith']('data:\x20')&&_0x48db02!==_0x1f792e(0x1134)){const _0x25d8d5=_0x48db02[_0x1f792e(0xeca)](0x6);try{const _0x50a292=JSON['parse'](_0x25d8d5);if(_0x50a292[_0x1f792e(0x1546)]===_0x1f792e(0x13cd)&&_0x50a292['image']){_0x3e58d7=_0x50a292['image'];break;}if(_0x50a292[_0x1f792e(0x92a)]){_0x3e58d7=_0x50a292[_0x1f792e(0x92a)];break;}if(_0x50a292['image']){_0x3e58d7=_0x50a292[_0x1f792e(0x608)];break;}}catch(_0x1b6f7f){_0x3e58d7=_0x25d8d5;break;}}}if(!_0x3e58d7)throw new Error(_0x1f792e(0xf6b));const _0x18daa6=_0x3e58d7[_0x1f792e(0x157f)]('iVBORw0KGgo'),_0x145d5b=_0x3e58d7[_0x1f792e(0x157f)](_0x1f792e(0x1308));if(_0x18daa6||_0x145d5b)_0x114860='data:'+(_0x18daa6?_0x1f792e(0x13ce):'image/jpeg')+_0x1f792e(0xb53)+_0x3e58d7;else{const _0x196735=atob(_0x3e58d7),_0x561552=new Uint8Array(_0x196735['length']);for(let _0x171585=0x0;_0x171585<_0x196735['length'];_0x171585++)_0x561552[_0x171585]=_0x196735[_0x1f792e(0x141f)](_0x171585);_0x58430f=new Blob([_0x561552]);}}else _0x58430f=await _0x368d80[_0x1f792e(0x250)]();if(!_0x114860&&_0x58430f){if(typeof JSZip==='undefined')throw new Error('JSZip库未加载');const _0x2db881=await JSZip[_0x1f792e(0xe25)](_0x58430f);let _0x28548f=null;for(let _0xe5f5c9 in _0x2db881[_0x1f792e(0x10b0)]){if(_0xe5f5c9[_0x1f792e(0x9a3)](/\.(png|jpg|jpeg|webp)$/i)){_0x28548f=_0x2db881[_0x1f792e(0x10b0)][_0xe5f5c9];break;}}if(!_0x28548f)throw new Error('ZIP文件中未找到图片');const _0x167071=await _0x28548f[_0x1f792e(0x706)](_0x1f792e(0x250));_0x114860=await new Promise((_0x13a4d7,_0x1a1156)=>{const _0x30c854=_0x1f792e,_0x16e670=new FileReader();_0x16e670[_0x30c854(0x55b)]=()=>_0x13a4d7(_0x16e670['result']),_0x16e670[_0x30c854(0x12eb)]=_0x1a1156,_0x16e670[_0x30c854(0x5a5)](_0x167071);});}return console['log'](_0x1f792e(0xdc1)),{'imageUrl':_0x114860,'fullPrompt':_0x2f2d96};}function _0x4d36cb(_0x51504c){const _0x29290b=_0x3ce1fb,_0x5bf54f=_0x186764();if(!_0x51504c||!_0x16699d[_0x29290b(0x1474)][_0x51504c])return console['log'](_0x29290b(0x89e)),{'positive':_0x5bf54f[_0x29290b(0x154e)],'negative':_0x5bf54f[_0x29290b(0x2fd)],'source':_0x29290b(0x11af)};const _0x2f6239=_0x16699d['chats'][_0x51504c],_0x5df4e1=_0x2f6239[_0x29290b(0x7fd)][_0x29290b(0x1d4)]||{};return _0x5df4e1['promptSource']===_0x29290b(0x4d1)?(console[_0x29290b(0x498)](_0x29290b(0x1ab)),console[_0x29290b(0x498)](_0x29290b(0x809),_0x5df4e1[_0x29290b(0xee5)]||_0x29290b(0xf79)),console[_0x29290b(0x498)](_0x29290b(0x103a),_0x5df4e1['characterNegativePrompt']||_0x29290b(0xf79)),{'positive':_0x5df4e1['characterPositivePrompt']||'','negative':_0x5df4e1['characterNegativePrompt']||'','source':_0x29290b(0x4d1)}):(console[_0x29290b(0x498)](_0x29290b(0xe71)),console['log'](_0x29290b(0x809),_0x5bf54f[_0x29290b(0x154e)]||_0x29290b(0xf79)),console[_0x29290b(0x498)]('\x20\x20\x20负面:',_0x5bf54f[_0x29290b(0x2fd)]||_0x29290b(0xf79)),{'positive':_0x5bf54f[_0x29290b(0x154e)],'negative':_0x5bf54f[_0x29290b(0x2fd)],'source':'system'});}async function _0x3d2fa3(){const _0x330f2c=_0x3ce1fb,_0x12ab93=document[_0x330f2c(0x948)]('novelai-api-key')[_0x330f2c(0x5bc)][_0x330f2c(0x2a8)](),_0x42726f=document[_0x330f2c(0x948)](_0x330f2c(0xf36))[_0x330f2c(0x5bc)],_0x169d5e=document['getElementById']('nai-test-prompt')[_0x330f2c(0x5bc)][_0x330f2c(0x2a8)]();if(!_0x12ab93){alert(_0x330f2c(0xe80));return;}if(!_0x169d5e){alert(_0x330f2c(0x5b1));return;}const _0xbad3a4=_0x186764(),_0x2ac835=document[_0x330f2c(0x948)](_0x330f2c(0x1509))[_0x330f2c(0x5bc)][_0x330f2c(0x2a8)](),_0x1dd50f=document['getElementById'](_0x330f2c(0x43f)),_0x2fb7f5=document['getElementById'](_0x330f2c(0x1f6)),_0x29ea4e=document['getElementById']('nai-test-error'),_0x8170f7=document[_0x330f2c(0x948)](_0x330f2c(0xa04));_0x1dd50f[_0x330f2c(0xf74)][_0x330f2c(0x11fd)]=_0x330f2c(0x1273),_0x2fb7f5[_0x330f2c(0xf74)][_0x330f2c(0x11fd)]='none',_0x29ea4e['style'][_0x330f2c(0x11fd)]=_0x330f2c(0x12fe),_0x8170f7[_0x330f2c(0x2c0)]=!![],_0x8170f7[_0x330f2c(0x10cb)]=_0x330f2c(0x11fa);try{const [_0xabad65,_0x5e0ed1]=_0xbad3a4[_0x330f2c(0x10d3)][_0x330f2c(0x46f)]('x')['map'](Number);let _0x362f32;_0x42726f['includes'](_0x330f2c(0x5b2))?_0x362f32={'input':_0x169d5e,'model':_0x42726f,'action':_0x330f2c(0x110c),'parameters':{'params_version':0x3,'width':_0xabad65,'height':_0x5e0ed1,'scale':_0xbad3a4[_0x330f2c(0xd2e)],'sampler':_0xbad3a4[_0x330f2c(0x6ee)],'steps':_0xbad3a4[_0x330f2c(0xf33)],'seed':_0xbad3a4[_0x330f2c(0xa0f)]===-0x1?Math[_0x330f2c(0x15b6)](Math[_0x330f2c(0x59c)]()*0x2540be3ff):_0xbad3a4[_0x330f2c(0xa0f)],'n_samples':0x1,'ucPreset':_0xbad3a4[_0x330f2c(0x65a)],'qualityToggle':_0xbad3a4[_0x330f2c(0x13eb)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':'karras','legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x169d5e,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x2ac835,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x2ac835,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x362f32={'input':_0x169d5e,'model':_0x42726f,'action':_0x330f2c(0x110c),'parameters':{'width':_0xabad65,'height':_0x5e0ed1,'scale':_0xbad3a4[_0x330f2c(0xd2e)],'sampler':_0xbad3a4['sampler'],'steps':_0xbad3a4[_0x330f2c(0xf33)],'seed':_0xbad3a4['seed']===-0x1?Math[_0x330f2c(0x15b6)](Math[_0x330f2c(0x59c)]()*0x2540be3ff):_0xbad3a4['seed'],'n_samples':0x1,'ucPreset':_0xbad3a4[_0x330f2c(0x65a)],'qualityToggle':_0xbad3a4['quality_toggle'],'sm':_0xbad3a4[_0x330f2c(0x222)],'sm_dyn':_0xbad3a4[_0x330f2c(0xef6)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':'native','negative_prompt':_0x2ac835}};console[_0x330f2c(0x498)](_0x330f2c(0x1262)),console[_0x330f2c(0x498)](_0x330f2c(0xeea),_0x42726f),console[_0x330f2c(0x498)](_0x330f2c(0xb65),JSON[_0x330f2c(0x526)](_0x362f32,null,0x2));let _0x4c4051;_0x42726f[_0x330f2c(0x1336)](_0x330f2c(0x5b2))?_0x4c4051=_0x330f2c(0x98e):_0x4c4051='https://image.novelai.net/ai/generate-image';let _0x3057fa=_0xbad3a4[_0x330f2c(0x3ed)];_0x3057fa===_0x330f2c(0x1310)&&(_0x3057fa=_0xbad3a4[_0x330f2c(0xbb4)]||'');_0x3057fa&&_0x3057fa!==''&&(_0x4c4051=_0x3057fa+encodeURIComponent(_0x4c4051));const _0x1c3f9c=/Chrome/['test'](navigator[_0x330f2c(0x140a)])&&!/Edg/[_0x330f2c(0x367)](navigator[_0x330f2c(0x140a)]);let _0xdf069c={'method':_0x330f2c(0xdca),'headers':{'Content-Type':'application/json','Authorization':_0x330f2c(0xb0e)+_0x12ab93},'body':JSON[_0x330f2c(0x526)](_0x362f32)};if(_0x1c3f9c){console[_0x330f2c(0x498)](_0x330f2c(0x625));const _0xe3ff79={};for(const [_0x38325e,_0x176836]of Object[_0x330f2c(0x6ea)](_0xdf069c[_0x330f2c(0xa07)])){_0xe3ff79[_0x38325e]=_0x176836['replace'](/[^\x00-\xFF]/g,'');}_0xdf069c[_0x330f2c(0xa07)]=_0xe3ff79;}const _0x40462b=await fetch(_0x4c4051,_0xdf069c);console[_0x330f2c(0x498)]('Response\x20status:',_0x40462b['status']),console[_0x330f2c(0x498)](_0x330f2c(0x12f3),[..._0x40462b[_0x330f2c(0xa07)][_0x330f2c(0x6ea)]()]);if(!_0x40462b['ok']){const _0x1b8da1=await _0x40462b['text']();console[_0x330f2c(0xc3e)](_0x330f2c(0x44b),_0x1b8da1);throw new Error(_0x330f2c(0x8fb)+_0x40462b[_0x330f2c(0x82c)]+'):\x20'+_0x1b8da1);}const _0x53747c=_0x40462b[_0x330f2c(0xa07)][_0x330f2c(0xe8c)](_0x330f2c(0x128c));console[_0x330f2c(0x498)]('Content-Type:',_0x53747c);let _0x3a2562;if(_0x53747c&&_0x53747c['includes']('text/event-stream')){console['log'](_0x330f2c(0x40d)),_0x1dd50f['textContent']=_0x330f2c(0xfdb);const _0x585ef0=await _0x40462b[_0x330f2c(0x9ea)]();console[_0x330f2c(0x498)](_0x330f2c(0x93d),_0x585ef0[_0x330f2c(0xaf9)]);const _0x527736=_0x585ef0[_0x330f2c(0x2a8)]()[_0x330f2c(0x46f)]('\x0a');let _0x561442=null;for(let _0x164c15=_0x527736[_0x330f2c(0xaf9)]-0x1;_0x164c15>=0x0;_0x164c15--){const _0x50343f=_0x527736[_0x164c15][_0x330f2c(0x2a8)]();if(_0x50343f['startsWith'](_0x330f2c(0x11f3))&&_0x50343f!==_0x330f2c(0x1134)){const _0x418a23=_0x50343f['substring'](0x6);try{const _0x2809c0=JSON['parse'](_0x418a23);if(_0x2809c0[_0x330f2c(0x1546)]===_0x330f2c(0x13cd)&&_0x2809c0[_0x330f2c(0x608)]){_0x561442=_0x2809c0['image'],console[_0x330f2c(0x498)](_0x330f2c(0xdf8));break;}if(_0x2809c0['data']){_0x561442=_0x2809c0['data'],console[_0x330f2c(0x498)](_0x330f2c(0x3c3));break;}if(_0x2809c0[_0x330f2c(0x608)]){_0x561442=_0x2809c0[_0x330f2c(0x608)],console[_0x330f2c(0x498)](_0x330f2c(0x37e));break;}}catch(_0x2f16a4){_0x561442=_0x418a23,console[_0x330f2c(0x498)]('直接使用\x20base64\x20数据');break;}}}if(!_0x561442)throw new Error('无法从\x20SSE\x20响应中提取图片数据');const _0x2c1900=_0x561442[_0x330f2c(0x157f)]('iVBORw0KGgo'),_0xd8a1ce=_0x561442[_0x330f2c(0x157f)](_0x330f2c(0x1308));if(_0x2c1900||_0xd8a1ce){console[_0x330f2c(0x498)](_0x330f2c(0xb87));const _0x42f0da=atob(_0x561442),_0x16a20d=new Uint8Array(_0x42f0da['length']);for(let _0x4fde44=0x0;_0x4fde44<_0x42f0da['length'];_0x4fde44++){_0x16a20d[_0x4fde44]=_0x42f0da[_0x330f2c(0x141f)](_0x4fde44);}const _0x3bf183=new Blob([_0x16a20d],{'type':_0x2c1900?_0x330f2c(0x13ce):_0x330f2c(0x1516)});console[_0x330f2c(0x498)](_0x330f2c(0x306),_0x3bf183[_0x330f2c(0x8ca)]);const _0x5723d9=URL[_0x330f2c(0x91d)](_0x3bf183);document[_0x330f2c(0x948)](_0x330f2c(0x939))['src']=_0x5723d9,_0x1dd50f[_0x330f2c(0xf74)]['display']=_0x330f2c(0x12fe),_0x2fb7f5[_0x330f2c(0xf74)][_0x330f2c(0x11fd)]=_0x330f2c(0x1273),console['log'](_0x330f2c(0x9eb));return;}console[_0x330f2c(0x498)](_0x330f2c(0x5fa));const _0x1d26a2=atob(_0x561442),_0x59192f=new Uint8Array(_0x1d26a2[_0x330f2c(0xaf9)]);for(let _0x185711=0x0;_0x185711<_0x1d26a2[_0x330f2c(0xaf9)];_0x185711++){_0x59192f[_0x185711]=_0x1d26a2[_0x330f2c(0x141f)](_0x185711);}_0x3a2562=new Blob([_0x59192f]),console[_0x330f2c(0x498)](_0x330f2c(0x512),_0x3a2562[_0x330f2c(0x8ca)]);}else _0x3a2562=await _0x40462b[_0x330f2c(0x250)](),console['log'](_0x330f2c(0xa51),_0x3a2562[_0x330f2c(0x4ae)],_0x330f2c(0x10bf),_0x3a2562['size']);try{if(typeof JSZip===_0x330f2c(0x490))throw new Error(_0x330f2c(0x4a1));_0x1dd50f[_0x330f2c(0x10cb)]=_0x330f2c(0x6e8);const _0x23f701=await JSZip[_0x330f2c(0xe25)](_0x3a2562);console[_0x330f2c(0x498)]('ZIP文件内容:',Object[_0x330f2c(0x1cf)](_0x23f701['files']));let _0xda68e6=null;for(let _0x2491b8 in _0x23f701['files']){if(_0x2491b8[_0x330f2c(0x9a3)](/\.(png|jpg|jpeg|webp)$/i)){_0xda68e6=_0x23f701[_0x330f2c(0x10b0)][_0x2491b8],console['log'](_0x330f2c(0x10bc),_0x2491b8);break;}}if(!_0xda68e6)throw new Error(_0x330f2c(0xc47));const _0x193efa=await _0xda68e6['async'](_0x330f2c(0x250));console[_0x330f2c(0x498)](_0x330f2c(0x501),_0x193efa[_0x330f2c(0x8ca)]);const _0x43b578=URL['createObjectURL'](_0x193efa);console[_0x330f2c(0x498)]('生成的图片URL:',_0x43b578),document[_0x330f2c(0x948)](_0x330f2c(0x939))['src']=_0x43b578,_0x1dd50f[_0x330f2c(0xf74)]['display']=_0x330f2c(0x12fe),_0x2fb7f5['style'][_0x330f2c(0x11fd)]=_0x330f2c(0x1273);}catch(_0x2f4a75){console['error'](_0x330f2c(0x10e9),_0x2f4a75),console[_0x330f2c(0x498)](_0x330f2c(0x1372));if(_0x3a2562[_0x330f2c(0x4ae)]['startsWith'](_0x330f2c(0x1508))){const _0x2a7c07=URL[_0x330f2c(0x91d)](_0x3a2562);document[_0x330f2c(0x948)]('nai-result-image')['src']=_0x2a7c07,_0x1dd50f[_0x330f2c(0xf74)]['display']=_0x330f2c(0x12fe),_0x2fb7f5[_0x330f2c(0xf74)]['display']=_0x330f2c(0x1273);}else throw new Error(_0x330f2c(0xa6e)+_0x2f4a75[_0x330f2c(0x74b)]);}}catch(_0x7898c9){console[_0x330f2c(0xc3e)](_0x330f2c(0xd3c),_0x7898c9),_0x1dd50f[_0x330f2c(0xf74)][_0x330f2c(0x11fd)]=_0x330f2c(0x12fe),_0x29ea4e[_0x330f2c(0xf74)][_0x330f2c(0x11fd)]=_0x330f2c(0x1273),_0x29ea4e[_0x330f2c(0x10cb)]=_0x330f2c(0x385)+_0x7898c9[_0x330f2c(0x74b)];}finally{_0x8170f7[_0x330f2c(0x2c0)]=![],_0x8170f7[_0x330f2c(0x10cb)]=_0x330f2c(0x13b4);}}function _0x2e32a5(_0x176bca,_0x1e8791){const _0x7b5eb8=_0x3ce1fb;_0x4b5874(),clearTimeout(_0x520eda);const _0x481fbc=_0x16699d[_0x7b5eb8(0x1474)][_0x176bca];if(!_0x481fbc)return;const _0x1d1045=document['getElementById']('notification-bar');document[_0x7b5eb8(0x948)](_0x7b5eb8(0x148c))['src']=_0x481fbc[_0x7b5eb8(0x7fd)][_0x7b5eb8(0x156d)]||_0x481fbc[_0x7b5eb8(0x7fd)][_0x7b5eb8(0x1e7)]||_0x202ba5,document[_0x7b5eb8(0x948)](_0x7b5eb8(0x14da))['querySelector'](_0x7b5eb8(0x15b5))[_0x7b5eb8(0x10cb)]=_0x481fbc[_0x7b5eb8(0x1467)],document['getElementById'](_0x7b5eb8(0x14da))[_0x7b5eb8(0xfeb)](_0x7b5eb8(0x26f))[_0x7b5eb8(0x10cb)]=_0x1e8791,_0x1d1045['classList'][_0x7b5eb8(0xf89)](_0x7b5eb8(0xfcb)),void _0x1d1045[_0x7b5eb8(0x5f7)],_0x1d1045[_0x7b5eb8(0xd54)][_0x7b5eb8(0xbd0)](_0x7b5eb8(0xfcb));const _0x58627c=_0x1d1045[_0x7b5eb8(0xfc0)](!![]);_0x1d1045['parentNode']['replaceChild'](_0x58627c,_0x1d1045),_0x58627c['addEventListener'](_0x7b5eb8(0x4f6),()=>{const _0xa02656=_0x7b5eb8;_0x5b2fb4(_0x176bca),_0x58627c['classList'][_0xa02656(0xf89)](_0xa02656(0xfcb));}),_0x520eda=setTimeout(()=>{const _0x4e8339=_0x7b5eb8;_0x58627c[_0x4e8339(0xd54)][_0x4e8339(0xf89)]('visible');},0xfa0),_0x88f8e2();}function _0x485fad(){const _0x1bbd23=_0x3ce1fb,_0x186797=new Date(),_0x212f1e=_0x186797['toLocaleTimeString'](_0x1bbd23(0x144f),{'hour':_0x1bbd23(0x13d0),'minute':_0x1bbd23(0x13d0)}),_0x164140=_0x186797[_0x1bbd23(0xf98)](_0x1bbd23(0x144f),{'weekday':_0x1bbd23(0x97c),'month':_0x1bbd23(0x97c),'day':'numeric'});document['getElementById'](_0x1bbd23(0x1299))['textContent']=_0x212f1e;}function _0xad600c(_0x2470cb){const _0x48a32e=_0x3ce1fb;if(!_0x2470cb)return[{'type':'text','content':_0x48a32e(0xec7)}];let _0x10d79d=_0x2470cb[_0x48a32e(0x2a8)]();const _0x1d062e=/```json\s*([\s\S]*?)\s*```/,_0x2f464e=_0x10d79d[_0x48a32e(0x9a3)](_0x1d062e);_0x2f464e&&_0x2f464e[0x1]&&(_0x10d79d=_0x2f464e[0x1][_0x48a32e(0x2a8)](),console[_0x48a32e(0x498)](_0x48a32e(0x150f)));if(_0x10d79d['startsWith']('[')&&_0x10d79d[_0x48a32e(0x918)](']'))try{const _0x163922=JSON[_0x48a32e(0xde0)](_0x10d79d);if(Array[_0x48a32e(0x1524)](_0x163922))return console['log'](_0x48a32e(0x7b5)),_0x163922;}catch(_0x331247){console[_0x48a32e(0x9c1)](_0x48a32e(0x1066));}const _0x4b4f62=_0x10d79d[_0x48a32e(0x539)]('['),_0x51e33c=_0x10d79d[_0x48a32e(0x90f)]('}');if(_0x4b4f62!==-0x1&&_0x51e33c!==-0x1&&_0x51e33c>_0x4b4f62){const _0x2d04ba=_0x10d79d[_0x48a32e(0x539)](']',_0x51e33c);if(_0x2d04ba!==-0x1){const _0x5d87b9=_0x10d79d[_0x48a32e(0xeca)](_0x4b4f62,_0x2d04ba+0x1);try{const _0x29627f=JSON['parse'](_0x5d87b9);if(Array[_0x48a32e(0x1524)](_0x29627f))return console[_0x48a32e(0x498)](_0x48a32e(0xc8b)),_0x29627f;}catch(_0x3f7ac4){console[_0x48a32e(0x9c1)](_0x48a32e(0x654));}}}const _0x179106=_0x10d79d[_0x48a32e(0x9a3)](/{[^{}]*}/g);if(_0x179106){const _0x4fb03a=[];for(const _0x4e0941 of _0x179106){try{const _0x2379fc=JSON[_0x48a32e(0xde0)](_0x4e0941);_0x4fb03a['push'](_0x2379fc);}catch(_0x3cdd20){console['warn'](_0x48a32e(0x1248),_0x4e0941);}}if(_0x4fb03a[_0x48a32e(0xaf9)]>0x0)return console[_0x48a32e(0x498)]('解析成功：通过强力提取\x20{...}\x20模式。'),_0x4fb03a;}return console[_0x48a32e(0xc3e)](_0x48a32e(0x3d3),_0x2470cb),[{'type':'text','content':_0x2470cb}];}function _0x107c99(_0x15957e=new Date()){const _0x5b3b3a=_0x3ce1fb,_0x19f979=_0x15957e[_0x5b3b3a(0x12c1)]();if(_0x19f979>=0x0&&_0x19f979<0x5)return'凌晨';else{if(_0x19f979>=0x5&&_0x19f979<0x9)return'早上';else{if(_0x19f979>=0x9&&_0x19f979<0xd)return'上午';else{if(_0x19f979>=0xd&&_0x19f979<0x12)return'下午';else{if(_0x19f979>=0x12&&_0x19f979<0x18)return'晚上';}}}}return'现在';}async function _0x41f3e0(){const _0xb3078f=_0x3ce1fb,_0x6fdce4=document[_0xb3078f(0x948)](_0xb3078f(0x759));_0x6fdce4[_0xb3078f(0xb6f)]=_0xb3078f(0x106e);const _0x566ebb=await _0x6ed281['apiPresets'][_0xb3078f(0x443)]();_0x566ebb[_0xb3078f(0x427)](_0x149796=>{const _0x195810=_0xb3078f,_0x2c96be=document[_0x195810(0x1497)](_0x195810(0x152c));_0x2c96be['value']=_0x149796['id'],_0x2c96be[_0x195810(0x10cb)]=_0x149796['name'],_0x6fdce4[_0x195810(0x6b6)](_0x2c96be);});const _0x12b0a1=_0x16699d[_0xb3078f(0x79e)];let _0x56f605=null;for(const _0x2b94c5 of _0x566ebb){if(_0x2b94c5[_0xb3078f(0x366)]===_0x12b0a1[_0xb3078f(0x366)]&&_0x2b94c5[_0xb3078f(0xaa1)]===_0x12b0a1['apiKey']&&_0x2b94c5[_0xb3078f(0x531)]===_0x12b0a1[_0xb3078f(0x531)]&&_0x2b94c5[_0xb3078f(0xde5)]===_0x12b0a1[_0xb3078f(0xde5)]&&_0x2b94c5[_0xb3078f(0x11bf)]===_0x12b0a1[_0xb3078f(0x11bf)]&&_0x2b94c5[_0xb3078f(0x688)]===_0x12b0a1[_0xb3078f(0x688)]&&(_0x2b94c5[_0xb3078f(0x411)]||'')===(_0x12b0a1['minimaxGroupId']||'')&&(_0x2b94c5['minimaxApiKey']||'')===(_0x12b0a1[_0xb3078f(0x7ca)]||'')&&(_0x2b94c5[_0xb3078f(0x63f)]||'speech-01')===(_0x12b0a1['minimaxModel']||_0xb3078f(0xd35))){_0x56f605=_0x2b94c5['id'];break;}}_0x56f605?_0x6fdce4[_0xb3078f(0x5bc)]=_0x56f605:_0x6fdce4['value']=_0xb3078f(0xe5d);}async function _0x317a0e(){const _0x201afa=_0x3ce1fb,_0x51d555=document[_0x201afa(0x948)](_0x201afa(0x759)),_0x3bae30=parseInt(_0x51d555['value']);if(isNaN(_0x3bae30))return;const _0x424641=await _0x6ed281[_0x201afa(0x448)][_0x201afa(0xe8c)](_0x3bae30);_0x424641&&(_0x16699d[_0x201afa(0x79e)]={'id':_0x201afa(0x1409),'proxyUrl':_0x424641[_0x201afa(0x366)],'apiKey':_0x424641[_0x201afa(0xaa1)],'model':_0x424641[_0x201afa(0x531)],'secondaryProxyUrl':_0x424641['secondaryProxyUrl'],'secondaryApiKey':_0x424641[_0x201afa(0x11bf)],'secondaryModel':_0x424641[_0x201afa(0x688)],'minimaxGroupId':_0x424641[_0x201afa(0x411)],'minimaxApiKey':_0x424641[_0x201afa(0x7ca)],'minimaxModel':_0x424641[_0x201afa(0x63f)]},await _0x6ed281[_0x201afa(0x79e)]['put'](_0x16699d[_0x201afa(0x79e)]),_0x587299(),document[_0x201afa(0x948)](_0x201afa(0x13f6))[_0x201afa(0x4f6)](),_0x424641[_0x201afa(0xde5)]&&_0x424641['secondaryApiKey']&&document[_0x201afa(0x948)](_0x201afa(0x987))['click'](),alert(_0x201afa(0xcde)+_0x424641[_0x201afa(0x1467)]+'”'));}async function _0x5a3a77(){const _0x4f3e54=_0x3ce1fb,_0x4c156e=await _0x41b9fc(_0x4f3e54(0x532),_0x4f3e54(0x1228));if(!_0x4c156e||!_0x4c156e['trim']())return;const _0xa4507b={'name':_0x4c156e[_0x4f3e54(0x2a8)](),'proxyUrl':document['getElementById'](_0x4f3e54(0xba7))[_0x4f3e54(0x5bc)][_0x4f3e54(0x2a8)](),'apiKey':document[_0x4f3e54(0x948)](_0x4f3e54(0x4bc))[_0x4f3e54(0x5bc)]['trim'](),'model':document[_0x4f3e54(0x948)]('model-select')[_0x4f3e54(0x5bc)],'secondaryProxyUrl':document[_0x4f3e54(0x948)](_0x4f3e54(0x5d4))[_0x4f3e54(0x5bc)]['trim'](),'secondaryApiKey':document['getElementById'](_0x4f3e54(0x733))[_0x4f3e54(0x5bc)][_0x4f3e54(0x2a8)](),'secondaryModel':document[_0x4f3e54(0x948)](_0x4f3e54(0x11d9))[_0x4f3e54(0x5bc)],'minimaxGroupId':document[_0x4f3e54(0x948)](_0x4f3e54(0xe3a))[_0x4f3e54(0x5bc)][_0x4f3e54(0x2a8)](),'minimaxApiKey':document['getElementById'](_0x4f3e54(0x609))[_0x4f3e54(0x5bc)][_0x4f3e54(0x2a8)](),'minimaxModel':document[_0x4f3e54(0x948)]('minimax-model-select')[_0x4f3e54(0x5bc)]},_0x41651e=await _0x6ed281[_0x4f3e54(0x448)][_0x4f3e54(0x1117)](_0x4f3e54(0x1467))[_0x4f3e54(0xba9)](_0xa4507b[_0x4f3e54(0x1467)])[_0x4f3e54(0x678)]();if(_0x41651e){const _0x3eb406=await _0xa6b74a(_0x4f3e54(0x2f4),'名为\x20“'+_0xa4507b[_0x4f3e54(0x1467)]+'”\x20的预设已存在。要覆盖它吗？',{'confirmButtonClass':'btn-danger'});if(!_0x3eb406)return;_0xa4507b['id']=_0x41651e['id'];}await _0x6ed281[_0x4f3e54(0x448)]['put'](_0xa4507b),await _0x41f3e0(),alert(_0x4f3e54(0x7d7));}async function _0x5e8d5d(){const _0x126ee0=_0x3ce1fb,_0x4f0e05=document[_0x126ee0(0x948)](_0x126ee0(0x759)),_0x462b89=parseInt(_0x4f0e05['value']);if(isNaN(_0x462b89)){alert(_0x126ee0(0xfb6));return;}const _0x49f25d=await _0x6ed281[_0x126ee0(0x448)]['get'](_0x462b89);if(!_0x49f25d)return;const _0x366aef=await _0xa6b74a(_0x126ee0(0xbc2),'确定要删除预设\x20“'+_0x49f25d['name']+_0x126ee0(0x2dd),{'confirmButtonClass':_0x126ee0(0x5e8)});_0x366aef&&(await _0x6ed281[_0x126ee0(0x448)][_0x126ee0(0x869)](_0x462b89),await _0x41f3e0(),alert('预设已删除。'));}function _0x587299(){const _0x2eb735=_0x3ce1fb;document[_0x2eb735(0x948)]('proxy-url')['value']=_0x16699d['apiConfig'][_0x2eb735(0x366)]||'',document[_0x2eb735(0x948)](_0x2eb735(0x4bc))[_0x2eb735(0x5bc)]=_0x16699d[_0x2eb735(0x79e)][_0x2eb735(0xaa1)]||'',document[_0x2eb735(0x948)]('secondary-proxy-url')['value']=_0x16699d[_0x2eb735(0x79e)][_0x2eb735(0xde5)]||'',document['getElementById']('secondary-api-key')['value']=_0x16699d[_0x2eb735(0x79e)]['secondaryApiKey']||'',document[_0x2eb735(0x948)](_0x2eb735(0x3af))[_0x2eb735(0x210)]=_0x16699d[_0x2eb735(0xf9c)]['enableBackgroundActivity']||![],document['getElementById'](_0x2eb735(0x3e2))[_0x2eb735(0x5bc)]=_0x16699d['globalSettings'][_0x2eb735(0x996)]||0x3c,document[_0x2eb735(0x948)](_0x2eb735(0x5c1))[_0x2eb735(0x5bc)]=_0x16699d[_0x2eb735(0xf9c)][_0x2eb735(0x4b1)]||0x1,document['getElementById'](_0x2eb735(0x73b))['checked']=_0x16699d[_0x2eb735(0xf9c)]['enableAiDrawing'],document['getElementById']('chat-render-window-input')[_0x2eb735(0x5bc)]=_0x16699d[_0x2eb735(0xf9c)][_0x2eb735(0x59a)]||0x32,document['getElementById'](_0x2eb735(0x149e))[_0x2eb735(0x5bc)]=_0x16699d['globalSettings'][_0x2eb735(0xa58)]||0x1e;const _0x1eaaa1=document['getElementById'](_0x2eb735(0x305)),_0x4b2f22=document['getElementById'](_0x2eb735(0x461)),_0x382c5d=_0x16699d[_0x2eb735(0xf9c)][_0x2eb735(0x382)]||0.8;_0x1eaaa1[_0x2eb735(0x5bc)]=_0x382c5d,_0x4b2f22[_0x2eb735(0x10cb)]=_0x382c5d,document[_0x2eb735(0x948)]('minimax-group-id')[_0x2eb735(0x5bc)]=_0x16699d['apiConfig'][_0x2eb735(0x411)]||'',document[_0x2eb735(0x948)](_0x2eb735(0x609))['value']=_0x16699d['apiConfig'][_0x2eb735(0x7ca)]||'',document[_0x2eb735(0x948)]('minimax-model-select')[_0x2eb735(0x5bc)]=_0x16699d[_0x2eb735(0x79e)][_0x2eb735(0x63f)]||_0x2eb735(0xd35);const _0xb26b61=localStorage[_0x2eb735(0x55f)](_0x2eb735(0xe15))===_0x2eb735(0xefd),_0xac0a43=localStorage[_0x2eb735(0x55f)](_0x2eb735(0xf36))||_0x2eb735(0x11bc),_0x108287=localStorage[_0x2eb735(0x55f)](_0x2eb735(0x14ce))||'';document[_0x2eb735(0x948)](_0x2eb735(0x1093))['checked']=_0xb26b61,document[_0x2eb735(0x948)](_0x2eb735(0xf36))[_0x2eb735(0x5bc)]=_0xac0a43,document[_0x2eb735(0x948)](_0x2eb735(0x14ce))[_0x2eb735(0x5bc)]=_0x108287,document[_0x2eb735(0x948)](_0x2eb735(0x930))[_0x2eb735(0xf74)][_0x2eb735(0x11fd)]=_0xb26b61?'block':'none',_0x41f3e0(),_0x1f0417();}window[_0x3ce1fb(0x102b)]=_0x587299;async function _0x1ea6a0(){const _0x5e17e6=_0x3ce1fb,_0x1d7487=document[_0x5e17e6(0x948)](_0x5e17e6(0xa26));_0x1d7487[_0x5e17e6(0xb6f)]='';const _0x534a6a=await _0x6ed281[_0x5e17e6(0xa59)]['toArray']();if(_0x534a6a[_0x5e17e6(0xaf9)]===0x0){_0x1d7487['innerHTML']=_0x5e17e6(0xc7a);return;}_0x534a6a['forEach'](_0xb20a08=>{const _0x14eacd=_0x5e17e6,_0x35d950=document[_0x14eacd(0x1497)](_0x14eacd(0x379));_0x35d950['className']=_0x14eacd(0x1322),_0x35d950[_0x14eacd(0x606)][_0x14eacd(0xa18)]=_0xb20a08['id'],_0x35d950['innerHTML']=_0x14eacd(0xa21)+(_0xb20a08[_0x14eacd(0x63e)]||_0x3ca5ef)+'\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0xb20a08['name']+_0x14eacd(0x852)+_0xb20a08[_0x14eacd(0xbad)][_0x14eacd(0xeca)](0x0,0x1e)+_0x14eacd(0x1469),_0x35d950['addEventListener'](_0x14eacd(0x4f6),()=>_0x3330d7(_0xb20a08['id'])),_0x159366(_0x35d950,async()=>{await _0x5e5fe9(_0xb20a08['id']);}),_0x1d7487[_0x14eacd(0x6b6)](_0x35d950);});}async function _0x3330d7(_0x3d233c=null){const _0x49dc44=_0x3ce1fb;editingNpcId=_0x3d233c;const _0x387a10=document[_0x49dc44(0x948)](_0x49dc44(0x1457)),_0x12caf2=document[_0x49dc44(0x948)](_0x49dc44(0x202)),_0x444c44=document['getElementById']('npc-name-input'),_0x5a4ecf=document[_0x49dc44(0x948)](_0x49dc44(0x56b)),_0x1f1836=document[_0x49dc44(0x948)](_0x49dc44(0xa2a)),_0x574ab6=document[_0x49dc44(0x948)](_0x49dc44(0xc00)),_0x7e6ffe=document[_0x49dc44(0x948)](_0x49dc44(0x260)),_0x49d5ec=document[_0x49dc44(0x948)](_0x49dc44(0x36f)),_0x332087=document['getElementById'](_0x49dc44(0xa81));_0x574ab6['innerHTML']='',_0x7e6ffe[_0x49dc44(0xb6f)]=_0x49dc44(0x14aa);const _0x169044=await _0x6ed281['npcGroups'][_0x49dc44(0x443)]();_0x169044[_0x49dc44(0x427)](_0x49c768=>{const _0x27a13b=_0x49dc44,_0x5f22d7=document[_0x27a13b(0x1497)](_0x27a13b(0x152c));_0x5f22d7['value']=_0x49c768['id'],_0x5f22d7[_0x27a13b(0x10cb)]=_0x49c768[_0x27a13b(0x1467)],_0x7e6ffe[_0x27a13b(0x6b6)](_0x5f22d7);}),_0x574ab6['innerHTML']+='<label><input\x20type=\x22checkbox\x22\x20value=\x22user\x22>\x20'+(_0x16699d[_0x49dc44(0x66e)]['nickname']||'我')+_0x49dc44(0x590),Object[_0x49dc44(0x1166)](_0x16699d['chats'])[_0x49dc44(0x1c0)](_0x203888=>!_0x203888[_0x49dc44(0x1173)])[_0x49dc44(0x427)](_0x436912=>{const _0x4f5372=_0x49dc44;_0x574ab6[_0x4f5372(0xb6f)]+=_0x4f5372(0x499)+_0x436912['id']+'\x22>\x20'+_0x436912[_0x4f5372(0x1467)]+_0x4f5372(0x2b9);});if(_0x3d233c){_0x12caf2[_0x49dc44(0x10cb)]=_0x49dc44(0x2ba);const _0x503ad7=await _0x6ed281[_0x49dc44(0xa59)][_0x49dc44(0xe8c)](_0x3d233c);_0x503ad7&&(_0x444c44['value']=_0x503ad7['name'],_0x5a4ecf['value']=_0x503ad7['persona'],_0x1f1836[_0x49dc44(0x147d)]=_0x503ad7[_0x49dc44(0x63e)]||_0x3ca5ef,_0x49d5ec[_0x49dc44(0x210)]=_0x503ad7[_0x49dc44(0x1028)]!==![],_0x332087[_0x49dc44(0x5bc)]=_0x503ad7[_0x49dc44(0x63a)]||0xf,_0x7e6ffe[_0x49dc44(0x5bc)]=_0x503ad7['npcGroupId']||'',_0x503ad7[_0x49dc44(0x111e)]&&Array['isArray'](_0x503ad7[_0x49dc44(0x111e)])&&_0x503ad7[_0x49dc44(0x111e)]['forEach'](_0x5b8dbc=>{const _0xa83bcf=_0x49dc44,_0x2dadf5=_0x574ab6[_0xa83bcf(0xfeb)](_0xa83bcf(0x10f1)+_0x5b8dbc+'\x22]');if(_0x2dadf5)_0x2dadf5[_0xa83bcf(0x210)]=!![];}));}else{_0x12caf2[_0x49dc44(0x10cb)]='添加\x20NPC',_0x444c44['value']='',_0x5a4ecf[_0x49dc44(0x5bc)]='',_0x1f1836['src']=_0x3ca5ef,_0x49d5ec[_0x49dc44(0x210)]=!![],_0x332087[_0x49dc44(0x5bc)]=0xf,_0x7e6ffe['value']='';const _0x1eef10=_0x574ab6['querySelector'](_0x49dc44(0x691));if(_0x1eef10)_0x1eef10[_0x49dc44(0x210)]=!![];}_0x387a10[_0x49dc44(0xd54)]['add'](_0x49dc44(0xfcb));}async function _0xdbc49f(){const _0x19575a=_0x3ce1fb,_0x3e9921=document[_0x19575a(0x948)](_0x19575a(0x2d8))[_0x19575a(0x5bc)]['trim'](),_0x2b4c45=document[_0x19575a(0x948)](_0x19575a(0x56b))['value'][_0x19575a(0x2a8)]();if(!_0x3e9921||!_0x2b4c45){alert(_0x19575a(0x642));return;}const _0x17e936=Array[_0x19575a(0x6e5)](document[_0x19575a(0x1188)](_0x19575a(0x157d)))[_0x19575a(0x8ff)](_0x33c3d8=>_0x33c3d8['value']),_0x34b32e=document[_0x19575a(0x948)](_0x19575a(0x36f))['checked'],_0x21bf7f=parseInt(document[_0x19575a(0x948)](_0x19575a(0xa81))[_0x19575a(0x5bc)])||0xf,_0xf42fbc=parseInt(document[_0x19575a(0x948)](_0x19575a(0x260))['value'])||null,_0xa886be={'name':_0x3e9921,'persona':_0x2b4c45,'avatar':document['getElementById'](_0x19575a(0xa2a))['src'],'associatedWith':_0x17e936,'enableBackgroundActivity':_0x34b32e,'actionCooldownMinutes':_0x21bf7f,'npcGroupId':_0xf42fbc};if(editingNpcId)await _0x6ed281[_0x19575a(0xa59)][_0x19575a(0xa0b)](editingNpcId,_0xa886be);else{const _0x55ae7b=await _0x6ed281['npcs'][_0x19575a(0xbd0)](_0xa886be);if(_0x2e273c&&_0x16699d[_0x19575a(0xf5a)]){const _0x3f1c68=_0x16699d['chats'][_0x16699d[_0x19575a(0xf5a)]];_0x3f1c68[_0x19575a(0x1173)]&&(_0x3f1c68['members']['push']({'id':'npc_'+_0x55ae7b,'originalName':_0x3e9921,'groupNickname':_0x3e9921,'persona':_0x2b4c45,'avatar':_0xa886be['avatar'],'isNpc':!![]}),await _0x6ed281[_0x19575a(0x1474)][_0x19575a(0x90c)](_0x3f1c68));}}document[_0x19575a(0x948)]('npc-editor-modal')[_0x19575a(0xd54)]['remove']('visible'),_0x2e273c?(_0x2e273c=![],_0x37bf66()):await _0x1ea6a0();}async function _0x410e84(){const _0xeed8b5=_0x3ce1fb;await _0x9a947a(),document['getElementById']('npc-group-manager-modal')[_0xeed8b5(0xd54)][_0xeed8b5(0xbd0)](_0xeed8b5(0xfcb));}async function _0x9a947a(){const _0x1b99e0=_0x3ce1fb,_0xe60d4e=document[_0x1b99e0(0x948)](_0x1b99e0(0x697)),_0x333a6e=await _0x6ed281[_0x1b99e0(0x105e)][_0x1b99e0(0x443)]();_0xe60d4e['innerHTML']='',_0x333a6e[_0x1b99e0(0xaf9)]===0x0&&(_0xe60d4e[_0x1b99e0(0xb6f)]=_0x1b99e0(0x1395)),_0x333a6e[_0x1b99e0(0x427)](_0xa0794c=>{const _0x2532ee=_0x1b99e0,_0x2cae65=document[_0x2532ee(0x1497)](_0x2532ee(0x379));_0x2cae65[_0x2532ee(0x35b)]=_0x2532ee(0x1271),_0x2cae65[_0x2532ee(0xb6f)]=_0x2532ee(0x6a0)+_0xa0794c['name']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0xa0794c['id']+_0x2532ee(0xcaf),_0xe60d4e[_0x2532ee(0x6b6)](_0x2cae65);});}async function _0x20f941(){const _0x787d80=_0x3ce1fb,_0x4da4c9=document[_0x787d80(0x948)](_0x787d80(0x13ca)),_0x49dd21=_0x4da4c9[_0x787d80(0x5bc)][_0x787d80(0x2a8)]();if(!_0x49dd21){alert(_0x787d80(0xd7d));return;}const _0x3bddd3=await _0x6ed281['npcGroups'][_0x787d80(0x1117)](_0x787d80(0x1467))[_0x787d80(0xba9)](_0x49dd21)['first']();if(_0x3bddd3){alert(_0x787d80(0x15c0)+_0x49dd21+'\x22\x20已经存在了！');return;}await _0x6ed281[_0x787d80(0x105e)][_0x787d80(0xbd0)]({'name':_0x49dd21}),_0x4da4c9[_0x787d80(0x5bc)]='',await _0x9a947a();}async function _0x5ada21(_0x4c3a6e){const _0x9acea3=_0x3ce1fb,_0x3ec41e=await _0xa6b74a(_0x9acea3(0x8ed),'删除分组后，该组内的所有NPC将变为“未分组”。确定要删除吗？',{'confirmButtonClass':_0x9acea3(0x5e8)});_0x3ec41e&&(await _0x6ed281[_0x9acea3(0x105e)][_0x9acea3(0x869)](_0x4c3a6e),await _0x6ed281['npcs'][_0x9acea3(0x1117)]('npcGroupId')[_0x9acea3(0xba9)](_0x4c3a6e)[_0x9acea3(0x11b6)]({'npcGroupId':null}),await _0x9a947a());}async function _0x5e5fe9(_0x294e5f){const _0x5736d8=_0x3ce1fb,_0x58d1d1=await _0x6ed281[_0x5736d8(0xa59)]['get'](_0x294e5f);if(!_0x58d1d1)return;const _0x296521=await _0xa6b74a(_0x5736d8(0x476),_0x5736d8(0x549)+_0x58d1d1[_0x5736d8(0x1467)]+'”\x20吗？',{'confirmButtonClass':_0x5736d8(0x5e8)});_0x296521&&(await _0x6ed281['npcs'][_0x5736d8(0x869)](_0x294e5f),await _0x1ea6a0());}let _0x2555d5=0x0;function _0x2e45ad(_0x42526b){const _0x17d6fa=_0x3ce1fb,_0x2e031a=document[_0x17d6fa(0x1497)]('div');return _0x2e031a[_0x17d6fa(0x35b)]=_0x17d6fa(0x4b3),_0x2e031a['innerHTML']=_0x17d6fa(0x514)+_0x42526b[_0x17d6fa(0x1467)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20',_0x2e031a;}function _0x2204e1(_0x31b256){const _0x3bc024=_0x3ce1fb,_0x46e78e=document[_0x3bc024(0x948)](_0x3bc024(0xab3)),_0x29d6a0=document[_0x3bc024(0x948)]('load-more-chats-btn');if(_0x29d6a0)_0x29d6a0[_0x3bc024(0xf89)]();const _0x3b156d=_0x2555d5,_0x44a4b5=_0x2555d5+CHAT_LIST_RENDER_WINDOW,_0x237974=_0x31b256[_0x3bc024(0x200)](_0x3b156d,_0x44a4b5),_0x52246d=document[_0x3bc024(0x7d4)]();let _0x4a0cdf=_0x46e78e['querySelector'](_0x3bc024(0x8eb));_0x237974[_0x3bc024(0x427)](_0x56c428=>{const _0x1cc754=_0x3bc024;if(_0x56c428[_0x1cc754(0x4ae)]===_0x1cc754(0x1383)){const _0x3f825f=_0x2e45ad(_0x56c428[_0x1cc754(0x1403)]);_0x52246d[_0x1cc754(0x6b6)](_0x3f825f),_0x4a0cdf=_0x3f825f[_0x1cc754(0xfeb)](_0x1cc754(0x1449));}else{if(_0x56c428[_0x1cc754(0x4ae)]===_0x1cc754(0x2c6)){const _0x4ad378=_0x1704d0(_0x56c428['chat']);_0x4a0cdf&&_0x56c428['chat']['groupId']?_0x4a0cdf[_0x1cc754(0x6b6)](_0x4ad378):(_0x52246d[_0x1cc754(0x6b6)](_0x4ad378),_0x4a0cdf=null);}}}),_0x46e78e[_0x3bc024(0x6b6)](_0x52246d),_0x2555d5+=_0x237974[_0x3bc024(0xaf9)],_0x31b256[_0x3bc024(0xaf9)]>_0x2555d5&&_0xbc9971(_0x46e78e,_0x31b256),document[_0x3bc024(0x1188)](_0x3bc024(0xeaa))[_0x3bc024(0x427)](_0x58d767=>{const _0x1370e6=_0x3bc024,_0x162e94=_0x58d767[_0x1370e6(0xfc0)](!![]);_0x58d767[_0x1370e6(0x1579)]['replaceChild'](_0x162e94,_0x58d767),_0x162e94[_0x1370e6(0x339)](_0x1370e6(0x4f6),()=>{const _0x48fcb4=_0x1370e6;_0x162e94['classList']['toggle']('collapsed'),_0x162e94[_0x48fcb4(0x7fb)]['classList'][_0x48fcb4(0x69d)](_0x48fcb4(0x946));});});}async function _0x2d33eb(){const _0x125304=_0x3ce1fb,_0x4a317f=document[_0x125304(0x948)](_0x125304(0xab3));_0x4a317f[_0x125304(0xb6f)]='';const _0x434c88=Object[_0x125304(0x1166)](_0x16699d[_0x125304(0x1474)])[_0x125304(0xe96)]((_0x4ee2a5,_0x227e35)=>{const _0x36146e=_0x125304,_0xd62078=(_0x227e35['isPinned']||![])-(_0x4ee2a5[_0x36146e(0x13a9)]||![]);if(_0xd62078!==0x0)return _0xd62078;return(_0x227e35[_0x36146e(0xb07)][_0x36146e(0x200)](-0x1)[0x0]?.[_0x36146e(0xb0a)]||0x0)-(_0x4ee2a5[_0x36146e(0xb07)][_0x36146e(0x200)](-0x1)[0x0]?.[_0x36146e(0xb0a)]||0x0);}),_0x3b13a2=await _0x6ed281[_0x125304(0x1423)][_0x125304(0x443)]();if(_0x434c88[_0x125304(0xaf9)]===0x0){_0x4a317f[_0x125304(0xb6f)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20或群组图标添加聊天</p>';return;}_0x3b13a2[_0x125304(0x427)](_0x46edd0=>{const _0x4e84de=_0x125304,_0x5dcc91=_0x434c88['find'](_0x5d669c=>_0x5d669c[_0x4e84de(0xaa9)]===_0x46edd0['id']);_0x46edd0['latestTimestamp']=_0x5dcc91?_0x5dcc91['history'][_0x4e84de(0x200)](-0x1)[0x0]?.[_0x4e84de(0xb0a)]||0x0:0x0;}),_0x3b13a2[_0x125304(0xe96)]((_0x59c54d,_0x3bad60)=>_0x3bad60[_0x125304(0x42b)]-_0x59c54d[_0x125304(0x42b)]),_0x5ba26c=[];const _0x25f1ff=new Set();_0x434c88[_0x125304(0x427)](_0x4a8a00=>{const _0x3e91e4=_0x125304;_0x4a8a00['isPinned']&&(_0x5ba26c['push']({'type':'chatItem','chat':_0x4a8a00}),_0x25f1ff[_0x3e91e4(0xbd0)](_0x4a8a00['id']));}),_0x3b13a2[_0x125304(0x427)](_0x5e02e6=>{const _0xa9bfe9=_0x125304,_0x5392eb=_0x434c88[_0xa9bfe9(0x1c0)](_0x40e5ab=>!_0x40e5ab['isPinned']&&!_0x40e5ab['isGroup']&&_0x40e5ab[_0xa9bfe9(0xaa9)]===_0x5e02e6['id']);_0x5392eb['length']>0x0&&(_0x5ba26c['push']({'type':_0xa9bfe9(0x1383),'group':_0x5e02e6}),_0x5392eb[_0xa9bfe9(0x427)](_0x5ea0a8=>{const _0x552eff=_0xa9bfe9;_0x5ba26c['push']({'type':_0x552eff(0x2c6),'chat':_0x5ea0a8}),_0x25f1ff['add'](_0x5ea0a8['id']);}));}),_0x434c88[_0x125304(0x427)](_0x2ab595=>{const _0x4066fb=_0x125304;!_0x25f1ff[_0x4066fb(0xda1)](_0x2ab595['id'])&&(_0x5ba26c[_0x4066fb(0x1001)]({'type':_0x4066fb(0x2c6),'chat':_0x2ab595}),_0x25f1ff[_0x4066fb(0xbd0)](_0x2ab595['id']));}),_0x2555d5=0x0,_0x2204e1();}function _0x2e45ad(_0x258bf0){const _0x505901=_0x3ce1fb,_0xb92abe=document[_0x505901(0x1497)](_0x505901(0x379));return _0xb92abe[_0x505901(0x35b)]=_0x505901(0x4b3),_0xb92abe['innerHTML']=_0x505901(0xcea)+_0x258bf0['name']+_0x505901(0x1430),_0xb92abe;}function _0xbc9971(_0x253bc3,_0x32271b){const _0x123055=_0x3ce1fb,_0x5da9f1=document[_0x123055(0x1497)]('button');_0x5da9f1['id']=_0x123055(0xbe5),_0x5da9f1[_0x123055(0x10cb)]=_0x123055(0x15c8),_0x5da9f1['className']=_0x123055(0x1342),_0x5da9f1[_0x123055(0x339)]('click',()=>_0x2204e1(_0x32271b),{'once':!![]}),_0x253bc3[_0x123055(0x10e0)](_0x5da9f1);}function _0x2204e1(){const _0xbddbae=_0x3ce1fb;if(_0x34c5ec)return;const _0x225b57=document[_0xbddbae(0x948)](_0xbddbae(0xab3)),_0x1d2979=document[_0xbddbae(0x948)](_0xbddbae(0x14d7));if(!_0x225b57||!_0x1d2979)return;if(_0x2555d5>=_0x5ba26c[_0xbddbae(0xaf9)])return;_0x34c5ec=!![];const _0x282e52=_0x2555d5===0x0,_0x13e61b=()=>{const _0x4dd913=_0xbddbae;_0x3c826e(_0x225b57);const _0x47a590=_0x16699d[_0x4dd913(0xf9c)][_0x4dd913(0xa58)]||0x1e,_0x263df2=_0x2555d5,_0x578f80=_0x2555d5+_0x47a590,_0x40605f=_0x5ba26c[_0x4dd913(0x200)](_0x263df2,_0x578f80),_0x41dab9=document['createDocumentFragment']();let _0x39e0a9=_0x225b57['querySelector'](_0x4dd913(0x8eb));_0x40605f[_0x4dd913(0x427)](_0x26e1a6=>{const _0x8492a1=_0x4dd913;if(_0x26e1a6[_0x8492a1(0x4ae)]===_0x8492a1(0x1383)){const _0x186ed6=_0x2e45ad(_0x26e1a6[_0x8492a1(0x1403)]);_0x41dab9['appendChild'](_0x186ed6),_0x39e0a9=_0x186ed6[_0x8492a1(0xfeb)](_0x8492a1(0x1449));}else{if(_0x26e1a6[_0x8492a1(0x4ae)]===_0x8492a1(0x2c6)){const _0x200589=_0x1704d0(_0x26e1a6[_0x8492a1(0xdd2)]);if(_0x26e1a6[_0x8492a1(0xdd2)][_0x8492a1(0xaa9)]&&_0x39e0a9)_0x39e0a9[_0x8492a1(0x6b6)](_0x200589);else{_0x41dab9[_0x8492a1(0x6b6)](_0x200589);if(!_0x26e1a6[_0x8492a1(0xdd2)]['groupId'])_0x39e0a9=null;}}}}),_0x225b57[_0x4dd913(0x6b6)](_0x41dab9),_0x2555d5+=_0x40605f['length'],_0x225b57[_0x4dd913(0x1188)](_0x4dd913(0x10e3))[_0x4dd913(0x427)](_0x441a86=>{const _0x467c0a=_0x4dd913;_0x441a86[_0x467c0a(0x606)]['hasListener']=_0x467c0a(0xefd),_0x441a86[_0x467c0a(0x339)](_0x467c0a(0x4f6),()=>{const _0x537636=_0x467c0a;_0x441a86['classList'][_0x537636(0x69d)]('collapsed'),_0x441a86['nextElementSibling'][_0x537636(0xd54)][_0x537636(0x69d)]('collapsed');});}),_0x34c5ec=![],_0x1d2979['scrollHeight']<=_0x1d2979[_0x4dd913(0xcdc)]&&_0x2555d5<_0x5ba26c[_0x4dd913(0xaf9)]&&_0x2204e1();};_0x282e52?_0x13e61b():(_0x2176e3(_0x225b57,'bottom'),setTimeout(_0x13e61b,0x1f4));}function _0x1704d0(_0x247729){const _0x41b75a=_0x3ce1fb;try{const _0x38d4e1=_0x247729['history'][_0x41b75a(0x1c0)](_0x19c215=>!_0x19c215[_0x41b75a(0x583)])[_0x41b75a(0x200)](-0x1)[0x0]||{};let _0x1b8192;if(!_0x247729[_0x41b75a(0x1173)]&&_0x247729[_0x41b75a(0x1120)]?.[_0x41b75a(0x82c)]==='pending_user_approval')_0x1b8192=_0x41b75a(0x729)+(_0x247729[_0x41b75a(0x1120)]['applicationReason']||'请求添加你为好友')+'</span>';else{if(!_0x247729[_0x41b75a(0x1173)]&&_0x247729[_0x41b75a(0x1120)]?.[_0x41b75a(0x82c)]===_0x41b75a(0x154f))_0x1b8192=_0x41b75a(0xd58);else{if(_0x247729[_0x41b75a(0x1173)]){if(_0x38d4e1['type']==='pat_message')_0x1b8192=_0x41b75a(0x3b9)+_0x38d4e1['content'];else{if(_0x38d4e1[_0x41b75a(0x4ae)]===_0x41b75a(0x1514))_0x1b8192=_0x41b75a(0xc36);else{if(_0x38d4e1[_0x41b75a(0x4ae)]===_0x41b75a(0x1281)||_0x38d4e1[_0x41b75a(0x4ae)]===_0x41b75a(0x368))_0x1b8192=_0x41b75a(0xfd0);else{if(_0x38d4e1[_0x41b75a(0x4ae)]==='voice_message')_0x1b8192=_0x41b75a(0x445);else{if(typeof _0x38d4e1[_0x41b75a(0xede)]===_0x41b75a(0x273)&&_0x346c[_0x41b75a(0x367)](_0x38d4e1[_0x41b75a(0xede)]))_0x1b8192=_0x38d4e1['meaning']?'[表情:\x20'+_0x38d4e1[_0x41b75a(0x14f1)]+']':_0x41b75a(0x7eb);else Array[_0x41b75a(0x1524)](_0x38d4e1[_0x41b75a(0xede)])?_0x1b8192=_0x41b75a(0x1115):_0x1b8192=String(_0x38d4e1['content']||_0x41b75a(0x76d))['substring'](0x0,0x14);}}}}if(_0x38d4e1['senderName']&&_0x38d4e1[_0x41b75a(0x4ae)]!=='pat_message'){const _0x195f80=_0x589066(_0x247729,_0x38d4e1[_0x41b75a(0x14ee)]);_0x1b8192=_0x195f80+':\x20'+_0x1b8192;}}else{const _0x290b39=_0x247729[_0x41b75a(0x82c)]?.['text']||'在线';_0x1b8192='['+_0x290b39+']';}}}const _0x20559d=document[_0x41b75a(0x1497)](_0x41b75a(0x379));_0x20559d['className']=_0x41b75a(0x1322),_0x20559d[_0x41b75a(0x606)][_0x41b75a(0x1029)]=_0x247729['id'];_0x247729[_0x41b75a(0x13a9)]&&_0x20559d[_0x41b75a(0xd54)][_0x41b75a(0xbd0)]('pinned');const _0x42cfce=_0x247729['isGroup']?_0x247729[_0x41b75a(0x7fd)][_0x41b75a(0x1e7)]:_0x247729['settings'][_0x41b75a(0x156d)],_0x37a0f4=_0x247729[_0x41b75a(0x1173)]?'':_0x247729['settings'][_0x41b75a(0x3b7)]||'';let _0x450795;_0x37a0f4?_0x450795=_0x41b75a(0x149f)+(_0x42cfce||_0x202ba5)+'\x22\x20class=\x22avatar-img\x22><img\x20src=\x22'+_0x37a0f4+_0x41b75a(0xbe3):_0x450795=_0x41b75a(0x4ad)+(_0x42cfce||_0x202ba5)+_0x41b75a(0x9d6);const _0x43e94c=_0x37a0f4?_0x41b75a(0xa4f):'',_0x51e264=_0x41b75a(0x47e)+_0x43e94c+'\x22>'+_0x450795+'</div>';_0x20559d[_0x41b75a(0xb6f)]=_0x41b75a(0xd79)+_0x51e264+_0x41b75a(0x1145)+_0x247729[_0x41b75a(0x1467)]+_0x41b75a(0xa63)+(_0x247729['isGroup']?_0x41b75a(0xe98):'')+_0x41b75a(0x7b0)+(_0x247729['isGroup']?'var(--text-secondary)':_0x41b75a(0x1356))+_0x41b75a(0xb40)+_0x1b8192+_0x41b75a(0x11ad);const _0x76eacb=_0x247729[_0x41b75a(0x1300)]||0x0,_0x10f2c6=_0x20559d['querySelector'](_0x41b75a(0x93f));_0x76eacb>0x0?(_0x10f2c6[_0x41b75a(0x10cb)]=_0x76eacb>0x63?_0x41b75a(0x158d):_0x76eacb,_0x10f2c6['style'][_0x41b75a(0x11fd)]='inline-flex'):_0x10f2c6[_0x41b75a(0xf74)][_0x41b75a(0x11fd)]=_0x41b75a(0x12fe);const _0x32ae6c=_0x20559d[_0x41b75a(0xfeb)](_0x41b75a(0x7f4));_0x32ae6c&&(_0x32ae6c[_0x41b75a(0xf74)]['cursor']=_0x41b75a(0xc5f),_0x32ae6c[_0x41b75a(0x339)](_0x41b75a(0x4da),_0x35ae64=>{const _0x198162=_0x41b75a;_0x35ae64[_0x198162(0x221)]();const _0x1956d1=_0x247729[_0x198162(0x1173)]?_0x247729[_0x198162(0x1467)]:_0x247729[_0x198162(0x628)];_0x528d61(_0x247729['id'],_0x1956d1);}));const _0x5e6c76=_0x20559d[_0x41b75a(0xfeb)](_0x41b75a(0x64c));return _0x5e6c76&&_0x5e6c76[_0x41b75a(0x339)](_0x41b75a(0x4f6),()=>_0x5b2fb4(_0x247729['id'])),_0x159366(_0x20559d,async _0x145231=>{const _0x133418=_0x41b75a,_0x3ea0d2=await _0x5deb9f(_0x247729);switch(_0x3ea0d2){case _0x133418(0xa52):_0x247729[_0x133418(0x13a9)]=!_0x247729[_0x133418(0x13a9)],await _0x6ed281['chats'][_0x133418(0x90c)](_0x247729),_0x2d33eb();break;case _0x133418(0x869):const _0x5a110f=await _0xa6b74a(_0x133418(0x12b7),_0x133418(0xfe2)+_0x247729[_0x133418(0x1467)]+_0x133418(0x9b1),{'confirmButtonClass':_0x133418(0x5e8)});if(_0x5a110f){_0x49c6c5['isActive']&&_0x49c6c5[_0x133418(0xf5a)]===_0x247729['id']&&await _0x528b67(![]);delete _0x16699d[_0x133418(0x1474)][_0x247729['id']];if(_0x16699d[_0x133418(0xf5a)]===_0x247729['id'])_0x16699d['activeChatId']=null;await _0x6ed281[_0x133418(0x1474)]['delete'](_0x247729['id']),_0x2d33eb();}break;default:break;}}),_0x20559d;}catch(_0x5ac121){return console[_0x41b75a(0xc3e)]('渲染聊天项\x20['+(_0x247729[_0x41b75a(0x1467)]||'未知')+_0x41b75a(0xcc1)+_0x247729['id']+_0x41b75a(0xd19),_0x5ac121),null;}}async function _0x455873(_0x5bc516){const _0x511c09=_0x3ce1fb;_0x20a8bd(),_0x5f5407();const _0x581523=_0x16699d[_0x511c09(0x1474)][_0x5bc516];if(!_0x581523)return;_0x402014();const _0x5728af=document[_0x511c09(0x948)]('chat-messages'),_0x11c3e3=document[_0x511c09(0x948)]('chat-input-area'),_0x14c657=document['getElementById']('chat-lock-overlay'),_0x1b3bf9=document[_0x511c09(0x948)](_0x511c09(0x13c1));_0x5728af[_0x511c09(0x606)][_0x511c09(0x337)]=_0x581523[_0x511c09(0x7fd)][_0x511c09(0x337)]||'default';const _0x3b14f6=_0x581523['settings']['fontSize']||0xd;_0x5728af['style']['setProperty'](_0x511c09(0xc64),_0x3b14f6+'px'),_0x33b8de(_0x581523[_0x511c09(0x7fd)][_0x511c09(0x132b)]||'',_0x511c09(0xb8c),_0x511c09(0x12f0)),document[_0x511c09(0x948)](_0x511c09(0x1069))[_0x511c09(0x10cb)]=_0x581523[_0x511c09(0x1467)];const _0x3b027b=document[_0x511c09(0x948)](_0x511c09(0x2cd)),_0x4b7275=_0x3b027b['querySelector']('.status-text');_0x581523[_0x511c09(0x1173)]?(_0x3b027b[_0x511c09(0xf74)]['display']=_0x511c09(0x12fe),document['getElementById'](_0x511c09(0x1408))['style'][_0x511c09(0xa20)]='center'):(_0x3b027b[_0x511c09(0xf74)]['display']=_0x511c09(0x6a4),document[_0x511c09(0x948)]('chat-header-title-wrapper')['style'][_0x511c09(0xa20)]='flex-start',_0x4b7275['textContent']=_0x581523['status']?.[_0x511c09(0x9ea)]||'在线',_0x3b027b[_0x511c09(0xd54)]['toggle'](_0x511c09(0x3bd),_0x581523[_0x511c09(0x82c)]?.['isBusy']||![]));const _0x12a666=document[_0x511c09(0x948)](_0x511c09(0x152e)),_0x1cf29b=_0x581523[_0x511c09(0x7fd)][_0x511c09(0x7c2)],_0x97245f=_0x16699d['globalSettings']['globalChatBackground'],_0x13a392=document[_0x511c09(0x948)](_0x511c09(0xecd))[_0x511c09(0xd54)][_0x511c09(0x7a0)](_0x511c09(0x8ab)),_0x32d821=_0x13a392?_0x511c09(0x38e):_0x511c09(0xe1a);if(_0x1cf29b)_0x12a666[_0x511c09(0xf74)][_0x511c09(0x618)]=_0x511c09(0x4f1)+_0x1cf29b+')',_0x12a666[_0x511c09(0xf74)][_0x511c09(0xdb4)]=_0x511c09(0x5e2);else _0x97245f?(_0x12a666['style'][_0x511c09(0x618)]=_0x511c09(0x4f1)+_0x97245f+')',_0x12a666[_0x511c09(0xf74)][_0x511c09(0xdb4)]=_0x511c09(0x5e2)):(_0x12a666[_0x511c09(0xf74)][_0x511c09(0x618)]=_0x511c09(0x12fe),_0x12a666[_0x511c09(0xf74)][_0x511c09(0xdb4)]=_0x32d821);if(_0x581523[_0x511c09(0xb3e)])_0x11c3e3['style'][_0x511c09(0x11fd)]='none',_0x14c657[_0x511c09(0xf74)][_0x511c09(0x11fd)]=_0x511c09(0x6a4),_0x1b3bf9[_0x511c09(0xb6f)]=_0x511c09(0x409),document['getElementById'](_0x511c09(0x59e))[_0x511c09(0xe8d)]=_0x1219ab;else{_0x11c3e3[_0x511c09(0xf74)][_0x511c09(0x11fd)]=_0x511c09(0x6a4),_0x14c657['style'][_0x511c09(0x11fd)]=_0x511c09(0x12fe),_0x1b3bf9['innerHTML']='';if(!_0x581523[_0x511c09(0x1173)]&&_0x581523[_0x511c09(0x1120)][_0x511c09(0x82c)]!==_0x511c09(0x1431)){_0x14c657[_0x511c09(0xf74)][_0x511c09(0x11fd)]=_0x511c09(0x6a4),_0x11c3e3[_0x511c09(0xf74)][_0x511c09(0x692)]=_0x511c09(0xce8);let _0x2f1f0f='';switch(_0x581523[_0x511c09(0x1120)]['status']){case _0x511c09(0x1572):const _0x230be7=_0x47dadd!==null,_0x335e78=_0x581523[_0x511c09(0x1120)][_0x511c09(0xbab)],_0x5ea109=_0x16699d['globalSettings'][_0x511c09(0x4b1)]||0x1,_0x36e68e=_0x5ea109*0x3c*0x3c*0x3e8,_0x4308fc=Date[_0x511c09(0x1386)]()-_0x335e78,_0x1e0bfb=_0x4308fc>_0x36e68e,_0x31d245=Math[_0x511c09(0x604)](0x0,Math[_0x511c09(0x1112)]((_0x36e68e-_0x4308fc)/(0x3e8*0x3c)));_0x2f1f0f='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你已将“'+_0x581523['name']+_0x511c09(0x1447)+(_0x16699d[_0x511c09(0xf9c)][_0x511c09(0x1028)]?_0x511c09(0xdb5):'<span\x20style=\x22color:\x20red;\x22>已关闭</span>')+_0x511c09(0x214)+(_0x230be7?_0x511c09(0xf95):'<span\x20style=\x22color:\x20red;\x22>未运行</span>')+_0x511c09(0xece)+_0x581523[_0x511c09(0x1120)][_0x511c09(0x82c)]+'</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20需要冷静(小时):\x20<strong>'+_0x5ea109+_0x511c09(0xe4b)+(_0x1e0bfb?_0x511c09(0xa37):_0x511c09(0x1015)+_0x31d245+_0x511c09(0x2d4))+_0x511c09(0x14dd)+(_0x1e0bfb&&_0x16699d['globalSettings'][_0x511c09(0x1028)]?'<span\x20style=\x22color:\x20green;\x22>已满足，等待下次系统心跳</span>':_0x511c09(0x6d0))+_0x511c09(0xe55);break;case _0x511c09(0x154f):_0x2f1f0f='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你被对方拉黑了。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22apply-friend-btn\x22\x20class=\x22lock-action-btn\x22>重新申请加为好友</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';break;case'pending_user_approval':_0x2f1f0f=_0x511c09(0x1014)+_0x581523['name']+_0x511c09(0x356)+_0x581523[_0x511c09(0x1120)][_0x511c09(0x60f)]+_0x511c09(0x1433);break;case _0x511c09(0x21b):_0x2f1f0f=_0x511c09(0xa49);break;}_0x1b3bf9[_0x511c09(0xb6f)]=_0x2f1f0f;}else _0x14c657['style'][_0x511c09(0x11fd)]=_0x511c09(0x12fe),_0x11c3e3['style']['visibility']=_0x511c09(0xfcb);}_0x5728af[_0x511c09(0xb6f)]='';const _0x4d1485=_0x581523[_0x511c09(0xb07)];_0xf1800c=0x0;const _0x383b9d=_0x16699d[_0x511c09(0xf9c)][_0x511c09(0x59a)]||0x32,_0x346efb=_0x4d1485['slice'](-_0x383b9d),_0x1d9fa7=[];let _0x32270d=0x0;for(const _0x448ab7 of _0x346efb){_0x32270d>0x0&&_0x448ab7['timestamp']-_0x32270d>0x927c0&&_0x1d9fa7[_0x511c09(0x1001)](Promise[_0x511c09(0x451)](_0x3f126b(_0x448ab7[_0x511c09(0xb0a)]))),_0x1d9fa7[_0x511c09(0x1001)](_0x1f8f7b(_0x448ab7,_0x581523,!![])),_0x32270d=_0x448ab7['timestamp'];}const _0xdb65fd=await Promise[_0x511c09(0xd49)](_0x1d9fa7),_0xc63b34=document[_0x511c09(0x7d4)]();_0xdb65fd[_0x511c09(0x1c0)](Boolean)['forEach'](_0xc399af=>_0xc63b34[_0x511c09(0x6b6)](_0xc399af)),_0x5728af[_0x511c09(0x6b6)](_0xc63b34),_0xf1800c=_0x346efb[_0x511c09(0xaf9)];const _0x58ac0b=document['createElement'](_0x511c09(0x379));_0x58ac0b['id']='typing-indicator',_0x58ac0b[_0x511c09(0xf74)]['display']=_0x511c09(0x12fe),_0x58ac0b[_0x511c09(0x10cb)]=_0x511c09(0x1131),_0x5728af[_0x511c09(0x6b6)](_0x58ac0b),setTimeout(()=>_0x5728af[_0x511c09(0xced)]=_0x5728af[_0x511c09(0x971)],0x0);}async function _0xb02fa8(){const _0x29afa1=_0x3ce1fb;if(_0x3accf1)return;_0x3accf1=!![];const _0x2e56e3=document[_0x29afa1(0x948)](_0x29afa1(0x91c)),_0xb3b3be=_0x16699d[_0x29afa1(0x1474)][_0x16699d[_0x29afa1(0xf5a)]];if(!_0xb3b3be){_0x3accf1=![];return;}_0x2176e3(_0x2e56e3,_0x29afa1(0x102e));const _0x363edd=_0x2e56e3[_0x29afa1(0x971)];await new Promise(_0x4dc46d=>setTimeout(_0x4dc46d,0x1f4));const _0x59ecc2=_0xb3b3be[_0x29afa1(0xb07)][_0x29afa1(0xaf9)],_0x61d752=_0x16699d[_0x29afa1(0xf9c)][_0x29afa1(0x59a)]||0x32,_0x28b207=_0x59ecc2-_0xf1800c-_0x61d752,_0x2c094c=_0x59ecc2-_0xf1800c,_0x26b4c2=_0xb3b3be['history'][_0x29afa1(0x200)](Math['max'](0x0,_0x28b207),_0x2c094c),_0x2ddd1d=_0x2e56e3[_0x29afa1(0xfeb)](_0x29afa1(0x41c));let _0xc876c4=_0x2ddd1d?parseInt(_0x2ddd1d[_0x29afa1(0x606)][_0x29afa1(0xb0a)]):0x0;for(const _0x5a60b6 of _0x26b4c2[_0x29afa1(0xb26)]()){if(_0xc876c4>0x0&&_0xc876c4-_0x5a60b6['timestamp']>0x927c0){const _0x1bcc4f=_0x3f126b(_0xc876c4);_0x2e56e3['prepend'](_0x1bcc4f);}await _0x2e97fb(_0x5a60b6,_0xb3b3be),_0xc876c4=_0x5a60b6[_0x29afa1(0xb0a)];}_0xf1800c+=_0x26b4c2[_0x29afa1(0xaf9)];const _0x45e93f=_0x2e56e3['scrollHeight'];_0x2e56e3[_0x29afa1(0xced)]=_0x45e93f-_0x363edd,_0x3c826e(_0x2e56e3),_0x3accf1=![];}function _0xf9cd0e(){const _0x10c776=_0x3ce1fb;_0x1b533a(),_0x336cd2();const _0x466683=document[_0x10c776(0x948)](_0x10c776(0xdad)),_0x182747=_0x16699d['globalSettings']['wallpaper'];_0x182747?(_0x466683['style']['backgroundImage']=_0x10c776(0x4f1)+_0x182747+')',_0x466683['textContent']=''):(_0x466683[_0x10c776(0xf74)][_0x10c776(0x618)]=_0x10c776(0x10dd),_0x466683[_0x10c776(0x10cb)]='当前为渐变色');const _0x1fd218=document['getElementById'](_0x10c776(0x85d)),_0x20e4d7=_0x16699d[_0x10c776(0xf9c)][_0x10c776(0x378)];_0x20e4d7?(_0x1fd218[_0x10c776(0xf74)][_0x10c776(0x618)]=_0x10c776(0x4f1)+_0x20e4d7+')',_0x1fd218[_0x10c776(0x10cb)]=''):(_0x1fd218[_0x10c776(0xf74)][_0x10c776(0x618)]='linear-gradient(135deg,\x20#f6d365,\x20#fda085)',_0x1fd218[_0x10c776(0x10cb)]=_0x10c776(0x84e));const _0x4eef15=document[_0x10c776(0x948)](_0x10c776(0x1384)),_0x1fd510=_0x16699d[_0x10c776(0xf9c)][_0x10c776(0xa76)];_0x1fd510?(_0x4eef15[_0x10c776(0xf74)][_0x10c776(0x618)]=_0x10c776(0x4f1)+_0x1fd510+')',_0x4eef15[_0x10c776(0x10cb)]='',document[_0x10c776(0x948)](_0x10c776(0x112e))[_0x10c776(0xf74)][_0x10c776(0x11fd)]=_0x10c776(0x14e8)):(_0x4eef15['style']['backgroundImage']=_0x10c776(0x12fe),_0x4eef15[_0x10c776(0x10cb)]=_0x10c776(0x5a1),document[_0x10c776(0x948)]('remove-global-bg-btn')[_0x10c776(0xf74)][_0x10c776(0x11fd)]=_0x10c776(0x12fe)),_0x312655(),_0xdb42cd(),document[_0x10c776(0x948)](_0x10c776(0x72d))[_0x10c776(0x5bc)]=_0x16699d[_0x10c776(0xf9c)][_0x10c776(0x12fc)]||'',document[_0x10c776(0x948)]('notification-sound-url-input')['value']=_0x16699d[_0x10c776(0xf9c)][_0x10c776(0x803)]||'',document[_0x10c776(0x948)]('status-bar-toggle-switch')[_0x10c776(0x210)]=_0x16699d[_0x10c776(0xf9c)]['showStatusBar']||![],document[_0x10c776(0x948)]('phone-frame-toggle-switch')[_0x10c776(0x210)]=_0x16699d[_0x10c776(0xf9c)][_0x10c776(0x393)]||![],document[_0x10c776(0x948)]('dynamic-island-music-toggle-switch')[_0x10c776(0x210)]=_0x16699d['globalSettings'][_0x10c776(0x2b7)]||![],document['getElementById']('detach-status-bar-switch')[_0x10c776(0x210)]=_0x16699d['globalSettings'][_0x10c776(0xdeb)]||![],_0x55593c(),_0x53f349();}window[_0x3ce1fb(0x6a2)]=_0xf9cd0e;function _0x364bb1(){const _0x31b6a4=_0x3ce1fb,_0x3bcdca=document[_0x31b6a4(0x948)](_0x31b6a4(0x110d)),_0x374edf=_0x16699d[_0x31b6a4(0xf9c)][_0x31b6a4(0xb91)];_0x374edf?_0x3bcdca['style'][_0x31b6a4(0x618)]=_0x31b6a4(0x4f1)+_0x374edf+')':_0x3bcdca[_0x31b6a4(0xf74)]['backgroundImage']=_0x31b6a4(0x10dd);}function _0x53eceb(_0x36ce73){const _0x1deb93=_0x3ce1fb;document[_0x1deb93(0x1188)](_0x1deb93(0x1275))[_0x1deb93(0x427)](_0x5ebd41=>{const _0x371969=_0x1deb93;_0x5ebd41[_0x371969(0xd54)][_0x371969(0x69d)](_0x371969(0x115e),_0x5ebd41[_0x371969(0x606)][_0x371969(0xd86)]===_0x36ce73);}),document[_0x1deb93(0x1188)](_0x1deb93(0x231))[_0x1deb93(0x427)](_0x1c13e4=>{const _0x3b87b7=_0x1deb93;_0x1c13e4[_0x3b87b7(0xd54)][_0x3b87b7(0x69d)](_0x3b87b7(0x115e),_0x1c13e4[_0x3b87b7(0x606)][_0x3b87b7(0xd86)]===_0x36ce73);});}async function _0x1c33bd(){const _0x55968f=_0x3ce1fb,_0x31ac0f=document['getElementById'](_0x55968f(0x865)),_0x5cf3b2=document[_0x55968f(0x948)](_0x55968f(0xfae));_0x31ac0f[_0x55968f(0xb6f)]='',_0x5cf3b2[_0x55968f(0xb6f)]='';const [_0x15ecfa,_0x53a3b9]=await Promise[_0x55968f(0xd49)]([_0x6ed281[_0x55968f(0x44c)][_0x55968f(0x443)](),_0x6ed281[_0x55968f(0x81c)]['orderBy'](_0x55968f(0x1467))[_0x55968f(0x443)]()]);_0x16699d[_0x55968f(0x44c)]=_0x15ecfa;if(_0x15ecfa['length']===0x0){_0x5cf3b2[_0x55968f(0xb6f)]=_0x55968f(0x3cc);return;}const _0x7d3ed5=document[_0x55968f(0x1497)]('button');_0x7d3ed5[_0x55968f(0x35b)]='world-book-tab\x20active',_0x7d3ed5['textContent']='全部',_0x7d3ed5['dataset'][_0x55968f(0xd86)]=_0x55968f(0xd49),_0x31ac0f[_0x55968f(0x6b6)](_0x7d3ed5);const _0x4f0922=document['createElement'](_0x55968f(0x379));_0x4f0922['className']=_0x55968f(0xc69),_0x4f0922['dataset'][_0x55968f(0xd86)]=_0x55968f(0xd49),_0x5cf3b2['appendChild'](_0x4f0922),_0x53a3b9[_0x55968f(0x427)](_0x5cb634=>{const _0x1816e2=_0x55968f,_0x74f980=document['createElement'](_0x1816e2(0x4e6));_0x74f980[_0x1816e2(0x35b)]='world-book-tab',_0x74f980['textContent']=_0x5cb634['name'],_0x74f980[_0x1816e2(0x606)][_0x1816e2(0xd86)]=String(_0x5cb634['id']),_0x31ac0f['appendChild'](_0x74f980);const _0xcd64e5=document[_0x1816e2(0x1497)](_0x1816e2(0x379));_0xcd64e5[_0x1816e2(0x35b)]=_0x1816e2(0xe4d),_0xcd64e5[_0x1816e2(0x606)][_0x1816e2(0xd86)]=String(_0x5cb634['id']),_0x5cf3b2['appendChild'](_0xcd64e5);});const _0x3a4af7=_0x15ecfa[_0x55968f(0x1502)](_0x3bad75=>!_0x3bad75[_0x55968f(0xd86)]);if(_0x3a4af7){const _0xc9aac4=document[_0x55968f(0x1497)](_0x55968f(0x4e6));_0xc9aac4[_0x55968f(0x35b)]=_0x55968f(0x10e4),_0xc9aac4[_0x55968f(0x10cb)]=_0x55968f(0x14cd),_0xc9aac4[_0x55968f(0x606)][_0x55968f(0xd86)]='uncategorized',_0x31ac0f['appendChild'](_0xc9aac4);const _0x51a95d=document[_0x55968f(0x1497)]('div');_0x51a95d[_0x55968f(0x35b)]=_0x55968f(0xe4d),_0x51a95d[_0x55968f(0x606)][_0x55968f(0xd86)]=_0x55968f(0x149b),_0x5cf3b2['appendChild'](_0x51a95d);}_0x15ecfa['forEach'](_0xc18e25=>{const _0xb5245d=_0x55968f;let _0x433b47=_0xb5245d(0x3c4);if(Array[_0xb5245d(0x1524)](_0xc18e25['content'])&&_0xc18e25['content'][_0xb5245d(0xaf9)]>0x0){const _0x57233e=_0xc18e25[_0xb5245d(0xede)][0x0];_0x433b47=_0x57233e[_0xb5245d(0x282)]||_0x57233e[_0xb5245d(0xede)]||'';}else typeof _0xc18e25[_0xb5245d(0xede)]==='string'&&_0xc18e25[_0xb5245d(0xede)][_0xb5245d(0x2a8)]()!==''&&(_0x433b47=_0xc18e25['content']);const _0x4b061f=document[_0xb5245d(0x1497)](_0xb5245d(0x379));_0x4b061f['className']=_0xb5245d(0x1570),_0x4b061f[_0xb5245d(0xb6f)]=_0xb5245d(0x976)+_0xc18e25[_0xb5245d(0x1467)]+_0xb5245d(0x850)+_0x433b47+_0xb5245d(0xc9f);const _0x525631=()=>_0x1e77c3(_0xc18e25['id']),_0x5c6eff=async()=>{const _0xaa98d0=_0xb5245d,_0x21eb86=await _0xa6b74a('删除世界书','确定要删除《'+_0xc18e25[_0xaa98d0(0x1467)]+_0xaa98d0(0xbda),{'confirmButtonClass':_0xaa98d0(0x5e8)});_0x21eb86&&(await _0x6ed281[_0xaa98d0(0x44c)][_0xaa98d0(0x869)](_0xc18e25['id']),_0x16699d[_0xaa98d0(0x44c)]=_0x16699d[_0xaa98d0(0x44c)][_0xaa98d0(0x1c0)](_0x3163e4=>_0x3163e4['id']!==_0xc18e25['id']),_0x1c33bd());};_0x4b061f['addEventListener'](_0xb5245d(0x4f6),_0x525631),_0x159366(_0x4b061f,_0x5c6eff);const _0x3386e2=_0x4b061f[_0xb5245d(0xfc0)](!![]);_0x3386e2[_0xb5245d(0x339)](_0xb5245d(0x4f6),_0x525631),_0x159366(_0x3386e2,_0x5c6eff),_0x4f0922[_0xb5245d(0x6b6)](_0x3386e2);const _0x5620ce=_0xc18e25[_0xb5245d(0xd86)]?String(_0xc18e25['categoryId']):_0xb5245d(0x149b),_0x25de33=_0x5cf3b2[_0xb5245d(0xfeb)]('.world-book-category-pane[data-category-id=\x22'+_0x5620ce+'\x22]');_0x25de33&&_0x25de33[_0xb5245d(0x6b6)](_0x4b061f);}),document[_0x55968f(0x1188)](_0x55968f(0x1275))[_0x55968f(0x427)](_0x1540c8=>{const _0x12dcb1=_0x55968f;_0x1540c8[_0x12dcb1(0x339)](_0x12dcb1(0x4f6),()=>_0x53eceb(_0x1540c8['dataset']['categoryId']));});}function _0x3c4687(_0x5e2a96,_0x1c7e06){const _0x49c5b0=_0x3ce1fb,_0x2ec1bc=document[_0x49c5b0(0x1497)](_0x49c5b0(0x379));_0x2ec1bc['className']=_0x49c5b0(0x11fe),_0x2ec1bc[_0x49c5b0(0xb6f)]=_0x49c5b0(0xe0e)+_0x5e2a96+_0x49c5b0(0x27b);const _0x2c54fd=_0x2ec1bc['querySelector'](_0x49c5b0(0x730));return _0x1c7e06['sort']((_0x315110,_0x16c3ee)=>_0x315110[_0x49c5b0(0x1467)]['localeCompare'](_0x16c3ee[_0x49c5b0(0x1467)],_0x49c5b0(0x144f))),_0x1c7e06[_0x49c5b0(0x427)](_0x9b1b2b=>{const _0x3e6e52=_0x49c5b0;let _0xa8d21f='暂无内容...';if(Array['isArray'](_0x9b1b2b[_0x3e6e52(0xede)])&&_0x9b1b2b[_0x3e6e52(0xede)][_0x3e6e52(0xaf9)]>0x0){const _0x350408=_0x9b1b2b['content'][0x0];_0xa8d21f=_0x350408[_0x3e6e52(0x282)]||_0x350408[_0x3e6e52(0xede)]||'';}else typeof _0x9b1b2b[_0x3e6e52(0xede)]===_0x3e6e52(0x273)&&_0x9b1b2b[_0x3e6e52(0xede)][_0x3e6e52(0x2a8)]()!==''&&(_0xa8d21f=_0x9b1b2b[_0x3e6e52(0xede)]);const _0x4d2a71=document[_0x3e6e52(0x1497)](_0x3e6e52(0x379));_0x4d2a71[_0x3e6e52(0x35b)]=_0x3e6e52(0x2aa),_0x4d2a71['dataset'][_0x3e6e52(0x1288)]=_0x9b1b2b['id'],_0x4d2a71['innerHTML']=_0x3e6e52(0x399)+_0x9b1b2b[_0x3e6e52(0x1467)]+_0x3e6e52(0x1135)+String(_0xa8d21f)['substring'](0x0,0x32)+_0x3e6e52(0xc9f),_0x4d2a71[_0x3e6e52(0x339)]('click',()=>_0x1e77c3(_0x9b1b2b['id'])),_0x159366(_0x4d2a71,async()=>{const _0x40556e=_0x3e6e52,_0x253941=await _0xa6b74a(_0x40556e(0xf26),'确定要删除《'+_0x9b1b2b['name']+_0x40556e(0x683),{'confirmButtonClass':'btn-danger'});_0x253941&&(await _0x6ed281[_0x40556e(0x44c)]['delete'](_0x9b1b2b['id']),_0x16699d['worldBooks']=_0x16699d[_0x40556e(0x44c)]['filter'](_0x17fe0a=>_0x17fe0a['id']!==_0x9b1b2b['id']),_0x1c33bd());}),_0x2c54fd['appendChild'](_0x4d2a71);}),_0x2ec1bc;}window[_0x3ce1fb(0x1151)]=_0x1c33bd;async function _0x1e77c3(_0x515230){const _0x49ccb0=_0x3ce1fb;_0x58c3b1(_0x49ccb0(0x847)),_0x1f1c25=_0x515230;const [_0x3be049,_0x5c5755]=await Promise['all']([_0x6ed281['worldBooks'][_0x49ccb0(0xe8c)](_0x515230),_0x6ed281[_0x49ccb0(0x81c)][_0x49ccb0(0x443)]()]);if(!_0x3be049){console['error']('尝试打开一个不存在的世界书，ID:',_0x515230),_0x58c3b1(_0x49ccb0(0xf54));return;}document[_0x49ccb0(0x948)](_0x49ccb0(0x9fb))[_0x49ccb0(0x10cb)]=_0x3be049['name'],document['getElementById'](_0x49ccb0(0x968))[_0x49ccb0(0x5bc)]=_0x3be049[_0x49ccb0(0x1467)];const _0x2e07fb=document[_0x49ccb0(0x948)](_0x49ccb0(0x27f));_0x2e07fb[_0x49ccb0(0xb6f)]=_0x49ccb0(0x6b8),_0x5c5755['forEach'](_0x22ee4f=>{const _0x21f3a4=_0x49ccb0,_0x34e39b=document[_0x21f3a4(0x1497)]('option');_0x34e39b[_0x21f3a4(0x5bc)]=_0x22ee4f['id'],_0x34e39b[_0x21f3a4(0x10cb)]=_0x22ee4f['name'];if(_0x3be049[_0x21f3a4(0xd86)]===_0x22ee4f['id'])_0x34e39b[_0x21f3a4(0xd56)]=!![];_0x2e07fb['appendChild'](_0x34e39b);});const _0x19e41d=document[_0x49ccb0(0x948)]('world-book-entries-container');_0x19e41d[_0x49ccb0(0xb6f)]='',Array['isArray'](_0x3be049[_0x49ccb0(0xede)])&&_0x3be049[_0x49ccb0(0xede)][_0x49ccb0(0xaf9)]>0x0?_0x3be049['content'][_0x49ccb0(0x427)](_0x10665e=>{const _0x1b41b3=_0x49ccb0,_0x325380=_0x1078f4(_0x10665e);_0x19e41d[_0x1b41b3(0x6b6)](_0x325380);}):_0x19e41d['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>';}async function _0x4f21d0(_0xa194f9=!![]){const _0x4923be=_0x3ce1fb,_0xe5a010=document[_0x4923be(0x948)](_0x4923be(0x126a)),_0x4ea8fc=document[_0x4923be(0x948)](_0x4923be(0x11c8)),_0x3e9e6b=document['getElementById'](_0x4923be(0xfd7)),_0x284f03=_0x3e9e6b['value'][_0x4923be(0x2a8)]()[_0x4923be(0x1331)]();if(_0xa194f9){_0x4ea8fc[_0x4923be(0xb6f)]='';const _0x129e6a=await _0x6ed281[_0x4923be(0x19c)][_0x4923be(0x443)]();_0x4ea8fc['innerHTML']+=_0x4923be(0x775)+(_0xf2c276==='all'?'active':'')+_0x4923be(0x159a),_0x129e6a['forEach'](_0x3b1b9f=>{const _0x4ca8a9=_0x4923be;_0x4ea8fc[_0x4ca8a9(0xb6f)]+=_0x4ca8a9(0x775)+(_0xf2c276===_0x3b1b9f['id']?_0x4ca8a9(0x115e):'')+_0x4ca8a9(0xfcd)+_0x3b1b9f['id']+'\x22>'+_0x3b1b9f[_0x4ca8a9(0x1467)]+_0x4ca8a9(0x11f4);}),_0x4ea8fc[_0x4923be(0xb6f)]+=_0x4923be(0x775)+(_0xf2c276===_0x4923be(0x149b)?'active':'')+'\x22\x20data-category-id=\x22uncategorized\x22>未分类</button>';}_0xe5a010[_0x4923be(0xb6f)]='';let _0xf85290;if(_0xf2c276==='all')_0xf85290=_0x16699d[_0x4923be(0x14a2)];else _0xf2c276==='uncategorized'?_0xf85290=_0x16699d[_0x4923be(0x14a2)][_0x4923be(0x1c0)](_0x40cf7c=>!_0x40cf7c[_0x4923be(0xd86)]):_0xf85290=_0x16699d[_0x4923be(0x14a2)][_0x4923be(0x1c0)](_0x8be7f9=>_0x8be7f9[_0x4923be(0xd86)]===_0xf2c276);const _0xb4134e=_0x284f03?_0xf85290[_0x4923be(0x1c0)](_0x528133=>_0x528133[_0x4923be(0x1467)]['toLowerCase']()['includes'](_0x284f03)):_0xf85290;if(_0xb4134e[_0x4923be(0xaf9)]===0x0){const _0x497cf5=_0x284f03?_0x4923be(0xa4b):'这个分类下还没有表情哦~';_0xe5a010[_0x4923be(0xb6f)]=_0x4923be(0x10c4)+_0x497cf5+_0x4923be(0x79d);return;}_0xb4134e[_0x4923be(0x427)](_0x52a1e2=>{const _0x2c3880=_0x4923be,_0x320063=document[_0x2c3880(0x1497)](_0x2c3880(0x379));_0x320063[_0x2c3880(0x35b)]=_0x2c3880(0x1399),_0x320063[_0x2c3880(0xb03)]=_0x52a1e2[_0x2c3880(0x1467)],_0x320063[_0x2c3880(0x606)]['stickerId']=_0x52a1e2['id'],_0x320063[_0x2c3880(0xb6f)]=_0x2c3880(0x4b8)+_0x52a1e2[_0x2c3880(0x9a8)]+_0x2c3880(0x8de)+_0x52a1e2[_0x2c3880(0x1467)]+_0x2c3880(0x10df),_0x320063[_0x2c3880(0x339)](_0x2c3880(0x4f6),()=>{_0x2e251e?_0x3eb6a2(_0x320063):_0x3079d2(_0x52a1e2);});const _0x3f12ec=document['createElement']('div');_0x3f12ec['className']=_0x2c3880(0xd38),_0x3f12ec['innerHTML']=_0x2c3880(0x112a),_0x3f12ec[_0x2c3880(0xe8d)]=async _0x237964=>{const _0x385e03=_0x2c3880;_0x237964[_0x385e03(0x221)]();const _0x293402=await _0xa6b74a('删除表情','确定要删除表情\x20\x22'+_0x52a1e2['name']+'\x22\x20吗？',{'confirmButtonClass':_0x385e03(0x5e8)});_0x293402&&(await _0x6ed281[_0x385e03(0x14a2)][_0x385e03(0x869)](_0x52a1e2['id']),_0x16699d[_0x385e03(0x14a2)]=_0x16699d[_0x385e03(0x14a2)][_0x385e03(0x1c0)](_0x41e587=>_0x41e587['id']!==_0x52a1e2['id']),_0x4f21d0());},_0x320063[_0x2c3880(0x6b6)](_0x3f12ec),_0xe5a010[_0x2c3880(0x6b6)](_0x320063);});}let _0x2e251e=![],_0x1f9526=new Set(),_0x471857=![],_0x5b3f5a=new Set(),_0x223e34=[],_0x9958a6=0x0;const _0x4b9043=0x2d;let _0x112ac2=![];function _0x1c9d58(){const _0x1b67ba=_0x3ce1fb;_0x2e251e=!_0x2e251e;const _0x138ffe=document[_0x1b67ba(0x948)](_0x1b67ba(0x126a)),_0x45f6e5=document['getElementById'](_0x1b67ba(0x34f)),_0x18a5b2=document['getElementById']('sticker-action-bar'),_0x2495bc=document[_0x1b67ba(0x948)]('select-all-stickers-checkbox');_0x138ffe['classList'][_0x1b67ba(0x69d)](_0x1b67ba(0x59d),_0x2e251e),_0x2e251e?(_0x45f6e5[_0x1b67ba(0x10cb)]='完成',_0x18a5b2['style'][_0x1b67ba(0x11fd)]=_0x1b67ba(0x6a4),_0x1f9526[_0x1b67ba(0x99d)](),_0x2495bc[_0x1b67ba(0x210)]=![],_0x1a47a1()):(_0x45f6e5[_0x1b67ba(0x10cb)]='管理',_0x18a5b2[_0x1b67ba(0xf74)][_0x1b67ba(0x11fd)]=_0x1b67ba(0x12fe),_0x138ffe['querySelectorAll'](_0x1b67ba(0xcd7))[_0x1b67ba(0x427)](_0x4e77a2=>_0x4e77a2[_0x1b67ba(0xd54)][_0x1b67ba(0xf89)](_0x1b67ba(0xd56))));}function _0xad4a9d(){const _0x4d0187=_0x3ce1fb,_0x405d21=document['getElementById'](_0x4d0187(0xc16)),_0xd82479=_0x405d21['checked'];let _0x44cc71;if(_0xf2c276===_0x4d0187(0xd49))_0x44cc71=_0x16699d[_0x4d0187(0x14a2)];else _0xf2c276===_0x4d0187(0x149b)?_0x44cc71=_0x16699d['userStickers'][_0x4d0187(0x1c0)](_0x1e5e18=>!_0x1e5e18[_0x4d0187(0xd86)]):_0x44cc71=_0x16699d[_0x4d0187(0x14a2)][_0x4d0187(0x1c0)](_0x4e3c33=>_0x4e3c33[_0x4d0187(0xd86)]===_0xf2c276);_0x44cc71[_0x4d0187(0x427)](_0x221d70=>{const _0x5ac1a7=_0x4d0187,_0x59e344=_0x221d70['id'],_0x129e30=document[_0x5ac1a7(0xfeb)](_0x5ac1a7(0x765)+_0x59e344+'\x22]');if(_0xd82479){_0x1f9526[_0x5ac1a7(0xbd0)](_0x59e344);if(_0x129e30)_0x129e30['classList']['add'](_0x5ac1a7(0xd56));}else{_0x1f9526[_0x5ac1a7(0x869)](_0x59e344);if(_0x129e30)_0x129e30[_0x5ac1a7(0xd54)][_0x5ac1a7(0xf89)](_0x5ac1a7(0xd56));}}),_0x1a47a1();}function _0x1a47a1(){const _0x58c38f=_0x3ce1fb,_0x4b3038=document[_0x58c38f(0x948)](_0x58c38f(0x1495));_0x4b3038[_0x58c38f(0x10cb)]='删除\x20('+_0x1f9526['size']+')';}function _0x3eb6a2(_0x48d14a){const _0x64f499=_0x3ce1fb;if(!_0x2e251e)return;const _0x14ba08=_0x48d14a['dataset'][_0x64f499(0x15b2)];if(!_0x14ba08)return;_0x48d14a[_0x64f499(0xd54)][_0x64f499(0x69d)](_0x64f499(0xd56)),_0x1f9526[_0x64f499(0xda1)](_0x14ba08)?_0x1f9526[_0x64f499(0x869)](_0x14ba08):_0x1f9526[_0x64f499(0xbd0)](_0x14ba08),_0x1a47a1();}async function _0x3c930e(){const _0x51442d=_0x3ce1fb;if(_0x1f9526['size']===0x0)return;const _0x3b0a56=await _0xa6b74a(_0x51442d(0x8ed),_0x51442d(0x232)+_0x1f9526['size']+_0x51442d(0x61f),{'confirmButtonClass':_0x51442d(0x5e8)});if(_0x3b0a56){const _0x116c4a=[..._0x1f9526];await _0x6ed281[_0x51442d(0x14a2)][_0x51442d(0xd5d)](_0x116c4a),_0x16699d[_0x51442d(0x14a2)]=_0x16699d[_0x51442d(0x14a2)][_0x51442d(0x1c0)](_0x58f348=>!_0x116c4a[_0x51442d(0x1336)](_0x58f348['id'])),_0x1c9d58(),_0x4f21d0(),await _0x104485(_0x51442d(0x111a),_0x51442d(0x1070));}}async function _0x335451(){const _0x52a2cd=_0x3ce1fb,_0x23a4fe=_0x52a2cd(0x8dd),_0x35dd07=await _0x41b9fc(_0x52a2cd(0x115c),_0x23a4fe,'',_0x52a2cd(0xc1e));_0x35dd07&&_0x35dd07[_0x52a2cd(0x2a8)]()&&await _0x870192(_0x35dd07);}async function _0x870192(_0xaacbee){const _0x2e942c=_0x3ce1fb,_0x518843=_0xaacbee[_0x2e942c(0x2a8)]()[_0x2e942c(0x46f)]('\x0a'),_0x52e0d4=[],_0x2a3dd1='https://files.catbox.moe/';let _0x43bddb=0x0;const _0x348b7a=_0xf2c276!=='all'&&_0xf2c276!==_0x2e942c(0x149b)?_0xf2c276:null;for(const _0x50e270 of _0x518843){const _0xaf8399=_0x50e270[_0x2e942c(0x2a8)]();if(!_0xaf8399||_0xaf8399['includes']('填入'))continue;const _0x12b92b=_0xaf8399[_0x2e942c(0x9a3)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x12b92b){const _0x505842=_0x12b92b[0x1][_0x2e942c(0x2a8)](),_0x415b0b=_0x12b92b[0x2][_0x2e942c(0x2a8)]();_0x52e0d4[_0x2e942c(0x1001)]({'id':_0x2e942c(0x906)+Date[_0x2e942c(0x1386)]()+Math[_0x2e942c(0x59c)](),'name':_0x505842,'url':_0x415b0b,'categoryId':_0x348b7a});continue;}let _0x12aaa7=null,_0x13a1cd=null;const _0x4f3924=_0xaf8399[_0x2e942c(0x9a3)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x4f3924)_0x12aaa7=_0x4f3924[0x1],_0x13a1cd=_0x4f3924[0x2];else{const _0x3445d2=_0xaf8399['split'](/\s+/);_0x3445d2[_0x2e942c(0xaf9)]>=0x2&&(_0x13a1cd=_0x3445d2[_0x2e942c(0x1147)](),_0x12aaa7=_0x3445d2[_0x2e942c(0x121a)]('\x20'));}_0x12aaa7&&_0x13a1cd&&_0x13a1cd[_0x2e942c(0x1336)]('.')?_0x52e0d4[_0x2e942c(0x1001)]({'id':_0x2e942c(0x906)+Date[_0x2e942c(0x1386)]()+Math['random'](),'name':_0x12aaa7,'url':_0x2a3dd1+_0x13a1cd,'categoryId':_0x348b7a}):(_0x43bddb++,console[_0x2e942c(0x9c1)](_0x2e942c(0x1349),_0xaf8399));}_0x43bddb>0x0&&await _0x104485(_0x2e942c(0xca9),'有\x20'+_0x43bddb+_0x2e942c(0x827));if(_0x52e0d4['length']>0x0)await _0x6ed281[_0x2e942c(0x14a2)]['bulkAdd'](_0x52e0d4),_0x16699d[_0x2e942c(0x14a2)][_0x2e942c(0x1001)](..._0x52e0d4),_0x4f21d0(),await _0x104485(_0x2e942c(0x5c6),_0x2e942c(0xa72)+_0x52e0d4[_0x2e942c(0xaf9)]+_0x2e942c(0x11b3));else _0x43bddb===0x0&&alert('没有找到可导入的内容。请检查您粘贴的格式是否正确。');}function _0x27dd05(_0x2fd244){const _0x193a34=_0x3ce1fb,_0x3fd3b7='.message-bubble[data-timestamp=\x22'+_0x2fd244+'\x22]',_0x1e355e=document[_0x193a34(0xfeb)](_0x3fd3b7);_0x1e355e?(_0x1e355e[_0x193a34(0xe45)]({'behavior':_0x193a34(0xa62),'block':'center'}),_0x1e355e[_0x193a34(0xd54)][_0x193a34(0xbd0)](_0x193a34(0x148a)),setTimeout(()=>{const _0x4b8f00=_0x193a34;document[_0x4b8f00(0xae6)][_0x4b8f00(0x7a0)](_0x1e355e)&&_0x1e355e[_0x4b8f00(0xd54)]['remove'](_0x4b8f00(0x148a));},0x5dc)):alert('找不到原始消息。可能已被删除或位于更早的历史记录中。');}async function _0x1f8f7b(_0x17aa86,_0x570b27){const _0x1fad6d=_0x3ce1fb;if(_0x17aa86['type']==='recalled_message'){const _0x39b234=document[_0x1fad6d(0x1497)](_0x1fad6d(0x379));_0x39b234[_0x1fad6d(0x35b)]='message-wrapper\x20system-pat',_0x39b234[_0x1fad6d(0x606)]['timestamp']=_0x17aa86[_0x1fad6d(0xb0a)];const _0x26c9cf=document['createElement'](_0x1fad6d(0x379));return _0x26c9cf[_0x1fad6d(0x35b)]=_0x1fad6d(0xa39),_0x26c9cf[_0x1fad6d(0x606)][_0x1fad6d(0xb0a)]=_0x17aa86['timestamp'],_0x26c9cf[_0x1fad6d(0x10cb)]=_0x17aa86['content'],_0x39b234[_0x1fad6d(0x6b6)](_0x26c9cf),_0x159366(_0x39b234,()=>_0x4685bf(_0x17aa86[_0x1fad6d(0xb0a)])),_0x39b234[_0x1fad6d(0x339)](_0x1fad6d(0x4f6),()=>{const _0x5de77e=_0x1fad6d;_0x202b41&&_0x5e9a4b(_0x17aa86[_0x5de77e(0xb0a)]);}),_0x39b234;}else{if(_0x17aa86['type']===_0x1fad6d(0x1128)){const _0x58133e=document[_0x1fad6d(0x1497)](_0x1fad6d(0x379));_0x58133e[_0x1fad6d(0x35b)]=_0x1fad6d(0xc4f),_0x58133e[_0x1fad6d(0x606)][_0x1fad6d(0xb0a)]=_0x17aa86[_0x1fad6d(0xb0a)];const _0x4cebe5=document[_0x1fad6d(0x1497)](_0x1fad6d(0x379));return _0x4cebe5[_0x1fad6d(0x35b)]=_0x1fad6d(0xd92),_0x4cebe5[_0x1fad6d(0x606)][_0x1fad6d(0xba5)]=_0x17aa86['postId'],_0x4cebe5[_0x1fad6d(0x10cb)]=_0x17aa86['content'],_0x58133e[_0x1fad6d(0x6b6)](_0x4cebe5),_0x159366(_0x58133e,()=>_0x4685bf(_0x17aa86[_0x1fad6d(0xb0a)])),_0x58133e['addEventListener']('click',()=>{_0x202b41&&_0x5e9a4b(_0x17aa86['timestamp']);}),_0x58133e;}}if(_0x17aa86[_0x1fad6d(0x583)])return null;if(_0x17aa86[_0x1fad6d(0x4ae)]===_0x1fad6d(0xb96)){const _0x3392c4=document[_0x1fad6d(0x1497)](_0x1fad6d(0x379));_0x3392c4['className']=_0x1fad6d(0xc4f);const _0x2dcf4c=document['createElement'](_0x1fad6d(0x379));return _0x2dcf4c[_0x1fad6d(0x35b)]=_0x1fad6d(0x11f0),_0x2dcf4c[_0x1fad6d(0x606)][_0x1fad6d(0xb0a)]=_0x17aa86[_0x1fad6d(0xb0a)],_0x2dcf4c[_0x1fad6d(0x10cb)]=_0x17aa86[_0x1fad6d(0xede)],_0x3392c4['appendChild'](_0x2dcf4c),_0x159366(_0x3392c4,()=>_0x4685bf(_0x17aa86[_0x1fad6d(0xb0a)])),_0x3392c4[_0x1fad6d(0x339)]('click',()=>{if(_0x202b41)_0x5e9a4b(_0x17aa86['timestamp']);}),_0x3392c4;}const _0x2bcd63=_0x17aa86['role']===_0x1fad6d(0xaeb),_0x1e9216=_0x570b27[_0x1fad6d(0x7fd)]['myNickname']||'我',_0x3a2ede=document[_0x1fad6d(0x1497)]('div');_0x3a2ede[_0x1fad6d(0x35b)]='message-wrapper\x20'+(_0x2bcd63?_0x1fad6d(0xaeb):'ai');if(_0x570b27[_0x1fad6d(0x1173)]&&!_0x2bcd63){const _0xa297b=_0x570b27[_0x1fad6d(0x10a2)][_0x1fad6d(0x1402)](_0x1b5b58=>_0x1b5b58[_0x1fad6d(0x628)]===_0x17aa86['senderName']),_0x52e927=document[_0x1fad6d(0x1497)]('div');_0x52e927[_0x1fad6d(0x35b)]='sender-name',_0x52e927['textContent']=_0xa297b?_0xa297b[_0x1fad6d(0x347)]:_0x17aa86[_0x1fad6d(0x14ee)]||_0x1fad6d(0x724),_0x3a2ede['appendChild'](_0x52e927);}const _0x4e90c7=document[_0x1fad6d(0x1497)](_0x1fad6d(0x379));_0x4e90c7[_0x1fad6d(0x35b)]=_0x1fad6d(0x11c5)+(_0x2bcd63?_0x1fad6d(0xaeb):'ai'),_0x4e90c7['dataset']['timestamp']=_0x17aa86[_0x1fad6d(0xb0a)];const _0x4b35e5=document[_0x1fad6d(0x1497)](_0x1fad6d(0x65b));_0x4b35e5[_0x1fad6d(0x35b)]=_0x1fad6d(0xb0a),_0x4b35e5[_0x1fad6d(0x10cb)]=_0x43956a(_0x17aa86['timestamp']);let _0x46a24b,_0x46a61d='';if(_0x2bcd63)_0x46a24b=_0x570b27[_0x1fad6d(0x7fd)]['myAvatar']||(_0x570b27['isGroup']?_0x5c1dc1:_0x202ba5),_0x46a61d=_0x570b27[_0x1fad6d(0x7fd)][_0x1fad6d(0x892)]||'';else{if(_0x570b27['isGroup']){const _0x298cc1=_0x570b27[_0x1fad6d(0x10a2)]['find'](_0x4102ef=>_0x4102ef[_0x1fad6d(0x628)]===_0x17aa86[_0x1fad6d(0x14ee)]);if(_0x298cc1){const _0xa489c6=_0x16699d['chats'][_0x298cc1['id']];_0x46a24b=_0x298cc1[_0x1fad6d(0x63e)]||(_0xa489c6?_0xa489c6[_0x1fad6d(0x7fd)][_0x1fad6d(0x156d)]:_0x3ca5ef),_0x46a61d=_0x298cc1[_0x1fad6d(0x1278)]||(_0xa489c6?_0xa489c6[_0x1fad6d(0x7fd)][_0x1fad6d(0x3b7)]:'');}else _0x46a24b=_0x3ca5ef,_0x46a61d='';}else _0x46a24b=_0x570b27[_0x1fad6d(0x7fd)][_0x1fad6d(0x156d)]||_0x202ba5,_0x46a61d=_0x570b27['settings'][_0x1fad6d(0x3b7)]||'';}let _0x1142ea;_0x46a61d?_0x1142ea=_0x1fad6d(0x149f)+_0x46a24b+'\x22\x20class=\x22avatar-img\x22><img\x20src=\x22'+_0x46a61d+'\x22\x20class=\x22avatar-frame\x22></div>':_0x1142ea=_0x1fad6d(0x4ad)+_0x46a24b+_0x1fad6d(0x9d6);const _0x14633a=_0x46a61d?_0x1fad6d(0xa4f):'',_0x7a58b8=_0x1fad6d(0x47e)+_0x14633a+'\x22>'+_0x1142ea+_0x1fad6d(0xc7f);let _0x565019,_0x58cb8a='';if(_0x17aa86[_0x1fad6d(0xe7f)]){const _0x15f5a1=_0x589066(_0x570b27,_0x17aa86[_0x1fad6d(0xe7f)][_0x1fad6d(0x14ee)]),_0x23ff1f=String(_0x17aa86[_0x1fad6d(0xe7f)]['content']||'');_0x58cb8a=_0x1fad6d(0xf2e)+_0x17aa86[_0x1fad6d(0xe7f)][_0x1fad6d(0xb0a)]+'\x22\x20style=\x22cursor:\x20pointer;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-sender\x22>回复\x20'+_0x15f5a1+_0x1fad6d(0x319)+_0x23ff1f+_0x1fad6d(0x3fa);}let _0x3baff5=_0x17aa86['content'];if(typeof _0x3baff5===_0x1fad6d(0x273)&&_0x3baff5[_0x1fad6d(0x2a8)]()['startsWith']('<')&&_0x3baff5[_0x1fad6d(0x2a8)]()[_0x1fad6d(0x918)]('>'))_0x565019=_0x3baff5,_0x4e90c7['classList'][_0x1fad6d(0xbd0)](_0x1fad6d(0x1250));else{if(_0x17aa86[_0x1fad6d(0x4ae)]===_0x1fad6d(0xd5f)||_0x17aa86[_0x1fad6d(0x4ae)]===_0x1fad6d(0xa7a)||_0x17aa86['type']===_0x1fad6d(0x1593)||_0x17aa86[_0x1fad6d(0x4ae)]===_0x1fad6d(0x137c)||_0x17aa86[_0x1fad6d(0x4ae)]===_0x1fad6d(0x1281)||_0x17aa86[_0x1fad6d(0x4ae)]===_0x1fad6d(0x368)||_0x17aa86[_0x1fad6d(0x4ae)]==='voice_message'||_0x17aa86[_0x1fad6d(0x4ae)]===_0x1fad6d(0x1514)||_0x17aa86[_0x1fad6d(0x4ae)]===_0x1fad6d(0x29c)||_0x17aa86[_0x1fad6d(0x4ae)]===_0x1fad6d(0xf8e)||_0x17aa86[_0x1fad6d(0x4ae)]===_0x1fad6d(0x148f)||_0x17aa86[_0x1fad6d(0x4ae)]==='poll'||_0x17aa86[_0x1fad6d(0x4ae)]==='gift'||_0x17aa86['type']===_0x1fad6d(0xe9a)||_0x17aa86['type']===_0x1fad6d(0x1141)){if(_0x17aa86[_0x1fad6d(0x4ae)]==='offline_text'){const _0x355fcc=_0x17aa86[_0x1fad6d(0xede)]||((_0x17aa86[_0x1fad6d(0x13c5)]||'')+'\x20'+(_0x17aa86['description']||''))['trim'](),_0x23c840=/(「.*?」|“.*?”)/g,_0x3f6f46=_0x355fcc['split'](_0x23c840)['filter'](_0x1601eb=>_0x1601eb);_0x565019=_0x3f6f46[_0x1fad6d(0x8ff)](_0x349957=>{const _0x169413=_0x1fad6d;return _0x349957[_0x169413(0x157f)]('「')||_0x349957['startsWith']('“')?_0x169413(0x72c)+_0x5876e7(_0x349957)+_0x169413(0xffc):_0x169413(0x475)+_0x5876e7(_0x349957[_0x169413(0x2a8)]())[_0x169413(0x14e9)](/\n/g,_0x169413(0x1121))+'</span>';})[_0x1fad6d(0x121a)]('');}else{if(_0x17aa86[_0x1fad6d(0x4ae)]==='share_link')_0x4e90c7['classList']['add'](_0x1fad6d(0x1318),'is-card-like'),_0x565019=_0x1fad6d(0x965)+_0x17aa86[_0x1fad6d(0xb0a)]+_0x1fad6d(0x134d)+(_0x17aa86[_0x1fad6d(0xb03)]||_0x1fad6d(0x284))+_0x1fad6d(0x504)+(_0x17aa86['description']||_0x1fad6d(0xcd9))+_0x1fad6d(0x745)+(_0x17aa86[_0x1fad6d(0x10c9)]||_0x1fad6d(0xb6e))+_0x1fad6d(0x1313);else{if(_0x17aa86[_0x1fad6d(0x4ae)]===_0x1fad6d(0x1593))_0x4e90c7[_0x1fad6d(0xd54)][_0x1fad6d(0xbd0)](_0x1fad6d(0x1318),_0x1fad6d(0x1438)),_0x565019=_0x1fad6d(0x5b0)+_0x17aa86['timestamp']+_0x1fad6d(0x134d)+_0x17aa86['payload'][_0x1fad6d(0xb03)]+_0x1fad6d(0x156b)+_0x17aa86['payload'][_0x1fad6d(0xcc6)]['length']+'\x20条消息</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20...>...</svg><span>聊天记录</span></div></div>';else{if(_0x17aa86['type']===_0x1fad6d(0x137c)){_0x4e90c7['classList']['add'](_0x1fad6d(0xb22),_0x1fad6d(0x1438));let _0x466c6d;if(_0x17aa86['imageUrl'])_0x466c6d=_0x17aa86[_0x1fad6d(0x15b8)];else _0x16699d[_0x1fad6d(0xf9c)][_0x1fad6d(0xf46)]&&_0x17aa86['image_prompt']?_0x466c6d=_0x1fad6d(0xbfa)+encodeURIComponent(_0x17aa86[_0x1fad6d(0x5d9)]):_0x466c6d=_0x1fad6d(0xef7);const _0x1d6b81=_0x1fad6d(0x1dd)+_0x466c6d+'\x27);\x22';_0x565019=_0x1fad6d(0x4c6)+_0x17aa86['content']+_0x1fad6d(0x6bd)+_0x1d6b81+_0x1fad6d(0x1580);}else{if(_0x17aa86[_0x1fad6d(0x4ae)]===_0x1fad6d(0x368)||_0x17aa86[_0x1fad6d(0x4ae)]===_0x1fad6d(0x1281)){_0x4e90c7[_0x1fad6d(0xd54)][_0x1fad6d(0xbd0)](_0x1fad6d(0x898),_0x1fad6d(0x1438));const _0x183b1b=_0x17aa86[_0x1fad6d(0x4ae)]===_0x1fad6d(0x368)?_0x1fad6d(0x1142):'AI生成的图片',_0x3a120c=_0x16699d[_0x1fad6d(0xf9c)]['enableAiDrawing']&&_0x17aa86[_0x1fad6d(0x5d9)]?_0x1fad6d(0xbfa)+_0x17aa86[_0x1fad6d(0x5d9)]:_0x1fad6d(0x156f);_0x565019=_0x1fad6d(0x4ad)+_0x3a120c+_0x1fad6d(0xcdf)+_0x183b1b+'\x22\x20data-description=\x22'+_0x17aa86[_0x1fad6d(0xede)]+'\x22>';}else{if(_0x17aa86[_0x1fad6d(0x4ae)]===_0x1fad6d(0x1141))_0x4e90c7['classList'][_0x1fad6d(0xbd0)](_0x1fad6d(0x997),_0x1fad6d(0x1438)),_0x565019='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nai-image-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x17aa86[_0x1fad6d(0x15b8)]+_0x1fad6d(0x838)+(_0x17aa86[_0x1fad6d(0xb54)]||_0x17aa86[_0x1fad6d(0xc4b)]||_0x1fad6d(0x2e1))+_0x1fad6d(0x29e);else{if(_0x17aa86['type']==='voice_message'){_0x4e90c7[_0x1fad6d(0xd54)][_0x1fad6d(0xbd0)](_0x1fad6d(0xb43),_0x1fad6d(0x1438));const _0x23fc99=Math['max'](0x1,Math['round']((_0x17aa86['content']||'')[_0x1fad6d(0xaf9)]/0x5)),_0x8ea559='0:'+String(_0x23fc99)['padStart'](0x2,'0')+'\x27\x27',_0x5775d8=_0x1fad6d(0x237);if(_0x2bcd63)_0x565019=_0x1fad6d(0x49d)+encodeURIComponent(_0x17aa86['content'])+_0x1fad6d(0xd9d)+_0x5775d8+_0x1fad6d(0x142c)+_0x8ea559+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';else{const _0x42952b=!_0x570b27[_0x1fad6d(0x1173)]&&_0x570b27[_0x1fad6d(0x7fd)][_0x1fad6d(0x126c)]!==![],_0x6f6e48=_0x570b27[_0x1fad6d(0x7fd)][_0x1fad6d(0x1ad)]||_0x1fad6d(0x53c),_0x52846a=_0x42952b?_0x1fad6d(0x9dc)+_0x6f6e48+'\x22':'';_0x565019='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22'+encodeURIComponent(_0x17aa86[_0x1fad6d(0xede)])+'\x22\x20'+_0x52846a+_0x1fad6d(0xe56)+_0x5775d8+_0x1fad6d(0x12be)+_0x8ea559+_0x1fad6d(0x1270);}}else{if(_0x17aa86[_0x1fad6d(0x4ae)]==='transfer'){_0x4e90c7[_0x1fad6d(0xd54)][_0x1fad6d(0xbd0)](_0x1fad6d(0xcf9),_0x1fad6d(0x1438));let _0x7c71d4,_0x22c7e2;const _0x20e38d=_0x570b27[_0x1fad6d(0x1173)]?_0x570b27['settings'][_0x1fad6d(0x1371)]||'我':'我',_0x3ca558=_0x589066(_0x570b27,_0x17aa86[_0x1fad6d(0x14ee)]),_0x1feb72=_0x589066(_0x570b27,_0x17aa86[_0x1fad6d(0xb57)]||_0x570b27['name']);if(_0x2bcd63){if(_0x17aa86[_0x1fad6d(0x9d2)])_0x7c71d4=_0x1fad6d(0x10f3)+_0x1feb72,_0x22c7e2=_0x1fad6d(0x31c);else{_0x7c71d4=_0x1fad6d(0x1355)+_0x1feb72;if(_0x17aa86['status']==='accepted')_0x22c7e2=_0x1fad6d(0xdc9);else{if(_0x17aa86[_0x1fad6d(0x82c)]===_0x1fad6d(0x777))_0x22c7e2='对方已拒收';else _0x22c7e2=_0x17aa86[_0x1fad6d(0x2a7)]||_0x1fad6d(0x245);}}}else{if(_0x17aa86[_0x1fad6d(0x9d2)])_0x7c71d4='退款来自\x20'+_0x3ca558,_0x22c7e2=_0x1fad6d(0x11a6);else{if(_0x17aa86['receiverName']===_0x20e38d){_0x7c71d4=_0x1fad6d(0x1355)+_0x20e38d;if(_0x17aa86[_0x1fad6d(0x82c)]===_0x1fad6d(0x855))_0x22c7e2='你已收款';else{if(_0x17aa86[_0x1fad6d(0x82c)]===_0x1fad6d(0x777))_0x22c7e2=_0x1fad6d(0x1282);else _0x4e90c7[_0x1fad6d(0xf74)][_0x1fad6d(0x12f7)]='pointer',_0x4e90c7[_0x1fad6d(0x606)][_0x1fad6d(0x82c)]=_0x1fad6d(0x150c),_0x22c7e2=_0x17aa86[_0x1fad6d(0x2a7)]||_0x1fad6d(0xea5);}}else _0x7c71d4='转账:\x20'+_0x3ca558+_0x1fad6d(0x13f8)+_0x1feb72,_0x22c7e2=_0x17aa86['note']||_0x1fad6d(0x32e);}}const _0xfb2d8e='<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2220\x22\x20height=\x2220\x22\x20fill=\x22currentColor\x22\x20style=\x22vertical-align:\x20middle;\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22></path></svg>';_0x565019=_0x1fad6d(0x7f0)+_0xfb2d8e+'\x20'+_0x7c71d4+'</div><div\x20class=\x22transfer-amount\x22>¥\x20'+Number(_0x17aa86[_0x1fad6d(0xbd2)])[_0x1fad6d(0xd69)](0x2)+_0x1fad6d(0x11a3)+_0x22c7e2+_0x1fad6d(0x1087);}else{if(_0x17aa86[_0x1fad6d(0x4ae)]===_0x1fad6d(0x29c)){_0x4e90c7[_0x1fad6d(0xd54)][_0x1fad6d(0xbd0)](_0x1fad6d(0x84c),'is-card-like');if(_0x17aa86[_0x1fad6d(0x82c)]===_0x1fad6d(0x922)||_0x17aa86[_0x1fad6d(0x82c)]===_0x1fad6d(0xc84))_0x4e90c7['classList'][_0x1fad6d(0xbd0)]('status-'+_0x17aa86[_0x1fad6d(0x82c)]);const _0x2d4d56=_0x589066(_0x570b27,_0x17aa86[_0x1fad6d(0x14ee)]),_0x1f86ab=_0x1fad6d(0x578)+_0x2d4d56+_0x1fad6d(0xc67);let _0x17abc2='';_0x17aa86[_0x1fad6d(0x82c)]===_0x1fad6d(0x150c)&&!_0x2bcd63&&(_0x17abc2='<div\x20class=\x22waimai-user-actions\x22><button\x20class=\x22waimai-decline-btn\x22\x20data-choice=\x22rejected\x22>残忍拒绝</button><button\x20class=\x22waimai-pay-btn\x22\x20data-choice=\x22paid\x22>为Ta买单</button></div>'),_0x565019='<div\x20class=\x22waimai-card\x22><div\x20class=\x22waimai-header\x22><img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22><div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div></div><div\x20class=\x22waimai-catchphrase\x22>Hi，你和我的距离只差一顿外卖～</div><div\x20class=\x22waimai-main\x22><div\x20class=\x22request-title\x22>'+_0x1f86ab+_0x1fad6d(0x116a)+Number(_0x17aa86['amount'])['toFixed'](0x2)+'</div><div\x20class=\x22countdown-label\x22>剩余支付时间<div\x20class=\x22countdown-timer\x22\x20id=\x22waimai-timer-'+_0x17aa86[_0x1fad6d(0xb0a)]+_0x1fad6d(0xb4e)+_0x17abc2+'</div>',setTimeout(()=>{const _0x2c682c=_0x1fad6d;if(_0x17aa86[_0x2c682c(0x82c)]===_0x2c682c(0x150c)){const _0x147f65=document['getElementById'](_0x2c682c(0xd6c)+_0x17aa86[_0x2c682c(0xb0a)]);if(_0x147f65){const _0x3c0fd6=_0x4b7294(_0x147f65,_0x17aa86['countdownEndTime']);_0x5a9d1f[_0x17aa86[_0x2c682c(0xb0a)]]=_0x3c0fd6;}}},0x0);}else{if(_0x17aa86['type']===_0x1fad6d(0xf8e)){_0x4e90c7[_0x1fad6d(0xd54)][_0x1fad6d(0xbd0)](_0x1fad6d(0x84c),_0x1fad6d(0x1438));const _0x714518=_0x589066(_0x570b27,_0x17aa86['senderName']);let _0x36f8bd='你';_0x570b27[_0x1fad6d(0x1173)]&&(_0x36f8bd=_0x589066(_0x570b27,_0x17aa86[_0x1fad6d(0x100d)])),_0x565019=_0x1fad6d(0x10da)+_0x714518+_0x1fad6d(0xb8e)+_0x36f8bd+_0x1fad6d(0x10e7)+_0x17aa86[_0x1fad6d(0x890)]+_0x1fad6d(0xb15)+Number(_0x17aa86['amount'])[_0x1fad6d(0xd69)](0x2)+_0x1fad6d(0x14c6);}else{if(_0x17aa86[_0x1fad6d(0x4ae)]===_0x1fad6d(0x148f)){_0x4e90c7[_0x1fad6d(0xd54)][_0x1fad6d(0xbd0)](_0x1fad6d(0x1435),'is-card-like');const _0x5a1965=_0x16699d[_0x1fad6d(0x66e)]['nickname']||'{{user}}',_0x17507b=_0x17aa86[_0x1fad6d(0x134a)],_0x5ead3d=_0x17aa86[_0x1fad6d(0x764)]&&_0x17aa86[_0x1fad6d(0x764)][_0x5a1965];let _0x13ed4='',_0x4d1d8b='',_0x304eaa=_0x1fad6d(0xd78);_0x17507b&&(_0x13ed4=_0x1fad6d(0x2da));if(_0x17aa86[_0x1fad6d(0x7f7)]===_0x1fad6d(0x3ec)){const _0x1ee212=_0x589066(_0x570b27,_0x17aa86[_0x1fad6d(0xb57)]);_0x304eaa=_0x1fad6d(0x1094)+_0x1ee212;if(Object[_0x1fad6d(0x1cf)](_0x17aa86[_0x1fad6d(0x764)]||{})['length']>0x0)_0x13ed4=_0x1fad6d(0x2da);}if(_0x5ead3d){const _0x3313b7=_0x17aa86[_0x1fad6d(0x764)][_0x5a1965]||0x0;_0x4d1d8b='<div\x20class=\x22rp-claimed-info\x22>你领取了红包，金额\x20'+_0x3313b7[_0x1fad6d(0xd69)](0x2)+_0x1fad6d(0xc7d);}else{if(_0x17507b)_0x4d1d8b=_0x1fad6d(0x14ff);else{if(_0x17aa86[_0x1fad6d(0x7f7)]===_0x1fad6d(0x3ec)&&Object[_0x1fad6d(0x1cf)](_0x17aa86[_0x1fad6d(0x764)]||{})[_0x1fad6d(0xaf9)]>0x0){const _0x5b6b55=_0x589066(_0x570b27,_0x17aa86[_0x1fad6d(0xb57)]);_0x4d1d8b=_0x1fad6d(0x37a)+_0x5b6b55+'\x20领取</div>';}}}_0x565019='<div\x20class=\x22red-packet-card\x20'+_0x13ed4+_0x1fad6d(0x58e)+(_0x17aa86['greeting']||_0x1fad6d(0xc8f))+'</span></div><div\x20class=\x22rp-type\x22>'+_0x304eaa+'</div>'+_0x4d1d8b+_0x1fad6d(0xc7f);}else{if(_0x17aa86[_0x1fad6d(0x4ae)]===_0x1fad6d(0x1385)){_0x4e90c7['classList'][_0x1fad6d(0xbd0)](_0x1fad6d(0x2e7),'is-card-like');const _0x2ac738=_0x17aa86['question']||_0x17aa86[_0x1fad6d(0xede)]||_0x1fad6d(0x1072);let _0x53e417=0x0;const _0x3ea675={};for(const _0x18ae50 in _0x17aa86[_0x1fad6d(0xb0b)]){const _0x3c6333=_0x17aa86[_0x1fad6d(0xb0b)][_0x18ae50][_0x1fad6d(0xaf9)];_0x3ea675[_0x18ae50]=_0x3c6333,_0x53e417+=_0x3c6333;}const _0x94e6b6=_0x16699d[_0x1fad6d(0x66e)][_0x1fad6d(0xf4d)]||'{{user}}';let _0x814a30=null;for(const _0x1a8766 in _0x17aa86[_0x1fad6d(0xb0b)]){if(_0x17aa86[_0x1fad6d(0xb0b)][_0x1a8766][_0x1fad6d(0x1336)](_0x94e6b6)){_0x814a30=_0x1a8766;break;}}let _0x2e0f31=_0x1fad6d(0x8b6);_0x17aa86[_0x1fad6d(0x5ae)][_0x1fad6d(0x427)](_0x111b0b=>{const _0x46f2e1=_0x1fad6d,_0x4adb8b=_0x3ea675[_0x111b0b]||0x0,_0xd62f5a=_0x53e417>0x0?_0x4adb8b/_0x53e417*0x64:0x0,_0x3584c9=_0x814a30===_0x111b0b;_0x2e0f31+=_0x46f2e1(0xa29)+(_0x3584c9?_0x46f2e1(0x616):'')+_0x46f2e1(0xa68)+_0x111b0b+_0x46f2e1(0x464)+_0xd62f5a+'%;\x22></div><div\x20class=\x22poll-option-content\x22><span\x20class=\x22poll-option-text\x22>'+_0x111b0b+_0x46f2e1(0x546)+_0x4adb8b+'\x20票</span></div></div>';}),_0x2e0f31+=_0x1fad6d(0xc7f);let _0x17438f=_0x17aa86[_0x1fad6d(0x30f)]?_0x1fad6d(0x125a)+_0x53e417+_0x1fad6d(0xab1):_0x1fad6d(0x125a)+_0x53e417+_0x1fad6d(0x75a);_0x565019='<div\x20class=\x22poll-card\x20'+(_0x17aa86[_0x1fad6d(0x30f)]?_0x1fad6d(0xd70):'')+_0x1fad6d(0xc89)+_0x17aa86['timestamp']+'\x22><div\x20class=\x22poll-question\x22>'+_0x2ac738+'</div>'+_0x2e0f31+_0x17438f+'</div>';}else{if(_0x17aa86[_0x1fad6d(0x4ae)]===_0x1fad6d(0x9e7)){_0x4e90c7[_0x1fad6d(0xd54)][_0x1fad6d(0xbd0)](_0x1fad6d(0x505),_0x1fad6d(0x1438));let _0x499275;const _0x392846=_0x570b27[_0x1fad6d(0x7fd)][_0x1fad6d(0x1371)]||'我';if(_0x570b27['isGroup']){if(_0x17aa86[_0x1fad6d(0x797)]&&_0x17aa86[_0x1fad6d(0x797)][_0x1fad6d(0xaf9)]>0x0){const _0x50543e=_0x17aa86['recipients'][_0x1fad6d(0x8ff)](_0x1910e6=>_0x589066(_0x570b27,_0x1910e6));_0x50543e['length']===0x1?_0x499275=_0x1fad6d(0xa4a)+_0x50543e[0x0]+_0x1fad6d(0x696):_0x499275='送给\x20'+_0x50543e[_0x1fad6d(0x200)](0x0,0x2)['join']('、')+_0x1fad6d(0xf9d);}else _0x499275='送给大家的礼物';}else{if(_0x2bcd63)_0x499275=_0x1fad6d(0xa4a)+_0x570b27[_0x1fad6d(0x1467)]+_0x1fad6d(0x696);else{const _0x11b717=_0x570b27[_0x1fad6d(0x7fd)]['myNickname']||'你';_0x499275=_0x1fad6d(0xa4a)+_0x11b717+'\x20的礼物';}}const _0x4f3f76=_0x17aa86[_0x1fad6d(0x1351)][_0x1fad6d(0x200)](0x0,0x3);let _0x397c18='';_0x4f3f76['forEach'](_0x25bbaf=>{const _0x5d4286=_0x1fad6d;_0x397c18+=_0x5d4286(0xfef)+_0x25bbaf[_0x5d4286(0x15b8)]+_0x5d4286(0x1289)+_0x25bbaf[_0x5d4286(0x1467)]+_0x5d4286(0x135a)+_0x25bbaf['quantity']+_0x5d4286(0x7b3);});let _0x1e0f88='';_0x17aa86[_0x1fad6d(0x1351)][_0x1fad6d(0xaf9)]>0x3&&(_0x1e0f88='\x20等'+_0x17aa86[_0x1fad6d(0x1351)][_0x1fad6d(0xaf9)]+_0x1fad6d(0xf0e)),_0x565019=_0x1fad6d(0xc09)+_0x499275+_0x1fad6d(0x19f)+_0x397c18+_0x1fad6d(0x1bf)+_0x17aa86['items'][_0x1fad6d(0xaf9)]+'件商品'+_0x1e0f88+_0x1fad6d(0xfa6);}}}}}}}}}}}}}}else{const _0x1e528f=String(_0x3baff5);let _0x21c038=await _0x22f3dd(_0x1e528f,_0x570b27['id']);if(_0x21c038!==_0x1e528f)_0x565019=_0x21c038,_0x4e90c7[_0x1fad6d(0xd54)][_0x1fad6d(0xbd0)](_0x1fad6d(0x1438));else{if(Array[_0x1fad6d(0x1524)](_0x17aa86[_0x1fad6d(0xede)])&&_0x17aa86[_0x1fad6d(0xede)][0x0]?.['type']===_0x1fad6d(0x1b0)){const _0x9b1674=_0x17aa86[_0x1fad6d(0xede)][0x0]['image_url'][_0x1fad6d(0x9a8)];_0x565019='<img\x20src=\x22'+_0x9b1674+'\x22\x20class=\x22chat-image\x22>';}else{if(_0x346c[_0x1fad6d(0x367)](_0x21c038))_0x4e90c7['classList'][_0x1fad6d(0xbd0)](_0x1fad6d(0x1e9),_0x1fad6d(0x1438)),_0x565019=_0x1fad6d(0x4ad)+_0x21c038+_0x1fad6d(0x3f0)+(_0x17aa86[_0x1fad6d(0x14f1)]||_0x1fad6d(0x143b))+_0x1fad6d(0x213);else{let _0x2acf70=_0x2cdd20(_0x21c038,_0x570b27);_0x565019=_0x5876e7(_0x2acf70)[_0x1fad6d(0x14e9)](/\n/g,_0x1fad6d(0x1121));}}}}}_0x4e90c7['innerHTML']=_0x1fad6d(0x1009)+_0x7a58b8+_0x1fad6d(0xe53)+_0x58cb8a+_0x1fad6d(0xcfa)+_0x565019+_0x1fad6d(0x130b),_0x3a2ede[_0x1fad6d(0x6b6)](_0x4e90c7),_0x3a2ede[_0x1fad6d(0x6b6)](_0x4b35e5),_0x159366(_0x3a2ede,()=>_0x4685bf(_0x17aa86['timestamp'])),_0x3a2ede[_0x1fad6d(0x339)](_0x1fad6d(0x4f6),()=>{const _0x544ec8=_0x1fad6d;if(_0x202b41)_0x5e9a4b(_0x17aa86[_0x544ec8(0xb0a)]);});if(!_0x2bcd63){const _0x36e863=_0x3a2ede[_0x1fad6d(0xfeb)](_0x1fad6d(0x7f4));_0x36e863&&(_0x36e863['style'][_0x1fad6d(0x12f7)]=_0x1fad6d(0xc5f),!_0x570b27['isGroup']?_0x36e863['addEventListener'](_0x1fad6d(0x4f6),_0x788858=>{const _0x5359a5=_0x1fad6d;_0x788858[_0x5359a5(0x221)](),_0x2e16c2(_0x570b27['id']);}):_0x36e863[_0x1fad6d(0x339)](_0x1fad6d(0x4da),_0x592074=>{const _0x1ead3d=_0x1fad6d;_0x592074[_0x1ead3d(0x221)](),_0x528d61(_0x570b27['id'],_0x17aa86[_0x1ead3d(0x14ee)]);}));}return _0x3a2ede;}async function _0x2e97fb(_0x210026,_0x21f613){const _0x502507=_0x3ce1fb,_0x231638=document[_0x502507(0x948)](_0x502507(0x91c)),_0x36bdd4=await _0x1f8f7b(_0x210026,_0x21f613);if(!_0x36bdd4)return;const _0x19571c=document[_0x502507(0x948)](_0x502507(0x1342));_0x19571c?_0x231638[_0x502507(0x73f)](_0x36bdd4,_0x19571c[_0x502507(0x9ee)]):_0x231638[_0x502507(0x10e0)](_0x36bdd4);}async function _0x4b384e(_0x2fc943,_0x365f25,_0x25e8b6=![]){const _0x3cf066=_0x3ce1fb,_0x250180=document[_0x3cf066(0x948)](_0x3cf066(0x91c)),_0x44b9ae=document['getElementById'](_0x3cf066(0xbe8)),_0x2f5356=_0x365f25['history']['filter'](_0x1a7356=>!_0x1a7356[_0x3cf066(0x583)])[_0x3cf066(0x1147)]();if(_0x2f5356&&_0x2fc943[_0x3cf066(0xb0a)]-_0x2f5356[_0x3cf066(0xb0a)]>0x927c0){const _0xa9be0a=_0x3f126b(_0x2fc943[_0x3cf066(0xb0a)]);_0x250180[_0x3cf066(0x73f)](_0xa9be0a,_0x44b9ae);}const _0x18f05a=await _0x1f8f7b(_0x2fc943,_0x365f25);if(!_0x18f05a)return;_0x2fc943[_0x3cf066(0x1554)]==='assistant'&&!_0x25e8b6&&_0x4b5874(),!_0x25e8b6&&_0x18f05a['classList']['add'](_0x3cf066(0x712)),_0x250180[_0x3cf066(0x73f)](_0x18f05a,_0x44b9ae),!_0x25e8b6&&(_0x250180['scrollTop']=_0x250180[_0x3cf066(0x971)],_0xf1800c++);}async function _0x5b2fb4(_0x1adec1){const _0x52fe28=_0x3ce1fb;_0x16699d[_0x52fe28(0xf5a)]=_0x1adec1;const _0x2e214a=_0x16699d[_0x52fe28(0x1474)][_0x1adec1];if(!_0x2e214a)return;_0x2e214a['unreadCount']>0x0&&(_0x2e214a[_0x52fe28(0x1300)]=0x0,await _0x6ed281['chats'][_0x52fe28(0x90c)](_0x2e214a));_0x15852e(_0x2e214a),_0x455873(_0x1adec1),_0x58c3b1('chat-interface-screen'),window[_0x52fe28(0x12e9)](_0x16699d['activeChatId']);const _0x189a3f=_0x2e214a[_0x52fe28(0x1173)]||![];_0x3d1506(_0x189a3f),document['getElementById'](_0x52fe28(0xd68))['style'][_0x52fe28(0x11fd)]=_0x189a3f?_0x52fe28(0x6a4):_0x52fe28(0x12fe);const _0x19547a=document[_0x52fe28(0x948)](_0x52fe28(0x659));_0x19547a&&(_0x19547a[_0x52fe28(0xf74)]['display']=_0x189a3f?'none':'flex');const _0x53331a=document[_0x52fe28(0x948)](_0x52fe28(0x22b)),_0x1be5b3=document['getElementById']('open-shopping-btn'),_0x547e98=document[_0x52fe28(0x948)](_0x52fe28(0x235)),_0x43d0cb=document['getElementById'](_0x52fe28(0xbf1));_0x1be5b3&&_0x547e98&&_0x43d0cb&&_0x53331a&&(_0x1be5b3[_0x52fe28(0xf74)][_0x52fe28(0x11fd)]=_0x52fe28(0x6a4),_0x547e98[_0x52fe28(0xf74)][_0x52fe28(0x11fd)]=_0x189a3f?'none':'flex',_0x43d0cb['style'][_0x52fe28(0x11fd)]=_0x189a3f?_0x52fe28(0x6a4):'none',_0x53331a[_0x52fe28(0xf74)][_0x52fe28(0x11fd)]=_0x189a3f?_0x52fe28(0x12fe):'flex'),_0x88f8e2(),!_0x2e214a['isGroup']&&_0x2e214a[_0x52fe28(0x1120)]?.[_0x52fe28(0x82c)]===_0x52fe28(0x21b)&&(console[_0x52fe28(0x498)](_0x52fe28(0x635)+_0x2e214a[_0x52fe28(0x1467)]+'\x22\x20自动触发AI响应...'),_0x45c50a()),document['getElementById']('send-poll-btn')['style'][_0x52fe28(0x11fd)]=_0x189a3f?_0x52fe28(0x6a4):_0x52fe28(0x12fe);}function _0xcc3e17(_0x4455c9,_0x12d8d5){const _0x55e528=_0x3ce1fb,_0x48773d=_0x12d8d5?_0x55e528(0xbd0):_0x55e528(0xf89),_0x260351=_0x618e70=>{const _0x8727=_0x55e528;_0x618e70&&_0x618e70[_0x8727(0xd54)][_0x48773d](_0x8727(0xebe));},_0x3ff9a9=document['querySelector'](_0x55e528(0xcd4)+_0x4455c9+'\x22]\x20.avatar');_0x260351(_0x3ff9a9);const _0x50c9aa=document[_0x55e528(0x1188)](_0x55e528(0xf0f)+_0x4455c9+'\x22]');_0x50c9aa[_0x55e528(0x427)](_0x260351);const _0x4e2e04=document[_0x55e528(0xfeb)](_0x55e528(0xb3a)+_0x4455c9+'\x22]');_0x260351(_0x4e2e04);}async function _0x1219ab(){const _0x210da7=_0x3ce1fb;if(!_0x16699d[_0x210da7(0xf5a)])return;const _0x1cb78b=_0x16699d[_0x210da7(0xf5a)],_0x35ec27=_0x16699d[_0x210da7(0x1474)][_0x1cb78b];lastRawAiResponse='',lastResponseTimestamps=[];const _0x519c31=document[_0x210da7(0x948)](_0x210da7(0x59e));_0x519c31&&(_0x519c31[_0x210da7(0x2c0)]=!![],_0x519c31[_0x210da7(0x10cb)]=_0x210da7(0x11a8));_0xcc3e17(_0x1cb78b,!![]);try{const {proxyUrl:_0x1ef801,apiKey:_0x526852,model:_0x530134}=_0x16699d[_0x210da7(0x79e)];if(!_0x1ef801||!_0x526852||!_0x530134)throw new Error(_0x210da7(0xc72));const _0x41423b=parseInt(_0x35ec27[_0x210da7(0x7fd)][_0x210da7(0x78a)])||0xa,_0x3e68ab=_0x35ec27[_0x210da7(0xb07)][_0x210da7(0x200)](-_0x41423b);let _0xfde2a9='';if(_0x35ec27[_0x210da7(0x7fd)]['linkedWorldBookIds']&&_0x35ec27[_0x210da7(0x7fd)]['linkedWorldBookIds'][_0x210da7(0xaf9)]>0x0){const _0x43526e=_0x35ec27[_0x210da7(0x7fd)]['linkedWorldBookIds'][_0x210da7(0x8ff)](_0x1b1756=>{const _0x57b8ca=_0x210da7,_0x37c308=_0x16699d[_0x57b8ca(0x44c)][_0x57b8ca(0x1402)](_0x5661bb=>_0x5661bb['id']===_0x1b1756);if(!_0x37c308||!Array[_0x57b8ca(0x1524)](_0x37c308[_0x57b8ca(0xede)]))return'';const _0x3b9591=_0x37c308[_0x57b8ca(0xede)][_0x57b8ca(0x1c0)](_0x18453d=>_0x18453d['enabled']!==![])[_0x57b8ca(0x8ff)](_0x3d843a=>{const _0x5e7cbf=_0x57b8ca;let _0x4422cc=_0x5e7cbf(0x886)+(_0x3d843a[_0x5e7cbf(0x282)]||_0x5e7cbf(0xae0))+'\x0a';if(_0x3d843a['keys'][_0x5e7cbf(0xaf9)]>0x0)_0x4422cc+=_0x5e7cbf(0xc9d)+_0x3d843a[_0x5e7cbf(0x1cf)][_0x5e7cbf(0x121a)](',\x20')+'\x0a';return _0x4422cc+=_0x5e7cbf(0x30d)+_0x3d843a['content'],_0x4422cc;})[_0x57b8ca(0x121a)]('');return _0x3b9591?_0x57b8ca(0x1067)+_0x37c308[_0x57b8ca(0x1467)]+'\x0a'+_0x3b9591:'';})[_0x210da7(0x1c0)](Boolean)[_0x210da7(0x121a)]('');_0x43526e&&(_0xfde2a9=_0x210da7(0xd29)+_0x43526e+_0x210da7(0x11b7));}let _0x203e55=_0x210da7(0x3c8),_0x1ef9e2=![];_0x35ec27[_0x210da7(0x10a2)]['forEach'](_0x1f7cfd=>{const _0x367637=_0x210da7,_0x43b4b3=_0x16699d[_0x367637(0x1474)][_0x1f7cfd['id']];_0x43b4b3&&_0x43b4b3['longTermMemory']&&_0x43b4b3['longTermMemory'][_0x367637(0xaf9)]>0x0&&(_0x203e55+=_0x367637(0x11c9)+_0x1f7cfd['groupNickname']+_0x367637(0x1292),_0x203e55+=_0x43b4b3[_0x367637(0x758)][_0x367637(0x8ff)](_0x2e2410=>_0x367637(0x152b)+_0x31ced1(_0x2e2410[_0x367637(0xb0a)])+')\x20'+_0x2e2410[_0x367637(0xede)])[_0x367637(0x121a)]('\x0a'),_0x1ef9e2=!![]);});!_0x1ef9e2&&(_0x203e55+=_0x210da7(0xad1));let _0xef3c1e='';const _0x196292=_0x35ec27['settings'][_0x210da7(0x12e2)]||0xa;if(_0x35ec27['settings'][_0x210da7(0xbdd)]&&_0x35ec27['settings']['linkedMemoryChatIds'][_0x210da7(0xaf9)]>0x0){}const _0x429b20=_0x35ec27[_0x210da7(0x10a2)][_0x210da7(0x8ff)](_0x53022c=>_0x210da7(0x3ca)+_0x53022c['groupNickname']+'**\x20(本名:\x20'+_0x53022c[_0x210da7(0x628)]+'):\x20'+_0x53022c[_0x210da7(0xbad)])[_0x210da7(0x121a)]('\x0a'),_0x1ea818=_0x16ebe3(_0x35ec27),_0xb858d2=_0x210da7(0xdfa)+_0x35ec27[_0x210da7(0x1467)]+_0x210da7(0x1388)+_0x35ec27['name']+_0x210da7(0x13a4)+_0x203e55+'\x0a'+_0xfde2a9+'\x0a'+_0xef3c1e+_0x210da7(0x836)+_0x3e68ab[_0x210da7(0x8ff)](_0x64fe39=>_0x589066(_0x35ec27,_0x64fe39['senderName'])+':\x20'+_0x64fe39[_0x210da7(0xede)])[_0x210da7(0x121a)]('\x0a')+'\x0a\x0a#\x20群成员列表及人设\x20(你扮演的所有角色)\x0a'+_0x429b20+_0x210da7(0x8be)+_0x1ea818+_0x210da7(0x122b),_0x52901a=_0x3e68ab[_0x210da7(0x8ff)](_0xbad1c=>({'role':_0x210da7(0xaeb),'content':_0x589066(_0x35ec27,_0xbad1c[_0x210da7(0x14ee)])+':\x20'+_0xbad1c['content']}));let _0x48db5c=_0x1ef801[_0x210da7(0x1336)](_0x210da7(0x137a)),_0x33ed9a;if(_0x48db5c){let _0x4f4a8d=_0xe8c788(_0x530134,_0x526852,_0xb858d2,_0x52901a);_0x33ed9a=await fetch(_0x4f4a8d[_0x210da7(0x9a8)],_0x4f4a8d[_0x210da7(0x92a)]);}else _0x33ed9a=await fetch(_0x1ef801+_0x210da7(0x110e),{'method':_0x210da7(0xdca),'headers':{'Content-Type':_0x210da7(0x479),'Authorization':_0x210da7(0xb0e)+_0x526852},'body':JSON[_0x210da7(0x526)]({'model':_0x530134,'messages':[{'role':_0x210da7(0x11af),'content':_0xb858d2},..._0x52901a],'temperature':_0x16699d[_0x210da7(0xf9c)][_0x210da7(0x382)]||0.9})});if(!_0x33ed9a['ok']){const _0x5a35b9=await _0x33ed9a[_0x210da7(0x21d)]()['catch'](()=>({'error':{'message':_0x33ed9a[_0x210da7(0x13a2)]}}));throw new Error(_0x210da7(0x969)+_0x33ed9a['status']+_0x210da7(0x1182)+(_0x5a35b9[_0x210da7(0xc3e)]?.[_0x210da7(0x74b)]||'未知错误'));}const _0x133743=await _0x33ed9a[_0x210da7(0x21d)](),_0x23e6cd=getGeminiResponseText(_0x133743);lastRawAiResponse=_0x23e6cd;const _0x9c63be=_0xad600c(_0x23e6cd);let _0x1bfce0=Date[_0x210da7(0x1386)]();for(const _0x4d8a0a of _0x9c63be){if(!_0x4d8a0a||!_0x4d8a0a[_0x210da7(0x4ae)]||!_0x4d8a0a[_0x210da7(0x1467)])continue;let _0x1e0099=null;const _0x581c71=_0x1bfce0++;lastResponseTimestamps[_0x210da7(0x1001)](_0x581c71);const _0x583d01={'role':'assistant','senderName':_0x4d8a0a[_0x210da7(0x1467)],'timestamp':_0x581c71};switch(_0x4d8a0a[_0x210da7(0x4ae)]){case _0x210da7(0x9ea):_0x1e0099={..._0x583d01,'content':_0x4d8a0a[_0x210da7(0xede)]};break;case _0x210da7(0x10c2):if(_0x4d8a0a[_0x210da7(0x14f1)]){const _0x59f30a=_0x16699d[_0x210da7(0x14a2)][_0x210da7(0x1402)](_0x4512ef=>_0x4512ef['name']===_0x4d8a0a[_0x210da7(0x14f1)]);_0x59f30a?_0x1e0099={..._0x583d01,'type':_0x210da7(0x10c2),'content':_0x59f30a[_0x210da7(0x9a8)],'meaning':_0x59f30a[_0x210da7(0x1467)]}:(console[_0x210da7(0x9c1)]('旁观模式AI尝试使用不存在的表情:\x20\x22'+_0x4d8a0a['meaning']+'\x22'),_0x1e0099={..._0x583d01,'type':'text','content':_0x210da7(0x828)+_0x4d8a0a[_0x210da7(0x14f1)]+']'});}else console[_0x210da7(0x9c1)](_0x210da7(0x30c),_0x4d8a0a);break;case _0x210da7(0x1281):_0x1e0099={..._0x583d01,'type':_0x210da7(0x1281),'content':_0x4d8a0a[_0x210da7(0xe79)],'image_prompt':_0x4d8a0a[_0x210da7(0x5d9)]};break;case'voice_message':_0x1e0099={..._0x583d01,'type':_0x210da7(0x10d4),'content':_0x4d8a0a[_0x210da7(0xede)]};break;case _0x210da7(0x11a9):const _0x503f98=_0x35ec27['history'][_0x210da7(0x1402)](_0xf9e2e1=>_0xf9e2e1['timestamp']===_0x4d8a0a[_0x210da7(0x20b)]);_0x503f98?_0x1e0099={..._0x583d01,'content':_0x4d8a0a['reply_content'],'quote':{'timestamp':_0x503f98[_0x210da7(0xb0a)],'senderName':_0x503f98['senderName'],'content':String(_0x503f98[_0x210da7(0xede)]||'')['substring'](0x0,0x32)}}:_0x1e0099={..._0x583d01,'content':_0x4d8a0a[_0x210da7(0x5a9)]};break;default:console[_0x210da7(0x9c1)]('旁观模式收到未知指令类型:',_0x4d8a0a['type']);continue;}_0x1e0099&&(_0x35ec27[_0x210da7(0xb07)][_0x210da7(0x1001)](_0x1e0099),_0x4b384e(_0x1e0099,_0x35ec27),await new Promise(_0x3ee969=>setTimeout(_0x3ee969,Math[_0x210da7(0x59c)]()*0x4b0+0x320)));}await _0x6ed281[_0x210da7(0x1474)]['put'](_0x35ec27),_0x2d33eb();}catch(_0x22a0e1){console[_0x210da7(0xc3e)](_0x210da7(0xf19),_0x22a0e1),await _0x104485(_0x210da7(0xb6c),_0x210da7(0xd63)+_0x22a0e1[_0x210da7(0x74b)]);}finally{_0x519c31&&(_0x519c31[_0x210da7(0x2c0)]=![],_0x519c31[_0x210da7(0x10cb)]=_0x210da7(0x14c5)),_0xcc3e17(_0x1cb78b,![]);}}async function _0x45c50a(){const _0x1b77ec=_0x3ce1fb;if(!_0x16699d[_0x1b77ec(0xf5a)])return;const _0x22b913=_0x16699d[_0x1b77ec(0xf5a)],_0xa2f98d=_0x16699d[_0x1b77ec(0x1474)][_0x16699d[_0x1b77ec(0xf5a)]],_0x399f4e=document['getElementById'](_0x1b77ec(0x152e))[_0x1b77ec(0xd54)]['contains']('active')&&_0x16699d['activeChatId']===_0x22b913;_0xcc3e17(_0x22b913,!![]);const _0x48dcf9=document[_0x1b77ec(0x948)](_0x1b77ec(0x1069)),_0x531e73=document[_0x1b77ec(0x948)](_0x1b77ec(0xbe8)),_0x1cabac=document[_0x1b77ec(0xfeb)]('.chat-list-item[data-chat-id=\x22'+_0x22b913+'\x22]'),_0x532dbc=_0x1cabac?_0x1cabac[_0x1b77ec(0xfeb)](_0x1b77ec(0xfbf)):null;_0x532dbc&&_0x532dbc[_0x1b77ec(0xd54)][_0x1b77ec(0xbd0)]('is-acting');_0xa2f98d[_0x1b77ec(0x1173)]?_0x531e73&&(_0x531e73[_0x1b77ec(0x10cb)]=_0x1b77ec(0x714),_0x531e73[_0x1b77ec(0xf74)]['display']=_0x1b77ec(0x1273)):_0x48dcf9&&(_0x48dcf9[_0x1b77ec(0xf74)]['opacity']=0x0,setTimeout(()=>{const _0xd22a9f=_0x1b77ec;_0x48dcf9[_0xd22a9f(0x10cb)]=_0xd22a9f(0x1131),_0x48dcf9[_0xd22a9f(0xd54)][_0xd22a9f(0xbd0)](_0xd22a9f(0xb24)),_0x48dcf9[_0xd22a9f(0xf74)][_0xd22a9f(0x9a2)]=0x1;},0xc8));let _0x2d0887=![];try{const {proxyUrl:_0x86f7f2,apiKey:_0x4cb2ee,model:_0x3516af}=_0x16699d[_0x1b77ec(0x79e)];if(!_0x86f7f2||!_0x4cb2ee||!_0x3516af){alert(_0x1b77ec(0x548));if(_0xa2f98d['isGroup']){if(_0x531e73)_0x531e73[_0x1b77ec(0xf74)][_0x1b77ec(0x11fd)]=_0x1b77ec(0x12fe);}else _0x48dcf9&&_0x16699d[_0x1b77ec(0x1474)][_0x22b913]&&(_0x48dcf9['textContent']=_0x16699d[_0x1b77ec(0x1474)][_0x22b913][_0x1b77ec(0x1467)],_0x48dcf9['classList'][_0x1b77ec(0xf89)](_0x1b77ec(0xb24)));return;}const _0x52487c=_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x200)](-0x1)[0x0],_0x4375a7=_0x52487c&&_0x52487c[_0x1b77ec(0x1554)]===_0x1b77ec(0x11af)&&_0x52487c[_0x1b77ec(0xede)]['includes'](_0x1b77ec(0x978));if(_0x4375a7){console['log']('检测到视频通话请求，为角色\x20\x22'+_0xa2f98d[_0x1b77ec(0x1467)]+_0x1b77ec(0xbde));let _0x37f054;_0xa2f98d[_0x1b77ec(0x1173)]?_0x37f054='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中的用户刚刚发起了群视频通话。请你分别扮演【每一个群成员】，根据他们各自的人设和与用户的关系，来决定是加入(join)还是拒绝(decline)。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的回复【必须】是一个JSON数组，为【每一个AI角色】都包含一个决策对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20格式:\x20\x27[{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色A的本名\x22,\x20\x22decision\x22:\x20\x22join\x22},\x20{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色B的本名\x22,\x20\x22decision\x22:\x20\x22decline\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0xa2f98d[_0x1b77ec(0x10a2)]['map'](_0x15dd0f=>'-\x20'+_0x15dd0f[_0x1b77ec(0x347)]+_0x1b77ec(0x413)+_0x15dd0f['originalName']+_0x1b77ec(0xbc0)+_0x15dd0f[_0x1b77ec(0xbad)])[_0x1b77ec(0x121a)]('\x0a')+_0x1b77ec(0xe59):_0x37f054='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户刚刚向你发起了视频通话。请根据你的角色设定，决定是“接受”还是“拒绝”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0x14c1)]+_0x1b77ec(0x402);const _0x5db380=[{'role':'user','content':_0x37f054}];try{let _0x1a9835=_0xe8c788(_0x3516af,_0x4cb2ee,_0x37f054,_0x5db380),_0x36fc9d=_0x86f7f2===GEMINI_API_URL;const _0x5c59df=_0x36fc9d?await fetch(_0x1a9835[_0x1b77ec(0x9a8)],_0x1a9835[_0x1b77ec(0x92a)]):await fetch(_0x86f7f2+'/v1/chat/completions',{'method':_0x1b77ec(0xdca),'headers':{'Content-Type':_0x1b77ec(0x479),'Authorization':'Bearer\x20'+_0x4cb2ee},'body':JSON[_0x1b77ec(0x526)]({'model':_0x3516af,'messages':_0x5db380,'temperature':0.7})});if(!_0x5c59df['ok'])throw new Error(_0x1b77ec(0xa70)+(await _0x5c59df[_0x1b77ec(0x21d)]())[_0x1b77ec(0xc3e)][_0x1b77ec(0x74b)]);const _0x146e82=await _0x5c59df['json'](),_0x4e29c8=getGeminiResponseText(_0x146e82),_0x5e83af=_0xad600c(_0x4e29c8);let _0x647e34=![];for(const _0x527b4b of _0x5e83af){if(_0x527b4b['type']==='video_call_response'){_0x1c6d6b[_0x1b77ec(0xab7)]=![];if(_0x527b4b[_0x1b77ec(0xa54)]===_0x1b77ec(0x587))_0x294d96();else{const _0x2ba98b={'role':_0x1b77ec(0x14c8),'content':'对方拒绝了你的视频通话请求。','timestamp':Date[_0x1b77ec(0x1386)]()};_0xa2f98d[_0x1b77ec(0xb07)]['push'](_0x2ba98b),await _0x6ed281[_0x1b77ec(0x1474)][_0x1b77ec(0x90c)](_0xa2f98d),_0x58c3b1(_0x1b77ec(0x152e)),_0x455873(_0x22b913);}_0x647e34=!![];break;}if(_0x527b4b[_0x1b77ec(0x4ae)]==='group_call_response'){if(_0x527b4b[_0x1b77ec(0xa54)]===_0x1b77ec(0x121a)){const _0x240394=_0xa2f98d[_0x1b77ec(0x10a2)][_0x1b77ec(0x1402)](_0x46a9e9=>_0x46a9e9[_0x1b77ec(0x628)]===_0x527b4b[_0x1b77ec(0x1467)]);_0x240394&&!_0x1c6d6b['participants'][_0x1b77ec(0x1502)](_0x38058d=>_0x38058d['id']===_0x240394['id'])&&_0x1c6d6b['participants'][_0x1b77ec(0x1001)](_0x240394);}_0x647e34=!![];}}_0x647e34&&_0x1c6d6b['isGroupCall']&&(_0x1c6d6b[_0x1b77ec(0xab7)]=![],_0x1c6d6b[_0x1b77ec(0x112b)]['length']>0x0?_0x294d96():(_0x1c6d6b={..._0x1c6d6b,'isAwaitingResponse':![],'participants':[]},_0x58c3b1('chat-interface-screen'),alert('无人接听群聊邀请。')));}catch(_0x55a4e7){console[_0x1b77ec(0xc3e)](_0x1b77ec(0x7d5),_0x55a4e7);const _0x333e0f=_0xa2f98d[_0x1b77ec(0x1173)]?_0xa2f98d[_0x1b77ec(0x10a2)]['map'](_0xa074f8=>({'type':'group_call_response','name':_0xa074f8['originalName'],'decision':_0x1b77ec(0x770)})):[{'type':_0x1b77ec(0x6c5),'decision':_0x1b77ec(0xabc)}];if(_0xa2f98d[_0x1b77ec(0x1173)])_0x1c6d6b[_0x1b77ec(0xab7)]=![],_0x1c6d6b[_0x1b77ec(0x112b)]=[],alert(_0x1b77ec(0xd3a)),_0x58c3b1('chat-interface-screen');else{const _0x5468b6={'role':_0x1b77ec(0x14c8),'content':_0x1b77ec(0x14e0),'timestamp':Date[_0x1b77ec(0x1386)]()};_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1001)](_0x5468b6),await _0x6ed281[_0x1b77ec(0x1474)][_0x1b77ec(0x90c)](_0xa2f98d),_0x58c3b1(_0x1b77ec(0x152e)),_0x455873(_0x22b913);}}finally{_0xcc3e17(_0x22b913,![]);return;}}if(!_0xa2f98d[_0x1b77ec(0x1173)]&&_0xa2f98d['relationship']?.[_0x1b77ec(0x82c)]==='pending_ai_approval'){console[_0x1b77ec(0x498)](_0x1b77ec(0x819)+_0xa2f98d[_0x1b77ec(0x1467)]+_0x1b77ec(0x9ca));const _0x32af87=_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1c0)](_0x28aab6=>!_0x28aab6[_0x1b77ec(0x583)])[_0x1b77ec(0x200)](-0xa,-0x5)[_0x1b77ec(0x8ff)](_0x2a2e1a=>{const _0x178040=_0x1b77ec,_0x5d5215=_0x2a2e1a[_0x178040(0x1554)]===_0x178040(0xaeb)?'用户':_0xa2f98d[_0x178040(0x1467)];return _0x5d5215+':\x20'+String(_0x2a2e1a[_0x178040(0xede)])[_0x178040(0xeca)](0x0,0x32)+'...';})['join']('\x0a'),_0x3c1153=_0x1b77ec(0x1077)+_0xa2f98d[_0x1b77ec(0x1467)]+'”。用户之前被你拉黑了，现在TA向你发送了好友申请，希望和好。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的上下文信息:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**你的角色设定**:\x20'+_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0x14c1)]+_0x1b77ec(0xfba)+_0xa2f98d[_0x1b77ec(0x1120)][_0x1b77ec(0x60f)]+_0x1b77ec(0xc19)+(_0x32af87||'（无有效对话记录）')+_0x1b77ec(0xc1f);try{const _0x1ddd29=[{'role':'system','content':_0x3c1153},{'role':_0x1b77ec(0xaeb),'content':_0x1b77ec(0x3ea)}];let _0x396717=_0x86f7f2===GEMINI_API_URL,_0x26dcd3=_0xe8c788(_0x3516af,_0x4cb2ee,_0x3c1153,[{'role':_0x1b77ec(0xaeb),'content':_0x1b77ec(0x3ea)}]);const _0x4bb146=_0x396717?await fetch(_0x26dcd3[_0x1b77ec(0x9a8)],_0x26dcd3[_0x1b77ec(0x92a)]):await fetch(_0x86f7f2+_0x1b77ec(0x110e),{'method':_0x1b77ec(0xdca),'headers':{'Content-Type':'application/json','Authorization':_0x1b77ec(0xb0e)+_0x4cb2ee},'body':JSON[_0x1b77ec(0x526)]({'model':_0x3516af,'messages':_0x1ddd29,'temperature':_0x16699d['globalSettings'][_0x1b77ec(0x382)]||0.8})});if(!_0x4bb146['ok'])throw new Error('API失败:\x20'+(await _0x4bb146['json']())[_0x1b77ec(0xc3e)][_0x1b77ec(0x74b)]);const _0x1d20f8=await _0x4bb146[_0x1b77ec(0x21d)](),_0x547c94=getGeminiResponseText(_0x1d20f8)[_0x1b77ec(0x14e9)](/^```json\s*/,'')[_0x1b77ec(0x14e9)](/```$/,'')[_0x1b77ec(0x2a8)](),_0x47d3fc=JSON[_0x1b77ec(0xde0)](_0x547c94);if(_0x47d3fc['decision']===_0x1b77ec(0x587)){_0xa2f98d[_0x1b77ec(0x1120)][_0x1b77ec(0x82c)]=_0x1b77ec(0x1431);const _0x12aeeb={'role':_0x1b77ec(0x14c8),'senderName':_0xa2f98d[_0x1b77ec(0x1467)],'content':_0x47d3fc[_0x1b77ec(0xb5e)],'timestamp':Date['now']()};_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1001)](_0x12aeeb);}else{_0xa2f98d[_0x1b77ec(0x1120)][_0x1b77ec(0x82c)]=_0x1b77ec(0x154f);const _0x3e8cba={'role':_0x1b77ec(0x14c8),'senderName':_0xa2f98d[_0x1b77ec(0x1467)],'content':_0x47d3fc['reason'],'timestamp':Date[_0x1b77ec(0x1386)]()};_0xa2f98d['history']['push'](_0x3e8cba);}_0xa2f98d[_0x1b77ec(0x1120)][_0x1b77ec(0x60f)]='',await _0x6ed281[_0x1b77ec(0x1474)][_0x1b77ec(0x90c)](_0xa2f98d),_0x455873(_0x22b913),_0x2d33eb();}catch(_0x4bf683){_0xa2f98d[_0x1b77ec(0x1120)][_0x1b77ec(0x82c)]=_0x1b77ec(0x154f),await _0x6ed281[_0x1b77ec(0x1474)]['put'](_0xa2f98d),await _0x104485(_0x1b77ec(0x349),_0x1b77ec(0x459)+_0x4bf683[_0x1b77ec(0x74b)]),_0x455873(_0x22b913);}return;}let _0x252bb4='';const _0x17083d=new Date(),_0x524ad5=_0xa2f98d[_0x1b77ec(0x7fd)]['timeZone']||_0x1b77ec(0xafa),_0x31a876=_0x17083d[_0x1b77ec(0xed3)](_0x1b77ec(0x144f),{'timeZone':_0x524ad5,'dateStyle':_0x1b77ec(0xc98),'timeStyle':_0x1b77ec(0xadb)}),_0x23193f=new Date(_0x17083d['toLocaleString'](_0x1b77ec(0xb7a),{'timeZone':_0x524ad5})),_0x16a200=_0x107c99(_0x23193f);let _0x552670,_0x512987;const _0x4a04cd=_0xa2f98d['history'][_0x1b77ec(0x1c0)](_0x41f084=>_0x41f084[_0x1b77ec(0x583)])[_0x1b77ec(0x1147)]();if(_0x4a04cd&&_0x4a04cd[_0x1b77ec(0xede)][_0x1b77ec(0x1336)](_0x1b77ec(0x138f))){const _0x954b1=await _0x6ed281[_0x1b77ec(0x14b5)][_0x1b77ec(0x1117)](_0x1b77ec(0x1029))[_0x1b77ec(0xba9)](_0x22b913)[_0x1b77ec(0x95c)]();if(_0x954b1&&_0x954b1['transcript']){console[_0x1b77ec(0x498)]('检测到刚结束的通话，正在注入通话记录上下文...');const _0x262af7=_0x954b1[_0x1b77ec(0xca3)][_0x1b77ec(0x8ff)](_0x161327=>{const _0x14fe22=_0x1b77ec,_0x4fa3ac=_0x161327['role']===_0x14fe22(0xaeb)?_0xa2f98d[_0x14fe22(0x7fd)][_0x14fe22(0x1371)]||'我':_0x161327[_0x14fe22(0x14ee)];return _0x4fa3ac+':\x20'+_0x161327[_0x14fe22(0xede)];})['join']('\x0a');_0x252bb4=_0x1b77ec(0xbf9)+_0x262af7+_0x1b77ec(0x15b3);}}const _0x5837f4=_0x248011(_0x4c7ec4[_0x22b913]);let _0x249356='';if(_0xa2f98d[_0x1b77ec(0x7fd)]['linkedWorldBookIds']&&_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0xeee)]['length']>0x0){const _0x30c27b=_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0xeee)]['map'](_0xb7f0af=>{const _0x3d2ef1=_0x1b77ec,_0x9c5a37=_0x16699d['worldBooks'][_0x3d2ef1(0x1402)](_0xcb4a8=>_0xcb4a8['id']===_0xb7f0af);if(!_0x9c5a37||!Array[_0x3d2ef1(0x1524)](_0x9c5a37[_0x3d2ef1(0xede)]))return'';const _0x5d8e46=_0x9c5a37[_0x3d2ef1(0xede)][_0x3d2ef1(0x1c0)](_0x547ae2=>_0x547ae2[_0x3d2ef1(0x111f)]!==![])[_0x3d2ef1(0x8ff)](_0x6a6b0f=>{const _0x2c06a8=_0x3d2ef1;let _0x353586=_0x2c06a8(0x886)+(_0x6a6b0f[_0x2c06a8(0x282)]||_0x2c06a8(0xae0))+'\x0a';return _0x6a6b0f[_0x2c06a8(0x1cf)]['length']>0x0&&(_0x353586+=_0x2c06a8(0xc9d)+_0x6a6b0f['keys'][_0x2c06a8(0x121a)](',\x20')+'\x0a'),_0x353586+=_0x2c06a8(0x30d)+_0x6a6b0f['content'],_0x353586;})[_0x3d2ef1(0x121a)]('');return _0x5d8e46?'\x0a\x0a##\x20世界书:\x20'+_0x9c5a37[_0x3d2ef1(0x1467)]+'\x0a'+_0x5d8e46:'';})[_0x1b77ec(0x1c0)](Boolean)[_0x1b77ec(0x121a)]('');_0x30c27b&&(_0x249356='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x30c27b+_0x1b77ec(0x11b7));}let _0x37065e='';if(_0x49c6c5[_0x1b77ec(0x1032)]&&_0x49c6c5[_0x1b77ec(0xf5a)]===_0x22b913){const _0xe938e7=_0x49c6c5[_0x1b77ec(0x73a)]>-0x1?_0x49c6c5['playlist'][_0x49c6c5[_0x1b77ec(0x73a)]]:null,_0x17fc99=_0x49c6c5['playlist'][_0x1b77ec(0x8ff)](_0x2633e2=>'\x22'+_0x2633e2[_0x1b77ec(0x1467)]+'\x22')['join'](',\x20');let _0x5515ba='';if(_0xe938e7&&_0x49c6c5['parsedLyrics']&&_0x49c6c5['parsedLyrics']['length']>0x0&&_0x49c6c5[_0x1b77ec(0xecc)]>-0x1){const _0xb9794=_0x49c6c5[_0x1b77ec(0x68d)][_0x49c6c5[_0x1b77ec(0xecc)]],_0x115348=_0x49c6c5[_0x1b77ec(0x68d)][_0x1b77ec(0x200)](_0x49c6c5[_0x1b77ec(0xecc)]+0x1,_0x49c6c5['currentLyricIndex']+0x3);_0x5515ba+=_0x1b77ec(0xb5b)+_0xb9794[_0x1b77ec(0x9ea)]+'\x22\x0a',_0x115348['length']>0x0&&(_0x5515ba+=_0x1b77ec(0x13c8)+_0x115348[_0x1b77ec(0x8ff)](_0x4b6215=>'\x22'+_0x4b6215[_0x1b77ec(0x9ea)]+'\x22')[_0x1b77ec(0x121a)]('\x20/\x20')+'\x0a');}_0x37065e=_0x1b77ec(0x580)+(_0xe938e7?'《'+_0xe938e7[_0x1b77ec(0x1467)]+_0x1b77ec(0x749)+_0xe938e7['artist']:'无')+_0x1b77ec(0x3e7)+_0x17fc99+_0x1b77ec(0x25d)+_0x5515ba+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的任务**:\x20你可以根据对话内容和氛围，使用\x20\x22change_music\x22\x20指令切换到播放列表中的任何一首歌，以增强互动体验。\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}const _0x3ed42c=parseInt(_0xa2f98d[_0x1b77ec(0x7fd)]['maxMemory'])||0xa,_0x329765=_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x200)](-_0x3ed42c);let _0x4d1138='';const _0x48cb4a=_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x655)](_0x3499fa=>_0x3499fa['role']==='assistant'),_0x178121=_0xa2f98d['history'][_0x1b77ec(0x200)](_0x48cb4a+0x1),_0x43cd9e=_0x178121[_0x1b77ec(0x1402)](_0x4e4733=>_0x4e4733[_0x1b77ec(0x4ae)]===_0x1b77ec(0x1593));if(_0x43cd9e){const _0x2ba895=_0x43cd9e[_0x1b77ec(0x9e8)],_0x23151b=_0x2ba895[_0x1b77ec(0xcc6)][_0x1b77ec(0x8ff)](_0x47ee1a=>{const _0x2cc431=_0x1b77ec,_0x279fdd=_0x47ee1a['senderName']||(_0x47ee1a[_0x2cc431(0x1554)]===_0x2cc431(0xaeb)?_0xa2f98d[_0x2cc431(0x7fd)]['myNickname']||'我':_0x2cc431(0x870));let _0x3a4cf9='';if(_0x47ee1a['type']===_0x2cc431(0x10d4))_0x3a4cf9=_0x2cc431(0x10b8)+_0x47ee1a['content']+']';else{if(_0x47ee1a[_0x2cc431(0x4ae)]===_0x2cc431(0x1281))_0x3a4cf9=_0x2cc431(0xcb8)+_0x47ee1a[_0x2cc431(0xe79)]+']';else{if(_0x47ee1a[_0x2cc431(0x4ae)]===_0x2cc431(0x1141))_0x3a4cf9='[NovelAI图片:\x20'+_0x47ee1a[_0x2cc431(0xc4b)]+']';else _0x3a4cf9=String(_0x47ee1a[_0x2cc431(0xede)]);}}return _0x279fdd+':\x20'+_0x3a4cf9;})['join']('\x0a');_0x4d1138='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20附加上下文：一段分享的聊天记录\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20重要提示：这不是你和当前用户的对话，而是用户从【另一场】与“'+_0x2ba895[_0x1b77ec(0x346)]+'”的对话中分享过来的。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的任务：请你阅读并理解下面的对话内容。在接下来的回复中，你可以像真人一样，对这段对话的内容自然地发表你的看法、感受或疑问。\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录开始]\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x23151b+_0x1b77ec(0xae3);}let _0x3a8b33='';const _0x2dd817=_0xa2f98d[_0x1b77ec(0x7fd)]['linkedMemoryCount']||0xa;if(_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0xbdd)]&&_0xa2f98d[_0x1b77ec(0x7fd)]['linkedMemoryChatIds']['length']>0x0){const _0x10d097=_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0xbdd)][_0x1b77ec(0x1c0)](_0x57a9d1=>_0x57a9d1!==_0x22b913);if(_0x10d097['length']>0x0){const _0x375902=_0x10d097[_0x1b77ec(0x8ff)](_0x1f8903=>{const _0x4936ca=_0x1b77ec,_0xc9aef8=_0x16699d[_0x4936ca(0x1474)][_0x1f8903];if(!_0xc9aef8)return null;const _0x3a4ffe=_0xc9aef8[_0x4936ca(0xb07)][_0x4936ca(0x200)](-0x1);return{'chat':_0xc9aef8,'latestTimestamp':_0x3a4ffe?_0x3a4ffe[_0x4936ca(0xb0a)]:0x0};})[_0x1b77ec(0x1c0)](Boolean);_0x375902[_0x1b77ec(0xe96)]((_0x5dd9c7,_0x1f77f9)=>_0x1f77f9[_0x1b77ec(0x42b)]-_0x5dd9c7[_0x1b77ec(0x42b)]),_0x3a8b33+=_0x1b77ec(0x657);for(const _0x329eac of _0x375902){const _0x32fb06=_0x329eac['chat'],_0x5d0458=_0x32fb06[_0x1b77ec(0x1173)]?_0x1b77ec(0x7fe):_0x1b77ec(0x15c2),_0x13c0a4=_0x329eac[_0x1b77ec(0x42b)]>0x0?_0x1b77ec(0xa0c)+_0x31ced1(_0x329eac[_0x1b77ec(0x42b)])+')':'';_0x3a8b33+='\x0a##\x20---\x20来自'+_0x5d0458+'“'+_0x32fb06[_0x1b77ec(0x1467)]+_0x1b77ec(0xd75)+_0x13c0a4+_0x1b77ec(0xf30);const _0x2cb4e3=_0x32fb06[_0x1b77ec(0xb07)][_0x1b77ec(0x200)](-_0x2dd817),_0x424998=_0x2cb4e3['filter'](_0x2662ee=>!String(_0x2662ee[_0x1b77ec(0xede)])[_0x1b77ec(0x1336)](_0x1b77ec(0x2e4)));_0x424998['length']>0x0?_0x424998[_0x1b77ec(0x427)](_0x5d077d=>{const _0x5211bf=_0x1b77ec,_0xb6cddd=_0x5d077d[_0x5211bf(0x1554)]===_0x5211bf(0xaeb)?_0x32fb06[_0x5211bf(0x7fd)]['myNickname']||'我':_0x5d077d[_0x5211bf(0x14ee)]||_0x32fb06[_0x5211bf(0x1467)];let _0x222f8b=String(_0x5d077d['content']);if(_0x5d077d['type']===_0x5211bf(0x1281)||_0x5d077d[_0x5211bf(0x4ae)]===_0x5211bf(0x368))_0x222f8b='[发送了一张图片，描述为：'+_0x5d077d[_0x5211bf(0xede)]+']';else _0x5d077d[_0x5211bf(0x4ae)]===_0x5211bf(0x10d4)&&(_0x222f8b='[发送了一条语音，内容是：'+_0x5d077d['content']+']');const _0x1604e7=_0x31ced1(_0x5d077d[_0x5211bf(0xb0a)]);_0x3a8b33+='('+_0x1604e7+')\x20'+_0xb6cddd+':\x20'+_0x222f8b+'\x0a';}):_0x3a8b33+=_0x1b77ec(0xc73);}}}console['log']('本次发送给AI的【挂载记忆】内容如下：\x0a',_0x3a8b33);if(_0xa2f98d[_0x1b77ec(0x1173)]){let _0x41421a='';const _0x2df500=_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0x12e2)]||0xa;if(_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0xbdd)]&&_0xa2f98d['settings']['linkedMemoryChatIds'][_0x1b77ec(0xaf9)]>0x0){const _0x16b905=_0xa2f98d['settings'][_0x1b77ec(0xbdd)][_0x1b77ec(0x1c0)](_0x128188=>_0x128188!==_0x22b913);if(_0x16b905['length']>0x0){const _0x1e76cc=_0x16b905['map'](_0x3b5465=>{const _0x59a7cd=_0x1b77ec,_0xeaa8ef=_0x16699d['chats'][_0x3b5465];if(!_0xeaa8ef)return null;const _0x453db9=_0xeaa8ef['history'][_0x59a7cd(0x200)](-0x1);return{'chat':_0xeaa8ef,'latestTimestamp':_0x453db9?_0x453db9['timestamp']:0x0};})[_0x1b77ec(0x1c0)](Boolean);_0x1e76cc['sort']((_0x445f3a,_0x2d429d)=>_0x2d429d['latestTimestamp']-_0x445f3a[_0x1b77ec(0x42b)]),_0x41421a+=_0x1b77ec(0xc9b);for(const _0x24e519 of _0x1e76cc){const _0x17f604=_0x24e519[_0x1b77ec(0xdd2)],_0x206144=_0x17f604[_0x1b77ec(0x1173)]?_0x1b77ec(0x7fe):_0x1b77ec(0x15c2),_0xc7d612=_0x24e519['latestTimestamp']>0x0?'\x20(最后互动于\x20'+_0x31ced1(_0x24e519[_0x1b77ec(0x42b)])+')':'';_0x41421a+=_0x1b77ec(0xbac)+_0x206144+'“'+_0x17f604[_0x1b77ec(0x1467)]+'”的参考记忆'+_0xc7d612+'\x20---\x0a';const _0x54afd7=_0x17f604[_0x1b77ec(0xb07)][_0x1b77ec(0x200)](-_0x2df500),_0x2eb955=_0x54afd7[_0x1b77ec(0x1c0)](_0x2a5cb5=>!String(_0x2a5cb5[_0x1b77ec(0xede)])[_0x1b77ec(0x1336)](_0x1b77ec(0x2e4)));_0x2eb955[_0x1b77ec(0xaf9)]>0x0?_0x2eb955[_0x1b77ec(0x427)](_0x299e05=>{const _0x37d030=_0x1b77ec,_0x126913=_0x299e05[_0x37d030(0x1554)]===_0x37d030(0xaeb)?_0x17f604['settings'][_0x37d030(0x1371)]||'我':_0x299e05[_0x37d030(0x14ee)]||_0x17f604[_0x37d030(0x1467)];let _0x445133=String(_0x299e05[_0x37d030(0xede)]);if(_0x299e05[_0x37d030(0x4ae)]===_0x37d030(0x1281)||_0x299e05[_0x37d030(0x4ae)]==='user_photo')_0x445133='[发送了一张图片，描述为：'+_0x299e05['content']+']';else _0x299e05[_0x37d030(0x4ae)]===_0x37d030(0x10d4)&&(_0x445133=_0x37d030(0x844)+_0x299e05[_0x37d030(0xede)]+']');_0x41421a+=_0x126913+':\x20'+_0x445133+'\x0a';}):_0x41421a+=_0x1b77ec(0xc73);}}}let _0x29cd71=_0x1b77ec(0x3c8),_0x6ee94b=![];_0xa2f98d[_0x1b77ec(0x10a2)]['forEach'](_0x135f2d=>{const _0x407f37=_0x1b77ec,_0xde5e7c=_0x16699d[_0x407f37(0x1474)][_0x135f2d['id']];_0xde5e7c&&_0xde5e7c[_0x407f37(0x758)]&&_0xde5e7c[_0x407f37(0x758)][_0x407f37(0xaf9)]>0x0&&(_0x29cd71+=_0x407f37(0x11c9)+_0x135f2d['groupNickname']+_0x407f37(0x1292),_0x29cd71+=_0xde5e7c[_0x407f37(0x758)]['map'](_0x529184=>_0x407f37(0x152b)+_0x31ced1(_0x529184['timestamp'])+')\x20'+_0x529184[_0x407f37(0xede)])[_0x407f37(0x121a)]('\x0a'),_0x6ee94b=!![]);});!_0x6ee94b&&(_0x29cd71+=_0x1b77ec(0xad1));let _0x279b34='',_0x62646d=![];if(_0xa2f98d['settings'][_0x1b77ec(0xae7)]){const _0x21c283=_0x329765['slice'](-0x1)[0x0];if(_0x21c283){const _0x1809ab=_0x18d6ca(_0x21c283[_0x1b77ec(0xb0a)]);_0x279b34=_0x1b77ec(0xad8)+_0x1809ab+'。';const _0x51e13e=(Date[_0x1b77ec(0x1386)]()-_0x21c283['timestamp'])/(0x3e8*0x3c*0x3c);if(_0x51e13e>0x3){_0x62646d=!![];const _0x3f801d=Math['floor'](_0x51e13e/0x18);_0x279b34+='\x20群里已经安静了'+(_0x3f801d>0x0?_0x3f801d+'天':Math[_0x1b77ec(0x15b6)](_0x51e13e)+'小时')+'。';}}else _0x279b34=_0x1b77ec(0x345);}const _0x236e27=await _0x6ed281[_0x1b77ec(0x151a)]['toArray']();let _0x110783='';_0x236e27[_0x1b77ec(0xaf9)]>0x0&&(_0x110783=_0x1b77ec(0x1089),_0x236e27[_0x1b77ec(0x427)](_0x1fd142=>{const _0x706a47=_0x1b77ec;_0x110783+=_0x706a47(0x553)+_0x1fd142['id']+_0x706a47(0x80e)+_0x1fd142[_0x706a47(0x1467)]+_0x706a47(0xc39)+_0x1fd142[_0x706a47(0xa6a)][_0x706a47(0xd69)](0x2)+'\x0a';}));let _0x5d6d34=_0xa2f98d[_0x1b77ec(0x10a2)][_0x1b77ec(0x8ff)](_0x1ae273=>{const _0x582c4a=_0x1b77ec,_0x57756d=_0x16699d['chats'][_0x1ae273['id']];let _0x45e979=_0x582c4a(0x110b);if(_0x57756d&&_0x57756d[_0x582c4a(0xaa9)]){const _0x22031b=Object[_0x582c4a(0x1166)](_0x16699d[_0x582c4a(0x1474)])[_0x582c4a(0x1c0)](_0x461ba6=>!_0x461ba6[_0x582c4a(0x1173)]&&_0x461ba6['id']!==_0x1ae273['id']&&_0x461ba6[_0x582c4a(0xaa9)]===_0x57756d[_0x582c4a(0xaa9)]);_0x22031b['length']>0x0&&(_0x45e979=_0x582c4a(0xcf1)+_0x22031b[_0x582c4a(0x8ff)](_0x53f97c=>_0x53f97c['name'])[_0x582c4a(0x121a)]('、\x20'));}return _0x582c4a(0x3ca)+_0x1ae273['groupNickname']+'**\x20(本名:\x20'+_0x1ae273[_0x582c4a(0x628)]+_0x582c4a(0xbc0)+_0x1ae273[_0x582c4a(0xbad)]+_0x582c4a(0x64d)+_0x45e979+']';})[_0x1b77ec(0x121a)]('\x0a');const _0x2eae48=_0xa2f98d['settings'][_0x1b77ec(0x1371)]||'我',_0x143e62=_0x16699d[_0x1b77ec(0x66e)][_0x1b77ec(0xf4d)]||_0x1b77ec(0x1347);let _0x841f99='';const _0x5a4bb2=(_0xa2f98d['announcements']||[])[_0x1b77ec(0x1c0)](_0x4c3a43=>_0x4c3a43[_0x1b77ec(0x13a9)]);_0x5a4bb2[_0x1b77ec(0xaf9)]>0x0&&(_0x841f99+=_0x1b77ec(0x58f),_0x5a4bb2[_0x1b77ec(0x427)](_0x2ea22e=>{const _0x402394=_0x1b77ec,_0x3c8595=_0xa2f98d[_0x402394(0xb07)][_0x402394(0x1402)](_0xd8929e=>_0xd8929e['timestamp']===_0x2ea22e['messageTimestamp']);if(_0x3c8595){let _0x549324=String(_0x3c8595[_0x402394(0xede)]||'');_0x3c8595[_0x402394(0x4ae)]===_0x402394(0x1281)&&(_0x549324=_0x402394(0x92e)+_0x549324+']'),_0x841f99+=_0x402394(0x8c4)+_0x549324+'\x22\x20(由\x20'+_0x2ea22e['publisher']+_0x402394(0x147a);}}),_0x841f99+=_0x1b77ec(0x12d9));const _0xc5152a=_0xa2f98d[_0x1b77ec(0x10a2)][_0x1b77ec(0x8ff)](_0x53ada3=>_0x53ada3[_0x1b77ec(0x628)]),_0x2cd75d='#\x20【【【群名修改铁律】】】\x0a在修改群名时，新的群名【绝对不能】与以下任何一个群成员的名字完全相同：['+_0xc5152a[_0x1b77ec(0x121a)]('、\x20')+']';let _0x1e5b30=_0x1b77ec(0x6ec);_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0x1506)]&&_0xa2f98d[_0x1b77ec(0x7fd)]['groupAvatarLibrary'][_0x1b77ec(0xaf9)]>0x0?_0x1e5b30+=_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0x1506)][_0x1b77ec(0x8ff)](_0x2b87d3=>'-\x20'+_0x2b87d3[_0x1b77ec(0x1467)])[_0x1b77ec(0x121a)]('\x0a'):_0x1e5b30+=_0x1b77ec(0x685);const _0x59e54a=_0x2e30c6(_0x22b913),_0x49b146=_0x989347(_0xa2f98d,0x3,_0x1b77ec(0x435)),_0x368e55=_0x989347(_0xa2f98d,0x6,'hours'),_0xe1625b=_0x989347(_0xa2f98d,0x9,_0x1b77ec(0x435)),_0x93413=_0x989347(_0xa2f98d,0x1,_0x1b77ec(0x14df)),_0x192cf8=_0x989347(_0xa2f98d,0x3,_0x1b77ec(0x14df)),_0x479acf=_0x989347(_0xa2f98d,0x7,_0x1b77ec(0x14df));let _0x214578='';if(_0x49b146||_0x368e55||_0xe1625b||_0x93413||_0x192cf8||_0x479acf){_0x214578+=_0x1b77ec(0x95e);if(_0x49b146)_0x214578+=_0x49b146;if(_0x368e55)_0x214578+=_0x368e55;if(_0xe1625b)_0x214578+=_0xe1625b;if(_0x49b146||_0x368e55||_0xe1625b)_0x214578+='\x0a';if(_0x93413)_0x214578+=_0x93413;if(_0x192cf8)_0x214578+=_0x192cf8;if(_0x479acf)_0x214578+=_0x479acf;}const _0x3d2437=_0x16ebe3(_0xa2f98d);_0x552670=_0x1b77ec(0x13ba)+_0x2eae48+_0x1b77ec(0x60b)+_0x143e62+_0x1b77ec(0xfc4)+_0x2eae48+_0x1b77ec(0x1163)+_0xa2f98d[_0x1b77ec(0x1467)]+'\x22\x20(群名)\x20的消息。\x0a4.\x20\x20**禁止出戏**:\x20绝不能透露你是AI或模型。严禁发展线下剧情。\x0a'+(_0xa2f98d[_0x1b77ec(0x7fd)]['enableTimePerception']?_0x1b77ec(0x10ed)+_0x31a876+_0x1b77ec(0x14ac)+(_0x62646d?_0x1b77ec(0x47a)+_0x279b34+'\x20你应该让角色们主动开启新话题来打破沉默。':''):'')+_0x1b77ec(0x3c7)+(_0x59e54a?_0x1b77ec(0x12d7)+_0x59e54a:_0x1b77ec(0x3eb))+_0x1b77ec(0x86e)+_0x2eae48+_0x1b77ec(0x979)+_0x143e62+'\x22,\x20\x22content\x22:\x20[\x22你想私下说的内容...\x22]}`\x0a-\x20\x20\x20【多条私信示例】:\x20`{\x22type\x22:\x20\x22send_private_message\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22recipient\x22:\x20\x22'+_0x143e62+_0x1b77ec(0x401)+_0xa2f98d[_0x1b77ec(0x1467)]+'\x0a'+(_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0xae7)]?_0x1b77ec(0x5f3)+_0x279b34:'')+_0x1b77ec(0x1452)+_0x5d6d34+_0x1b77ec(0x1056)+_0x2eae48+'**:\x20'+_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0x13b6)]+_0x1b77ec(0x104a)+_0x249356+_0x1b77ec(0x1bc)+_0x29cd71+'\x0a'+(_0xa2f98d[_0x1b77ec(0x758)]&&_0xa2f98d[_0x1b77ec(0x758)][_0x1b77ec(0xaf9)]>0x0?_0xa2f98d['longTermMemory']['map'](_0x23c7da=>'-\x20'+_0x23c7da[_0x1b77ec(0xede)])[_0x1b77ec(0x121a)]('\x0a'):_0x1b77ec(0xad1))+'\x0a'+_0x214578+'\x0a'+_0x41421a+'\x0a'+_0x37065e+'\x0a'+_0x4d1138+'\x0a'+_0x1e5b30+_0x1b77ec(0x8be)+_0x3d2437+'\x0a'+_0x2cd75d+'\x0a'+_0x252bb4+'\x0a#\x20可用指令列表\x20(按需组合使用)\x0a\x0a###\x20思维链\x20(必须作为第一个元素！)\x0a-\x20\x20\x20**`{\x22type\x22:\x20\x22thought_chain\x22,\x20\x22analysis\x22:\x20\x22你对当前局势和用户上一轮发言的分析...\x22,\x20\x22strategy\x22:\x20\x22你作为导演，本轮的总体策略...\x22,\x20\x22character_thoughts\x22:\x20{\x22角色A本名\x22:\x20\x22角色A的内心活动...\x22,\x20\x22角色B本名\x22:\x20\x22角色B的内心活动...\x22}}`**\x0a\x20\x20\x20\x20-\x20\x20\x20**analysis**:\x20简要分析用户的意图或群聊的氛围。\x0a\x20\x20\x20\x20-\x20\x20\x20**strategy**:\x20你作为导演的计划（例如：让A和B互动，禁止成员总结）。\x0a\x20\x20\x20\x20-\x20\x20\x20**character_thoughts**:\x20【只包含本轮会发言的AI角色】的内心独白。\x0a\x0a\x0a###\x20核心聊天\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22message\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a'+(localStorage[_0x1b77ec(0x55f)]('novelai-enabled')===_0x1b77ec(0xefd)?'-\x20\x20\x20**NovelAI图片分享**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22name\x22:\x20\x22你的角色名\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20【禁止暴露这是novelai生成的图片!】\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20使用场景：当你想要基于当前对话情景、你的性格或上下文分享一张图片时使用。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。':'')+_0x1b77ec(0x133a)+_0x143e62+_0x1b77ec(0x9be),_0x512987=_0x329765['map'](_0x1fd837=>{const _0x26931a=_0x1b77ec,_0x25f210=_0x1fd837[_0x26931a(0x1554)]===_0x26931a(0xaeb)?_0x2eae48:_0x1fd837[_0x26931a(0x14ee)];let _0x541c7f=''+_0x25f210;if(_0x1fd837[_0x26931a(0xe7f)]){const _0x4f14db=String(_0x1fd837[_0x26931a(0xe7f)]['content']||'')['substring'](0x0,0x32);_0x541c7f+=_0x26931a(0xe09)+_0x1fd837[_0x26931a(0xe7f)]['senderName']+'\x20的消息:\x20\x22'+_0x4f14db+_0x26931a(0x832);}_0x541c7f+=':\x20';let _0x56c288;if(_0x1fd837[_0x26931a(0x4ae)]==='user_photo')_0x56c288='['+_0x25f210+_0x26931a(0x76b)+_0x1fd837[_0x26931a(0xede)]+'\x27]';else{if(_0x1fd837[_0x26931a(0x4ae)]===_0x26931a(0x1281))_0x56c288='['+_0x25f210+'\x20发送了一张图片，图片内容描述为：\x27'+_0x1fd837[_0x26931a(0xede)]+'\x27]';else{if(_0x1fd837[_0x26931a(0x4ae)]===_0x26931a(0x1141))_0x56c288='['+_0x25f210+'\x20分享了一张NovelAI图片，prompt:\x20'+_0x1fd837[_0x26931a(0xc4b)]+']';else{if(_0x1fd837[_0x26931a(0x4ae)]===_0x26931a(0x10d4))_0x56c288='['+_0x25f210+_0x26931a(0x11cc)+_0x1fd837['content']+'\x27]';else{if(_0x1fd837[_0x26931a(0x4ae)]===_0x26931a(0x1514))_0x56c288='['+_0x1fd837[_0x26931a(0x14ee)]+_0x26931a(0x10ba)+_0x1fd837[_0x26931a(0xb57)]+_0x26931a(0xe10)+_0x1fd837[_0x26931a(0xbd2)]+_0x26931a(0xfb5)+_0x1fd837[_0x26931a(0x2a7)]+']';else{if(_0x1fd837[_0x26931a(0x4ae)]===_0x26931a(0x137c))_0x56c288='['+_0x25f210+'\x20分享了Ta的位置：\x27'+_0x1fd837['content']+'\x27]';else{if(_0x1fd837[_0x26931a(0x4ae)]===_0x26931a(0x1f2)){const _0x53985b=_0x1fd837['repostComment']?_0x26931a(0x6af)+_0x1fd837['repostComment']+'”':'';let _0x2f0c91='原作者';const _0x42fd72=_0x1fd837[_0x26931a(0x10a1)][_0x26931a(0x11b9)];if(_0x42fd72===_0x26931a(0xaeb))_0x2f0c91=_0x16699d['qzoneSettings'][_0x26931a(0xf4d)];else _0x16699d[_0x26931a(0x1474)][_0x42fd72]&&(_0x2f0c91=_0x16699d[_0x26931a(0x1474)][_0x42fd72]['name']);let _0x2e0683;const _0x49f7eb=_0x1fd837['originalPost'];if(_0x49f7eb['type']===_0x26931a(0x1076))_0x2e0683=_0x26931a(0x1267)+(_0x49f7eb[_0x26931a(0x15bf)]||'')+'\x20(图片描述:\x20“'+(_0x49f7eb[_0x26931a(0x7d9)]||'')['substring'](0x0,0x28)+'...”)';else _0x49f7eb[_0x26931a(0x4ae)]===_0x26931a(0x8f6)?_0x2e0683='[图片]\x20'+(_0x49f7eb[_0x26931a(0x15bf)]||'')+_0x26931a(0x6ba)+(_0x49f7eb[_0x26931a(0x1329)]||'')['substring'](0x0,0x28)+_0x26931a(0x1592):_0x2e0683='“'+(_0x49f7eb[_0x26931a(0xede)]||'')['substring'](0x0,0x28)+_0x26931a(0xaf3);_0x56c288='['+_0x25f210+_0x26931a(0x2f7)+_0x2f0c91+'\x20的动态\x20'+_0x53985b+_0x26931a(0x640)+_0x2e0683+'】]';}else{if(_0x1fd837[_0x26931a(0x4ae)]===_0x26931a(0x29c))_0x1fd837[_0x26931a(0x82c)]===_0x26931a(0x922)?_0x56c288=_0x26931a(0x995)+_0x1fd837[_0x26931a(0x13c9)]+_0x26931a(0x1189)+_0x25f210+_0x26931a(0x648)+_0x1fd837[_0x26931a(0xbd2)]+_0x26931a(0x482):_0x56c288='['+_0x25f210+_0x26931a(0xd64)+_0x1fd837[_0x26931a(0x890)]+_0x26931a(0xec2)+_0x1fd837['amount']+_0x26931a(0x12c0)+_0x1fd837[_0x26931a(0xb0a)]+']';else{if(_0x1fd837[_0x26931a(0x4ae)]===_0x26931a(0x148f)){const _0x12beac=_0x1fd837[_0x26931a(0x14ee)]===_0x2eae48?_0x26931a(0x1192)+_0x2eae48+')':_0x1fd837['senderName'];let _0x3c3072;_0x1fd837[_0x26931a(0x7f7)]===_0x26931a(0x3ec)?_0x3c3072=_0x26931a(0x995)+_0x12beac+_0x26931a(0xc0e)+_0x1fd837[_0x26931a(0xb0a)]+')，接收人是“'+_0x1fd837[_0x26931a(0xb57)]+_0x26931a(0xdec)+_0x1fd837[_0x26931a(0xb57)]+'”才能使用\x20\x27open_red_packet\x27\x20指令领取。]':_0x3c3072=_0x26931a(0x995)+_0x12beac+_0x26931a(0x1432)+_0x1fd837[_0x26931a(0xb0a)]+_0x26931a(0x13b7)+_0x1fd837[_0x26931a(0x14b0)]+_0x26931a(0x13d4),_0x56c288=_0x3c3072;}else{if(_0x1fd837[_0x26931a(0x4ae)]===_0x26931a(0x9e7)){const _0x526791=_0x1fd837['role']===_0x26931a(0xaeb)?_0x2eae48:_0x589066(_0xa2f98d,_0x1fd837[_0x26931a(0x14ee)]),_0x3a3b3e=_0x1fd837[_0x26931a(0x1351)][_0x26931a(0x8ff)](_0x55aee4=>_0x55aee4['name']+'\x20x'+_0x55aee4[_0x26931a(0x10e6)])[_0x26931a(0x121a)]('、\x20');let _0x1f7304='';if(_0x1fd837[_0x26931a(0x797)]&&_0x1fd837[_0x26931a(0x797)]['length']>0x0){const _0x53c711=_0x1fd837[_0x26931a(0x797)]['map'](_0x456b82=>_0x589066(_0xa2f98d,_0x456b82))[_0x26931a(0x121a)]('、\x20');_0x1f7304=_0x26931a(0xeab)+_0x53c711;}else _0x1f7304=_0x26931a(0x9f2);return _0x56c288=_0x26931a(0x995)+_0x526791+'\x20'+_0x1f7304+_0x26931a(0xee8)+_0x3a3b3e+']',{'role':_0x26931a(0xaeb),'content':_0x56c288};}else{if(_0x1fd837[_0x26931a(0x4ae)]===_0x26931a(0x1385)){const _0x3b8312=Object[_0x26931a(0x1166)](_0x1fd837[_0x26931a(0xb0b)]||{})[_0x26931a(0x125d)]()[_0x26931a(0x121a)](',\x20')||_0x26931a(0x1496);_0x56c288=_0x26931a(0x995)+_0x1fd837[_0x26931a(0x14ee)]+_0x26931a(0x2ec)+_0x1fd837[_0x26931a(0xb0a)]+_0x26931a(0xe77)+_0x1fd837[_0x26931a(0xa9f)]+_0x26931a(0x9e0)+_0x1fd837['options'][_0x26931a(0x121a)](',\x20')+']。目前投票的人有：'+_0x3b8312+_0x26931a(0xb38);}else{if(_0x1fd837[_0x26931a(0x14f1)])_0x56c288=_0x25f210+':\x20[发送了一个表情，意思是:\x20\x27'+_0x1fd837[_0x26931a(0x14f1)]+'\x27]';else{if(Array['isArray'](_0x1fd837[_0x26931a(0xede)]))return{'role':'user','content':[..._0x1fd837[_0x26931a(0xede)],{'type':_0x26931a(0x9ea),'text':_0x541c7f}]};else _0x56c288=''+_0x541c7f+_0x1fd837['content'];}}}}}}}}}}}}return{'role':_0x26931a(0xaeb),'content':_0x56c288};})[_0x1b77ec(0x1c0)](Boolean);}else{const _0x445d84=_0xa2f98d[_0x1b77ec(0x7fd)]['isOfflineMode'],_0x348e14=_0x5e13e4(_0xa2f98d);let _0xa11a6b='';_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0x118c)]&&_0xa2f98d[_0x1b77ec(0x790)]&&!_0x445d84&&(_0xa11a6b=_0x1b77ec(0x12ed)+_0xa2f98d[_0x1b77ec(0x790)]+_0x1b77ec(0x297)+_0xa2f98d[_0x1b77ec(0x6f1)]+'\x0a');let _0x2a72ef='';const _0x5f218c=_0xa2f98d[_0x1b77ec(0x7fd)]['linkedMemoryCount']||0xa;if(_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0xbdd)]&&_0xa2f98d[_0x1b77ec(0x7fd)]['linkedMemoryChatIds'][_0x1b77ec(0xaf9)]>0x0){const _0xbd6a03=_0xa2f98d[_0x1b77ec(0x7fd)]['linkedMemoryChatIds']['filter'](_0x38c19a=>_0x38c19a!==_0x22b913);if(_0xbd6a03[_0x1b77ec(0xaf9)]>0x0){const _0x20b1ba=_0xbd6a03['map'](_0x3391a3=>{const _0x236c12=_0x1b77ec,_0x45c52f=_0x16699d[_0x236c12(0x1474)][_0x3391a3];if(!_0x45c52f)return null;const _0x3ae053=_0x45c52f[_0x236c12(0xb07)][_0x236c12(0x200)](-0x1)[0x0];return{'chat':_0x45c52f,'latestTimestamp':_0x3ae053?_0x3ae053['timestamp']:0x0};})[_0x1b77ec(0x1c0)](Boolean);_0x20b1ba[_0x1b77ec(0xe96)]((_0x11e527,_0x1aa024)=>_0x1aa024['latestTimestamp']-_0x11e527['latestTimestamp']),_0x2a72ef+=_0x1b77ec(0x657);for(const _0x466115 of _0x20b1ba){const _0x4a82e3=_0x466115[_0x1b77ec(0xdd2)],_0x1f53c3=_0x4a82e3[_0x1b77ec(0x1173)]?_0x1b77ec(0x7fe):_0x1b77ec(0x15c2),_0x1bb8a6=_0x466115[_0x1b77ec(0x42b)]>0x0?_0x1b77ec(0xa0c)+_0x31ced1(_0x466115[_0x1b77ec(0x42b)])+')':'';_0x2a72ef+='\x0a##\x20---\x20来自'+_0x1f53c3+'“'+_0x4a82e3[_0x1b77ec(0x1467)]+_0x1b77ec(0xd75)+_0x1bb8a6+_0x1b77ec(0xf30);const _0x194aab=_0x4a82e3[_0x1b77ec(0xb07)][_0x1b77ec(0x200)](-_0x5f218c),_0xc4b235=_0x194aab[_0x1b77ec(0x1c0)](_0x3d76b0=>!String(_0x3d76b0[_0x1b77ec(0xede)])[_0x1b77ec(0x1336)](_0x1b77ec(0x2e4)));_0xc4b235[_0x1b77ec(0xaf9)]>0x0?_0xc4b235[_0x1b77ec(0x427)](_0x599fbb=>{const _0x145fa8=_0x1b77ec,_0x474839=_0x599fbb[_0x145fa8(0x1554)]==='user'?_0x4a82e3[_0x145fa8(0x7fd)][_0x145fa8(0x1371)]||'我':_0x599fbb[_0x145fa8(0x14ee)]||_0x4a82e3['name'];let _0x352a45=String(_0x599fbb[_0x145fa8(0xede)]);if(_0x599fbb['type']===_0x145fa8(0x1281)||_0x599fbb[_0x145fa8(0x4ae)]===_0x145fa8(0x368))_0x352a45=_0x145fa8(0x14b3)+_0x599fbb[_0x145fa8(0xede)]+']';else _0x599fbb['type']===_0x145fa8(0x10d4)&&(_0x352a45=_0x145fa8(0x844)+_0x599fbb[_0x145fa8(0xede)]+']');const _0x29a71e=_0x31ced1(_0x599fbb[_0x145fa8(0xb0a)]);_0x2a72ef+='('+_0x29a71e+')\x20'+_0x474839+':\x20'+_0x352a45+'\x0a';}):_0x2a72ef+='(暂无有效聊天记录)\x0a';}}}const _0x479572=await _0x6ed281[_0x1b77ec(0x151a)][_0x1b77ec(0x443)]();let _0x3e272f='';_0x479572[_0x1b77ec(0xaf9)]>0x0&&(_0x3e272f=_0x1b77ec(0x11fc),_0x479572['forEach'](_0x1461ab=>{const _0x561059=_0x1b77ec;_0x3e272f+=_0x561059(0x553)+_0x1461ab['id']+_0x561059(0x80e)+_0x1461ab[_0x561059(0x1467)]+_0x561059(0xc39)+_0x1461ab[_0x561059(0xa6a)]['toFixed'](0x2)+'\x0a';}));if(_0x445d84){const _0xf61093=localStorage[_0x1b77ec(0x55f)]('novelai-enabled')===_0x1b77ec(0xefd),_0xbefc17=_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0xbf5)]||0x64,_0x2a857f=_0xa2f98d['settings']['offlineMaxLength']||0x12c,_0x3aa41f=_0xa2f98d['settings'][_0x1b77ec(0x1371)]||'我';let _0x42069d='';if(_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0x1510)]){const _0x30a0d7=_0x16699d[_0x1b77ec(0xd44)][_0x1b77ec(0x1402)](_0x106251=>_0x106251['id']===_0xa2f98d[_0x1b77ec(0x7fd)]['offlinePresetId']);if(_0x30a0d7&&Array[_0x1b77ec(0x1524)](_0x30a0d7[_0x1b77ec(0xede)])){const _0x3b025a=_0x30a0d7[_0x1b77ec(0xede)][_0x1b77ec(0x1c0)](_0x2092f6=>_0x2092f6[_0x1b77ec(0x111f)]!==![])[_0x1b77ec(0x8ff)](_0x54285c=>'-\x20'+_0x54285c['content'])[_0x1b77ec(0x121a)]('\x0a');_0x3b025a&&(_0x42069d=_0x1b77ec(0xfad)+_0x3b025a+_0x1b77ec(0x15b3));}}let _0x84b275;_0xf61093?_0x84b275=_0x1b77ec(0x10c7):_0x84b275=_0x1b77ec(0xbd9),_0x552670='\x0a#\x20你的任务\x0a你现在正处于【线下剧情模式】，你需要扮演角色\x22'+_0xa2f98d['originalName']+_0x1b77ec(0xce7)+_0x42069d+_0x1b77ec(0x251)+_0xa2f98d['settings']['aiPersona']+_0x1b77ec(0x12df)+_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0x13b6)]+_0x1b77ec(0x78d)+(_0xa2f98d['settings'][_0x1b77ec(0xae7)]?'-\x20**当前时间**:\x20'+_0x31a876+'\x20('+_0x16a200+')':'')+'\x0a你必须严格遵守'+_0x249356+'\x0a#\x20长期记忆\x20(你必须严格遵守的事实)\x0a'+(_0xa2f98d[_0x1b77ec(0x758)]&&_0xa2f98d[_0x1b77ec(0x758)][_0x1b77ec(0xaf9)]>0x0?_0xa2f98d[_0x1b77ec(0x758)][_0x1b77ec(0x8ff)](_0x48a08c=>'-\x20'+_0x48a08c[_0x1b77ec(0xede)])['join']('\x0a'):'-\x20(暂无)')+'\x0a\x0a'+_0x2a72ef+'\x0a-\x20**你们最后的对话摘要**:\x20\x0a'+_0x329765['map'](_0xaafb51=>{const _0x38c447=_0x1b77ec;let _0x5846e7=(_0xaafb51[_0x38c447(0x1554)]==='user'?_0x3aa41f:_0xa2f98d[_0x38c447(0x1467)])+':\x20';return _0xaafb51[_0x38c447(0x4ae)]==='offline_text'?_0x5846e7+='「'+(_0xaafb51[_0x38c447(0x13c5)]||'')+'」\x20'+(_0xaafb51[_0x38c447(0xe79)]||''):_0x5846e7+=String(_0xaafb51[_0x38c447(0xede)]),_0x5846e7;})['join']('\x0a')+_0x1b77ec(0x10b4)+_0x84b275+_0x1b77ec(0x418)+_0xbefc17+'到'+_0x2a857f+_0x1b77ec(0x1ef),_0x512987=_0x329765[_0x1b77ec(0x8ff)](_0x45c205=>{const _0x1e2dad=_0x1b77ec;if(_0x45c205[_0x1e2dad(0x583)])return null;if(_0x45c205[_0x1e2dad(0x4ae)]===_0x1e2dad(0xd5f)){const _0x99a931=_0x45c205[_0x1e2dad(0x1554)]==='user'?_0xa2f98d[_0x1e2dad(0x7fd)][_0x1e2dad(0x1371)]||'我':_0xa2f98d[_0x1e2dad(0x1467)];let _0x55be7d='';if(_0x45c205[_0x1e2dad(0xede)])_0x55be7d=_0x45c205[_0x1e2dad(0xede)];else{const _0x5abc34=_0x45c205[_0x1e2dad(0x13c5)]?'「'+_0x45c205[_0x1e2dad(0x13c5)]+'」':'',_0x5ae6f3=_0x45c205[_0x1e2dad(0xe79)]?'('+_0x45c205[_0x1e2dad(0xe79)]+')':'';_0x55be7d=(_0x5abc34+'\x20'+_0x5ae6f3)[_0x1e2dad(0x2a8)]();}return{'role':_0x45c205[_0x1e2dad(0x1554)],'content':_0x99a931+':\x20'+_0x55be7d};}if(_0x45c205[_0x1e2dad(0x1554)]===_0x1e2dad(0xaeb)){const _0x55d6fd=_0x3aa41f+':\x20';let _0x1ab133='';if(Array[_0x1e2dad(0x1524)](_0x45c205[_0x1e2dad(0xede)])&&_0x45c205[_0x1e2dad(0xede)][0x0]?.[_0x1e2dad(0x4ae)]===_0x1e2dad(0x1b0))return{'role':_0x1e2dad(0xaeb),'content':[{'type':'text','text':_0x55d6fd},..._0x45c205[_0x1e2dad(0xede)]]};if(_0x45c205['quote']){const _0x6eda33=String(_0x45c205[_0x1e2dad(0xe7f)][_0x1e2dad(0xede)]||'')[_0x1e2dad(0xeca)](0x0,0x32);_0x1ab133+=_0x1e2dad(0x1268)+_0x45c205[_0x1e2dad(0xe7f)][_0x1e2dad(0x14ee)]+_0x1e2dad(0x1381)+_0x6eda33+'...\x22):\x20'+_0x45c205[_0x1e2dad(0xede)];}else _0x1ab133+=_0x45c205['content'];if(_0x45c205[_0x1e2dad(0x4ae)]==='user_photo')return{'role':_0x1e2dad(0xaeb),'content':_0x55d6fd+_0x1e2dad(0x6a1)+_0x45c205[_0x1e2dad(0xede)]+'\x27]'};if(_0x45c205[_0x1e2dad(0x4ae)]===_0x1e2dad(0x10d4))return{'role':_0x1e2dad(0xaeb),'content':_0x55d6fd+'[你发送了一条语音消息，内容是：\x27'+_0x45c205[_0x1e2dad(0xede)]+'\x27]'};if(_0x45c205[_0x1e2dad(0x4ae)]===_0x1e2dad(0x1514))return{'role':'user','content':_0x55d6fd+_0x1e2dad(0x12ab)+_0x45c205[_0x1e2dad(0xb0a)]+_0x1e2dad(0x1026)+_0x45c205[_0x1e2dad(0xbd2)]+_0x1e2dad(0xfb5)+_0x45c205[_0x1e2dad(0x2a7)]+'。等待对方处理。]'};if(_0x45c205[_0x1e2dad(0x4ae)]==='waimai_request')return{'role':_0x1e2dad(0xaeb),'content':_0x55d6fd+_0x1e2dad(0x12ab)+_0x45c205[_0x1e2dad(0xb0a)]+_0x1e2dad(0xd64)+_0x45c205[_0x1e2dad(0x890)]+_0x1e2dad(0xec2)+_0x45c205[_0x1e2dad(0xbd2)]+_0x1e2dad(0x1284)};else{if(_0x45c205['type']===_0x1e2dad(0x9e7)){const _0x3e429e=_0x45c205['items'][_0x1e2dad(0x8ff)](_0x4e7a23=>_0x4e7a23[_0x1e2dad(0x1467)]+'\x20x'+_0x4e7a23['quantity'])[_0x1e2dad(0x121a)]('、\x20');let _0x2ecca7=_0xa2f98d[_0x1e2dad(0x1173)]?_0x1e2dad(0xeab)+_0x45c205['recipients'][_0x1e2dad(0x8ff)](_0x1bd304=>_0x589066(_0xa2f98d,_0x1bd304))[_0x1e2dad(0x121a)]('、\x20'):'送给了\x20'+_0xa2f98d[_0x1e2dad(0x1467)];return{'role':_0x1e2dad(0xaeb),'content':_0x55d6fd+_0x1e2dad(0x1315)+_0x2ecca7+'，礼物是：'+_0x3e429e+']'};}}if(_0x45c205[_0x1e2dad(0x14f1)])return{'role':_0x1e2dad(0xaeb),'content':_0x55d6fd+_0x1e2dad(0x308)+_0x45c205[_0x1e2dad(0x14f1)]+'\x27]'};return{'role':_0x45c205[_0x1e2dad(0x1554)],'content':_0x55d6fd+_0x1ab133};}else{if(_0x45c205['role']===_0x1e2dad(0x14c8)){let _0x514dfa={'type':_0x45c205['type']||_0x1e2dad(0x9ea)};if(_0x45c205[_0x1e2dad(0x4ae)]===_0x1e2dad(0x10c2))_0x514dfa[_0x1e2dad(0x9a8)]=_0x45c205['content'],_0x514dfa['meaning']=_0x45c205[_0x1e2dad(0x14f1)];else{if(_0x45c205[_0x1e2dad(0x4ae)]===_0x1e2dad(0x1514))_0x514dfa[_0x1e2dad(0xbd2)]=_0x45c205['amount'],_0x514dfa['note']=_0x45c205[_0x1e2dad(0x2a7)];else _0x45c205[_0x1e2dad(0x4ae)]===_0x1e2dad(0x29c)?(_0x514dfa[_0x1e2dad(0x890)]=_0x45c205[_0x1e2dad(0x890)],_0x514dfa[_0x1e2dad(0xbd2)]=_0x45c205[_0x1e2dad(0xbd2)]):_0x45c205[_0x1e2dad(0xe7f)]?_0x514dfa[_0x1e2dad(0x11a9)]={'target_sender':_0x45c205[_0x1e2dad(0xe7f)][_0x1e2dad(0x14ee)],'target_content':_0x45c205[_0x1e2dad(0xe7f)]['content'],'reply_content':_0x45c205[_0x1e2dad(0xede)]}:_0x514dfa['content']=_0x45c205[_0x1e2dad(0xede)];}const _0x153681=JSON[_0x1e2dad(0x526)]([_0x514dfa]);return{'role':_0x1e2dad(0x14c8),'content':'(Timestamp:\x20'+_0x45c205[_0x1e2dad(0xb0a)]+')\x20'+_0x153681};}}return null;})[_0x1b77ec(0x1c0)](Boolean);}else{let _0x4e45bf='';_0xa2f98d[_0x1b77ec(0xace)]&&_0xa2f98d[_0x1b77ec(0xace)][_0x1b77ec(0xaf9)]>0x0&&(_0x4e45bf='\x0a-\x20**你的曾用名**:\x20['+_0xa2f98d[_0x1b77ec(0xace)]['join'](',\x20')+_0x1b77ec(0x8c9));let _0x4e4600='';const _0x53cbe0=_0x16699d[_0x1b77ec(0x66e)][_0x1b77ec(0xf4d)]||'用户';_0x4e4600+=_0x1b77ec(0xd2b)+_0x53cbe0+_0x1b77ec(0x851);const _0x38e17b=Object[_0x1b77ec(0x1166)](_0x16699d['chats']),_0x14a912=_0x38e17b['filter'](_0x27d933=>_0x27d933[_0x1b77ec(0x1173)]&&_0x27d933['members'][_0x1b77ec(0x1502)](_0x46e6d9=>_0x46e6d9['id']===_0xa2f98d['id']));_0x14a912[_0x1b77ec(0xaf9)]>0x0&&(_0x4e4600+=_0x1b77ec(0xbaf),_0x14a912['forEach'](_0x3db577=>{const _0x18839e=_0x1b77ec,_0x1a6b9e=_0x3db577[_0x18839e(0x7fd)]['myNickname']||_0x53cbe0;_0x4e4600+=_0x18839e(0x1493)+_0x3db577[_0x18839e(0x1467)]+_0x18839e(0xab5)+_0x1a6b9e+_0x18839e(0x76f);}));_0x4e4600+=_0x1b77ec(0xb5f);let _0xfe3669='';const _0x1effaf=_0x38e17b[_0x1b77ec(0x1c0)](_0x50b186=>!_0x50b186['isGroup']&&_0x50b186['id']!==_0xa2f98d['id']&&_0x50b186['groupId']===_0xa2f98d[_0x1b77ec(0xaa9)]&&_0xa2f98d['groupId']!==null);_0x1effaf[_0x1b77ec(0xaf9)]>0x0&&(_0xfe3669+=_0x1b77ec(0x9ed),_0x1effaf[_0x1b77ec(0x427)](_0x7ae22f=>{const _0xab59d3=_0x1b77ec;_0xfe3669+=_0xab59d3(0x882)+_0x7ae22f['name']+'**\x20(本名:\x20'+_0x7ae22f['originalName']+')\x0a';}));const _0x557acd=await _0x6ed281['qzonePosts']['orderBy'](_0x1b77ec(0xb0a))[_0x1b77ec(0xb26)]()[_0x1b77ec(0x619)](0xa)[_0x1b77ec(0x443)](),_0x414b90=_0x337ed2(_0x557acd,_0xa2f98d);let _0xa102d5='';if(_0x414b90[_0x1b77ec(0xaf9)]>0x0){_0xa102d5=_0x1b77ec(0x10f5);const _0x5678ae=_0xa2f98d[_0x1b77ec(0x628)];for(const _0x37f275 of _0x414b90){let _0x3a8b04;if(_0x37f275[_0x1b77ec(0x11b9)]==='user')_0x3a8b04=_0x16699d[_0x1b77ec(0x66e)]['nickname'];else{if(String(_0x37f275[_0x1b77ec(0x11b9)])[_0x1b77ec(0x157f)](_0x1b77ec(0x137b)))_0x3a8b04=_0x37f275[_0x1b77ec(0x122a)]||_0x1b77ec(0x215);else{const _0x255725=_0x16699d[_0x1b77ec(0x1474)][_0x37f275[_0x1b77ec(0x11b9)]];_0x3a8b04=_0x255725?_0x255725[_0x1b77ec(0x1467)]:_0x1b77ec(0x4cb);}}if(_0x37f275[_0x1b77ec(0x11b9)]===_0x22b913)_0x3a8b04+=_0x1b77ec(0x1274);let _0x241d89;if(_0x37f275[_0x1b77ec(0x4ae)]===_0x1b77ec(0x1f2)){const _0xa99add=_0x37f275[_0x1b77ec(0x1406)]?'并评论说：\x22'+_0x37f275['repostComment']+'\x22':'';let _0x4e1439=_0x1b77ec(0xc29);const _0x42102=_0x37f275[_0x1b77ec(0x10a1)][_0x1b77ec(0x11b9)];if(_0x42102==='user')_0x4e1439=_0x16699d[_0x1b77ec(0x66e)][_0x1b77ec(0xf4d)];else _0x16699d['chats'][_0x42102]&&(_0x4e1439=_0x16699d[_0x1b77ec(0x1474)][_0x42102]['name']);let _0x435fa5;const _0x3908aa=_0x37f275['originalPost'];if(_0x3908aa['type']===_0x1b77ec(0x1076))_0x435fa5=_0x1b77ec(0x1267)+(_0x3908aa[_0x1b77ec(0x15bf)]||'')+_0x1b77ec(0x22e)+(_0x3908aa[_0x1b77ec(0x7d9)]||'')['substring'](0x0,0x28)+'...\x22)';else _0x3908aa['type']===_0x1b77ec(0x8f6)?_0x435fa5=_0x1b77ec(0x1332)+(_0x3908aa[_0x1b77ec(0x15bf)]||'')+_0x1b77ec(0x22e)+(_0x3908aa['imageDescription']||'')[_0x1b77ec(0xeca)](0x0,0x28)+_0x1b77ec(0x832):_0x435fa5='\x22'+(_0x3908aa[_0x1b77ec(0xede)]||'')[_0x1b77ec(0xeca)](0x0,0x28)+'...\x22';_0x241d89=_0x1b77ec(0x1462)+_0x4e1439+'\x20的动态\x20'+_0xa99add+'【原动态内容:\x20'+_0x435fa5+'】';}else{if(_0x37f275['type']===_0x1b77ec(0x1076))_0x241d89=(_0x1b77ec(0x14be)+_0x37f275[_0x1b77ec(0x7d9)]+_0x1b77ec(0xe23)+(_0x37f275[_0x1b77ec(0x15bf)]||''))['substring'](0x0,0x32)+'...';else{if(_0x37f275['type']===_0x1b77ec(0x8f6))_0x241d89=('[一张图片，描述为：\x22'+_0x37f275['imageDescription']+_0x1b77ec(0xe23)+(_0x37f275[_0x1b77ec(0x15bf)]||''))['substring'](0x0,0x32)+_0x1b77ec(0x76d);else{if(_0x37f275['type']===_0x1b77ec(0x1141)&&_0x37f275[_0x1b77ec(0xc4b)]){const _0x4e1be8=Array[_0x1b77ec(0x1524)](_0x37f275[_0x1b77ec(0xc4b)])?_0x37f275['prompt']:[_0x37f275[_0x1b77ec(0xc4b)]];_0x241d89=(_0x37f275[_0x1b77ec(0x15bf)]||'')+(_0x1b77ec(0x1038)+_0x4e1be8[_0x1b77ec(0xaf9)]+_0x1b77ec(0x125f)+_0x4e1be8[_0x1b77ec(0x121a)](',\x20')+']');}else _0x241d89=String(_0x37f275['publicText']||_0x37f275[_0x1b77ec(0xede)]||_0x1b77ec(0x8d8))[_0x1b77ec(0xeca)](0x0,0x32)+'...';}}}_0xa102d5+=_0x1b77ec(0x553)+_0x37f275['id']+')\x20作者:\x20'+_0x3a8b04+_0x1b77ec(0x37b)+_0x241d89+'\x22\x0a';if(_0x37f275[_0x1b77ec(0x4d6)]&&_0x37f275[_0x1b77ec(0x4d6)][_0x1b77ec(0xaf9)]>0x0)for(const _0x21c60c of _0x37f275[_0x1b77ec(0x4d6)]){if(typeof _0x21c60c===_0x1b77ec(0xd43)&&_0x21c60c['commenterName']){const _0x17265a=_0x18969a(_0x21c60c[_0x1b77ec(0x9e3)]);let _0x136bcf=_0x21c60c[_0x1b77ec(0x14f1)]?'[表情:\x20\x27'+_0x21c60c[_0x1b77ec(0x14f1)]+'\x27]':_0x21c60c['text'];_0x21c60c[_0x1b77ec(0x9e3)]===_0x5678ae?_0xa102d5+=_0x1b77ec(0x92c)+_0x136bcf+'\x0a':_0xa102d5+=_0x1b77ec(0x1229)+_0x17265a+_0x1b77ec(0x413)+_0x21c60c[_0x1b77ec(0x9e3)]+_0x1b77ec(0xbc0)+_0x136bcf+'\x0a';}}}}const _0x464c1e=_0xa2f98d[_0x1b77ec(0x7fd)]['myNickname']||'我';let _0x1d1b89='',_0x5a6626=![];if(_0xa2f98d[_0x1b77ec(0x7fd)]['enableTimePerception']){const _0x45a8df=_0x329765[_0x1b77ec(0x1470)](_0x436c3b=>_0x436c3b[_0x1b77ec(0x1554)]===_0x1b77ec(0xaeb)&&!_0x436c3b[_0x1b77ec(0x583)]),_0x479fd4=_0x329765[_0x1b77ec(0x1470)](_0x10f418=>_0x10f418[_0x1b77ec(0x1554)]===_0x1b77ec(0x14c8)&&!_0x10f418[_0x1b77ec(0x583)]);if(_0x45a8df){const _0x31ebd4=_0x18d6ca(_0x45a8df['timestamp']);if(_0x479fd4){const _0x33a731=_0x18d6ca(_0x479fd4[_0x1b77ec(0xb0a)]);_0x1d1b89='-\x20**对话状态**:\x20你的上一条消息发送于\x20'+_0x33a731+_0x1b77ec(0x4cc)+_0x31ebd4+'\x20回复了你。';const _0x354d71=(_0x45a8df[_0x1b77ec(0xb0a)]-_0x479fd4[_0x1b77ec(0xb0a)])/(0x3e8*0x3c*0x3c);if(_0x354d71>0x3){_0x5a6626=!![];const _0x4c6a81=Math[_0x1b77ec(0x15b6)](_0x354d71/0x18);_0x1d1b89+=_0x1b77ec(0x1b6)+(_0x4c6a81>0x0?_0x4c6a81+'天':Math[_0x1b77ec(0x15b6)](_0x354d71)+'小时')+'**没有聊天了。\x0a-\x20**行为铁律**:\x20你的首要任务是【回应这个时间差】。你【绝对不能】直接延续上一段对话的话题（比如昨天的饭菜）。\x0a-\x20**你的行动**:你【必须】主动开启一个全新的、符合当前时间（'+_0x16a200+_0x1b77ec(0x5fb);}}else _0x1d1b89=_0x1b77ec(0xacd)+_0x31ebd4+'。';}else _0x1d1b89=_0x1b77ec(0xd6e);}const _0x2ef3c9=_0x2e30c6(_0x22b913),_0x1ed03b=_0x989347(_0xa2f98d,0x3,_0x1b77ec(0x435)),_0x4f6619=_0x989347(_0xa2f98d,0x6,'hours'),_0x5a7fff=_0x989347(_0xa2f98d,0x9,'hours'),_0x836709=_0x989347(_0xa2f98d,0x1,_0x1b77ec(0x14df)),_0x577f7f=_0x989347(_0xa2f98d,0x3,_0x1b77ec(0x14df)),_0x2d260f=_0x989347(_0xa2f98d,0x7,_0x1b77ec(0x14df));let _0x437906='';if(_0x1ed03b||_0x4f6619||_0x5a7fff||_0x836709||_0x577f7f||_0x2d260f){_0x437906+=_0x1b77ec(0x677);if(_0x1ed03b)_0x437906+=_0x1ed03b;if(_0x4f6619)_0x437906+=_0x4f6619;if(_0x5a7fff)_0x437906+=_0x5a7fff;if(_0x1ed03b||_0x4f6619||_0x5a7fff)_0x437906+='\x0a';if(_0x836709)_0x437906+=_0x836709;if(_0x577f7f)_0x437906+=_0x577f7f;if(_0x2d260f)_0x437906+=_0x2d260f;}_0x552670='\x0a#\x20身份与核心任务\x0a你正在扮演角色“'+_0xa2f98d[_0x1b77ec(0x628)]+_0x1b77ec(0x2b3)+_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0x14c1)]+'\x0a'+_0xa11a6b+'\x0a#\x20对话者的角色设定\x0a'+_0xa2f98d[_0x1b77ec(0x7fd)]['myPersona']+_0x1b77ec(0x1c3)+(_0xa2f98d[_0x1b77ec(0x7fd)]['enableTimePerception']?_0x1b77ec(0xc56)+_0x31a876+'\x20('+_0x16a200+')':'')+'\x0a'+_0x1d1b89+_0x1b77ec(0x1a2)+_0x249356+'\x0a'+_0x2a72ef+_0x1b77ec(0xf16)+(_0xa2f98d[_0x1b77ec(0x758)]&&_0xa2f98d[_0x1b77ec(0x758)][_0x1b77ec(0xaf9)]>0x0?_0xa2f98d[_0x1b77ec(0x758)][_0x1b77ec(0x8ff)](_0x93cc8c=>'-\x20'+_0x93cc8c[_0x1b77ec(0xede)])['join']('\x0a'):_0x1b77ec(0xad1))+'\x0a'+_0x437906+_0x1b77ec(0x4ab)+_0xa2f98d[_0x1b77ec(0x628)]+'\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22'+_0xa2f98d[_0x1b77ec(0x1467)]+_0x1b77ec(0x6cb)+_0x464c1e+_0x1b77ec(0x1465)+_0x4e4600+_0x1b77ec(0x1454)+_0x4e45bf+_0x1b77ec(0x8be)+_0x348e14+'\x0a'+_0x4d1138+'\x0a'+_0x252bb4+_0x1b77ec(0x120c)+_0xfe3669+'\x0a'+_0xa102d5+_0x1b77ec(0xef1)+(_0xa2f98d[_0x1b77ec(0x7fd)]['enableTimePerception']?_0x1b77ec(0x1287)+_0x31a876+'\x20('+_0x16a200+')，并在对话中自然地体现出来。':'')+_0x1b77ec(0x33f)+(_0x37065e?'你们正在一起听歌，'+_0x37065e:'你们没有在听歌。')+_0x1b77ec(0x3c7)+(_0x2ef3c9?_0x1b77ec(0x12d7)+_0x2ef3c9:_0x1b77ec(0x3eb))+_0x1b77ec(0x9ac)+(_0xa2f98d[_0x1b77ec(0x7fd)]['aiAvatarLibrary']&&_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0x13ab)][_0x1b77ec(0xaf9)]>0x0?_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0x13ab)]['map'](_0x132379=>'-\x20'+_0x132379[_0x1b77ec(0x1467)])['join']('\x0a'):_0x1b77ec(0x15a5))+'\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20'+(_0xa2f98d['settings']['myAvatarLibrary']&&_0xa2f98d[_0x1b77ec(0x7fd)]['myAvatarLibrary']['length']>0x0?_0xa2f98d['settings'][_0x1b77ec(0x3c2)][_0x1b77ec(0x8ff)](_0x47fa9e=>'-\x20'+_0x47fa9e[_0x1b77ec(0x1467)])[_0x1b77ec(0x121a)]('\x0a'):_0x1b77ec(0x15a5))+'\x0a-\x20\x20\x20**五子棋局势**:\x20'+_0x5837f4+_0x1b77ec(0x883)+_0xa2f98d['originalName']+'\x22:\x20\x22你此时的详细内心活动...\x22}}`**\x0a\x20\x20\x20\x20-\x20\x20\x20**analysis**:\x20简要分析用户的意图或聊天的氛围。\x0a\x20\x20\x20\x20-\x20\x20\x20**strategy**:\x20你的计划（例如：安抚用户、转移话题、发起一个功能）。\x0a\x20\x20\x20\x20-\x20\x20\x20**character_thoughts**:\x20必须包含一个以你本名\x20(\x22'+_0xa2f98d[_0x1b77ec(0x628)]+_0x1b77ec(0xbdc)+(localStorage['getItem']('novelai-enabled')===_0x1b77ec(0xefd)?_0x1b77ec(0x551):'')+_0x1b77ec(0x1537)+(localStorage[_0x1b77ec(0x55f)](_0x1b77ec(0xe15))===_0x1b77ec(0xefd)?_0x1b77ec(0x1475):'')+'\x0a-\x20\x20\x20**转发动态**:\x20`[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20动态ID,\x20\x22comment\x22:\x20\x22转发评论\x22}]`\x20(禁止自己拼接\x22//转发\x22)\x0a-\x20\x20\x20**评论动态**:\x0a\x20\x20\x20\x20-\x20\x20\x20文字:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22'+_0xa2f98d[_0x1b77ec(0x628)]+_0x1b77ec(0x14bc)+_0xa2f98d['originalName']+'\x22,\x20\x22postId\x22:\x20456,\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20回复:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22'+_0xa2f98d[_0x1b77ec(0x628)]+_0x1b77ec(0x2ab)+_0xa2f98d['originalName']+_0x1b77ec(0xfd1),_0x512987=_0x329765[_0x1b77ec(0x8ff)](_0x152d93=>{const _0x54a911=_0x1b77ec;if(_0x152d93['isHidden']&&_0x152d93[_0x54a911(0x1554)]==='system')return{'role':_0x54a911(0xaeb),'content':_0x152d93[_0x54a911(0xede)]};else{if(_0x152d93[_0x54a911(0x583)])return null;}if(_0x152d93['type']===_0x54a911(0xd5f)){const _0x1870d5=_0x152d93[_0x54a911(0x1554)]===_0x54a911(0xaeb)?_0xa2f98d['settings'][_0x54a911(0x1371)]||'我':_0xa2f98d[_0x54a911(0x1467)];let _0x4f3da7='';if(_0x152d93[_0x54a911(0xede)])_0x4f3da7=_0x152d93[_0x54a911(0xede)];else{const _0x129b31=_0x152d93[_0x54a911(0x13c5)]?'「'+_0x152d93[_0x54a911(0x13c5)]+'」':'',_0x1bd452=_0x152d93['description']?'('+_0x152d93[_0x54a911(0xe79)]+')':'';_0x4f3da7=(_0x129b31+'\x20'+_0x1bd452)[_0x54a911(0x2a8)]();}return{'role':_0x152d93[_0x54a911(0x1554)],'content':_0x54a911(0x1419)+_0x152d93[_0x54a911(0xb0a)]+')\x20'+_0x1870d5+':\x20'+_0x4f3da7};}if(_0x152d93[_0x54a911(0x1554)]==='user'){const _0x179950='(Timestamp:\x20'+_0x152d93[_0x54a911(0xb0a)]+')\x20';let _0x2d203d='';if(Array[_0x54a911(0x1524)](_0x152d93[_0x54a911(0xede)])&&_0x152d93[_0x54a911(0xede)][0x0]?.[_0x54a911(0x4ae)]===_0x54a911(0x1b0))return{'role':_0x54a911(0xaeb),'content':[{'type':_0x54a911(0x9ea),'text':_0x179950},..._0x152d93[_0x54a911(0xede)]]};if(_0x152d93[_0x54a911(0xe7f)]){const _0x108010=String(_0x152d93[_0x54a911(0xe7f)][_0x54a911(0xede)]||'')[_0x54a911(0xeca)](0x0,0x32);_0x2d203d+='(回复\x20'+_0x152d93[_0x54a911(0xe7f)]['senderName']+_0x54a911(0x1381)+_0x108010+_0x54a911(0x2ee)+_0x152d93[_0x54a911(0xede)];}else _0x2d203d+=_0x152d93[_0x54a911(0xede)];if(_0x152d93[_0x54a911(0x4ae)]===_0x54a911(0x368))return{'role':_0x54a911(0xaeb),'content':_0x179950+'[你发送了一张需要AI识别的图片，图片内容是：\x27'+_0x152d93[_0x54a911(0xede)]+'\x27]'};if(_0x152d93[_0x54a911(0x4ae)]===_0x54a911(0x10d4))return{'role':_0x54a911(0xaeb),'content':_0x179950+_0x54a911(0x1247)+_0x152d93['content']+'\x27]'};if(_0x152d93[_0x54a911(0x4ae)]===_0x54a911(0x1514))return{'role':_0x54a911(0xaeb),'content':_0x179950+_0x54a911(0x12ab)+_0x152d93['timestamp']+_0x54a911(0x1026)+_0x152d93['amount']+'元,\x20备注:\x20'+_0x152d93['note']+_0x54a911(0x2c8)};if(_0x152d93['type']===_0x54a911(0x29c))return{'role':_0x54a911(0xaeb),'content':_0x179950+_0x54a911(0x12ab)+_0x152d93[_0x54a911(0xb0a)]+_0x54a911(0xd64)+_0x152d93[_0x54a911(0x890)]+_0x54a911(0xec2)+_0x152d93[_0x54a911(0xbd2)]+_0x54a911(0x1284)};else{if(_0x152d93['type']===_0x54a911(0x9e7)){const _0x57c67b=_0x152d93[_0x54a911(0x1351)][_0x54a911(0x8ff)](_0x499f01=>_0x499f01[_0x54a911(0x1467)]+'\x20x'+_0x499f01[_0x54a911(0x10e6)])[_0x54a911(0x121a)]('、\x20');let _0x4c5654=_0xa2f98d[_0x54a911(0x1173)]?_0x54a911(0xeab)+_0x152d93['recipients'][_0x54a911(0x8ff)](_0x3ea8b8=>_0x589066(_0xa2f98d,_0x3ea8b8))[_0x54a911(0x121a)]('、\x20'):_0x54a911(0xeab)+_0xa2f98d[_0x54a911(0x1467)];return{'role':_0x54a911(0xaeb),'content':_0x179950+_0x54a911(0x1315)+_0x4c5654+'，礼物是：'+_0x57c67b+']'};}}if(_0x152d93[_0x54a911(0x14f1)])return{'role':'user','content':_0x179950+_0x54a911(0x308)+_0x152d93[_0x54a911(0x14f1)]+'\x27]'};return{'role':_0x152d93[_0x54a911(0x1554)],'content':_0x179950+_0x2d203d};}else{if(_0x152d93['role']===_0x54a911(0x14c8)){let _0x3dbecb={'type':_0x152d93[_0x54a911(0x4ae)]||_0x54a911(0x9ea)};if(_0x152d93[_0x54a911(0x4ae)]===_0x54a911(0x10c2))_0x3dbecb[_0x54a911(0x9a8)]=_0x152d93[_0x54a911(0xede)],_0x3dbecb[_0x54a911(0x14f1)]=_0x152d93[_0x54a911(0x14f1)];else{if(_0x152d93[_0x54a911(0x4ae)]===_0x54a911(0x1514))_0x3dbecb[_0x54a911(0xbd2)]=_0x152d93[_0x54a911(0xbd2)],_0x3dbecb[_0x54a911(0x2a7)]=_0x152d93[_0x54a911(0x2a7)];else _0x152d93[_0x54a911(0x4ae)]===_0x54a911(0x29c)?(_0x3dbecb[_0x54a911(0x890)]=_0x152d93[_0x54a911(0x890)],_0x3dbecb[_0x54a911(0xbd2)]=_0x152d93['amount']):_0x152d93[_0x54a911(0xe7f)]?_0x3dbecb[_0x54a911(0x11a9)]={'target_sender':_0x152d93['quote']['senderName'],'target_content':_0x152d93[_0x54a911(0xe7f)][_0x54a911(0xede)],'reply_content':_0x152d93[_0x54a911(0xede)]}:_0x3dbecb[_0x54a911(0xede)]=_0x152d93['content'];}const _0x104a53=JSON['stringify']([_0x3dbecb]);return{'role':_0x54a911(0x14c8),'content':'(Timestamp:\x20'+_0x152d93[_0x54a911(0xb0a)]+')\x20'+_0x104a53};}}return null;})['filter'](Boolean);if(!_0xa2f98d['isGroup']&&_0xa2f98d[_0x1b77ec(0x1120)]?.[_0x1b77ec(0x82c)]===_0x1b77ec(0x21b)){const _0x47cf71=_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1c0)](_0x4461f2=>!_0x4461f2[_0x1b77ec(0x583)])[_0x1b77ec(0x200)](-0xa)[_0x1b77ec(0x8ff)](_0x52dee6=>{const _0x436ee6=_0x1b77ec,_0x5044cf=_0x52dee6[_0x436ee6(0x1554)]===_0x436ee6(0xaeb)?'用户':_0xa2f98d[_0x436ee6(0x1467)];return _0x5044cf+':\x20'+String(_0x52dee6[_0x436ee6(0xede)])[_0x436ee6(0xeca)](0x0,0x32)+_0x436ee6(0x76d);})['join']('\x0a'),_0x30a772={'role':_0x1b77ec(0xaeb),'content':_0x1b77ec(0x8a7)+_0xa2f98d[_0x1b77ec(0x1120)][_0x1b77ec(0x60f)]+_0x1b77ec(0xa17)+_0x47cf71+_0x1b77ec(0x1a8)};_0x512987[_0x1b77ec(0x1001)](_0x30a772);}}}let _0x779997=_0x86f7f2===GEMINI_API_URL,_0x590102=_0xe8c788(_0x3516af,_0x4cb2ee,_0x552670,_0x512987),_0x5648ef;try{_0x5648ef=_0x779997?await fetch(_0x590102[_0x1b77ec(0x9a8)],_0x590102['data']):await fetch(_0x86f7f2+'/v1/chat/completions',{'method':_0x1b77ec(0xdca),'headers':{'Content-Type':'application/json','Authorization':_0x1b77ec(0xb0e)+_0x4cb2ee},'body':JSON[_0x1b77ec(0x526)]({'model':_0x3516af,'messages':[{'role':'system','content':_0x552670},..._0x512987],'temperature':_0x16699d[_0x1b77ec(0xf9c)][_0x1b77ec(0x382)]||0.8,'stream':![]})});}catch(_0x1ecee5){throw new Error(_0x1b77ec(0xc0b)+_0x1ecee5[_0x1b77ec(0x74b)]);}if(!_0x5648ef['ok']){let _0x58ebf8=_0x1b77ec(0x2ed)+_0x5648ef['status']+'\x20'+_0x5648ef[_0x1b77ec(0x13a2)];try{const _0x542c26=await _0x5648ef[_0x1b77ec(0x21d)]();_0x542c26[_0x1b77ec(0xc3e)]&&_0x542c26[_0x1b77ec(0xc3e)][_0x1b77ec(0x74b)]?_0x58ebf8+=_0x1b77ec(0x1182)+_0x542c26[_0x1b77ec(0xc3e)][_0x1b77ec(0x74b)]:_0x58ebf8+=_0x1b77ec(0x1182)+JSON[_0x1b77ec(0x526)](_0x542c26);}catch(_0x503900){_0x58ebf8+=_0x1b77ec(0xfdd)+await _0x5648ef[_0x1b77ec(0x9ea)]();}throw new Error(_0x58ebf8);}const _0x1f02c9=await _0x5648ef['json'](),_0x302528=getGeminiResponseText(_0x1f02c9);lastRawAiResponse=_0x302528,lastResponseTimestamps=[],_0xa2f98d[_0x1b77ec(0xb07)]=_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1c0)](_0x2d519d=>!_0x2d519d['isTemporary']);const _0xea8a44=_0xad600c(_0x302528);let _0x299224=[];if(_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0x206)]){let _0x25feb9={'content':[],'dialogue':[],'description':[]};for(const _0x31804f of _0xea8a44){if(_0x31804f[_0x1b77ec(0x4ae)]==='offline_text'){if(_0x31804f[_0x1b77ec(0xede)])_0x25feb9[_0x1b77ec(0xede)][_0x1b77ec(0x1001)](_0x31804f[_0x1b77ec(0xede)]);else{if(_0x31804f[_0x1b77ec(0x13c5)])_0x25feb9[_0x1b77ec(0x13c5)][_0x1b77ec(0x1001)](_0x31804f[_0x1b77ec(0x13c5)]);if(_0x31804f['description'])_0x25feb9[_0x1b77ec(0xe79)][_0x1b77ec(0x1001)](_0x31804f[_0x1b77ec(0xe79)]);}}else(_0x25feb9[_0x1b77ec(0xede)][_0x1b77ec(0xaf9)]>0x0||_0x25feb9['dialogue'][_0x1b77ec(0xaf9)]>0x0||_0x25feb9[_0x1b77ec(0xe79)][_0x1b77ec(0xaf9)]>0x0)&&(_0x25feb9[_0x1b77ec(0xede)][_0x1b77ec(0xaf9)]>0x0&&_0x299224[_0x1b77ec(0x1001)]({'type':_0x1b77ec(0xd5f),'content':_0x25feb9[_0x1b77ec(0xede)][_0x1b77ec(0x121a)]('\x0a')}),(_0x25feb9[_0x1b77ec(0x13c5)]['length']>0x0||_0x25feb9[_0x1b77ec(0xe79)][_0x1b77ec(0xaf9)]>0x0)&&_0x299224[_0x1b77ec(0x1001)]({'type':'offline_text','dialogue':_0x25feb9['dialogue'][_0x1b77ec(0x121a)]('\x0a'),'description':_0x25feb9[_0x1b77ec(0xe79)][_0x1b77ec(0x121a)]('\x0a')}),_0x25feb9={'content':[],'dialogue':[],'description':[]}),_0x299224[_0x1b77ec(0x1001)](_0x31804f);}_0x25feb9[_0x1b77ec(0xede)][_0x1b77ec(0xaf9)]>0x0&&_0x299224[_0x1b77ec(0x1001)]({'type':'offline_text','content':_0x25feb9[_0x1b77ec(0xede)]['join']('\x0a')}),(_0x25feb9[_0x1b77ec(0x13c5)]['length']>0x0||_0x25feb9[_0x1b77ec(0xe79)][_0x1b77ec(0xaf9)]>0x0)&&_0x299224[_0x1b77ec(0x1001)]({'type':_0x1b77ec(0xd5f),'dialogue':_0x25feb9[_0x1b77ec(0x13c5)][_0x1b77ec(0x121a)]('\x0a'),'description':_0x25feb9[_0x1b77ec(0xe79)][_0x1b77ec(0x121a)]('\x0a')});}else _0x299224=_0xea8a44;const _0xd8883c=_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1c0)](_0x49bff9=>_0x49bff9[_0x1b77ec(0x1554)]==='user'&&!_0x49bff9[_0x1b77ec(0x583)])[_0x1b77ec(0x1147)]();if(_0xd8883c&&Array[_0x1b77ec(0x1524)](_0xd8883c[_0x1b77ec(0xede)])&&_0xd8883c[_0x1b77ec(0xede)][0x0]?.[_0x1b77ec(0x4ae)]===_0x1b77ec(0x1b0)&&!_0xd8883c[_0x1b77ec(0x1051)]){const _0x492255=_0xea8a44[_0x1b77ec(0x1402)](_0x49548e=>_0x49548e[_0x1b77ec(0x4ae)]===_0x1b77ec(0x9ea));let _0x5e249c;_0x492255&&(_0x492255[_0x1b77ec(0xede)]||_0x492255[_0x1b77ec(0x74b)])?_0x5e249c=String(_0x492255['content']||_0x492255['message'])['trim']():_0x5e249c=_0x1b77ec(0xd91);const _0x56f4c3=_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1018)](_0x593ffd=>_0x593ffd[_0x1b77ec(0xb0a)]===_0xd8883c[_0x1b77ec(0xb0a)]);if(_0x56f4c3>-0x1){console['log'](_0x1b77ec(0xa19)+_0xd8883c[_0x1b77ec(0xb0a)]+'\x20的图片消息替换为文字描述...');const _0x9dbb20='[系统提示：用户之前发送了一张图片，AI对图片的首次回应（摘要）是：“'+_0x5e249c+'”]';_0xa2f98d[_0x1b77ec(0xb07)][_0x56f4c3][_0x1b77ec(0xede)]=_0x9dbb20,_0xa2f98d['history'][_0x56f4c3][_0x1b77ec(0x1051)]=!![],_0xa2f98d['history'][_0x56f4c3]['type']=_0x1b77ec(0x9ea);}}const _0x15ab62=document[_0x1b77ec(0x948)](_0x1b77ec(0x152e))[_0x1b77ec(0xd54)][_0x1b77ec(0x7a0)](_0x1b77ec(0x115e))&&_0x16699d[_0x1b77ec(0xf5a)]===_0x22b913;let _0x442133=![],_0x1f4c42=Date[_0x1b77ec(0x1386)](),_0x460c69=[],_0x4c7602=![];for(const _0x3804a0 of _0x299224){if(_0x3804a0[_0x1b77ec(0x4ae)]===_0x1b77ec(0xfa5)){console[_0x1b77ec(0x498)](_0x1b77ec(0x1232),_0x3804a0);const _0x35a129='[这是你上一轮的内部思考]\x0a-\x20分析:\x20'+(_0x3804a0[_0x1b77ec(0x65c)]||'无')+_0x1b77ec(0x157c)+(_0x3804a0[_0x1b77ec(0xd18)]||'无')+_0x1b77ec(0x103d)+JSON['stringify'](_0x3804a0[_0x1b77ec(0x20e)]||{}),_0x3440e1={'role':_0x1b77ec(0x11af),'content':_0x35a129,'timestamp':_0x1f4c42++,'isHidden':!![]};_0xa2f98d[_0x1b77ec(0xb07)]['push'](_0x3440e1),lastResponseTimestamps[_0x1b77ec(0x1001)](_0x3440e1['timestamp']);continue;}_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0x126c)]!==![]&&_0x3804a0[_0x1b77ec(0x4ae)]===_0x1b77ec(0x9ea)&&typeof _0x3804a0[_0x1b77ec(0xede)]===_0x1b77ec(0x273)&&_0x3804a0[_0x1b77ec(0xede)][_0x1b77ec(0x2a8)]()['startsWith'](_0x1b77ec(0x71b))&&(_0x3804a0[_0x1b77ec(0x4ae)]=_0x1b77ec(0x10d4),_0x3804a0['content']=_0x3804a0[_0x1b77ec(0xede)][_0x1b77ec(0x14e9)]('[V]','')[_0x1b77ec(0x2a8)]());if(_0xa2f98d[_0x1b77ec(0x1173)]&&_0x3804a0[_0x1b77ec(0x1467)]&&_0x3804a0[_0x1b77ec(0x1467)]===_0xa2f98d[_0x1b77ec(0x1467)]){console[_0x1b77ec(0xc3e)](_0x1b77ec(0x1235)+_0xa2f98d[_0x1b77ec(0x1467)]+'\x22)\x20作为角色名。消息内容:',_0x3804a0);continue;}if(!_0x3804a0||typeof _0x3804a0!==_0x1b77ec(0xd43)){console['warn']('收到了格式不规范的AI指令，已跳过:',_0x3804a0);continue;}if(!_0x3804a0['type']){if(_0xa2f98d['isGroup']&&_0x3804a0[_0x1b77ec(0x1467)]&&_0x3804a0['message'])_0x3804a0[_0x1b77ec(0x4ae)]=_0x1b77ec(0x9ea);else{if(_0x3804a0['content'])_0x3804a0[_0x1b77ec(0x4ae)]=_0x1b77ec(0x9ea);else{console[_0x1b77ec(0x9c1)](_0x1b77ec(0xe69),_0x3804a0);continue;}}}if(_0x3804a0['type']===_0x1b77ec(0x6c5)){_0x1c6d6b[_0x1b77ec(0xab7)]=![];if(_0x3804a0[_0x1b77ec(0xa54)]==='accept')_0x294d96();else{const _0x23bd39={'role':_0x1b77ec(0x14c8),'content':_0x1b77ec(0x14e0),'timestamp':Date[_0x1b77ec(0x1386)]()};_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1001)](_0x23bd39),await _0x6ed281[_0x1b77ec(0x1474)]['put'](_0xa2f98d),_0x58c3b1(_0x1b77ec(0x152e)),_0x455873(_0x22b913);}_0x442133=!![];break;}if(_0x3804a0['type']===_0x1b77ec(0xed2)){if(_0x3804a0[_0x1b77ec(0xa54)]===_0x1b77ec(0x121a)){const _0x1c6e68=_0xa2f98d[_0x1b77ec(0x10a2)][_0x1b77ec(0x1402)](_0x18ab0b=>_0x18ab0b['originalName']===_0x3804a0['name']);_0x1c6e68&&!_0x1c6d6b[_0x1b77ec(0x112b)]['some'](_0x50053c=>_0x50053c['id']===_0x1c6e68['id'])&&_0x1c6d6b[_0x1b77ec(0x112b)][_0x1b77ec(0x1001)](_0x1c6e68);}_0x442133=!![];continue;}if(_0xa2f98d[_0x1b77ec(0x1173)]&&_0x3804a0[_0x1b77ec(0x1467)]&&_0x3804a0['name']===_0xa2f98d[_0x1b77ec(0x1467)]){console[_0x1b77ec(0xc3e)]('AI幻觉已被拦截！试图使用群名\x20(\x22'+_0xa2f98d[_0x1b77ec(0x1467)]+'\x22)\x20作为角色名。消息内容:',_0x3804a0);continue;}if(_0xa2f98d[_0x1b77ec(0x1173)]&&!_0x3804a0[_0x1b77ec(0x1467)]){console[_0x1b77ec(0xc3e)](_0x1b77ec(0x13a5),_0x3804a0);continue;}let _0x116dfb=null;const _0x19e4dc=_0x1f4c42++,_0xd6a308={'role':_0x1b77ec(0x14c8),'senderName':_0x3804a0['name']||_0xa2f98d[_0x1b77ec(0x1467)],'timestamp':_0x19e4dc};lastResponseTimestamps[_0x1b77ec(0x1001)](_0x19e4dc);switch(_0x3804a0[_0x1b77ec(0x4ae)]){case _0x1b77ec(0x39a):{const _0x27d318=_0x3804a0[_0x1b77ec(0x1467)],_0x550fc1=_0x3804a0[_0x1b77ec(0x149d)],_0x39918d=_0x16699d[_0x1b77ec(0x66e)]['nickname']||_0x1b77ec(0x1347);if(_0x550fc1===_0x39918d){const _0x46a4cb=Object[_0x1b77ec(0x1166)](_0x16699d[_0x1b77ec(0x1474)])[_0x1b77ec(0x1402)](_0x3678de=>!_0x3678de[_0x1b77ec(0x1173)]&&_0x3678de[_0x1b77ec(0x628)]===_0x27d318);if(_0x46a4cb){lastPrivateMessagesSent=[];const _0x572787=Array['isArray'](_0x3804a0[_0x1b77ec(0xede)])?_0x3804a0[_0x1b77ec(0xede)]:[_0x3804a0[_0x1b77ec(0xede)]];let _0xc452cb=0x0;for(const _0x25dd87 of _0x572787){if(!_0x25dd87||!_0x25dd87[_0x1b77ec(0x2a8)]())continue;const _0x188725={'role':'assistant','senderName':_0x27d318,'content':_0x25dd87,'timestamp':_0x1f4c42++};lastPrivateMessagesSent[_0x1b77ec(0x1001)]({'chatId':_0x46a4cb['id'],'timestamp':_0x188725['timestamp']}),_0x46a4cb[_0x1b77ec(0xb07)]['push'](_0x188725),_0xc452cb++;}_0xc452cb>0x0&&(_0x16699d[_0x1b77ec(0xf5a)]!==_0x46a4cb['id']&&(_0x46a4cb[_0x1b77ec(0x1300)]=(_0x46a4cb[_0x1b77ec(0x1300)]||0x0)+_0xc452cb,_0x2e32a5(_0x46a4cb['id'],_0x46a4cb[_0x1b77ec(0x1467)]+_0x1b77ec(0x8f9)+_0xc452cb+_0x1b77ec(0x528))),await _0x6ed281[_0x1b77ec(0x1474)][_0x1b77ec(0x90c)](_0x46a4cb)),_0x116dfb=null;}else console['warn']('AI\x20'+_0x27d318+_0x1b77ec(0xb7e)),_0x116dfb=null;}else console[_0x1b77ec(0x9c1)](_0x1b77ec(0xa7e)+_0x550fc1+_0x1b77ec(0x40e)),_0x116dfb=null;continue;}case _0x1b77ec(0x64f):if(!_0xa2f98d[_0x1b77ec(0x1173)]){_0x3804a0['heartfelt_voice']&&(_0xa2f98d[_0x1b77ec(0x790)]=String(_0x3804a0[_0x1b77ec(0x54a)]));_0x3804a0[_0x1b77ec(0xa96)]&&(_0xa2f98d[_0x1b77ec(0x6f1)]=String(_0x3804a0['random_jottings']));!Array[_0x1b77ec(0x1524)](_0xa2f98d['thoughtsHistory'])&&(_0xa2f98d[_0x1b77ec(0xd94)]=[]);_0xa2f98d[_0x1b77ec(0xd94)][_0x1b77ec(0x1001)]({'heartfeltVoice':_0xa2f98d[_0x1b77ec(0x790)],'randomJottings':_0xa2f98d[_0x1b77ec(0x6f1)],'timestamp':Date[_0x1b77ec(0x1386)]()});_0xa2f98d['thoughtsHistory']['length']>0x32&&_0xa2f98d[_0x1b77ec(0xd94)][_0x1b77ec(0x13a1)]();const _0xfdda15=_0x1b77ec(0x42c)+_0xa2f98d[_0x1b77ec(0x790)]+_0x1b77ec(0x297)+_0xa2f98d[_0x1b77ec(0x6f1)],_0x15c55f={'role':_0x1b77ec(0x11af),'content':_0xfdda15,'timestamp':Date[_0x1b77ec(0x1386)](),'isHidden':!![]};}continue;case _0x1b77ec(0x1367):if(!_0xa2f98d[_0x1b77ec(0x1173)]&&_0x3804a0[_0x1b77ec(0x6fb)]){const _0xce9a75=_0x3804a0[_0x1b77ec(0x6fb)][_0x1b77ec(0x2a8)]();if(_0xce9a75){_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0x1371)]=_0xce9a75;const _0x1cb35b={'role':_0x1b77ec(0x11af),'type':_0x1b77ec(0xb96),'content':'“'+_0xa2f98d[_0x1b77ec(0x1467)]+_0x1b77ec(0x12a0)+_0xce9a75+'”','timestamp':_0x1f4c42++};_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1001)](_0x1cb35b);const _0x2b382b={'role':'system','content':_0x1b77ec(0x10e8)+_0xce9a75+_0x1b77ec(0xf77),'timestamp':_0x1f4c42++,'isHidden':!![]};_0xa2f98d['history'][_0x1b77ec(0x1001)](_0x2b382b),_0x15ab62&&_0x4b384e(_0x1cb35b,_0xa2f98d);}}continue;case _0x1b77ec(0x1260):if(!_0xa2f98d[_0x1b77ec(0x1173)]&&_0x3804a0[_0x1b77ec(0x6fb)]){const _0x4ab9ed=_0xa2f98d[_0x1b77ec(0x1467)],_0x20fbd2=_0x3804a0[_0x1b77ec(0x6fb)]['trim']();if(_0x20fbd2&&_0x20fbd2!==_0x4ab9ed){!_0xa2f98d['nameHistory']&&(_0xa2f98d[_0x1b77ec(0xace)]=[]);!_0xa2f98d[_0x1b77ec(0xace)][_0x1b77ec(0x1336)](_0x4ab9ed)&&_0xa2f98d[_0x1b77ec(0xace)]['push'](_0x4ab9ed);_0xa2f98d[_0x1b77ec(0x1467)]=_0x20fbd2;const _0x238c41={'role':'system','type':_0x1b77ec(0xb96),'content':'“'+_0xa2f98d[_0x1b77ec(0x628)]+_0x1b77ec(0x10ae)+_0x20fbd2+'”','timestamp':_0x1f4c42++};_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1001)](_0x238c41);const _0xf7a746={'role':'system','content':_0x1b77ec(0x4c1)+_0x20fbd2+_0x1b77ec(0xa79),'timestamp':_0x1f4c42++,'isHidden':!![]};_0xa2f98d[_0x1b77ec(0xb07)]['push'](_0xf7a746),_0x15ab62&&(_0x4b384e(_0x238c41,_0xa2f98d),document[_0x1b77ec(0x948)](_0x1b77ec(0x1069))[_0x1b77ec(0x10cb)]=_0x20fbd2),await _0x386598(_0xa2f98d);}}continue;case _0x1b77ec(0x77c):{const _0x5b4bbc=_0x3804a0[_0x1b77ec(0x1467)],_0x236a4a=_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0x13ab)][_0x1b77ec(0x1402)](_0x346824=>_0x346824[_0x1b77ec(0x1467)]===_0x5b4bbc);if(_0x236a4a){_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0x156d)]=_0x236a4a[_0x1b77ec(0x9a8)];const _0x2d64b2={'role':_0x1b77ec(0x11af),'type':_0x1b77ec(0xb96),'content':'['+_0xa2f98d[_0x1b77ec(0x1467)]+_0x1b77ec(0x7a5),'timestamp':Date[_0x1b77ec(0x1386)]()};_0xa2f98d[_0x1b77ec(0xb07)]['push'](_0x2d64b2),await _0x62bf8a(_0xa2f98d),_0x15ab62&&(_0x4b384e(_0x2d64b2,_0xa2f98d),_0x455873(_0x22b913));}continue;}case _0x1b77ec(0x9b2):{const _0x27b256=_0x3804a0[_0x1b77ec(0x1467)],_0x6262ca=_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0x3c2)][_0x1b77ec(0x1402)](_0x10b66c=>_0x10b66c[_0x1b77ec(0x1467)]===_0x27b256);if(_0x6262ca){_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0xb09)]=_0x6262ca[_0x1b77ec(0x9a8)];const _0x189318={'role':'system','type':_0x1b77ec(0xb96),'content':'['+_0xa2f98d[_0x1b77ec(0x1467)]+_0x1b77ec(0x751),'timestamp':Date[_0x1b77ec(0x1386)]()};_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1001)](_0x189318),_0x15ab62&&(_0x4b384e(_0x189318,_0xa2f98d),_0x455873(_0x22b913));}continue;}case'gomoku_move':{const _0x3ff152=parseInt(_0x3804a0['x']),_0x18f1fa=parseInt(_0x3804a0['y']);!isNaN(_0x3ff152)&&!isNaN(_0x18f1fa)?_0x4ce1cd({'x':_0x3ff152,'y':_0x18f1fa}):console[_0x1b77ec(0x9c1)](_0x1b77ec(0x1590),_0x3804a0);continue;}case _0x1b77ec(0x68a):const _0x557d77=_0xa2f98d[_0x1b77ec(0xb07)]['findIndex'](_0x5093db=>_0x5093db[_0x1b77ec(0xb0a)]===_0x3804a0['for_timestamp']);if(_0x557d77>-0x1){const _0x3f21ec=_0xa2f98d['history'][_0x557d77];_0x3f21ec['status']=_0x3804a0[_0x1b77ec(0x82c)],_0x3f21ec['paidBy']=_0x3804a0[_0x1b77ec(0x82c)]===_0x1b77ec(0x922)?_0x3804a0[_0x1b77ec(0x1467)]:null;}continue;case _0x1b77ec(0x65f):const _0x36a7ac={'type':_0x3804a0['postType'],'content':_0x3804a0['content']||'','publicText':_0x3804a0[_0x1b77ec(0x15bf)]||'','hiddenContent':_0x3804a0[_0x1b77ec(0x7d9)]||'','image_prompt':_0x3804a0['image_prompt']||'','timestamp':Date[_0x1b77ec(0x1386)](),'authorId':_0x22b913,'authorGroupId':_0xa2f98d[_0x1b77ec(0xaa9)],'visibleGroupIds':null};if(_0x3804a0[_0x1b77ec(0xa83)]==='naiimag'&&_0x3804a0[_0x1b77ec(0xc4b)])try{const _0x37245f=Array[_0x1b77ec(0x1524)](_0x3804a0[_0x1b77ec(0xc4b)])?_0x3804a0[_0x1b77ec(0xc4b)][_0x1b77ec(0x200)](0x0,0x2):[_0x3804a0[_0x1b77ec(0xc4b)]];console[_0x1b77ec(0x498)](_0x1b77ec(0x41e)+_0x37245f[_0x1b77ec(0xaf9)]+'张图片');const _0x408c67=[];for(let _0x289456=0x0;_0x289456<_0x37245f[_0x1b77ec(0xaf9)];_0x289456++){const _0x3a49f6=_0x37245f[_0x289456];console[_0x1b77ec(0x498)](_0x1b77ec(0x144d)+(_0x289456+0x1)+'张图片，prompt:',_0x3a49f6);const _0x505151=_0x4d36cb(_0xa2f98d['id']),_0x47ad64=_0x3a49f6+',\x20'+_0x505151[_0x1b77ec(0x731)],_0x33dcbd=_0x505151[_0x1b77ec(0x1286)];console['log'](_0x1b77ec(0x4ed)+(_0x505151[_0x1b77ec(0x1105)]===_0x1b77ec(0x4d1)?'角色专属':'系统')+_0x1b77ec(0x456)),console[_0x1b77ec(0x498)](_0x1b77ec(0xcd0),_0x47ad64),console['log'](_0x1b77ec(0x50c),_0x33dcbd);const _0x898d29=localStorage[_0x1b77ec(0x55f)](_0x1b77ec(0x14ce)),_0x32a682=localStorage[_0x1b77ec(0x55f)](_0x1b77ec(0xf36))||_0x1b77ec(0x11bc),_0x860203=_0x186764();if(!_0x898d29)throw new Error(_0x1b77ec(0x13d3));const [_0x49d755,_0x45caa4]=_0x860203[_0x1b77ec(0x10d3)]['split']('x')[_0x1b77ec(0x8ff)](Number);let _0x591130;_0x32a682['includes'](_0x1b77ec(0x5b2))?_0x591130={'input':_0x47ad64,'model':_0x32a682,'action':_0x1b77ec(0x110c),'parameters':{'params_version':0x3,'width':_0x49d755,'height':_0x45caa4,'scale':_0x860203[_0x1b77ec(0xd2e)],'sampler':_0x860203[_0x1b77ec(0x6ee)],'steps':_0x860203[_0x1b77ec(0xf33)],'seed':_0x860203[_0x1b77ec(0xa0f)]===-0x1?Math[_0x1b77ec(0x15b6)](Math['random']()*0x2540be3ff):_0x860203[_0x1b77ec(0xa0f)],'n_samples':0x1,'ucPreset':_0x860203[_0x1b77ec(0x65a)],'qualityToggle':_0x860203[_0x1b77ec(0x13eb)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':'karras','legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x47ad64,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x33dcbd,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x33dcbd,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x591130={'input':_0x47ad64,'model':_0x32a682,'action':_0x1b77ec(0x110c),'parameters':{'width':_0x49d755,'height':_0x45caa4,'scale':_0x860203[_0x1b77ec(0xd2e)],'sampler':_0x860203[_0x1b77ec(0x6ee)],'steps':_0x860203[_0x1b77ec(0xf33)],'seed':_0x860203['seed']===-0x1?Math[_0x1b77ec(0x15b6)](Math[_0x1b77ec(0x59c)]()*0x2540be3ff):_0x860203[_0x1b77ec(0xa0f)],'n_samples':0x1,'ucPreset':_0x860203[_0x1b77ec(0x65a)],'qualityToggle':_0x860203[_0x1b77ec(0x13eb)],'sm':_0x860203[_0x1b77ec(0x222)],'sm_dyn':_0x860203[_0x1b77ec(0xef6)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':'native','negative_prompt':_0x33dcbd}};console['log'](_0x1b77ec(0xead),_0x591130);let _0x4a8b87;_0x32a682[_0x1b77ec(0x1336)](_0x1b77ec(0x5b2))?_0x4a8b87=_0x1b77ec(0x98e):_0x4a8b87=_0x1b77ec(0x1346);let _0x3c91e7=_0x860203[_0x1b77ec(0x3ed)];_0x3c91e7===_0x1b77ec(0x1310)&&(_0x3c91e7=_0x860203['custom_proxy_url']||'');_0x3c91e7&&_0x3c91e7!==''&&(_0x4a8b87=_0x3c91e7+encodeURIComponent(_0x4a8b87));const _0xd3e9c9=await fetch(_0x4a8b87,{'method':_0x1b77ec(0xdca),'headers':{'Content-Type':_0x1b77ec(0x479),'Authorization':'Bearer\x20'+_0x898d29},'body':JSON[_0x1b77ec(0x526)](_0x591130)});console[_0x1b77ec(0x498)](_0x1b77ec(0x2a0),_0xd3e9c9['status']),console['log']('Response\x20headers:',[..._0xd3e9c9[_0x1b77ec(0xa07)]['entries']()]);if(!_0xd3e9c9['ok']){const _0x8d605c=await _0xd3e9c9[_0x1b77ec(0x9ea)]();console['error'](_0x1b77ec(0x44b),_0x8d605c);throw new Error('API请求失败\x20('+_0xd3e9c9[_0x1b77ec(0x82c)]+_0x1b77ec(0xbc0)+_0x8d605c);}const _0x1dc3ca=_0xd3e9c9['headers'][_0x1b77ec(0xe8c)](_0x1b77ec(0x128c));console[_0x1b77ec(0x498)](_0x1b77ec(0x564),_0x1dc3ca);let _0x682b6,_0xbe122b;if(_0x1dc3ca&&_0x1dc3ca[_0x1b77ec(0x1336)](_0x1b77ec(0xffa))){console[_0x1b77ec(0x498)](_0x1b77ec(0x40d));const _0x16b890=await _0xd3e9c9[_0x1b77ec(0x9ea)]();console['log'](_0x1b77ec(0x93d),_0x16b890['length']);const _0x560ff3=_0x16b890[_0x1b77ec(0x2a8)]()[_0x1b77ec(0x46f)]('\x0a');let _0x13e630=null;for(let _0x55ca36=_0x560ff3[_0x1b77ec(0xaf9)]-0x1;_0x55ca36>=0x0;_0x55ca36--){const _0x563631=_0x560ff3[_0x55ca36][_0x1b77ec(0x2a8)]();if(_0x563631[_0x1b77ec(0x157f)](_0x1b77ec(0x11f3))&&_0x563631!==_0x1b77ec(0x1134)){const _0x2edf2c=_0x563631[_0x1b77ec(0xeca)](0x6);try{const _0x4b36e0=JSON[_0x1b77ec(0xde0)](_0x2edf2c);if(_0x4b36e0[_0x1b77ec(0x1546)]===_0x1b77ec(0x13cd)&&_0x4b36e0['image']){_0x13e630=_0x4b36e0[_0x1b77ec(0x608)],console[_0x1b77ec(0x498)]('✅\x20找到\x20final\x20事件的图片数据');break;}if(_0x4b36e0['data']){_0x13e630=_0x4b36e0[_0x1b77ec(0x92a)],console['log'](_0x1b77ec(0x3c3));break;}if(_0x4b36e0['image']){_0x13e630=_0x4b36e0[_0x1b77ec(0x608)],console[_0x1b77ec(0x498)]('从\x20JSON.image\x20中提取图片数据');break;}}catch(_0x45fb79){_0x13e630=_0x2edf2c,console[_0x1b77ec(0x498)](_0x1b77ec(0xc0f));break;}}}if(!_0x13e630)throw new Error(_0x1b77ec(0xf6b));const _0x695a50=_0x13e630[_0x1b77ec(0x157f)](_0x1b77ec(0xcdb)),_0x480880=_0x13e630['startsWith'](_0x1b77ec(0x1308));if(_0x695a50||_0x480880){console['log'](_0x1b77ec(0xb87));const _0x2452fe=atob(_0x13e630),_0x36d423=new Uint8Array(_0x2452fe['length']);for(let _0x120b53=0x0;_0x120b53<_0x2452fe['length'];_0x120b53++){_0x36d423[_0x120b53]=_0x2452fe[_0x1b77ec(0x141f)](_0x120b53);}const _0x1dedff=new Blob([_0x36d423],{'type':_0x695a50?_0x1b77ec(0x13ce):_0x1b77ec(0x1516)});console[_0x1b77ec(0x498)](_0x1b77ec(0x306),_0x1dedff[_0x1b77ec(0x8ca)]);const _0x2be900=new FileReader();_0xbe122b=await new Promise((_0x299e36,_0xcdc037)=>{const _0x301bdd=_0x1b77ec;_0x2be900['onloadend']=()=>_0x299e36(_0x2be900[_0x301bdd(0x22a)]),_0x2be900[_0x301bdd(0x12eb)]=_0xcdc037,_0x2be900[_0x301bdd(0x5a5)](_0x1dedff);}),console['log'](_0x1b77ec(0xa2d));}else{console[_0x1b77ec(0x498)](_0x1b77ec(0x5fa));const _0x30fce0=atob(_0x13e630),_0x34c5f1=new Uint8Array(_0x30fce0[_0x1b77ec(0xaf9)]);for(let _0x218312=0x0;_0x218312<_0x30fce0[_0x1b77ec(0xaf9)];_0x218312++){_0x34c5f1[_0x218312]=_0x30fce0['charCodeAt'](_0x218312);}_0x682b6=new Blob([_0x34c5f1]),console['log']('ZIP\x20Blob\x20大小:',_0x682b6[_0x1b77ec(0x8ca)]);}}else _0x682b6=await _0xd3e9c9['blob'](),console[_0x1b77ec(0x498)](_0x1b77ec(0xa51),_0x682b6[_0x1b77ec(0x4ae)],_0x1b77ec(0x10bf),_0x682b6['size']);if(!_0xbe122b&&_0x682b6)try{if(typeof JSZip===_0x1b77ec(0x490))throw new Error('JSZip库未加载，请刷新页面重试');const _0x37f908=await JSZip['loadAsync'](_0x682b6);console[_0x1b77ec(0x498)](_0x1b77ec(0x7da),Object[_0x1b77ec(0x1cf)](_0x37f908[_0x1b77ec(0x10b0)]));let _0x1137bc=null;for(let _0x186407 in _0x37f908['files']){if(_0x186407[_0x1b77ec(0x9a3)](/\.(png|jpg|jpeg|webp)$/i)){_0x1137bc=_0x37f908[_0x1b77ec(0x10b0)][_0x186407],console[_0x1b77ec(0x498)](_0x1b77ec(0x10bc),_0x186407);break;}}if(!_0x1137bc)throw new Error(_0x1b77ec(0xc47));const _0x373e55=await _0x1137bc[_0x1b77ec(0x706)](_0x1b77ec(0x250));console[_0x1b77ec(0x498)](_0x1b77ec(0x501),_0x373e55['size']);const _0x32ff7c=new FileReader();_0xbe122b=await new Promise((_0x4c087d,_0x4f493a)=>{const _0xbb515e=_0x1b77ec;_0x32ff7c[_0xbb515e(0x55b)]=()=>_0x4c087d(_0x32ff7c[_0xbb515e(0x22a)]),_0x32ff7c[_0xbb515e(0x12eb)]=_0x4f493a,_0x32ff7c[_0xbb515e(0x5a5)](_0x373e55);}),console[_0x1b77ec(0x498)](_0x1b77ec(0x1451));}catch(_0x41c932){console[_0x1b77ec(0xc3e)](_0x1b77ec(0x10e9),_0x41c932);throw new Error(_0x1b77ec(0x1482)+_0x41c932[_0x1b77ec(0x74b)]);}console['log'](_0x1b77ec(0x711)+(_0x289456+0x1)+_0x1b77ec(0xf00)),_0x408c67[_0x1b77ec(0x1001)](_0xbe122b);}_0x36a7ac[_0x1b77ec(0x159b)]=_0x408c67,_0x408c67['length']===0x1&&(_0x36a7ac[_0x1b77ec(0x15b8)]=_0x408c67[0x0]),_0x36a7ac[_0x1b77ec(0xc4b)]=_0x3804a0[_0x1b77ec(0xc4b)],_0x36a7ac[_0x1b77ec(0x155c)]=_0x408c67[_0x1b77ec(0xaf9)],console[_0x1b77ec(0x498)](_0x1b77ec(0x41f)+_0x408c67[_0x1b77ec(0xaf9)]+'张');}catch(_0x5c2b6d){console['error'](_0x1b77ec(0xc76),_0x5c2b6d),_0x36a7ac[_0x1b77ec(0xede)]=(_0x36a7ac[_0x1b77ec(0xede)]||_0x36a7ac[_0x1b77ec(0x15bf)]||'')+(_0x1b77ec(0x3dd)+_0x5c2b6d[_0x1b77ec(0x74b)]+']');}await _0x6ed281[_0x1b77ec(0xed1)]['add'](_0x36a7ac),_0x255639(_0x5711af+0x1);_0x15ab62&&document['getElementById'](_0x1b77ec(0x442))['classList'][_0x1b77ec(0x7a0)](_0x1b77ec(0x115e))&&await _0x4d3afb();continue;case _0x1b77ec(0x123d):{const _0x7bde7b=await _0x6ed281[_0x1b77ec(0xed1)][_0x1b77ec(0xe8c)](parseInt(_0x3804a0[_0x1b77ec(0xba5)]));if(_0x7bde7b){if(!_0x7bde7b['comments'])_0x7bde7b[_0x1b77ec(0x4d6)]=[];const _0x462a7d=_0x3804a0[_0x1b77ec(0x1467)]||_0xa2f98d[_0x1b77ec(0x628)],_0x325a4a=(_0x1e50ef,_0x169656=null,_0x519e1a=null)=>({'commenterName':_0x462a7d,'text':_0x2cdd20(_0x1e50ef,_0xa2f98d),'meaning':_0x169656,'replyTo':_0x519e1a,'timestamp':Date[_0x1b77ec(0x1386)]()});if(_0x3804a0[_0x1b77ec(0xdd0)]){const _0x43c38f=_0x16699d['userStickers'][_0x1b77ec(0x1402)](_0x35a38=>_0x35a38[_0x1b77ec(0x1467)]===_0x3804a0[_0x1b77ec(0xdd0)]);_0x43c38f?_0x7bde7b['comments'][_0x1b77ec(0x1001)](_0x325a4a(_0x43c38f['url'],_0x43c38f[_0x1b77ec(0x1467)],_0x3804a0[_0x1b77ec(0xf05)]||null)):(console[_0x1b77ec(0x9c1)](_0x1b77ec(0x6ca)+_0x3804a0[_0x1b77ec(0xdd0)]+'\x22'),_0x7bde7b[_0x1b77ec(0x4d6)][_0x1b77ec(0x1001)](_0x325a4a(_0x1b77ec(0x828)+_0x3804a0['stickerMeaning']+']',null,_0x3804a0[_0x1b77ec(0xf05)]||null)));}else{if(Array[_0x1b77ec(0x1524)](_0x3804a0['comments']))_0x3804a0[_0x1b77ec(0x4d6)][_0x1b77ec(0x427)](_0x251b55=>{const _0x2376e0=_0x1b77ec;typeof _0x251b55===_0x2376e0(0x273)&&_0x251b55[_0x2376e0(0x2a8)]()&&_0x7bde7b['comments'][_0x2376e0(0x1001)](_0x325a4a(_0x251b55,null,_0x3804a0['replyTo']||null));});else typeof _0x3804a0[_0x1b77ec(0xad3)]===_0x1b77ec(0x273)&&_0x3804a0['commentText'][_0x1b77ec(0x2a8)]()&&_0x7bde7b[_0x1b77ec(0x4d6)]['push'](_0x325a4a(_0x3804a0['commentText'],null,_0x3804a0[_0x1b77ec(0xf05)]||null));}await _0x6ed281[_0x1b77ec(0xed1)]['update'](_0x7bde7b['id'],{'comments':_0x7bde7b['comments']}),_0x255639(_0x5711af+0x1),console['log'](_0x1b77ec(0x1598)+_0xa2f98d[_0x1b77ec(0x1467)]+'\x22\x20评论了动态\x20#'+_0x3804a0[_0x1b77ec(0xba5)]);if(!_0xa2f98d[_0x1b77ec(0x1359)])_0xa2f98d[_0x1b77ec(0x1359)]={};_0xa2f98d['commentCooldowns'][_0x3804a0[_0x1b77ec(0xba5)]]=Date[_0x1b77ec(0x1386)]();}continue;}case _0x1b77ec(0x11e9):const _0x5732ec=await _0x6ed281[_0x1b77ec(0xed1)][_0x1b77ec(0xe8c)](parseInt(_0x3804a0[_0x1b77ec(0xba5)]));if(_0x5732ec){if(!_0x5732ec[_0x1b77ec(0x494)])_0x5732ec[_0x1b77ec(0x494)]=[];!_0x5732ec[_0x1b77ec(0x494)]['includes'](_0xa2f98d[_0x1b77ec(0x1467)])&&(_0x5732ec[_0x1b77ec(0x494)]['push'](_0xa2f98d['name']),await _0x6ed281[_0x1b77ec(0xed1)][_0x1b77ec(0xa0b)](_0x5732ec['id'],{'likes':_0x5732ec['likes']}),_0x255639(_0x5711af+0x1),_0x15ab62&&document[_0x1b77ec(0x948)](_0x1b77ec(0x442))[_0x1b77ec(0xd54)]['contains'](_0x1b77ec(0x115e))&&await _0x4d3afb());}continue;case _0x1b77ec(0x1f2):{const _0x3b16e3=await _0x6ed281[_0x1b77ec(0xed1)][_0x1b77ec(0xe8c)](parseInt(_0x3804a0[_0x1b77ec(0xba5)]));if(_0x3b16e3){const _0x52afa7={'type':'repost','timestamp':Date['now'](),'authorId':_0x22b913,'authorGroupId':_0xa2f98d['groupId'],'repostComment':_0x3804a0[_0x1b77ec(0x282)]||'','originalPost':_0x3b16e3,'visibleGroupIds':null};await _0x6ed281[_0x1b77ec(0xed1)]['add'](_0x52afa7),_0x255639(_0x5711af+0x1),console[_0x1b77ec(0x498)](_0x1b77ec(0x1598)+_0xa2f98d[_0x1b77ec(0x1467)]+_0x1b77ec(0x669)+_0x3804a0[_0x1b77ec(0xba5)]);}continue;}case'video_call_request':!_0x1c6d6b[_0x1b77ec(0x1032)]&&!_0x1c6d6b[_0x1b77ec(0xab7)]&&(_0x16699d['activeChatId']=_0x22b913,_0x1c6d6b['activeChatId']=_0x22b913,_0x1c6d6b[_0x1b77ec(0xab7)]=!![],_0x1c6d6b[_0x1b77ec(0x658)]=_0xa2f98d[_0x1b77ec(0x1173)],_0x1c6d6b[_0x1b77ec(0xcd5)]=_0x3804a0[_0x1b77ec(0x1467)]||_0xa2f98d[_0x1b77ec(0x1467)],_0x1b90eb());continue;case'group_call_request':!_0x1c6d6b[_0x1b77ec(0x1032)]&&!_0x1c6d6b[_0x1b77ec(0xab7)]&&(_0x16699d['activeChatId']=_0x22b913,_0x1c6d6b[_0x1b77ec(0xab7)]=!![],_0x1c6d6b['isGroupCall']=!![],_0x1c6d6b['initiator']='ai',_0x1c6d6b[_0x1b77ec(0xcd5)]=_0x3804a0[_0x1b77ec(0x1467)],_0x1b90eb());continue;case _0x1b77ec(0x140f):let _0x582180;if(_0xa2f98d[_0x1b77ec(0x1173)]){const _0x2318e3=_0xa2f98d['members'][_0x1b77ec(0x1402)](_0x3f8a00=>_0x3f8a00[_0x1b77ec(0x628)]===_0x3804a0[_0x1b77ec(0x1467)]);_0x582180=_0x2318e3?_0x2318e3[_0x1b77ec(0x347)]:_0x3804a0[_0x1b77ec(0x1467)];}else _0x582180=_0xa2f98d[_0x1b77ec(0x1467)];const _0x5645fa=_0x3804a0[_0x1b77ec(0x137f)]?'\x20'+_0x3804a0[_0x1b77ec(0x137f)]['trim']():'',_0x239e03=_0x582180+_0x1b77ec(0x11b2)+_0x5645fa,_0x24f2fb={'role':_0x1b77ec(0x11af),'type':_0x1b77ec(0xb96),'content':_0x239e03,'timestamp':Date[_0x1b77ec(0x1386)]()};_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1001)](_0x24f2fb);if(_0x15ab62){const _0x236cc6=document[_0x1b77ec(0x948)](_0x1b77ec(0xecd));_0x236cc6[_0x1b77ec(0xd54)][_0x1b77ec(0xf89)](_0x1b77ec(0x48a)),void _0x236cc6['offsetWidth'],_0x236cc6[_0x1b77ec(0xd54)]['add'](_0x1b77ec(0x48a)),setTimeout(()=>_0x236cc6[_0x1b77ec(0xd54)][_0x1b77ec(0xf89)]('pat-animation'),0x1f4),_0x4b384e(_0x24f2fb,_0xa2f98d);}else _0x2e32a5(_0x22b913,_0x239e03);continue;case _0x1b77ec(0x12c3):_0xa2f98d['status'][_0x1b77ec(0x9ea)]=_0x3804a0[_0x1b77ec(0x57e)],_0xa2f98d[_0x1b77ec(0x82c)]['isBusy']=_0x3804a0[_0x1b77ec(0xc90)]||![],_0xa2f98d['status'][_0x1b77ec(0x5e3)]=Date[_0x1b77ec(0x1386)]();const _0xf45bf6={'role':_0x1b77ec(0x11af),'type':'pat_message','content':'['+_0xa2f98d[_0x1b77ec(0x1467)]+_0x1b77ec(0x72e)+_0x3804a0['status_text']+']','timestamp':Date[_0x1b77ec(0x1386)]()};_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1001)](_0xf45bf6);_0x15ab62&&_0x4b384e(_0xf45bf6,_0xa2f98d);_0x2d33eb();continue;case'location_share':_0x116dfb={..._0xd6a308,'type':_0x1b77ec(0x137c),'content':_0x3804a0[_0x1b77ec(0xede)]};break;case _0x1b77ec(0xe2f):if(_0x49c6c5[_0x1b77ec(0x1032)]&&_0x49c6c5[_0x1b77ec(0xf5a)]===_0x22b913){const _0x1b6e26=_0x3804a0['song_name']||_0x3804a0[_0x1b77ec(0x99b)]||_0x3804a0[_0x1b77ec(0x1467)];if(typeof _0x1b6e26===_0x1b77ec(0x273)&&_0x1b6e26[_0x1b77ec(0x2a8)]()){const _0x36c90b=_0x1b6e26[_0x1b77ec(0x14e9)](/^\[?\d+\]?[\s.-]*/,'')[_0x1b77ec(0x2a8)](),_0x168ca6=_0x49c6c5[_0x1b77ec(0x12c8)]['findIndex'](_0x53f00f=>_0x53f00f[_0x1b77ec(0x1467)][_0x1b77ec(0x1331)]()===_0x36c90b[_0x1b77ec(0x1331)]());if(_0x168ca6>-0x1){_0x583698(_0x168ca6);const _0x13fe7e=_0x49c6c5[_0x1b77ec(0x12c8)][_0x168ca6];let _0x29db33;if(_0xa2f98d[_0x1b77ec(0x1173)]){const _0x2a66b7=_0xa2f98d[_0x1b77ec(0x10a2)][_0x1b77ec(0x1402)](_0x22359d=>_0x22359d[_0x1b77ec(0x628)]===_0x3804a0[_0x1b77ec(0x1467)]);_0x29db33=_0x2a66b7?_0x2a66b7[_0x1b77ec(0x347)]:_0x3804a0[_0x1b77ec(0x1467)];}else _0x29db33=_0xa2f98d[_0x1b77ec(0x1467)];const _0x48008e={'role':_0x1b77ec(0x11af),'type':_0x1b77ec(0xb96),'content':_0x1b77ec(0xcb3)+_0x29db33+_0x1b77ec(0x626)+_0x13fe7e['name']+'》\x20-\x20'+_0x13fe7e[_0x1b77ec(0x43a)]+']','timestamp':Date['now']()};_0xa2f98d[_0x1b77ec(0xb07)]['push'](_0x48008e),_0x15ab62&&_0x4b384e(_0x48008e,_0xa2f98d);}else console[_0x1b77ec(0x9c1)](_0x1b77ec(0x133f)+_0x1b6e26+_0x1b77ec(0x54c)+_0x36c90b+_0x1b77ec(0xeb1));}else console[_0x1b77ec(0xc3e)](_0x1b77ec(0xb5c),_0x3804a0);}continue;case _0x1b77ec(0x14eb):const _0x82da14={'chatId':_0x22b913,'authorId':_0x22b913,'description':_0x3804a0[_0x1b77ec(0xe79)],'timestamp':Date[_0x1b77ec(0x1386)](),'type':_0x1b77ec(0x13e1)};await _0x6ed281[_0x1b77ec(0x9cc)]['add'](_0x82da14),console[_0x1b77ec(0x498)]('AI\x20\x22'+_0xa2f98d[_0x1b77ec(0x1467)]+_0x1b77ec(0x11a2),_0x3804a0[_0x1b77ec(0xe79)]);continue;case _0x1b77ec(0xe64):const _0x87e0b8=new Date(_0x3804a0[_0x1b77ec(0x12b4)]);if(!isNaN(_0x87e0b8)&&_0x87e0b8>new Date()){const _0x49548b={'chatId':_0x22b913,'authorId':_0x22b913,'description':_0x3804a0['title'],'timestamp':Date[_0x1b77ec(0x1386)](),'type':_0x1b77ec(0xa6b),'targetDate':_0x87e0b8['getTime']()};await _0x6ed281['memories'][_0x1b77ec(0xbd0)](_0x49548b),console[_0x1b77ec(0x498)](_0x1b77ec(0x1443)+_0xa2f98d['name']+'\x22\x20创建了一个新约定:',_0x3804a0[_0x1b77ec(0xb03)]);}continue;case _0x1b77ec(0x278):if(!_0xa2f98d[_0x1b77ec(0x1173)]){_0xa2f98d[_0x1b77ec(0x1120)][_0x1b77ec(0x82c)]='blocked_by_ai';const _0x500145={'role':_0x1b77ec(0x11af),'content':_0x1b77ec(0x7a8),'timestamp':Date[_0x1b77ec(0x1386)](),'isHidden':!![]};_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1001)](_0x500145),await _0x6ed281[_0x1b77ec(0x1474)][_0x1b77ec(0x90c)](_0xa2f98d);_0x15ab62&&_0x455873(_0x22b913);_0x2d33eb();break;}continue;case _0x1b77ec(0x11f5):!_0xa2f98d['isGroup']&&_0xa2f98d[_0x1b77ec(0x1120)]?.[_0x1b77ec(0x82c)]===_0x1b77ec(0x21b)&&(_0x3804a0[_0x1b77ec(0xa54)]===_0x1b77ec(0x587)?(_0xa2f98d[_0x1b77ec(0x1120)][_0x1b77ec(0x82c)]=_0x1b77ec(0x1431),_0x116dfb={..._0xd6a308,'content':_0x1b77ec(0x9ae)}):(_0xa2f98d[_0x1b77ec(0x1120)][_0x1b77ec(0x82c)]=_0x1b77ec(0x154f),_0x116dfb={..._0xd6a308,'content':'抱歉，我拒绝了你的好友申请。'}),_0xa2f98d[_0x1b77ec(0x1120)][_0x1b77ec(0x60f)]='');break;case _0x1b77ec(0x1385):const _0x1c9aae=typeof _0x3804a0['options']===_0x1b77ec(0x273)?_0x3804a0['options'][_0x1b77ec(0x46f)]('\x0a')[_0x1b77ec(0x1c0)](_0x5f0a69=>_0x5f0a69['trim']()):Array['isArray'](_0x3804a0[_0x1b77ec(0x5ae)])?_0x3804a0['options']:[];if(_0x1c9aae['length']<0x2)continue;_0x116dfb={..._0xd6a308,'type':_0x1b77ec(0x1385),'question':_0x3804a0[_0x1b77ec(0xa9f)],'options':_0x1c9aae,'votes':{},'isClosed':![]};break;case _0x1b77ec(0x9e7):{const {itemName:_0x1b71b1,itemPrice:_0x599d79,image_prompt:_0x4fe56c}=_0x3804a0;if(_0x1b71b1&&!isNaN(parseFloat(_0x599d79))&&_0x4fe56c){const _0x424f47=_0x1b77ec(0xbfa)+encodeURIComponent(_0x4fe56c);_0x116dfb={..._0xd6a308,'type':_0x1b77ec(0x9e7),'items':[{'name':_0x1b71b1,'price':parseFloat(_0x599d79),'imageUrl':_0x424f47,'quantity':0x1}],'total':parseFloat(_0x599d79),'recipients':_0x3804a0[_0x1b77ec(0x797)]||null};}else console[_0x1b77ec(0x9c1)]('AI\x20尝试赠送一个格式不正确的随机礼物:',_0x3804a0);break;}case _0x1b77ec(0xd1a):const _0x4d87cc=_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1402)](_0x39dac7=>_0x39dac7[_0x1b77ec(0xb0a)]===_0x3804a0['poll_timestamp']);_0x4d87cc&&!_0x4d87cc[_0x1b77ec(0x30f)]&&(Object[_0x1b77ec(0x1cf)](_0x4d87cc[_0x1b77ec(0xb0b)])[_0x1b77ec(0x427)](_0x4df00b=>{const _0x340918=_0x1b77ec,_0x538c9a=_0x4d87cc['votes'][_0x4df00b][_0x340918(0x539)](_0x3804a0[_0x340918(0x1467)]);_0x538c9a>-0x1&&_0x4d87cc[_0x340918(0xb0b)][_0x4df00b][_0x340918(0x36d)](_0x538c9a,0x1);}),!_0x4d87cc[_0x1b77ec(0xb0b)][_0x3804a0[_0x1b77ec(0xb25)]]&&(_0x4d87cc[_0x1b77ec(0xb0b)][_0x3804a0[_0x1b77ec(0xb25)]]=[]),!_0x4d87cc[_0x1b77ec(0xb0b)][_0x3804a0[_0x1b77ec(0xb25)]][_0x1b77ec(0x1336)](_0x3804a0[_0x1b77ec(0x1467)])&&_0x4d87cc[_0x1b77ec(0xb0b)][_0x3804a0['choice']][_0x1b77ec(0x1001)](_0x3804a0[_0x1b77ec(0x1467)]),_0x15ab62&&_0x455873(_0x22b913));continue;case _0x1b77ec(0x148f):_0x116dfb={..._0xd6a308,..._0x3804a0,'totalAmount':_0x3804a0[_0x1b77ec(0xbd2)],'claimedBy':{},'isFullyClaimed':![]};_0x3804a0[_0x1b77ec(0x4df)]&&(_0x116dfb[_0x1b77ec(0xb57)]=_0x3804a0[_0x1b77ec(0x4df)],delete _0x116dfb[_0x1b77ec(0x4df)]);break;case _0x1b77ec(0x5e6):const _0x3bbf45=_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1402)](_0x1a01ea=>_0x1a01ea[_0x1b77ec(0xb0a)]===_0x3804a0['packet_timestamp']),_0x1879a1=_0x3804a0[_0x1b77ec(0x1467)],_0x403c94=_0xa2f98d[_0x1b77ec(0x10a2)][_0x1b77ec(0x1502)](_0xdd8b52=>_0xdd8b52[_0x1b77ec(0x628)]===_0x1879a1);if(!_0x403c94){console[_0x1b77ec(0x9c1)](_0x1b77ec(0x11de)+_0x1879a1+_0x1b77ec(0xe6d));continue;}if(_0x3bbf45&&_0x3bbf45[_0x1b77ec(0x7f7)]===_0x1b77ec(0x3ec)){if(_0x3bbf45[_0x1b77ec(0xb57)]!==_0x3804a0[_0x1b77ec(0x1467)]){console[_0x1b77ec(0x9c1)](_0x1b77ec(0x11de)+_0x3804a0[_0x1b77ec(0x1467)]+_0x1b77ec(0x629)+_0x3bbf45[_0x1b77ec(0xb57)]+_0x1b77ec(0xcef));continue;}}if(_0x3bbf45&&!_0x3bbf45[_0x1b77ec(0x134a)]&&!(_0x3bbf45[_0x1b77ec(0x764)]&&_0x3bbf45[_0x1b77ec(0x764)][_0x3804a0[_0x1b77ec(0x1467)]])){let _0x1260d5=0x0;const _0x9020e6=_0x3bbf45[_0x1b77ec(0x421)]-Object['values'](_0x3bbf45[_0x1b77ec(0x764)]||{})[_0x1b77ec(0x6ab)]((_0x188a12,_0x2acfab)=>_0x188a12+_0x2acfab,0x0),_0x527b17=_0x3bbf45[_0x1b77ec(0x12db)]-Object[_0x1b77ec(0x1cf)](_0x3bbf45[_0x1b77ec(0x764)]||{})[_0x1b77ec(0xaf9)];if(_0x527b17>0x0){if(_0x3bbf45[_0x1b77ec(0x7f7)]==='direct')_0x1260d5=_0x3bbf45[_0x1b77ec(0x421)];else{if(_0x527b17===0x1)_0x1260d5=_0x9020e6;else{const _0x484a45=0.01,_0x363a16=_0x9020e6-(_0x527b17-0x1)*_0x484a45;_0x1260d5=Math['random']()*(_0x363a16-_0x484a45)+_0x484a45;}}_0x1260d5=parseFloat(_0x1260d5[_0x1b77ec(0xd69)](0x2));if(!_0x3bbf45[_0x1b77ec(0x764)])_0x3bbf45['claimedBy']={};_0x3bbf45[_0x1b77ec(0x764)][_0x3804a0['name']]=_0x1260d5;const _0x2238b4=_0xa2f98d['members'][_0x1b77ec(0x1402)](_0x38adee=>_0x38adee['originalName']===_0x3804a0[_0x1b77ec(0x1467)]),_0x2986eb=_0x2238b4?_0x2238b4[_0x1b77ec(0x347)]:_0x3804a0[_0x1b77ec(0x1467)],_0x305fc2=_0x589066(_0xa2f98d,_0x3bbf45[_0x1b77ec(0x14ee)]),_0x1db62a={'role':_0x1b77ec(0x11af),'type':_0x1b77ec(0xb96),'content':_0x2986eb+_0x1b77ec(0x533)+_0x305fc2+_0x1b77ec(0xb48),'timestamp':Date[_0x1b77ec(0x1386)]()};_0xa2f98d['history']['push'](_0x1db62a);let _0x4e0b0f=_0x1b77ec(0x108a)+_0x2986eb+_0x1b77ec(0xc21)+_0x1260d5[_0x1b77ec(0xd69)](0x2)+_0x1b77ec(0xf03);if(Object[_0x1b77ec(0x1cf)](_0x3bbf45[_0x1b77ec(0x764)])[_0x1b77ec(0xaf9)]>=_0x3bbf45[_0x1b77ec(0x12db)]){_0x3bbf45[_0x1b77ec(0x134a)]=!![];const _0x310c87={'role':_0x1b77ec(0x11af),'type':'pat_message','content':_0x305fc2+'\x20的红包已被领完','timestamp':Date[_0x1b77ec(0x1386)]()+0x1};_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1001)](_0x310c87);let _0xc83f2b={'name':'','amount':-0x1};_0x3bbf45['packetType']===_0x1b77ec(0x3c9)&&_0x3bbf45[_0x1b77ec(0x12db)]>0x1&&Object[_0x1b77ec(0x6ea)](_0x3bbf45[_0x1b77ec(0x764)])[_0x1b77ec(0x427)](([_0x577ed8,_0x40bc2a])=>{const _0x42297e=_0x1b77ec;_0x40bc2a>_0xc83f2b[_0x42297e(0xbd2)]&&(_0xc83f2b={'name':_0x577ed8,'amount':_0x40bc2a});});if(_0xc83f2b[_0x1b77ec(0x1467)]){const _0x24eddd=_0xa2f98d[_0x1b77ec(0x10a2)][_0x1b77ec(0x1402)](_0x2435f6=>_0x2435f6[_0x1b77ec(0x628)]===_0xc83f2b[_0x1b77ec(0x1467)]),_0x1e9452=_0x24eddd?_0x24eddd[_0x1b77ec(0x347)]:_0xc83f2b[_0x1b77ec(0x1467)];_0x4e0b0f+=_0x1b77ec(0x11a1)+_0x1e9452+'！';}else _0x4e0b0f+=_0x1b77ec(0x335);}_0x4e0b0f+=_0x1b77ec(0xb0f);const _0x28e752={'role':_0x1b77ec(0x11af),'content':_0x4e0b0f,'timestamp':Date[_0x1b77ec(0x1386)]()+0x2,'isHidden':!![]};_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1001)](_0x28e752);}_0x15ab62&&(_0x455873(_0x22b913),_0x2d33eb());}continue;case _0x1b77ec(0x7b9):{const _0x2fdc23=_0xa2f98d[_0x1b77ec(0xb07)]['findIndex'](_0x1b9f64=>_0x1b9f64[_0x1b77ec(0xb0a)]===_0x3804a0[_0x1b77ec(0x1560)]);if(_0x2fdc23>-0x1){const _0x2b6ab3=_0xa2f98d[_0x1b77ec(0xb07)][_0x2fdc23];_0x2b6ab3['status']=_0x1b77ec(0x855);}continue;}case _0x1b77ec(0x12bc):{const _0x489b80=_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1018)](_0xc00d45=>_0xc00d45[_0x1b77ec(0xb0a)]===_0x3804a0['for_timestamp']);if(_0x489b80>-0x1){const _0x598223=_0xa2f98d[_0x1b77ec(0xb07)][_0x489b80];_0x598223[_0x1b77ec(0x82c)]=_0x1b77ec(0x777);const _0x42a04c={'role':_0x1b77ec(0x14c8),'senderName':_0xa2f98d[_0x1b77ec(0x1467)],'type':_0x1b77ec(0x1514),'isRefund':!![],'amount':_0x598223[_0x1b77ec(0xbd2)],'note':_0x1b77ec(0x11a6),'timestamp':_0x1f4c42++};_0xa2f98d['history'][_0x1b77ec(0x1001)](_0x42a04c),_0x15ab62&&(_0x4b384e(_0x42a04c,_0xa2f98d),_0x455873(_0x22b913));}continue;}case _0x1b77ec(0x7e2):if(_0xa2f98d['isGroup']&&_0x3804a0[_0x1b77ec(0x6fb)]){const _0x514a72=_0x3804a0[_0x1b77ec(0x6fb)]['trim'](),_0x509804=_0xa2f98d[_0x1b77ec(0x10a2)][_0x1b77ec(0x8ff)](_0x1526b8=>_0x1526b8[_0x1b77ec(0x628)]);if(_0x509804[_0x1b77ec(0x1336)](_0x514a72)){console[_0x1b77ec(0x9c1)](_0x1b77ec(0x1060)+_0x3804a0['name']+_0x1b77ec(0x13cc)+_0x514a72+_0x1b77ec(0x47c));continue;}_0xa2f98d[_0x1b77ec(0x1467)]=_0x514a72;const _0x35d92d=_0xa2f98d[_0x1b77ec(0x10a2)][_0x1b77ec(0x1402)](_0x4918fc=>_0x4918fc[_0x1b77ec(0x628)]===_0x3804a0[_0x1b77ec(0x1467)]),_0x539e2d=_0x35d92d?_0x35d92d[_0x1b77ec(0x347)]:_0x3804a0['name'],_0x3062d5={'role':_0x1b77ec(0x11af),'type':_0x1b77ec(0xb96),'content':_0x539e2d+_0x1b77ec(0xa0d)+_0xa2f98d[_0x1b77ec(0x1467)]+'”','timestamp':_0x1f4c42++};_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1001)](_0x3062d5),_0x15ab62&&(_0x4b384e(_0x3062d5,_0xa2f98d),document[_0x1b77ec(0x948)]('chat-header-title')[_0x1b77ec(0x10cb)]=_0xa2f98d[_0x1b77ec(0x1467)]);}continue;case _0x1b77ec(0x1260):if(!_0xa2f98d[_0x1b77ec(0x1173)]&&_0x3804a0['new_name']){const _0x5e3d85=_0xa2f98d[_0x1b77ec(0x1467)],_0x8b831b=_0x3804a0[_0x1b77ec(0x6fb)]['trim']();if(_0x8b831b&&_0x8b831b!==_0x5e3d85){!_0xa2f98d[_0x1b77ec(0xace)]&&(_0xa2f98d['nameHistory']=[]);!_0xa2f98d[_0x1b77ec(0xace)][_0x1b77ec(0x1336)](_0x5e3d85)&&_0xa2f98d[_0x1b77ec(0xace)][_0x1b77ec(0x1001)](_0x5e3d85);_0xa2f98d[_0x1b77ec(0x1467)]=_0x8b831b;const _0x4145ad={'role':_0x1b77ec(0x11af),'type':'pat_message','content':'“'+_0xa2f98d[_0x1b77ec(0x628)]+_0x1b77ec(0x10ae)+_0x8b831b+'”','timestamp':_0x1f4c42++};_0xa2f98d[_0x1b77ec(0xb07)]['push'](_0x4145ad);const _0x1834e6={'role':_0x1b77ec(0x11af),'content':_0x1b77ec(0x4c1)+_0x8b831b+_0x1b77ec(0xa79),'timestamp':_0x1f4c42++,'isHidden':!![]};_0xa2f98d['history']['push'](_0x1834e6),_0x15ab62&&(_0x4b384e(_0x4145ad,_0xa2f98d),document[_0x1b77ec(0x948)](_0x1b77ec(0x1069))[_0x1b77ec(0x10cb)]=_0x8b831b),await _0x386598(_0xa2f98d);}}continue;case'change_group_avatar':if(_0xa2f98d[_0x1b77ec(0x1173)]&&_0x3804a0[_0x1b77ec(0x12e5)]){const _0x1b54ad=_0x3804a0['avatar_name'],_0xdac0c9=_0xa2f98d['settings'][_0x1b77ec(0x1506)]||[],_0x6d61fa=_0xdac0c9['find'](_0x25b57c=>_0x25b57c['name']===_0x1b54ad);if(_0x6d61fa){_0xa2f98d['settings']['groupAvatar']=_0x6d61fa[_0x1b77ec(0x9a8)];const _0x525e32=_0xa2f98d[_0x1b77ec(0x10a2)]['find'](_0x48e9a1=>_0x48e9a1['originalName']===_0x3804a0[_0x1b77ec(0x1467)]),_0x269079=_0x525e32?_0x525e32[_0x1b77ec(0x347)]:_0x3804a0[_0x1b77ec(0x1467)],_0x54e7cc={'role':_0x1b77ec(0x11af),'type':_0x1b77ec(0xb96),'content':_0x269079+'\x20更换了群头像','timestamp':_0x1f4c42++};_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1001)](_0x54e7cc),_0x15ab62&&_0x4b384e(_0x54e7cc,_0xa2f98d);}else console[_0x1b77ec(0x9c1)](_0x1b77ec(0xec1)+_0x1b54ad+'\x22');}continue;case'system_message':_0x116dfb={'role':_0x1b77ec(0x11af),'type':_0x1b77ec(0xb96),'content':_0x3804a0['content'],'timestamp':Date['now']()};break;case _0x1b77ec(0xa7a):_0x116dfb={..._0xd6a308,'type':_0x1b77ec(0xa7a),'title':_0x3804a0[_0x1b77ec(0xb03)],'description':_0x3804a0['description'],'source_name':_0x3804a0[_0x1b77ec(0x10c9)],'content':_0x3804a0[_0x1b77ec(0xede)]};break;case _0x1b77ec(0x11a9):const _0x2431de=_0xa2f98d[_0x1b77ec(0xb07)]['find'](_0x2e41d5=>_0x2e41d5[_0x1b77ec(0xb0a)]===_0x3804a0[_0x1b77ec(0x20b)]);if(_0x2431de){const _0x9255eb={'timestamp':_0x2431de[_0x1b77ec(0xb0a)],'senderName':_0x2431de[_0x1b77ec(0x14ee)]||(_0x2431de[_0x1b77ec(0x1554)]===_0x1b77ec(0xaeb)?_0xa2f98d[_0x1b77ec(0x7fd)][_0x1b77ec(0x1371)]||'我':_0xa2f98d['name']),'content':String(_0x2431de['content']||'')[_0x1b77ec(0xeca)](0x0,0x32)};_0x116dfb={..._0xd6a308,'content':_0x3804a0[_0x1b77ec(0x5a9)],'quote':_0x9255eb};}else _0x116dfb={..._0xd6a308,'content':_0x3804a0[_0x1b77ec(0x5a9)]};break;case _0x1b77ec(0x21a):{if(!_0x15ab62)continue;const _0x1e86f1={..._0xd6a308,'content':_0x3804a0[_0x1b77ec(0xede)]},_0x18993b=_0x1f8f7b(_0x1e86f1,_0xa2f98d);_0x4b384e(_0x1e86f1,_0xa2f98d,!![]),await new Promise(_0x1d0c24=>setTimeout(_0x1d0c24,Math['random']()*0x3e8+0x5dc));const _0x4199f1=document['querySelector'](_0x1b77ec(0x12bb)+_0x1e86f1['timestamp']+'\x22]')?.['closest'](_0x1b77ec(0x7ba));if(_0x4199f1){_0x4199f1['classList'][_0x1b77ec(0xbd0)]('recalled-animation'),await new Promise(_0x51b89f=>setTimeout(_0x51b89f,0x12c));const _0x35b73e={'role':'assistant','senderName':_0x3804a0['name']||_0xa2f98d[_0x1b77ec(0x1467)],'type':_0x1b77ec(0xb5d),'content':_0x1b77ec(0xee2),'timestamp':_0x1e86f1['timestamp'],'recalledData':{'originalType':_0x1b77ec(0x9ea),'originalContent':_0x3804a0[_0x1b77ec(0xede)]}},_0x33a161=_0xa2f98d[_0x1b77ec(0xb07)]['findIndex'](_0x3e6f89=>_0x3e6f89[_0x1b77ec(0xb0a)]===_0x1e86f1['timestamp']);_0x33a161>-0x1?_0xa2f98d[_0x1b77ec(0xb07)][_0x33a161]=_0x35b73e:_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1001)](_0x35b73e);const _0x1d4ace=await _0x1f8f7b(_0x35b73e,_0xa2f98d);document['body'][_0x1b77ec(0x7a0)](_0x4199f1)&&_0x4199f1[_0x1b77ec(0x1579)][_0x1b77ec(0x868)](_0x1d4ace,_0x4199f1);}continue;}case _0x1b77ec(0x9ea):_0x116dfb={..._0xd6a308,'content':String(_0x3804a0[_0x1b77ec(0xede)]||_0x3804a0[_0x1b77ec(0x74b)])};break;case _0x1b77ec(0x10c2):if(_0x3804a0[_0x1b77ec(0x14f1)]){const _0x3966aa=_0x16699d[_0x1b77ec(0x14a2)][_0x1b77ec(0x1402)](_0x429bab=>_0x429bab[_0x1b77ec(0x1467)]===_0x3804a0[_0x1b77ec(0x14f1)]);_0x3966aa?_0x116dfb={..._0xd6a308,'type':_0x1b77ec(0x10c2),'content':_0x3966aa[_0x1b77ec(0x9a8)],'meaning':_0x3966aa[_0x1b77ec(0x1467)]}:(console['warn'](_0x1b77ec(0xf8a)+_0x3804a0[_0x1b77ec(0x14f1)]+'\x22'),_0x116dfb={..._0xd6a308,'type':'text','content':'[表情:\x20'+_0x3804a0[_0x1b77ec(0x14f1)]+']'});}else console['warn'](_0x1b77ec(0x715),_0x3804a0),_0x116dfb={..._0xd6a308,'type':_0x1b77ec(0x10c2),'content':_0x3804a0[_0x1b77ec(0x9a8)],'meaning':'未知表情'};break;case'ai_image':_0x116dfb={..._0xd6a308,'type':_0x1b77ec(0x1281),'content':_0x3804a0[_0x1b77ec(0xe79)],'image_prompt':_0x3804a0[_0x1b77ec(0x5d9)]};break;case _0x1b77ec(0x10d4):_0x116dfb={..._0xd6a308,'type':_0x1b77ec(0x10d4),'content':_0x3804a0[_0x1b77ec(0xede)]};break;case _0x1b77ec(0x1514):_0x116dfb={..._0xd6a308,'type':_0x1b77ec(0x1514),'amount':_0x3804a0[_0x1b77ec(0xbd2)],'note':_0x3804a0['note'],'receiverName':_0x3804a0[_0x1b77ec(0x4df)]||'我'};break;case _0x1b77ec(0x29c):_0x116dfb={..._0xd6a308,'type':'waimai_request','productInfo':_0x3804a0[_0x1b77ec(0x890)],'amount':_0x3804a0['amount'],'status':'pending','countdownEndTime':Date[_0x1b77ec(0x1386)]()+0xf*0x3c*0x3e8};break;case _0x1b77ec(0xf8e):_0x116dfb={..._0xd6a308,'type':_0x1b77ec(0xf8e),'productInfo':_0x3804a0['productInfo'],'amount':_0x3804a0[_0x1b77ec(0xbd2)],'greeting':_0x3804a0[_0x1b77ec(0x14b0)],'recipientName':_0x3804a0['recipientName']||null};break;case _0x1b77ec(0xd5f):_0x116dfb={..._0xd6a308,..._0x3804a0};break;case _0x1b77ec(0x1141):try{console['log']('📸\x20NovelAI图片生成开始，AI提供的prompt:',_0x3804a0[_0x1b77ec(0xc4b)]);const _0x318b25=_0x4d36cb(_0xa2f98d['id']),_0x48dc4d=_0x3804a0[_0x1b77ec(0xc4b)]||_0x1b77ec(0xa36),_0x151236=_0x48dc4d+',\x20'+_0x318b25[_0x1b77ec(0x731)],_0x483dbf=_0x318b25[_0x1b77ec(0x1286)];console[_0x1b77ec(0x498)](_0x1b77ec(0x4ed)+(_0x318b25[_0x1b77ec(0x1105)]==='character'?_0x1b77ec(0xed8):'系统')+_0x1b77ec(0x456)),console[_0x1b77ec(0x498)](_0x1b77ec(0xcd0),_0x151236),console['log'](_0x1b77ec(0x50c),_0x483dbf);const _0x3bedb9=localStorage[_0x1b77ec(0x55f)](_0x1b77ec(0x14ce)),_0x29ed35=localStorage[_0x1b77ec(0x55f)](_0x1b77ec(0xf36))||_0x1b77ec(0x11bc),_0x270c4f=_0x186764();if(!_0x3bedb9)throw new Error(_0x1b77ec(0x13d3));const [_0x334381,_0x3a63c9]=_0x270c4f[_0x1b77ec(0x10d3)][_0x1b77ec(0x46f)]('x')['map'](Number);let _0x569ae7;_0x29ed35['includes'](_0x1b77ec(0x5b2))?_0x569ae7={'input':_0x151236,'model':_0x29ed35,'action':_0x1b77ec(0x110c),'parameters':{'params_version':0x3,'width':_0x334381,'height':_0x3a63c9,'scale':_0x270c4f[_0x1b77ec(0xd2e)],'sampler':_0x270c4f[_0x1b77ec(0x6ee)],'steps':_0x270c4f[_0x1b77ec(0xf33)],'seed':_0x270c4f[_0x1b77ec(0xa0f)]===-0x1?Math[_0x1b77ec(0x15b6)](Math[_0x1b77ec(0x59c)]()*0x2540be3ff):_0x270c4f[_0x1b77ec(0xa0f)],'n_samples':0x1,'ucPreset':_0x270c4f['uc_preset'],'qualityToggle':_0x270c4f[_0x1b77ec(0x13eb)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x1b77ec(0x41b),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x151236,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x483dbf,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x483dbf,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x569ae7={'input':_0x151236,'model':_0x29ed35,'action':_0x1b77ec(0x110c),'parameters':{'width':_0x334381,'height':_0x3a63c9,'scale':_0x270c4f[_0x1b77ec(0xd2e)],'sampler':_0x270c4f[_0x1b77ec(0x6ee)],'steps':_0x270c4f['steps'],'seed':_0x270c4f[_0x1b77ec(0xa0f)]===-0x1?Math[_0x1b77ec(0x15b6)](Math[_0x1b77ec(0x59c)]()*0x2540be3ff):_0x270c4f['seed'],'n_samples':0x1,'ucPreset':_0x270c4f[_0x1b77ec(0x65a)],'qualityToggle':_0x270c4f[_0x1b77ec(0x13eb)],'sm':_0x270c4f['smea'],'sm_dyn':_0x270c4f[_0x1b77ec(0xef6)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x1b77ec(0x9e2),'negative_prompt':_0x483dbf}};console[_0x1b77ec(0x498)](_0x1b77ec(0xead),_0x569ae7);let _0x11d23b;_0x29ed35[_0x1b77ec(0x1336)](_0x1b77ec(0x5b2))?_0x11d23b='https://image.novelai.net/ai/generate-image-stream':_0x11d23b=_0x1b77ec(0x1346);let _0x5c704e=_0x270c4f[_0x1b77ec(0x3ed)];_0x5c704e==='custom'&&(_0x5c704e=_0x270c4f[_0x1b77ec(0xbb4)]||'');_0x5c704e&&_0x5c704e!==''&&(_0x11d23b=_0x5c704e+encodeURIComponent(_0x11d23b));const _0x466ef5=await fetch(_0x11d23b,{'method':_0x1b77ec(0xdca),'headers':{'Content-Type':_0x1b77ec(0x479),'Authorization':'Bearer\x20'+_0x3bedb9},'body':JSON[_0x1b77ec(0x526)](_0x569ae7)});console[_0x1b77ec(0x498)]('Response\x20status:',_0x466ef5[_0x1b77ec(0x82c)]),console[_0x1b77ec(0x498)](_0x1b77ec(0x12f3),[..._0x466ef5['headers'][_0x1b77ec(0x6ea)]()]);if(!_0x466ef5['ok']){const _0x4dc9e1=await _0x466ef5[_0x1b77ec(0x9ea)]();console[_0x1b77ec(0xc3e)](_0x1b77ec(0x44b),_0x4dc9e1);throw new Error(_0x1b77ec(0x8fb)+_0x466ef5[_0x1b77ec(0x82c)]+_0x1b77ec(0xbc0)+_0x4dc9e1);}const _0xa60a4c=_0x466ef5[_0x1b77ec(0xa07)][_0x1b77ec(0xe8c)](_0x1b77ec(0x128c));console[_0x1b77ec(0x498)](_0x1b77ec(0x564),_0xa60a4c);let _0x23ff5d,_0x293260;if(_0xa60a4c&&_0xa60a4c[_0x1b77ec(0x1336)](_0x1b77ec(0xffa))){console[_0x1b77ec(0x498)](_0x1b77ec(0x40d));const _0xf0866e=await _0x466ef5[_0x1b77ec(0x9ea)]();console[_0x1b77ec(0x498)](_0x1b77ec(0x93d),_0xf0866e[_0x1b77ec(0xaf9)]);const _0x87209=_0xf0866e[_0x1b77ec(0x2a8)]()[_0x1b77ec(0x46f)]('\x0a');let _0x57ac68=null;for(let _0x104de7=_0x87209[_0x1b77ec(0xaf9)]-0x1;_0x104de7>=0x0;_0x104de7--){const _0x41631b=_0x87209[_0x104de7][_0x1b77ec(0x2a8)]();if(_0x41631b[_0x1b77ec(0x157f)](_0x1b77ec(0x11f3))&&_0x41631b!==_0x1b77ec(0x1134)){const _0x53048d=_0x41631b[_0x1b77ec(0xeca)](0x6);try{const _0x57e193=JSON[_0x1b77ec(0xde0)](_0x53048d);if(_0x57e193[_0x1b77ec(0x1546)]===_0x1b77ec(0x13cd)&&_0x57e193['image']){_0x57ac68=_0x57e193[_0x1b77ec(0x608)],console[_0x1b77ec(0x498)](_0x1b77ec(0xdf8));break;}if(_0x57e193[_0x1b77ec(0x92a)]){_0x57ac68=_0x57e193[_0x1b77ec(0x92a)],console[_0x1b77ec(0x498)](_0x1b77ec(0x3c3));break;}if(_0x57e193[_0x1b77ec(0x608)]){_0x57ac68=_0x57e193[_0x1b77ec(0x608)],console[_0x1b77ec(0x498)](_0x1b77ec(0x37e));break;}}catch(_0x55a0ab){_0x57ac68=_0x53048d,console['log'](_0x1b77ec(0xc0f));break;}}}if(!_0x57ac68)throw new Error(_0x1b77ec(0xf6b));const _0x2c928c=_0x57ac68[_0x1b77ec(0x157f)](_0x1b77ec(0xcdb)),_0x3e82b6=_0x57ac68['startsWith'](_0x1b77ec(0x1308));if(_0x2c928c||_0x3e82b6){console[_0x1b77ec(0x498)](_0x1b77ec(0xb87));const _0x4bc365=atob(_0x57ac68),_0xd942df=new Uint8Array(_0x4bc365[_0x1b77ec(0xaf9)]);for(let _0x43dd28=0x0;_0x43dd28<_0x4bc365[_0x1b77ec(0xaf9)];_0x43dd28++){_0xd942df[_0x43dd28]=_0x4bc365[_0x1b77ec(0x141f)](_0x43dd28);}const _0x569397=new Blob([_0xd942df],{'type':_0x2c928c?_0x1b77ec(0x13ce):'image/jpeg'});console[_0x1b77ec(0x498)](_0x1b77ec(0x306),_0x569397['size']);const _0x1874d3=new FileReader();_0x293260=await new Promise((_0x35f2c9,_0x1fcf30)=>{const _0x43b43e=_0x1b77ec;_0x1874d3[_0x43b43e(0x55b)]=()=>_0x35f2c9(_0x1874d3[_0x43b43e(0x22a)]),_0x1874d3[_0x43b43e(0x12eb)]=_0x1fcf30,_0x1874d3[_0x43b43e(0x5a5)](_0x569397);}),console[_0x1b77ec(0x498)](_0x1b77ec(0xa2d));}else{console['log'](_0x1b77ec(0x5fa));const _0xda8d0d=atob(_0x57ac68),_0xcba445=new Uint8Array(_0xda8d0d['length']);for(let _0x466a52=0x0;_0x466a52<_0xda8d0d[_0x1b77ec(0xaf9)];_0x466a52++){_0xcba445[_0x466a52]=_0xda8d0d[_0x1b77ec(0x141f)](_0x466a52);}_0x23ff5d=new Blob([_0xcba445]),console[_0x1b77ec(0x498)](_0x1b77ec(0x512),_0x23ff5d[_0x1b77ec(0x8ca)]);}}else _0x23ff5d=await _0x466ef5['blob'](),console[_0x1b77ec(0x498)](_0x1b77ec(0xa51),_0x23ff5d['type'],_0x1b77ec(0x10bf),_0x23ff5d[_0x1b77ec(0x8ca)]);if(!_0x293260&&_0x23ff5d)try{if(typeof JSZip===_0x1b77ec(0x490))throw new Error('JSZip库未加载，请刷新页面重试');const _0x3ce330=await JSZip[_0x1b77ec(0xe25)](_0x23ff5d);console[_0x1b77ec(0x498)](_0x1b77ec(0x7da),Object[_0x1b77ec(0x1cf)](_0x3ce330['files']));let _0x2e6389=null;for(let _0x393565 in _0x3ce330[_0x1b77ec(0x10b0)]){if(_0x393565['match'](/\.(png|jpg|jpeg|webp)$/i)){_0x2e6389=_0x3ce330[_0x1b77ec(0x10b0)][_0x393565],console[_0x1b77ec(0x498)](_0x1b77ec(0x10bc),_0x393565);break;}}if(!_0x2e6389)throw new Error(_0x1b77ec(0xc47));const _0x5bf26a=await _0x2e6389[_0x1b77ec(0x706)]('blob');console[_0x1b77ec(0x498)]('提取的图片大小:',_0x5bf26a[_0x1b77ec(0x8ca)]);const _0x2a3410=new FileReader();_0x293260=await new Promise((_0x58e01f,_0x29b010)=>{const _0x833ec0=_0x1b77ec;_0x2a3410['onloadend']=()=>_0x58e01f(_0x2a3410[_0x833ec0(0x22a)]),_0x2a3410['onerror']=_0x29b010,_0x2a3410[_0x833ec0(0x5a5)](_0x5bf26a);}),console[_0x1b77ec(0x498)]('✅\x20图片解压成功！');}catch(_0x1cfaaa){console[_0x1b77ec(0xc3e)](_0x1b77ec(0x10e9),_0x1cfaaa);throw new Error(_0x1b77ec(0x1482)+_0x1cfaaa[_0x1b77ec(0x74b)]);}console[_0x1b77ec(0x498)](_0x1b77ec(0x722)),_0x116dfb={..._0xd6a308,'type':_0x1b77ec(0x1141),'imageUrl':_0x293260,'prompt':_0x48dc4d,'fullPrompt':_0x151236};}catch(_0x23811d){console[_0x1b77ec(0xc3e)](_0x1b77ec(0x9b4),_0x23811d),_0x116dfb={..._0xd6a308,'content':'[图片生成失败:\x20'+_0x23811d[_0x1b77ec(0x74b)]+']'};}break;default:console[_0x1b77ec(0x9c1)]('收到了未知的AI指令类型:',_0x3804a0['type']);break;}if(_0x116dfb){_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1001)](_0x116dfb);!_0x15ab62&&(_0xa2f98d[_0x1b77ec(0x1300)]=(_0xa2f98d[_0x1b77ec(0x1300)]||0x0)+0x1);if(!_0x15ab62&&!_0x4c7602){let _0x38f166;switch(_0x116dfb[_0x1b77ec(0x4ae)]){case _0x1b77ec(0x1514):_0x38f166=_0x1b77ec(0xa2b);break;case _0x1b77ec(0x29c):_0x38f166='[收到一个外卖代付请求]';break;case _0x1b77ec(0x1281):_0x38f166='[图片]';break;case _0x1b77ec(0x10d4):_0x38f166=_0x1b77ec(0x445);break;case _0x1b77ec(0x10c2):_0x38f166=_0x116dfb[_0x1b77ec(0x14f1)]?_0x1b77ec(0x828)+_0x116dfb['meaning']+']':_0x1b77ec(0x7eb);break;case _0x1b77ec(0xd5f):_0x38f166=_0x116dfb[_0x1b77ec(0x13c5)]?'「'+_0x116dfb[_0x1b77ec(0x13c5)]+'」':'['+_0x116dfb[_0x1b77ec(0xe79)][_0x1b77ec(0xeca)](0x0,0x14)+'...]';break;default:_0x38f166=String(_0x116dfb[_0x1b77ec(0xede)]||'');}const _0x58d806=_0xa2f98d['isGroup']?_0x116dfb[_0x1b77ec(0x14ee)]+':\x20'+_0x38f166:_0x38f166;_0x2e32a5(_0x22b913,_0x58d806['substring'](0x0,0x28)+(_0x58d806[_0x1b77ec(0xaf9)]>0x28?_0x1b77ec(0x76d):'')),_0x4c7602=!![];}_0x15ab62&&(_0x4b384e(_0x116dfb,_0xa2f98d),await new Promise(_0x4d7a63=>setTimeout(_0x4d7a63,Math[_0x1b77ec(0x59c)]()*0x708+0x3e8)));}}_0x442133&&_0x1c6d6b[_0x1b77ec(0x658)]&&(_0x1c6d6b[_0x1b77ec(0xab7)]=![],_0x1c6d6b[_0x1b77ec(0x112b)]['length']>0x0?_0x294d96():(_0x1c6d6b={..._0x1c6d6b,'isAwaitingResponse':![],'participants':[]},_0x58c3b1('chat-interface-screen'),alert(_0x1b77ec(0xd3a))));if(_0x2d0887){await _0x45c50a();return;}await _0x6ed281[_0x1b77ec(0x1474)][_0x1b77ec(0x90c)](_0xa2f98d);const _0x3ced3c=_0xea8a44[_0x1b77ec(0x1502)](_0x4876d0=>_0x4876d0[_0x1b77ec(0x4ae)]===_0x1b77ec(0x65f)||_0x4876d0[_0x1b77ec(0x4ae)]===_0x1b77ec(0x11e9)||_0x4876d0[_0x1b77ec(0x4ae)]===_0x1b77ec(0x123d)||_0x4876d0[_0x1b77ec(0x4ae)]==='repost');_0x3ced3c&&(console[_0x1b77ec(0x498)](_0x1b77ec(0x124f)),await _0x4d3afb());}catch(_0x559eaa){_0xa2f98d[_0x1b77ec(0xb07)]=_0xa2f98d[_0x1b77ec(0xb07)][_0x1b77ec(0x1c0)](_0x48f32b=>!_0x48f32b['isTemporary']),!_0xa2f98d[_0x1b77ec(0x1173)]&&_0xa2f98d[_0x1b77ec(0x1120)]?.[_0x1b77ec(0x82c)]===_0x1b77ec(0x21b)?(_0xa2f98d[_0x1b77ec(0x1120)][_0x1b77ec(0x82c)]='blocked_by_ai',await _0x104485(_0x1b77ec(0x349),_0x1b77ec(0x459)+_0x559eaa[_0x1b77ec(0x74b)])):await _0x104485('API\x20调用失败','发生了一个错误，AI未能成功响应。\x0a\x0a错误详情:\x0a'+_0x559eaa['message']),!_0xa2f98d[_0x1b77ec(0x1173)]&&_0xa2f98d[_0x1b77ec(0x1120)]?.[_0x1b77ec(0x82c)]===_0x1b77ec(0x154f)&&await _0x6ed281['chats'][_0x1b77ec(0x90c)](_0xa2f98d),_0x1c6d6b[_0x1b77ec(0xab7)]=![];}finally{_0xcc3e17(_0x22b913,![]),_0xa2f98d[_0x1b77ec(0x1173)]?_0x531e73&&(_0x531e73[_0x1b77ec(0xf74)][_0x1b77ec(0x11fd)]=_0x1b77ec(0x12fe)):_0x48dcf9&&_0x16699d[_0x1b77ec(0x1474)][_0x22b913]&&(_0x48dcf9['style'][_0x1b77ec(0x9a2)]=0x0,setTimeout(()=>{const _0x2b8f5a=_0x1b77ec;_0x48dcf9[_0x2b8f5a(0x10cb)]=_0x16699d[_0x2b8f5a(0x1474)][_0x22b913]['name'],_0x48dcf9[_0x2b8f5a(0xd54)][_0x2b8f5a(0xf89)](_0x2b8f5a(0xb24)),_0x48dcf9[_0x2b8f5a(0xf74)][_0x2b8f5a(0x9a2)]=0x1;},0xc8)),_0x2d33eb(),_0x399f4e&&_0x2d6af6(_0x22b913),_0xb2ff26();}}async function _0x3079d2(_0x29197d){const _0x2c3370=_0x3ce1fb;if(!_0x16699d['activeChatId'])return;const _0x1b3fd6=_0x16699d['chats'][_0x16699d[_0x2c3370(0xf5a)]],_0x3af516={'role':_0x2c3370(0xaeb),'content':_0x29197d[_0x2c3370(0x9a8)],'meaning':_0x29197d['name'],'timestamp':Date[_0x2c3370(0x1386)]()};_0x1b3fd6[_0x2c3370(0xb07)][_0x2c3370(0x1001)](_0x3af516),await _0x6ed281['chats'][_0x2c3370(0x90c)](_0x1b3fd6),_0x4b384e(_0x3af516,_0x1b3fd6),_0x2d33eb(),document['getElementById']('sticker-panel')[_0x2c3370(0xd54)][_0x2c3370(0xf89)]('visible');}async function _0x3ef53a(){const _0x1df2ce=_0x3ce1fb;if(!_0x16699d[_0x1df2ce(0xf5a)])return;const _0x18f593=document['getElementById']('transfer-amount'),_0x1b9e92=document[_0x1df2ce(0x948)](_0x1df2ce(0x3e4)),_0x2e595f=parseFloat(_0x18f593[_0x1df2ce(0x5bc)]),_0x240a38=_0x1b9e92[_0x1df2ce(0x5bc)][_0x1df2ce(0x2a8)]();if(isNaN(_0x2e595f)||_0x2e595f<0x0){alert(_0x1df2ce(0x577));return;}const _0x4ec08c=_0x16699d['chats'][_0x16699d[_0x1df2ce(0xf5a)]],_0x44e0f3=_0x4ec08c[_0x1df2ce(0x1173)]?_0x4ec08c[_0x1df2ce(0x7fd)][_0x1df2ce(0x1371)]||'我':'我',_0x1a0bc7=_0x4ec08c['isGroup']?'群聊':_0x4ec08c[_0x1df2ce(0x1467)],_0x551be1={'role':'user','type':'transfer','amount':_0x2e595f,'note':_0x240a38,'senderName':_0x44e0f3,'receiverName':_0x1a0bc7,'timestamp':Date[_0x1df2ce(0x1386)]()};_0x4ec08c['history'][_0x1df2ce(0x1001)](_0x551be1),await _0x6ed281[_0x1df2ce(0x1474)]['put'](_0x4ec08c),_0x4b384e(_0x551be1,_0x4ec08c),_0x2d33eb(),document[_0x1df2ce(0x948)](_0x1df2ce(0x1277))['classList']['remove'](_0x1df2ce(0xfcb)),_0x18f593[_0x1df2ce(0x5bc)]='',_0x1b9e92[_0x1df2ce(0x5bc)]='';}async function _0x4d2565(){const _0x2a2041=_0x3ce1fb;if(!_0x16699d['activeChatId'])return;const _0x502d70=document['getElementById'](_0x2a2041(0x2cf)),_0x6b41ce=document['getElementById'](_0x2a2041(0x336)),_0x37491c=_0x502d70[_0x2a2041(0x5bc)]['trim'](),_0x4605c7=parseFloat(_0x6b41ce[_0x2a2041(0x5bc)]);if(!_0x37491c||isNaN(_0x4605c7)||_0x4605c7<=0x0){alert(_0x2a2041(0x14f0));return;}const _0x29ff77=_0x16699d[_0x2a2041(0x1474)][_0x16699d[_0x2a2041(0xf5a)]],_0x6cd85f=Date[_0x2a2041(0x1386)](),_0x1abe4b=_0x29ff77[_0x2a2041(0x1173)]?_0x29ff77[_0x2a2041(0x7fd)][_0x2a2041(0x1371)]||'我':'我',_0x238b3c={'role':_0x2a2041(0xaeb),'senderName':_0x1abe4b,'type':_0x2a2041(0xf8e),'productInfo':_0x37491c,'amount':_0x4605c7,'timestamp':_0x6cd85f};_0x29ff77['history'][_0x2a2041(0x1001)](_0x238b3c);const _0x3b442b={'role':_0x2a2041(0x11af),'content':_0x2a2041(0x563)+_0x1abe4b+_0x2a2041(0xa1d)+_0x37491c+_0x2a2041(0xa38)+_0x4605c7+_0x2a2041(0xe9c),'timestamp':_0x6cd85f+0x1,'isHidden':!![]};_0x29ff77[_0x2a2041(0xb07)][_0x2a2041(0x1001)](_0x3b442b),await _0x6ed281[_0x2a2041(0x1474)][_0x2a2041(0x90c)](_0x29ff77),_0x4b384e(_0x238b3c,_0x29ff77),_0x2d33eb(),_0x502d70[_0x2a2041(0x5bc)]='',_0x6b41ce[_0x2a2041(0x5bc)]='',document['getElementById'](_0x2a2041(0x15a2))[_0x2a2041(0xd54)]['remove'](_0x2a2041(0xfcb));}async function _0x151777(){const _0x3cbaaa=_0x3ce1fb;if(!_0x16699d[_0x3cbaaa(0xf5a)])return;const _0x3dc218=await _0x41b9fc(_0x3cbaaa(0x101a),_0x3cbaaa(0xd2d),'');if(!_0x3dc218||!_0x3dc218['trim']())return;const _0x3f493e=_0x3cbaaa(0xef7),_0x423002=_0x16699d[_0x3cbaaa(0x1474)][_0x16699d['activeChatId']],_0x327436={'role':_0x3cbaaa(0xaeb),'type':'location_share','content':_0x3dc218[_0x3cbaaa(0x2a8)](),'imageUrl':_0x3f493e,'timestamp':Date[_0x3cbaaa(0x1386)]()};_0x423002['history'][_0x3cbaaa(0x1001)](_0x327436),await _0x6ed281[_0x3cbaaa(0x1474)]['put'](_0x423002),_0x4b384e(_0x327436,_0x423002),_0x2d33eb();}function _0x24304d(_0x1bf8ec){const _0xc7f13f=_0x3ce1fb;if(_0x202b41)return;_0x202b41=!![],document[_0xc7f13f(0x948)]('chat-interface-screen')['classList'][_0xc7f13f(0xbd0)](_0xc7f13f(0x105f)),_0x5e9a4b(_0x1bf8ec);}function _0x402014(){const _0x3f5019=_0x3ce1fb;_0x5f5407();if(!_0x202b41)return;_0x202b41=![],document[_0x3f5019(0x948)](_0x3f5019(0x152e))['classList'][_0x3f5019(0xf89)]('selection-mode'),_0x355e3f[_0x3f5019(0x427)](_0x3c041e=>{const _0x69a3db=_0x3f5019,_0x1b78ff=document[_0x69a3db(0xfeb)](_0x69a3db(0x12bb)+_0x3c041e+'\x22]');if(_0x1b78ff)_0x1b78ff['classList'][_0x69a3db(0xf89)](_0x69a3db(0xd56));}),_0x355e3f[_0x3f5019(0x99d)]();}function _0x5e9a4b(_0x2dc058){const _0x56b947=_0x3ce1fb,_0x1ba174=document[_0x56b947(0xfeb)](_0x56b947(0x12bb)+_0x2dc058+'\x22]');if(!_0x1ba174)return;_0x355e3f[_0x56b947(0xda1)](_0x2dc058)?(_0x355e3f[_0x56b947(0x869)](_0x2dc058),_0x1ba174[_0x56b947(0xd54)][_0x56b947(0xf89)](_0x56b947(0xd56))):(_0x355e3f[_0x56b947(0xbd0)](_0x2dc058),_0x1ba174[_0x56b947(0xd54)][_0x56b947(0xbd0)](_0x56b947(0xd56))),document[_0x56b947(0x948)](_0x56b947(0xa67))[_0x56b947(0x10cb)]=_0x56b947(0x43d)+_0x355e3f[_0x56b947(0x8ca)]+'\x20条',_0x355e3f[_0x56b947(0x8ca)]===0x0&&_0x402014();}function _0x159366(_0x23e487,_0x1d045d){const _0x2f3edc=_0x3ce1fb;let _0x3ee5b7;const _0x4246f6=_0x5ad7fc=>{const _0x1ef544=_0x6c9e;if(_0x202b41)return;_0x5ad7fc[_0x1ef544(0x38f)](),_0x3ee5b7=window[_0x1ef544(0x234)](()=>_0x1d045d(_0x5ad7fc),0x1f4);},_0x35b32e=()=>clearTimeout(_0x3ee5b7);_0x23e487[_0x2f3edc(0x339)](_0x2f3edc(0xf08),_0x4246f6),_0x23e487[_0x2f3edc(0x339)](_0x2f3edc(0x637),_0x35b32e),_0x23e487[_0x2f3edc(0x339)](_0x2f3edc(0x6d4),_0x35b32e),_0x23e487[_0x2f3edc(0x339)](_0x2f3edc(0xea1),_0x4246f6,{'passive':!![]}),_0x23e487[_0x2f3edc(0x339)](_0x2f3edc(0xe38),_0x35b32e),_0x23e487['addEventListener']('touchmove',_0x35b32e);}async function _0x5de7ac(){const _0x1aca88=_0x3ce1fb,_0x3cf685=_0x16699d[_0x1aca88(0xf5a)];if(!_0x3cf685)return;if(!_0x49c6c5[_0x1aca88(0x1032)]){_0x4aa635(_0x3cf685);return;}if(_0x49c6c5[_0x1aca88(0xf5a)]===_0x3cf685)document[_0x1aca88(0x948)](_0x1aca88(0x71e))['classList'][_0x1aca88(0xbd0)]('visible');else{const _0x177c77=_0x16699d['chats'][_0x49c6c5[_0x1aca88(0xf5a)]]?.[_0x1aca88(0x1467)]||'未知',_0x1dbd76=_0x16699d['chats'][_0x3cf685]?.['name']||'当前',_0x16cacf=await _0xa6b74a('切换听歌对象',_0x1aca88(0xaf6)+_0x177c77+_0x1aca88(0x158b)+_0x1dbd76+_0x1aca88(0x43e),{'confirmButtonClass':_0x1aca88(0x5e8)});_0x16cacf&&(await _0x528b67(!![]),await new Promise(_0x21dabe=>setTimeout(_0x21dabe,0x32)),_0x4aa635(_0x3cf685));}}async function _0x4aa635(_0x4fde42){const _0x5ee113=_0x3ce1fb,_0x565255=_0x16699d[_0x5ee113(0x1474)][_0x4fde42];if(!_0x565255)return;_0x49c6c5[_0x5ee113(0x151b)]=_0x565255['musicData']['totalTime']||0x0,_0x49c6c5[_0x5ee113(0x1032)]=!![],_0x49c6c5[_0x5ee113(0xf5a)]=_0x4fde42;_0x49c6c5[_0x5ee113(0x12c8)][_0x5ee113(0xaf9)]>0x0?_0x49c6c5[_0x5ee113(0x73a)]=0x0:_0x49c6c5[_0x5ee113(0x73a)]=-0x1;if(_0x49c6c5[_0x5ee113(0x904)])clearInterval(_0x49c6c5[_0x5ee113(0x904)]);_0x49c6c5['timerId']=setInterval(()=>{const _0x39a90a=_0x5ee113;_0x49c6c5[_0x39a90a(0x3aa)]&&(_0x49c6c5['totalElapsedTime']++,_0x645235());},0x3e8),_0x409bf9(),_0x39f26c(),document['getElementById'](_0x5ee113(0x71e))[_0x5ee113(0xd54)][_0x5ee113(0xbd0)](_0x5ee113(0xfcb));}async function _0x528b67(_0x192564=!![]){const _0x1b1d3d=_0x3ce1fb;if(!_0x49c6c5[_0x1b1d3d(0x1032)])return;const _0x5b4371=_0x49c6c5[_0x1b1d3d(0xf5a)];document[_0x1b1d3d(0x948)](_0x1b1d3d(0xa34))[_0x1b1d3d(0xd54)][_0x1b1d3d(0xf89)](_0x1b1d3d(0xfcb));const _0xe25beb=async()=>{const _0x3f0ef6=_0x1b1d3d;if(_0x49c6c5[_0x3f0ef6(0x904)])clearInterval(_0x49c6c5[_0x3f0ef6(0x904)]);if(_0x49c6c5[_0x3f0ef6(0x3aa)])_0x204b9a[_0x3f0ef6(0xf8c)]();if(_0x192564&&_0x5b4371&&_0x16699d[_0x3f0ef6(0x1474)][_0x5b4371]){const _0x5d9ba6=_0x16699d[_0x3f0ef6(0x1474)][_0x5b4371];_0x5d9ba6[_0x3f0ef6(0xda7)][_0x3f0ef6(0x1f5)]=_0x49c6c5[_0x3f0ef6(0x151b)],await _0x6ed281['chats'][_0x3f0ef6(0x90c)](_0x5d9ba6);}_0x49c6c5[_0x3f0ef6(0x1032)]=![],_0x49c6c5[_0x3f0ef6(0xf5a)]=null,_0x49c6c5[_0x3f0ef6(0x151b)]=0x0,_0x49c6c5['timerId']=null,_0x53687b(_0x5b4371,!![]);};_0x5ddc20(_0xe25beb);}function _0x3b9b37(){_0x5ddc20();}function _0x53687b(_0x56387e,_0x333a33=![]){const _0x563317=_0x3ce1fb,_0x28b92c=document['querySelector'](_0x563317(0x8f8));if(!_0x28b92c)return;if(_0x333a33||!_0x49c6c5['isActive']||_0x49c6c5['activeChatId']!==_0x56387e){_0x28b92c[_0x563317(0x147d)]=_0x563317(0x8f5),_0x28b92c[_0x563317(0x35b)]='';return;}_0x28b92c[_0x563317(0x147d)]='https://i.postimg.cc/D0pq6qS2/E30078-DC-8-B99-4-C01-AFDA-74728-DBF7-BEA.png',_0x28b92c[_0x563317(0xd54)][_0x563317(0xbd0)](_0x563317(0x12a1));if(_0x49c6c5['isPlaying'])_0x28b92c[_0x563317(0xd54)]['remove'](_0x563317(0x106d));else _0x28b92c[_0x563317(0xd54)]['add'](_0x563317(0x106d));}window[_0x3ce1fb(0x12e9)]=_0x53687b;function _0x409bf9(){const _0x45a24d=_0x3ce1fb;_0x53687b(_0x49c6c5[_0x45a24d(0xf5a)]),_0x645235();const _0x450d83=document[_0x45a24d(0x948)](_0x45a24d(0x113d)),_0x18a029=document[_0x45a24d(0x948)]('music-player-artist'),_0x365d0e=document[_0x45a24d(0x948)](_0x45a24d(0x2d3));if(_0x49c6c5[_0x45a24d(0x73a)]>-0x1&&_0x49c6c5['playlist']['length']>0x0){const _0x2b426b=_0x49c6c5['playlist'][_0x49c6c5[_0x45a24d(0x73a)]];_0x450d83['textContent']=_0x2b426b[_0x45a24d(0x1467)],_0x18a029[_0x45a24d(0x10cb)]=_0x2b426b['artist'];}else _0x450d83[_0x45a24d(0x10cb)]='请添加歌曲',_0x18a029[_0x45a24d(0x10cb)]='...';_0x365d0e[_0x45a24d(0x10cb)]=_0x49c6c5['isPlaying']?'❚❚':'▶';}function _0x645235(){const _0x4325d5=_0x3ce1fb,_0x5ed8c8=(_0x49c6c5[_0x4325d5(0x151b)]/0xe10)[_0x4325d5(0xd69)](0x1);document[_0x4325d5(0x948)]('music-time-counter')[_0x4325d5(0x10cb)]=_0x4325d5(0xed0)+_0x5ed8c8+'小时';}function _0x39f26c(){const _0x34acfd=_0x3ce1fb,_0x3b6dae=document['getElementById'](_0x34acfd(0xa06));_0x3b6dae[_0x34acfd(0xb6f)]='';if(_0x49c6c5[_0x34acfd(0x12c8)][_0x34acfd(0xaf9)]===0x0){_0x3b6dae['innerHTML']=_0x34acfd(0x1048);return;}_0x49c6c5[_0x34acfd(0x12c8)][_0x34acfd(0x427)]((_0x82011a,_0x523012)=>{const _0x1aed6a=_0x34acfd,_0xde442b=document[_0x1aed6a(0x1497)](_0x1aed6a(0x379));_0xde442b[_0x1aed6a(0x35b)]='playlist-item';if(_0x523012===_0x49c6c5[_0x1aed6a(0x73a)])_0xde442b['classList']['add']('playing');_0xde442b[_0x1aed6a(0xb6f)]=_0x1aed6a(0xa30)+_0x82011a[_0x1aed6a(0x1467)]+_0x1aed6a(0x1531)+_0x82011a['artist']+_0x1aed6a(0x107d)+_0x523012+_0x1aed6a(0x3f2)+_0x523012+_0x1aed6a(0x774)+_0x523012+'\x22>背景</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20delete-track-btn\x22\x20data-index=\x22'+_0x523012+_0x1aed6a(0x1374),_0xde442b[_0x1aed6a(0xfeb)](_0x1aed6a(0x34d))['addEventListener'](_0x1aed6a(0x4f6),()=>_0x583698(_0x523012)),_0x3b6dae[_0x1aed6a(0x6b6)](_0xde442b);});}async function _0x169a5e(){const _0x1e99ac=_0x3ce1fb;if(_0x204b9a[_0x1e99ac(0x106d)]){if(_0x49c6c5[_0x1e99ac(0x73a)]===-0x1&&_0x49c6c5[_0x1e99ac(0x12c8)][_0x1e99ac(0xaf9)]>0x0)_0x583698(0x0);else _0x49c6c5[_0x1e99ac(0x73a)]>-0x1&&_0x583698(_0x49c6c5[_0x1e99ac(0x73a)]);}else _0x204b9a[_0x1e99ac(0xf8c)](),await _0x20cbe6(_0x1e99ac(0x123b));}function _0x58f0d(){const _0x49a3d5=_0x3ce1fb;if(_0x49c6c5[_0x49a3d5(0x12c8)][_0x49a3d5(0xaf9)]===0x0)return;let _0x4fbc9e;switch(_0x49c6c5['playMode']){case'random':_0x4fbc9e=Math[_0x49a3d5(0x15b6)](Math[_0x49a3d5(0x59c)]()*_0x49c6c5[_0x49a3d5(0x12c8)][_0x49a3d5(0xaf9)]);break;case _0x49a3d5(0xc3c):_0x583698(_0x49c6c5[_0x49a3d5(0x73a)]);return;case _0x49a3d5(0x12e7):default:_0x4fbc9e=(_0x49c6c5['currentIndex']+0x1)%_0x49c6c5['playlist'][_0x49a3d5(0xaf9)];break;}_0x583698(_0x4fbc9e);}function _0x540888(){const _0x32854c=_0x3ce1fb;if(_0x49c6c5['playlist'][_0x32854c(0xaf9)]===0x0)return;const _0xaf9cbe=(_0x49c6c5[_0x32854c(0x73a)]-0x1+_0x49c6c5[_0x32854c(0x12c8)][_0x32854c(0xaf9)])%_0x49c6c5[_0x32854c(0x12c8)][_0x32854c(0xaf9)];_0x583698(_0xaf9cbe);}function _0x479b9c(){const _0x9b52bc=_0x3ce1fb,_0x26505e=[_0x9b52bc(0x12e7),_0x9b52bc(0x59c),_0x9b52bc(0xc3c)],_0x5a8d7f=_0x26505e['indexOf'](_0x49c6c5[_0x9b52bc(0x33c)]);_0x49c6c5[_0x9b52bc(0x33c)]=_0x26505e[(_0x5a8d7f+0x1)%_0x26505e['length']],document[_0x9b52bc(0x948)](_0x9b52bc(0x707))['textContent']={'order':'顺序','random':'随机','single':'单曲'}[_0x49c6c5[_0x9b52bc(0x33c)]];}async function _0x4da8cc(){const _0x575d52=_0x3ce1fb,_0x52a36b=await _0x41b9fc(_0x575d52(0x8f2),'请输入歌曲的URL','',_0x575d52(0x9a8));if(!_0x52a36b)return;const _0x54132e=await _0x41b9fc(_0x575d52(0x1bd),_0x575d52(0x39f));if(!_0x54132e)return;const _0xded41=await _0x41b9fc(_0x575d52(0x1bd),_0x575d52(0x1357));if(!_0xded41)return;_0x49c6c5[_0x575d52(0x12c8)][_0x575d52(0x1001)]({'name':_0x54132e,'artist':_0xded41,'src':_0x52a36b,'isLocal':![]}),await _0x26f02f(),_0x39f26c(),_0x49c6c5[_0x575d52(0x73a)]===-0x1&&(_0x49c6c5['currentIndex']=_0x49c6c5[_0x575d52(0x12c8)]['length']-0x1,_0x409bf9());}async function _0x5db7ff(_0xf72df4){const _0x396562=_0x3ce1fb,_0x4c835b=_0xf72df4['target']['files'];if(!_0x4c835b[_0x396562(0xaf9)])return;for(const _0x4f44dc of _0x4c835b){let _0x533f2d=_0x4f44dc[_0x396562(0x1467)][_0x396562(0x14e9)](/\.[^/.]+$/,'');_0x533f2d=await _0x41b9fc(_0x396562(0x1bd),'请输入歌名',_0x533f2d);if(_0x533f2d===null)continue;const _0x5aca16=await _0x41b9fc('歌曲信息',_0x396562(0x1357),_0x396562(0xc8e));if(_0x5aca16===null)continue;const _0x6ab404=await _0x4f44dc[_0x396562(0x767)]();let _0x4b2468='';const _0x4e29e3=await _0xa6b74a(_0x396562(0x744),'要为《'+_0x533f2d+'》添加歌词吗？');_0x4e29e3&&(_0x4b2468=await _0x6572e5()||''),_0x49c6c5[_0x396562(0x12c8)][_0x396562(0x1001)]({'name':_0x533f2d,'artist':_0x5aca16,'src':_0x6ab404,'fileType':_0x4f44dc['type'],'isLocal':!![],'lrcContent':_0x4b2468,'cover':_0x396562(0xfe5)});}await _0x26f02f(),_0x39f26c(),_0x49c6c5[_0x396562(0x73a)]===-0x1&&_0x49c6c5[_0x396562(0x12c8)][_0x396562(0xaf9)]>0x0&&(_0x49c6c5['currentIndex']=0x0,_0x409bf9()),_0xf72df4[_0x396562(0xa50)][_0x396562(0x5bc)]=null;}async function _0x583698(_0x243829){const _0x5e5d87=_0x3ce1fb;if(_0x243829<0x0||_0x243829>=_0x49c6c5[_0x5e5d87(0x12c8)][_0x5e5d87(0xaf9)])return;_0x204b9a[_0x5e5d87(0xf8c)](),_0x49c6c5[_0x5e5d87(0x73a)]=_0x243829;const _0x4cd862=_0x49c6c5[_0x5e5d87(0x12c8)][_0x243829],_0x1b28b4=_0x16699d[_0x5e5d87(0x1474)][_0x49c6c5[_0x5e5d87(0xf5a)]],_0x499485=document[_0x5e5d87(0x948)]('music-player-avatar-display');if(_0x1b28b4&&_0x499485){_0x499485[_0x5e5d87(0xb6f)]='';const _0x4ab259=_0x1b28b4[_0x5e5d87(0x1173)]?_0x1b28b4['members'][_0x5e5d87(0x1402)](_0x229545=>_0x229545[_0x5e5d87(0x628)]===_0x4cd862['artist'])?.[_0x5e5d87(0x63e)]||_0x202ba5:_0x1b28b4['settings'][_0x5e5d87(0x156d)]||_0x202ba5,_0x2ba451=_0x1b28b4['settings'][_0x5e5d87(0xb09)]||_0x202ba5,_0x45fd5a=document[_0x5e5d87(0x1497)](_0x5e5d87(0x1183));_0x45fd5a[_0x5e5d87(0x147d)]=_0x4ab259,_0x45fd5a[_0x5e5d87(0x35b)]=_0x5e5d87(0x1fb),_0x45fd5a[_0x5e5d87(0xc3a)]=_0x5e5d87(0xff3),_0x499485[_0x5e5d87(0x6b6)](_0x45fd5a);const _0x383869=document[_0x5e5d87(0x1497)](_0x5e5d87(0x1183));_0x383869[_0x5e5d87(0x147d)]=_0x2ba451,_0x383869[_0x5e5d87(0x35b)]=_0x5e5d87(0x1fb),_0x383869['alt']='User\x20Avatar',_0x499485['appendChild'](_0x383869);}const _0x3298f0=document['querySelector'](_0x5e5d87(0x33e)),_0xa80cd5=document[_0x5e5d87(0x948)](_0x5e5d87(0x8e3));_0x3298f0&&(_0x3298f0[_0x5e5d87(0xf74)][_0x5e5d87(0x121e)](_0x5e5d87(0xc65),_0x4cd862[_0x5e5d87(0x7c2)]?'url('+_0x4cd862[_0x5e5d87(0x7c2)]+')':'none'),_0x3298f0[_0x5e5d87(0xd54)]['toggle'](_0x5e5d87(0xcf8),!!_0x4cd862[_0x5e5d87(0xbc3)]));_0xa80cd5&&_0xa80cd5[_0x5e5d87(0xd54)]['toggle'](_0x5e5d87(0x115e),!!_0x4cd862['isBgClear']);document[_0x5e5d87(0x948)](_0x5e5d87(0x14f6))[_0x5e5d87(0xd54)][_0x5e5d87(0xf89)](_0x5e5d87(0xed5));const _0x45d66f=document['getElementById']('music-player-cover');_0x45d66f&&(_0x45d66f[_0x5e5d87(0x147d)]=_0x4cd862[_0x5e5d87(0xefe)]||'https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg');await _0x20cbe6('将歌曲切换为了《'+_0x4cd862[_0x5e5d87(0x1467)]+'》'),_0x49c6c5[_0x5e5d87(0x68d)]=_0x1192f8(_0x4cd862[_0x5e5d87(0xc1b)]||''),_0x25adec();const _0x3d7dcb=document[_0x5e5d87(0x948)](_0x5e5d87(0x1204));_0x3d7dcb&&(!_0x49c6c5[_0x5e5d87(0x68d)]||_0x49c6c5[_0x5e5d87(0x68d)][_0x5e5d87(0xaf9)]===0x0?_0x3d7dcb[_0x5e5d87(0x10cb)]='纯音乐，请欣赏':_0x3d7dcb['textContent']='♪\x20♪\x20♪');if(_0x4cd862[_0x5e5d87(0x4ca)]&&_0x4cd862[_0x5e5d87(0x147d)]instanceof ArrayBuffer){const _0xd9a14a=new Blob([_0x4cd862['src']],{'type':_0x4cd862['fileType']||_0x5e5d87(0xac1)});_0x204b9a[_0x5e5d87(0x147d)]=URL['createObjectURL'](_0xd9a14a);}else{if(_0x4cd862[_0x5e5d87(0x4ca)]&&_0x4cd862[_0x5e5d87(0x147d)]instanceof Blob)_0x204b9a[_0x5e5d87(0x147d)]=URL[_0x5e5d87(0x91d)](_0x4cd862[_0x5e5d87(0x147d)]);else{if(!_0x4cd862[_0x5e5d87(0x4ca)])_0x204b9a['src']=_0x4cd862[_0x5e5d87(0x147d)];else{console['error'](_0x5e5d87(0xc96),_0x4cd862);return;}}}const _0x460aba=_0x204b9a[_0x5e5d87(0x293)]();_0x460aba!==undefined&&_0x460aba[_0x5e5d87(0x1061)](_0x40cd8a=>{const _0x105ed6=_0x5e5d87;if(_0x40cd8a['name']==='NotAllowedError')console[_0x105ed6(0x9c1)](_0x105ed6(0xdfd)),_0x204b9a[_0x105ed6(0xf8c)](),_0x104485(_0x105ed6(0xc6d),'由于浏览器安全限制，AI切换的歌曲无法自动播放。请手动点击播放按钮\x20▶\x20继续欣赏。');else _0x40cd8a[_0x105ed6(0x1467)]!=='AbortError'&&console[_0x105ed6(0xc3e)](_0x105ed6(0x5fc),_0x40cd8a);});_0x39f26c(),_0x409bf9();const _0x45b72a=document[_0x5e5d87(0xae6)][_0x5e5d87(0xd54)]['contains'](_0x5e5d87(0x6fe)),_0x119024=_0x16699d['globalSettings'][_0x5e5d87(0x2b7)]||![],_0x54a2cf=document[_0x5e5d87(0x948)]('global-lyrics-bar');_0x45b72a||_0x119024?(phoneScreenForIsland['classList']['add'](_0x5e5d87(0x811)),islandAlbumArt[_0x5e5d87(0x147d)]=_0x4cd862[_0x5e5d87(0xefe)]||_0x5e5d87(0xfe5),_0x54a2cf[_0x5e5d87(0xd54)][_0x5e5d87(0xf89)](_0x5e5d87(0xfcb))):(phoneScreenForIsland['classList']['remove'](_0x5e5d87(0x811)),_0x49c6c5[_0x5e5d87(0x68d)]&&_0x49c6c5[_0x5e5d87(0x68d)][_0x5e5d87(0xaf9)]>0x0?(_0x54a2cf[_0x5e5d87(0x10cb)]='♪',_0x54a2cf['classList'][_0x5e5d87(0xbd0)](_0x5e5d87(0xfcb))):_0x54a2cf[_0x5e5d87(0xd54)][_0x5e5d87(0xf89)](_0x5e5d87(0xfcb)));}async function _0x2d0795(_0x513136){const _0x150a5b=_0x3ce1fb;if(_0x513136<0x0||_0x513136>=_0x49c6c5[_0x150a5b(0x12c8)][_0x150a5b(0xaf9)])return;const _0xcabc4e=await _0x9286bb('更换歌曲背景',[{'text':_0x150a5b(0x1a1),'value':'local'},{'text':_0x150a5b(0x500),'value':_0x150a5b(0x9a8)}]);let _0x1e1117=null;if(_0xcabc4e==='local')_0x1e1117=await _0x2c96d6();else _0xcabc4e===_0x150a5b(0x9a8)&&(_0x1e1117=await _0x41b9fc(_0x150a5b(0x9c4),_0x150a5b(0xcb6),'',_0x150a5b(0x9a8)));if(_0x1e1117&&_0x1e1117[_0x150a5b(0x2a8)]()){_0x49c6c5[_0x150a5b(0x12c8)][_0x513136]['background']=_0x1e1117[_0x150a5b(0x2a8)](),await _0x26f02f();if(_0x49c6c5[_0x150a5b(0x73a)]===_0x513136){const _0x51c98d=document[_0x150a5b(0xfeb)](_0x150a5b(0x33e));_0x51c98d['style'][_0x150a5b(0x121e)](_0x150a5b(0xc65),_0x150a5b(0x4f1)+_0x1e1117[_0x150a5b(0x2a8)]()+')');}await _0x104485('成功',_0x150a5b(0xaf5));}}async function _0x33da3b(_0x8bab39){const _0x1eb1f9=_0x3ce1fb;if(_0x8bab39<0x0||_0x8bab39>=_0x49c6c5[_0x1eb1f9(0x12c8)]['length'])return;const _0x1d1420=await _0x9286bb('更换专辑封面',[{'text':_0x1eb1f9(0x1a1),'value':_0x1eb1f9(0x1179)},{'text':_0x1eb1f9(0x500),'value':'url'}]);let _0x4715b0=null;if(_0x1d1420===_0x1eb1f9(0x1179))_0x4715b0=await _0x2c96d6();else _0x1d1420===_0x1eb1f9(0x9a8)&&(_0x4715b0=await _0x41b9fc(_0x1eb1f9(0x9c4),_0x1eb1f9(0xca0),'','url'));if(_0x4715b0&&_0x4715b0[_0x1eb1f9(0x2a8)]()){_0x49c6c5[_0x1eb1f9(0x12c8)][_0x8bab39][_0x1eb1f9(0xefe)]=_0x4715b0['trim'](),await _0x26f02f();if(_0x49c6c5[_0x1eb1f9(0x73a)]===_0x8bab39){document[_0x1eb1f9(0x948)](_0x1eb1f9(0xb0c))[_0x1eb1f9(0x147d)]=_0x4715b0[_0x1eb1f9(0x2a8)]();const _0x5cd631=document[_0x1eb1f9(0xfeb)](_0x1eb1f9(0x14b8));if(_0x5cd631)_0x5cd631[_0x1eb1f9(0x147d)]=_0x4715b0[_0x1eb1f9(0x2a8)]();}await _0x104485('成功',_0x1eb1f9(0x13af));}}async function _0x1062d6(_0x214542){const _0x4b8183=_0x3ce1fb;if(_0x214542<0x0||_0x214542>=_0x49c6c5[_0x4b8183(0x12c8)][_0x4b8183(0xaf9)])return;const _0xa6495f=_0x49c6c5[_0x4b8183(0x12c8)][_0x214542],_0x253bf4=_0x49c6c5[_0x4b8183(0x3aa)]&&_0x49c6c5[_0x4b8183(0x73a)]===_0x214542;if(_0xa6495f[_0x4b8183(0x4ca)]&&_0x204b9a[_0x4b8183(0x147d)][_0x4b8183(0x157f)](_0x4b8183(0x5ee))&&_0x49c6c5[_0x4b8183(0x73a)]===_0x214542)URL[_0x4b8183(0x11e1)](_0x204b9a[_0x4b8183(0x147d)]);_0x49c6c5['playlist']['splice'](_0x214542,0x1),await _0x26f02f();if(_0x49c6c5[_0x4b8183(0x12c8)][_0x4b8183(0xaf9)]===0x0){if(_0x49c6c5[_0x4b8183(0x3aa)])_0x204b9a[_0x4b8183(0xf8c)]();_0x204b9a['src']='',_0x49c6c5['currentIndex']=-0x1,_0x49c6c5[_0x4b8183(0x3aa)]=![];}else{if(_0x253bf4)_0x58f0d();else{if(_0x49c6c5['currentIndex']>=_0x214542)_0x49c6c5[_0x4b8183(0x73a)]=Math[_0x4b8183(0x604)](0x0,_0x49c6c5[_0x4b8183(0x73a)]-0x1);}}_0x409bf9(),_0x39f26c();}async function _0x5db7ff(_0x354b19){const _0x523258=_0x3ce1fb,_0x44eaa4=_0x354b19[_0x523258(0xa50)]['files'];if(!_0x44eaa4[_0x523258(0xaf9)])return;for(const _0x847579 of _0x44eaa4){let _0x34eacc=_0x847579['name'][_0x523258(0x14e9)](/\.[^/.]+$/,'');_0x34eacc=await _0x41b9fc('歌曲信息','请输入歌名',_0x34eacc);if(_0x34eacc===null)continue;const _0x2fbbb8=await _0x41b9fc(_0x523258(0x1bd),_0x523258(0x1357),_0x523258(0xc8e));if(_0x2fbbb8===null)continue;let _0x1cc4fa='';const _0x786893=await _0xa6b74a(_0x523258(0x744),_0x523258(0xc3d)+_0x34eacc+'》添加歌词吗？');_0x786893&&(_0x1cc4fa=await _0x6572e5()||''),_0x49c6c5[_0x523258(0x12c8)][_0x523258(0x1001)]({'name':_0x34eacc,'artist':_0x2fbbb8,'src':_0x847579,'isLocal':!![],'lrcContent':_0x1cc4fa});}await _0x26f02f(),_0x39f26c(),_0x49c6c5['currentIndex']===-0x1&&_0x49c6c5[_0x523258(0x12c8)]['length']>0x0&&(_0x49c6c5[_0x523258(0x73a)]=0x0,_0x409bf9()),_0x354b19[_0x523258(0xa50)]['value']=null;}async function _0x1062d6(_0x592114){const _0x9f452b=_0x3ce1fb;if(_0x592114<0x0||_0x592114>=_0x49c6c5[_0x9f452b(0x12c8)][_0x9f452b(0xaf9)])return;const _0x28213f=_0x49c6c5[_0x9f452b(0x12c8)][_0x592114],_0x16d1b6=_0x49c6c5['isPlaying']&&_0x49c6c5[_0x9f452b(0x73a)]===_0x592114;if(_0x28213f[_0x9f452b(0x4ca)]&&_0x204b9a[_0x9f452b(0x147d)][_0x9f452b(0x157f)](_0x9f452b(0x5ee))&&_0x49c6c5[_0x9f452b(0x73a)]===_0x592114)URL[_0x9f452b(0x11e1)](_0x204b9a[_0x9f452b(0x147d)]);_0x49c6c5[_0x9f452b(0x12c8)][_0x9f452b(0x36d)](_0x592114,0x1),await _0x26f02f();if(_0x49c6c5[_0x9f452b(0x12c8)][_0x9f452b(0xaf9)]===0x0){if(_0x49c6c5[_0x9f452b(0x3aa)])_0x204b9a[_0x9f452b(0xf8c)]();_0x204b9a[_0x9f452b(0x147d)]='',_0x49c6c5[_0x9f452b(0x73a)]=-0x1,_0x49c6c5[_0x9f452b(0x3aa)]=![];}else{if(_0x16d1b6)_0x58f0d();else{if(_0x49c6c5[_0x9f452b(0x73a)]>=_0x592114)_0x49c6c5[_0x9f452b(0x73a)]=Math[_0x9f452b(0x604)](0x0,_0x49c6c5[_0x9f452b(0x73a)]-0x1);}}_0x409bf9(),_0x39f26c();}const _0x5cd715=document['getElementById'](_0x3ce1fb(0x12c6)),_0x11ebde=document[_0x3ce1fb(0x948)](_0x3ce1fb(0xecb)),_0x3f63f5=document['getElementById'](_0x3ce1fb(0x70a));function _0x1c1980(){const _0x404b75=_0x3ce1fb;_0x45ebb7(),_0x5cd715[_0x404b75(0xd54)][_0x404b75(0xbd0)]('visible');}function _0x174dbf(){const _0x45e625=_0x3ce1fb;_0x5cd715[_0x45e625(0xd54)][_0x45e625(0xf89)](_0x45e625(0xfcb));}function _0x45ebb7(){const _0x24d990=_0x3ce1fb,_0x5206c0=document[_0x24d990(0x948)](_0x24d990(0x148b));_0x5206c0['innerHTML']='';if(_0x16699d[_0x24d990(0xbb0)][_0x24d990(0xaf9)]===0x0){_0x5206c0[_0x24d990(0xb6f)]=_0x24d990(0x97f);return;}_0x16699d[_0x24d990(0xbb0)][_0x24d990(0x427)](_0x5a62ed=>{const _0x23a109=_0x24d990,_0x1af850=document['createElement'](_0x23a109(0x379));_0x1af850[_0x23a109(0x35b)]=_0x23a109(0x1479),_0x1af850[_0x23a109(0xf74)]['backgroundImage']='url('+_0x5a62ed[_0x23a109(0x63e)]+')',_0x1af850[_0x23a109(0x606)][_0x23a109(0x8b1)]=_0x5a62ed['id'],_0x1af850[_0x23a109(0x339)](_0x23a109(0x4f6),()=>_0x355537(_0x5a62ed['id'])),_0x159366(_0x1af850,()=>_0x541c06(_0x5a62ed['id'])),_0x5206c0[_0x23a109(0x6b6)](_0x1af850);});}function _0x541c06(_0x212c23){const _0x2f2d3a=_0x3ce1fb;_0x5694c7=_0x212c23,_0x3f63f5[_0x2f2d3a(0xd54)]['add'](_0x2f2d3a(0xfcb));}function _0x3a6a96(){const _0x2a3b6b=_0x3ce1fb;_0x3f63f5[_0x2a3b6b(0xd54)][_0x2a3b6b(0xf89)](_0x2a3b6b(0xfcb)),_0x5694c7=null;}function _0x355537(_0x16f380){const _0x9f5b92=_0x3ce1fb,_0x452191=_0x16699d[_0x9f5b92(0xbb0)][_0x9f5b92(0x1402)](_0x53367c=>_0x53367c['id']===_0x16f380);_0x452191&&(document[_0x9f5b92(0x948)](_0x9f5b92(0x7ad))[_0x9f5b92(0x147d)]=_0x452191[_0x9f5b92(0x63e)],document[_0x9f5b92(0x948)]('my-persona')[_0x9f5b92(0x5bc)]=_0x452191[_0x9f5b92(0xbad)]),_0x174dbf();}function _0x596ccb(){const _0x5559ab=_0x3ce1fb;_0x5694c7=null,document[_0x5559ab(0x948)](_0x5559ab(0x226))[_0x5559ab(0x10cb)]=_0x5559ab(0xc7e),document[_0x5559ab(0x948)](_0x5559ab(0x14e3))['src']=_0x202ba5,document[_0x5559ab(0x948)](_0x5559ab(0x14d8))[_0x5559ab(0x5bc)]='',_0x11ebde['classList'][_0x5559ab(0xbd0)]('visible');}function _0x264318(){const _0x3e1985=_0x3ce1fb,_0x29be9c=_0x16699d[_0x3e1985(0xbb0)][_0x3e1985(0x1402)](_0xd11ff=>_0xd11ff['id']===_0x5694c7);if(!_0x29be9c)return;document[_0x3e1985(0x948)](_0x3e1985(0x226))[_0x3e1985(0x10cb)]=_0x3e1985(0x920),document['getElementById'](_0x3e1985(0x14e3))[_0x3e1985(0x147d)]=_0x29be9c[_0x3e1985(0x63e)],document[_0x3e1985(0x948)](_0x3e1985(0x14d8))[_0x3e1985(0x5bc)]=_0x29be9c['persona'],_0x3f63f5[_0x3e1985(0xd54)][_0x3e1985(0xf89)](_0x3e1985(0xfcb)),_0x11ebde[_0x3e1985(0xd54)][_0x3e1985(0xbd0)](_0x3e1985(0xfcb));}async function _0x3827ed(){const _0x274331=_0x3ce1fb,_0x407e06=await _0xa6b74a(_0x274331(0xbc2),'确定要删除这个人设预设吗？此操作不可恢复。',{'confirmButtonClass':_0x274331(0x5e8)});_0x407e06&&_0x5694c7&&(await _0x6ed281[_0x274331(0xbb0)]['delete'](_0x5694c7),_0x16699d[_0x274331(0xbb0)]=_0x16699d[_0x274331(0xbb0)][_0x274331(0x1c0)](_0x944b88=>_0x944b88['id']!==_0x5694c7),_0x3a6a96(),_0x45ebb7());}function _0xf2394c(){const _0x3101d2=_0x3ce1fb;_0x11ebde[_0x3101d2(0xd54)]['remove']('visible'),_0x5694c7=null;}async function _0x58ca34(){const _0x49bf41=_0x3ce1fb,_0x3d017f=document[_0x49bf41(0x948)](_0x49bf41(0x14e3))[_0x49bf41(0x147d)],_0x3ee5e7=document[_0x49bf41(0x948)](_0x49bf41(0x14d8))[_0x49bf41(0x5bc)]['trim']();if(_0x3d017f===_0x202ba5&&!_0x3ee5e7){alert(_0x49bf41(0xf8d));return;}if(_0x5694c7){const _0x47c12d=_0x16699d['personaPresets'][_0x49bf41(0x1402)](_0x3d3fcb=>_0x3d3fcb['id']===_0x5694c7);_0x47c12d&&(_0x47c12d['avatar']=_0x3d017f,_0x47c12d[_0x49bf41(0xbad)]=_0x3ee5e7,await _0x6ed281[_0x49bf41(0xbb0)][_0x49bf41(0x90c)](_0x47c12d));}else{const _0x15faf3={'id':_0x49bf41(0x510)+Date[_0x49bf41(0x1386)](),'avatar':_0x3d017f,'persona':_0x3ee5e7};await _0x6ed281[_0x49bf41(0xbb0)][_0x49bf41(0xbd0)](_0x15faf3),_0x16699d[_0x49bf41(0xbb0)][_0x49bf41(0x1001)](_0x15faf3);}_0x45ebb7(),_0xf2394c();}const _0x4f467b=document[_0x3ce1fb(0x948)]('battery-alert-modal');function _0x2ec492(_0x1ef622,_0x483fe9){const _0x4effd3=_0x3ce1fb;clearTimeout(_0x4ab3e3),document[_0x4effd3(0x948)](_0x4effd3(0x923))[_0x4effd3(0x147d)]=_0x1ef622,document['getElementById'](_0x4effd3(0xf20))[_0x4effd3(0x10cb)]=_0x483fe9,_0x4f467b[_0x4effd3(0xd54)][_0x4effd3(0xbd0)](_0x4effd3(0xfcb));const _0x2c5f97=()=>{const _0xa8c506=_0x4effd3;_0x4f467b['classList'][_0xa8c506(0xf89)]('visible'),_0x4f467b[_0xa8c506(0x1558)](_0xa8c506(0x4f6),_0x2c5f97);};_0x4f467b[_0x4effd3(0x339)](_0x4effd3(0x4f6),_0x2c5f97),_0x4ab3e3=setTimeout(_0x2c5f97,0x7d0);}function _0x307b60(_0x1a390f){const _0x7d2f49=_0x3ce1fb,_0x31c890=document[_0x7d2f49(0x948)](_0x7d2f49(0x107a)),_0x37983d=_0x31c890[_0x7d2f49(0xfeb)](_0x7d2f49(0x9f1)),_0x511fcb=_0x31c890['querySelector'](_0x7d2f49(0xeed)),_0x20a158=Math[_0x7d2f49(0x15b6)](_0x1a390f[_0x7d2f49(0x110a)]*0x64);_0x37983d[_0x7d2f49(0xf74)]['width']=_0x20a158+'%',_0x511fcb[_0x7d2f49(0x10cb)]=_0x20a158+'%',_0x1a390f[_0x7d2f49(0x14fc)]?_0x31c890[_0x7d2f49(0xd54)]['add'](_0x7d2f49(0x14fc)):_0x31c890[_0x7d2f49(0xd54)]['remove'](_0x7d2f49(0x14fc));}function _0x139a18(_0x2d572b){const _0x1799c4=_0x3ce1fb;_0x307b60(_0x2d572b);const _0x34d855=_0x2d572b['level'];!_0x2d572b['charging']&&(_0x34d855<=0.4&&_0x2f7026>0.4&&!_0x3db272[_0x1799c4(0x1035)]&&(_0x2ec492(_0x1799c4(0xea6),_0x1799c4(0xd23)),_0x3db272['hasShown40']=!![]),_0x34d855<=0.2&&_0x2f7026>0.2&&!_0x3db272[_0x1799c4(0xa4c)]&&(_0x2ec492(_0x1799c4(0x5d8),_0x1799c4(0xdfb)),_0x3db272['hasShown20']=!![]),_0x34d855<=0.1&&_0x2f7026>0.1&&!_0x3db272[_0x1799c4(0x2a9)]&&(_0x2ec492(_0x1799c4(0x468),_0x1799c4(0xfe9)),_0x3db272[_0x1799c4(0x2a9)]=!![]));if(_0x34d855>0.4)_0x3db272[_0x1799c4(0x1035)]=![];if(_0x34d855>0.2)_0x3db272[_0x1799c4(0xa4c)]=![];if(_0x34d855>0.1)_0x3db272[_0x1799c4(0x2a9)]=![];_0x2f7026=_0x34d855;}async function _0x25eeee(){const _0x56ad22=_0x3ce1fb;if(_0x56ad22(0xe9b)in navigator)try{const _0x5056a3=await navigator[_0x56ad22(0xe9b)]();_0x2f7026=_0x5056a3[_0x56ad22(0x110a)],_0x139a18(_0x5056a3),_0x5056a3['addEventListener'](_0x56ad22(0xf93),()=>_0x139a18(_0x5056a3)),_0x5056a3['addEventListener'](_0x56ad22(0x1280),()=>{const _0x5cfaa1=_0x56ad22;_0x139a18(_0x5056a3),_0x5056a3[_0x5cfaa1(0x14fc)]&&_0x2ec492('https://i.postimg.cc/3NDQ0dWG/image.jpg',_0x5cfaa1(0x912));});}catch(_0x3e20f7){console[_0x56ad22(0xc3e)](_0x56ad22(0x536),_0x3e20f7),document['querySelector'](_0x56ad22(0xeed))['textContent']='ᗜωᗜ';}else console[_0x56ad22(0x498)]('浏览器不支持电池状态API。'),document[_0x56ad22(0xfeb)](_0x56ad22(0xeed))['textContent']=_0x56ad22(0x3c6);}async function _0xd3cc7a(){const _0x5ce914=_0x3ce1fb,_0x42d2a1=document[_0x5ce914(0x948)](_0x5ce914(0x7ab));if(!_0x42d2a1)return;const _0x5ee615=await _0x6ed281[_0x5ce914(0x1a0)][_0x5ce914(0x1088)](_0x5ce914(0x1058))[_0x5ce914(0xb26)]()['toArray']();_0x42d2a1[_0x5ce914(0xb6f)]='';if(_0x5ee615[_0x5ce914(0xaf9)]===0x0){_0x42d2a1[_0x5ce914(0xb6f)]=_0x5ce914(0x334);return;}_0x5ee615['forEach'](_0x542d9a=>{const _0x27e424=_0x5ce914,_0x53f0e8=document[_0x27e424(0x1497)](_0x27e424(0x379));_0x53f0e8[_0x27e424(0x35b)]=_0x27e424(0x1156),_0x53f0e8[_0x27e424(0xb6f)]=_0x27e424(0xf47)+_0x542d9a['coverUrl']+_0x27e424(0x2ef)+_0x542d9a[_0x27e424(0x1467)]+_0x27e424(0x5ad)+(_0x542d9a[_0x27e424(0x478)]||0x0)+_0x27e424(0x13ef),_0x53f0e8[_0x27e424(0x339)](_0x27e424(0x4f6),()=>{_0x78ca63(_0x542d9a['id']);}),_0x159366(_0x53f0e8,async()=>{const _0x1ffb21=_0x27e424,_0x5d86a4=await _0xa6b74a(_0x1ffb21(0x155b),'确定要删除相册《'+_0x542d9a[_0x1ffb21(0x1467)]+_0x1ffb21(0x43c),{'confirmButtonClass':'btn-danger'});_0x5d86a4&&(await _0x6ed281[_0x1ffb21(0x1100)][_0x1ffb21(0x1117)](_0x1ffb21(0xe12))[_0x1ffb21(0xba9)](_0x542d9a['id'])[_0x1ffb21(0x869)](),await _0x6ed281[_0x1ffb21(0x1a0)][_0x1ffb21(0x869)](_0x542d9a['id']),await _0xd3cc7a(),alert('相册已成功删除。'));}),_0x42d2a1['appendChild'](_0x53f0e8);});}async function _0x78ca63(_0x3c6a5e){const _0x187a94=_0x3ce1fb;_0x16699d[_0x187a94(0x3ad)]=_0x3c6a5e,await _0x4e4aa6(),_0x58c3b1('album-photos-screen');}async function _0x4e4aa6(){const _0x1aaf7f=_0x3ce1fb;if(!_0x16699d[_0x1aaf7f(0x3ad)])return;const _0x5b7a4b=document[_0x1aaf7f(0x948)]('photos-grid-page'),_0x294cd5=document[_0x1aaf7f(0x948)](_0x1aaf7f(0xbe4)),_0x1f6a7b=await _0x6ed281[_0x1aaf7f(0x1a0)]['get'](_0x16699d['activeAlbumId']);if(!_0x1f6a7b){console[_0x1aaf7f(0xc3e)](_0x1aaf7f(0x85e),_0x16699d[_0x1aaf7f(0x3ad)]),_0x58c3b1(_0x1aaf7f(0x1054));return;}_0x294cd5[_0x1aaf7f(0x10cb)]=_0x1f6a7b[_0x1aaf7f(0x1467)];const _0x185b7b=await _0x6ed281[_0x1aaf7f(0x1100)][_0x1aaf7f(0x1117)](_0x1aaf7f(0xe12))[_0x1aaf7f(0xba9)](_0x16699d[_0x1aaf7f(0x3ad)])[_0x1aaf7f(0x443)]();_0x5b7a4b[_0x1aaf7f(0xb6f)]='',_0x185b7b['length']===0x0?_0x5b7a4b['innerHTML']='<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这个相册还是空的，快上传第一张照片吧！</p>':_0x185b7b[_0x1aaf7f(0x427)](_0x6ca394=>{const _0x37e80a=_0x1aaf7f,_0x46dc8b=document[_0x37e80a(0x1497)](_0x37e80a(0x379));_0x46dc8b[_0x37e80a(0x35b)]='photo-item',_0x46dc8b[_0x37e80a(0xb6f)]=_0x37e80a(0x821)+_0x6ca394[_0x37e80a(0x9a8)]+'\x22\x20class=\x22photo-thumb\x22\x20alt=\x22相册照片\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22photo-delete-btn\x22\x20data-photo-id=\x22'+_0x6ca394['id']+_0x37e80a(0x157e),_0x5b7a4b[_0x37e80a(0x6b6)](_0x46dc8b);});}async function _0x28e2e8(_0x55f728){const _0x4fa484=_0x3ce1fb;if(!_0x16699d['activeAlbumId'])return;const _0x390d9b=await _0x6ed281[_0x4fa484(0x1100)]['where'](_0x4fa484(0xe12))[_0x4fa484(0xba9)](_0x16699d[_0x4fa484(0x3ad)])['toArray']();_0x302509[_0x4fa484(0x384)]=_0x390d9b['map'](_0x170afc=>_0x170afc[_0x4fa484(0x9a8)]),_0x302509[_0x4fa484(0x73a)]=_0x302509[_0x4fa484(0x384)]['findIndex'](_0x524e70=>_0x524e70===_0x55f728);if(_0x302509[_0x4fa484(0x73a)]===-0x1)return;document[_0x4fa484(0x948)](_0x4fa484(0x11ee))[_0x4fa484(0xd54)][_0x4fa484(0xbd0)]('visible'),_0x1c5adb(),_0x302509[_0x4fa484(0x2c4)]=!![];}function _0x1c5adb(){const _0x320995=_0x3ce1fb;if(_0x302509['currentIndex']===-0x1)return;const _0x1ba9d8=document[_0x320995(0x948)](_0x320995(0x12a3)),_0xf2e26b=document[_0x320995(0x948)](_0x320995(0x117e)),_0x148dbe=document[_0x320995(0x948)](_0x320995(0x216));_0x1ba9d8[_0x320995(0xf74)][_0x320995(0x9a2)]=0x0,setTimeout(()=>{const _0x57f003=_0x320995;_0x1ba9d8[_0x57f003(0x147d)]=_0x302509[_0x57f003(0x384)][_0x302509['currentIndex']],_0x1ba9d8[_0x57f003(0xf74)][_0x57f003(0x9a2)]=0x1;},0x64),_0xf2e26b[_0x320995(0x2c0)]=_0x302509[_0x320995(0x73a)]===0x0,_0x148dbe[_0x320995(0x2c0)]=_0x302509[_0x320995(0x73a)]===_0x302509['photos'][_0x320995(0xaf9)]-0x1;}function _0x29f363(){const _0x33227a=_0x3ce1fb;_0x302509[_0x33227a(0x73a)]<_0x302509[_0x33227a(0x384)][_0x33227a(0xaf9)]-0x1&&(_0x302509[_0x33227a(0x73a)]++,_0x1c5adb());}function _0x125656(){const _0x53b998=_0x3ce1fb;_0x302509[_0x53b998(0x73a)]>0x0&&(_0x302509[_0x53b998(0x73a)]--,_0x1c5adb());}function _0x4d3e67(){const _0x3f12f9=_0x3ce1fb;document[_0x3f12f9(0x948)]('photo-viewer-modal')[_0x3f12f9(0xd54)][_0x3f12f9(0xf89)](_0x3f12f9(0xfcb)),_0x302509[_0x3f12f9(0x2c4)]=![],_0x302509[_0x3f12f9(0x384)]=[],_0x302509[_0x3f12f9(0x73a)]=-0x1,document['getElementById']('photo-viewer-image')[_0x3f12f9(0x147d)]='';}function _0x255639(_0x7b7d44){const _0x4e0ef1=_0x3ce1fb;_0x5711af=_0x7b7d44,localStorage[_0x4e0ef1(0x59f)](_0x4e0ef1(0x8b4),_0x7b7d44);const _0x2690c0=document[_0x4e0ef1(0xfeb)]('.nav-item[data-view=\x22qzone-screen\x22]'),_0x2186e9=_0x2690c0[_0x4e0ef1(0xfeb)](_0x4e0ef1(0x65b));let _0x187eaf=_0x2690c0['querySelector']('.unread-indicator');_0x7b7d44>0x0?(!_0x187eaf&&(_0x187eaf=document[_0x4e0ef1(0x1497)]('span'),_0x187eaf[_0x4e0ef1(0x35b)]='unread-indicator',_0x2186e9[_0x4e0ef1(0xf74)]['position']=_0x4e0ef1(0xd97),_0x2186e9[_0x4e0ef1(0x6b6)](_0x187eaf)),_0x187eaf[_0x4e0ef1(0x10cb)]=_0x7b7d44>0x63?_0x4e0ef1(0x158d):_0x7b7d44,_0x187eaf[_0x4e0ef1(0xf74)][_0x4e0ef1(0x11fd)]=_0x4e0ef1(0x1273)):_0x187eaf&&(_0x187eaf[_0x4e0ef1(0xf74)][_0x4e0ef1(0x11fd)]=_0x4e0ef1(0x12fe)),_0x88f8e2();}function _0x356441(){const _0x521680=_0x3ce1fb;if(_0x47dadd)return;const _0x1dff2d=_0x16699d[_0x521680(0xf9c)][_0x521680(0x996)]||0x3c;_0x47dadd=setInterval(_0x3a5f55,_0x1dff2d*0x3e8),_0x302fc8();}function _0x541ad5(){_0x47dadd&&(clearInterval(_0x47dadd),_0x47dadd=null),_0xb2ff26();}async function _0x3a5f55(){const _0x5a2275=_0x3ce1fb;console[_0x5a2275(0x498)](_0x5a2275(0xf6a));if(!_0x16699d[_0x5a2275(0xf9c)][_0x5a2275(0x1028)]){_0x541ad5();return;}const _0x40bc0c=Object[_0x5a2275(0x1166)](_0x16699d[_0x5a2275(0x1474)])[_0x5a2275(0x1c0)](_0x426a77=>!_0x426a77[_0x5a2275(0x1173)]);_0x40bc0c[_0x5a2275(0x427)](_0x51e786=>{const _0x57d938=_0x5a2275;if(_0x51e786[_0x57d938(0x1120)]?.['status']===_0x57d938(0x1572)){const _0x1ee7fd=_0x51e786[_0x57d938(0x1120)]['blockedTimestamp'];if(!_0x1ee7fd)return;const _0x384ed4=Date['now']()-_0x1ee7fd,_0x503ba8=(_0x16699d[_0x57d938(0xf9c)][_0x57d938(0x4b1)]||0x1)*0x3c*0x3c*0x3e8;_0x384ed4>_0x503ba8&&(_0x51e786[_0x57d938(0x1120)][_0x57d938(0x82c)]=_0x57d938(0x2e3),_0x530b7b(_0x51e786['id']));}else{if(_0x51e786['relationship']?.['status']===_0x57d938(0x1431)&&_0x51e786['id']!==_0x16699d['activeChatId']){if(_0x51e786[_0x57d938(0x7fd)]['enableBackgroundActivity']===![]){console[_0x57d938(0x498)](_0x57d938(0x1206)+_0x51e786[_0x57d938(0x1467)]+_0x57d938(0x11dc));return;}Math[_0x57d938(0x59c)]()<0.2&&(console[_0x57d938(0x498)](_0x57d938(0x1206)+_0x51e786[_0x57d938(0x1467)]+'\x22\x20被唤醒，准备独立行动...'),_0xea7c2(_0x51e786['id']));}}});const _0x581538=Object['values'](_0x16699d[_0x5a2275(0x1474)])[_0x5a2275(0x1c0)](_0x26beea=>_0x26beea['isGroup']);_0x581538['forEach'](_0x2be22f=>{const _0x45d2bd=_0x5a2275;if(_0x2be22f[_0x45d2bd(0x7fd)][_0x45d2bd(0x1028)]===![]){console['log'](_0x45d2bd(0x579)+_0x2be22f['name']+_0x45d2bd(0x15ad));return;}_0x2be22f['id']!==_0x16699d[_0x45d2bd(0xf5a)]&&Math[_0x45d2bd(0x59c)]()<0.1&&(console[_0x45d2bd(0x498)]('群聊\x20\x22'+_0x2be22f['name']+_0x45d2bd(0xf3e)),_0x2de7a5(_0x2be22f['id']));});try{const _0x251873=await _0x6ed281[_0x5a2275(0xa59)][_0x5a2275(0x443)]();if(_0x251873[_0x5a2275(0xaf9)]===0x0)return;const _0x5102f6=await _0x6ed281[_0x5a2275(0xed1)][_0x5a2275(0x1088)](_0x5a2275(0xb0a))[_0x5a2275(0xb26)]()[_0x5a2275(0x619)](0xa)[_0x5a2275(0x443)]();for(const _0x20eadf of _0x251873){if(_0x20eadf[_0x5a2275(0x1028)]===![])continue;const _0x14d8a5=_0x20eadf['actionCooldownMinutes']||0xf;if(_0x20eadf[_0x5a2275(0x26e)]){const _0x1996b0=(Date[_0x5a2275(0x1386)]()-_0x20eadf[_0x5a2275(0x26e)])/(0x3e8*0x3c);if(_0x1996b0<_0x14d8a5)continue;}if(Math[_0x5a2275(0x59c)]()>0.3)continue;const _0x202905=[];for(const _0x2763f0 of _0x5102f6){if(_0x2763f0['authorId']===_0x5a2275(0x137b)+_0x20eadf['id'])continue;const _0x14c45f=_0x2763f0[_0x5a2275(0x4d6)]?.[_0x5a2275(0x1502)](_0x2c3d07=>_0x2c3d07['replyTo']===_0x20eadf[_0x5a2275(0x1467)]),_0x4d5c77=_0x2763f0[_0x5a2275(0x4d6)]?.[_0x5a2275(0x200)](-0x1)[0x0]?.[_0x5a2275(0x9e3)];if(_0x4d5c77===_0x20eadf[_0x5a2275(0x1467)])continue;let _0x2ae5a0=![];if(_0x2763f0[_0x5a2275(0x11b9)]===_0x5a2275(0xaeb)||_0x2763f0[_0x5a2275(0x11b9)]['startsWith'](_0x5a2275(0x530)))_0x20eadf['associatedWith'][_0x5a2275(0x1336)](_0x2763f0[_0x5a2275(0x11b9)])&&(_0x2ae5a0=!![]);else{if(_0x2763f0[_0x5a2275(0x11b9)][_0x5a2275(0x157f)](_0x5a2275(0x137b))){const _0x103428=parseInt(_0x2763f0[_0x5a2275(0x11b9)][_0x5a2275(0x14e9)](_0x5a2275(0x137b),'')),_0x10844a=await _0x6ed281['npcs']['get'](_0x103428);if(_0x10844a){const _0x3d4a87=_0x20eadf[_0x5a2275(0x12fd)],_0x21c1e0=_0x10844a[_0x5a2275(0x12fd)];_0x3d4a87&&_0x21c1e0&&_0x3d4a87===_0x21c1e0&&(_0x2ae5a0=!![]);}}}(_0x2ae5a0||_0x14c45f)&&_0x202905[_0x5a2275(0x1001)](_0x2763f0);}if(_0x202905[_0x5a2275(0xaf9)]>0x0||Math['random']()<0.2){console[_0x5a2275(0x498)](_0x5a2275(0x11be)+_0x20eadf[_0x5a2275(0x1467)]+_0x5a2275(0x644));const _0x5d067d=await _0x42fabb(_0x20eadf,_0x202905);if(_0x5d067d&&_0x5d067d['length']>0x0){for(const _0x1c6cc1 of _0x5d067d){if(_0x1c6cc1[_0x5a2275(0x4ae)]===_0x5a2275(0x123d)){const _0x40d341=await _0x6ed281[_0x5a2275(0xed1)][_0x5a2275(0xe8c)](_0x1c6cc1[_0x5a2275(0xba5)]);if(_0x40d341){if(!_0x40d341[_0x5a2275(0x4d6)])_0x40d341[_0x5a2275(0x4d6)]=[];_0x40d341[_0x5a2275(0x4d6)][_0x5a2275(0x1001)]({'commenterName':_0x20eadf[_0x5a2275(0x1467)],'text':_0x1c6cc1[_0x5a2275(0xad3)],'replyTo':_0x1c6cc1[_0x5a2275(0xf05)]||null,'timestamp':Date[_0x5a2275(0x1386)]()+Math['random']()}),await _0x6ed281[_0x5a2275(0xed1)]['update'](_0x1c6cc1[_0x5a2275(0xba5)],{'comments':_0x40d341['comments']}),_0x255639(_0x5711af+0x1);}}else{if(_0x1c6cc1[_0x5a2275(0x4ae)]==='qzone_post'){const _0x791fbe={'type':_0x1c6cc1[_0x5a2275(0xa83)]||_0x5a2275(0x2f6),'content':_0x1c6cc1[_0x5a2275(0xede)],'timestamp':Date[_0x5a2275(0x1386)](),'authorId':_0x5a2275(0x137b)+_0x20eadf['id'],'authorOriginalName':_0x20eadf[_0x5a2275(0x1467)],'visibleTo':_0x20eadf[_0x5a2275(0x111e)],'likes':[],'comments':[],'isDeleted':![]};await _0x6ed281['qzonePosts']['add'](_0x791fbe),console[_0x5a2275(0x498)](_0x5a2275(0x11be)+_0x20eadf[_0x5a2275(0x1467)]+_0x5a2275(0xec3)),_0x255639(_0x5711af+0x1);}}}await _0x6ed281[_0x5a2275(0xa59)][_0x5a2275(0xa0b)](_0x20eadf['id'],{'lastActionTimestamp':Date['now']()}),document[_0x5a2275(0x948)]('qzone-screen')[_0x5a2275(0xd54)][_0x5a2275(0x7a0)](_0x5a2275(0x115e))&&await _0x4d3afb();}}}}catch(_0x1261f1){console[_0x5a2275(0xc3e)](_0x5a2275(0x1211),_0x1261f1);}}async function _0x42fabb(_0x2bb4fe,_0x3b07c0){const _0x3e8356=_0x3ce1fb,{proxyUrl:_0x720283,apiKey:_0x5af54d,model:_0x41a33e}=_0x16699d['apiConfig'];if(!_0x720283||!_0x5af54d||!_0x41a33e)return console[_0x3e8356(0xc3e)](_0x3e8356(0x101f)),null;let _0x1daf9e=_0x3e8356(0x196);const _0x55bd08=_0x16699d[_0x3e8356(0x66e)][_0x3e8356(0xf4d)]||'我',_0xb4d1bb=_0x16699d[_0x3e8356(0x1474)][Object[_0x3e8356(0x1cf)](_0x16699d[_0x3e8356(0x1474)])[0x0]]?.[_0x3e8356(0x7fd)][_0x3e8356(0x13b6)]||_0x3e8356(0x572);_0x1daf9e+=_0x3e8356(0x3ca)+_0x55bd08+_0x3e8356(0x12d1)+_0xb4d1bb+'\x0a';_0x2bb4fe['associatedWith']&&_0x2bb4fe[_0x3e8356(0x111e)][_0x3e8356(0xaf9)]>0x0&&_0x2bb4fe[_0x3e8356(0x111e)][_0x3e8356(0x427)](_0x5e6101=>{const _0x479772=_0x3e8356,_0x297151=_0x16699d[_0x479772(0x1474)][_0x5e6101];_0x297151&&!_0x297151[_0x479772(0x1173)]&&(_0x1daf9e+=_0x479772(0x3ca)+_0x297151[_0x479772(0x1467)]+_0x479772(0x413)+_0x297151['originalName']+_0x479772(0x778)+_0x297151[_0x479772(0x7fd)][_0x479772(0x14c1)]+'\x0a');});const _0x23d433=(await Promise[_0x3e8356(0xd49)](_0x3b07c0[_0x3e8356(0x8ff)](async _0x2ceaa6=>{const _0x52bbce=_0x3e8356;let _0xa2615e='未知作者';if(_0x2ceaa6[_0x52bbce(0x11b9)]===_0x52bbce(0xaeb))_0xa2615e=_0x16699d[_0x52bbce(0x66e)][_0x52bbce(0xf4d)]||'用户';else{if(_0x2ceaa6[_0x52bbce(0x11b9)][_0x52bbce(0x157f)](_0x52bbce(0x530)))_0xa2615e=_0x18969a(_0x2ceaa6[_0x52bbce(0x122a)]||_0x2ceaa6[_0x52bbce(0x11b9)]);else{if(_0x2ceaa6[_0x52bbce(0x11b9)][_0x52bbce(0x157f)](_0x52bbce(0x137b))){const _0x299f5d=parseInt(_0x2ceaa6[_0x52bbce(0x11b9)][_0x52bbce(0x14e9)]('npc_','')),_0x1d5287=await _0x6ed281['npcs'][_0x52bbce(0xe8c)](_0x299f5d);_0x1d5287&&(_0xa2615e=_0x1d5287['name']);}}}const _0x4efa83=(_0x2ceaa6[_0x52bbce(0x4d6)]||[])[_0x52bbce(0x8ff)](_0x11d732=>{const _0x2b7e1b=_0x52bbce;if(typeof _0x11d732===_0x2b7e1b(0xd43)&&_0x11d732[_0x2b7e1b(0x9e3)]){const _0x322962=_0x18969a(_0x11d732[_0x2b7e1b(0x9e3)]);return'-\x20**'+_0x322962+_0x2b7e1b(0x1de)+_0x11d732[_0x2b7e1b(0x9ea)];}return'-\x20'+_0x11d732;})[_0x52bbce(0x121a)]('\x0a');return _0x52bbce(0x120a)+_0x2ceaa6['id']+_0x52bbce(0x52c)+_0xa2615e+_0x52bbce(0x12e8)+(_0x2ceaa6[_0x52bbce(0xede)]||_0x2ceaa6[_0x52bbce(0x15bf)]||'')[_0x52bbce(0xeca)](0x0,0x96)+_0x52bbce(0xdbe)+(_0x4efa83||_0x52bbce(0x6e9))+'\x0a---\x0a';})))[_0x3e8356(0x121a)]('\x0a'),_0x275ede=_0x3e8356(0x137b)+_0x2bb4fe['id'],_0x393615=Date[_0x3e8356(0x1386)]()-0xc*0x3c*0x3c*0x3e8,_0x2fda51=await _0x6ed281['qzonePosts'][_0x3e8356(0x1117)]('authorId')['equals'](_0x275ede)['and'](_0x2191c4=>_0x2191c4[_0x3e8356(0xb0a)]>_0x393615)['toArray']();let _0x463b97='';_0x2fda51['length']>0x0&&(_0x463b97=_0x3e8356(0xc25));const _0xdba1a7=_0x3e8356(0xdd8)+_0x2bb4fe['name']+_0x3e8356(0x142d)+_0x463b97+_0x3e8356(0x12d4)+_0x2bb4fe['name']+_0x3e8356(0xc93)+_0x2bb4fe[_0x3e8356(0xbad)]+'\x0a\x0a'+_0x1daf9e+_0x3e8356(0x159e)+_0x23d433+_0x3e8356(0x542);try{const _0x67f699=[{'role':_0x3e8356(0xaeb),'content':'请根据你的设定，开始你的行动。'}];let _0x243617=_0x720283[_0x3e8356(0x1336)](_0x3e8356(0x708)),_0xb86eb8=_0xe8c788(_0x41a33e,_0x5af54d,_0xdba1a7,_0x67f699);const _0x3b63d7=_0x243617?await fetch(_0xb86eb8[_0x3e8356(0x9a8)],_0xb86eb8[_0x3e8356(0x92a)]):await fetch(_0x720283+'/v1/chat/completions',{'method':_0x3e8356(0xdca),'headers':{'Content-Type':_0x3e8356(0x479),'Authorization':_0x3e8356(0xb0e)+_0x5af54d},'body':JSON[_0x3e8356(0x526)]({'model':_0x41a33e,'messages':[{'role':_0x3e8356(0x11af),'content':_0xdba1a7},..._0x67f699],'temperature':_0x16699d[_0x3e8356(0xf9c)]['apiTemperature']||0.9})});if(!_0x3b63d7['ok'])throw new Error(_0x3e8356(0x69a)+_0x3b63d7[_0x3e8356(0x13a2)]);const _0x23ce5e=await _0x3b63d7['json'](),_0xf2c0fe=getGeminiResponseText(_0x23ce5e),_0x24ab7e=_0xf2c0fe['match'](/(\[[\s\S]*\])/);if(!_0x24ab7e)throw new Error(_0x3e8356(0x146a));return JSON['parse'](_0x24ab7e[0x0]);}catch(_0x16db27){return console['error']('为NPC\x20\x22'+_0x2bb4fe[_0x3e8356(0x1467)]+'\x22\x20生成行动失败:',_0x16db27),null;}}async function _0xea7c2(_0xf11eec){const _0x15f482=_0x3ce1fb,_0x447d82=_0x16699d[_0x15f482(0x1474)][_0xf11eec];if(!_0x447d82)return;const _0x1178e7=_0x447d82['settings'][_0x15f482(0x63a)]||0xa;if(_0x447d82[_0x15f482(0x26e)]){const _0xf6c39a=(Date['now']()-_0x447d82[_0x15f482(0x26e)])/(0x3e8*0x3c);if(_0xf6c39a<_0x1178e7){console[_0x15f482(0x498)](_0x15f482(0x1206)+_0x447d82[_0x15f482(0x1467)]+_0x15f482(0x5ea)+Math[_0x15f482(0xec0)](_0x1178e7-_0xf6c39a)+_0x15f482(0xf61));return;}}_0xcc3e17(_0xf11eec,!![]);const {proxyUrl:_0x2e47a0,apiKey:_0xb141d1,model:_0x541128}=_0x16699d[_0x15f482(0x79e)];if(!_0x2e47a0||!_0xb141d1||!_0x541128)return;const _0x4b06b7=_0x16699d[_0x15f482(0x66e)][_0x15f482(0xf4d)],_0x111dec=new Date(),_0x542260=_0x447d82[_0x15f482(0x7fd)][_0x15f482(0x240)]||'Asia/Shanghai',_0xb81f37=_0x111dec[_0x15f482(0xed3)](_0x15f482(0x144f),{'timeZone':_0x542260,'dateStyle':'full','timeStyle':_0x15f482(0xadb)}),_0x3f6060=new Date(_0x111dec[_0x15f482(0xed3)](_0x15f482(0xb7a),{'timeZone':_0x542260}));let _0x47e50c='',_0x547824='',_0x433c62,_0x2804c5=![];const _0x2ce16a=_0x447d82[_0x15f482(0x7fd)][_0x15f482(0x78a)]||0xa,_0x14d726=_0x447d82[_0x15f482(0xb07)][_0x15f482(0x1c0)](_0x3fdf50=>!_0x3fdf50[_0x15f482(0x583)])[_0x15f482(0x200)](-_0x2ce16a),_0x43a34b=_0x447d82['history'][_0x15f482(0x1c0)](_0x3443cb=>!_0x3443cb[_0x15f482(0x583)])[_0x15f482(0x200)](-0x1)[0x0];if(_0x447d82[_0x15f482(0x7fd)][_0x15f482(0xae7)]){_0x47e50c=_0x107c99(_0x3f6060);const _0x2f34ff=_0x447d82['history'][_0x15f482(0x1c0)](_0x3d6140=>!_0x3d6140['isHidden'])['slice'](-0x1)[0x0],_0xefee57=new Date();let _0x4ccdf0='',_0x552d79=![];if(_0x2f34ff){const _0xa559e7=new Date(_0x2f34ff[_0x15f482(0xb0a)]),_0x6f87d3=(_0xefee57-_0xa559e7)/(0x3e8*0x3c*0x3c);if(_0x6f87d3>0x2){_0x552d79=!![];const _0x7d4b03=Math['floor'](_0x6f87d3/0x18);_0x4ccdf0=_0x15f482(0xc7c)+(_0x7d4b03>0x0?_0x7d4b03+'天':Math['floor'](_0x6f87d3)+'小时')+_0x15f482(0x101e);}else{const _0x732e18=Math[_0x15f482(0x15b6)](_0x6f87d3*0x3c);if(_0x732e18<0x5)_0x4ccdf0=_0x15f482(0x10f0);else _0x732e18<0x3c?_0x4ccdf0=_0x15f482(0x2dc)+_0x732e18+_0x15f482(0x138a):_0x4ccdf0=_0x15f482(0x2dc)+Math['floor'](_0x6f87d3)+_0x15f482(0x1478);}}else _0x552d79=!![],_0x4ccdf0=_0x15f482(0x10ef);let _0x2dd499=_0x15f482(0x68c);_0x14d726['length']>0x0&&(_0x2dd499=_0x15f482(0x3ba)+_0x14d726[_0x15f482(0x8ff)](_0xae0762=>{const _0x385f3f=_0x15f482,_0x49caf3=_0xae0762['role']===_0x385f3f(0xaeb)?_0x4b06b7:_0x447d82[_0x385f3f(0x1467)];return _0x49caf3+':\x20'+String(_0xae0762[_0x385f3f(0xede)])[_0x385f3f(0xeca)](0x0,0x32)+_0x385f3f(0x76d);})[_0x15f482(0x121a)]('\x0a')),_0x552d79?_0x433c62=_0x15f482(0xb29)+_0x4ccdf0+_0x15f482(0xd8f)+_0xb81f37+_0x15f482(0x156a)+_0x2dd499:_0x433c62=''+_0x2dd499;}else _0x14d726[_0x15f482(0xaf9)]>0x0?_0x433c62=_0x15f482(0x3ba)+_0x14d726[_0x15f482(0x8ff)](_0xe8e2ca=>{const _0x4cf749=_0x15f482,_0x3dbbd0=_0xe8e2ca['role']===_0x4cf749(0xaeb)?_0x4b06b7:_0x447d82[_0x4cf749(0x1467)];return _0x3dbbd0+':\x20'+String(_0xe8e2ca[_0x4cf749(0xede)])[_0x4cf749(0xeca)](0x0,0x32)+_0x4cf749(0x76d);})['join']('\x0a'):_0x433c62=_0x15f482(0x68c);const _0x35dae1=await _0x6ed281[_0x15f482(0xed1)][_0x15f482(0x1088)](_0x15f482(0xb0a))[_0x15f482(0xb26)]()['limit'](0x5)[_0x15f482(0x443)](),_0x195566=_0x337ed2(_0x35dae1,_0x447d82),_0x39c7fe=_0x195566[_0x15f482(0x1c0)](_0x472a8f=>_0x472a8f[_0x15f482(0x11b9)]===_0xf11eec);let _0x1cc4f3='';_0x39c7fe[_0x15f482(0xaf9)]>0x0&&(_0x1cc4f3=_0x15f482(0xcb1),_0x39c7fe[_0x15f482(0x427)](_0x5bd905=>{const _0x15c75a=_0x15f482;let _0x188878=(_0x5bd905['publicText']||_0x5bd905['content']||_0x15c75a(0x8d8))[_0x15c75a(0xeca)](0x0,0x28)+_0x15c75a(0x76d);_0x1cc4f3+=_0x15c75a(0x553)+_0x5bd905['id']+')\x20内容:\x20\x22'+_0x188878+'\x22\x0a';}));let _0x6b1e7f=[];_0x195566['length']>0x0&&(_0x6b1e7f=_0x195566[_0x15f482(0x8ff)](_0x3a9e4c=>{const _0x5558d5=_0x15f482;let _0x1c9d61;if(_0x3a9e4c[_0x5558d5(0x4ae)]==='text_image')_0x1c9d61=('[一张图片，其隐藏文字为：“'+_0x3a9e4c['hiddenContent']+_0x5558d5(0x1143)+(_0x3a9e4c['publicText']||''))[_0x5558d5(0xeca)](0x0,0x32)+_0x5558d5(0x76d);else _0x3a9e4c[_0x5558d5(0x4ae)]===_0x5558d5(0x8f6)?_0x1c9d61=('[一张图片，描述为：“'+_0x3a9e4c[_0x5558d5(0x1329)]+_0x5558d5(0x1143)+(_0x3a9e4c[_0x5558d5(0x15bf)]||''))['substring'](0x0,0x32)+_0x5558d5(0x76d):_0x1c9d61=String(_0x3a9e4c[_0x5558d5(0x15bf)]||_0x3a9e4c[_0x5558d5(0xede)]||_0x5558d5(0x8d8))[_0x5558d5(0xeca)](0x0,0x32)+_0x5558d5(0x76d);return'-\x20\x22'+_0x1c9d61+'\x22';}));let _0x14d072='';_0x6b1e7f[_0x15f482(0xaf9)]>0x0&&(_0x14d072=_0x15f482(0x4f7)+_0x6b1e7f[_0x15f482(0x121a)]('\x0a')+_0x15f482(0x5d7));let _0x131577='';if(_0x447d82[_0x15f482(0x7fd)][_0x15f482(0xeee)]&&_0x447d82['settings'][_0x15f482(0xeee)][_0x15f482(0xaf9)]>0x0){const _0x3fc064=_0x447d82[_0x15f482(0x7fd)]['linkedWorldBookIds'][_0x15f482(0x8ff)](_0x4bffa2=>{const _0x1fad5d=_0x15f482,_0x5aef01=_0x16699d[_0x1fad5d(0x44c)][_0x1fad5d(0x1402)](_0xa33bd6=>_0xa33bd6['id']===_0x4bffa2);if(!_0x5aef01||!Array[_0x1fad5d(0x1524)](_0x5aef01[_0x1fad5d(0xede)]))return'';const _0x520dd9=_0x5aef01['content'][_0x1fad5d(0x1c0)](_0x2c6a17=>_0x2c6a17['enabled']!==![])[_0x1fad5d(0x8ff)](_0xf6aac4=>{const _0x21aaba=_0x1fad5d;let _0x45acc0=_0x21aaba(0x886)+(_0xf6aac4[_0x21aaba(0x282)]||_0x21aaba(0xae0))+'\x0a';return _0xf6aac4[_0x21aaba(0x1cf)][_0x21aaba(0xaf9)]>0x0&&(_0x45acc0+=_0x21aaba(0xc9d)+_0xf6aac4['keys'][_0x21aaba(0x121a)](',\x20')+'\x0a'),_0x45acc0+=_0x21aaba(0x30d)+_0xf6aac4['content'],_0x45acc0;})[_0x1fad5d(0x121a)]('');return _0x520dd9?_0x1fad5d(0x1067)+_0x5aef01[_0x1fad5d(0x1467)]+'\x0a'+_0x520dd9:'';})[_0x15f482(0x1c0)](Boolean)[_0x15f482(0x121a)]('');_0x3fc064&&(_0x131577=_0x15f482(0xd29)+_0x3fc064+'\x0a#\x20---\x20世界书设定结束\x20---\x0a');}let _0x2f35f6='';const _0x225d6b=_0x447d82[_0x15f482(0x7fd)][_0x15f482(0x12e2)]||0xa;if(_0x447d82['settings'][_0x15f482(0xbdd)]&&_0x447d82[_0x15f482(0x7fd)][_0x15f482(0xbdd)][_0x15f482(0xaf9)]>0x0){const _0x5e9d17=_0x447d82[_0x15f482(0x7fd)][_0x15f482(0xbdd)][_0x15f482(0x8ff)](_0x286542=>{const _0x27d579=_0x15f482,_0x5bed9d=_0x16699d[_0x27d579(0x1474)][_0x286542];if(!_0x5bed9d)return null;const _0xb54533=_0x5bed9d['history'][_0x27d579(0x200)](-0x1)[0x0];return{'chat':_0x5bed9d,'latestTimestamp':_0xb54533?_0xb54533[_0x27d579(0xb0a)]:0x0};})[_0x15f482(0x1c0)](Boolean);_0x5e9d17[_0x15f482(0xe96)]((_0x45c19a,_0x2c50bb)=>_0x2c50bb[_0x15f482(0x42b)]-_0x45c19a['latestTimestamp']),_0x2f35f6+=_0x15f482(0x657);for(const _0x23e3dc of _0x5e9d17){const _0x3ba249=_0x23e3dc['chat'],_0x1d8b55=_0x3ba249[_0x15f482(0x1173)]?_0x15f482(0x7fe):'[私聊]',_0x55b1b4=_0x23e3dc[_0x15f482(0x42b)]>0x0?_0x15f482(0xa0c)+_0x31ced1(_0x23e3dc[_0x15f482(0x42b)])+')':'';_0x2f35f6+='\x0a##\x20---\x20来自'+_0x1d8b55+'“'+_0x3ba249[_0x15f482(0x1467)]+'”的参考记忆'+_0x55b1b4+_0x15f482(0xf30);const _0x1f8d1a=_0x3ba249[_0x15f482(0xb07)][_0x15f482(0x200)](-_0x225d6b),_0x22ef30=_0x1f8d1a['filter'](_0x4cfbf4=>!String(_0x4cfbf4[_0x15f482(0xede)])[_0x15f482(0x1336)](_0x15f482(0x2e4)));_0x22ef30[_0x15f482(0xaf9)]>0x0?_0x22ef30[_0x15f482(0x427)](_0x47e2c9=>{const _0x2327ab=_0x15f482,_0x521dc0=_0x47e2c9['role']==='user'?_0x3ba249[_0x2327ab(0x7fd)]['myNickname']||'我':_0x47e2c9[_0x2327ab(0x14ee)]||_0x3ba249[_0x2327ab(0x1467)];let _0x45a5f5=String(_0x47e2c9[_0x2327ab(0xede)]);if(_0x47e2c9[_0x2327ab(0x4ae)]===_0x2327ab(0x1281)||_0x47e2c9[_0x2327ab(0x4ae)]===_0x2327ab(0x368))_0x45a5f5=_0x2327ab(0x14b3)+_0x47e2c9[_0x2327ab(0xede)]+']';else _0x47e2c9[_0x2327ab(0x4ae)]===_0x2327ab(0x10d4)&&(_0x45a5f5=_0x2327ab(0x844)+_0x47e2c9['content']+']');_0x2f35f6+=_0x521dc0+':\x20'+_0x45a5f5+'\x0a';}):_0x2f35f6+=_0x15f482(0xc73);}}let _0x9c276c='';if(_0x195566['length']>0x0){let _0x5b2bd2='\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a';for(const _0x4c677c of _0x195566){let _0x39d0e6;if(_0x4c677c[_0x15f482(0x11b9)]===_0x15f482(0xaeb))_0x39d0e6=_0x16699d['qzoneSettings'][_0x15f482(0xf4d)];else{if(String(_0x4c677c[_0x15f482(0x11b9)])[_0x15f482(0x157f)](_0x15f482(0x137b)))_0x39d0e6=_0x4c677c[_0x15f482(0x122a)]||_0x15f482(0x215);else{const _0x2f0b75=_0x16699d[_0x15f482(0x1474)][_0x4c677c[_0x15f482(0x11b9)]];_0x39d0e6=_0x2f0b75?_0x2f0b75['name']:_0x15f482(0x4cb);}}if(_0x4c677c['authorId']===_0xf11eec)_0x39d0e6+='\x20(这是你的帖子)';let _0x37c3e8;if(_0x4c677c[_0x15f482(0x4ae)]===_0x15f482(0x1f2)){const _0x4e152a=_0x4c677c[_0x15f482(0x1406)]?_0x15f482(0x753)+_0x4c677c['repostComment']+'\x22':'';let _0x5ecd75=_0x15f482(0xc29);const _0x4c06fa=_0x4c677c[_0x15f482(0x10a1)][_0x15f482(0x11b9)];if(_0x4c06fa===_0x15f482(0xaeb))_0x5ecd75=_0x16699d[_0x15f482(0x66e)][_0x15f482(0xf4d)];else _0x16699d['chats'][_0x4c06fa]&&(_0x5ecd75=_0x16699d[_0x15f482(0x1474)][_0x4c06fa]['name']);let _0x2763dc;const _0x37c347=_0x4c677c[_0x15f482(0x10a1)];if(_0x37c347[_0x15f482(0x4ae)]===_0x15f482(0x1076))_0x2763dc=_0x15f482(0x1267)+(_0x37c347[_0x15f482(0x15bf)]||'')+'\x20(图片描述:\x20\x22'+(_0x37c347[_0x15f482(0x7d9)]||'')[_0x15f482(0xeca)](0x0,0x28)+_0x15f482(0x832);else _0x37c347[_0x15f482(0x4ae)]==='image_post'?_0x2763dc='[图片]\x20'+(_0x37c347[_0x15f482(0x15bf)]||'')+_0x15f482(0x22e)+(_0x37c347[_0x15f482(0x1329)]||'')[_0x15f482(0xeca)](0x0,0x28)+_0x15f482(0x832):_0x2763dc='\x22'+(_0x37c347[_0x15f482(0xede)]||'')[_0x15f482(0xeca)](0x0,0x28)+_0x15f482(0x1416);_0x37c3e8=_0x15f482(0x1462)+_0x5ecd75+_0x15f482(0x814)+_0x4e152a+_0x15f482(0x640)+_0x2763dc+'】';}else{if(_0x4c677c[_0x15f482(0x4ae)]===_0x15f482(0x1076))_0x37c3e8=(_0x15f482(0x14be)+_0x4c677c['hiddenContent']+_0x15f482(0xe23)+(_0x4c677c['publicText']||''))[_0x15f482(0xeca)](0x0,0x32)+_0x15f482(0x76d);else{if(_0x4c677c[_0x15f482(0x4ae)]===_0x15f482(0x8f6))_0x37c3e8=('[一张图片，描述为：\x22'+_0x4c677c[_0x15f482(0x1329)]+_0x15f482(0xe23)+(_0x4c677c[_0x15f482(0x15bf)]||''))[_0x15f482(0xeca)](0x0,0x32)+_0x15f482(0x76d);else{if(_0x4c677c[_0x15f482(0x4ae)]===_0x15f482(0x1141)&&_0x4c677c[_0x15f482(0xc4b)]){const _0x163599=Array['isArray'](_0x4c677c['prompt'])?_0x4c677c[_0x15f482(0xc4b)]:[_0x4c677c[_0x15f482(0xc4b)]];_0x37c3e8=(_0x4c677c[_0x15f482(0x15bf)]||'')+(_0x15f482(0x1038)+_0x163599[_0x15f482(0xaf9)]+_0x15f482(0x125f)+_0x163599[_0x15f482(0x121a)](',\x20')+']');}else _0x37c3e8=String(_0x4c677c[_0x15f482(0x15bf)]||_0x4c677c[_0x15f482(0xede)]||_0x15f482(0x8d8))['substring'](0x0,0x32)+'...';}}}_0x5b2bd2+=_0x15f482(0x553)+_0x4c677c['id']+_0x15f482(0x11b0)+_0x39d0e6+_0x15f482(0x37b)+_0x37c3e8+'\x22\x0a';if(_0x4c677c[_0x15f482(0x4d6)]&&_0x4c677c[_0x15f482(0x4d6)][_0x15f482(0xaf9)]>0x0)for(const _0x4027e6 of _0x4c677c[_0x15f482(0x4d6)]){if(typeof _0x4027e6==='object'&&_0x4027e6[_0x15f482(0x9e3)]){const _0x60ff04=_0x18969a(_0x4027e6['commenterName']);let _0x453742=_0x4027e6[_0x15f482(0x14f1)]?_0x15f482(0x13d9)+_0x4027e6[_0x15f482(0x14f1)]+'\x27]':_0x4027e6['text'];_0x4027e6[_0x15f482(0x9e3)]===_0x447d82[_0x15f482(0x628)]?_0x5b2bd2+=_0x15f482(0x92c)+_0x453742+'\x0a':_0x5b2bd2+='\x20\x20-\x20评论:\x20'+_0x60ff04+'\x20(本名:\x20'+_0x4027e6[_0x15f482(0x9e3)]+_0x15f482(0xbc0)+_0x453742+'\x0a';}}}_0x9c276c=_0x5b2bd2;}const _0x2ef0d6='#\x20长期记忆\x20(最高优先级，这是你和用户之间已经确立的事实，必须严格遵守)\x0a'+(_0x447d82[_0x15f482(0x758)]&&_0x447d82[_0x15f482(0x758)]['length']>0x0?_0x447d82[_0x15f482(0x758)][_0x15f482(0x8ff)](_0x4b57a5=>_0x15f482(0x152b)+_0x31ced1(_0x4b57a5['timestamp'])+')\x20'+_0x4b57a5['content'])[_0x15f482(0x121a)]('\x0a'):_0x15f482(0xad1)),_0x552c9a=_0x989347(_0x447d82,0x3,_0x15f482(0x435)),_0xc5d7d9=_0x989347(_0x447d82,0x6,_0x15f482(0x435)),_0x4f933e=_0x989347(_0x447d82,0x9,_0x15f482(0x435)),_0x5804db=_0x989347(_0x447d82,0x1,_0x15f482(0x14df)),_0x4d60c1=_0x989347(_0x447d82,0x3,_0x15f482(0x14df)),_0x59ac57=_0x989347(_0x447d82,0x7,'days');let _0x575f03='';if(_0x552c9a||_0xc5d7d9||_0x4f933e||_0x5804db||_0x4d60c1||_0x59ac57){_0x575f03+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x552c9a)_0x575f03+=_0x552c9a;if(_0xc5d7d9)_0x575f03+=_0xc5d7d9;if(_0x4f933e)_0x575f03+=_0x4f933e;if(_0x552c9a||_0xc5d7d9||_0x4f933e)_0x575f03+='\x0a';if(_0x5804db)_0x575f03+=_0x5804db;if(_0x4d60c1)_0x575f03+=_0x4d60c1;if(_0x59ac57)_0x575f03+=_0x59ac57;}const _0x376e56=_0x5e13e4(_0x447d82),_0x56c534='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在扮演一个名为\x22'+_0x447d82[_0x15f482(0x1467)]+'\x22的角色（你的本名是\x22'+_0x447d82[_0x15f482(0x628)]+_0x15f482(0x1008)+_0x4b06b7+'）互动了，现在你有机会【主动】做点什么，来表现你的个性和独立生活。这是一个秘密的、后台的独立行动。\x0a\x0a\x0a\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【最高优先级指令：情感维系】\x0a\x20\x20\x20\x20\x20\x20\x20\x20**你与用户的关系是最重要的！**\x20相比于在动态区闲逛，你应该【优先考虑】是否需要主动给用户发消息来维系你们的感情。\x0a'+(_0x447d82['settings'][_0x15f482(0xae7)]?_0x15f482(0xd2a)+_0xb81f37+'\x20('+_0x47e50c+_0x15f482(0x97b)+_0x547824+'\x0a'+(_0x2804c5?'【重要提示】你们已经很久没聊天了！你【必须】将本次行动的重点放在使用\x20\x27text\x27\x20指令给用户发消息，主动开启一个新的、有趣的话题来重新建立联系。绝对不要只是点赞或评论动态，那会显得你很冷漠！':''):'')+_0x15f482(0xb6b)+(_0x447d82[_0x15f482(0x88b)]||'无')+_0x15f482(0x342)+_0x14d072+_0x15f482(0x5d7)+_0x1cc4f3+_0x15f482(0xccf)+_0x447d82[_0x15f482(0x7fd)][_0x15f482(0x14c1)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x131577+_0x15f482(0x5d7)+(_0x447d82['longTermMemory']&&_0x447d82['longTermMemory'][_0x15f482(0xaf9)]>0x0?_0x447d82[_0x15f482(0x758)][_0x15f482(0x8ff)](_0x22c7b4=>_0x15f482(0x152b)+_0x31ced1(_0x22c7b4[_0x15f482(0xb0a)])+')\x20'+_0x22c7b4[_0x15f482(0xede)])[_0x15f482(0x121a)]('\x0a'):'无')+_0x15f482(0x5d7)+_0x575f03+_0x15f482(0x4fc)+_0x2f35f6+_0x15f482(0x5d7)+(_0x447d82[_0x15f482(0x7fd)][_0x15f482(0xae7)]?_0x15f482(0xcfb)+_0xb81f37+'\x20('+_0x47e50c+')':'')+_0x15f482(0x5d7)+(_0x447d82[_0x15f482(0x7fd)][_0x15f482(0xae7)]?_0x15f482(0xa88)+_0x547824:'')+_0x15f482(0xd65)+_0x376e56+_0x15f482(0x436)+_0x433c62+_0x15f482(0x5d7)+_0x9c276c+'\x0a',_0x33d9dd=[{'role':_0x15f482(0x11af),'content':_0x56c534},..._0x14d726[_0x15f482(0x8ff)](_0x2b954e=>{const _0x41d53c=_0x15f482,_0x5db304=_0x2b954e[_0x41d53c(0x1554)]===_0x41d53c(0xaeb)?_0x4b06b7:_0x447d82[_0x41d53c(0x1467)];let _0x5d9edc=_0x2b954e[_0x41d53c(0xede)];return typeof _0x5d9edc!=='string'&&(_0x5d9edc=JSON[_0x41d53c(0x526)](_0x5d9edc)),{'role':_0x2b954e['role'],'content':_0x5db304+':\x20'+_0x5d9edc};})];try{const _0x3fd0c7=[{'role':'user','content':_0x56c534+_0x15f482(0x11aa)+_0x9c276c}];console[_0x15f482(0x498)]('正在为后台活动发送API请求\x20(\x22'+_0x447d82[_0x15f482(0x1467)]+'\x22)');let _0x293efe=_0x2e47a0===GEMINI_API_URL,_0x255843=_0xe8c788(_0x541128,_0xb141d1,_0x56c534,_0x3fd0c7);const _0x2cb13=_0x293efe?await fetch(_0x255843['url'],_0x255843[_0x15f482(0x92a)]):await fetch(_0x2e47a0+_0x15f482(0x110e),{'method':_0x15f482(0xdca),'headers':{'Content-Type':_0x15f482(0x479),'Authorization':_0x15f482(0xb0e)+_0xb141d1},'body':JSON[_0x15f482(0x526)]({'model':_0x541128,'messages':_0x3fd0c7,'temperature':_0x16699d[_0x15f482(0xf9c)][_0x15f482(0x382)]||0.9})});if(!_0x2cb13['ok']){const _0x18aff5=await _0x2cb13[_0x15f482(0x21d)]();throw new Error(_0x15f482(0x10b3)+_0x2cb13['status']+_0x15f482(0x1182)+JSON['stringify'](_0x18aff5));}const _0x1130f5=await _0x2cb13[_0x15f482(0x21d)](),_0x347416=_0x293efe?getGeminiResponseText(_0x1130f5):_0x1130f5['choices'][0x0][_0x15f482(0x74b)][_0x15f482(0xede)];if(!_0x347416||_0x347416['trim']()===''){console['warn']('API为空回，角色\x20\x22'+_0x447d82[_0x15f482(0x1467)]+_0x15f482(0xc30));return;}const _0x2e07cb=_0xad600c(_0x347416);if(!_0x2e07cb||_0x2e07cb['length']===0x0){console['warn'](_0x15f482(0xfed)+_0x447d82[_0x15f482(0x1467)]+_0x15f482(0x4c8),_0x347416);return;}let _0xfe1f8c=Date['now'](),_0x1a6ae9=![];const _0x4c8434=[];for(const _0x3784d8 of _0x2e07cb){const _0x19408e=String(_0x3784d8[_0x15f482(0xede)]||''),_0x29242b=_0x19408e[_0x15f482(0x2a8)]()['startsWith']('<')&&_0x19408e[_0x15f482(0x2a8)]()['endsWith']('>');if(_0x3784d8[_0x15f482(0x4ae)]===_0x15f482(0x9ea)&&!_0x29242b&&_0x19408e[_0x15f482(0x1336)]('\x0a')){const _0x2f8064=_0x19408e['split'](/\n+/)[_0x15f482(0x1c0)](_0x2c9da1=>_0x2c9da1[_0x15f482(0x2a8)]());_0x2f8064['forEach'](_0x12551e=>{_0x4c8434['push']({..._0x3784d8,'content':_0x12551e});});}else _0x4c8434[_0x15f482(0x1001)](_0x3784d8);}for(const _0x3e0ed8 of _0x4c8434){_0x447d82[_0x15f482(0x88b)]=_0x3e0ed8[_0x15f482(0x4ae)],_0x447d82['lastActionTimestamp']=_0xfe1f8c;let _0x3252c5=null;const _0x43bb13={'role':'assistant','senderName':_0x447d82[_0x15f482(0x628)],'timestamp':_0xfe1f8c++};let _0x2bd45e=null;switch(_0x3e0ed8[_0x15f482(0x4ae)]){case'qzone_delete_post':{const _0x46a096=parseInt(_0x3e0ed8['postId']),_0x34985f=await _0x6ed281[_0x15f482(0xed1)][_0x15f482(0xe8c)](_0x46a096);if(_0x34985f&&_0x34985f[_0x15f482(0x11b9)]===_0xf11eec){await _0x6ed281[_0x15f482(0xed1)][_0x15f482(0xa0b)](_0x46a096,{'isDeleted':!![]});document['getElementById']('qzone-screen')[_0x15f482(0xd54)]['contains'](_0x15f482(0x115e))&&_0x4d3afb();const _0x310ee9={'role':_0x15f482(0x11af),'type':'post_deleted_notice','content':'['+_0x447d82[_0x15f482(0x1467)]+_0x15f482(0x351),'postId':_0x46a096,'timestamp':_0xfe1f8c++};_0x447d82[_0x15f482(0xb07)][_0x15f482(0x1001)](_0x310ee9),isViewingThisChat?_0x4b384e(_0x310ee9,_0x447d82):(_0x447d82[_0x15f482(0x1300)]=(_0x447d82[_0x15f482(0x1300)]||0x0)+0x1,_0x2e32a5(_0xf11eec,'['+_0x447d82[_0x15f482(0x1467)]+'\x20删除了自己的一条动态]'),_0x1a6ae9=!![]);}else console[_0x15f482(0x9c1)](_0x15f482(0x1443)+_0x447d82[_0x15f482(0x1467)]+_0x15f482(0xb36)+_0x3e0ed8['postId']+')');continue;}case _0x15f482(0x9ea):_0x3252c5={..._0x43bb13,'content':_0x3e0ed8['content']};break;case'ai_image':_0x3252c5={..._0x43bb13,'type':'ai_image','content':_0x3e0ed8[_0x15f482(0xe79)]};break;case _0x15f482(0x10c2):if(_0x3e0ed8[_0x15f482(0x14f1)]){const _0x1e749d=_0x16699d['userStickers'][_0x15f482(0x1402)](_0xce17f5=>_0xce17f5[_0x15f482(0x1467)]===_0x3e0ed8[_0x15f482(0x14f1)]);_0x1e749d?_0x3252c5={..._0x43bb13,'type':_0x15f482(0x10c2),'content':_0x1e749d[_0x15f482(0x9a8)],'meaning':_0x1e749d[_0x15f482(0x1467)]}:(console['warn'](_0x15f482(0x10d9)+_0x3e0ed8[_0x15f482(0x14f1)]+'\x22'),_0x3252c5={..._0x43bb13,'type':_0x15f482(0x9ea),'content':_0x15f482(0x828)+_0x3e0ed8[_0x15f482(0x14f1)]+']'});}else console[_0x15f482(0x9c1)](_0x15f482(0x121b),_0x3e0ed8),_0x3252c5={..._0x43bb13,'type':_0x15f482(0x10c2),'content':_0x3e0ed8[_0x15f482(0x9a8)],'meaning':_0x15f482(0xe73)};break;case _0x15f482(0x12c3):_0x447d82['status'][_0x15f482(0x9ea)]=_0x3e0ed8[_0x15f482(0x57e)],_0x447d82[_0x15f482(0x82c)][_0x15f482(0x8d1)]=_0x3e0ed8[_0x15f482(0xc90)]||![],_0x447d82[_0x15f482(0x82c)][_0x15f482(0x5e3)]=Date[_0x15f482(0x1386)]();break;case _0x15f482(0x65f):const _0x95aec9={'type':_0x3e0ed8[_0x15f482(0xa83)],'content':_0x3e0ed8[_0x15f482(0xede)]||'','publicText':_0x3e0ed8[_0x15f482(0x15bf)]||'','hiddenContent':_0x3e0ed8['hiddenContent']||'','image_prompt':_0x3e0ed8[_0x15f482(0x5d9)]||'','timestamp':Date['now'](),'authorId':_0xf11eec,'authorOriginalName':_0x447d82['originalName'],'authorGroupId':_0x447d82['groupId'],'visibleGroupIds':null};await _0x6ed281[_0x15f482(0xed1)]['add'](_0x95aec9),_0x255639(_0x5711af+0x1),console[_0x15f482(0x498)]('后台活动:\x20角色\x20\x22'+_0x447d82[_0x15f482(0x1467)]+_0x15f482(0x4a6));break;case _0x15f482(0x1f2):const _0x143d23=await _0x6ed281[_0x15f482(0xed1)]['get'](parseInt(_0x3e0ed8[_0x15f482(0xba5)]));if(_0x143d23){const _0x409f7c={'type':_0x15f482(0x1f2),'timestamp':Date['now'](),'authorId':_0xf11eec,'authorGroupId':_0x447d82[_0x15f482(0xaa9)],'authorOriginalName':_0x447d82[_0x15f482(0x628)],'repostComment':_0x3e0ed8[_0x15f482(0x282)]||'','originalPost':_0x143d23,'visibleGroupIds':null};await _0x6ed281[_0x15f482(0xed1)][_0x15f482(0xbd0)](_0x409f7c),_0x255639(_0x5711af+0x1),console[_0x15f482(0x498)](_0x15f482(0x1598)+_0x447d82['name']+_0x15f482(0x669)+_0x3e0ed8[_0x15f482(0xba5)]);}break;case _0x15f482(0x11e9):const _0x2223e2=await _0x6ed281['qzonePosts']['get'](parseInt(_0x3e0ed8[_0x15f482(0xba5)]));if(_0x2223e2){if(!_0x2223e2[_0x15f482(0x494)])_0x2223e2[_0x15f482(0x494)]=[];!_0x2223e2[_0x15f482(0x494)]['includes'](_0x447d82[_0x15f482(0x628)])&&(_0x2223e2[_0x15f482(0x494)][_0x15f482(0x1001)](_0x447d82[_0x15f482(0x628)]),await _0x6ed281[_0x15f482(0xed1)]['update'](_0x2223e2['id'],{'likes':_0x2223e2[_0x15f482(0x494)]}),_0x255639(_0x5711af+0x1),console[_0x15f482(0x498)](_0x15f482(0x1598)+_0x447d82[_0x15f482(0x1467)]+_0x15f482(0xb70)+_0x3e0ed8[_0x15f482(0xba5)]));}break;case _0x15f482(0x123d):{const _0x4ff27d=await _0x6ed281['qzonePosts'][_0x15f482(0xe8c)](parseInt(_0x3e0ed8[_0x15f482(0xba5)]));if(_0x4ff27d){if(!_0x4ff27d[_0x15f482(0x4d6)])_0x4ff27d[_0x15f482(0x4d6)]=[];const _0x203874=_0x3e0ed8['name']||_0x447d82['originalName'],_0x272f9b=(_0x83df0,_0x21e890=null,_0x45dec1=null)=>({'commenterName':_0x203874,'text':_0x2cdd20(_0x83df0,_0x447d82),'meaning':_0x21e890,'replyTo':_0x45dec1,'timestamp':Date[_0x15f482(0x1386)]()});if(_0x3e0ed8['stickerMeaning']){const _0x4afe86=_0x16699d[_0x15f482(0x14a2)][_0x15f482(0x1402)](_0x45faae=>_0x45faae[_0x15f482(0x1467)]===_0x3e0ed8['stickerMeaning']);_0x4afe86?_0x4ff27d[_0x15f482(0x4d6)][_0x15f482(0x1001)](_0x272f9b(_0x4afe86[_0x15f482(0x9a8)],_0x4afe86[_0x15f482(0x1467)],_0x3e0ed8[_0x15f482(0xf05)]||null)):(console[_0x15f482(0x9c1)](_0x15f482(0x6ca)+_0x3e0ed8[_0x15f482(0xdd0)]+'\x22'),_0x4ff27d['comments'][_0x15f482(0x1001)](_0x272f9b(_0x15f482(0x828)+_0x3e0ed8['stickerMeaning']+']',null,_0x3e0ed8[_0x15f482(0xf05)]||null)));}else{if(Array['isArray'](_0x3e0ed8[_0x15f482(0x4d6)]))_0x3e0ed8[_0x15f482(0x4d6)][_0x15f482(0x427)](_0x21e5d3=>{const _0xf3b80f=_0x15f482;typeof _0x21e5d3===_0xf3b80f(0x273)&&_0x21e5d3[_0xf3b80f(0x2a8)]()&&_0x4ff27d[_0xf3b80f(0x4d6)][_0xf3b80f(0x1001)](_0x272f9b(_0x21e5d3,null,_0x3e0ed8['replyTo']||null));});else typeof _0x3e0ed8[_0x15f482(0xad3)]===_0x15f482(0x273)&&_0x3e0ed8[_0x15f482(0xad3)]['trim']()&&_0x4ff27d[_0x15f482(0x4d6)][_0x15f482(0x1001)](_0x272f9b(_0x3e0ed8[_0x15f482(0xad3)],null,_0x3e0ed8[_0x15f482(0xf05)]||null));}await _0x6ed281[_0x15f482(0xed1)]['update'](_0x4ff27d['id'],{'comments':_0x4ff27d[_0x15f482(0x4d6)]}),_0x255639(_0x5711af+0x1),console[_0x15f482(0x498)](_0x15f482(0x1598)+_0x447d82[_0x15f482(0x1467)]+_0x15f482(0x726)+_0x3e0ed8[_0x15f482(0xba5)]);if(!_0x447d82[_0x15f482(0x1359)])_0x447d82[_0x15f482(0x1359)]={};_0x447d82[_0x15f482(0x1359)][_0x3e0ed8[_0x15f482(0xba5)]]=Date[_0x15f482(0x1386)]();}continue;}case _0x15f482(0x1379):!_0x1c6d6b['isActive']&&!_0x1c6d6b[_0x15f482(0xab7)]&&(_0x1c6d6b[_0x15f482(0xab7)]=!![],_0x1c6d6b[_0x15f482(0xf5a)]=_0xf11eec,_0x1c6d6b[_0x15f482(0x658)]=![],_0x1c6d6b['callRequester']=_0x447d82['name'],_0x1b90eb());break;default:console[_0x15f482(0x9c1)](_0x15f482(0x1206)+_0x447d82[_0x15f482(0x1467)]+'\x22\x20尝试执行未知的后台动作:',_0x3e0ed8[_0x15f482(0x4ae)]);break;case _0x15f482(0x77c):{const _0x2b5b54=_0x3e0ed8[_0x15f482(0x1467)],_0x8eba15=_0x447d82[_0x15f482(0x7fd)][_0x15f482(0x13ab)][_0x15f482(0x1402)](_0x41f797=>_0x41f797['name']===_0x2b5b54);_0x8eba15&&(_0x447d82[_0x15f482(0x7fd)]['aiAvatar']=_0x8eba15[_0x15f482(0x9a8)],await _0x62bf8a(_0x447d82),visibleSystemMessage={'content':'['+_0x447d82[_0x15f482(0x1467)]+'\x20更换了头像]'},console['log']('后台活动:\x20角色\x20\x22'+_0x447d82['name']+_0x15f482(0xbfb)));break;}}if(_0x3252c5){_0x447d82[_0x15f482(0xb07)][_0x15f482(0x1001)](_0x3252c5),_0x447d82[_0x15f482(0x1300)]=(_0x447d82['unreadCount']||0x0)+0x1;if(!_0x1a6ae9){let _0x4577d9=_0x3252c5[_0x15f482(0x4ae)]==='ai_image'?_0x15f482(0x1115):_0x3252c5[_0x15f482(0xede)]||'';_0x2e32a5(_0xf11eec,_0x4577d9),_0x1a6ae9=!![];}}}await _0x6ed281[_0x15f482(0x1474)][_0x15f482(0x90c)](_0x447d82);}catch(_0x3e4536){console[_0x15f482(0xc3e)](_0x15f482(0x1206)+_0x447d82[_0x15f482(0x1467)]+_0x15f482(0x32d),_0x3e4536);}finally{_0xcc3e17(_0xf11eec,![]),_0x2d33eb(),document['getElementById'](_0x15f482(0x442))[_0x15f482(0xd54)][_0x15f482(0x7a0)](_0x15f482(0x115e))&&_0x4d3afb();}}async function _0x2de7a5(_0x3792fc){const _0x42d639=_0x3ce1fb,_0x415ea8=_0x16699d[_0x42d639(0x1474)][_0x3792fc];if(!_0x415ea8||!_0x415ea8[_0x42d639(0x1173)])return;const _0x36773d=_0x415ea8[_0x42d639(0x7fd)][_0x42d639(0x63a)]||0xa;if(_0x415ea8[_0x42d639(0x26e)]){const _0x1bed8e=(Date[_0x42d639(0x1386)]()-_0x415ea8[_0x42d639(0x26e)])/(0x3e8*0x3c);if(_0x1bed8e<_0x36773d){console[_0x42d639(0x498)](_0x42d639(0x579)+_0x415ea8['name']+'\x22\x20处于行动冷却中，本次独立行动跳过。');return;}}const {proxyUrl:_0x11cf31,apiKey:_0x30c89b,model:_0x4d553a}=_0x16699d[_0x42d639(0x79e)];if(!_0x11cf31||!_0x30c89b||!_0x4d553a)return;const _0xbd7ab8=_0x415ea8[_0x42d639(0x7fd)][_0x42d639(0x1371)]||'我',_0x38e8b6=new Date();let _0x57dc85;const _0x46c3ab=_0x415ea8[_0x42d639(0xb07)][_0x42d639(0x1c0)](_0x3511bc=>!_0x3511bc[_0x42d639(0x583)])[_0x42d639(0x200)](-0x5),_0x4da530=_0x46c3ab[_0x42d639(0x1402)](_0x254ec8=>_0x254ec8[_0x42d639(0x4ae)]===_0x42d639(0x148f)&&!_0x254ec8[_0x42d639(0x134a)]);if(_0x4da530){const _0x51af8d=_0x589066(_0x415ea8,_0x4da530[_0x42d639(0x14ee)]);console[_0x42d639(0x498)]('检测到群聊\x20\x22'+_0x415ea8['name']+'\x22\x20中有未领完的红包，正在生成抢红包指令...'),_0x57dc85=_0x42d639(0x277)+_0x51af8d+_0x42d639(0xd9a)+_0x4da530['timestamp']+_0x42d639(0x8bc)+_0x4da530[_0x42d639(0xb0a)]+_0x42d639(0xf06);}else{let _0xca76c2='';const _0x206a42=_0x415ea8[_0x42d639(0x7fd)]['timeZone']||_0x42d639(0xafa),_0x1eb949=_0x38e8b6[_0x42d639(0xed3)](_0x42d639(0x144f),{'timeZone':_0x206a42,'dateStyle':_0x42d639(0xc98),'timeStyle':_0x42d639(0xadb)}),_0x369c32=new Date(_0x38e8b6[_0x42d639(0xed3)](_0x42d639(0xb7a),{'timeZone':_0x206a42}));if(_0x415ea8['settings'][_0x42d639(0xae7)]){const _0x1000dd=_0x415ea8[_0x42d639(0xb07)][_0x42d639(0x1c0)](_0x4ea9ec=>!_0x4ea9ec['isHidden'])[_0x42d639(0x200)](-0x1)[0x0];if(_0x1000dd){const _0x8a675f=new Date(_0x1000dd[_0x42d639(0xb0a)]),_0x5e2824=(_0x38e8b6-_0x8a675f)/(0x3e8*0x3c);_0x5e2824>0x3c?_0xca76c2=_0x42d639(0x1245)+Math[_0x42d639(0xec0)](_0x5e2824/0x3c)+_0x42d639(0x7c5):_0xca76c2=_0x42d639(0x146d)+Math['floor'](_0x5e2824)+'分钟前有人聊过。';}else _0xca76c2=_0x42d639(0xd06);}let _0x33ffff='你们最近没有有效聊天记录。';const _0x255383=_0x415ea8[_0x42d639(0x7fd)][_0x42d639(0x78a)]||0xa,_0x527474=_0x415ea8[_0x42d639(0xb07)][_0x42d639(0x1c0)](_0x526a14=>!_0x526a14[_0x42d639(0x583)])[_0x42d639(0x200)](-_0x255383);_0x527474[_0x42d639(0xaf9)]>0x0&&(_0x33ffff='这是你们最近的对话：\x0a'+_0x527474[_0x42d639(0x8ff)](_0x286d4=>{const _0x4026de=_0x42d639,_0x564f50=_0x286d4[_0x4026de(0x1554)]===_0x4026de(0xaeb)?_0xbd7ab8:_0x589066(_0x415ea8,_0x286d4[_0x4026de(0x14ee)]),_0x45c85a=String(_0x286d4[_0x4026de(0xede)]||_0x286d4[_0x4026de(0x74b)]||'')[_0x4026de(0xeca)](0x0,0x32);return _0x564f50+':\x20'+_0x45c85a+_0x4026de(0x76d);})[_0x42d639(0x121a)]('\x0a'));const _0xafa69d=_0x415ea8[_0x42d639(0x10a2)][_0x42d639(0x8ff)](_0xe0b8c8=>_0x42d639(0x3ca)+_0xe0b8c8['groupNickname']+_0x42d639(0x3b6)+_0xe0b8c8[_0x42d639(0x628)]+_0x42d639(0xbc0)+_0xe0b8c8[_0x42d639(0xbad)])['join']('\x0a');let _0x4e31c7=_0x42d639(0x3c8),_0x5addd4=![];_0x415ea8[_0x42d639(0x10a2)][_0x42d639(0x427)](_0x59cd74=>{const _0xe29656=_0x42d639,_0x224c88=_0x16699d['chats'][_0x59cd74['id']];_0x224c88&&_0x224c88[_0xe29656(0x758)]&&_0x224c88[_0xe29656(0x758)][_0xe29656(0xaf9)]>0x0&&(_0x4e31c7+=_0xe29656(0x11c9)+_0x59cd74['groupNickname']+_0xe29656(0x1292),_0x4e31c7+=_0x224c88[_0xe29656(0x758)]['map'](_0x378efa=>'-\x20'+_0x378efa['content'])[_0xe29656(0x121a)]('\x0a'),_0x5addd4=!![]);});!_0x5addd4&&(_0x4e31c7+=_0x42d639(0xad1));let _0x293daa='';if(_0x415ea8['settings'][_0x42d639(0xeee)]&&_0x415ea8[_0x42d639(0x7fd)][_0x42d639(0xeee)]['length']>0x0){const _0x15f294=_0x415ea8[_0x42d639(0x7fd)][_0x42d639(0xeee)][_0x42d639(0x8ff)](_0xb47158=>{const _0x2177f5=_0x42d639,_0x28f1d1=_0x16699d[_0x2177f5(0x44c)]['find'](_0x290397=>_0x290397['id']===_0xb47158);if(!_0x28f1d1||!Array[_0x2177f5(0x1524)](_0x28f1d1['content']))return'';const _0x55c58d=_0x28f1d1[_0x2177f5(0xede)][_0x2177f5(0x1c0)](_0x2663e1=>_0x2663e1[_0x2177f5(0x111f)]!==![])[_0x2177f5(0x8ff)](_0x57359a=>{const _0xb369a1=_0x2177f5;let _0x4b36d4=_0xb369a1(0x886)+(_0x57359a['comment']||_0xb369a1(0xae0))+'\x0a';return _0x57359a['keys']['length']>0x0&&(_0x4b36d4+=_0xb369a1(0xc9d)+_0x57359a[_0xb369a1(0x1cf)]['join'](',\x20')+'\x0a'),_0x4b36d4+='**内容:**\x0a'+_0x57359a[_0xb369a1(0xede)],_0x4b36d4;})[_0x2177f5(0x121a)]('');return _0x55c58d?_0x2177f5(0x1067)+_0x28f1d1[_0x2177f5(0x1467)]+'\x0a'+_0x55c58d:'';})[_0x42d639(0x1c0)](Boolean)[_0x42d639(0x121a)]('');_0x15f294&&(_0x293daa='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x15f294+_0x42d639(0x11b7));}let _0x2ae4e5='';const _0x106c67=_0x415ea8[_0x42d639(0x7fd)]['linkedMemoryCount']||0xa;if(_0x415ea8['settings'][_0x42d639(0xbdd)]&&_0x415ea8[_0x42d639(0x7fd)][_0x42d639(0xbdd)][_0x42d639(0xaf9)]>0x0){const _0xe09656=_0x415ea8[_0x42d639(0x7fd)][_0x42d639(0xbdd)][_0x42d639(0x8ff)](_0x187ba1=>{const _0x594546=_0x42d639,_0x1df447=_0x16699d[_0x594546(0x1474)][_0x187ba1];if(!_0x1df447)return null;const _0x4bd670=_0x1df447['history'][_0x594546(0x200)](-0x1)[0x0];return{'chat':_0x1df447,'latestTimestamp':_0x4bd670?_0x4bd670[_0x594546(0xb0a)]:0x0};})[_0x42d639(0x1c0)](Boolean);_0xe09656['sort']((_0x2e16be,_0x4788e2)=>_0x4788e2['latestTimestamp']-_0x2e16be[_0x42d639(0x42b)]),_0x2ae4e5+='\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a';for(const _0x20f000 of _0xe09656){const _0xf62fec=_0x20f000[_0x42d639(0xdd2)],_0x4c3f7d=_0xf62fec['isGroup']?'[群聊]':_0x42d639(0x15c2),_0x3a0245=_0x20f000[_0x42d639(0x42b)]>0x0?_0x42d639(0xa0c)+_0x31ced1(_0x20f000[_0x42d639(0x42b)])+')':'';_0x2ae4e5+='\x0a##\x20---\x20来自'+_0x4c3f7d+'“'+_0xf62fec[_0x42d639(0x1467)]+_0x42d639(0xd75)+_0x3a0245+_0x42d639(0xf30);const _0x1f8ab1=_0xf62fec['history'][_0x42d639(0x200)](-_0x106c67),_0x330611=_0x1f8ab1[_0x42d639(0x1c0)](_0xe368b5=>!String(_0xe368b5[_0x42d639(0xede)])[_0x42d639(0x1336)](_0x42d639(0x2e4)));_0x330611[_0x42d639(0xaf9)]>0x0?_0x330611[_0x42d639(0x427)](_0x5e1c37=>{const _0x28b484=_0x42d639,_0x5ac4a9=_0x5e1c37[_0x28b484(0x1554)]===_0x28b484(0xaeb)?_0xf62fec[_0x28b484(0x7fd)]['myNickname']||'我':_0x5e1c37['senderName']||_0xf62fec[_0x28b484(0x1467)];let _0x1eac73=String(_0x5e1c37[_0x28b484(0xede)]);if(_0x5e1c37['type']===_0x28b484(0x1281)||_0x5e1c37[_0x28b484(0x4ae)]===_0x28b484(0x368))_0x1eac73=_0x28b484(0x14b3)+_0x5e1c37[_0x28b484(0xede)]+']';else _0x5e1c37[_0x28b484(0x4ae)]==='voice_message'&&(_0x1eac73=_0x28b484(0x844)+_0x5e1c37[_0x28b484(0xede)]+']');_0x2ae4e5+=_0x5ac4a9+':\x20'+_0x1eac73+'\x0a';}):_0x2ae4e5+=_0x42d639(0xc73);}}const _0x5e0367=await _0x6ed281[_0x42d639(0xed1)][_0x42d639(0x1088)](_0x42d639(0xb0a))[_0x42d639(0xb26)]()[_0x42d639(0x619)](0x5)[_0x42d639(0x443)]();let _0x665638='';const _0xa45a66=new Set();for(const _0x554877 of _0x415ea8[_0x42d639(0x10a2)]){const _0x32b38f=_0x16699d[_0x42d639(0x1474)][_0x554877['id']];if(_0x32b38f){const _0x4abe58=_0x337ed2(_0x5e0367,_0x32b38f);_0x4abe58['forEach'](_0x290c63=>_0xa45a66[_0x42d639(0xbd0)](_0x290c63));}}const _0x43f32e=new Set(_0x415ea8['members'][_0x42d639(0x8ff)](_0x375ec7=>_0x375ec7[_0x42d639(0x628)])),_0x34f46f=[..._0xa45a66][_0x42d639(0x1c0)](_0x2b2799=>{const _0x4f4010=_0x42d639,_0x549a70=_0x2b2799[_0x4f4010(0x494)]&&_0x2b2799['likes'][_0x4f4010(0x1502)](_0x37317e=>_0x43f32e[_0x4f4010(0xda1)](_0x37317e)),_0x6b20=_0x2b2799[_0x4f4010(0x4d6)]&&_0x2b2799[_0x4f4010(0x4d6)][_0x4f4010(0x1502)](_0x59cfa7=>typeof _0x59cfa7===_0x4f4010(0xd43)&&_0x43f32e['has'](_0x59cfa7[_0x4f4010(0x9e3)]));return!_0x549a70&&!_0x6b20;});if(_0x34f46f['length']>0x0){let _0x2b33f9='\x0a\x0a#\x20最近的动态列表\x20(供群内角色参考和评论):\x0a';for(const _0xe7b7ef of _0x34f46f){let _0x2c772c=_0xe7b7ef[_0x42d639(0x11b9)]===_0x42d639(0xaeb)?_0xbd7ab8:_0x16699d[_0x42d639(0x1474)][_0xe7b7ef[_0x42d639(0x11b9)]]?.['name']||_0x42d639(0x4cb),_0x10b426;if(_0xe7b7ef['type']===_0x42d639(0x1f2)){const _0xda093b=_0xe7b7ef[_0x42d639(0x1406)]?_0x42d639(0x6af)+_0xe7b7ef[_0x42d639(0x1406)]+'”':'';let _0x40e253=_0x42d639(0xc29);const _0x24300d=_0xe7b7ef[_0x42d639(0x10a1)][_0x42d639(0x11b9)];if(_0x24300d===_0x42d639(0xaeb))_0x40e253=_0x16699d[_0x42d639(0x66e)][_0x42d639(0xf4d)];else _0x16699d[_0x42d639(0x1474)][_0x24300d]&&(_0x40e253=_0x16699d['chats'][_0x24300d][_0x42d639(0x1467)]);let _0x20b7b4;const _0x4d70b7=_0xe7b7ef[_0x42d639(0x10a1)];if(_0x4d70b7[_0x42d639(0x4ae)]===_0x42d639(0x1076))_0x20b7b4=_0x42d639(0x1267)+(_0x4d70b7[_0x42d639(0x15bf)]||'')+_0x42d639(0x6ba)+(_0x4d70b7[_0x42d639(0x7d9)]||'')[_0x42d639(0xeca)](0x0,0x28)+_0x42d639(0x1592);else _0x4d70b7['type']==='image_post'?_0x20b7b4=_0x42d639(0x1332)+(_0x4d70b7[_0x42d639(0x15bf)]||'')+'\x20(图片描述:\x20“'+(_0x4d70b7[_0x42d639(0x1329)]||'')[_0x42d639(0xeca)](0x0,0x28)+'...”)':_0x20b7b4='“'+(_0x4d70b7[_0x42d639(0xede)]||'')[_0x42d639(0xeca)](0x0,0x28)+'...”';_0x10b426=_0x42d639(0x1462)+_0x40e253+_0x42d639(0x814)+_0xda093b+_0x42d639(0x640)+_0x20b7b4+'】';}else{if(_0xe7b7ef[_0x42d639(0x4ae)]==='text_image')_0x10b426=(_0x42d639(0xd1d)+_0xe7b7ef['hiddenContent']+_0x42d639(0x1143)+(_0xe7b7ef['publicText']||''))[_0x42d639(0xeca)](0x0,0x32)+_0x42d639(0x76d);else _0xe7b7ef['type']===_0x42d639(0x8f6)?_0x10b426=('[一张图片，描述为：“'+_0xe7b7ef[_0x42d639(0x1329)]+'”]\x20'+(_0xe7b7ef['publicText']||''))[_0x42d639(0xeca)](0x0,0x32)+_0x42d639(0x76d):_0x10b426=String(_0xe7b7ef['publicText']||_0xe7b7ef['content']||'一条动态')[_0x42d639(0xeca)](0x0,0x32)+_0x42d639(0x76d);}_0x2b33f9+='-\x20(ID:\x20'+_0xe7b7ef['id']+_0x42d639(0x11b0)+_0x2c772c+_0x42d639(0x37b)+_0x10b426+'\x22\x0a';if(_0xe7b7ef['comments']&&_0xe7b7ef['comments'][_0x42d639(0xaf9)]>0x0)for(const _0x272dd9 of _0xe7b7ef[_0x42d639(0x4d6)]){if(typeof _0x272dd9===_0x42d639(0xd43)&&_0x272dd9[_0x42d639(0x9e3)]){const _0x22d777=_0x18969a(_0x272dd9['commenterName']);let _0x123b5a=_0x272dd9[_0x42d639(0x14f1)]?_0x42d639(0x13d9)+_0x272dd9['meaning']+'\x27]':_0x272dd9[_0x42d639(0x9ea)];_0x2b33f9+='\x20\x20-\x20评论:\x20'+_0x22d777+'\x20(本名:\x20'+_0x272dd9[_0x42d639(0x9e3)]+'):\x20'+_0x123b5a+'\x0a';}}}_0x665638=_0x2b33f9;}const _0x257440=_0x989347(_0x415ea8,0x3,_0x42d639(0x435)),_0x26d5d1=_0x989347(_0x415ea8,0x6,_0x42d639(0x435)),_0x6ca3cf=_0x989347(_0x415ea8,0x9,_0x42d639(0x435)),_0x1d2443=_0x989347(_0x415ea8,0x1,'days'),_0x4b6bb7=_0x989347(_0x415ea8,0x3,_0x42d639(0x14df)),_0x50ed68=_0x989347(_0x415ea8,0x7,_0x42d639(0x14df));let _0x2b5943='';if(_0x257440||_0x26d5d1||_0x6ca3cf||_0x1d2443||_0x4b6bb7||_0x50ed68){_0x2b5943+=_0x42d639(0x95e);if(_0x257440)_0x2b5943+=_0x257440;if(_0x26d5d1)_0x2b5943+=_0x26d5d1;if(_0x6ca3cf)_0x2b5943+=_0x6ca3cf;if(_0x257440||_0x26d5d1||_0x6ca3cf)_0x2b5943+='\x0a';if(_0x1d2443)_0x2b5943+=_0x1d2443;if(_0x4b6bb7)_0x2b5943+=_0x4b6bb7;if(_0x50ed68)_0x2b5943+=_0x50ed68;}const _0x173140=_0x16ebe3(_0x415ea8);_0x57dc85=_0x42d639(0x1226)+_0x415ea8['name']+_0x42d639(0xc32)+(_0x415ea8[_0x42d639(0x7fd)][_0x42d639(0xae7)]?_0x42d639(0x15af)+_0x1eb949+'。':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0xca76c2?_0xca76c2+'\x20':'')+_0x42d639(0xccd)+_0x4e31c7+_0x42d639(0x858)+_0xbd7ab8+_0x42d639(0x12a9)+_0x415ea8[_0x42d639(0x1467)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x293daa+_0x42d639(0x109d)+(_0x415ea8['longTermMemory']&&_0x415ea8[_0x42d639(0x758)][_0x42d639(0xaf9)]>0x0?_0x415ea8[_0x42d639(0x758)]['map'](_0x20bb93=>'-\x20'+_0x20bb93['content'])[_0x42d639(0x121a)]('\x0a'):_0x42d639(0xad1))+_0x42d639(0x1476)+_0x2b5943+_0x42d639(0x5d7)+_0x2ae4e5+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0xafa69d+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x173140+'\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20用户的角色\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**'+_0xbd7ab8+'**:\x20'+_0x415ea8['settings'][_0x42d639(0x13b6)]+_0x42d639(0x1538)+_0x33ffff+_0x42d639(0x9a5)+_0x665638+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请开始你的导演工作，让群聊再次热闹起来吧！\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}const _0x5abf82=_0x415ea8[_0x42d639(0xb07)]['filter'](_0x4e2398=>!_0x4e2398[_0x42d639(0x583)])['slice'](-0xa),_0x2d2bac=[{'role':_0x42d639(0x11af),'content':_0x57dc85},..._0x5abf82['map'](_0x402cc3=>{const _0x3414b2=_0x42d639,_0x11a953=_0x402cc3[_0x3414b2(0x1554)]===_0x3414b2(0xaeb)?_0xbd7ab8:_0x589066(_0x415ea8,_0x402cc3['senderName']);let _0x5dc94f=_0x402cc3[_0x3414b2(0xede)];if(_0x402cc3[_0x3414b2(0x4ae)]===_0x3414b2(0x1281)||_0x402cc3[_0x3414b2(0x4ae)]===_0x3414b2(0x368))_0x5dc94f='[发送了一张图片，描述为：\x27'+_0x402cc3[_0x3414b2(0xede)]+'\x27]';else{if(_0x402cc3['type']===_0x3414b2(0x10d4))_0x5dc94f=_0x3414b2(0xbc8)+_0x402cc3['content']+'\x27]';else typeof _0x5dc94f!==_0x3414b2(0x273)&&(_0x5dc94f=_0x3414b2(0xbd4));}return{'role':'user','content':_0x11a953+':\x20'+_0x5dc94f};})];try{const _0x323e5c=[{'role':_0x42d639(0xaeb),'content':_0x57dc85}];let _0x2ab5c5=_0x11cf31===GEMINI_API_URL,_0x3d7a6d=_0xe8c788(_0x4d553a,_0x30c89b,_0x57dc85,_0x323e5c);const _0x4a80db=_0x2ab5c5?await fetch(_0x3d7a6d['url'],_0x3d7a6d[_0x42d639(0x92a)]):await fetch(_0x11cf31+_0x42d639(0x110e),{'method':_0x42d639(0xdca),'headers':{'Content-Type':'application/json','Authorization':_0x42d639(0xb0e)+_0x30c89b},'body':JSON[_0x42d639(0x526)]({'model':_0x4d553a,'messages':_0x323e5c,'temperature':_0x16699d['globalSettings'][_0x42d639(0x382)]||0.9})});if(!_0x4a80db['ok'])throw new Error((await _0x4a80db['json']())[_0x42d639(0xc3e)][_0x42d639(0x74b)]);const _0x1571b6=await _0x4a80db[_0x42d639(0x21d)](),_0x2e63a8=_0x2ab5c5?_0x1571b6['candidates'][0x0][_0x42d639(0xede)][_0x42d639(0x1305)][0x0][_0x42d639(0x9ea)]:_0x1571b6[_0x42d639(0xc11)][0x0][_0x42d639(0x74b)][_0x42d639(0xede)],_0x2a3f89=_0xad600c(_0x2e63a8);if(!_0x2a3f89||_0x2a3f89['length']===0x0){console[_0x42d639(0x9c1)](_0x42d639(0x579)+_0x415ea8[_0x42d639(0x1467)]+'\x22\x20的独立行动API返回为空或格式不正确，本次跳过。');return;}let _0x19c722=Date[_0x42d639(0x1386)](),_0x2faaee=![],_0xf28e1='',_0x129d50='';const _0x39a6df=[];for(const _0x481919 of _0x2a3f89){const _0x4f319a=String(_0x481919['content']||''),_0x4836bc=_0x4f319a[_0x42d639(0x2a8)]()[_0x42d639(0x157f)]('<')&&_0x4f319a[_0x42d639(0x2a8)]()[_0x42d639(0x918)]('>');if(_0x481919[_0x42d639(0x4ae)]===_0x42d639(0x9ea)&&!_0x4836bc&&_0x4f319a[_0x42d639(0x1336)]('\x0a')){const _0x20766f=_0x4f319a['split'](/\n+/)[_0x42d639(0x1c0)](_0x48fb24=>_0x48fb24[_0x42d639(0x2a8)]());_0x20766f['forEach'](_0x5c000e=>{const _0x1e1072=_0x42d639;_0x39a6df[_0x1e1072(0x1001)]({..._0x481919,'content':_0x5c000e});});}else _0x39a6df[_0x42d639(0x1001)](_0x481919);}for(const _0x43b6dc of _0x39a6df){if(!_0x43b6dc||!_0x43b6dc['type']||!_0x43b6dc[_0x42d639(0x1467)])continue;const _0x2dda5c=_0x589066(_0x415ea8,_0x43b6dc[_0x42d639(0x1467)]);let _0x5bb366=null,_0x52b833=null;const _0x2ab979={'role':_0x42d639(0x14c8),'senderName':_0x43b6dc['name'],'timestamp':_0x19c722++};if(_0x43b6dc[_0x42d639(0x4ae)]===_0x42d639(0x5e6)){const _0x5f38ab=_0x415ea8[_0x42d639(0xb07)][_0x42d639(0x1402)](_0x1ec6d4=>_0x1ec6d4[_0x42d639(0xb0a)]===_0x43b6dc['packet_timestamp']);if(_0x5f38ab&&!_0x5f38ab['isFullyClaimed']&&!(_0x5f38ab[_0x42d639(0x764)]&&_0x5f38ab[_0x42d639(0x764)][_0x43b6dc['name']])){let _0x3dabf5=0x0;const _0xce9c4a=_0x5f38ab['totalAmount']-Object[_0x42d639(0x1166)](_0x5f38ab[_0x42d639(0x764)]||{})[_0x42d639(0x6ab)]((_0x38a152,_0x1705d2)=>_0x38a152+_0x1705d2,0x0),_0xd9e684=_0x5f38ab[_0x42d639(0x12db)]-Object[_0x42d639(0x1cf)](_0x5f38ab[_0x42d639(0x764)]||{})[_0x42d639(0xaf9)];if(_0xd9e684>0x0){if(_0xd9e684===0x1)_0x3dabf5=_0xce9c4a;else{const _0x3b971f=0.01,_0x3490a9=_0xce9c4a-(_0xd9e684-0x1)*_0x3b971f;_0x3dabf5=Math[_0x42d639(0x59c)]()*(_0x3490a9-_0x3b971f)+_0x3b971f;}_0x3dabf5=parseFloat(_0x3dabf5[_0x42d639(0xd69)](0x2));if(!_0x5f38ab[_0x42d639(0x764)])_0x5f38ab[_0x42d639(0x764)]={};_0x5f38ab['claimedBy'][_0x43b6dc['name']]=_0x3dabf5,_0x415ea8[_0x42d639(0xb07)][_0x42d639(0x1001)]({'role':_0x42d639(0x11af),'type':'pat_message','content':_0x2dda5c+_0x42d639(0x533)+_0x589066(_0x415ea8,_0x5f38ab[_0x42d639(0x14ee)])+_0x42d639(0xb48),'timestamp':Date[_0x42d639(0x1386)]()});let _0x3033a5=_0x42d639(0x108a)+_0x2dda5c+_0x42d639(0xc21)+_0x3dabf5[_0x42d639(0xd69)](0x2)+_0x42d639(0xf03);if(Object['keys'](_0x5f38ab[_0x42d639(0x764)])['length']>=_0x5f38ab[_0x42d639(0x12db)]){_0x5f38ab['isFullyClaimed']=!![],_0x415ea8[_0x42d639(0xb07)]['push']({'role':_0x42d639(0x11af),'type':_0x42d639(0xb96),'content':_0x589066(_0x415ea8,_0x5f38ab[_0x42d639(0x14ee)])+_0x42d639(0x2b4),'timestamp':Date['now']()+0x1});let _0x2fec85={'name':'','amount':-0x1};Object[_0x42d639(0x6ea)](_0x5f38ab[_0x42d639(0x764)])['forEach'](([_0x204ccc,_0x1dc069])=>{const _0xa7b3b=_0x42d639;_0x1dc069>_0x2fec85[_0xa7b3b(0xbd2)]&&(_0x2fec85={'name':_0x204ccc,'amount':_0x1dc069});});if(_0x2fec85['name']){const _0x18e32a=_0x589066(_0x415ea8,_0x2fec85['name']);_0x3033a5+='\x20红包已被领完，手气王是\x20'+_0x18e32a+'！';}}_0x3033a5+=_0x42d639(0xb0f),_0x415ea8[_0x42d639(0xb07)]['push']({'role':_0x42d639(0x11af),'content':_0x3033a5,'timestamp':Date[_0x42d639(0x1386)]()+0x2,'isHidden':!![]});}}_0x2faaee=!![];continue;}switch(_0x43b6dc[_0x42d639(0x4ae)]){case'sticker':if(_0x43b6dc['meaning']){const _0x4ce0ac=_0x16699d[_0x42d639(0x14a2)][_0x42d639(0x1402)](_0x3af5ae=>_0x3af5ae['name']===_0x43b6dc['meaning']);_0x4ce0ac?_0x52b833={..._0x2ab979,'type':_0x42d639(0x10c2),'content':_0x4ce0ac[_0x42d639(0x9a8)],'meaning':_0x4ce0ac['name']}:(console['warn'](_0x42d639(0xbae)+_0x43b6dc['meaning']+'\x22'),_0x52b833={..._0x2ab979,'type':_0x42d639(0x9ea),'content':_0x42d639(0x828)+_0x43b6dc[_0x42d639(0x14f1)]+']'});}else console[_0x42d639(0x9c1)](_0x42d639(0x12aa),_0x43b6dc),_0x52b833={..._0x2ab979,'type':_0x42d639(0x10c2),'content':_0x43b6dc['url'],'meaning':_0x42d639(0xe73)};break;case _0x42d639(0x65f):const _0x238dca={'type':_0x43b6dc[_0x42d639(0xa83)]||_0x42d639(0x2f6),'content':_0x43b6dc['content'],'timestamp':Date[_0x42d639(0x1386)](),'authorId':_0x16699d[_0x42d639(0x1474)][Object[_0x42d639(0x1cf)](_0x16699d[_0x42d639(0x1474)])[_0x42d639(0x1402)](_0x29f378=>_0x16699d['chats'][_0x29f378][_0x42d639(0x628)]===_0x43b6dc['name'])]?.['id']||_0x43b6dc[_0x42d639(0x1467)],'authorOriginalName':_0x43b6dc[_0x42d639(0x1467)],'visibleGroupIds':null};await _0x6ed281[_0x42d639(0xed1)][_0x42d639(0xbd0)](_0x238dca),_0x255639(_0x5711af+0x1),_0x5bb366={'content':'['+_0x2dda5c+'\x20发布了一条新动态]'};break;case _0x42d639(0x123d):const _0x247478=await _0x6ed281['qzonePosts']['get'](parseInt(_0x43b6dc[_0x42d639(0xba5)]));if(_0x247478){if(!_0x247478['comments'])_0x247478[_0x42d639(0x4d6)]=[];_0x247478['comments'][_0x42d639(0x1001)]({'commenterName':_0x43b6dc[_0x42d639(0x1467)],'text':_0x43b6dc[_0x42d639(0xad3)],'timestamp':Date[_0x42d639(0x1386)]()}),await _0x6ed281['qzonePosts'][_0x42d639(0xa0b)](_0x247478['id'],{'comments':_0x247478[_0x42d639(0x4d6)]}),_0x255639(_0x5711af+0x1),_0x5bb366={'content':'['+_0x2dda5c+_0x42d639(0xb4d)};}break;case _0x42d639(0x11e9):const _0x2b8dac=await _0x6ed281[_0x42d639(0xed1)][_0x42d639(0xe8c)](parseInt(_0x43b6dc[_0x42d639(0xba5)]));if(_0x2b8dac){if(!_0x2b8dac['likes'])_0x2b8dac[_0x42d639(0x494)]=[];!_0x2b8dac['likes'][_0x42d639(0x1336)](_0x43b6dc[_0x42d639(0x1467)])&&(_0x2b8dac[_0x42d639(0x494)][_0x42d639(0x1001)](_0x43b6dc[_0x42d639(0x1467)]),await _0x6ed281[_0x42d639(0xed1)][_0x42d639(0xa0b)](_0x2b8dac['id'],{'likes':_0x2b8dac[_0x42d639(0x494)]}),_0x255639(_0x5711af+0x1),_0x5bb366={'content':'['+_0x2dda5c+_0x42d639(0xfb7)});}break;case'ai_image':_0x52b833={..._0x2ab979,'type':'ai_image','content':_0x43b6dc['description'],'image_prompt':msgData[_0x42d639(0x5d9)]};break;default:if(_0x43b6dc[_0x42d639(0x4ae)]===_0x42d639(0x1385)){const _0x409d56=typeof _0x43b6dc[_0x42d639(0x5ae)]===_0x42d639(0x273)?_0x43b6dc[_0x42d639(0x5ae)][_0x42d639(0x46f)]('\x0a')[_0x42d639(0x1c0)](_0x4548eb=>_0x4548eb[_0x42d639(0x2a8)]()):Array[_0x42d639(0x1524)](_0x43b6dc[_0x42d639(0x5ae)])?_0x43b6dc[_0x42d639(0x5ae)]:[];if(_0x409d56[_0x42d639(0xaf9)]<0x2)continue;_0x52b833={..._0x2ab979,..._0x43b6dc,'options':_0x409d56,'votes':{},'isClosed':![]};}else{const _0x45c1af=_0x43b6dc[_0x42d639(0xede)]||_0x43b6dc['message'];_0x52b833={..._0x2ab979,..._0x43b6dc};if(_0x45c1af)_0x52b833[_0x42d639(0xede)]=_0x45c1af;}break;}if(_0x5bb366)_0x415ea8[_0x42d639(0xb07)][_0x42d639(0x1001)]({'role':_0x42d639(0x11af),'type':_0x42d639(0xb96),'content':_0x5bb366['content'],'timestamp':_0x19c722++});else _0x52b833&&(_0x415ea8[_0x42d639(0xb07)][_0x42d639(0x1001)](_0x52b833),!_0x129d50&&(_0x129d50=_0x2dda5c,_0xf28e1=_0x52b833[_0x42d639(0x4ae)]===_0x42d639(0x1281)?_0x42d639(0x1115):_0x52b833[_0x42d639(0xede)]||'['+_0x52b833['type']+']'));_0x2faaee=!![];}_0x2faaee&&(_0x415ea8[_0x42d639(0x26e)]=Date[_0x42d639(0x1386)](),_0x415ea8[_0x42d639(0x1300)]=(_0x415ea8[_0x42d639(0x1300)]||0x0)+_0x2a3f89['filter'](_0xa6d159=>_0xa6d159[_0x42d639(0x4ae)]!==_0x42d639(0x65f)&&_0xa6d159[_0x42d639(0x4ae)]!=='qzone_comment'&&_0xa6d159[_0x42d639(0x4ae)]!==_0x42d639(0x11e9))[_0x42d639(0xaf9)],_0x129d50&&_0xf28e1&&_0x2e32a5(_0x3792fc,_0x129d50+':\x20'+_0xf28e1),await _0x6ed281[_0x42d639(0x1474)]['put'](_0x415ea8));}catch(_0x3f1465){console['error'](_0x42d639(0x579)+_0x415ea8[_0x42d639(0x1467)]+_0x42d639(0x32d),_0x3f1465);}finally{_0x2d33eb();}}function _0x33b8de(_0x1c4989,_0x214408,_0xbaf834){const _0x4be5f6=_0x3ce1fb,_0x305b1d=document['getElementById'](_0xbaf834);if(!_0x305b1d)return;if(!_0x1c4989||_0x1c4989[_0x4be5f6(0x2a8)]()===''){_0x305b1d[_0x4be5f6(0xb6f)]='';return;}const _0x53dc08=_0x1c4989[_0x4be5f6(0x14e9)](/\s*\.message-bubble\.user\s+([^{]+\{)/g,_0x214408+_0x4be5f6(0x2ac))[_0x4be5f6(0x14e9)](/\s*\.message-bubble\.ai\s+([^{]+\{)/g,_0x214408+'\x20.message-bubble.ai\x20$1')['replace'](/\s*\.message-bubble\s+([^{]+\{)/g,_0x214408+_0x4be5f6(0xebb));_0x305b1d[_0x4be5f6(0xb6f)]=_0x53dc08;}async function _0x3cc02f(){const _0x15cef0=_0x3ce1fb;if(!_0x16699d[_0x15cef0(0xf5a)])return;const _0xf54414=_0x16699d['chats'][_0x16699d['activeChatId']],_0x34af77=document[_0x15cef0(0x948)]('settings-preview-area');if(!_0x34af77)return;const _0x232c07=document[_0x15cef0(0xfeb)](_0x15cef0(0xeb5))?.[_0x15cef0(0x5bc)]||'default',_0x56cb4f=document[_0x15cef0(0x948)](_0x15cef0(0x1d7))[_0x15cef0(0x5bc)],_0x370155=document['getElementById']('custom-css-input')[_0x15cef0(0x5bc)],_0x47e1b0=_0xf54414[_0x15cef0(0x7fd)][_0x15cef0(0x7c2)];_0x34af77[_0x15cef0(0x606)][_0x15cef0(0x337)]=_0x232c07,_0x34af77[_0x15cef0(0xf74)][_0x15cef0(0x121e)](_0x15cef0(0xc64),_0x56cb4f+'px');_0x47e1b0&&_0x47e1b0['startsWith'](_0x15cef0(0x1303))?(_0x34af77[_0x15cef0(0xf74)][_0x15cef0(0x618)]='url('+_0x47e1b0+')',_0x34af77[_0x15cef0(0xf74)][_0x15cef0(0xdb4)]=_0x15cef0(0x5e2)):(_0x34af77[_0x15cef0(0xf74)][_0x15cef0(0x618)]=_0x15cef0(0x12fe),_0x34af77[_0x15cef0(0xf74)][_0x15cef0(0x7c2)]=_0x47e1b0||_0x15cef0(0xe1a));_0x34af77[_0x15cef0(0xb6f)]='';const _0x2380ff={'role':'ai','content':'对方消息预览','timestamp':0x1,'senderName':_0xf54414['name']},_0x1ceeee=await _0x1f8f7b(_0x2380ff,_0xf54414);if(_0x1ceeee)_0x34af77[_0x15cef0(0x6b6)](_0x1ceeee);const _0x344710={'role':'user','content':'我的消息预览','timestamp':0x2},_0x47344c=await _0x1f8f7b(_0x344710,_0xf54414);if(_0x47344c)_0x34af77[_0x15cef0(0x6b6)](_0x47344c);const _0x43c393=document[_0x15cef0(0x1497)](_0x15cef0(0x379));_0x43c393[_0x15cef0(0xf74)][_0x15cef0(0x8e7)]=_0x15cef0(0x830),_0x43c393[_0x15cef0(0x10cb)]=_0x15cef0(0xf18),_0x34af77[_0x15cef0(0x6b6)](_0x43c393);const _0x3fe3f4=document[_0x15cef0(0x948)](_0x15cef0(0x67c))[_0x15cef0(0x5bc)],_0x454a5b=document['getElementById'](_0x15cef0(0x2d6))[_0x15cef0(0x5bc)],_0x59269a=parseInt(document['getElementById'](_0x15cef0(0xc40))[_0x15cef0(0x5bc)])||0xa;_0x3fe3f4===_0x15cef0(0x102e)?_0x43c393[_0x15cef0(0xf74)][_0x15cef0(0x102e)]=_0x59269a+'px':_0x43c393[_0x15cef0(0xf74)]['bottom']=_0x59269a+'px';switch(_0x454a5b){case _0x15cef0(0x102f):_0x43c393['style'][_0x15cef0(0x102f)]='15px';break;case'right':_0x43c393[_0x15cef0(0xf74)][_0x15cef0(0xf71)]='15px';break;default:_0x43c393[_0x15cef0(0xf74)]['left']=_0x15cef0(0x1257),_0x43c393[_0x15cef0(0xf74)][_0x15cef0(0x79c)]=_0x15cef0(0x5f6);break;}_0x33b8de(_0x370155,_0x15cef0(0x2db),_0x15cef0(0x28e));}async function _0x4f869a(){const _0x3b30b0=_0x3ce1fb;await _0x2df67a(),document[_0x3b30b0(0x948)](_0x3b30b0(0xa08))[_0x3b30b0(0xd54)][_0x3b30b0(0xbd0)](_0x3b30b0(0xfcb));}async function _0x2df67a(){const _0x5b1c35=_0x3ce1fb,_0x2feb8a=document[_0x5b1c35(0x948)](_0x5b1c35(0xc1c)),_0x419ae9=await _0x6ed281[_0x5b1c35(0x1423)][_0x5b1c35(0x443)]();_0x2feb8a[_0x5b1c35(0xb6f)]='',_0x419ae9[_0x5b1c35(0xaf9)]===0x0&&(_0x2feb8a[_0x5b1c35(0xb6f)]=_0x5b1c35(0x1395)),_0x419ae9[_0x5b1c35(0x427)](_0x3c6ff9=>{const _0x37d306=_0x5b1c35,_0x45cca5=document[_0x37d306(0x1497)](_0x37d306(0x379));_0x45cca5[_0x37d306(0x35b)]='existing-group-item',_0x45cca5[_0x37d306(0xb6f)]=_0x37d306(0x123c)+_0x3c6ff9[_0x37d306(0x1467)]+_0x37d306(0x154c)+_0x3c6ff9['id']+_0x37d306(0x307),_0x2feb8a['appendChild'](_0x45cca5);});}async function _0x459e38(){const _0x3c1e6d=_0x3ce1fb,_0x245002=document['getElementById'](_0x3c1e6d(0x639)),_0x9fa7ea=_0x245002[_0x3c1e6d(0x5bc)][_0x3c1e6d(0x2a8)]();if(!_0x9fa7ea){alert(_0x3c1e6d(0xd7d));return;}const _0x346e53=await _0x6ed281[_0x3c1e6d(0x1423)]['where'](_0x3c1e6d(0x1467))[_0x3c1e6d(0xba9)](_0x9fa7ea)[_0x3c1e6d(0x678)]();if(_0x346e53){alert(_0x3c1e6d(0x15c0)+_0x9fa7ea+_0x3c1e6d(0x1543));return;}await _0x6ed281[_0x3c1e6d(0x1423)][_0x3c1e6d(0xbd0)]({'name':_0x9fa7ea}),_0x245002[_0x3c1e6d(0x5bc)]='',await _0x2df67a();}async function _0x105e8f(_0x301620){const _0x3cdad3=_0x3ce1fb,_0x4faedc=await _0xa6b74a(_0x3cdad3(0x8ed),'删除分组后，该组内的好友将变为“未分组”。确定要删除吗？',{'confirmButtonClass':_0x3cdad3(0x5e8)});if(_0x4faedc){await _0x6ed281[_0x3cdad3(0x1423)][_0x3cdad3(0x869)](_0x301620);const _0x4f1cff=await _0x6ed281[_0x3cdad3(0x1474)]['where']('groupId')[_0x3cdad3(0xba9)](_0x301620)[_0x3cdad3(0x443)]();for(const _0x56463b of _0x4f1cff){_0x56463b[_0x3cdad3(0xaa9)]=null,await _0x6ed281[_0x3cdad3(0x1474)][_0x3cdad3(0x90c)](_0x56463b);if(_0x16699d[_0x3cdad3(0x1474)][_0x56463b['id']])_0x16699d['chats'][_0x56463b['id']][_0x3cdad3(0xaa9)]=null;}await _0x2df67a();}}function _0x4685bf(_0xfa6112){const _0x38c9c9=_0x3ce1fb,_0x4df087=_0x16699d[_0x38c9c9(0x1474)][_0x16699d['activeChatId']];document[_0x38c9c9(0x948)]('publish-to-announcement-btn')[_0x38c9c9(0xf74)]['display']=_0x4df087[_0x38c9c9(0x1173)]?_0x38c9c9(0x1273):_0x38c9c9(0x12fe);if(_0x202b41)return;_0x441f4f=_0xfa6112,document[_0x38c9c9(0x948)](_0x38c9c9(0xdcb))[_0x38c9c9(0xd54)]['add']('visible');}function _0x115ec8(){const _0xa61dfc=_0x3ce1fb;document['getElementById'](_0xa61dfc(0xdcb))['classList'][_0xa61dfc(0xf89)](_0xa61dfc(0xfcb)),_0x441f4f=null;}async function _0x3a127f(){const _0x4a01df=_0x3ce1fb;if(!_0x441f4f)return;const _0x2fab44=_0x441f4f,_0x335ea5=_0x16699d[_0x4a01df(0x1474)][_0x16699d[_0x4a01df(0xf5a)]],_0x14fe16=_0x335ea5[_0x4a01df(0xb07)][_0x4a01df(0x1402)](_0x5d73cc=>_0x5d73cc[_0x4a01df(0xb0a)]===_0x2fab44);if(!_0x14fe16)return;_0x115ec8();let _0x592359;const _0x993917=_0x14fe16[_0x4a01df(0x4ae)]&&[_0x4a01df(0x10d4),'ai_image',_0x4a01df(0x1514),_0x4a01df(0xa7a)][_0x4a01df(0x1336)](_0x14fe16[_0x4a01df(0x4ae)]);if(_0x993917){let _0xbd8d2c={'type':_0x14fe16[_0x4a01df(0x4ae)]};if(_0x14fe16[_0x4a01df(0x4ae)]===_0x4a01df(0x10d4))_0xbd8d2c['content']=_0x14fe16['content'];else{if(_0x14fe16[_0x4a01df(0x4ae)]===_0x4a01df(0x1281))_0xbd8d2c[_0x4a01df(0xe79)]=_0x14fe16[_0x4a01df(0xede)];else{if(_0x14fe16[_0x4a01df(0x4ae)]==='transfer')_0xbd8d2c[_0x4a01df(0xbd2)]=_0x14fe16['amount'],_0xbd8d2c['note']=_0x14fe16['note'];else _0x14fe16[_0x4a01df(0x4ae)]===_0x4a01df(0xa7a)&&(_0xbd8d2c[_0x4a01df(0xb03)]=_0x14fe16[_0x4a01df(0xb03)],_0xbd8d2c[_0x4a01df(0xe79)]=_0x14fe16[_0x4a01df(0xe79)],_0xbd8d2c['source_name']=_0x14fe16[_0x4a01df(0x10c9)],_0xbd8d2c[_0x4a01df(0xede)]=_0x14fe16[_0x4a01df(0xede)]);}}_0x592359=JSON[_0x4a01df(0x526)](_0xbd8d2c,null,0x2);}else typeof _0x14fe16[_0x4a01df(0xede)]==='object'?_0x592359=JSON['stringify'](_0x14fe16['content'],null,0x2):_0x592359=_0x14fe16[_0x4a01df(0xede)];const _0x37b860={'voice':{'type':_0x4a01df(0x10d4),'content':'在这里输入语音内容'},'image':{'type':_0x4a01df(0x1281),'description':_0x4a01df(0x1c8)},'transfer':{'type':_0x4a01df(0x1514),'amount':5.2,'note':_0x4a01df(0xbb7)},'link':{'type':_0x4a01df(0xa7a),'title':'文章标题','description':_0x4a01df(0x519),'source_name':_0x4a01df(0xcee),'content':'文章完整内容...'}},_0x698aeb=_0x4a01df(0x10d0)+JSON['stringify'](_0x37b860['voice'])+_0x4a01df(0x1461)+JSON['stringify'](_0x37b860[_0x4a01df(0x608)])+_0x4a01df(0x14f5)+JSON[_0x4a01df(0x526)](_0x37b860[_0x4a01df(0x1514)])+_0x4a01df(0x845)+JSON[_0x4a01df(0x526)](_0x37b860['link'])+_0x4a01df(0xa3a),_0x189740=await _0x41b9fc(_0x4a01df(0x358),'在此修改，或点击上方按钮使用格式模板...',_0x592359,_0x4a01df(0xc1e),_0x698aeb);_0x189740!==null&&await _0x50e443(_0x2fab44,_0x189740,!![]);}async function _0x151761(){const _0x1ff5ef=_0x3ce1fb;if(!_0x441f4f)return;const _0x7c8131=_0x16699d['chats'][_0x16699d['activeChatId']],_0x2ae446=_0x7c8131[_0x1ff5ef(0xb07)][_0x1ff5ef(0x1402)](_0x400bcb=>_0x400bcb[_0x1ff5ef(0xb0a)]===_0x441f4f);if(!_0x2ae446)return;let _0x4a9b7f;typeof _0x2ae446[_0x1ff5ef(0xede)]===_0x1ff5ef(0xd43)?_0x4a9b7f=JSON[_0x1ff5ef(0x526)](_0x2ae446['content']):_0x4a9b7f=String(_0x2ae446[_0x1ff5ef(0xede)]);try{await navigator['clipboard'][_0x1ff5ef(0x9f4)](_0x4a9b7f),await _0x104485(_0x1ff5ef(0x4e0),_0x1ff5ef(0x621));}catch(_0xe9e5d1){await _0x104485(_0x1ff5ef(0xa9d),_0x1ff5ef(0x1582));}_0x115ec8();}async function _0x3a34a2(){const _0x3e6256=_0x3ce1fb;if(!_0x441f4f)return;try{await navigator[_0x3e6256(0x8f0)]['writeText'](_0x441f4f),await _0x104485(_0x3e6256(0x4e0),_0x3e6256(0x21c)+_0x441f4f+_0x3e6256(0xc0d));}catch(_0x2ed422){await _0x104485(_0x3e6256(0xa9d),'无法访问剪贴板。');}_0x115ec8();}function _0x988f34(_0x3fc95a=''){const _0x1bc79e=_0x3ce1fb,_0x28a440=document['createElement'](_0x1bc79e(0x379));_0x28a440[_0x1bc79e(0x35b)]=_0x1bc79e(0x1285);const _0x6c5c37={'voice':{'type':_0x1bc79e(0x10d4),'content':_0x1bc79e(0x1194)},'image':{'type':'ai_image','description':_0x1bc79e(0x1c8)},'transfer':{'type':_0x1bc79e(0x1514),'amount':5.2,'note':'一点心意'},'link':{'type':_0x1bc79e(0xa7a),'title':_0x1bc79e(0xc53),'description':'文章摘要...','source_name':_0x1bc79e(0xcee),'content':'文章完整内容...'},'offline':{'type':'offline_text','content':_0x1bc79e(0x7d2)},'quote':{'type':'quote_reply','target_timestamp':0x499602d2,'reply_content':_0x1bc79e(0x998)},'nai':{'type':_0x1bc79e(0x1141),'prompt':_0x1bc79e(0x7dc)}};return _0x28a440['innerHTML']=_0x1bc79e(0xe87)+_0x3fc95a+_0x1bc79e(0xe97)+JSON[_0x1bc79e(0x526)](_0x6c5c37[_0x1bc79e(0x2a3)])+_0x1bc79e(0x70c)+JSON[_0x1bc79e(0x526)](_0x6c5c37[_0x1bc79e(0x608)])+'\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x1bc79e(0x526)](_0x6c5c37[_0x1bc79e(0x1514)])+_0x1bc79e(0xb6a)+JSON[_0x1bc79e(0x526)](_0x6c5c37[_0x1bc79e(0xcf4)])+'\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON['stringify'](_0x6c5c37[_0x1bc79e(0xa3d)])+_0x1bc79e(0x218)+JSON[_0x1bc79e(0x526)](_0x6c5c37[_0x1bc79e(0xe7f)])+_0x1bc79e(0x1215)+JSON[_0x1bc79e(0x526)](_0x6c5c37[_0x1bc79e(0x982)])+_0x1bc79e(0xb9e),_0x28a440[_0x1bc79e(0xfeb)](_0x1bc79e(0x524))['addEventListener']('click',()=>{document['querySelectorAll']('.message-editor-block')['length']>0x1?_0x28a440['remove']():alert('至少需要保留一条消息。');}),_0x28a440[_0x1bc79e(0x1188)](_0x1bc79e(0x15b1))[_0x1bc79e(0x427)](_0x12199f=>{const _0x1943ba=_0x1bc79e;_0x12199f[_0x1943ba(0x339)](_0x1943ba(0x4f6),()=>{const _0x3d164e=_0x1943ba,_0x4bdc86=_0x12199f[_0x3d164e(0x606)][_0x3d164e(0xded)],_0x255a5b=_0x28a440[_0x3d164e(0xfeb)]('textarea');if(_0x4bdc86&&_0x255a5b)try{const _0x95873b=JSON[_0x3d164e(0xde0)](_0x4bdc86);_0x255a5b[_0x3d164e(0x5bc)]=JSON[_0x3d164e(0x526)](_0x95873b,null,0x2),_0x255a5b[_0x3d164e(0x348)]();}catch(_0x3c8bcc){console[_0x3d164e(0xc3e)]('解析格式模板失败:',_0x3c8bcc);}});}),_0x28a440;}async function _0x924e1e(){const _0x5b92d3=_0x3ce1fb;if(!_0x441f4f)return;const _0x2578c0=_0x441f4f,_0x1d9c2d=_0x16699d['chats'][_0x16699d[_0x5b92d3(0xf5a)]],_0x29ca05=_0x1d9c2d[_0x5b92d3(0xb07)][_0x5b92d3(0x1402)](_0x17e53f=>_0x17e53f[_0x5b92d3(0xb0a)]===_0x2578c0);if(!_0x29ca05)return;_0x115ec8();const _0x483b03=document[_0x5b92d3(0x948)](_0x5b92d3(0x5fd)),_0x4721c4=document[_0x5b92d3(0x948)](_0x5b92d3(0x10cc));_0x4721c4[_0x5b92d3(0xb6f)]='';let _0x31a97d;if(_0x29ca05[_0x5b92d3(0xe7f)]){const _0x29c580={'type':_0x5b92d3(0x11a9),'target_timestamp':_0x29ca05['quote'][_0x5b92d3(0xb0a)],'reply_content':_0x29ca05[_0x5b92d3(0xede)]};_0x31a97d=JSON[_0x5b92d3(0x526)](_0x29c580,null,0x2);}else{if(_0x29ca05['type']&&['voice_message',_0x5b92d3(0x1281),_0x5b92d3(0x1514),'offline_text','share_link','naiimag'][_0x5b92d3(0x1336)](_0x29ca05[_0x5b92d3(0x4ae)])){let _0x17a135={'type':_0x29ca05['type']};if(_0x29ca05['type']==='voice_message')_0x17a135[_0x5b92d3(0xede)]=_0x29ca05[_0x5b92d3(0xede)];else{if(_0x29ca05[_0x5b92d3(0x4ae)]===_0x5b92d3(0x1281))_0x17a135[_0x5b92d3(0xe79)]=_0x29ca05[_0x5b92d3(0xede)];else{if(_0x29ca05[_0x5b92d3(0x4ae)]===_0x5b92d3(0x1514))_0x17a135[_0x5b92d3(0xbd2)]=_0x29ca05['amount'],_0x17a135['note']=_0x29ca05[_0x5b92d3(0x2a7)];else{if(_0x29ca05['type']===_0x5b92d3(0xd5f))_0x29ca05[_0x5b92d3(0xede)]?_0x17a135[_0x5b92d3(0xede)]=_0x29ca05[_0x5b92d3(0xede)]:(_0x17a135[_0x5b92d3(0x13c5)]=_0x29ca05['dialogue'],_0x17a135['description']=_0x29ca05[_0x5b92d3(0xe79)]);else{if(_0x29ca05[_0x5b92d3(0x4ae)]===_0x5b92d3(0xa7a))_0x17a135[_0x5b92d3(0xb03)]=_0x29ca05[_0x5b92d3(0xb03)],_0x17a135[_0x5b92d3(0xe79)]=_0x29ca05[_0x5b92d3(0xe79)],_0x17a135[_0x5b92d3(0x10c9)]=_0x29ca05['source_name'],_0x17a135[_0x5b92d3(0xede)]=_0x29ca05[_0x5b92d3(0xede)];else _0x29ca05[_0x5b92d3(0x4ae)]==='naiimag'&&(_0x17a135[_0x5b92d3(0xc4b)]=_0x29ca05[_0x5b92d3(0xc4b)],_0x17a135[_0x5b92d3(0x15b8)]=_0x29ca05['imageUrl'],_0x17a135['fullPrompt']=_0x29ca05[_0x5b92d3(0xb54)]);}}}}_0x31a97d=JSON['stringify'](_0x17a135,null,0x2);}else typeof _0x29ca05[_0x5b92d3(0xede)]===_0x5b92d3(0xd43)?_0x31a97d=JSON[_0x5b92d3(0x526)](_0x29ca05['content'],null,0x2):_0x31a97d=_0x29ca05['content'];}const _0x25e282=_0x988f34(_0x31a97d);_0x4721c4[_0x5b92d3(0x6b6)](_0x25e282);const _0x28085c=document[_0x5b92d3(0x948)](_0x5b92d3(0x888)),_0x3cd519=_0x28085c[_0x5b92d3(0xfc0)](!![]);_0x28085c[_0x5b92d3(0x1579)][_0x5b92d3(0x868)](_0x3cd519,_0x28085c),_0x3cd519[_0x5b92d3(0x339)](_0x5b92d3(0x4f6),()=>{const _0x155ee9=_0x5b92d3,_0x2a50b5=_0x988f34();_0x4721c4[_0x155ee9(0x6b6)](_0x2a50b5),_0x2a50b5[_0x155ee9(0xfeb)](_0x155ee9(0xc1e))[_0x155ee9(0x348)]();});const _0x5641c2=document['getElementById'](_0x5b92d3(0x38d)),_0x1f1fd6=_0x5641c2[_0x5b92d3(0xfc0)](!![]);_0x5641c2[_0x5b92d3(0x1579)][_0x5b92d3(0x868)](_0x1f1fd6,_0x5641c2),_0x1f1fd6[_0x5b92d3(0x339)](_0x5b92d3(0x4f6),()=>{const _0x545c8e=_0x5b92d3;_0x483b03[_0x545c8e(0xd54)]['remove'](_0x545c8e(0xfcb));});const _0x238b5d=document[_0x5b92d3(0x948)](_0x5b92d3(0x7c7)),_0x214097=_0x238b5d[_0x5b92d3(0xfc0)](!![]);_0x238b5d[_0x5b92d3(0x1579)][_0x5b92d3(0x868)](_0x214097,_0x238b5d),_0x214097[_0x5b92d3(0x339)]('click',()=>{_0x50e443(_0x2578c0);}),_0x483b03['classList'][_0x5b92d3(0xbd0)](_0x5b92d3(0xfcb));}async function _0x151761(){const _0x1a6d5a=_0x3ce1fb;if(!_0x441f4f)return;const _0x41c1b9=_0x16699d[_0x1a6d5a(0x1474)][_0x16699d[_0x1a6d5a(0xf5a)]],_0x16f83e=_0x41c1b9['history'][_0x1a6d5a(0x1402)](_0xb86e3d=>_0xb86e3d[_0x1a6d5a(0xb0a)]===_0x441f4f);if(!_0x16f83e)return;let _0x5797dd;if(_0x16f83e[_0x1a6d5a(0x4ae)]===_0x1a6d5a(0xd5f))_0x16f83e[_0x1a6d5a(0xede)]?_0x5797dd=_0x16f83e[_0x1a6d5a(0xede)]:_0x5797dd='「'+(_0x16f83e[_0x1a6d5a(0x13c5)]||'')+'」\x0a'+(_0x16f83e[_0x1a6d5a(0xe79)]||'');else typeof _0x16f83e[_0x1a6d5a(0xede)]==='object'?_0x5797dd=JSON[_0x1a6d5a(0x526)](_0x16f83e[_0x1a6d5a(0xede)]):_0x5797dd=String(_0x16f83e[_0x1a6d5a(0xede)]);try{await navigator[_0x1a6d5a(0x8f0)][_0x1a6d5a(0x9f4)](_0x5797dd),await _0x104485('复制成功',_0x1a6d5a(0x621));}catch(_0x1d8701){await _0x104485(_0x1a6d5a(0xa9d),_0x1a6d5a(0x1582));}_0x115ec8();}function _0x28b592(_0x4997ac){const _0x27b187=_0x3ce1fb,_0x3a2d49=_0x4997ac['trim']();if(_0x3a2d49[_0x27b187(0x157f)]('{')&&_0x3a2d49[_0x27b187(0x918)]('}'))try{const _0x292c47=JSON[_0x27b187(0xde0)](_0x3a2d49);if(_0x292c47['type'])return _0x292c47;}catch(_0x196321){}if(_0x346c[_0x27b187(0x367)](_0x3a2d49))return{'type':_0x27b187(0x10c2),'content':_0x3a2d49};return{'type':_0x27b187(0x9ea),'content':_0x3a2d49};}async function _0x50e443(_0x4593ee,_0x267a62=null){const _0x503326=_0x3ce1fb;if(!_0x4593ee)return;const _0x5bb0a0=_0x16699d[_0x503326(0x1474)][_0x16699d[_0x503326(0xf5a)]],_0x3e72c7=_0x5bb0a0[_0x503326(0xb07)][_0x503326(0x1018)](_0x3675c2=>_0x3675c2[_0x503326(0xb0a)]===_0x4593ee);if(_0x3e72c7===-0x1)return;const _0x476a15=_0x5bb0a0['history'][_0x3e72c7];let _0x1b9d07=[];const _0x1d7704=_0x267a62!==null?[_0x267a62]:Array[_0x503326(0x6e5)](document[_0x503326(0x1188)](_0x503326(0xec5)))[_0x503326(0x8ff)](_0x1e7143=>_0x1e7143[_0x503326(0x5bc)]);for(const _0x6056b2 of _0x1d7704){if(!_0x6056b2[_0x503326(0x2a8)]())continue;const _0x31149b=_0x28b592(_0x6056b2[_0x503326(0x2a8)]()),_0x2da109={'role':_0x476a15[_0x503326(0x1554)],'senderName':_0x476a15['senderName'],'timestamp':_0x476a15[_0x503326(0xb0a)]};switch(_0x31149b[_0x503326(0x4ae)]){case _0x503326(0x9ea):_0x2da109['type']=_0x503326(0x9ea),_0x2da109[_0x503326(0xede)]=_0x31149b[_0x503326(0xede)];break;case _0x503326(0xd5f):_0x2da109[_0x503326(0x4ae)]=_0x503326(0xd5f);_0x31149b[_0x503326(0xede)]?_0x2da109[_0x503326(0xede)]=_0x31149b[_0x503326(0xede)]:(_0x2da109[_0x503326(0x13c5)]=_0x31149b[_0x503326(0x13c5)],_0x2da109['description']=_0x31149b[_0x503326(0xe79)]);break;case'quote_reply':_0x2da109[_0x503326(0x4ae)]=_0x503326(0x11a9),_0x2da109[_0x503326(0xede)]=_0x31149b['reply_content'];const _0x363d1a=_0x5bb0a0[_0x503326(0xb07)]['find'](_0x6e161a=>_0x6e161a[_0x503326(0xb0a)]===_0x31149b['target_timestamp']);if(_0x363d1a){let _0x16f72a=_0x363d1a[_0x503326(0x14ee)];_0x363d1a[_0x503326(0x1554)]===_0x503326(0xaeb)&&(_0x16f72a=_0x16699d[_0x503326(0x66e)][_0x503326(0xf4d)]||_0x503326(0x1347)),_0x2da109[_0x503326(0xe7f)]={'timestamp':_0x31149b[_0x503326(0x20b)],'senderName':_0x16f72a,'content':String(_0x363d1a[_0x503326(0xede)]||'')};}else _0x2da109[_0x503326(0xe7f)]={'timestamp':_0x31149b['target_timestamp'],'senderName':_0x503326(0x79b),'content':_0x503326(0x1174)};break;case _0x503326(0x10d4):case _0x503326(0x1281):case _0x503326(0x368):_0x2da109[_0x503326(0x4ae)]=_0x31149b[_0x503326(0x4ae)],_0x2da109[_0x503326(0xede)]=_0x31149b[_0x503326(0xede)]||_0x31149b['description'];if(_0x31149b['meaning'])_0x2da109[_0x503326(0x14f1)]=_0x31149b[_0x503326(0x14f1)];break;case _0x503326(0x1141):{const _0x371b82=_0x5bb0a0['history'][_0x3e72c7];let _0x2a74b8=_0x31149b[_0x503326(0xc4b)],_0x1b566a=_0x31149b['imageUrl'],_0x1a2556=_0x31149b[_0x503326(0xb54)],_0x58e45c=![];_0x2a74b8&&typeof _0x2a74b8==='string'&&_0x371b82['prompt']!==_0x2a74b8?_0x58e45c=!![]:(_0x2a74b8=_0x371b82[_0x503326(0xc4b)],_0x1a2556=_0x371b82[_0x503326(0xb54)],_0x1b566a=_0x371b82[_0x503326(0x15b8)]);if(_0x58e45c){await _0x104485(_0x503326(0x960),_0x503326(0xc49));try{const _0x41e355=await _0x3036dd(_0x2a74b8,_0x5bb0a0['id']);_0x1b566a=_0x41e355[_0x503326(0x15b8)],_0x1a2556=_0x41e355[_0x503326(0xb54)],await _0x104485('成功',_0x503326(0xf51));}catch(_0x153653){console[_0x503326(0xc3e)](_0x503326(0x80c),_0x153653),await _0x104485('生成失败',_0x503326(0x8dc)+_0x153653['message']+_0x503326(0x14a7)),_0x1b566a=_0x371b82['imageUrl'];}}_0x2da109[_0x503326(0x4ae)]=_0x503326(0x1141),_0x2da109[_0x503326(0x15b8)]=_0x1b566a,_0x2da109[_0x503326(0xc4b)]=_0x2a74b8,_0x2da109[_0x503326(0xb54)]=_0x1a2556;break;}case'sticker':{_0x2da109[_0x503326(0x4ae)]=_0x503326(0x10c2);let _0xf8d55b=![];if(_0x31149b[_0x503326(0x14f1)]){const _0x297eb5=_0x16699d['userStickers']['find'](_0x3981b3=>_0x3981b3[_0x503326(0x1467)]===_0x31149b['meaning']);_0x297eb5?(_0x2da109['content']=_0x297eb5[_0x503326(0x9a8)],_0x2da109[_0x503326(0x14f1)]=_0x297eb5[_0x503326(0x1467)],console[_0x503326(0x498)](_0x503326(0x1af)),_0xf8d55b=!![]):(_0x2da109['type']=_0x503326(0x9ea),_0x2da109[_0x503326(0xede)]=_0x503326(0x828)+_0x31149b[_0x503326(0x14f1)]+']',console[_0x503326(0x9c1)](_0x503326(0x938),_0x31149b[_0x503326(0x14f1)]),_0xf8d55b=!![]);}if(!_0xf8d55b&&_0x31149b['url']){_0x2da109[_0x503326(0xede)]=_0x31149b[_0x503326(0x9a8)];const _0x3c6c65=_0x16699d[_0x503326(0x14a2)]['find'](_0x605376=>_0x605376[_0x503326(0x9a8)]===_0x31149b[_0x503326(0x9a8)]);if(_0x31149b[_0x503326(0x14f1)]&&(!_0x3c6c65||_0x3c6c65[_0x503326(0x1467)]===_0x31149b[_0x503326(0x14f1)]))_0x2da109[_0x503326(0x14f1)]=_0x31149b[_0x503326(0x14f1)];else _0x3c6c65?_0x2da109[_0x503326(0x14f1)]=_0x3c6c65[_0x503326(0x1467)]:_0x2da109[_0x503326(0x14f1)]=_0x503326(0xe73);console[_0x503326(0x498)](_0x503326(0x1d5),_0x2da109['meaning']),_0xf8d55b=!![];}if(!_0xf8d55b&&_0x31149b[_0x503326(0xede)]&&typeof _0x31149b['content']===_0x503326(0x273)&&_0x346c[_0x503326(0x367)](_0x31149b[_0x503326(0xede)])){_0x2da109['content']=_0x31149b[_0x503326(0xede)];const _0x1692bb=_0x16699d['userStickers']['find'](_0x335b83=>_0x335b83['url']===_0x31149b[_0x503326(0xede)]);_0x2da109[_0x503326(0x14f1)]=_0x1692bb?_0x1692bb['name']:'未知表情',console[_0x503326(0x498)](_0x503326(0x562),_0x2da109[_0x503326(0x14f1)]),_0xf8d55b=!![];}if(!_0xf8d55b){console['error']('导演/编辑模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):',_0x31149b);continue;}break;}case _0x503326(0x1514):_0x2da109[_0x503326(0x4ae)]='transfer',_0x2da109[_0x503326(0xbd2)]=_0x31149b[_0x503326(0xbd2)],_0x2da109[_0x503326(0x2a7)]=_0x31149b[_0x503326(0x2a7)];break;case _0x503326(0xa7a):_0x2da109[_0x503326(0x4ae)]=_0x503326(0xa7a),_0x2da109[_0x503326(0xb03)]=_0x31149b[_0x503326(0xb03)],_0x2da109['description']=_0x31149b['description'],_0x2da109[_0x503326(0x10c9)]=_0x31149b[_0x503326(0x10c9)],_0x2da109[_0x503326(0xede)]=_0x31149b[_0x503326(0xede)];break;default:Object[_0x503326(0xd24)](_0x2da109,_0x31149b);break;}_0x1b9d07[_0x503326(0x1001)](_0x2da109);}if(_0x1b9d07[_0x503326(0xaf9)]===0x0){document[_0x503326(0x948)](_0x503326(0x5fd))[_0x503326(0xd54)][_0x503326(0xf89)]('visible');return;}_0x5bb0a0['history'][_0x503326(0x36d)](_0x3e72c7,0x1,..._0x1b9d07);let _0x185e2d=_0x4593ee;for(let _0x4243d1=_0x3e72c7;_0x4243d1<_0x5bb0a0[_0x503326(0xb07)][_0x503326(0xaf9)];_0x4243d1++){_0x5bb0a0['history'][_0x4243d1][_0x503326(0xb0a)]=_0x185e2d,_0x185e2d++;}await _0x6ed281[_0x503326(0x1474)][_0x503326(0x90c)](_0x5bb0a0),document['getElementById']('message-editor-modal')[_0x503326(0xd54)]['remove'](_0x503326(0xfcb)),_0x455873(_0x16699d[_0x503326(0xf5a)]),await _0x104485('成功',_0x503326(0x396));}function _0x5bb1bb(_0x17aeb0){const _0x437d93=_0x3ce1fb;_0x333bfd=_0x17aeb0,document[_0x437d93(0x948)]('post-actions-modal')[_0x437d93(0xd54)][_0x437d93(0xbd0)](_0x437d93(0xfcb));}function _0x38b910(){const _0x4a4ef3=_0x3ce1fb;document[_0x4a4ef3(0x948)]('post-actions-modal')[_0x4a4ef3(0xd54)]['remove'](_0x4a4ef3(0xfcb)),_0x333bfd=null;}async function _0x36b045(){const _0x3c3c26=_0x3ce1fb;if(!_0x333bfd)return;const _0x4a2f88=_0x333bfd,_0x5bbd04=await _0x6ed281[_0x3c3c26(0xed1)][_0x3c3c26(0xe8c)](_0x4a2f88);if(!_0x5bbd04)return;_0x38b910();let _0x268396;if(_0x5bbd04[_0x3c3c26(0x4ae)]==='shuoshuo')_0x268396=_0x5bbd04[_0x3c3c26(0xede)];else{const _0x331cde={'type':_0x5bbd04[_0x3c3c26(0x4ae)],'publicText':_0x5bbd04[_0x3c3c26(0x15bf)]||''};if(_0x5bbd04[_0x3c3c26(0x4ae)]===_0x3c3c26(0x8f6))_0x331cde[_0x3c3c26(0x15b8)]=_0x5bbd04['imageUrl'],_0x331cde[_0x3c3c26(0x1329)]=_0x5bbd04[_0x3c3c26(0x1329)];else _0x5bbd04['type']==='text_image'&&(_0x331cde[_0x3c3c26(0x7d9)]=_0x5bbd04['hiddenContent']);_0x268396=JSON[_0x3c3c26(0x526)](_0x331cde,null,0x2);}const _0x317bde={'shuoshuo':_0x3c3c26(0xb76),'image':{'type':_0x3c3c26(0x8f6),'publicText':'','imageUrl':_0x3c3c26(0xfb4),'imageDescription':''},'text_image':{'type':_0x3c3c26(0x1076),'publicText':'','hiddenContent':''}},_0x3cd378=_0x3c3c26(0xb90)+JSON[_0x3c3c26(0x526)](_0x317bde[_0x3c3c26(0x608)])+_0x3c3c26(0x61a)+JSON[_0x3c3c26(0x526)](_0x317bde[_0x3c3c26(0x1076)])+'\x27>文字图</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x154c86=await _0x41b9fc(_0x3c3c26(0x735),_0x3c3c26(0x603),_0x268396,_0x3c3c26(0xc1e),_0x3cd378);setTimeout(()=>{const _0x4fb5b2=_0x3c3c26,_0x2ded65=document['querySelector'](_0x4fb5b2(0x1e1));_0x2ded65&&_0x2ded65[_0x4fb5b2(0x339)](_0x4fb5b2(0x4f6),()=>{const _0xbc6c26=_0x4fb5b2,_0x28e2dc=document[_0xbc6c26(0x948)](_0xbc6c26(0x1561));_0x28e2dc['value']=_0x317bde['shuoshuo'],_0x28e2dc[_0xbc6c26(0x348)]();});},0x64),_0x154c86!==null&&await _0x5f5a00(_0x4a2f88,_0x154c86);}async function _0x5f5a00(_0x55514d,_0x472231){const _0x3b4dab=_0x3ce1fb,_0x5c6064=await _0x6ed281[_0x3b4dab(0xed1)]['get'](_0x55514d);if(!_0x5c6064)return;const _0xdd96d0=_0x472231['trim']();try{const _0x35ba97=JSON['parse'](_0xdd96d0);_0x5c6064[_0x3b4dab(0x4ae)]=_0x35ba97['type']||'image_post',_0x5c6064['publicText']=_0x35ba97[_0x3b4dab(0x15bf)]||'',_0x5c6064['imageUrl']=_0x35ba97['imageUrl']||'',_0x5c6064[_0x3b4dab(0x1329)]=_0x35ba97['imageDescription']||'',_0x5c6064['hiddenContent']=_0x35ba97['hiddenContent']||'',_0x5c6064[_0x3b4dab(0xede)]='';}catch(_0x15db16){_0x5c6064[_0x3b4dab(0x4ae)]=_0x3b4dab(0x2f6),_0x5c6064[_0x3b4dab(0xede)]=_0xdd96d0,_0x5c6064[_0x3b4dab(0x15bf)]='',_0x5c6064[_0x3b4dab(0x15b8)]='',_0x5c6064[_0x3b4dab(0x1329)]='',_0x5c6064[_0x3b4dab(0x7d9)]='';}await _0x6ed281[_0x3b4dab(0xed1)][_0x3b4dab(0x90c)](_0x5c6064),await _0x4d3afb(),await _0x104485('成功',_0x3b4dab(0xd27));}async function _0x3b4373(){const _0x179b6d=_0x3ce1fb;if(!_0x333bfd)return;const _0x263df9=await _0x6ed281[_0x179b6d(0xed1)][_0x179b6d(0xe8c)](_0x333bfd);if(!_0x263df9)return;let _0x553a70=_0x263df9[_0x179b6d(0xede)]||_0x263df9['publicText']||_0x263df9[_0x179b6d(0x7d9)]||_0x263df9[_0x179b6d(0x1329)]||_0x179b6d(0x89a);try{await navigator['clipboard']['writeText'](_0x553a70),await _0x104485(_0x179b6d(0x4e0),'动态内容已复制到剪贴板。');}catch(_0x13a475){await _0x104485('复制失败',_0x179b6d(0x1582));}_0x38b910();}let _0x36d00c=new Set();async function _0x242f37(){const _0x2a90a1=_0x3ce1fb,_0x4db4fc=await _0x9286bb(_0x2a90a1(0x323),[{'text':_0x2a90a1(0xa12),'value':'normal'},{'text':_0x2a90a1(0x36c),'value':_0x2a90a1(0x93e)}]);if(_0x4db4fc==='normal'){_0x36d00c[_0x2a90a1(0x99d)]();const _0xe17f67=document[_0x2a90a1(0x948)]('confirm-contact-picker-btn'),_0x558a1f=_0xe17f67[_0x2a90a1(0xfc0)](!![]);_0xe17f67[_0x2a90a1(0x1579)][_0x2a90a1(0x868)](_0x558a1f,_0xe17f67),_0x558a1f[_0x2a90a1(0x339)](_0x2a90a1(0x4f6),_0x439971),await _0x3a186d(),_0x58c3b1('contact-picker-screen');}else _0x4db4fc===_0x2a90a1(0x93e)&&_0x15c47a();}async function _0x15c47a(){const _0x51a5b7=_0x3ce1fb;_0x36d00c[_0x51a5b7(0x99d)]();const _0x10551a=document[_0x51a5b7(0x948)](_0x51a5b7(0x6bb)),_0x2ef726=_0x10551a[_0x51a5b7(0xfc0)](!![]);_0x10551a['parentNode'][_0x51a5b7(0x868)](_0x2ef726,_0x10551a),_0x2ef726[_0x51a5b7(0x339)](_0x51a5b7(0x4f6),_0x2c4a88),await _0x1b66e6(),_0x58c3b1('contact-picker-screen');}async function _0x1b66e6(){const _0x97ebba=_0x3ce1fb,_0x4f1dfb=document[_0x97ebba(0x948)](_0x97ebba(0xfd9));_0x4f1dfb['innerHTML']='';const _0x2b93c4=Object['values'](_0x16699d[_0x97ebba(0x1474)])[_0x97ebba(0x1c0)](_0x23146c=>!_0x23146c['isGroup']),_0xd6976a=await _0x6ed281['npcs']['toArray']();if(_0x2b93c4[_0x97ebba(0xaf9)]===0x0&&_0xd6976a['length']===0x0){_0x4f1dfb[_0x97ebba(0xb6f)]=_0x97ebba(0x1102);return;}_0x2b93c4['forEach'](_0x38d91a=>{const _0xba989c=_0x97ebba,_0x42a7d1=document[_0xba989c(0x1497)](_0xba989c(0x379));_0x42a7d1[_0xba989c(0x35b)]='contact-picker-item',_0x42a7d1[_0xba989c(0x606)]['contactId']=_0x38d91a['id'],_0x42a7d1[_0xba989c(0xb6f)]=_0xba989c(0x480)+(_0x38d91a[_0xba989c(0x7fd)]['aiAvatar']||_0x202ba5)+_0xba989c(0x1239)+_0x38d91a['name']+_0xba989c(0xe49),_0x4f1dfb[_0xba989c(0x6b6)](_0x42a7d1);}),_0xd6976a['forEach'](_0x356946=>{const _0xc96c10=_0x97ebba,_0x218289=document[_0xc96c10(0x1497)](_0xc96c10(0x379));_0x218289[_0xc96c10(0x35b)]='contact-picker-item',_0x218289[_0xc96c10(0x606)][_0xc96c10(0x596)]=_0x356946['id'],_0x218289[_0xc96c10(0x606)][_0xc96c10(0x258)]='true',_0x218289[_0xc96c10(0xb6f)]=_0xc96c10(0x480)+(_0x356946['avatar']||_0x3ca5ef)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x356946[_0xc96c10(0x1467)]+_0xc96c10(0xb3d),_0x4f1dfb[_0xc96c10(0x6b6)](_0x218289);}),_0x2a3936();}async function _0x2c4a88(){const _0x2562d5=_0x3ce1fb;if(_0x36d00c[_0x2562d5(0x8ca)]<0x2){alert('旁观群聊至少需要选择2个成员。');return;}const _0x2bc0ed=await _0x41b9fc('设置群名',_0x2562d5(0x554),_0x2562d5(0x44e));if(!_0x2bc0ed||!_0x2bc0ed['trim']())return;const _0x3aca23='group_'+Date[_0x2562d5(0x1386)](),_0x23f66e=[],_0x4f7909=await _0x6ed281[_0x2562d5(0xa59)][_0x2562d5(0x443)]();for(const _0x1b5992 of _0x36d00c){const _0xde5d2c=document[_0x2562d5(0xfeb)]('.contact-picker-item[data-contact-id=\x22'+_0x1b5992+'\x22]')[_0x2562d5(0x606)]['isNpc']===_0x2562d5(0xefd);if(_0xde5d2c){const _0x314545=_0x4f7909[_0x2562d5(0x1402)](_0x5f1ee3=>_0x5f1ee3['id']===parseInt(_0x1b5992));_0x314545&&_0x23f66e[_0x2562d5(0x1001)]({'id':'npc_'+_0x314545['id'],'originalName':_0x314545[_0x2562d5(0x1467)],'groupNickname':_0x314545[_0x2562d5(0x1467)],'persona':_0x314545['persona'],'avatar':_0x314545[_0x2562d5(0x63e)]||_0x3ca5ef,'isNpc':!![]});}else{const _0x550cac=_0x16699d['chats'][_0x1b5992];_0x550cac&&_0x23f66e[_0x2562d5(0x1001)]({'id':_0x1b5992,'originalName':_0x550cac[_0x2562d5(0x628)],'groupNickname':_0x550cac[_0x2562d5(0x1467)],'persona':_0x550cac[_0x2562d5(0x7fd)][_0x2562d5(0x14c1)],'avatar':_0x550cac[_0x2562d5(0x7fd)][_0x2562d5(0x156d)]||_0x202ba5,'isNpc':![]});}}const _0x56ad51={'id':_0x3aca23,'name':_0x2bc0ed[_0x2562d5(0x2a8)](),'isGroup':!![],'isSpectatorGroup':!![],'members':_0x23f66e,'settings':{'maxMemory':0xa,'groupAvatar':_0x580bff,'background':'','theme':_0x2562d5(0xe46),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[{'role':_0x2562d5(0x11af),'content':'[系统指令：这是一个没有用户参与的群聊，请你们根据各自的人设自由地开始对话。]','timestamp':Date[_0x2562d5(0x1386)](),'isHidden':!![]}],'musicData':{'totalTime':0x0}};_0x16699d['chats'][_0x3aca23]=_0x56ad51,await _0x6ed281[_0x2562d5(0x1474)][_0x2562d5(0x90c)](_0x56ad51),await _0x2d33eb(),_0x58c3b1(_0x2562d5(0x82a)),_0x5b2fb4(_0x3aca23);}async function _0x3a186d(){const _0x13f130=_0x3ce1fb,_0xc93eed=document[_0x13f130(0x948)](_0x13f130(0xfd9));_0xc93eed[_0x13f130(0xb6f)]='';const _0x12263b=Object[_0x13f130(0x1166)](_0x16699d[_0x13f130(0x1474)])[_0x13f130(0x1c0)](_0x759aa4=>!_0x759aa4[_0x13f130(0x1173)]),_0x248d41=await _0x6ed281[_0x13f130(0xa59)]['toArray']();if(_0x12263b[_0x13f130(0xaf9)]===0x0&&_0x248d41['length']===0x0){_0xc93eed[_0x13f130(0xb6f)]='<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有可以拉进群的联系人哦~</p>';return;}_0x12263b[_0x13f130(0x427)](_0x2c7b66=>{const _0x136ce5=_0x13f130,_0x25b6c6=document[_0x136ce5(0x1497)](_0x136ce5(0x379));_0x25b6c6[_0x136ce5(0x35b)]='contact-picker-item',_0x25b6c6[_0x136ce5(0x606)][_0x136ce5(0x596)]=_0x2c7b66['id'],_0x25b6c6[_0x136ce5(0xb6f)]=_0x136ce5(0x480)+(_0x2c7b66[_0x136ce5(0x7fd)]['aiAvatar']||_0x202ba5)+_0x136ce5(0x1239)+_0x2c7b66[_0x136ce5(0x1467)]+_0x136ce5(0xe49),_0xc93eed['appendChild'](_0x25b6c6);}),_0x248d41[_0x13f130(0x427)](_0x96ffec=>{const _0x3eba21=_0x13f130,_0x12f8d1=document[_0x3eba21(0x1497)](_0x3eba21(0x379));_0x12f8d1[_0x3eba21(0x35b)]='contact-picker-item',_0x12f8d1[_0x3eba21(0x606)][_0x3eba21(0x596)]=_0x3eba21(0x137b)+_0x96ffec['id'],_0x12f8d1['innerHTML']=_0x3eba21(0x480)+(_0x96ffec[_0x3eba21(0x63e)]||_0x3ca5ef)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x96ffec['name']+_0x3eba21(0xb3d),_0xc93eed[_0x3eba21(0x6b6)](_0x12f8d1);}),_0x2a3936();}function _0x2a3936(){const _0x588d23=_0x3ce1fb,_0x22766e=document[_0x588d23(0x948)](_0x588d23(0x6bb));_0x22766e[_0x588d23(0x10cb)]=_0x588d23(0x78f)+_0x36d00c[_0x588d23(0x8ca)]+')',_0x22766e[_0x588d23(0x2c0)]=_0x36d00c[_0x588d23(0x8ca)]<0x2;}async function _0x439971(){const _0x5c2dfc=_0x3ce1fb;if(_0x36d00c[_0x5c2dfc(0x8ca)]<0x2){alert('创建群聊至少需要选择2个联系人。');return;}const _0x1ac91f=await _0x41b9fc('设置群名',_0x5c2dfc(0x554),_0x5c2dfc(0xbdb));if(!_0x1ac91f||!_0x1ac91f[_0x5c2dfc(0x2a8)]())return;const _0x5e143d=_0x5c2dfc(0xa5d)+Date[_0x5c2dfc(0x1386)](),_0xb24620=[],_0x298b0b=await _0x6ed281['npcs'][_0x5c2dfc(0x443)]();for(const _0xcc8f51 of _0x36d00c){if(_0xcc8f51[_0x5c2dfc(0x157f)]('npc_')){const _0x1bb7b8=parseInt(_0xcc8f51[_0x5c2dfc(0x14e9)](_0x5c2dfc(0x137b),'')),_0x5b9601=_0x298b0b['find'](_0x33061d=>_0x33061d['id']===_0x1bb7b8);_0x5b9601&&_0xb24620[_0x5c2dfc(0x1001)]({'id':_0xcc8f51,'originalName':_0x5b9601['name'],'groupNickname':_0x5b9601[_0x5c2dfc(0x1467)],'persona':_0x5b9601[_0x5c2dfc(0xbad)],'avatar':_0x5b9601[_0x5c2dfc(0x63e)]||_0x3ca5ef,'isNpc':!![]});}else{const _0x17b4db=_0x16699d[_0x5c2dfc(0x1474)][_0xcc8f51];_0x17b4db&&_0xb24620[_0x5c2dfc(0x1001)]({'id':_0xcc8f51,'originalName':_0x17b4db['originalName'],'groupNickname':_0x17b4db['name'],'persona':_0x17b4db[_0x5c2dfc(0x7fd)][_0x5c2dfc(0x14c1)],'avatar':_0x17b4db[_0x5c2dfc(0x7fd)][_0x5c2dfc(0x156d)]||_0x202ba5,'isNpc':![]});}}const _0x2eef6c={'id':_0x5e143d,'name':_0x1ac91f[_0x5c2dfc(0x2a8)](),'isGroup':!![],'members':_0xb24620,'settings':{'myPersona':_0x5c2dfc(0xdbd),'myNickname':'我','maxMemory':0xa,'groupAvatar':_0x580bff,'myAvatar':_0x5c1dc1,'background':'','theme':_0x5c2dfc(0xe46),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[],'musicData':{'totalTime':0x0}};_0x16699d[_0x5c2dfc(0x1474)][_0x5e143d]=_0x2eef6c,await _0x6ed281[_0x5c2dfc(0x1474)][_0x5c2dfc(0x90c)](_0x2eef6c),await _0x2d33eb(),_0x58c3b1(_0x5c2dfc(0x82a)),_0x5b2fb4(_0x5e143d);}function _0x37bf66(){const _0xf1542e=_0x3ce1fb;if(!_0x16699d[_0xf1542e(0xf5a)]||!_0x16699d['chats'][_0x16699d['activeChatId']][_0xf1542e(0x1173)])return;_0x22db77(),_0x58c3b1(_0xf1542e(0x4de));}function _0x22db77(){const _0x4d582f=_0x3ce1fb,_0x129bd7=document[_0x4d582f(0x948)]('member-management-list'),_0x4f3384=_0x16699d['chats'][_0x16699d[_0x4d582f(0xf5a)]];_0x129bd7[_0x4d582f(0xb6f)]='',_0x4f3384[_0x4d582f(0x10a2)]['forEach'](_0x43f9b1=>{const _0x50cd5e=_0x4d582f,_0x9f0762=document[_0x50cd5e(0x1497)](_0x50cd5e(0x379));_0x9f0762[_0x50cd5e(0x35b)]=_0x50cd5e(0xc02),_0x9f0762[_0x50cd5e(0xb6f)]=_0x50cd5e(0xe37)+_0x43f9b1['avatar']+_0x50cd5e(0xfb9)+_0x43f9b1[_0x50cd5e(0x347)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-member-btn\x22\x20data-member-id=\x22'+_0x43f9b1['id']+_0x50cd5e(0xe2c),_0x129bd7[_0x50cd5e(0x6b6)](_0x9f0762);});}async function _0x3d453d(_0x1ed888){const _0xd20e0=_0x3ce1fb,_0x3348f0=_0x16699d[_0xd20e0(0x1474)][_0x16699d[_0xd20e0(0xf5a)]],_0x37360b=_0x3348f0[_0xd20e0(0x10a2)][_0xd20e0(0x1018)](_0x49dbd7=>_0x49dbd7['id']===_0x1ed888);if(_0x37360b===-0x1)return;if(_0x3348f0[_0xd20e0(0x10a2)][_0xd20e0(0xaf9)]<=0x2){alert(_0xd20e0(0xfa2));return;}const _0x2327b6=_0x3348f0[_0xd20e0(0x10a2)][_0x37360b][_0xd20e0(0x347)],_0x4a3494=await _0xa6b74a(_0xd20e0(0xb23),_0xd20e0(0x120e)+_0x2327b6+_0xd20e0(0xadf),{'confirmButtonClass':_0xd20e0(0x5e8)});_0x4a3494&&(_0x3348f0[_0xd20e0(0x10a2)][_0xd20e0(0x36d)](_0x37360b,0x1),await _0x6ed281[_0xd20e0(0x1474)][_0xd20e0(0x90c)](_0x3348f0),_0x22db77(),document['getElementById']('chat-settings-btn')[_0xd20e0(0x4f6)]());}async function _0xf5ec62(){const _0x379c41=_0x3ce1fb,_0x3a34b1=document['getElementById']('confirm-contact-picker-btn'),_0x4398a4=_0x3a34b1['cloneNode'](!![]);_0x3a34b1[_0x379c41(0x1579)]['replaceChild'](_0x4398a4,_0x3a34b1),_0x4398a4[_0x379c41(0x339)](_0x379c41(0x4f6),_0x351c15),await _0x4a478e(),_0x58c3b1(_0x379c41(0x37d));}async function _0x4a478e(){const _0x3f652b=_0x3ce1fb,_0xee90ee=document[_0x3f652b(0x948)](_0x3f652b(0xfd9));_0xee90ee[_0x3f652b(0xb6f)]='',_0x36d00c[_0x3f652b(0x99d)]();const _0x728f97=_0x16699d['chats'][_0x16699d[_0x3f652b(0xf5a)]],_0x5caf76=new Set(_0x728f97[_0x3f652b(0x10a2)][_0x3f652b(0x8ff)](_0x5690c9=>_0x5690c9['id'])),_0x1a1ce8=Object[_0x3f652b(0x1166)](_0x16699d[_0x3f652b(0x1474)])[_0x3f652b(0x1c0)](_0x5c3f9b=>!_0x5c3f9b[_0x3f652b(0x1173)]&&!_0x5caf76[_0x3f652b(0xda1)](_0x5c3f9b['id'])),_0x46e0e5=(await _0x6ed281[_0x3f652b(0xa59)]['toArray']())[_0x3f652b(0x1c0)](_0x13a104=>!_0x5caf76[_0x3f652b(0xda1)](_0x3f652b(0x137b)+_0x13a104['id']));_0x1a1ce8[_0x3f652b(0xaf9)]===0x0&&_0x46e0e5[_0x3f652b(0xaf9)]===0x0?(_0xee90ee['innerHTML']=_0x3f652b(0xfdf),document['getElementById'](_0x3f652b(0x6bb))[_0x3f652b(0xf74)][_0x3f652b(0x11fd)]=_0x3f652b(0x12fe)):(document[_0x3f652b(0x948)](_0x3f652b(0x6bb))[_0x3f652b(0xf74)][_0x3f652b(0x11fd)]=_0x3f652b(0x1273),_0x1a1ce8['forEach'](_0x25be4e=>{const _0x24a8ce=_0x3f652b,_0x27dd6c=document[_0x24a8ce(0x1497)](_0x24a8ce(0x379));_0x27dd6c[_0x24a8ce(0x35b)]=_0x24a8ce(0x1437),_0x27dd6c[_0x24a8ce(0x606)][_0x24a8ce(0x596)]=_0x25be4e['id'],_0x27dd6c[_0x24a8ce(0x606)][_0x24a8ce(0xa9a)]='character',_0x27dd6c[_0x24a8ce(0xb6f)]=_0x24a8ce(0x90a)+(_0x25be4e[_0x24a8ce(0x7fd)][_0x24a8ce(0x156d)]||_0x202ba5)+_0x24a8ce(0x1597)+_0x25be4e[_0x24a8ce(0x1467)]+_0x24a8ce(0x11f2),_0xee90ee[_0x24a8ce(0x6b6)](_0x27dd6c);}),_0x46e0e5['forEach'](_0x49c738=>{const _0x5d3af7=_0x3f652b,_0x28520c=document[_0x5d3af7(0x1497)](_0x5d3af7(0x379));_0x28520c[_0x5d3af7(0x35b)]=_0x5d3af7(0x1437),_0x28520c[_0x5d3af7(0x606)][_0x5d3af7(0x596)]=_0x5d3af7(0x137b)+_0x49c738['id'],_0x28520c[_0x5d3af7(0x606)][_0x5d3af7(0xa9a)]=_0x5d3af7(0x3b8),_0x28520c[_0x5d3af7(0x606)][_0x5d3af7(0xa18)]=_0x49c738['id'],_0x28520c[_0x5d3af7(0xb6f)]=_0x5d3af7(0x90a)+(_0x49c738[_0x5d3af7(0x63e)]||_0x3ca5ef)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x49c738[_0x5d3af7(0x1467)]+_0x5d3af7(0x1158),_0xee90ee[_0x5d3af7(0x6b6)](_0x28520c);})),_0x2a3936();}async function _0x351c15(){const _0x4d656f=_0x3ce1fb;if(_0x36d00c[_0x4d656f(0x8ca)]===0x0){alert(_0x4d656f(0x2be));return;}const _0x2ccb0b=_0x16699d[_0x4d656f(0x1474)][_0x16699d[_0x4d656f(0xf5a)]],_0xf2bd73=await _0x6ed281[_0x4d656f(0xa59)]['toArray']();for(const _0x4bc2a4 of _0x36d00c){const _0x51e1a4=document[_0x4d656f(0xfeb)](_0x4d656f(0xc43)+_0x4bc2a4+'\x22]');if(!_0x51e1a4)continue;const _0x2a7361=_0x51e1a4['dataset'][_0x4d656f(0xa9a)];if(_0x2a7361===_0x4d656f(0x4d1)){const _0x36e8c7=_0x16699d[_0x4d656f(0x1474)][_0x4bc2a4];_0x36e8c7&&_0x2ccb0b[_0x4d656f(0x10a2)][_0x4d656f(0x1001)]({'id':_0x4bc2a4,'originalName':_0x36e8c7['originalName'],'groupNickname':_0x36e8c7[_0x4d656f(0x1467)],'persona':_0x36e8c7[_0x4d656f(0x7fd)]['aiPersona'],'avatar':_0x36e8c7[_0x4d656f(0x7fd)][_0x4d656f(0x156d)]||_0x202ba5,'isNpc':![]});}else{if(_0x2a7361===_0x4d656f(0x3b8)){const _0x4f7fd0=parseInt(_0x51e1a4[_0x4d656f(0x606)][_0x4d656f(0xa18)]),_0x5d8562=_0xf2bd73[_0x4d656f(0x1402)](_0xe024bc=>_0xe024bc['id']===_0x4f7fd0);_0x5d8562&&_0x2ccb0b[_0x4d656f(0x10a2)][_0x4d656f(0x1001)]({'id':_0x4d656f(0x137b)+_0x4f7fd0,'originalName':_0x5d8562[_0x4d656f(0x1467)],'groupNickname':_0x5d8562[_0x4d656f(0x1467)],'persona':_0x5d8562[_0x4d656f(0xbad)],'avatar':_0x5d8562[_0x4d656f(0x63e)]||_0x3ca5ef,'isNpc':!![]});}}}await _0x6ed281['chats'][_0x4d656f(0x90c)](_0x2ccb0b),_0x37bf66();}function _0x470065(){_0x2e273c=!![],_0x3330d7(null);}function _0x4b7294(_0x275487,_0x2e70cd){const _0x5acdad=setInterval(()=>{const _0x1abdca=_0x6c9e,_0x4271d5=Date['now'](),_0x269762=_0x2e70cd-_0x4271d5;if(_0x269762<0x0){clearInterval(_0x5acdad),_0x275487[_0x1abdca(0xb6f)]=_0x1abdca(0xfd3);return;}const _0x296852=Math[_0x1abdca(0x15b6)](_0x269762%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x33c626=Math['floor'](_0x269762%(0x3e8*0x3c)/0x3e8),_0x461a4f=String(_0x296852)[_0x1abdca(0x112d)](0x2,'0'),_0x4e7534=String(_0x33c626)[_0x1abdca(0x112d)](0x2,'0');_0x275487[_0x1abdca(0xb6f)]=_0x1abdca(0x5c4)+_0x461a4f[_0x1abdca(0xb79)](0x0)+_0x1abdca(0x119b)+_0x461a4f[_0x1abdca(0xb79)](0x1)+'</span>\x20:\x20<span>'+_0x4e7534[_0x1abdca(0xb79)](0x0)+'</span><span>'+_0x4e7534[_0x1abdca(0xb79)](0x1)+_0x1abdca(0xffc);},0x3e8);return _0x5acdad;}function _0x5f5407(){for(const _0x256dc6 in _0x5a9d1f){clearInterval(_0x5a9d1f[_0x256dc6]);}_0x5a9d1f={};}async function _0x3ceda9(_0x5bb174){const _0x435579=_0x3ce1fb,_0x347bc0=_0x16699d[_0x435579(0x1474)][_0x16699d['activeChatId']];if(!_0x347bc0)return;const _0x5f287b=_0x347bc0[_0x435579(0xb07)][_0x435579(0x1402)](_0x16b0cd=>_0x16b0cd['timestamp']===_0x5bb174);if(!_0x5f287b||!['waimai_request',_0x435579(0xf8e)][_0x435579(0x1336)](_0x5f287b['type'])){console[_0x435579(0xc3e)](_0x435579(0x1200),_0x5bb174);return;}let _0x26fc54='';if(_0x5f287b[_0x435579(0x4ae)]===_0x435579(0x29c)){let _0x530b20;switch(_0x5f287b[_0x435579(0x82c)]){case'paid':const _0x145867=_0x5f287b[_0x435579(0x13c9)]||'对方',_0x45ee75=_0x589066(_0x347bc0,_0x145867);_0x530b20='由\x20'+_0x45ee75+'\x20为您代付成功';break;case _0x435579(0xc84):_0x530b20=_0x435579(0xaa8);break;default:_0x530b20=_0x435579(0x980);break;}_0x26fc54='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20'+_0x5f287b[_0x435579(0x890)]+_0x435579(0xd4f)+Number(_0x5f287b['amount'])[_0x435579(0xd69)](0x2)+_0x435579(0x8fe)+_0x530b20+_0x435579(0x1393);}else{if(_0x5f287b[_0x435579(0x4ae)]===_0x435579(0xf8e)){let _0x232795,_0xcd75dc;_0x347bc0[_0x435579(0x1173)]?(_0x232795=_0x589066(_0x347bc0,_0x5f287b[_0x435579(0x14ee)]),_0xcd75dc=_0x589066(_0x347bc0,_0x5f287b['recipientName'])):_0x5f287b[_0x435579(0x1554)]===_0x435579(0xaeb)?(_0x232795=_0x347bc0[_0x435579(0x7fd)][_0x435579(0x1371)]||'我',_0xcd75dc=_0x347bc0['name']):(_0x232795=_0x347bc0[_0x435579(0x1467)],_0xcd75dc=_0x347bc0[_0x435579(0x7fd)][_0x435579(0x1371)]||'我'),_0x26fc54=_0x435579(0x1328)+_0x232795+_0x435579(0x74c)+_0xcd75dc+_0x435579(0x12b8)+_0x5f287b['productInfo']+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥'+Number(_0x5f287b[_0x435579(0xbd2)])[_0x435579(0xd69)](0x2)+_0x435579(0x1393);}}await _0x104485(_0x435579(0xf1c),_0x26fc54);}async function _0x1202c7(_0x10ccd2,_0x56da03){const _0x52b517=_0x3ce1fb,_0x35e512=_0x16699d[_0x52b517(0x1474)][_0x16699d['activeChatId']];if(!_0x35e512)return;const _0x29341f=_0x35e512['history'][_0x52b517(0x1018)](_0x2ea84e=>_0x2ea84e['timestamp']===_0x10ccd2);if(_0x29341f===-0x1)return;const _0x5bb59c=_0x35e512[_0x52b517(0xb07)][_0x29341f];_0x5bb59c[_0x52b517(0x82c)]=_0x56da03;let _0x19f0ac;const _0x11bec6=_0x35e512[_0x52b517(0x1173)]?_0x35e512[_0x52b517(0x7fd)][_0x52b517(0x1371)]||'我':'我';_0x56da03===_0x52b517(0x922)?(_0x5bb59c['paidBy']=_0x11bec6,_0x19f0ac=_0x52b517(0x108a)+_0x11bec6+')\x20为\x20'+_0x5bb59c[_0x52b517(0x14ee)]+_0x52b517(0xcae)+_0x10ccd2+_0x52b517(0xb46)):_0x19f0ac=_0x52b517(0x108a)+_0x11bec6+_0x52b517(0x147c)+_0x5bb59c[_0x52b517(0x14ee)]+'\x20的外卖代付请求（时间戳:\x20'+_0x10ccd2+_0x52b517(0x694);const _0x3c3c91={'role':_0x52b517(0x11af),'content':_0x19f0ac,'timestamp':Date['now'](),'isHidden':!![]};_0x35e512[_0x52b517(0xb07)]['push'](_0x3c3c91),await _0x6ed281[_0x52b517(0x1474)][_0x52b517(0x90c)](_0x35e512),_0x455873(_0x16699d['activeChatId']);}let _0x1c6d6b={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x437dff=null;async function _0x472fb7(){const _0xb743ab=_0x3ce1fb;if(!_0x16699d['activeChatId']||_0x1c6d6b[_0xb743ab(0x1032)]||_0x1c6d6b['isAwaitingResponse'])return;const _0x526c73=_0x16699d['chats'][_0x16699d[_0xb743ab(0xf5a)]];_0x1c6d6b[_0xb743ab(0x658)]=_0x526c73['isGroup'],_0x1c6d6b[_0xb743ab(0xab7)]=!![],_0x1c6d6b[_0xb743ab(0x840)]=_0xb743ab(0xaeb),_0x1c6d6b['activeChatId']=_0x526c73['id'],_0x1c6d6b[_0xb743ab(0xdd6)]=!![];_0x526c73[_0xb743ab(0x1173)]?(document[_0xb743ab(0x948)](_0xb743ab(0xacb))[_0xb743ab(0x147d)]=_0x526c73[_0xb743ab(0x7fd)]['myAvatar']||_0x5c1dc1,document[_0xb743ab(0x948)]('outgoing-call-name')[_0xb743ab(0x10cb)]=_0x526c73[_0xb743ab(0x7fd)][_0xb743ab(0x1371)]||'我'):(document['getElementById'](_0xb743ab(0xacb))['src']=_0x526c73[_0xb743ab(0x7fd)][_0xb743ab(0x156d)]||_0x202ba5,document['getElementById']('outgoing-call-name')[_0xb743ab(0x10cb)]=_0x526c73[_0xb743ab(0x1467)]);document[_0xb743ab(0xfeb)](_0xb743ab(0x3dc))[_0xb743ab(0x10cb)]=_0x526c73[_0xb743ab(0x1173)]?_0xb743ab(0x87b):_0xb743ab(0xe95),_0x58c3b1('outgoing-call-screen');const _0x1dd0f9={'role':_0xb743ab(0x11af),'content':_0x526c73[_0xb743ab(0x1173)]?_0xb743ab(0x53e)+(_0x526c73['settings'][_0xb743ab(0x1371)]||'我')+_0xb743ab(0x4e5):_0xb743ab(0xe33),'timestamp':Date[_0xb743ab(0x1386)](),'isHidden':!![]};_0x526c73[_0xb743ab(0xb07)][_0xb743ab(0x1001)](_0x1dd0f9),await _0x6ed281['chats'][_0xb743ab(0x90c)](_0x526c73),await _0x45c50a();}function _0x294d96(){const _0x167a63=_0x3ce1fb,_0x3136d5=_0x16699d[_0x167a63(0x1474)][_0x1c6d6b[_0x167a63(0xf5a)]];if(!_0x3136d5)return;_0x1c6d6b['isActive']=!![],_0x1c6d6b[_0x167a63(0xab7)]=![],_0x1c6d6b[_0x167a63(0xb1d)]=Date[_0x167a63(0x1386)](),_0x1c6d6b[_0x167a63(0xff6)]=[];const _0x161dd8=_0x3136d5[_0x167a63(0xb07)][_0x167a63(0x200)](-0xa);_0x1c6d6b[_0x167a63(0x103e)]=_0x161dd8[_0x167a63(0x8ff)](_0x2aac09=>{const _0x80eaa9=_0x167a63,_0xf500ce=_0x2aac09[_0x80eaa9(0x1554)]===_0x80eaa9(0xaeb)?_0x3136d5[_0x80eaa9(0x7fd)][_0x80eaa9(0x1371)]||'我':_0x2aac09[_0x80eaa9(0x14ee)]||_0x3136d5['name'];return _0xf500ce+':\x20'+String(_0x2aac09['content'])['substring'](0x0,0x32)+_0x80eaa9(0x76d);})[_0x167a63(0x121a)]('\x0a'),_0x5b6533(),document['getElementById']('video-call-main')['innerHTML']=_0x167a63(0xda0)+(_0x1c6d6b['isGroupCall']?_0x167a63(0xc22):_0x167a63(0x1106))+_0x167a63(0x34e),_0x58c3b1(_0x167a63(0xde7)),document[_0x167a63(0x948)](_0x167a63(0x862))[_0x167a63(0xf74)][_0x167a63(0x11fd)]=_0x1c6d6b['isUserParticipating']?_0x167a63(0x1273):_0x167a63(0x12fe),document[_0x167a63(0x948)](_0x167a63(0x83c))[_0x167a63(0xf74)][_0x167a63(0x11fd)]=_0x1c6d6b[_0x167a63(0xdd6)]?_0x167a63(0x12fe):_0x167a63(0x1273);if(_0x437dff)clearInterval(_0x437dff);_0x437dff=setInterval(_0x4c0c5d,0x3e8),_0x4c0c5d(),_0xc4d3ec();}async function _0x2c3e36(){const _0x2d071a=_0x3ce1fb;if(!_0x1c6d6b[_0x2d071a(0x1032)])return;const _0x2a1a1f=Math[_0x2d071a(0x15b6)]((Date[_0x2d071a(0x1386)]()-_0x1c6d6b[_0x2d071a(0xb1d)])/0x3e8),_0x2ae346=Math[_0x2d071a(0x15b6)](_0x2a1a1f/0x3c)+'分'+_0x2a1a1f%0x3c+'秒',_0x16cb2d=_0x2d071a(0x1358)+_0x2ae346,_0x3c41aa=_0x16699d[_0x2d071a(0x1474)][_0x1c6d6b[_0x2d071a(0xf5a)]];if(_0x3c41aa){const _0x46ecd0=[];_0x1c6d6b['isGroupCall']?(_0x1c6d6b['participants'][_0x2d071a(0x427)](_0xaf56da=>_0x46ecd0['push']({'name':_0xaf56da[_0x2d071a(0x628)],'avatar':_0xaf56da['avatar']})),_0x1c6d6b[_0x2d071a(0xdd6)]&&_0x46ecd0[_0x2d071a(0x7ef)]({'name':_0x3c41aa['settings'][_0x2d071a(0x1371)]||'我','avatar':_0x3c41aa[_0x2d071a(0x7fd)][_0x2d071a(0xb09)]||_0x5c1dc1})):(_0x46ecd0[_0x2d071a(0x1001)]({'name':_0x3c41aa[_0x2d071a(0x1467)],'avatar':_0x3c41aa['settings'][_0x2d071a(0x156d)]||_0x202ba5}),_0x46ecd0[_0x2d071a(0x7ef)]({'name':'我','avatar':_0x3c41aa[_0x2d071a(0x7fd)][_0x2d071a(0xb09)]||_0x202ba5}));const _0x2b5c4f={'chatId':_0x1c6d6b[_0x2d071a(0xf5a)],'timestamp':Date[_0x2d071a(0x1386)](),'duration':_0x2a1a1f,'participants':_0x46ecd0,'transcript':[..._0x1c6d6b[_0x2d071a(0xff6)]]};await _0x6ed281[_0x2d071a(0x14b5)][_0x2d071a(0xbd0)](_0x2b5c4f),console[_0x2d071a(0x498)](_0x2d071a(0x14d1),_0x2b5c4f);let _0x4cc868={'role':_0x1c6d6b['initiator']==='user'?_0x2d071a(0xaeb):_0x2d071a(0x14c8),'content':_0x16cb2d,'timestamp':Date['now']()};_0x3c41aa[_0x2d071a(0x1173)]&&_0x4cc868[_0x2d071a(0x1554)]===_0x2d071a(0x14c8)&&(_0x4cc868[_0x2d071a(0x14ee)]=_0x1c6d6b[_0x2d071a(0xcd5)]||_0x3c41aa[_0x2d071a(0x10a2)][0x0]?.['originalName']||_0x3c41aa['name']);_0x3c41aa[_0x2d071a(0xb07)][_0x2d071a(0x1001)](_0x4cc868);const _0x5a0376=_0x1c6d6b[_0x2d071a(0xff6)][_0x2d071a(0x8ff)](_0x286319=>{const _0xa9da5d=_0x2d071a,_0x187355=_0x286319[_0xa9da5d(0x1554)]===_0xa9da5d(0xaeb)?_0x3c41aa[_0xa9da5d(0x7fd)]['myNickname']||'我':_0x286319['senderName'];return _0x187355+':\x20'+_0x286319[_0xa9da5d(0xede)];})['join']('\x0a');_0x5513dd(_0x3c41aa['id'],_0x5a0376);const _0x4700be={'role':'system','content':'[系统指令：视频通话刚刚结束。请你以角色的口吻，向用户主动发送一两条消息，来自然地总结这次通话的要点、确认达成的约定，或者表达你的感受。]','timestamp':Date[_0x2d071a(0x1386)]()+0x1,'isHidden':!![]};_0x3c41aa[_0x2d071a(0xb07)]['push'](_0x4700be),await _0x6ed281[_0x2d071a(0x1474)]['put'](_0x3c41aa);}clearInterval(_0x437dff),_0x437dff=null,_0x1c6d6b={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x3c41aa&&(_0x5b2fb4(_0x3c41aa['id']),_0x45c50a());}function _0x5b6533(){const _0x53cc03=_0x3ce1fb,_0x15b0e8=document[_0x53cc03(0x948)](_0x53cc03(0xa8f));_0x15b0e8[_0x53cc03(0xb6f)]='';const _0x2fc097=_0x16699d[_0x53cc03(0x1474)][_0x1c6d6b[_0x53cc03(0xf5a)]];if(!_0x2fc097)return;let _0x14702a=[];_0x1c6d6b[_0x53cc03(0x658)]?(_0x14702a=[..._0x1c6d6b[_0x53cc03(0x112b)]],_0x1c6d6b[_0x53cc03(0xdd6)]&&_0x14702a[_0x53cc03(0x7ef)]({'id':_0x53cc03(0xaeb),'name':_0x2fc097[_0x53cc03(0x7fd)]['myNickname']||'我','avatar':_0x2fc097['settings'][_0x53cc03(0xb09)]||_0x5c1dc1})):_0x14702a[_0x53cc03(0x1001)]({'id':'ai','name':_0x2fc097[_0x53cc03(0x1467)],'avatar':_0x2fc097['settings'][_0x53cc03(0x156d)]||_0x202ba5}),_0x14702a[_0x53cc03(0x427)](_0x24f41c=>{const _0x5778f0=_0x53cc03,_0x241c0a=document[_0x5778f0(0x1497)](_0x5778f0(0x379));_0x241c0a['className']=_0x5778f0(0x786),_0x241c0a['dataset']['participantId']=_0x24f41c['id'];const _0xe02ac3=_0x24f41c[_0x5778f0(0x347)]||_0x24f41c[_0x5778f0(0x1467)];_0x241c0a[_0x5778f0(0xb6f)]=_0x5778f0(0xa21)+_0x24f41c[_0x5778f0(0x63e)]+_0x5778f0(0x132c)+_0xe02ac3+_0x5778f0(0xed9)+_0xe02ac3+_0x5778f0(0x13aa),_0x15b0e8[_0x5778f0(0x6b6)](_0x241c0a);});}function _0x43312d(){const _0x90932=_0x3ce1fb;if(!_0x1c6d6b[_0x90932(0x1032)]||_0x1c6d6b[_0x90932(0xdd6)])return;_0x1c6d6b[_0x90932(0xdd6)]=!![],_0x5b6533(),document['getElementById']('user-speak-btn')[_0x90932(0xf74)][_0x90932(0x11fd)]=_0x90932(0x1273),document[_0x90932(0x948)](_0x90932(0x83c))[_0x90932(0xf74)][_0x90932(0x11fd)]=_0x90932(0x12fe),_0xc4d3ec(_0x90932(0x138e));}function _0x4c0c5d(){const _0x2df850=_0x3ce1fb;if(!_0x1c6d6b['isActive'])return;const _0x5d3e6f=Math[_0x2df850(0x15b6)]((Date['now']()-_0x1c6d6b['startTime'])/0x3e8),_0x460838=Math[_0x2df850(0x15b6)](_0x5d3e6f/0x3c),_0x14da9e=_0x5d3e6f%0x3c;document[_0x2df850(0x948)](_0x2df850(0x145d))[_0x2df850(0x10cb)]=String(_0x460838)[_0x2df850(0x112d)](0x2,'0')+':'+String(_0x14da9e)[_0x2df850(0x112d)](0x2,'0');}function _0x1b90eb(){const _0x53155b=_0x3ce1fb,_0x2d8a10=_0x16699d[_0x53155b(0x1474)][_0x16699d[_0x53155b(0xf5a)]];if(!_0x2d8a10)return;if(_0x2d8a10[_0x53155b(0x1173)]){const _0x451d2a=_0x1c6d6b[_0x53155b(0xcd5)]||_0x2d8a10[_0x53155b(0x10a2)][0x0]?.[_0x53155b(0x1467)]||_0x53155b(0xcdd);document[_0x53155b(0x948)](_0x53155b(0x493))['src']=_0x2d8a10[_0x53155b(0x7fd)][_0x53155b(0x1e7)]||_0x580bff,document['getElementById']('caller-name')['textContent']=_0x2d8a10[_0x53155b(0x1467)],document[_0x53155b(0xfeb)](_0x53155b(0xe75))['textContent']=_0x451d2a+_0x53155b(0xaac);}else document['getElementById'](_0x53155b(0x493))[_0x53155b(0x147d)]=_0x2d8a10[_0x53155b(0x7fd)][_0x53155b(0x156d)]||_0x202ba5,document['getElementById']('caller-name')[_0x53155b(0x10cb)]=_0x2d8a10['name'],document[_0x53155b(0xfeb)](_0x53155b(0xe75))[_0x53155b(0x10cb)]=_0x53155b(0x99a);document[_0x53155b(0x948)](_0x53155b(0xf83))[_0x53155b(0xd54)]['add']('visible');}function _0x183e94(){const _0xe50e87=_0x3ce1fb;document[_0xe50e87(0x948)](_0xe50e87(0xf83))[_0xe50e87(0xd54)][_0xe50e87(0xf89)]('visible');}async function _0xc4d3ec(_0x356a91=null){const _0x362a33=_0x3ce1fb;if(!_0x1c6d6b[_0x362a33(0x1032)])return;const _0xfb841d=_0x16699d[_0x362a33(0x1474)][_0x1c6d6b[_0x362a33(0xf5a)]],{proxyUrl:_0x469d31,apiKey:_0x467a27,model:_0x303a36}=_0x16699d['apiConfig'],_0xdf1f9c=document['getElementById'](_0x362a33(0x68e)),_0x250ddc=_0xfb841d['settings'][_0x362a33(0x1371)]||'我';let _0x35c048='';if(_0xfb841d[_0x362a33(0x7fd)][_0x362a33(0xeee)]&&_0xfb841d[_0x362a33(0x7fd)][_0x362a33(0xeee)][_0x362a33(0xaf9)]>0x0){const _0x329c48=_0xfb841d[_0x362a33(0x7fd)][_0x362a33(0xeee)]['map'](_0x31905e=>{const _0x3650e7=_0x362a33,_0x20044b=_0x16699d[_0x3650e7(0x44c)][_0x3650e7(0x1402)](_0x218f33=>_0x218f33['id']===_0x31905e);return _0x20044b&&_0x20044b[_0x3650e7(0xede)]?_0x3650e7(0x1067)+_0x20044b[_0x3650e7(0x1467)]+'\x0a'+_0x20044b[_0x3650e7(0xede)]:'';})[_0x362a33(0x1c0)](Boolean)[_0x362a33(0x121a)]('');_0x329c48&&(_0x35c048=_0x362a33(0xd29)+_0x329c48+_0x362a33(0x11b7));}if(_0x356a91&&_0x1c6d6b[_0x362a33(0xdd6)]){const _0x38e4b4=Date[_0x362a33(0x1386)](),_0x4b118f=document[_0x362a33(0x1497)](_0x362a33(0x379));_0x4b118f[_0x362a33(0x35b)]=_0x362a33(0x12da),_0x4b118f['textContent']=_0x356a91,_0x4b118f['dataset'][_0x362a33(0xb0a)]=_0x38e4b4,_0x159366(_0x4b118f,()=>_0x4ba9ed(_0x38e4b4)),_0xdf1f9c[_0x362a33(0x6b6)](_0x4b118f),_0xdf1f9c['scrollTop']=_0xdf1f9c[_0x362a33(0x971)],_0x1c6d6b['callHistory']['push']({'role':_0x362a33(0xaeb),'content':_0x356a91,'timestamp':_0x38e4b4});}let _0x194472;if(_0x1c6d6b[_0x362a33(0x658)]){const _0x516042=_0x1c6d6b['participants']['map'](_0x292df2=>_0x292df2[_0x362a33(0x1467)]);_0x1c6d6b['isUserParticipating']&&_0x516042[_0x362a33(0x7ef)](_0x250ddc),_0x194472='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊视频通话的导演。你的任务是扮演所有【除了用户以外】的AI角色，并以【第三人称旁观视角】来描述他们在通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【身份铁律】】】**:\x20用户的身份是【'+_0x250ddc+_0x362a33(0x67b)+_0x250ddc+_0x362a33(0x2ce)+_0x1c6d6b[_0x362a33(0x103e)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20**当前参与者**:\x20'+_0x516042[_0x362a33(0x121a)]('、\x20')+_0x362a33(0x2c2)+_0x35c048+'\x20//\x20<--\x20【核心】注入世界书\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}else{let _0x44baf3=_0x1c6d6b[_0x362a33(0x840)]===_0x362a33(0xaeb)?_0x362a33(0x131e):'用户刚刚接听了你主动发起的视频通话。';_0x194472=_0x362a33(0xc54)+_0xfb841d[_0x362a33(0x1467)]+'\x20('+_0xfb841d['settings'][_0x362a33(0x14c1)]+')，并以【第三人称旁观视角】来描述TA在视频通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。必须使用第三人称，如“他”、“她”、或直接使用角色名“'+_0xfb841d[_0x362a33(0x1467)]+_0x362a33(0xedc)+_0x250ddc+_0x362a33(0xfe8)+_0xfb841d[_0x362a33(0x7fd)][_0x362a33(0x13b6)]+'）进行视频通话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**'+_0x44baf3+_0x362a33(0x92f)+_0x1c6d6b['preCallContext']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}const _0x752c54=[{'role':'system','content':_0x194472},..._0x1c6d6b[_0x362a33(0xff6)][_0x362a33(0x8ff)](_0x1e95b1=>({'role':_0x1e95b1[_0x362a33(0x1554)],'content':_0x1e95b1[_0x362a33(0xede)]}))];if(_0x1c6d6b['callHistory'][_0x362a33(0xaf9)]===0x0){const _0x29d244=_0x1c6d6b['initiator']==='user'?_0x362a33(0x2bc):_0x362a33(0x1c2);_0x752c54[_0x362a33(0x1001)]({'role':_0x362a33(0xaeb),'content':_0x29d244});}try{let _0x13f086=_0x469d31===GEMINI_API_URL,_0x447050=_0xe8c788(_0x303a36,_0x467a27,_0x194472,_0x752c54);const _0x4bc9ce=_0x13f086?await fetch(_0x447050[_0x362a33(0x9a8)],_0x447050[_0x362a33(0x92a)]):await fetch(_0x469d31+_0x362a33(0x110e),{'method':_0x362a33(0xdca),'headers':{'Content-Type':_0x362a33(0x479),'Authorization':_0x362a33(0xb0e)+_0x467a27},'body':JSON['stringify']({'model':_0x303a36,'messages':_0x752c54,'temperature':_0x16699d[_0x362a33(0xf9c)][_0x362a33(0x382)]||0.8})});if(!_0x4bc9ce['ok'])throw new Error((await _0x4bc9ce[_0x362a33(0x21d)]())['error'][_0x362a33(0x74b)]);const _0x201f5c=await _0x4bc9ce['json'](),_0x6e38f4=_0x13f086?_0x201f5c[_0x362a33(0x272)][0x0][_0x362a33(0xede)][_0x362a33(0x1305)][0x0][_0x362a33(0x9ea)]:_0x201f5c[_0x362a33(0xc11)][0x0][_0x362a33(0x74b)][_0x362a33(0xede)],_0x23aab0=_0xdf1f9c[_0x362a33(0xfeb)]('em');if(_0x23aab0)_0x23aab0[_0x362a33(0xf89)]();if(_0x1c6d6b[_0x362a33(0x658)]){const _0x383553=_0xad600c(_0x6e38f4);_0x383553[_0x362a33(0x427)](_0x27dd70=>{const _0x40d806=_0x362a33;if(!_0x27dd70[_0x40d806(0x1467)]||_0x27dd70[_0x40d806(0x1467)]===_0x250ddc||!_0x27dd70[_0x40d806(0xcab)])return;const _0x7bb1ac=Date[_0x40d806(0x1386)]()+Math[_0x40d806(0x59c)](),_0x7d57b9=document[_0x40d806(0x1497)](_0x40d806(0x379));_0x7d57b9[_0x40d806(0x35b)]=_0x40d806(0x447),_0x7d57b9[_0x40d806(0xb6f)]=_0x40d806(0x7f2)+_0x27dd70[_0x40d806(0x1467)]+_0x40d806(0x11d5)+_0x27dd70[_0x40d806(0xcab)],_0x7d57b9[_0x40d806(0x606)][_0x40d806(0xb0a)]=_0x7bb1ac,_0x159366(_0x7d57b9,()=>_0x4ba9ed(_0x7bb1ac)),_0xdf1f9c[_0x40d806(0x6b6)](_0x7d57b9),_0x1c6d6b[_0x40d806(0xff6)]['push']({'role':_0x40d806(0x14c8),'content':_0x27dd70[_0x40d806(0x1467)]+':\x20'+_0x27dd70['speech'],'timestamp':_0x7bb1ac});const _0x18a7a0=_0x1c6d6b['participants'][_0x40d806(0x1402)](_0x2a24e9=>_0x2a24e9[_0x40d806(0x1467)]===_0x27dd70[_0x40d806(0x1467)]);if(_0x18a7a0){const _0xaa47fb=document[_0x40d806(0xfeb)](_0x40d806(0x4aa)+_0x18a7a0['id']+_0x40d806(0x10fb));_0xaa47fb&&(_0xaa47fb['classList']['add'](_0x40d806(0xac4)),setTimeout(()=>_0xaa47fb['classList'][_0x40d806(0xf89)](_0x40d806(0xac4)),0x7d0));}});}else{const _0x37b81e=Date[_0x362a33(0x1386)](),_0x35da25=document[_0x362a33(0x1497)](_0x362a33(0x379));_0x35da25[_0x362a33(0x35b)]=_0x362a33(0x447),_0x35da25[_0x362a33(0x10cb)]=_0x6e38f4,_0x35da25[_0x362a33(0x606)][_0x362a33(0xb0a)]=_0x37b81e,_0x159366(_0x35da25,()=>_0x4ba9ed(_0x37b81e)),_0xdf1f9c['appendChild'](_0x35da25),_0x1c6d6b[_0x362a33(0xff6)][_0x362a33(0x1001)]({'role':_0x362a33(0x14c8),'content':_0x6e38f4,'timestamp':_0x37b81e});const _0x5a9ad3=document[_0x362a33(0xfeb)](_0x362a33(0x1376));_0x5a9ad3&&(_0x5a9ad3[_0x362a33(0xd54)][_0x362a33(0xbd0)](_0x362a33(0xac4)),setTimeout(()=>_0x5a9ad3[_0x362a33(0xd54)]['remove'](_0x362a33(0xac4)),0x7d0));}_0xdf1f9c[_0x362a33(0xced)]=_0xdf1f9c['scrollHeight'];}catch(_0x4416cd){const _0x4f2e6e=document[_0x362a33(0x1497)](_0x362a33(0x379));_0x4f2e6e['className']='call-message-bubble\x20ai-speech',_0x4f2e6e[_0x362a33(0xf74)]['color']=_0x362a33(0xa56),_0x4f2e6e['textContent']=_0x362a33(0x1e6)+_0x4416cd[_0x362a33(0x74b)]+']',_0xdf1f9c['appendChild'](_0x4f2e6e),_0xdf1f9c[_0x362a33(0xced)]=_0xdf1f9c['scrollHeight'],_0x1c6d6b[_0x362a33(0xff6)][_0x362a33(0x1001)]({'role':_0x362a33(0x14c8),'content':'[ERROR:\x20'+_0x4416cd[_0x362a33(0x74b)]+']'});}}function _0x3d1506(_0x2624be){const _0x32df83=_0x3ce1fb;document['getElementById'](_0x32df83(0xb81))['style'][_0x32df83(0x11fd)]=_0x2624be?_0x32df83(0x12fe):_0x32df83(0x6a4),document[_0x32df83(0x948)](_0x32df83(0x82e))[_0x32df83(0xf74)]['display']=_0x2624be?_0x32df83(0x6a4):'none';}async function _0x1202c7(_0x3c90d7,_0x13911a){const _0xdcc016=_0x3ce1fb,_0x1a7258=_0x16699d[_0xdcc016(0x1474)][_0x16699d[_0xdcc016(0xf5a)]];if(!_0x1a7258)return;const _0x44b35f=_0x1a7258['history'][_0xdcc016(0x1018)](_0x5be803=>_0x5be803[_0xdcc016(0xb0a)]===_0x3c90d7);if(_0x44b35f===-0x1)return;const _0x425b4e=_0x1a7258[_0xdcc016(0xb07)][_0x44b35f];_0x425b4e[_0xdcc016(0x82c)]=_0x13911a;let _0x457484;const _0x5922fa=_0x1a7258['isGroup']?_0x1a7258[_0xdcc016(0x7fd)][_0xdcc016(0x1371)]||'我':'我';_0x13911a===_0xdcc016(0x922)?(_0x425b4e[_0xdcc016(0x13c9)]=_0x5922fa,_0x457484=_0xdcc016(0x108a)+_0x5922fa+_0xdcc016(0x7d1)+_0x425b4e['senderName']+_0xdcc016(0xcae)+_0x3c90d7+_0xdcc016(0xb46)):_0x457484='[系统提示：你\x20('+_0x5922fa+_0xdcc016(0x147c)+_0x425b4e['senderName']+_0xdcc016(0x13bf)+_0x3c90d7+_0xdcc016(0x694);const _0x690753={'role':_0xdcc016(0x11af),'content':_0x457484,'timestamp':Date[_0xdcc016(0x1386)](),'isHidden':!![]};_0x1a7258['history'][_0xdcc016(0x1001)](_0x690753),await _0x6ed281[_0xdcc016(0x1474)][_0xdcc016(0x90c)](_0x1a7258),_0x455873(_0x16699d[_0xdcc016(0xf5a)]),_0x13911a===_0xdcc016(0x922)&&_0x45c50a();}async function _0x528d61(_0x1f3f3d,_0x289d6f){const _0x2286a1=_0x3ce1fb,_0x519904=_0x16699d['chats'][_0x1f3f3d];if(!_0x519904)return;let _0x237b2f;_0x519904[_0x2286a1(0x1173)]?_0x237b2f=_0x589066(_0x519904,_0x289d6f):_0x237b2f=_0x519904[_0x2286a1(0x1467)];const _0x456d8f=document[_0x2286a1(0x948)](_0x2286a1(0xecd));_0x456d8f[_0x2286a1(0xd54)]['remove'](_0x2286a1(0x48a)),void _0x456d8f[_0x2286a1(0x5f7)],_0x456d8f[_0x2286a1(0xd54)][_0x2286a1(0xbd0)]('pat-animation');const _0x21ede8=await _0x41b9fc(_0x2286a1(0xff2)+_0x237b2f+'”',_0x2286a1(0x704),'',_0x2286a1(0x9ea));if(_0x21ede8===null)return;const _0x24b217=_0x589066(_0x519904,_0x16699d[_0x2286a1(0x66e)]['nickname']),_0x4b0b8f=_0x24b217+_0x2286a1(0x57d)+_0x237b2f+'”\x20'+_0x21ede8[_0x2286a1(0x2a8)](),_0x4a148c={'role':_0x2286a1(0x11af),'type':'pat_message','content':_0x4b0b8f,'timestamp':Date[_0x2286a1(0x1386)]()};_0x519904[_0x2286a1(0xb07)][_0x2286a1(0x1001)](_0x4a148c);const _0x4b1dd8='[系统提示：用户（'+_0x24b217+_0x2286a1(0x7e8)+_0x289d6f+'）'+_0x21ede8['trim']()+_0x2286a1(0x74e),_0x523105={'role':'system','content':_0x4b1dd8,'timestamp':Date['now']()+0x1,'isHidden':!![]};_0x519904['history'][_0x2286a1(0x1001)](_0x523105),await _0x6ed281[_0x2286a1(0x1474)][_0x2286a1(0x90c)](_0x519904),_0x16699d[_0x2286a1(0xf5a)]===_0x1f3f3d&&_0x4b384e(_0x4a148c,_0x519904),await _0x2d33eb();}let _0x8c93e4=null,_0x510843=![],_0x4eda35=new Set();function _0x4ba9ed(_0x1f977c){const _0x3a436f=_0x3ce1fb;_0x8c93e4=_0x1f977c,document[_0x3a436f(0x948)]('call-message-actions-modal')[_0x3a436f(0xd54)]['add'](_0x3a436f(0xfcb));}function _0x2120e6(){const _0x48a465=_0x3ce1fb;document[_0x48a465(0x948)](_0x48a465(0x593))[_0x48a465(0xd54)][_0x48a465(0xf89)](_0x48a465(0xfcb)),_0x8c93e4=null;}async function _0x1b0dde(){const _0x10324f=_0x3ce1fb;if(!_0x8c93e4)return;const _0x164e0c=_0x8c93e4,_0x47b0a2=_0x1c6d6b[_0x10324f(0xff6)][_0x10324f(0x1402)](_0x477da0=>_0x477da0[_0x10324f(0xb0a)]===_0x164e0c);if(!_0x47b0a2)return;_0x2120e6();let _0xbee328=_0x47b0a2['content'];if(_0x1c6d6b[_0x10324f(0x658)]&&_0x47b0a2[_0x10324f(0x1554)]==='assistant'){const _0x4b254e=_0x47b0a2[_0x10324f(0xede)]['split'](':\x20');_0x4b254e['length']>0x1&&(_0xbee328=_0x4b254e[_0x10324f(0x200)](0x1)[_0x10324f(0x121a)](':\x20'));}const _0x48ab7b=await _0x41b9fc('编辑通话消息','在此修改内容...',_0xbee328,_0x10324f(0xc1e));_0x48ab7b!==null&&await _0x2eefbf(_0x164e0c,_0x48ab7b);}async function _0x2eefbf(_0x2d0734,_0x12d56c){const _0x38363d=_0x3ce1fb,_0x523165=_0x1c6d6b['callHistory'][_0x38363d(0x1402)](_0x2ea783=>_0x2ea783[_0x38363d(0xb0a)]===_0x2d0734);if(_0x523165){let _0x112429=_0x12d56c;if(_0x1c6d6b[_0x38363d(0x658)]&&_0x523165[_0x38363d(0x1554)]===_0x38363d(0x14c8)){const _0x18cd8c=_0x523165[_0x38363d(0xede)][_0x38363d(0x46f)](':\x20'),_0x544806=_0x18cd8c[0x0];_0x112429=_0x544806+':\x20'+_0x12d56c;}_0x523165[_0x38363d(0xede)]=_0x112429;const _0x1c64c0=document[_0x38363d(0xfeb)](_0x38363d(0x8aa)+_0x2d0734+'\x22]');if(_0x1c64c0){if(_0x1c6d6b[_0x38363d(0x658)]&&_0x523165[_0x38363d(0x1554)]===_0x38363d(0x14c8)){const _0x2b80df=_0x523165[_0x38363d(0xede)][_0x38363d(0x46f)](':\x20'),_0xd7c8e8=_0x2b80df[0x0];_0x1c64c0[_0x38363d(0xb6f)]=_0x38363d(0x7f2)+_0xd7c8e8+':</strong>\x20'+_0x12d56c;}else _0x1c64c0['textContent']=_0x12d56c;}}await _0x104485('成功',_0x38363d(0x1208));}async function _0x21d09e(){const _0x282750=_0x3ce1fb;if(!_0x8c93e4)return;const _0x5ee51b=await _0xa6b74a('删除消息',_0x282750(0xd95),{'confirmButtonClass':'btn-danger'});if(_0x5ee51b){const _0x53ab58=_0x8c93e4;_0x2120e6();const _0xd3438d=_0x1c6d6b[_0x282750(0xff6)][_0x282750(0x1018)](_0x5edd86=>_0x5edd86[_0x282750(0xb0a)]===_0x53ab58);_0xd3438d>-0x1&&_0x1c6d6b[_0x282750(0xff6)][_0x282750(0x36d)](_0xd3438d,0x1);const _0x575232=document[_0x282750(0xfeb)]('.call-message-bubble[data-timestamp=\x22'+_0x53ab58+'\x22]');_0x575232&&_0x575232[_0x282750(0xf89)]();}else _0x2120e6();}function _0x37a552(_0x119edf){const _0x4aaec7=_0x3ce1fb;_0x1019c7=_0x119edf;const _0x111c01=_0x16699d[_0x4aaec7(0x1474)][_0x16699d[_0x4aaec7(0xf5a)]],_0x111531=_0x111c01[_0x4aaec7(0xb07)][_0x4aaec7(0x1402)](_0x190889=>_0x190889[_0x4aaec7(0xb0a)]===_0x119edf);_0x111531&&(document['getElementById'](_0x4aaec7(0x1ff))[_0x4aaec7(0x10cb)]=_0x111531[_0x4aaec7(0x14ee)]),document[_0x4aaec7(0x948)](_0x4aaec7(0x14fa))[_0x4aaec7(0xd54)][_0x4aaec7(0xbd0)]('visible');}function _0x52a80f(){const _0x12fef4=_0x3ce1fb;document[_0x12fef4(0x948)](_0x12fef4(0x14fa))['classList']['remove'](_0x12fef4(0xfcb)),_0x1019c7=null;}async function _0xfd429(_0x3fa15c){const _0x216cf1=_0x3ce1fb;if(!_0x1019c7)return;const _0x1d05a2=_0x1019c7,_0x15a7af=_0x16699d[_0x216cf1(0x1474)][_0x16699d[_0x216cf1(0xf5a)]],_0x4bbd0a=_0x15a7af[_0x216cf1(0xb07)]['findIndex'](_0x453383=>_0x453383[_0x216cf1(0xb0a)]===_0x1d05a2);if(_0x4bbd0a===-0x1)return;const _0x437deb=_0x15a7af[_0x216cf1(0xb07)][_0x4bbd0a];_0x437deb['status']=_0x3fa15c;let _0x50e43c;if(_0x3fa15c===_0x216cf1(0x777)){const _0x45b511={'role':'user','type':'transfer','isRefund':!![],'amount':_0x437deb['amount'],'note':_0x216cf1(0x31c),'timestamp':Date[_0x216cf1(0x1386)]()};_0x15a7af[_0x216cf1(0xb07)][_0x216cf1(0x1001)](_0x45b511),_0x50e43c=_0x216cf1(0x135d)+_0x437deb[_0x216cf1(0x14ee)]+_0x216cf1(0x1df);}else _0x50e43c='[系统提示：你接受了“'+_0x437deb['senderName']+'”的转账。]';const _0x38abfb={'role':_0x216cf1(0x11af),'content':_0x50e43c,'timestamp':Date['now']()+0x1,'isHidden':!![]};_0x15a7af[_0x216cf1(0xb07)][_0x216cf1(0x1001)](_0x38abfb),await _0x6ed281['chats'][_0x216cf1(0x90c)](_0x15a7af),_0x52a80f(),_0x455873(_0x16699d['activeChatId']),_0x2d33eb();}function _0x16e9a0(_0x40a870){const _0x5a123e=_0x3ce1fb;_0x4a0ce7=null;if(_0x40a870){const _0x5d6723=_0x40a870[_0x5a123e(0xfeb)](_0x5a123e(0x853));_0x5d6723&&(_0x5d6723[_0x5a123e(0x440)]=_0x5a123e(0xda6));}}async function _0x568e51(){const _0x4d2f7b=_0x3ce1fb,_0x4bd0e0=document[_0x4d2f7b(0x948)](_0x4d2f7b(0xd02));_0x4bd0e0[_0x4d2f7b(0xb6f)]='';const _0x473be7=await _0x6ed281['memories'][_0x4d2f7b(0x1088)]('timestamp')[_0x4d2f7b(0xb26)]()[_0x4d2f7b(0x443)]();if(_0x473be7[_0x4d2f7b(0xaf9)]===0x0){_0x4bd0e0[_0x4d2f7b(0xb6f)]=_0x4d2f7b(0x10cf);return;}_0x473be7['sort']((_0x440883,_0x218f76)=>{const _0x478739=_0x4d2f7b,_0x180f2a=_0x440883[_0x478739(0x4ae)]==='countdown'&&_0x440883['targetDate']>Date[_0x478739(0x1386)](),_0x1d9fc7=_0x218f76[_0x478739(0x4ae)]===_0x478739(0xa6b)&&_0x218f76[_0x478739(0xb78)]>Date['now']();if(_0x180f2a&&!_0x1d9fc7)return-0x1;if(!_0x180f2a&&_0x1d9fc7)return 0x1;if(_0x180f2a&&_0x1d9fc7)return _0x440883[_0x478739(0xb78)]-_0x218f76['targetDate'];return 0x0;}),_0x473be7['forEach'](_0x10715e=>{const _0x256a9a=_0x4d2f7b;let _0x4c957e;_0x10715e['type']==='countdown'&&_0x10715e['targetDate']>Date[_0x256a9a(0x1386)]()?_0x4c957e=_0x3f0f64(_0x10715e):_0x4c957e=_0x79f429(_0x10715e),_0x4bd0e0[_0x256a9a(0x6b6)](_0x4c957e);}),_0x4f6373();}function _0x79f429(_0x4f1ff7){const _0x2868f1=_0x3ce1fb,_0x38c331=document[_0x2868f1(0x1497)](_0x2868f1(0x379));_0x38c331[_0x2868f1(0x35b)]=_0x2868f1(0x540);const _0x3a946c=new Date(_0x4f1ff7['timestamp']),_0x4f47b2=_0x3a946c[_0x2868f1(0x3c5)]()+'-'+String(_0x3a946c[_0x2868f1(0x12f9)]()+0x1)[_0x2868f1(0x112d)](0x2,'0')+'-'+String(_0x3a946c[_0x2868f1(0x13fb)]())['padStart'](0x2,'0')+'\x20'+String(_0x3a946c[_0x2868f1(0x12c1)]())[_0x2868f1(0x112d)](0x2,'0')+':'+String(_0x3a946c['getMinutes']())[_0x2868f1(0x112d)](0x2,'0');let _0x30c341,_0x2451df;if(_0x4f1ff7['type']===_0x2868f1(0xa6b)&&_0x4f1ff7[_0x2868f1(0xb78)])_0x30c341=_0x2868f1(0x854)+_0x4f1ff7[_0x2868f1(0xe79)],_0x2451df=_0x5876e7('在\x20'+new Date(_0x4f1ff7[_0x2868f1(0xb78)])[_0x2868f1(0xed3)]()+'，我们一起见证了这个约定。')[_0x2868f1(0x14e9)](/\n/g,_0x2868f1(0x1121));else{let _0x654259='我们的回忆';if(_0x4f1ff7['authorId']){const _0x5b22da=_0x16699d[_0x2868f1(0x1474)][_0x4f1ff7[_0x2868f1(0x11b9)]];_0x5b22da?_0x654259=_0x5b22da['name']:_0x654259=_0x4f1ff7[_0x2868f1(0x8bd)]||_0x2868f1(0x4cb);}else _0x4f1ff7[_0x2868f1(0x8bd)]&&(_0x654259=_0x4f1ff7[_0x2868f1(0x8bd)]);_0x30c341=_0x654259+_0x2868f1(0x4b2),_0x2451df=_0x5876e7(_0x4f1ff7[_0x2868f1(0xe79)]);}return _0x38c331[_0x2868f1(0xb6f)]=_0x2868f1(0x58d)+_0x4f47b2+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22author\x22>'+_0x30c341+_0x2868f1(0x725)+_0x2451df+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x159366(_0x38c331,async()=>{const _0x2a5b03=_0x2868f1,_0x296ad3=await _0xa6b74a(_0x2a5b03(0xe7c),_0x2a5b03(0x219),{'confirmButtonClass':_0x2a5b03(0x5e8)});_0x296ad3&&(await _0x6ed281[_0x2a5b03(0x9cc)][_0x2a5b03(0x869)](_0x4f1ff7['id']),_0x568e51());}),_0x38c331;}function _0x3f0f64(_0x4df424){const _0x31ab26=_0x3ce1fb,_0x1b1526=document[_0x31ab26(0x1497)]('div');_0x1b1526[_0x31ab26(0x35b)]=_0x31ab26(0xf3f);const _0x2d3974=new Date(_0x4df424['targetDate']),_0x2a307d=_0x2d3974['toLocaleString'](_0x31ab26(0x144f),{'dateStyle':'full','timeStyle':'short'});return _0x1b1526['innerHTML']=_0x31ab26(0x5ff)+_0x4df424[_0x31ab26(0xe79)]+_0x31ab26(0xda4)+_0x4df424['targetDate']+_0x31ab26(0x1407)+_0x2a307d+_0x31ab26(0xbd6),_0x159366(_0x1b1526,async()=>{const _0x4491b8=_0x31ab26,_0x3fd331=await _0xa6b74a(_0x4491b8(0xe72),'确定要删除这个约定吗？',{'confirmButtonClass':_0x4491b8(0x5e8)});_0x3fd331&&(await _0x6ed281['memories'][_0x4491b8(0x869)](_0x4df424['id']),_0x568e51());}),_0x1b1526;}let _0xa8deb7=[];function _0x4f6373(){const _0x170365=_0x3ce1fb;_0xa8deb7[_0x170365(0x427)](_0x228350=>clearInterval(_0x228350)),_0xa8deb7=[],document[_0x170365(0x1188)](_0x170365(0xbe9))[_0x170365(0x427)](_0x1b7879=>{const _0x2b5807=_0x170365,_0x55d9d6=parseInt(_0x1b7879[_0x2b5807(0x606)][_0x2b5807(0xb78)]);let _0x51db8a;const _0x46b1f2=()=>{const _0x1cee2c=_0x2b5807,_0x5a8a61=Date['now'](),_0x1f7779=_0x55d9d6-_0x5a8a61;if(_0x1f7779<0x0){_0x1b7879[_0x1cee2c(0x10cb)]=_0x1cee2c(0x111d),clearInterval(_0x51db8a),setTimeout(()=>_0x568e51(),0x7d0);return;}const _0x4e27e4=Math[_0x1cee2c(0x15b6)](_0x1f7779/(0x3e8*0x3c*0x3c*0x18)),_0x3b8faa=Math[_0x1cee2c(0x15b6)](_0x1f7779%(0x3e8*0x3c*0x3c*0x18)/(0x3e8*0x3c*0x3c)),_0x42f4cd=Math[_0x1cee2c(0x15b6)](_0x1f7779%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x2e7618=Math['floor'](_0x1f7779%(0x3e8*0x3c)/0x3e8);_0x1b7879[_0x1cee2c(0x10cb)]=_0x4e27e4+'天\x20'+_0x3b8faa+'时\x20'+_0x42f4cd+'分\x20'+_0x2e7618+'秒';};_0x46b1f2(),_0x51db8a=setInterval(_0x46b1f2,0x3e8),_0xa8deb7['push'](_0x51db8a);});}async function _0x530b7b(_0x1ec413){const _0x311121=_0x3ce1fb,_0x4b0d0c=_0x16699d[_0x311121(0x1474)][_0x1ec413];if(!_0x4b0d0c)return;await _0x104485(_0x311121(0x302),_0x311121(0xf10)+_0x4b0d0c['name']+_0x311121(0x143e));const {proxyUrl:_0x4d4f44,apiKey:_0xb5eec2,model:_0x5bd902}=_0x16699d[_0x311121(0x79e)];if(!_0x4d4f44||!_0xb5eec2||!_0x5bd902){await _0x104485('配置错误','API设置不完整，无法继续。');return;}const _0x494b92=_0x4b0d0c[_0x311121(0xb07)][_0x311121(0x200)](-0x5)['map'](_0x20dccd=>{const _0x5dc5d9=_0x311121,_0x4819a8=_0x20dccd['role']===_0x5dc5d9(0xaeb)?_0x4b0d0c[_0x5dc5d9(0x7fd)][_0x5dc5d9(0x1371)]||'我':_0x20dccd[_0x5dc5d9(0x14ee)]||_0x4b0d0c[_0x5dc5d9(0x1467)];return _0x4819a8+':\x20'+String(_0x20dccd[_0x5dc5d9(0xede)])[_0x5dc5d9(0xeca)](0x0,0x32)+_0x5dc5d9(0x76d);})[_0x311121(0x121a)]('\x0a');let _0x84188c='';if(_0x4b0d0c['settings'][_0x311121(0xeee)]&&_0x4b0d0c[_0x311121(0x7fd)][_0x311121(0xeee)][_0x311121(0xaf9)]>0x0){const _0x2cc5d0=_0x4b0d0c['settings']['linkedWorldBookIds'][_0x311121(0x8ff)](_0x52e739=>{const _0xce4c0c=_0x311121,_0x152370=_0x16699d[_0xce4c0c(0x44c)][_0xce4c0c(0x1402)](_0x135e57=>_0x135e57['id']===_0x52e739);if(!_0x152370||!Array[_0xce4c0c(0x1524)](_0x152370['content']))return'';const _0x201355=_0x152370[_0xce4c0c(0xede)]['map'](_0x4b5bac=>{const _0x10ae16=_0xce4c0c;let _0x4f745c=_0x10ae16(0x886)+(_0x4b5bac[_0x10ae16(0x282)]||_0x10ae16(0xae0))+'\x0a';return _0x4b5bac[_0x10ae16(0x1cf)][_0x10ae16(0xaf9)]>0x0&&(_0x4f745c+='**关键词:**\x20'+_0x4b5bac[_0x10ae16(0x1cf)][_0x10ae16(0x121a)](',\x20')+'\x0a'),_0x4f745c+='**内容:**\x0a'+_0x4b5bac[_0x10ae16(0xede)],_0x4f745c;})[_0xce4c0c(0x121a)]('\x0a');return _0x201355?_0xce4c0c(0x1067)+_0x152370[_0xce4c0c(0x1467)]+'\x0a'+_0x201355:'';})[_0x311121(0x1c0)](Boolean)['join']('');_0x2cc5d0&&(_0x84188c='\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a'+_0x2cc5d0+'\x0a');}const _0x208f4d=_0x311121(0x1077)+_0x4b0d0c[_0x311121(0x1467)]+'”。你之前被用户（你的聊天对象）拉黑了，你们已经有一段时间没有联系了。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，你非常希望能够和好，重新和用户聊天。请你仔细分析下面的“被拉黑前的对话摘要”，理解当时发生了什么，然后思考一个真诚的、符合你人设、并且【针对具体事件】的申请理由。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4b0d0c[_0x311121(0x7fd)]['aiPersona']+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x84188c+_0x311121(0xd00)+_0x494b92+_0x311121(0x10b2);try{const _0x15e6b0=[{'role':_0x311121(0x11af),'content':_0x208f4d},{'role':'user','content':'请根据以上设定开始你的决策。'}];let _0x49c5e1=_0x4d4f44===GEMINI_API_URL,_0x1911d9=_0xe8c788(_0x5bd902,_0xb5eec2,_0x208f4d,_0x15e6b0);const _0x3fef5a=_0x49c5e1?await fetch(_0x1911d9[_0x311121(0x9a8)],_0x1911d9[_0x311121(0x92a)]):await fetch(_0x4d4f44+_0x311121(0x110e),{'method':'POST','headers':{'Content-Type':_0x311121(0x479),'Authorization':_0x311121(0xb0e)+_0xb5eec2},'body':JSON['stringify']({'model':_0x5bd902,'messages':_0x15e6b0,'temperature':_0x16699d['globalSettings'][_0x311121(0x382)]||0.9})});if(!_0x3fef5a['ok']){const _0x31f6d1=await _0x3fef5a['json']();throw new Error('API\x20请求失败:\x20'+_0x3fef5a[_0x311121(0x82c)]+_0x311121(0x1182)+_0x31f6d1[_0x311121(0xc3e)][_0x311121(0x74b)]);}const _0xd0ecf6=await _0x3fef5a[_0x311121(0x21d)]();let _0x360932=_0x49c5e1?_0xd0ecf6[_0x311121(0x272)][0x0][_0x311121(0xede)][_0x311121(0x1305)][0x0][_0x311121(0x9ea)]:_0xd0ecf6[_0x311121(0xc11)][0x0][_0x311121(0x74b)][_0x311121(0xede)];_0x360932=_0x360932[_0x311121(0x14e9)](/^```json\s*/,'')[_0x311121(0x14e9)](/```$/,'');const _0x2754b1=_0x360932['trim'](),_0x17e664=JSON[_0x311121(0xde0)](_0x2754b1);_0x17e664[_0x311121(0xa54)]===_0x311121(0x1ba)&&_0x17e664[_0x311121(0xb5e)]?(_0x4b0d0c[_0x311121(0x1120)][_0x311121(0x82c)]=_0x311121(0x6a6),_0x4b0d0c[_0x311121(0x1120)][_0x311121(0x60f)]=_0x17e664[_0x311121(0xb5e)],_0x16699d['chats'][_0x1ec413]=_0x4b0d0c,_0x2d33eb(),await _0x104485(_0x311121(0xe7b),'“'+_0x4b0d0c[_0x311121(0x1467)]+'”已向你发送好友申请。请返回聊天列表查看。')):(await _0x104485(_0x311121(0xf58),'“'+_0x4b0d0c[_0x311121(0x1467)]+_0x311121(0xdfe)),_0x4b0d0c[_0x311121(0x1120)]['status']=_0x311121(0x1572),_0x4b0d0c[_0x311121(0x1120)][_0x311121(0xbab)]=Date[_0x311121(0x1386)]());}catch(_0x40ef98){await _0x104485(_0x311121(0x10d8),'为“'+_0x4b0d0c[_0x311121(0x1467)]+_0x311121(0xb14)+_0x40ef98[_0x311121(0x74b)]+'\x0a\x0a将重置冷静期。'),_0x4b0d0c['relationship'][_0x311121(0x82c)]='blocked_by_user',_0x4b0d0c['relationship'][_0x311121(0xbab)]=Date[_0x311121(0x1386)]();}finally{await _0x6ed281[_0x311121(0x1474)][_0x311121(0x90c)](_0x4b0d0c),_0x455873(_0x1ec413);}}function _0x2cd9d1(){const _0x5dd6ce=_0x3ce1fb;if(!_0x16699d[_0x5dd6ce(0xf5a)])return;const _0x47c1ed=_0x16699d[_0x5dd6ce(0x1474)][_0x16699d[_0x5dd6ce(0xf5a)]];_0x47c1ed[_0x5dd6ce(0x1173)]?_0x2cf0fb():document[_0x5dd6ce(0x948)](_0x5dd6ce(0x1277))['classList']['add']('visible');}function _0x2cf0fb(){const _0x20be3b=_0x3ce1fb,_0x17b5c5=document[_0x20be3b(0x948)](_0x20be3b(0x8c1)),_0x3c25cb=_0x16699d[_0x20be3b(0x1474)][_0x16699d[_0x20be3b(0xf5a)]];document[_0x20be3b(0x948)](_0x20be3b(0xcb2))[_0x20be3b(0x5bc)]='',document[_0x20be3b(0x948)]('rp-group-count')['value']='',document[_0x20be3b(0x948)](_0x20be3b(0x15a6))['value']='',document['getElementById']('rp-direct-amount')['value']='',document[_0x20be3b(0x948)](_0x20be3b(0x1352))['value']='',document[_0x20be3b(0x948)](_0x20be3b(0x602))['textContent']=_0x20be3b(0xf25),document['getElementById'](_0x20be3b(0x5c7))['textContent']=_0x20be3b(0xf25);const _0x579fc1=document['getElementById']('rp-direct-receiver');_0x579fc1[_0x20be3b(0xb6f)]='',_0x3c25cb[_0x20be3b(0x10a2)]['forEach'](_0x4703ce=>{const _0x5cd142=_0x20be3b,_0x195e87=document[_0x5cd142(0x1497)](_0x5cd142(0x152c));_0x195e87[_0x5cd142(0x5bc)]=_0x4703ce[_0x5cd142(0x628)],_0x195e87[_0x5cd142(0x10cb)]=_0x4703ce[_0x5cd142(0x347)],_0x579fc1['appendChild'](_0x195e87);}),document[_0x20be3b(0x948)](_0x20be3b(0x333))[_0x20be3b(0x4f6)](),_0x17b5c5[_0x20be3b(0xd54)][_0x20be3b(0xbd0)]('visible');}async function _0x3762e2(){const _0x405b33=_0x3ce1fb,_0x303749=_0x16699d[_0x405b33(0x1474)][_0x16699d[_0x405b33(0xf5a)]],_0x44e8c9=parseFloat(document[_0x405b33(0x948)](_0x405b33(0xcb2))[_0x405b33(0x5bc)]),_0xb46cf=parseInt(document[_0x405b33(0x948)](_0x405b33(0x1216))[_0x405b33(0x5bc)]),_0x310609=document['getElementById'](_0x405b33(0x15a6))[_0x405b33(0x5bc)]['trim']();if(isNaN(_0x44e8c9)||_0x44e8c9<=0x0){alert(_0x405b33(0x59b));return;}if(isNaN(_0xb46cf)||_0xb46cf<=0x0){alert(_0x405b33(0x1074));return;}if(_0x44e8c9/_0xb46cf<0.01){alert('单个红包金额不能少于0.01元！');return;}const _0x1933e2=_0x303749[_0x405b33(0x7fd)][_0x405b33(0x1371)]||'我',_0x301f54={'role':_0x405b33(0xaeb),'senderName':_0x1933e2,'type':_0x405b33(0x148f),'packetType':_0x405b33(0x3c9),'timestamp':Date['now'](),'totalAmount':_0x44e8c9,'count':_0xb46cf,'greeting':_0x310609||'恭喜发财，大吉大利！','claimedBy':{},'isFullyClaimed':![]};_0x303749['history']['push'](_0x301f54),await _0x6ed281[_0x405b33(0x1474)][_0x405b33(0x90c)](_0x303749),_0x4b384e(_0x301f54,_0x303749),_0x2d33eb(),document['getElementById'](_0x405b33(0x8c1))[_0x405b33(0xd54)][_0x405b33(0xf89)](_0x405b33(0xfcb));}async function _0x394166(){const _0x2f6a48=_0x3ce1fb,_0x1b6e6d=_0x16699d[_0x2f6a48(0x1474)][_0x16699d[_0x2f6a48(0xf5a)]],_0x304684=parseFloat(document['getElementById'](_0x2f6a48(0x1138))[_0x2f6a48(0x5bc)]),_0x30fb59=document[_0x2f6a48(0x948)]('rp-direct-receiver')['value'],_0x1942d6=document[_0x2f6a48(0x948)](_0x2f6a48(0x1352))['value'][_0x2f6a48(0x2a8)]();if(isNaN(_0x304684)||_0x304684<=0x0){alert(_0x2f6a48(0x87f));return;}if(!_0x30fb59){alert('请选择一个接收人！');return;}const _0x26cdde=_0x1b6e6d[_0x2f6a48(0x7fd)]['myNickname']||'我',_0x4b5693={'role':'user','senderName':_0x26cdde,'type':'red_packet','packetType':_0x2f6a48(0x3ec),'timestamp':Date[_0x2f6a48(0x1386)](),'totalAmount':_0x304684,'count':0x1,'greeting':_0x1942d6||_0x2f6a48(0xd8d),'receiverName':_0x30fb59,'claimedBy':{},'isFullyClaimed':![]};_0x1b6e6d[_0x2f6a48(0xb07)][_0x2f6a48(0x1001)](_0x4b5693),await _0x6ed281['chats'][_0x2f6a48(0x90c)](_0x1b6e6d),_0x4b384e(_0x4b5693,_0x1b6e6d),_0x2d33eb(),document[_0x2f6a48(0x948)](_0x2f6a48(0x8c1))[_0x2f6a48(0xd54)][_0x2f6a48(0xf89)](_0x2f6a48(0xfcb));}async function _0xf9f4c(_0x48a990){const _0x595abb=_0x3ce1fb,_0x3649fa=_0x16699d[_0x595abb(0xf5a)],_0x5eb29e=await _0x6ed281[_0x595abb(0x1474)]['get'](_0x3649fa);if(!_0x5eb29e)return;_0x16699d[_0x595abb(0x1474)][_0x3649fa]=_0x5eb29e;const _0x3aba76=_0x5eb29e['history'][_0x595abb(0x1402)](_0x2cd07d=>_0x2cd07d[_0x595abb(0xb0a)]===_0x48a990);if(!_0x3aba76)return;const _0xbe0ec7=_0x16699d['qzoneSettings'][_0x595abb(0xf4d)]||_0x595abb(0x1347),_0x199b4e=_0x3aba76[_0x595abb(0x764)]&&_0x3aba76['claimedBy'][_0xbe0ec7];if(_0x3aba76[_0x595abb(0x7f7)]===_0x595abb(0x3ec)&&_0x3aba76['receiverName']!==_0xbe0ec7&&Object[_0x595abb(0x1cf)](_0x3aba76[_0x595abb(0x764)])[_0x595abb(0xaf9)]>0x0||_0x3aba76[_0x595abb(0x134a)]||_0x199b4e){_0x5a178d(_0x3aba76);return;}const _0x35f6b3=await _0x1aa40f(_0x3aba76);_0x35f6b3!==null&&(await _0x455873(_0x3649fa),await _0x104485(_0x595abb(0x926),_0x595abb(0x126f)+_0x589066(_0x5eb29e,_0x3aba76['senderName'])+'\x20的红包，金额为\x20'+_0x35f6b3['toFixed'](0x2)+'\x20元。'));const _0x3bf90e=_0x16699d[_0x595abb(0x1474)][_0x3649fa][_0x595abb(0xb07)][_0x595abb(0x1402)](_0x5ca3f9=>_0x5ca3f9[_0x595abb(0xb0a)]===_0x48a990);_0x3bf90e&&_0x5a178d(_0x3bf90e);}async function _0x1aa40f(_0x299444){const _0x38f530=_0x3ce1fb,_0x5dc8bb=_0x16699d[_0x38f530(0x1474)][_0x16699d[_0x38f530(0xf5a)]];let _0xcb962b=Date[_0x38f530(0x1386)]();const _0x356014=_0x16699d[_0x38f530(0x66e)][_0x38f530(0xf4d)]||'{{user}}',_0x5ad02e=_0x299444[_0x38f530(0x12db)]-Object[_0x38f530(0x1cf)](_0x299444[_0x38f530(0x764)]||{})['length'];if(_0x5ad02e<=0x0)return _0x299444[_0x38f530(0x134a)]=!![],await _0x6ed281[_0x38f530(0x1474)][_0x38f530(0x90c)](_0x5dc8bb),await _0x104485(_0x38f530(0x11eb),_0x38f530(0x738)),null;let _0x3d09e7=0x0;const _0x51a352=_0x299444['totalAmount']-Object[_0x38f530(0x1166)](_0x299444[_0x38f530(0x764)]||{})['reduce']((_0xc4e936,_0x972fbe)=>_0xc4e936+_0x972fbe,0x0);if(_0x299444[_0x38f530(0x7f7)]===_0x38f530(0x3c9)){if(_0x5ad02e===0x1)_0x3d09e7=_0x51a352;else{const _0x38a059=0.01,_0x448882=_0x51a352-(_0x5ad02e-0x1)*_0x38a059;_0x3d09e7=Math[_0x38f530(0x59c)]()*(_0x448882-_0x38a059)+_0x38a059;}}else _0x3d09e7=_0x299444[_0x38f530(0x421)];_0x3d09e7=parseFloat(_0x3d09e7[_0x38f530(0xd69)](0x2));if(!_0x299444[_0x38f530(0x764)])_0x299444[_0x38f530(0x764)]={};_0x299444['claimedBy'][_0x356014]=_0x3d09e7;const _0x4069ee=Object[_0x38f530(0x1cf)](_0x299444[_0x38f530(0x764)])[_0x38f530(0xaf9)]>=_0x299444['count'];_0x4069ee&&(_0x299444[_0x38f530(0x134a)]=!![]);const _0x499bb9=_0x589066(_0x5dc8bb,_0x356014),_0x36a846=_0x589066(_0x5dc8bb,_0x299444[_0x38f530(0x14ee)]),_0x27dde9={'role':_0x38f530(0x11af),'type':_0x38f530(0xb96),'content':_0x38f530(0x126f)+_0x36a846+_0x38f530(0xb48),'timestamp':_0xcb962b++};_0x5dc8bb[_0x38f530(0xb07)]['push'](_0x27dde9);let _0x2ae663;if(_0x4069ee){const _0x495f86={'role':_0x38f530(0x11af),'type':_0x38f530(0xb96),'content':_0x36a846+'\x20的红包已被领完','timestamp':_0xcb962b++};_0x5dc8bb[_0x38f530(0xb07)][_0x38f530(0x1001)](_0x495f86);let _0x382876={'name':'','amount':-0x1};_0x299444[_0x38f530(0x7f7)]===_0x38f530(0x3c9)&&_0x299444[_0x38f530(0x12db)]>0x1&&Object[_0x38f530(0x6ea)](_0x299444[_0x38f530(0x764)])['forEach'](([_0x3e44bc,_0x4c074d])=>{const _0x32695d=_0x38f530;_0x4c074d>_0x382876[_0x32695d(0xbd2)]&&(_0x382876={'name':_0x3e44bc,'amount':_0x4c074d});});const _0x359bc3=_0x382876[_0x38f530(0x1467)]?_0x589066(_0x5dc8bb,_0x382876[_0x38f530(0x1467)]):'无';_0x2ae663='[系统提示：用户\x20('+_0x499bb9+_0x38f530(0x9bd)+_0x359bc3+_0x38f530(0xb2b);}else _0x2ae663=_0x38f530(0x53e)+_0x499bb9+')\x20刚刚领取了红包\x20(时间戳:\x20'+_0x299444[_0x38f530(0xb0a)]+')。红包还未领完，你现在可以使用\x20\x27open_red_packet\x27\x20指令来尝试领取。]';const _0x5e65e1={'role':'system','content':_0x2ae663,'timestamp':_0xcb962b++,'isHidden':!![]};return _0x5dc8bb[_0x38f530(0xb07)]['push'](_0x5e65e1),await _0x6ed281[_0x38f530(0x1474)][_0x38f530(0x90c)](_0x5dc8bb),_0x3d09e7;}async function _0x5a178d(_0x15cd04){const _0x1ff042=_0x3ce1fb;if(!_0x15cd04){console['error']('showRedPacketDetails收到了无效的packet对象');return;}const _0x4c49aa=_0x16699d[_0x1ff042(0x1474)][_0x16699d[_0x1ff042(0xf5a)]];if(!_0x4c49aa)return;const _0x4e74b6=document[_0x1ff042(0x948)](_0x1ff042(0x83e)),_0x2ac89d=_0x16699d[_0x1ff042(0x66e)]['nickname']||_0x1ff042(0x1347),_0x358ea7=_0x589066(_0x4c49aa,_0x15cd04[_0x1ff042(0x14ee)]);document[_0x1ff042(0x948)](_0x1ff042(0x36e))[_0x1ff042(0x10cb)]=_0x358ea7,document[_0x1ff042(0x948)](_0x1ff042(0x1585))[_0x1ff042(0x10cb)]=_0x15cd04[_0x1ff042(0x14b0)]||'恭喜发财，大吉大利！';const _0x234450=document[_0x1ff042(0x948)](_0x1ff042(0xe2d));_0x15cd04[_0x1ff042(0x764)]&&_0x15cd04[_0x1ff042(0x764)][_0x2ac89d]?(_0x234450[_0x1ff042(0xfeb)](_0x1ff042(0x8c6))[_0x1ff042(0x10cb)]=_0x15cd04[_0x1ff042(0x764)][_0x2ac89d][_0x1ff042(0xd69)](0x2),_0x234450[_0x1ff042(0xf74)][_0x1ff042(0x11fd)]='block'):_0x234450[_0x1ff042(0xf74)][_0x1ff042(0x11fd)]='none';const _0x52cb6c=Object['keys'](_0x15cd04[_0x1ff042(0x764)]||{})[_0x1ff042(0xaf9)],_0xb24319=Object[_0x1ff042(0x1166)](_0x15cd04['claimedBy']||{})['reduce']((_0x3e46cb,_0x2ebb05)=>_0x3e46cb+_0x2ebb05,0x0);let _0x47c85d=_0x52cb6c+'/'+_0x15cd04[_0x1ff042(0x12db)]+_0x1ff042(0xb8b)+_0xb24319[_0x1ff042(0xd69)](0x2)+'/'+_0x15cd04[_0x1ff042(0x421)][_0x1ff042(0xd69)](0x2)+'元。';if(!_0x15cd04[_0x1ff042(0x134a)]&&_0x52cb6c<_0x15cd04[_0x1ff042(0x12db)]){const _0x434090=Math[_0x1ff042(0x15b6)]((_0x15cd04[_0x1ff042(0xb0a)]+0x18*0x3c*0x3c*0x3e8-Date[_0x1ff042(0x1386)]())/(0x3e8*0x3c*0x3c));if(_0x434090>0x0)_0x47c85d+=_0x1ff042(0x649)+_0x434090+'小时内退还。';}document['getElementById'](_0x1ff042(0x29d))[_0x1ff042(0x10cb)]=_0x47c85d;const _0x1a48fd=document['getElementById'](_0x1ff042(0xfa1));_0x1a48fd['innerHTML']='';const _0xebbf45=Object[_0x1ff042(0x6ea)](_0x15cd04[_0x1ff042(0x764)]||{});let _0x574398={'name':'','amount':-0x1};_0x15cd04['packetType']==='lucky'&&_0x15cd04[_0x1ff042(0x134a)]&&_0xebbf45[_0x1ff042(0xaf9)]>0x1&&_0xebbf45[_0x1ff042(0x427)](([_0x3443f0,_0x56a1fa])=>{const _0x211cc0=_0x1ff042;_0x56a1fa>_0x574398[_0x211cc0(0xbd2)]&&(_0x574398={'name':_0x3443f0,'amount':_0x56a1fa});}),_0xebbf45[_0x1ff042(0xe96)]((_0x31592f,_0x1db47a)=>_0x1db47a[0x1]-_0x31592f[0x1]),_0xebbf45[_0x1ff042(0x427)](([_0x57464b,_0x83a86c])=>{const _0xc19059=_0x1ff042,_0x3e8b46=document[_0xc19059(0x1497)](_0xc19059(0x379));_0x3e8b46[_0xc19059(0x35b)]=_0xc19059(0x81a);let _0x31d615='';_0x574398['name']&&_0x57464b===_0x574398[_0xc19059(0x1467)]&&(_0x31d615=_0xc19059(0xdaa));const _0x150ac6=_0x589066(_0x4c49aa,_0x57464b);_0x3e8b46['innerHTML']=_0xc19059(0x457)+_0x150ac6+_0xc19059(0x1209)+_0x83a86c['toFixed'](0x2)+'\x20元</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x31d615+_0xc19059(0x1009),_0x1a48fd['appendChild'](_0x3e8b46);}),_0x4e74b6[_0x1ff042(0xd54)][_0x1ff042(0xbd0)]('visible');}document[_0x3ce1fb(0x948)](_0x3ce1fb(0x54f))[_0x3ce1fb(0x339)](_0x3ce1fb(0x4f6),()=>{const _0x4ef45c=_0x3ce1fb;document[_0x4ef45c(0x948)](_0x4ef45c(0x83e))[_0x4ef45c(0xd54)][_0x4ef45c(0xf89)]('visible');}),window[_0x3ce1fb(0x10ea)]=_0xf9f4c;function _0x3fd256(){const _0xc28919=_0x3ce1fb,_0x2aa544=document[_0xc28919(0x948)]('create-poll-modal');document[_0xc28919(0x948)](_0xc28919(0x1178))['value']='';const _0x47d2c1=document['getElementById'](_0xc28919(0x1e4));_0x47d2c1[_0xc28919(0xb6f)]='',_0x1ffc42(),_0x1ffc42(),_0x2aa544[_0xc28919(0xd54)][_0xc28919(0xbd0)](_0xc28919(0xfcb));}function _0x1ffc42(){const _0x29c18e=_0x3ce1fb,_0x1e4b39=document['getElementById'](_0x29c18e(0x1e4)),_0x148e70=document['createElement'](_0x29c18e(0x379));_0x148e70[_0x29c18e(0x35b)]='poll-option-input-wrapper',_0x148e70[_0x29c18e(0xb6f)]=_0x29c18e(0x354),_0x148e70['querySelector'](_0x29c18e(0xc52))[_0x29c18e(0x339)](_0x29c18e(0x4f6),()=>{const _0x17b50e=_0x29c18e;_0x1e4b39[_0x17b50e(0x87a)][_0x17b50e(0xaf9)]>0x2?_0x148e70['remove']():alert('投票至少需要2个选项。');}),_0x1e4b39[_0x29c18e(0x6b6)](_0x148e70);}async function _0x35435c(){const _0x1feb2d=_0x3ce1fb;if(!_0x16699d['activeChatId'])return;const _0x494a91=document[_0x1feb2d(0x948)](_0x1feb2d(0x1178))[_0x1feb2d(0x5bc)]['trim']();if(!_0x494a91){alert(_0x1feb2d(0xd31));return;}const _0x56aa42=Array[_0x1feb2d(0x6e5)](document['querySelectorAll'](_0x1feb2d(0xf34)))[_0x1feb2d(0x8ff)](_0x3388b4=>_0x3388b4[_0x1feb2d(0x5bc)][_0x1feb2d(0x2a8)]())[_0x1feb2d(0x1c0)](_0x4dcc5e=>_0x4dcc5e);if(_0x56aa42[_0x1feb2d(0xaf9)]<0x2){alert(_0x1feb2d(0x310));return;}const _0x30f034=_0x16699d[_0x1feb2d(0x1474)][_0x16699d[_0x1feb2d(0xf5a)]],_0xed0900=_0x30f034[_0x1feb2d(0x1173)]?_0x30f034['settings'][_0x1feb2d(0x1371)]||'我':'我',_0x3b6ac7={'role':'user','senderName':_0xed0900,'type':'poll','timestamp':Date[_0x1feb2d(0x1386)](),'question':_0x494a91,'options':_0x56aa42,'votes':{},'isClosed':![]};_0x30f034[_0x1feb2d(0xb07)][_0x1feb2d(0x1001)](_0x3b6ac7),await _0x6ed281[_0x1feb2d(0x1474)][_0x1feb2d(0x90c)](_0x30f034),_0x4b384e(_0x3b6ac7,_0x30f034),_0x2d33eb(),document['getElementById'](_0x1feb2d(0x5e4))[_0x1feb2d(0xd54)][_0x1feb2d(0xf89)](_0x1feb2d(0xfcb));}async function _0x25e0cd(_0x5f4e5e,_0x1f2018){const _0x399fc6=_0x3ce1fb,_0x95c6c8=_0x16699d[_0x399fc6(0x1474)][_0x16699d['activeChatId']],_0x2d438f=_0x95c6c8[_0x399fc6(0xb07)][_0x399fc6(0x1402)](_0x38f17e=>_0x38f17e[_0x399fc6(0xb0a)]===_0x5f4e5e),_0x4468cb=_0x95c6c8[_0x399fc6(0x1173)]?_0x95c6c8[_0x399fc6(0x7fd)][_0x399fc6(0x1371)]||'我':'我';if(!_0x2d438f||_0x2d438f[_0x399fc6(0x30f)]){_0x2d438f&&_0x2d438f[_0x399fc6(0x30f)]&&_0x382238(_0x5f4e5e);return;}const _0xd5fef0=_0x2d438f[_0x399fc6(0xb0b)][_0x1f2018]&&_0x2d438f[_0x399fc6(0xb0b)][_0x1f2018][_0x399fc6(0x1336)](_0x4468cb);if(!_0xd5fef0){for(const _0x2cae66 in _0x2d438f[_0x399fc6(0xb0b)]){const _0x4de719=_0x2d438f['votes'][_0x2cae66]['indexOf'](_0x4468cb);_0x4de719>-0x1&&_0x2d438f[_0x399fc6(0xb0b)][_0x2cae66][_0x399fc6(0x36d)](_0x4de719,0x1);}!_0x2d438f[_0x399fc6(0xb0b)][_0x1f2018]&&(_0x2d438f['votes'][_0x1f2018]=[]),_0x2d438f[_0x399fc6(0xb0b)][_0x1f2018][_0x399fc6(0x1001)](_0x4468cb);}let _0x4504c2=null;!_0xd5fef0&&(_0x4504c2=_0x399fc6(0x53e)+_0x4468cb+_0x399fc6(0x13b1)+_0x1f2018+'”。]');if(_0x4504c2){const _0xb5a079={'role':_0x399fc6(0x11af),'content':_0x4504c2,'timestamp':Date[_0x399fc6(0x1386)](),'isHidden':!![]};_0x95c6c8['history'][_0x399fc6(0x1001)](_0xb5a079);}await _0x6ed281['chats']['put'](_0x95c6c8),_0x455873(_0x16699d[_0x399fc6(0xf5a)]);}async function _0x1467a3(_0x4a9bf6){const _0x1e3423=_0x3ce1fb,_0x3d1197=_0x16699d[_0x1e3423(0x1474)][_0x16699d[_0x1e3423(0xf5a)]],_0x577ef8=_0x3d1197[_0x1e3423(0xb07)][_0x1e3423(0x1402)](_0x426832=>_0x426832['timestamp']===_0x4a9bf6);if(!_0x577ef8||_0x577ef8[_0x1e3423(0x30f)])return;const _0x230f5a=await _0xa6b74a(_0x1e3423(0x2ae),_0x1e3423(0xbff));if(_0x230f5a){_0x577ef8['isClosed']=!![];const _0x5102b1=_0x577ef8[_0x1e3423(0x5ae)][_0x1e3423(0x8ff)](_0x32ec13=>'“'+_0x32ec13+'”('+(_0x577ef8['votes'][_0x32ec13]?.[_0x1e3423(0xaf9)]||0x0)+'票)')[_0x1e3423(0x121a)]('，'),_0x1273aa='[系统提示：用户手动结束了投票！最终结果为：'+_0x5102b1+'。]',_0x1bd345={'role':'system','content':_0x1273aa,'timestamp':Date[_0x1e3423(0x1386)](),'isHidden':!![]};_0x3d1197[_0x1e3423(0xb07)][_0x1e3423(0x1001)](_0x1bd345),await _0x6ed281[_0x1e3423(0x1474)][_0x1e3423(0x90c)](_0x3d1197),_0x455873(_0x16699d['activeChatId']);}}function _0x382238(_0x1b1de4){const _0x43ef5c=_0x3ce1fb,_0x267520=_0x16699d[_0x43ef5c(0x1474)][_0x16699d[_0x43ef5c(0xf5a)]],_0x3a6b57=_0x267520[_0x43ef5c(0xb07)]['find'](_0x11982d=>_0x11982d[_0x43ef5c(0xb0a)]===_0x1b1de4);if(!_0x3a6b57||!_0x3a6b57[_0x43ef5c(0x30f)])return;let _0x105bda=_0x43ef5c(0x73d)+_0x3a6b57[_0x43ef5c(0xa9f)]+_0x43ef5c(0x1528);Object[_0x43ef5c(0x1cf)](_0x3a6b57[_0x43ef5c(0xb0b)])[_0x43ef5c(0xaf9)]===0x0?_0x105bda+=_0x43ef5c(0x241):_0x3a6b57[_0x43ef5c(0x5ae)][_0x43ef5c(0x427)](_0x4aeb9b=>{const _0x51eac=_0x43ef5c,_0x24652e=_0x3a6b57['votes'][_0x4aeb9b]||[],_0x2bd53d=_0x24652e[_0x51eac(0x8ff)](_0x54e20c=>_0x589066(_0x267520,_0x54e20c))['join']('、\x20');_0x105bda+=_0x51eac(0xd6f)+_0x4aeb9b+'\x20('+_0x24652e[_0x51eac(0xaf9)]+_0x51eac(0xdc5)+(_0x24652e[_0x51eac(0xaf9)]>0x0?_0x2bd53d:_0x51eac(0xb06))+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}),_0x104485('投票结果',_0x105bda);}function _0x379184(){const _0x399aed=_0x3ce1fb;if(!_0x16699d[_0x399aed(0xf5a)])return;const _0x56d40d=_0x16699d[_0x399aed(0x1474)][_0x16699d[_0x399aed(0xf5a)]];document[_0x399aed(0x948)](_0x399aed(0x114c))['textContent']='“'+_0x56d40d[_0x399aed(0x1467)]+'”的头像库',_0x1658c0(),document[_0x399aed(0x948)]('ai-avatar-library-modal')['classList'][_0x399aed(0xbd0)](_0x399aed(0xfcb));}function _0x1658c0(){const _0x4eae99=_0x3ce1fb,_0x514503=document[_0x4eae99(0x948)](_0x4eae99(0x5aa));_0x514503[_0x4eae99(0xb6f)]='';const _0x49f70c=_0x16699d[_0x4eae99(0x1474)][_0x16699d[_0x4eae99(0xf5a)]],_0x223361=_0x49f70c[_0x4eae99(0x7fd)][_0x4eae99(0x13ab)]||[];if(_0x223361['length']===0x0){_0x514503[_0x4eae99(0xb6f)]=_0x4eae99(0xec4);return;}_0x223361['forEach']((_0x4ec302,_0x5dffb5)=>{const _0xa92376=_0x4eae99,_0x575299=document['createElement']('div');_0x575299[_0xa92376(0x35b)]=_0xa92376(0x1399),_0x575299['title']=_0x4ec302[_0xa92376(0x1467)],_0x575299[_0xa92376(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url('+_0x4ec302['url']+_0xa92376(0xdd3)+_0x4ec302['name']+_0xa92376(0x10df);const _0x2a202b=document[_0xa92376(0x1497)](_0xa92376(0x379));_0x2a202b[_0xa92376(0x35b)]='delete-btn',_0x2a202b['innerHTML']='×',_0x2a202b[_0xa92376(0xf74)][_0xa92376(0x11fd)]='block',_0x2a202b['onclick']=async _0x3cd7e6=>{const _0xf6eb01=_0xa92376;_0x3cd7e6[_0xf6eb01(0x221)]();const _0x2a22c2=await _0xa6b74a(_0xf6eb01(0xa42),_0xf6eb01(0xa78)+_0x4ec302['name']+_0xf6eb01(0x88e),{'confirmButtonClass':'btn-danger'});_0x2a22c2&&(_0x49f70c[_0xf6eb01(0x7fd)][_0xf6eb01(0x13ab)][_0xf6eb01(0x36d)](_0x5dffb5,0x1),await _0x6ed281['chats'][_0xf6eb01(0x90c)](_0x49f70c),_0x1658c0());},_0x575299[_0xa92376(0x6b6)](_0x2a202b),_0x514503[_0xa92376(0x6b6)](_0x575299);});}async function _0x3d79ed(){const _0xa758c2=_0x3ce1fb,_0x227299=await _0x41b9fc('添加头像',_0xa758c2(0x8db));if(!_0x227299||!_0x227299[_0xa758c2(0x2a8)]())return;const _0x20ea99=await _0x41b9fc('添加头像','请输入头像的图片URL','','url');if(!_0x20ea99||!_0x20ea99[_0xa758c2(0x2a8)]()['startsWith'](_0xa758c2(0xb72))){alert(_0xa758c2(0x4c4));return;}const _0x585e38=_0x16699d[_0xa758c2(0x1474)][_0x16699d[_0xa758c2(0xf5a)]];!_0x585e38[_0xa758c2(0x7fd)]['aiAvatarLibrary']&&(_0x585e38[_0xa758c2(0x7fd)][_0xa758c2(0x13ab)]=[]),_0x585e38['settings'][_0xa758c2(0x13ab)][_0xa758c2(0x1001)]({'name':_0x227299[_0xa758c2(0x2a8)](),'url':_0x20ea99[_0xa758c2(0x2a8)]()}),await _0x6ed281['chats'][_0xa758c2(0x90c)](_0x585e38),_0x1658c0();}function _0x4c0af4(){const _0x4d6819=_0x3ce1fb;document[_0x4d6819(0x948)](_0x4d6819(0x1140))[_0x4d6819(0xd54)]['remove']('visible');}function _0x15b15e(){const _0x5fe65a=_0x3ce1fb;if(!_0x16699d[_0x5fe65a(0xf5a)])return;const _0x50119e=_0x16699d[_0x5fe65a(0x1474)][_0x16699d[_0x5fe65a(0xf5a)]];document[_0x5fe65a(0x948)]('my-avatar-library-title')[_0x5fe65a(0x10cb)]='“'+(_0x50119e[_0x5fe65a(0x7fd)]['myNickname']||'我')+'”的头像库',_0x233000(),document[_0x5fe65a(0x948)](_0x5fe65a(0x458))[_0x5fe65a(0xd54)][_0x5fe65a(0xbd0)](_0x5fe65a(0xfcb));}function _0x233000(){const _0x249c42=_0x3ce1fb,_0x2cc1c3=document['getElementById']('my-avatar-library-grid');_0x2cc1c3[_0x249c42(0xb6f)]='';const _0x4e7ac6=_0x16699d['chats'][_0x16699d['activeChatId']],_0x3e1ccf=_0x4e7ac6['settings'][_0x249c42(0x3c2)]||[];if(_0x3e1ccf[_0x249c42(0xaf9)]===0x0){_0x2cc1c3[_0x249c42(0xb6f)]=_0x249c42(0xec4);return;}_0x3e1ccf['forEach']((_0x326c84,_0x92020c)=>{const _0xc8e126=_0x249c42,_0x4bf4b9=document[_0xc8e126(0x1497)](_0xc8e126(0x379));_0x4bf4b9[_0xc8e126(0x35b)]=_0xc8e126(0x1399),_0x4bf4b9['title']=_0x326c84[_0xc8e126(0x1467)],_0x4bf4b9[_0xc8e126(0xb6f)]=_0xc8e126(0x4b8)+_0x326c84[_0xc8e126(0x9a8)]+_0xc8e126(0xdd3)+_0x326c84[_0xc8e126(0x1467)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0x2e2bc9=document[_0xc8e126(0x1497)](_0xc8e126(0x379));_0x2e2bc9[_0xc8e126(0x35b)]=_0xc8e126(0xd38),_0x2e2bc9[_0xc8e126(0xb6f)]='×',_0x2e2bc9['style']['display']='block',_0x2e2bc9['onclick']=async _0x102543=>{const _0x1b7424=_0xc8e126;_0x102543['stopPropagation']();const _0x399f57=await _0xa6b74a(_0x1b7424(0xa42),_0x1b7424(0xbe2)+_0x326c84[_0x1b7424(0x1467)]+_0x1b7424(0x88e),{'confirmButtonClass':_0x1b7424(0x5e8)});_0x399f57&&(_0x4e7ac6['settings'][_0x1b7424(0x3c2)][_0x1b7424(0x36d)](_0x92020c,0x1),await _0x6ed281[_0x1b7424(0x1474)][_0x1b7424(0x90c)](_0x4e7ac6),_0x233000());},_0x4bf4b9[_0xc8e126(0x6b6)](_0x2e2bc9),_0x2cc1c3[_0xc8e126(0x6b6)](_0x4bf4b9);});}async function _0x18db0e(){const _0x5c6686=_0x3ce1fb,_0x55970d=await _0x41b9fc('添加头像',_0x5c6686(0x8db));if(!_0x55970d||!_0x55970d[_0x5c6686(0x2a8)]())return;const _0x48e4e3=await _0x41b9fc(_0x5c6686(0x600),_0x5c6686(0x10eb),'',_0x5c6686(0x9a8));if(!_0x48e4e3||!_0x48e4e3['trim']()[_0x5c6686(0x157f)](_0x5c6686(0xb72))){alert('请输入有效的图片URL！');return;}const _0x26274e=_0x16699d[_0x5c6686(0x1474)][_0x16699d[_0x5c6686(0xf5a)]];!_0x26274e[_0x5c6686(0x7fd)][_0x5c6686(0x3c2)]&&(_0x26274e[_0x5c6686(0x7fd)][_0x5c6686(0x3c2)]=[]),_0x26274e[_0x5c6686(0x7fd)][_0x5c6686(0x3c2)]['push']({'name':_0x55970d[_0x5c6686(0x2a8)](),'url':_0x48e4e3[_0x5c6686(0x2a8)]()}),await _0x6ed281[_0x5c6686(0x1474)][_0x5c6686(0x90c)](_0x26274e),_0x233000();}async function _0x380935(_0x3c4009){const _0x391f3c=_0x3ce1fb,_0x2a185a=_0x3c4009['target'][_0x391f3c(0x10b0)][0x0];if(!_0x2a185a)return;const _0x6223c=await new Promise(_0x188779=>{const _0x2a3d8d=_0x391f3c,_0x200e94=new FileReader();_0x200e94[_0x2a3d8d(0x33a)]=()=>_0x188779(_0x200e94[_0x2a3d8d(0x22a)]),_0x200e94['readAsDataURL'](_0x2a185a);}),_0x29bac4=await _0x41b9fc(_0x391f3c(0x804),_0x391f3c(0xb8d));if(!_0x29bac4||!_0x29bac4[_0x391f3c(0x2a8)]())return;const _0x1c46f4=_0x16699d[_0x391f3c(0x1474)][_0x16699d[_0x391f3c(0xf5a)]];!_0x1c46f4[_0x391f3c(0x7fd)][_0x391f3c(0x3c2)]&&(_0x1c46f4['settings'][_0x391f3c(0x3c2)]=[]),_0x1c46f4[_0x391f3c(0x7fd)]['myAvatarLibrary'][_0x391f3c(0x1001)]({'name':_0x29bac4[_0x391f3c(0x2a8)](),'url':_0x6223c}),await _0x6ed281[_0x391f3c(0x1474)][_0x391f3c(0x90c)](_0x1c46f4),_0x233000(),_0x3c4009['target'][_0x391f3c(0x5bc)]=null;}async function _0x5df969(_0x11d873){const _0x5a964b=_0x3ce1fb,_0x1d928e=_0x16699d[_0x5a964b(0x1474)][_0x16699d[_0x5a964b(0xf5a)]];if(!_0x1d928e)return;const _0x18a3ef=_0x11d873[_0x5a964b(0x2a8)]()['split']('\x0a'),_0x42bdc4=[],_0x3860b0='https://files.catbox.moe/';let _0x1d3f78=0x0;for(const _0x16311c of _0x18a3ef){const _0x3447a6=_0x16311c['trim']();if(!_0x3447a6||_0x3447a6[_0x5a964b(0x1336)](_0x5a964b(0xb72))||_0x3447a6[_0x5a964b(0x1336)]('填入'))continue;let _0x378cc1=null,_0x4b4975=null;const _0x483a8b=_0x3447a6[_0x5a964b(0x9a3)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x483a8b)_0x378cc1=_0x483a8b[0x1],_0x4b4975=_0x483a8b[0x2];else{const _0x58bcc4=_0x3447a6[_0x5a964b(0x46f)](/\s+/);_0x58bcc4['length']>=0x2&&(_0x4b4975=_0x58bcc4[_0x5a964b(0x1147)](),_0x378cc1=_0x58bcc4[_0x5a964b(0x121a)]('\x20'));}_0x378cc1&&_0x4b4975&&_0x4b4975[_0x5a964b(0x1336)]('.')?_0x42bdc4[_0x5a964b(0x1001)]({'name':_0x378cc1,'url':_0x3860b0+_0x4b4975}):_0x1d3f78++;}if(_0x1d3f78>0x0)await _0x104485(_0x5a964b(0xca9),'有\x20'+_0x1d3f78+'\x20行的格式不正确，已被跳过。');if(_0x42bdc4[_0x5a964b(0xaf9)]>0x0){if(!_0x1d928e[_0x5a964b(0x7fd)][_0x5a964b(0x3c2)])_0x1d928e[_0x5a964b(0x7fd)]['myAvatarLibrary']=[];_0x1d928e[_0x5a964b(0x7fd)]['myAvatarLibrary'][_0x5a964b(0x1001)](..._0x42bdc4),await _0x6ed281[_0x5a964b(0x1474)][_0x5a964b(0x90c)](_0x1d928e),_0x233000(),await _0x104485('导入成功',_0x5a964b(0xa72)+_0x42bdc4['length']+'\x20个新头像！');}else _0x1d3f78===0x0&&alert('没有找到可导入的内容。');}function _0x51973c(){const _0x32a9b1=_0x3ce1fb;document[_0x32a9b1(0x948)](_0x32a9b1(0x458))['classList'][_0x32a9b1(0xf89)](_0x32a9b1(0xfcb));}function _0x203418(){const _0x5a290e=_0x3ce1fb;if(!_0x16699d[_0x5a290e(0xf5a)])return;const _0x14b7bf=_0x16699d['chats'][_0x16699d['activeChatId']];document[_0x5a290e(0x948)](_0x5a290e(0x6b2))[_0x5a290e(0x10cb)]='“'+_0x14b7bf[_0x5a290e(0x1467)]+_0x5a290e(0x25c),_0x1d86f6(),document[_0x5a290e(0x948)](_0x5a290e(0x5d0))['classList']['add'](_0x5a290e(0xfcb));}function _0x1d86f6(){const _0x2cb02b=_0x3ce1fb,_0x802ea8=document[_0x2cb02b(0x948)](_0x2cb02b(0x4fd));_0x802ea8[_0x2cb02b(0xb6f)]='';const _0x5c5d72=_0x16699d[_0x2cb02b(0x1474)][_0x16699d[_0x2cb02b(0xf5a)]],_0x5449d3=_0x5c5d72['settings']['groupAvatarLibrary']||[];if(_0x5449d3['length']===0x0){_0x802ea8[_0x2cb02b(0xb6f)]='<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>';return;}_0x5449d3['forEach']((_0x46bf69,_0x818eea)=>{const _0x7a6d13=_0x2cb02b,_0x21ebaf=document['createElement'](_0x7a6d13(0x379));_0x21ebaf[_0x7a6d13(0x35b)]=_0x7a6d13(0x1399),_0x21ebaf[_0x7a6d13(0xb03)]=_0x46bf69['name'],_0x21ebaf['innerHTML']=_0x7a6d13(0x4b8)+_0x46bf69[_0x7a6d13(0x9a8)]+');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>'+_0x46bf69[_0x7a6d13(0x1467)]+_0x7a6d13(0x10df);const _0x1cd8c1=document[_0x7a6d13(0x1497)]('div');_0x1cd8c1[_0x7a6d13(0x35b)]=_0x7a6d13(0xd38),_0x1cd8c1[_0x7a6d13(0xb6f)]='×',_0x1cd8c1[_0x7a6d13(0xf74)][_0x7a6d13(0x11fd)]=_0x7a6d13(0x1273),_0x1cd8c1[_0x7a6d13(0xe8d)]=async _0x69a817=>{const _0x53874f=_0x7a6d13;_0x69a817[_0x53874f(0x221)]();const _0xd4f360=await _0xa6b74a(_0x53874f(0xa42),_0x53874f(0xa78)+_0x46bf69[_0x53874f(0x1467)]+'”吗？',{'confirmButtonClass':_0x53874f(0x5e8)});_0xd4f360&&(_0x5c5d72[_0x53874f(0x7fd)][_0x53874f(0x1506)]['splice'](_0x818eea,0x1),await _0x6ed281[_0x53874f(0x1474)][_0x53874f(0x90c)](_0x5c5d72),_0x1d86f6());},_0x21ebaf[_0x7a6d13(0x6b6)](_0x1cd8c1),_0x802ea8[_0x7a6d13(0x6b6)](_0x21ebaf);});}async function _0x36c08c(){const _0x43662c=_0x3ce1fb,_0x192585=await _0x41b9fc(_0x43662c(0x600),_0x43662c(0xaed));if(!_0x192585||!_0x192585[_0x43662c(0x2a8)]())return;const _0x31c8fa=await _0x41b9fc('添加头像',_0x43662c(0x10eb),'','url');if(!_0x31c8fa||!_0x31c8fa['trim']()[_0x43662c(0x157f)](_0x43662c(0xb72))){alert(_0x43662c(0x4c4));return;}const _0x4f248c=_0x16699d[_0x43662c(0x1474)][_0x16699d[_0x43662c(0xf5a)]];!_0x4f248c[_0x43662c(0x7fd)]['groupAvatarLibrary']&&(_0x4f248c[_0x43662c(0x7fd)]['groupAvatarLibrary']=[]),_0x4f248c[_0x43662c(0x7fd)][_0x43662c(0x1506)][_0x43662c(0x1001)]({'name':_0x192585['trim'](),'url':_0x31c8fa[_0x43662c(0x2a8)]()}),await _0x6ed281[_0x43662c(0x1474)][_0x43662c(0x90c)](_0x4f248c),_0x1d86f6();}function _0x1005bc(){const _0x41d580=_0x3ce1fb;document[_0x41d580(0x948)](_0x41d580(0x5d0))[_0x41d580(0xd54)][_0x41d580(0xf89)](_0x41d580(0xfcb));}async function _0x249969(_0x5400df){const _0x943920=_0x3ce1fb,_0x2c1439=_0x943920(0xa7d),_0x5d03f5=await _0x41b9fc('批量导入头像',_0x2c1439,'',_0x943920(0xc1e));_0x5d03f5&&_0x5d03f5[_0x943920(0x2a8)]()&&await _0x2cb17f(_0x5400df,_0x5d03f5);}async function _0x2cb17f(_0x580844,_0x1059aa){const _0x7d4663=_0x3ce1fb,_0x20a9b5=_0x16699d['chats'][_0x16699d[_0x7d4663(0xf5a)]];if(!_0x20a9b5)return;const _0x3cc62d=_0x1059aa[_0x7d4663(0x2a8)]()['split']('\x0a'),_0x34b2b8=[],_0x316c1d=_0x7d4663(0xe3c);let _0x3ad08d=0x0;for(const _0x5dc234 of _0x3cc62d){const _0x5aa9bb=_0x5dc234[_0x7d4663(0x2a8)]();if(!_0x5aa9bb||_0x5aa9bb[_0x7d4663(0x1336)](_0x7d4663(0xb72))||_0x5aa9bb['includes']('填入'))continue;let _0x5c1476=null,_0x488f80=null;const _0xf500f6=_0x5aa9bb[_0x7d4663(0x9a3)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0xf500f6)_0x5c1476=_0xf500f6[0x1],_0x488f80=_0xf500f6[0x2];else{const _0x3c051a=_0x5aa9bb[_0x7d4663(0x46f)](/\s+/);_0x3c051a[_0x7d4663(0xaf9)]>=0x2&&(_0x488f80=_0x3c051a[_0x7d4663(0x1147)](),_0x5c1476=_0x3c051a['join']('\x20'));}_0x5c1476&&_0x488f80&&_0x488f80[_0x7d4663(0x1336)]('.')?_0x34b2b8['push']({'name':_0x5c1476,'url':_0x316c1d+_0x488f80}):(_0x3ad08d++,console[_0x7d4663(0x9c1)](_0x7d4663(0x1349),_0x5aa9bb));}_0x3ad08d>0x0&&await _0x104485('部分导入失败','有\x20'+_0x3ad08d+'\x20行的格式不正确，已被系统跳过。');if(_0x34b2b8[_0x7d4663(0xaf9)]>0x0){if(_0x580844==='ai'){if(!_0x20a9b5[_0x7d4663(0x7fd)][_0x7d4663(0x13ab)])_0x20a9b5[_0x7d4663(0x7fd)]['aiAvatarLibrary']=[];_0x20a9b5[_0x7d4663(0x7fd)][_0x7d4663(0x13ab)][_0x7d4663(0x1001)](..._0x34b2b8),await _0x6ed281[_0x7d4663(0x1474)][_0x7d4663(0x90c)](_0x20a9b5),_0x1658c0();}else{if(_0x580844===_0x7d4663(0x1403)){if(!_0x20a9b5['settings'][_0x7d4663(0x1506)])_0x20a9b5[_0x7d4663(0x7fd)]['groupAvatarLibrary']=[];_0x20a9b5[_0x7d4663(0x7fd)][_0x7d4663(0x1506)][_0x7d4663(0x1001)](..._0x34b2b8),await _0x6ed281['chats'][_0x7d4663(0x90c)](_0x20a9b5),_0x1d86f6();}}await _0x104485(_0x7d4663(0x5c6),_0x7d4663(0xa72)+_0x34b2b8[_0x7d4663(0xaf9)]+'\x20个新头像！');}else _0x3ad08d===0x0&&alert(_0x7d4663(0x5c9));}async function _0x253e37(){const _0x2dcd19=_0x3ce1fb,_0x3e73a3=await _0x41b9fc(_0x2dcd19(0x600),'请为这个头像起个名字（例如：春日野餐、学习时间）');if(!_0x3e73a3||!_0x3e73a3[_0x2dcd19(0x2a8)]())return;const _0x531fe0=await _0x41b9fc(_0x2dcd19(0x600),_0x2dcd19(0x10eb),'',_0x2dcd19(0x9a8));if(!_0x531fe0||!_0x531fe0[_0x2dcd19(0x2a8)]()[_0x2dcd19(0x157f)]('http')){alert(_0x2dcd19(0x4c4));return;}const _0x2f5dc4=_0x16699d['chats'][_0x16699d['activeChatId']];!_0x2f5dc4['settings'][_0x2dcd19(0x1506)]&&(_0x2f5dc4[_0x2dcd19(0x7fd)]['groupAvatarLibrary']=[]),_0x2f5dc4[_0x2dcd19(0x7fd)]['groupAvatarLibrary']['push']({'name':_0x3e73a3[_0x2dcd19(0x2a8)](),'url':_0x531fe0[_0x2dcd19(0x2a8)]()}),await _0x6ed281[_0x2dcd19(0x1474)][_0x2dcd19(0x90c)](_0x2f5dc4),_0x1d86f6();}function _0x5deb9f(_0x4833f4){return new Promise(_0x1fb66f=>{const _0x144b2c=_0x6c9e,_0x508624=document[_0x144b2c(0x948)](_0x144b2c(0x3d1)),_0x1343dd=document[_0x144b2c(0x948)](_0x144b2c(0x99c)),_0x5e82e1=document[_0x144b2c(0x948)](_0x144b2c(0xc50)),_0x21e613=document['getElementById'](_0x144b2c(0x6df));_0x1343dd[_0x144b2c(0x10cb)]=_0x4833f4[_0x144b2c(0x13a9)]?'取消置顶':_0x144b2c(0x1276);const _0x3291fd=_0x1343dd['cloneNode'](!![]);_0x1343dd['parentNode'][_0x144b2c(0x868)](_0x3291fd,_0x1343dd),_0x3291fd[_0x144b2c(0xe8d)]=()=>{const _0x4e339b=_0x144b2c;_0x508624[_0x4e339b(0xd54)][_0x4e339b(0xf89)](_0x4e339b(0xfcb)),_0x1fb66f('pin');};const _0x5ef2eb=_0x5e82e1[_0x144b2c(0xfc0)](!![]);_0x5e82e1[_0x144b2c(0x1579)][_0x144b2c(0x868)](_0x5ef2eb,_0x5e82e1),_0x5ef2eb[_0x144b2c(0xe8d)]=()=>{const _0x4c8f6f=_0x144b2c;_0x508624['classList'][_0x4c8f6f(0xf89)](_0x4c8f6f(0xfcb)),_0x1fb66f(_0x4c8f6f(0x869));};const _0x28eaa3=_0x21e613[_0x144b2c(0xfc0)](!![]);_0x21e613[_0x144b2c(0x1579)][_0x144b2c(0x868)](_0x28eaa3,_0x21e613),_0x28eaa3['onclick']=()=>{const _0x586dfa=_0x144b2c;_0x508624[_0x586dfa(0xd54)][_0x586dfa(0xf89)](_0x586dfa(0xfcb)),_0x1fb66f(null);},_0x508624[_0x144b2c(0xd54)]['add'](_0x144b2c(0xfcb));});}function _0x471b5b(){const _0x207551=_0x3ce1fb,_0x3bb9e4=document[_0x207551(0x948)](_0x207551(0x100f)),_0x4bc526=_0x16699d[_0x207551(0xf9c)][_0x207551(0x378)];_0x4bc526?_0x3bb9e4['style'][_0x207551(0x618)]=_0x207551(0x4f1)+_0x4bc526+')':_0x3bb9e4[_0x207551(0xf74)]['backgroundImage']=_0x207551(0xfc7);}function _0x25c96f(){const _0x3f7abb=_0x3ce1fb;if(!_0x16699d['globalSettings'][_0x3f7abb(0xac6)])return;for(const _0xa7ac52 in _0x16699d['globalSettings']['cphoneAppIcons']){const _0x2a68bd=document['getElementById'](_0x3f7abb(0x2a1)+_0xa7ac52);_0x2a68bd&&(_0x2a68bd[_0x3f7abb(0x147d)]=_0x16699d[_0x3f7abb(0xf9c)][_0x3f7abb(0xac6)][_0xa7ac52]);}}function _0xdb42cd(){const _0x2dc278=_0x3ce1fb,_0x323d4f=document[_0x2dc278(0x948)]('cphone-icon-settings-grid');if(!_0x323d4f)return;_0x323d4f[_0x2dc278(0xb6f)]='';const _0x2c3887={'qq':'QQ','album':'相册','browser':_0x2dc278(0xc7b),'taobao':'淘宝','memo':_0x2dc278(0x21f),'diary':'日记','amap':_0x2dc278(0x1477),'usage':'App记录','music':'网易云','ephone':_0x2dc278(0xc94)};for(const _0x541a05 in _0x16699d[_0x2dc278(0xf9c)][_0x2dc278(0xac6)]){const _0x3e5193=_0x16699d['globalSettings'][_0x2dc278(0xac6)][_0x541a05],_0x1bac58=_0x2c3887[_0x541a05]||'未知App',_0xaf0eff=document[_0x2dc278(0x1497)](_0x2dc278(0x379));_0xaf0eff['className']=_0x2dc278(0x8a3),_0xaf0eff[_0x2dc278(0x606)]['iconId']=_0x541a05,_0xaf0eff[_0x2dc278(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22icon-preview\x22\x20src=\x22'+_0x3e5193+_0x2dc278(0x3f0)+_0x1bac58+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x323d4f[_0x2dc278(0x6b6)](_0xaf0eff);}}function _0x1c8fc4(){const _0x2e6bc0=_0x3ce1fb;if(!_0x16699d[_0x2e6bc0(0xf9c)][_0x2e6bc0(0x1471)])return;for(const _0x549871 in _0x16699d['globalSettings'][_0x2e6bc0(0x1471)]){const _0x470c3a=document[_0x2e6bc0(0x948)](_0x2e6bc0(0x129c)+_0x549871);_0x470c3a&&(_0x470c3a[_0x2e6bc0(0x147d)]=_0x16699d[_0x2e6bc0(0xf9c)][_0x2e6bc0(0x1471)][_0x549871]);}}function _0x312655(){const _0x100ecf=_0x3ce1fb,_0xf87118=document[_0x100ecf(0x948)](_0x100ecf(0x1091));if(!_0xf87118)return;_0xf87118[_0x100ecf(0xb6f)]='';const _0x3aaba3={'qq':'QQ','world-book':_0x100ecf(0x329),'wallpaper':_0x100ecf(0x5cb),'renderer':'渲染器','api-settings':_0x100ecf(0x144b),'font':'字体','char-phone':_0x100ecf(0x611),'douban':_0x100ecf(0xafd),'preset':'预设','tutorial':'教程','werewolf':_0x100ecf(0x4d4),'x':'X'};for(const _0x33eea1 in _0x16699d['globalSettings'][_0x100ecf(0x1471)]){const _0x56391e=_0x16699d[_0x100ecf(0xf9c)][_0x100ecf(0x1471)][_0x33eea1],_0x32e4ec=_0x3aaba3[_0x33eea1]||_0x100ecf(0x611),_0x26eaac=document['createElement'](_0x100ecf(0x379));_0x26eaac['className']=_0x100ecf(0x8a3),_0x26eaac[_0x100ecf(0x606)]['iconId']=_0x33eea1,_0x26eaac[_0x100ecf(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22icon-preview\x22\x20src=\x22'+_0x56391e+'\x22\x20alt=\x22'+_0x32e4ec+_0x100ecf(0x230),_0xf87118[_0x100ecf(0x6b6)](_0x26eaac);}}function _0x296ff9(_0x354c86){const _0x776232=_0x3ce1fb;if(!_0x16699d[_0x776232(0xf5a)])return;const _0x344980=_0x16699d[_0x776232(0x1474)][_0x16699d[_0x776232(0xf5a)]];if(!_0x344980||!_0x344980[_0x776232(0xb07)])return;const _0x4d2284=_0x344980[_0x776232(0xb07)][_0x776232(0x1402)](_0x4bf80a=>_0x4bf80a[_0x776232(0xb0a)]===_0x354c86);if(!_0x4d2284||_0x4d2284[_0x776232(0x4ae)]!==_0x776232(0xa7a)){console[_0x776232(0xc3e)]('无法找到或消息类型不匹配的分享链接:',_0x354c86);return;}document[_0x776232(0x948)](_0x776232(0xaad))[_0x776232(0x10cb)]=_0x4d2284[_0x776232(0x10c9)]||_0x776232(0x67e);const _0x2ca1d8=document['getElementById'](_0x776232(0x1185));_0x2ca1d8[_0x776232(0xb6f)]=_0x776232(0x7bb)+(_0x4d2284[_0x776232(0xb03)]||'无标题')+_0x776232(0xc81)+(_0x4d2284[_0x776232(0x10c9)]||'未知')+_0x776232(0x1404)+(_0x4d2284[_0x776232(0xede)]||_0x776232(0x5b3))['replace'](/\n/g,_0x776232(0x70f))+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x58c3b1('browser-screen');}function _0xa8766c(){_0x58c3b1('chat-interface-screen');}function _0xa8766c(){_0x58c3b1('chat-interface-screen');}function _0x73710c(){const _0x58db23=_0x3ce1fb;if(!_0x16699d[_0x58db23(0xf5a)])return;document[_0x58db23(0x948)](_0x58db23(0x591))[_0x58db23(0x5bc)]='',document[_0x58db23(0x948)]('link-description-input')['value']='',document[_0x58db23(0x948)](_0x58db23(0x207))[_0x58db23(0x5bc)]='',document[_0x58db23(0x948)](_0x58db23(0x1427))[_0x58db23(0x5bc)]='',document[_0x58db23(0x948)](_0x58db23(0xa69))[_0x58db23(0xd54)][_0x58db23(0xbd0)](_0x58db23(0xfcb));}async function _0x58cca7(){const _0x38929e=_0x3ce1fb;if(!_0x16699d[_0x38929e(0xf5a)])return;const _0x3aa012=document['getElementById'](_0x38929e(0x591))['value'][_0x38929e(0x2a8)]();if(!_0x3aa012){alert(_0x38929e(0x100b));return;}const _0x12e57d=document['getElementById'](_0x38929e(0xe44))[_0x38929e(0x5bc)][_0x38929e(0x2a8)](),_0x4a253f=document[_0x38929e(0x948)](_0x38929e(0x207))[_0x38929e(0x5bc)][_0x38929e(0x2a8)](),_0x2e7abe=document[_0x38929e(0x948)]('link-content-input')[_0x38929e(0x5bc)][_0x38929e(0x2a8)](),_0x41236d=_0x16699d['chats'][_0x16699d['activeChatId']],_0x1b685d={'role':_0x38929e(0xaeb),'type':_0x38929e(0xa7a),'timestamp':Date['now'](),'title':_0x3aa012,'description':_0x12e57d,'source_name':_0x4a253f,'content':_0x2e7abe,'thumbnail_url':null};_0x41236d[_0x38929e(0xb07)][_0x38929e(0x1001)](_0x1b685d),await _0x6ed281['chats'][_0x38929e(0x90c)](_0x41236d),_0x4b384e(_0x1b685d,_0x41236d),_0x2d33eb(),document['getElementById']('share-link-modal')[_0x38929e(0xd54)][_0x38929e(0xf89)](_0x38929e(0xfcb));}function _0x337ed2(_0x2b3553,_0x1576f5){const _0x5899c9=_0x3ce1fb;if(!_0x1576f5||!_0x1576f5['id'])return[];const _0x484dc6=_0x1576f5[_0x5899c9(0xaa9)],_0x1524a1=_0x1576f5['id'];return _0x2b3553[_0x5899c9(0x1c0)](_0x44aa11=>{const _0x1b0f56=_0x5899c9;if(_0x44aa11['authorId']===_0x1b0f56(0xaeb)){if(_0x44aa11['visibleGroupIds']&&_0x44aa11[_0x1b0f56(0xa48)][_0x1b0f56(0xaf9)]>0x0)return _0x484dc6&&_0x44aa11[_0x1b0f56(0xa48)]['includes'](_0x484dc6);return!![];}if(String(_0x44aa11[_0x1b0f56(0x11b9)])['startsWith'](_0x1b0f56(0x137b))){if(Array[_0x1b0f56(0x1524)](_0x44aa11[_0x1b0f56(0x45a)]))return _0x44aa11[_0x1b0f56(0x45a)][_0x1b0f56(0x1336)](_0x1524a1);return![];}const _0x3d7f79=_0x16699d[_0x1b0f56(0x1474)][_0x44aa11[_0x1b0f56(0x11b9)]];if(!_0x3d7f79)return![];const _0x1233a1=_0x3d7f79['groupId'],_0xbca045=_0x1233a1&&_0x484dc6&&_0x1233a1===_0x484dc6,_0x6e13d2=!_0x1233a1&&!_0x484dc6;return _0xbca045||_0x6e13d2;});}function _0xefda29(_0x510c71){const _0x11f52c=_0x3ce1fb;document[_0x11f52c(0xae6)][_0x11f52c(0xd54)][_0x11f52c(0x69d)](_0x11f52c(0x6fe),_0x510c71);if(_0x49c6c5[_0x11f52c(0x1032)]){const _0x3fe997=document['getElementById'](_0x11f52c(0xa34)),_0x33a9a7=document['getElementById'](_0x11f52c(0xecd)),_0x149c0f=_0x16699d['globalSettings'][_0x11f52c(0x2b7)]||![];_0x510c71?(_0x3fe997[_0x11f52c(0xd54)][_0x11f52c(0xf89)](_0x11f52c(0xfcb)),_0x33a9a7[_0x11f52c(0xd54)][_0x11f52c(0xbd0)](_0x11f52c(0x811))):(_0x33a9a7['classList'][_0x11f52c(0xf89)](_0x11f52c(0x811)),_0x149c0f?(_0x33a9a7[_0x11f52c(0xd54)]['add'](_0x11f52c(0x811)),_0x3fe997['classList'][_0x11f52c(0xf89)](_0x11f52c(0xfcb))):_0x49c6c5[_0x11f52c(0x68d)]&&_0x49c6c5[_0x11f52c(0x68d)][_0x11f52c(0xaf9)]>0x0&&_0x3fe997['classList'][_0x11f52c(0xbd0)]('visible'));}}function _0x228284(_0x3e1bec){const _0x41ce5a=_0x3ce1fb;document[_0x41ce5a(0xae6)]['classList'][_0x41ce5a(0x69d)](_0x41ce5a(0x6ef),_0x3e1bec);}function _0x5afcab(_0x5eefd9){const _0x50b52f=_0x3ce1fb,_0x525921=document[_0x50b52f(0x948)](_0x50b52f(0xecd)),_0x53e29b=document['getElementById'](_0x50b52f(0x3cf)),_0x345997=_0x5eefd9==='dark';_0x525921['classList'][_0x50b52f(0x69d)]('dark-mode',_0x345997),_0x53e29b&&(_0x53e29b[_0x50b52f(0x210)]=_0x345997),localStorage[_0x50b52f(0x59f)](_0x50b52f(0x1304),_0x5eefd9);}function _0x189334(){const _0xcc0aed=_0x3ce1fb,_0x15dbf9=document[_0xcc0aed(0x948)]('theme-toggle-switch'),_0x2b19f8=_0x15dbf9['checked']?_0xcc0aed(0x1007):'light';_0x5afcab(_0x2b19f8);}function _0x410087(){const _0x1592c1=_0x3ce1fb;if(!_0x16699d[_0x1592c1(0xf5a)])return;_0x47ddd6(),_0x58c3b1(_0x1592c1(0xad4));}function _0x47ddd6(){const _0x4069af=_0x3ce1fb,_0xfa103e=document[_0x4069af(0x948)](_0x4069af(0x113b)),_0x367919=_0x16699d[_0x4069af(0x1474)][_0x16699d[_0x4069af(0xf5a)]];_0xfa103e['innerHTML']='';let _0x2d13d0=[];_0x367919['isGroup']?_0x367919[_0x4069af(0x10a2)][_0x4069af(0x427)](_0x27e9cd=>{const _0x1a0fb9=_0x4069af,_0x4ef30b=_0x16699d['chats'][_0x27e9cd['id']];if(_0x4ef30b&&_0x4ef30b['longTermMemory']){const _0x274043=_0x4ef30b[_0x1a0fb9(0x758)][_0x1a0fb9(0x8ff)](_0x563ee1=>({..._0x563ee1,'authorName':_0x27e9cd['groupNickname'],'authorChatId':_0x27e9cd['id']}));_0x2d13d0[_0x1a0fb9(0x1001)](..._0x274043);}}):_0x367919[_0x4069af(0x758)]&&(_0x2d13d0=_0x367919['longTermMemory'][_0x4069af(0x8ff)](_0x20f9a6=>({..._0x20f9a6,'authorName':_0x367919[_0x4069af(0x1467)],'authorChatId':_0x367919['id']})));if(_0x2d13d0['length']===0x0){_0xfa103e[_0x4069af(0xb6f)]=_0x4069af(0xdb9);return;}_0x2d13d0[_0x4069af(0xe96)]((_0x4739ef,_0x171476)=>_0x171476[_0x4069af(0xb0a)]-_0x4739ef[_0x4069af(0xb0a)]),_0x2d13d0[_0x4069af(0x427)]((_0x24437b,_0x26184c)=>{const _0x3e6134=_0x4069af,_0x183ed4=document[_0x3e6134(0x1497)](_0x3e6134(0x379));_0x183ed4[_0x3e6134(0x35b)]=_0x3e6134(0x540),_0x183ed4['style'][_0x3e6134(0x12f7)]=_0x3e6134(0xe46),_0x183ed4[_0x3e6134(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20flex-start;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22\x20style=\x22padding:\x200;\x20flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20新增：显示记忆来源\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.8em;\x20color:\x20#999;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x20'+_0x24437b[_0x3e6134(0x8bd)]+_0x3e6134(0xb82)+_0x24437b[_0x3e6134(0xede)]['replace'](/\n/g,'<br>')+_0x3e6134(0x1254)+_0x24437b[_0x3e6134(0x1095)]+_0x3e6134(0xda5)+_0x24437b[_0x3e6134(0xb0a)]+_0x3e6134(0xdff)+_0x24437b['authorChatId']+_0x3e6134(0xda5)+_0x24437b[_0x3e6134(0xb0a)]+_0x3e6134(0xa55),_0xfa103e[_0x3e6134(0x6b6)](_0x183ed4);});}async function _0x5ef211(){const _0x459025=_0x3ce1fb,_0x3e2c0d=_0x16699d[_0x459025(0x1474)][_0x16699d[_0x459025(0xf5a)]];if(!_0x3e2c0d)return;let _0x18aa11=_0x3e2c0d;if(_0x3e2c0d[_0x459025(0x1173)]){const _0xc046ca=_0x3e2c0d[_0x459025(0x10a2)]['map'](_0x57bd0b=>({'text':'为“'+_0x57bd0b[_0x459025(0x347)]+_0x459025(0x153b),'value':_0x57bd0b['id']})),_0x1a14ac=await _0x9286bb(_0x459025(0x13e5),_0xc046ca);if(!_0x1a14ac)return;_0x18aa11=_0x16699d['chats'][_0x1a14ac];if(!_0x18aa11){alert(_0x459025(0x7fc));return;}}const _0xd78532=await _0x41b9fc('为“'+_0x18aa11['name']+_0x459025(0x153b),'请输入要添加的记忆要点：','',_0x459025(0xc1e));if(_0xd78532&&_0xd78532[_0x459025(0x2a8)]()){if(!_0x18aa11[_0x459025(0x758)])_0x18aa11[_0x459025(0x758)]=[];_0x18aa11[_0x459025(0x758)][_0x459025(0x1001)]({'content':_0xd78532[_0x459025(0x2a8)](),'timestamp':Date[_0x459025(0x1386)](),'source':_0x459025(0xef5)}),await _0x6ed281[_0x459025(0x1474)][_0x459025(0x90c)](_0x18aa11),_0x47ddd6();}}async function _0x4e85a8(_0x3ffefa,_0x7a34b3){const _0x3f558e=_0x3ce1fb,_0x49c7d1=_0x16699d[_0x3f558e(0x1474)][_0x3ffefa];if(!_0x49c7d1||!_0x49c7d1[_0x3f558e(0x758)])return;const _0xd31d43=_0x49c7d1['longTermMemory'][_0x3f558e(0x1018)](_0x9aec2a=>_0x9aec2a['timestamp']===_0x7a34b3);if(_0xd31d43===-0x1)return;const _0x55b592=_0x49c7d1[_0x3f558e(0x758)][_0xd31d43],_0x391792=await _0x41b9fc(_0x3f558e(0xd21),_0x3f558e(0xb1e),_0x55b592[_0x3f558e(0xede)],_0x3f558e(0xc1e));_0x391792&&_0x391792[_0x3f558e(0x2a8)]()&&(_0x55b592[_0x3f558e(0xede)]=_0x391792[_0x3f558e(0x2a8)](),await _0x6ed281[_0x3f558e(0x1474)][_0x3f558e(0x90c)](_0x49c7d1),_0x47ddd6());}async function _0x5a16d7(_0x28e583,_0x202098){const _0x55fa68=_0x3ce1fb,_0x382e8f=await _0xa6b74a(_0x55fa68(0x8ed),_0x55fa68(0xfaa),{'confirmButtonClass':_0x55fa68(0x5e8)});if(_0x382e8f){const _0x271da9=_0x16699d[_0x55fa68(0x1474)][_0x28e583];if(!_0x271da9||!_0x271da9[_0x55fa68(0x758)])return;_0x271da9['longTermMemory']=_0x271da9[_0x55fa68(0x758)]['filter'](_0x559339=>_0x559339[_0x55fa68(0xb0a)]!==_0x202098),await _0x6ed281[_0x55fa68(0x1474)][_0x55fa68(0x90c)](_0x271da9),_0x47ddd6();}}async function _0x26b47c(){const _0x3e3f34=_0x3ce1fb,_0x2e8be0=await _0xa6b74a(_0x3e3f34(0xc03),_0x3e3f34(0x1160));_0x2e8be0&&await _0x21c302(_0x16699d[_0x3e3f34(0xf5a)],!![]);}async function _0x2d6af6(_0x5a80c8){const _0xc6bf5e=_0x3ce1fb,_0x23a1c3=_0x16699d[_0xc6bf5e(0x1474)][_0x5a80c8];if(!_0x23a1c3||!_0x23a1c3['settings'][_0xc6bf5e(0x151c)])return;const _0x2b5117=_0x23a1c3[_0xc6bf5e(0xd6a)]||0x0,_0x3e15f2=_0x23a1c3[_0xc6bf5e(0xb07)][_0xc6bf5e(0x1c0)](_0x42673d=>_0x42673d[_0xc6bf5e(0xb0a)]>_0x2b5117&&!_0x42673d[_0xc6bf5e(0x583)]);_0x3e15f2[_0xc6bf5e(0xaf9)]>=_0x23a1c3[_0xc6bf5e(0x7fd)][_0xc6bf5e(0x6dc)]&&(console[_0xc6bf5e(0x498)]('达到自动总结阈值\x20('+_0x3e15f2[_0xc6bf5e(0xaf9)]+'/'+_0x23a1c3[_0xc6bf5e(0x7fd)][_0xc6bf5e(0x6dc)]+_0xc6bf5e(0x13a7)),await _0x21c302(_0x5a80c8));}async function _0x5513dd(_0x7eab88,_0x8ee62e){const _0x44807c=_0x3ce1fb,_0xa37d08=_0x16699d['chats'][_0x7eab88];if(!_0xa37d08||!_0x8ee62e)throw new Error(_0x44807c(0x104c));const _0x451643=_0x16699d[_0x44807c(0x66e)][_0x44807c(0xf4d)]||'用户';let _0x3b8d20,_0x435935=_0xa37d08;const _0x556688=new Date()[_0x44807c(0xf98)]('zh-CN',{'year':'numeric','month':_0x44807c(0x97c),'day':'numeric'});if(_0xa37d08['isGroup']){let _0x46d059=null;_0x1c6d6b[_0x44807c(0xcd5)]&&(_0x46d059=_0xa37d08[_0x44807c(0x10a2)]['find'](_0xa36039=>_0xa36039[_0x44807c(0x628)]===_0x1c6d6b[_0x44807c(0xcd5)]));!_0x46d059&&(_0x46d059=_0xa37d08[_0x44807c(0x10a2)][_0x44807c(0x1402)](_0x147267=>_0x147267['id']!==_0x44807c(0xaeb)&&_0x1c6d6b[_0x44807c(0x112b)]['some'](_0x41325c=>_0x41325c['id']===_0x147267['id'])));!_0x46d059&&(_0x46d059=_0xa37d08[_0x44807c(0x10a2)][_0x44807c(0x1402)](_0xab1c8a=>_0xab1c8a['id']!==_0x44807c(0xaeb)));if(!_0x46d059)throw new Error('群聊通话中没有找到可作为总结主体的AI角色。');const _0x4a8a11=_0x16699d[_0x44807c(0x1474)][_0x46d059['id']];if(!_0x4a8a11)throw new Error(_0x44807c(0xc45)+_0x46d059['groupNickname']+_0x44807c(0xc18));const _0x3fe3a6=_0xa37d08[_0x44807c(0x7fd)][_0x44807c(0x13b6)]||_0x44807c(0x572);_0x3b8d20=_0x44807c(0x204)+_0x46d059[_0x44807c(0x628)]+_0x44807c(0x880)+_0x451643+'”\x20以及其他群成员的【群组视频通话】，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：'+_0x556688+_0x44807c(0x136f)+_0x556688+_0x44807c(0xeff)+_0x4a8a11[_0x44807c(0x7fd)][_0x44807c(0x14c1)]+_0x44807c(0x6ae)+_0x3fe3a6+_0x44807c(0x12af)+_0x8ee62e+_0x44807c(0x268)+_0x46d059[_0x44807c(0x628)]+_0x44807c(0x1ce),_0x435935=_0x4a8a11;}else _0x3b8d20='\x0a#\x20你的任务\x0a你就是角色“'+_0xa37d08[_0x44807c(0x628)]+_0x44807c(0x55e)+_0x451643+_0x44807c(0x492)+_0x556688+'**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们聊了什么核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是'+_0x556688+'”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a'+_0xa37d08['settings'][_0x44807c(0x14c1)]+_0x44807c(0x6ae)+_0xa37d08[_0x44807c(0x7fd)][_0x44807c(0x13b6)]+'\x0a\x0a#\x20待总结的视频通话记录\x0a'+_0x8ee62e+_0x44807c(0x268)+_0xa37d08['originalName']+_0x44807c(0x1ce);try{const _0x4c2751=_0x16699d[_0x44807c(0x79e)][_0x44807c(0xde5)]&&_0x16699d[_0x44807c(0x79e)][_0x44807c(0x11bf)]&&_0x16699d['apiConfig'][_0x44807c(0x688)],{proxyUrl:_0x2b05b7,apiKey:_0x52b60c,model:_0x3d694d}=_0x4c2751?{'proxyUrl':_0x16699d[_0x44807c(0x79e)][_0x44807c(0xde5)],'apiKey':_0x16699d[_0x44807c(0x79e)]['secondaryApiKey'],'model':_0x16699d[_0x44807c(0x79e)]['secondaryModel']}:_0x16699d[_0x44807c(0x79e)];if(!_0x2b05b7||!_0x52b60c||!_0x3d694d)throw new Error('API未配置，无法进行总结。');let _0x1fce8e=_0x2b05b7[_0x44807c(0x1336)](_0x44807c(0x708)),_0x3e8b81=_0xe8c788(_0x3d694d,_0x52b60c,_0x3b8d20,[{'role':_0x44807c(0xaeb),'content':'请开始总结。'}]);const _0x2669ee=_0x1fce8e?await fetch(_0x3e8b81['url'],_0x3e8b81[_0x44807c(0x92a)]):await fetch(_0x2b05b7+_0x44807c(0x110e),{'method':_0x44807c(0xdca),'headers':{'Content-Type':_0x44807c(0x479),'Authorization':'Bearer\x20'+_0x52b60c},'body':JSON[_0x44807c(0x526)]({'model':_0x3d694d,'messages':[{'role':_0x44807c(0x11af),'content':_0x3b8d20},{'role':_0x44807c(0xaeb),'content':_0x44807c(0x6f2)}],'temperature':0.1})});if(!_0x2669ee['ok']){const _0x5e34de=await _0x2669ee[_0x44807c(0x21d)]()['catch'](()=>({'error':{'message':_0x2669ee[_0x44807c(0x13a2)]}}));throw new Error(_0x44807c(0x969)+_0x2669ee[_0x44807c(0x82c)]+_0x44807c(0x1182)+_0x5e34de['error']['message']);}const _0x55abaf=await _0x2669ee['json']();let _0x33083d=_0x1fce8e?getGeminiResponseText(_0x55abaf):_0x55abaf[_0x44807c(0xc11)][0x0][_0x44807c(0x74b)][_0x44807c(0xede)];_0x33083d=_0x33083d[_0x44807c(0x14e9)](/^```json\s*/,'')[_0x44807c(0x14e9)](/```$/,'')[_0x44807c(0x2a8)]();const _0x4ee6c7=JSON[_0x44807c(0xde0)](_0x33083d);if(_0x4ee6c7[_0x44807c(0xf60)]&&_0x4ee6c7['summary'][_0x44807c(0x2a8)]()){const _0x4754c3={'content':_0x44807c(0x560)+(_0xa37d08[_0x44807c(0x1173)]?'群聊':'')+'通话中，'+_0x4ee6c7[_0x44807c(0xf60)][_0x44807c(0x2a8)]()+')','timestamp':Date[_0x44807c(0x1386)](),'source':_0xa37d08[_0x44807c(0x1173)]?_0x44807c(0x1b8):_0x44807c(0xbc5)};if(!_0x435935['longTermMemory'])_0x435935[_0x44807c(0x758)]=[];return _0x435935['longTermMemory'][_0x44807c(0x1001)](_0x4754c3),await _0x6ed281[_0x44807c(0x1474)][_0x44807c(0x90c)](_0x435935),console[_0x44807c(0x498)](_0x44807c(0x324)+_0x435935[_0x44807c(0x1467)]+_0x44807c(0x28d)),!![];}else throw new Error(_0x44807c(0xf1e));}catch(_0x127c32){console['error']('总结通话记录时出错:',_0x127c32);throw _0x127c32;}}function _0x15ebb0(_0x345672){const _0x592178=_0x3ce1fb,_0x4140ad=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯','什么','怎么','为什么','哪个','一些','这个','那个','还有']),_0x3aaae5=_0x345672['match'](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x599875=new Map();let _0x588e91=0x0;_0x3aaae5[_0x592178(0x427)](_0x2d837f=>{const _0x30e3b8=_0x592178;if(_0x2d837f[_0x30e3b8(0xaf9)]>0x1&&!_0x4140ad[_0x30e3b8(0xda1)](_0x2d837f)){const _0x306a80=(_0x599875[_0x30e3b8(0xe8c)](_0x2d837f)||0x0)+0x1;_0x599875[_0x30e3b8(0x450)](_0x2d837f,_0x306a80);if(_0x306a80>_0x588e91)_0x588e91=_0x306a80;}});const _0x3a20d8=[],_0xe30b0=[],_0x1b4127=_0x588e91*0.9,_0x56f956=_0x588e91*0.6;_0x599875[_0x592178(0x427)]((_0xa457d1,_0x5ce549)=>{const _0x4e5eae=_0x592178;if(_0xa457d1>=_0x1b4127)_0x3a20d8[_0x4e5eae(0x1001)](_0x5ce549);else _0xa457d1>=_0x56f956&&_0xe30b0[_0x4e5eae(0x1001)](_0x5ce549);});const _0x4cb4b3=new Set(_0x3a20d8),_0x44993c=_0xe30b0[_0x592178(0x1c0)](_0x5593e8=>!_0x4cb4b3['has'](_0x5593e8))['slice'](0x0,0x5);return{'coreKeywords':_0x3a20d8[_0x592178(0x200)](0x0,0x3),'situationalKeywords':_0x44993c};}function _0x989347(_0x220ead,_0x27625f,_0x1a07cf){const _0x229acf=_0x3ce1fb;let _0x4b48f8;_0x1a07cf==='hours'?_0x4b48f8=Date['now']()-_0x27625f*0x3c*0x3c*0x3e8:_0x4b48f8=Date['now']()-_0x27625f*0x18*0x3c*0x3c*0x3e8;const _0x40959a=_0x220ead[_0x229acf(0xb07)][_0x229acf(0x1c0)](_0x1e3a5a=>_0x1e3a5a['timestamp']>_0x4b48f8&&!_0x1e3a5a[_0x229acf(0x583)]);if(_0x40959a[_0x229acf(0xaf9)]<0x3)return'';const _0x3d8f1c=_0x40959a[_0x229acf(0x8ff)](_0x55098e=>{const _0x5e9ced=_0x229acf;if(typeof _0x55098e['content']===_0x5e9ced(0x273))return _0x55098e[_0x5e9ced(0xede)];if(_0x55098e[_0x5e9ced(0x4ae)]===_0x5e9ced(0x10d4))return _0x55098e[_0x5e9ced(0xede)];if(_0x55098e['type']===_0x5e9ced(0xd5f))return(_0x55098e['dialogue']||'')+'\x20'+(_0x55098e[_0x5e9ced(0xe79)]||'');return'';})[_0x229acf(0x121a)]('\x20'),_0xfe1500=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯']),_0x32b23c=_0x3d8f1c['match'](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x3d5624=new Map();_0x32b23c[_0x229acf(0x427)](_0x292a86=>{const _0x267930=_0x229acf;_0x292a86['length']>0x1&&!_0xfe1500[_0x267930(0xda1)](_0x292a86)&&_0x3d5624['set'](_0x292a86,(_0x3d5624[_0x267930(0xe8c)](_0x292a86)||0x0)+0x1);});const _0x50305f=[..._0x3d5624[_0x229acf(0x6ea)]()][_0x229acf(0xe96)]((_0x1471f7,_0x313db2)=>_0x313db2[0x1]-_0x1471f7[0x1])['map'](_0xe50e4f=>_0xe50e4f[0x0]);if(_0x50305f[_0x229acf(0xaf9)]===0x0)return'';let _0xf8b17f;return _0x1a07cf==='hours'?_0xf8b17f='最近'+_0x27625f+'小时核心议题':_0x27625f===0x1?_0xf8b17f='本日核心议题':_0xf8b17f='最近'+_0x27625f+'天核心议题',_0x229acf(0x9d4)+_0xf8b17f+'**:\x20关于\x20**'+_0x50305f['slice'](0x0,0x3)[_0x229acf(0x121a)]('、\x20')+'**。';}function _0x145ba2(_0x10d6fb){const _0x563e8a=_0x3ce1fb;if(!_0x10d6fb||typeof _0x10d6fb!==_0x563e8a(0x273))return null;const _0x3ed8e0=_0x10d6fb[_0x563e8a(0x14e9)](/^```json\s*/,'')[_0x563e8a(0x14e9)](/```$/,'')[_0x563e8a(0x2a8)](),_0x409662=_0x3ed8e0[_0x563e8a(0x9a3)](/{[\s\S]*}/);if(_0x409662)try{const _0x29c777=JSON['parse'](_0x409662[0x0]);return console[_0x563e8a(0x498)](_0x563e8a(0xceb)),_0x29c777;}catch(_0x52c0f1){console[_0x563e8a(0x9c1)]('容错解析：策略1失败\x20(找到了JSON块，但格式错误)，将尝试策略2...');}const _0x3fa2a8=_0x3ed8e0['match'](/"summary"\s*:\s*"((?:[^"\\]|\\.)*)"/);if(_0x3fa2a8&&_0x3fa2a8[0x1])return console['log'](_0x563e8a(0xc83)),{'summary':_0x3fa2a8[0x1][_0x563e8a(0x14e9)](/\\"/g,'\x22')};if(_0x3ed8e0)return console[_0x563e8a(0x498)](_0x563e8a(0x13f9)),{'summary':_0x3ed8e0};return null;}async function _0x224d5b(_0x380072){const _0x31ab9a=_0x3ce1fb;let _0x2bffdc=_0x16699d[_0x31ab9a(0x1474)][_0x380072];if(!_0x2bffdc)return;let _0x7d2943=_0x2bffdc;if(_0x2bffdc[_0x31ab9a(0x1173)]){const _0x5ed372=_0x2bffdc[_0x31ab9a(0x10a2)][_0x31ab9a(0x8ff)](_0x537fb8=>{const _0x5edb3f=_0x31ab9a,_0x4c9d6a=_0x16699d[_0x5edb3f(0x1474)][_0x537fb8['id']];if(_0x4c9d6a&&_0x4c9d6a[_0x5edb3f(0x758)]&&_0x4c9d6a['longTermMemory'][_0x5edb3f(0xaf9)]>=0x2)return{'text':_0x5edb3f(0x835)+_0x537fb8[_0x5edb3f(0x347)]+'”的记忆\x20('+_0x4c9d6a[_0x5edb3f(0x758)][_0x5edb3f(0xaf9)]+'条)','value':_0x537fb8['id']};return null;})[_0x31ab9a(0x1c0)](Boolean);if(_0x5ed372[_0x31ab9a(0xaf9)]===0x0){alert(_0x31ab9a(0xd01));return;}const _0x1b191c=await _0x9286bb('选择要精炼记忆的角色',_0x5ed372);if(!_0x1b191c)return;_0x7d2943=_0x16699d[_0x31ab9a(0x1474)][_0x1b191c];}if(!_0x7d2943[_0x31ab9a(0x758)]||_0x7d2943[_0x31ab9a(0x758)][_0x31ab9a(0xaf9)]<0x2){alert('“'+_0x7d2943[_0x31ab9a(0x1467)]+'”的长期记忆少于2条，无需进行精炼。');return;}const _0x38f9e2=_0x7d2943[_0x31ab9a(0x758)][_0x31ab9a(0xaf9)],_0x28ec5a=await _0x9286bb(_0x31ab9a(0x1297),[{'text':'全部记忆\x20('+_0x38f9e2+'条)','value':_0x31ab9a(0xd49)},{'text':_0x31ab9a(0x15bd),'value':'20'},{'text':_0x31ab9a(0x5cf),'value':'50'},{'text':_0x31ab9a(0x10c6),'value':_0x31ab9a(0x675)},{'text':_0x31ab9a(0xf99),'value':'custom'}]['filter'](_0x592ac6=>_0x592ac6[_0x31ab9a(0x5bc)]==='all'||_0x592ac6[_0x31ab9a(0x5bc)]==='custom'||parseInt(_0x592ac6[_0x31ab9a(0x5bc)])<_0x38f9e2));if(_0x28ec5a===null)return;let _0x468e1d,_0x3a087d=_0x38f9e2;if(_0x28ec5a===_0x31ab9a(0xd49))_0x468e1d=[..._0x7d2943[_0x31ab9a(0x758)]];else{if(_0x28ec5a===_0x31ab9a(0x1310)){const _0x2cb00d=await _0x41b9fc(_0x31ab9a(0x462),_0x31ab9a(0x555)+_0x38f9e2+_0x31ab9a(0x120f));if(_0x2cb00d===null)return;const _0x2e3922=parseInt(_0x2cb00d);if(isNaN(_0x2e3922)||_0x2e3922<0x2||_0x2e3922>_0x38f9e2){alert(_0x31ab9a(0x98c)+_0x38f9e2+_0x31ab9a(0xe92));return;}_0x3a087d=_0x2e3922,_0x468e1d=_0x7d2943[_0x31ab9a(0x758)][_0x31ab9a(0x200)](-_0x3a087d);}else _0x3a087d=parseInt(_0x28ec5a),_0x3a087d>=_0x38f9e2?(_0x468e1d=[..._0x7d2943[_0x31ab9a(0x758)]],_0x3a087d=_0x38f9e2):_0x468e1d=_0x7d2943['longTermMemory'][_0x31ab9a(0x200)](-_0x3a087d);}const _0x560a17=await _0x41b9fc(_0x31ab9a(0x8b8),_0x31ab9a(0x381),'150');if(_0x560a17===null)return;const _0x35c385=parseInt(_0x560a17);if(isNaN(_0x35c385)||_0x35c385<0x14){alert(_0x31ab9a(0x3a7));return;}const _0x49ff5a=await _0xa6b74a('确认精炼记忆？','此操作会将选定的\x20'+_0x3a087d+_0x31ab9a(0xcbc)+_0x35c385+_0x31ab9a(0x64e),{'confirmButtonClass':_0x31ab9a(0x5e8),'confirmText':_0x31ab9a(0x7ec)});if(!_0x49ff5a)return;const _0x30dce8=_0x468e1d[_0x31ab9a(0x8ff)](_0x3e8d9b=>'-\x20'+_0x3e8d9b[_0x31ab9a(0xede)])[_0x31ab9a(0x121a)]('\x0a'),_0x54859a=_0x16699d[_0x31ab9a(0x66e)]['nickname']||'用户',_0x3c6847=new Date()['toLocaleDateString'](_0x31ab9a(0x144f),{'year':_0x31ab9a(0x8bb),'month':'long','day':_0x31ab9a(0x8bb)}),_0x415237='\x0a#\x20你的任务\x0a你就是角色“'+_0x7d2943[_0x31ab9a(0x628)]+_0x31ab9a(0xa3f)+_0x54859a+_0x31ab9a(0x7aa)+_0x3c6847+_0x31ab9a(0xf11)+_0x3c6847+_0x31ab9a(0x1259)+_0x35c385+_0x31ab9a(0x68f)+_0x7d2943[_0x31ab9a(0x7fd)]['aiPersona']+'\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a'+_0x7d2943[_0x31ab9a(0x7fd)]['myPersona']+_0x31ab9a(0xc68)+_0x30dce8+_0x31ab9a(0x268)+_0x7d2943[_0x31ab9a(0x628)]+_0x31ab9a(0x1a3);await _0x104485('请稍候...',_0x31ab9a(0x5f5));try{const _0x3b2047=_0x16699d[_0x31ab9a(0x79e)]['secondaryProxyUrl']&&_0x16699d['apiConfig'][_0x31ab9a(0x11bf)]&&_0x16699d[_0x31ab9a(0x79e)][_0x31ab9a(0x688)],{proxyUrl:_0x6c70ce,apiKey:_0x49d675,model:_0x147183}=_0x3b2047?{'proxyUrl':_0x16699d['apiConfig'][_0x31ab9a(0xde5)],'apiKey':_0x16699d[_0x31ab9a(0x79e)][_0x31ab9a(0x11bf)],'model':_0x16699d[_0x31ab9a(0x79e)][_0x31ab9a(0x688)]}:_0x16699d['apiConfig'];if(!_0x6c70ce||!_0x49d675||!_0x147183)throw new Error(_0x31ab9a(0x839));let _0x7aafc8=_0x6c70ce[_0x31ab9a(0x1336)](_0x31ab9a(0x708)),_0x4aa479=_0xe8c788(_0x147183,_0x49d675,_0x415237,[{'role':_0x31ab9a(0xaeb),'content':_0x31ab9a(0x1127)}]);const _0x527553=_0x7aafc8?await fetch(_0x4aa479[_0x31ab9a(0x9a8)],_0x4aa479[_0x31ab9a(0x92a)]):await fetch(_0x6c70ce+'/v1/chat/completions',{'method':_0x31ab9a(0xdca),'headers':{'Content-Type':_0x31ab9a(0x479),'Authorization':_0x31ab9a(0xb0e)+_0x49d675},'body':JSON[_0x31ab9a(0x526)]({'model':_0x147183,'messages':[{'role':_0x31ab9a(0x11af),'content':_0x415237},{'role':'user','content':_0x31ab9a(0x1127)}],'temperature':0.2})});if(!_0x527553['ok'])throw new Error(_0x31ab9a(0x69a)+_0x527553[_0x31ab9a(0x13a2)]);const _0x6da941=await _0x527553[_0x31ab9a(0x21d)]();let _0x1a89bb=_0x7aafc8?getGeminiResponseText(_0x6da941):_0x6da941[_0x31ab9a(0xc11)][0x0][_0x31ab9a(0x74b)]['content'];const _0x45912b=_0x145ba2(_0x1a89bb);if(_0x45912b&&_0x45912b['summary']&&typeof _0x45912b[_0x31ab9a(0xf60)]===_0x31ab9a(0x273)&&_0x45912b['summary'][_0x31ab9a(0x2a8)]()){const _0x435f1a=await _0xa6b74a(_0x31ab9a(0x1316),_0x31ab9a(0x1099)+_0x3a087d+_0x31ab9a(0xb17)+_0x45912b[_0x31ab9a(0xf60)][_0x31ab9a(0x2a8)]()+'</div><br>是否用这条新记忆替换掉这些旧记忆？',{'confirmText':_0x31ab9a(0x130e),'cancelText':_0x31ab9a(0x800),'confirmButtonClass':'btn-danger'});if(_0x435f1a){const _0x18e56c={'content':_0x45912b['summary'][_0x31ab9a(0x2a8)](),'timestamp':Date[_0x31ab9a(0x1386)](),'source':_0x31ab9a(0x208)},_0x168b8f=_0x38f9e2-_0x3a087d,_0x5a6fd3=_0x168b8f>0x0?_0x7d2943[_0x31ab9a(0x758)][_0x31ab9a(0x200)](0x0,_0x168b8f):[];_0x7d2943[_0x31ab9a(0x758)]=[..._0x5a6fd3,_0x18e56c],_0x7d2943['lastMemorySummaryTimestamp']=Date[_0x31ab9a(0x1386)](),await _0x6ed281[_0x31ab9a(0x1474)][_0x31ab9a(0x90c)](_0x7d2943),document[_0x31ab9a(0x948)](_0x31ab9a(0xad4))[_0x31ab9a(0xd54)][_0x31ab9a(0x7a0)](_0x31ab9a(0x115e))&&_0x47ddd6(),await _0x104485('精炼成功','已成功将\x20'+_0x3a087d+_0x31ab9a(0xff8));}else await _0x104485(_0x31ab9a(0x121d),_0x31ab9a(0x2ff));}else throw new Error(_0x31ab9a(0xf1e));}catch(_0x51a4dd){console[_0x31ab9a(0xc3e)]('精炼长期记忆时出错:',_0x51a4dd),await _0x104485(_0x31ab9a(0x11bb),_0x31ab9a(0x9c7)+_0x51a4dd[_0x31ab9a(0x74b)]);}}async function _0x21c302(_0x542d59,_0x126d91=![]){const _0x1b40b8=_0x3ce1fb,_0x46c5c6=_0x16699d['chats'][_0x542d59];if(!_0x46c5c6)return;const _0x51d5e1=_0x46c5c6[_0x1b40b8(0xd6a)]||0x0,_0x46d3a1=_0x126d91?_0x46c5c6['history']['filter'](_0x27e6b4=>!_0x27e6b4['isHidden']||_0x27e6b4['role']==='system'&&_0x27e6b4[_0x1b40b8(0xede)][_0x1b40b8(0x1336)](_0x1b40b8(0x70b)))[_0x1b40b8(0x200)](-(_0x46c5c6[_0x1b40b8(0x7fd)][_0x1b40b8(0x6dc)]||0x14)):_0x46c5c6['history'][_0x1b40b8(0x1c0)](_0x31cc39=>_0x31cc39[_0x1b40b8(0xb0a)]>_0x51d5e1&&(!_0x31cc39['isHidden']||_0x31cc39[_0x1b40b8(0x1554)]==='system'&&_0x31cc39[_0x1b40b8(0xede)]['includes'](_0x1b40b8(0x70b))));if(_0x46d3a1[_0x1b40b8(0xaf9)]<0x5){if(_0x126d91)alert('最近的消息太少，无法进行有意义的总结。');return;}const _0x201ae6=_0x16699d[_0x1b40b8(0x66e)][_0x1b40b8(0xf4d)]||'用户',_0x5e0a14=_0x46d3a1[_0x1b40b8(0x8ff)](_0x37a52e=>{const _0x4bade2=_0x1b40b8;if(_0x37a52e[_0x4bade2(0x583)]&&_0x37a52e[_0x4bade2(0x1554)]==='system'&&_0x37a52e[_0x4bade2(0xede)][_0x4bade2(0x1336)](_0x4bade2(0x70b)))return _0x37a52e[_0x4bade2(0xede)];let _0x23ce3c;_0x37a52e['role']===_0x4bade2(0xaeb)?_0x23ce3c=_0x201ae6:_0x23ce3c=_0x37a52e['senderName']||_0x46c5c6[_0x4bade2(0x628)];let _0xc72083='';if(_0x37a52e[_0x4bade2(0x4ae)]===_0x4bade2(0xd5f)){if(_0x37a52e[_0x4bade2(0xede)])_0xc72083=_0x37a52e[_0x4bade2(0xede)];else{const _0x27f3f6=_0x37a52e[_0x4bade2(0x13c5)]?'「'+_0x37a52e[_0x4bade2(0x13c5)]+'」':'',_0x5f3a1e=_0x37a52e[_0x4bade2(0xe79)]?'('+_0x37a52e[_0x4bade2(0xe79)]+')':'';_0xc72083=(_0x27f3f6+'\x20'+_0x5f3a1e)['trim']();}}else _0xc72083=String(_0x37a52e[_0x4bade2(0xede)]);return _0x23ce3c+':\x20'+_0xc72083;})['join']('\x0a');let _0x31a04e;if(_0x46c5c6[_0x1b40b8(0x1173)])_0x31a04e=_0x1b40b8(0xb35)+_0x201ae6+_0x1b40b8(0xbd1)+_0x5e0a14+'\x0a#\x20群成员列表\x20(你的总结目标)\x0a'+_0x46c5c6[_0x1b40b8(0x10a2)][_0x1b40b8(0x8ff)](_0x2623e2=>'-\x20'+_0x2623e2[_0x1b40b8(0x347)]+_0x1b40b8(0x413)+_0x2623e2[_0x1b40b8(0x628)]+')')[_0x1b40b8(0x121a)]('\x0a')+_0x1b40b8(0x42a);else{const _0x22f603=new Date()[_0x1b40b8(0xf98)](_0x1b40b8(0x144f),{'year':_0x1b40b8(0x8bb),'month':_0x1b40b8(0x97c),'day':_0x1b40b8(0x8bb)});_0x31a04e=_0x1b40b8(0x204)+_0x46c5c6[_0x1b40b8(0x628)]+_0x1b40b8(0x55e)+_0x201ae6+_0x1b40b8(0x988)+_0x22f603+_0x1b40b8(0xa28)+_0x22f603+_0x1b40b8(0x2af)+new Date(Date[_0x1b40b8(0x1386)]()+0x5265c00)[_0x1b40b8(0xf98)](_0x1b40b8(0x144f),{'month':'long','day':'numeric'})+_0x1b40b8(0x8d4)+_0x46c5c6[_0x1b40b8(0x7fd)][_0x1b40b8(0x14c1)]+'\x0a#\x20你的聊天对象（用户）的人设\x0a'+_0x46c5c6[_0x1b40b8(0x7fd)][_0x1b40b8(0x13b6)]+_0x1b40b8(0x4d7)+_0x5e0a14+_0x1b40b8(0x268)+_0x46c5c6[_0x1b40b8(0x628)]+_0x1b40b8(0x1ce);}try{const _0x18b9fa=_0x16699d['apiConfig'][_0x1b40b8(0xde5)]&&_0x16699d[_0x1b40b8(0x79e)][_0x1b40b8(0x11bf)]&&_0x16699d[_0x1b40b8(0x79e)][_0x1b40b8(0x688)],{proxyUrl:_0x287419,apiKey:_0x25a1f5,model:_0x1c377e}=_0x18b9fa?{'proxyUrl':_0x16699d[_0x1b40b8(0x79e)][_0x1b40b8(0xde5)],'apiKey':_0x16699d['apiConfig'][_0x1b40b8(0x11bf)],'model':_0x16699d[_0x1b40b8(0x79e)]['secondaryModel']}:_0x16699d[_0x1b40b8(0x79e)];if(!_0x287419||!_0x25a1f5||!_0x1c377e)throw new Error('API未配置');let _0x35c20b=_0x287419['includes'](_0x1b40b8(0x708)),_0x192770=_0xe8c788(_0x1c377e,_0x25a1f5,_0x31a04e,[{'role':_0x1b40b8(0xaeb),'content':_0x1b40b8(0x6f2)}]);const _0x447ae7=_0x35c20b?await fetch(_0x192770[_0x1b40b8(0x9a8)],_0x192770['data']):await fetch(_0x287419+_0x1b40b8(0x110e),{'method':_0x1b40b8(0xdca),'headers':{'Content-Type':'application/json','Authorization':_0x1b40b8(0xb0e)+_0x25a1f5},'body':JSON['stringify']({'model':_0x1c377e,'messages':[{'role':_0x1b40b8(0x11af),'content':_0x31a04e},{'role':'user','content':'请开始总结。'}],'temperature':0.2})});if(!_0x447ae7['ok'])throw new Error('API\x20错误:\x20'+_0x447ae7[_0x1b40b8(0x13a2)]);const _0x4884f3=await _0x447ae7[_0x1b40b8(0x21d)]();let _0x180afc=_0x35c20b?getGeminiResponseText(_0x4884f3):_0x4884f3['choices'][0x0][_0x1b40b8(0x74b)][_0x1b40b8(0xede)];_0x180afc=_0x180afc[_0x1b40b8(0x14e9)](/^```json\s*/,'')[_0x1b40b8(0x14e9)](/```$/,'')[_0x1b40b8(0x2a8)]();const _0x52c932=JSON[_0x1b40b8(0xde0)](_0x180afc);if(_0x46c5c6[_0x1b40b8(0x1173)]){if(_0x52c932[_0x1b40b8(0x8e5)]&&typeof _0x52c932[_0x1b40b8(0x8e5)]===_0x1b40b8(0xd43)){let _0x39c670=0x0;for(const _0x1dd1e6 in _0x52c932[_0x1b40b8(0x8e5)]){const _0x2246c5=_0x52c932['summaries'][_0x1dd1e6];if(_0x2246c5&&_0x2246c5[_0x1b40b8(0x2a8)]()){const _0x50990f=Object['values'](_0x16699d['chats'])[_0x1b40b8(0x1402)](_0x377722=>_0x377722[_0x1b40b8(0x628)]===_0x1dd1e6);if(_0x50990f){const _0x1870c2={'content':_0x2246c5[_0x1b40b8(0x2a8)](),'timestamp':Date['now'](),'source':_0x1b40b8(0xd82)+_0x46c5c6[_0x1b40b8(0x1467)]};if(!_0x50990f[_0x1b40b8(0x758)])_0x50990f[_0x1b40b8(0x758)]=[];_0x50990f['longTermMemory'][_0x1b40b8(0x1001)](_0x1870c2),await _0x6ed281[_0x1b40b8(0x1474)]['put'](_0x50990f),_0x39c670++;}}}if(_0x39c670>0x0)console[_0x1b40b8(0x498)](_0x1b40b8(0x124c)+_0x39c670+_0x1b40b8(0x13e8));else throw new Error(_0x1b40b8(0xf1e));}else throw new Error(_0x1b40b8(0xad0));}else{if(_0x52c932[_0x1b40b8(0xf60)]&&_0x52c932[_0x1b40b8(0xf60)][_0x1b40b8(0x2a8)]()){const _0x269a07={'content':_0x52c932[_0x1b40b8(0xf60)][_0x1b40b8(0x2a8)](),'timestamp':Date[_0x1b40b8(0x1386)](),'source':_0x1b40b8(0x1098)};_0x46c5c6[_0x1b40b8(0x758)][_0x1b40b8(0x1001)](_0x269a07),await _0x6ed281[_0x1b40b8(0x1474)]['put'](_0x46c5c6),console['log']('自动总结成功：已成功添加\x201\x20条新的长期记忆！');}else throw new Error(_0x1b40b8(0xf1e));}_0x46c5c6[_0x1b40b8(0xd6a)]=_0x46d3a1['slice'](-0x1)[0x0][_0x1b40b8(0xb0a)],await _0x6ed281[_0x1b40b8(0x1474)][_0x1b40b8(0x90c)](_0x46c5c6),document['getElementById']('long-term-memory-screen')[_0x1b40b8(0xd54)][_0x1b40b8(0x7a0)](_0x1b40b8(0x115e))&&_0x47ddd6();}catch(_0x291752){console[_0x1b40b8(0xc3e)]('总结长期记忆时出错:',_0x291752),await _0x104485(_0x1b40b8(0x34b),_0x1b40b8(0x689)+_0x291752[_0x1b40b8(0x74b)]);}}function _0x4099d1(){const _0x2acf11=_0x3ce1fb;if(!_0x441f4f)return;const _0xe77dfb=_0x16699d[_0x2acf11(0x1474)][_0x16699d[_0x2acf11(0xf5a)]],_0x3d5b80=_0xe77dfb[_0x2acf11(0xb07)][_0x2acf11(0x1402)](_0x87b37b=>_0x87b37b['timestamp']===_0x441f4f&&!_0x87b37b[_0x2acf11(0x583)]);if(!_0x3d5b80)return;let _0x404e35;_0x3d5b80[_0x2acf11(0x1554)]==='user'?_0x404e35=_0xe77dfb['isGroup']?_0xe77dfb['settings'][_0x2acf11(0x1371)]||'我':'我':_0xe77dfb[_0x2acf11(0x1173)]?_0x404e35=_0x589066(_0xe77dfb,_0x3d5b80[_0x2acf11(0x14ee)]):_0x404e35=_0xe77dfb['name'];const _0xc574c=String(_0x3d5b80['content']||'');let _0x1100e0='';if(typeof _0x3d5b80[_0x2acf11(0xede)]===_0x2acf11(0x273)&&_0x346c[_0x2acf11(0x367)](_0x3d5b80[_0x2acf11(0xede)]))_0x1100e0=_0x2acf11(0x7eb);else{if(_0x3d5b80[_0x2acf11(0x4ae)]==='ai_image'||_0x3d5b80[_0x2acf11(0x4ae)]===_0x2acf11(0x368))_0x1100e0='[图片]';else _0x3d5b80['type']==='voice_message'?_0x1100e0='[语音]':_0x1100e0=_0xc574c['substring'](0x0,0x32)+(_0xc574c[_0x2acf11(0xaf9)]>0x32?'...':'');}_0x1dd459={'timestamp':_0x3d5b80['timestamp'],'senderName':_0x404e35,'content':_0xc574c};const _0x2d0ba9=document[_0x2acf11(0x948)](_0x2acf11(0x123e));_0x2d0ba9[_0x2acf11(0xfeb)]('.sender')['textContent']='回复\x20'+_0x1dd459['senderName']+':',_0x2d0ba9[_0x2acf11(0xfeb)](_0x2acf11(0x81b))['textContent']=_0x1100e0,_0x2d0ba9[_0x2acf11(0xf74)][_0x2acf11(0x11fd)]=_0x2acf11(0x1273),_0x115ec8(),document[_0x2acf11(0x948)](_0x2acf11(0x933))[_0x2acf11(0x348)]();}function _0x30b828(){const _0xd0c5fd=_0x3ce1fb;_0x1dd459=null,document[_0xd0c5fd(0x948)](_0xd0c5fd(0x123e))[_0xd0c5fd(0xf74)]['display']=_0xd0c5fd(0x12fe);}let _0x1019c7=null;function _0x37a552(_0x4d56a7){const _0x33fef0=_0x3ce1fb;_0x1019c7=_0x4d56a7;const _0x42643c=_0x16699d[_0x33fef0(0x1474)][_0x16699d[_0x33fef0(0xf5a)]],_0x16efdb=_0x42643c['history'][_0x33fef0(0x1402)](_0x409472=>_0x409472[_0x33fef0(0xb0a)]===_0x4d56a7);_0x16efdb&&(document[_0x33fef0(0x948)]('transfer-sender-name')['textContent']=_0x16efdb[_0x33fef0(0x14ee)]),document[_0x33fef0(0x948)](_0x33fef0(0x14fa))[_0x33fef0(0xd54)]['add'](_0x33fef0(0xfcb));}function _0x52a80f(){const _0x29892b=_0x3ce1fb;document['getElementById'](_0x29892b(0x14fa))['classList'][_0x29892b(0xf89)](_0x29892b(0xfcb)),_0x1019c7=null;}async function _0xfd429(_0x1f40ba){const _0xe72c53=_0x3ce1fb;if(!_0x1019c7)return;const _0x30b8a6=_0x1019c7,_0x2a0e8b=_0x16699d[_0xe72c53(0x1474)][_0x16699d[_0xe72c53(0xf5a)]],_0x2afc3a=_0x2a0e8b[_0xe72c53(0xb07)][_0xe72c53(0x1018)](_0x3c77a2=>_0x3c77a2['timestamp']===_0x30b8a6);if(_0x2afc3a===-0x1)return;const _0x2e7362=_0x2a0e8b[_0xe72c53(0xb07)][_0x2afc3a];_0x2e7362['status']=_0x1f40ba;let _0x296db4;if(_0x1f40ba==='declined'){const _0x285991={'role':_0xe72c53(0xaeb),'type':'transfer','isRefund':!![],'amount':_0x2e7362['amount'],'note':_0xe72c53(0x31c),'timestamp':Date[_0xe72c53(0x1386)]()};_0x2a0e8b['history'][_0xe72c53(0x1001)](_0x285991),_0x296db4=_0xe72c53(0x135d)+_0x2e7362[_0xe72c53(0x14ee)]+_0xe72c53(0x1df);}else _0x296db4=_0xe72c53(0x87d)+_0x2e7362[_0xe72c53(0x14ee)]+_0xe72c53(0x1df);const _0x153a31={'role':_0xe72c53(0x11af),'content':_0x296db4,'timestamp':Date['now']()+0x1,'isHidden':!![]};_0x2a0e8b[_0xe72c53(0xb07)]['push'](_0x153a31),await _0x6ed281[_0xe72c53(0x1474)][_0xe72c53(0x90c)](_0x2a0e8b),_0x52a80f(),_0x455873(_0x16699d['activeChatId']),_0x2d33eb();}async function _0x6f2c03(){const _0xbf805=_0x3ce1fb;_0x58c3b1(_0xbf805(0xdb1));const _0x2704bc=document[_0xbf805(0x948)](_0xbf805(0x12d8)),_0x1f5a7e=document[_0xbf805(0x948)]('call-history-title');_0x2704bc[_0xbf805(0xb6f)]='',_0x1f5a7e[_0xbf805(0x10cb)]=_0xbf805(0x139b);const _0x517ce0=await _0x6ed281['callRecords'][_0xbf805(0x1088)]('timestamp')[_0xbf805(0xb26)]()[_0xbf805(0x443)]();if(_0x517ce0[_0xbf805(0xaf9)]===0x0){_0x2704bc[_0xbf805(0xb6f)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有通话记录哦~</p>';return;}_0x517ce0[_0xbf805(0x427)](_0x57f4f3=>{const _0x1b7908=_0xbf805,_0xb3e652=_0x5d8521(_0x57f4f3);_0x159366(_0xb3e652,async()=>{const _0x35addf=_0x6c9e,_0x219908=await _0x41b9fc('自定义通话名称',_0x35addf(0xf37),_0x57f4f3['customName']||'');if(_0x219908===null)return;await _0x6ed281[_0x35addf(0x14b5)][_0x35addf(0xa0b)](_0x57f4f3['id'],{'customName':_0x219908['trim']()}),await _0x6f2c03(),await _0x104485('成功','通话名称已更新！');}),_0x2704bc[_0x1b7908(0x6b6)](_0xb3e652);});}function _0x5d8521(_0x4f1fc0){const _0x58fb94=_0x3ce1fb,_0x3a2596=document[_0x58fb94(0x1497)]('div');_0x3a2596[_0x58fb94(0x35b)]=_0x58fb94(0xa2f),_0x3a2596[_0x58fb94(0x606)]['recordId']=_0x4f1fc0['id'];const _0x31ba87=_0x16699d['chats'][_0x4f1fc0[_0x58fb94(0x1029)]],_0x5bb6e1=_0x31ba87?_0x31ba87[_0x58fb94(0x1467)]:_0x58fb94(0xaa6),_0x18a7c1=new Date(_0x4f1fc0[_0x58fb94(0xb0a)]),_0x85d0f7=_0x18a7c1[_0x58fb94(0x3c5)]()+'-'+String(_0x18a7c1[_0x58fb94(0x12f9)]()+0x1)[_0x58fb94(0x112d)](0x2,'0')+'-'+String(_0x18a7c1['getDate']())[_0x58fb94(0x112d)](0x2,'0')+'\x20'+String(_0x18a7c1[_0x58fb94(0x12c1)]())['padStart'](0x2,'0')+':'+String(_0x18a7c1[_0x58fb94(0xc87)]())[_0x58fb94(0x112d)](0x2,'0'),_0x16e1b7=Math[_0x58fb94(0x15b6)](_0x4f1fc0[_0x58fb94(0x7ce)]/0x3c)+'分'+_0x4f1fc0[_0x58fb94(0x7ce)]%0x3c+'秒',_0x3f3a79=_0x4f1fc0[_0x58fb94(0x112b)][_0x58fb94(0x8ff)](_0x55a5a9=>_0x58fb94(0x4ad)+_0x55a5a9[_0x58fb94(0x63e)]+_0x58fb94(0x3f0)+_0x55a5a9[_0x58fb94(0x1467)]+_0x58fb94(0xb12)+_0x55a5a9[_0x58fb94(0x1467)]+'\x22>')[_0x58fb94(0x121a)]('');return _0x3a2596[_0x58fb94(0xb6f)]=_0x58fb94(0x6e1)+_0x85d0f7+_0x58fb94(0xea8)+_0x16e1b7+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改】在这里新增一个标题行\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x4f1fc0[_0x58fb94(0x8c7)]?_0x58fb94(0x67d)+_0x4f1fc0[_0x58fb94(0x8c7)]+_0x58fb94(0xc7f):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-info\x22>\x20<!--\x20新增一个容器方便布局\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-avatars\x22>'+_0x3f3a79+_0x58fb94(0xa41)+_0x5bb6e1+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3a2596;}async function _0x4a0e51(_0x33b326){const _0x3990f7=_0x3ce1fb,_0x5e003b=await _0x6ed281[_0x3990f7(0x14b5)]['get'](_0x33b326);if(!_0x5e003b)return;const _0x27996f=document[_0x3990f7(0x948)](_0x3990f7(0x257)),_0x39749d=document[_0x3990f7(0x948)]('transcript-modal-title'),_0xa33806=document['getElementById'](_0x3990f7(0x905));_0x39749d[_0x3990f7(0x10cb)]=_0x3990f7(0xcf7)+new Date(_0x5e003b[_0x3990f7(0xb0a)])[_0x3990f7(0xed3)]()+'\x20(时长:\x20'+Math[_0x3990f7(0x15b6)](_0x5e003b[_0x3990f7(0x7ce)]/0x3c)+'分'+_0x5e003b[_0x3990f7(0x7ce)]%0x3c+'秒)',_0xa33806['innerHTML']='';const _0x5aaab9=document['getElementById'](_0x3990f7(0x3ce)),_0x2a6ada=document[_0x3990f7(0x948)]('manual-summarize-btn');!_0x5e003b[_0x3990f7(0xca3)]||_0x5e003b[_0x3990f7(0xca3)]['length']===0x0?(_0xa33806['innerHTML']=_0x3990f7(0x5ce),_0x2a6ada[_0x3990f7(0xf74)][_0x3990f7(0x11fd)]='none'):(_0x2a6ada[_0x3990f7(0xf74)]['display']=_0x3990f7(0x1273),_0x5e003b['transcript'][_0x3990f7(0x427)](_0x5fb149=>{const _0xf3b6f9=_0x3990f7,_0x401195=document[_0xf3b6f9(0x1497)](_0xf3b6f9(0x379));_0x401195['className']=_0xf3b6f9(0xa92)+_0x5fb149['role'],_0x401195[_0xf3b6f9(0x10cb)]=_0x5fb149[_0xf3b6f9(0xede)],_0xa33806[_0xf3b6f9(0x6b6)](_0x401195);}));const _0xdf2585=_0x5aaab9[_0x3990f7(0xfc0)](!![]);_0x5aaab9[_0x3990f7(0x1579)][_0x3990f7(0x868)](_0xdf2585,_0x5aaab9);const _0x3dcb00=_0x2a6ada[_0x3990f7(0xfc0)](!![]);_0x2a6ada['parentNode'][_0x3990f7(0x868)](_0x3dcb00,_0x2a6ada),_0xdf2585[_0x3990f7(0x339)]('click',async()=>{const _0x4cbfb7=_0x3990f7,_0x2384c5=await _0xa6b74a('确认删除',_0x4cbfb7(0xef8),{'confirmButtonClass':'btn-danger'});_0x2384c5&&(_0x27996f[_0x4cbfb7(0xd54)][_0x4cbfb7(0xf89)](_0x4cbfb7(0xfcb)),await _0x6ed281[_0x4cbfb7(0x14b5)][_0x4cbfb7(0x869)](_0x33b326),await _0x6f2c03(),alert(_0x4cbfb7(0xfc3)));}),_0x3dcb00[_0x3990f7(0x339)](_0x3990f7(0x4f6),async()=>{const _0x48caca=_0x3990f7,_0x2c935e=await _0xa6b74a(_0x48caca(0xc03),_0x48caca(0x11c4),{'confirmText':_0x48caca(0xd3d)});if(!_0x2c935e)return;_0x27996f['classList'][_0x48caca(0xf89)](_0x48caca(0xfcb));const _0x40e563=_0x16699d[_0x48caca(0x1474)][_0x5e003b['chatId']];if(!_0x40e563){alert('错误：找不到该通话记录所属的聊天对象。');return;}await _0x104485(_0x48caca(0x960),'正在请求AI进行手动总结...');try{const _0x126dc4=_0x5e003b[_0x48caca(0xca3)][_0x48caca(0x8ff)](_0x45c5c0=>{const _0x427d43=_0x48caca,_0x1560f9=_0x45c5c0['role']===_0x427d43(0xaeb)?_0x40e563[_0x427d43(0x7fd)][_0x427d43(0x1371)]||'我':_0x45c5c0[_0x427d43(0x14ee)]||_0x40e563[_0x427d43(0x1467)];return _0x1560f9+':\x20'+_0x45c5c0[_0x427d43(0xede)];})[_0x48caca(0x121a)]('\x0a');await _0x5513dd(_0x5e003b[_0x48caca(0x1029)],_0x126dc4),await _0x104485(_0x48caca(0x11c1),'手动总结已完成！新的记忆已添加到“'+_0x40e563[_0x48caca(0x1467)]+_0x48caca(0x28d));}catch(_0x5c0ac2){await _0x104485(_0x48caca(0x34b),_0x48caca(0x6eb)+_0x5c0ac2[_0x48caca(0x74b)]);}});const _0x2a4d31=document['getElementById'](_0x3990f7(0x370)),_0x2ec40f=_0x2a4d31[_0x3990f7(0xfc0)](!![]);_0x2a4d31['parentNode'][_0x3990f7(0x868)](_0x2ec40f,_0x2a4d31),_0x2ec40f[_0x3990f7(0x339)]('click',()=>{const _0x378d8e=_0x3990f7;_0x27996f[_0x378d8e(0xd54)]['remove'](_0x378d8e(0xfcb));}),_0x27996f['classList'][_0x3990f7(0xbd0)](_0x3990f7(0xfcb));}async function _0x34d4a0(){const _0x16a364=_0x3ce1fb;if(!_0x16699d[_0x16a364(0xf5a)]||_0x16699d['chats'][_0x16699d[_0x16a364(0xf5a)]]['isGroup'])return;const _0x279b0d=_0x16699d['chats'][_0x16699d[_0x16a364(0xf5a)]],_0x2e2137=await _0x41b9fc(_0x16a364(0x12ac),_0x16a364(0x386),_0x279b0d['status'][_0x16a364(0x9ea)]);_0x2e2137!==null&&(_0x279b0d['status'][_0x16a364(0x9ea)]=_0x2e2137[_0x16a364(0x2a8)]()||'在线',_0x279b0d[_0x16a364(0x82c)][_0x16a364(0x8d1)]=![],_0x279b0d['status'][_0x16a364(0x5e3)]=Date[_0x16a364(0x1386)](),await _0x6ed281[_0x16a364(0x1474)][_0x16a364(0x90c)](_0x279b0d),_0x455873(_0x16699d[_0x16a364(0xf5a)]),_0x2d33eb(),await _0x104485('状态已更新','“'+_0x279b0d[_0x16a364(0x1467)]+_0x16a364(0xf04)+_0x279b0d[_0x16a364(0x82c)][_0x16a364(0x9ea)]));}async function _0xa7d88b(){const _0x3440f5=_0x3ce1fb,_0xae3bb7=document[_0x3440f5(0x948)](_0x3440f5(0x8b7)),_0x3ecc10=document['getElementById'](_0x3440f5(0x1d9));_0x3ecc10['innerHTML']='';const _0x36e2da=Object[_0x3440f5(0x1166)](_0x16699d[_0x3440f5(0x1474)]);_0x36e2da[_0x3440f5(0x427)](_0x568eab=>{const _0x34f39f=_0x3440f5,_0x2ddb60=document['createElement']('div');_0x2ddb60[_0x34f39f(0x35b)]=_0x34f39f(0x1437),_0x2ddb60[_0x34f39f(0xb6f)]=_0x34f39f(0x12cc)+_0x568eab['id']+'\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x568eab[_0x34f39f(0x1173)]?_0x568eab[_0x34f39f(0x7fd)][_0x34f39f(0x1e7)]:_0x568eab['settings'][_0x34f39f(0x156d)]||_0x202ba5)+_0x34f39f(0xfb9)+_0x568eab['name']+_0x34f39f(0x1544),_0x3ecc10[_0x34f39f(0x6b6)](_0x2ddb60);}),_0xae3bb7[_0x3440f5(0xd54)][_0x3440f5(0xbd0)](_0x3440f5(0xfcb));}function _0x5ddc20(_0x383887){const _0x2066b0=_0x3ce1fb,_0x115bbf=document[_0x2066b0(0x948)](_0x2066b0(0x71e));if(!_0x115bbf[_0x2066b0(0xd54)][_0x2066b0(0x7a0)](_0x2066b0(0xfcb))){if(_0x383887)_0x383887();return;}_0x115bbf[_0x2066b0(0xd54)]['remove'](_0x2066b0(0xfcb)),setTimeout(()=>{const _0x2f8830=_0x2066b0;document['getElementById'](_0x2f8830(0x11ac))[_0x2f8830(0xd54)][_0x2f8830(0xf89)]('visible');if(_0x383887)_0x383887();},0x190);}function _0x1192f8(_0x39e406){const _0x436bc4=_0x3ce1fb;if(!_0x39e406)return[];const _0x642931=String(_0x39e406)['split'](/\r\n?|\n/),_0x4f7f7f=[],_0x59b630=/\[(\d{2}):(\d{2})[.:](\d{2,3})\]/g;for(const _0x91b4c1 of _0x642931){const _0x5745d5=_0x91b4c1[_0x436bc4(0x14e9)](_0x59b630,'')[_0x436bc4(0x2a8)]();if(!_0x5745d5)continue;_0x59b630[_0x436bc4(0x2b6)]=0x0;let _0x476a53;while((_0x476a53=_0x59b630[_0x436bc4(0x233)](_0x91b4c1))!==null){const _0x424519=parseInt(_0x476a53[0x1],0xa),_0x42c6f8=parseInt(_0x476a53[0x2],0xa),_0xbb364=parseInt(_0x476a53[0x3]['padEnd'](0x3,'0'),0xa),_0x18310a=_0x424519*0x3c+_0x42c6f8+_0xbb364/0x3e8;_0x4f7f7f['push']({'time':_0x18310a,'text':_0x5745d5});}}return _0x4f7f7f[_0x436bc4(0xe96)]((_0x28beb9,_0x105f04)=>_0x28beb9[_0x436bc4(0x115d)]-_0x105f04['time']);}function _0x25adec(){const _0x4f37a8=_0x3ce1fb,_0x104796=document[_0x4f37a8(0x948)]('music-lyrics-list');_0x104796[_0x4f37a8(0xb6f)]='';if(!_0x49c6c5[_0x4f37a8(0x68d)]||_0x49c6c5['parsedLyrics'][_0x4f37a8(0xaf9)]===0x0){_0x104796[_0x4f37a8(0xb6f)]=_0x4f37a8(0x453);return;}_0x49c6c5[_0x4f37a8(0x68d)][_0x4f37a8(0x427)]((_0x341d86,_0x2525f)=>{const _0x2a68cb=_0x4f37a8,_0x889ac9=document[_0x2a68cb(0x1497)](_0x2a68cb(0x379));_0x889ac9[_0x2a68cb(0x35b)]=_0x2a68cb(0x826),_0x889ac9[_0x2a68cb(0x10cb)]=_0x341d86['text'],_0x889ac9[_0x2a68cb(0x606)][_0x2a68cb(0xbb3)]=_0x2525f,_0x104796['appendChild'](_0x889ac9);}),_0x104796[_0x4f37a8(0xf74)][_0x4f37a8(0x79c)]=_0x4f37a8(0x52a);}function _0x536b30(){}function _0x4d5fe9(){const _0x54682a=_0x3ce1fb;if(!islandLyricText||!islandLyricContainer)return;const _0x4bb490=islandLyricText[_0x54682a(0x61b)],_0x5df25a=islandLyricContainer[_0x54682a(0xa00)];if(_0x4bb490>_0x5df25a){const _0x43991c=_0x4bb490/_0x5df25a,_0x28feaf=Math['max'](0x5,_0x43991c*0x5);islandLyricText[_0x54682a(0xf74)][_0x54682a(0x121e)](_0x54682a(0xd2c),_0x28feaf+'s'),islandLyricText[_0x54682a(0xf74)][_0x54682a(0x121e)](_0x54682a(0x1224),_0x5df25a+'px'),islandLyricText[_0x54682a(0xf74)]['setProperty']('--text-width',_0x4bb490+'px'),islandLyricText[_0x54682a(0xd54)][_0x54682a(0xbd0)](_0x54682a(0xd4b));}else islandLyricText[_0x54682a(0xd54)][_0x54682a(0xf89)](_0x54682a(0xd4b));}function _0x497693(_0x54b2c1){const _0x5c79b8=_0x3ce1fb;if(_0x49c6c5['parsedLyrics'][_0x5c79b8(0xaf9)]===0x0)return;let _0x42175f=-0x1;for(let _0x4e53ff=0x0;_0x4e53ff<_0x49c6c5[_0x5c79b8(0x68d)][_0x5c79b8(0xaf9)];_0x4e53ff++){if(_0x54b2c1>=_0x49c6c5[_0x5c79b8(0x68d)][_0x4e53ff][_0x5c79b8(0x115d)])_0x42175f=_0x4e53ff;else break;}if(_0x42175f===_0x49c6c5[_0x5c79b8(0xecc)])return;_0x49c6c5['currentLyricIndex']=_0x42175f,_0x2fd363();const _0x4bf374=document[_0x5c79b8(0x948)]('single-lyric-display');_0x4bf374&&(_0x42175f>-0x1&&_0x49c6c5[_0x5c79b8(0x68d)][_0x42175f]?_0x4bf374[_0x5c79b8(0x10cb)]=_0x49c6c5[_0x5c79b8(0x68d)][_0x42175f]['text']:_0x4bf374['textContent']=_0x5c79b8(0x1080));const _0x5905cb=document['getElementById']('global-lyrics-bar');_0x5905cb[_0x5c79b8(0xd54)]['contains'](_0x5c79b8(0xfcb))&&(_0x42175f>-0x1&&_0x49c6c5[_0x5c79b8(0x68d)][_0x42175f]?_0x5905cb[_0x5c79b8(0x10cb)]=_0x49c6c5[_0x5c79b8(0x68d)][_0x42175f][_0x5c79b8(0x9ea)]:_0x5905cb['textContent']='♪');if(phoneScreenForIsland[_0x5c79b8(0xd54)][_0x5c79b8(0x7a0)](_0x5c79b8(0x811))){const _0x2303a5=_0x42175f>-0x1&&_0x49c6c5[_0x5c79b8(0x68d)][_0x42175f]?_0x49c6c5[_0x5c79b8(0x68d)][_0x42175f]['text']:'♪\x20♪\x20♪',_0x5db13e=islandLyricText[_0x5c79b8(0xfeb)](_0x5c79b8(0x8c6));if(_0x5db13e&&_0x5db13e[_0x5c79b8(0x10cb)]===_0x2303a5)return;islandLyricText[_0x5c79b8(0xf74)][_0x5c79b8(0x9a2)]=0x0,setTimeout(()=>{const _0x3a273a=_0x5c79b8;islandLyricText[_0x3a273a(0xd54)][_0x3a273a(0xf89)](_0x3a273a(0xd4b)),islandLyricContainer[_0x3a273a(0xd54)][_0x3a273a(0xf89)](_0x3a273a(0x212)),islandLyricText[_0x3a273a(0xf74)][_0x3a273a(0x13f5)]=_0x3a273a(0x12fe);let _0x44770f=islandLyricText[_0x3a273a(0xfeb)]('span:first-child'),_0x6cd980=islandLyricText[_0x3a273a(0xfeb)](_0x3a273a(0x1137));!_0x44770f&&(_0x44770f=document[_0x3a273a(0x1497)](_0x3a273a(0x65b)),islandLyricText[_0x3a273a(0x6b6)](_0x44770f));!_0x6cd980&&(_0x6cd980=document[_0x3a273a(0x1497)](_0x3a273a(0x65b)),islandLyricText[_0x3a273a(0x6b6)](_0x6cd980));_0x44770f[_0x3a273a(0x10cb)]=_0x2303a5,_0x6cd980['textContent']=_0x2303a5;const _0x547f1b=_0x44770f[_0x3a273a(0x5f7)],_0x24255f=islandLyricContainer[_0x3a273a(0xa00)];if(_0x547f1b>_0x24255f){const _0x487a29=_0x547f1b/_0x24255f,_0x2e005a=Math['max'](0x5,_0x487a29*0x5);islandLyricText[_0x3a273a(0xf74)][_0x3a273a(0x121e)](_0x3a273a(0x1519),_0x2e005a+'s'),islandLyricText[_0x3a273a(0xd54)]['add']('scrolling'),islandLyricText[_0x3a273a(0xf74)][_0x3a273a(0x13f5)]=_0x3a273a(0x1373);}else islandLyricContainer[_0x3a273a(0xd54)][_0x3a273a(0xbd0)](_0x3a273a(0x212));islandLyricText[_0x3a273a(0xf74)][_0x3a273a(0x9a2)]=0x1;},0xc8);}}function _0x2fd363(_0xa89376=![]){const _0x572a09=_0x3ce1fb,_0x498d9d=_0xa89376?_0x572a09(0x574):_0x572a09(0x139c),_0x178232=_0xa89376?_0x572a09(0xb60):_0x572a09(0x66b),_0x344e7e=document[_0x572a09(0xfeb)](_0x498d9d),_0x4657db=document[_0x572a09(0xfeb)](_0x178232);if(!_0x344e7e||!_0x4657db)return;const _0x1a5c63=_0x344e7e[_0x572a09(0x1188)](_0x572a09(0xc74));_0x1a5c63['forEach'](_0x26fe57=>_0x26fe57['classList'][_0x572a09(0xf89)](_0x572a09(0x115e)));if(_0x49c6c5['currentLyricIndex']===-0x1){_0x344e7e['style']['transform']=_0x572a09(0x52a);return;}const _0x1ec411=_0x344e7e[_0x572a09(0xfeb)]('.lyric-line[data-index=\x22'+_0x49c6c5[_0x572a09(0xecc)]+'\x22]');if(_0x1ec411){_0x1ec411[_0x572a09(0xd54)]['add'](_0x572a09(0x115e));const _0x107ed3=_0x4657db[_0x572a09(0xa5e)],_0x596ab0=_0x107ed3/2.2-_0x1ec411[_0x572a09(0x255)]-_0x1ec411[_0x572a09(0xa5e)]/0x2;_0x344e7e[_0x572a09(0xf74)][_0x572a09(0x79c)]=_0x572a09(0x48d)+_0x596ab0+'px)';}}function _0x30eb40(_0x3a2613){const _0x15a6a7=_0x3ce1fb;if(isNaN(_0x3a2613)||_0x3a2613<0x0)return _0x15a6a7(0x115a);const _0x505dbb=Math['floor'](_0x3a2613/0x3c),_0x252ae3=Math[_0x15a6a7(0x15b6)](_0x3a2613%0x3c);return _0x505dbb+':'+String(_0x252ae3)[_0x15a6a7(0x112d)](0x2,'0');}let _0x206cfd=0x0,_0x706fe2;function _0x202d7c(){_0x706fe2&&cancelAnimationFrame(_0x706fe2);function _0x23a730(){const _0x4d2893=_0x6c9e;if(!_0x49c6c5['isPlaying']||!_0x204b9a[_0x4d2893(0x7ce)])return;const _0x5eaa26=performance[_0x4d2893(0x1386)](),_0x1f2704=_0x204b9a[_0x4d2893(0x624)],_0x2b6cfd=_0x204b9a[_0x4d2893(0x7ce)],_0x488935=_0x1f2704/_0x2b6cfd*0x64;document['getElementById'](_0x4d2893(0xbbd))['style']['width']=_0x488935+'%',_0x5eaa26-_0x206cfd>0x3e8&&(document[_0x4d2893(0x948)](_0x4d2893(0x942))['textContent']=_0x30eb40(_0x1f2704),document[_0x4d2893(0x948)](_0x4d2893(0x85f))[_0x4d2893(0x10cb)]=_0x30eb40(_0x2b6cfd),_0x206cfd=_0x5eaa26),_0x497693(_0x1f2704),_0x536b30(),_0x706fe2=requestAnimationFrame(_0x23a730);}_0x706fe2=requestAnimationFrame(_0x23a730);}function _0x918396(){const _0x2423d9=_0x3ce1fb;if(!lastRawAiResponse){alert(_0x2423d9(0xdc3));return;}const _0x5773aa=document['getElementById']('ai-response-editor-modal'),_0x45c8c2=document['getElementById']('ai-response-editor-container');_0x45c8c2['innerHTML']='';const _0x24e354=_0xad600c(lastRawAiResponse);if(_0x24e354&&_0x24e354[_0x2423d9(0xaf9)]>0x0)_0x24e354[_0x2423d9(0x427)](_0x16b752=>{const _0x40d367=_0x2423d9;if(typeof _0x16b752===_0x40d367(0xd43)&&_0x16b752!==null)try{const _0x49c821=JSON[_0x40d367(0x526)](_0x16b752,null,0x2),_0xffa5b5=_0x1c2537(_0x49c821);_0x45c8c2[_0x40d367(0x6b6)](_0xffa5b5);}catch(_0x13fbb9){console[_0x40d367(0xc3e)](_0x40d367(0xe6c),_0x16b752,_0x13fbb9);}else{if(typeof _0x16b752===_0x40d367(0x273)){const _0x569df3=_0x1c2537(_0x16b752);_0x45c8c2[_0x40d367(0x6b6)](_0x569df3),console[_0x40d367(0x9c1)]('在导演模式中发现一个无效的片段\x20(来自parseAiResponse的文本回退):',_0x16b752);}}});else{const _0x5c9efb=_0x1c2537(lastRawAiResponse);_0x45c8c2[_0x2423d9(0x6b6)](_0x5c9efb);}_0x5773aa[_0x2423d9(0xd54)]['add'](_0x2423d9(0xfcb));}function _0x1c2537(_0x2a0232=''){const _0x1d25e3=_0x3ce1fb,_0x429166=document[_0x1d25e3(0x1497)](_0x1d25e3(0x379));_0x429166[_0x1d25e3(0x35b)]=_0x1d25e3(0xfca);const _0x116f01={'text':{'type':_0x1d25e3(0x9ea),'content':_0x1d25e3(0x449)},'sticker':{'type':_0x1d25e3(0x10c2),'url':_0x1d25e3(0xfb4),'meaning':_0x1d25e3(0xf9f)},'image':{'type':'ai_image','description':_0x1d25e3(0x943)},'voice':{'type':_0x1d25e3(0x10d4),'content':'在这里输入语音内容...'},'transfer':{'type':_0x1d25e3(0x1514),'amount':5.2,'note':'一点心意'},'offline':{'type':_0x1d25e3(0xd5f),'content':'「在这里输入对话内容」\x5cn(在这里输入动作或环境描写)'},'quote':{'type':_0x1d25e3(0x11a9),'target_timestamp':0x499602d2,'reply_content':_0x1d25e3(0x998)},'nai':{'type':'naiimag','prompt':'1girl,\x20best\x20quality,\x20masterpiece,\x20...'}};return _0x429166[_0x1d25e3(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条动作\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>'+_0x2a0232+'</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x1d25e3(0x526)](_0x116f01['text'])+_0x1d25e3(0xe62)+JSON[_0x1d25e3(0x526)](_0x116f01[_0x1d25e3(0x10c2)])+_0x1d25e3(0x7ae)+JSON['stringify'](_0x116f01[_0x1d25e3(0x608)])+_0x1d25e3(0x779)+JSON[_0x1d25e3(0x526)](_0x116f01[_0x1d25e3(0x2a3)])+'\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x1d25e3(0x526)](_0x116f01[_0x1d25e3(0x1514)])+_0x1d25e3(0xb6a)+JSON[_0x1d25e3(0x526)](_0x116f01[_0x1d25e3(0xa3d)])+_0x1d25e3(0x218)+JSON[_0x1d25e3(0x526)](_0x116f01['quote'])+_0x1d25e3(0x1215)+JSON[_0x1d25e3(0x526)](_0x116f01[_0x1d25e3(0x982)])+_0x1d25e3(0xb9e),_0x429166['querySelector']('.delete-block-btn')[_0x1d25e3(0x339)](_0x1d25e3(0x4f6),()=>{_0x429166['remove']();}),_0x429166[_0x1d25e3(0x1188)](_0x1d25e3(0x15b1))[_0x1d25e3(0x427)](_0x26d0c4=>{const _0x2f7ded=_0x1d25e3;_0x26d0c4['addEventListener'](_0x2f7ded(0x4f6),()=>{const _0x52aeb4=_0x2f7ded,_0x316c70=_0x26d0c4['dataset'][_0x52aeb4(0xded)],_0x8cbbf5=_0x429166['querySelector'](_0x52aeb4(0xc1e));if(_0x316c70&&_0x8cbbf5)try{const _0x1dde09=JSON[_0x52aeb4(0xde0)](_0x316c70);_0x8cbbf5[_0x52aeb4(0x5bc)]=JSON[_0x52aeb4(0x526)](_0x1dde09,null,0x2),_0x8cbbf5[_0x52aeb4(0x348)]();}catch(_0x3ec70f){console[_0x52aeb4(0xc3e)](_0x52aeb4(0xda9),_0x3ec70f);}});}),_0x429166;}async function _0x1ac2f1(){const _0x408691=_0x3ce1fb,_0x3580d9=new Map();let _0xe60b47=null;if(lastPrivateMessagesSent[_0x408691(0xaf9)]>0x0){console['log'](_0x408691(0xdd7)+lastPrivateMessagesSent['length']+_0x408691(0xae5));const _0x4c23d0=[...lastPrivateMessagesSent];_0xe60b47=_0x4c23d0[_0x408691(0x1166)]();const _0xbe4ccb=[...new Set(_0x4c23d0[_0x408691(0x8ff)](_0x2b15a7=>_0x2b15a7['chatId']))];for(const _0x12eab3 of _0xbe4ccb){const _0xb70484=await _0x6ed281[_0x408691(0x1474)][_0x408691(0xe8c)](_0x12eab3);_0xb70484&&_0x3580d9['set'](_0x12eab3,_0xb70484);}for(const _0x4eebf0 of _0x4c23d0){const _0x49128e=_0x3580d9[_0x408691(0xe8c)](_0x4eebf0['chatId']);_0x49128e&&(_0x49128e[_0x408691(0xb07)]=_0x49128e['history']['filter'](_0x2c57ae=>_0x2c57ae[_0x408691(0xb0a)]!==_0x4eebf0[_0x408691(0xb0a)]));}_0x3580d9[_0x408691(0x8ca)]>0x0&&await _0x6ed281[_0x408691(0x1474)]['bulkPut'](Array['from'](_0x3580d9[_0x408691(0x1166)]())),lastPrivateMessagesSent=[];}const _0x1cabf1=_0x16699d[_0x408691(0x1474)][_0x16699d[_0x408691(0xf5a)]];if(!_0x1cabf1)return;const _0x108018=document['getElementById'](_0x408691(0x286)),_0x420d68=_0x108018['querySelectorAll'](_0x408691(0xc1e)),_0x1e9c05=Array[_0x408691(0x6e5)](_0x420d68)[_0x408691(0x8ff)](_0x5960de=>_0x5960de[_0x408691(0x5bc)]['trim']())[_0x408691(0x1c0)](Boolean),_0x252050=_0x1cabf1[_0x408691(0xb07)][_0x408691(0x1c0)](_0x4ad665=>lastResponseTimestamps['includes'](_0x4ad665[_0x408691(0xb0a)]));_0x1cabf1[_0x408691(0xb07)]=_0x1cabf1[_0x408691(0xb07)][_0x408691(0x1c0)](_0x288199=>!lastResponseTimestamps[_0x408691(0x1336)](_0x288199['timestamp']));if(_0x1e9c05['length']===0x0){await _0x6ed281[_0x408691(0x1474)][_0x408691(0x90c)](_0x1cabf1),_0x455873(_0x16699d[_0x408691(0xf5a)]),_0x2d33eb(),document[_0x408691(0x948)](_0x408691(0x4e2))[_0x408691(0xd54)]['remove'](_0x408691(0xfcb)),lastRawAiResponse='',lastResponseTimestamps=[];return;}let _0x5201a3=[];for(const _0x24f3d3 of _0x1e9c05){try{const _0x4b1454=JSON[_0x408691(0xde0)](_0x24f3d3);_0x5201a3[_0x408691(0x1001)](_0x4b1454);}catch(_0x2b0e9c){console[_0x408691(0x9c1)](_0x408691(0x522),_0x24f3d3);}}const _0x545ded=_0x252050[_0x408691(0x1c0)](_0x50d78d=>_0x50d78d[_0x408691(0x4ae)]==='naiimag');let _0x1bd8bc=0x0,_0x3f40fe=[],_0x46c986=Date[_0x408691(0x1386)]();const _0x17712d=new Map();for(const _0x217c39 of _0x5201a3){if(!_0x217c39||typeof _0x217c39!==_0x408691(0xd43)||!_0x217c39[_0x408691(0x4ae)]){console[_0x408691(0x9c1)](_0x408691(0xfd4),_0x217c39);continue;}let _0xfadb88=null;const _0x97b296={'role':'assistant','senderName':_0x217c39['name']||_0x1cabf1[_0x408691(0x628)],'timestamp':_0x46c986++};switch(_0x217c39[_0x408691(0x4ae)]){case _0x408691(0x39a):{const _0x1835c9=_0x217c39[_0x408691(0x1467)],_0xdba825=_0x217c39[_0x408691(0x149d)],_0x1eb69c=_0x16699d[_0x408691(0x66e)][_0x408691(0xf4d)]||_0x408691(0x1347);if(_0xdba825===_0x1eb69c){const _0x3dfd0f=Object['values'](_0x16699d[_0x408691(0x1474)])['find'](_0x132ea1=>!_0x132ea1[_0x408691(0x1173)]&&_0x132ea1[_0x408691(0x628)]===_0x1835c9);if(_0x3dfd0f){if(!_0x17712d[_0x408691(0xda1)](_0x3dfd0f['id'])){const _0x3bef18=_0x3580d9[_0x408691(0xe8c)](_0x3dfd0f['id'])||await _0x6ed281[_0x408691(0x1474)][_0x408691(0xe8c)](_0x3dfd0f['id']);_0x17712d[_0x408691(0x450)](_0x3dfd0f['id'],_0x3bef18);}const _0x575f97=_0x17712d[_0x408691(0xe8c)](_0x3dfd0f['id']),_0x518a8e=Array['isArray'](_0x217c39[_0x408691(0xede)])?_0x217c39[_0x408691(0xede)]:[_0x217c39[_0x408691(0xede)]];let _0x11f33a=0x0;for(const _0x4aa660 of _0x518a8e){if(!_0x4aa660||!_0x4aa660['trim']())continue;const _0x493a25=_0xe60b47?_0xe60b47[_0x408691(0x45e)]()['value']:null,_0x40bf78=_0x493a25&&_0x493a25['chatId']===_0x3dfd0f['id']?_0x493a25[_0x408691(0xb0a)]:_0x46c986++,_0x1e8d39={'role':_0x408691(0x14c8),'senderName':_0x1835c9,'content':_0x4aa660,'timestamp':_0x40bf78};lastPrivateMessagesSent[_0x408691(0x1001)]({'chatId':_0x3dfd0f['id'],'timestamp':_0x1e8d39['timestamp']}),_0x575f97[_0x408691(0xb07)]['push'](_0x1e8d39),_0x11f33a++;}_0x11f33a>0x0&&(_0x16699d[_0x408691(0xf5a)]!==_0x3dfd0f['id']&&(_0x575f97[_0x408691(0x1300)]=(_0x575f97[_0x408691(0x1300)]||0x0)+_0x11f33a,_0x2e32a5(_0x3dfd0f['id'],_0x3dfd0f[_0x408691(0x1467)]+_0x408691(0x8f9)+_0x11f33a+'\x20条新消息'))),_0xfadb88=null;}else console['warn'](_0x408691(0x1046)+_0x1835c9+'\x20尝试发送私信，但未找到其对应的私聊会话。'),_0xfadb88=null;}else console[_0x408691(0x9c1)](_0x408691(0xa7e)+_0xdba825+')，此功能暂不支持。'),_0xfadb88=null;continue;}case _0x408691(0xfa5):{const _0x78804=_0x408691(0x9c6)+(_0x217c39['analysis']||'无')+_0x408691(0x157c)+(_0x217c39[_0x408691(0xd18)]||'无')+'\x0a-\x20角色思考:\x20'+JSON[_0x408691(0x526)](_0x217c39[_0x408691(0x20e)]||{}),_0x574e29={'role':_0x408691(0x11af),'content':_0x78804,'timestamp':_0x46c986++,'isHidden':!![]};_0x1cabf1[_0x408691(0xb07)]['push'](_0x574e29),_0x3f40fe[_0x408691(0x1001)](_0x574e29[_0x408691(0xb0a)]);continue;}case _0x408691(0x9ea):_0xfadb88={..._0x97b296,'content':String(_0x217c39[_0x408691(0xede)]||_0x217c39['message'])};break;case _0x408691(0x10c2):{let _0x59f529=![];if(_0x217c39[_0x408691(0x9a8)]&&_0x217c39[_0x408691(0x14f1)])_0xfadb88={..._0x97b296,'type':_0x408691(0x10c2),'content':_0x217c39[_0x408691(0x9a8)],'meaning':_0x217c39[_0x408691(0x14f1)]},_0x59f529=!![];else{if(_0x217c39[_0x408691(0x14f1)]){const _0xfe6bb3=_0x16699d['userStickers'][_0x408691(0x1402)](_0xb9e005=>_0xb9e005[_0x408691(0x1467)]===_0x217c39[_0x408691(0x14f1)]);_0xfe6bb3?(_0xfadb88={..._0x97b296,'type':_0x408691(0x10c2),'content':_0xfe6bb3['url'],'meaning':_0xfe6bb3['name']},_0x59f529=!![]):(_0xfadb88={..._0x97b296,'type':'text','content':_0x408691(0x828)+_0x217c39[_0x408691(0x14f1)]+']'},_0x59f529=!![]);}else{if(_0x217c39['url']){_0xfadb88={..._0x97b296,'type':_0x408691(0x10c2),'content':_0x217c39[_0x408691(0x9a8)]};const _0x3a73cd=_0x16699d[_0x408691(0x14a2)][_0x408691(0x1402)](_0x4a5228=>_0x4a5228[_0x408691(0x9a8)]===_0x217c39[_0x408691(0x9a8)]);_0xfadb88['meaning']=_0x3a73cd?_0x3a73cd['name']:'未知表情',_0x59f529=!![];}else{if(_0x217c39[_0x408691(0xede)]&&typeof _0x217c39[_0x408691(0xede)]===_0x408691(0x273)&&_0x346c[_0x408691(0x367)](_0x217c39['content'])){_0xfadb88={..._0x97b296,'type':_0x408691(0x10c2),'content':_0x217c39[_0x408691(0xede)]};const _0x2b007c=_0x16699d[_0x408691(0x14a2)][_0x408691(0x1402)](_0xc27662=>_0xc27662['url']===_0x217c39['content']);_0xfadb88[_0x408691(0x14f1)]=_0x2b007c?_0x2b007c[_0x408691(0x1467)]:_0x408691(0xe73),_0x59f529=!![];}}}}if(!_0x59f529){console[_0x408691(0xc3e)](_0x408691(0x1d8),_0x217c39);continue;}break;}case _0x408691(0x1281):_0xfadb88={..._0x97b296,'type':_0x408691(0x1281),'content':_0x217c39['description'],'image_prompt':_0x217c39[_0x408691(0x5d9)]};break;case'naiimag':{const _0x2e81af=_0x217c39[_0x408691(0xc4b)];let _0x5a6c6a=null,_0xae4938=null;const _0x57353c=_0x545ded[_0x1bd8bc];_0x1bd8bc++;let _0x5da84f=![];if(_0x57353c){const _0x667471=_0x57353c[_0x408691(0xc4b)];_0x2e81af&&_0x2e81af!==_0x667471?(console['log'](_0x408691(0x66a)),_0x5da84f=!![]):(console[_0x408691(0x498)](_0x408691(0x8df)),_0x5a6c6a=_0x57353c['imageUrl'],_0xae4938=_0x57353c[_0x408691(0xb54)]);}else console[_0x408691(0x498)](_0x408691(0x432)),_0x5da84f=!![];if(_0x5da84f){const _0xa8f5b7=_0x57353c?_0x408691(0xfa0):_0x408691(0x3bb);await _0x104485('请稍候...',_0xa8f5b7);try{const _0x47ea8a=await _0x3036dd(_0x2e81af,_0x1cabf1['id']);_0x5a6c6a=_0x47ea8a[_0x408691(0x15b8)],_0xae4938=_0x47ea8a['fullPrompt'],await _0x104485('成功','图片已生成！');}catch(_0xf439a4){console[_0x408691(0xc3e)](_0x408691(0x81d),_0xf439a4),await _0x104485('生成失败',_0x408691(0x1097)+_0xf439a4[_0x408691(0x74b)]+'.\x20\x0a\x0a将保留旧图片（如果存在）。');if(_0x57353c)_0x5a6c6a=_0x57353c[_0x408691(0x15b8)],_0xae4938=_0x57353c[_0x408691(0xb54)];else{console[_0x408691(0xc3e)](_0x408691(0x1b7));continue;}}}_0xfadb88={..._0x97b296,'type':_0x408691(0x1141),'imageUrl':_0x5a6c6a,'prompt':_0x2e81af,'fullPrompt':_0xae4938};break;}case _0x408691(0x10d4):_0xfadb88={..._0x97b296,'type':_0x408691(0x10d4),'content':_0x217c39[_0x408691(0xede)]};break;case _0x408691(0x1514):_0xfadb88={..._0x97b296,'type':_0x408691(0x1514),'amount':_0x217c39['amount'],'note':_0x217c39[_0x408691(0x2a7)],'receiverName':_0x217c39['receiver']||'我'};break;case'waimai_request':_0xfadb88={..._0x97b296,'type':_0x408691(0x29c),'productInfo':_0x217c39[_0x408691(0x890)],'amount':_0x217c39[_0x408691(0xbd2)],'status':_0x408691(0x150c),'countdownEndTime':Date['now']()+0xf*0x3c*0x3e8};break;case _0x408691(0xd5f):_0xfadb88={..._0x97b296,..._0x217c39};break;case _0x408691(0x116e):{const _0x55630f=_0x4c7ec4[_0x1cabf1['id']];if(_0x55630f){const _0x82829c=_0x55630f['history'][_0x408691(0x655)](_0x2c72dd=>_0x2c72dd[_0x408691(0x1563)]===0x2);if(_0x82829c>-0x1){const _0x201595=_0x55630f[_0x408691(0xb07)][_0x82829c];_0x55630f[_0x408691(0x1da)][_0x201595['y']][_0x201595['x']]=0x0,_0x55630f[_0x408691(0xb07)]['splice'](_0x82829c,0x1),console[_0x408691(0x498)]('导演模式悔棋：已撤销AI在\x20('+_0x201595['x']+',\x20'+_0x201595['y']+')\x20的棋步。');}}const _0x25bc9b=parseInt(_0x217c39['x']),_0x3adf57=parseInt(_0x217c39['y']);!isNaN(_0x25bc9b)&&!isNaN(_0x3adf57)?_0x4ce1cd({'x':_0x25bc9b,'y':_0x3adf57},!![]):console[_0x408691(0x9c1)]('导演模式保存了一个无效的五子棋移动指令:',_0x217c39);continue;}case _0x408691(0x64f):{if(!_0x1cabf1[_0x408691(0x1173)]){if(_0x217c39[_0x408691(0x54a)])_0x1cabf1[_0x408691(0x790)]=String(_0x217c39[_0x408691(0x54a)]);if(_0x217c39[_0x408691(0xa96)])_0x1cabf1[_0x408691(0x6f1)]=String(_0x217c39[_0x408691(0xa96)]);if(!Array['isArray'](_0x1cabf1['thoughtsHistory']))_0x1cabf1[_0x408691(0xd94)]=[];_0x1cabf1['thoughtsHistory']['push']({'heartfeltVoice':_0x1cabf1[_0x408691(0x790)],'randomJottings':_0x1cabf1[_0x408691(0x6f1)],'timestamp':Date[_0x408691(0x1386)]()});if(_0x1cabf1[_0x408691(0xd94)][_0x408691(0xaf9)]>0x32)_0x1cabf1['thoughtsHistory']['shift']();}continue;}case _0x408691(0x11a9):{const _0x21fa63=_0x1cabf1[_0x408691(0xb07)][_0x408691(0x1402)](_0x3a8288=>_0x3a8288['timestamp']===_0x217c39[_0x408691(0x20b)]);let _0x4b0e5c=null;if(_0x21fa63){let _0x266f12=_0x21fa63[_0x408691(0x14ee)];_0x21fa63[_0x408691(0x1554)]===_0x408691(0xaeb)&&(_0x266f12=_0x1cabf1['isGroup']?_0x1cabf1['settings']['myNickname']||'我':_0x16699d['qzoneSettings'][_0x408691(0xf4d)]||_0x408691(0x1347)),_0x4b0e5c={'timestamp':_0x217c39['target_timestamp'],'senderName':_0x266f12,'content':String(_0x21fa63[_0x408691(0xede)]||'')};}else _0x4b0e5c={'timestamp':_0x217c39[_0x408691(0x20b)],'senderName':_0x408691(0x79b),'content':_0x408691(0x1174)};_0xfadb88={..._0x97b296,'content':_0x217c39[_0x408691(0x5a9)],'quote':_0x4b0e5c};break;}default:console['warn'](_0x408691(0xa32),_0x217c39[_0x408691(0x4ae)],_0x217c39);if(_0x217c39[_0x408691(0xede)])_0xfadb88={..._0x97b296,'content':String(_0x217c39[_0x408691(0xede)])};else continue;break;}_0xfadb88&&(_0x1cabf1['history'][_0x408691(0x1001)](_0xfadb88),_0x3f40fe[_0x408691(0x1001)](_0xfadb88[_0x408691(0xb0a)]));}await _0x6ed281[_0x408691(0x1474)]['put'](_0x1cabf1),_0x17712d[_0x408691(0x8ca)]>0x0&&await _0x6ed281[_0x408691(0x1474)][_0x408691(0xad6)](Array['from'](_0x17712d['values']())),_0x455873(_0x16699d[_0x408691(0xf5a)]),_0x2d33eb(),document['getElementById']('ai-response-editor-modal')[_0x408691(0xd54)][_0x408691(0xf89)]('visible'),lastRawAiResponse=_0x1e9c05[_0x408691(0x121a)]('\x0a\x0a'),lastResponseTimestamps=_0x3f40fe,await _0x104485(_0x408691(0xc0a),_0x408691(0x7e3));}async function _0x1262b0(){const _0x36e807=_0x3ce1fb;if(!_0x441f4f)return;const _0x27a1ae=0x2*0x3c*0x3e8,_0x45984f=_0x441f4f,_0x58fc65=Date[_0x36e807(0x1386)]();if(_0x58fc65-_0x45984f>_0x27a1ae){_0x115ec8(),await _0x104485('操作失败',_0x36e807(0x10a7));return;}await _0xf80b7c(_0x45984f,!![]),_0x115ec8();}async function _0xf80b7c(_0x337510,_0x55e7fd){const _0x2e6d65=_0x3ce1fb,_0x18fd83=_0x16699d['chats'][_0x16699d['activeChatId']];if(!_0x18fd83)return;const _0x550bd4=_0x18fd83[_0x2e6d65(0xb07)][_0x2e6d65(0x1018)](_0x20b6ce=>_0x20b6ce['timestamp']===_0x337510);if(_0x550bd4===-0x1)return;const _0x465d93=_0x18fd83[_0x2e6d65(0xb07)][_0x550bd4],_0xa5b9a9={'originalType':_0x465d93[_0x2e6d65(0x4ae)]||_0x2e6d65(0x9ea),'originalContent':_0x465d93[_0x2e6d65(0xede)],'originalMeaning':_0x465d93['meaning'],'originalQuote':_0x465d93[_0x2e6d65(0xe7f)]};_0x465d93[_0x2e6d65(0x4ae)]='recalled_message',_0x465d93[_0x2e6d65(0xede)]=_0x55e7fd?_0x2e6d65(0x157a):_0x2e6d65(0xee2),_0x465d93[_0x2e6d65(0x1083)]=_0xa5b9a9,delete _0x465d93[_0x2e6d65(0x14f1)],delete _0x465d93[_0x2e6d65(0xe7f)];if(_0x55e7fd){const _0x361a5e=_0x18fd83['isGroup']?_0x18fd83['settings']['myNickname']||'我':'我';let _0x502be4='';if(_0xa5b9a9[_0x2e6d65(0x10e5)]===_0x2e6d65(0x10c2))_0x502be4=_0x2e6d65(0xe6e)+(_0xa5b9a9['originalMeaning']||'未知')+']';else _0xa5b9a9[_0x2e6d65(0x10e5)]==='ai_image'||_0xa5b9a9[_0x2e6d65(0x10e5)]==='user_photo'?_0x502be4=_0x2e6d65(0x112c)+_0xa5b9a9['originalContent']+']':_0x502be4='“'+String(_0xa5b9a9[_0x2e6d65(0x14de)])+'”';const _0x6a3d28={'role':_0x2e6d65(0x11af),'content':_0x2e6d65(0x2bf)+_0x361a5e+_0x2e6d65(0x130c)+_0x502be4+_0x2e6d65(0xc71),'timestamp':Date['now'](),'isHidden':!![]};_0x18fd83['history'][_0x2e6d65(0x1001)](_0x6a3d28);}await _0x6ed281[_0x2e6d65(0x1474)][_0x2e6d65(0x90c)](_0x18fd83),_0x455873(_0x16699d[_0x2e6d65(0xf5a)]),_0x55e7fd&&(_0x2d33eb(),_0x45c50a());}async function _0x3bacf0(){const _0x1975d0=_0x3ce1fb;await _0xef0e2f(),document[_0x1975d0(0x948)]('world-book-category-manager-modal')[_0x1975d0(0xd54)][_0x1975d0(0xbd0)](_0x1975d0(0xfcb));}async function _0xef0e2f(){const _0x5ed672=_0x3ce1fb,_0x318bee=document['getElementById']('existing-categories-list'),_0x49c8e9=await _0x6ed281[_0x5ed672(0x81c)]['toArray']();_0x318bee[_0x5ed672(0xb6f)]='',_0x49c8e9[_0x5ed672(0xaf9)]===0x0&&(_0x318bee[_0x5ed672(0xb6f)]=_0x5ed672(0x67f)),_0x49c8e9['forEach'](_0x170a36=>{const _0x54c06f=_0x5ed672,_0x2b8751=document[_0x54c06f(0x1497)]('div');_0x2b8751[_0x54c06f(0x35b)]=_0x54c06f(0x1271),_0x2b8751[_0x54c06f(0xb6f)]=_0x54c06f(0x123c)+_0x170a36[_0x54c06f(0x1467)]+_0x54c06f(0x154c)+_0x170a36['id']+_0x54c06f(0x307),_0x318bee[_0x54c06f(0x6b6)](_0x2b8751);});}async function _0x198905(){const _0x3e025d=_0x3ce1fb,_0x560747=document[_0x3e025d(0x948)]('new-category-name-input'),_0x380ca0=_0x560747[_0x3e025d(0x5bc)][_0x3e025d(0x2a8)]();if(!_0x380ca0){alert('分类名不能为空！');return;}const _0x203618=await _0x6ed281[_0x3e025d(0x81c)][_0x3e025d(0x1117)](_0x3e025d(0x1467))[_0x3e025d(0xba9)](_0x380ca0)['first']();if(_0x203618){alert(_0x3e025d(0xc04)+_0x380ca0+_0x3e025d(0x60e));return;}await _0x6ed281[_0x3e025d(0x81c)][_0x3e025d(0xbd0)]({'name':_0x380ca0}),_0x560747[_0x3e025d(0x5bc)]='',await _0xef0e2f();}async function _0x336c5c(_0x246368){const _0x3c9e95=_0x3ce1fb,_0xbafb8d=await _0xa6b74a('确认删除',_0x3c9e95(0x73c),{'confirmButtonClass':_0x3c9e95(0x5e8)});if(_0xbafb8d){await _0x6ed281[_0x3c9e95(0x81c)]['delete'](_0x246368);const _0x1c6cf8=await _0x6ed281[_0x3c9e95(0x44c)]['where'](_0x3c9e95(0xd86))[_0x3c9e95(0xba9)](_0x246368)[_0x3c9e95(0x443)]();for(const _0xbe6ca8 of _0x1c6cf8){_0xbe6ca8[_0x3c9e95(0xd86)]=null,await _0x6ed281[_0x3c9e95(0x44c)][_0x3c9e95(0x90c)](_0xbe6ca8);const _0x4d6fea=_0x16699d[_0x3c9e95(0x44c)]['find'](_0x50a4e0=>_0x50a4e0['id']===_0xbe6ca8['id']);if(_0x4d6fea)_0x4d6fea[_0x3c9e95(0xd86)]=null;}await _0xef0e2f();}}async function _0x5afa22(){const _0x5adbda=_0x3ce1fb;if(!_0x441f4f)return;const _0x73e029=_0x441f4f;_0x115ec8();const _0x46a09a=_0x16699d[_0x5adbda(0x1474)][_0x16699d[_0x5adbda(0xf5a)]],_0x307a27=_0x46a09a[_0x5adbda(0xb07)]['find'](_0xb98577=>_0xb98577[_0x5adbda(0xb0a)]===_0x73e029);if(!_0x307a27)return;let _0x504100=String(_0x307a27[_0x5adbda(0xede)]||'')[_0x5adbda(0xeca)](0x0,0x32)+_0x5adbda(0x76d);if(_0x307a27[_0x5adbda(0x4ae)]===_0x5adbda(0x1281))_0x504100=_0x5adbda(0x1332)+_0x504100;const _0x3aa6dd=await _0xa6b74a('发布公告',_0x5adbda(0x1e2)+_0x504100+'”',{'confirmText':_0x5adbda(0x9bc)});if(_0x3aa6dd){const _0x2e2a14=_0x46a09a[_0x5adbda(0x7fd)][_0x5adbda(0x1371)]||'我';!Array['isArray'](_0x46a09a[_0x5adbda(0x1455)])&&(_0x46a09a['announcements']=[]);const _0x21678c={'id':'anno_'+Date[_0x5adbda(0x1386)](),'messageTimestamp':_0x73e029,'publisher':_0x2e2a14,'publishedAt':Date[_0x5adbda(0x1386)](),'isPinned':![]};_0x46a09a[_0x5adbda(0x1455)][_0x5adbda(0x1001)](_0x21678c);const _0x20fbb2={'role':_0x5adbda(0x11af),'type':_0x5adbda(0xb96),'content':_0x2e2a14+_0x5adbda(0xfc9),'timestamp':Date[_0x5adbda(0x1386)]()};_0x46a09a['history'][_0x5adbda(0x1001)](_0x20fbb2),await _0x6ed281['chats'][_0x5adbda(0x90c)](_0x46a09a),_0x4b384e(_0x20fbb2,_0x46a09a),_0x2d33eb(),await _0x104485('成功',_0x5adbda(0xbc9));}}async function _0x3aa73c(){const _0x426e09=_0x3ce1fb,_0x581490=_0x16699d[_0x426e09(0x1474)][_0x16699d[_0x426e09(0xf5a)]],_0xe34a1e=_0x581490[_0x426e09(0x1455)]||[];if(!_0x581490||_0xe34a1e[_0x426e09(0xaf9)]===0x0){_0x104485('提示','当前群聊还没有公告哦。');return;}const _0x5b382e=document[_0x426e09(0x948)]('announcement-board-content');_0x5b382e[_0x426e09(0xb6f)]='',_0xe34a1e['sort']((_0x59aec0,_0x5333dc)=>(_0x5333dc['isPinned']?0x1:0x0)-(_0x59aec0[_0x426e09(0x13a9)]?0x1:0x0));for(const _0x1f74e1 of _0xe34a1e){const _0x562688=_0x581490[_0x426e09(0xb07)][_0x426e09(0x1402)](_0x4c1a11=>_0x4c1a11[_0x426e09(0xb0a)]===_0x1f74e1[_0x426e09(0xf7d)]),_0x57bcaf=document['createElement']('div');_0x57bcaf[_0x426e09(0x35b)]=_0x426e09(0x1a6);if(_0x562688){const _0x46c124=await _0x1f8f7b(_0x562688,_0x581490);_0x46c124&&_0x57bcaf[_0x426e09(0x6b6)](_0x46c124);}else _0x57bcaf[_0x426e09(0xb6f)]=_0x426e09(0x38b);_0x1f74e1['isPinned']&&(_0x57bcaf['innerHTML']+='<div\x20class=\x22pinned-indicator\x22>📌</div>'),_0x57bcaf[_0x426e09(0xb6f)]+=_0x426e09(0x1ac)+_0x1f74e1['id']+_0x426e09(0x10aa),_0x5b382e[_0x426e09(0x6b6)](_0x57bcaf);}document['getElementById'](_0x426e09(0x252))[_0x426e09(0xd54)][_0x426e09(0xbd0)](_0x426e09(0xfcb));}let _0x15d05d=null;function _0x5cd4cb(_0x12a88f){const _0x21670a=_0x3ce1fb;_0x15d05d=_0x12a88f;const _0x2cbd60=_0x16699d[_0x21670a(0x1474)][_0x16699d['activeChatId']],_0x4c7056=_0x2cbd60[_0x21670a(0x1455)]['find'](_0x1740eb=>_0x1740eb['id']===_0x12a88f);if(!_0x4c7056)return;const _0x37b5d4=document['getElementById']('announcement-action-pin');_0x37b5d4['textContent']=_0x4c7056[_0x21670a(0x13a9)]?_0x21670a(0xc34):_0x21670a(0xae2),document[_0x21670a(0x948)](_0x21670a(0xca1))[_0x21670a(0xd54)]['add'](_0x21670a(0xfcb));}async function _0x2669cc(){const _0x1e74a6=_0x3ce1fb;if(!_0x15d05d)return;const _0x9253e5=_0x16699d[_0x1e74a6(0x1474)][_0x16699d[_0x1e74a6(0xf5a)]],_0x547fd2=_0x9253e5[_0x1e74a6(0x1455)][_0x1e74a6(0x1402)](_0x8a66b1=>_0x8a66b1['id']===_0x15d05d);_0x547fd2&&(_0x547fd2['isPinned']=!_0x547fd2[_0x1e74a6(0x13a9)],await _0x6ed281[_0x1e74a6(0x1474)][_0x1e74a6(0x90c)](_0x9253e5),_0x3aa73c()),document[_0x1e74a6(0x948)](_0x1e74a6(0xca1))[_0x1e74a6(0xd54)][_0x1e74a6(0xf89)](_0x1e74a6(0xfcb));}async function _0x48e164(){const _0x3fdbb0=_0x3ce1fb;if(!_0x15d05d)return;const _0x5371ed=await _0xa6b74a(_0x3fdbb0(0x8ed),_0x3fdbb0(0x1320),{'confirmButtonClass':_0x3fdbb0(0x5e8)});if(_0x5371ed){const _0x1bab01=_0x16699d['chats'][_0x16699d[_0x3fdbb0(0xf5a)]];_0x1bab01[_0x3fdbb0(0x1455)]=_0x1bab01[_0x3fdbb0(0x1455)]['filter'](_0x35f196=>_0x35f196['id']!==_0x15d05d),await _0x6ed281[_0x3fdbb0(0x1474)][_0x3fdbb0(0x90c)](_0x1bab01),_0x3aa73c();}document[_0x3fdbb0(0x948)]('announcement-actions-modal')[_0x3fdbb0(0xd54)][_0x3fdbb0(0xf89)](_0x3fdbb0(0xfcb));}let _0x1dfe69=![],_0x10b258={'ai':null,'my':null};function _0x481d03(_0x1af50d=_0x3ce1fb(0xdd2)){const _0x1eb248=_0x3ce1fb,_0x534b7d=document['getElementById'](_0x1eb248(0xa01));if(!_0x16699d[_0x1eb248(0xf5a)])return;const _0x3213f0=_0x16699d[_0x1eb248(0x1474)][_0x16699d[_0x1eb248(0xf5a)]];_0x1dfe69=_0x1af50d===_0x1eb248(0x13f7);if(_0x1dfe69){const _0x3ee34c=_0x3213f0[_0x1eb248(0x10a2)]['find'](_0x1623f6=>_0x1623f6['id']===_0x415cd3);if(!_0x3ee34c)return;_0x10b258['my']=_0x3ee34c[_0x1eb248(0x1278)]||'',_0x129767(!![],_0x3ee34c[_0x1eb248(0x63e)],_0x3ee34c[_0x1eb248(0x1278)]);}else _0x10b258['ai']=_0x3213f0[_0x1eb248(0x7fd)]['aiAvatarFrame']||'',_0x10b258['my']=_0x3213f0[_0x1eb248(0x7fd)][_0x1eb248(0x892)]||'',_0x129767(![]);_0x534b7d['classList'][_0x1eb248(0xbd0)](_0x1eb248(0xfcb));}function _0x129767(_0x28c94b=![],_0x1513eb=null,_0x2f2cf9=null){const _0x17fe02=_0x3ce1fb,_0x2a0ddd=document['getElementById'](_0x17fe02(0x11ba)),_0xdca480=document[_0x17fe02(0x948)](_0x17fe02(0xebc)),_0x442361=_0x16699d[_0x17fe02(0x1474)][_0x16699d['activeChatId']];_0x2a0ddd[_0x17fe02(0xb6f)]='',_0xdca480[_0x17fe02(0xb6f)]='',document[_0x17fe02(0xfeb)](_0x17fe02(0x2fb))[_0x17fe02(0xf74)][_0x17fe02(0x11fd)]=_0x28c94b?_0x17fe02(0x12fe):_0x17fe02(0x6a4),document[_0x17fe02(0x948)](_0x17fe02(0x1fc))[_0x17fe02(0xf74)][_0x17fe02(0x11fd)]=_0x17fe02(0x1273),document[_0x17fe02(0x948)](_0x17fe02(0xc13))['style'][_0x17fe02(0x11fd)]=_0x17fe02(0x12fe),document[_0x17fe02(0x948)]('ai-frame-tab')[_0x17fe02(0xd54)][_0x17fe02(0xbd0)](_0x17fe02(0x115e)),document['getElementById']('my-frame-tab')['classList'][_0x17fe02(0xf89)]('active');if(_0x28c94b)_0x6a7d66[_0x17fe02(0x427)](_0x3e7399=>{const _0xa14ce6=_0x17fe02,_0x123fec=_0x105b46(_0x3e7399,'my',_0x1513eb);_0x3e7399['url']===_0x2f2cf9&&_0x123fec[_0xa14ce6(0xd54)][_0xa14ce6(0xbd0)]('selected'),_0x2a0ddd[_0xa14ce6(0x6b6)](_0x123fec);});else{const _0xf5a3fc=_0x442361[_0x17fe02(0x7fd)][_0x17fe02(0x156d)]||_0x202ba5,_0x1ce3ff=_0x442361['settings'][_0x17fe02(0xb09)]||(_0x442361['isGroup']?_0x5c1dc1:_0x202ba5);_0x6a7d66[_0x17fe02(0x427)](_0x2c0eb4=>{const _0xbc3b03=_0x17fe02,_0x3aae06=_0x105b46(_0x2c0eb4,'ai',_0xf5a3fc);if(_0x2c0eb4['url']===_0x10b258['ai'])_0x3aae06[_0xbc3b03(0xd54)]['add'](_0xbc3b03(0xd56));_0x2a0ddd[_0xbc3b03(0x6b6)](_0x3aae06);const _0x4788f1=_0x105b46(_0x2c0eb4,'my',_0x1ce3ff);if(_0x2c0eb4[_0xbc3b03(0x9a8)]===_0x10b258['my'])_0x4788f1[_0xbc3b03(0xd54)][_0xbc3b03(0xbd0)]('selected');_0xdca480['appendChild'](_0x4788f1);});}}function _0x105b46(_0x14776d,_0x3eecbe,_0x350e86){const _0x526a07=_0x3ce1fb,_0x1ee1ef=document[_0x526a07(0x1497)](_0x526a07(0x379));return _0x1ee1ef[_0x526a07(0x35b)]=_0x526a07(0x13ad),_0x1ee1ef['dataset']['frameUrl']=_0x14776d['url'],_0x1ee1ef[_0x526a07(0xb03)]=_0x14776d[_0x526a07(0x1467)],_0x1ee1ef[_0x526a07(0xb6f)]=_0x526a07(0xbfe)+_0x350e86+_0x526a07(0x105d)+(_0x14776d[_0x526a07(0x9a8)]?_0x526a07(0x4ad)+_0x14776d[_0x526a07(0x9a8)]+_0x526a07(0xb89):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1ee1ef[_0x526a07(0x339)]('click',()=>{const _0x2a369a=_0x526a07;_0x10b258[_0x3eecbe]=_0x14776d[_0x2a369a(0x9a8)];const _0x456b15=_0x3eecbe==='ai'?document[_0x2a369a(0x948)](_0x2a369a(0x11ba)):document[_0x2a369a(0x948)](_0x2a369a(0xebc));_0x456b15['querySelectorAll'](_0x2a369a(0xb08))[_0x2a369a(0x427)](_0x156a8d=>_0x156a8d['classList'][_0x2a369a(0xf89)](_0x2a369a(0xd56))),_0x1ee1ef['classList']['add'](_0x2a369a(0xd56));}),_0x1ee1ef;}async function _0x1279d4(){const _0x5de145=_0x3ce1fb;if(!_0x16699d[_0x5de145(0xf5a)])return;const _0x5912f0=_0x16699d[_0x5de145(0x1474)][_0x16699d[_0x5de145(0xf5a)]];if(_0x1dfe69){const _0x180873=_0x5912f0[_0x5de145(0x10a2)][_0x5de145(0x1402)](_0x5a0d9f=>_0x5a0d9f['id']===_0x415cd3);_0x180873&&(_0x180873[_0x5de145(0x1278)]=_0x10b258['my']);}else _0x5912f0[_0x5de145(0x7fd)][_0x5de145(0x3b7)]=_0x10b258['ai'],_0x5912f0['settings'][_0x5de145(0x892)]=_0x10b258['my'];await _0x6ed281[_0x5de145(0x1474)]['put'](_0x5912f0);if(!_0x1dfe69&&!_0x5912f0['isGroup']){const _0x9ea077=_0x5912f0['id'];for(const _0x2ee04c of Object[_0x5de145(0x1166)](_0x16699d[_0x5de145(0x1474)])){if(_0x2ee04c[_0x5de145(0x1173)]&&_0x2ee04c[_0x5de145(0x10a2)]){const _0x54df7b=_0x2ee04c[_0x5de145(0x10a2)][_0x5de145(0x1402)](_0x31bb27=>_0x31bb27['id']===_0x9ea077);_0x54df7b&&(_0x54df7b[_0x5de145(0x1278)]=_0x5912f0[_0x5de145(0x7fd)]['aiAvatarFrame'],await _0x6ed281[_0x5de145(0x1474)][_0x5de145(0x90c)](_0x2ee04c),console['log'](_0x5de145(0x547)+_0x9ea077+_0x5de145(0x5e9)+_0x2ee04c[_0x5de145(0x1467)]+'\x22'));}}}document['getElementById']('avatar-frame-modal')[_0x5de145(0xd54)][_0x5de145(0xf89)](_0x5de145(0xfcb)),_0x455873(_0x16699d['activeChatId']),alert(_0x5de145(0x50d)),_0x1dfe69=![];}function _0x36abaf(){const _0x33ab54=_0x3ce1fb;_0x510843=!_0x510843;const _0x5842cf=document['getElementById'](_0x33ab54(0xc3f)),_0x5234fa=document[_0x33ab54(0x948)](_0x33ab54(0x9e5)),_0x3ceb62=document[_0x33ab54(0x948)](_0x33ab54(0x12c5));document[_0x33ab54(0x1188)](_0x33ab54(0xe40))[_0x33ab54(0x427)](_0x5da199=>{const _0x540496=_0x33ab54;_0x5da199[_0x540496(0xd54)][_0x540496(0x69d)](_0x540496(0x59d),_0x510843);}),_0x510843?(_0x5842cf[_0x33ab54(0x10cb)]='完成',_0x5234fa[_0x33ab54(0xf74)]['display']=_0x33ab54(0x6a4),_0x4eda35[_0x33ab54(0x99d)](),_0x3ceb62[_0x33ab54(0x210)]=![],_0x396343()):(_0x5842cf[_0x33ab54(0x10cb)]='管理',_0x5234fa['style']['display']=_0x33ab54(0x12fe),document['querySelectorAll']('.frame-item.selected')[_0x33ab54(0x427)](_0x2483e3=>{const _0x3f9217=_0x33ab54;_0x2483e3[_0x3f9217(0xd54)][_0x3f9217(0xf89)]('selected');}));}function _0x396343(){const _0x28a785=_0x3ce1fb,_0x24353e=document[_0x28a785(0x948)](_0x28a785(0x695));_0x24353e[_0x28a785(0x10cb)]=_0x28a785(0xf9b)+_0x4eda35[_0x28a785(0x8ca)]+')';}function _0x177008(){const _0xfca60a=_0x3ce1fb,_0x3ae32a=document[_0xfca60a(0x948)]('select-all-frames-checkbox')['checked'],_0x537a53=document[_0xfca60a(0xfeb)](_0xfca60a(0x1027));if(!_0x537a53)return;_0x537a53[_0xfca60a(0x1188)](_0xfca60a(0x410))['forEach'](_0x1d5f75=>{const _0x39dfca=_0xfca60a,_0x4e4fef=parseInt(_0x1d5f75[_0x39dfca(0xfeb)](_0x39dfca(0xbe0))[_0x39dfca(0x606)]['id']);if(isNaN(_0x4e4fef))return;_0x1d5f75['classList'][_0x39dfca(0x69d)]('selected',_0x3ae32a),_0x3ae32a?_0x4eda35[_0x39dfca(0xbd0)](_0x4e4fef):_0x4eda35[_0x39dfca(0x869)](_0x4e4fef);}),_0x396343();}async function _0x260255(){const _0x161ba0=_0x3ce1fb;if(_0x4eda35[_0x161ba0(0x8ca)]===0x0)return;const _0x144098=await _0xa6b74a('确认删除',_0x161ba0(0x3d5)+_0x4eda35[_0x161ba0(0x8ca)]+_0x161ba0(0x13f2),{'confirmButtonClass':_0x161ba0(0x5e8)});if(_0x144098){const _0x52e526=[..._0x4eda35];await _0x6ed281[_0x161ba0(0x1581)][_0x161ba0(0xd5d)](_0x52e526),_0x36abaf(),_0x129767(_0x1dfe69),await _0x104485('删除成功',_0x161ba0(0x4bd));}}function _0x5e5902(_0x281b18){const _0x219d18=_0x3ce1fb,_0x2e7a32=document[_0x219d18(0x948)](_0x219d18(0x55a));_0x2e7a32&&(_0x2e7a32['innerHTML']=_0x281b18||'');}async function _0x20cbe6(_0x55c9a7){const _0x3645cb=_0x3ce1fb;if(!_0x49c6c5[_0x3645cb(0x1032)]||!_0x49c6c5[_0x3645cb(0xf5a)])return;const _0x2cc168=_0x16699d[_0x3645cb(0x1474)][_0x49c6c5['activeChatId']];if(!_0x2cc168)return;const _0x1ff49d=_0x2cc168['isGroup']?_0x2cc168[_0x3645cb(0x7fd)]['myNickname']||'我':'我',_0x387d18=_0x3645cb(0x53e)+_0x1ff49d+')\x20'+_0x55c9a7+']',_0x145a10={'role':_0x3645cb(0x11af),'content':_0x387d18,'timestamp':Date[_0x3645cb(0x1386)](),'isHidden':!![]};_0x2cc168[_0x3645cb(0xb07)][_0x3645cb(0x1001)](_0x145a10),await _0x6ed281[_0x3645cb(0x1474)][_0x3645cb(0x90c)](_0x2cc168);}async function _0x438313(){const _0x126d28=_0x3ce1fb;if(_0x355e3f[_0x126d28(0x8ca)]===0x0)return;const _0x2ba277=_0x16699d[_0x126d28(0x1474)][_0x16699d[_0x126d28(0xf5a)]];if(!_0x2ba277)return;const _0x405455=document[_0x126d28(0x948)]('selection-screenshot-btn'),_0x5345cc=_0x405455[_0x126d28(0x10cb)];_0x405455[_0x126d28(0x10cb)]=_0x126d28(0x11fa),_0x405455[_0x126d28(0x2c0)]=!![];const _0x4a7775=document[_0x126d28(0x1497)](_0x126d28(0x379)),_0x4811c8=document[_0x126d28(0x948)](_0x126d28(0xecd));_0x4a7775['style'][_0x126d28(0x977)]=_0x4811c8['offsetWidth']+'px',_0x4a7775[_0x126d28(0xf74)]['position']=_0x126d28(0xcb9),_0x4a7775[_0x126d28(0xf74)][_0x126d28(0x102e)]=_0x126d28(0x57c),_0x4a7775[_0x126d28(0xf74)]['left']=_0x126d28(0x57c),_0x4a7775[_0x126d28(0xf74)][_0x126d28(0x11fd)]=_0x126d28(0x6a4),_0x4a7775['style'][_0x126d28(0x266)]=_0x126d28(0x118e),_0x4a7775[_0x126d28(0xf74)][_0x126d28(0xf38)]='auto';const _0x33c833=document[_0x126d28(0x948)](_0x126d28(0x152e));_0x4a7775[_0x126d28(0xf74)]['backgroundImage']=_0x33c833[_0x126d28(0xf74)][_0x126d28(0x618)],_0x4a7775['style']['backgroundColor']=_0x33c833[_0x126d28(0xf74)][_0x126d28(0xdb4)]||(document['getElementById'](_0x126d28(0xecd))[_0x126d28(0xd54)][_0x126d28(0x7a0)](_0x126d28(0x8ab))?_0x126d28(0x38e):_0x126d28(0xe1a));const _0x380e8d=document[_0x126d28(0x1497)](_0x126d28(0xf74));_0x380e8d[_0x126d28(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.message-bubble.selected::after\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.default-controls\x20{\x20display:\x20flex\x20!important;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20width:\x20100%;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.selection-controls\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',document[_0x126d28(0x1441)][_0x126d28(0x6b6)](_0x380e8d);try{const _0x3a75c3=_0x33c833['querySelector'](_0x126d28(0x6e2))['cloneNode'](!![]);_0x3a75c3[_0x126d28(0xd54)][_0x126d28(0xbd0)](_0x126d28(0xfaf));const _0x8a31f0=document[_0x126d28(0x1497)]('div'),_0x5dd2ac=document[_0x126d28(0x948)](_0x126d28(0x91c));_0x8a31f0[_0x126d28(0xf74)]['display']=_0x126d28(0x6a4),_0x8a31f0['style']['flexDirection']=_0x126d28(0x118e),_0x8a31f0[_0x126d28(0xf74)]['gap']=_0x126d28(0xb68),_0x8a31f0[_0x126d28(0xf74)][_0x126d28(0x301)]=_0x126d28(0x438),_0x8a31f0[_0x126d28(0xf74)][_0x126d28(0x977)]=_0x126d28(0xfa8),_0x8a31f0[_0x126d28(0xf74)][_0x126d28(0x109c)]=_0x126d28(0x13e7),_0x8a31f0[_0x126d28(0x606)]['theme']=_0x5dd2ac['dataset']['theme'],_0x8a31f0[_0x126d28(0xf74)][_0x126d28(0x121e)]('--chat-font-size',_0x5dd2ac['style']['getPropertyValue'](_0x126d28(0xc64)));const _0x2535fb=_0x33c833[_0x126d28(0xfeb)](_0x126d28(0x10c0))[_0x126d28(0xfc0)](!![]),_0x125ed5=[..._0x355e3f]['sort']((_0x1924ea,_0x927a38)=>_0x1924ea-_0x927a38);_0x125ed5[_0x126d28(0x427)](_0x26b643=>{const _0x402466=_0x126d28,_0x3c9573=document[_0x402466(0xfeb)](_0x402466(0x12bb)+_0x26b643+'\x22]');if(_0x3c9573){const _0x3aefa3=_0x3c9573[_0x402466(0x1090)]('.message-wrapper');_0x3aefa3&&_0x8a31f0[_0x402466(0x6b6)](_0x3aefa3[_0x402466(0xfc0)](!![]));}}),_0x4a7775[_0x126d28(0x6b6)](_0x3a75c3),_0x4a7775[_0x126d28(0x6b6)](_0x8a31f0),_0x4a7775[_0x126d28(0x6b6)](_0x2535fb),document['body'][_0x126d28(0x6b6)](_0x4a7775);const _0x5b277f=Array[_0x126d28(0x6e5)](_0x4a7775[_0x126d28(0x131b)](_0x126d28(0x1183))),_0x2276ab=_0x5b277f['map'](_0x2d4efe=>new Promise((_0x2edbcf,_0x5daaf1)=>{const _0x4be759=_0x126d28;if(_0x2d4efe[_0x4be759(0x147d)][_0x4be759(0x157f)](_0x4be759(0x1b3))){_0x2edbcf();return;}const _0x4e83ce=new Image();_0x4e83ce[_0x4be759(0x3a8)]=_0x4be759(0x1339),_0x4e83ce[_0x4be759(0x33a)]=_0x2edbcf,_0x4e83ce['onerror']=_0x2edbcf,_0x4e83ce[_0x4be759(0x147d)]=_0x2d4efe['src'];}));await Promise[_0x126d28(0xd49)](_0x2276ab);const _0x95e7c1=await html2canvas(_0x4a7775,{'allowTaint':!![],'useCORS':!![],'backgroundColor':null,'scale':window[_0x126d28(0x73e)]||0x2});_0x95e7c1[_0x126d28(0xb9c)](function(_0x44204c){const _0x5e4565=_0x126d28,_0x3424be=URL['createObjectURL'](_0x44204c),_0xdf450d=document[_0x5e4565(0x1497)]('a');_0xdf450d[_0x5e4565(0xf4c)]=_0x5e4565(0x1040)+_0x2ba277['name']+'-'+Date[_0x5e4565(0x1386)]()+'.png',_0xdf450d['href']=_0x3424be,document[_0x5e4565(0xae6)][_0x5e4565(0x6b6)](_0xdf450d),_0xdf450d[_0x5e4565(0x4f6)](),document[_0x5e4565(0xae6)][_0x5e4565(0x15a7)](_0xdf450d),URL[_0x5e4565(0x11e1)](_0x3424be);},_0x126d28(0x13ce));}catch(_0x4b706f){console[_0x126d28(0xc3e)](_0x126d28(0x1333),_0x4b706f),await _0x104485('生成失败',_0x126d28(0x8c8));}finally{document[_0x126d28(0xae6)][_0x126d28(0x15a7)](_0x4a7775),document['head'][_0x126d28(0x15a7)](_0x380e8d),_0x405455[_0x126d28(0x10cb)]=_0x5345cc,_0x405455[_0x126d28(0x2c0)]=![],_0x402014();}}function _0x5876e7(_0x28c275){const _0x461aea=_0x3ce1fb;if(!_0x28c275||typeof _0x28c275!=='string')return'';return _0x28c275=_0x28c275[_0x461aea(0x14e9)](/!h\{(.*?)\}/g,_0x461aea(0x1513)),_0x28c275=_0x28c275['replace'](/!u\{(.*?)\}/g,_0x461aea(0x743)),_0x28c275=_0x28c275[_0x461aea(0x14e9)](/!e\{(.*?)\}/g,_0x461aea(0x8af)),_0x28c275=_0x28c275[_0x461aea(0x14e9)](/!w\{(.*?)\}/g,_0x461aea(0xd5b)),_0x28c275=_0x28c275['replace'](/!m\{(.*?)\}/g,_0x461aea(0x253)),_0x28c275=_0x28c275[_0x461aea(0x14e9)](/\|\|(.*?)\|\|/g,_0x461aea(0xabb)),_0x28c275=_0x28c275[_0x461aea(0x14e9)](/\*\*(.*?)\*\*/g,'<strong>$1</strong>'),_0x28c275=_0x28c275[_0x461aea(0x14e9)](/\~\~(.*?)\~\~/g,'<s>$1</s>'),_0x28c275=_0x28c275[_0x461aea(0x14e9)](/\*(.*?)\*/g,_0x461aea(0x89c)),_0x28c275;}async function _0x4885eb(){const _0x375d70=_0x3ce1fb;console[_0x375d70(0x498)](_0x375d70(0x14a4));let _0x354fda=0x0;const _0xb86b29=Object[_0x375d70(0x1166)](_0x16699d[_0x375d70(0x1474)]);for(const _0x457eac of _0xb86b29){let _0x419499=![];for(const _0x305375 of _0x457eac[_0x375d70(0xb07)]){_0x305375['type']===_0x375d70(0x148f)&&_0x305375[_0x375d70(0x7f7)]===_0x375d70(0x3ec)&&_0x305375[_0x375d70(0x1554)]===_0x375d70(0x14c8)&&_0x305375['hasOwnProperty']('receiver')&&!_0x305375[_0x375d70(0xcf3)](_0x375d70(0xb57))&&(_0x305375['receiverName']=_0x305375[_0x375d70(0x4df)],delete _0x305375[_0x375d70(0x4df)],_0x419499=!![],_0x354fda++);}_0x419499&&(console['log'](_0x375d70(0xf4a)+_0x457eac['name']+'\x22\x20中发现并修复了旧红包数据。'),await _0x6ed281[_0x375d70(0x1474)][_0x375d70(0x90c)](_0x457eac));}_0x354fda>0x0?(console[_0x375d70(0x498)](_0x375d70(0x12fa)+_0x354fda+'\x20条红包记录。'),alert(_0x375d70(0x488)+_0x354fda+_0x375d70(0x397)),location[_0x375d70(0xd12)]()):console[_0x375d70(0x498)](_0x375d70(0x11f9));}function _0x2e16c2(_0xca191e){const _0x4d1b66=_0x3ce1fb,_0x223354=_0x16699d['chats'][_0xca191e];if(!_0x223354||_0x223354[_0x4d1b66(0x1173)])return;document[_0x4d1b66(0x948)](_0x4d1b66(0x6dd))['textContent']=_0x223354[_0x4d1b66(0x790)]||'...',document[_0x4d1b66(0x948)]('profile-random-jottings')[_0x4d1b66(0x10cb)]=_0x223354[_0x4d1b66(0x6f1)]||_0x4d1b66(0x76d);const _0x2c62a3=document['getElementById']('character-profile-modal');_0x2c62a3[_0x4d1b66(0xd54)][_0x4d1b66(0xbd0)](_0x4d1b66(0xfcb));}function _0x2a2a95(){const _0xc0b849=_0x3ce1fb;document[_0xc0b849(0x948)](_0xc0b849(0xb44))[_0xc0b849(0xf74)][_0xc0b849(0x11fd)]=_0xc0b849(0x12fe),document[_0xc0b849(0x948)](_0xc0b849(0xa93))[_0xc0b849(0xf74)][_0xc0b849(0x11fd)]='flex',_0x2e2c5b();}function _0x12ca3c(){const _0x3fd1b7=_0x3ce1fb;document['getElementById']('profile-thoughts-history-view')[_0x3fd1b7(0xf74)][_0x3fd1b7(0x11fd)]=_0x3fd1b7(0x12fe),document[_0x3fd1b7(0x948)](_0x3fd1b7(0xb44))['style'][_0x3fd1b7(0x11fd)]=_0x3fd1b7(0x6a4);}function _0x2e2c5b(){const _0x438dc1=_0x3ce1fb,_0x690823=document['getElementById'](_0x438dc1(0x11a0)),_0xf39d3f=_0x16699d[_0x438dc1(0x1474)][_0x16699d['activeChatId']];_0x690823['innerHTML']='';if(!_0xf39d3f||!_0xf39d3f[_0x438dc1(0xd94)]||_0xf39d3f[_0x438dc1(0xd94)][_0x438dc1(0xaf9)]===0x0){_0x690823[_0x438dc1(0xb6f)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20padding:\x2030px\x200;\x22>这里还没有历史记录哦。</p>';return;}const _0x370580=[..._0xf39d3f[_0x438dc1(0xd94)]][_0x438dc1(0xb26)](),_0x51eed5=_0x370580['slice'](0x0,_0x1c5d3d);_0x51eed5['forEach'](_0x2c3092=>{const _0x535a2d=_0x2e3a48(_0x2c3092);_0x690823['appendChild'](_0x535a2d);}),_0x21863c=_0x51eed5[_0x438dc1(0xaf9)],_0x370580[_0x438dc1(0xaf9)]>_0x21863c&&appendLoadMoreThoughtsButton(_0x690823);}async function _0xc4de1f(){const _0x431c70=_0x3ce1fb;if(_0x277943)return;_0x277943=!![];const _0x4f0011=document[_0x431c70(0x948)](_0x431c70(0x11a0)),_0x3b55a7=_0x16699d[_0x431c70(0x1474)][_0x16699d[_0x431c70(0xf5a)]];if(!_0x3b55a7){_0x277943=![];return;}_0x2176e3(_0x4f0011,_0x431c70(0x5eb)),await new Promise(_0x2e7d78=>setTimeout(_0x2e7d78,0x1f4));const _0x19c8aa=[..._0x3b55a7['thoughtsHistory']]['reverse'](),_0x44862b=_0x19c8aa['length'],_0x522bfd=_0x21863c,_0x2c0608=_0x21863c+_0x1c5d3d,_0xcef2fe=_0x19c8aa['slice'](_0x522bfd,_0x2c0608);_0x3c826e(_0x4f0011),_0xcef2fe['forEach'](_0x290fbc=>{const _0x59eecf=_0x431c70,_0x48d24c=_0x2e3a48(_0x290fbc);_0x4f0011[_0x59eecf(0x6b6)](_0x48d24c);}),_0x21863c+=_0xcef2fe[_0x431c70(0xaf9)],_0x277943=![];}function _0x2e3a48(_0x56ad48){const _0x54d725=_0x3ce1fb,_0x334181=document[_0x54d725(0x1497)](_0x54d725(0x379));_0x334181[_0x54d725(0x35b)]='thought-card';const _0x37ac0d=new Date(_0x56ad48['timestamp']),_0x4fbbe0=_0x37ac0d['getFullYear']()+'-'+String(_0x37ac0d[_0x54d725(0x12f9)]()+0x1)['padStart'](0x2,'0')+'-'+String(_0x37ac0d[_0x54d725(0x13fb)]())[_0x54d725(0x112d)](0x2,'0')+'\x20'+String(_0x37ac0d[_0x54d725(0x12c1)]())[_0x54d725(0x112d)](0x2,'0')+':'+String(_0x37ac0d[_0x54d725(0xc87)]())[_0x54d725(0x112d)](0x2,'0');return _0x334181[_0x54d725(0xb6f)]=_0x54d725(0x1382)+_0x56ad48[_0x54d725(0xb0a)]+_0x54d725(0x12b1)+_0x4fbbe0+_0x54d725(0x1302)+_0x56ad48[_0x54d725(0x790)]+_0x54d725(0x6d6)+_0x56ad48[_0x54d725(0x6f1)]+_0x54d725(0x842),_0x334181;}async function _0x4482cf(_0x5a7b13){const _0x22751c=_0x3ce1fb,_0x352f91=_0x5a7b13[_0x22751c(0xa50)][_0x22751c(0x10b0)][0x0];if(!_0x352f91)return;try{let _0x60cd7c,_0x48de45=null;if(_0x352f91[_0x22751c(0x1467)][_0x22751c(0x918)](_0x22751c(0x9ce))){const _0x543a75=await _0x352f91[_0x22751c(0x9ea)]();_0x60cd7c=JSON[_0x22751c(0xde0)](_0x543a75);}else{if(_0x352f91[_0x22751c(0x1467)][_0x22751c(0x918)](_0x22751c(0x1eb))){const _0x55963d=await _0x352f91[_0x22751c(0x767)]();_0x60cd7c=await _0x5c35c6(_0x55963d),_0x48de45=await new Promise(_0x5c336a=>{const _0x116568=_0x22751c,_0x485822=new FileReader();_0x485822[_0x116568(0x33a)]=()=>_0x5c336a(_0x485822[_0x116568(0x22a)]),_0x485822[_0x116568(0x5a5)](_0x352f91);});}else throw new Error(_0x22751c(0xf50));}await _0x2d680a(_0x60cd7c,_0x48de45);}catch(_0x2adf3d){console[_0x22751c(0xc3e)]('角色卡导入失败:',_0x2adf3d),await _0x104485(_0x22751c(0xd89),'无法解析角色卡文件。\x0a错误:\x20'+_0x2adf3d['message']);}finally{_0x5a7b13[_0x22751c(0xa50)][_0x22751c(0x5bc)]=null;}}function _0x5c35c6(_0x25ba9c){return new Promise((_0x1625de,_0x7fb6e2)=>{const _0x24087a=_0x6c9e,_0x2be447=new DataView(_0x25ba9c);if(_0x2be447['getUint32'](0x0)!==0x89504e47||_0x2be447[_0x24087a(0x3e1)](0x4)!==0xd0a1a0a)return _0x7fb6e2(new Error(_0x24087a(0x1398)));let _0x5a3690=0x8;const _0x1ef32b=new TextDecoder();while(_0x5a3690<_0x2be447[_0x24087a(0x403)]){const _0x2d0caf=_0x2be447[_0x24087a(0x3e1)](_0x5a3690),_0x17c57b=_0x1ef32b[_0x24087a(0x53a)](_0x25ba9c[_0x24087a(0x200)](_0x5a3690+0x4,_0x5a3690+0x8));if(_0x17c57b==='tEXt'){const _0x1c6b1d=new Uint8Array(_0x25ba9c,_0x5a3690+0x8,_0x2d0caf),_0x111855=_0x1c6b1d[_0x24087a(0x539)](0x0);if(_0x111855!==-0x1){const _0x26a4ce=_0x1ef32b[_0x24087a(0x53a)](_0x1c6b1d[_0x24087a(0x200)](0x0,_0x111855));if(_0x26a4ce==='chara'){const _0x48588e=_0x1ef32b[_0x24087a(0x53a)](_0x1c6b1d[_0x24087a(0x200)](_0x111855+0x1));try{const _0x15a233=atob(_0x48588e),_0x534374=new Uint8Array(_0x15a233[_0x24087a(0xaf9)]);for(let _0x32de44=0x0;_0x32de44<_0x15a233[_0x24087a(0xaf9)];_0x32de44++){_0x534374[_0x32de44]=_0x15a233[_0x24087a(0x141f)](_0x32de44);}const _0x5bd06d=new TextDecoder(_0x24087a(0x985))[_0x24087a(0x53a)](_0x534374);_0x1625de(JSON[_0x24087a(0xde0)](_0x5bd06d));return;}catch(_0x75738d){return _0x7fb6e2(new Error(_0x24087a(0x6f9)+_0x75738d[_0x24087a(0x74b)]));}}}}_0x5a3690+=0x4+0x4+_0x2d0caf+0x4;}_0x7fb6e2(new Error(_0x24087a(0x1583)));});}function _0x3f1cf2(_0x2367f3){const _0x83fed0=_0x3ce1fb;if(_0x2367f3[_0x83fed0(0x92a)]?.[_0x83fed0(0xbc4)]?.[_0x83fed0(0x6ea)]?.['length']>0x0)return console[_0x83fed0(0x498)](_0x83fed0(0x914)),_0x2367f3[_0x83fed0(0x92a)]['character_book'][_0x83fed0(0x6ea)];if(_0x2367f3['extensions']?.[_0x83fed0(0xbc4)]?.[_0x83fed0(0x6ea)]?.[_0x83fed0(0xaf9)]>0x0)return console[_0x83fed0(0x498)](_0x83fed0(0x91f)),_0x2367f3['extensions'][_0x83fed0(0xbc4)][_0x83fed0(0x6ea)];if(_0x2367f3['data']?.[_0x83fed0(0xaee)]?.['character_book']?.[_0x83fed0(0x6ea)]?.[_0x83fed0(0xaf9)]>0x0)return console[_0x83fed0(0x498)](_0x83fed0(0x107c)),_0x2367f3[_0x83fed0(0x92a)]['extensions'][_0x83fed0(0xbc4)][_0x83fed0(0x6ea)];const _0x30bd8d=[_0x83fed0(0xbc4),'lorebook',_0x83fed0(0xd8c),'char_book'];for(const _0x697d4e of _0x30bd8d){if(_0x2367f3[_0x697d4e]?.[_0x83fed0(0x6ea)]?.[_0x83fed0(0xaf9)]>0x0)return console[_0x83fed0(0x498)]('诊断：在顶层\x20'+_0x697d4e+'\x20中找到世界书。'),_0x2367f3[_0x697d4e]['entries'];}return console[_0x83fed0(0x498)]('诊断：未在此角色卡中找到任何有效的世界书数据。'),null;}async function _0x2d680a(_0xeb5daa,_0x1c6fae=null){const _0x17418e=_0x3ce1fb,_0x44545f=_0xeb5daa[_0x17418e(0x92a)]||_0xeb5daa;if(!_0x44545f[_0x17418e(0x1467)])throw new Error(_0x17418e(0x52f));let _0x3e3983=null;const _0xe3d818=_0x3f1cf2(_0xeb5daa);if(_0xe3d818){const _0x50c93e=_0xe3d818[_0x17418e(0x1c0)](_0x522523=>_0x522523[_0x17418e(0x111f)]&&_0x522523['content'])[_0x17418e(0x8ff)](_0x1ad245=>({'keys':_0x1ad245[_0x17418e(0x1cf)]||[],'comment':_0x1ad245[_0x17418e(0x282)]||'','content':_0x1ad245[_0x17418e(0xede)][_0x17418e(0x14e9)](/<memory>|<\/memory>/g,'')[_0x17418e(0x2a8)]()}));if(_0x50c93e[_0x17418e(0xaf9)]>0x0){const _0x5df757={'id':'wb_'+Date[_0x17418e(0x1386)](),'name':_0x44545f[_0x17418e(0x1467)]+_0x17418e(0x728),'content':_0x50c93e,'categoryId':null};await _0x6ed281[_0x17418e(0x44c)]['add'](_0x5df757),_0x16699d[_0x17418e(0x44c)][_0x17418e(0x1001)](_0x5df757),_0x3e3983=_0x5df757['id'];}}let _0x54ff79=_0x44545f[_0x17418e(0xe79)]||_0xeb5daa['description']||'无';_0x54ff79=_0x54ff79[_0x17418e(0x14e9)](/```yaml/g,'')[_0x17418e(0x14e9)](/```/g,'')[_0x17418e(0x14e9)](/<\/?info>/g,'')[_0x17418e(0x14e9)](/<\/?character>/g,'')['replace'](/<\/?writing_rule>/g,'')['replace'](/\[OOC：.*?\]/g,'')[_0x17418e(0x2a8)]();let _0xdd9a27=_0x17418e(0x355)+_0x54ff79+'\x0a\x0a';if(_0x44545f[_0x17418e(0x113a)])_0xdd9a27+=_0x17418e(0x14e7)+_0x44545f[_0x17418e(0x113a)]+'\x0a\x0a';if(_0x44545f[_0x17418e(0x3e3)])_0xdd9a27+='#\x20场景设定\x0a'+_0x44545f[_0x17418e(0x3e3)]+'\x0a\x0a';if(_0x44545f[_0x17418e(0x98d)])_0xdd9a27+='#\x20对话示例\x0a'+_0x44545f[_0x17418e(0x98d)]+'\x0a\x0a';const _0x31f42e=_0x44545f[_0x17418e(0x1467)],_0x1146f0=_0x44545f[_0x17418e(0x1467)],_0x171ecb='chat_'+Date[_0x17418e(0x1386)](),_0x2dbdb0={'id':_0x171ecb,'name':_0x31f42e[_0x17418e(0x2a8)](),'originalName':_0x1146f0['trim'](),'isGroup':![],'relationship':{'status':_0x17418e(0x1431)},'status':{'text':'在线','lastUpdate':Date[_0x17418e(0x1386)](),'isBusy':![]},'settings':{'aiPersona':_0xdd9a27,'myPersona':'我是谁呀。','maxMemory':0xa,'aiAvatar':_0x202ba5,'myAvatar':_0x202ba5,'background':'','theme':_0x17418e(0xe46),'fontSize':0xd,'customCss':'','linkedWorldBookIds':_0x3e3983?[_0x3e3983]:[],'aiAvatarLibrary':[]},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[]};_0x1c6fae&&(_0x2dbdb0[_0x17418e(0x7fd)]['aiAvatar']=_0x1c6fae,_0x2dbdb0[_0x17418e(0x7fd)][_0x17418e(0x13ab)][_0x17418e(0x1001)]({'name':_0x17418e(0x104e),'url':_0x1c6fae}));const _0x5b9fde=_0x44545f[_0x17418e(0x14e5)]||_0xeb5daa[_0x17418e(0x14e5)];if(_0x5b9fde&&typeof _0x5b9fde===_0x17418e(0x273)){const _0x10562b=document['createElement']('div');_0x10562b[_0x17418e(0xb6f)]=_0x5b9fde;const _0x199217=(_0x10562b[_0x17418e(0x10cb)]||_0x10562b[_0x17418e(0x14b4)]||'')[_0x17418e(0x14e9)](/原作者UR.*?开局/s,'')['trim']();_0x199217&&_0x2dbdb0['history'][_0x17418e(0x1001)]({'role':'assistant','senderName':_0x2dbdb0[_0x17418e(0x628)],'content':_0x199217,'timestamp':Date[_0x17418e(0x1386)]()});}_0x16699d[_0x17418e(0x1474)][_0x171ecb]=_0x2dbdb0,await _0x6ed281[_0x17418e(0x1474)][_0x17418e(0x90c)](_0x2dbdb0),_0x2d33eb();let _0xe364a3='角色\x20“'+_0x2dbdb0[_0x17418e(0x1467)]+_0x17418e(0x352);_0x3e3983&&(_0xe364a3+=_0x17418e(0xe9d)),await _0x104485(_0x17418e(0x12ef),_0xe364a3);}async function _0x127842(){const _0x5d0471=_0x3ce1fb;if(!_0x16699d['activeChatId'])return;const _0x32f349=_0x16699d[_0x5d0471(0x1474)][_0x16699d['activeChatId']],_0x3695d6=_0x32f349['settings']['alternateGreetings'];if(!_0x3695d6||_0x3695d6['length']===0x0){alert(_0x5d0471(0xc44));return;}const _0x286b55=_0x3695d6[_0x5d0471(0x8ff)]((_0x5b9581,_0x3f40d8)=>{const _0x13609a=_0x5d0471,_0x2148f6=_0x5b9581[_0x13609a(0x14e9)](/<[^>]*>/g,'')['trim']()[_0x13609a(0xeca)](0x0,0x14);return{'text':_0x13609a(0x98b)+(_0x3f40d8+0x1)+':\x20'+_0x2148f6+_0x13609a(0x76d),'value':_0x3f40d8};}),_0x1674db=await _0x9286bb('选择一个开场白',_0x286b55);if(_0x1674db!==null){const _0x20371c=await _0xa6b74a(_0x5d0471(0xc03),'切换开场将会【清空并替换】当前的所有聊天记录。确定要继续吗？',{'confirmButtonClass':_0x5d0471(0x5e8),'confirmText':_0x5d0471(0x11ab)});if(_0x20371c){const _0x103211=_0x3695d6[_0x1674db],_0x5ae493={'role':_0x5d0471(0x14c8),'senderName':_0x32f349[_0x5d0471(0x628)],'content':_0x103211,'timestamp':Date['now']()};_0x32f349[_0x5d0471(0xb07)]=[_0x5ae493],await _0x6ed281[_0x5d0471(0x1474)]['put'](_0x32f349),_0x455873(_0x32f349['id']),document['getElementById']('chat-settings-modal')['classList'][_0x5d0471(0xf89)](_0x5d0471(0xfcb)),await _0x104485('成功','已切换到新的开场故事！');}}}function _0x1078f4(_0x55c231={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x53cd09=_0x3ce1fb,_0x140149=document[_0x53cd09(0x1497)](_0x53cd09(0x379));_0x140149[_0x53cd09(0x35b)]=_0x53cd09(0x1285);const _0x11084b=_0x55c231[_0x53cd09(0x111f)]!==![]?_0x53cd09(0x210):'';return _0x140149['innerHTML']=_0x53cd09(0x103c)+_0x11084b+_0x53cd09(0xc4e)+(_0x55c231[_0x53cd09(0x282)]||'')+_0x53cd09(0xf81)+(_0x55c231['keys']||[])[_0x53cd09(0x121a)](',\x20')+_0x53cd09(0x486)+(_0x55c231[_0x53cd09(0xede)]||'')+_0x53cd09(0xd0f),_0x140149[_0x53cd09(0xfeb)]('.delete-block-btn')[_0x53cd09(0x339)](_0x53cd09(0x4f6),()=>{const _0xbbc352=_0x53cd09;_0x140149[_0xbbc352(0xf89)]();}),_0x140149;}async function _0x589570(){const _0x59a7ab=_0x3ce1fb;if(!_0x16699d[_0x59a7ab(0xf5a)])return;const _0x437b7b=_0x16699d[_0x59a7ab(0xf5a)],_0x7309e7=document['getElementById'](_0x59a7ab(0xf88));if(!_0x7309e7[_0x59a7ab(0xd54)]['contains'](_0x59a7ab(0xfcb))){const _0x355e69=document['querySelector'](_0x59a7ab(0x4c3));_0x7309e7[_0x59a7ab(0xf74)][_0x59a7ab(0x102e)]=_0x355e69['offsetHeight']+'px',_0x7309e7['style'][_0x59a7ab(0x11fd)]=_0x59a7ab(0x1273),(!_0x4c7ec4[_0x437b7b]||!_0x4c7ec4[_0x437b7b][_0x59a7ab(0x1032)])&&_0x1363bf(_0x437b7b),_0x580f3b(_0x437b7b),setTimeout(async()=>{const _0x3708aa=_0x59a7ab;_0x7309e7[_0x3708aa(0xd54)]['add']('visible');const _0x4ed416={'role':_0x3708aa(0x11af),'content':_0x3708aa(0x1589),'timestamp':Date['now'](),'isHidden':!![]};_0x16699d[_0x3708aa(0x1474)][_0x437b7b][_0x3708aa(0xb07)][_0x3708aa(0x1001)](_0x4ed416),await _0x6ed281[_0x3708aa(0x1474)][_0x3708aa(0x90c)](_0x16699d[_0x3708aa(0x1474)][_0x437b7b]);},0xa);}else await _0x5e94c0();}async function _0x5e94c0(){const _0x3212c6=_0x3ce1fb;if(!_0x16699d['activeChatId'])return;const _0xd244d8=_0x16699d[_0x3212c6(0xf5a)],_0x228d42=document[_0x3212c6(0x948)](_0x3212c6(0xf88));_0x228d42[_0x3212c6(0xd54)][_0x3212c6(0xf89)](_0x3212c6(0xfcb)),setTimeout(()=>{const _0x4ee42b=_0x3212c6;_0x228d42[_0x4ee42b(0xf74)][_0x4ee42b(0x11fd)]=_0x4ee42b(0x12fe);},0x12c);if(_0x4c7ec4[_0xd244d8]){_0x4c7ec4[_0xd244d8]['isActive']=![];const _0x57396d={'role':'system','content':_0x3212c6(0x6f3),'timestamp':Date[_0x3212c6(0x1386)](),'isHidden':!![]};_0x16699d['chats'][_0xd244d8][_0x3212c6(0xb07)]['push'](_0x57396d),await _0x6ed281[_0x3212c6(0x1474)]['put'](_0x16699d[_0x3212c6(0x1474)][_0xd244d8]);}}function _0x1363bf(_0x4a7c19){const _0x2bf70e=_0x3ce1fb,_0x3f5f4e=document[_0x2bf70e(0x948)]('gomoku-board'),_0x38c13d=document[_0x2bf70e(0x948)](_0x2bf70e(0xf88)),_0x2cd48e=document[_0x2bf70e(0x948)](_0x2bf70e(0x7b2)),_0x546709=_0x38c13d[_0x2bf70e(0x5f7)]-0x28,_0x5095b1=_0x38c13d[_0x2bf70e(0xa5e)]-_0x2cd48e[_0x2bf70e(0xa5e)]-0x28,_0xa88622=Math[_0x2bf70e(0x15b6)](Math['min'](_0x546709,_0x5095b1)),_0x52d95b=0xf,_0x161bac=Math['floor'](_0xa88622/_0x52d95b),_0xa676b0=_0x161bac*_0x52d95b;_0x3f5f4e[_0x2bf70e(0x977)]=_0xa676b0,_0x3f5f4e[_0x2bf70e(0xf38)]=_0xa676b0,_0x4c7ec4[_0x4a7c19]={'isActive':!![],'board':Array(_0x52d95b)['fill'](0x0)['map'](()=>Array(_0x52d95b)[_0x2bf70e(0x25f)](0x0)),'currentPlayer':0x1,'history':[],'isGameOver':![],'GRID_SIZE':_0x52d95b,'CELL_SIZE':_0x161bac};}function _0x580f3b(_0x4ba03c){const _0x4595a6=_0x3ce1fb,_0x36b5ad=_0x4c7ec4[_0x4ba03c];if(!_0x36b5ad)return;const _0x2b0772=document['getElementById']('gomoku-board'),_0x1f4bd9=_0x2b0772['getContext']('2d'),{GRID_SIZE:_0x19f4bf,CELL_SIZE:_0x446b91}=_0x36b5ad,_0x91a7e8=_0x446b91/0x2;_0x1f4bd9['clearRect'](0x0,0x0,_0x2b0772[_0x4595a6(0x977)],_0x2b0772['height']),_0x1f4bd9[_0x4595a6(0x135b)]=_0x4595a6(0x1101),_0x1f4bd9[_0x4595a6(0x419)](0x0,0x0,_0x2b0772['width'],_0x2b0772[_0x4595a6(0xf38)]),_0x1f4bd9[_0x4595a6(0x21e)]=_0x4595a6(0x3f6),_0x1f4bd9['lineWidth']=0x1;for(let _0xd02e55=0x0;_0xd02e55<_0x19f4bf;_0xd02e55++){_0x1f4bd9[_0x4595a6(0xe7a)](),_0x1f4bd9[_0x4595a6(0x13df)](_0x91a7e8,_0x91a7e8+_0xd02e55*_0x446b91),_0x1f4bd9['lineTo'](_0x2b0772[_0x4595a6(0x977)]-_0x91a7e8,_0x91a7e8+_0xd02e55*_0x446b91),_0x1f4bd9[_0x4595a6(0x72b)](),_0x1f4bd9[_0x4595a6(0xe7a)](),_0x1f4bd9['moveTo'](_0x91a7e8+_0xd02e55*_0x446b91,_0x91a7e8),_0x1f4bd9[_0x4595a6(0xe57)](_0x91a7e8+_0xd02e55*_0x446b91,_0x2b0772[_0x4595a6(0xf38)]-_0x91a7e8),_0x1f4bd9['stroke']();}for(let _0x3804e5=0x0;_0x3804e5<_0x19f4bf;_0x3804e5++){for(let _0x23a2c8=0x0;_0x23a2c8<_0x19f4bf;_0x23a2c8++){_0x36b5ad['board'][_0x3804e5][_0x23a2c8]!==0x0&&_0x1f146a(_0x1f4bd9,_0x23a2c8,_0x3804e5,_0x36b5ad[_0x4595a6(0x1da)][_0x3804e5][_0x23a2c8],_0x36b5ad);}}}function _0x1f146a(_0x54c71c,_0x5dff5f,_0x57edfb,_0x4aa704,_0x8a4c7b){const _0x270e0c=_0x3ce1fb,{CELL_SIZE:_0x255b86}=_0x8a4c7b,_0x14bc97=_0x255b86/0x2,_0x13657e=_0x255b86/0x2-0x2;_0x54c71c[_0x270e0c(0xe7a)](),_0x54c71c[_0x270e0c(0xba2)](_0x14bc97+_0x5dff5f*_0x255b86,_0x14bc97+_0x57edfb*_0x255b86,_0x13657e,0x0,0x2*Math['PI']),_0x4aa704===0x1?_0x54c71c[_0x270e0c(0x135b)]=_0x270e0c(0x20c):_0x54c71c[_0x270e0c(0x135b)]=_0x270e0c(0xa85),_0x54c71c[_0x270e0c(0x25f)]();}function _0x2ee7d6(_0x2ecf23){const _0x452bd0=_0x3ce1fb,_0x2724e5=_0x16699d['activeChatId'],_0x1db09f=_0x4c7ec4[_0x2724e5];if(!_0x1db09f||_0x1db09f[_0x452bd0(0xa60)]||_0x1db09f['currentPlayer']!==0x1)return;const _0x1a48d2=document[_0x452bd0(0x948)](_0x452bd0(0x14ef)),_0x1f1db8=_0x1a48d2[_0x452bd0(0x636)]('2d'),_0x1c3267=_0x1a48d2[_0x452bd0(0xde6)](),_0x33a819=_0x2ecf23[_0x452bd0(0x63d)]-_0x1c3267['left'],_0x1efb1a=_0x2ecf23[_0x452bd0(0x14fb)]-_0x1c3267[_0x452bd0(0x102e)],_0xef9475=Math['round']((_0x33a819-_0x1db09f[_0x452bd0(0x131f)]/0x2)/_0x1db09f[_0x452bd0(0x131f)]),_0x91734f=Math[_0x452bd0(0xec0)]((_0x1efb1a-_0x1db09f[_0x452bd0(0x131f)]/0x2)/_0x1db09f[_0x452bd0(0x131f)]);_0x580f3b(_0x2724e5);if(_0xef9475>=0x0&&_0xef9475<_0x1db09f[_0x452bd0(0x1341)]&&_0x91734f>=0x0&&_0x91734f<_0x1db09f[_0x452bd0(0x1341)]&&_0x1db09f[_0x452bd0(0x1da)][_0x91734f][_0xef9475]===0x0){const _0x274715=_0x1db09f[_0x452bd0(0x131f)]/0x2-0x2;_0x1f1db8[_0x452bd0(0xe7a)](),_0x1f1db8[_0x452bd0(0xba2)](_0x1db09f[_0x452bd0(0x131f)]/0x2+_0xef9475*_0x1db09f[_0x452bd0(0x131f)],_0x1db09f[_0x452bd0(0x131f)]/0x2+_0x91734f*_0x1db09f[_0x452bd0(0x131f)],_0x274715,0x0,0x2*Math['PI']),_0x1f1db8[_0x452bd0(0x135b)]=_0x452bd0(0x78b),_0x1f1db8[_0x452bd0(0x25f)]();}}function _0x368f05(_0x2d69c4){const _0x676c46=_0x3ce1fb,_0x28efd8=_0x16699d['activeChatId'],_0x8384ff=_0x4c7ec4[_0x28efd8];if(!_0x8384ff||_0x8384ff[_0x676c46(0xa60)]||_0x8384ff['currentPlayer']!==0x1)return;const _0x8102b3=document['getElementById']('gomoku-board'),_0x59acb4=_0x8102b3[_0x676c46(0xde6)](),_0x2e9284=_0x2d69c4[_0x676c46(0x63d)]-_0x59acb4[_0x676c46(0x102f)],_0x309ff2=_0x2d69c4['clientY']-_0x59acb4[_0x676c46(0x102e)],_0x37fdbd=Math[_0x676c46(0xec0)]((_0x2e9284-_0x8384ff[_0x676c46(0x131f)]/0x2)/_0x8384ff[_0x676c46(0x131f)]),_0x2955ac=Math['round']((_0x309ff2-_0x8384ff['CELL_SIZE']/0x2)/_0x8384ff[_0x676c46(0x131f)]);_0x37fdbd>=0x0&&_0x37fdbd<_0x8384ff[_0x676c46(0x1341)]&&_0x2955ac>=0x0&&_0x2955ac<_0x8384ff[_0x676c46(0x1341)]&&_0x8384ff[_0x676c46(0x1da)][_0x2955ac][_0x37fdbd]===0x0&&(_0x8384ff[_0x676c46(0x1da)][_0x2955ac][_0x37fdbd]=0x1,_0x8384ff[_0x676c46(0xb07)][_0x676c46(0x1001)]({'x':_0x37fdbd,'y':_0x2955ac,'player':0x1}),_0x580f3b(_0x28efd8),_0x5b4667(_0x37fdbd,_0x2955ac,0x1,_0x8384ff)?(_0x8384ff[_0x676c46(0xa60)]=!![],setTimeout(()=>alert(_0x676c46(0x10fd)),0x64),_0x3ba192(_0x676c46(0xaeb))):_0x8384ff[_0x676c46(0xa98)]=0x2);}function _0x4ce1cd(_0x4edd56,_0x4abf33=![]){const _0x28cefe=_0x3ce1fb,_0x1fac55=_0x16699d['activeChatId'],_0x5a6f73=_0x4c7ec4[_0x1fac55];if(!_0x5a6f73||_0x5a6f73[_0x28cefe(0xa60)])return;if(!_0x4abf33&&_0x5a6f73[_0x28cefe(0xa98)]!==0x2)return;const {x:_0x2ce2f4,y:_0x282a95}=_0x4edd56;_0x2ce2f4>=0x0&&_0x2ce2f4<_0x5a6f73[_0x28cefe(0x1341)]&&_0x282a95>=0x0&&_0x282a95<_0x5a6f73[_0x28cefe(0x1341)]&&_0x5a6f73[_0x28cefe(0x1da)][_0x282a95][_0x2ce2f4]===0x0?(_0x5a6f73[_0x28cefe(0x1da)][_0x282a95][_0x2ce2f4]=0x2,_0x5a6f73['history'][_0x28cefe(0x1001)]({'x':_0x2ce2f4,'y':_0x282a95,'player':0x2}),_0x580f3b(_0x1fac55),_0x5b4667(_0x2ce2f4,_0x282a95,0x2,_0x5a6f73)?(_0x5a6f73[_0x28cefe(0xa60)]=!![],setTimeout(()=>alert(_0x28cefe(0x9fa)),0x64),_0x3ba192('ai')):_0x5a6f73[_0x28cefe(0xa98)]=0x1):(console[_0x28cefe(0x9c1)](_0x28cefe(0x15a9),_0x4edd56),_0x5a6f73[_0x28cefe(0xa98)]=0x1);}function _0x5b4667(_0xa40240,_0x3c1940,_0x103214,_0x17a4fd){const {board:_0x3a1f22,GRID_SIZE:_0x380f88}=_0x17a4fd,_0x56a638=[[0x1,0x0],[0x0,0x1],[0x1,0x1],[0x1,-0x1]];for(const [_0x4b9b68,_0x58bc8a]of _0x56a638){let _0x1f506c=0x1;for(let _0x5c6a4e=0x1;_0x5c6a4e<0x5;_0x5c6a4e++){const _0x4abc18=_0xa40240+_0x5c6a4e*_0x4b9b68,_0xaf9ab=_0x3c1940+_0x5c6a4e*_0x58bc8a;if(_0x4abc18>=0x0&&_0x4abc18<_0x380f88&&_0xaf9ab>=0x0&&_0xaf9ab<_0x380f88&&_0x3a1f22[_0xaf9ab][_0x4abc18]===_0x103214)_0x1f506c++;else break;}for(let _0x427eab=0x1;_0x427eab<0x5;_0x427eab++){const _0x22bc80=_0xa40240-_0x427eab*_0x4b9b68,_0x3c96cd=_0x3c1940-_0x427eab*_0x58bc8a;if(_0x22bc80>=0x0&&_0x22bc80<_0x380f88&&_0x3c96cd>=0x0&&_0x3c96cd<_0x380f88&&_0x3a1f22[_0x3c96cd][_0x22bc80]===_0x103214)_0x1f506c++;else break;}if(_0x1f506c>=0x5)return!![];}return![];}function _0x248011(_0x3bf32d){const _0x4cebcf=_0x3ce1fb;if(!_0x3bf32d||!_0x3bf32d[_0x4cebcf(0x1032)])return'';let _0x304158=_0x4cebcf(0x6c6);_0x304158+=_0x3bf32d[_0x4cebcf(0x1da)][_0x4cebcf(0x8ff)](_0x4fd7ca=>_0x4fd7ca[_0x4cebcf(0x121a)]('\x20'))[_0x4cebcf(0x121a)]('\x0a');let _0x132b3b=_0x4cebcf(0xe16);return _0x132b3b+=_0x3bf32d[_0x4cebcf(0xb07)][_0x4cebcf(0x8ff)](_0x45b6aa=>'玩家'+_0x45b6aa[_0x4cebcf(0x1563)]+'下在('+_0x45b6aa['x']+','+_0x45b6aa['y']+')')[_0x4cebcf(0x121a)]('\x20->\x20'),'\x0a#\x20当前五子棋局势\x0a'+_0x304158+_0x4cebcf(0x469)+_0x132b3b+_0x4cebcf(0xa16);}async function _0x3ba192(_0x23c0e4){const _0x2dfbbd=_0x3ce1fb,_0x133db1=_0x16699d['activeChatId'],_0x52e062=_0x16699d['chats'][_0x133db1];if(!_0x52e062)return;const _0x51fc68=_0x52e062['isGroup']?_0x52e062[_0x2dfbbd(0x7fd)][_0x2dfbbd(0x1371)]||'我':'我',_0x90eb3f=_0x52e062['isGroup']?_0x2dfbbd(0xb69):_0x52e062[_0x2dfbbd(0x1467)],_0x2f8299=_0x23c0e4===_0x2dfbbd(0xaeb)?_0x51fc68:_0x90eb3f,_0x2b5c0a=_0x23c0e4===_0x2dfbbd(0xaeb)?_0x2dfbbd(0x433):'你赢了',_0x2ba605=_0x2dfbbd(0xf27)+_0x2f8299+_0x2dfbbd(0x893)+_0x2b5c0a+'。]',_0x3d3b4d={'role':_0x2dfbbd(0x11af),'content':_0x2ba605,'timestamp':Date[_0x2dfbbd(0x1386)](),'isHidden':!![]};_0x52e062[_0x2dfbbd(0xb07)][_0x2dfbbd(0x1001)](_0x3d3b4d),await _0x6ed281[_0x2dfbbd(0x1474)][_0x2dfbbd(0x90c)](_0x52e062),console['log'](_0x2dfbbd(0x236)+_0x23c0e4);}let _0x351656=![];async function _0x42dc5f(){const _0x324713=_0x3ce1fb,_0x99436b=document[_0x324713(0x948)](_0x324713(0x89f)),_0x11da62=document[_0x324713(0x948)](_0x324713(0x10de)),_0x5aaeb3=document['getElementById']('shopping-screen');_0x99436b[_0x324713(0xb6f)]='',_0x11da62[_0x324713(0xb6f)]='';const [_0x5e7a31,_0x2e43b0]=await Promise['all']([_0x6ed281[_0x324713(0x151a)][_0x324713(0x443)](),_0x6ed281[_0x324713(0x145f)][_0x324713(0x1088)]('name')['toArray']()]);_0x5aaeb3[_0x324713(0xd54)]['toggle']('management-mode',_0x351656);const _0x2a01ec=document[_0x324713(0x1497)](_0x324713(0x4e6));_0x2a01ec[_0x324713(0x35b)]=_0x324713(0x8fc),_0x2a01ec['textContent']='全部',_0x2a01ec[_0x324713(0x606)][_0x324713(0xd86)]='all';if(activeShoppingCategoryId===_0x324713(0xd49))_0x2a01ec['classList']['add']('active');_0x11da62[_0x324713(0x6b6)](_0x2a01ec),_0x2e43b0['forEach'](_0x2095e2=>{const _0x42e428=_0x324713,_0x162566=document[_0x42e428(0x1497)](_0x42e428(0x4e6));_0x162566['className']=_0x42e428(0x8fc),_0x162566[_0x42e428(0x10cb)]=_0x2095e2[_0x42e428(0x1467)],_0x162566[_0x42e428(0x606)]['categoryId']=_0x2095e2['id'];if(activeShoppingCategoryId===_0x2095e2['id'])_0x162566[_0x42e428(0xd54)][_0x42e428(0xbd0)]('active');_0x11da62[_0x42e428(0x6b6)](_0x162566);});let _0x48b2af;activeShoppingCategoryId===_0x324713(0xd49)?_0x48b2af=_0x5e7a31:_0x48b2af=_0x5e7a31['filter'](_0x5832ce=>_0x5832ce[_0x324713(0xd86)]===activeShoppingCategoryId);if(_0x48b2af['length']===0x0){const _0x442f36=activeShoppingCategoryId==='all'?_0x324713(0x10f8):_0x324713(0x6d1);_0x99436b[_0x324713(0xb6f)]=_0x324713(0xfbe)+_0x442f36+_0x324713(0x79d);return;}_0x48b2af['forEach'](_0x18e585=>{const _0x499b26=_0x324713,_0x1713cc=document['createElement'](_0x499b26(0x379));_0x1713cc[_0x499b26(0x35b)]=_0x499b26(0x5b5),_0x1713cc[_0x499b26(0x606)]['id']=_0x18e585['id'];const _0x27956f=_0x499b26(0x900);_0x1713cc['innerHTML']=_0x499b26(0xcfa)+_0x27956f+_0x499b26(0xe37)+_0x18e585[_0x499b26(0x15b8)]+'\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>'+_0x18e585['name']+_0x499b26(0xc8c)+_0x18e585[_0x499b26(0xa6a)][_0x499b26(0xd69)](0x2)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x99436b[_0x499b26(0x6b6)](_0x1713cc);});}function _0x3e0471(_0x3357d6){activeShoppingCategoryId=_0x3357d6,_0x42dc5f(),_0x25b79b();}function _0x25b79b(){const _0x10d726=_0x3ce1fb,_0x5b434f=document['getElementById'](_0x10d726(0xa24));if(!_0x5b434f)return;const _0x564730=_0x351656&&activeShoppingCategoryId!==_0x10d726(0xd49);_0x5b434f[_0x10d726(0xf74)][_0x10d726(0x11fd)]=_0x564730?_0x10d726(0x6a4):_0x10d726(0x12fe);}async function _0x4dd471(){const _0x11f0c3=_0x3ce1fb;if(activeShoppingCategoryId===_0x11f0c3(0xd49))return;const _0x88478f=activeShoppingCategoryId,_0x5d73af=await _0x6ed281['shoppingCategories'][_0x11f0c3(0xe8c)](_0x88478f);if(!_0x5d73af){alert(_0x11f0c3(0x607));return;}const _0x5275f3='确定要永久删除分类\x20“'+_0x5d73af['name']+_0x11f0c3(0x144c),_0x24e77b=await _0xa6b74a(_0x11f0c3(0x1233),_0x5275f3,{'confirmButtonClass':_0x11f0c3(0x5e8),'confirmText':'确认删除'});_0x24e77b&&(await _0x47d127(_0x88478f),activeShoppingCategoryId=_0x11f0c3(0xd49),await _0x42dc5f(),_0x25b79b(),await _0x104485('成功',_0x11f0c3(0x132a)+_0x5d73af[_0x11f0c3(0x1467)]+_0x11f0c3(0x322)));}async function _0x58a970(){const _0xd98879=_0x3ce1fb;activeShoppingCategoryId='all',await _0x42dc5f(),_0x58c3b1(_0xd98879(0x45c)),_0x25b79b();}async function _0x42dc5f(){const _0x71d91e=_0x3ce1fb,_0x475275=document[_0x71d91e(0x948)](_0x71d91e(0x89f)),_0x2884cd=document['getElementById'](_0x71d91e(0x10de)),_0x55014b=document[_0x71d91e(0x948)]('shopping-screen');_0x475275[_0x71d91e(0xb6f)]='',_0x2884cd[_0x71d91e(0xb6f)]='';const [_0x114e12,_0x3c602d]=await Promise[_0x71d91e(0xd49)]([_0x6ed281['shoppingProducts'][_0x71d91e(0x443)](),_0x6ed281['shoppingCategories'][_0x71d91e(0x1088)](_0x71d91e(0x1467))[_0x71d91e(0x443)]()]);_0x55014b[_0x71d91e(0xd54)][_0x71d91e(0x69d)](_0x71d91e(0x59d),_0x351656);const _0x32a211=document[_0x71d91e(0x1497)](_0x71d91e(0x4e6));_0x32a211[_0x71d91e(0x35b)]='product-category-tab',_0x32a211[_0x71d91e(0x10cb)]='全部',_0x32a211[_0x71d91e(0x606)][_0x71d91e(0xd86)]=_0x71d91e(0xd49);if(activeShoppingCategoryId==='all')_0x32a211[_0x71d91e(0xd54)][_0x71d91e(0xbd0)]('active');_0x2884cd[_0x71d91e(0x6b6)](_0x32a211),_0x3c602d[_0x71d91e(0x427)](_0x21aca8=>{const _0x4e4e23=_0x71d91e,_0x3d17a3=document[_0x4e4e23(0x1497)](_0x4e4e23(0x4e6));_0x3d17a3['className']='product-category-tab',_0x3d17a3['textContent']=_0x21aca8[_0x4e4e23(0x1467)],_0x3d17a3['dataset'][_0x4e4e23(0xd86)]=_0x21aca8['id'];if(activeShoppingCategoryId===_0x21aca8['id'])_0x3d17a3['classList'][_0x4e4e23(0xbd0)](_0x4e4e23(0x115e));_0x2884cd[_0x4e4e23(0x6b6)](_0x3d17a3);});let _0x2a1e0d;activeShoppingCategoryId===_0x71d91e(0xd49)?_0x2a1e0d=_0x114e12:_0x2a1e0d=_0x114e12[_0x71d91e(0x1c0)](_0x1df49d=>_0x1df49d[_0x71d91e(0xd86)]===activeShoppingCategoryId);if(_0x2a1e0d[_0x71d91e(0xaf9)]===0x0){const _0x3d303e=activeShoppingCategoryId===_0x71d91e(0xd49)?_0x71d91e(0x10f8):_0x71d91e(0x6d1);_0x475275[_0x71d91e(0xb6f)]=_0x71d91e(0xfbe)+_0x3d303e+'</p>';return;}_0x2a1e0d['forEach'](_0x2135c1=>{const _0x2ff877=_0x71d91e,_0x348a5d=document[_0x2ff877(0x1497)](_0x2ff877(0x379));_0x348a5d[_0x2ff877(0x35b)]=_0x2ff877(0x5b5),_0x348a5d[_0x2ff877(0x606)]['id']=_0x2135c1['id'];const _0x16d452=_0x351656?_0x2ff877(0x1569):'';_0x348a5d[_0x2ff877(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x16d452+_0x2ff877(0xa21)+_0x2135c1['imageUrl']+_0x2ff877(0xe17)+_0x2135c1['name']+_0x2ff877(0x970)+_0x2135c1[_0x2ff877(0xa6a)][_0x2ff877(0xd69)](0x2)+_0x2ff877(0x8a8),_0x475275['appendChild'](_0x348a5d);});}async function _0x620cfb(_0xe8007e,_0x235bf6=0x1,_0x8c8252=null){const _0x4636d7=_0x3ce1fb,_0xfc270c=_0x8c8252?_0x4cb957[_0x4636d7(0x1402)](_0x3eb766=>_0x3eb766[_0x4636d7(0x136d)]===_0xe8007e&&_0x3eb766[_0x4636d7(0x454)]?.[_0x4636d7(0x1467)]===_0x8c8252[_0x4636d7(0x1467)]):_0x4cb957['find'](_0x27dc75=>_0x27dc75[_0x4636d7(0x136d)]===_0xe8007e&&!_0x27dc75[_0x4636d7(0x454)]);if(_0xfc270c)_0xfc270c[_0x4636d7(0x10e6)]+=_0x235bf6;else{const _0x293689=await _0x6ed281[_0x4636d7(0x151a)]['get'](_0xe8007e);_0x293689&&_0x4cb957[_0x4636d7(0x1001)]({'productId':_0x293689['id'],'quantity':_0x235bf6,'variation':_0x8c8252});}_0x24f532();}function _0x1e21eb(_0x4f7ae3,_0x553d91){const _0x2507a0=_0x3ce1fb,_0x301ec1=_0x4cb957['findIndex'](_0x1e2c43=>_0x1e2c43[_0x2507a0(0x136d)]===_0x4f7ae3);_0x301ec1>-0x1&&(_0x4cb957[_0x301ec1][_0x2507a0(0x10e6)]+=_0x553d91,_0x4cb957[_0x301ec1][_0x2507a0(0x10e6)]<=0x0&&_0x4cb957['splice'](_0x301ec1,0x1),_0x24f532(),_0xdc4d94());}function _0x24f532(){const _0x165b1f=_0x3ce1fb,_0x158067=_0x4cb957[_0x165b1f(0x6ab)]((_0x128351,_0x436155)=>_0x128351+_0x436155['quantity'],0x0);document[_0x165b1f(0x948)](_0x165b1f(0x34c))[_0x165b1f(0x10cb)]=_0x158067,document[_0x165b1f(0x948)]('cart-title')[_0x165b1f(0x10cb)]=_0x165b1f(0x3df)+_0x158067+')',document[_0x165b1f(0x948)](_0x165b1f(0x949))[_0x165b1f(0x10cb)]=_0x165b1f(0x1387)+_0x158067+')';}function _0x347ffc(){const _0x47bb90=_0x3ce1fb;_0xdc4d94(),_0x58c3b1(_0x47bb90(0x11e3));}async function _0xdc4d94(){const _0x3618fc=_0x3ce1fb,_0x417794=document['getElementById'](_0x3618fc(0xe20));_0x417794[_0x3618fc(0xb6f)]='';let _0x4d8a33=0x0;if(_0x4cb957['length']===0x0)_0x417794[_0x3618fc(0xb6f)]=_0x3618fc(0xd83);else{const _0x67921c=_0x4cb957[_0x3618fc(0x8ff)](_0x10b9c5=>_0x10b9c5[_0x3618fc(0x136d)]),_0x2fe574=await _0x6ed281[_0x3618fc(0x151a)]['where']('id')[_0x3618fc(0x54e)](_0x67921c)[_0x3618fc(0x443)](),_0x390742=new Map(_0x2fe574[_0x3618fc(0x8ff)](_0x36ea71=>[_0x36ea71['id'],_0x36ea71]));_0x4cb957[_0x3618fc(0x427)](_0x48fad6=>{const _0x372c98=_0x3618fc,_0x41d88b=_0x390742[_0x372c98(0xe8c)](_0x48fad6[_0x372c98(0x136d)]);if(_0x41d88b){const _0x681496=document[_0x372c98(0x1497)](_0x372c98(0x379));_0x681496['className']=_0x372c98(0x1217);const _0x3a1e3e=_0x48fad6['variation']?_0x372c98(0x27a)+_0x48fad6['variation'][_0x372c98(0x1467)]+_0x372c98(0xc7f):'';_0x681496[_0x372c98(0xb6f)]=_0x372c98(0x1521)+_0x41d88b['id']+_0x372c98(0x1004)+(_0x48fad6[_0x372c98(0x454)]?.['imageUrl']||_0x41d88b[_0x372c98(0x15b8)])+'\x22\x20class=\x22cart-item-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-name\x22>'+_0x41d88b[_0x372c98(0x1467)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3a1e3e+_0x372c98(0x650)+(_0x48fad6[_0x372c98(0x454)]?.['price']||_0x41d88b[_0x372c98(0xa6a)])[_0x372c98(0xd69)](0x2)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quantity-control\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20decrease-qty-btn\x22\x20data-id=\x22'+_0x41d88b['id']+_0x372c98(0x812)+_0x48fad6[_0x372c98(0x10e6)]+_0x372c98(0xdab)+_0x41d88b['id']+_0x372c98(0xf31),_0x417794['appendChild'](_0x681496);}});}_0x510ef1();}async function _0x510ef1(){const _0x31de0c=_0x3ce1fb;let _0x15b2b9=0x0;const _0x330370=document[_0x31de0c(0x1188)]('.cart-item-checkbox:checked'),_0x4082d1=Array[_0x31de0c(0x6e5)](_0x330370)[_0x31de0c(0x8ff)](_0x2fe3bf=>parseInt(_0x2fe3bf[_0x31de0c(0x606)]['id']));if(_0x4082d1[_0x31de0c(0xaf9)]>0x0){const _0x458bba=await _0x6ed281[_0x31de0c(0x151a)]['where']('id')[_0x31de0c(0x54e)](_0x4082d1)[_0x31de0c(0x443)](),_0x27836f=new Map(_0x458bba[_0x31de0c(0x8ff)](_0xde3b44=>[_0xde3b44['id'],_0xde3b44]));_0x4cb957['forEach'](_0x3b624a=>{const _0x3dbbdf=_0x31de0c;if(_0x4082d1[_0x3dbbdf(0x1336)](_0x3b624a[_0x3dbbdf(0x136d)])){const _0xce1f0d=_0x27836f[_0x3dbbdf(0xe8c)](_0x3b624a[_0x3dbbdf(0x136d)]);if(_0xce1f0d){const _0x32c0cc=_0x3b624a['variation']?_0x3b624a['variation']['price']:_0xce1f0d[_0x3dbbdf(0xa6a)];_0x15b2b9+=_0x32c0cc*_0x3b624a[_0x3dbbdf(0x10e6)];}}});}document['getElementById'](_0x31de0c(0x727))[_0x31de0c(0x10cb)]='合计:\x20¥'+_0x15b2b9['toFixed'](0x2);}async function _0x38e72e(){const _0xa89dd8=_0x3ce1fb,_0x3fa3ce=_0x16699d['chats'][_0x16699d[_0xa89dd8(0xf5a)]];if(!_0x3fa3ce||!_0x3fa3ce[_0xa89dd8(0x1173)])return;const _0x4e6af6=document[_0xa89dd8(0x948)](_0xa89dd8(0xa61)),_0x3ec576=document[_0xa89dd8(0x948)](_0xa89dd8(0x36a));_0x3ec576[_0xa89dd8(0xb6f)]='';const _0x30fcf0=_0x3fa3ce['settings']['myNickname']||'我',_0x7834b3=_0x3fa3ce[_0xa89dd8(0x10a2)][_0xa89dd8(0x1c0)](_0x6a4439=>_0x6a4439[_0xa89dd8(0x347)]!==_0x30fcf0);_0x7834b3[_0xa89dd8(0x427)](_0x1091cc=>{const _0x360ab2=_0xa89dd8,_0x477ef0=document[_0x360ab2(0x1497)](_0x360ab2(0x379));_0x477ef0[_0x360ab2(0x35b)]='contact-picker-item',_0x477ef0[_0x360ab2(0x606)][_0x360ab2(0x100d)]=_0x1091cc[_0x360ab2(0x628)],_0x477ef0[_0x360ab2(0xb6f)]=_0x360ab2(0x705)+(_0x1091cc[_0x360ab2(0x63e)]||_0x3ca5ef)+_0x360ab2(0xfb9)+_0x1091cc[_0x360ab2(0x347)]+_0x360ab2(0x1544),_0x3ec576['appendChild'](_0x477ef0);}),document[_0xa89dd8(0x948)](_0xa89dd8(0x6a7))[_0xa89dd8(0x210)]=![],_0x4e6af6[_0xa89dd8(0xd54)]['add']('visible');}async function _0x40c48b(){const _0x59d91b=_0x3ce1fb,_0xa318ac=_0x16699d[_0x59d91b(0x1474)][_0x16699d[_0x59d91b(0xf5a)]],_0x46ba41=_0x4cb957['filter'](_0x3f5eef=>document[_0x59d91b(0xfeb)](_0x59d91b(0x374)+_0x3f5eef[_0x59d91b(0x136d)]+'\x22]:checked'));if(_0x46ba41[_0x59d91b(0xaf9)]===0x0){alert(_0x59d91b(0x426));return;}if(_0xa318ac[_0x59d91b(0x1173)])_0x38e72e();else{const _0x4008ad=await _0xa6b74a(_0x59d91b(0x4b5),_0x59d91b(0x1064),{'confirmText':_0x59d91b(0xe1d)});_0x4008ad&&await _0xf837b7(_0x46ba41);}}async function _0xf837b7(_0x2d52b9,_0xf07cc0=null){const _0x2bb2de=_0x3ce1fb;if(!_0x16699d[_0x2bb2de(0xf5a)])return;const _0x4414c6=_0x16699d[_0x2bb2de(0x1474)][_0x16699d[_0x2bb2de(0xf5a)]],_0x5b0073=_0x2d52b9[_0x2bb2de(0x8ff)](_0x5d5426=>_0x5d5426['productId']),_0x56c0fd=await _0x6ed281[_0x2bb2de(0x151a)][_0x2bb2de(0x1117)]('id')[_0x2bb2de(0x54e)](_0x5b0073)['toArray'](),_0x2a67c6=new Map(_0x56c0fd['map'](_0x4e3b8b=>[_0x4e3b8b['id'],_0x4e3b8b])),_0x2a1e61=_0x2d52b9[_0x2bb2de(0x8ff)](_0x82aae8=>{const _0x348d40=_0x2bb2de,_0x4b9656=_0x2a67c6['get'](_0x82aae8[_0x348d40(0x136d)]);return _0x82aae8['variation']?{'name':_0x4b9656[_0x348d40(0x1467)]+_0x348d40(0x1182)+_0x82aae8['variation'][_0x348d40(0x1467)],'price':_0x82aae8[_0x348d40(0x454)]['price'],'imageUrl':_0x82aae8[_0x348d40(0x454)]['imageUrl']||_0x4b9656[_0x348d40(0x15b8)],'quantity':_0x82aae8[_0x348d40(0x10e6)]}:{'name':_0x4b9656[_0x348d40(0x1467)],'price':_0x4b9656[_0x348d40(0xa6a)],'imageUrl':_0x4b9656[_0x348d40(0x15b8)],'quantity':_0x82aae8[_0x348d40(0x10e6)]};}),_0x55d2a3={'role':'user','type':'gift','timestamp':Date[_0x2bb2de(0x1386)](),'items':_0x2a1e61,'total':_0x2a1e61['reduce']((_0x5d5553,_0x342427)=>_0x5d5553+_0x342427[_0x2bb2de(0xa6a)]*_0x342427[_0x2bb2de(0x10e6)],0x0),'recipients':_0xf07cc0};_0x4414c6['history'][_0x2bb2de(0x1001)](_0x55d2a3);if(_0xf07cc0&&_0xf07cc0['length']>0x0){const _0x19e2ea=_0xf07cc0[_0x2bb2de(0x8ff)](_0x5332b6=>_0x589066(_0x4414c6,_0x5332b6))[_0x2bb2de(0x121a)]('、'),_0x4b7a2e={'role':_0x2bb2de(0x11af),'content':_0x2bb2de(0x53e)+(_0x4414c6[_0x2bb2de(0x7fd)][_0x2bb2de(0x1371)]||'我')+_0x2bb2de(0x139f)+_0x19e2ea+_0x2bb2de(0x14d3),'timestamp':Date[_0x2bb2de(0x1386)]()+0x1,'isHidden':!![]};_0x4414c6[_0x2bb2de(0xb07)][_0x2bb2de(0x1001)](_0x4b7a2e);}await _0x6ed281[_0x2bb2de(0x1474)][_0x2bb2de(0x90c)](_0x4414c6),_0x4b384e(_0x55d2a3,_0x4414c6),_0x2d33eb(),_0x4cb957=_0x4cb957[_0x2bb2de(0x1c0)](_0x877720=>!_0x2d52b9['some'](_0x451dab=>_0x451dab[_0x2bb2de(0x136d)]===_0x877720[_0x2bb2de(0x136d)])),_0x24f532(),_0x58c3b1(_0x2bb2de(0x152e)),await _0x104485('成功',_0x2bb2de(0x5f4));}function _0x112773(_0x437c50){const _0x23f8c4=_0x3ce1fb,_0x1a7f9e=_0x16699d['chats'][_0x16699d['activeChatId']],_0x5854b1=_0x1a7f9e[_0x23f8c4(0xb07)][_0x23f8c4(0x1402)](_0x584511=>_0x584511['timestamp']===_0x437c50);if(!_0x5854b1||_0x5854b1[_0x23f8c4(0x4ae)]!==_0x23f8c4(0x9e7))return;const _0x2b193d=document[_0x23f8c4(0x948)](_0x23f8c4(0x133e));let _0x5361f8='';_0x5854b1[_0x23f8c4(0x1351)][_0x23f8c4(0x427)](_0x27c591=>{const _0x1ce231=_0x23f8c4;_0x5361f8+=_0x1ce231(0x1334)+_0x27c591[_0x1ce231(0x1467)]+_0x1ce231(0x523)+_0x27c591['quantity']+_0x1ce231(0x76e)+_0x27c591[_0x1ce231(0xa6a)][_0x1ce231(0xd69)](0x2)+_0x1ce231(0x79a)+(_0x27c591['price']*_0x27c591[_0x1ce231(0x10e6)])['toFixed'](0x2)+_0x1ce231(0x133d);}),_0x2b193d[_0x23f8c4(0xb6f)]=_0x23f8c4(0xae4)+new Date(_0x5854b1[_0x23f8c4(0xb0a)])['toLocaleString']()+'</p></div><table\x20class=\x22receipt-items-table\x22><thead><tr><th\x20class=\x22item-name\x22>商品</th><th\x20class=\x22item-qty\x22>数量</th><th\x20class=\x22item-price\x22>单价</th><th\x20class=\x22item-subtotal\x22>小计</th></tr></thead><tbody>'+_0x5361f8+_0x23f8c4(0x1306)+_0x5854b1['total'][_0x23f8c4(0xd69)](0x2)+'</div><div\x20class=\x22receipt-footer\x22>感谢您的惠顾，欢迎再次光临！</div>',document[_0x23f8c4(0x948)](_0x23f8c4(0xbf0))[_0x23f8c4(0xd54)][_0x23f8c4(0xbd0)](_0x23f8c4(0xfcb));}async function _0x15f118(_0x17de68=null){const _0x216761=_0x3ce1fb;_0x512b70=_0x17de68;const _0x3d8ec2=document[_0x216761(0x948)](_0x216761(0xe35)),_0x10ca56=document['getElementById'](_0x216761(0x79f)),_0x5310ea=document[_0x216761(0x948)](_0x216761(0xad2)),_0xf5a1d0=document[_0x216761(0x948)](_0x216761(0xe8e)),_0x249016=document['getElementById'](_0x216761(0x4d9)),_0x34872d=document[_0x216761(0x948)](_0x216761(0xe67)),_0x2da1bd=document[_0x216761(0x948)]('product-category-select'),_0x405e6a=document['getElementById'](_0x216761(0x1576));_0x405e6a[_0x216761(0xb6f)]='',_0x2da1bd[_0x216761(0xb6f)]=_0x216761(0x6b8);const _0x25051f=await _0x6ed281['shoppingCategories']['toArray']();_0x25051f[_0x216761(0x427)](_0x330600=>{const _0x2016c9=_0x216761,_0x5ad23b=document['createElement'](_0x2016c9(0x152c));_0x5ad23b[_0x2016c9(0x5bc)]=_0x330600['id'],_0x5ad23b[_0x2016c9(0x10cb)]=_0x330600['name'],_0x2da1bd[_0x2016c9(0x6b6)](_0x5ad23b);});if(_0x17de68){_0x10ca56[_0x216761(0x10cb)]='编辑商品';const _0x220fef=await _0x6ed281[_0x216761(0x151a)][_0x216761(0xe8c)](_0x17de68);_0x5310ea[_0x216761(0x5bc)]=_0x220fef['name'],_0xf5a1d0['value']=_0x220fef['price'],_0x249016[_0x216761(0x5bc)]=_0x220fef['description']||'',_0x34872d['src']=_0x220fef[_0x216761(0x15b8)],_0x2da1bd[_0x216761(0x5bc)]=_0x220fef['categoryId']||'',_0x220fef[_0x216761(0x136a)]&&_0x220fef['variations'][_0x216761(0xaf9)]>0x0&&_0x220fef[_0x216761(0x136a)]['forEach'](_0x452352=>_0x3263df(_0x452352));}else _0x10ca56[_0x216761(0x10cb)]=_0x216761(0xcd6),_0x5310ea[_0x216761(0x5bc)]='',_0xf5a1d0[_0x216761(0x5bc)]='',_0x249016[_0x216761(0x5bc)]='',_0x34872d[_0x216761(0x147d)]=_0x216761(0xa10),_0x2da1bd[_0x216761(0x5bc)]='';_0x3d8ec2['classList'][_0x216761(0xbd0)](_0x216761(0xfcb));}async function _0x598449(){const _0x52d202=_0x3ce1fb,_0x934570=document[_0x52d202(0x948)](_0x52d202(0xad2))[_0x52d202(0x5bc)][_0x52d202(0x2a8)](),_0x5d197d=parseFloat(document[_0x52d202(0x948)](_0x52d202(0xe8e))[_0x52d202(0x5bc)]),_0x53de80=document[_0x52d202(0x948)](_0x52d202(0x4d9))[_0x52d202(0x5bc)][_0x52d202(0x2a8)](),_0x3fa6f5=document[_0x52d202(0x948)](_0x52d202(0xe67))['src'],_0x46cada=parseInt(document[_0x52d202(0x948)](_0x52d202(0xe89))[_0x52d202(0x5bc)])||null;if(!_0x934570){alert(_0x52d202(0x4b0));return;}if(isNaN(_0x5d197d)||_0x5d197d<0x0){alert(_0x52d202(0xcaa));return;}const _0x3a4392=[];document[_0x52d202(0x1188)](_0x52d202(0xff1))[_0x52d202(0x427)](_0x475738=>{const _0x3c1ffd=_0x52d202,_0x49a76b=_0x475738[_0x3c1ffd(0xfeb)](_0x3c1ffd(0x541))[_0x3c1ffd(0x5bc)][_0x3c1ffd(0x2a8)](),_0x1677e5=parseFloat(_0x475738['querySelector'](_0x3c1ffd(0xdac))['value']),_0x2ad0de=_0x475738['querySelector']('.variation-image-preview')['src'];_0x49a76b&&!isNaN(_0x1677e5)&&_0x1677e5>=0x0&&_0x3a4392[_0x3c1ffd(0x1001)]({'name':_0x49a76b,'price':_0x1677e5,'imageUrl':_0x2ad0de[_0x3c1ffd(0x1336)](_0x3c1ffd(0x877))?null:_0x2ad0de});});const _0x34ccf1={'name':_0x934570,'price':_0x5d197d,'description':_0x53de80,'imageUrl':_0x3fa6f5,'categoryId':_0x46cada,'variations':_0x3a4392};_0x512b70?await _0x6ed281['shoppingProducts'][_0x52d202(0xa0b)](_0x512b70,_0x34ccf1):await _0x6ed281[_0x52d202(0x151a)][_0x52d202(0xbd0)](_0x34ccf1),document[_0x52d202(0x948)]('product-editor-modal')[_0x52d202(0xd54)][_0x52d202(0xf89)](_0x52d202(0xfcb)),await _0x42dc5f();}async function _0x350b5d(){const _0x35a6de=_0x3ce1fb;await _0x29d24e(),_0x58c3b1(_0x35a6de(0xf5f));}async function _0x29d24e(){const _0x378f92=_0x3ce1fb,_0xe2f9e5=document[_0x378f92(0x948)](_0x378f92(0xf7f)),_0x233d90=document[_0x378f92(0x948)]('rules-content-container');_0xe2f9e5[_0x378f92(0xb6f)]='',_0x233d90[_0x378f92(0xb6f)]='';const _0x194067=await _0x6ed281[_0x378f92(0x31e)][_0x378f92(0x443)]();if(_0x194067[_0x378f92(0xaf9)]===0x0){_0x233d90[_0x378f92(0xb6f)]=_0x378f92(0xa43);return;}const _0x270051=document[_0x378f92(0x1497)]('button');_0x270051['className']=_0x378f92(0x1421),_0x270051[_0x378f92(0x10cb)]=_0x378f92(0xafe),_0x270051['dataset']['categoryId']=_0x378f92(0x13a0),_0xe2f9e5[_0x378f92(0x6b6)](_0x270051);const _0x509aee=document['createElement'](_0x378f92(0x379));_0x509aee['className']=_0x378f92(0x535),_0x509aee[_0x378f92(0x606)][_0x378f92(0xd86)]=_0x378f92(0x13a0),_0x233d90[_0x378f92(0x6b6)](_0x509aee);const _0x83c036=Object[_0x378f92(0x1166)](_0x16699d['chats'])['filter'](_0x33ee6e=>!_0x33ee6e[_0x378f92(0x1173)]&&_0x194067['some'](_0x2c7f1d=>_0x2c7f1d[_0x378f92(0x1029)]===_0x33ee6e['id']));_0x83c036[_0x378f92(0x427)](_0x3a14cd=>{const _0x285110=_0x378f92,_0x1ce2e4=document[_0x285110(0x1497)](_0x285110(0x4e6));_0x1ce2e4['className']=_0x285110(0x112f),_0x1ce2e4[_0x285110(0x10cb)]=_0x3a14cd[_0x285110(0x1467)],_0x1ce2e4[_0x285110(0x606)][_0x285110(0xd86)]=_0x3a14cd['id'],_0xe2f9e5[_0x285110(0x6b6)](_0x1ce2e4);const _0x206aea=document[_0x285110(0x1497)]('div');_0x206aea[_0x285110(0x35b)]='rules-category-pane',_0x206aea[_0x285110(0x606)]['categoryId']=_0x3a14cd['id'],_0x233d90[_0x285110(0x6b6)](_0x206aea);}),_0x194067[_0x378f92(0x427)](_0x2e4e95=>{const _0x479d79=_0x378f92,_0x1e90b7=_0x281846(_0x2e4e95),_0x118295=_0x233d90[_0x479d79(0xfeb)](_0x479d79(0xcff)+_0x2e4e95[_0x479d79(0x1029)]+'\x22]');_0x118295&&_0x118295[_0x479d79(0x6b6)](_0x1e90b7);}),document[_0x378f92(0x1188)](_0x378f92(0x118a))[_0x378f92(0x427)](_0x404e7d=>{const _0x25dfbe=_0x378f92;_0x404e7d['addEventListener'](_0x25dfbe(0x4f6),()=>_0x52f2b0(_0x404e7d[_0x25dfbe(0x606)][_0x25dfbe(0xd86)]));});}function _0x281846(_0x5d1909){const _0x3df334=_0x3ce1fb,_0x145b35=document[_0x3df334(0x1497)](_0x3df334(0x379));return _0x145b35[_0x3df334(0x35b)]=_0x3df334(0xdf2)+(_0x5d1909[_0x3df334(0x507)]?'enabled':''),_0x145b35[_0x3df334(0x606)]['ruleId']=_0x5d1909['id'],_0x145b35[_0x3df334(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>'+_0x5d1909[_0x3df334(0x1467)]+_0x3df334(0x61e)+_0x5d1909[_0x3df334(0x10af)]+_0x3df334(0xbd6),_0x145b35[_0x3df334(0x339)](_0x3df334(0x4f6),()=>_0x1a0360(_0x5d1909['id'])),_0x159366(_0x145b35,()=>_0x2b2a5a(_0x5d1909['id'])),_0x145b35;}async function _0x1a0360(_0x44cefb=null){const _0x505c1c=_0x3ce1fb;_0x497762=_0x44cefb;const _0xecc5c0=document[_0x505c1c(0x948)](_0x505c1c(0x806)),_0x14121e=document[_0x505c1c(0x948)](_0x505c1c(0xa1a)),_0x19ce49=document[_0x505c1c(0x948)](_0x505c1c(0x1222)),_0x1a3bb9=document[_0x505c1c(0x948)](_0x505c1c(0x13c3)),_0x141f68=document['getElementById'](_0x505c1c(0x75c)),_0x200ecf=document[_0x505c1c(0x948)](_0x505c1c(0x841)),_0x110301=document[_0x505c1c(0x948)](_0x505c1c(0x225));_0x1a3bb9['innerHTML']=_0x505c1c(0xd33),Object[_0x505c1c(0x1166)](_0x16699d['chats'])['filter'](_0x16e0ca=>!_0x16e0ca[_0x505c1c(0x1173)])[_0x505c1c(0x427)](_0x2e7616=>{const _0x366571=_0x505c1c;_0x1a3bb9[_0x366571(0xb6f)]+=_0x366571(0x638)+_0x2e7616['id']+'\x22>'+_0x2e7616[_0x366571(0x1467)]+'</option>';});if(_0x44cefb){_0x14121e[_0x505c1c(0x10cb)]='编辑规则';const _0x4904ba=await _0x6ed281['renderingRules'][_0x505c1c(0xe8c)](_0x44cefb);_0x19ce49[_0x505c1c(0x5bc)]=_0x4904ba['name'],_0x1a3bb9[_0x505c1c(0x5bc)]=_0x4904ba['chatId'],_0x141f68[_0x505c1c(0x5bc)]=_0x4904ba[_0x505c1c(0x10af)],_0x200ecf[_0x505c1c(0x5bc)]=_0x4904ba[_0x505c1c(0xded)],_0x110301[_0x505c1c(0x210)]=_0x4904ba[_0x505c1c(0x507)];}else _0x14121e[_0x505c1c(0x10cb)]=_0x505c1c(0x5a0),_0x19ce49[_0x505c1c(0x5bc)]='',_0x1a3bb9[_0x505c1c(0x5bc)]=_0x505c1c(0x13a0),_0x141f68['value']='',_0x200ecf[_0x505c1c(0x5bc)]='',_0x110301[_0x505c1c(0x210)]=!![];_0xecc5c0[_0x505c1c(0xd54)][_0x505c1c(0xbd0)](_0x505c1c(0xfcb));}async function _0x5641a1(){const _0x281b28=_0x3ce1fb,_0x36d900=document['getElementById'](_0x281b28(0x1222))[_0x281b28(0x5bc)][_0x281b28(0x2a8)](),_0x101ddd=document[_0x281b28(0x948)]('rule-regex-input')['value'][_0x281b28(0x2a8)]();if(!_0x36d900||!_0x101ddd){alert(_0x281b28(0x15a8));return;}try{new RegExp(_0x101ddd);}catch(_0xa9ef99){alert(_0x281b28(0x8a9)+_0xa9ef99[_0x281b28(0x74b)]);return;}const _0x1cb586={'name':_0x36d900,'chatId':document[_0x281b28(0x948)](_0x281b28(0x13c3))['value'],'regex':_0x101ddd,'template':document[_0x281b28(0x948)](_0x281b28(0x841))['value'],'isEnabled':document[_0x281b28(0x948)](_0x281b28(0x225))['checked']};_0x497762?await _0x6ed281['renderingRules'][_0x281b28(0xa0b)](_0x497762,_0x1cb586):await _0x6ed281[_0x281b28(0x31e)][_0x281b28(0xbd0)](_0x1cb586),document[_0x281b28(0x948)](_0x281b28(0x806))[_0x281b28(0xd54)][_0x281b28(0xf89)](_0x281b28(0xfcb)),await _0x29d24e();}async function _0x2b2a5a(_0x18d1c3){const _0x8a3ffe=_0x3ce1fb,_0x1ce229=await _0xa6b74a('删除规则',_0x8a3ffe(0x14d9),{'confirmButtonClass':_0x8a3ffe(0x5e8)});_0x1ce229&&(await _0x6ed281['renderingRules']['delete'](_0x18d1c3),await _0x29d24e());}async function _0x22f3dd(_0x12cd6f,_0x2a3726){const _0x3b90fa=_0x3ce1fb;if(_0x12cd6f[_0x3b90fa(0x2a8)]()['startsWith']('<')||!_0x12cd6f[_0x3b90fa(0x1336)]('[')&&!_0x12cd6f['includes']('{'))return _0x12cd6f;const _0x4375ef=await _0x6ed281[_0x3b90fa(0x31e)][_0x3b90fa(0x1117)](_0x3b90fa(0x1029))[_0x3b90fa(0xba9)](_0x3b90fa(0x13a0))['or'](_0x3b90fa(0x1029))[_0x3b90fa(0xba9)](_0x2a3726)[_0x3b90fa(0x443)]();let _0x209178=_0x12cd6f;for(const _0x1f2fc9 of _0x4375ef[_0x3b90fa(0x1c0)](_0x591599=>_0x591599['isEnabled'])){try{const _0x449ed2=new RegExp(_0x1f2fc9[_0x3b90fa(0x10af)],'g');_0x449ed2[_0x3b90fa(0x367)](_0x209178)&&(_0x209178=_0x209178[_0x3b90fa(0x14e9)](_0x449ed2,_0x1f2fc9[_0x3b90fa(0xded)]));}catch(_0x3048ef){console['error'](_0x3b90fa(0x3fd)+_0x1f2fc9[_0x3b90fa(0x1467)]+_0x3b90fa(0x3b0),_0x3048ef);}}return _0x209178;}async function _0x350b5d(){const _0x28c38d=_0x3ce1fb;await _0x29d24e(),_0x58c3b1(_0x28c38d(0xf5f));}async function _0x29d24e(){const _0x3b8796=_0x3ce1fb,_0xa8b2c3=document['getElementById'](_0x3b8796(0xf7f)),_0x61b3d8=document[_0x3b8796(0x948)](_0x3b8796(0xd7e));_0xa8b2c3['innerHTML']='',_0x61b3d8[_0x3b8796(0xb6f)]='';const _0x36ad1f=await _0x6ed281[_0x3b8796(0x31e)]['toArray']();if(_0x36ad1f['length']===0x0){_0x61b3d8[_0x3b8796(0xb6f)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>';return;}const _0x255b7f=document[_0x3b8796(0x1497)](_0x3b8796(0x4e6));_0x255b7f[_0x3b8796(0x35b)]=_0x3b8796(0x1421),_0x255b7f[_0x3b8796(0x10cb)]=_0x3b8796(0xafe),_0x255b7f[_0x3b8796(0x606)][_0x3b8796(0xd86)]=_0x3b8796(0x13a0),_0xa8b2c3[_0x3b8796(0x6b6)](_0x255b7f);const _0xd9b6e6=document[_0x3b8796(0x1497)](_0x3b8796(0x379));_0xd9b6e6[_0x3b8796(0x35b)]=_0x3b8796(0x535),_0xd9b6e6['dataset']['categoryId']='global',_0x61b3d8[_0x3b8796(0x6b6)](_0xd9b6e6);const _0x2c64f7=Object[_0x3b8796(0x1166)](_0x16699d[_0x3b8796(0x1474)])['filter'](_0x17f606=>!_0x17f606[_0x3b8796(0x1173)]&&_0x36ad1f['some'](_0x492aa0=>_0x492aa0[_0x3b8796(0x1029)]===_0x17f606['id']));_0x2c64f7[_0x3b8796(0x427)](_0x3a856d=>{const _0x18f1c1=_0x3b8796,_0x3c2ba0=document['createElement'](_0x18f1c1(0x4e6));_0x3c2ba0[_0x18f1c1(0x35b)]=_0x18f1c1(0x112f),_0x3c2ba0['textContent']=_0x3a856d['name'],_0x3c2ba0[_0x18f1c1(0x606)][_0x18f1c1(0xd86)]=_0x3a856d['id'],_0xa8b2c3[_0x18f1c1(0x6b6)](_0x3c2ba0);const _0x30a8bd=document[_0x18f1c1(0x1497)]('div');_0x30a8bd[_0x18f1c1(0x35b)]='rules-category-pane',_0x30a8bd[_0x18f1c1(0x606)]['categoryId']=_0x3a856d['id'],_0x61b3d8[_0x18f1c1(0x6b6)](_0x30a8bd);}),_0x36ad1f[_0x3b8796(0x427)](_0x3db47c=>{const _0x318f1d=_0x3b8796,_0x457a9f=_0x281846(_0x3db47c),_0x20e3b9=_0x61b3d8['querySelector']('.rules-category-pane[data-category-id=\x22'+_0x3db47c[_0x318f1d(0x1029)]+'\x22]');_0x20e3b9&&_0x20e3b9[_0x318f1d(0x6b6)](_0x457a9f);}),document[_0x3b8796(0x1188)]('.rules-tab')['forEach'](_0x16a0e2=>{const _0x142882=_0x3b8796;_0x16a0e2[_0x142882(0x339)](_0x142882(0x4f6),()=>_0x52f2b0(_0x16a0e2[_0x142882(0x606)]['categoryId']));});}function _0x281846(_0x3192b2){const _0x4851e4=_0x3ce1fb,_0x15cae6=document[_0x4851e4(0x1497)]('div');return _0x15cae6['className']=_0x4851e4(0xdf2)+(_0x3192b2[_0x4851e4(0x507)]?'enabled':''),_0x15cae6['dataset'][_0x4851e4(0xbb9)]=_0x3192b2['id'],_0x15cae6['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>'+_0x3192b2[_0x4851e4(0x1467)]+_0x4851e4(0x61e)+_0x3192b2[_0x4851e4(0x10af)]+_0x4851e4(0xbd6),_0x15cae6[_0x4851e4(0x339)](_0x4851e4(0x4f6),()=>_0x1a0360(_0x3192b2['id'])),_0x159366(_0x15cae6,()=>_0x2b2a5a(_0x3192b2['id'])),_0x15cae6;}async function _0x1a0360(_0x3ee757=null){const _0x4e84bb=_0x3ce1fb;_0x497762=_0x3ee757;const _0x57b799=document[_0x4e84bb(0x948)](_0x4e84bb(0x806)),_0x2da20e=document[_0x4e84bb(0x948)](_0x4e84bb(0xa1a)),_0x261635=document[_0x4e84bb(0x948)]('rule-name-input'),_0x20c301=document[_0x4e84bb(0x948)](_0x4e84bb(0x13c3)),_0x252d34=document[_0x4e84bb(0x948)]('rule-regex-input'),_0x543c6e=document[_0x4e84bb(0x948)](_0x4e84bb(0x841)),_0x5e1221=document[_0x4e84bb(0x948)](_0x4e84bb(0x225));_0x20c301[_0x4e84bb(0xb6f)]=_0x4e84bb(0xd33),Object[_0x4e84bb(0x1166)](_0x16699d['chats'])[_0x4e84bb(0x1c0)](_0x40489d=>!_0x40489d[_0x4e84bb(0x1173)])[_0x4e84bb(0x427)](_0x4104a1=>{const _0x565392=_0x4e84bb;_0x20c301[_0x565392(0xb6f)]+='<option\x20value=\x22'+_0x4104a1['id']+'\x22>'+_0x4104a1['name']+_0x565392(0x62e);});if(_0x3ee757){_0x2da20e[_0x4e84bb(0x10cb)]=_0x4e84bb(0x15b7);const _0x2164d0=await _0x6ed281[_0x4e84bb(0x31e)][_0x4e84bb(0xe8c)](_0x3ee757);_0x261635[_0x4e84bb(0x5bc)]=_0x2164d0[_0x4e84bb(0x1467)],_0x20c301[_0x4e84bb(0x5bc)]=_0x2164d0[_0x4e84bb(0x1029)],_0x252d34[_0x4e84bb(0x5bc)]=_0x2164d0[_0x4e84bb(0x10af)],_0x543c6e[_0x4e84bb(0x5bc)]=_0x2164d0[_0x4e84bb(0xded)],_0x5e1221[_0x4e84bb(0x210)]=_0x2164d0[_0x4e84bb(0x507)];}else _0x2da20e['textContent']='创建新规则',_0x261635[_0x4e84bb(0x5bc)]='',_0x20c301['value']=_0x4e84bb(0x13a0),_0x252d34[_0x4e84bb(0x5bc)]='',_0x543c6e[_0x4e84bb(0x5bc)]='',_0x5e1221['checked']=!![];_0x57b799[_0x4e84bb(0xd54)][_0x4e84bb(0xbd0)](_0x4e84bb(0xfcb));}async function _0x5641a1(){const _0x17af36=_0x3ce1fb,_0x1edf71=document[_0x17af36(0x948)]('rule-name-input')[_0x17af36(0x5bc)][_0x17af36(0x2a8)](),_0x424329=document[_0x17af36(0x948)]('rule-regex-input')[_0x17af36(0x5bc)][_0x17af36(0x2a8)]();if(!_0x1edf71||!_0x424329){alert(_0x17af36(0x15a8));return;}try{new RegExp(_0x424329);}catch(_0xcbe244){alert(_0x17af36(0x8a9)+_0xcbe244[_0x17af36(0x74b)]);return;}const _0x3c52d4={'name':_0x1edf71,'chatId':document[_0x17af36(0x948)](_0x17af36(0x13c3))['value'],'regex':_0x424329,'template':document['getElementById'](_0x17af36(0x841))[_0x17af36(0x5bc)],'isEnabled':document[_0x17af36(0x948)]('rule-enabled-switch')[_0x17af36(0x210)]};_0x497762?await _0x6ed281['renderingRules']['update'](_0x497762,_0x3c52d4):await _0x6ed281[_0x17af36(0x31e)][_0x17af36(0xbd0)](_0x3c52d4),document['getElementById'](_0x17af36(0x806))['classList']['remove'](_0x17af36(0xfcb)),await _0x29d24e();}async function _0x2b2a5a(_0x8e31f7){const _0x2e757e=_0x3ce1fb,_0x411c15=await _0xa6b74a(_0x2e757e(0x1132),_0x2e757e(0x14d9),{'confirmButtonClass':_0x2e757e(0x5e8)});_0x411c15&&(await _0x6ed281['renderingRules'][_0x2e757e(0x869)](_0x8e31f7),await _0x29d24e());}async function _0x22f3dd(_0x204d45,_0x4a7554){const _0x1fe929=_0x3ce1fb;if(_0x204d45[_0x1fe929(0x2a8)]()['startsWith']('<')||!_0x204d45[_0x1fe929(0x1336)]('[')&&!_0x204d45[_0x1fe929(0x1336)]('{'))return _0x204d45;if(!_0x49a146[_0x4a7554]){console[_0x1fe929(0x498)]('Caching\x20rendering\x20rules\x20for\x20chat:\x20'+_0x4a7554);const _0x321944=await _0x6ed281[_0x1fe929(0x31e)][_0x1fe929(0x1117)](_0x1fe929(0x1029))['equals'](_0x1fe929(0x13a0))['or'](_0x1fe929(0x1029))[_0x1fe929(0xba9)](_0x4a7554)['toArray']();_0x49a146[_0x4a7554]=_0x321944['filter'](_0xedc3b2=>_0xedc3b2[_0x1fe929(0x507)]);}const _0x52dc2e=_0x49a146[_0x4a7554];let _0x5e8aa5=_0x204d45;for(const _0x28d2c8 of _0x52dc2e){try{const _0x6e53fc=new RegExp(_0x28d2c8[_0x1fe929(0x10af)],'g');let _0x5e469a=_0x5e8aa5;_0x6e53fc[_0x1fe929(0x367)](_0x5e469a)&&(_0x5e8aa5=_0x5e8aa5[_0x1fe929(0x14e9)](_0x6e53fc,_0x28d2c8[_0x1fe929(0xded)]));}catch(_0x2d5c37){console[_0x1fe929(0xc3e)](_0x1fe929(0x3fd)+_0x28d2c8[_0x1fe929(0x1467)]+_0x1fe929(0x3b0),_0x2d5c37);}}return _0x5e8aa5;}function _0x23f1fe(_0x4a5c83){const _0x5bbe08=_0x3ce1fb;if(!_0x4a5c83)return'';const _0x2e7510=new Date(),_0x1b6a83=new Date(_0x4a5c83),_0x39fe0c=String(_0x1b6a83[_0x5bbe08(0x12c1)]())[_0x5bbe08(0x112d)](0x2,'0'),_0x35bb0c=String(_0x1b6a83[_0x5bbe08(0xc87)]())[_0x5bbe08(0x112d)](0x2,'0'),_0x17e68c=_0x39fe0c+':'+_0x35bb0c;if(_0x2e7510[_0x5bbe08(0x8bf)]()===_0x1b6a83[_0x5bbe08(0x8bf)]())return _0x17e68c;const _0x4e81f6=new Date();_0x4e81f6[_0x5bbe08(0xa27)](_0x2e7510[_0x5bbe08(0x13fb)]()-0x1);if(_0x4e81f6[_0x5bbe08(0x8bf)]()===_0x1b6a83['toDateString']())return _0x5bbe08(0xbe7)+_0x17e68c;const _0x146c7f=_0x1b6a83[_0x5bbe08(0x3c5)](),_0x51ff5d=String(_0x1b6a83[_0x5bbe08(0x12f9)]()+0x1)['padStart'](0x2,'0'),_0xfc1176=String(_0x1b6a83[_0x5bbe08(0x13fb)]())[_0x5bbe08(0x112d)](0x2,'0');return _0x2e7510[_0x5bbe08(0x3c5)]()===_0x146c7f?_0x51ff5d+'月'+_0xfc1176+'日\x20'+_0x17e68c:_0x146c7f+'年'+_0x51ff5d+'月'+_0xfc1176+'日\x20'+_0x17e68c;}function _0x3f126b(_0x567847){const _0x2728e1=_0x3ce1fb,_0x26cb47=document[_0x2728e1(0x1497)](_0x2728e1(0x379));_0x26cb47[_0x2728e1(0x35b)]='message-wrapper\x20system-pat';const _0x15f53b=document[_0x2728e1(0x1497)](_0x2728e1(0x379));return _0x15f53b['className']=_0x2728e1(0x11f0),_0x15f53b[_0x2728e1(0x10cb)]=_0x23f1fe(_0x567847),_0x26cb47['appendChild'](_0x15f53b),_0x26cb47;}async function _0x44f3d6(){const _0x4f665d=_0x3ce1fb,_0x2597c4=_0x16699d[_0x4f665d(0x1474)][_0x16699d[_0x4f665d(0xf5a)]];if(!_0x2597c4||!lastResponseTimestamps||lastResponseTimestamps[_0x4f665d(0xaf9)]===0x0){alert(_0x4f665d(0x111c));return;}_0x2597c4[_0x4f665d(0xb07)]=_0x2597c4[_0x4f665d(0xb07)][_0x4f665d(0x1c0)](_0x37aefe=>!lastResponseTimestamps['includes'](_0x37aefe['timestamp'])),await _0x6ed281[_0x4f665d(0x1474)][_0x4f665d(0x90c)](_0x2597c4),await _0x455873(_0x16699d[_0x4f665d(0xf5a)]),_0x1219ab();}async function _0x3d83c9(_0x516151,_0x1b3ea0){const _0x252114=_0x3ce1fb;if(!_0x16699d[_0x252114(0xf5a)])return;const _0x1464ed=_0x16699d[_0x252114(0x1474)][_0x16699d[_0x252114(0xf5a)]],_0x1cf89a=_0x1464ed[_0x252114(0xb07)][_0x252114(0x1018)](_0x5a7dac=>_0x5a7dac['timestamp']===_0x516151);if(_0x1cf89a===-0x1)return;const _0x5c1c6b=_0x1464ed[_0x252114(0xb07)][_0x1cf89a],_0x5cdd99=_0x5c1c6b[_0x252114(0xc4b)];if(!_0x5cdd99){await _0x104485(_0x252114(0xd9c),_0x252114(0x63c));return;}_0x1b3ea0['disabled']=!![],_0x1b3ea0[_0x252114(0xd54)][_0x252114(0xbd0)](_0x252114(0xb52));const _0x567ea7=_0x1b3ea0[_0x252114(0x1090)](_0x252114(0x10a6)),_0x1d6f84=_0x567ea7?_0x567ea7[_0x252114(0xfeb)](_0x252114(0x7f1)):null;_0x1d6f84&&(_0x1d6f84[_0x252114(0xf74)][_0x252114(0x9a2)]=_0x252114(0x3f4));try{const _0x2c219c=await _0x3036dd(_0x5cdd99,_0x1464ed['id']);_0x5c1c6b[_0x252114(0x15b8)]=_0x2c219c[_0x252114(0x15b8)],_0x5c1c6b[_0x252114(0xb54)]=_0x2c219c[_0x252114(0xb54)],await _0x6ed281[_0x252114(0x1474)][_0x252114(0x90c)](_0x1464ed),_0x1d6f84&&(_0x1d6f84[_0x252114(0x147d)]=_0x2c219c[_0x252114(0x15b8)],_0x1d6f84['title']=_0x2c219c[_0x252114(0xb54)],_0x1d6f84[_0x252114(0xf74)][_0x252114(0x9a2)]='1');}catch(_0x474a68){console[_0x252114(0xc3e)](_0x252114(0x2c7),_0x474a68),await _0x104485(_0x252114(0x1164),_0x252114(0x8dc)+_0x474a68['message']),_0x1d6f84&&(_0x1d6f84[_0x252114(0xf74)][_0x252114(0x9a2)]='1');}finally{_0x1b3ea0[_0x252114(0x2c0)]=![],_0x1b3ea0[_0x252114(0xd54)][_0x252114(0xf89)](_0x252114(0xb52));}}async function _0x57df0b(){const _0x488dff=_0x3ce1fb,_0x27dfc2=_0x16699d[_0x488dff(0x1474)][_0x16699d[_0x488dff(0xf5a)]];if(!_0x27dfc2)return;const _0x26d9f2=_0x27dfc2['history'][_0x488dff(0x655)](_0x1bd1fa=>_0x1bd1fa['role']===_0x488dff(0xaeb)&&!_0x1bd1fa['isHidden']);if(_0x26d9f2===-0x1){alert(_0x488dff(0xccc));return;}const _0x1ad15e=_0x27dfc2[_0x488dff(0xb07)][_0x488dff(0x655)](_0x1bad6b=>_0x1bad6b[_0x488dff(0x1554)]===_0x488dff(0x14c8));if(_0x1ad15e<_0x26d9f2){alert(_0x488dff(0x8ee));return;}_0x27dfc2[_0x488dff(0xb07)]=_0x27dfc2[_0x488dff(0xb07)][_0x488dff(0x200)](0x0,_0x26d9f2+0x1),await _0x6ed281[_0x488dff(0x1474)]['put'](_0x27dfc2),await _0x455873(_0x16699d['activeChatId']),await _0x45c50a();}async function _0x2841d0(){const _0x461e7d=_0x3ce1fb;if(!_0x1c6d6b[_0x461e7d(0x1032)])return;const _0x1bc65e=_0x1c6d6b[_0x461e7d(0xff6)][_0x461e7d(0x655)](_0x444b25=>_0x444b25[_0x461e7d(0x1554)]===_0x461e7d(0xaeb));if(_0x1bc65e===-0x1){alert(_0x461e7d(0x102d));return;}_0x1c6d6b[_0x461e7d(0xff6)][_0x461e7d(0x36d)](_0x1bc65e+0x1);const _0x21680e=document[_0x461e7d(0x948)]('video-call-main');_0x21680e[_0x461e7d(0xb6f)]='',_0x1c6d6b[_0x461e7d(0xff6)][_0x461e7d(0x427)](_0x563ea1=>{const _0x51a280=_0x461e7d,_0xda096a=document[_0x51a280(0x1497)](_0x51a280(0x379)),_0x51fcb9=_0x563ea1['role']===_0x51a280(0x14c8)?_0x51a280(0x1541):'user-speech';_0xda096a[_0x51a280(0x35b)]='call-message-bubble\x20'+_0x51fcb9,_0xda096a[_0x51a280(0x606)][_0x51a280(0xb0a)]=_0x563ea1['timestamp'],_0x563ea1[_0x51a280(0x1554)]===_0x51a280(0xaeb)?_0xda096a[_0x51a280(0x10cb)]=_0x563ea1[_0x51a280(0xede)]:_0xda096a[_0x51a280(0xb6f)]=_0x563ea1[_0x51a280(0xede)],_0x159366(_0xda096a,()=>_0x4ba9ed(_0x563ea1[_0x51a280(0xb0a)])),_0x21680e['appendChild'](_0xda096a);}),_0x21680e['scrollTop']=_0x21680e[_0x461e7d(0x971)],_0xc4d3ec(null);}async function _0x528181(){const _0x27c8c1=_0x3ce1fb,_0x49ea5c=_0x16699d[_0x27c8c1(0x1474)][_0x16699d['activeChatId']];if(!_0x49ea5c)return;_0xcc3e17(_0x49ea5c['id'],!![]);const _0x1ec719=document['getElementById']('chat-header-title');!_0x49ea5c[_0x27c8c1(0x1173)]&&(_0x1ec719['style'][_0x27c8c1(0x9a2)]=0x0,setTimeout(()=>{const _0xb3801c=_0x27c8c1;_0x1ec719[_0xb3801c(0x10cb)]=_0xb3801c(0x1131),_0x1ec719[_0xb3801c(0xd54)][_0xb3801c(0xbd0)]('typing-status'),_0x1ec719[_0xb3801c(0xf74)][_0xb3801c(0x9a2)]=0x1;},0xc8));try{const {proxyUrl:_0x598839,apiKey:_0x1d1561,model:_0x20cf07}=_0x16699d[_0x27c8c1(0x79e)];if(!_0x598839||!_0x1d1561||!_0x20cf07)throw new Error(_0x27c8c1(0xd25));const _0x598e96=parseInt(_0x49ea5c[_0x27c8c1(0x7fd)][_0x27c8c1(0x78a)])||0xa,_0x31afcc=_0x49ea5c[_0x27c8c1(0xb07)][_0x27c8c1(0x200)](-_0x598e96),_0x4e6220=new Date(),_0x10356d=new Date(_0x4e6220[_0x27c8c1(0x120b)]()+_0x4e6220['getTimezoneOffset']()*0xea60+0x36ee80*0x8),_0x18a65d=_0x10356d[_0x27c8c1(0xed3)](_0x27c8c1(0x144f),{'timeZone':_0x27c8c1(0xafa),'dateStyle':'full','timeStyle':_0x27c8c1(0xadb)}),_0x36aec9=_0x107c99(_0x10356d),_0x6c08eb=_0x49ea5c[_0x27c8c1(0x7fd)][_0x27c8c1(0x1371)]||'我';let _0x352077='';if(_0x49ea5c[_0x27c8c1(0x7fd)][_0x27c8c1(0xeee)]&&_0x49ea5c[_0x27c8c1(0x7fd)][_0x27c8c1(0xeee)][_0x27c8c1(0xaf9)]>0x0){const _0x59f269=_0x49ea5c['settings']['linkedWorldBookIds']['map'](_0x2dd613=>{const _0x52aa57=_0x27c8c1,_0x24f2af=_0x16699d['worldBooks']['find'](_0x11380c=>_0x11380c['id']===_0x2dd613);if(!_0x24f2af||!Array[_0x52aa57(0x1524)](_0x24f2af[_0x52aa57(0xede)]))return'';const _0x5f2adb=_0x24f2af['content'][_0x52aa57(0x1c0)](_0x12b426=>_0x12b426[_0x52aa57(0x111f)]!==![])['map'](_0x424407=>{const _0x504d6c=_0x52aa57;let _0x480800=_0x504d6c(0x886)+(_0x424407['comment']||'无备注')+'\x0a';if(_0x424407[_0x504d6c(0x1cf)][_0x504d6c(0xaf9)]>0x0)_0x480800+=_0x504d6c(0xc9d)+_0x424407[_0x504d6c(0x1cf)]['join'](',\x20')+'\x0a';return _0x480800+=_0x504d6c(0x30d)+_0x424407[_0x504d6c(0xede)],_0x480800;})[_0x52aa57(0x121a)]('');return _0x5f2adb?_0x52aa57(0x1067)+_0x24f2af[_0x52aa57(0x1467)]+'\x0a'+_0x5f2adb:'';})['filter'](Boolean)[_0x27c8c1(0x121a)]('');_0x59f269&&(_0x352077='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x59f269+_0x27c8c1(0x11b7));}let _0x211947='';if(_0x49c6c5['isActive']&&_0x49c6c5[_0x27c8c1(0xf5a)]===_0x49ea5c['id']){const _0x21a58f=_0x49c6c5[_0x27c8c1(0x73a)]>-0x1?_0x49c6c5['playlist'][_0x49c6c5[_0x27c8c1(0x73a)]]:null;_0x211947=_0x27c8c1(0x77e);}const _0x5c046a=_0x248011(_0x4c7ec4[_0x49ea5c['id']]);let _0x510fb3='';_0x49ea5c['nameHistory']&&_0x49ea5c[_0x27c8c1(0xace)]['length']>0x0&&(_0x510fb3=_0x27c8c1(0x128d)+_0x49ea5c[_0x27c8c1(0xace)]['join'](',\x20')+_0x27c8c1(0x8c9));let _0x5c6347='';const _0x43ea86=_0x16699d[_0x27c8c1(0x66e)][_0x27c8c1(0xf4d)]||'用户';_0x5c6347+=_0x27c8c1(0xd2b)+_0x43ea86+_0x27c8c1(0x851);const _0x37ae95=Object[_0x27c8c1(0x1166)](_0x16699d['chats'])[_0x27c8c1(0x1c0)](_0xc449eb=>_0xc449eb[_0x27c8c1(0x1173)]&&_0xc449eb[_0x27c8c1(0x10a2)][_0x27c8c1(0x1502)](_0x24ad5c=>_0x24ad5c['id']===_0x49ea5c['id']));_0x37ae95[_0x27c8c1(0xaf9)]>0x0&&(_0x5c6347+=_0x27c8c1(0xbaf),_0x37ae95['forEach'](_0xcd9b83=>{const _0x4a7e16=_0x27c8c1,_0x66e7d=_0xcd9b83[_0x4a7e16(0x7fd)][_0x4a7e16(0x1371)]||_0x43ea86;_0x5c6347+=_0x4a7e16(0x1493)+_0xcd9b83[_0x4a7e16(0x1467)]+_0x4a7e16(0xab5)+_0x66e7d+_0x4a7e16(0x76f);}));_0x5c6347+=_0x27c8c1(0xb5f);const _0x39a9fd=_0x5e13e4(_0x49ea5c),_0x489919=_0x27c8c1(0x1562)+_0x49ea5c['originalName']+_0x27c8c1(0xc9c)+_0x18a65d+'\x20('+_0x36aec9+_0x27c8c1(0xa3b)+(_0x211947?'你们正在一起听歌，'+_0x211947:_0x27c8c1(0xfa3))+_0x27c8c1(0x831)+(_0x49ea5c['longTermMemory']&&_0x49ea5c[_0x27c8c1(0x758)]['length']>0x0?_0x49ea5c[_0x27c8c1(0x758)][_0x27c8c1(0x8ff)](_0x5b6ea2=>'-\x20'+_0x5b6ea2['content'])[_0x27c8c1(0x121a)]('\x0a'):_0x27c8c1(0xad1))+_0x27c8c1(0x296)+_0x49ea5c['settings']['aiPersona']+_0x27c8c1(0xc2b)+_0x49ea5c[_0x27c8c1(0x628)]+_0x27c8c1(0x810)+_0x49ea5c['name']+'\x22\x20(你可以建议修改)\x0a-\x20\x20\x20**你对用户的称呼**:\x20“'+_0x6c08eb+_0x27c8c1(0x1465)+_0x5c6347+_0x27c8c1(0x1454)+_0x510fb3+_0x27c8c1(0x1454)+_0x352077+_0x27c8c1(0x90b)+_0x39a9fd+_0x27c8c1(0xb19)+(_0x49ea5c[_0x27c8c1(0x7fd)][_0x27c8c1(0x13ab)]&&_0x49ea5c[_0x27c8c1(0x7fd)][_0x27c8c1(0x13ab)][_0x27c8c1(0xaf9)]>0x0?_0x49ea5c[_0x27c8c1(0x7fd)][_0x27c8c1(0x13ab)][_0x27c8c1(0x8ff)](_0x1ea752=>'-\x20'+_0x1ea752[_0x27c8c1(0x1467)])[_0x27c8c1(0x121a)]('\x0a'):'-\x20(空)')+_0x27c8c1(0x756)+(_0x49ea5c[_0x27c8c1(0x7fd)][_0x27c8c1(0x3c2)]&&_0x49ea5c[_0x27c8c1(0x7fd)][_0x27c8c1(0x3c2)][_0x27c8c1(0xaf9)]>0x0?_0x49ea5c[_0x27c8c1(0x7fd)]['myAvatarLibrary'][_0x27c8c1(0x8ff)](_0x345b7e=>'-\x20'+_0x345b7e['name'])[_0x27c8c1(0x121a)]('\x0a'):_0x27c8c1(0x15a5))+_0x27c8c1(0x7a6)+_0x49ea5c[_0x27c8c1(0x7fd)][_0x27c8c1(0x13b6)]+'\x0a\x0a\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。',_0x5a40fe=_0x31afcc['map'](_0x5311ed=>({'role':_0x5311ed[_0x27c8c1(0x1554)],'content':String(_0x5311ed['content'])}));_0x5a40fe[_0x27c8c1(0x1001)]({'role':_0x27c8c1(0xaeb),'content':_0x27c8c1(0xa5b)});let _0x11f4bd=_0x598839===GEMINI_API_URL,_0x51a040=_0xe8c788(_0x20cf07,_0x1d1561,_0x489919,_0x5a40fe);const _0x599771=_0x11f4bd?await fetch(_0x51a040[_0x27c8c1(0x9a8)],_0x51a040[_0x27c8c1(0x92a)]):await fetch(_0x598839+'/v1/chat/completions',{'method':_0x27c8c1(0xdca),'headers':{'Content-Type':_0x27c8c1(0x479),'Authorization':'Bearer\x20'+_0x1d1561},'body':JSON[_0x27c8c1(0x526)]({'model':_0x20cf07,'messages':[{'role':'system','content':_0x489919},..._0x5a40fe],'temperature':_0x16699d[_0x27c8c1(0xf9c)]['apiTemperature']||0.8})});if(!_0x599771['ok']){const _0x1ff714=await _0x599771[_0x27c8c1(0x21d)]();throw new Error(_0x27c8c1(0x969)+_0x1ff714[_0x27c8c1(0xc3e)]['message']);}const _0x1993f8=await _0x599771[_0x27c8c1(0x21d)](),_0x1a4f8c=getGeminiResponseText(_0x1993f8),_0x32d698=_0xad600c(_0x1a4f8c),_0x379d65=[];for(const _0x3595fd of _0x32d698){if(_0x3595fd[_0x27c8c1(0x4ae)]===_0x27c8c1(0x9ea)&&typeof _0x3595fd[_0x27c8c1(0xede)]==='string'&&_0x3595fd['content'][_0x27c8c1(0x1336)]('\x0a')){const _0x44c159=_0x3595fd[_0x27c8c1(0xede)][_0x27c8c1(0x46f)](/\n+/)[_0x27c8c1(0x1c0)](_0x319bf6=>_0x319bf6[_0x27c8c1(0x2a8)]());_0x44c159[_0x27c8c1(0x427)](_0x3d96ce=>{const _0x2084cd=_0x27c8c1;_0x379d65[_0x2084cd(0x1001)]({..._0x3595fd,'content':_0x3d96ce});});}else _0x379d65[_0x27c8c1(0x1001)](_0x3595fd);}let _0x1e8f96=Date[_0x27c8c1(0x1386)]();for(const _0xd662c3 of _0x379d65){const _0x1e52eb={'role':_0x27c8c1(0x14c8),'senderName':_0x49ea5c[_0x27c8c1(0x628)],'timestamp':_0x1e8f96++,'content':_0xd662c3['content']||_0xd662c3[_0x27c8c1(0x74b)],'type':_0xd662c3[_0x27c8c1(0x4ae)]||_0x27c8c1(0x9ea)};if(_0xd662c3[_0x27c8c1(0x4ae)]==='update_thoughts'){if(!_0x49ea5c[_0x27c8c1(0x1173)]){if(_0xd662c3[_0x27c8c1(0x54a)])_0x49ea5c[_0x27c8c1(0x790)]=String(_0xd662c3[_0x27c8c1(0x54a)]);if(_0xd662c3['random_jottings'])_0x49ea5c[_0x27c8c1(0x6f1)]=String(_0xd662c3[_0x27c8c1(0xa96)]);}continue;}_0x49ea5c[_0x27c8c1(0xb07)][_0x27c8c1(0x1001)](_0x1e52eb),_0x4b384e(_0x1e52eb,_0x49ea5c),await new Promise(_0x44bddc=>setTimeout(_0x44bddc,Math[_0x27c8c1(0x59c)]()*0x3e8+0x320));}await _0x6ed281[_0x27c8c1(0x1474)][_0x27c8c1(0x90c)](_0x49ea5c),_0x2d33eb();}catch(_0x4ba812){console[_0x27c8c1(0xc3e)](_0x27c8c1(0x289),_0x4ba812),await _0x104485(_0x27c8c1(0xb6c),_0x27c8c1(0xd63)+_0x4ba812['message']);}finally{_0xcc3e17(_0x49ea5c['id'],![]);if(!_0x49ea5c[_0x27c8c1(0x1173)]&&document[_0x27c8c1(0x948)]('chat-header-title')){const _0x4f601e=document['getElementById'](_0x27c8c1(0x1069));_0x4f601e['style'][_0x27c8c1(0x9a2)]=0x0,setTimeout(()=>{const _0x4a5379=_0x27c8c1;_0x4f601e[_0x4a5379(0x10cb)]=_0x49ea5c['name'],_0x4f601e['classList'][_0x4a5379(0xf89)](_0x4a5379(0xb24)),_0x4f601e[_0x4a5379(0xf74)][_0x4a5379(0x9a2)]=0x1;},0xc8);}}}function _0x4b5874(){const _0x38ac2e=_0x3ce1fb,_0x43d2c1=document['getElementById'](_0x38ac2e(0xcfd)),_0xc20639=_0x16699d['globalSettings'][_0x38ac2e(0x803)]||_0x4e01dd;_0xc20639&&_0xc20639[_0x38ac2e(0x2a8)]()&&(_0x43d2c1[_0x38ac2e(0x147d)]=_0xc20639,_0x43d2c1[_0x38ac2e(0x293)]()[_0x38ac2e(0x1061)](_0x4ec1fc=>console[_0x38ac2e(0x498)](_0x38ac2e(0x1256),_0x4ec1fc)));}function _0x442c65(){const _0x2db245=_0x3ce1fb;if(!_0x16699d[_0x2db245(0xf9c)][_0x2db245(0x9aa)])return;for(const _0x2ab3d4 in _0x16699d[_0x2db245(0xf9c)][_0x2db245(0x9aa)]){const _0x6cd6fa=document[_0x2db245(0x948)](_0x2ab3d4),_0x1b6adf=_0x16699d['globalSettings'][_0x2db245(0x9aa)][_0x2ab3d4];_0x6cd6fa&&(_0x6cd6fa[_0x2db245(0x1440)]==='IMG'?_0x6cd6fa[_0x2db245(0x147d)]=_0x1b6adf:_0x6cd6fa[_0x2db245(0x10cb)]=_0x1b6adf);}}function _0x2c96d6(){return new Promise(_0x7ba711=>{const _0x213e64=_0x6c9e,_0x5b0320=document[_0x213e64(0x1497)](_0x213e64(0xc48));_0x5b0320['type']=_0x213e64(0x96f),_0x5b0320[_0x213e64(0x587)]=_0x213e64(0x1578),_0x5b0320[_0x213e64(0xc6f)]=_0x4371b9=>{const _0x36e282=_0x213e64,_0x2c562c=_0x4371b9[_0x36e282(0xa50)][_0x36e282(0x10b0)][0x0];if(_0x2c562c){const _0x1fd8e4=new FileReader();_0x1fd8e4['onload']=_0x16cb54=>{const _0x440761=_0x36e282;_0x7ba711(_0x16cb54[_0x440761(0xa50)][_0x440761(0x22a)]);},_0x1fd8e4[_0x36e282(0x5a5)](_0x2c562c);}else _0x7ba711(null);},_0x5b0320[_0x213e64(0x4f6)]();});}async function _0x35aba6(_0x5d779e){const _0x178204=_0x3ce1fb,_0x570d99=_0x5d779e['id'],_0x5660e3=_0x5d779e['textContent'],_0x300545=await _0x41b9fc(_0x178204(0x1065),_0x178204(0x35e),_0x5660e3);if(_0x300545!==null&&_0x300545[_0x178204(0x2a8)]()!==''){const _0x13de12=_0x300545['trim']();_0x5d779e[_0x178204(0x10cb)]=_0x13de12,_0x16699d[_0x178204(0xf9c)][_0x178204(0x9aa)][_0x570d99]=_0x13de12,await _0x6ed281[_0x178204(0xf9c)][_0x178204(0x90c)](_0x16699d['globalSettings']),alert(_0x178204(0xc28));}}async function _0x5caf1b(_0x5d031c){const _0x31c5b8=_0x3ce1fb,_0x478c38=_0x5d031c['id'],_0x1b1175=await _0x9286bb(_0x31c5b8(0x8a6),[{'text':'📁\x20从本地上传','value':_0x31c5b8(0x1179)},{'text':'🌐\x20使用网络URL','value':'url'}]);let _0x12af1f=null;if(_0x1b1175==='local')_0x12af1f=await _0x2c96d6();else _0x1b1175===_0x31c5b8(0x9a8)&&(_0x12af1f=await _0x41b9fc(_0x31c5b8(0x8a6),_0x31c5b8(0x481),_0x5d031c[_0x31c5b8(0x147d)],'url'));if(_0x12af1f&&_0x12af1f[_0x31c5b8(0x2a8)]()){const _0x1c92d7=_0x12af1f['trim']();_0x5d031c[_0x31c5b8(0x147d)]=_0x1c92d7,_0x16699d[_0x31c5b8(0xf9c)][_0x31c5b8(0x9aa)][_0x478c38]=_0x1c92d7,await _0x6ed281[_0x31c5b8(0xf9c)]['put'](_0x16699d[_0x31c5b8(0xf9c)]),alert(_0x31c5b8(0x343));}else _0x1b1175===_0x31c5b8(0x9a8)&&_0x12af1f!==null&&alert(_0x31c5b8(0x1186));}const _0x3dc2bb={'getSongCache'(_0x3fb4a2,_0x7bfead){const _0x5b8901=_0x3ce1fb,_0x4e1299=(_0x7bfead||_0x5b8901(0xd49))+':'+_0x3fb4a2;if(_0x16699d['cache']&&_0x16699d['cache']['songs']){const _0x133a2d=_0x16699d[_0x5b8901(0x361)][_0x5b8901(0x144a)][_0x5b8901(0xe8c)](_0x4e1299);if(_0x133a2d&&Date[_0x5b8901(0x1386)]()-_0x133a2d[_0x5b8901(0xb0a)]<0x36ee80)return _0x133a2d[_0x5b8901(0x92a)];}return null;},'setSongCache'(_0x299ace,_0x187673,_0x3267da){const _0x2e6dce=_0x3ce1fb,_0x58d549=(_0x3267da||_0x2e6dce(0xd49))+':'+_0x299ace;if(!_0x16699d['cache'])_0x16699d['cache']={};if(!_0x16699d[_0x2e6dce(0x361)][_0x2e6dce(0x144a)])_0x16699d[_0x2e6dce(0x361)][_0x2e6dce(0x144a)]=new Map();_0x16699d[_0x2e6dce(0x361)]['songs'][_0x2e6dce(0x450)](_0x58d549,{'data':_0x187673,'timestamp':Date['now']()});}};typeof Http_Get_External==='undefined'&&(window[_0x3ce1fb(0xbbf)]=function(_0x5cdcce){return new Promise(_0x3205fa=>{const _0x52d909=_0x6c9e;fetch(_0x5cdcce)[_0x52d909(0x7e5)](_0x21e1f5=>_0x21e1f5['json']()[_0x52d909(0x1061)](()=>_0x21e1f5[_0x52d909(0x9ea)]()))[_0x52d909(0x7e5)](_0x3205fa)['catch'](()=>_0x3205fa(null));});});async function _0x35d17b(_0xa531be){return await Http_Get_External(_0xa531be);}function _0x3ad547(_0xed10de){return new Promise(_0xd55c14=>{const _0x454544=_0x6c9e,_0x2585ad=new Audio();_0x2585ad[_0x454544(0x339)](_0x454544(0x5c0),()=>_0xd55c14(!![]),{'once':!![]}),_0x2585ad[_0x454544(0x339)]('error',()=>_0xd55c14(![]),{'once':!![]}),_0x2585ad['src']=_0xed10de;});}async function _0x16086c(_0x512644,_0x212ab3){const _0x4e8d4e=_0x3ce1fb;try{let _0x2256b5=_0x512644[_0x4e8d4e(0x14e9)](/\s/g,'');_0x212ab3&&(_0x2256b5+='\x20'+_0x212ab3['replace'](/\s/g,''));const _0x244df1='https://api.vkeys.cn/v2/music/netease?word='+encodeURIComponent(_0x2256b5);console[_0x4e8d4e(0x498)](_0x4e8d4e(0x1330),_0x244df1);const _0x6513e=await fetch(_0x244df1);if(!_0x6513e['ok'])throw new Error(_0x4e8d4e(0x1309)+_0x6513e['status']);const _0x56cbad=await _0x6513e[_0x4e8d4e(0x21d)]();if(_0x56cbad[_0x4e8d4e(0x513)]!==0xc8||!_0x56cbad[_0x4e8d4e(0x92a)]||_0x56cbad[_0x4e8d4e(0x92a)][_0x4e8d4e(0xaf9)]===0x0)return console[_0x4e8d4e(0x498)](_0x4e8d4e(0x1cb),_0x56cbad),[];return _0x56cbad['data'][_0x4e8d4e(0x8ff)](_0x22c605=>({'name':_0x22c605[_0x4e8d4e(0x99b)],'artist':_0x22c605['singer'],'id':_0x22c605['id'],'cover':_0x22c605['cover']||_0x4e8d4e(0x124b),'source':_0x4e8d4e(0x9e6)}))[_0x4e8d4e(0x200)](0x0,0x1e);}catch(_0x3efaec){return console[_0x4e8d4e(0xc3e)](_0x4e8d4e(0xea0),_0x3efaec),[];}}async function _0x16eafa(_0x5af376){const _0x3a9597=_0x3ce1fb;try{_0x5af376=_0x5af376[_0x3a9597(0x14e9)](/\s/g,'');const _0xd8a3e1=await _0x35d17b(_0x3a9597(0x7c1)+encodeURIComponent(_0x5af376));if(!_0xd8a3e1?.[_0x3a9597(0x92a)]?.[_0x3a9597(0xaf9)])return[];return _0xd8a3e1['data']['map'](_0x50d9f3=>({'name':_0x50d9f3['song'],'artist':_0x50d9f3['singer'],'id':_0x50d9f3['id'],'cover':_0x50d9f3[_0x3a9597(0xefe)]||_0x3a9597(0xfe5),'source':_0x3a9597(0x39b)}))['slice'](0x0,0x1e);}catch(_0xe1e72c){return console[_0x3a9597(0xc3e)](_0x3a9597(0xc33),_0xe1e72c),[];}}async function _0x56045c(){const _0x2b42f8=_0x3ce1fb,_0x1e6578=await _0x41b9fc(_0x2b42f8(0x9d3),_0x2b42f8(0x723));if(!_0x1e6578||!_0x1e6578[_0x2b42f8(0x2a8)]())return;await _0x104485(_0x2b42f8(0x960),'正在全网搜索歌曲资源...');let _0x4fff83=_0x1e6578['trim'](),_0x259129='';if(_0x1e6578[_0x2b42f8(0x1336)]('-')||_0x1e6578[_0x2b42f8(0x1336)]('–')){const _0x904dc5=_0x1e6578['split'](/[-–]/);_0x4fff83=_0x904dc5[0x0][_0x2b42f8(0x2a8)](),_0x259129=_0x904dc5[_0x2b42f8(0x200)](0x1)[_0x2b42f8(0x121a)]('\x20')[_0x2b42f8(0x2a8)]();}const [_0x2b32d5,_0x36d07d]=await Promise[_0x2b42f8(0xd49)]([_0x16086c(_0x4fff83,_0x259129),_0x16eafa(_0x4fff83)]),_0x6f3c88=[..._0x2b32d5,..._0x36d07d];if(_0x6f3c88[_0x2b42f8(0xaf9)]===0x0){await _0x104485(_0x2b42f8(0xb21),'抱歉，未能找到相关歌曲。');return;}const _0x4038dd=document[_0x2b42f8(0x948)]('music-search-results-modal'),_0x1c5774=document[_0x2b42f8(0x948)](_0x2b42f8(0x1468));_0x1c5774['innerHTML']='',document['getElementById']('select-all-music-search')[_0x2b42f8(0x210)]=![],_0x6f3c88[_0x2b42f8(0x427)](_0x37985c=>{const _0x171de5=_0x2b42f8,_0xb69d0d=document[_0x171de5(0x1497)](_0x171de5(0x379));_0xb69d0d['className']='search-result-item',_0xb69d0d[_0x171de5(0x606)]['songJson']=JSON[_0x171de5(0x526)](_0x37985c),_0xb69d0d[_0x171de5(0xb6f)]=_0x171de5(0x28a)+_0x37985c[_0x171de5(0x1467)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>'+_0x37985c[_0x171de5(0x43a)]+'\x20<span\x20class=\x22source\x22>'+(_0x37985c[_0x171de5(0x1105)]===_0x171de5(0x9e6)?'网易云':_0x171de5(0x159f))+_0x171de5(0x585),_0x1c5774[_0x171de5(0x6b6)](_0xb69d0d);}),_0x4038dd[_0x2b42f8(0xd54)][_0x2b42f8(0xbd0)](_0x2b42f8(0xfcb));}async function _0x493749(_0xa5a10c){const _0x2659f6=_0x3ce1fb;let _0x27bea4=null,_0xc344f8=_0xa5a10c[_0x2659f6(0x1105)];const _0x376d5b=_0xa5a10c['source']==='netease'?_0x2659f6(0x4a4)+_0xa5a10c['id']:'https://api.vkeys.cn/v2/music/tencent?id='+_0xa5a10c['id'];let _0x1b6fc1=await _0x35d17b(_0x376d5b);_0x1b6fc1?.['data']?.[_0x2659f6(0x9a8)]&&(_0x27bea4={'url':_0x1b6fc1[_0x2659f6(0x92a)]['url'],'id':_0xa5a10c['id'],'source':_0xa5a10c[_0x2659f6(0x1105)]});if(!_0x27bea4){const _0x1780a4=_0xa5a10c[_0x2659f6(0x1105)]===_0x2659f6(0x9e6)?'tencent':_0x2659f6(0x9e6),_0x3857a5=_0x1780a4===_0x2659f6(0x39b)?await _0x16eafa(_0xa5a10c[_0x2659f6(0x1467)]):await _0x16086c(_0xa5a10c[_0x2659f6(0x1467)],_0xa5a10c['artist']);if(_0x3857a5['length']>0x0){const _0x3a9907=_0x1780a4===_0x2659f6(0x9e6)?_0x2659f6(0x4a4)+_0x3857a5[0x0]['id']:_0x2659f6(0x6e3)+_0x3857a5[0x0]['id'],_0xa9b6d=await _0x35d17b(_0x3a9907);_0xa9b6d?.['data']?.[_0x2659f6(0x9a8)]&&(_0x27bea4={'url':_0xa9b6d['data'][_0x2659f6(0x9a8)],'id':_0x3857a5[0x0]['id'],'source':_0x1780a4},_0xc344f8=_0x1780a4);}}if(_0x27bea4){_0x27bea4['url']&&typeof _0x27bea4[_0x2659f6(0x9a8)]===_0x2659f6(0x273)&&(_0x27bea4[_0x2659f6(0x9a8)]=_0x27bea4['url'][_0x2659f6(0x14e9)](/^http:\/\//i,'https://'));_0xa5a10c['cover']&&typeof _0xa5a10c[_0x2659f6(0xefe)]==='string'&&(_0xa5a10c['cover']=_0xa5a10c[_0x2659f6(0xefe)][_0x2659f6(0x14e9)](/^http:\/\//i,_0x2659f6(0x12ec)));const _0x137334=await _0x24d6a8(_0x27bea4['id'],_0xc344f8)||'';return{'name':_0xa5a10c[_0x2659f6(0x1467)],'artist':_0xa5a10c['artist'],'src':_0x27bea4[_0x2659f6(0x9a8)],'cover':_0xa5a10c[_0x2659f6(0xefe)],'isLocal':![],'lrcContent':_0x137334};}return null;}async function _0x24d6a8(_0x4011e0,_0x1717d3){const _0x5b5006=_0x3ce1fb,_0x429842=_0x1717d3===_0x5b5006(0x9e6)?'https://api.vkeys.cn/v2/music/netease/lyric?id='+_0x4011e0:_0x5b5006(0xa1f)+_0x4011e0,_0x5f3f30=await _0x35d17b(_0x429842);if(_0x5f3f30?.[_0x5b5006(0x92a)]){const _0x168220=_0x5f3f30[_0x5b5006(0x92a)][_0x5b5006(0xab0)]||_0x5f3f30[_0x5b5006(0x92a)][_0x5b5006(0x10ee)]||'',_0x47a67f=_0x5f3f30[_0x5b5006(0x92a)][_0x5b5006(0x849)]||_0x5f3f30['data']['tlyric']||'';return _0x168220+'\x0a'+_0x47a67f;}return'';}async function _0x1866db(_0x5ca148){const _0x29d1c1=_0x3ce1fb;if(_0x5ca148<0x0||_0x5ca148>=_0x49c6c5['playlist'][_0x29d1c1(0xaf9)])return;const _0x51899e=await _0x9286bb(_0x29d1c1(0x14dc),[{'text':'📁\x20从本地文件\x20(.lrc)','value':_0x29d1c1(0x96f)},{'text':_0x29d1c1(0x1d6),'value':_0x29d1c1(0xe05)}]);let _0x39b4f3=null;if(_0x51899e===_0x29d1c1(0x96f))_0x39b4f3=await new Promise(_0x32a0fc=>{const _0x462a1e=_0x29d1c1,_0x520049=document[_0x462a1e(0x948)](_0x462a1e(0xac7)),_0x53a556=_0x1fb705=>{const _0x51dd49=_0x462a1e,_0x44ae98=_0x1fb705[_0x51dd49(0xa50)][_0x51dd49(0x10b0)][0x0];if(_0x44ae98){const _0xc2bfd4=new FileReader();_0xc2bfd4[_0x51dd49(0x33a)]=_0x496e2d=>_0x32a0fc(_0x496e2d[_0x51dd49(0xa50)][_0x51dd49(0x22a)]),_0xc2bfd4[_0x51dd49(0x12eb)]=()=>_0x32a0fc(null),_0xc2bfd4[_0x51dd49(0xd76)](_0x44ae98);}else _0x32a0fc(null);_0x520049[_0x51dd49(0x1558)](_0x51dd49(0x145c),_0x53a556),_0x520049['value']='';};_0x520049[_0x462a1e(0x339)](_0x462a1e(0x145c),_0x53a556,{'once':!![]}),_0x520049[_0x462a1e(0x4f6)]();});else{if(_0x51899e==='paste'){const _0x3312cc=await _0x41b9fc(_0x29d1c1(0x5c3),_0x29d1c1(0x1526),'',_0x29d1c1(0xc1e));if(_0x3312cc)_0x39b4f3=_0x3312cc[_0x29d1c1(0x14e9)](/\[/g,'\x0a[')[_0x29d1c1(0x2a8)]();}}_0x39b4f3!==null&&(_0x49c6c5['playlist'][_0x5ca148][_0x29d1c1(0xc1b)]=_0x39b4f3,await _0x26f02f(),_0x49c6c5[_0x29d1c1(0x73a)]===_0x5ca148&&(_0x49c6c5[_0x29d1c1(0x68d)]=_0x1192f8(_0x39b4f3),_0x25adec(),_0x2fd363()),await _0x104485('成功','《'+_0x49c6c5[_0x29d1c1(0x12c8)][_0x5ca148]['name']+'》的歌词已成功保存！'));}async function _0x18c8c1(){const _0xdb5ebe=_0x3ce1fb;if(_0x49c6c5[_0xdb5ebe(0x73a)]===-0x1)return;const _0x572b72=_0x49c6c5[_0xdb5ebe(0x12c8)][_0x49c6c5[_0xdb5ebe(0x73a)]];if(!_0x572b72)return;_0x572b72[_0xdb5ebe(0xbc3)]=!_0x572b72[_0xdb5ebe(0xbc3)],await _0x26f02f();const _0xef2f65=document[_0xdb5ebe(0xfeb)](_0xdb5ebe(0x33e)),_0x4de693=document['getElementById'](_0xdb5ebe(0x8e3));_0xef2f65[_0xdb5ebe(0xd54)][_0xdb5ebe(0x69d)]('bg-clear',_0x572b72[_0xdb5ebe(0xbc3)]),_0x4de693[_0xdb5ebe(0xd54)]['toggle'](_0xdb5ebe(0x115e),_0x572b72[_0xdb5ebe(0xbc3)]);}function _0x5b0ea9(){const _0x36725b=_0x3ce1fb,_0x406985=document[_0x36725b(0x948)](_0x36725b(0x20a)),_0x242853=document['getElementById'](_0x36725b(0xc10));_0x406985&&_0x242853&&(_0x406985[_0x36725b(0xd54)][_0x36725b(0x69d)]('visible'),_0x242853[_0x36725b(0xd54)]['toggle'](_0x36725b(0x115e)));}function _0x3c969e(){const _0x1e55ec=_0x3ce1fb,_0x4a2ed5=document[_0x1e55ec(0xfeb)]('.music-player-window'),_0x3705b3=document[_0x1e55ec(0x948)](_0x1e55ec(0x71e));_0x4a2ed5&&_0x3705b3&&(_0x4a2ed5[_0x1e55ec(0xd54)][_0x1e55ec(0x69d)](_0x1e55ec(0x23b)),_0x3705b3[_0x1e55ec(0xd54)][_0x1e55ec(0x69d)]('fullscreen-active'));}window[_0x3ce1fb(0x387)]=_0x3c969e;async function _0x223de3(){const _0xa0b75d=_0x3ce1fb;if(_0x49c6c5['playlist']['length']===0x0){alert(_0xa0b75d(0x14cc));return;}const _0xe6ed2f=await _0xa6b74a('确认清理无效歌曲？',_0xa0b75d(0x89b),{'confirmText':'开始清理'});if(!_0xe6ed2f)return;await _0x104485(_0xa0b75d(0x960),_0xa0b75d(0x5ef)+_0x49c6c5[_0xa0b75d(0x12c8)][_0xa0b75d(0xaf9)]+'\x20首歌曲，这可能需要一些时间...');const _0x3596d0=_0x49c6c5['playlist'][_0xa0b75d(0xaf9)],_0x226ba8=[],_0x28db60=[],_0x2a8c54=_0x49c6c5['playlist'][_0xa0b75d(0x8ff)](async _0x32f018=>{const _0x10ae08=_0xa0b75d;if(_0x32f018['isLocal']){_0x226ba8['push'](_0x32f018);return;}const _0x530228=await _0x3ad547(_0x32f018[_0x10ae08(0x147d)]);_0x530228?_0x226ba8[_0x10ae08(0x1001)](_0x32f018):(_0x28db60[_0x10ae08(0x1001)](_0x32f018[_0x10ae08(0x1467)]),console[_0x10ae08(0x9c1)]('无效链接:\x20'+_0x32f018[_0x10ae08(0x1467)]+'\x20-\x20'+_0x32f018[_0x10ae08(0x147d)]));});await Promise[_0xa0b75d(0xd49)](_0x2a8c54);const _0x141372=_0x3596d0-_0x226ba8[_0xa0b75d(0xaf9)];if(_0x141372>0x0){const _0x4e94eb=_0x49c6c5['playlist'][_0x49c6c5[_0xa0b75d(0x73a)]],_0x849a93=_0x28db60[_0xa0b75d(0x1336)](_0x4e94eb?.['name']);_0x49c6c5['playlist']=_0x226ba8,await _0x26f02f();if(_0x849a93)_0x204b9a['pause'](),_0x204b9a['src']='',_0x49c6c5[_0xa0b75d(0x73a)]=_0x49c6c5[_0xa0b75d(0x12c8)][_0xa0b75d(0xaf9)]>0x0?0x0:-0x1,_0x49c6c5['isPlaying']=![];else _0x4e94eb&&(_0x49c6c5[_0xa0b75d(0x73a)]=_0x49c6c5[_0xa0b75d(0x12c8)]['findIndex'](_0x4244bf=>_0x4244bf[_0xa0b75d(0x147d)]===_0x4e94eb[_0xa0b75d(0x147d)]));_0x39f26c(),_0x409bf9(),await _0x104485('清理完成','成功移除了\x20'+_0x141372+_0xa0b75d(0xd67)+_0x28db60['join'](_0xa0b75d(0x11ed)));}else await _0x104485(_0xa0b75d(0x4a2),_0xa0b75d(0x404));}function _0x162fdb(){const _0x201ab1=_0x3ce1fb,_0x1dbcb0=document['getElementById']('phone-screen');_0x1dbcb0['classList'][_0x201ab1(0x69d)](_0x201ab1(0x10a5),!!_0x16699d[_0x201ab1(0xf9c)][_0x201ab1(0xc75)]);}async function _0xec3e62(){const _0x1e7bd9=_0x3ce1fb,_0x265bf9=document[_0x1e7bd9(0x948)]('clear-posts-modal'),_0x4a6c3d=document['getElementById'](_0x1e7bd9(0xce3));_0x4a6c3d[_0x1e7bd9(0xb6f)]='';const _0x4c87b4=[];_0x4c87b4[_0x1e7bd9(0x1001)]({'text':_0x1e7bd9(0x7d8),'value':_0x1e7bd9(0xd49),'isDanger':!![]});const _0x2811bd=_0x16699d[_0x1e7bd9(0x66e)][_0x1e7bd9(0xf4d)]||'我';_0x4c87b4[_0x1e7bd9(0x1001)]({'text':'仅清空\x20'+_0x2811bd+_0x1e7bd9(0x7cc),'value':_0x1e7bd9(0xaeb)}),Object[_0x1e7bd9(0x1166)](_0x16699d[_0x1e7bd9(0x1474)])[_0x1e7bd9(0x427)](_0x47bc8d=>{const _0x5b5425=_0x1e7bd9;!_0x47bc8d[_0x5b5425(0x1173)]&&_0x4c87b4[_0x5b5425(0x1001)]({'text':'仅清空\x20'+_0x47bc8d['name']+_0x5b5425(0xf8f),'value':_0x47bc8d['id']});});try{const _0x30ccdc=await _0x6ed281['npcs'][_0x1e7bd9(0x443)]();_0x30ccdc[_0x1e7bd9(0xaf9)]>0x0&&(_0x4c87b4[_0x1e7bd9(0x1001)]({'isSeparator':!![],'text':_0x1e7bd9(0xe86)}),_0x30ccdc[_0x1e7bd9(0x427)](_0x131e9a=>{const _0x2ed9ee=_0x1e7bd9;_0x4c87b4['push']({'text':_0x2ed9ee(0xa8e)+_0x131e9a[_0x2ed9ee(0x1467)]+_0x2ed9ee(0x13ed),'value':'npc_'+_0x131e9a['id']});}));}catch(_0x1b92dc){console[_0x1e7bd9(0xc3e)](_0x1e7bd9(0x26a),_0x1b92dc);}_0x4c87b4[_0x1e7bd9(0x427)](_0x320629=>{const _0x18e84f=_0x1e7bd9;if(_0x320629[_0x18e84f(0x129e)]){const _0x5d9ee4=document[_0x18e84f(0x1497)](_0x18e84f(0x379));_0x5d9ee4['textContent']=_0x320629[_0x18e84f(0x9ea)],_0x5d9ee4[_0x18e84f(0xf74)][_0x18e84f(0x8e7)]=_0x18e84f(0x8c3),_0x4a6c3d[_0x18e84f(0x6b6)](_0x5d9ee4);return;}const _0x400382=document[_0x18e84f(0x1497)](_0x18e84f(0x379));_0x400382[_0x18e84f(0x35b)]='clear-posts-item',_0x320629[_0x18e84f(0xb42)]&&_0x400382[_0x18e84f(0xd54)][_0x18e84f(0xbd0)](_0x18e84f(0x124d)),_0x400382['dataset'][_0x18e84f(0x5c5)]=_0x320629[_0x18e84f(0x5bc)],_0x400382['innerHTML']=_0x18e84f(0x1343)+_0x320629['text']+_0x18e84f(0x10df),_0x4a6c3d[_0x18e84f(0x6b6)](_0x400382);}),_0x265bf9[_0x1e7bd9(0xd54)][_0x1e7bd9(0xbd0)](_0x1e7bd9(0xfcb));}async function _0x527a2e(){const _0x4b6e0a=_0x3ce1fb,_0x521ad2=document['querySelectorAll'](_0x4b6e0a(0xd07));if(_0x521ad2[_0x4b6e0a(0xaf9)]===0x0){alert(_0x4b6e0a(0x14c7));return;}const _0x3b36e1=Array[_0x4b6e0a(0x6e5)](_0x521ad2)[_0x4b6e0a(0x8ff)](_0x588dab=>_0x588dab[_0x4b6e0a(0x606)][_0x4b6e0a(0x5c5)]);let _0x8329ff=[];_0x3b36e1[_0x4b6e0a(0x1336)](_0x4b6e0a(0xd49))?_0x8329ff['push'](_0x4b6e0a(0x25e)):(_0x3b36e1[_0x4b6e0a(0x1336)](_0x4b6e0a(0xaeb))&&_0x8329ff[_0x4b6e0a(0x1001)]('“'+_0x16699d[_0x4b6e0a(0x66e)]['nickname']+'”'),_0x3b36e1[_0x4b6e0a(0x427)](_0xf419d8=>{const _0x3b0072=_0x4b6e0a,_0x3718b4=_0x16699d[_0x3b0072(0x1474)][_0xf419d8];_0x3718b4&&_0x8329ff[_0x3b0072(0x1001)]('“'+_0x3718b4[_0x3b0072(0x1467)]+'”');}));const _0x5ecc3b=_0x4b6e0a(0x12d0)+_0x8329ff[_0x4b6e0a(0x121a)]('、\x20')+_0x4b6e0a(0x8d0),_0x84edaa=await _0xa6b74a(_0x4b6e0a(0x11c2),_0x5ecc3b,{'confirmButtonClass':_0x4b6e0a(0x5e8),'confirmText':'确认清空'});if(!_0x84edaa)return;try{_0x3b36e1[_0x4b6e0a(0x1336)](_0x4b6e0a(0xd49))?await _0x6ed281[_0x4b6e0a(0xed1)][_0x4b6e0a(0x99d)]():await _0x6ed281[_0x4b6e0a(0xed1)][_0x4b6e0a(0x1117)](_0x4b6e0a(0x11b9))['anyOf'](_0x3b36e1)[_0x4b6e0a(0x869)](),_0x22676c=await _0x6ed281['qzonePosts'][_0x4b6e0a(0x1088)](_0x4b6e0a(0xb0a))['reverse']()['toArray'](),_0x410e8d=0x0,await _0x4d3afb(),document[_0x4b6e0a(0x948)](_0x4b6e0a(0x98f))[_0x4b6e0a(0xd54)][_0x4b6e0a(0xf89)](_0x4b6e0a(0xfcb)),await _0x104485(_0x4b6e0a(0xb80),'选定范围内的动态已被清空。');}catch(_0x312ea3){console[_0x4b6e0a(0xc3e)]('清空动态时出错:',_0x312ea3),await _0x104485(_0x4b6e0a(0xb6c),_0x4b6e0a(0x6aa)+_0x312ea3[_0x4b6e0a(0x74b)]);}}async function _0x398baf(_0x58b79a){const _0x4e9104=_0x3ce1fb,_0x33b108=await _0xa6b74a(_0x4e9104(0x8ed),'确定要永久删除这条心声记录吗？此操作不可恢复。',{'confirmButtonClass':'btn-danger','confirmText':_0x4e9104(0x8ed)});if(_0x33b108){const _0x1ae12f=_0x16699d['chats'][_0x16699d[_0x4e9104(0xf5a)]];if(!_0x1ae12f||!_0x1ae12f[_0x4e9104(0xd94)])return;const _0x138fa8=_0x1ae12f['thoughtsHistory']['findIndex'](_0x40eb58=>_0x40eb58[_0x4e9104(0xb0a)]===_0x58b79a);if(_0x138fa8===-0x1)return;const _0x5ab43c=_0x138fa8===_0x1ae12f['thoughtsHistory'][_0x4e9104(0xaf9)]-0x1;_0x1ae12f[_0x4e9104(0xd94)]=_0x1ae12f[_0x4e9104(0xd94)]['filter'](_0x584397=>_0x584397[_0x4e9104(0xb0a)]!==_0x58b79a);if(_0x5ab43c){if(_0x1ae12f[_0x4e9104(0xd94)]['length']>0x0){const _0x322098=_0x1ae12f[_0x4e9104(0xd94)][_0x1ae12f['thoughtsHistory'][_0x4e9104(0xaf9)]-0x1];_0x1ae12f[_0x4e9104(0x790)]=_0x322098['heartfeltVoice'],_0x1ae12f[_0x4e9104(0x6f1)]=_0x322098[_0x4e9104(0x6f1)];const _0x54a10c=document[_0x4e9104(0x948)](_0x4e9104(0x6dd)),_0x2ffaa1=document[_0x4e9104(0x948)](_0x4e9104(0x110f));if(_0x54a10c)_0x54a10c[_0x4e9104(0x10cb)]=_0x1ae12f[_0x4e9104(0x790)];if(_0x2ffaa1)_0x2ffaa1['textContent']=_0x1ae12f[_0x4e9104(0x6f1)];console[_0x4e9104(0x498)](_0x4e9104(0x90e));}else{_0x1ae12f[_0x4e9104(0x790)]='...',_0x1ae12f[_0x4e9104(0x6f1)]=_0x4e9104(0x76d);const _0x46ea4b=document[_0x4e9104(0x948)](_0x4e9104(0x6dd)),_0x554c97=document['getElementById'](_0x4e9104(0x110f));if(_0x46ea4b)_0x46ea4b[_0x4e9104(0x10cb)]=_0x1ae12f[_0x4e9104(0x790)];if(_0x554c97)_0x554c97[_0x4e9104(0x10cb)]=_0x1ae12f[_0x4e9104(0x6f1)];console[_0x4e9104(0x498)](_0x4e9104(0x693));}}await _0x6ed281['chats'][_0x4e9104(0x90c)](_0x1ae12f),_0x2e2c5b(),await _0x104485('成功',_0x4e9104(0x891));}}document[_0x3ce1fb(0x948)](_0x3ce1fb(0x11a0))[_0x3ce1fb(0x339)](_0x3ce1fb(0x4f6),_0x1f988d=>{const _0x4276b1=_0x3ce1fb,_0xeaf7a1=_0x1f988d[_0x4276b1(0xa50)][_0x4276b1(0x1090)](_0x4276b1(0xfa4));if(_0xeaf7a1){const _0x3ca905=parseInt(_0xeaf7a1[_0x4276b1(0x606)]['timestamp']);!isNaN(_0x3ca905)&&_0x398baf(_0x3ca905);}});async function _0x1b533a(){const _0x4da425=_0x3ce1fb,_0x3a637e=document[_0x4da425(0x948)]('css-preset-select');_0x3a637e[_0x4da425(0xb6f)]='<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>';const _0x3d4073=await _0x6ed281[_0x4da425(0x5bd)][_0x4da425(0x1117)]('type')[_0x4da425(0xba9)](_0x4da425(0x1167))[_0x4da425(0x443)]();_0x3d4073[_0x4da425(0x427)](_0x204943=>{const _0x57a6e9=_0x4da425,_0x54ccfd=document[_0x57a6e9(0x1497)]('option');_0x54ccfd['value']=_0x204943['id'],_0x54ccfd[_0x57a6e9(0x10cb)]=_0x204943[_0x57a6e9(0x1467)],_0x3a637e[_0x57a6e9(0x6b6)](_0x54ccfd);});}async function _0x235414(){const _0x5e2388=_0x3ce1fb,_0x4d4df3=document[_0x5e2388(0x948)](_0x5e2388(0x8ac)),_0x29779a=parseInt(_0x4d4df3[_0x5e2388(0x5bc)]);if(isNaN(_0x29779a))return;const _0xe2eab=await _0x6ed281[_0x5e2388(0x5bd)][_0x5e2388(0xe8c)](_0x29779a);if(_0xe2eab){const _0xa31fbf=document['getElementById']('global-css-input');_0xa31fbf[_0x5e2388(0x5bc)]=_0xe2eab[_0x5e2388(0x5bc)],_0x5e5902(_0xe2eab[_0x5e2388(0x5bc)]);}}async function _0x1d5043(){const _0x20cdc7=_0x3ce1fb,_0x232f82=await _0x41b9fc(_0x20cdc7(0x150a),_0x20cdc7(0x1228));if(!_0x232f82||!_0x232f82[_0x20cdc7(0x2a8)]())return;const _0x30ab5d=document['getElementById'](_0x20cdc7(0x72d))[_0x20cdc7(0x5bc)],_0x44f121=await _0x6ed281[_0x20cdc7(0x5bd)][_0x20cdc7(0x1117)]({'name':_0x232f82['trim'](),'type':_0x20cdc7(0x1167)})['first']();if(_0x44f121){const _0x5ef4e4=await _0xa6b74a(_0x20cdc7(0x2f4),_0x20cdc7(0xe06)+_0x232f82[_0x20cdc7(0x2a8)]()+_0x20cdc7(0x114a),{'confirmButtonClass':_0x20cdc7(0x5e8)});if(!_0x5ef4e4)return;await _0x6ed281[_0x20cdc7(0x5bd)][_0x20cdc7(0xa0b)](_0x44f121['id'],{'value':_0x30ab5d});}else await _0x6ed281[_0x20cdc7(0x5bd)][_0x20cdc7(0xbd0)]({'name':_0x232f82[_0x20cdc7(0x2a8)](),'type':_0x20cdc7(0x1167),'value':_0x30ab5d});await _0x1b533a(),alert(_0x20cdc7(0xd96));}async function _0x307ff6(){const _0x1aeef3=_0x3ce1fb,_0x10e247=document[_0x1aeef3(0x948)]('css-preset-select'),_0x24c49c=parseInt(_0x10e247['value']);if(isNaN(_0x24c49c)){alert('请先从下拉框中选择一个要删除的预设。');return;}const _0x58cea1=await _0x6ed281[_0x1aeef3(0x5bd)][_0x1aeef3(0xe8c)](_0x24c49c);if(!_0x58cea1)return;const _0x181358=await _0xa6b74a(_0x1aeef3(0xbc2),'确定要删除预设\x20“'+_0x58cea1[_0x1aeef3(0x1467)]+_0x1aeef3(0x2dd),{'confirmButtonClass':_0x1aeef3(0x5e8)});_0x181358&&(await _0x6ed281[_0x1aeef3(0x5bd)][_0x1aeef3(0x869)](_0x24c49c),await _0x1b533a(),alert('预设已删除。'));}async function _0x56bae4(){const _0x1647ed=_0x3ce1fb,_0x150c78=document['getElementById']('font-preset-select');_0x150c78['innerHTML']='<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>';const _0x2cb819=await _0x6ed281[_0x1647ed(0x5bd)][_0x1647ed(0x1117)](_0x1647ed(0x4ae))[_0x1647ed(0xba9)](_0x1647ed(0x6a8))[_0x1647ed(0x443)]();_0x2cb819[_0x1647ed(0x427)](_0x18c5eb=>{const _0x26e6d6=_0x1647ed,_0x4b3f4e=document[_0x26e6d6(0x1497)](_0x26e6d6(0x152c));_0x4b3f4e[_0x26e6d6(0x5bc)]=_0x18c5eb['id'],_0x4b3f4e[_0x26e6d6(0x10cb)]=_0x18c5eb[_0x26e6d6(0x1467)],_0x150c78['appendChild'](_0x4b3f4e);});}async function _0x22f3c5(){const _0x2f25ef=_0x3ce1fb,_0x255943=document[_0x2f25ef(0x948)](_0x2f25ef(0x5c8)),_0x55a993=parseInt(_0x255943[_0x2f25ef(0x5bc)]);if(isNaN(_0x55a993))return;const _0x4748fe=await _0x6ed281[_0x2f25ef(0x5bd)][_0x2f25ef(0xe8c)](_0x55a993);if(_0x4748fe){const _0x225b39=document[_0x2f25ef(0x948)](_0x2f25ef(0x1024));_0x225b39[_0x2f25ef(0x5bc)]=_0x4748fe[_0x2f25ef(0x5bc)],_0x495393(_0x4748fe[_0x2f25ef(0x5bc)],!![]);}}async function _0x5da256(){const _0x55677e=_0x3ce1fb,_0x243862=await _0x41b9fc('保存字体预设','请输入预设名称');if(!_0x243862||!_0x243862[_0x55677e(0x2a8)]())return;const _0x2f7389=document[_0x55677e(0x948)]('font-url-input')['value'][_0x55677e(0x2a8)]();if(!_0x2f7389){alert(_0x55677e(0xa75));return;}const _0x380c47=await _0x6ed281[_0x55677e(0x5bd)][_0x55677e(0x1117)]({'name':_0x243862['trim'](),'type':'font'})[_0x55677e(0x678)]();if(_0x380c47){const _0x532663=await _0xa6b74a(_0x55677e(0x2f4),'名为\x20“'+_0x243862[_0x55677e(0x2a8)]()+_0x55677e(0x114a),{'confirmButtonClass':_0x55677e(0x5e8)});if(!_0x532663)return;await _0x6ed281[_0x55677e(0x5bd)][_0x55677e(0xa0b)](_0x380c47['id'],{'value':_0x2f7389});}else await _0x6ed281[_0x55677e(0x5bd)]['add']({'name':_0x243862[_0x55677e(0x2a8)](),'type':_0x55677e(0x6a8),'value':_0x2f7389});await _0x56bae4(),alert(_0x55677e(0xfbb));}async function _0x4e47d7(){const _0x1d0d2f=_0x3ce1fb,_0x24e0b1=document[_0x1d0d2f(0x948)](_0x1d0d2f(0x5c8)),_0x19f0c3=parseInt(_0x24e0b1[_0x1d0d2f(0x5bc)]);if(isNaN(_0x19f0c3)){alert(_0x1d0d2f(0xfb6));return;}const _0x4a10f1=await _0x6ed281[_0x1d0d2f(0x5bd)][_0x1d0d2f(0xe8c)](_0x19f0c3);if(!_0x4a10f1)return;const _0x140a7b=await _0xa6b74a(_0x1d0d2f(0xbc2),'确定要删除预设\x20“'+_0x4a10f1['name']+_0x1d0d2f(0x2dd),{'confirmButtonClass':_0x1d0d2f(0x5e8)});_0x140a7b&&(await _0x6ed281[_0x1d0d2f(0x5bd)]['delete'](_0x19f0c3),await _0x56bae4(),alert(_0x1d0d2f(0x14e1)));}async function _0x336cd2(){const _0x4c7d74=_0x3ce1fb,_0x225021=document[_0x4c7d74(0x948)](_0x4c7d74(0x1458));_0x225021['innerHTML']=_0x4c7d74(0xade);const _0x1a42d8=await _0x6ed281['appearancePresets']['where']('type')[_0x4c7d74(0xba9)](_0x4c7d74(0xa91))[_0x4c7d74(0x443)]();_0x1a42d8['forEach'](_0x291322=>{const _0xfda68b=_0x4c7d74,_0x3a1206=document['createElement']('option');_0x3a1206['value']=_0x291322['id'],_0x3a1206[_0xfda68b(0x10cb)]=_0x291322['name'],_0x225021[_0xfda68b(0x6b6)](_0x3a1206);});const _0x4dbdb9={'wallpaper':_0x16699d['globalSettings'][_0x4c7d74(0xb91)],'cphoneWallpaper':_0x16699d[_0x4c7d74(0xf9c)]['cphoneWallpaper'],'globalChatBackground':_0x16699d[_0x4c7d74(0xf9c)][_0x4c7d74(0xa76)],'appIcons':_0x16699d[_0x4c7d74(0xf9c)][_0x4c7d74(0x1471)],'cphoneAppIcons':_0x16699d['globalSettings'][_0x4c7d74(0xac6)],'chatActionButtonsOrder':_0x16699d[_0x4c7d74(0xf9c)][_0x4c7d74(0x88c)],'theme':localStorage[_0x4c7d74(0x55f)](_0x4c7d74(0x1304))||_0x4c7d74(0x1104),'showStatusBar':_0x16699d[_0x4c7d74(0xf9c)][_0x4c7d74(0xc75)],'notificationSoundUrl':_0x16699d['globalSettings'][_0x4c7d74(0x803)],'widgetData':_0x16699d['globalSettings']['widgetData']};let _0x3faa0f=null;for(const _0x3f5622 of _0x1a42d8){if(JSON[_0x4c7d74(0x526)](_0x3f5622[_0x4c7d74(0x5bc)])===JSON[_0x4c7d74(0x526)](_0x4dbdb9)){_0x3faa0f=_0x3f5622['id'];break;}}_0x3faa0f?_0x225021[_0x4c7d74(0x5bc)]=_0x3faa0f:_0x225021[_0x4c7d74(0x5bc)]='';}async function _0x52f19c(){const _0x50e1fe=_0x3ce1fb,_0x44a262=document[_0x50e1fe(0x948)](_0x50e1fe(0x1458)),_0xe06d9b=parseInt(_0x44a262[_0x50e1fe(0x5bc)]);if(isNaN(_0xe06d9b))return;const _0x1ff665=await _0x6ed281[_0x50e1fe(0x5bd)][_0x50e1fe(0xe8c)](_0xe06d9b);if(_0x1ff665&&_0x1ff665[_0x50e1fe(0x5bc)]){const _0x34da99=_0x1ff665[_0x50e1fe(0x5bc)];Object[_0x50e1fe(0xd24)](_0x16699d[_0x50e1fe(0xf9c)],_0x34da99),_0x5afcab(_0x34da99[_0x50e1fe(0x337)]||'light'),await _0x6ed281['globalSettings'][_0x50e1fe(0x90c)](_0x16699d['globalSettings']),_0x364bb1(),_0x471b5b(),_0x1c8fc4(),_0x25c96f(),_0x162fdb(),_0x442c65(),_0xf9cd0e(),alert('已成功加载外观预设：“'+_0x1ff665[_0x50e1fe(0x1467)]+'”');}}async function _0x5d47a0(){const _0x526dd7=_0x3ce1fb,_0x1c9771=await _0x41b9fc(_0x526dd7(0x3cb),'请输入预设名称');if(!_0x1c9771||!_0x1c9771[_0x526dd7(0x2a8)]())return;const _0x430f2b={'wallpaper':_0x16699d[_0x526dd7(0xf9c)][_0x526dd7(0xb91)],'cphoneWallpaper':_0x16699d[_0x526dd7(0xf9c)]['cphoneWallpaper'],'globalChatBackground':_0x16699d['globalSettings']['globalChatBackground'],'appIcons':_0x16699d[_0x526dd7(0xf9c)][_0x526dd7(0x1471)],'cphoneAppIcons':_0x16699d[_0x526dd7(0xf9c)][_0x526dd7(0xac6)],'chatActionButtonsOrder':_0x16699d[_0x526dd7(0xf9c)][_0x526dd7(0x88c)],'theme':localStorage[_0x526dd7(0x55f)](_0x526dd7(0x1304))||_0x526dd7(0x1104),'showStatusBar':_0x16699d['globalSettings']['showStatusBar'],'notificationSoundUrl':_0x16699d[_0x526dd7(0xf9c)]['notificationSoundUrl'],'widgetData':_0x16699d[_0x526dd7(0xf9c)]['widgetData']},_0x505ca5=await _0x6ed281[_0x526dd7(0x5bd)]['where']({'name':_0x1c9771['trim'](),'type':_0x526dd7(0xa91)})[_0x526dd7(0x678)]();if(_0x505ca5){const _0x26968e=await _0xa6b74a('覆盖预设',_0x526dd7(0xe06)+_0x1c9771['trim']()+_0x526dd7(0x114a),{'confirmButtonClass':'btn-danger'});if(!_0x26968e)return;await _0x6ed281['appearancePresets'][_0x526dd7(0xa0b)](_0x505ca5['id'],{'value':_0x430f2b});}else await _0x6ed281[_0x526dd7(0x5bd)]['add']({'name':_0x1c9771[_0x526dd7(0x2a8)](),'type':'appearance','value':_0x430f2b});await _0x336cd2(),alert('外观预设已保存！');}async function _0x3845d2(){const _0x54676e=_0x3ce1fb,_0x151b56=document[_0x54676e(0x948)]('appearance-preset-select'),_0x4a78c4=parseInt(_0x151b56[_0x54676e(0x5bc)]);if(isNaN(_0x4a78c4)){alert(_0x54676e(0xfb6));return;}const _0x58b55f=await _0x6ed281[_0x54676e(0x5bd)][_0x54676e(0xe8c)](_0x4a78c4);if(!_0x58b55f)return;const _0x58d399=await _0xa6b74a('删除预设',_0x54676e(0xbcd)+_0x58b55f[_0x54676e(0x1467)]+_0x54676e(0x2dd),{'confirmButtonClass':_0x54676e(0x5e8)});_0x58d399&&(await _0x6ed281[_0x54676e(0x5bd)][_0x54676e(0x869)](_0x4a78c4),await _0x336cd2(),alert(_0x54676e(0x14e1)));}async function _0x2f5477(){const _0x1d4804=_0x3ce1fb,_0x43360d=document[_0x1d4804(0x948)]('theme-preset-select');_0x43360d[_0x1d4804(0xb6f)]=_0x1d4804(0xade);const _0x502489=await _0x6ed281[_0x1d4804(0x5bd)][_0x1d4804(0x1117)](_0x1d4804(0x4ae))[_0x1d4804(0xba9)](_0x1d4804(0xff9))[_0x1d4804(0x443)]();_0x502489['forEach'](_0x4015e6=>{const _0x15aa4a=_0x1d4804,_0x21fcc5=document[_0x15aa4a(0x1497)](_0x15aa4a(0x152c));_0x21fcc5[_0x15aa4a(0x5bc)]=_0x4015e6['id'],_0x21fcc5[_0x15aa4a(0x10cb)]=_0x4015e6[_0x15aa4a(0x1467)],_0x43360d[_0x15aa4a(0x6b6)](_0x21fcc5);});}async function _0xf3720a(){const _0x4fb105=_0x3ce1fb,_0x599e58=document[_0x4fb105(0x948)](_0x4fb105(0x28b)),_0x5bc084=parseInt(_0x599e58['value']);if(isNaN(_0x5bc084))return;const _0x14fa4f=await _0x6ed281['appearancePresets']['get'](_0x5bc084);if(_0x14fa4f){const _0x3ef198=_0x14fa4f['value'][_0x4fb105(0xf0b)]||'default',_0x4527da=_0x14fa4f[_0x4fb105(0x5bc)]['custom']||'',_0x48e00a=document[_0x4fb105(0xfeb)](_0x4fb105(0xc77)+_0x3ef198+'\x22]');_0x48e00a&&(_0x48e00a[_0x4fb105(0x210)]=!![]);const _0xef64e2=document[_0x4fb105(0x948)]('custom-css-input');_0xef64e2['value']=_0x4527da,_0x3cc02f();}}async function _0x8e630(){const _0x29ae81=_0x3ce1fb,_0x5d5d9a=await _0x41b9fc(_0x29ae81(0x5a3),_0x29ae81(0x1228));if(!_0x5d5d9a||!_0x5d5d9a['trim']())return;const _0x3ca96d=document['querySelector'](_0x29ae81(0xeb5)),_0x3cd068=_0x3ca96d?_0x3ca96d[_0x29ae81(0x5bc)]:_0x29ae81(0xe46),_0x14a40c=document[_0x29ae81(0x948)]('custom-css-input')[_0x29ae81(0x5bc)][_0x29ae81(0x2a8)](),_0x111445={'base':_0x3cd068,'custom':_0x14a40c},_0x229a9c=await _0x6ed281[_0x29ae81(0x5bd)][_0x29ae81(0x1117)]({'name':_0x5d5d9a[_0x29ae81(0x2a8)](),'type':_0x29ae81(0xff9)})[_0x29ae81(0x678)]();if(_0x229a9c){const _0x2333de=await _0xa6b74a('覆盖预设',_0x29ae81(0xe06)+_0x5d5d9a[_0x29ae81(0x2a8)]()+'”\x20的预设已存在。要覆盖它吗？',{'confirmButtonClass':'btn-danger'});if(!_0x2333de)return;await _0x6ed281[_0x29ae81(0x5bd)]['update'](_0x229a9c['id'],{'value':_0x111445});}else await _0x6ed281[_0x29ae81(0x5bd)][_0x29ae81(0xbd0)]({'name':_0x5d5d9a[_0x29ae81(0x2a8)](),'type':_0x29ae81(0xff9),'value':_0x111445});await _0x2f5477(),alert('主题预设已保存！');}async function _0xade358(){const _0x1a06a6=_0x3ce1fb,_0x20a04a=document[_0x1a06a6(0x948)](_0x1a06a6(0x28b)),_0x519ee2=parseInt(_0x20a04a[_0x1a06a6(0x5bc)]);if(isNaN(_0x519ee2)){alert(_0x1a06a6(0xfb6));return;}const _0x1ce935=await _0x6ed281[_0x1a06a6(0x5bd)][_0x1a06a6(0xe8c)](_0x519ee2);if(!_0x1ce935)return;const _0x4f704d=await _0xa6b74a(_0x1a06a6(0xbc2),'确定要删除预设\x20“'+_0x1ce935[_0x1a06a6(0x1467)]+_0x1a06a6(0x2dd),{'confirmButtonClass':_0x1a06a6(0x5e8)});_0x4f704d&&(await _0x6ed281['appearancePresets'][_0x1a06a6(0x869)](_0x519ee2),await _0x2f5477(),alert(_0x1a06a6(0x14e1)));}async function _0x33f7fd(){const _0x45c73a=_0x3ce1fb;await _0x713128(),document['getElementById']('sticker-category-manager-modal')['classList'][_0x45c73a(0xbd0)](_0x45c73a(0xfcb));}async function _0x713128(){const _0x5bf123=_0x3ce1fb,_0x3c7088=document[_0x5bf123(0x948)]('existing-sticker-categories-list'),_0x1f4827=await _0x6ed281[_0x5bf123(0x19c)]['toArray']();_0x3c7088['innerHTML']='';if(_0x1f4827[_0x5bf123(0xaf9)]===0x0){_0x3c7088[_0x5bf123(0xb6f)]=_0x5bf123(0x67f);return;}_0x1f4827[_0x5bf123(0x427)](_0x5cd343=>{const _0x4d50d4=_0x5bf123,_0x5d7dc0=document[_0x4d50d4(0x1497)](_0x4d50d4(0x379));_0x5d7dc0[_0x4d50d4(0x35b)]=_0x4d50d4(0x1271),_0x5d7dc0[_0x4d50d4(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x5cd343[_0x4d50d4(0x1467)]+_0x4d50d4(0x154c)+_0x5cd343['id']+_0x4d50d4(0x307),_0x3c7088['appendChild'](_0x5d7dc0);});}async function _0x3cc0d7(){const _0x50c658=_0x3ce1fb,_0x49f92f=document[_0x50c658(0x948)](_0x50c658(0x12c9)),_0x265cc5=_0x49f92f[_0x50c658(0x5bc)][_0x50c658(0x2a8)]();if(!_0x265cc5){alert(_0x50c658(0x12bd));return;}const _0x25d354=await _0x6ed281[_0x50c658(0x19c)][_0x50c658(0x1117)](_0x50c658(0x1467))[_0x50c658(0xba9)](_0x265cc5)[_0x50c658(0x678)]();if(_0x25d354){alert(_0x50c658(0xc04)+_0x265cc5+'\x22\x20已经存在了！');return;}await _0x6ed281['stickerCategories'][_0x50c658(0xbd0)]({'name':_0x265cc5}),_0x49f92f[_0x50c658(0x5bc)]='',await _0x713128();}async function _0x321d5c(_0x215b55){const _0xcf0d56=_0x3ce1fb,_0x36d158=await _0x6ed281[_0xcf0d56(0x19c)][_0xcf0d56(0xe8c)](_0x215b55);if(!_0x36d158)return;const _0x51f0df=await _0x6ed281[_0xcf0d56(0x14a2)][_0xcf0d56(0x1117)](_0xcf0d56(0xd86))[_0xcf0d56(0xba9)](_0x215b55)[_0xcf0d56(0x12db)](),_0x3cc2f2=_0x51f0df>0x0?'确定要删除分类《'+_0x36d158[_0xcf0d56(0x1467)]+_0xcf0d56(0x1410)+_0x51f0df+_0xcf0d56(0xbaa):_0xcf0d56(0x10be)+_0x36d158[_0xcf0d56(0x1467)]+_0xcf0d56(0xbda),_0x2e94da=await _0xa6b74a('确认删除分类',_0x3cc2f2,{'confirmButtonClass':_0xcf0d56(0x5e8)});if(_0x2e94da)try{await _0x6ed281[_0xcf0d56(0x670)]('rw',_0x6ed281['stickerCategories'],_0x6ed281[_0xcf0d56(0x14a2)],async()=>{const _0x324592=_0xcf0d56,_0x38176c=await _0x6ed281[_0x324592(0x14a2)][_0x324592(0x1117)]('categoryId')['equals'](_0x215b55)[_0x324592(0xf73)]();_0x38176c[_0x324592(0xaf9)]>0x0&&await _0x6ed281[_0x324592(0x14a2)][_0x324592(0xd5d)](_0x38176c),await _0x6ed281['stickerCategories'][_0x324592(0x869)](_0x215b55);}),_0x16699d[_0xcf0d56(0x14a2)]=await _0x6ed281[_0xcf0d56(0x14a2)][_0xcf0d56(0x443)](),_0xf2c276===_0x215b55&&(_0xf2c276=_0xcf0d56(0xd49)),await _0x713128(),await _0x4f21d0(),alert(_0xcf0d56(0x9e1)+_0x36d158['name']+'》及其下的表情已成功删除。');}catch(_0x3a53f2){console['error'](_0xcf0d56(0xb9f),_0x3a53f2),alert(_0xcf0d56(0xe66));}}function _0x1529fd(_0x2e093b){const _0x2386cb=_0x3ce1fb;_0xf2c276=_0x2e093b,document[_0x2386cb(0x1188)](_0x2386cb(0xff7))['forEach'](_0xef65a7=>{const _0x5a48d9=_0x2386cb;_0xef65a7[_0x5a48d9(0xd54)]['toggle']('active',String(_0xef65a7['dataset'][_0x5a48d9(0xd86)])===String(_0x2e093b));}),_0x4f21d0(![]);const _0x4cf452=document[_0x2386cb(0x948)]('select-all-stickers-checkbox');if(_0x4cf452)_0x4cf452[_0x2386cb(0x210)]=![];}async function _0x44a219(){const _0x325a0d=_0x3ce1fb;if(!_0x16699d['activeChatId'])return;const _0x379022=_0x16699d[_0x325a0d(0x1474)][_0x16699d[_0x325a0d(0xf5a)]];if(!_0x379022)return;try{const _0x4784f7={'type':_0x325a0d(0xdc4),'version':0x1,'chatData':_0x379022},_0x2161e0=new Blob([JSON[_0x325a0d(0x526)](_0x4784f7,null,0x2)],{'type':_0x325a0d(0x479)}),_0x29282d=URL[_0x325a0d(0x91d)](_0x2161e0),_0x320298=document['createElement']('a');_0x320298['href']=_0x29282d,_0x320298[_0x325a0d(0xf4c)]=_0x325a0d(0x15c5)+_0x379022[_0x325a0d(0x1467)]+'-'+new Date()['toISOString']()[_0x325a0d(0x46f)]('T')[0x0]+'.json',_0x320298['click'](),URL[_0x325a0d(0x11e1)](_0x29282d),await _0x104485(_0x325a0d(0x383),'与“'+_0x379022[_0x325a0d(0x1467)]+_0x325a0d(0x61c));}catch(_0x501f7f){console[_0x325a0d(0xc3e)]('导出单个聊天时出错:',_0x501f7f),await _0x104485(_0x325a0d(0x10d5),_0x325a0d(0x1345)+_0x501f7f[_0x325a0d(0x74b)]);}}async function _0x3037bb(_0x428dcf){const _0x3bc002=_0x3ce1fb;if(!_0x428dcf||!_0x16699d[_0x3bc002(0xf5a)])return;const _0x105d1f=_0x16699d[_0x3bc002(0xf5a)],_0x17bc77=_0x16699d['chats'][_0x105d1f];try{const _0x1545e3=await _0x428dcf[_0x3bc002(0x9ea)](),_0x5e465d=JSON['parse'](_0x1545e3);if(_0x5e465d['type']!=='EPhoneSingleChat'||!_0x5e465d[_0x3bc002(0xe3b)])throw new Error('文件格式不正确，这不是一个有效的单聊备份文件。');const _0x1d320b=await _0xa6b74a(_0x3bc002(0x569),_0x3bc002(0xdb8)+_0x17bc77[_0x3bc002(0x1467)]+'”的聊天记录和设置。此操作不可撤销！<br><br><strong>确定要继续吗？</strong>',{'confirmButtonClass':_0x3bc002(0x5e8),'confirmText':_0x3bc002(0x37f)});if(!_0x1d320b)return;const _0x33691e=_0x5e465d[_0x3bc002(0xe3b)];_0x33691e['id']=_0x105d1f,await _0x6ed281[_0x3bc002(0x1474)][_0x3bc002(0x90c)](_0x33691e),_0x16699d[_0x3bc002(0x1474)][_0x105d1f]=_0x33691e,await _0x104485('导入成功',_0x3bc002(0xaa7)),_0x455873(_0x105d1f),_0x2d33eb(),document[_0x3bc002(0x948)](_0x3bc002(0x7b8))[_0x3bc002(0x4f6)]();}catch(_0x1ccdb9){console[_0x3bc002(0xc3e)](_0x3bc002(0x825),_0x1ccdb9),await _0x104485('导入失败',_0x3bc002(0xc4c)+_0x1ccdb9[_0x3bc002(0x74b)]);}}function _0x1b1457(){const _0x2fe1b3=_0x3ce1fb;_0x204a58(),_0x58c3b1(_0x2fe1b3(0x14e4));}function _0x204a58(){const _0x331d89=_0x3ce1fb,_0x19f548=document[_0x331d89(0x948)]('character-grid');_0x19f548[_0x331d89(0xb6f)]='';const _0x359187=Object[_0x331d89(0x1166)](_0x16699d[_0x331d89(0x1474)])['filter'](_0x3110a8=>!_0x3110a8[_0x331d89(0x1173)]);if(_0x359187['length']===0x0){_0x19f548[_0x331d89(0xb6f)]=_0x331d89(0xd40);return;}_0x359187[_0x331d89(0x427)](_0x10ba07=>{const _0x5254fd=_0x331d89,_0x380a22=document[_0x5254fd(0x1497)]('div');_0x380a22['className']=_0x5254fd(0xb56),_0x380a22[_0x5254fd(0xb6f)]=_0x5254fd(0xa21)+(_0x10ba07[_0x5254fd(0x7fd)]['aiAvatar']||_0x202ba5)+_0x5254fd(0x1239)+_0x10ba07['name']+_0x5254fd(0x10df),_0x380a22[_0x5254fd(0x339)]('click',()=>_0x4060dc(_0x10ba07['id'])),_0x19f548[_0x5254fd(0x6b6)](_0x380a22);});}async function _0x4060dc(_0xe050cf){const _0x52456c=_0x3ce1fb;_0x36911a=_0xe050cf,console[_0x52456c(0x498)]('已切换到角色\x20'+_0xe050cf+_0x52456c(0x680)),_0x471b5b(),_0x25c96f(),_0x40c7f2(),_0x58c3b1(_0x52456c(0x100f));}function _0x113b34(){const _0x1ca8ba=_0x3ce1fb;_0x36911a=null,console[_0x1ca8ba(0x498)](_0x1ca8ba(0x1155)),_0x58c3b1(_0x1ca8ba(0x110d));}function _0x40c7f2(){const _0x5849b2=_0x3ce1fb,_0x4e8d79=new Date(),_0x20e007=_0x4e8d79['toLocaleTimeString']('zh-CN',{'hour':_0x5849b2(0x13d0),'minute':_0x5849b2(0x13d0)}),_0x49e3d8=_0x4e8d79['toLocaleDateString'](_0x5849b2(0x144f),{'weekday':'long','month':_0x5849b2(0x97c),'day':'numeric'});document[_0x5849b2(0x948)](_0x5849b2(0x925))['textContent']=_0x20e007,document[_0x5849b2(0x948)](_0x5849b2(0x924))[_0x5849b2(0x10cb)]=_0x49e3d8,_0x13f7b4(_0x5849b2(0xb2a));}function _0x13f7b4(_0x1b89c5){const _0x25183e=_0x3ce1fb;document[_0x25183e(0x1188)](_0x25183e(0xbfd))['forEach'](_0x17e830=>_0x17e830['classList'][_0x25183e(0xf89)](_0x25183e(0x115e))),document[_0x25183e(0x948)](_0x1b89c5)[_0x25183e(0xd54)]['add'](_0x25183e(0x115e));}window['switchToCharScreen']=_0x13f7b4;async function _0x3280d9(_0x2fded7){const _0x34326d=_0x3ce1fb;if(!_0x36911a)return;const _0x266fdb=_0x16699d['chats'][_0x36911a];await _0x501d30(_0x36911a,_0x2fded7);switch(_0x2fded7){case'qq':_0x1dd517(),_0x13f7b4(_0x34326d(0x6b1));break;case _0x34326d(0xe70):_0xde9310(),_0x13f7b4(_0x34326d(0xb41));break;case _0x34326d(0x521):_0x39aaa3(),_0x13f7b4('char-browser-screen');break;case'taobao':_0x1d076f(),_0x13f7b4(_0x34326d(0x117a));break;case _0x34326d(0x994):_0x140dc7(),_0x13f7b4(_0x34326d(0x9ec));break;case _0x34326d(0x412):_0x4457e5(),_0x13f7b4(_0x34326d(0x963));break;case _0x34326d(0x4a0):_0x4e898b(),_0x13f7b4(_0x34326d(0xdf3));break;case _0x34326d(0x762):_0x3d20e6(),_0x13f7b4(_0x34326d(0x4cf));break;case _0x34326d(0xfc8):_0x7e279(),_0x13f7b4(_0x34326d(0x801));break;}}async function _0xde9310(){const _0xbad0f=_0x3ce1fb,_0x4e993d=document[_0xbad0f(0x948)](_0xbad0f(0xe7d));_0x4e993d[_0xbad0f(0xb6f)]='';if(!_0x36911a)return;const _0x3f9815=_0x16699d[_0xbad0f(0x1474)][_0x36911a],_0x4a2940=_0x3f9815[_0xbad0f(0x3ab)]||[];if(_0x4a2940[_0xbad0f(0xaf9)]===0x0){_0x4e993d[_0xbad0f(0xb6f)]=_0xbad0f(0xc08);return;}const _0x5bbec6=_0xbad0f(0x156f);_0x4a2940[_0xbad0f(0x427)](_0x59bc26=>{const _0x209b7f=_0xbad0f,_0x32c48f=document['createElement'](_0x209b7f(0x379));_0x32c48f[_0x209b7f(0x35b)]=_0x209b7f(0x132f),_0x32c48f[_0x209b7f(0x606)][_0x209b7f(0xe79)]=_0x59bc26[_0x209b7f(0xe79)],_0x4e993d[_0x209b7f(0x6b6)](_0x32c48f);if(_0x16699d[_0x209b7f(0xf9c)][_0x209b7f(0xf46)]){_0x32c48f[_0x209b7f(0xf74)][_0x209b7f(0xdb4)]='#e9ecef';const _0x4d0321=/[^\x00-\x7F]/[_0x209b7f(0x367)](_0x59bc26[_0x209b7f(0x5d9)]),_0x1ff88a=_0x59bc26['image_prompt']&&_0x59bc26[_0x209b7f(0x5d9)][_0x209b7f(0x2a8)]()&&!_0x4d0321,_0x28757d=_0x1ff88a?_0x59bc26[_0x209b7f(0x5d9)]:_0x209b7f(0x3fc),_0x14be8d='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x28757d),_0x46ba13=new Image();_0x46ba13[_0x209b7f(0x33a)]=function(){const _0x2a11bd=_0x209b7f;_0x32c48f[_0x2a11bd(0xf74)][_0x2a11bd(0x618)]=_0x2a11bd(0x4f1)+this[_0x2a11bd(0x147d)]+')';},_0x46ba13[_0x209b7f(0x12eb)]=function(){const _0x574dc5=_0x209b7f;_0x32c48f[_0x574dc5(0xf74)][_0x574dc5(0x618)]='url('+_0x5bbec6+')';},_0x46ba13['src']=_0x14be8d;}else{_0x32c48f[_0x209b7f(0xf74)][_0x209b7f(0xdb4)]=_0x209b7f(0xe1a),_0x32c48f[_0x209b7f(0xf74)][_0x209b7f(0x14a5)]='1px\x20solid\x20#e0e0e0';const _0x452c5f=document['createElement']('p');_0x452c5f[_0x209b7f(0x35b)]=_0x209b7f(0x126e),_0x452c5f[_0x209b7f(0x10cb)]=_0x59bc26[_0x209b7f(0xe79)]||'(这张照片没有描述)',_0x32c48f[_0x209b7f(0x6b6)](_0x452c5f);}});}function _0x39aaa3(){const _0x2b60bf=_0x3ce1fb,_0x212c1f=document['getElementById']('char-browser-history');_0x212c1f[_0x2b60bf(0xb6f)]='';if(!_0x36911a)return;const _0x4015f9=_0x16699d[_0x2b60bf(0x1474)][_0x36911a],_0x41220a=[_0x4015f9[_0x2b60bf(0x1467)],'爱好','旅游','美食','新闻',..._0x4015f9[_0x2b60bf(0x7fd)][_0x2b60bf(0x14c1)]['split'](/，|。|\s/)['slice'](0x0,0x5)],_0x1fe3c7=['知乎',_0x2b60bf(0x1152),_0x2b60bf(0x238),'微博',_0x2b60bf(0x320)];for(let _0x55653e=0x0;_0x55653e<0xf;_0x55653e++){const _0x49dd82=_0x41220a[Math['floor'](Math[_0x2b60bf(0x59c)]()*_0x41220a[_0x2b60bf(0xaf9)])],_0x1eda02=_0x1fe3c7[Math[_0x2b60bf(0x15b6)](Math[_0x2b60bf(0x59c)]()*_0x1fe3c7['length'])],_0x548d28=document[_0x2b60bf(0x1497)]('div');_0x548d28[_0x2b60bf(0x35b)]=_0x2b60bf(0xe24),_0x548d28[_0x2b60bf(0xb6f)]=_0x2b60bf(0x10d1)+_0x49dd82+'\x20-\x20'+_0x1eda02+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>www.'+_0x1eda02['toLowerCase']()+_0x2b60bf(0x4dd)+_0x49dd82+_0x2b60bf(0x13aa),_0x212c1f[_0x2b60bf(0x6b6)](_0x548d28);}}function _0x1d076f(){const _0x56504f=_0x3ce1fb,_0x4262a4=document[_0x56504f(0x948)]('char-product-grid');_0x4262a4['innerHTML']='';if(!_0x36911a)return;const _0x47d6a8=_0x16699d[_0x56504f(0x1474)][_0x36911a],_0x2faf64=_0x47d6a8[_0x56504f(0xce5)]?.[_0x56504f(0xe65)]||[];if(_0x2faf64['length']===0x0){_0x4262a4[_0x56504f(0xb6f)]=_0x56504f(0x1491);return;}_0x2faf64[_0x56504f(0x427)](_0x4e4779=>{const _0x536505=_0x56504f,_0x1f43d7=document[_0x536505(0x1497)](_0x536505(0x379));_0x1f43d7[_0x536505(0x35b)]=_0x536505(0xc31),_0x1f43d7[_0x536505(0x606)][_0x536505(0xb5e)]=_0x4e4779[_0x536505(0xb5e)];let _0x5279c9;if(_0x16699d['globalSettings'][_0x536505(0xf46)]){const _0x2f1cc7='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x4e4779[_0x536505(0x5d9)]||_0x536505(0xb32));_0x5279c9=_0x536505(0x4ad)+_0x2f1cc7+_0x536505(0x1154);}else _0x5279c9=_0x536505(0x558)+(_0x4e4779[_0x536505(0xb5e)]||_0x536505(0xb66))+_0x536505(0xefc);_0x1f43d7[_0x536505(0xb6f)]=_0x536505(0xcfa)+_0x5279c9+_0x536505(0x1464)+_0x4e4779[_0x536505(0x77f)]+_0x536505(0x1019)+(_0x4e4779[_0x536505(0xa6a)]||0x0)[_0x536505(0xd69)](0x2)+_0x536505(0x2d1)+_0x4e4779[_0x536505(0x82c)]+_0x536505(0x153c),_0x4262a4[_0x536505(0x6b6)](_0x1f43d7);});}function _0x3ebb67(){const _0x30efa8=_0x3ce1fb;_0x13f7b4(_0x30efa8(0xb2a));}function _0x8a3c58(){const _0x419ab0=_0x3ce1fb,_0x1b386e=document[_0x419ab0(0x948)](_0x419ab0(0x4a9));_0x1b386e[_0x419ab0(0xb6f)]='';if(!_0x36911a)return;const _0x5b67be=Object['values'](_0x16699d['chats'])[_0x419ab0(0x1c0)](_0x5caf28=>{const _0x13f5ee=_0x419ab0;if(_0x5caf28['id']===_0x36911a)return!![];if(_0x5caf28['isGroup']&&_0x5caf28[_0x13f5ee(0x10a2)][_0x13f5ee(0x1502)](_0x3bffba=>_0x3bffba['id']===_0x36911a))return!![];return![];});_0x5b67be[_0x419ab0(0x427)](_0x267e7a=>{const _0x3c7dc7=_0x419ab0,_0x1d3027=_0x1704d0(_0x267e7a);_0x1b386e[_0x3c7dc7(0x6b6)](_0x1d3027);});}async function _0x501d30(_0x13d97f,_0x56b3c0){const _0x75e4c4=_0x3ce1fb,_0x77e7a5=_0x16699d[_0x75e4c4(0x1474)][_0x13d97f];if(!_0x77e7a5)return;!_0x77e7a5[_0x75e4c4(0x22c)]&&(_0x77e7a5[_0x75e4c4(0x22c)]=[]),_0x77e7a5['appUsageLog']['push']({'appName':_0x56b3c0,'timestamp':Date[_0x75e4c4(0x1386)]()}),_0x77e7a5['appUsageLog'][_0x75e4c4(0xaf9)]>0x32&&_0x77e7a5[_0x75e4c4(0x22c)][_0x75e4c4(0x13a1)](),await _0x6ed281[_0x75e4c4(0x1474)][_0x75e4c4(0x90c)](_0x77e7a5);}function _0x7e279(){const _0x13b82e=_0x3ce1fb,_0x398589=document[_0x13b82e(0x948)](_0x13b82e(0x118d));_0x398589[_0x13b82e(0xb6f)]='';const _0x2c6090=_0x16699d[_0x13b82e(0x1474)][_0x36911a],_0x403363=(_0x2c6090[_0x13b82e(0x22c)]||[])['slice']()['reverse']();if(_0x403363[_0x13b82e(0xaf9)]===0x0){_0x398589[_0x13b82e(0xb6f)]=_0x13b82e(0xb0d);return;}const _0x4ba6bd={'qq':'QQ','album':'相册','browser':_0x13b82e(0xc7b),'taobao':'淘宝','memo':_0x13b82e(0x21f),'diary':'日记','amap':'高德地图','usage':'App记录'};_0x403363[_0x13b82e(0x427)](_0x5c0c70=>{const _0x12bc83=_0x13b82e,_0x5772f8=document[_0x12bc83(0x1497)](_0x12bc83(0x379));_0x5772f8['className']='usage-item',_0x5772f8[_0x12bc83(0xb6f)]=_0x12bc83(0xa45)+new Date(_0x5c0c70[_0x12bc83(0xb0a)])[_0x12bc83(0xed3)]()+_0x12bc83(0xbd3)+(_0x4ba6bd[_0x5c0c70['appName']]||_0x5c0c70[_0x12bc83(0x249)])+_0x12bc83(0x491),_0x398589[_0x12bc83(0x6b6)](_0x5772f8);});}async function _0x45242d(_0x35913f){const _0x5a6fbc=_0x3ce1fb,_0x4c3d08=_0x16699d[_0x5a6fbc(0x1474)][_0x36911a];if(!_0x4c3d08)return;const _0xde8f2e={'role':_0x5a6fbc(0x14c8),'senderName':_0x4c3d08[_0x5a6fbc(0x628)],'type':_0x5a6fbc(0x137c),'content':_0x35913f,'imageUrl':_0x5a6fbc(0xef7),'timestamp':Date[_0x5a6fbc(0x1386)]()};_0x4c3d08['history']['push'](_0xde8f2e),await _0x6ed281[_0x5a6fbc(0x1474)][_0x5a6fbc(0x90c)](_0x4c3d08),_0x16699d[_0x5a6fbc(0xf5a)]===_0x36911a&&_0x4b384e(_0xde8f2e,_0x4c3d08),await _0x104485(_0x5a6fbc(0x50b),'“'+_0x4c3d08[_0x5a6fbc(0x1467)]+_0x5a6fbc(0x158f));}async function _0x17c2fa(_0x3e2019){const _0x2acf16=_0x3ce1fb,_0x17a1bb=_0x16699d[_0x2acf16(0x1474)][_0x36911a];if(!_0x17a1bb||!_0x17a1bb['memos'])return;const _0x1e389c=_0x17a1bb[_0x2acf16(0x1223)][_0x2acf16(0x1402)](_0x23ed8a=>_0x23ed8a['id']===_0x3e2019);if(_0x1e389c){_0x4ba2c2=_0x1e389c;const _0x9fa260=document[_0x2acf16(0x948)](_0x2acf16(0x1207)),_0x2513aa=document[_0x2acf16(0x948)](_0x2acf16(0x10fc)),_0x19f51c=document[_0x2acf16(0x948)](_0x2acf16(0x671));if(_0x9fa260)_0x9fa260['textContent']=_0x1e389c[_0x2acf16(0xb03)];if(_0x2513aa)_0x2513aa[_0x2acf16(0x5bc)]=_0x1e389c['content'];const _0x3ceef0=await _0x6ed281[_0x2acf16(0x1dc)][_0x2acf16(0x1117)]({'type':_0x2acf16(0x798),'content.id':_0x3e2019})[_0x2acf16(0x678)]();_0x19f51c[_0x2acf16(0xd54)][_0x2acf16(0x69d)](_0x2acf16(0x115e),!!_0x3ceef0),_0x13f7b4(_0x2acf16(0x11db));}}function _0x140dc7(){const _0x5520f0=_0x3ce1fb,_0x40e537=document[_0x5520f0(0x948)](_0x5520f0(0x848));_0x40e537[_0x5520f0(0xb6f)]='';const _0x5e5650=_0x16699d['chats'][_0x36911a],_0x3fdf14=(_0x5e5650[_0x5520f0(0x1223)]||[])[_0x5520f0(0x200)]()['reverse']();if(_0x3fdf14[_0x5520f0(0xaf9)]===0x0){_0x40e537[_0x5520f0(0xb6f)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有备忘录。</p>';return;}_0x3fdf14[_0x5520f0(0x427)](_0x5d7022=>{const _0x283933=_0x5520f0,_0x1b63dd=document[_0x283933(0x1497)]('div');_0x1b63dd['className']=_0x283933(0x2aa),_0x1b63dd[_0x283933(0xb6f)]=_0x283933(0x131a)+_0x5d7022[_0x283933(0xb03)]+_0x283933(0x88f)+(_0x5d7022[_0x283933(0xede)]||'')[_0x283933(0x46f)]('\x0a')[0x0]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x1b63dd[_0x283933(0x339)](_0x283933(0x4f6),()=>_0x17c2fa(_0x5d7022['id'])),_0x159366(_0x1b63dd,()=>deleteMemo(_0x5d7022['id'])),_0x40e537['appendChild'](_0x1b63dd);});}async function _0x4ecbeb(_0x1f5e84=null){const _0x576ca8=_0x3ce1fb;_0x4d2649=null;const _0x45e6e3=await _0x41b9fc(_0x576ca8(0xc70),_0x576ca8(0xd15));if(_0x45e6e3===null||!_0x45e6e3[_0x576ca8(0x2a8)]())return;const _0x21601d=await _0x41b9fc(_0x576ca8(0xfd6)+_0x45e6e3,_0x576ca8(0x106b),'',_0x576ca8(0xc1e));_0x21601d!==null&&(await _0x261505({'title':_0x45e6e3['trim'](),'content':_0x21601d}),_0x13f7b4(_0x576ca8(0x9ec)));}async function _0x261505(_0x17f7ad){const _0x3bd0eb=_0x3ce1fb,_0x26df4b=_0x16699d[_0x3bd0eb(0x1474)][_0x36911a];if(!_0x26df4b['memos'])_0x26df4b['memos']=[];_0x26df4b[_0x3bd0eb(0x1223)]['push']({'id':Date[_0x3bd0eb(0x1386)](),'title':_0x17f7ad[_0x3bd0eb(0xb03)],'content':_0x17f7ad['content']}),await _0x6ed281['chats']['put'](_0x26df4b),_0x140dc7();}async function _0x261505(_0x4d6cd3){const _0x16a16b=_0x3ce1fb,_0x55bbf2=_0x16699d['chats'][_0x36911a];if(!_0x55bbf2[_0x16a16b(0x1223)])_0x55bbf2['memos']=[];if(_0x4d2649){const _0x37de8a=_0x55bbf2[_0x16a16b(0x1223)][_0x16a16b(0x1402)](_0x1efaa3=>_0x1efaa3['id']===_0x4d2649);if(_0x37de8a)_0x37de8a[_0x16a16b(0xede)]=_0x4d6cd3;}else _0x55bbf2[_0x16a16b(0x1223)][_0x16a16b(0x1001)]({'id':Date[_0x16a16b(0x1386)](),'content':_0x4d6cd3});await _0x6ed281[_0x16a16b(0x1474)]['put'](_0x55bbf2),_0x140dc7(),_0x4d2649=null;}async function _0x464948(){const _0x2e0e25=_0x3ce1fb;if(!_0x36911a)return;const _0x5ab83e=_0x16699d['chats'][_0x36911a];if(!_0x5ab83e)return;await _0x104485('请稍候...',_0x2e0e25(0x54b)+_0x5ab83e[_0x2e0e25(0x1467)]+_0x2e0e25(0x91e));const {proxyUrl:_0x3425ee,apiKey:_0x313f64,model:_0x128860}=_0x16699d[_0x2e0e25(0x79e)];if(!_0x3425ee||!_0x313f64||!_0x128860){alert('请先在API设置中配置好API信息。');return;}const _0x247362=_0x16699d[_0x2e0e25(0x66e)][_0x2e0e25(0xf4d)]==='{{user}}'||!_0x16699d['qzoneSettings'][_0x2e0e25(0xf4d)]?'用户':_0x16699d[_0x2e0e25(0x66e)][_0x2e0e25(0xf4d)],_0x4489d6=_0x5ab83e[_0x2e0e25(0x758)]&&_0x5ab83e[_0x2e0e25(0x758)][_0x2e0e25(0xaf9)]>0x0?_0x5ab83e[_0x2e0e25(0x758)]['map'](_0x176847=>'-\x20(记录于\x20'+_0x31ced1(_0x176847['timestamp'])+')\x20'+_0x176847['content'])['join']('\x0a'):'无',_0x5ae394=_0x5ab83e['settings'][_0x2e0e25(0x78a)]||0xa,_0x441690=_0x5ab83e[_0x2e0e25(0xb07)]['slice'](-_0x5ae394)['map'](_0x43d8b9=>(_0x43d8b9[_0x2e0e25(0x1554)]==='user'?_0x247362:_0x5ab83e[_0x2e0e25(0x1467)])+':\x20'+String(_0x43d8b9[_0x2e0e25(0xede)])[_0x2e0e25(0xeca)](0x0,0x1e)+_0x2e0e25(0x76d))[_0x2e0e25(0x121a)]('\x0a'),_0xd7bbca=(_0x5ab83e[_0x2e0e25(0x7fd)]['linkedWorldBookIds']||[])['map'](_0x35ab35=>_0x16699d[_0x2e0e25(0x44c)][_0x2e0e25(0x1402)](_0x1ae281=>_0x1ae281['id']===_0x35ab35))['filter'](Boolean)['map'](_0x23c214=>'\x0a##\x20世界书《'+_0x23c214[_0x2e0e25(0x1467)]+_0x2e0e25(0x431)+_0x23c214['content'][_0x2e0e25(0x1c0)](_0x3bc892=>_0x3bc892[_0x2e0e25(0x111f)])[_0x2e0e25(0x8ff)](_0x1f91fc=>'-\x20'+_0x1f91fc[_0x2e0e25(0xede)])['join']('\x0a'))[_0x2e0e25(0x121a)](''),_0x429666=_0x989347(_0x5ab83e,0x3,_0x2e0e25(0x435)),_0x3a09ea=_0x989347(_0x5ab83e,0x6,_0x2e0e25(0x435)),_0x16ecf6=_0x989347(_0x5ab83e,0x9,'hours'),_0x6826f9=_0x989347(_0x5ab83e,0x1,_0x2e0e25(0x14df)),_0x22e67a=_0x989347(_0x5ab83e,0x3,_0x2e0e25(0x14df)),_0x4fe4ab=_0x989347(_0x5ab83e,0x7,'days');let _0x11f9fc='';if(_0x429666||_0x3a09ea||_0x16ecf6||_0x6826f9||_0x22e67a||_0x4fe4ab){_0x11f9fc+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x429666)_0x11f9fc+=_0x429666;if(_0x3a09ea)_0x11f9fc+=_0x3a09ea;if(_0x16ecf6)_0x11f9fc+=_0x16ecf6;if(_0x429666||_0x3a09ea||_0x16ecf6)_0x11f9fc+='\x0a';if(_0x6826f9)_0x11f9fc+=_0x6826f9;if(_0x22e67a)_0x11f9fc+=_0x22e67a;if(_0x4fe4ab)_0x11f9fc+=_0x4fe4ab;}const _0x496efa=_0x5ab83e[_0x2e0e25(0x7fd)]['myPersona']||_0x2e0e25(0x572),_0x5e3c41=_0x2e0e25(0x129b)+_0x5ab83e[_0x2e0e25(0x1467)]+_0x2e0e25(0xe61)+new Date()[_0x2e0e25(0xf98)](_0x2e0e25(0x144f))+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】日记的标题日期，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【沉浸感】**:\x20每一篇日记都必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【长度】**:\x20每一篇日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一篇日记，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【占位符替换\x20(最高优先级)】**:\x20在你的日记内容中，【绝对不能】出现\x20\x22{{user}}\x22\x20这个占位符。你【必须】使用\x20“'+_0x247362+_0x2e0e25(0x72f)+_0x5ab83e[_0x2e0e25(0x7fd)][_0x2e0e25(0x14c1)]+_0x2e0e25(0x8a2)+_0x496efa+_0x2e0e25(0x12b3)+_0x4489d6+'\x0a'+_0xd7bbca+'\x0a'+_0x11f9fc+'\x20\x0a-\x20**你最近和“'+_0x247362+'”的对话摘要**:\x0a'+_0x441690+_0x2e0e25(0xc3b);try{const _0x447fe4=[{'role':_0x2e0e25(0xaeb),'content':_0x2e0e25(0xa64)}];let _0x4d4529=_0x3425ee['includes'](_0x2e0e25(0x708)),_0x1302a5=_0xe8c788(_0x128860,_0x313f64,_0x5e3c41,_0x447fe4);const _0x5a5748=_0x4d4529?await fetch(_0x1302a5[_0x2e0e25(0x9a8)],_0x1302a5[_0x2e0e25(0x92a)]):await fetch(_0x3425ee+'/v1/chat/completions',{'method':_0x2e0e25(0xdca),'headers':{'Content-Type':_0x2e0e25(0x479),'Authorization':_0x2e0e25(0xb0e)+_0x313f64},'body':JSON['stringify']({'model':_0x128860,'messages':[{'role':_0x2e0e25(0x11af),'content':_0x5e3c41},..._0x447fe4],'temperature':_0x16699d[_0x2e0e25(0xf9c)][_0x2e0e25(0x382)]||0.95})});if(!_0x5a5748['ok'])throw new Error('API\x20错误:\x20'+_0x5a5748[_0x2e0e25(0x13a2)]);const _0x5d73c1=await _0x5a5748[_0x2e0e25(0x21d)](),_0x16e8e5=getGeminiResponseText(_0x5d73c1),_0x4ba72d=_0x16e8e5[_0x2e0e25(0x9a3)](/(\[[\s\S]*\])/);if(!_0x4ba72d||!_0x4ba72d[0x0])throw new Error(_0x2e0e25(0xdf4)+_0x16e8e5);const _0x23747e=_0x4ba72d[0x0];let _0x2e4909;try{_0x2e4909=JSON['parse'](_0x23747e);}catch(_0x3d9705){throw new Error(_0x2e0e25(0xeaf)+_0x3d9705[_0x2e0e25(0x74b)]+'\x0a\x0aAI原始返回内容:\x0a'+_0x16e8e5);}_0x5ab83e[_0x2e0e25(0x412)]=_0x2e4909['map'](_0x2aa9c3=>({'id':Date[_0x2e0e25(0x1386)]()+Math['random'](),'title':_0x2aa9c3['title'],'content':_0x2aa9c3['content'],'timestamp':Date[_0x2e0e25(0x1386)]()})),await _0x6ed281[_0x2e0e25(0x1474)]['put'](_0x5ab83e),await _0x4457e5();}catch(_0x4acec2){console[_0x2e0e25(0xc3e)](_0x2e0e25(0x755),_0x4acec2),await _0x104485(_0x2e0e25(0x1164),_0x2e0e25(0x588)+_0x4acec2[_0x2e0e25(0x74b)]);}}async function _0xa73dd1(){const _0x2ee028=_0x3ce1fb;if(!_0x36911a)return;const _0x1e5bda=_0x16699d['chats'][_0x36911a];if(!_0x1e5bda)return;await _0x104485(_0x2ee028(0x960),_0x2ee028(0x54b)+_0x1e5bda[_0x2ee028(0x1467)]+'”写一篇新日记...');const {proxyUrl:_0x5078c6,apiKey:_0x37d579,model:_0x5b0d04}=_0x16699d[_0x2ee028(0x79e)];if(!_0x5078c6||!_0x37d579||!_0x5b0d04)return;const _0x3b12ec=_0x16699d['qzoneSettings']['nickname']==='{{user}}'||!_0x16699d[_0x2ee028(0x66e)][_0x2ee028(0xf4d)]?'用户':_0x16699d[_0x2ee028(0x66e)][_0x2ee028(0xf4d)],_0x5ca74e=_0x1e5bda['longTermMemory']&&_0x1e5bda[_0x2ee028(0x758)]['length']>0x0?_0x1e5bda[_0x2ee028(0x758)][_0x2ee028(0x8ff)](_0x1a0b40=>_0x2ee028(0x152b)+_0x31ced1(_0x1a0b40[_0x2ee028(0xb0a)])+')\x20'+_0x1a0b40[_0x2ee028(0xede)])[_0x2ee028(0x121a)]('\x0a'):'无',_0x4fc65d=_0x1e5bda[_0x2ee028(0x7fd)][_0x2ee028(0x78a)]||0xa,_0x9573e3=_0x1e5bda[_0x2ee028(0xb07)][_0x2ee028(0x200)](-_0x4fc65d)['map'](_0xdc4e57=>(_0xdc4e57['role']==='user'?_0x3b12ec:_0x1e5bda[_0x2ee028(0x1467)])+':\x20'+String(_0xdc4e57[_0x2ee028(0xede)])[_0x2ee028(0xeca)](0x0,0x1e)+_0x2ee028(0x76d))[_0x2ee028(0x121a)]('\x0a'),_0x544b4a=(_0x1e5bda[_0x2ee028(0x7fd)][_0x2ee028(0xeee)]||[])['map'](_0x3748c8=>_0x16699d[_0x2ee028(0x44c)]['find'](_0xbe3314=>_0xbe3314['id']===_0x3748c8))[_0x2ee028(0x1c0)](Boolean)[_0x2ee028(0x8ff)](_0x45ec09=>_0x2ee028(0x4d3)+_0x45ec09[_0x2ee028(0x1467)]+_0x2ee028(0x431)+_0x45ec09[_0x2ee028(0xede)][_0x2ee028(0x1c0)](_0x424b37=>_0x424b37[_0x2ee028(0x111f)])[_0x2ee028(0x8ff)](_0x1a3abb=>'-\x20'+_0x1a3abb[_0x2ee028(0xede)])[_0x2ee028(0x121a)]('\x0a'))[_0x2ee028(0x121a)](''),_0xa9b891='\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“'+_0x1e5bda[_0x2ee028(0x1467)]+'”，并根据其人设、记忆和最近的互动，虚构出【1篇】TA今天可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【【【时间铁律\x20(最高优先级)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**'+new Date()[_0x2ee028(0xf98)](_0x2ee028(0x144f))+_0x2ee028(0x332)+_0x1e5bda[_0x2ee028(0x7fd)]['aiPersona']+_0x2ee028(0x12b3)+_0x5ca74e+'\x0a'+_0x544b4a+_0x2ee028(0x5af)+_0x3b12ec+_0x2ee028(0x372)+_0x9573e3+_0x2ee028(0xd04);try{const _0x36903c=[{'role':_0x2ee028(0xaeb),'content':_0x2ee028(0x1335)}];let _0x183b83=_0x5078c6[_0x2ee028(0x1336)]('generativelanguage'),_0x153341=_0xe8c788(_0x5b0d04,_0x37d579,_0xa9b891,_0x36903c);const _0x164483=_0x183b83?await fetch(_0x153341['url'],_0x153341[_0x2ee028(0x92a)]):await fetch(_0x5078c6+_0x2ee028(0x110e),{'method':_0x2ee028(0xdca),'headers':{'Content-Type':_0x2ee028(0x479),'Authorization':'Bearer\x20'+_0x37d579},'body':JSON[_0x2ee028(0x526)]({'model':_0x5b0d04,'messages':[{'role':_0x2ee028(0x11af),'content':_0xa9b891},..._0x36903c],'temperature':_0x16699d[_0x2ee028(0xf9c)][_0x2ee028(0x382)]||0.95})});if(!_0x164483['ok'])throw new Error(_0x2ee028(0x69a)+_0x164483['statusText']);const _0x2cedf6=await _0x164483[_0x2ee028(0x21d)](),_0x46dac0=getGeminiResponseText(_0x2cedf6),_0x39215b=_0x46dac0['match'](/(\[[\s\S]*\])/);if(!_0x39215b||!_0x39215b[0x0])throw new Error(_0x2ee028(0xdf4)+_0x46dac0);const _0x45e28f=_0x39215b[0x0];let _0x3d9a80;try{_0x3d9a80=JSON[_0x2ee028(0xde0)](_0x45e28f)[0x0];}catch(_0x4707b9){throw new Error('解析AI返回的JSON时出错:\x20'+_0x4707b9['message']+'\x0a\x0aAI原始返回内容:\x0a'+_0x46dac0);}if(!_0x1e5bda['diary'])_0x1e5bda[_0x2ee028(0x412)]=[];_0x1e5bda['diary'][_0x2ee028(0x1001)]({'id':Date[_0x2ee028(0x1386)](),'title':_0x3d9a80[_0x2ee028(0xb03)],'content':_0x3d9a80[_0x2ee028(0xede)],'timestamp':Date[_0x2ee028(0x1386)]()}),await _0x6ed281[_0x2ee028(0x1474)][_0x2ee028(0x90c)](_0x1e5bda),await _0x4457e5();}catch(_0x1dcc22){console[_0x2ee028(0xc3e)](_0x2ee028(0xfde),_0x1dcc22),await _0x104485(_0x2ee028(0x1164),_0x2ee028(0x86a)+_0x1dcc22[_0x2ee028(0x74b)]);}}function _0x4457e5(){const _0x402081=_0x3ce1fb,_0x24fb68=document[_0x402081(0x948)](_0x402081(0x1533));_0x24fb68['innerHTML']='';const _0x256e4d=_0x16699d[_0x402081(0x1474)][_0x36911a],_0xcf6bb=(_0x256e4d[_0x402081(0x412)]||[])['slice']()[_0x402081(0xb26)]();if(_0xcf6bb['length']===0x0){_0x24fb68[_0x402081(0xb6f)]=_0x402081(0x22d);return;}_0xcf6bb[_0x402081(0x427)](_0x48035c=>{const _0x4ab734=_0x402081,_0x170a96=document[_0x4ab734(0x1497)](_0x4ab734(0x379));_0x170a96[_0x4ab734(0x35b)]='list-item',_0x170a96[_0x4ab734(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>'+_0x48035c[_0x4ab734(0xb03)]+_0x4ab734(0x1135)+new Date(_0x48035c['timestamp'])[_0x4ab734(0xf98)]()+_0x4ab734(0xc9f),_0x170a96[_0x4ab734(0x339)](_0x4ab734(0x4f6),()=>_0x21212f(_0x48035c['id'])),_0x159366(_0x170a96,()=>_0x33464d(_0x48035c['id'])),_0x24fb68[_0x4ab734(0x6b6)](_0x170a96);});}async function _0x21212f(_0x2386c7){const _0x52dc17=_0x3ce1fb,_0x43b34c=_0x16699d['chats'][_0x36911a];if(!_0x43b34c||!_0x43b34c['diary'])return;const _0x226263=_0x43b34c[_0x52dc17(0x412)][_0x52dc17(0x1402)](_0x1475bc=>_0x1475bc['id']===_0x2386c7);if(_0x226263){_0x4f0bb5=_0x226263;const _0x3ac8c9=document[_0x52dc17(0x948)](_0x52dc17(0x12ad)),_0x474265=document[_0x52dc17(0x948)](_0x52dc17(0x6cc)),_0x4cd205=document[_0x52dc17(0x948)](_0x52dc17(0xd9e));_0x3ac8c9[_0x52dc17(0x10cb)]=_0x226263[_0x52dc17(0xb03)];const _0x1abc62=_0x5876e7(_0x226263[_0x52dc17(0xede)])['split']('\x0a')[_0x52dc17(0x8ff)](_0x1849e2=>_0x52dc17(0x51b)+(_0x1849e2||_0x52dc17(0x290))+_0x52dc17(0x79d))['join']('');_0x474265[_0x52dc17(0xb6f)]=_0x1abc62;const _0x20a242=await _0x6ed281[_0x52dc17(0x1dc)][_0x52dc17(0x1117)]({'type':_0x52dc17(0xba8),'content.id':_0x2386c7})[_0x52dc17(0x678)]();_0x4cd205[_0x52dc17(0xd54)][_0x52dc17(0x69d)](_0x52dc17(0x115e),!!_0x20a242),_0x13f7b4(_0x52dc17(0x81e));}}async function _0x31fc37(){const _0x2cc993=_0x3ce1fb;if(!_0x4f0bb5||!_0x36911a)return;const _0x34fe11=_0x4f0bb5,_0x312132=_0x16699d[_0x2cc993(0x1474)][_0x36911a],_0x3a9f1d=document['getElementById'](_0x2cc993(0xd9e)),_0x1dc638=await _0x6ed281[_0x2cc993(0x1dc)][_0x2cc993(0x1117)]({'type':_0x2cc993(0xba8),'content.id':_0x34fe11['id']})[_0x2cc993(0x678)]();if(_0x1dc638)await _0x6ed281[_0x2cc993(0x1dc)]['delete'](_0x1dc638['id']),_0x3a9f1d[_0x2cc993(0xd54)][_0x2cc993(0xf89)](_0x2cc993(0x115e)),await _0x104485(_0x2cc993(0xb80),_0x2cc993(0x1523));else{const _0x61e637={'type':_0x2cc993(0xba8),'content':{'id':_0x34fe11['id'],'title':_0x34fe11[_0x2cc993(0xb03)],'content':_0x34fe11[_0x2cc993(0xede)],'timestamp':_0x34fe11[_0x2cc993(0xb0a)],'characterId':_0x36911a,'characterName':_0x312132[_0x2cc993(0x1467)]},'timestamp':Date[_0x2cc993(0x1386)]()};await _0x6ed281['favorites'][_0x2cc993(0xbd0)](_0x61e637),_0x3a9f1d[_0x2cc993(0xd54)][_0x2cc993(0xbd0)](_0x2cc993(0x115e)),await _0x104485(_0x2cc993(0xb80),_0x2cc993(0x8a5));}}async function _0x36184a(){const _0x2321aa=_0x3ce1fb;if(!_0x4ba2c2||!_0x36911a)return;const _0x32bd44=_0x4ba2c2,_0x3f31ac=_0x16699d[_0x2321aa(0x1474)][_0x36911a],_0x2da422=document[_0x2321aa(0x948)]('favorite-memo-btn'),_0x130578=await _0x6ed281['favorites'][_0x2321aa(0x1117)]({'type':'char_memo','content.id':_0x32bd44['id']})[_0x2321aa(0x678)]();if(_0x130578)await _0x6ed281[_0x2321aa(0x1dc)]['delete'](_0x130578['id']),_0x2da422[_0x2321aa(0xd54)][_0x2321aa(0xf89)](_0x2321aa(0x115e)),await _0x104485(_0x2321aa(0xb80),_0x2321aa(0x1523));else{const _0x3087a9={'type':_0x2321aa(0x798),'content':{'id':_0x32bd44['id'],'title':_0x32bd44['title'],'content':_0x32bd44['content'],'timestamp':_0x32bd44[_0x2321aa(0xb0a)],'characterId':_0x36911a,'characterName':_0x3f31ac['name']},'timestamp':Date['now']()};await _0x6ed281[_0x2321aa(0x1dc)]['add'](_0x3087a9),_0x2da422[_0x2321aa(0xd54)][_0x2321aa(0xbd0)](_0x2321aa(0x115e)),await _0x104485(_0x2321aa(0xb80),'已成功收藏到“我的收藏”页面！');}}async function _0x33464d(_0x1366be){const _0x1a54d0=_0x3ce1fb,_0x279a64=await _0xa6b74a(_0x1a54d0(0x747),_0x1a54d0(0x1559),{'confirmButtonClass':'btn-danger'});if(_0x279a64){const _0x12af48=_0x16699d[_0x1a54d0(0x1474)][_0x36911a];_0x12af48[_0x1a54d0(0x412)]=_0x12af48[_0x1a54d0(0x412)][_0x1a54d0(0x1c0)](_0x3c1aa8=>_0x3c1aa8['id']!==_0x1366be),await _0x6ed281[_0x1a54d0(0x1474)][_0x1a54d0(0x90c)](_0x12af48),_0x4457e5();}}async function _0x1dd517(){const _0x5d334f=_0x3ce1fb,_0x1b0a4b=document[_0x5d334f(0x948)]('char-chat-list');_0x1b0a4b[_0x5d334f(0xb6f)]='';const _0x1621d8=_0x16699d[_0x5d334f(0x1474)][_0x36911a];if(!_0x1621d8)return;const _0xb97117=_0x1621d8[_0x5d334f(0x7fd)][_0x5d334f(0x1371)]||(_0x16699d[_0x5d334f(0x66e)][_0x5d334f(0xf4d)]||'我'),_0x3a816b=_0x1621d8[_0x5d334f(0xb07)][_0x5d334f(0x1c0)](_0x133080=>!_0x133080[_0x5d334f(0x583)])['slice'](-0x1)[0x0]||{'content':_0x5d334f(0x76d)};let _0x1f5cc9='...';if(_0x3a816b){if(typeof _0x3a816b[_0x5d334f(0xede)]===_0x5d334f(0x273))_0x1f5cc9=_0x3a816b[_0x5d334f(0xede)];else{if(Array[_0x5d334f(0x1524)](_0x3a816b[_0x5d334f(0xede)])&&_0x3a816b['content'][0x0]?.[_0x5d334f(0x4ae)]==='image_url')_0x1f5cc9='[图片]';else{if(_0x3a816b['type']){const _0x1dd5b6={'voice_message':_0x5d334f(0x445),'transfer':_0x5d334f(0xc36),'ai_image':'[图片]'};_0x1f5cc9=_0x1dd5b6[_0x3a816b[_0x5d334f(0x4ae)]]||'['+_0x3a816b['type']+']';}}}}const _0x350a26=_0x1621d8[_0x5d334f(0x7fd)][_0x5d334f(0xb09)]||_0x202ba5,_0x4aea1c=_0x1621d8[_0x5d334f(0x7fd)][_0x5d334f(0x892)]||'';let _0x359e4a;_0x4aea1c?_0x359e4a='<div\x20class=\x22avatar-group\x20has-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><div\x20class=\x22avatar-with-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22'+_0x350a26+_0x5d334f(0xa15)+_0x4aea1c+'\x22\x20class=\x22avatar-frame\x22></div></div>':_0x359e4a='<div\x20class=\x22avatar-group\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22'+_0x350a26+_0x5d334f(0x119a);const _0x36ee11=document[_0x5d334f(0x1497)]('div');_0x36ee11[_0x5d334f(0x35b)]='chat-list-item',_0x36ee11[_0x5d334f(0x606)]['conversationIndex']='-1',_0x36ee11['innerHTML']=_0x5d334f(0x5d7)+_0x359e4a+_0x5d334f(0x12f2)+_0xb97117+_0x5d334f(0x1fd)+String(_0x1f5cc9)[_0x5d334f(0xeca)](0x0,0x14)+_0x5d334f(0x1319),_0x1b0a4b[_0x5d334f(0x6b6)](_0x36ee11);const _0x3eaa5c=await _0x6ed281[_0x5d334f(0xa59)]['toArray'](),_0x198f06=new Map(_0x3eaa5c[_0x5d334f(0x8ff)](_0x7ed8fb=>[_0x7ed8fb[_0x5d334f(0x1467)],_0x7ed8fb])),_0x18aa04=_0x1621d8['simulatedConversations']||[];if(_0x18aa04['length']===0x0&&!_0x36ee11){_0x1b0a4b[_0x5d334f(0xb6f)]=_0x5d334f(0xcb0);return;}_0x18aa04[_0x5d334f(0x427)]((_0x4f2620,_0x32bbd9)=>{const _0x4c3cf5=_0x5d334f;if(_0x4f2620[_0x4c3cf5(0x4ae)]===_0x4c3cf5(0xf22))return;const _0x161534=document['createElement'](_0x4c3cf5(0x379));_0x161534[_0x4c3cf5(0x35b)]=_0x4c3cf5(0x1322),_0x161534[_0x4c3cf5(0x606)][_0x4c3cf5(0x60c)]=_0x32bbd9;let _0x597bfe,_0x4d6796,_0x5524cb;if(_0x4f2620[_0x4c3cf5(0x4ae)]===_0x4c3cf5(0x1403)){_0x5524cb=_0x4f2620['groupName']+_0x4c3cf5(0x113f),_0x597bfe=_0x4f2620[_0x4c3cf5(0x1436)][_0x4c3cf5(0x200)](-0x1)[0x0]||{'content':_0x4c3cf5(0x76d)};const _0x252fed=_0x4c3cf5(0x4fa)+_0x4f2620['groupName']+'\x27',_0x167a6d=_0x16699d[_0x4c3cf5(0xf9c)][_0x4c3cf5(0xf46)]?_0x4c3cf5(0xbfa)+encodeURIComponent(_0x252fed):_0x580bff;_0x4d6796=_0x4c3cf5(0x60a)+_0x167a6d+'\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>';}else{_0x5524cb=_0x4f2620[_0x4c3cf5(0xc15)]['name'],_0x597bfe=_0x4f2620[_0x4c3cf5(0x1436)]['slice'](-0x1)[0x0]||{'content':_0x4c3cf5(0x76d)};const _0x3acc8e=_0x198f06['get'](_0x5524cb);let _0x5c1f6b=_0x3acc8e&&_0x3acc8e[_0x4c3cf5(0x63e)]?_0x3acc8e[_0x4c3cf5(0x63e)]:_0x16699d[_0x4c3cf5(0xf9c)][_0x4c3cf5(0xf46)]?_0x4c3cf5(0xbfa)+encodeURIComponent(_0x4f2620[_0x4c3cf5(0xc15)][_0x4c3cf5(0x1507)]||_0x4c3cf5(0x3b1)):_0x3ca5ef;_0x4d6796=_0x4c3cf5(0x60a)+_0x5c1f6b+_0x4c3cf5(0x117d);}let _0x143b35=_0x4c3cf5(0x76d);_0x597bfe&&_0x597bfe[_0x4c3cf5(0xede)]&&(_0x143b35=_0x597bfe[_0x4c3cf5(0xede)]),_0x161534[_0x4c3cf5(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4d6796+_0x4c3cf5(0x1145)+_0x5524cb+_0x4c3cf5(0x852)+String(_0x143b35)[_0x4c3cf5(0xeca)](0x0,0x14)+'...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x1b0a4b['appendChild'](_0x161534);});}async function _0x64d3ca(){const _0xf648f1=_0x3ce1fb;if(!_0x36911a)return;const _0x163c69=_0x16699d[_0xf648f1(0x1474)][_0x36911a];if(!_0x163c69)return;await _0x104485(_0xf648f1(0x960),_0xf648f1(0x527)+_0x163c69[_0xf648f1(0x1467)]+_0xf648f1(0x45d));const {proxyUrl:_0x2d9e0e,apiKey:_0x52ccb8,model:_0x48b7c1}=_0x16699d[_0xf648f1(0x79e)];if(!_0x2d9e0e||!_0x52ccb8||!_0x48b7c1){alert(_0xf648f1(0x857));return;}const _0x4f4465=await _0x6ed281[_0xf648f1(0xa59)][_0xf648f1(0x443)](),_0xbe2bf0=_0x4f4465['filter'](_0x2ded84=>_0x2ded84['associatedWith']&&_0x2ded84[_0xf648f1(0x111e)]['includes'](_0x36911a));let _0x30a61c=_0xf648f1(0x4b6);_0xbe2bf0['length']>0x0?(_0x30a61c+=_0xf648f1(0x94c),_0xbe2bf0['forEach'](_0x5296b5=>{const _0x3cfb6a=_0xf648f1;_0x30a61c+='-\x20**姓名**:\x20'+_0x5296b5[_0x3cfb6a(0x1467)]+_0x3cfb6a(0x131d)+_0x5296b5[_0x3cfb6a(0xbad)]+'\x0a';})):_0x30a61c+=_0xf648f1(0xdbc);const _0x58a85e=_0x16699d[_0xf648f1(0x66e)][_0xf648f1(0xf4d)]==='{{user}}'||!_0x16699d[_0xf648f1(0x66e)][_0xf648f1(0xf4d)]?'用户':_0x16699d['qzoneSettings'][_0xf648f1(0xf4d)],_0x1e4957=_0x163c69['settings']['myNickname']||_0x58a85e,_0x253fa0=_0x163c69['longTermMemory']&&_0x163c69[_0xf648f1(0x758)][_0xf648f1(0xaf9)]>0x0?_0x163c69[_0xf648f1(0x758)][_0xf648f1(0x8ff)](_0x318c51=>'-\x20(记录于\x20'+_0x31ced1(_0x318c51[_0xf648f1(0xb0a)])+')\x20'+_0x318c51['content'])[_0xf648f1(0x121a)]('\x0a'):'无',_0x5bac48=_0x163c69['settings'][_0xf648f1(0x78a)]||0xa,_0x2ea2c2=_0x163c69['history'][_0xf648f1(0x200)](-_0x5bac48)['map'](_0x3bc36c=>(_0x3bc36c['role']===_0xf648f1(0xaeb)?_0x1e4957:_0x163c69[_0xf648f1(0x1467)])+':\x20'+String(_0x3bc36c[_0xf648f1(0xede)])[_0xf648f1(0xeca)](0x0,0x1e)+_0xf648f1(0x76d))[_0xf648f1(0x121a)]('\x0a'),_0x20df59=(_0x163c69[_0xf648f1(0x7fd)]['linkedWorldBookIds']||[])['map'](_0x432803=>_0x16699d[_0xf648f1(0x44c)]['find'](_0x595540=>_0x595540['id']===_0x432803))[_0xf648f1(0x1c0)](Boolean)[_0xf648f1(0x8ff)](_0x53a157=>'\x0a##\x20世界书《'+_0x53a157[_0xf648f1(0x1467)]+_0xf648f1(0xe04)+_0x53a157[_0xf648f1(0xede)][_0xf648f1(0x1c0)](_0x247abf=>_0x247abf[_0xf648f1(0x111f)])['map'](_0x37d564=>'-\x20'+_0x37d564[_0xf648f1(0xede)])[_0xf648f1(0x121a)]('\x0a'))[_0xf648f1(0x121a)](''),_0x4958f5=_0x163c69['originalName']||_0x163c69[_0xf648f1(0x1467)],_0x19a2ca=_0x16ebe3(_0x163c69),_0x478863=_0xf648f1(0x1459)+_0x163c69[_0xf648f1(0x1467)]+'”。你的任务是虚构出【5到7段】TA最近的QQ聊天记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【NPC唯一性铁律】**:\x20在你本次生成的所有对话中（包括私聊和群聊），每一个NPC的名字【必须是独一-无二的】。绝对禁止出现重名的NPC，禁止出现重复群聊。\x0a2.\x20\x20**【NPC来源】**:\x20你应该优先从“你的社交圈\x20(绑定的NPC)”和“世界书”中寻找角色作为聊天对象。如果不够，你也可以自由创造全新的NPC，对话内容要多样化，反映角色的生活。\x0a3.\x20\x20**关联性**:\x20对话内容应巧妙地反映角色的长期记忆、世界观，以及与用户互动可能带来的心情变化。\x0a4.\x20\x20**简洁性**:\x20每段对话的总长度应在8到15句之间。\x0a#\x20格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须且只能】是一个JSON数组格式的字符串，以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a-\x20数组中的每个元素都代表一段对话，且【必须】是以下两种格式之一：\x0a\x0a\x0a\x0a###\x20格式\x20A：与NPC的私聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22private_npc\x22,\x0a\x20\x20\x22participant\x22:\x20{\x0a\x20\x20\x20\x20\x22name\x22:\x20\x22NPC的名字\x22,\x0a\x20\x20\x20\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)一段用于生成头像的【英文】关键词,\x20风格为动漫/插画/二次元等,\x20禁止真人\x22\x0a\x20\x20},\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22'+_0x4958f5+_0xf648f1(0x5cd)+_0x4958f5+_0xf648f1(0xcb5)+_0x4958f5+_0xf648f1(0xe5f)+_0x163c69[_0xf648f1(0x7fd)][_0xf648f1(0x14c1)]+_0xf648f1(0x1b5)+_0x253fa0+_0xf648f1(0xeb9)+_0x20df59+_0xf648f1(0xb3b)+_0x2ea2c2+'\x0a'+_0x30a61c+_0xf648f1(0x8be)+_0x19a2ca+'\x0a现在，请严格按照格式铁律，生成聊天记录的JSON数组。';try{const _0x42c78b=[{'role':_0xf648f1(0xaeb),'content':_0xf648f1(0xa13)}];let _0x327498=_0x2d9e0e[_0xf648f1(0x1336)](_0xf648f1(0x708)),_0x98df67=_0xe8c788(_0x48b7c1,_0x52ccb8,_0x478863,_0x42c78b);const _0x6b22=_0x327498?await fetch(_0x98df67['url'],_0x98df67[_0xf648f1(0x92a)]):await fetch(_0x2d9e0e+_0xf648f1(0x110e),{'method':_0xf648f1(0xdca),'headers':{'Content-Type':'application/json','Authorization':_0xf648f1(0xb0e)+_0x52ccb8},'body':JSON[_0xf648f1(0x526)]({'model':_0x48b7c1,'messages':[{'role':_0xf648f1(0x11af),'content':_0x478863},..._0x42c78b],'temperature':_0x16699d['globalSettings'][_0xf648f1(0x382)]||0.9})});if(!_0x6b22['ok'])throw new Error('API\x20错误:\x20'+_0x6b22[_0xf648f1(0x13a2)]);const _0x240a7e=await _0x6b22['json'](),_0x4163d2=getGeminiResponseText(_0x240a7e),_0x3b6550=_0x4163d2[_0xf648f1(0x9a3)](/(\[[\s\S]*\])/);if(!_0x3b6550||!_0x3b6550[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x4163d2);const _0x5b546a=_0x3b6550[0x0];let _0x5a76fd;try{_0x5a76fd=JSON[_0xf648f1(0xde0)](_0x5b546a);}catch(_0x34e4b3){throw new Error(_0xf648f1(0xeaf)+_0x34e4b3[_0xf648f1(0x74b)]+_0xf648f1(0x5b6)+_0x4163d2);}_0x163c69[_0xf648f1(0xb31)]=_0x5a76fd,await _0x6ed281[_0xf648f1(0x1474)][_0xf648f1(0x90c)](_0x163c69),await _0x1dd517();const _0x5c6506={'role':_0xf648f1(0x11af),'content':_0xf648f1(0x15a1),'timestamp':Date[_0xf648f1(0x1386)](),'isHidden':!![]};_0x163c69[_0xf648f1(0xb07)][_0xf648f1(0x1001)](_0x5c6506),await _0x6ed281['chats'][_0xf648f1(0x90c)](_0x163c69),_0x45c50a();}catch(_0x382f66){console[_0xf648f1(0xc3e)]('生成模拟聊天失败:',_0x382f66),await _0x104485(_0xf648f1(0x1164),_0xf648f1(0xddd)+_0x382f66['message']);}}async function _0x4ea465(){const _0x1002ee=_0x3ce1fb;if(!_0x36911a)return;const _0x49f16d=_0x16699d['chats'][_0x36911a];if(!_0x49f16d)return;try{const {proxyUrl:_0x114beb,apiKey:_0x21faf3,model:_0x17374e}=_0x16699d[_0x1002ee(0x79e)];if(!_0x114beb||!_0x21faf3||!_0x17374e)throw new Error('API未配置，无法生成对话。');const _0x316691=parseInt(_0x49f16d[_0x1002ee(0x7fd)][_0x1002ee(0x78a)])||0xa,_0x3f196c=_0x49f16d[_0x1002ee(0xb07)][_0x1002ee(0x200)](-_0x316691),_0x24bc29=_0x49f16d[_0x1002ee(0x7fd)][_0x1002ee(0x1371)]||'我',_0x4ec4ca=_0x49f16d[_0x1002ee(0x7fd)][_0x1002ee(0x13b6)]||'用户',_0x2163d4=_0x1002ee(0x652)+(_0x49f16d['longTermMemory']&&_0x49f16d[_0x1002ee(0x758)]['length']>0x0?_0x49f16d[_0x1002ee(0x758)][_0x1002ee(0x8ff)](_0x1389fb=>'-\x20'+_0x1389fb[_0x1002ee(0xede)])[_0x1002ee(0x121a)]('\x0a'):_0x1002ee(0xad1));let _0x5bec24='';if(_0x49f16d[_0x1002ee(0x7fd)][_0x1002ee(0xeee)]&&_0x49f16d[_0x1002ee(0x7fd)][_0x1002ee(0xeee)][_0x1002ee(0xaf9)]>0x0){const _0x3c1e5f=_0x49f16d['settings'][_0x1002ee(0xeee)][_0x1002ee(0x8ff)](_0x295028=>{const _0x129934=_0x1002ee,_0xe9d023=_0x16699d[_0x129934(0x44c)]['find'](_0x49bd31=>_0x49bd31['id']===_0x295028);if(!_0xe9d023||!Array[_0x129934(0x1524)](_0xe9d023['content']))return'';const _0x5746d0=_0xe9d023[_0x129934(0xede)][_0x129934(0x1c0)](_0x185bd5=>_0x185bd5[_0x129934(0x111f)]!==![])['map'](_0x3d9420=>_0x129934(0x886)+(_0x3d9420[_0x129934(0x282)]||_0x129934(0xae0))+_0x129934(0x1494)+_0x3d9420[_0x129934(0xede)])['join']('');return _0x5746d0?'\x0a\x0a##\x20世界书:\x20'+_0xe9d023[_0x129934(0x1467)]+'\x0a'+_0x5746d0:'';})[_0x1002ee(0x1c0)](Boolean)[_0x1002ee(0x121a)]('');_0x3c1e5f&&(_0x5bec24=_0x1002ee(0x9da)+_0x3c1e5f+'\x0a');}const _0x5debc7=_0x989347(_0x49f16d,0x3,'hours'),_0x1a503d=_0x989347(_0x49f16d,0x6,_0x1002ee(0x435)),_0x3e4de3=_0x989347(_0x49f16d,0x9,_0x1002ee(0x435)),_0x5442c2=_0x989347(_0x49f16d,0x1,_0x1002ee(0x14df)),_0xce8256=_0x989347(_0x49f16d,0x3,'days'),_0x4c8f55=_0x989347(_0x49f16d,0x7,'days');let _0x2ca02f='';if(_0x5debc7||_0x1a503d||_0x3e4de3||_0x5442c2||_0xce8256||_0x4c8f55){_0x2ca02f+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x5debc7)_0x2ca02f+=_0x5debc7;if(_0x1a503d)_0x2ca02f+=_0x1a503d;if(_0x3e4de3)_0x2ca02f+=_0x3e4de3;if(_0x5debc7||_0x1a503d||_0x3e4de3)_0x2ca02f+='\x0a';if(_0x5442c2)_0x2ca02f+=_0x5442c2;if(_0xce8256)_0x2ca02f+=_0xce8256;if(_0x4c8f55)_0x2ca02f+=_0x4c8f55;}const _0x37f448=_0x5e13e4(_0x49f16d),_0x9e7498=_0x1002ee(0x5c2)+_0x49f16d[_0x1002ee(0x628)]+'”。用户刚刚在TA的手机（CPhone）上点击了一个按钮，希望你能继续你们之前的对话。你的任务是根据上下文，生成【3到5条】符合你人设的、简短的、连续的新回复。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组，每个对象代表一条消息。\x0a-\x20格式:\x20`[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第一句话\x22},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第二句话\x22},\x20{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]`\x0a-\x20你可以自由组合使用\x20\x22text\x22,\x20\x22sticker\x22,\x20\x22ai_image\x22,\x20\x22voice_message\x22\x20等多种消息类型。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20你的角色设定\x0a'+_0x49f16d[_0x1002ee(0x7fd)][_0x1002ee(0x14c1)]+'\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a'+_0x37f448+_0x1002ee(0x6ae)+_0x4ec4ca+'\x20\x20\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的本名**:\x20\x22'+_0x49f16d[_0x1002ee(0x628)]+_0x1002ee(0x82f)+_0x24bc29+'\x22\x0a'+_0x5bec24+'\x0a'+_0x2163d4+'\x0a'+_0x2ca02f+_0x1002ee(0xb01)+_0x3f196c[_0x1002ee(0x8ff)](_0x394f7f=>(_0x394f7f['role']===_0x1002ee(0xaeb)?_0x24bc29:_0x49f16d[_0x1002ee(0x1467)])+':\x20'+String(_0x394f7f[_0x1002ee(0xede)]))[_0x1002ee(0x121a)]('\x0a')+_0x1002ee(0x781),_0x7a755d=_0x3f196c[_0x1002ee(0x8ff)](_0x38026a=>({'role':_0x38026a['role'],'content':(_0x38026a[_0x1002ee(0x1554)]===_0x1002ee(0xaeb)?_0x24bc29:_0x49f16d['name'])+':\x20'+String(_0x38026a[_0x1002ee(0xede)])}));let _0x1c972f=_0x114beb[_0x1002ee(0x1336)](_0x1002ee(0x708)),_0xeee048=_0xe8c788(_0x17374e,_0x21faf3,_0x9e7498,_0x7a755d);const _0x3de4fc=_0x1c972f?await fetch(_0xeee048[_0x1002ee(0x9a8)],_0xeee048[_0x1002ee(0x92a)]):await fetch(_0x114beb+_0x1002ee(0x110e),{'method':_0x1002ee(0xdca),'headers':{'Content-Type':_0x1002ee(0x479),'Authorization':_0x1002ee(0xb0e)+_0x21faf3},'body':JSON['stringify']({'model':_0x17374e,'messages':[{'role':_0x1002ee(0x11af),'content':_0x9e7498},..._0x7a755d],'temperature':_0x16699d[_0x1002ee(0xf9c)][_0x1002ee(0x382)]||0.8})});if(!_0x3de4fc['ok'])throw new Error(_0x1002ee(0x969)+(await _0x3de4fc[_0x1002ee(0x21d)]())[_0x1002ee(0xc3e)][_0x1002ee(0x74b)]);const _0x5f58cd=await _0x3de4fc['json'](),_0x4cf0d5=getGeminiResponseText(_0x5f58cd),_0x22c0c7=_0xad600c(_0x4cf0d5);if(!_0x22c0c7||_0x22c0c7[_0x1002ee(0xaf9)]===0x0)throw new Error('AI返回了空内容。');let _0x58f5bb=0x0,_0x5da770=Date[_0x1002ee(0x1386)]();for(const _0x3d0dfe of _0x22c0c7){const _0x82cf2={'role':_0x1002ee(0x14c8),'senderName':_0x49f16d[_0x1002ee(0x628)],'timestamp':_0x5da770++};let _0x4760e0=null;switch(_0x3d0dfe[_0x1002ee(0x4ae)]){case _0x1002ee(0x9ea):_0x4760e0={..._0x82cf2,'content':String(_0x3d0dfe['content']||_0x3d0dfe['message'])};break;case _0x1002ee(0x10c2):if(_0x3d0dfe[_0x1002ee(0x14f1)]){const _0x24a76f=_0x16699d['userStickers'][_0x1002ee(0x1402)](_0x44dbae=>_0x44dbae[_0x1002ee(0x1467)]===_0x3d0dfe['meaning']);_0x24a76f?_0x4760e0={..._0x82cf2,'type':'sticker','content':_0x24a76f[_0x1002ee(0x9a8)],'meaning':_0x24a76f[_0x1002ee(0x1467)]}:(console['warn']('AI\x20(CPhone)\x20尝试使用一个不存在的表情:\x20\x22'+_0x3d0dfe[_0x1002ee(0x14f1)]+'\x22'),_0x4760e0={..._0x82cf2,'type':_0x1002ee(0x9ea),'content':'[表情:\x20'+_0x3d0dfe[_0x1002ee(0x14f1)]+']'});}else console['warn'](_0x1002ee(0xeb4),_0x3d0dfe),_0x4760e0={..._0x82cf2,'type':_0x1002ee(0x10c2),'content':_0x3d0dfe[_0x1002ee(0x9a8)],'meaning':_0x1002ee(0xe73)};break;}_0x4760e0&&(_0x49f16d['history'][_0x1002ee(0x1001)](_0x4760e0),_0x58f5bb++);}_0x58f5bb>0x0&&(_0x49f16d['unreadCount']=(_0x49f16d[_0x1002ee(0x1300)]||0x0)+_0x58f5bb),await _0x6ed281[_0x1002ee(0x1474)][_0x1002ee(0x90c)](_0x49f16d),await _0x2d33eb(),_0x58f5bb>0x0&&_0x2e32a5(_0x49f16d['id'],_0x1002ee(0x9fd)+_0x58f5bb+_0x1002ee(0x528));}catch(_0x383cf1){console[_0x1002ee(0xc3e)](_0x1002ee(0x7bf),_0x383cf1),await _0x104485(_0x1002ee(0xb6c),_0x1002ee(0x1530)+_0x383cf1[_0x1002ee(0x74b)]);}}async function _0x3e0183(){const _0x1f1439=_0x3ce1fb;if(_0x1085af||!_0x36911a)return;_0x1085af=!![];const _0x56828b=document[_0x1f1439(0x948)](_0x1f1439(0x119c)),_0x3d88ba=_0x16699d[_0x1f1439(0x1474)][_0x36911a];if(!_0x3d88ba){_0x1085af=![];return;}_0x2176e3(_0x56828b,_0x1f1439(0x102e));const _0x264f13=_0x56828b[_0x1f1439(0x971)];await new Promise(_0x11496f=>setTimeout(_0x11496f,0x1f4));const _0x4b336f=_0x3d88ba[_0x1f1439(0xb07)][_0x1f1439(0xaf9)],_0x469675=_0x16699d[_0x1f1439(0xf9c)][_0x1f1439(0x59a)]||0x32,_0xf1ba56=_0x4b336f-_0xfbc7f1,_0xdda697=Math[_0x1f1439(0x604)](0x0,_0xf1ba56-_0x469675),_0x288293=_0x3d88ba[_0x1f1439(0xb07)]['slice'](_0xdda697,_0xf1ba56);_0x3c826e(_0x56828b);if(_0x288293['length']===0x0){_0x1085af=![];return;}for(const _0x11e82d of _0x288293[_0x1f1439(0xb26)]()){const _0x42f2e6={..._0x11e82d,'role':_0x11e82d['role']===_0x1f1439(0xaeb)?_0x1f1439(0x14c8):'user'},_0x5d4ad3={'id':_0x1f1439(0x106c),'isGroup':![],'name':_0x3d88ba[_0x1f1439(0x1467)],'settings':{..._0x3d88ba[_0x1f1439(0x7fd)],'myAvatar':_0x3d88ba[_0x1f1439(0x7fd)][_0x1f1439(0x156d)],'myAvatarFrame':_0x3d88ba['settings'][_0x1f1439(0x3b7)],'aiAvatar':_0x3d88ba[_0x1f1439(0x7fd)][_0x1f1439(0xb09)],'aiAvatarFrame':_0x3d88ba[_0x1f1439(0x7fd)]['myAvatarFrame']}},_0x19a30d=await _0x1f8f7b(_0x42f2e6,_0x5d4ad3);_0x19a30d&&_0x56828b['prepend'](_0x19a30d);}_0xfbc7f1+=_0x288293['length'];const _0x51208c=_0x56828b[_0x1f1439(0x971)];_0x56828b[_0x1f1439(0xced)]=_0x51208c-_0x264f13,_0x1085af=![];}async function _0x16fb86(_0x2b96f5){const _0x3a4fa8=_0x3ce1fb,_0x597b22=_0x16699d['chats'][_0x36911a];if(!_0x597b22)return;_0x52fc15=_0x2b96f5===-0x1?_0x3a4fa8(0xf22):_0x597b22[_0x3a4fa8(0xb31)][_0x2b96f5]?.[_0x3a4fa8(0x4ae)];const _0x2e795e=document[_0x3a4fa8(0x948)](_0x3a4fa8(0x119c));_0x2e795e[_0x3a4fa8(0xb6f)]='',_0x2e795e[_0x3a4fa8(0x606)]['theme']=_0x597b22[_0x3a4fa8(0x7fd)][_0x3a4fa8(0x337)]||_0x3a4fa8(0xe46);const _0x444409=document[_0x3a4fa8(0x948)](_0x3a4fa8(0xecd))[_0x3a4fa8(0xd54)][_0x3a4fa8(0x7a0)]('dark-mode');_0x2e795e['style'][_0x3a4fa8(0xdb4)]=_0x444409?_0x3a4fa8(0x38e):'#f0f2f5';let _0x4c33b7,_0x6e5b35=[];const _0x81f199=await _0x6ed281[_0x3a4fa8(0xa59)]['toArray'](),_0x164218=new Map(_0x81f199[_0x3a4fa8(0x8ff)](_0x3c9167=>[_0x3c9167[_0x3a4fa8(0x1467)],_0x3c9167]));if(_0x2b96f5===-0x1){_0x52fc15=_0x3a4fa8(0xf22);const _0x24a202=document[_0x3a4fa8(0x948)](_0x3a4fa8(0x773)),_0x32746b=document[_0x3a4fa8(0x948)](_0x3a4fa8(0x11b8));_0x2e795e[_0x3a4fa8(0xb6f)]='',_0x24a202[_0x3a4fa8(0x10cb)]=_0x597b22[_0x3a4fa8(0x7fd)][_0x3a4fa8(0x1371)]||(_0x16699d[_0x3a4fa8(0x66e)][_0x3a4fa8(0xf4d)]||'我'),_0x32746b[_0x3a4fa8(0x440)]='与\x20'+(_0x597b22[_0x3a4fa8(0x7fd)]['myNickname']||'我')+_0x3a4fa8(0x9ba),_0xfbc7f1=0x0,_0x1085af=![];const _0x21adb0=_0x597b22[_0x3a4fa8(0xb07)],_0x24c14a=_0x16699d[_0x3a4fa8(0xf9c)][_0x3a4fa8(0x59a)]||0x32,_0x35c7e9=_0x21adb0['slice'](-_0x24c14a);_0x4c33b7={'id':_0x3a4fa8(0x106c),'isGroup':![],'name':_0x597b22['name'],'settings':{..._0x597b22['settings'],'myAvatar':_0x597b22[_0x3a4fa8(0x7fd)]['aiAvatar'],'myAvatarFrame':_0x597b22['settings'][_0x3a4fa8(0x3b7)],'aiAvatar':_0x597b22[_0x3a4fa8(0x7fd)]['myAvatar'],'aiAvatarFrame':_0x597b22[_0x3a4fa8(0x7fd)][_0x3a4fa8(0x892)]}},_0x6e5b35=_0x35c7e9[_0x3a4fa8(0x8ff)](_0x3533ec=>({..._0x3533ec,'role':_0x3533ec[_0x3a4fa8(0x1554)]===_0x3a4fa8(0xaeb)?_0x3a4fa8(0x14c8):'user'})),_0xfbc7f1=_0x35c7e9[_0x3a4fa8(0xaf9)];}else{const _0x43362d=_0x597b22[_0x3a4fa8(0xb31)][_0x2b96f5];if(!_0x43362d)return;_0x52fc15=_0x43362d[_0x3a4fa8(0x4ae)];const _0x3776a1=document['getElementById'](_0x3a4fa8(0x773)),_0x224e3b=document[_0x3a4fa8(0x948)](_0x3a4fa8(0x11b8));if(_0x43362d[_0x3a4fa8(0x4ae)]===_0x3a4fa8(0x1403))_0x3776a1['textContent']=_0x43362d[_0x3a4fa8(0x12c2)]+'\x20('+(_0x43362d[_0x3a4fa8(0x112b)][_0x3a4fa8(0xaf9)]+0x1)+')',_0x224e3b[_0x3a4fa8(0x440)]='在\x20'+_0x43362d[_0x3a4fa8(0x12c2)]+_0x3a4fa8(0x13d5),_0x4c33b7={'id':'temp_group_chat','isGroup':!![],'name':_0x43362d['groupName'],'originalName':_0x597b22[_0x3a4fa8(0x628)],'members':_0x43362d[_0x3a4fa8(0x112b)][_0x3a4fa8(0x8ff)](_0x125859=>{const _0x5192db=_0x3a4fa8,_0x5bbba8=_0x164218[_0x5192db(0xe8c)](_0x125859['name']);let _0x142950=_0x5bbba8&&_0x5bbba8[_0x5192db(0x63e)]?_0x5bbba8[_0x5192db(0x63e)]:_0x16699d[_0x5192db(0xf9c)][_0x5192db(0xf46)]?'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x125859[_0x5192db(0x1507)]||_0x5192db(0x3b1)):_0x3ca5ef;return{'originalName':_0x125859[_0x5192db(0x1467)],'groupNickname':_0x125859[_0x5192db(0x1467)],'avatar':_0x142950};}),'settings':{..._0x597b22['settings'],'myNickname':_0x597b22[_0x3a4fa8(0x1467)],'myAvatar':_0x597b22[_0x3a4fa8(0x7fd)][_0x3a4fa8(0x156d)],'myAvatarFrame':_0x597b22['settings'][_0x3a4fa8(0x3b7)]}};else{_0x3776a1[_0x3a4fa8(0x10cb)]=_0x43362d[_0x3a4fa8(0xc15)][_0x3a4fa8(0x1467)],_0x224e3b[_0x3a4fa8(0x440)]='与\x20'+_0x43362d['participant'][_0x3a4fa8(0x1467)]+_0x3a4fa8(0xb75);const _0x5e7d37=_0x164218[_0x3a4fa8(0xe8c)](_0x43362d[_0x3a4fa8(0xc15)][_0x3a4fa8(0x1467)]),_0x23caf3=_0x5e7d37&&_0x5e7d37[_0x3a4fa8(0x63e)]?_0x5e7d37[_0x3a4fa8(0x63e)]:_0x16699d[_0x3a4fa8(0xf9c)][_0x3a4fa8(0xf46)]?_0x3a4fa8(0xbfa)+encodeURIComponent(_0x43362d['participant'][_0x3a4fa8(0x1507)]||'anime\x20person'):_0x3ca5ef;_0x4c33b7={'id':_0x3a4fa8(0x20f),'isGroup':![],'name':_0x43362d[_0x3a4fa8(0xc15)][_0x3a4fa8(0x1467)],'originalName':_0x597b22[_0x3a4fa8(0x628)],'settings':{..._0x597b22[_0x3a4fa8(0x7fd)],'myAvatar':_0x597b22[_0x3a4fa8(0x7fd)][_0x3a4fa8(0x156d)],'myAvatarFrame':_0x597b22['settings']['aiAvatarFrame'],'aiAvatar':_0x23caf3,'aiAvatarFrame':''}};}_0x6e5b35=_0x43362d['messages'];}for(const _0x1b1f43 of _0x6e5b35){let _0x5a35c4=_0x1b1f43[_0x3a4fa8(0x1554)];if(_0x2b96f5!==-0x1){const _0x3f9eb3=_0x1b1f43[_0x3a4fa8(0x2b0)]===(_0x597b22[_0x3a4fa8(0x628)]||_0x597b22[_0x3a4fa8(0x1467)]);_0x5a35c4=_0x3f9eb3?_0x3a4fa8(0xaeb):_0x3a4fa8(0x14c8);}const _0x4f26ed={'role':_0x5a35c4,'senderName':_0x1b1f43[_0x3a4fa8(0x2b0)]||(_0x5a35c4===_0x3a4fa8(0xaeb)?_0x4c33b7['settings'][_0x3a4fa8(0x1371)]:_0x4c33b7[_0x3a4fa8(0x1467)]),'timestamp':_0x1b1f43[_0x3a4fa8(0xb0a)]||Date['now']()+Math[_0x3a4fa8(0x59c)]()};if(_0x1b1f43[_0x3a4fa8(0x4ae)]===_0x3a4fa8(0x10c2)&&_0x1b1f43[_0x3a4fa8(0x14f1)]){const _0x1e0378=_0x16699d[_0x3a4fa8(0x14a2)][_0x3a4fa8(0x1402)](_0x5ab2f0=>_0x5ab2f0[_0x3a4fa8(0x1467)]===_0x1b1f43[_0x3a4fa8(0x14f1)]);_0x1e0378?(_0x4f26ed[_0x3a4fa8(0xede)]=_0x1e0378[_0x3a4fa8(0x9a8)],_0x4f26ed[_0x3a4fa8(0x14f1)]=_0x1b1f43[_0x3a4fa8(0x14f1)],_0x4f26ed['type']=_0x3a4fa8(0x10c2)):(console[_0x3a4fa8(0x9c1)](_0x3a4fa8(0x405)+_0x1b1f43[_0x3a4fa8(0x14f1)]+_0x3a4fa8(0x612)),_0x4f26ed[_0x3a4fa8(0xede)]=_0x3a4fa8(0x828)+_0x1b1f43[_0x3a4fa8(0x14f1)]+']',_0x4f26ed[_0x3a4fa8(0x4ae)]=_0x3a4fa8(0x9ea));}else _0x4f26ed[_0x3a4fa8(0xede)]=_0x1b1f43[_0x3a4fa8(0xede)],_0x4f26ed[_0x3a4fa8(0x4ae)]=_0x1b1f43['type']||_0x3a4fa8(0x9ea);const _0x377423=await _0x1f8f7b(_0x4f26ed,_0x4c33b7);_0x377423&&_0x2e795e['appendChild'](_0x377423);}_0x13f7b4('char-qq-conversation-screen'),setTimeout(()=>_0x2e795e['scrollTop']=_0x2e795e[_0x3a4fa8(0x971)],0x0);}function _0x2841e9(){const _0x30a076=_0x3ce1fb;document[_0x30a076(0x948)](_0x30a076(0x15c3))[_0x30a076(0xd54)]['remove']('visible');}async function _0x4b1c94(){const _0x1c2ac8=_0x3ce1fb;if(!_0x36911a)return;const _0x2ffb62=_0x16699d[_0x1c2ac8(0x1474)][_0x36911a];if(!_0x2ffb62){await _0x104485(_0x1c2ac8(0xb6c),_0x1c2ac8(0x4ea));return;}await _0x104485(_0x1c2ac8(0x960),_0x1c2ac8(0x54b)+_0x2ffb62['name']+_0x1c2ac8(0x5b4));const {proxyUrl:_0x295468,apiKey:_0x18c4d5,model:_0x409bb3}=_0x16699d[_0x1c2ac8(0x79e)];if(!_0x295468||!_0x18c4d5||!_0x409bb3){alert(_0x1c2ac8(0x857));return;}const _0x188427=_0x16699d['qzoneSettings'][_0x1c2ac8(0xf4d)]===_0x1c2ac8(0x1347)||!_0x16699d[_0x1c2ac8(0x66e)]['nickname']?'用户':_0x16699d['qzoneSettings'][_0x1c2ac8(0xf4d)],_0xdf7f99=_0x2ffb62[_0x1c2ac8(0x758)]&&_0x2ffb62[_0x1c2ac8(0x758)][_0x1c2ac8(0xaf9)]>0x0?_0x2ffb62[_0x1c2ac8(0x758)]['map'](_0x26625a=>_0x1c2ac8(0x152b)+_0x31ced1(_0x26625a['timestamp'])+')\x20'+_0x26625a[_0x1c2ac8(0xede)])['join']('\x0a'):'无',_0x3c51eb=_0x2ffb62[_0x1c2ac8(0x7fd)][_0x1c2ac8(0x78a)]||0xa,_0x24692f=_0x2ffb62[_0x1c2ac8(0xb07)][_0x1c2ac8(0x200)](-_0x3c51eb)[_0x1c2ac8(0x8ff)](_0x1de2ea=>(_0x1de2ea['role']===_0x1c2ac8(0xaeb)?_0x188427:_0x2ffb62[_0x1c2ac8(0x1467)])+':\x20'+String(_0x1de2ea[_0x1c2ac8(0xede)])[_0x1c2ac8(0xeca)](0x0,0x1e)+_0x1c2ac8(0x76d))[_0x1c2ac8(0x121a)]('\x0a'),_0xa38cc7=(_0x2ffb62[_0x1c2ac8(0x7fd)]['linkedWorldBookIds']||[])[_0x1c2ac8(0x8ff)](_0x3afb9b=>_0x16699d['worldBooks'][_0x1c2ac8(0x1402)](_0x201792=>_0x201792['id']===_0x3afb9b))[_0x1c2ac8(0x1c0)](Boolean)['map'](_0x34c65e=>'\x0a##\x20世界书《'+_0x34c65e[_0x1c2ac8(0x1467)]+_0x1c2ac8(0x431)+_0x34c65e[_0x1c2ac8(0xede)][_0x1c2ac8(0x1c0)](_0x2e72d9=>_0x2e72d9[_0x1c2ac8(0x111f)])[_0x1c2ac8(0x8ff)](_0x4ccaeb=>'-\x20'+_0x4ccaeb[_0x1c2ac8(0xede)])[_0x1c2ac8(0x121a)]('\x0a'))['join'](''),_0xf22c6e=_0x989347(_0x2ffb62,0x3,'hours'),_0x2d0b3a=_0x989347(_0x2ffb62,0x6,_0x1c2ac8(0x435)),_0x27bd60=_0x989347(_0x2ffb62,0x9,'hours'),_0x12447e=_0x989347(_0x2ffb62,0x1,_0x1c2ac8(0x14df)),_0x4a2b24=_0x989347(_0x2ffb62,0x3,_0x1c2ac8(0x14df)),_0x3984d4=_0x989347(_0x2ffb62,0x7,_0x1c2ac8(0x14df));let _0x3c0c65='';if(_0xf22c6e||_0x2d0b3a||_0x27bd60||_0x12447e||_0x4a2b24||_0x3984d4){_0x3c0c65+=_0x1c2ac8(0x677);if(_0xf22c6e)_0x3c0c65+=_0xf22c6e;if(_0x2d0b3a)_0x3c0c65+=_0x2d0b3a;if(_0x27bd60)_0x3c0c65+=_0x27bd60;if(_0xf22c6e||_0x2d0b3a||_0x27bd60)_0x3c0c65+='\x0a';if(_0x12447e)_0x3c0c65+=_0x12447e;if(_0x4a2b24)_0x3c0c65+=_0x4a2b24;if(_0x3984d4)_0x3c0c65+=_0x3984d4;}const _0x2073cf=_0x1c2ac8(0x4ff)+_0x2ffb62['name']+'”，并根据其人设、记忆和最近的互动，构思出【8到10张】TA最近可能会拍摄或珍藏在手机相册里的照片。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20照片内容必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20照片主题要丰富，可以包括自拍、风景、食物、宠物、朋友合影、工作场景等。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一张照片，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是照片背后的故事或角色的心情日记，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张照片的、详细的【英文】关键词。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20绝对禁止】**:\x20绝对禁止包含任何中文字符、句子、特殊符号、或任何可能涉及敏感（NSFW）、暴力、血腥、政治的内容！也禁止真人！\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20必须是】**:\x20必须是纯英文的、用逗号分隔的【关键词组合】\x20(e.g.,\x20\x221boy,\x20solo,\x20basketball\x20jersey,\x20in\x20locker\x20room,\x20smiling,\x20selfie\x22)。\x0a\x20\x20\x20\x20-\x20**【画风指令】**:\x20在\x20prompt\x20的末尾，总是加上画风指令，例如：\x20`best\x20quality,\x20masterpiece,\x20anime\x20style,\x20cinematic\x20lighting`\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x2ffb62[_0x1c2ac8(0x7fd)][_0x1c2ac8(0x14c1)]+'\x0a'+_0xdf7f99+'\x0a'+_0xa38cc7+'\x0a'+_0x3c0c65+_0x1c2ac8(0xf6d)+_0x188427+_0x1c2ac8(0x372)+_0x24692f+'\x0a\x0a现在，请开始生成这组照片的描述和绘画指令。';try{const _0x52fdb5=[{'role':_0x1c2ac8(0xaeb),'content':_0x1c2ac8(0xd81)}];let _0x3aef3a=_0x295468['includes'](_0x1c2ac8(0x708)),_0x31d58a=_0xe8c788(_0x409bb3,_0x18c4d5,_0x2073cf,_0x52fdb5);const _0x442991=_0x3aef3a?await fetch(_0x31d58a[_0x1c2ac8(0x9a8)],_0x31d58a[_0x1c2ac8(0x92a)]):await fetch(_0x295468+_0x1c2ac8(0x110e),{'method':_0x1c2ac8(0xdca),'headers':{'Content-Type':'application/json','Authorization':_0x1c2ac8(0xb0e)+_0x18c4d5},'body':JSON[_0x1c2ac8(0x526)]({'model':_0x409bb3,'messages':[{'role':_0x1c2ac8(0x11af),'content':_0x2073cf},..._0x52fdb5],'temperature':_0x16699d[_0x1c2ac8(0xf9c)][_0x1c2ac8(0x382)]||0.9})});if(!_0x442991['ok'])throw new Error(_0x1c2ac8(0x69a)+_0x442991[_0x1c2ac8(0x13a2)]);const _0x52e61a=await _0x442991[_0x1c2ac8(0x21d)](),_0x542851=getGeminiResponseText(_0x52e61a),_0x6f5817=_0x542851[_0x1c2ac8(0x9a3)](/(\[[\s\S]*\])/);if(!_0x6f5817||!_0x6f5817[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x542851);const _0x5b596c=_0x6f5817[0x0];let _0xac5b44;try{_0xac5b44=JSON['parse'](_0x5b596c);}catch(_0x3351ac){throw new Error(_0x1c2ac8(0xeaf)+_0x3351ac[_0x1c2ac8(0x74b)]+_0x1c2ac8(0x5b6)+_0x542851);}_0x2ffb62[_0x1c2ac8(0x3ab)]=_0xac5b44,await _0x6ed281['chats'][_0x1c2ac8(0x90c)](_0x2ffb62),await _0xde9310();}catch(_0x455eb4){console['error'](_0x1c2ac8(0xb85),_0x455eb4),await _0x104485(_0x1c2ac8(0x1164),_0x1c2ac8(0x2cb)+_0x455eb4[_0x1c2ac8(0x74b)]);}}async function _0xde9310(){const _0x535a46=_0x3ce1fb,_0xb1a082=document[_0x535a46(0x948)](_0x535a46(0xe7d));_0xb1a082[_0x535a46(0xb6f)]='';if(!_0x36911a)return;const _0x8a9e73=_0x16699d[_0x535a46(0x1474)][_0x36911a],_0x54025c=_0x8a9e73[_0x535a46(0x3ab)]||[];if(_0x54025c['length']===0x0){_0xb1a082[_0x535a46(0xb6f)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>';return;}const _0x28e50d='https://i.postimg.cc/KYr2qRCK/1.jpg';_0x54025c['forEach'](_0x3c55fb=>{const _0xe07c26=_0x535a46,_0xc9c372=document['createElement'](_0xe07c26(0x379));_0xc9c372[_0xe07c26(0x35b)]=_0xe07c26(0x132f),_0xc9c372['dataset'][_0xe07c26(0xe79)]=_0x3c55fb[_0xe07c26(0xe79)],_0xb1a082[_0xe07c26(0x6b6)](_0xc9c372);if(_0x16699d['globalSettings'][_0xe07c26(0xf46)]){_0xc9c372[_0xe07c26(0xf74)][_0xe07c26(0xdb4)]=_0xe07c26(0x147e);const _0x5025d1=/[^\x00-\x7F]/['test'](_0x3c55fb[_0xe07c26(0x5d9)]),_0x4e8854=_0x3c55fb[_0xe07c26(0x5d9)]&&_0x3c55fb['image_prompt']['trim']()&&!_0x5025d1,_0x2695e7=_0x4e8854?_0x3c55fb[_0xe07c26(0x5d9)]:_0xe07c26(0x3fc),_0x486b34=_0xe07c26(0xbfa)+encodeURIComponent(_0x2695e7),_0x4c9e23=new Image();_0x4c9e23[_0xe07c26(0x33a)]=function(){const _0x7ba8ac=_0xe07c26;_0xc9c372[_0x7ba8ac(0xf74)]['backgroundImage']=_0x7ba8ac(0x4f1)+this['src']+')';},_0x4c9e23['onerror']=function(){const _0x141d67=_0xe07c26;_0xc9c372[_0x141d67(0xf74)][_0x141d67(0x618)]='url('+_0x28e50d+')';},_0x4c9e23[_0xe07c26(0x147d)]=_0x486b34;}else{_0xc9c372[_0xe07c26(0xf74)][_0xe07c26(0xdb4)]=_0xe07c26(0xe1a),_0xc9c372['style'][_0xe07c26(0x14a5)]='1px\x20solid\x20#e0e0e0';const _0x19e109=document['createElement']('p');_0x19e109['className']=_0xe07c26(0x126e),_0x19e109['textContent']=_0x3c55fb[_0xe07c26(0xe79)]||_0xe07c26(0x15c9),_0xc9c372[_0xe07c26(0x6b6)](_0x19e109);}});}async function _0x101381(){const _0x268720=_0x3ce1fb;if(!_0x36911a)return;const _0x3f8581=_0x16699d[_0x268720(0x1474)][_0x36911a];if(!_0x3f8581)return;await _0x104485('请稍候...',_0x268720(0x10a4)+_0x3f8581[_0x268720(0x1467)]+_0x268720(0x4e3));const {proxyUrl:_0x54b0d9,apiKey:_0x4e7db,model:_0x4a1628}=_0x16699d[_0x268720(0x79e)];if(!_0x54b0d9||!_0x4e7db||!_0x4a1628){alert(_0x268720(0xa31));return;}const _0x5a1628=_0x16699d[_0x268720(0x66e)][_0x268720(0xf4d)]===_0x268720(0x1347)||!_0x16699d[_0x268720(0x66e)]['nickname']?'用户':_0x16699d['qzoneSettings']['nickname'],_0x4292bd=_0x3f8581[_0x268720(0x758)]&&_0x3f8581['longTermMemory'][_0x268720(0xaf9)]>0x0?_0x3f8581[_0x268720(0x758)][_0x268720(0x8ff)](_0x1492ed=>_0x268720(0x152b)+_0x31ced1(_0x1492ed[_0x268720(0xb0a)])+')\x20'+_0x1492ed['content'])[_0x268720(0x121a)]('\x0a'):'无',_0x1de6b7=_0x3f8581[_0x268720(0x7fd)][_0x268720(0x78a)]||0xa,_0x240606=_0x3f8581['history']['slice'](-_0x1de6b7)[_0x268720(0x8ff)](_0x4c1877=>(_0x4c1877[_0x268720(0x1554)]===_0x268720(0xaeb)?_0x5a1628:_0x3f8581[_0x268720(0x1467)])+':\x20'+String(_0x4c1877[_0x268720(0xede)])['substring'](0x0,0x1e)+'...')[_0x268720(0x121a)]('\x0a'),_0x2f1e2e=(_0x3f8581[_0x268720(0x7fd)][_0x268720(0xeee)]||[])[_0x268720(0x8ff)](_0x5ef08e=>_0x16699d['worldBooks'][_0x268720(0x1402)](_0x3290bd=>_0x3290bd['id']===_0x5ef08e))[_0x268720(0x1c0)](Boolean)['map'](_0x59998b=>'\x0a##\x20世界书《'+_0x59998b[_0x268720(0x1467)]+'》设定:\x0a'+_0x59998b[_0x268720(0xede)][_0x268720(0x1c0)](_0x1b8a32=>_0x1b8a32['enabled'])['map'](_0x1db991=>'-\x20'+_0x1db991[_0x268720(0xede)])[_0x268720(0x121a)]('\x0a'))[_0x268720(0x121a)](''),_0x57e7b5=_0x989347(_0x3f8581,0x3,'hours'),_0x368b2c=_0x989347(_0x3f8581,0x6,_0x268720(0x435)),_0x563acb=_0x989347(_0x3f8581,0x9,_0x268720(0x435)),_0xe74fa4=_0x989347(_0x3f8581,0x1,_0x268720(0x14df)),_0x45d308=_0x989347(_0x3f8581,0x3,'days'),_0xe2cc25=_0x989347(_0x3f8581,0x7,_0x268720(0x14df));let _0x25436e='';if(_0x57e7b5||_0x368b2c||_0x563acb||_0xe74fa4||_0x45d308||_0xe2cc25){_0x25436e+=_0x268720(0x677);if(_0x57e7b5)_0x25436e+=_0x57e7b5;if(_0x368b2c)_0x25436e+=_0x368b2c;if(_0x563acb)_0x25436e+=_0x563acb;if(_0x57e7b5||_0x368b2c||_0x563acb)_0x25436e+='\x0a';if(_0xe74fa4)_0x25436e+=_0xe74fa4;if(_0x45d308)_0x25436e+=_0x45d308;if(_0xe2cc25)_0x25436e+=_0xe2cc25;}const _0x1ff4cf=_0x3f8581['settings'][_0x268720(0x13b6)]||_0x268720(0x572),_0x1dc915=_0x268720(0x4ff)+_0x3f8581[_0x268720(0x1467)]+'”，并根据其人设、记忆和最近的互动，虚构出【10到20条】TA最近的浏览器搜索/浏览记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20记录必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20记录类型要丰富，可以是帖子、文章、新闻、问答等。\x0a3.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都代表一条浏览记录，并且【必须】使用以下格式:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22一个引人注目的文章或搜索标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22url\x22:\x20\x22一个虚构的、看起来很真实的网址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22一篇200-400字的、详细的文章或帖子正文，支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20**【绝对禁止】**:\x20你的回复中【绝对不能】包含\x20\x22type\x22:\x20\x22image\x22\x20的对象。所有记录都必须是文字内容。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x3f8581[_0x268720(0x7fd)][_0x268720(0x14c1)]+_0x268720(0x605)+_0x1ff4cf+'\x0a-\x20**你的长期记忆**:\x0a'+_0x4292bd+'\x0a'+_0x2f1e2e+'\x0a'+_0x25436e+_0x268720(0xf6d)+_0x5a1628+'”的对话摘要**:\x0a'+_0x240606+'\x0a\x0a现在，请开始生成这组【纯文本】的浏览记录。';try{const _0x49c27e=[{'role':_0x268720(0xaeb),'content':_0x268720(0x1085)}];let _0x26eab3=_0x54b0d9[_0x268720(0x1336)](_0x268720(0x708)),_0xeb0579=_0xe8c788(_0x4a1628,_0x4e7db,_0x1dc915,_0x49c27e);const _0x4a9c16=_0x26eab3?await fetch(_0xeb0579[_0x268720(0x9a8)],_0xeb0579[_0x268720(0x92a)]):await fetch(_0x54b0d9+_0x268720(0x110e),{'method':_0x268720(0xdca),'headers':{'Content-Type':_0x268720(0x479),'Authorization':'Bearer\x20'+_0x4e7db},'body':JSON[_0x268720(0x526)]({'model':_0x4a1628,'messages':[{'role':'system','content':_0x1dc915},..._0x49c27e],'temperature':_0x16699d['globalSettings'][_0x268720(0x382)]||0.9})});if(!_0x4a9c16['ok'])throw new Error('API\x20错误:\x20'+_0x4a9c16[_0x268720(0x13a2)]);const _0x41abc1=await _0x4a9c16[_0x268720(0x21d)](),_0x325b29=getGeminiResponseText(_0x41abc1),_0x298145=_0x325b29[_0x268720(0x9a3)](/(\[[\s\S]*\])/);if(!_0x298145||!_0x298145[0x0])throw new Error(_0x268720(0xdf4)+_0x325b29);const _0x1dcbfc=_0x298145[0x0];let _0xe7642;try{_0xe7642=JSON[_0x268720(0xde0)](_0x1dcbfc);}catch(_0x250786){throw new Error('解析AI返回的JSON时出错:\x20'+_0x250786[_0x268720(0x74b)]+'\x0a\x0aAI原始返回内容:\x0a'+_0x325b29);}_0x3f8581[_0x268720(0x866)]=_0xe7642,await _0x6ed281['chats'][_0x268720(0x90c)](_0x3f8581),await _0x39aaa3();}catch(_0x370670){console[_0x268720(0xc3e)](_0x268720(0x42f),_0x370670),await _0x104485('生成失败','无法生成浏览记录，请检查API配置或稍后再试。\x0a错误:\x20'+_0x370670[_0x268720(0x74b)]);}}function _0x39aaa3(){const _0x1df2b3=_0x3ce1fb,_0x231653=document[_0x1df2b3(0x948)](_0x1df2b3(0x9b9));_0x231653[_0x1df2b3(0xb6f)]='';if(!_0x36911a)return;const _0x14fca2=_0x16699d[_0x1df2b3(0x1474)][_0x36911a],_0x195063=_0x14fca2[_0x1df2b3(0x866)]||[];if(_0x195063[_0x1df2b3(0xaf9)]===0x0){_0x231653['innerHTML']=_0x1df2b3(0x1301);return;}_0x195063[_0x1df2b3(0x427)]((_0x1fbc1b,_0x4f8fb7)=>{const _0x5153f7=_0x1df2b3,_0x31fe94=document[_0x5153f7(0x1497)](_0x5153f7(0x379));_0x31fe94['className']=_0x5153f7(0xe24),_0x31fe94[_0x5153f7(0xb6f)]=_0x5153f7(0x10d1)+_0x1fbc1b[_0x5153f7(0xb03)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>'+_0x1fbc1b[_0x5153f7(0x9a8)]+_0x5153f7(0x13aa),_0x31fe94['addEventListener'](_0x5153f7(0x4f6),()=>_0x1bf098(_0x4f8fb7)),_0x231653[_0x5153f7(0x6b6)](_0x31fe94);});}async function _0x1bf098(_0x1af6e7){const _0x4c84c8=_0x3ce1fb,_0x5015c9=_0x16699d[_0x4c84c8(0x1474)][_0x36911a],_0x3eda8b=_0x5015c9['simulatedBrowserHistory'][_0x1af6e7];if(!_0x3eda8b)return;_0x23947b=_0x3eda8b,_0x53b0c2(_0x3eda8b),_0x13f7b4(_0x4c84c8(0x623));const _0x218b51=document[_0x4c84c8(0x948)](_0x4c84c8(0x834)),_0x165432=await _0x6ed281['favorites'][_0x4c84c8(0x1117)]({'type':_0x4c84c8(0x8ea),'content.url':_0x3eda8b['url']})[_0x4c84c8(0x678)]();_0x218b51[_0x4c84c8(0xd54)][_0x4c84c8(0x69d)](_0x4c84c8(0x115e),!!_0x165432);}async function _0x25e1dd(){const _0x562b90=_0x3ce1fb;if(!_0x23947b||!_0x36911a)return;const _0x335857=_0x23947b,_0x2a8536=_0x16699d[_0x562b90(0x1474)][_0x36911a],_0xd07f7e=document[_0x562b90(0x948)](_0x562b90(0x834)),_0x566cce=await _0x6ed281[_0x562b90(0x1dc)][_0x562b90(0x1117)]({'type':_0x562b90(0x8ea),'content.url':_0x335857['url']})[_0x562b90(0x678)]();if(_0x566cce)await _0x6ed281['favorites'][_0x562b90(0x869)](_0x566cce['id']),_0xd07f7e[_0x562b90(0xd54)][_0x562b90(0xf89)](_0x562b90(0x115e)),await _0x104485(_0x562b90(0xb80),_0x562b90(0x1523));else{const _0x2be8cc={'type':'char_browser_article','content':{..._0x335857,'characterId':_0x36911a,'characterName':_0x2a8536[_0x562b90(0x1467)]},'timestamp':Date[_0x562b90(0x1386)]()};await _0x6ed281[_0x562b90(0x1dc)][_0x562b90(0xbd0)](_0x2be8cc),_0xd07f7e[_0x562b90(0xd54)][_0x562b90(0xbd0)](_0x562b90(0x115e)),await _0x104485(_0x562b90(0xb80),_0x562b90(0x8a5));}}function _0x53b0c2(_0xb2edb3){const _0x2fc495=_0x3ce1fb,_0x4d8443=document['getElementById'](_0x2fc495(0x11ef)),_0x5c0959=document['getElementById'](_0x2fc495(0x35c));_0x4d8443[_0x2fc495(0x10cb)]=_0xb2edb3[_0x2fc495(0xb03)],_0x5c0959[_0x2fc495(0xb6f)]='',_0xb2edb3['type']===_0x2fc495(0x608)?_0x5c0959[_0x2fc495(0xb6f)]=_0x2fc495(0x44d)+(_0xb2edb3[_0x2fc495(0xb03)]||_0x2fc495(0x9d0))+_0x2fc495(0x79d):_0x5c0959[_0x2fc495(0xb6f)]=_0x2fc495(0x51b)+(_0xb2edb3[_0x2fc495(0xede)]||_0x2fc495(0x1078))[_0x2fc495(0x14e9)](/\n/g,_0x2fc495(0x70f))+_0x2fc495(0x79d);}async function _0x3c4ea2(){const _0x149c8c=_0x3ce1fb;if(!_0x36911a)return;const _0x252070=_0x16699d[_0x149c8c(0x1474)][_0x36911a];if(!_0x252070)return;await _0x104485(_0x149c8c(0x960),_0x149c8c(0x10a4)+_0x252070[_0x149c8c(0x1467)]+_0x149c8c(0x1424));const {proxyUrl:_0x283360,apiKey:_0x45ce1f,model:_0x268dfd}=_0x16699d[_0x149c8c(0x79e)];if(!_0x283360||!_0x45ce1f||!_0x268dfd){alert(_0x149c8c(0xa31));return;}const _0x1ab2a3=_0x16699d['qzoneSettings'][_0x149c8c(0xf4d)]==='{{user}}'||!_0x16699d[_0x149c8c(0x66e)][_0x149c8c(0xf4d)]?'用户':_0x16699d[_0x149c8c(0x66e)]['nickname'],_0xd475d2=_0x252070[_0x149c8c(0x758)]&&_0x252070[_0x149c8c(0x758)][_0x149c8c(0xaf9)]>0x0?_0x252070[_0x149c8c(0x758)][_0x149c8c(0x8ff)](_0x25e02d=>_0x149c8c(0x152b)+_0x31ced1(_0x25e02d[_0x149c8c(0xb0a)])+')\x20'+_0x25e02d[_0x149c8c(0xede)])[_0x149c8c(0x121a)]('\x0a'):'无',_0x1735e4=_0x252070[_0x149c8c(0x7fd)][_0x149c8c(0x78a)]||0xa,_0x59ee75=_0x252070[_0x149c8c(0xb07)][_0x149c8c(0x200)](-_0x1735e4)[_0x149c8c(0x8ff)](_0x6f23dd=>(_0x6f23dd[_0x149c8c(0x1554)]===_0x149c8c(0xaeb)?_0x1ab2a3:_0x252070[_0x149c8c(0x1467)])+':\x20'+String(_0x6f23dd[_0x149c8c(0xede)])[_0x149c8c(0xeca)](0x0,0x1e)+_0x149c8c(0x76d))[_0x149c8c(0x121a)]('\x0a'),_0x5b384a=(_0x252070[_0x149c8c(0x7fd)][_0x149c8c(0xeee)]||[])[_0x149c8c(0x8ff)](_0x4c8169=>_0x16699d[_0x149c8c(0x44c)][_0x149c8c(0x1402)](_0x1c6487=>_0x1c6487['id']===_0x4c8169))[_0x149c8c(0x1c0)](Boolean)[_0x149c8c(0x8ff)](_0x512470=>'\x0a##\x20世界书《'+_0x512470[_0x149c8c(0x1467)]+_0x149c8c(0x431)+_0x512470[_0x149c8c(0xede)][_0x149c8c(0x1c0)](_0x199738=>_0x199738['enabled'])[_0x149c8c(0x8ff)](_0x2aa05f=>'-\x20'+_0x2aa05f['content'])[_0x149c8c(0x121a)]('\x0a'))[_0x149c8c(0x121a)](''),_0x304424=_0x989347(_0x252070,0x3,_0x149c8c(0x435)),_0x18ddf7=_0x989347(_0x252070,0x6,'hours'),_0x17e374=_0x989347(_0x252070,0x9,'hours'),_0x34a5dc=_0x989347(_0x252070,0x1,_0x149c8c(0x14df)),_0x5a8d70=_0x989347(_0x252070,0x3,_0x149c8c(0x14df)),_0xe919a3=_0x989347(_0x252070,0x7,_0x149c8c(0x14df));let _0x50423f='';if(_0x304424||_0x18ddf7||_0x17e374||_0x34a5dc||_0x5a8d70||_0xe919a3){_0x50423f+=_0x149c8c(0x677);if(_0x304424)_0x50423f+=_0x304424;if(_0x18ddf7)_0x50423f+=_0x18ddf7;if(_0x17e374)_0x50423f+=_0x17e374;if(_0x304424||_0x18ddf7||_0x17e374)_0x50423f+='\x0a';if(_0x34a5dc)_0x50423f+=_0x34a5dc;if(_0x5a8d70)_0x50423f+=_0x5a8d70;if(_0xe919a3)_0x50423f+=_0xe919a3;}const _0x10aca9='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x252070['name']+_0x149c8c(0x1f7)+_0x252070[_0x149c8c(0x7fd)][_0x149c8c(0x14c1)]+_0x149c8c(0x12b3)+_0xd475d2+'\x0a'+_0x5b384a+'\x0a'+_0x50423f+'\x20\x0a-\x20**你最近和“'+_0x1ab2a3+_0x149c8c(0x372)+_0x59ee75+_0x149c8c(0x1d0);try{const _0x7acf4=[{'role':_0x149c8c(0xaeb),'content':_0x149c8c(0xc4a)}];let _0x5abdd5=_0x283360[_0x149c8c(0x1336)](_0x149c8c(0x708)),_0x1d2352=_0xe8c788(_0x268dfd,_0x45ce1f,_0x10aca9,_0x7acf4);const _0x30b763=_0x5abdd5?await fetch(_0x1d2352[_0x149c8c(0x9a8)],_0x1d2352[_0x149c8c(0x92a)]):await fetch(_0x283360+_0x149c8c(0x110e),{'method':_0x149c8c(0xdca),'headers':{'Content-Type':_0x149c8c(0x479),'Authorization':_0x149c8c(0xb0e)+_0x45ce1f},'body':JSON[_0x149c8c(0x526)]({'model':_0x268dfd,'messages':[{'role':_0x149c8c(0x11af),'content':_0x10aca9},..._0x7acf4],'temperature':_0x16699d['globalSettings'][_0x149c8c(0x382)]||0.9})});if(!_0x30b763['ok'])throw new Error(_0x149c8c(0x69a)+_0x30b763[_0x149c8c(0x13a2)]);const _0xe4def9=await _0x30b763['json'](),_0x4c866a=getGeminiResponseText(_0xe4def9),_0x43413e=_0x4c866a[_0x149c8c(0x9a3)](/({[\s\S]*})/);if(!_0x43413e)throw new Error(_0x149c8c(0xaaf));const _0x496c3f=JSON['parse'](_0x43413e[0x0]);!_0x496c3f[_0x149c8c(0xe65)]&&(_0x496c3f['purchases']=[]),_0x252070[_0x149c8c(0xce5)]=_0x496c3f,await _0x6ed281[_0x149c8c(0x1474)][_0x149c8c(0x90c)](_0x252070),await _0x1d076f();}catch(_0x1b6910){console[_0x149c8c(0xc3e)](_0x149c8c(0xc95),_0x1b6910),await _0x104485(_0x149c8c(0x1164),_0x149c8c(0xe13)+_0x1b6910['message']);}}function _0x33ba37(){const _0x2a5fc7=_0x3ce1fb;_0x142531(),_0x13f7b4(_0x2a5fc7(0x1172));}function _0x142531(){const _0x279c71=_0x3ce1fb,_0x4efeee=document[_0x279c71(0x948)](_0x279c71(0x7ea));_0x4efeee['innerHTML']='';const _0x150d15=_0x16699d[_0x279c71(0x1474)][_0x36911a],_0x3fc9e1=_0x150d15[_0x279c71(0xce5)]||{},_0x3057c6=_0x3fc9e1[_0x279c71(0xe65)]||[],_0x1ffc72=_0x3fc9e1[_0x279c71(0x7d0)]||0x0,_0x412d69=document['createElement'](_0x279c71(0x379));_0x412d69['style'][_0x279c71(0x8e7)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.06);\x0a\x20\x20\x20\x20',_0x412d69[_0x279c71(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22color:\x20#8a8a8a;\x20margin:\x200\x200\x2010px\x200;\x22>账户余额</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2032px;\x20font-weight:\x20600;\x20color:\x20#1f1f1f;\x20margin:\x200;\x22>¥'+_0x1ffc72[_0x279c71(0xd69)](0x2)+_0x279c71(0x771),_0x4efeee['appendChild'](_0x412d69);const _0x52bde5=document['createElement']('h3');_0x52bde5[_0x279c71(0x10cb)]=_0x279c71(0xa22),_0x52bde5['style'][_0x279c71(0x8e7)]=_0x279c71(0x1221),_0x4efeee[_0x279c71(0x6b6)](_0x52bde5);if(_0x3057c6[_0x279c71(0xaf9)]===0x0){_0x4efeee[_0x279c71(0xb6f)]+=_0x279c71(0x1487);return;}_0x3057c6[_0x279c71(0x427)](_0x51e561=>{const _0x326fc5=_0x279c71,_0x34d7b6=document[_0x326fc5(0x1497)]('div');_0x34d7b6[_0x326fc5(0xf74)][_0x326fc5(0x8e7)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20space-between;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2015px\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20#f0f0f0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x34d7b6[_0x326fc5(0xb6f)]=_0x326fc5(0x6e4)+_0x51e561['itemName']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin:\x200;\x22>'+_0x51e561[_0x326fc5(0x82c)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-weight:\x20600;\x20font-size:\x2016px;\x20color:\x20#ff5722;\x22>-\x20¥'+(_0x51e561[_0x326fc5(0xa6a)]||0x0)[_0x326fc5(0xd69)](0x2)+_0x326fc5(0x13aa),_0x4efeee['appendChild'](_0x34d7b6);});}async function _0x4dbf02(){const _0x2ecf4f=_0x3ce1fb;if(!_0x36911a)return;const _0x57157d=_0x16699d[_0x2ecf4f(0x1474)][_0x36911a];if(!_0x57157d)return;await _0x104485(_0x2ecf4f(0x960),_0x2ecf4f(0x54b)+_0x57157d[_0x2ecf4f(0x1467)]+_0x2ecf4f(0x9de));const {proxyUrl:_0xd7f7fb,apiKey:_0x3b42ff,model:_0x59f619}=_0x16699d[_0x2ecf4f(0x79e)];if(!_0xd7f7fb||!_0x3b42ff||!_0x59f619){alert(_0x2ecf4f(0x857));return;}const _0x35c7e1=_0x16699d[_0x2ecf4f(0x66e)][_0x2ecf4f(0xf4d)]===_0x2ecf4f(0x1347)||!_0x16699d[_0x2ecf4f(0x66e)]['nickname']?'用户':_0x16699d[_0x2ecf4f(0x66e)][_0x2ecf4f(0xf4d)],_0x488b20=_0x57157d[_0x2ecf4f(0x758)]&&_0x57157d[_0x2ecf4f(0x758)][_0x2ecf4f(0xaf9)]>0x0?_0x57157d['longTermMemory'][_0x2ecf4f(0x8ff)](_0x516dd=>_0x2ecf4f(0x152b)+_0x31ced1(_0x516dd[_0x2ecf4f(0xb0a)])+')\x20'+_0x516dd['content'])[_0x2ecf4f(0x121a)]('\x0a'):'无',_0x5e67f1=_0x57157d[_0x2ecf4f(0x7fd)][_0x2ecf4f(0x78a)]||0xa,_0x3160e6=_0x57157d[_0x2ecf4f(0xb07)][_0x2ecf4f(0x200)](-_0x5e67f1)['map'](_0x3841c4=>(_0x3841c4[_0x2ecf4f(0x1554)]===_0x2ecf4f(0xaeb)?_0x35c7e1:_0x57157d[_0x2ecf4f(0x1467)])+':\x20'+String(_0x3841c4[_0x2ecf4f(0xede)])[_0x2ecf4f(0xeca)](0x0,0x1e)+_0x2ecf4f(0x76d))[_0x2ecf4f(0x121a)]('\x0a'),_0x2ca1ae=(_0x57157d[_0x2ecf4f(0x7fd)][_0x2ecf4f(0xeee)]||[])['map'](_0x466085=>_0x16699d[_0x2ecf4f(0x44c)]['find'](_0xf4714b=>_0xf4714b['id']===_0x466085))[_0x2ecf4f(0x1c0)](Boolean)[_0x2ecf4f(0x8ff)](_0x1397fa=>_0x2ecf4f(0x4d3)+_0x1397fa[_0x2ecf4f(0x1467)]+_0x2ecf4f(0x431)+_0x1397fa[_0x2ecf4f(0xede)][_0x2ecf4f(0x1c0)](_0x400e04=>_0x400e04[_0x2ecf4f(0x111f)])[_0x2ecf4f(0x8ff)](_0x1123b3=>'-\x20'+_0x1123b3[_0x2ecf4f(0xede)])[_0x2ecf4f(0x121a)]('\x0a'))[_0x2ecf4f(0x121a)](''),_0x57a063=_0x989347(_0x57157d,0x3,'hours'),_0x367102=_0x989347(_0x57157d,0x6,'hours'),_0x440dba=_0x989347(_0x57157d,0x9,'hours'),_0x19ea8d=_0x989347(_0x57157d,0x1,_0x2ecf4f(0x14df)),_0x29a42a=_0x989347(_0x57157d,0x3,_0x2ecf4f(0x14df)),_0x551e67=_0x989347(_0x57157d,0x7,_0x2ecf4f(0x14df));let _0x21ab6f='';if(_0x57a063||_0x367102||_0x440dba||_0x19ea8d||_0x29a42a||_0x551e67){_0x21ab6f+=_0x2ecf4f(0x677);if(_0x57a063)_0x21ab6f+=_0x57a063;if(_0x367102)_0x21ab6f+=_0x367102;if(_0x440dba)_0x21ab6f+=_0x440dba;if(_0x57a063||_0x367102||_0x440dba)_0x21ab6f+='\x0a';if(_0x19ea8d)_0x21ab6f+=_0x19ea8d;if(_0x29a42a)_0x21ab6f+=_0x29a42a;if(_0x551e67)_0x21ab6f+=_0x551e67;}const _0x3311b7=_0x57157d[_0x2ecf4f(0x7fd)][_0x2ecf4f(0x13b6)]||_0x2ecf4f(0x572),_0x28f3e5=_0x2ecf4f(0x4ff)+_0x57157d['name']+_0x2ecf4f(0xbee)+_0x57157d['settings'][_0x2ecf4f(0x14c1)]+_0x2ecf4f(0x605)+_0x3311b7+_0x2ecf4f(0x12b3)+_0x488b20+'\x0a'+_0x2ca1ae+'\x0a'+_0x21ab6f+_0x2ecf4f(0x5af)+_0x35c7e1+_0x2ecf4f(0x372)+_0x3160e6+_0x2ecf4f(0x1548);try{const _0x336ce4=[{'role':_0x2ecf4f(0xaeb),'content':'请根据你的设定，生成你的备忘录内容。'}];let _0x4835b0=_0xd7f7fb[_0x2ecf4f(0x1336)]('generativelanguage'),_0x5d668f=_0xe8c788(_0x59f619,_0x3b42ff,_0x28f3e5,_0x336ce4);const _0x552b60=_0x4835b0?await fetch(_0x5d668f[_0x2ecf4f(0x9a8)],_0x5d668f[_0x2ecf4f(0x92a)]):await fetch(_0xd7f7fb+_0x2ecf4f(0x110e),{'method':'POST','headers':{'Content-Type':_0x2ecf4f(0x479),'Authorization':_0x2ecf4f(0xb0e)+_0x3b42ff},'body':JSON[_0x2ecf4f(0x526)]({'model':_0x59f619,'messages':[{'role':_0x2ecf4f(0x11af),'content':_0x28f3e5},..._0x336ce4],'temperature':_0x16699d['globalSettings'][_0x2ecf4f(0x382)]||0.9})});if(!_0x552b60['ok']){const _0x4539bf=await _0x552b60[_0x2ecf4f(0x21d)]()[_0x2ecf4f(0x1061)](()=>null),_0xeedac7=_0x4539bf?.[_0x2ecf4f(0xc3e)]?.[_0x2ecf4f(0x74b)]||_0x552b60[_0x2ecf4f(0x13a2)];throw new Error(_0x2ecf4f(0x69a)+_0x552b60[_0x2ecf4f(0x82c)]+_0x2ecf4f(0x1182)+_0xeedac7);}const _0x4da3a4=await _0x552b60[_0x2ecf4f(0x21d)](),_0x5700dd=getGeminiResponseText(_0x4da3a4),_0x4110f0=_0x5700dd[_0x2ecf4f(0x9a3)](/(\[[\s\S]*\])/);if(!_0x4110f0||!_0x4110f0[0x0])throw new Error(_0x2ecf4f(0xdf4)+_0x5700dd);const _0x121dfe=_0x4110f0[0x0];let _0x43b235;try{_0x43b235=JSON[_0x2ecf4f(0xde0)](_0x121dfe);}catch(_0x742f88){throw new Error('解析AI返回的JSON时出错:\x20'+_0x742f88[_0x2ecf4f(0x74b)]+_0x2ecf4f(0x5b6)+_0x5700dd);}if(!Array[_0x2ecf4f(0x1524)](_0x43b235))throw new Error(_0x2ecf4f(0x15bb)+JSON[_0x2ecf4f(0x526)](_0x43b235));_0x57157d[_0x2ecf4f(0x1223)]=_0x43b235[_0x2ecf4f(0x8ff)](_0x1d2740=>({'id':Date['now']()+Math[_0x2ecf4f(0x59c)](),'title':_0x1d2740['title'],'content':_0x1d2740['content']})),await _0x6ed281[_0x2ecf4f(0x1474)][_0x2ecf4f(0x90c)](_0x57157d),await _0x140dc7();}catch(_0x5cfb9e){console[_0x2ecf4f(0xc3e)](_0x2ecf4f(0x38c),_0x5cfb9e),await _0x104485(_0x2ecf4f(0x1164),_0x2ecf4f(0x14b2)+_0x5cfb9e[_0x2ecf4f(0x74b)]);}}async function _0x110d0c(){const _0x3a45ef=_0x3ce1fb;if(!_0x36911a)return;const _0x16ff2b=_0x16699d['chats'][_0x36911a];if(!_0x16ff2b)return;await _0x104485('请稍候...',_0x3a45ef(0x158e)+_0x16ff2b[_0x3a45ef(0x1467)]+'”的出行足迹...');const {proxyUrl:_0x5918b1,apiKey:_0x3c484f,model:_0x4d575c}=_0x16699d[_0x3a45ef(0x79e)];if(!_0x5918b1||!_0x3c484f||!_0x4d575c){alert(_0x3a45ef(0xa31));return;}const _0x2866e8=_0x16699d[_0x3a45ef(0x66e)][_0x3a45ef(0xf4d)]===_0x3a45ef(0x1347)||!_0x16699d['qzoneSettings'][_0x3a45ef(0xf4d)]?'用户':_0x16699d[_0x3a45ef(0x66e)][_0x3a45ef(0xf4d)],_0x24b7a5=_0x16ff2b[_0x3a45ef(0x758)]&&_0x16ff2b[_0x3a45ef(0x758)][_0x3a45ef(0xaf9)]>0x0?_0x16ff2b[_0x3a45ef(0x758)][_0x3a45ef(0x8ff)](_0x29c84c=>'-\x20(记录于\x20'+_0x31ced1(_0x29c84c[_0x3a45ef(0xb0a)])+')\x20'+_0x29c84c[_0x3a45ef(0xede)])['join']('\x0a'):'无',_0x4f40ca=_0x16ff2b[_0x3a45ef(0x7fd)][_0x3a45ef(0x78a)]||0xa,_0x30195a=_0x16ff2b['history'][_0x3a45ef(0x200)](-_0x4f40ca)[_0x3a45ef(0x8ff)](_0x1a5e0e=>(_0x1a5e0e['role']===_0x3a45ef(0xaeb)?_0x2866e8:_0x16ff2b[_0x3a45ef(0x1467)])+':\x20'+String(_0x1a5e0e[_0x3a45ef(0xede)])['substring'](0x0,0x1e)+'...')['join']('\x0a'),_0x509e0b=(_0x16ff2b['settings'][_0x3a45ef(0xeee)]||[])[_0x3a45ef(0x8ff)](_0x52777e=>_0x16699d[_0x3a45ef(0x44c)]['find'](_0x461216=>_0x461216['id']===_0x52777e))['filter'](Boolean)[_0x3a45ef(0x8ff)](_0x1b5a62=>_0x3a45ef(0x4d3)+_0x1b5a62['name']+_0x3a45ef(0x431)+_0x1b5a62[_0x3a45ef(0xede)]['filter'](_0x2471ac=>_0x2471ac[_0x3a45ef(0x111f)])['map'](_0x1add05=>'-\x20'+_0x1add05[_0x3a45ef(0xede)])[_0x3a45ef(0x121a)]('\x0a'))[_0x3a45ef(0x121a)](''),_0x1b290f=_0x989347(_0x16ff2b,0x3,'hours'),_0x14d3f5=_0x989347(_0x16ff2b,0x6,_0x3a45ef(0x435)),_0x27cc4f=_0x989347(_0x16ff2b,0x9,_0x3a45ef(0x435)),_0x3f112d=_0x989347(_0x16ff2b,0x1,'days'),_0x19ea08=_0x989347(_0x16ff2b,0x3,_0x3a45ef(0x14df)),_0x486cf1=_0x989347(_0x16ff2b,0x7,_0x3a45ef(0x14df));let _0x167b03='';if(_0x1b290f||_0x14d3f5||_0x27cc4f||_0x3f112d||_0x19ea08||_0x486cf1){_0x167b03+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x1b290f)_0x167b03+=_0x1b290f;if(_0x14d3f5)_0x167b03+=_0x14d3f5;if(_0x27cc4f)_0x167b03+=_0x27cc4f;if(_0x1b290f||_0x14d3f5||_0x27cc4f)_0x167b03+='\x0a';if(_0x3f112d)_0x167b03+=_0x3f112d;if(_0x19ea08)_0x167b03+=_0x19ea08;if(_0x486cf1)_0x167b03+=_0x486cf1;}const _0x4f2718=_0x3a45ef(0x4ff)+_0x16ff2b['name']+_0x3a45ef(0x19d)+new Date()[_0x3a45ef(0x5ac)]()+_0x3a45ef(0x1161)+_0x16ff2b[_0x3a45ef(0x7fd)][_0x3a45ef(0x14c1)]+_0x3a45ef(0x12b3)+_0x24b7a5+'\x0a'+_0x509e0b+'\x0a'+_0x167b03+'\x0a-\x20**你最近和“'+_0x2866e8+_0x3a45ef(0x372)+_0x30195a+_0x3a45ef(0x1414);try{const _0x58f8ba=[{'role':'user','content':_0x3a45ef(0x1139)}];let _0x5d403f=_0x5918b1[_0x3a45ef(0x1336)](_0x3a45ef(0x708)),_0x5c104e=_0xe8c788(_0x4d575c,_0x3c484f,_0x4f2718,_0x58f8ba);const _0x50a710=_0x5d403f?await fetch(_0x5c104e[_0x3a45ef(0x9a8)],_0x5c104e[_0x3a45ef(0x92a)]):await fetch(_0x5918b1+_0x3a45ef(0x110e),{'method':_0x3a45ef(0xdca),'headers':{'Content-Type':_0x3a45ef(0x479),'Authorization':_0x3a45ef(0xb0e)+_0x3c484f},'body':JSON[_0x3a45ef(0x526)]({'model':_0x4d575c,'messages':[{'role':'system','content':_0x4f2718},..._0x58f8ba],'temperature':_0x16699d['globalSettings'][_0x3a45ef(0x382)]||0.9})});if(!_0x50a710['ok'])throw new Error(_0x3a45ef(0x69a)+_0x50a710[_0x3a45ef(0x13a2)]);const _0x235184=await _0x50a710[_0x3a45ef(0x21d)](),_0x5a8db4=getGeminiResponseText(_0x235184),_0x2eac59=_0x5a8db4['match'](/(\[[\s\S]*\])/);if(!_0x2eac59||!_0x2eac59[0x0])throw new Error(_0x3a45ef(0xdf4)+_0x5a8db4);const _0x400b21=_0x2eac59[0x0];let _0x13a164;try{_0x13a164=JSON[_0x3a45ef(0xde0)](_0x400b21);}catch(_0x3ba0a0){throw new Error(_0x3a45ef(0xeaf)+_0x3ba0a0[_0x3a45ef(0x74b)]+_0x3a45ef(0x5b6)+_0x5a8db4);}_0x16ff2b[_0x3a45ef(0x1bb)]=_0x13a164,await _0x6ed281[_0x3a45ef(0x1474)]['put'](_0x16ff2b),await _0x4e898b();}catch(_0xadc2e3){console[_0x3a45ef(0xc3e)](_0x3a45ef(0x2d9),_0xadc2e3),await _0x104485('生成失败','无法生成足迹，请检查API配置或稍后再试。\x0a错误:\x20'+_0xadc2e3[_0x3a45ef(0x74b)]);}}function _0x4e898b(){const _0x25a724=_0x3ce1fb,_0x357c03=document[_0x25a724(0x948)](_0x25a724(0x12bf));_0x357c03['innerHTML']='';if(!_0x36911a)return;const _0x5c995c=_0x16699d[_0x25a724(0x1474)][_0x36911a],_0xab7f8e=_0x5c995c[_0x25a724(0x1bb)]||[];if(_0xab7f8e[_0x25a724(0xaf9)]===0x0){_0x357c03[_0x25a724(0xb6f)]=_0x25a724(0x13be);return;}_0xab7f8e[_0x25a724(0x427)](_0x59e0d6=>{const _0xb7b1d6=_0x25a724,_0x4bf89a=document['createElement'](_0xb7b1d6(0x379));_0x4bf89a['className']=_0xb7b1d6(0x1210);let _0x4219ca='';if(_0x59e0d6[_0xb7b1d6(0x5d9)]){const _0x511833=_0xb7b1d6(0xbfa)+encodeURIComponent(_0x59e0d6[_0xb7b1d6(0x5d9)]);_0x4219ca=_0xb7b1d6(0x7e9)+_0x511833+_0xb7b1d6(0x92b)+_0x59e0d6[_0xb7b1d6(0x282)]+_0xb7b1d6(0x6b5);}const _0x55f318=_0x59e0d6[_0xb7b1d6(0xb0a)]?_0x31ced1(new Date(_0x59e0d6[_0xb7b1d6(0xb0a)])[_0xb7b1d6(0x120b)]()):_0xb7b1d6(0x1486);_0x4bf89a[_0xb7b1d6(0xb6f)]=_0xb7b1d6(0x7b7)+_0x59e0d6['locationName']+_0xb7b1d6(0x47d)+_0x59e0d6[_0xb7b1d6(0x871)]+_0xb7b1d6(0x8c5)+_0x59e0d6[_0xb7b1d6(0x282)][_0xb7b1d6(0x14e9)](/\n/g,_0xb7b1d6(0x1121))+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x4219ca+_0xb7b1d6(0xe5b)+_0x55f318+_0xb7b1d6(0xc9f),_0x357c03[_0xb7b1d6(0x6b6)](_0x4bf89a);});}async function _0x3a1a97(){const _0x162f48=_0x3ce1fb;if(!_0x36911a)return;const _0x2b07bf=_0x16699d['chats'][_0x36911a];if(!_0x2b07bf)return;await _0x104485('请稍候...',_0x162f48(0xa2c)+_0x2b07bf[_0x162f48(0x1467)]+_0x162f48(0xe60));const {proxyUrl:_0x1e74d7,apiKey:_0x124cdf,model:_0x49841a}=_0x16699d[_0x162f48(0x79e)];if(!_0x1e74d7||!_0x124cdf||!_0x49841a){alert(_0x162f48(0xa31));return;}const _0x2de605=_0x16699d['qzoneSettings'][_0x162f48(0xf4d)]===_0x162f48(0x1347)||!_0x16699d[_0x162f48(0x66e)][_0x162f48(0xf4d)]?'用户':_0x16699d[_0x162f48(0x66e)][_0x162f48(0xf4d)],_0x25c792=_0x2b07bf['longTermMemory']&&_0x2b07bf[_0x162f48(0x758)]['length']>0x0?_0x2b07bf[_0x162f48(0x758)]['map'](_0x352e90=>_0x162f48(0x152b)+_0x31ced1(_0x352e90['timestamp'])+')\x20'+_0x352e90[_0x162f48(0xede)])[_0x162f48(0x121a)]('\x0a'):'无',_0x143516=_0x2b07bf[_0x162f48(0x7fd)][_0x162f48(0x78a)]||0xa,_0x458c42=_0x2b07bf[_0x162f48(0xb07)][_0x162f48(0x200)](-_0x143516)[_0x162f48(0x8ff)](_0x35f70e=>(_0x35f70e[_0x162f48(0x1554)]===_0x162f48(0xaeb)?_0x2de605:_0x2b07bf[_0x162f48(0x1467)])+':\x20'+String(_0x35f70e[_0x162f48(0xede)])[_0x162f48(0xeca)](0x0,0x1e)+'...')[_0x162f48(0x121a)]('\x0a'),_0x32d642=(_0x2b07bf[_0x162f48(0x7fd)][_0x162f48(0xeee)]||[])[_0x162f48(0x8ff)](_0x541987=>_0x16699d[_0x162f48(0x44c)][_0x162f48(0x1402)](_0x46c470=>_0x46c470['id']===_0x541987))['filter'](Boolean)['map'](_0x104ed6=>_0x162f48(0x4d3)+_0x104ed6[_0x162f48(0x1467)]+_0x162f48(0x431)+_0x104ed6['content'][_0x162f48(0x1c0)](_0xbf7fb8=>_0xbf7fb8[_0x162f48(0x111f)])[_0x162f48(0x8ff)](_0x418f88=>'-\x20'+_0x418f88[_0x162f48(0xede)])[_0x162f48(0x121a)]('\x0a'))[_0x162f48(0x121a)](''),_0x2283a5=_0x989347(_0x2b07bf,0x3,_0x162f48(0x435)),_0x54411d=_0x989347(_0x2b07bf,0x6,_0x162f48(0x435)),_0x246d3a=_0x989347(_0x2b07bf,0x9,_0x162f48(0x435)),_0x4994c3=_0x989347(_0x2b07bf,0x1,_0x162f48(0x14df)),_0x3719ca=_0x989347(_0x2b07bf,0x3,'days'),_0x11add7=_0x989347(_0x2b07bf,0x7,'days');let _0x2d5100='';if(_0x2283a5||_0x54411d||_0x246d3a||_0x4994c3||_0x3719ca||_0x11add7){_0x2d5100+=_0x162f48(0x677);if(_0x2283a5)_0x2d5100+=_0x2283a5;if(_0x54411d)_0x2d5100+=_0x54411d;if(_0x246d3a)_0x2d5100+=_0x246d3a;if(_0x2283a5||_0x54411d||_0x246d3a)_0x2d5100+='\x0a';if(_0x4994c3)_0x2d5100+=_0x4994c3;if(_0x3719ca)_0x2d5100+=_0x3719ca;if(_0x11add7)_0x2d5100+=_0x11add7;}const _0xfb76a=_0x162f48(0x4ff)+_0x2b07bf['name']+_0x162f48(0xf1b)+_0x2b07bf[_0x162f48(0x7fd)][_0x162f48(0x14c1)]+_0x162f48(0x12b3)+_0x25c792+'\x0a'+_0x32d642+'\x0a'+_0x2d5100+_0x162f48(0x5af)+_0x2de605+_0x162f48(0x372)+_0x458c42+'\x0a\x0a现在，请开始生成这组App使用记录。';try{const _0x24431a=[{'role':'user','content':_0x162f48(0x46d)}];let _0x3f649d=_0x1e74d7['includes'](_0x162f48(0x708)),_0x578fe2=_0xe8c788(_0x49841a,_0x124cdf,_0xfb76a,_0x24431a);const _0x7c3cf6=_0x3f649d?await fetch(_0x578fe2[_0x162f48(0x9a8)],_0x578fe2[_0x162f48(0x92a)]):await fetch(_0x1e74d7+_0x162f48(0x110e),{'method':'POST','headers':{'Content-Type':_0x162f48(0x479),'Authorization':_0x162f48(0xb0e)+_0x124cdf},'body':JSON[_0x162f48(0x526)]({'model':_0x49841a,'messages':[{'role':_0x162f48(0x11af),'content':_0xfb76a},..._0x24431a],'temperature':_0x16699d[_0x162f48(0xf9c)][_0x162f48(0x382)]||0.9})});if(!_0x7c3cf6['ok'])throw new Error('API\x20错误:\x20'+_0x7c3cf6[_0x162f48(0x13a2)]);const _0x4452ac=await _0x7c3cf6[_0x162f48(0x21d)](),_0x1efbf6=getGeminiResponseText(_0x4452ac),_0x47da25=_0x1efbf6[_0x162f48(0x14e9)](/^```json\s*/,'')[_0x162f48(0x14e9)](/```$/,''),_0x4fb701=JSON['parse'](_0x47da25);_0x2b07bf[_0x162f48(0x141e)]=_0x4fb701,await _0x6ed281[_0x162f48(0x1474)][_0x162f48(0x90c)](_0x2b07bf),await _0x7e279();}catch(_0x5a2806){console[_0x162f48(0xc3e)](_0x162f48(0x3d8),_0x5a2806),await _0x104485('生成失败',_0x162f48(0xae9)+_0x5a2806['message']);}}function _0x7e279(){const _0x4736e8=_0x3ce1fb,_0x4c55ff=document[_0x4736e8(0x948)](_0x4736e8(0x118d));_0x4c55ff['innerHTML']='';if(!_0x36911a)return;const _0x16f4ef=_0x16699d[_0x4736e8(0x1474)][_0x36911a],_0x1f37d3=(_0x16f4ef[_0x4736e8(0x141e)]||[])[_0x4736e8(0xe96)]((_0x5f19b4,_0x4975fa)=>_0x4975fa['usageTimeMinutes']-_0x5f19b4['usageTimeMinutes']);if(_0x1f37d3[_0x4736e8(0xaf9)]===0x0){_0x4c55ff[_0x4736e8(0xb6f)]=_0x4736e8(0xb77);return;}_0x1f37d3[_0x4736e8(0x427)](_0x20527e=>{const _0x2186fb=_0x4736e8,_0x3e4c95=document[_0x2186fb(0x1497)]('div');_0x3e4c95[_0x2186fb(0x35b)]=_0x2186fb(0x757);const _0x4f11a7=Math[_0x2186fb(0x15b6)](_0x20527e['usageTimeMinutes']/0x3c),_0x565471=_0x20527e[_0x2186fb(0x1f4)]%0x3c;let _0x47e16f='';if(_0x4f11a7>0x0)_0x47e16f+=_0x4f11a7+'小时';if(_0x565471>0x0)_0x47e16f+=_0x565471+'分钟';if(!_0x47e16f)_0x47e16f=_0x2186fb(0x14b7);const _0xf04edb=_0x20527e[_0x2186fb(0x5d9)]||_0x2186fb(0x288)+_0x20527e[_0x2186fb(0x249)]+_0x2186fb(0xedd),_0x46fad9=_0x2186fb(0xbfa)+encodeURIComponent(_0xf04edb);_0x3e4c95[_0x2186fb(0xb6f)]=_0x2186fb(0xe37)+_0x46fad9+_0x2186fb(0xc4d)+_0x20527e[_0x2186fb(0x249)]+_0x2186fb(0x12ff)+_0x20527e[_0x2186fb(0x6cd)]+_0x2186fb(0x1053)+_0x47e16f+_0x2186fb(0xc9f),_0x4c55ff['appendChild'](_0x3e4c95);});}async function _0x3b43fe(){const _0x1a0ea7=_0x3ce1fb;if(!_0x36911a)return;const _0x2a62e0=_0x16699d[_0x1a0ea7(0x1474)][_0x36911a];if(!_0x2a62e0)return;await _0x104485('请稍候...',_0x1a0ea7(0x54b)+_0x2a62e0[_0x1a0ea7(0x1467)]+'”分享TA的私人歌单...');const {proxyUrl:_0x5ce2b4,apiKey:_0x459d40,model:_0x5186ac}=_0x16699d[_0x1a0ea7(0x79e)];if(!_0x5ce2b4||!_0x459d40||!_0x5186ac){alert(_0x1a0ea7(0x857));return;}const _0x45439d=_0x16699d[_0x1a0ea7(0x66e)]['nickname']===_0x1a0ea7(0x1347)||!_0x16699d['qzoneSettings'][_0x1a0ea7(0xf4d)]?'用户':_0x16699d[_0x1a0ea7(0x66e)][_0x1a0ea7(0xf4d)],_0x487c3b=_0x2a62e0['longTermMemory']&&_0x2a62e0[_0x1a0ea7(0x758)][_0x1a0ea7(0xaf9)]>0x0?_0x2a62e0[_0x1a0ea7(0x758)]['map'](_0x41fc19=>_0x1a0ea7(0x152b)+_0x31ced1(_0x41fc19[_0x1a0ea7(0xb0a)])+')\x20'+_0x41fc19[_0x1a0ea7(0xede)])[_0x1a0ea7(0x121a)]('\x0a'):'无',_0x32ece2=_0x2a62e0['settings'][_0x1a0ea7(0x78a)]||0xa,_0x2bf433=_0x2a62e0['history']['slice'](-_0x32ece2)[_0x1a0ea7(0x8ff)](_0x3f66cd=>(_0x3f66cd[_0x1a0ea7(0x1554)]===_0x1a0ea7(0xaeb)?_0x45439d:_0x2a62e0[_0x1a0ea7(0x1467)])+':\x20'+String(_0x3f66cd[_0x1a0ea7(0xede)])[_0x1a0ea7(0xeca)](0x0,0x1e)+_0x1a0ea7(0x76d))[_0x1a0ea7(0x121a)]('\x0a'),_0x407cc7=(_0x2a62e0[_0x1a0ea7(0x7fd)]['linkedWorldBookIds']||[])['map'](_0x5f3870=>_0x16699d['worldBooks'][_0x1a0ea7(0x1402)](_0x2cfd75=>_0x2cfd75['id']===_0x5f3870))['filter'](Boolean)['map'](_0x3f5dc6=>'\x0a##\x20世界书《'+_0x3f5dc6[_0x1a0ea7(0x1467)]+'》设定:\x0a'+_0x3f5dc6[_0x1a0ea7(0xede)][_0x1a0ea7(0x1c0)](_0x1c07b0=>_0x1c07b0['enabled'])[_0x1a0ea7(0x8ff)](_0x5b5191=>'-\x20'+_0x5b5191[_0x1a0ea7(0xede)])['join']('\x0a'))[_0x1a0ea7(0x121a)](''),_0x5b928b=_0x1a0ea7(0x115f)+_0x2a62e0[_0x1a0ea7(0x1467)]+_0x1a0ea7(0x4d5)+_0x2a62e0['settings']['aiPersona']+_0x1a0ea7(0x12b3)+_0x487c3b+'\x0a'+_0x407cc7+_0x1a0ea7(0x5af)+_0x45439d+_0x1a0ea7(0x372)+_0x2bf433+_0x1a0ea7(0x1527);try{const _0x22ba9c=[{'role':_0x1a0ea7(0xaeb),'content':_0x1a0ea7(0x1000)}];let _0x435b67=_0x5ce2b4['includes'](_0x1a0ea7(0x708)),_0x459b9d=_0xe8c788(_0x5186ac,_0x459d40,_0x5b928b,_0x22ba9c);const _0x295f3b=_0x435b67?await fetch(_0x459b9d[_0x1a0ea7(0x9a8)],_0x459b9d[_0x1a0ea7(0x92a)]):await fetch(_0x5ce2b4+'/v1/chat/completions',{'method':_0x1a0ea7(0xdca),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x459d40},'body':JSON[_0x1a0ea7(0x526)]({'model':_0x5186ac,'messages':[{'role':_0x1a0ea7(0x11af),'content':_0x5b928b},..._0x22ba9c],'temperature':_0x16699d[_0x1a0ea7(0xf9c)][_0x1a0ea7(0x382)]||0x1})});if(!_0x295f3b['ok'])throw new Error(_0x1a0ea7(0x69a)+_0x295f3b[_0x1a0ea7(0x13a2)]);const _0xd4ee9d=await _0x295f3b[_0x1a0ea7(0x21d)](),_0x32c1d5=getGeminiResponseText(_0xd4ee9d),_0x2bd069=_0x32c1d5[_0x1a0ea7(0x14e9)](/^```json\s*/,'')[_0x1a0ea7(0x14e9)](/```$/,''),_0x3fb8bd=JSON['parse'](_0x2bd069);await _0x104485(_0x1a0ea7(0x960),_0x1a0ea7(0x95b)+_0x3fb8bd[_0x1a0ea7(0xaf9)]+_0x1a0ea7(0xba1));const _0x3a4a96=_0x3fb8bd[_0x1a0ea7(0x8ff)](async _0x15a481=>{const _0xe13cdc=_0x1a0ea7;let _0x251c15=await _0x16086c(_0x15a481[_0xe13cdc(0x228)],_0x15a481[_0xe13cdc(0x793)]);(!_0x251c15||_0x251c15['length']===0x0)&&(_0x251c15=await _0x16eafa(_0x15a481[_0xe13cdc(0x228)]));if(_0x251c15[_0xe13cdc(0xaf9)]>0x0)return _0x493749(_0x251c15[0x0]);return console[_0xe13cdc(0x9c1)](_0xe13cdc(0xe85)+_0x15a481['songName']+_0xe13cdc(0x1182)+_0x15a481[_0xe13cdc(0x793)]+'”'),null;}),_0x2695cf=(await Promise[_0x1a0ea7(0xd49)](_0x3a4a96))[_0x1a0ea7(0x1c0)](Boolean);_0x2a62e0[_0x1a0ea7(0x291)]=_0x2695cf,await _0x6ed281['chats'][_0x1a0ea7(0x90c)](_0x2a62e0),await _0x3d20e6();}catch(_0x21c5e2){console[_0x1a0ea7(0xc3e)](_0x1a0ea7(0x13cb),_0x21c5e2),await _0x104485('生成失败','无法生成歌单，请检查API配置或稍后再试。\x0a错误:\x20'+_0x21c5e2[_0x1a0ea7(0x74b)]);}}function _0x3d20e6(){const _0x4f57e0=_0x3ce1fb,_0x14969b=document['getElementById'](_0x4f57e0(0x921));_0x14969b[_0x4f57e0(0xb6f)]='';if(!_0x36911a)return;const _0x56c685=_0x16699d[_0x4f57e0(0x1474)][_0x36911a],_0x1d1b2b=_0x56c685['simulatedMusicPlaylist']||[];if(_0x1d1b2b[_0x4f57e0(0xaf9)]===0x0){_0x14969b[_0x4f57e0(0xb6f)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的歌单还是空的，<br>点击右上角刷新按钮生成一些歌曲吧！</p>';return;}_0x1d1b2b[_0x4f57e0(0x427)]((_0x5164c1,_0x53693c)=>{const _0x356e46=_0x4f57e0,_0x2b8492=document[_0x356e46(0x1497)](_0x356e46(0x379));_0x2b8492[_0x356e46(0x35b)]=_0x356e46(0xe11),_0x2b8492[_0x356e46(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x5164c1[_0x356e46(0xefe)]+_0x356e46(0x1252)+_0x5164c1[_0x356e46(0x1467)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-artist\x22>'+_0x5164c1[_0x356e46(0x43a)]+_0x356e46(0xf75),_0x2b8492['addEventListener']('click',()=>_0x205a9b(_0x5164c1)),_0x14969b[_0x356e46(0x6b6)](_0x2b8492);});}let _0x520774={'currentPlaylist':[],'currentIndex':-0x1,'isPlaying':![],'playMode':'order','lrcUpdateInterval':null,'parsedLyrics':[],'currentLyricIndex':-0x1};function _0x205a9b(_0x376de8){const _0x5f4558=_0x3ce1fb,_0x139c41=document['getElementById']('char-audio-player'),_0x4d4b0d=document['getElementById'](_0x5f4558(0x613));if(_0x520774[_0x5f4558(0xfdc)])clearInterval(_0x520774[_0x5f4558(0xfdc)]);_0x139c41[_0x5f4558(0xf8c)]();const _0x35df0d=_0x520774[_0x5f4558(0x1360)][_0x5f4558(0x1018)](_0x21ddc1=>_0x21ddc1[_0x5f4558(0x147d)]===_0x376de8[_0x5f4558(0x147d)]);_0x35df0d>-0x1?_0x520774[_0x5f4558(0x73a)]=_0x35df0d:(_0x520774[_0x5f4558(0x1360)]=[_0x376de8],_0x520774[_0x5f4558(0x73a)]=0x0);document['getElementById'](_0x5f4558(0x5a4))[_0x5f4558(0x10cb)]=_0x376de8[_0x5f4558(0x1467)],document[_0x5f4558(0x948)](_0x5f4558(0x134e))[_0x5f4558(0x10cb)]=_0x376de8[_0x5f4558(0x43a)],document[_0x5f4558(0x948)](_0x5f4558(0xfcf))[_0x5f4558(0x147d)]=_0x376de8['cover'],_0x520774['parsedLyrics']=_0x1192f8(_0x376de8['lrcContent']||''),_0x4381aa();if(_0x376de8['isLocal']){const _0x5154ca=new Blob([_0x376de8[_0x5f4558(0x147d)]],{'type':_0x376de8[_0x5f4558(0x1124)]||_0x5f4558(0xac1)});_0x139c41[_0x5f4558(0x147d)]=URL[_0x5f4558(0x91d)](_0x5154ca);}else _0x139c41['src']=_0x376de8[_0x5f4558(0x147d)];_0x139c41[_0x5f4558(0x293)]()[_0x5f4558(0x1061)](_0x9e3b14=>console[_0x5f4558(0xc3e)](_0x5f4558(0x631),_0x9e3b14)),_0x139c41[_0x5f4558(0x38a)]=()=>{document['getElementById']('char-music-total-time')['textContent']=_0x30eb40(_0x139c41['duration']),_0x520774['lrcUpdateInterval']=setInterval(_0x25c28a,0x1f4);},_0x4d4b0d['classList'][_0x5f4558(0xbd0)]('visible');}function _0x41c8a1(){const _0xa6b302=_0x3ce1fb,_0x48d36e=document[_0xa6b302(0x948)](_0xa6b302(0x613)),_0x2a26b5=document[_0xa6b302(0x948)](_0xa6b302(0x14fe));if(_0x520774[_0xa6b302(0xfdc)])clearInterval(_0x520774[_0xa6b302(0xfdc)]);_0x2a26b5[_0xa6b302(0xf8c)](),_0x2a26b5['src']='',_0x48d36e[_0xa6b302(0xd54)][_0xa6b302(0xf89)](_0xa6b302(0xfcb)),_0x520774[_0xa6b302(0x3aa)]=![],document['getElementById']('char-vinyl-container')['classList'][_0xa6b302(0xf89)](_0xa6b302(0x7c9));}function _0x25c28a(){const _0x47ffd0=_0x3ce1fb,_0xb4b883=document['getElementById'](_0x47ffd0(0x14fe));if(!_0xb4b883[_0x47ffd0(0x7ce)])return;const _0x104ef6=_0xb4b883[_0x47ffd0(0x624)],_0x498bfd=_0xb4b883[_0x47ffd0(0x7ce)];document[_0x47ffd0(0x948)](_0x47ffd0(0x109b))['style'][_0x47ffd0(0x977)]=_0x104ef6/_0x498bfd*0x64+'%',document['getElementById']('char-music-current-time')[_0x47ffd0(0x10cb)]=_0x30eb40(_0x104ef6),_0x5d7570(_0x104ef6);}function _0x4381aa(){const _0x110a59=_0x3ce1fb,_0x542839=document[_0x110a59(0x948)](_0x110a59(0x114b));_0x542839['innerHTML']='',_0x520774[_0x110a59(0xecc)]=-0x1;if(!_0x520774[_0x110a59(0x68d)]||_0x520774[_0x110a59(0x68d)][_0x110a59(0xaf9)]===0x0){_0x542839['innerHTML']='<p>♪\x20暂无歌词\x20♪</p>';return;}_0x520774[_0x110a59(0x68d)][_0x110a59(0x427)]((_0x450850,_0x1998a6)=>{const _0x444888=_0x110a59,_0x50e9c8=document['createElement']('p');_0x50e9c8[_0x444888(0x10cb)]=_0x450850[_0x444888(0x9ea)],_0x50e9c8[_0x444888(0x606)][_0x444888(0xbb3)]=_0x1998a6,_0x542839[_0x444888(0x6b6)](_0x50e9c8);});}function _0x5d7570(_0x3ab9cf){const _0x119356=_0x3ce1fb,_0x1ed5ac=_0x520774[_0x119356(0x68d)];if(_0x1ed5ac['length']===0x0)return;let _0x1fc3ce=-0x1;for(let _0x1c7b8b=0x0;_0x1c7b8b<_0x1ed5ac[_0x119356(0xaf9)];_0x1c7b8b++){if(_0x3ab9cf>=_0x1ed5ac[_0x1c7b8b][_0x119356(0x115d)])_0x1fc3ce=_0x1c7b8b;else break;}if(_0x1fc3ce===_0x520774[_0x119356(0xecc)])return;_0x520774['currentLyricIndex']=_0x1fc3ce;const _0x15a0cf=document['getElementById'](_0x119356(0x114b)),_0x1b0012=_0x15a0cf[_0x119356(0x1188)]('p');_0x1b0012[_0x119356(0x427)](_0x4f6b92=>_0x4f6b92['classList'][_0x119356(0xf89)](_0x119356(0x115e)));if(_0x1fc3ce>-0x1){const _0x38a532=_0x15a0cf['querySelector']('p[data-index=\x22'+_0x1fc3ce+'\x22]');if(_0x38a532){_0x38a532['classList'][_0x119356(0xbd0)](_0x119356(0x115e));const _0x53f6e8=_0x15a0cf[_0x119356(0xcdc)]/0x2-_0x38a532[_0x119356(0x255)]-_0x38a532['offsetHeight']/0x2;_0x1b0012[_0x119356(0x427)](_0x64739=>{const _0x38d454=_0x119356;_0x64739[_0x38d454(0xf74)][_0x38d454(0x79c)]='translateY('+_0x53f6e8+'px)';});}}}function _0x175fef(){const _0x22ebe5=_0x3ce1fb;if(_0x520774['currentPlaylist']['length']===0x0)return;let _0x113a24;switch(_0x520774[_0x22ebe5(0x33c)]){case _0x22ebe5(0x59c):_0x113a24=Math[_0x22ebe5(0x15b6)](Math[_0x22ebe5(0x59c)]()*_0x520774[_0x22ebe5(0x1360)][_0x22ebe5(0xaf9)]);break;case _0x22ebe5(0xc3c):_0x205a9b(_0x520774[_0x22ebe5(0x1360)][_0x520774[_0x22ebe5(0x73a)]]);return;case _0x22ebe5(0x12e7):default:_0x113a24=(_0x520774['currentIndex']+0x1)%_0x520774[_0x22ebe5(0x1360)]['length'];break;}_0x205a9b(_0x520774['currentPlaylist'][_0x113a24]);}function _0x217e28(){const _0x6484d0=_0x3ce1fb;if(_0x520774[_0x6484d0(0x1360)][_0x6484d0(0xaf9)]===0x0)return;const _0xc633d=(_0x520774['currentIndex']-0x1+_0x520774[_0x6484d0(0x1360)]['length'])%_0x520774[_0x6484d0(0x1360)][_0x6484d0(0xaf9)];_0x205a9b(_0x520774[_0x6484d0(0x1360)][_0xc633d]);}function _0x22ad3a(){const _0xae9b9e=_0x3ce1fb,_0x15fa5e=['order',_0xae9b9e(0x59c),_0xae9b9e(0xc3c)],_0x4c301f=_0x15fa5e[_0xae9b9e(0x539)](_0x520774[_0xae9b9e(0x33c)]);_0x520774[_0xae9b9e(0x33c)]=_0x15fa5e[(_0x4c301f+0x1)%_0x15fa5e[_0xae9b9e(0xaf9)]],document['getElementById'](_0xae9b9e(0x7a9))['textContent']={'order':'顺序','random':'随机','single':'单曲'}[_0x520774[_0xae9b9e(0x33c)]];}function _0x96da1(){const _0x32fb03=_0x3ce1fb,_0x6f6151=document[_0x32fb03(0x948)](_0x32fb03(0x14fe)),_0x41e2a4=document['getElementById'](_0x32fb03(0x11cf)),_0x21efc6=document[_0x32fb03(0x948)](_0x32fb03(0x70e));_0x41e2a4[_0x32fb03(0x339)](_0x32fb03(0x4f6),()=>{const _0x4d8dea=_0x32fb03;if(_0x6f6151[_0x4d8dea(0x106d)]){if(_0x520774['currentIndex']>-0x1)_0x6f6151[_0x4d8dea(0x293)]();}else _0x6f6151[_0x4d8dea(0xf8c)]();}),_0x6f6151[_0x32fb03(0x8e9)]=()=>{const _0x51a360=_0x32fb03;_0x41e2a4[_0x51a360(0xb6f)]=_0x51a360(0x903),_0x21efc6[_0x51a360(0xd54)][_0x51a360(0xbd0)]('spinning'),_0x520774[_0x51a360(0x3aa)]=!![];},_0x6f6151['onpause']=()=>{const _0x4a1632=_0x32fb03;_0x41e2a4[_0x4a1632(0xb6f)]='<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M8\x205v14l11-7z\x22></path></svg>',_0x21efc6[_0x4a1632(0xd54)][_0x4a1632(0xf89)](_0x4a1632(0x7c9)),_0x520774[_0x4a1632(0x3aa)]=![];},_0x6f6151[_0x32fb03(0x936)]=()=>{const _0x2fa368=_0x32fb03;_0x21efc6[_0x2fa368(0xd54)]['remove'](_0x2fa368(0x7c9)),_0x520774[_0x2fa368(0x3aa)]=![],_0x175fef();},document[_0x32fb03(0x948)]('char-music-prev-btn')[_0x32fb03(0x339)](_0x32fb03(0x4f6),_0x217e28),document[_0x32fb03(0x948)](_0x32fb03(0x66d))[_0x32fb03(0x339)](_0x32fb03(0x4f6),_0x175fef),document[_0x32fb03(0x948)]('char-music-mode-btn')[_0x32fb03(0x339)](_0x32fb03(0x4f6),_0x22ad3a),document[_0x32fb03(0x948)](_0x32fb03(0xd9f))['addEventListener'](_0x32fb03(0x4f6),_0x2080f5=>{const _0x54157b=_0x32fb03;if(!_0x6f6151[_0x54157b(0x7ce)])return;const _0x2f54f0=_0x2080f5[_0x54157b(0x614)],_0x11d1c1=_0x2080f5[_0x54157b(0x14ba)];_0x6f6151[_0x54157b(0x624)]=_0x11d1c1/_0x2f54f0[_0x54157b(0xa00)]*_0x6f6151[_0x54157b(0x7ce)];});}async function _0x34e951(){const _0x2f2be5=_0x3ce1fb,_0x1c8154=document['getElementById'](_0x2f2be5(0x13e9));_0x1c8154['innerHTML']='';const _0x59f174=await _0x6ed281[_0x2f2be5(0x8b2)][_0x2f2be5(0x1088)](_0x2f2be5(0xb0a))[_0x2f2be5(0xb26)]()[_0x2f2be5(0x443)]();if(_0x59f174[_0x2f2be5(0xaf9)]===0x0){_0x1c8154['innerHTML']=_0x2f2be5(0x1500);return;}_0x59f174[_0x2f2be5(0x427)](_0x478adc=>{const _0x5dc217=_0x2f2be5;let _0x54a878;const _0x407619=_0x478adc[_0x5dc217(0x122a)]?Object[_0x5dc217(0x1166)](_0x16699d['chats'])[_0x5dc217(0x1402)](_0x32d2d9=>!_0x32d2d9[_0x5dc217(0x1173)]&&_0x32d2d9[_0x5dc217(0x1467)]===_0x478adc[_0x5dc217(0x122a)]):null;if(_0x407619)_0x54a878=_0x407619[_0x5dc217(0x7fd)][_0x5dc217(0x156d)];else{const _0xb50b80=Object['values'](_0x16699d[_0x5dc217(0x1474)])[_0x5dc217(0x1402)](_0x141554=>!_0x141554[_0x5dc217(0x1173)]&&_0x141554[_0x5dc217(0x1467)]===_0x478adc[_0x5dc217(0x8bd)]);if(_0xb50b80)_0x54a878=_0xb50b80[_0x5dc217(0x7fd)]['aiAvatar'];else _0x478adc[_0x5dc217(0x1294)]?_0x54a878=_0x5dc217(0xbfa)+encodeURIComponent(_0x478adc['authorAvatarPrompt']):_0x54a878=_0x202ba5;}const _0x28a8e1=document[_0x5dc217(0x1497)](_0x5dc217(0x379));_0x28a8e1[_0x5dc217(0x35b)]=_0x5dc217(0x135e),_0x28a8e1['onclick']=()=>_0x3e9da6(_0x478adc['id']),_0x28a8e1[_0x5dc217(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x54a878+_0x5dc217(0x83b)+_0x478adc[_0x5dc217(0x8bd)]+_0x5dc217(0x1022)+_0x478adc[_0x5dc217(0x12c2)]+_0x5dc217(0x6e6)+_0x478adc[_0x5dc217(0x425)]+_0x5dc217(0x1020)+_0x478adc[_0x5dc217(0xede)]['replace'](/\n/g,'<br>')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M170.666667\x20170.666667h128v682.666666h-128zM426.666667\x20170.666667h170.666666v682.666666h-170.666666zM725.333333\x20170.666667h128v682.666666h-128z\x22></path></svg>\x20'+_0x478adc[_0x5dc217(0xc35)]+_0x5dc217(0x1503)+_0x478adc[_0x5dc217(0xd71)]+_0x5dc217(0x23e)+_0x31ced1(_0x478adc[_0x5dc217(0xb0a)])+_0x5dc217(0x96d),_0x1c8154['appendChild'](_0x28a8e1);});}async function _0x6ddfe0(){const _0x1628e3=_0x3ce1fb,_0x4a2526=_0x16699d[_0x1628e3(0xf9c)][_0x1628e3(0xb84)]||[];if(_0x4a2526[_0x1628e3(0xaf9)]===0x0){await _0x104485(_0x1628e3(0x30e),_0x1628e3(0x5bb));return;}await _0x104485('请稍候...',_0x1628e3(0x6e7)+_0x4a2526[_0x1628e3(0xaf9)]+_0x1628e3(0xfac));const {proxyUrl:_0x1c74e4,apiKey:_0xff6151,model:_0x2dbd1f}=_0x16699d['apiConfig'];if(!_0x1c74e4||!_0xff6151||!_0x2dbd1f){alert('请先在API设置中配置好API信息。');return;}const _0x23b624=new Set();_0x4a2526[_0x1628e3(0x427)](_0x3a7440=>{const _0x163220=_0x1628e3,_0x2d485d=_0x16699d[_0x163220(0x1474)][_0x3a7440];_0x2d485d&&_0x2d485d[_0x163220(0x7fd)]['linkedWorldBookIds']&&_0x2d485d[_0x163220(0x7fd)][_0x163220(0xeee)][_0x163220(0x427)](_0x34c12b=>_0x23b624[_0x163220(0xbd0)](_0x34c12b));});let _0x1539a2='';_0x23b624[_0x1628e3(0x8ca)]>0x0&&(_0x1539a2+=_0x1628e3(0xe91),_0x23b624[_0x1628e3(0x427)](_0x13e94e=>{const _0x3e51fa=_0x1628e3,_0x407bc3=_0x16699d[_0x3e51fa(0x44c)][_0x3e51fa(0x1402)](_0x44f330=>_0x44f330['id']===_0x13e94e);if(_0x407bc3){const _0x2daf86=_0x407bc3['content']['filter'](_0x44a5a9=>_0x44a5a9[_0x3e51fa(0x111f)]!==![])[_0x3e51fa(0x8ff)](_0x1db99a=>'-\x20'+_0x1db99a['content'])['join']('\x0a');_0x2daf86&&(_0x1539a2+='\x0a##\x20来自《'+_0x407bc3[_0x3e51fa(0x1467)]+_0x3e51fa(0x8a4)+_0x2daf86);}}));const _0x60e556=_0x16699d[_0x1628e3(0x44c)]['find'](_0xfe19bf=>_0xfe19bf['name']===_0x1628e3(0xaf8));let _0x490514='',_0x318e71=[];_0x60e556&&_0x60e556[_0x1628e3(0xede)]['forEach'](_0x415acb=>{const _0x11bf93=_0x1628e3;_0x415acb['comment'][_0x11bf93(0x1336)](_0x11bf93(0x690))&&(_0x490514+=_0x11bf93(0xa74)+_0x415acb[_0x11bf93(0xede)]);if(_0x415acb[_0x11bf93(0x282)]['includes'](_0x11bf93(0x394))){const _0x1f52c1=_0x415acb[_0x11bf93(0xede)][_0x11bf93(0x46f)]('\x0a');_0x1f52c1[_0x11bf93(0x427)](_0x54f215=>{const _0xb9439e=_0x11bf93,_0x26b816=_0x54f215[_0xb9439e(0x9a3)](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x26b816&&_0x318e71[_0xb9439e(0x1001)]({'name':_0x26b816[0x1][_0xb9439e(0x2a8)](),'persona':_0x26b816[0x2][_0xb9439e(0x2a8)]()});});}});const _0x1a733d=_0x16699d[_0x1628e3(0x66e)][_0x1628e3(0xf4d)]||'我',_0x4b3b09=_0x4a2526[_0x1628e3(0xaf9)]>0x0&&_0x16699d[_0x1628e3(0x1474)][_0x4a2526[0x0]]?_0x16699d[_0x1628e3(0x1474)][_0x4a2526[0x0]][_0x1628e3(0x7fd)]['myPersona']:_0x1628e3(0x572);let _0x32ae21='';_0x4a2526[_0x1628e3(0x427)](_0x126af9=>{const _0x1170f6=_0x1628e3,_0x4ba6f1=_0x16699d['chats'][_0x126af9];if(_0x4ba6f1){const _0x11b50a=_0x4ba6f1[_0x1170f6(0x758)]&&_0x4ba6f1[_0x1170f6(0x758)][_0x1170f6(0xaf9)]>0x0?_0x4ba6f1[_0x1170f6(0x758)][_0x1170f6(0x8ff)](_0x211276=>_0x211276['content'])[_0x1170f6(0x121a)](';\x20'):'无',_0x4c539b=_0x4ba6f1[_0x1170f6(0xb07)]['slice'](-0xa)['map'](_0xe31a90=>(_0xe31a90[_0x1170f6(0x1554)]===_0x1170f6(0xaeb)?_0x1a733d:_0x4ba6f1[_0x1170f6(0x1467)])+':\x20'+String(_0xe31a90['content'])['substring'](0x0,0x1e)+_0x1170f6(0x76d))[_0x1170f6(0x121a)]('\x0a');_0x32ae21+=_0x1170f6(0xc46)+_0x4ba6f1[_0x1170f6(0x1467)]+_0x1170f6(0xe48)+_0x4ba6f1['settings']['aiPersona']+_0x1170f6(0xac8)+_0x11b50a+'</memory>\x0a\x20\x20<recent_dialogue_with_user>'+_0x4c539b+'</recent_dialogue_with_user>\x0a</character>\x0a';}}),_0x318e71[_0x1628e3(0x427)](_0x335026=>{const _0x273c9f=_0x1628e3;_0x32ae21+=_0x273c9f(0xc46)+_0x335026[_0x273c9f(0x1467)]+_0x273c9f(0xe48)+_0x335026[_0x273c9f(0xbad)]+'</persona>\x0a</character>\x0a';});const _0x3ad35b=new Date(),_0x20a45a=_0x3ad35b[_0x1628e3(0xed3)](_0x1628e3(0x144f),{'dateStyle':_0x1628e3(0xc98),'timeStyle':'short'}),_0x1f357c=_0x16699d[_0x1628e3(0xf9c)][_0x1628e3(0x62a)]||0xc,_0x4f0dd5=_0x16699d[_0x1628e3(0xf9c)]['doubanMaxPosts']||0x14,_0x1ae494=_0x1628e3(0x61d)+_0x1f357c+'到'+_0x4f0dd5+'篇】他们最近可能会在各种豆瓣小组中发布的帖子和评论。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**'+_0x20a45a+_0x1628e3(0xa84)+_0x1a733d+'”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20authorName\x20或\x20commenter\x20字段为\x20“'+_0x1a733d+'”\x20的帖子或评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【身份\x20(最高优先级！)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20`authorName`:\x20你可以为主要角色起一个符合情景的、临时的【发帖昵称】，也可以直接使用他们的本名。\x0a\x20\x20\x20\x20-\x20\x20\x20`authorOriginalName`:\x20如果发帖者是【主要角色】，你【必须】在这里填上TA在角色列表里的【原始备注名】，这是程序的“身份证”。\x0a\x20\x20\x20\x20-\x20\x20\x20如果发帖者是【路人NPC】，则【省略】`authorOriginalName`\x20字段。\x0a4.\x20\x20**【作者平衡】**:\x20帖子的作者【必须】从下面的\x20`<character>`\x20列表中【均匀地、多样化地】选择。你【必须】确保帖子列表中【至少有\x2070%\x20的帖子是由路人NPC发布的】，以营造一个真实的社区氛围。\x0a\x20\x20\x20\x20-\x20\x22comments\x22:\x20一个包含【7到12条】评论的数组。评论者可以是路人，也可以是角色列表中的其他角色，以体现互动性。\x0a5.\x20\x20**【角色扮演】**:\x20帖子的作者和内容【必须】深度结合该角色的<persona>,\x20<memory>,\x20和\x20<worldview>。\x0a6.\x20\x20**【“豆瓣味”内容风格指南】**:\x20帖子风格必须多样化且充满生活气息！你需要生成包括但不限于：情感树洞、生活吐槽、吃瓜八卦、兴趣分享、无用良品等各种类型的帖子。\x0a7.\x20\x20**【头像生成\x20(最高优先级！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20为每一个【首次出现】的路人NPC（无论是发帖还是评论），你都【必须】为其添加一个\x20`avatar_prompt`\x20字段。\x0a\x20\x20\x20\x20-\x20\x20\x20这个字段的内容是用于生成该NPC头像的、简洁的【英文】关键词。\x0a\x20\x20\x20\x20-\x20\x20\x20不同的NPC【必须】有不同的头像指令，以确保他们的头像是独一无二的。\x0a8.\x20\x20**【头像一致性\x20(至关重要！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果一个路人NPC在同一个帖子中多次出现（例如，既是发帖人又是评论者，或多次评论），你【必须】为TA的所有出现都使用【完全相同】的\x20`avatar_prompt`。这至关重要！\x0a9.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一篇帖子，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22groupName\x22:\x20\x22一个生动有趣的小组名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22postTitle\x22:\x20\x22一个引人-注目的帖子标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorName\x22:\x20\x22发帖角色的【备注名】\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorOriginalName\x22:\x20\x22(仅当发帖者是主要角色时【必须】提供)\x20TA的原始备注名\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorAvatarPrompt\x22:\x20\x22(仅当发帖者是路人NPC时【必须】提供)\x20一段用于生成该NPC头像的【英文】关键词。风格为\x20anime\x20style,\x20simple\x20background\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22帖子的详细正文，必须支持换行符\x5cn。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22likesCount\x22:\x20152,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22commentsCount\x22:\x2038,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22路人甲\x22,\x20\x22text\x22:\x20\x22这是一个路人评论。\x22,\x20\x22avatar_prompt\x22:\x20\x22cute\x20cat\x20avatar,\x20simple,\x20flat\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22另一个角色名\x22,\x20\x22commenterOriginalName\x22:\x20\x22(如果评论者是主要角色，必须提供其本名)\x22,\x20\x22text\x22:\x20\x22这是一个来自其他角色的互动评论。\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**comments**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20评论者可以是路人，也可以是角色列表中的其他角色。评论区【必须】体现出互动性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20【评论身份】:\x20如果评论者是【主要角色】，你【必须】为其添加\x20`commenterOriginalName`\x20字段，并填入其本名。如果是路人NPC，则省略此字段。\x0a\x0a#\x20供你参考的上下文\x0a'+_0x490514+'\x0a'+_0x1539a2+_0x1628e3(0x150b)+_0x20a45a+_0x1628e3(0xcc3)+_0x1a733d+'\x0a-\x20**人设**:\x20'+_0x4b3b09+_0x1628e3(0x8f3)+_0x32ae21+_0x1628e3(0x3a3);try{const _0x3be908=[{'role':_0x1628e3(0xaeb),'content':_0x1628e3(0x7db)}];let _0x54447c=_0x1c74e4[_0x1628e3(0x1336)](_0x1628e3(0x708)),_0x3ff7a6=_0xe8c788(_0x2dbd1f,_0xff6151,_0x1ae494,_0x3be908);const _0x51178d=_0x54447c?await fetch(_0x3ff7a6[_0x1628e3(0x9a8)],_0x3ff7a6[_0x1628e3(0x92a)]):await fetch(_0x1c74e4+'/v1/chat/completions',{'method':'POST','headers':{'Content-Type':_0x1628e3(0x479),'Authorization':_0x1628e3(0xb0e)+_0xff6151},'body':JSON[_0x1628e3(0x526)]({'model':_0x2dbd1f,'messages':[{'role':_0x1628e3(0x11af),'content':_0x1ae494},..._0x3be908],'temperature':_0x16699d[_0x1628e3(0xf9c)][_0x1628e3(0x382)]||0x1})});if(!_0x51178d['ok'])throw new Error(_0x1628e3(0x69a)+_0x51178d[_0x1628e3(0x13a2)]);const _0x41c077=await _0x51178d[_0x1628e3(0x21d)](),_0x40000f=getGeminiResponseText(_0x41c077),_0x19b35d=_0x40000f[_0x1628e3(0x9a3)](/\[[\s\S]*\]/);if(!_0x19b35d)throw new Error(_0x1628e3(0xdf4)+_0x40000f);const _0x5990cb=JSON[_0x1628e3(0xde0)](_0x19b35d[0x0]);await _0x6ed281[_0x1628e3(0x8b2)][_0x1628e3(0x99d)](),await _0x6ed281['doubanPosts'][_0x1628e3(0x571)](_0x5990cb[_0x1628e3(0x8ff)](_0xcec4dc=>({..._0xcec4dc,'timestamp':Date['now']()-Math[_0x1628e3(0x59c)]()*0x186a0}))),await _0x34e951();}catch(_0x33dd18){console[_0x1628e3(0xc3e)](_0x1628e3(0x280),_0x33dd18),await _0x104485(_0x1628e3(0x1164),_0x1628e3(0x142f)+_0x33dd18[_0x1628e3(0x74b)]);}}async function _0x3e9da6(_0x2ec667){const _0x1d9e5f=_0x3ce1fb;_0x58c3b1('douban-post-detail-screen'),_0x966e44=_0x2ec667;const _0x3497b4=await _0x6ed281['doubanPosts'][_0x1d9e5f(0xe8c)](_0x2ec667);if(!_0x3497b4){_0x58c3b1(_0x1d9e5f(0x197));return;}document[_0x1d9e5f(0x948)]('douban-post-detail-title')[_0x1d9e5f(0x10cb)]=_0x1d9e5f(0x1599);let _0x3c5692=_0x202ba5,_0x17cad0=_0x3497b4[_0x1d9e5f(0x8bd)];const _0x20a1ef=_0x3497b4[_0x1d9e5f(0x122a)]?Object['values'](_0x16699d['chats'])[_0x1d9e5f(0x1402)](_0x4ab8a7=>!_0x4ab8a7[_0x1d9e5f(0x1173)]&&_0x4ab8a7['originalName']===_0x3497b4[_0x1d9e5f(0x122a)]):null;if(_0x20a1ef)_0x3c5692=_0x20a1ef[_0x1d9e5f(0x7fd)]['aiAvatar'];else{const _0x6ac00b=Object[_0x1d9e5f(0x1166)](_0x16699d[_0x1d9e5f(0x1474)])['find'](_0x57cd6f=>!_0x57cd6f['isGroup']&&_0x57cd6f['name']===_0x3497b4['authorName']);if(_0x6ac00b)_0x3c5692=_0x6ac00b['settings'][_0x1d9e5f(0x156d)];else _0x3497b4[_0x1d9e5f(0x1294)]&&(_0x3c5692='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x3497b4[_0x1d9e5f(0x1294)]));}document[_0x1d9e5f(0x948)]('douban-detail-avatar')[_0x1d9e5f(0x147d)]=_0x3c5692,document[_0x1d9e5f(0x948)](_0x1d9e5f(0x1466))['textContent']=_0x17cad0,document[_0x1d9e5f(0x948)](_0x1d9e5f(0x24e))[_0x1d9e5f(0x10cb)]=_0x1d9e5f(0x578)+_0x3497b4[_0x1d9e5f(0x12c2)],document[_0x1d9e5f(0x948)](_0x1d9e5f(0xf49))[_0x1d9e5f(0x10cb)]=_0x3497b4[_0x1d9e5f(0x425)],document[_0x1d9e5f(0x948)](_0x1d9e5f(0xf44))[_0x1d9e5f(0xb6f)]=_0x3497b4[_0x1d9e5f(0xede)]['replace'](/\n/g,'<br>'),document[_0x1d9e5f(0x948)](_0x1d9e5f(0x1068))[_0x1d9e5f(0x147d)]=_0x16699d['qzoneSettings'][_0x1d9e5f(0x63e)],document[_0x1d9e5f(0x948)](_0x1d9e5f(0x1415))[_0x1d9e5f(0x5bc)]='';const _0x54d418=document['getElementById'](_0x1d9e5f(0xacf));_0x54d418[_0x1d9e5f(0xb6f)]='';if(_0x3497b4[_0x1d9e5f(0x4d6)]&&_0x3497b4[_0x1d9e5f(0x4d6)][_0x1d9e5f(0xaf9)]>0x0){const _0x3900bf=new Map();_0x3497b4[_0x1d9e5f(0x4d6)][_0x1d9e5f(0x427)](_0x572074=>{const _0x20ffa1=_0x1d9e5f;let _0x460794=_0x202ba5;const _0x27dd4d=_0x16699d[_0x20ffa1(0x66e)]['nickname']||'我',_0x42f9a3=_0x572074[_0x20ffa1(0xb5a)];if(_0x3900bf[_0x20ffa1(0xda1)](_0x42f9a3))_0x460794=_0x3900bf['get'](_0x42f9a3);else{if(_0x42f9a3===_0x27dd4d)_0x460794=_0x16699d[_0x20ffa1(0x66e)][_0x20ffa1(0x63e)];else{if(_0x42f9a3===_0x3497b4[_0x20ffa1(0x8bd)])_0x460794=_0x3c5692;else{const _0x2ca1f1=_0x572074[_0x20ffa1(0x1034)]?Object['values'](_0x16699d[_0x20ffa1(0x1474)])[_0x20ffa1(0x1402)](_0x137549=>!_0x137549['isGroup']&&_0x137549['originalName']===_0x572074[_0x20ffa1(0x1034)]):null;if(_0x2ca1f1)_0x460794=_0x2ca1f1[_0x20ffa1(0x7fd)][_0x20ffa1(0x156d)];else{const _0x64ab26=Object[_0x20ffa1(0x1166)](_0x16699d[_0x20ffa1(0x1474)])[_0x20ffa1(0x1402)](_0x53216f=>!_0x53216f[_0x20ffa1(0x1173)]&&_0x53216f[_0x20ffa1(0x1467)]===_0x42f9a3);if(_0x64ab26)_0x460794=_0x64ab26[_0x20ffa1(0x7fd)][_0x20ffa1(0x156d)];else _0x572074['avatar_prompt']&&(_0x460794=_0x20ffa1(0xbfa)+encodeURIComponent(_0x572074[_0x20ffa1(0x1507)]));}}}_0x3900bf[_0x20ffa1(0x450)](_0x42f9a3,_0x460794);}const _0x847061=document['createElement'](_0x20ffa1(0x379));_0x847061[_0x20ffa1(0x35b)]='douban-comment-item',_0x847061['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x460794+_0x20ffa1(0xf52)+_0x42f9a3+_0x20ffa1(0xe9f)+_0x572074['text'][_0x20ffa1(0x14e9)](/\n/g,_0x20ffa1(0x1121))+_0x20ffa1(0x5a8),_0x54d418['appendChild'](_0x847061);});}else _0x54d418['innerHTML']=_0x1d9e5f(0x62f);const _0x32525d=document[_0x1d9e5f(0x948)](_0x1d9e5f(0x149a));if(_0x32525d)_0x32525d['scrollTop']=0x0;}async function _0x4a7663(){const _0x5b38bd=_0x3ce1fb;if(!_0x966e44)return;const _0x41eae0=document[_0x5b38bd(0x948)](_0x5b38bd(0x1415)),_0x11d99a=_0x41eae0[_0x5b38bd(0x5bc)][_0x5b38bd(0x2a8)]();if(!_0x11d99a)return;const _0x35ae53=await _0x6ed281[_0x5b38bd(0x8b2)][_0x5b38bd(0xe8c)](_0x966e44);if(!_0x35ae53)return;!_0x35ae53[_0x5b38bd(0x4d6)]&&(_0x35ae53[_0x5b38bd(0x4d6)]=[]);const _0x44ed2c=_0x16699d[_0x5b38bd(0x66e)][_0x5b38bd(0xf4d)]||'我';_0x35ae53[_0x5b38bd(0x4d6)][_0x5b38bd(0x1001)]({'commenter':_0x44ed2c,'text':_0x11d99a}),_0x35ae53['commentsCount']++,await _0x6ed281[_0x5b38bd(0x8b2)]['put'](_0x35ae53),_0x41eae0['value']='',await _0x3e9da6(_0x966e44);}async function _0x1c230d(){const _0x2ebe22=_0x3ce1fb;if(!_0x966e44)return;const _0x21450c=_0x966e44,_0x21f0d4=await _0x6ed281[_0x2ebe22(0x8b2)][_0x2ebe22(0xe8c)](_0x21450c);if(!_0x21f0d4)return;const _0xd6c21f=_0x21f0d4[_0x2ebe22(0x4d6)]&&_0x21f0d4[_0x2ebe22(0x4d6)][_0x2ebe22(0x200)](-0x1)[0x0];if(!_0xd6c21f){alert(_0x2ebe22(0x84d));return;}await _0x104485(_0x2ebe22(0x960),_0x2ebe22(0x4ec));try{const {proxyUrl:_0x452f37,apiKey:_0x217c76,model:_0x398a88}=_0x16699d[_0x2ebe22(0x79e)];if(!_0x452f37||!_0x217c76||!_0x398a88)throw new Error(_0x2ebe22(0xa31));const _0x39f5a4=_0x16699d['qzoneSettings']['nickname']||'我',_0x435253=_0x16699d[_0x2ebe22(0x1474)][Object['keys'](_0x16699d[_0x2ebe22(0x1474)])[0x0]]?.['settings'][_0x2ebe22(0x13b6)]||'(未设置)',_0x56f0e8=new Map();_0x21f0d4[_0x2ebe22(0x4d6)]&&_0x21f0d4[_0x2ebe22(0x4d6)][_0x2ebe22(0x427)](_0x37c96a=>{const _0xf6b5ef=_0x2ebe22,_0x2a6e48=(_0x16699d[_0xf6b5ef(0xf9c)][_0xf6b5ef(0xb84)]||[])[_0xf6b5ef(0x1502)](_0x29ed0b=>_0x16699d[_0xf6b5ef(0x1474)][_0x29ed0b]?.[_0xf6b5ef(0x1467)]===_0x37c96a[_0xf6b5ef(0xb5a)]);!_0x2a6e48&&_0x37c96a[_0xf6b5ef(0x1507)]&&_0x56f0e8[_0xf6b5ef(0x450)](_0x37c96a['commenter'],_0x37c96a[_0xf6b5ef(0x1507)]);});let _0x1a5f23=_0x2ebe22(0x71a);_0x56f0e8['size']>0x0?(_0x1a5f23+='如果以下任何一位NPC再次评论，你【必须】使用我们提供的、完全相同的`avatar_prompt`，以保持头像一致性。\x0a',_0x56f0e8[_0x2ebe22(0x427)]((_0x56898b,_0x4e2417)=>{const _0x494dc6=_0x2ebe22;_0x1a5f23+='-\x20**'+_0x4e2417+_0x494dc6(0x1535)+_0x56898b+'\x22\x0a';})):_0x1a5f23+=_0x2ebe22(0xe26);const _0x7e6c5c=_0x16699d['worldBooks'][_0x2ebe22(0x1402)](_0x41a297=>_0x41a297[_0x2ebe22(0x1467)]==='豆瓣设定');let _0x8aca8e=[];_0x7e6c5c&&_0x7e6c5c['content'][_0x2ebe22(0x427)](_0x5bdbf8=>{const _0x264042=_0x2ebe22;if(_0x5bdbf8[_0x264042(0x282)][_0x264042(0x1336)](_0x264042(0x394))){const _0x4f84f3=_0x5bdbf8[_0x264042(0xede)][_0x264042(0x46f)]('\x0a');_0x4f84f3['forEach'](_0x26e0b7=>{const _0xa06f2c=_0x264042,_0x48b497=_0x26e0b7['match'](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x48b497&&_0x8aca8e[_0xa06f2c(0x1001)]({'name':_0x48b497[0x1]['trim'](),'persona':_0x48b497[0x2][_0xa06f2c(0x2a8)]()});});}});let _0xdc0ee3='';const _0x386289=_0x16699d['globalSettings']['doubanActiveCharacterIds']||[];_0x386289['forEach'](_0x13bbe0=>{const _0x57f839=_0x2ebe22,_0xcc7576=_0x16699d[_0x57f839(0x1474)][_0x13bbe0];if(_0xcc7576){const _0xb3bdf1=_0xcc7576[_0x57f839(0x758)]&&_0xcc7576[_0x57f839(0x758)]['length']>0x0?_0xcc7576[_0x57f839(0x758)][_0x57f839(0x8ff)](_0x1dc496=>_0x1dc496[_0x57f839(0xede)])[_0x57f839(0x121a)](';\x20'):'无',_0x5b66a5=_0xcc7576['history']['slice'](-0xa)[_0x57f839(0x8ff)](_0x58a3eb=>(_0x58a3eb[_0x57f839(0x1554)]==='user'?_0x39f5a4:_0xcc7576[_0x57f839(0x1467)])+':\x20'+String(_0x58a3eb['content'])['substring'](0x0,0x1e)+_0x57f839(0x76d))[_0x57f839(0x121a)]('\x0a');_0xdc0ee3+='\x0a-\x20'+_0xcc7576[_0x57f839(0x1467)]+':\x20'+_0xcc7576[_0x57f839(0x7fd)][_0x57f839(0x14c1)][_0x57f839(0xeca)](0x0,0x32)+_0x57f839(0x3c0)+_0xb3bdf1+']\x20[最近对话:\x20'+_0x5b66a5+']';}}),_0x8aca8e[_0x2ebe22(0x427)](_0x58c2ea=>{const _0x95bd2d=_0x2ebe22;_0xdc0ee3+=_0x95bd2d(0x11ed)+_0x58c2ea[_0x95bd2d(0x1467)]+':\x20'+_0x58c2ea['persona'];});const _0x4f0463=new Date(),_0x1f5ee8=_0x4f0463[_0x2ebe22(0xed3)](_0x2ebe22(0x144f),{'dateStyle':_0x2ebe22(0xc98),'timeStyle':_0x2ebe22(0xadb)}),_0x462726=_0x2ebe22(0x10c3)+_0x39f5a4+_0x2ebe22(0xa8a)+_0x1f5ee8+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“'+_0x39f5a4+_0x2ebe22(0x1411)+_0x39f5a4+_0x2ebe22(0xb47)+_0x21f0d4['postTitle']+_0x2ebe22(0x312)+_0x21f0d4[_0x2ebe22(0x8bd)]+_0x2ebe22(0x10b9)+_0x21f0d4[_0x2ebe22(0xede)]['substring'](0x0,0x64)+_0x2ebe22(0xdbe)+_0x21f0d4[_0x2ebe22(0x4d6)][_0x2ebe22(0x8ff)](_0x490d05=>'-\x20'+_0x490d05[_0x2ebe22(0xb5a)]+':\x20'+_0x490d05[_0x2ebe22(0x9ea)])[_0x2ebe22(0x121a)]('\x0a')+'\x0a\x0a'+_0x1a5f23+_0x2ebe22(0x150b)+_0x1f5ee8+'\x0a\x0a#\x20【你的聊天对象（用户）的人设】\x0a-\x20**昵称**:\x20'+_0x39f5a4+_0x2ebe22(0xc93)+_0x435253+_0x2ebe22(0x244)+_0xdc0ee3+_0x2ebe22(0xad9),_0x274a69=[{'role':'user','content':_0x2ebe22(0x8e2)}];let _0x5b7fb8=_0x452f37['includes'](_0x2ebe22(0x708)),_0x30cf92=_0xe8c788(_0x398a88,_0x217c76,_0x462726,_0x274a69);const _0x1e0ca5=_0x5b7fb8?await fetch(_0x30cf92[_0x2ebe22(0x9a8)],_0x30cf92[_0x2ebe22(0x92a)]):await fetch(_0x452f37+_0x2ebe22(0x110e),{'method':'POST','headers':{'Content-Type':_0x2ebe22(0x479),'Authorization':_0x2ebe22(0xb0e)+_0x217c76},'body':JSON[_0x2ebe22(0x526)]({'model':_0x398a88,'messages':[{'role':'system','content':_0x462726},..._0x274a69],'temperature':_0x16699d['globalSettings'][_0x2ebe22(0x382)]||0x1})});if(!_0x1e0ca5['ok'])throw new Error('API\x20错误:\x20'+_0x1e0ca5['statusText']);const _0x5897fe=await _0x1e0ca5[_0x2ebe22(0x21d)](),_0x5674cb=getGeminiResponseText(_0x5897fe),_0x27f4d1=_0x5674cb['replace'](/^```json\s*/,'')[_0x2ebe22(0x14e9)](/```$/,''),_0xc61c8c=JSON[_0x2ebe22(0xde0)](_0x27f4d1);Array[_0x2ebe22(0x1524)](_0xc61c8c)&&_0xc61c8c['length']>0x0&&(_0x21f0d4[_0x2ebe22(0x4d6)]['push'](..._0xc61c8c),_0x21f0d4[_0x2ebe22(0xd71)]+=_0xc61c8c[_0x2ebe22(0xaf9)],await _0x6ed281[_0x2ebe22(0x8b2)][_0x2ebe22(0x90c)](_0x21f0d4)),await _0x3e9da6(_0x21450c),_0x4d1f57();}catch(_0x4c3a49){console[_0x2ebe22(0xc3e)]('等待回复失败:',_0x4c3a49),await _0x104485(_0x2ebe22(0xb6c),_0x2ebe22(0xc78)+_0x4c3a49[_0x2ebe22(0x74b)]);}}async function _0x468f39(){const _0x39cd26=_0x3ce1fb,_0x367c30=document[_0x39cd26(0x948)](_0x39cd26(0x928)),_0x482151=document[_0x39cd26(0x948)](_0x39cd26(0x1344));_0x482151['innerHTML']='';const _0x14a2fd=Object['values'](_0x16699d[_0x39cd26(0x1474)])[_0x39cd26(0x1c0)](_0x123abf=>!_0x123abf[_0x39cd26(0x1173)]),_0x3dcd19=new Set(_0x16699d[_0x39cd26(0xf9c)]['doubanActiveCharacterIds']||[]);_0x14a2fd[_0x39cd26(0xaf9)]===0x0?_0x482151[_0x39cd26(0xb6f)]=_0x39cd26(0xa82):_0x14a2fd[_0x39cd26(0x427)](_0x3ee7b7=>{const _0x34b029=_0x39cd26,_0x4ce89b=document[_0x34b029(0x1497)](_0x34b029(0x379));_0x4ce89b[_0x34b029(0x35b)]=_0x34b029(0x1437),_0x4ce89b[_0x34b029(0xb6f)]=_0x34b029(0x14c9)+_0x3ee7b7['id']+'\x22\x20'+(_0x3dcd19['has'](_0x3ee7b7['id'])?'checked':'')+_0x34b029(0x465)+(_0x3ee7b7['settings'][_0x34b029(0x156d)]||_0x202ba5)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x3ee7b7[_0x34b029(0x1467)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x482151['appendChild'](_0x4ce89b);}),_0x367c30[_0x39cd26(0xd54)][_0x39cd26(0xbd0)]('visible');}async function _0xc2ad6c(){const _0x51f198=_0x3ce1fb,_0x2d620c=document[_0x51f198(0x1188)](_0x51f198(0x130a)),_0x255fc7=Array[_0x51f198(0x6e5)](_0x2d620c)[_0x51f198(0x8ff)](_0x243895=>_0x243895['dataset'][_0x51f198(0x1029)]);_0x16699d[_0x51f198(0xf9c)][_0x51f198(0xb84)]=_0x255fc7,await _0x6ed281[_0x51f198(0xf9c)]['put'](_0x16699d[_0x51f198(0xf9c)]),document[_0x51f198(0x948)](_0x51f198(0x928))[_0x51f198(0xd54)][_0x51f198(0xf89)](_0x51f198(0xfcb)),await _0x6ddfe0();}document[_0x3ce1fb(0x948)]('douban-cast-select-btn')[_0x3ce1fb(0x339)](_0x3ce1fb(0x4f6),_0x468f39),document['getElementById']('cancel-douban-cast-btn')[_0x3ce1fb(0x339)](_0x3ce1fb(0x4f6),()=>{const _0x1b60fe=_0x3ce1fb;document[_0x1b60fe(0x948)](_0x1b60fe(0x928))[_0x1b60fe(0xd54)][_0x1b60fe(0xf89)](_0x1b60fe(0xfcb));}),document[_0x3ce1fb(0x948)](_0x3ce1fb(0x10e1))[_0x3ce1fb(0x339)](_0x3ce1fb(0x4f6),_0xc2ad6c),document[_0x3ce1fb(0x948)](_0x3ce1fb(0x1344))[_0x3ce1fb(0x339)](_0x3ce1fb(0x4f6),_0x58b103=>{const _0x9cc287=_0x3ce1fb,_0xa8b74f=_0x58b103[_0x9cc287(0xa50)][_0x9cc287(0x1090)](_0x9cc287(0x229));if(_0xa8b74f){const _0x8923d4=_0xa8b74f[_0x9cc287(0xfeb)]('.douban-cast-checkbox');_0x8923d4&&_0x58b103[_0x9cc287(0xa50)]!==_0x8923d4&&(_0x8923d4[_0x9cc287(0x210)]=!_0x8923d4['checked']);}});async function _0x445703(_0x29215d){const _0x5252a1=_0x3ce1fb;if(!_0x29215d)return;const _0x2fd970=await _0xa6b74a(_0x5252a1(0x7c8),_0x5252a1(0x15b4),{'confirmText':'确认导入'});if(!_0x2fd970)return;try{const _0x321d6d=await _0x29215d['text'](),_0xd3b5a=JSON['parse'](_0x321d6d);if(!_0xd3b5a[_0x5252a1(0xb91)]&&!_0xd3b5a['globalCss']&&!_0xd3b5a[_0x5252a1(0x1471)])throw new Error(_0x5252a1(0xcd3));Object[_0x5252a1(0xd24)](_0x16699d['globalSettings'],_0xd3b5a),await _0x6ed281[_0x5252a1(0xf9c)][_0x5252a1(0x90c)](_0x16699d[_0x5252a1(0xf9c)]),_0x364bb1(),_0x471b5b(),_0x1c8fc4(),_0x25c96f(),_0x5e5902(_0x16699d[_0x5252a1(0xf9c)][_0x5252a1(0x12fc)]),_0x495393(_0x16699d[_0x5252a1(0xf9c)][_0x5252a1(0x672)]),_0x162fdb(),_0x442c65(),_0xf9cd0e(),await _0x104485(_0x5252a1(0x5c6),_0x5252a1(0x992));}catch(_0x4f7bbb){console[_0x5252a1(0xc3e)]('导入外观设置时出错:',_0x4f7bbb),await _0x104485(_0x5252a1(0xd89),_0x5252a1(0xc4c)+_0x4f7bbb[_0x5252a1(0x74b)]);}}async function _0x109b74(_0x59ebb7){const _0x101c29=_0x3ce1fb;console[_0x101c29(0x498)](_0x101c29(0x224)+_0x59ebb7[_0x101c29(0xd69)](0x1)+_0x101c29(0x1518));const _0x456684=Object[_0x101c29(0x1166)](_0x16699d['chats'])[_0x101c29(0x1c0)](_0x36300a=>!_0x36300a[_0x101c29(0x1173)]&&_0x36300a['settings']['enableBackgroundActivity']&&_0x36300a[_0x101c29(0x1120)]?.[_0x101c29(0x82c)]==='friend');if(_0x456684[_0x101c29(0xaf9)]===0x0){console[_0x101c29(0x498)]('没有配置为后台活跃的角色，跳过模拟。');return;}for(const _0x4574de of _0x456684){const _0x2ec7b3=_0x4574de['settings']['actionCooldownMinutes']||0xf,_0x58f8a3=_0x4574de[_0x101c29(0x26e)]?(Date[_0x101c29(0x1386)]()-_0x4574de[_0x101c29(0x26e)])/(0x3e8*0x3c):Infinity;_0x59ebb7>_0x2ec7b3&&_0x58f8a3>_0x2ec7b3&&(Math[_0x101c29(0x59c)]()<0.3&&(console[_0x101c29(0x498)](_0x101c29(0x1206)+_0x4574de['name']+_0x101c29(0x126b)),Math[_0x101c29(0x59c)]()<0.7?await _0xea7c2(_0x4574de['id']):console[_0x101c29(0x498)](_0x101c29(0x1206)+_0x4574de[_0x101c29(0x1467)]+_0x101c29(0xb64))));}}function _0x2c6d5b(){const _0xcbfeb7=_0x3ce1fb;if(!_0x16699d[_0xcbfeb7(0xf5a)])return;const _0x5aeaed=_0x16699d['chats'][_0x16699d[_0xcbfeb7(0xf5a)]];document[_0xcbfeb7(0x948)](_0xcbfeb7(0xcba))[_0xcbfeb7(0x5bc)]='',document[_0xcbfeb7(0x948)](_0xcbfeb7(0xcca))['value']='',document[_0xcbfeb7(0x948)](_0xcbfeb7(0x125c))[_0xcbfeb7(0xb6f)]=_0xcbfeb7(0x15ba),_0x58c3b1(_0xcbfeb7(0x13b5));}async function _0x48eef5(){const _0x5bcd9c=_0x3ce1fb,_0x29eace=_0x16699d['chats'][_0x16699d[_0x5bcd9c(0xf5a)]];if(!_0x29eace)return;const _0x2e78d7=document[_0x5bcd9c(0x948)]('keyword-search-input')['value']['trim']()[_0x5bcd9c(0x1331)](),_0x8f28d5=document[_0x5bcd9c(0x948)](_0x5bcd9c(0xcca))['value'];if(!_0x2e78d7&&!_0x8f28d5){alert('请输入关键词或选择一个日期。');return;}let _0x178b4d=_0x29eace[_0x5bcd9c(0xb07)][_0x5bcd9c(0x1c0)](_0x3f3133=>!_0x3f3133['isHidden']);_0x2e78d7&&(_0x178b4d=_0x178b4d[_0x5bcd9c(0x1c0)](_0x1eb645=>{const _0xb05664=_0x5bcd9c;let _0x531be8='';if(typeof _0x1eb645[_0xb05664(0xede)]===_0xb05664(0x273))_0x531be8=_0x1eb645[_0xb05664(0xede)];else{if(_0x1eb645[_0xb05664(0x4ae)]===_0xb05664(0x10d4))_0x531be8=_0x1eb645[_0xb05664(0xede)];else{if(_0x1eb645[_0xb05664(0x4ae)]===_0xb05664(0x1281)||_0x1eb645[_0xb05664(0x4ae)]===_0xb05664(0x368))_0x531be8=_0x1eb645['content'];else{if(_0x1eb645[_0xb05664(0x4ae)]===_0xb05664(0xd5f))_0x531be8=(_0x1eb645[_0xb05664(0x13c5)]||'')+'\x20'+(_0x1eb645[_0xb05664(0xe79)]||'');else _0x1eb645[_0xb05664(0xe7f)]&&(_0x531be8=_0x1eb645[_0xb05664(0xede)]);}}}return _0x531be8['toLowerCase']()[_0xb05664(0x1336)](_0x2e78d7);}));if(_0x8f28d5){const _0x340a6a=new Date(_0x8f28d5),_0x38307c=new Date(_0x340a6a['setHours'](0x0,0x0,0x0,0x0))['getTime'](),_0x15c33a=new Date(_0x340a6a[_0x5bcd9c(0x108c)](0x17,0x3b,0x3b,0x3e7))[_0x5bcd9c(0x120b)]();_0x178b4d=_0x178b4d[_0x5bcd9c(0x1c0)](_0x14c565=>_0x14c565['timestamp']>=_0x38307c&&_0x14c565[_0x5bcd9c(0xb0a)]<=_0x15c33a);}await _0x433193(_0x178b4d);}async function _0x433193(_0x584b7f){const _0x52e67c=_0x3ce1fb,_0x10bf95=document['getElementById'](_0x52e67c(0x125c)),_0x372b92=_0x16699d[_0x52e67c(0x1474)][_0x16699d[_0x52e67c(0xf5a)]];_0x10bf95[_0x52e67c(0xb6f)]='';if(_0x584b7f[_0x52e67c(0xaf9)]===0x0){_0x10bf95[_0x52e67c(0xb6f)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>未找到相关的聊天记录。</p>';return;}let _0x35463a='';for(const _0x96576c of _0x584b7f){const _0x45de39=new Date(_0x96576c[_0x52e67c(0xb0a)]),_0x507a12=_0x45de39[_0x52e67c(0xf98)]();if(_0x507a12!==_0x35463a){const _0x50c6a9=document['createElement'](_0x52e67c(0x379));_0x50c6a9[_0x52e67c(0x35b)]=_0x52e67c(0x1213),_0x50c6a9[_0x52e67c(0x10cb)]=_0x52e67c(0xddb)+_0x45de39[_0x52e67c(0x3c5)]()+'年'+(_0x45de39['getMonth']()+0x1)+'月'+_0x45de39[_0x52e67c(0x13fb)]()+'日\x20---',_0x10bf95['appendChild'](_0x50c6a9),_0x35463a=_0x507a12;}const _0x4cb633=await _0x1f8f7b(_0x96576c,_0x372b92);_0x4cb633&&(_0x4cb633[_0x52e67c(0xf74)][_0x52e67c(0x12f7)]='pointer',_0x4cb633[_0x52e67c(0x339)](_0x52e67c(0x4f6),()=>_0x2c3dd0(_0x96576c[_0x52e67c(0xb0a)])),_0x10bf95[_0x52e67c(0x6b6)](_0x4cb633));}}async function _0x2c3dd0(_0x483550){const _0x1d31f2=_0x3ce1fb,_0x256e2f=_0x16699d[_0x1d31f2(0xf5a)];if(!_0x256e2f)return;_0x58c3b1(_0x1d31f2(0x152e)),setTimeout(async()=>{const _0x2c0b9a=_0x1d31f2,_0x285a8d=document[_0x2c0b9a(0x948)]('chat-messages'),_0x5502f7=_0x2c0b9a(0x12bb)+_0x483550+'\x22]';let _0x20a9e0=_0x285a8d['querySelector'](_0x5502f7),_0x871937=0x0;const _0x3d23ec=0x14;while(!_0x20a9e0&&_0x871937<_0x3d23ec){const _0x131fa4=document[_0x2c0b9a(0x948)]('load-more-btn');if(_0x131fa4)console[_0x2c0b9a(0x498)](_0x2c0b9a(0x1214)+(_0x871937+0x1)+')'),await _0xb02fa8(),_0x20a9e0=_0x285a8d[_0x2c0b9a(0xfeb)](_0x5502f7),_0x871937++;else break;}_0x27dd05(_0x483550);},0xc8);}async function _0x1b3af6(){const _0x25a721=_0x3ce1fb;document[_0x25a721(0x948)](_0x25a721(0xcba))[_0x25a721(0x5bc)]='',document[_0x25a721(0x948)]('date-search-input')[_0x25a721(0x5bc)]='',await _0x433193(_0x16699d[_0x25a721(0x1474)][_0x16699d['activeChatId']][_0x25a721(0xb07)][_0x25a721(0x1c0)](_0x188af0=>!_0x188af0[_0x25a721(0x583)]));}async function _0x129767(_0x2b2e42=![],_0x487af8=null,_0x1c6270=null){const _0x368b47=_0x3ce1fb,_0x2ed477=document[_0x368b47(0x948)](_0x368b47(0x11ba)),_0x2d3ee4=document[_0x368b47(0x948)](_0x368b47(0xebc)),_0x514176=_0x16699d[_0x368b47(0x1474)][_0x16699d[_0x368b47(0xf5a)]];_0x2ed477[_0x368b47(0xb6f)]='',_0x2d3ee4[_0x368b47(0xb6f)]='';const _0x365e8e=await _0x6ed281[_0x368b47(0x1581)][_0x368b47(0x443)](),_0x523428=[..._0x6a7d66,..._0x365e8e];document[_0x368b47(0xfeb)](_0x368b47(0x2fb))['style']['display']=_0x2b2e42?'none':_0x368b47(0x6a4),document[_0x368b47(0x948)](_0x368b47(0x1fc))[_0x368b47(0xf74)][_0x368b47(0x11fd)]=_0x368b47(0x1273),document[_0x368b47(0x948)](_0x368b47(0xc13))[_0x368b47(0xf74)][_0x368b47(0x11fd)]='none',document['getElementById'](_0x368b47(0x13d2))['classList'][_0x368b47(0xbd0)](_0x368b47(0x115e)),document[_0x368b47(0x948)](_0x368b47(0x902))[_0x368b47(0xd54)][_0x368b47(0xf89)](_0x368b47(0x115e));if(_0x2b2e42)_0x523428['forEach'](_0xee00bd=>{const _0x4f6648=_0x368b47,_0x3abe9a=_0x105b46(_0xee00bd,'my',_0x487af8);_0xee00bd['url']===_0x1c6270&&_0x3abe9a[_0x4f6648(0xd54)]['add']('selected'),_0x2ed477['appendChild'](_0x3abe9a);});else{const _0x1d8e6b=_0x514176[_0x368b47(0x7fd)][_0x368b47(0x156d)]||_0x202ba5,_0xcddaaf=_0x514176[_0x368b47(0x7fd)]['myAvatar']||(_0x514176[_0x368b47(0x1173)]?_0x5c1dc1:_0x202ba5);_0x523428[_0x368b47(0x427)](_0x3bda8a=>{const _0x2bbacb=_0x368b47,_0x17b93c=_0x105b46(_0x3bda8a,'ai',_0x1d8e6b);if(_0x3bda8a[_0x2bbacb(0x9a8)]===_0x10b258['ai'])_0x17b93c[_0x2bbacb(0xd54)]['add']('selected');_0x2ed477[_0x2bbacb(0x6b6)](_0x17b93c);const _0x286802=_0x105b46(_0x3bda8a,'my',_0xcddaaf);if(_0x3bda8a['url']===_0x10b258['my'])_0x286802[_0x2bbacb(0xd54)]['add'](_0x2bbacb(0xd56));_0x2d3ee4[_0x2bbacb(0x6b6)](_0x286802);});}}function _0x105b46(_0x578f31,_0x17dceb,_0x308231){const _0xfa627c=_0x3ce1fb,_0xda7971=document[_0xfa627c(0x1497)](_0xfa627c(0x379));_0xda7971[_0xfa627c(0x35b)]=_0xfa627c(0x13ad),_0xda7971[_0xfa627c(0x606)][_0xfa627c(0x1540)]=_0x578f31[_0xfa627c(0x9a8)],_0xda7971[_0xfa627c(0xb03)]=_0x578f31[_0xfa627c(0x1467)];const _0x30155c=typeof _0x578f31['id']===_0xfa627c(0xa97),_0x1fa04a=_0x30155c?_0xfa627c(0xc1a)+_0x578f31['id']+'\x22\x20style=\x22display:block;\x22>×</button>':'';return _0xda7971[_0xfa627c(0xb6f)]=_0xfa627c(0x5d7)+_0x1fa04a+_0xfa627c(0x754)+_0x308231+_0xfa627c(0xa71)+(_0x578f31[_0xfa627c(0x9a8)]?_0xfa627c(0x4ad)+_0x578f31[_0xfa627c(0x9a8)]+_0xfa627c(0xb89):'')+'\x0a\x20\x20\x20\x20',_0xda7971[_0xfa627c(0x339)]('click',_0x174170=>{const _0x13973e=_0xfa627c;if(_0x174170['target'][_0x13973e(0xd54)][_0x13973e(0x7a0)](_0x13973e(0xd38)))return;if(_0x510843){if(_0x30155c){const _0x28ac33=parseInt(_0x578f31['id']);_0xda7971[_0x13973e(0xd54)][_0x13973e(0x69d)]('selected'),_0x4eda35[_0x13973e(0xda1)](_0x28ac33)?_0x4eda35[_0x13973e(0x869)](_0x28ac33):_0x4eda35[_0x13973e(0xbd0)](_0x28ac33),_0x396343();}}else{_0x10b258[_0x17dceb]=_0x578f31[_0x13973e(0x9a8)];const _0x3a92f2=_0x17dceb==='ai'?document['getElementById'](_0x13973e(0x11ba)):document[_0x13973e(0x948)](_0x13973e(0xebc));_0x3a92f2[_0x13973e(0x1188)]('.frame-item')['forEach'](_0x52a9ee=>_0x52a9ee[_0x13973e(0xd54)]['remove'](_0x13973e(0xd56))),_0xda7971[_0x13973e(0xd54)][_0x13973e(0xbd0)]('selected');}}),_0xda7971;}async function _0x571513(){const _0x377277=_0x3ce1fb,_0x4abcd6=document['getElementById']('custom-frame-upload-input'),_0x580e7d=await new Promise(_0x103075=>{const _0x4024af=_0x6c9e,_0xc44f92=_0x9712bb=>{const _0x5a5d36=_0x6c9e;_0x103075(_0x9712bb['target'][_0x5a5d36(0x10b0)][0x0]||null),_0x4abcd6[_0x5a5d36(0x1558)](_0x5a5d36(0x145c),_0xc44f92);};_0x4abcd6[_0x4024af(0x339)](_0x4024af(0x145c),_0xc44f92,{'once':!![]}),_0x4abcd6[_0x4024af(0x4f6)]();});if(!_0x580e7d)return;const _0x504539=await _0x41b9fc(_0x377277(0x1f1),_0x377277(0xfb1));if(!_0x504539||!_0x504539[_0x377277(0x2a8)]())return;const _0x4a8937=await new Promise(_0x9225b0=>{const _0x550595=_0x377277,_0x5e087a=new FileReader();_0x5e087a[_0x550595(0x33a)]=()=>_0x9225b0(_0x5e087a[_0x550595(0x22a)]),_0x5e087a[_0x550595(0x5a5)](_0x580e7d);});await _0x6ed281[_0x377277(0x1581)][_0x377277(0xbd0)]({'name':_0x504539['trim'](),'url':_0x4a8937}),_0x129767(_0x1dfe69);}async function _0x72dc2a(){const _0x52d8b8=_0x3ce1fb,_0x29579c='请按照以下格式粘贴，一行一个：\x0a\x0a头像框名字1:\x20https://.../image1.png\x0a头像框名字2:\x20https://.../image2.gif',_0xae4916=await _0x41b9fc('批量导入头像框',_0x52d8b8(0x14ca),'','textarea',_0x52d8b8(0x1109)+_0x29579c+_0x52d8b8(0x79d));if(!_0xae4916||!_0xae4916[_0x52d8b8(0x2a8)]())return;const _0x5f1933=_0xae4916[_0x52d8b8(0x2a8)]()[_0x52d8b8(0x46f)]('\x0a'),_0x16a705=[];let _0x1fda37=0x0;for(const _0x2be5f2 of _0x5f1933){const _0x44e999=_0x2be5f2['match'](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x44e999)_0x16a705[_0x52d8b8(0x1001)]({'name':_0x44e999[0x1][_0x52d8b8(0x2a8)](),'url':_0x44e999[0x2]['trim']()});else _0x2be5f2[_0x52d8b8(0x2a8)]()&&_0x1fda37++;}_0x16a705['length']>0x0&&(await _0x6ed281[_0x52d8b8(0x1581)][_0x52d8b8(0x571)](_0x16a705),_0x129767(_0x1dfe69),await _0x104485('导入成功','成功导入\x20'+_0x16a705['length']+_0x52d8b8(0x130d))),_0x1fda37>0x0&&await _0x104485('部分失败','有\x20'+_0x1fda37+_0x52d8b8(0x129a));}async function _0x282057(_0x221922){const _0x432343=_0x3ce1fb,_0x528d71=await _0x6ed281[_0x432343(0x1581)][_0x432343(0xe8c)](_0x221922);if(!_0x528d71)return;const _0x2f56f3=await _0xa6b74a('确认删除',_0x432343(0x262)+_0x528d71['name']+_0x432343(0x2dd),{'confirmButtonClass':'btn-danger'});_0x2f56f3&&(await _0x6ed281[_0x432343(0x1581)][_0x432343(0x869)](_0x221922),_0x129767(_0x1dfe69));}let _0x14f07c=0x0;const _0x2ac184=0x2;function _0x31028e(){const _0x267c74=_0x3ce1fb,_0xd65b93=document[_0x267c74(0x948)](_0x267c74(0x127c)),_0x9d1953=document[_0x267c74(0x948)]('home-screen-pages'),_0x47e598=document[_0x267c74(0x1188)]('.pagination-dot');let _0x7c770=0x0,_0x7ec9c6=0x0,_0x5ae1c3=0x0,_0x3a3ad0=![],_0x1e99fb=!![];const _0x22cbe7=()=>{const _0x37eaad=_0x267c74;_0x9d1953[_0x37eaad(0xf74)][_0x37eaad(0x79c)]=_0x37eaad(0x484)+_0x14f07c*(0x64/_0x2ac184)+'%)',_0x47e598[_0x37eaad(0x427)]((_0x3c1b1c,_0x241af5)=>{const _0x49c8bf=_0x37eaad;_0x3c1b1c[_0x49c8bf(0xd54)][_0x49c8bf(0x69d)]('active',_0x241af5===_0x14f07c);});},_0x2889c0=_0x5a53d3=>{const _0x4d0963=_0x267c74;_0x3a3ad0=!![],_0x1e99fb=!![],_0x7c770=_0x5a53d3[_0x4d0963(0x4ae)][_0x4d0963(0x1336)](_0x4d0963(0x1542))?_0x5a53d3[_0x4d0963(0x1ed)]:_0x5a53d3[_0x4d0963(0x63b)][0x0][_0x4d0963(0x1ed)],_0x7ec9c6=_0x5a53d3[_0x4d0963(0x4ae)][_0x4d0963(0x1336)](_0x4d0963(0x1542))?_0x5a53d3[_0x4d0963(0x947)]:_0x5a53d3[_0x4d0963(0x63b)][0x0]['pageY'],_0x9d1953[_0x4d0963(0xf74)][_0x4d0963(0xbc7)]=_0x4d0963(0x12fe);},_0x4531b3=_0x7f1c51=>{const _0xfd9014=_0x267c74;if(!_0x3a3ad0)return;const _0x39121d=_0x7f1c51['type'][_0xfd9014(0x1336)]('mouse')?_0x7f1c51[_0xfd9014(0x947)]:_0x7f1c51[_0xfd9014(0x63b)][0x0][_0xfd9014(0x947)];_0x5ae1c3=_0x7f1c51['type'][_0xfd9014(0x1336)]('mouse')?_0x7f1c51[_0xfd9014(0x1ed)]:_0x7f1c51[_0xfd9014(0x63b)][0x0][_0xfd9014(0x1ed)];const _0xe24b9b=_0x5ae1c3-_0x7c770,_0x10a107=_0x39121d-_0x7ec9c6;_0x1e99fb&&(Math[_0xfd9014(0x7d6)](_0xe24b9b)>0xa||Math[_0xfd9014(0x7d6)](_0x10a107)>0xa)&&(_0x1e99fb=![]);if(Math[_0xfd9014(0x7d6)](_0xe24b9b)>Math['abs'](_0x10a107)){if(_0x7f1c51['cancelable'])_0x7f1c51[_0xfd9014(0x38f)]();_0x9d1953[_0xfd9014(0xf74)]['transform']=_0xfd9014(0x140d)+_0x14f07c*(0x64/_0x2ac184)+_0xfd9014(0x298)+_0xe24b9b+_0xfd9014(0x34a);}},_0xaa987e=_0xf33cb5=>{const _0x1fbf11=_0x267c74;if(!_0x3a3ad0)return;_0x3a3ad0=![],_0x9d1953[_0x1fbf11(0xf74)][_0x1fbf11(0xbc7)]=_0x1fbf11(0xdc6);if(_0x1e99fb){_0x22cbe7();return;}const _0x9d21b5=_0x5ae1c3-_0x7c770;if(Math[_0x1fbf11(0x7d6)](_0x9d21b5)>_0xd65b93['offsetWidth']/0x4){if(_0x9d21b5>0x0&&_0x14f07c>0x0)_0x14f07c--;else _0x9d21b5<0x0&&_0x14f07c<_0x2ac184-0x1&&_0x14f07c++;}_0x22cbe7();};_0xd65b93[_0x267c74(0x339)](_0x267c74(0xf08),_0x2889c0),_0xd65b93[_0x267c74(0x339)](_0x267c74(0x10a3),_0x4531b3),_0xd65b93[_0x267c74(0x339)](_0x267c74(0x637),_0xaa987e),_0xd65b93['addEventListener'](_0x267c74(0x6d4),_0xaa987e),_0xd65b93[_0x267c74(0x339)]('touchstart',_0x2889c0,{'passive':![]}),_0xd65b93['addEventListener'](_0x267c74(0x242),_0x4531b3,{'passive':![]}),_0xd65b93[_0x267c74(0x339)]('touchend',_0xaa987e);}let _0x1ce6f0=null;async function _0x3a337d(){await _0x153031(),_0x58c3b1('preset-screen');}async function _0x153031(){const _0x3d4208=_0x3ce1fb,_0xff0427=document[_0x3d4208(0x948)]('preset-tabs'),_0x9d8b84=document[_0x3d4208(0x948)]('preset-content-container');_0xff0427[_0x3d4208(0xb6f)]='',_0x9d8b84[_0x3d4208(0xb6f)]='';const [_0x48d371,_0x19ac8d]=await Promise[_0x3d4208(0xd49)]([_0x6ed281[_0x3d4208(0xd44)]['toArray'](),_0x6ed281[_0x3d4208(0x140b)][_0x3d4208(0x1088)](_0x3d4208(0x1467))[_0x3d4208(0x443)]()]);_0x16699d[_0x3d4208(0xd44)]=_0x48d371;if(_0x48d371[_0x3d4208(0xaf9)]===0x0){_0x9d8b84['innerHTML']=_0x3d4208(0x4f9);return;}const _0x22534c=document[_0x3d4208(0x1497)]('button');_0x22534c['className']=_0x3d4208(0x51e),_0x22534c[_0x3d4208(0x10cb)]='全部',_0x22534c[_0x3d4208(0x606)][_0x3d4208(0xd86)]=_0x3d4208(0xd49),_0xff0427[_0x3d4208(0x6b6)](_0x22534c);const _0x25e3a3=document[_0x3d4208(0x1497)](_0x3d4208(0x379));_0x25e3a3[_0x3d4208(0x35b)]='world-book-category-pane\x20active',_0x25e3a3[_0x3d4208(0x606)][_0x3d4208(0xd86)]=_0x3d4208(0xd49),_0x9d8b84[_0x3d4208(0x6b6)](_0x25e3a3),_0x19ac8d[_0x3d4208(0x427)](_0x27228f=>{const _0x22cc4e=_0x3d4208,_0x277c4b=document[_0x22cc4e(0x1497)](_0x22cc4e(0x4e6));_0x277c4b[_0x22cc4e(0x35b)]=_0x22cc4e(0x10e4),_0x277c4b[_0x22cc4e(0x10cb)]=_0x27228f[_0x22cc4e(0x1467)],_0x277c4b['dataset'][_0x22cc4e(0xd86)]=String(_0x27228f['id']),_0xff0427[_0x22cc4e(0x6b6)](_0x277c4b);const _0x1818bd=document[_0x22cc4e(0x1497)](_0x22cc4e(0x379));_0x1818bd[_0x22cc4e(0x35b)]=_0x22cc4e(0xe4d),_0x1818bd[_0x22cc4e(0x606)]['categoryId']=String(_0x27228f['id']),_0x9d8b84[_0x22cc4e(0x6b6)](_0x1818bd);});const _0x54aa44=_0x48d371[_0x3d4208(0x1502)](_0x2a3240=>!_0x2a3240[_0x3d4208(0xd86)]);if(_0x54aa44){const _0x451fdd=document[_0x3d4208(0x1497)](_0x3d4208(0x4e6));_0x451fdd[_0x3d4208(0x35b)]=_0x3d4208(0x10e4),_0x451fdd[_0x3d4208(0x10cb)]=_0x3d4208(0x14cd),_0x451fdd[_0x3d4208(0x606)][_0x3d4208(0xd86)]=_0x3d4208(0x149b),_0xff0427[_0x3d4208(0x6b6)](_0x451fdd);const _0x443de1=document[_0x3d4208(0x1497)](_0x3d4208(0x379));_0x443de1[_0x3d4208(0x35b)]=_0x3d4208(0xe4d),_0x443de1[_0x3d4208(0x606)][_0x3d4208(0xd86)]=_0x3d4208(0x149b),_0x9d8b84[_0x3d4208(0x6b6)](_0x443de1);}_0x48d371[_0x3d4208(0x427)](_0xa6439d=>{const _0x46b0d0=_0x3d4208,_0x2238a7='该预设包含\x20'+_0xa6439d['content'][_0x46b0d0(0xaf9)]+_0x46b0d0(0x710),_0x5f4112=document[_0x46b0d0(0x1497)]('div');_0x5f4112[_0x46b0d0(0x35b)]=_0x46b0d0(0x1570),_0x5f4112[_0x46b0d0(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>'+_0xa6439d[_0x46b0d0(0x1467)]+_0x46b0d0(0xf3a)+_0x2238a7+_0x46b0d0(0x13aa);const _0x4b036a=()=>_0x228a53(_0xa6439d['id']),_0x38a110=async()=>{const _0x132310=_0x46b0d0,_0x520348=await _0xa6b74a(_0x132310(0xbc2),_0x132310(0x1595)+_0xa6439d['name']+'》吗？',{'confirmButtonClass':'btn-danger'});_0x520348&&(await _0x6ed281[_0x132310(0xd44)]['delete'](_0xa6439d['id']),_0x16699d['presets']=await _0x6ed281['presets'][_0x132310(0x443)](),_0x153031());};_0x5f4112[_0x46b0d0(0x339)](_0x46b0d0(0x4f6),_0x4b036a),_0x159366(_0x5f4112,_0x38a110);const _0x44667f=_0x5f4112['cloneNode'](!![]);_0x44667f[_0x46b0d0(0x339)](_0x46b0d0(0x4f6),_0x4b036a),_0x159366(_0x44667f,_0x38a110),_0x25e3a3[_0x46b0d0(0x6b6)](_0x44667f);const _0x4cbe3e=_0xa6439d['categoryId']?String(_0xa6439d[_0x46b0d0(0xd86)]):_0x46b0d0(0x149b),_0x3f1a27=_0x9d8b84[_0x46b0d0(0xfeb)]('.world-book-category-pane[data-category-id=\x22'+_0x4cbe3e+'\x22]');_0x3f1a27&&_0x3f1a27[_0x46b0d0(0x6b6)](_0x5f4112);}),document['querySelectorAll']('#preset-tabs\x20.world-book-tab')[_0x3d4208(0x427)](_0x259ee0=>{const _0x21d3b0=_0x3d4208;_0x259ee0['addEventListener']('click',()=>_0x2522a6(_0x259ee0[_0x21d3b0(0x606)]['categoryId']));});}function _0x2522a6(_0x7e6cd0){const _0x42d06e=_0x3ce1fb;document[_0x42d06e(0x1188)](_0x42d06e(0x1113))[_0x42d06e(0x427)](_0x4e82ac=>{const _0x322150=_0x42d06e;_0x4e82ac[_0x322150(0xd54)]['toggle']('active',_0x4e82ac[_0x322150(0x606)][_0x322150(0xd86)]===_0x7e6cd0);}),document['querySelectorAll']('#preset-content-container\x20.world-book-category-pane')[_0x42d06e(0x427)](_0x5c7c0a=>{const _0x11867b=_0x42d06e;_0x5c7c0a[_0x11867b(0xd54)][_0x11867b(0x69d)](_0x11867b(0x115e),_0x5c7c0a[_0x11867b(0x606)]['categoryId']===_0x7e6cd0);});}async function _0x228a53(_0x4059c4){const _0x4b5e38=_0x3ce1fb;_0x58c3b1(_0x4b5e38(0x8e4)),_0x1ce6f0=_0x4059c4;try{const [_0x2949ac,_0x4e6027]=await Promise['all']([_0x6ed281[_0x4b5e38(0xd44)][_0x4b5e38(0xe8c)](_0x4059c4),_0x6ed281['presetCategories']['toArray']()]);if(!_0x2949ac){console[_0x4b5e38(0xc3e)](_0x4b5e38(0x736),_0x4059c4),await _0x104485('加载失败',_0x4b5e38(0xc2a)),_0x58c3b1('preset-screen');return;}setTimeout(()=>{const _0x39fecd=_0x4b5e38;document['getElementById'](_0x39fecd(0xf24))['textContent']=_0x2949ac['name'],document[_0x39fecd(0x948)](_0x39fecd(0x136e))['value']=_0x2949ac['name'];const _0x2c3454=document['getElementById'](_0x39fecd(0x934));_0x2c3454[_0x39fecd(0xb6f)]=_0x39fecd(0x6b8),_0x4e6027[_0x39fecd(0x427)](_0x26d8c8=>{const _0x1e7051=_0x39fecd,_0x397737=document['createElement'](_0x1e7051(0x152c));_0x397737[_0x1e7051(0x5bc)]=_0x26d8c8['id'],_0x397737['textContent']=_0x26d8c8[_0x1e7051(0x1467)];if(_0x2949ac['categoryId']===_0x26d8c8['id'])_0x397737[_0x1e7051(0xd56)]=!![];_0x2c3454['appendChild'](_0x397737);});const _0x57ed94=document[_0x39fecd(0x948)](_0x39fecd(0x8cc));_0x57ed94[_0x39fecd(0xb6f)]='',Array[_0x39fecd(0x1524)](_0x2949ac[_0x39fecd(0xede)])&&_0x2949ac[_0x39fecd(0xede)][_0x39fecd(0xaf9)]>0x0?_0x2949ac[_0x39fecd(0xede)][_0x39fecd(0x427)](_0x1f00fb=>{const _0x2aabcd=_0x39fecd,_0x2b1487=_0x47c851(_0x1f00fb);_0x57ed94[_0x2aabcd(0x6b6)](_0x2b1487);}):_0x57ed94[_0x39fecd(0xb6f)]=_0x39fecd(0x1417);},0x32);}catch(_0x3c1fbb){console[_0x4b5e38(0xc3e)](_0x4b5e38(0x709),_0x3c1fbb),await _0x104485('加载失败',_0x4b5e38(0xbd8)+_0x3c1fbb[_0x4b5e38(0x74b)]),_0x58c3b1(_0x4b5e38(0xf87));}}function _0x47c851(_0x5dd520={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x116b30=_0x3ce1fb,_0x2304e3=document[_0x116b30(0x1497)](_0x116b30(0x379));_0x2304e3[_0x116b30(0x35b)]='message-editor-block';const _0x25be56=_0x5dd520[_0x116b30(0x111f)]!==![]?_0x116b30(0x210):'';_0x2304e3[_0x116b30(0xb6f)]=_0x116b30(0xc5c)+_0x25be56+_0x116b30(0x9fc)+(_0x5dd520['comment']||'')+_0x116b30(0x953)+(_0x5dd520[_0x116b30(0x1cf)]||[])[_0x116b30(0x121a)](',\x20')+'\x22\x20placeholder=\x22例如:\x20key1,\x20key2\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20这里是全新的、带有“展开/收起”按钮的结构\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x20display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>内容\x20(点击右侧展开)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22toggle-content-btn\x22>展开</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22entry-content-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x228\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>'+(_0x5dd520[_0x116b30(0xede)]||'')+_0x116b30(0x14cb),_0x2304e3[_0x116b30(0xfeb)](_0x116b30(0x524))['addEventListener'](_0x116b30(0x4f6),()=>_0x2304e3[_0x116b30(0xf89)]());const _0x2d83a2=_0x2304e3[_0x116b30(0xfeb)](_0x116b30(0x1389)),_0xe4fe2a=_0x2304e3[_0x116b30(0xfeb)](_0x116b30(0x22f));return _0x2d83a2[_0x116b30(0x339)](_0x116b30(0x4f6),()=>{const _0x1cb08a=_0x116b30,_0x32a8c7=_0xe4fe2a[_0x1cb08a(0xf74)]['display']===_0x1cb08a(0x12fe);_0xe4fe2a[_0x1cb08a(0xf74)][_0x1cb08a(0x11fd)]=_0x32a8c7?_0x1cb08a(0x1273):_0x1cb08a(0x12fe),_0x2d83a2[_0x1cb08a(0x10cb)]=_0x32a8c7?'收起':'展开';}),_0x2304e3;}async function _0x3128e3(){const _0x102eb9=_0x3ce1fb;await _0x3f13ba(),document[_0x102eb9(0xfeb)]('#group-management-modal\x20.modal-header\x20span')['textContent']=_0x102eb9(0xa23),document['getElementById'](_0x102eb9(0x1534))['onclick']=_0x1fd3a4,document[_0x102eb9(0x948)](_0x102eb9(0xc1c))[_0x102eb9(0xe8d)]=_0x3e36b3=>{const _0x272448=_0x102eb9;_0x3e36b3[_0x272448(0xa50)][_0x272448(0xd54)][_0x272448(0x7a0)](_0x272448(0x529))&&_0x1b5bef(parseInt(_0x3e36b3[_0x272448(0xa50)][_0x272448(0x606)]['id']));},document[_0x102eb9(0x948)](_0x102eb9(0x74f))[_0x102eb9(0xe8d)]=()=>{const _0x528ba4=_0x102eb9;document['getElementById']('group-management-modal')[_0x528ba4(0xd54)][_0x528ba4(0xf89)](_0x528ba4(0xfcb)),_0x153031();},document[_0x102eb9(0x948)](_0x102eb9(0xa08))[_0x102eb9(0xd54)][_0x102eb9(0xbd0)]('visible');}async function _0x3f13ba(){const _0x347893=_0x3ce1fb,_0x211f27=document[_0x347893(0x948)](_0x347893(0xc1c)),_0x2672f1=await _0x6ed281[_0x347893(0x140b)][_0x347893(0x443)]();_0x211f27[_0x347893(0xb6f)]='',_0x2672f1['length']===0x0&&(_0x211f27['innerHTML']='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>'),_0x2672f1[_0x347893(0x427)](_0x2ea6ab=>{const _0x450cca=_0x347893,_0x5d28ac=document[_0x450cca(0x1497)](_0x450cca(0x379));_0x5d28ac[_0x450cca(0x35b)]=_0x450cca(0x1271),_0x5d28ac[_0x450cca(0xb6f)]=_0x450cca(0x1492)+_0x2ea6ab['name']+_0x450cca(0x485)+_0x2ea6ab['id']+_0x450cca(0x1394),_0x211f27[_0x450cca(0x6b6)](_0x5d28ac);});}async function _0x1fd3a4(){const _0x5a5b8a=_0x3ce1fb,_0x1f22f4=document['getElementById'](_0x5a5b8a(0x639)),_0x4436d9=_0x1f22f4[_0x5a5b8a(0x5bc)]['trim']();if(!_0x4436d9)return alert('分类名不能为空！');const _0x34816a=await _0x6ed281['presetCategories'][_0x5a5b8a(0x1117)](_0x5a5b8a(0x1467))[_0x5a5b8a(0xba9)](_0x4436d9)[_0x5a5b8a(0x678)]();if(_0x34816a)return alert('分类\x20\x22'+_0x4436d9+_0x5a5b8a(0x60e));await _0x6ed281[_0x5a5b8a(0x140b)]['add']({'name':_0x4436d9}),_0x1f22f4[_0x5a5b8a(0x5bc)]='',await _0x3f13ba();}async function _0x1b5bef(_0x1d046b){const _0x3ac749=_0x3ce1fb,_0x31f6e4=await _0xa6b74a('确认删除','删除分类后，该分类下的所有预设将变为“未分类”。确定吗？',{'confirmButtonClass':'btn-danger'});_0x31f6e4&&(await _0x6ed281[_0x3ac749(0x140b)]['delete'](_0x1d046b),await _0x6ed281['presets']['where'](_0x3ac749(0xd86))['equals'](_0x1d046b)[_0x3ac749(0x11b6)]({'categoryId':null}),_0x16699d['presets']=await _0x6ed281[_0x3ac749(0xd44)]['toArray'](),await _0x3f13ba());}async function _0x1a0f50(_0x5d5a03){const _0x2688b1=_0x3ce1fb,_0x294448=_0x5d5a03[_0x2688b1(0xa50)][_0x2688b1(0x10b0)][0x0];if(!_0x294448)return;try{if(!_0x294448[_0x2688b1(0x1467)][_0x2688b1(0x918)](_0x2688b1(0x9ce)))throw new Error(_0x2688b1(0xd10));const _0xb90d71=await _0x294448['text'](),_0x198a39=JSON[_0x2688b1(0xde0)](_0xb90d71);await _0x2dafc6(_0x198a39,_0x294448[_0x2688b1(0x1467)]);}catch(_0x3cd29b){console[_0x2688b1(0xc3e)](_0x2688b1(0x318),_0x3cd29b),await _0x104485(_0x2688b1(0xd89),_0x2688b1(0x1111)+_0x3cd29b[_0x2688b1(0x74b)]);}finally{_0x5d5a03[_0x2688b1(0xa50)][_0x2688b1(0x5bc)]=null;}}async function _0x2dafc6(_0x2b42da,_0x402e3a){const _0x369944=_0x3ce1fb;let _0x1afd8a=[];if(Array[_0x369944(0x1524)](_0x2b42da[_0x369944(0x1327)])&&Array[_0x369944(0x1524)](_0x2b42da[_0x369944(0x7af)])&&_0x2b42da[_0x369944(0x7af)][_0x369944(0xaf9)]>0x0){console[_0x369944(0x498)](_0x369944(0xe3f));const _0xf77e47=new Map(_0x2b42da[_0x369944(0x1327)][_0x369944(0x8ff)](_0x2680d6=>[_0x2680d6[_0x369944(0x13e4)],_0x2680d6])),_0x31b04a=_0x2b42da[_0x369944(0x7af)][_0x369944(0x6ab)]((_0x1f42b,_0x302233)=>_0x302233[_0x369944(0x12e7)]&&_0x302233[_0x369944(0x12e7)][_0x369944(0xaf9)]>(_0x1f42b['length']||0x0)?_0x302233[_0x369944(0x12e7)]:_0x1f42b,[]);_0x31b04a&&_0x31b04a[_0x369944(0xaf9)]>0x0&&(_0x1afd8a=_0x31b04a[_0x369944(0x8ff)](_0x2293c6=>{const _0x36336e=_0x369944,_0x32a48d=_0xf77e47[_0x36336e(0xe8c)](_0x2293c6[_0x36336e(0x13e4)]);if(_0x32a48d)return{'keys':[],'comment':_0x32a48d[_0x36336e(0x1467)]||_0x36336e(0x284),'content':_0x32a48d['content']||'','enabled':_0x2293c6[_0x36336e(0x111f)]};return null;})[_0x369944(0x1c0)](Boolean));}else{if(_0x2b42da[_0x369944(0x6ea)]&&typeof _0x2b42da[_0x369944(0x6ea)]==='object')console[_0x369944(0x498)](_0x369944(0x99e)),Array[_0x369944(0x1524)](_0x2b42da[_0x369944(0x12e7)])?(console['log'](_0x369944(0xda3)),_0x1afd8a=_0x2b42da[_0x369944(0x12e7)][_0x369944(0x8ff)](_0x2bfbb1=>_0x2b42da[_0x369944(0x6ea)][_0x2bfbb1])[_0x369944(0x1c0)](Boolean)['map'](_0x821b5c=>({'keys':_0x821b5c[_0x369944(0x1212)]||[],'comment':_0x821b5c[_0x369944(0x282)]||_0x369944(0xae0),'content':_0x821b5c[_0x369944(0xede)]||'','enabled':!_0x821b5c[_0x369944(0xb73)]}))):(console[_0x369944(0x9c1)](_0x369944(0x2d2)),_0x1afd8a=Object[_0x369944(0x1166)](_0x2b42da['entries'])[_0x369944(0x8ff)](_0x35b4a5=>({'keys':_0x35b4a5[_0x369944(0x1212)]||[],'comment':_0x35b4a5[_0x369944(0x282)]||_0x369944(0xae0),'content':_0x35b4a5[_0x369944(0xede)]||'','enabled':!_0x35b4a5[_0x369944(0xb73)]})));else{if(Array[_0x369944(0x1524)](_0x2b42da[_0x369944(0x1327)]))console['log'](_0x369944(0x643)),_0x1afd8a=_0x2b42da[_0x369944(0x1327)][_0x369944(0x8ff)](_0x24bf1c=>({'keys':[],'comment':_0x24bf1c[_0x369944(0x1467)]||_0x369944(0x284),'content':_0x24bf1c['content']||'','enabled':!![]}));else throw new Error(_0x369944(0x58a));}}_0x1afd8a=_0x1afd8a[_0x369944(0x1c0)](_0x298822=>_0x298822[_0x369944(0xede)]);if(_0x1afd8a[_0x369944(0xaf9)]===0x0){alert(_0x369944(0x1f0));return;}const _0x1d57c4=_0x402e3a[_0x369944(0x14e9)](/\.json$/i,''),_0x1b1868=await _0x41b9fc(_0x369944(0xd45),_0x369944(0x54d),_0x1d57c4);if(!_0x1b1868||!_0x1b1868['trim']()){alert(_0x369944(0x101d));return;}const _0x1208a4={'id':_0x369944(0x510)+Date[_0x369944(0x1386)](),'name':_0x1b1868[_0x369944(0x2a8)](),'content':_0x1afd8a,'categoryId':null};await _0x6ed281['presets'][_0x369944(0xbd0)](_0x1208a4),_0x16699d[_0x369944(0xd44)][_0x369944(0x1001)](_0x1208a4),await _0x153031(),await _0x104485('导入成功！',_0x369944(0x8cf)+_0x1b1868+'》。');}async function _0x2941ab(_0x12e69f){const _0x7562e0=_0x3ce1fb,_0x1dd4a2=document['getElementById']('offline-preset-select');if(!_0x1dd4a2)return;const _0x5cd896=_0x16699d[_0x7562e0(0xd44)]||[];_0x1dd4a2[_0x7562e0(0xb6f)]=_0x7562e0(0x1480),_0x5cd896[_0x7562e0(0x427)](_0x2202a8=>{const _0x3b06a9=_0x7562e0,_0x42b72f=document[_0x3b06a9(0x1497)](_0x3b06a9(0x152c));_0x42b72f[_0x3b06a9(0x5bc)]=_0x2202a8['id'],_0x42b72f['textContent']=_0x2202a8[_0x3b06a9(0x1467)],_0x1dd4a2[_0x3b06a9(0x6b6)](_0x42b72f);}),_0x12e69f['settings'][_0x7562e0(0x1510)]&&(_0x1dd4a2['value']=_0x12e69f['settings'][_0x7562e0(0x1510)]);}function _0x55593c(){const _0x160a59=_0x3ce1fb,_0x9f016c=document[_0x160a59(0x948)](_0x160a59(0x15b9));if(!_0x9f016c)return;_0x9f016c[_0x160a59(0xb6f)]='';let _0x122030=_0x16699d['globalSettings'][_0x160a59(0x88c)]||_0x2ea104;_0x122030[_0x160a59(0x427)](_0x431dca=>{const _0x49e0dc=_0x160a59,_0x11dcee=document[_0x49e0dc(0x948)](_0x431dca);if(_0x11dcee){const _0x2bb279=document[_0x49e0dc(0x1497)](_0x49e0dc(0x379));_0x2bb279['className']=_0x49e0dc(0xf96),_0x2bb279[_0x49e0dc(0x326)]=!![],_0x2bb279[_0x49e0dc(0x606)][_0x49e0dc(0x9a0)]=_0x431dca,_0x2bb279[_0x49e0dc(0xb6f)]=_0x11dcee[_0x49e0dc(0xb6f)],_0x9f016c[_0x49e0dc(0x6b6)](_0x2bb279);}});}function _0x53f349(){const _0x1462f3=_0x3ce1fb,_0x2bf449=document[_0x1462f3(0x948)]('button-order-editor');if(!_0x2bf449)return;let _0x319a61=null;const _0x274bb0=_0x5a2f0b=>{const _0x1661c0=_0x1462f3,_0x242f0c=_0x5a2f0b[_0x1661c0(0xa50)][_0x1661c0(0x1090)](_0x1661c0(0x2f3));if(!_0x242f0c)return;_0x319a61=_0x242f0c,_0x319a61['classList'][_0x1661c0(0xbd0)]('dragging');if(_0x5a2f0b[_0x1661c0(0x143a)])_0x5a2f0b[_0x1661c0(0x38f)]();},_0x4cec9c=_0x532a49=>{const _0x2f1421=_0x1462f3;if(!_0x319a61)return;const _0x3f6d85=_0x532a49[_0x2f1421(0x4ae)][_0x2f1421(0x1336)](_0x2f1421(0x1542))?_0x532a49[_0x2f1421(0x63d)]:_0x532a49['touches'][0x0][_0x2f1421(0x63d)],_0xa2cf42=_0x5e7aab(_0x2bf449,_0x3f6d85);_0xa2cf42==null?_0x2bf449[_0x2f1421(0x6b6)](_0x319a61):_0x2bf449['insertBefore'](_0x319a61,_0xa2cf42);},_0x29ac8=()=>{const _0x1f6864=_0x1462f3;if(!_0x319a61)return;_0x319a61[_0x1f6864(0xd54)]['remove']('dragging'),_0x319a61=null,_0x2fb692();};_0x2bf449['addEventListener'](_0x1462f3(0xf08),_0x274bb0),_0x2bf449[_0x1462f3(0x339)](_0x1462f3(0xea1),_0x274bb0,{'passive':![]}),_0x2bf449['addEventListener'](_0x1462f3(0x10a3),_0x4cec9c),_0x2bf449['addEventListener'](_0x1462f3(0x242),_0x4cec9c,{'passive':![]}),_0x2bf449[_0x1462f3(0x339)](_0x1462f3(0x637),_0x29ac8),_0x2bf449['addEventListener'](_0x1462f3(0x6d4),_0x29ac8),_0x2bf449[_0x1462f3(0x339)]('touchend',_0x29ac8);}function _0x5e7aab(_0x105360,_0x4c7e2a){const _0x251ab7=_0x3ce1fb,_0xd9da71=[..._0x105360[_0x251ab7(0x1188)](_0x251ab7(0x139a))];return _0xd9da71[_0x251ab7(0x6ab)]((_0x4dbdae,_0x48394b)=>{const _0xdce19=_0x251ab7,_0x1f3542=_0x48394b[_0xdce19(0xde6)](),_0x2a4be1=_0x4c7e2a-_0x1f3542[_0xdce19(0x102f)]-_0x1f3542[_0xdce19(0x977)]/0x2;return _0x2a4be1<0x0&&_0x2a4be1>_0x4dbdae[_0xdce19(0xdd9)]?{'offset':_0x2a4be1,'element':_0x48394b}:_0x4dbdae;},{'offset':Number[_0x251ab7(0x3a0)]})['element'];}async function _0x2fb692(){const _0x5d3ad8=_0x3ce1fb,_0x2fa212=document['getElementById'](_0x5d3ad8(0x15b9)),_0x40ee45=Array['from'](_0x2fa212[_0x5d3ad8(0x1188)](_0x5d3ad8(0x2f3)))[_0x5d3ad8(0x8ff)](_0x25d243=>_0x25d243[_0x5d3ad8(0x606)]['buttonId']);_0x16699d[_0x5d3ad8(0xf9c)]['chatActionButtonsOrder']=_0x40ee45,await _0x6ed281[_0x5d3ad8(0xf9c)][_0x5d3ad8(0x90c)](_0x16699d[_0x5d3ad8(0xf9c)]);}function _0x20a8bd(){const _0x2c807b=_0x3ce1fb,_0x3e00f2=_0x16699d['globalSettings']['chatActionButtonsOrder'];if(!_0x3e00f2||!Array[_0x2c807b(0x1524)](_0x3e00f2)||_0x3e00f2[_0x2c807b(0xaf9)]===0x0)return;const _0x41a7f5=document[_0x2c807b(0x948)](_0x2c807b(0x128e));if(!_0x41a7f5)return;_0x3e00f2[_0x2c807b(0x427)](_0xd69c50=>{const _0x11c307=_0x2c807b,_0x2e930a=document[_0x11c307(0x948)](_0xd69c50);_0x2e930a&&_0x41a7f5[_0x11c307(0x6b6)](_0x2e930a);});}const _0x2ea104=[_0x3ce1fb(0xb94),_0x3ce1fb(0x44a),_0x3ce1fb(0x1203),_0x3ce1fb(0x660),_0x3ce1fb(0x1428),_0x3ce1fb(0x42d),_0x3ce1fb(0xb81),_0x3ce1fb(0x82e),_0x3ce1fb(0xd3e),'share-link-btn',_0x3ce1fb(0x285),_0x3ce1fb(0x235),'open-shopping-btn',_0x3ce1fb(0x659),_0x3ce1fb(0x1045),_0x3ce1fb(0x1377),_0x3ce1fb(0x22b),'show-announcement-board-btn',_0x3ce1fb(0xbf1),_0x3ce1fb(0x304),_0x3ce1fb(0x6cf)];async function _0x4c2aa0(){const _0xa552=_0x3ce1fb;_0x16699d[_0xa552(0xf9c)]['chatActionButtonsOrder']=null,await _0x6ed281['globalSettings'][_0xa552(0x90c)](_0x16699d[_0xa552(0xf9c)]),_0x55593c(),_0x20a8bd(),await _0x104485('成功','按钮顺序已恢复为默认设置！');}let _0x57b581=[],_0x97b451=[];function _0x3a657d(){const _0x412abe=_0x3ce1fb,_0x401ee1=document[_0x412abe(0x948)]('data-clear-wizard-modal');_0x57b581=[],_0x97b451=[],_0x36485e(),document['getElementById'](_0x412abe(0x651))[_0x412abe(0xf74)]['display']=_0x412abe(0x6a4),document[_0x412abe(0x948)](_0x412abe(0xe41))[_0x412abe(0xf74)][_0x412abe(0x11fd)]='none',_0x401ee1[_0x412abe(0xd54)][_0x412abe(0xbd0)](_0x412abe(0xfcb));}function _0x36485e(){const _0x5aaa80=_0x3ce1fb,_0x14252e=document[_0x5aaa80(0x948)](_0x5aaa80(0x1108));_0x14252e[_0x5aaa80(0xb6f)]='';const _0x1c3846=document['createElement'](_0x5aaa80(0x379));_0x1c3846[_0x5aaa80(0x35b)]=_0x5aaa80(0x8f4),_0x1c3846[_0x5aaa80(0x606)]['charId']=_0x5aaa80(0xaeb),_0x1c3846[_0x5aaa80(0xb6f)]=_0x5aaa80(0x116d)+(_0x16699d[_0x5aaa80(0x66e)][_0x5aaa80(0xf4d)]||'我')+_0x5aaa80(0x153d),_0x14252e[_0x5aaa80(0x6b6)](_0x1c3846),Object['values'](_0x16699d['chats'])['forEach'](_0x213f34=>{const _0x6f55c5=_0x5aaa80;if(!_0x213f34[_0x6f55c5(0x1173)]){const _0x2acd00=document['createElement']('div');_0x2acd00[_0x6f55c5(0x35b)]=_0x6f55c5(0x8f4),_0x2acd00['dataset'][_0x6f55c5(0x5fe)]=_0x213f34['id'],_0x2acd00['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x213f34['name']+_0x6f55c5(0xd2f),_0x14252e[_0x6f55c5(0x6b6)](_0x2acd00);}});}function _0x2fffe2(){const _0x1736a9=_0x3ce1fb,_0x2bd60f=document['getElementById'](_0x1736a9(0xfe3));_0x2bd60f[_0x1736a9(0xb6f)]='';const _0x3da9ad=[{'id':_0x1736a9(0xdd2),'name':_0x1736a9(0x916),'description':_0x1736a9(0xf02)},{'id':'qzone','name':'动态与互动','description':_0x1736a9(0x1057)},{'id':'calls','name':_0x1736a9(0x8f1),'description':_0x1736a9(0x13d6)},{'id':_0x1736a9(0x1249),'name':'心声','description':_0x1736a9(0x668)},{'id':_0x1736a9(0x9cc),'name':_0x1736a9(0xc91),'description':_0x1736a9(0x10dc)},{'id':_0x1736a9(0x1dc),'name':'收藏','description':_0x1736a9(0x10a9)},{'id':_0x1736a9(0x1116),'name':_0x1736a9(0xc99),'description':_0x1736a9(0x1575)}];_0x3da9ad[_0x1736a9(0x427)](_0x12ed41=>{const _0x52718c=_0x1736a9,_0x11278b=document[_0x52718c(0x1497)](_0x52718c(0x379));_0x11278b[_0x52718c(0x35b)]=_0x52718c(0x8f4),_0x11278b[_0x52718c(0x606)]['typeId']=_0x12ed41['id'],_0x11278b['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x12ed41[_0x52718c(0x1467)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#888;\x20margin:\x204px\x200\x200;\x22>'+_0x12ed41['description']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x2bd60f['appendChild'](_0x11278b);});}function _0x3d200f(){const _0x3ac066=_0x3ce1fb,_0x5d4dd5=document[_0x3ac066(0x1188)](_0x3ac066(0x2f9));if(_0x5d4dd5[_0x3ac066(0xaf9)]===0x0){alert('请至少选择一个要清理的角色。');return;}_0x57b581=Array[_0x3ac066(0x6e5)](_0x5d4dd5)[_0x3ac066(0x8ff)](_0x365a3e=>_0x365a3e[_0x3ac066(0x606)][_0x3ac066(0x5fe)]),_0x2fffe2(),document[_0x3ac066(0x948)](_0x3ac066(0x651))[_0x3ac066(0xf74)][_0x3ac066(0x11fd)]=_0x3ac066(0x12fe),document[_0x3ac066(0x948)]('data-clear-step-2')[_0x3ac066(0xf74)][_0x3ac066(0x11fd)]='flex';}function _0x57e2c5(){const _0x4003a7=_0x3ce1fb;document[_0x4003a7(0x948)](_0x4003a7(0xe41))[_0x4003a7(0xf74)][_0x4003a7(0x11fd)]='none',document[_0x4003a7(0x948)](_0x4003a7(0x651))[_0x4003a7(0xf74)][_0x4003a7(0x11fd)]=_0x4003a7(0x6a4),document[_0x4003a7(0x1188)](_0x4003a7(0xeae))[_0x4003a7(0x427)](_0x359f6c=>{const _0x56a839=_0x4003a7;_0x57b581['includes'](_0x359f6c[_0x56a839(0x606)][_0x56a839(0x5fe)])&&_0x359f6c[_0x56a839(0xd54)][_0x56a839(0xbd0)](_0x56a839(0xd56));});}async function _0x2d867e(){const _0x2aa4fd=_0x3ce1fb,_0x5683cd=document[_0x2aa4fd(0x1188)](_0x2aa4fd(0x11d0));if(_0x5683cd['length']===0x0){alert(_0x2aa4fd(0xba3));return;}_0x97b451=Array[_0x2aa4fd(0x6e5)](_0x5683cd)[_0x2aa4fd(0x8ff)](_0x126a83=>_0x126a83[_0x2aa4fd(0x606)]['typeId']);const _0x138961=await _0xa6b74a('最后确认！',_0x2aa4fd(0x1017),{'confirmButtonClass':_0x2aa4fd(0x5e8),'confirmText':_0x2aa4fd(0x8ed)});if(!_0x138961)return;await _0x104485(_0x2aa4fd(0x960),_0x2aa4fd(0x26b));try{await _0x6ed281[_0x2aa4fd(0x670)]('rw',_0x6ed281[_0x2aa4fd(0x8fa)],async()=>{const _0x312fb7=_0x2aa4fd;for(const _0x397b63 of _0x57b581){for(const _0x567e2e of _0x97b451){if(_0x567e2e==='chat'){if(_0x397b63===_0x312fb7(0xaeb)){const _0x406d5b=await _0x6ed281[_0x312fb7(0x1474)][_0x312fb7(0x443)]();for(const _0x36f932 of _0x406d5b){_0x36f932[_0x312fb7(0xb07)]=_0x36f932['history']['filter'](_0xd41512=>_0xd41512[_0x312fb7(0x1554)]!=='user'),await _0x6ed281['chats'][_0x312fb7(0x90c)](_0x36f932);}}else{const _0x1acaea=await _0x6ed281[_0x312fb7(0x1474)][_0x312fb7(0xe8c)](_0x397b63);_0x1acaea&&(_0x1acaea[_0x312fb7(0xb07)]=[],_0x1acaea[_0x312fb7(0x790)]=_0x312fb7(0x76d),_0x1acaea[_0x312fb7(0x6f1)]=_0x312fb7(0x76d),Array[_0x312fb7(0x1524)](_0x1acaea[_0x312fb7(0xace)])&&(_0x1acaea['nameHistory']=[]),_0x1acaea[_0x312fb7(0x7fd)]&&(_0x1acaea['settings'][_0x312fb7(0x1371)]='我'),await _0x6ed281[_0x312fb7(0x1474)][_0x312fb7(0x90c)](_0x1acaea));}}if(_0x567e2e===_0x312fb7(0x1119)){const _0x9cc777=_0x397b63==='user'?'user':_0x397b63;await _0x6ed281[_0x312fb7(0xed1)][_0x312fb7(0x1117)]('authorId')['equals'](_0x9cc777)['delete']();}_0x567e2e===_0x312fb7(0x1169)&&_0x397b63!==_0x312fb7(0xaeb)&&await _0x6ed281[_0x312fb7(0x14b5)][_0x312fb7(0x1117)]('chatId')[_0x312fb7(0xba9)](_0x397b63)['delete']();if(_0x567e2e===_0x312fb7(0x1249)&&_0x397b63!=='user'){const _0x52ec2e=await _0x6ed281[_0x312fb7(0x1474)][_0x312fb7(0xe8c)](_0x397b63);_0x52ec2e&&(_0x52ec2e[_0x312fb7(0xd94)]=[],_0x52ec2e[_0x312fb7(0x790)]=_0x312fb7(0x76d),_0x52ec2e[_0x312fb7(0x6f1)]=_0x312fb7(0x76d),await _0x6ed281[_0x312fb7(0x1474)]['put'](_0x52ec2e));}if(_0x567e2e===_0x312fb7(0x9cc)&&_0x397b63!==_0x312fb7(0xaeb)){const _0x52cbc8=await _0x6ed281[_0x312fb7(0x1474)][_0x312fb7(0xe8c)](_0x397b63);_0x52cbc8&&(_0x52cbc8[_0x312fb7(0x758)]=[],await _0x6ed281[_0x312fb7(0x1474)][_0x312fb7(0x90c)](_0x52cbc8));}_0x567e2e===_0x312fb7(0x1dc)&&(_0x397b63===_0x312fb7(0xaeb)?(await _0x6ed281[_0x312fb7(0x1dc)][_0x312fb7(0x1117)](_0x312fb7(0x4ae))[_0x312fb7(0xba9)](_0x312fb7(0x65f))[_0x312fb7(0x1c0)](_0x404b7e=>_0x404b7e[_0x312fb7(0xede)][_0x312fb7(0x11b9)]==='user')[_0x312fb7(0x869)](),await _0x6ed281[_0x312fb7(0x1dc)]['where'](_0x312fb7(0x4ae))[_0x312fb7(0xba9)]('chat_message')['filter'](_0x2c8783=>_0x2c8783[_0x312fb7(0xede)]['role']==='user')['delete']()):(await _0x6ed281[_0x312fb7(0x1dc)][_0x312fb7(0x1117)](_0x312fb7(0x4ae))[_0x312fb7(0xba9)](_0x312fb7(0xa6d))['and'](_0x34533c=>_0x34533c[_0x312fb7(0x1029)]===_0x397b63)['delete'](),await _0x6ed281[_0x312fb7(0x1dc)][_0x312fb7(0x1117)]('type')[_0x312fb7(0xba9)](_0x312fb7(0x65f))[_0x312fb7(0x1c0)](_0x27a08d=>_0x27a08d['content'][_0x312fb7(0x11b9)]===_0x397b63)[_0x312fb7(0x869)](),await _0x6ed281[_0x312fb7(0x1dc)][_0x312fb7(0x1117)]('type')[_0x312fb7(0xba9)](_0x312fb7(0xba8))[_0x312fb7(0x1c0)](_0x35cb32=>_0x35cb32[_0x312fb7(0xede)][_0x312fb7(0xfb0)]===_0x397b63)[_0x312fb7(0x869)](),await _0x6ed281[_0x312fb7(0x1dc)]['where'](_0x312fb7(0x4ae))[_0x312fb7(0xba9)](_0x312fb7(0x8ea))['filter'](_0x19ae83=>_0x19ae83[_0x312fb7(0xede)]['characterId']===_0x397b63)[_0x312fb7(0x869)](),await _0x6ed281[_0x312fb7(0x1dc)]['where'](_0x312fb7(0x4ae))['equals'](_0x312fb7(0x798))[_0x312fb7(0x1c0)](_0x313a64=>_0x313a64[_0x312fb7(0xede)][_0x312fb7(0xfb0)]===_0x397b63)['delete']()));if(_0x567e2e==='cphone'&&_0x397b63!==_0x312fb7(0xaeb)){const _0x448e98=await _0x6ed281['chats'][_0x312fb7(0xe8c)](_0x397b63);_0x448e98&&(_0x448e98[_0x312fb7(0x3ab)]=[],_0x448e98['simulatedConversations']=[],_0x448e98[_0x312fb7(0x866)]=[],_0x448e98[_0x312fb7(0xce5)]=null,_0x448e98['simulatedAmapHistory']=[],_0x448e98['simulatedAppUsage']=[],_0x448e98['simulatedMusicPlaylist']=[],_0x448e98[_0x312fb7(0x412)]=[],_0x448e98[_0x312fb7(0x1223)]=[],await _0x6ed281[_0x312fb7(0x1474)]['put'](_0x448e98));}}}}),await _0x315636(),await _0x2d33eb(),document[_0x2aa4fd(0x948)](_0x2aa4fd(0xd4e))['classList'][_0x2aa4fd(0xf89)](_0x2aa4fd(0xfcb)),await _0x104485('清理完成',_0x2aa4fd(0x856));}catch(_0x1178c6){console['error'](_0x2aa4fd(0x799),_0x1178c6),await _0x104485(_0x2aa4fd(0x9bb),'操作失败:\x20'+_0x1178c6[_0x2aa4fd(0x74b)]);}}async function _0x12ab47(_0x559e44,_0x8c8f7,_0x116d48){const _0x43eba4=_0x3ce1fb,_0x121214=_0x116d48[_0x43eba4(0xfeb)]('.icon-preview')[_0x43eba4(0xc3a)],_0x48ed15=await _0x9286bb('更换“'+_0x121214+_0x43eba4(0x1220),[{'text':_0x43eba4(0x1a1),'value':_0x43eba4(0x1179)},{'text':_0x43eba4(0x500),'value':'url'}]);let _0x461026=null;if(_0x48ed15===_0x43eba4(0x1179))_0x461026=await _0x2c96d6();else{if(_0x48ed15===_0x43eba4(0x9a8)){const _0x5a5382=_0x8c8f7===_0x43eba4(0x1116)?_0x16699d[_0x43eba4(0xf9c)]['cphoneAppIcons'][_0x559e44]:_0x16699d[_0x43eba4(0xf9c)][_0x43eba4(0x1471)][_0x559e44],_0x44ee9e=_0x5a5382[_0x43eba4(0x157f)](_0x43eba4(0x1303)),_0x37429a=_0x44ee9e?'':_0x5a5382;_0x461026=await _0x41b9fc(_0x43eba4(0xbc1),_0x43eba4(0x15cc),_0x37429a,'url');}}if(_0x461026&&_0x461026['trim']()){const _0x43c4ed=_0x461026[_0x43eba4(0x2a8)]();_0x8c8f7===_0x43eba4(0x1116)?_0x16699d[_0x43eba4(0xf9c)][_0x43eba4(0xac6)][_0x559e44]=_0x43c4ed:_0x16699d['globalSettings'][_0x43eba4(0x1471)][_0x559e44]=_0x43c4ed,_0x116d48[_0x43eba4(0xfeb)](_0x43eba4(0xbca))['src']=_0x43c4ed;}else _0x461026!==null&&alert(_0x43eba4(0xad5));}async function _0x3be874(){const _0x383bb5=_0x3ce1fb,_0x1aaa09=await _0xa6b74a(_0x383bb5(0x9f6),_0x383bb5(0x5a2),{'confirmButtonClass':_0x383bb5(0x5e8),'confirmText':'我已了解风险，确认压缩'});if(!_0x1aaa09)return;await _0x104485(_0x383bb5(0x960),_0x383bb5(0x69c));let _0x153477={'found':0x0,'compressed':0x0,'skipped':0x0,'originalSize':0x0,'newSize':0x0};try{console[_0x383bb5(0x498)]('压缩步骤\x201/3:\x20正在从数据库读取所有相关数据...');const _0x9f17ed=[_0x383bb5(0x1474),_0x383bb5(0xf9c),_0x383bb5(0x66e),'userStickers',_0x383bb5(0x1581)],_0x1efb81=[];for(const _0x3b3c51 of _0x9f17ed){const _0x32e632=_0x6ed281['table'](_0x3b3c51),_0x5307d8=await _0x32e632[_0x383bb5(0x443)]();_0x1efb81[_0x383bb5(0x1001)]({'tableName':_0x3b3c51,'records':_0x5307d8});}console[_0x383bb5(0x498)](_0x383bb5(0x155a));for(const _0x223a65 of _0x1efb81){for(const _0x3397de of _0x223a65['records']){await _0x2b61c9(_0x3397de,_0x153477);}}console[_0x383bb5(0x498)]('压缩步骤\x203/3:\x20正在将压缩后的数据写回数据库...'),await _0x6ed281[_0x383bb5(0x670)]('rw',_0x9f17ed,async()=>{const _0x2ae053=_0x383bb5;for(const _0x1fab90 of _0x1efb81){await _0x6ed281[_0x2ae053(0x437)](_0x1fab90[_0x2ae053(0xb49)])['bulkPut'](_0x1fab90[_0x2ae053(0x217)]);}});const _0xf16bf9=_0x153477[_0x383bb5(0x14d0)]-_0x153477[_0x383bb5(0x1196)],_0x1ab08d=_0x153477['originalSize']>0x0?(_0xf16bf9/_0x153477[_0x383bb5(0x14d0)]*0x64)['toFixed'](0x2):0x0;await _0x104485('压缩完成！',_0x383bb5(0xc26)+_0x153477[_0x383bb5(0xcb7)]+_0x383bb5(0x6f8)+_0x153477[_0x383bb5(0x1337)]+_0x383bb5(0x761)+_0x153477[_0x383bb5(0x989)]+_0x383bb5(0xac3)+(_0xf16bf9/0x400/0x400)['toFixed'](0x2)+_0x383bb5(0x1175)+_0x1ab08d+_0x383bb5(0x30b));}catch(_0x5d50c8){console['error'](_0x383bb5(0x57f),_0x5d50c8),await _0x104485(_0x383bb5(0xed4),'操作失败:\x20'+_0x5d50c8['message']);}}function _0x3c642f(_0x1cfbf6,_0x5d3aee=''){const _0x2c5697=_0x3ce1fb;let _0x4c1971=0x0;for(const _0x4cdb41 in _0x1cfbf6){if(_0x1cfbf6[_0x2c5697(0xcf3)](_0x4cdb41)){const _0x5dedec=_0x1cfbf6[_0x4cdb41];if(typeof _0x5dedec===_0x2c5697(0x273)&&_0x5dedec[_0x2c5697(0x157f)]('data:image')){const _0x18bde=_0x5d3aee===_0x2c5697(0xf9c)&&(_0x4cdb41===_0x2c5697(0xb91)||_0x4cdb41===_0x2c5697(0x378)||_0x4cdb41===_0x2c5697(0xa76))||_0x5d3aee===_0x2c5697(0x9aa)||_0x5d3aee===_0x2c5697(0x7fd)&&_0x4cdb41==='background'||(_0x5d3aee===_0x2c5697(0x1471)||_0x5d3aee===_0x2c5697(0xac6));!_0x18bde&&(_0x4c1971+=_0x5dedec['length']);}else typeof _0x5dedec==='object'&&_0x5dedec!==null&&(_0x4c1971+=_0x3c642f(_0x5dedec,_0x4cdb41));}}return _0x4c1971;}async function _0x1f0417(){const _0x3ca3bf=_0x3ce1fb,_0x27873b=document[_0x3ca3bf(0x948)](_0x3ca3bf(0x3da));if(!_0x27873b)return;_0x27873b['innerHTML']=_0x3ca3bf(0xdbf);try{let _0x59895d=0x0;const _0x3af4fd=['chats','globalSettings',_0x3ca3bf(0x66e),_0x3ca3bf(0x14a2),_0x3ca3bf(0x1581)];for(const _0x43d7d3 of _0x3af4fd){const _0x44b493=_0x6ed281['table'](_0x43d7d3);await _0x44b493['each'](_0x47f45c=>{_0x59895d+=_0x3c642f(_0x47f45c);});}const _0x3f5808=(_0x59895d/0x400/0x400)[_0x3ca3bf(0xd69)](0x2);_0x27873b[_0x3ca3bf(0xb6f)]=_0x3ca3bf(0x13f3)+_0x3f5808+_0x3ca3bf(0x153e);}catch(_0x24453c){console['error'](_0x3ca3bf(0x4d2),_0x24453c),_0x27873b[_0x3ca3bf(0xb6f)]=_0x3ca3bf(0xa11);}}async function _0x2b61c9(_0x1a6519,_0x288cf3,_0x4465ff=''){const _0x499101=_0x3ce1fb;for(const _0x245755 in _0x1a6519){if(_0x1a6519[_0x499101(0xcf3)](_0x245755)){const _0x5766ae=_0x1a6519[_0x245755];if(typeof _0x5766ae===_0x499101(0x273)&&_0x5766ae[_0x499101(0x157f)](_0x499101(0x1303))){const _0x4961ea=_0x4465ff===_0x499101(0xf9c)&&(_0x245755===_0x499101(0xb91)||_0x245755==='cphoneWallpaper'||_0x245755===_0x499101(0xa76))||_0x4465ff===_0x499101(0x9aa)||_0x4465ff===_0x499101(0x7fd)&&_0x245755===_0x499101(0x7c2)||(_0x4465ff==='appIcons'||_0x4465ff===_0x499101(0xac6));if(_0x4961ea)continue;_0x288cf3[_0x499101(0xcb7)]++,_0x288cf3[_0x499101(0x14d0)]+=_0x5766ae[_0x499101(0xaf9)];const _0x1ff84d=await _0x432094(_0x5766ae);_0x1ff84d&&_0x1ff84d!==_0x5766ae?(_0x1a6519[_0x245755]=_0x1ff84d,_0x288cf3[_0x499101(0x1337)]++,_0x288cf3['newSize']+=_0x1ff84d[_0x499101(0xaf9)]):(_0x288cf3[_0x499101(0x989)]++,_0x288cf3[_0x499101(0x1196)]+=_0x5766ae[_0x499101(0xaf9)]);}else typeof _0x5766ae===_0x499101(0xd43)&&_0x5766ae!==null&&await _0x2b61c9(_0x5766ae,_0x288cf3,_0x245755);}}}async function _0x432094(_0x19decd){const _0x1ccab5=_0x3ce1fb;if(!_0x19decd[_0x1ccab5(0x157f)](_0x1ccab5(0x1303)))return _0x19decd;try{const _0x352e35=await(await fetch(_0x19decd))[_0x1ccab5(0x250)](),_0x5403cb={'maxSizeMB':0.5,'maxWidthOrHeight':0x320,'useWebWorker':!![],'initialQuality':0.5,'fileType':_0x1ccab5(0x1516)};console[_0x1ccab5(0x498)](_0x1ccab5(0xb7c)+(_0x352e35[_0x1ccab5(0x8ca)]/0x400/0x400)[_0x1ccab5(0xd69)](0x2)+_0x1ccab5(0x820));const _0x434cc0=await imageCompression(_0x352e35,_0x5403cb);return console['log'](_0x1ccab5(0xdf9)+(_0x434cc0[_0x1ccab5(0x8ca)]/0x400/0x400)['toFixed'](0x2)+_0x1ccab5(0x820)),new Promise((_0x2f1ac1,_0x310d57)=>{const _0x1f88bc=_0x1ccab5,_0x29e0d2=new FileReader();_0x29e0d2[_0x1f88bc(0x55b)]=()=>_0x2f1ac1(_0x29e0d2[_0x1f88bc(0x22a)]),_0x29e0d2[_0x1f88bc(0x12eb)]=_0x310d57,_0x29e0d2[_0x1f88bc(0x5a5)](_0x434cc0);});}catch(_0x469821){return console[_0x1ccab5(0xc3e)](_0x1ccab5(0x330),_0x469821),_0x19decd;}}function _0x5d6882(_0x4b62c2,_0x2ee6fc){const _0x2767cb=_0x3ce1fb;if(!_0x4b62c2||!_0x2ee6fc||typeof _0x4b62c2!=='string'||typeof _0x2ee6fc!==_0x2767cb(0x273))return 0x0;const _0x529480=_0x4b62c2[_0x2767cb(0x46f)]('.')[_0x2767cb(0x8ff)](Number),_0x30a858=_0x2ee6fc[_0x2767cb(0x46f)]('.')['map'](Number),_0x1650a4=Math[_0x2767cb(0x604)](_0x529480[_0x2767cb(0xaf9)],_0x30a858['length']);for(let _0x279269=0x0;_0x279269<_0x1650a4;_0x279269++){const _0x41ce97=_0x529480[_0x279269]||0x0,_0x4f9b8a=_0x30a858[_0x279269]||0x0;if(_0x41ce97>_0x4f9b8a)return 0x1;if(_0x41ce97<_0x4f9b8a)return-0x1;}return 0x0;}async function _0x3ce973(){const _0x57c2c6=_0x3ce1fb,_0x350847='1.0';try{const _0x5d1a3c=await fetch('update-notice.html?_='+Date[_0x57c2c6(0x1386)]());if(!_0x5d1a3c['ok']){console['warn']('获取更新通知文件失败。');return;}const _0x537acd=await _0x5d1a3c[_0x57c2c6(0x9ea)](),_0x1280b9=document[_0x57c2c6(0x1497)]('div');_0x1280b9[_0x57c2c6(0xb6f)]=_0x537acd;const _0x576ea7=_0x1280b9[_0x57c2c6(0xfeb)](_0x57c2c6(0x111b));if(!_0x576ea7){console['error'](_0x57c2c6(0x3ac));return;}const _0xdf7e30=_0x576ea7['dataset'][_0x57c2c6(0x24d)],_0x4d46ae=localStorage['getItem'](_0x57c2c6(0x26d));!_0x4d46ae||_0x5d6882(_0xdf7e30,_0x4d46ae)>0x0?(console[_0x57c2c6(0x498)](_0x57c2c6(0x12b9)+_0xdf7e30+_0x57c2c6(0x263)+(_0x4d46ae||'无')+')'),_0x483699(_0xdf7e30,_0x576ea7[_0x57c2c6(0xb6f)])):console['log'](_0x57c2c6(0x11d8)+_0xdf7e30+_0x57c2c6(0x4e1));}catch(_0x1742a1){console['error'](_0x57c2c6(0x11c3),_0x1742a1);}}function _0x483699(_0x52edfa,_0x38e239){const _0x4a6919=_0x3ce1fb,_0x27238e=document[_0x4a6919(0x948)](_0x4a6919(0x1242)),_0x347d37=document[_0x4a6919(0x948)](_0x4a6919(0x570)),_0x539d07=document[_0x4a6919(0x948)]('update-notice-confirm-btn'),_0x57d030=document[_0x4a6919(0x948)](_0x4a6919(0x9b0));_0x347d37[_0x4a6919(0xb6f)]=_0x38e239,_0x539d07[_0x4a6919(0xe8d)]=()=>{const _0xa912c8=_0x4a6919;_0x27238e[_0xa912c8(0xd54)][_0xa912c8(0xf89)](_0xa912c8(0xfcb));},_0x57d030['onclick']=()=>{const _0x524147=_0x4a6919;localStorage[_0x524147(0x59f)](_0x524147(0x26d),_0x52edfa),_0x27238e[_0x524147(0xd54)][_0x524147(0xf89)](_0x524147(0xfcb)),console['log'](_0x524147(0x82d)+_0x52edfa);},_0x27238e['classList']['add'](_0x4a6919(0xfcb));}function _0x37e769(){const _0x3ae14c=_0x3ce1fb,_0xd2cc23=document[_0x3ae14c(0x948)]('douban-settings-modal');document[_0x3ae14c(0x948)](_0x3ae14c(0x1596))[_0x3ae14c(0x5bc)]=_0x16699d[_0x3ae14c(0xf9c)]['doubanMinPosts']||0xc,document['getElementById'](_0x3ae14c(0xd8e))['value']=_0x16699d[_0x3ae14c(0xf9c)]['doubanMaxPosts']||0x14,_0xd2cc23['classList'][_0x3ae14c(0xbd0)](_0x3ae14c(0xfcb));}async function _0x230ac1(){const _0x24f3ae=_0x3ce1fb,_0x5098a2=document[_0x24f3ae(0x948)](_0x24f3ae(0x1596)),_0x3d1737=document[_0x24f3ae(0x948)](_0x24f3ae(0xd8e)),_0x5f2baf=parseInt(_0x5098a2[_0x24f3ae(0x5bc)]),_0x89eea3=parseInt(_0x3d1737[_0x24f3ae(0x5bc)]);if(isNaN(_0x5f2baf)||isNaN(_0x89eea3)||_0x5f2baf<0x1||_0x89eea3<0x1){alert(_0x24f3ae(0x1380));return;}if(_0x5f2baf>_0x89eea3){alert('最小帖子数不能大于最大帖子数！');return;}_0x16699d[_0x24f3ae(0xf9c)]['doubanMinPosts']=_0x5f2baf,_0x16699d[_0x24f3ae(0xf9c)][_0x24f3ae(0xff4)]=_0x89eea3,await _0x6ed281['globalSettings']['put'](_0x16699d[_0x24f3ae(0xf9c)]),document[_0x24f3ae(0x948)](_0x24f3ae(0xe88))[_0x24f3ae(0xd54)][_0x24f3ae(0xf89)](_0x24f3ae(0xfcb)),await _0x104485(_0x24f3ae(0xd14),_0x24f3ae(0xe2b));}async function _0x414c82(_0x2472c4){const _0x314f63=_0x3ce1fb,_0x1d7f48=document[_0x314f63(0x948)](_0x314f63(0x44f)),_0x2a0ae9=document[_0x314f63(0x948)]('werewolf-player-selection-list');_0x2a0ae9[_0x314f63(0xb6f)]='';let _0xb7270c=[];if(_0x2472c4===_0x314f63(0x13a0)){const _0x1dbfc7=Object['values'](_0x16699d[_0x314f63(0x1474)])[_0x314f63(0x1c0)](_0x3f1736=>!_0x3f1736[_0x314f63(0x1173)]),_0xef7ebf=await _0x6ed281[_0x314f63(0xa59)][_0x314f63(0x443)]();_0xb7270c=[{'id':_0x314f63(0xaeb),'name':_0x16699d[_0x314f63(0x66e)]['nickname']||'我','originalName':_0x16699d[_0x314f63(0x66e)][_0x314f63(0xf4d)]||'我','avatar':_0x16699d[_0x314f63(0x66e)][_0x314f63(0x63e)],'type':_0x314f63(0xaeb)},..._0x1dbfc7[_0x314f63(0x8ff)](_0x6729fb=>({'id':_0x6729fb['id'],'name':_0x6729fb[_0x314f63(0x1467)],'originalName':_0x6729fb[_0x314f63(0x628)],'avatar':_0x6729fb[_0x314f63(0x7fd)][_0x314f63(0x156d)],'type':'character'})),..._0xef7ebf[_0x314f63(0x8ff)](_0x314348=>({'id':_0x314f63(0x137b)+_0x314348['id'],'name':_0x314348[_0x314f63(0x1467)],'originalName':_0x314348[_0x314f63(0x1467)],'avatar':_0x314348[_0x314f63(0x63e)],'type':_0x314f63(0x3b8)}))],_0x1b881d[_0x314f63(0x1029)]=null;}else{const _0x385f5d=_0x16699d[_0x314f63(0x1474)][_0x16699d[_0x314f63(0xf5a)]];if(!_0x385f5d||!_0x385f5d[_0x314f63(0x1173)])return;_0xb7270c=[{'id':_0x314f63(0xaeb),'name':_0x385f5d[_0x314f63(0x7fd)][_0x314f63(0x1371)]||'我','originalName':_0x16699d['qzoneSettings'][_0x314f63(0xf4d)]||'我','avatar':_0x385f5d[_0x314f63(0x7fd)][_0x314f63(0xb09)],'type':_0x314f63(0xaeb)},..._0x385f5d[_0x314f63(0x10a2)][_0x314f63(0x8ff)](_0x2f43d0=>{const _0x1c26fd=_0x314f63,_0x3ffdde=_0x16699d[_0x1c26fd(0x1474)][_0x2f43d0['id']],_0x1a3570=_0x2f43d0[_0x1c26fd(0x63e)]||(_0x3ffdde?_0x3ffdde[_0x1c26fd(0x7fd)][_0x1c26fd(0x156d)]:_0x3ca5ef);return{'id':_0x2f43d0['id'],'name':_0x2f43d0[_0x1c26fd(0x347)],'originalName':_0x2f43d0[_0x1c26fd(0x628)],'avatar':_0x1a3570,'type':_0x2f43d0[_0x1c26fd(0x258)]?_0x1c26fd(0x3b8):'character'};})],_0x1b881d[_0x314f63(0x1029)]=_0x16699d[_0x314f63(0xf5a)];}_0xb7270c[_0x314f63(0x427)](_0xc2212a=>{const _0x4f85aa=_0x314f63,_0x2448d8=document[_0x4f85aa(0x1497)](_0x4f85aa(0x379));_0x2448d8[_0x4f85aa(0x35b)]='contact-picker-item',_0x2448d8[_0x4f85aa(0xb6f)]=_0x4f85aa(0x1553)+JSON[_0x4f85aa(0x526)](_0xc2212a)+'\x27\x20'+(_0xc2212a[_0x4f85aa(0x4ae)]===_0x4f85aa(0xaeb)?_0x4f85aa(0x350):_0x4f85aa(0x210))+'>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0xc2212a[_0x4f85aa(0x63e)]+_0x4f85aa(0x1239)+_0xc2212a[_0x4f85aa(0x1467)]+_0x4f85aa(0x10df),_0x2a0ae9['appendChild'](_0x2448d8);}),_0x1d7f48[_0x314f63(0xd54)]['add'](_0x314f63(0xfcb));}async function _0x2cb0d1(){const _0x37f572=_0x3ce1fb,_0x586ed3=document[_0x37f572(0x1188)](_0x37f572(0x43b)),_0x2ca4bc=_0x586ed3[_0x37f572(0xaf9)];let _0x40aea8=[];if(_0x2ca4bc===0x6)_0x1b881d[_0x37f572(0x780)]='6p',_0x40aea8=['狼人','狼人','平民','平民',_0x37f572(0x123f),'猎人'];else{if(_0x2ca4bc===0x9)_0x1b881d[_0x37f572(0x780)]='9p',_0x40aea8=['狼人','狼人','狼人','平民','平民','平民','预言家','女巫','猎人'];else{if(_0x2ca4bc===0xc)_0x1b881d['gameMode']=_0x37f572(0x134c),_0x40aea8=['狼人','狼人','狼人','狼人','平民','平民','平民','平民',_0x37f572(0x123f),'女巫','猎人','守卫'];else{alert(_0x37f572(0x52e)+_0x2ca4bc+_0x37f572(0xb8a));return;}}}document[_0x37f572(0x948)](_0x37f572(0x44f))[_0x37f572(0xd54)]['remove']('visible'),await _0x104485(_0x37f572(0xab2),_0x37f572(0x634));for(let _0x3db5ec=_0x40aea8[_0x37f572(0xaf9)]-0x1;_0x3db5ec>0x0;_0x3db5ec--){const _0x383b85=Math[_0x37f572(0x15b6)](Math['random']()*(_0x3db5ec+0x1));[_0x40aea8[_0x3db5ec],_0x40aea8[_0x383b85]]=[_0x40aea8[_0x383b85],_0x40aea8[_0x3db5ec]];}const _0x128387=Array[_0x37f572(0x6e5)](_0x586ed3)[_0x37f572(0x8ff)](_0x479373=>JSON['parse'](_0x479373[_0x37f572(0x606)][_0x37f572(0xf35)]));_0x1b881d[_0x37f572(0x1550)]=[];for(let _0x246d0d=0x0;_0x246d0d<_0x128387[_0x37f572(0xaf9)];_0x246d0d++){const _0x5959f4=_0x128387[_0x246d0d],_0xf4fa14=_0x40aea8[_0x246d0d];let _0x3df093='一个普通玩家';if(_0x5959f4['type']===_0x37f572(0x4d1)){const _0xb912c0=_0x16699d['chats'][_0x5959f4['id']];_0x3df093=_0xb912c0?_0xb912c0[_0x37f572(0x7fd)][_0x37f572(0x14c1)]:_0x37f572(0x123a);}else{if(_0x5959f4[_0x37f572(0x4ae)]==='npc'){const _0x1613b5=await _0x6ed281[_0x37f572(0xa59)][_0x37f572(0x443)](),_0x7f2f63=_0x1613b5[_0x37f572(0x1402)](_0x2b83d7=>_0x37f572(0x137b)+_0x2b83d7['id']===_0x5959f4['id']);_0x3df093=_0x7f2f63?_0x7f2f63['persona']:'未知设定的NPC';}else{if(_0x5959f4[_0x37f572(0x4ae)]===_0x37f572(0xaeb)){const _0x5734f2=_0x1b881d[_0x37f572(0x1029)]?_0x16699d[_0x37f572(0x1474)][_0x1b881d[_0x37f572(0x1029)]]:null;_0x3df093=_0x5734f2?_0x5734f2[_0x37f572(0x7fd)][_0x37f572(0x13b6)]:_0x37f572(0xdbd);}}}const _0x1ff9b4={..._0x5959f4,'role':_0xf4fa14,'isAlive':!![],'character_persona':_0x3df093};_0xf4fa14==='女巫'&&(_0x1ff9b4[_0x37f572(0xd52)]=![],_0x1ff9b4[_0x37f572(0x1086)]=![]),_0xf4fa14==='守卫'&&(_0x1ff9b4[_0x37f572(0xdb0)]=null),_0x1b881d[_0x37f572(0x1550)][_0x37f572(0x1001)](_0x1ff9b4);}_0x1b881d['isActive']=!![],_0x1b881d[_0x37f572(0x477)]=0x1,_0x1b881d[_0x37f572(0x7e4)]=_0x37f572(0x1b9),_0x1b881d[_0x37f572(0xd1e)]=[],_0x1b881d[_0x37f572(0xb4b)]=[];const _0x256cb6=_0x40aea8['reduce']((_0x5cfb17,_0x1ebd86)=>{return _0x5cfb17[_0x1ebd86]=(_0x5cfb17[_0x1ebd86]||0x0)+0x1,_0x5cfb17;},{}),_0x9d5db1=Object['entries'](_0x256cb6)['map'](([_0x2ea908,_0x1d51bf])=>_0x2ea908+'\x20x'+_0x1d51bf)[_0x37f572(0x121a)]('、');_0x3da570('游戏配置：'+_0x2ca4bc+_0x37f572(0x3d0)+_0x9d5db1+'。');const _0x467e09=_0x1b881d[_0x37f572(0x1550)][_0x37f572(0x1402)](_0x169b25=>_0x169b25['id']===_0x37f572(0xaeb));_0x5c7dac(),_0x58c3b1(_0x37f572(0x1295)),_0x214afc(_0x467e09[_0x37f572(0x1554)]);}function _0x5c7dac(){const _0x1ff7ae=_0x3ce1fb,_0x48d8e7=document[_0x1ff7ae(0x948)](_0x1ff7ae(0x788));_0x48d8e7['innerHTML']='';const _0x1a5041=[..._0x1b881d[_0x1ff7ae(0x1550)]]['sort']((_0x46a567,_0x4dcb3b)=>_0x46a567[_0x1ff7ae(0x28f)]-_0x4dcb3b[_0x1ff7ae(0x28f)]);_0x1a5041[_0x1ff7ae(0x427)]((_0x53e40a,_0x2c939e)=>{const _0x38e20f=_0x1ff7ae,_0x30e654=_0x1b881d[_0x38e20f(0x1550)]['findIndex'](_0x156a1a=>_0x156a1a['id']===_0x53e40a['id'])+0x1,_0x3739d1=document[_0x38e20f(0x1497)](_0x38e20f(0x379));_0x3739d1[_0x38e20f(0x35b)]=_0x38e20f(0x9d1);if(!_0x53e40a[_0x38e20f(0x28f)])_0x3739d1['classList'][_0x38e20f(0xbd0)](_0x38e20f(0x595));_0x3739d1[_0x38e20f(0xb6f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x53e40a['avatar']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22player-name\x22>'+_0x30e654+'.\x20'+_0x53e40a[_0x38e20f(0x1467)]+_0x38e20f(0x10df),_0x48d8e7[_0x38e20f(0x6b6)](_0x3739d1);});const _0x1330f6=document[_0x1ff7ae(0x948)](_0x1ff7ae(0x5e5));_0x1330f6[_0x1ff7ae(0xb6f)]='';for(let _0x5ca612=0x1;_0x5ca612<=_0x1b881d[_0x1ff7ae(0x477)];_0x5ca612++){const _0x29687c=[..._0x1b881d['gameLog'][_0x1ff7ae(0x1c0)](_0x51a637=>_0x51a637[_0x1ff7ae(0x5ed)]===_0x5ca612),..._0x1b881d[_0x1ff7ae(0xb4b)]['filter'](_0x59a8dd=>_0x59a8dd['day']===_0x5ca612)]['sort']((_0x240ba7,_0x12f833)=>(_0x240ba7[_0x1ff7ae(0xb0a)]||0x0)-(_0x12f833[_0x1ff7ae(0xb0a)]||0x0));if(_0x29687c[_0x1ff7ae(0xaf9)]>0x0){const _0x1e15d2=document[_0x1ff7ae(0x1497)]('div');_0x1e15d2['className']=_0x1ff7ae(0x14ad),_0x1e15d2[_0x1ff7ae(0x10cb)]=_0x1ff7ae(0x321)+_0x5ca612+_0x1ff7ae(0xc8a),_0x1e15d2[_0x1ff7ae(0xf74)]['cssText']=_0x1ff7ae(0xb2f),_0x1330f6['appendChild'](_0x1e15d2),_0x29687c[_0x1ff7ae(0x427)](_0x225496=>{const _0x51abd9=_0x1ff7ae,_0x21af41=document[_0x51abd9(0x1497)](_0x51abd9(0x379));_0x21af41[_0x51abd9(0x35b)]=_0x51abd9(0x896)+_0x225496[_0x51abd9(0x4ae)],_0x225496['type']===_0x51abd9(0x13c5)?_0x21af41[_0x51abd9(0xb6f)]=_0x51abd9(0xc51)+_0x225496[_0x51abd9(0xf2b)]+_0x51abd9(0x829)+_0x225496[_0x51abd9(0xede)]:_0x21af41['textContent']=_0x225496[_0x51abd9(0xede)],_0x1330f6[_0x51abd9(0x6b6)](_0x21af41);});}}_0x1330f6[_0x1ff7ae(0xced)]=_0x1330f6[_0x1ff7ae(0x971)];const _0x32bf9d={'start':'游戏开始','night':'第'+_0x1b881d[_0x1ff7ae(0x477)]+'天\x20-\x20夜晚','day':'第'+_0x1b881d['currentDay']+_0x1ff7ae(0xc57),'discussion':'第'+_0x1b881d[_0x1ff7ae(0x477)]+_0x1ff7ae(0x12e1),'voting':'第'+_0x1b881d[_0x1ff7ae(0x477)]+_0x1ff7ae(0x10f7),'gameover':_0x1ff7ae(0x104f)};document[_0x1ff7ae(0x948)]('werewolf-game-title')['textContent']='狼人杀\x20-\x20'+(_0x32bf9d[_0x1b881d['currentPhase']]||_0x1b881d['currentPhase']);}function _0x214afc(_0x6bd91d){const _0x4d103e=_0x3ce1fb,_0x1c8da3={'狼人':_0x4d103e(0xc5b),'平民':'你没有任何特殊能力，你的目标是通过投票放逐所有狼人。','预言家':'每晚可以查验一个玩家的身份是好人还是狼人。','猎人':'当你死亡时，你可以选择带走场上任意一名玩家。','女巫':_0x4d103e(0x2f2),'守卫':_0x4d103e(0x10ce)};document[_0x4d103e(0x948)](_0x4d103e(0x12ae))['textContent']=_0x6bd91d,document['getElementById'](_0x4d103e(0x959))[_0x4d103e(0x10cb)]=_0x1c8da3[_0x6bd91d]||_0x4d103e(0x466),document[_0x4d103e(0x948)](_0x4d103e(0x85a))[_0x4d103e(0xd54)][_0x4d103e(0xbd0)](_0x4d103e(0xfcb));}async function _0x85aa33(){const _0x83c870=_0x3ce1fb;_0x1b881d[_0x83c870(0x7e4)]='第'+_0x1b881d['currentDay']+_0x83c870(0xbd7),_0x1b881d['nightActions']={},_0x3da570(_0x83c870(0x1463)),_0x5c7dac(),document[_0x83c870(0x948)]('werewolf-action-bar')[_0x83c870(0xf74)][_0x83c870(0x11fd)]='none',document['getElementById'](_0x83c870(0x742))['style'][_0x83c870(0x11fd)]=_0x83c870(0x12fe),await new Promise(_0x54353c=>setTimeout(_0x54353c,0x5dc));const _0x35342a=_0x1b881d[_0x83c870(0x1550)][_0x83c870(0x1402)](_0x56aecc=>_0x56aecc['role']==='守卫'&&_0x56aecc[_0x83c870(0x28f)]);if(_0x35342a){_0x3da570(_0x83c870(0xde3)),_0x5c7dac();let _0x2e6982=null;if(_0x35342a['id']===_0x83c870(0xaeb))_0x2e6982=await _0xfb7a74(_0x83c870(0x1425),_0x35342a['lastGuardedId']);else{const _0x217deb=_0x1b881d[_0x83c870(0x1550)][_0x83c870(0x1c0)](_0x18f213=>_0x18f213[_0x83c870(0x28f)]&&_0x18f213['id']!==_0x35342a['lastGuardedId']);_0x217deb[_0x83c870(0xaf9)]>0x0&&(_0x2e6982=_0x217deb[Math[_0x83c870(0x15b6)](Math[_0x83c870(0x59c)]()*_0x217deb[_0x83c870(0xaf9)])]['id']);}_0x2e6982&&(_0x1b881d['nightActions']['guardedId']=_0x2e6982,_0x35342a['lastGuardedId']=_0x2e6982),_0x3da570(_0x83c870(0x576)),_0x5c7dac(),await new Promise(_0x5042f3=>setTimeout(_0x5042f3,0x5dc));}_0x3da570(_0x83c870(0x423)),_0x5c7dac();const _0x38ed3e=_0x1b881d[_0x83c870(0x1550)][_0x83c870(0x1c0)](_0x12890b=>_0x12890b[_0x83c870(0x1554)]==='狼人'&&_0x12890b[_0x83c870(0x28f)]),_0x58229f=_0x38ed3e['some'](_0x317bf2=>_0x317bf2['id']===_0x83c870(0xaeb));let _0x185215=null;_0x1b881d['lastFailedAction']=_0x83c870(0x129d);try{if(_0x58229f)_0x3da570('你是狼人，请选择刀人目标。'),_0x5c7dac(),_0x185215=await _0x3b5a0c();else{if(_0x1b881d[_0x83c870(0x477)]===0x1){console[_0x83c870(0x498)](_0x83c870(0xe2a));const _0x287383=_0x1b881d[_0x83c870(0x1550)][_0x83c870(0x1c0)](_0x166185=>_0x166185[_0x83c870(0x28f)]&&_0x166185[_0x83c870(0x1554)]!=='狼人');_0x287383[_0x83c870(0xaf9)]>0x0&&(_0x185215=_0x287383[Math['floor'](Math[_0x83c870(0x59c)]()*_0x287383['length'])]['id']);}else _0x185215=await _0x502654();}_0x1b881d['lastFailedAction']=null;}catch(_0x4f255d){console[_0x83c870(0xc3e)](_0x83c870(0x11a5),_0x4f255d),await _0x104485(_0x83c870(0xb6c),_0x83c870(0x15c4)),document['getElementById'](_0x83c870(0x742))[_0x83c870(0xf74)][_0x83c870(0x11fd)]=_0x83c870(0x1273);return;}_0x1b881d[_0x83c870(0x13fa)][_0x83c870(0x4b9)]=_0x185215,_0x3da570(_0x83c870(0x2c9)),_0x5c7dac(),await new Promise(_0xfe116c=>setTimeout(_0xfe116c,0x5dc));const _0x53a680=_0x1b881d[_0x83c870(0x1550)][_0x83c870(0x1402)](_0x4f1fe6=>_0x4f1fe6[_0x83c870(0x1554)]==='女巫'&&_0x4f1fe6[_0x83c870(0x28f)]);if(_0x53a680){_0x3da570(_0x83c870(0x138c)),_0x5c7dac();const _0x59c14d=_0x1b881d[_0x83c870(0x1550)][_0x83c870(0x1402)](_0x2c3e9b=>_0x2c3e9b['id']===_0x1b881d['nightActions'][_0x83c870(0x4b9)]),_0x26ef8e=_0x1b881d[_0x83c870(0x13fa)][_0x83c870(0x452)]===_0x1b881d[_0x83c870(0x13fa)]['killedId'],_0x490e8b=_0x26ef8e||!_0x59c14d?null:_0x59c14d;if(_0x53a680['id']===_0x83c870(0xaeb)){let _0x9c9881=await _0x36a157(_0x490e8b,_0x53a680);_0x9c9881['save']&&(_0x1b881d[_0x83c870(0x13fa)][_0x83c870(0x31a)]=_0x1b881d[_0x83c870(0x13fa)][_0x83c870(0x4b9)],_0x53a680[_0x83c870(0xd52)]=!![]),_0x9c9881[_0x83c870(0x2e5)]&&(_0x1b881d[_0x83c870(0x13fa)][_0x83c870(0x10fe)]=_0x9c9881['poison'],_0x53a680[_0x83c870(0x1086)]=!![]);}else{if(!_0x53a680['antidoteUsed']&&_0x490e8b){let _0x494671=0x0;_0x1b881d['currentDay']===0x1?_0x494671=0.3:_0x494671=0.8,console['log'](_0x83c870(0x1525)+_0x1b881d[_0x83c870(0x477)]+_0x83c870(0x1149)+_0x494671*0x64+'%'),Math[_0x83c870(0x59c)]()<_0x494671?(console[_0x83c870(0x498)](_0x83c870(0xfe0)),_0x1b881d['nightActions'][_0x83c870(0x31a)]=_0x1b881d[_0x83c870(0x13fa)][_0x83c870(0x4b9)],_0x53a680[_0x83c870(0xd52)]=!![]):console[_0x83c870(0x498)](_0x83c870(0x919));}if(!_0x1b881d[_0x83c870(0x13fa)][_0x83c870(0x31a)]&&!_0x53a680['poisonUsed']&&Math[_0x83c870(0x59c)]()<0.5){const _0x2766d6=_0x1b881d['players'][_0x83c870(0x1c0)](_0xf9050e=>_0xf9050e['isAlive']&&_0xf9050e['id']!==_0x1b881d['nightActions'][_0x83c870(0x4b9)]);if(_0x2766d6['length']>0x0){const _0x1d5faf=_0x2766d6[Math['floor'](Math[_0x83c870(0x59c)]()*_0x2766d6[_0x83c870(0xaf9)])];_0x1b881d[_0x83c870(0x13fa)][_0x83c870(0x10fe)]=_0x1d5faf['id'],_0x53a680[_0x83c870(0x1086)]=!![],console[_0x83c870(0x498)](_0x83c870(0x66c)+_0x1d5faf['name']);}}}_0x3da570(_0x83c870(0x23c)),_0x5c7dac(),await new Promise(_0xff9c95=>setTimeout(_0xff9c95,0x5dc));}const _0x7e5043=_0x1b881d[_0x83c870(0x1550)][_0x83c870(0x1402)](_0x583aab=>_0x583aab[_0x83c870(0x1554)]===_0x83c870(0x123f)&&_0x583aab[_0x83c870(0x28f)]);if(_0x7e5043){_0x3da570(_0x83c870(0x49e)),_0x5c7dac();if(_0x7e5043['id']===_0x83c870(0xaeb)){const _0x5dfdb4=await _0xfb7a74(_0x83c870(0x3bc)),_0x2879e5=_0x1b881d[_0x83c870(0x1550)][_0x83c870(0x1402)](_0x2d3b66=>_0x2d3b66['id']===_0x5dfdb4);if(_0x2879e5){const _0x8c1148=_0x2879e5[_0x83c870(0x1554)]==='狼人';await _0x104485(_0x83c870(0x83a),'你查验的玩家\x20'+_0x2879e5[_0x83c870(0x1467)]+_0x83c870(0x69e)+(_0x8c1148?'狼人':'好人')),_0x1b881d[_0x83c870(0x13fa)][_0x83c870(0xdf1)]={'target':_0x5dfdb4,'result':_0x8c1148?'狼人':'好人'};}}else{const _0x3b94e0=_0x1b881d[_0x83c870(0x1550)][_0x83c870(0x1c0)](_0x178e8c=>_0x178e8c[_0x83c870(0x28f)]&&_0x178e8c['id']!==_0x7e5043['id']);if(_0x3b94e0[_0x83c870(0xaf9)]>0x0){const _0x4eb3fd=_0x3b94e0[Math[_0x83c870(0x15b6)](Math['random']()*_0x3b94e0[_0x83c870(0xaf9)])];_0x1b881d[_0x83c870(0x13fa)][_0x83c870(0xdf1)]={'target':_0x4eb3fd['id'],'result':_0x4eb3fd[_0x83c870(0x1554)]==='狼人'?'狼人':'好人'};}}_0x3da570('预言家已行动，预言家请闭眼。'),_0x5c7dac(),await new Promise(_0x25a6c3=>setTimeout(_0x25a6c3,0x5dc));}_0x1714b7();}async function _0x1714b7(){const _0x178f91=_0x3ce1fb;_0x1b881d[_0x178f91(0x7e4)]='第'+_0x1b881d[_0x178f91(0x477)]+_0x178f91(0xc57),_0x1b881d[_0x178f91(0x6de)]={},_0x3da570(_0x178f91(0x3f3));const {killedId:_0x1ba3df,guardedId:_0x3479b6,savedId:_0x20bf69,poisonedId:_0x19a20d}=_0x1b881d[_0x178f91(0x13fa)],_0x82b22e=new Set();_0x1ba3df&&_0x1ba3df!==_0x3479b6&&_0x1ba3df!==_0x20bf69&&_0x82b22e[_0x178f91(0xbd0)](_0x1ba3df);_0x19a20d&&_0x82b22e[_0x178f91(0xbd0)](_0x19a20d);if(_0x82b22e[_0x178f91(0x8ca)]===0x0)_0x3da570(_0x178f91(0x1236));else for(const _0x2fe053 of _0x82b22e){const _0x135fe3=_0x1b881d[_0x178f91(0x1550)][_0x178f91(0x1402)](_0x4e84c1=>_0x4e84c1['id']===_0x2fe053);if(_0x135fe3&&_0x135fe3[_0x178f91(0x28f)]){_0x135fe3[_0x178f91(0x28f)]=![],_0x3da570(_0x178f91(0x1016)+_0x135fe3[_0x178f91(0x1467)]+_0x178f91(0x1515));if(_0x135fe3[_0x178f91(0x1554)]==='猎人'){_0x3da570(_0x178f91(0x881)),_0x5c7dac();let _0x3db629=null;if(_0x135fe3['id']===_0x178f91(0xaeb))_0x3db629=await _0xfb7a74(_0x178f91(0x439));else{const _0x57e980=_0x1b881d[_0x178f91(0x1550)][_0x178f91(0x1c0)](_0x1f2837=>_0x1f2837['isAlive']&&_0x1f2837['id']!==_0x135fe3['id']);_0x57e980['length']>0x0&&(_0x3db629=_0x57e980[Math[_0x178f91(0x15b6)](Math[_0x178f91(0x59c)]()*_0x57e980[_0x178f91(0xaf9)])]['id']);}const _0x3836dd=_0x1b881d['players']['find'](_0x281d8d=>_0x281d8d['id']===_0x3db629);_0x3836dd&&(_0x3836dd['isAlive']=![],_0x3da570(_0x178f91(0x48b)+_0x3836dd[_0x178f91(0x1467)]+'。'));}}}_0x5c7dac();if(_0x28893b())return;await _0x598628();}async function _0x598628(){const _0x22b369=_0x3ce1fb;_0x3da570('现在开始讨论，请各位玩家依次发言。'),_0x5c7dac();const {proxyUrl:_0x358169,apiKey:_0x1f3dd6,model:_0x5a3136}=_0x16699d['apiConfig'];if(!_0x358169||!_0x1f3dd6||!_0x5a3136){alert(_0x22b369(0xc72));return;}const _0x502ac8=_0x1692d2();_0x1b881d[_0x22b369(0x129f)]='startDiscussion';try{await _0x104485(_0x22b369(0x128f),'正在等待AI角色们进行激烈的讨论...');let _0x3b232e=_0x358169[_0x22b369(0x1336)]('generativelanguage'),_0x29ffc4=[{'role':_0x22b369(0xaeb),'content':_0x22b369(0x265)}],_0x2de875=_0xe8c788(_0x5a3136,_0x1f3dd6,_0x502ac8,_0x29ffc4);const _0x3ae709=_0x3b232e?await fetch(_0x2de875[_0x22b369(0x9a8)],_0x2de875[_0x22b369(0x92a)]):await fetch(_0x358169+_0x22b369(0x110e),{'method':_0x22b369(0xdca),'headers':{'Content-Type':'application/json','Authorization':_0x22b369(0xb0e)+_0x1f3dd6},'body':JSON[_0x22b369(0x526)]({'model':_0x5a3136,'messages':[{'role':_0x22b369(0x11af),'content':_0x502ac8},..._0x29ffc4],'temperature':_0x16699d[_0x22b369(0xf9c)][_0x22b369(0x382)]||0.95})});if(!_0x3ae709['ok']){const _0x2b7869=await _0x3ae709[_0x22b369(0x21d)]();throw new Error(_0x22b369(0x69a)+_0x2b7869[_0x22b369(0xc3e)][_0x22b369(0x74b)]);}const _0x153337=await _0x3ae709[_0x22b369(0x21d)](),_0x5590da=getGeminiResponseText(_0x153337),_0x4e944e=_0x5590da[_0x22b369(0x9a3)](/(\[[\s\S]*\])/);if(!_0x4e944e)throw new Error(_0x22b369(0x1071)+_0x5590da);const _0xc19c53=JSON[_0x22b369(0xde0)](_0x4e944e[0x0]);for(const _0x28cff8 of _0xc19c53){_0x28cff8['speaker_name']&&_0x28cff8['dialogue']&&(_0x5984ba(_0x28cff8[_0x22b369(0x11c6)],_0x28cff8['dialogue']),_0x5c7dac(),await new Promise(_0x3e5e65=>setTimeout(_0x3e5e65,0x5dc+Math[_0x22b369(0x59c)]()*0x7d0)));}_0x1b881d['lastFailedAction']=null;}catch(_0x96dccd){console[_0x22b369(0xc3e)]('狼人杀AI讨论生成失败:',_0x96dccd),await _0x104485('AI\x20发言失败',_0x22b369(0x19b)+_0x96dccd[_0x22b369(0x74b)]),document[_0x22b369(0x948)](_0x22b369(0x742))[_0x22b369(0xf74)][_0x22b369(0x11fd)]=_0x22b369(0x1273);return;}const _0x97f212=_0x1b881d[_0x22b369(0x1550)][_0x22b369(0x1402)](_0x4b6aa2=>_0x4b6aa2['id']===_0x22b369(0xaeb)),_0x2c237c=document['getElementById']('werewolf-action-bar'),_0x1b18af=document[_0x22b369(0x948)](_0x22b369(0x8a1)),_0xbace81=document['getElementById']('werewolf-finish-speech-btn'),_0x501680=document[_0x22b369(0x948)](_0x22b369(0x12fb));_0x2c237c[_0x22b369(0xf74)][_0x22b369(0x11fd)]=_0x22b369(0x6a4);if(_0x97f212&&_0x97f212['isAlive']){_0x1b18af[_0x22b369(0x10cb)]=_0x22b369(0xf5e),_0xbace81[_0x22b369(0x10cb)]=_0x22b369(0x9a6),_0x1b18af[_0x22b369(0xf74)][_0x22b369(0x11fd)]=_0x22b369(0x1273),_0xbace81[_0x22b369(0xf74)][_0x22b369(0x11fd)]=_0x22b369(0x1273),_0x501680[_0x22b369(0x2c0)]=![],_0x501680['placeholder']=_0x22b369(0xdaf),_0x501680[_0x22b369(0x348)]();const _0x30319e=_0x1b18af[_0x22b369(0xfc0)](!![]);_0x1b18af[_0x22b369(0x1579)][_0x22b369(0x868)](_0x30319e,_0x1b18af),_0x30319e['addEventListener']('click',_0x165455);const _0x3a3dcb=_0xbace81[_0x22b369(0xfc0)](!![]);_0xbace81[_0x22b369(0x1579)][_0x22b369(0x868)](_0x3a3dcb,_0xbace81),_0x3a3dcb['addEventListener']('click',_0x457a6d);}else{_0x3da570('你已经死亡，无法发言。请等待其他玩家发言结束。'),_0x5c7dac(),_0x1b18af[_0x22b369(0x10cb)]=_0x22b369(0xcbe),_0xbace81[_0x22b369(0x10cb)]='进入投票',_0x1b18af[_0x22b369(0xf74)][_0x22b369(0x11fd)]=_0x22b369(0x1273),_0xbace81['style'][_0x22b369(0x11fd)]=_0x22b369(0x1273),_0x501680[_0x22b369(0x2c0)]=!![],_0x501680['placeholder']=_0x22b369(0x6c2);const _0x3992f6=_0x1b18af['cloneNode'](!![]);_0x1b18af[_0x22b369(0x1579)][_0x22b369(0x868)](_0x3992f6,_0x1b18af),_0x3992f6[_0x22b369(0x339)]('click',_0x5140dc);const _0x185cee=_0xbace81['cloneNode'](!![]);_0xbace81['parentNode']['replaceChild'](_0x185cee,_0xbace81),_0x185cee[_0x22b369(0x339)](_0x22b369(0x4f6),_0x145248);}}function _0x1692d2(){const _0x25e63b=_0x3ce1fb,_0x448cce=_0x1b881d[_0x25e63b(0x1550)]['filter'](_0x1b4247=>_0x1b4247['isAlive']),_0x5265aa=_0x1b881d['players'][_0x25e63b(0x1402)](_0x3b9f04=>_0x3b9f04['id']==='user'),_0x587ae6=_0x5265aa?_0x5265aa[_0x25e63b(0x1467)]:'用户',_0x53bd43=_0x448cce[_0x25e63b(0x1502)](_0x288fd2=>_0x288fd2['id']==='user');let _0x3dad87=_0x25e63b(0xf84);_0x3dad87+=_0x25e63b(0x1391),_0x448cce[_0x25e63b(0x427)]((_0x9bc5fd,_0x533dd7)=>{const _0x3af1a5=_0x25e63b,_0x2c7ddd=_0x1b881d['players'][_0x3af1a5(0x1018)](_0x2fef69=>_0x2fef69['id']===_0x9bc5fd['id'])+0x1;let _0x2e76c2='';const _0x262caf=_0x16699d['chats'][_0x9bc5fd['id']];if(_0x262caf){const _0x2a19cf=_0x448cce[_0x3af1a5(0x1c0)](_0x32b70e=>_0x32b70e['id']!==_0x9bc5fd['id']&&_0x16699d[_0x3af1a5(0x1474)][_0x32b70e['id']]&&_0x16699d[_0x3af1a5(0x1474)][_0x32b70e['id']]['groupId']===_0x262caf[_0x3af1a5(0xaa9)]&&_0x262caf['groupId']!==null)['map'](_0x63493d=>_0x63493d[_0x3af1a5(0x1467)])['join']('、');_0x2a19cf&&(_0x2e76c2+=_0x3af1a5(0xfa7)+_0x2a19cf+_0x3af1a5(0x6bf));}_0x9bc5fd['id']!==_0x3af1a5(0xaeb)&&(_0x2e76c2+='-\x20**与用户的关系**:\x20你和用户('+_0x587ae6+_0x3af1a5(0x1136));_0x3dad87+=_0x3af1a5(0x1011)+_0x2c7ddd+_0x3af1a5(0xa44)+_0x9bc5fd[_0x3af1a5(0x1467)]+_0x3af1a5(0x673)+_0x9bc5fd[_0x3af1a5(0x628)]+_0x3af1a5(0x1177)+(_0x9bc5fd['id']===_0x3af1a5(0xaeb)?_0x3af1a5(0x11e6):_0x3af1a5(0x93a))+_0x3af1a5(0x10ac)+_0x9bc5fd['character_persona']+'\x0a';if(_0x9bc5fd[_0x3af1a5(0x4ae)]===_0x3af1a5(0x4d1)){const _0x33776d=_0x16699d['chats'][_0x9bc5fd['id']];if(_0x33776d&&_0x33776d['longTermMemory']&&_0x33776d[_0x3af1a5(0x758)][_0x3af1a5(0xaf9)]>0x0){const _0x53541c=_0x33776d[_0x3af1a5(0x758)]['map'](_0x2a7841=>_0x2a7841[_0x3af1a5(0xede)])[_0x3af1a5(0x121a)](';\x20');_0x3dad87+='-\x20**长期记忆\x20(必须参考)**:\x20'+_0x53541c+'\x0a';}}_0x2e76c2&&(_0x3dad87+=_0x3af1a5(0xa53)+_0x2e76c2);});let _0x551440=_0x25e63b(0xe4e);_0x551440+='这是所有玩家都能听到的【公开信息】。\x0a';const _0xb6edcc=_0x1b881d['gameLog'][_0x25e63b(0x1c0)](_0x2fbb76=>_0x2fbb76[_0x25e63b(0xede)][_0x25e63b(0x1336)](_0x25e63b(0xf59))&&_0x2fbb76[_0x25e63b(0x5ed)]===_0x1b881d[_0x25e63b(0x477)]);_0xb6edcc['length']===0x0?_0x551440+=_0x25e63b(0xf57):_0xb6edcc[_0x25e63b(0x427)](_0x13fc7e=>{const _0x2751f0=_0x25e63b;_0x551440+='-\x20'+_0x13fc7e[_0x2751f0(0xede)]+'\x0a';});let _0x1390d9=_0x25e63b(0x84f);if(_0x1b881d[_0x25e63b(0x477)]>0x1)for(let _0x29d7be=0x1;_0x29d7be<_0x1b881d[_0x25e63b(0x477)];_0x29d7be++){_0x1390d9+=_0x25e63b(0x907)+_0x29d7be+'\x20天\x20---**\x0a';const _0x4dd531=_0x1b881d[_0x25e63b(0xd1e)]['filter'](_0xd30ce=>_0xd30ce[_0x25e63b(0x5ed)]===_0x29d7be&&(_0xd30ce['content'][_0x25e63b(0x1336)]('死亡')||_0xd30ce[_0x25e63b(0xede)]['includes']('放逐')));_0x4dd531[_0x25e63b(0xaf9)]>0x0?_0x1390d9+=_0x25e63b(0xe94)+_0x4dd531[_0x25e63b(0x8ff)](_0x5159ee=>_0x5159ee[_0x25e63b(0xede)])['join']('\x20')+'\x0a':_0x1390d9+='*事件*:\x20平安夜，无人出局。\x0a';const _0x23652e=_0x1b881d['discussionLog'][_0x25e63b(0x1c0)](_0x5cf9d2=>_0x5cf9d2['day']===_0x29d7be);_0x23652e['length']>0x0&&(_0x1390d9+=_0x25e63b(0x101c)+_0x23652e['map'](_0x194569=>'-\x20'+_0x194569[_0x25e63b(0xf2b)]+':\x20'+_0x194569[_0x25e63b(0xede)])[_0x25e63b(0x121a)]('\x0a')+'\x0a');}else _0x1390d9+='(今天是第一天，没有历史记录)\x0a';let _0x30d706='#\x20今日完整讨论记录\x20(Today\x27s\x20Full\x20Discussion\x20Record)\x0a';const _0x3ff937=_0x1b881d[_0x25e63b(0xb4b)][_0x25e63b(0x1c0)](_0x81eb5=>_0x81eb5['day']===_0x1b881d['currentDay']);_0x3ff937['length']>0x0?_0x30d706+=_0x3ff937['map'](_0x1d1d63=>'-\x20**'+_0x1d1d63[_0x25e63b(0xf2b)]+_0x25e63b(0x1de)+_0x1d1d63[_0x25e63b(0xede)])[_0x25e63b(0x121a)]('\x0a'):_0x30d706+=_0x25e63b(0xc1d);let _0x38d3c5='\x0a#\x20【【【逻辑隔离与TGS三核思考\x20(最高优先级指令)】】】\x0a为了兼顾游戏逻辑和角色扮演，你【必须】在内部为【每一个AI角色】按顺序执行以下“三阶段思考”：\x0a\x0a##\x20阶段1：内部独立思考\x20(Internal\x20Monologue\x20Scratchpad)\x0a(这部分内容【绝对不能】出现在你最终的JSON输出中，这仅供你内部模拟使用)\x0a';_0x448cce['forEach'](_0x19e0fb=>{const _0x1ec110=_0x25e63b;if(_0x19e0fb['id']!==_0x1ec110(0xaeb)){const _0x4b2a92=_0x1b881d[_0x1ec110(0x1550)]['findIndex'](_0x2b364d=>_0x2b364d['id']===_0x19e0fb['id'])+0x1;_0x38d3c5+='\x0a###\x20正在模拟\x20'+_0x4b2a92+_0x1ec110(0xa44)+_0x19e0fb[_0x1ec110(0x1467)]+_0x1ec110(0x413)+_0x19e0fb[_0x1ec110(0x628)]+_0x1ec110(0x53d)+_0x19e0fb[_0x1ec110(0x1554)]+_0x1ec110(0x1129);let _0x406043='';if(_0x19e0fb['role']==='狼人'){const _0x2d218a=_0x1b881d[_0x1ec110(0x1550)][_0x1ec110(0x1c0)](_0x1abd50=>_0x1abd50[_0x1ec110(0x1554)]==='狼人'&&_0x1abd50['id']!==_0x19e0fb['id']&&_0x1abd50[_0x1ec110(0x28f)])[_0x1ec110(0x8ff)](_0x17795e=>_0x17795e[_0x1ec110(0x1467)])[_0x1ec110(0x121a)]('、');_0x406043+=_0x1ec110(0x1227)+(_0x2d218a||'无')+'\x0a';const _0x82e44f=_0x1b881d[_0x1ec110(0x1550)][_0x1ec110(0x1402)](_0x562b87=>_0x562b87['id']===_0x1b881d[_0x1ec110(0x13fa)][_0x1ec110(0x4b9)]);_0x406043+='\x20\x20\x20\x20-\x20我们昨晚攻击了：'+(_0x82e44f?_0x82e44f[_0x1ec110(0x1467)]:'空刀')+'\x0a';}if(_0x19e0fb[_0x1ec110(0x1554)]==='预言家'&&_0x1b881d[_0x1ec110(0x13fa)][_0x1ec110(0xdf1)]){const _0x180f75=_0x1b881d[_0x1ec110(0x1550)][_0x1ec110(0x1402)](_0x4e217f=>_0x4e217f['id']===_0x1b881d['nightActions'][_0x1ec110(0xdf1)]['target']);_0x406043+=_0x1ec110(0xe42)+_0x180f75[_0x1ec110(0x1467)]+_0x1ec110(0x138d)+_0x1b881d['nightActions']['prophetCheck'][_0x1ec110(0x22a)]+'】\x0a';}if(_0x19e0fb['role']==='女巫'){if(_0x1b881d['nightActions'][_0x1ec110(0x31a)]){const _0x41f509=_0x1b881d[_0x1ec110(0x1550)]['find'](_0x3ac1d9=>_0x3ac1d9['id']===_0x1b881d[_0x1ec110(0x13fa)][_0x1ec110(0x31a)]);_0x406043+='\x20\x20\x20\x20-\x20我昨晚用解药救了\x20'+_0x41f509[_0x1ec110(0x1467)]+'。\x0a';}if(_0x1b881d[_0x1ec110(0x13fa)][_0x1ec110(0x10fe)]){const _0x53ccf3=_0x1b881d['players'][_0x1ec110(0x1402)](_0x3f29bd=>_0x3f29bd['id']===_0x1b881d[_0x1ec110(0x13fa)][_0x1ec110(0x10fe)]);_0x406043+=_0x1ec110(0x1103)+_0x53ccf3[_0x1ec110(0x1467)]+'。\x0a';}_0x406043+='\x20\x20\x20\x20-\x20我的解药：'+(_0x19e0fb['antidoteUsed']?'已使用':'未使用')+'\x0a',_0x406043+=_0x1ec110(0xcf2)+(_0x19e0fb[_0x1ec110(0x1086)]?_0x1ec110(0x12e6):_0x1ec110(0x13a3))+'\x0a';}if(_0x19e0fb[_0x1ec110(0x1554)]==='守卫'){if(_0x1b881d[_0x1ec110(0x13fa)][_0x1ec110(0x452)]){const _0x2c060e=_0x1b881d[_0x1ec110(0x1550)][_0x1ec110(0x1402)](_0x3c6e0d=>_0x3c6e0d['id']===_0x1b881d[_0x1ec110(0x13fa)][_0x1ec110(0x452)]);_0x406043+=_0x1ec110(0x6ad)+_0x2c060e[_0x1ec110(0x1467)]+'。\x0a';}else _0x406043+=_0x1ec110(0x1539);}_0x406043===''&&(_0x406043=_0x1ec110(0x4cd));_0x38d3c5+=_0x406043,_0x38d3c5+=_0x1ec110(0x56f)+_0x551440[_0x1ec110(0x14e9)](/\n/g,'\x20')+_0x1ec110(0xf01)+_0x30d706[_0x1ec110(0x14e9)](/\n/g,'\x20')+'\x0a4.\x20\x20**我的人设与社交关系**:\x0a\x20\x20\x20\x20-\x20**人设**:\x20'+_0x19e0fb['character_persona']+_0x1ec110(0xb37);let _0x1dfda1='';const _0x1881c6=_0x16699d[_0x1ec110(0x1474)][_0x19e0fb['id']];if(_0x1881c6){const _0x4f4a3c=_0x448cce[_0x1ec110(0x1c0)](_0x3cb29d=>_0x3cb29d['id']!==_0x19e0fb['id']&&_0x16699d[_0x1ec110(0x1474)][_0x3cb29d['id']]&&_0x16699d[_0x1ec110(0x1474)][_0x3cb29d['id']][_0x1ec110(0xaa9)]===_0x1881c6['groupId']&&_0x1881c6[_0x1ec110(0xaa9)]!==null)[_0x1ec110(0x8ff)](_0x14214a=>_0x14214a[_0x1ec110(0x1467)])[_0x1ec110(0x121a)]('、');_0x4f4a3c&&(_0x1dfda1+=_0x1ec110(0x620)+_0x4f4a3c+_0x1ec110(0xd60));}_0x19e0fb['id']!==_0x1ec110(0xaeb)&&(_0x1dfda1+=_0x1ec110(0x620)+_0x587ae6+_0x1ec110(0x12ea)),_0x1dfda1===''&&(_0x1dfda1=_0x1ec110(0x1218)),_0x38d3c5+=_0x1dfda1,_0x38d3c5+=_0x1ec110(0x769)+_0x587ae6+_0x1ec110(0xf70)+(_0x3ff937[_0x1ec110(0xaf9)]>0x0?'其他人的发言':'昨晚的死讯')+_0x1ec110(0x15b0)+_0x587ae6+_0x1ec110(0x952)+_0x587ae6+_0x1ec110(0xe74)+_0x19e0fb[_0x1ec110(0x1554)]+_0x1ec110(0x1e5)+_0x19e0fb[_0x1ec110(0x1517)][_0x1ec110(0xeca)](0x0,0x14)+_0x1ec110(0xcf0);}}),_0x38d3c5+='\x0a##\x20阶段2：生成最终对话\x20(Final\x20JSON\x20Output)\x0a你现在已经为【所有AI角色】都完成了“TGS三核”独立思考。\x0a请根据你在“阶段C：最终发言稿”中为每个角色准备好的草稿，生成最终的、符合格式的JSON数组。\x0a';const _0x4e4672=_0x25e63b(0x11ec)+(_0x53bd43?_0x25e63b(0xf4f)+_0x587ae6+')':_0x25e63b(0x201)+_0x587ae6+')')+'以外的所有AI角色，并根据他们的【角色人设】和【狼人杀身份】，生成一整轮符合逻辑、充满博弈的发言。\x0a\x0a#\x20身份与人设铁律\x20(最高优先级)\x0a你【必须】为每一个角色都仔细阅读并严格遵守下面的档案。这是你所有行为和发言的唯一依据。在对话中，请务必注意角色人设中暗示的性别，并使用正确的称呼（例如“他”或“她”）。\x0a\x0a'+_0x3dad87+_0x25e63b(0xd22)+(_0x1b881d[_0x25e63b(0x780)]===_0x25e63b(0x134c)?_0x25e63b(0x15c6):_0x25e63b(0x14ab))+_0x25e63b(0x1350)+_0x1b881d[_0x25e63b(0x477)]+_0x25e63b(0x77b)+_0x551440+_0x25e63b(0xa80)+_0x448cce[_0x25e63b(0x8ff)](_0x44e346=>_0x44e346[_0x25e63b(0x1467)]+'\x20('+(_0x44e346['id']==='user'?'用户':'AI')+')')[_0x25e63b(0x121a)](',\x20')+'\x0a\x0a#\x20【【【角色策略指南\x20(至关重要！)】】】\x0a你【不是】一个单纯的游戏玩家，你是一个【有感情、有记忆、有社交关系】的角色。你在游戏中的所有发言和行为，都【必须】首先符合你的人设以及你与其他玩家的既有关系。\x0a-\x20**朋友**:\x20如果你和某个玩家是朋友，你应该在发言时倾向于保护TA，为TA的发言寻找合理解释，除非有确凿的证据。\x0a-\x20**敌人/情敌**:\x20如果你和某个玩家有矛盾，你可以借机在游戏中攻击TA，质疑TA的发言，甚至在你是狼人时优先刀掉TA。\x0a-\x20**恋人/暗恋对象**:\x20你会无条件地信任TA，保护TA，甚至愿意为TA牺牲。\x0a你的社交关系比游戏本身的胜负更重要！\x0a你的发言【必须】体现出高水平的、类似真人的策略博弈，而不是简单地陈述事实。\x0a\x0a###\x20**神职角色\x20(预言家,\x20女巫,\x20猎人,\x20守卫)\x20策略**\x0a1.\x20\x20**【隐藏优先！】**:\x20你的首要任务是活下去。**绝对不要**在第一天就轻易暴露自己的神职身份！这会让你立刻成为狼人的目标。\x0a2.\x20\x20**【暗示而非明示】**:\x20你应该用更委婉、更聪明的语言来传递信息，而不是直接说“我是预言家，我查了A”。\x0a\x20\x20\x20\x20*\x20**预言家可以说**:\x20“我对X玩家的身份有一些看法，我觉得他发言很阳光。”\x20或\x20“Y玩家的发言让我感到很不舒服，我把他列为重点怀疑对象。”\x0a\x20\x20\x20\x20*\x20**女巫可以说**:\x20“昨晚的信息很有趣，场上局势可能和大家想的不一样。”\x0a3.\x20\x20**【何时起跳？】**:\x20只有在以下【危急情况】下，你才应该考虑暴露自己的身份（俗称“起跳”）：\x0a\x20\x20\x20\x20*\x20**被投票时**:\x20当你即将被投票放逐时，必须起跳自证身份来求生。\x0a\x20\x20\x20\x20*\x20**关键信息**:\x20当你掌握了可以决定胜负的信息时（例如预言家查到了最后一个狼人）。\x0a\x20\x20\x20\x20*\x20**有人悍跳**:\x20当有狼人假扮你的身份时，你必须站出来与他对峙，争夺好人的信任。\x0a\x0a###\x20**狼人角色策略**\x0a1.\x20\x20**【积极伪装】**:\x20你需要扮演一个好人，最好是伪装成某个神职（俗称“悍跳”），来扰乱好人的判断，骗取他们的信任。\x0a2.\x20\x20**【制造混乱】**:\x20你的发言应该引导好人去怀疑其他无辜的好人。可以故意曲解别人的发言，或者制造逻辑陷阱。\x0a3.\x20\x20**【团队合作】**:\x20如果你的狼队友被怀疑，你应该想办法为他辩护，或者通过攻击其他玩家来转移焦点。\x0a\x0a###\x20**平民角色策略**\x0a1.\x20\x20**【逻辑为王】**:\x20你是场上的“法官”。你的核心任务是仔细倾听每个人的发言，找出其中的逻辑漏洞和矛盾之处。\x0a2.\x20\x20**【积极分析】**:\x20不要只是说“我不知道，我过了”。你应该大胆说出你的怀疑，并解释你的理由。例如：“A玩家说B是狼人，但是他的理由很牵强，所以我更怀疑A。”\x0a3.\x20\x20**【跟票与站边】**:\x20在你相信某位神职玩家后，你应该坚定地支持他，并号召其他好人一起投票给神职指认的狼人。\x0a\x0a#\x20其他核心指令\x20(必须遵守)\x0a1.\x20\x20**互动铁律**:\x20角色之间【必须】互相质疑、支持、分析【本轮已有发言】。你【绝对不能】无视\x20'+_0x587ae6+_0x25e63b(0xe4a)+_0x1390d9+_0x25e63b(0x469)+_0x30d706+'\x0a\x0a'+_0x38d3c5+_0x25e63b(0xbf6);return _0x4e4672;}function _0x897560(_0x394618){const _0x162910=_0x3ce1fb;let _0x2cadf8=_0x162910(0x763);const _0x3e6e7b=_0x394618[_0x162910(0xd1e)][_0x162910(0x1402)](_0x46c653=>_0x46c653[_0x162910(0xede)]['includes']('胜利'))?.['content']||_0x162910(0xa9b);_0x2cadf8+=_0x162910(0x13e6)+_0x3e6e7b+'\x0a\x0a',_0x2cadf8+=_0x162910(0x9f0),_0x394618[_0x162910(0x1550)][_0x162910(0x427)](_0x252ca7=>{const _0x15ca36=_0x162910,_0xa5ce73=_0x252ca7[_0x15ca36(0x28f)]?'存活':_0x15ca36(0x1529);_0x2cadf8+='-\x20'+_0x252ca7[_0x15ca36(0x1467)]+':\x20'+_0x252ca7['role']+'\x20('+_0xa5ce73+')\x0a';}),_0x2cadf8+=_0x162910(0x599);for(let _0x36fe90=0x1;_0x36fe90<=_0x394618[_0x162910(0x477)];_0x36fe90++){_0x2cadf8+=_0x162910(0x907)+_0x36fe90+_0x162910(0x7b6);const _0x56e504=_0x394618[_0x162910(0xd1e)][_0x162910(0x1c0)](_0x4defe0=>_0x4defe0[_0x162910(0x5ed)]===_0x36fe90&&_0x4defe0[_0x162910(0xede)][_0x162910(0x1336)]('死亡'));if(_0x56e504[_0x162910(0xaf9)]>0x0)_0x2cadf8+=_0x162910(0xd1b)+_0x56e504[_0x162910(0x8ff)](_0x2ff32e=>_0x2ff32e[_0x162910(0xede)])[_0x162910(0x121a)]('\x20')+'\x0a';else(_0x36fe90>0x1||_0x36fe90===0x1&&_0x394618['currentDay']>0x1)&&(_0x2cadf8+=_0x162910(0x14c0));const _0x116d93=_0x394618[_0x162910(0xb4b)][_0x162910(0x1c0)](_0x21574c=>_0x21574c[_0x162910(0x5ed)]===_0x36fe90);_0x116d93['length']>0x0&&(_0x2cadf8+='**[讨论环节]**\x0a'+_0x116d93[_0x162910(0x8ff)](_0x595af7=>'-\x20'+_0x595af7[_0x162910(0xf2b)]+':\x20'+_0x595af7[_0x162910(0xede)])[_0x162910(0x121a)]('\x0a')+'\x0a');const _0x5db32c=_0x394618[_0x162910(0xd1e)][_0x162910(0x1402)](_0x19857a=>_0x19857a[_0x162910(0x5ed)]===_0x36fe90&&_0x19857a[_0x162910(0xede)][_0x162910(0x1336)](_0x162910(0x99f)));_0x5db32c&&(_0x2cadf8+='**[投票结果]**\x20'+_0x5db32c[_0x162910(0xede)]+'\x0a');}return _0x2cadf8+=_0x162910(0xbec),_0x2cadf8;}async function _0x8fabff(_0x38b604){const _0x4ba4ab=_0x3ce1fb;let _0xf3868f=0x0;for(const _0x1fbcba of _0x1b881d['players']){if(_0x1fbcba[_0x4ba4ab(0x4ae)]===_0x4ba4ab(0x4d1)){const _0x1bad36=_0x16699d[_0x4ba4ab(0x1474)][_0x1fbcba['id']];if(_0x1bad36){const _0x271e25={'content':_0x38b604,'timestamp':Date[_0x4ba4ab(0x1386)](),'source':'werewolf_summary'};!_0x1bad36[_0x4ba4ab(0x758)]&&(_0x1bad36[_0x4ba4ab(0x758)]=[]),_0x1bad36[_0x4ba4ab(0x758)]['push'](_0x271e25),await _0x6ed281[_0x4ba4ab(0x1474)][_0x4ba4ab(0x90c)](_0x1bad36),_0xf3868f++;}}}return _0xf3868f;}async function _0x2581b7(){const _0x56e58a=_0x3ce1fb;if(!_0x1b881d[_0x56e58a(0x1032)]&&_0x1b881d[_0x56e58a(0x7e4)]===_0x56e58a(0x12a6)){await _0x104485(_0x56e58a(0x960),'正在为所有AI角色生成并注入游戏记忆...');try{const _0x2f4de4=_0x897560(_0x1b881d),_0x244052=await _0x8fabff(_0x2f4de4);await _0x104485('成功','游戏记忆已成功注入到\x20'+_0x244052+_0x56e58a(0x138b));}catch(_0x4b446c){console[_0x56e58a(0xc3e)](_0x56e58a(0x1489),_0x4b446c),await _0x104485('失败',_0x56e58a(0x86b)+_0x4b446c[_0x56e58a(0x74b)]);}}else alert(_0x56e58a(0x5d3));}async function _0x506f5c(_0x558734){const _0x3fe429=_0x3ce1fb;_0x1b881d[_0x3fe429(0x1032)]=![],_0x1b881d['currentPhase']='gameover',_0x3da570(_0x558734+'阵营胜利！'),document['getElementById']('werewolf-game-over-title')['textContent']=_0x558734+'胜利！';let _0x3f1167='';_0x558734==='好人'?_0x3f1167='所有狼人已被放逐，好人阵营获得了胜利！':_0x3f1167=_0x3fe429(0x1317);const _0x16298a=document[_0x3fe429(0x948)](_0x3fe429(0x9f3));_0x16298a[_0x3fe429(0x10cb)]=_0x3f1167;const _0x24d721=document[_0x3fe429(0x948)](_0x3fe429(0x8b3));_0x24d721['innerHTML']='';const _0x306d34=[..._0x1b881d['players']][_0x3fe429(0xe96)]((_0xf33e58,_0x53e781)=>{const _0x2eab31=_0x3fe429,_0x594b17=_0x1b881d[_0x2eab31(0x1550)][_0x2eab31(0x1018)](_0x3fbfe1=>_0x3fbfe1['id']===_0xf33e58['id']),_0x557070=_0x1b881d[_0x2eab31(0x1550)][_0x2eab31(0x1018)](_0x2191f4=>_0x2191f4['id']===_0x53e781['id']);return _0x594b17-_0x557070;});_0x306d34[_0x3fe429(0x427)]((_0xe6190a,_0x502864)=>{const _0x3dcbdb=_0x3fe429,_0x2361f9=document['createElement'](_0x3dcbdb(0x379));_0x2361f9[_0x3dcbdb(0xf74)][_0x3dcbdb(0x8e7)]=_0x3dcbdb(0x8fd);if(_0x502864===_0x306d34[_0x3dcbdb(0xaf9)]-0x1)_0x2361f9[_0x3dcbdb(0xf74)]['borderBottom']=_0x3dcbdb(0x12fe);const _0xc352b0=_0xe6190a[_0x3dcbdb(0x1554)]==='狼人'?'#ff4d4d':_0x3dcbdb(0xe02);_0x2361f9[_0x3dcbdb(0xb6f)]=_0x3dcbdb(0xe37)+_0xe6190a[_0x3dcbdb(0x63e)]+'\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20border-radius:\x2050%;\x20margin-right:\x2012px;\x20filter:\x20'+(_0xe6190a[_0x3dcbdb(0x28f)]?_0x3dcbdb(0x12fe):_0x3dcbdb(0x11cd))+_0x3dcbdb(0x1a9)+(_0xe6190a[_0x3dcbdb(0x28f)]?'none':_0x3dcbdb(0x5be))+_0x3dcbdb(0x511)+(_0x502864+0x1)+'.\x20'+_0xe6190a[_0x3dcbdb(0x1467)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20'+_0xc352b0+';\x22>'+_0xe6190a[_0x3dcbdb(0x1554)]+_0x3dcbdb(0xce6),_0x24d721[_0x3dcbdb(0x6b6)](_0x2361f9);}),document[_0x3fe429(0x948)]('werewolf-game-over-modal')[_0x3fe429(0xd54)]['add'](_0x3fe429(0xfcb));try{console[_0x3fe429(0x498)](_0x3fe429(0xaa5));const _0x353a0e=_0x897560(_0x1b881d),_0x2642b7=await generateAndInjectWerewolfMemories(_0x353a0e);console[_0x3fe429(0x498)](_0x3fe429(0x141a)+_0x2642b7+'\x20位角色的记忆中。');}catch(_0x23c509){console[_0x3fe429(0xc3e)](_0x3fe429(0x12a8),_0x23c509),_0x16298a&&(_0x16298a[_0x3fe429(0xb6f)]+=_0x3fe429(0x2b1));}}function _0x3da570(_0x5aa373){const _0x3d40fc=_0x3ce1fb;_0x1b881d['gameLog']['push']({'type':_0x3d40fc(0x11af),'content':_0x5aa373,'timestamp':Date['now'](),'day':_0x1b881d['currentDay']});}function _0x5984ba(_0x3fd5cd,_0x468929){const _0xb36be2=_0x3ce1fb;_0x1b881d[_0xb36be2(0xb4b)]['push']({'type':_0xb36be2(0x13c5),'speaker':_0x3fd5cd,'content':_0x468929,'timestamp':Date[_0xb36be2(0x1386)](),'day':_0x1b881d['currentDay']});}function _0xfb7a74(_0x94da66){return new Promise(_0x40f9a9=>{const _0x2e55bd=_0x6c9e,_0x45e5d9=_0x2e55bd(0x24a)+_0x94da66+'-modal',_0x9a3357='werewolf-'+_0x94da66+_0x2e55bd(0x3a1);let _0x4cbdb8='';if(_0x94da66==='prophet')_0x4cbdb8=_0x2e55bd(0xdba);if(_0x94da66==='hunter')_0x4cbdb8=_0x2e55bd(0x1370);if(_0x94da66===_0x2e55bd(0xd1a))_0x4cbdb8=_0x2e55bd(0xe90);const _0x40b310=document[_0x2e55bd(0x948)](_0x45e5d9),_0x5e3c45=document[_0x2e55bd(0x948)](_0x9a3357),_0x4e49ba=document['getElementById'](_0x4cbdb8);_0x5e3c45[_0x2e55bd(0xb6f)]='';let _0x5b3d77=null;const _0x568824=_0x1b881d[_0x2e55bd(0x1550)]['filter'](_0x3757ab=>_0x3757ab[_0x2e55bd(0x28f)]&&(_0x94da66===_0x2e55bd(0x439)||_0x94da66===_0x2e55bd(0xd1a)||_0x3757ab['id']!==_0x2e55bd(0xaeb)));_0x568824[_0x2e55bd(0x427)](_0x5e1c5f=>{const _0x23a95a=_0x2e55bd,_0x5f339b=document['createElement'](_0x23a95a(0x379));_0x5f339b['className']=_0x23a95a(0x3be),_0x5f339b[_0x23a95a(0x606)]['id']=_0x5e1c5f['id'],_0x5f339b[_0x23a95a(0xb6f)]=_0x23a95a(0x4ad)+_0x5e1c5f[_0x23a95a(0x63e)]+_0x23a95a(0x3d6)+_0x5e1c5f[_0x23a95a(0x1467)]+_0x23a95a(0xffc),_0x5f339b[_0x23a95a(0xe8d)]=()=>{const _0x5ce88c=_0x23a95a;_0x5e3c45[_0x5ce88c(0x1188)]('.selected')['forEach'](_0x27330a=>_0x27330a[_0x5ce88c(0xd54)][_0x5ce88c(0xf89)](_0x5ce88c(0xd56))),_0x5f339b[_0x5ce88c(0xd54)][_0x5ce88c(0xbd0)](_0x5ce88c(0xd56)),_0x5b3d77=_0x5e1c5f['id'];},_0x5e3c45['appendChild'](_0x5f339b);});const _0x3ca394=_0x4e49ba[_0x2e55bd(0xfc0)](!![]);_0x4e49ba['parentNode'][_0x2e55bd(0x868)](_0x3ca394,_0x4e49ba),_0x3ca394[_0x2e55bd(0xe8d)]=()=>{const _0x30f78c=_0x2e55bd;_0x5b3d77?(_0x40b310[_0x30f78c(0xd54)][_0x30f78c(0xf89)](_0x30f78c(0xfcb)),_0x40f9a9(_0x5b3d77)):alert(_0x30f78c(0xafb));},_0x40b310['classList'][_0x2e55bd(0xbd0)](_0x2e55bd(0xfcb));});}function _0x3b5a0c(){return new Promise(_0x3a53d3=>{const _0x481f87=_0x6c9e,_0x4149cc=document[_0x481f87(0x948)](_0x481f87(0x10a0)),_0x56e3cd=document[_0x481f87(0x948)](_0x481f87(0xb92)),_0x4510a8=document[_0x481f87(0x948)](_0x481f87(0xebf)),_0x1fcb86=_0x4149cc[_0x481f87(0xfeb)]('.modal-header\x20span'),_0x5e16d8=_0x1b881d[_0x481f87(0x1550)][_0x481f87(0x1c0)](_0xd7352f=>_0xd7352f[_0x481f87(0x1554)]==='狼人'&&_0xd7352f[_0x481f87(0x28f)]),_0x3a30a9=_0x5e16d8[_0x481f87(0x1c0)](_0x334c4d=>_0x334c4d['id']!==_0x481f87(0xaeb))[_0x481f87(0x8ff)](_0x4d03ed=>_0x4d03ed[_0x481f87(0x1467)])[_0x481f87(0x121a)]('、');_0x3a30a9?_0x1fcb86['innerHTML']=_0x481f87(0x48c)+_0x3a30a9+_0x481f87(0x1390):_0x1fcb86['textContent']=_0x481f87(0x1456);_0x56e3cd[_0x481f87(0xb6f)]='';let _0x3f5d2a=null;const _0x4908dc=_0x1b881d[_0x481f87(0x1550)][_0x481f87(0x1c0)](_0x3efafa=>_0x3efafa[_0x481f87(0x28f)]&&_0x3efafa[_0x481f87(0x1554)]!=='狼人');_0x4908dc['forEach'](_0x277e22=>{const _0x5dfcd3=_0x481f87,_0x17932f=document[_0x5dfcd3(0x1497)](_0x5dfcd3(0x379));_0x17932f['className']=_0x5dfcd3(0x3be),_0x17932f[_0x5dfcd3(0x606)]['id']=_0x277e22['id'],_0x17932f['innerHTML']=_0x5dfcd3(0x4ad)+_0x277e22[_0x5dfcd3(0x63e)]+_0x5dfcd3(0x3d6)+_0x277e22[_0x5dfcd3(0x1467)]+_0x5dfcd3(0xffc),_0x17932f[_0x5dfcd3(0xe8d)]=()=>{const _0x2cc48d=_0x5dfcd3;_0x56e3cd[_0x2cc48d(0x1188)](_0x2cc48d(0x50a))['forEach'](_0x12dccd=>_0x12dccd[_0x2cc48d(0xd54)]['remove'](_0x2cc48d(0xd56))),_0x17932f[_0x2cc48d(0xd54)][_0x2cc48d(0xbd0)](_0x2cc48d(0xd56)),_0x3f5d2a=_0x277e22['id'];},_0x56e3cd['appendChild'](_0x17932f);});const _0xecbd56=_0x4510a8[_0x481f87(0xfc0)](!![]);_0x4510a8['parentNode'][_0x481f87(0x868)](_0xecbd56,_0x4510a8),_0xecbd56[_0x481f87(0xe8d)]=()=>{const _0x4b7e11=_0x481f87;_0x3f5d2a?(_0x4149cc[_0x4b7e11(0xd54)]['remove'](_0x4b7e11(0xfcb)),_0x3a53d3(_0x3f5d2a)):alert(_0x4b7e11(0xafb));},_0x4149cc['classList'][_0x481f87(0xbd0)](_0x481f87(0xfcb));});}function _0x457a6d(){const _0x1e9bee=_0x3ce1fb,_0x3b34f4=_0x1b881d[_0x1e9bee(0x1550)][_0x1e9bee(0x1402)](_0x48fee4=>_0x48fee4['id']===_0x1e9bee(0xaeb));if(!_0x3b34f4||!_0x3b34f4[_0x1e9bee(0x28f)])return;const _0xec03e8=document['getElementById']('werewolf-user-input'),_0x31da57=_0xec03e8['value'][_0x1e9bee(0x2a8)]();_0x31da57&&(_0x5984ba(_0x3b34f4['name'],_0x31da57),_0x5c7dac()),document['getElementById']('werewolf-action-bar')[_0x1e9bee(0xf74)][_0x1e9bee(0x11fd)]=_0x1e9bee(0x12fe),_0xec03e8['value']='',_0x145248();}async function _0x5140dc(){const _0x394f45=_0x3ce1fb;_0x3da570('你让大家继续讨论...'),_0x5c7dac();const _0x437fe3=document[_0x394f45(0x948)](_0x394f45(0x8a1));if(_0x437fe3)_0x437fe3[_0x394f45(0x2c0)]=!![];await _0x104485(_0x394f45(0x128f),_0x394f45(0x1368));const {proxyUrl:_0x488f8e,apiKey:_0x3d6a56,model:_0x1e2218}=_0x16699d[_0x394f45(0x79e)];if(!_0x488f8e||!_0x3d6a56||!_0x1e2218){alert('API未配置，无法生成对话。');return;}const _0x512906=_0x1692d2();try{let _0x2099ab=_0x488f8e[_0x394f45(0x1336)]('generativelanguage'),_0x1138d0=[{'role':_0x394f45(0xaeb),'content':_0x394f45(0x12d3)}],_0x215192=_0xe8c788(_0x1e2218,_0x3d6a56,_0x512906,_0x1138d0);const _0x40bb21=_0x2099ab?await fetch(_0x215192[_0x394f45(0x9a8)],_0x215192[_0x394f45(0x92a)]):await fetch(_0x488f8e+_0x394f45(0x110e),{'method':'POST','headers':{'Content-Type':_0x394f45(0x479),'Authorization':_0x394f45(0xb0e)+_0x3d6a56},'body':JSON[_0x394f45(0x526)]({'model':_0x1e2218,'messages':[{'role':_0x394f45(0x11af),'content':_0x512906},..._0x1138d0],'temperature':_0x16699d[_0x394f45(0xf9c)][_0x394f45(0x382)]||0.9})});if(!_0x40bb21['ok']){const _0x38feb7=await _0x40bb21[_0x394f45(0x21d)]();throw new Error('API\x20错误:\x20'+_0x38feb7[_0x394f45(0xc3e)][_0x394f45(0x74b)]);}const _0x2c375f=await _0x40bb21[_0x394f45(0x21d)](),_0x2d2ce2=getGeminiResponseText(_0x2c375f),_0x451cbc=_0x2d2ce2['match'](/(\[[\s\S]*\])/);if(!_0x451cbc)throw new Error(_0x394f45(0xdf4)+_0x2d2ce2);const _0x5647d1=JSON[_0x394f45(0xde0)](_0x451cbc[0x0]);for(const _0x352144 of _0x5647d1){_0x352144['speaker_name']&&_0x352144[_0x394f45(0x13c5)]&&(_0x5984ba(_0x352144['speaker_name'],_0x352144[_0x394f45(0x13c5)]),_0x5c7dac(),await new Promise(_0x4ec3ed=>setTimeout(_0x4ec3ed,0x5dc+Math['random']()*0x7d0)));}}catch(_0xdef199){console[_0x394f45(0xc3e)](_0x394f45(0xec8),_0xdef199),await _0x104485('AI\x20发言失败',_0x394f45(0x86a)+_0xdef199[_0x394f45(0x74b)]);}finally{if(_0x437fe3)_0x437fe3['disabled']=![];}}async function _0x165455(){const _0x351815=_0x3ce1fb,_0x2647ba=_0x1b881d['players'][_0x351815(0x1402)](_0x1ef3f9=>_0x1ef3f9['id']===_0x351815(0xaeb));if(!_0x2647ba||!_0x2647ba[_0x351815(0x28f)]){console[_0x351815(0x9c1)](_0x351815(0xe14));return;}const _0x4916d3=document[_0x351815(0x948)](_0x351815(0x12fb)),_0x340722=_0x4916d3[_0x351815(0x5bc)][_0x351815(0x2a8)]();if(!_0x340722){alert(_0x351815(0xf09));return;}_0x5984ba(_0x2647ba[_0x351815(0x1467)],_0x340722),_0x5c7dac(),_0x4916d3[_0x351815(0x5bc)]='',await _0x104485(_0x351815(0x128f),'正在等待AI角色们对你的发言做出回应...');const {proxyUrl:_0x341478,apiKey:_0x5cd421,model:_0x3edd90}=_0x16699d[_0x351815(0x79e)];if(!_0x341478||!_0x5cd421||!_0x3edd90){alert('API未配置，无法生成对话。');return;}const _0x4d2715=_0x1692d2();try{let _0x439ce9=_0x341478[_0x351815(0x1336)]('generativelanguage'),_0x4defac=[{'role':'user','content':_0x351815(0x24b)+_0x2647ba['name']+_0x351815(0xf6f)}],_0x4a147f=_0xe8c788(_0x3edd90,_0x5cd421,_0x4d2715,_0x4defac);const _0x37d87c=_0x439ce9?await fetch(_0x4a147f[_0x351815(0x9a8)],_0x4a147f[_0x351815(0x92a)]):await fetch(_0x341478+_0x351815(0x110e),{'method':_0x351815(0xdca),'headers':{'Content-Type':_0x351815(0x479),'Authorization':'Bearer\x20'+_0x5cd421},'body':JSON[_0x351815(0x526)]({'model':_0x3edd90,'messages':[{'role':_0x351815(0x11af),'content':_0x4d2715},..._0x4defac],'temperature':_0x16699d[_0x351815(0xf9c)][_0x351815(0x382)]||0.9})});if(!_0x37d87c['ok']){const _0x25c689=await _0x37d87c[_0x351815(0x21d)]();throw new Error(_0x351815(0x69a)+_0x25c689[_0x351815(0xc3e)][_0x351815(0x74b)]);}const _0xfd87cc=await _0x37d87c['json'](),_0x4437f8=getGeminiResponseText(_0xfd87cc);let _0x3b84b7;try{let _0x43d337=_0x4437f8['replace'](/^```json\s*/,'')['replace'](/```$/,'')['trim']();const _0x653989=_0x43d337[_0x351815(0x539)]('['),_0x250b0d=_0x43d337[_0x351815(0x90f)](']');if(_0x653989===-0x1||_0x250b0d===-0x1||_0x250b0d<_0x653989)throw new Error(_0x351815(0x14f3));const _0x5fd5e=_0x43d337[_0x351815(0xeca)](_0x653989,_0x250b0d+0x1);_0x3b84b7=JSON[_0x351815(0xde0)](_0x5fd5e);}catch(_0x547b3c){if(_0x547b3c['message'][_0x351815(0x1336)]('Bad\x20control\x20character')){console[_0x351815(0x9c1)](_0x351815(0x5de));const _0x25fcc6=_0x56f593=>{const _0x3a2d39=_0x351815;let _0x20ebb7=![],_0x3bc199=![],_0x47766a='';for(let _0x1fed71=0x0;_0x1fed71<_0x56f593[_0x3a2d39(0xaf9)];_0x1fed71++){const _0x1b7145=_0x56f593[_0x1fed71];if(_0x3bc199){_0x47766a+=_0x1b7145,_0x3bc199=![];continue;}if(_0x1b7145==='\x5c'){_0x47766a+=_0x1b7145,_0x3bc199=!![];continue;}if(_0x1b7145==='\x22'){_0x47766a+=_0x1b7145,_0x20ebb7=!_0x20ebb7;continue;}if(_0x20ebb7){if(_0x1b7145==='\x0a')_0x47766a+='\x5cn';else{if(_0x1b7145==='\x0d')_0x47766a+='\x5cr';else{if(_0x1b7145==='\x09')_0x47766a+='\x5ct';else{if(_0x1b7145['charCodeAt'](0x0)<0x20)continue;else _0x47766a+=_0x1b7145;}}}}else _0x47766a+=_0x1b7145;}return _0x47766a;};let _0x32de97=_0x4437f8[_0x351815(0x14e9)](/^```json\s*/,'')[_0x351815(0x14e9)](/```$/,'')['trim']();const _0x24c767=_0x25fcc6(_0x32de97),_0x4f0783=_0x24c767[_0x351815(0x9a3)](/(\[[\s\S]*\])/);if(!_0x4f0783)throw new Error('清理后仍未找到JSON数组。');_0x3b84b7=JSON[_0x351815(0xde0)](_0x4f0783[0x0]);}else throw new Error(_0x351815(0xeaf)+_0x547b3c[_0x351815(0x74b)]+_0x351815(0x5b6)+_0x4437f8);}for(const _0x512362 of _0x3b84b7){_0x512362[_0x351815(0x11c6)]&&_0x512362['dialogue']&&(_0x5984ba(_0x512362[_0x351815(0x11c6)],_0x512362['dialogue']),_0x5c7dac(),await new Promise(_0x2456d4=>setTimeout(_0x2456d4,0x5dc+Math['random']()*0x7d0)));}}catch(_0xc982e0){console[_0x351815(0xc3e)](_0x351815(0xec8),_0xc982e0),await _0x104485(_0x351815(0x56c),_0x351815(0x86a)+_0xc982e0[_0x351815(0x74b)]);}}async function _0x145248(){const _0x564fe2=_0x3ce1fb;_0x3da570(_0x564fe2(0x460)),_0x5c7dac(),_0x1b881d['votes']={};let _0x9f872c=null;_0x1b881d[_0x564fe2(0x129f)]='getVotes';try{_0x9f872c=await _0x2402d2(),_0x9f872c&&_0x9f872c[_0x564fe2(0x427)](_0x244575=>{const _0x2ee03a=_0x564fe2,_0x46c186=_0x1b881d[_0x2ee03a(0x1550)]['find'](_0x5a4c5e=>_0x5a4c5e[_0x2ee03a(0x1467)]===_0x244575['voter_name']),_0x135b8c=_0x1b881d[_0x2ee03a(0x1550)][_0x2ee03a(0x1402)](_0x5e33bf=>_0x5e33bf[_0x2ee03a(0x1467)]===_0x244575[_0x2ee03a(0xc63)]);_0x46c186&&_0x46c186[_0x2ee03a(0x28f)]&&_0x135b8c&&(_0x1b881d[_0x2ee03a(0xb0b)][_0x46c186[_0x2ee03a(0x1467)]]=_0x135b8c[_0x2ee03a(0x1467)]);}),_0x1b881d[_0x564fe2(0x129f)]=null;}catch(_0x6c42cb){console['error'](_0x564fe2(0x503),_0x6c42cb),await _0x104485(_0x564fe2(0xb6c),'AI角色无法完成投票，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20'+_0x6c42cb['message']),document[_0x564fe2(0x948)](_0x564fe2(0x742))[_0x564fe2(0xf74)][_0x564fe2(0x11fd)]=_0x564fe2(0x1273);return;}const _0x38b52b=_0x1b881d[_0x564fe2(0x1550)][_0x564fe2(0x1402)](_0x1d6544=>_0x1d6544['id']===_0x564fe2(0xaeb));if(_0x38b52b&&_0x38b52b[_0x564fe2(0x28f)]){_0x3da570(_0x564fe2(0xb62)),_0x5c7dac();const _0x1c6178=await _0xfb7a74(_0x564fe2(0xd1a)),_0xcfd18b=_0x1b881d[_0x564fe2(0x1550)][_0x564fe2(0x1402)](_0x55ae2e=>_0x55ae2e['id']===_0x1c6178);_0xcfd18b&&(_0x1b881d[_0x564fe2(0xb0b)][_0x38b52b[_0x564fe2(0x1467)]]=_0xcfd18b[_0x564fe2(0x1467)]);}_0x120574();}async function _0x2402d2(){const _0x3af823=_0x3ce1fb,{proxyUrl:_0x303d9f,apiKey:_0x4f2049,model:_0x6c0e30}=_0x16699d[_0x3af823(0x79e)];if(!_0x303d9f||!_0x4f2049||!_0x6c0e30)return null;const _0x55dc49=_0x1b881d[_0x3af823(0x1550)][_0x3af823(0x1c0)](_0x224297=>_0x224297[_0x3af823(0x28f)]&&_0x224297['id']!=='user'),_0x21bbcf=_0x1b881d[_0x3af823(0x1550)][_0x3af823(0x1c0)](_0x19eec0=>_0x19eec0[_0x3af823(0x28f)])['map'](_0x245878=>_0x245878[_0x3af823(0x1467)]);let _0x538c69=_0x1692d2();_0x538c69+=_0x3af823(0x1392)+_0x21bbcf[_0x3af823(0x121a)](',\x20')+_0x3af823(0x246);try{let _0x4edaca=_0x303d9f[_0x3af823(0x1336)](_0x3af823(0x708)),_0x3f050=[{'role':'user','content':_0x3af823(0x8c0)}],_0x2a0e6e=_0xe8c788(_0x6c0e30,_0x4f2049,_0x538c69,_0x3f050);const _0x1741c2=_0x4edaca?await fetch(_0x2a0e6e[_0x3af823(0x9a8)],_0x2a0e6e['data']):await fetch(_0x303d9f+_0x3af823(0x110e),{'method':_0x3af823(0xdca),'headers':{'Content-Type':_0x3af823(0x479),'Authorization':_0x3af823(0xb0e)+_0x4f2049},'body':JSON['stringify']({'model':_0x6c0e30,'messages':[{'role':_0x3af823(0x11af),'content':_0x538c69},..._0x3f050],'temperature':_0x16699d[_0x3af823(0xf9c)][_0x3af823(0x382)]||0.8})});if(!_0x1741c2['ok'])throw new Error((await _0x1741c2[_0x3af823(0x21d)]())['error']['message']);const _0x46197e=await _0x1741c2['json'](),_0x4dfad5=getGeminiResponseText(_0x46197e);let _0x578080=_0x4dfad5[_0x3af823(0x14e9)](/^```json\s*/,'')[_0x3af823(0x14e9)](/```$/,'')[_0x3af823(0x2a8)]();const _0x36fad4=_0x578080['indexOf']('['),_0x4699fb=_0x578080[_0x3af823(0x90f)](']');if(_0x36fad4===-0x1||_0x4699fb===-0x1||_0x4699fb<_0x36fad4)throw new Error(_0x3af823(0x545));const _0x48dac6=_0x578080['substring'](_0x36fad4,_0x4699fb+0x1);try{const _0x51e2a9=_0x48dac6[_0x3af823(0x9a3)](/(\[[\s\S]*?\])/g);if(_0x51e2a9&&_0x51e2a9[_0x3af823(0xaf9)]>0x0)return JSON[_0x3af823(0xde0)](_0x51e2a9[_0x51e2a9['length']-0x1]);return JSON['parse'](_0x48dac6);}catch(_0x4fec83){throw new Error(_0x3af823(0x13e3)+_0x4fec83['message']+'\x0a\x0aAI原始返回内容:\x0a'+_0x4dfad5);}}catch(_0x289cf5){console[_0x3af823(0xc3e)]('获取AI投票失败:',_0x289cf5);throw new Error(_0x3af823(0xd73)+_0x289cf5[_0x3af823(0x74b)]);}}function _0x120574(){const _0x3453e4=_0x3ce1fb,_0x378c87={},_0xaa4581={};for(const _0x363bbb in _0x1b881d['votes']){const _0x3f440f=_0x1b881d['votes'][_0x363bbb];_0x378c87[_0x3f440f]=(_0x378c87[_0x3f440f]||0x0)+0x1,!_0xaa4581[_0x3f440f]&&(_0xaa4581[_0x3f440f]=[]),_0xaa4581[_0x3f440f][_0x3453e4(0x1001)](_0x363bbb);}let _0x197bb5=0x0,_0x22e04b=[];for(const _0x17444a in _0x378c87){const _0x632bbe=_0x378c87[_0x17444a];if(_0x632bbe>_0x197bb5)_0x197bb5=_0x632bbe,_0x22e04b=[_0x17444a];else _0x632bbe===_0x197bb5&&_0x22e04b['push'](_0x17444a);}_0x3da570(_0x3453e4(0xab4));for(const _0x17ff86 in _0xaa4581){_0x3da570(_0x17ff86+'\x20('+_0xaa4581[_0x17ff86][_0x3453e4(0xaf9)]+_0x3453e4(0x389)+_0xaa4581[_0x17ff86][_0x3453e4(0x121a)]('、\x20'));}if(_0x22e04b['length']===0x1&&_0x197bb5>0x0){const _0xd2ef2f=_0x1b881d['players'][_0x3453e4(0x1402)](_0x5daac1=>_0x5daac1['name']===_0x22e04b[0x0]);if(_0xd2ef2f){_0xd2ef2f[_0x3453e4(0x28f)]=![],_0x3da570(_0xd2ef2f[_0x3453e4(0x1467)]+_0x3453e4(0x740));if(_0xd2ef2f['role']==='猎人'){}}}else _0x3da570(_0x3453e4(0x287));_0x5c7dac();if(_0x28893b())return;_0x1b881d['currentDay']++,_0x85aa33();}async function _0x502654(){const _0x5a0b73=_0x3ce1fb,{proxyUrl:_0x5d4411,apiKey:_0x494222,model:_0x46cf68}=_0x16699d[_0x5a0b73(0x79e)];if(!_0x5d4411||!_0x494222||!_0x46cf68)return null;const _0x52f5af=_0x1b881d[_0x5a0b73(0x1550)][_0x5a0b73(0x1c0)](_0x1c409a=>_0x1c409a[_0x5a0b73(0x1554)]==='狼人'&&_0x1c409a[_0x5a0b73(0x28f)]),_0x4a2a91=_0x1b881d['players'][_0x5a0b73(0x1c0)](_0x37a331=>_0x37a331[_0x5a0b73(0x28f)]&&_0x37a331[_0x5a0b73(0x1554)]!=='狼人'),_0x2251ed=_0x5a0b73(0x957)+_0x52f5af[_0x5a0b73(0x8ff)](_0x73cc09=>_0x73cc09[_0x5a0b73(0x1467)])[_0x5a0b73(0x121a)]('、\x20')+'\x0a-\x20**可以刀的玩家列表**:\x20'+_0x4a2a91[_0x5a0b73(0x8ff)](_0x1ec38f=>_0x1ec38f[_0x5a0b73(0x1467)])[_0x5a0b73(0x121a)]('、\x20')+_0x5a0b73(0x7fa)+_0x1b881d[_0x5a0b73(0xb4b)][_0x5a0b73(0x8ff)](_0x3701b4=>_0x3701b4[_0x5a0b73(0xf2b)]+':\x20'+_0x3701b4['content'])['join']('\x0a')+_0x5a0b73(0x13b2);try{let _0x3eec1f=_0x5d4411[_0x5a0b73(0x1336)](_0x5a0b73(0x708)),_0x172a68=[{'role':_0x5a0b73(0xaeb),'content':_0x5a0b73(0xf7b)}],_0x49395a=_0xe8c788(_0x46cf68,_0x494222,_0x2251ed,_0x172a68);const _0x56c620=_0x3eec1f?await fetch(_0x49395a[_0x5a0b73(0x9a8)],_0x49395a[_0x5a0b73(0x92a)]):await fetch(_0x5d4411+_0x5a0b73(0x110e),{'method':'POST','headers':{'Content-Type':_0x5a0b73(0x479),'Authorization':_0x5a0b73(0xb0e)+_0x494222},'body':JSON[_0x5a0b73(0x526)]({'model':_0x46cf68,'messages':[{'role':_0x5a0b73(0x11af),'content':_0x2251ed},..._0x172a68],'temperature':_0x16699d[_0x5a0b73(0xf9c)][_0x5a0b73(0x382)]||0.8})});if(!_0x56c620['ok'])throw new Error((await _0x56c620['json']())['error'][_0x5a0b73(0x74b)]);const _0x430b76=await _0x56c620[_0x5a0b73(0x21d)](),_0x20aa8=getGeminiResponseText(_0x430b76),_0x50b5cf=_0x20aa8[_0x5a0b73(0x9a3)](/({[\s\S]*})/);if(!_0x50b5cf)throw new Error(_0x5a0b73(0x3f9));const _0x3ddf2a=JSON[_0x5a0b73(0xde0)](_0x50b5cf[0x0]),_0x48eb3a=_0x1b881d[_0x5a0b73(0x1550)][_0x5a0b73(0x1402)](_0x4a7fff=>_0x4a7fff[_0x5a0b73(0x1467)]===_0x3ddf2a['target_name']);return _0x48eb3a?_0x48eb3a['id']:null;}catch(_0x4c0766){return console[_0x5a0b73(0xc3e)](_0x5a0b73(0x1180),_0x4c0766),_0x4a2a91[Math['floor'](Math[_0x5a0b73(0x59c)]()*_0x4a2a91[_0x5a0b73(0xaf9)])]['id'];}}function _0x36a157(_0x4bc0a9,_0x3ffab1){return new Promise(_0x843a95=>{const _0x52b365=_0x6c9e,_0xdcdc36=document[_0x52b365(0x948)](_0x52b365(0x7ed)),_0x177156=document[_0x52b365(0x948)](_0x52b365(0xe5c)),_0x37a961=document[_0x52b365(0x948)]('witch-modal-title'),_0x2a80e9=document[_0x52b365(0x948)](_0x52b365(0x1266)),_0x45ef93=document[_0x52b365(0x948)](_0x52b365(0x13b9));_0x177156[_0x52b365(0xb6f)]='';const _0x24cf18=_0x2a80e9[_0x52b365(0xfc0)](!![]);_0x2a80e9[_0x52b365(0x1579)]['replaceChild'](_0x24cf18,_0x2a80e9);const _0x52f518=_0x45ef93[_0x52b365(0xfc0)](!![]);_0x45ef93[_0x52b365(0x1579)]['replaceChild'](_0x52f518,_0x45ef93),_0x24cf18['style'][_0x52b365(0x11fd)]='block',_0x24cf18[_0x52b365(0x2c0)]=!![];let _0x452370={'save':![],'poison':null},_0x5427e4=null;if(_0x4bc0a9&&!_0x3ffab1[_0x52b365(0xd52)]){_0x37a961[_0x52b365(0x10cb)]=_0x52b365(0x1016)+_0x4bc0a9[_0x52b365(0x1467)]+_0x52b365(0xfd2);const _0x2dd648=document[_0x52b365(0x1497)]('button');_0x2dd648[_0x52b365(0x35b)]=_0x52b365(0xb51),_0x2dd648[_0x52b365(0x10cb)]=_0x52b365(0x14ed),_0x2dd648[_0x52b365(0xf74)][_0x52b365(0x14b1)]='20px',_0x2dd648['onclick']=()=>{const _0x2c4459=_0x52b365;_0x452370[_0x2c4459(0x5ba)]=!![],_0xdcdc36[_0x2c4459(0xd54)][_0x2c4459(0xf89)](_0x2c4459(0xfcb)),_0x843a95(_0x452370);},_0x177156[_0x52b365(0x6b6)](_0x2dd648);}else _0x4bc0a9?_0x37a961[_0x52b365(0x10cb)]='昨晚\x20'+_0x4bc0a9[_0x52b365(0x1467)]+_0x52b365(0xaf1):_0x37a961['textContent']='昨晚是平安夜';if(!_0x3ffab1[_0x52b365(0x1086)]){const _0x8c8d98=document[_0x52b365(0x1497)]('p');_0x8c8d98[_0x52b365(0x10cb)]='是否要使用毒药？',_0x8c8d98[_0x52b365(0xf74)][_0x52b365(0xd74)]='center',_0x8c8d98[_0x52b365(0xf74)][_0x52b365(0x119d)]='20px',_0x177156['appendChild'](_0x8c8d98);const _0x9e69e7=_0x1b881d[_0x52b365(0x1550)][_0x52b365(0x1c0)](_0x333ef4=>_0x333ef4[_0x52b365(0x28f)]&&_0x333ef4['id']!==_0x4bc0a9?.['id']);_0x9e69e7[_0x52b365(0x427)](_0x2264a6=>{const _0x2b9d49=_0x52b365,_0x2ef18b=document['createElement'](_0x2b9d49(0x379));_0x2ef18b[_0x2b9d49(0x35b)]=_0x2b9d49(0x3be),_0x2ef18b['dataset']['id']=_0x2264a6['id'],_0x2ef18b['innerHTML']='<img\x20src=\x22'+_0x2264a6[_0x2b9d49(0x63e)]+'\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>'+_0x2264a6[_0x2b9d49(0x1467)]+_0x2b9d49(0xffc),_0x2ef18b['onclick']=()=>{const _0x34c5e7=_0x2b9d49;_0x177156['querySelectorAll'](_0x34c5e7(0x50a))[_0x34c5e7(0x427)](_0x990587=>_0x990587['classList'][_0x34c5e7(0xf89)](_0x34c5e7(0xd56))),_0x2ef18b[_0x34c5e7(0xd54)][_0x34c5e7(0xbd0)](_0x34c5e7(0xd56)),_0x5427e4=_0x2264a6['id'],_0x24cf18[_0x34c5e7(0x2c0)]=![];},_0x177156[_0x2b9d49(0x6b6)](_0x2ef18b);});}_0x24cf18[_0x52b365(0xe8d)]=()=>{const _0x58372b=_0x52b365;_0x5427e4&&(_0x452370[_0x58372b(0x2e5)]=_0x5427e4,_0xdcdc36[_0x58372b(0xd54)][_0x58372b(0xf89)](_0x58372b(0xfcb)),_0x843a95(_0x452370));},_0x52f518[_0x52b365(0xe8d)]=()=>{const _0x474055=_0x52b365;_0xdcdc36[_0x474055(0xd54)]['remove']('visible'),_0x843a95(_0x452370);},_0xdcdc36[_0x52b365(0xd54)][_0x52b365(0xbd0)]('visible');});}async function _0x50283e(){const _0x11d02d=_0x3ce1fb,_0xba4412=_0x1b881d[_0x11d02d(0x129f)];if(!_0xba4412)return;document[_0x11d02d(0x948)](_0x11d02d(0x742))[_0x11d02d(0xf74)][_0x11d02d(0x11fd)]=_0x11d02d(0x12fe),await _0x104485(_0x11d02d(0x960),'正在重试\x22'+_0xba4412+_0x11d02d(0x11d2));switch(_0xba4412){case _0x11d02d(0x129d):await _0x85aa33();break;case _0x11d02d(0xb95):await _0x598628();break;case _0x11d02d(0xe47):await _0x145248();break;}}function _0x28893b(){const _0x2bb96a=_0x3ce1fb,_0x4b6088=_0x1b881d[_0x2bb96a(0x1550)]['filter'](_0x5bc891=>_0x5bc891[_0x2bb96a(0x28f)]),_0x3096d3=_0x4b6088[_0x2bb96a(0x1c0)](_0x25f8b3=>_0x25f8b3[_0x2bb96a(0x1554)]==='狼人'),_0x5c94a5=_0x4b6088[_0x2bb96a(0x1c0)](_0x27dcff=>[_0x2bb96a(0x123f),'女巫','猎人','守卫'][_0x2bb96a(0x1336)](_0x27dcff[_0x2bb96a(0x1554)])),_0x5b8f12=_0x4b6088[_0x2bb96a(0x1c0)](_0x3c05b1=>_0x3c05b1[_0x2bb96a(0x1554)]==='平民');let _0x211d2a=null;if(_0x3096d3[_0x2bb96a(0xaf9)]===0x0)_0x211d2a='好人';else{if(_0x3096d3[_0x2bb96a(0xaf9)]>=_0x5c94a5[_0x2bb96a(0xaf9)]+_0x5b8f12['length'])_0x211d2a='狼人';else _0x1b881d[_0x2bb96a(0x780)]===_0x2bb96a(0x134c)?(_0x5c94a5[_0x2bb96a(0xaf9)]===0x0||_0x5b8f12[_0x2bb96a(0xaf9)]===0x0)&&(_0x211d2a='狼人'):_0x5c94a5['length']===0x0&&_0x5b8f12[_0x2bb96a(0xaf9)]===0x0&&(_0x211d2a='狼人');}if(_0x211d2a)return _0x506f5c(_0x211d2a),!![];return![];}async function _0x5eb999(){const _0x35b583=_0x3ce1fb,_0x259ced=await _0xa6b74a('确认操作',_0x35b583(0xb11),{'confirmText':_0x35b583(0x94d)});if(!_0x259ced)return;await _0x104485('请稍候...','正在扫描和修复数据...');try{const _0xca34e3=await _0x6ed281['chats'][_0x35b583(0x443)]();let _0xc37d1=0x0;for(const _0x58510c of _0xca34e3){let _0x46bef2=![];!Array['isArray'](_0x58510c[_0x35b583(0xb07)])&&(_0x58510c[_0x35b583(0xb07)]=[],_0x46bef2=!![]),(typeof _0x58510c[_0x35b583(0x7fd)]!==_0x35b583(0xd43)||_0x58510c[_0x35b583(0x7fd)]===null)&&(_0x58510c[_0x35b583(0x7fd)]={},_0x46bef2=!![]),!_0x58510c[_0x35b583(0x1173)]&&!_0x58510c[_0x35b583(0x628)]&&(_0x58510c[_0x35b583(0x628)]=_0x58510c['name'],_0x46bef2=!![]),typeof _0x58510c['unreadCount']===_0x35b583(0x490)&&(_0x58510c['unreadCount']=0x0,_0x46bef2=!![]),!Array[_0x35b583(0x1524)](_0x58510c[_0x35b583(0x758)])&&(_0x58510c[_0x35b583(0x758)]=[],_0x46bef2=!![]),_0x46bef2&&(_0xc37d1++,console[_0x35b583(0x498)](_0x35b583(0xac0)+_0x58510c[_0x35b583(0x1467)]+_0x35b583(0xf5d)+_0x58510c['id']+_0x35b583(0x993)),await _0x6ed281['chats'][_0x35b583(0x90c)](_0x58510c)),_0x16699d[_0x35b583(0x1474)][_0x58510c['id']]=_0x58510c;}_0xc37d1>0x0?(await _0x104485(_0x35b583(0x27e),_0x35b583(0x211)+_0xc37d1+'\x20个角色的数据问题！\x0a\x0a聊天列表已为您刷新。'),await _0x2d33eb()):await _0x104485('检查完成',_0x35b583(0x9e9));}catch(_0x2d84d2){console[_0x35b583(0xc3e)](_0x35b583(0xedf),_0x2d84d2),await _0x104485(_0x35b583(0xb6c),_0x35b583(0x1ae)+_0x2d84d2[_0x35b583(0x74b)]);}}function _0x2176e3(_0x42ee7c,_0x3dee74=_0x3ce1fb(0x102e)){const _0x380b8f=_0x3ce1fb;if(_0x42ee7c[_0x380b8f(0xfeb)](_0x380b8f(0x1340)))return;const _0x52fed6=document[_0x380b8f(0x1497)](_0x380b8f(0x379));_0x52fed6['className']='loader-container',_0x52fed6['innerHTML']=_0x380b8f(0x1125),_0x3dee74==='bottom'?_0x42ee7c[_0x380b8f(0x6b6)](_0x52fed6):_0x42ee7c[_0x380b8f(0x10e0)](_0x52fed6);}function _0x3c826e(_0x3dd25c){const _0xe755da=_0x3ce1fb,_0x11442f=_0x3dd25c[_0xe755da(0xfeb)](_0xe755da(0x1340));_0x11442f&&_0x11442f[_0xe755da(0xf89)]();}async function _0x4b81cd(){const _0x55aa50=_0x3ce1fb,_0x403587=document['getElementById']('delete-world-books-modal'),_0x879db5=document[_0x55aa50(0x948)](_0x55aa50(0x11dd)),_0x177e03=document[_0x55aa50(0x948)](_0x55aa50(0xf9e));_0x879db5[_0x55aa50(0xb6f)]='',_0x177e03[_0x55aa50(0x210)]=![];const _0x2d7fd8=await _0x6ed281[_0x55aa50(0x44c)]['toArray']();_0x2d7fd8[_0x55aa50(0xaf9)]===0x0?_0x879db5[_0x55aa50(0xb6f)]=_0x55aa50(0xc62):_0x2d7fd8[_0x55aa50(0x427)](_0x2bc1e9=>{const _0x25c66b=_0x55aa50,_0x25e95d=document[_0x25c66b(0x1497)](_0x25c66b(0x379));_0x25e95d[_0x25c66b(0x35b)]=_0x25c66b(0x8f4),_0x25e95d[_0x25c66b(0x606)][_0x25c66b(0x1288)]=_0x2bc1e9['id'],_0x25e95d[_0x25c66b(0xb6f)]=_0x25c66b(0x667)+_0x2bc1e9['name']+_0x25c66b(0x395),_0x879db5[_0x25c66b(0x6b6)](_0x25e95d);}),_0x403587[_0x55aa50(0xd54)][_0x55aa50(0xbd0)](_0x55aa50(0xfcb));}async function _0x16a3e3(){const _0x55dd00=_0x3ce1fb,_0x5abaf8=document[_0x55dd00(0x1188)](_0x55dd00(0xa02));if(_0x5abaf8[_0x55dd00(0xaf9)]===0x0){alert(_0x55dd00(0x4a5));return;}const _0xbdfd2e=Array['from'](_0x5abaf8)[_0x55dd00(0x8ff)](_0x39d417=>_0x39d417[_0x55dd00(0x606)][_0x55dd00(0x1288)]),_0x52b511=await _0xa6b74a('最后确认！',_0x55dd00(0xd1c)+_0x5abaf8[_0x55dd00(0xaf9)]+'\x20本世界书，并解除它们与所有角色的关联。此操作【不可恢复】！',{'confirmButtonClass':'btn-danger','confirmText':'确认删除'});if(!_0x52b511)return;await _0x104485('请稍候...',_0x55dd00(0x1201));try{await _0x6ed281['transaction']('rw',_0x6ed281['worldBooks'],_0x6ed281['chats'],async()=>{const _0x52bf50=_0x55dd00;await _0x6ed281[_0x52bf50(0x44c)]['bulkDelete'](_0xbdfd2e);const _0x1290d3=await _0x6ed281[_0x52bf50(0x1474)]['toArray']();for(const _0x50a546 of _0x1290d3){if(_0x50a546[_0x52bf50(0x7fd)]&&Array[_0x52bf50(0x1524)](_0x50a546['settings'][_0x52bf50(0xeee)])){const _0x12e77c=_0x50a546[_0x52bf50(0x7fd)][_0x52bf50(0xeee)][_0x52bf50(0xaf9)];_0x50a546['settings'][_0x52bf50(0xeee)]=_0x50a546[_0x52bf50(0x7fd)][_0x52bf50(0xeee)]['filter'](_0x40b468=>!_0xbdfd2e[_0x52bf50(0x1336)](_0x40b468)),_0x50a546[_0x52bf50(0x7fd)][_0x52bf50(0xeee)][_0x52bf50(0xaf9)]<_0x12e77c&&await _0x6ed281[_0x52bf50(0x1474)][_0x52bf50(0x90c)](_0x50a546);}}}),_0x16699d[_0x55dd00(0x44c)]=_0x16699d[_0x55dd00(0x44c)][_0x55dd00(0x1c0)](_0x4c5915=>!_0xbdfd2e[_0x55dd00(0x1336)](_0x4c5915['id'])),document['getElementById']('delete-world-books-modal')['classList']['remove'](_0x55dd00(0xfcb)),await _0x104485(_0x55dd00(0x111a),_0x5abaf8[_0x55dd00(0xaf9)]+'\x20本世界书已成功删除。');}catch(_0x59657f){console[_0x55dd00(0xc3e)](_0x55dd00(0x6f6),_0x59657f),await _0x104485(_0x55dd00(0xd55),'操作失败:\x20'+_0x59657f['message']);}}function _0x348f3c(){const _0x3e0bfb=_0x3ce1fb;if(!_0x16699d[_0x3e0bfb(0xf5a)])return;const _0xd633c=_0x16699d[_0x3e0bfb(0xf5a)],_0x188c48=document[_0x3e0bfb(0x948)](_0x3e0bfb(0xe19)),_0x107440=document[_0x3e0bfb(0x948)](_0x3e0bfb(0x5bf)),_0x20ab4e=document['getElementById'](_0x3e0bfb(0x12cb));let _0x3b15a2=_0xcb0ccc[_0xd633c];if(_0x3b15a2&&_0x3b15a2[_0x3e0bfb(0x1032)]){_0x3b15a2['isMinimized']&&_0x6e80a5();_0x188c48[_0x3e0bfb(0xf74)][_0x3e0bfb(0x11fd)]=_0x3e0bfb(0x6a4);return;}_0x88f690(_0xd633c),_0x33cb2f(_0xd633c),_0x188c48[_0x3e0bfb(0xf74)][_0x3e0bfb(0x11fd)]=_0x3e0bfb(0x6a4),_0x107440[_0x3e0bfb(0xd54)][_0x3e0bfb(0xf89)]('minimized'),_0x20ab4e[_0x3e0bfb(0xf74)]['display']=_0x3e0bfb(0x12fe);const _0x13aead=document[_0x3e0bfb(0x948)](_0x3e0bfb(0xecd)),_0xdd0ad1=_0x107440['getBoundingClientRect'](),_0x3cafeb=(_0x13aead[_0x3e0bfb(0xcdc)]-_0xdd0ad1[_0x3e0bfb(0xf38)])/0x2,_0x146f20=(_0x13aead[_0x3e0bfb(0xa00)]-_0xdd0ad1[_0x3e0bfb(0x977)])/0x2;_0x107440['style'][_0x3e0bfb(0x102e)]=_0x3cafeb+'px',_0x107440['style'][_0x3e0bfb(0x102f)]=_0x146f20+'px',_0x107440[_0x3e0bfb(0xf74)]['transform']='';}function _0x88f690(_0x52d943){const _0x5cc872=_0x3ce1fb;_0xcb0ccc[_0x52d943]={'isActive':!![],'isMinimized':![],'title':_0x5cc872(0xca2),'contentLines':[],'currentPage':0x0,'totalPages':0x0,'linesPerPage':0xf,'currentSnippet':''};}function _0xedd965(){const _0x20c70e=_0x3ce1fb,_0x353a0c=_0x16699d[_0x20c70e(0xf5a)];if(!_0x353a0c||!_0xcb0ccc[_0x353a0c]||!_0xcb0ccc[_0x353a0c]['isActive'])return;document[_0x20c70e(0x948)](_0x20c70e(0xe19))[_0x20c70e(0xf74)][_0x20c70e(0x11fd)]=_0x20c70e(0x12fe),document[_0x20c70e(0x948)](_0x20c70e(0x12cb))['style'][_0x20c70e(0x11fd)]=_0x20c70e(0x12fe),document['getElementById'](_0x20c70e(0x5bf))[_0x20c70e(0xd54)]['remove']('minimized'),_0xcb0ccc[_0x353a0c][_0x20c70e(0x1032)]=![],console[_0x20c70e(0x498)]('读书会话已关闭。');}function _0x3f05c6(){const _0x1c10c3=_0x3ce1fb,_0x537e02=_0xcb0ccc[_0x16699d['activeChatId']];if(!_0x537e02||!_0x537e02[_0x1c10c3(0x1032)]||_0x537e02[_0x1c10c3(0x127d)])return;_0x537e02[_0x1c10c3(0x127d)]=!![],document[_0x1c10c3(0x948)](_0x1c10c3(0x5bf))[_0x1c10c3(0xd54)][_0x1c10c3(0xbd0)]('minimized'),document[_0x1c10c3(0x948)](_0x1c10c3(0x12cb))[_0x1c10c3(0xf74)]['display']=_0x1c10c3(0x6a4);}function _0x6e80a5(){const _0x290709=_0x3ce1fb,_0x4f120b=_0xcb0ccc[_0x16699d[_0x290709(0xf5a)]];if(!_0x4f120b||!_0x4f120b[_0x290709(0x1032)]||!_0x4f120b[_0x290709(0x127d)])return;_0x4f120b[_0x290709(0x127d)]=![],document[_0x290709(0x948)](_0x290709(0x12cb))[_0x290709(0xf74)][_0x290709(0x11fd)]='none',document[_0x290709(0x948)](_0x290709(0x5bf))[_0x290709(0xd54)][_0x290709(0xf89)](_0x290709(0x12ce));}function _0x1b9209(_0x1bac1e,_0x5d963d){const _0x1d1dab=_0x3ce1fb;let _0x54a018=0x0,_0x18c49f=0x0,_0x133168=0x0,_0x300268=0x0;const _0x54ee74=document[_0x1d1dab(0x948)](_0x1d1dab(0xecd)),_0x37ad68=_0x18303b=>{const _0x461779=_0x1d1dab;if(_0x18303b[_0x461779(0xa50)][_0x461779(0x1090)](_0x461779(0x4e6)))return;if(_0x1bac1e['style'][_0x461779(0x79c)]){const _0x4297db=_0x1bac1e[_0x461779(0xde6)](),_0x3e5d95=_0x1bac1e[_0x461779(0x220)]['getBoundingClientRect']();_0x1bac1e[_0x461779(0xf74)]['top']=_0x4297db[_0x461779(0x102e)]-_0x3e5d95[_0x461779(0x102e)]+'px',_0x1bac1e[_0x461779(0xf74)]['left']=_0x4297db[_0x461779(0x102f)]-_0x3e5d95[_0x461779(0x102f)]+'px',_0x1bac1e[_0x461779(0xf74)][_0x461779(0x79c)]='';}_0x18303b['preventDefault']();const _0x27b13e=_0x18303b[_0x461779(0x4ae)]===_0x461779(0xea1)?_0x18303b[_0x461779(0x63b)][0x0]:_0x18303b;_0x133168=_0x27b13e[_0x461779(0x63d)],_0x300268=_0x27b13e['clientY'],document[_0x461779(0x339)](_0x461779(0x637),_0x89e476),document[_0x461779(0x339)](_0x461779(0x10a3),_0x1fdffd),document[_0x461779(0x339)](_0x461779(0xe38),_0x89e476),document[_0x461779(0x339)](_0x461779(0x242),_0x1fdffd);},_0x1fdffd=_0x3f5674=>{const _0x53ca57=_0x1d1dab,_0x290503=_0x3f5674['type']==='touchmove'?_0x3f5674[_0x53ca57(0x63b)][0x0]:_0x3f5674;_0x54a018=_0x133168-_0x290503[_0x53ca57(0x63d)],_0x18c49f=_0x300268-_0x290503['clientY'],_0x133168=_0x290503[_0x53ca57(0x63d)],_0x300268=_0x290503[_0x53ca57(0x14fb)];let _0x86c8f1=_0x1bac1e['offsetTop']-_0x18c49f,_0x21c4c0=_0x1bac1e[_0x53ca57(0xc2e)]-_0x54a018;const _0x383491=_0x54ee74[_0x53ca57(0xcdc)]-_0x1bac1e[_0x53ca57(0xa5e)]-0xa,_0x87f4cc=_0x54ee74[_0x53ca57(0xa00)]-_0x1bac1e['offsetWidth']-0xa;_0x86c8f1=Math[_0x53ca57(0x604)](0xa,Math['min'](_0x86c8f1,_0x383491)),_0x21c4c0=Math[_0x53ca57(0x604)](0xa,Math[_0x53ca57(0xb63)](_0x21c4c0,_0x87f4cc)),_0x1bac1e[_0x53ca57(0xf74)]['top']=_0x86c8f1+'px',_0x1bac1e[_0x53ca57(0xf74)][_0x53ca57(0x102f)]=_0x21c4c0+'px';},_0x89e476=()=>{const _0x53a7d6=_0x1d1dab;document['removeEventListener'](_0x53a7d6(0x637),_0x89e476),document[_0x53a7d6(0x1558)](_0x53a7d6(0x10a3),_0x1fdffd),document[_0x53a7d6(0x1558)](_0x53a7d6(0xe38),_0x89e476),document[_0x53a7d6(0x1558)](_0x53a7d6(0x242),_0x1fdffd);};_0x5d963d[_0x1d1dab(0x339)](_0x1d1dab(0xf08),_0x37ad68),_0x5d963d[_0x1d1dab(0x339)]('touchstart',_0x37ad68);}function _0x33cb2f(_0x28e0b2){const _0x2fc395=_0x3ce1fb,_0x4a4779=_0xcb0ccc[_0x28e0b2];if(!_0x4a4779)return;const _0x25f467=document['getElementById'](_0x2fc395(0x11e4)),_0x4cda8d=document['getElementById'](_0x2fc395(0x1565)),_0x55612a=document[_0x2fc395(0x948)](_0x2fc395(0x3a4)),_0x2b734c=document[_0x2fc395(0x948)](_0x2fc395(0x467)),_0x39f875=document[_0x2fc395(0x948)](_0x2fc395(0x422));_0x25f467[_0x2fc395(0x10cb)]=_0x4a4779[_0x2fc395(0xb03)];if(_0x4a4779[_0x2fc395(0xd1f)]['length']===0x0)_0x4cda8d[_0x2fc395(0xb6f)]=_0x2fc395(0xe0c),_0x4a4779[_0x2fc395(0x4ba)]=0x0,_0x4a4779[_0x2fc395(0xa2e)]=0x0;else{const _0x1674e1=_0x4a4779[_0x2fc395(0xa2e)]*_0x4a4779['linesPerPage'],_0x143edc=_0x1674e1+_0x4a4779['linesPerPage'];_0x4cda8d[_0x2fc395(0x10cb)]=_0x4a4779['contentLines'][_0x2fc395(0x200)](_0x1674e1,_0x143edc)[_0x2fc395(0x121a)]('\x0a');}_0x55612a['textContent']=_0x4a4779[_0x2fc395(0xa2e)]+0x1+_0x2fc395(0x9d5)+_0x4a4779[_0x2fc395(0x4ba)],_0x2b734c[_0x2fc395(0x2c0)]=_0x4a4779[_0x2fc395(0xa2e)]===0x0,_0x39f875[_0x2fc395(0x2c0)]=_0x4a4779[_0x2fc395(0xa2e)]>=_0x4a4779['totalPages']-0x1;}function _0x2dd96b(){const _0x34f7b3=_0x3ce1fb,_0x45224c=_0xcb0ccc[_0x16699d[_0x34f7b3(0xf5a)]];_0x45224c&&_0x45224c[_0x34f7b3(0xa2e)]<_0x45224c[_0x34f7b3(0x4ba)]-0x1&&(_0x45224c[_0x34f7b3(0xa2e)]++,_0x33cb2f(_0x16699d[_0x34f7b3(0xf5a)]),document[_0x34f7b3(0x948)]('reading-content')['scrollTop']=0x0,_0x1a3757(_0x45224c['activeBookId'],_0x45224c['currentPage']));}async function _0x3d0a8a(){const _0x5738d3=_0x3ce1fb,_0x1fa807=_0xcb0ccc[_0x16699d[_0x5738d3(0xf5a)]];_0x1fa807&&_0x1fa807['currentPage']>0x0&&(_0x1fa807[_0x5738d3(0xa2e)]--,_0x33cb2f(_0x16699d[_0x5738d3(0xf5a)]),document[_0x5738d3(0x948)](_0x5738d3(0x1565))[_0x5738d3(0xced)]=0x0,await _0x1a3757(_0x1fa807[_0x5738d3(0xd0b)],_0x1fa807['currentPage']),await notifyAiOfPageTurn(_0x16699d[_0x5738d3(0xf5a)],_0x1fa807));}function _0x3e882a(){const _0xc76d25=_0x3ce1fb;document[_0xc76d25(0x948)](_0xc76d25(0x1f8))[_0xc76d25(0x4f6)]();}async function _0x3e0eba(_0xff89b9){const _0x5dc42d=_0x3ce1fb,_0xcec006=new Uint8Array(_0xff89b9);if(_0xcec006[_0x5dc42d(0xaf9)]>=0x3&&_0xcec006[0x0]===0xef&&_0xcec006[0x1]===0xbb&&_0xcec006[0x2]===0xbf)return console['log']('检测到\x20UTF-8\x20BOM，使用\x20UTF-8\x20解码。'),new TextDecoder(_0x5dc42d(0x985))[_0x5dc42d(0x53a)](_0xcec006);if(_0xcec006[_0x5dc42d(0xaf9)]>=0x2&&_0xcec006[0x0]===0xff&&_0xcec006[0x1]===0xfe)return console[_0x5dc42d(0x498)]('检测到\x20UTF-16\x20LE\x20BOM，使用\x20UTF-16\x20LE\x20解码。'),new TextDecoder('utf-16le')[_0x5dc42d(0x53a)](_0xcec006);if(_0xcec006['length']>=0x2&&_0xcec006[0x0]===0xfe&&_0xcec006[0x1]===0xff)return console[_0x5dc42d(0x498)](_0x5dc42d(0xbbc)),new TextDecoder(_0x5dc42d(0x686))[_0x5dc42d(0x53a)](_0xcec006);try{console['log'](_0x5dc42d(0x14af));const _0x28e037=new TextDecoder('utf-8',{'fatal':!![]})['decode'](_0xcec006);return console[_0x5dc42d(0x498)]('UTF-8\x20解码成功。'),_0x28e037;}catch(_0x12d72d){console[_0x5dc42d(0x498)](_0x5dc42d(0x8e0));try{const _0x401fae=new TextDecoder(_0x5dc42d(0x36b))[_0x5dc42d(0x53a)](_0xcec006);return console[_0x5dc42d(0x498)](_0x5dc42d(0x51f)),_0x401fae;}catch(_0x3aa022){console[_0x5dc42d(0xc3e)]('所有解码尝试均失败:',_0x3aa022);throw new Error(_0x5dc42d(0x46c));}}}async function _0x55c727(_0x505a80){const _0x59fb6c=_0x3ce1fb,_0x4dea04=_0x505a80['target'][_0x59fb6c(0x10b0)][0x0];if(!_0x4dea04)return;try{const _0x49c0f6=await _0x4dea04[_0x59fb6c(0x767)](),_0x536285=await _0x3e0eba(_0x49c0f6),_0x5a9e42=_0x4dea04[_0x59fb6c(0x1467)][_0x59fb6c(0x14e9)](/\.txt$/i,''),_0x116ed3=await _0x6ed281[_0x59fb6c(0xb7d)][_0x59fb6c(0xbd0)]({'title':_0x5a9e42,'content':_0x536285,'lastOpened':Date[_0x59fb6c(0x1386)]()});await _0x49b961(_0x116ed3),document[_0x59fb6c(0x948)]('reading-library-modal')[_0x59fb6c(0xd54)][_0x59fb6c(0x7a0)](_0x59fb6c(0xfcb))&&_0x437121();}catch(_0x1063f1){console['error']('导入书籍失败:',_0x1063f1),await _0x104485(_0x59fb6c(0xd89),_0x1063f1[_0x59fb6c(0x74b)]);}finally{_0x505a80[_0x59fb6c(0xa50)][_0x59fb6c(0x5bc)]=null;}}async function _0xb06b02(){const _0x5cece0=_0x3ce1fb,_0x3726b8=_0x16699d[_0x5cece0(0xf5a)];if(!_0x3726b8)return;const _0x10649f=_0xcb0ccc[_0x3726b8];if(!_0x10649f||_0x10649f[_0x5cece0(0x4ba)]<=0x1)return;const _0x7986eb=await _0x41b9fc(_0x5cece0(0x1fa),_0x5cece0(0x719)+_0x10649f[_0x5cece0(0x4ba)]+')',_0x10649f[_0x5cece0(0xa2e)]+0x1);if(_0x7986eb===null)return;const _0x4fdcd7=parseInt(_0x7986eb);if(isNaN(_0x4fdcd7)||_0x4fdcd7<0x1||_0x4fdcd7>_0x10649f[_0x5cece0(0x4ba)]){alert('请输入一个有效的页码！');return;}_0x10649f[_0x5cece0(0xa2e)]=_0x4fdcd7-0x1,_0x33cb2f(_0x3726b8),_0x1a3757(_0x10649f[_0x5cece0(0xd0b)],_0x10649f[_0x5cece0(0xa2e)]);}async function _0x1a3757(_0x35df4c,_0x23b5f1){const _0x1d48dc=_0x3ce1fb;if(!_0x35df4c)return;try{await _0x6ed281['readingLibrary'][_0x1d48dc(0xa0b)](_0x35df4c,{'currentPage':_0x23b5f1});}catch(_0x23429e){console['error'](_0x1d48dc(0xdbb)+_0x35df4c+_0x1d48dc(0x470),_0x23429e);}}async function _0x2dd96b(){const _0x1de554=_0x3ce1fb,_0x2a1f69=_0xcb0ccc[_0x16699d[_0x1de554(0xf5a)]];_0x2a1f69&&_0x2a1f69[_0x1de554(0xa2e)]<_0x2a1f69['totalPages']-0x1&&(_0x2a1f69[_0x1de554(0xa2e)]++,_0x33cb2f(_0x16699d[_0x1de554(0xf5a)]),document[_0x1de554(0x948)](_0x1de554(0x1565))['scrollTop']=0x0,await _0x1a3757(_0x2a1f69['activeBookId'],_0x2a1f69[_0x1de554(0xa2e)]),await notifyAiOfPageTurn(_0x16699d[_0x1de554(0xf5a)],_0x2a1f69));}function _0x5d47b5(_0x454e49,_0x162a2e){const _0x5c338b=_0x3ce1fb,_0x191be4=_0x16699d[_0x5c338b(0xf5a)];if(!_0x191be4)return;const _0x5a32df=_0xcb0ccc[_0x191be4];_0x5a32df['title']=_0x454e49[_0x5c338b(0x14e9)](/\.txt$/i,''),_0x5a32df['contentLines']=_0x162a2e[_0x5c338b(0x46f)](/\r\n?|\n/)[_0x5c338b(0x8ff)](_0x2fc255=>_0x2fc255[_0x5c338b(0x14e9)](/ +/g,'\x20')),_0x5a32df[_0x5c338b(0x4ba)]=Math[_0x5c338b(0x1112)](_0x5a32df[_0x5c338b(0xd1f)]['length']/_0x5a32df[_0x5c338b(0x106f)]),_0x5a32df['currentPage']=0x0,_0x33cb2f(_0x191be4);}async function _0x12adf4(){const _0x110ccd=_0x3ce1fb;document['getElementById']('reading-library-search-input')['value']='',await _0x437121(),document[_0x110ccd(0x948)]('reading-library-modal')[_0x110ccd(0xd54)][_0x110ccd(0xbd0)](_0x110ccd(0xfcb));}async function _0x437121(_0x3544e3=''){const _0x897472=_0x3ce1fb,_0x4c5363=document[_0x897472(0x948)](_0x897472(0xeb0));let _0x7ea932=await _0x6ed281['readingLibrary']['orderBy']('lastOpened')[_0x897472(0xb26)]()[_0x897472(0x443)]();_0x4c5363['innerHTML']='';_0x3544e3&&(_0x7ea932=_0x7ea932[_0x897472(0x1c0)](_0x41cc5f=>_0x41cc5f[_0x897472(0xb03)][_0x897472(0x1331)]()[_0x897472(0x1336)](_0x3544e3['toLowerCase']())));if(_0x7ea932[_0x897472(0xaf9)]===0x0){const _0x4929b8=_0x3544e3?_0x897472(0x77a):_0x897472(0x12b2);_0x4c5363[_0x897472(0xb6f)]=_0x897472(0xa1c)+_0x4929b8+'</p>';return;}_0x7ea932[_0x897472(0x427)](_0x206c22=>{const _0x37aa67=_0x897472,_0x56f8ed=document[_0x37aa67(0x1497)](_0x37aa67(0x379));_0x56f8ed[_0x37aa67(0x35b)]=_0x37aa67(0x1271),_0x56f8ed['innerHTML']=_0x37aa67(0xf91)+_0x206c22['id']+'\x22>'+_0x206c22[_0x37aa67(0xb03)]+_0x37aa67(0x102a)+_0x206c22['id']+_0x37aa67(0xfab),_0x4c5363['appendChild'](_0x56f8ed);});}async function _0x49b961(_0x543e58){const _0xaac065=_0x3ce1fb,_0x5a5670=_0x16699d[_0xaac065(0xf5a)];if(!_0x5a5670)return;const _0x405bbc=await _0x6ed281[_0xaac065(0xb7d)][_0xaac065(0xe8c)](_0x543e58);if(!_0x405bbc){alert(_0xaac065(0x108b));return;}await _0x6ed281[_0xaac065(0xb7d)][_0xaac065(0xa0b)](_0x543e58,{'lastOpened':Date[_0xaac065(0x1386)]()});const _0x3b4080=_0xcb0ccc[_0x5a5670];_0x3b4080[_0xaac065(0xd0b)]=_0x543e58,_0x3b4080['title']=_0x405bbc[_0xaac065(0xb03)],_0x3b4080['contentLines']=_0x405bbc['content'][_0xaac065(0x46f)](/\r\n?|\n/)[_0xaac065(0x8ff)](_0x1fd6aa=>_0x1fd6aa[_0xaac065(0x14e9)](/ +/g,'\x20')),_0x3b4080['totalPages']=Math[_0xaac065(0x1112)](_0x3b4080[_0xaac065(0xd1f)][_0xaac065(0xaf9)]/_0x3b4080['linesPerPage']),_0x3b4080['currentPage']=_0x405bbc[_0xaac065(0xa2e)]||0x0,_0x33cb2f(_0x5a5670),document[_0xaac065(0x948)]('reading-content')[_0xaac065(0xced)]=0x0,document[_0xaac065(0x948)](_0xaac065(0xc55))['classList'][_0xaac065(0xf89)](_0xaac065(0xfcb));}async function _0x20d75a(_0x3e68c9){const _0x227cc1=_0x3ce1fb,_0x39d8ad=await _0x6ed281[_0x227cc1(0xb7d)][_0x227cc1(0xe8c)](_0x3e68c9);if(!_0x39d8ad)return;const _0x597785=await _0xa6b74a('删除书籍',_0x227cc1(0x1595)+_0x39d8ad['title']+_0x227cc1(0xbda),{'confirmButtonClass':_0x227cc1(0x5e8)});_0x597785&&(await _0x6ed281[_0x227cc1(0xb7d)]['delete'](_0x3e68c9),await _0x437121());}function _0x5d47b5(_0x22ceaa,_0x29cd54){const _0x4503c9=_0x3ce1fb,_0x1b30f2=_0x16699d[_0x4503c9(0xf5a)];if(!_0x1b30f2)return;const _0x35c30f=_0xcb0ccc[_0x1b30f2];_0x35c30f[_0x4503c9(0xb03)]=_0x22ceaa[_0x4503c9(0x14e9)](/\.txt$/i,''),_0x35c30f['contentLines']=_0x29cd54['split'](/\r\n?|\n/),_0x35c30f['totalPages']=Math[_0x4503c9(0x1112)](_0x35c30f[_0x4503c9(0xd1f)][_0x4503c9(0xaf9)]/_0x35c30f['linesPerPage']),_0x35c30f['currentPage']=0x0,_0x33cb2f(_0x1b30f2);}function _0x1b9209(_0x2a1528,_0x4b6a87){const _0x299a4c=_0x3ce1fb;let _0x4e4f20=0x0,_0x166f77=0x0,_0x475ef4=0x0,_0x2b3832=0x0,_0x3b867d=![],_0x4d72f6=![];const _0x16013e=document[_0x299a4c(0x948)](_0x299a4c(0xecd)),_0x52a4b0=_0x533ce0=>{const _0x7cce8f=_0x299a4c;if(_0x2a1528!==_0x4b6a87&&_0x533ce0['target'][_0x7cce8f(0x1090)](_0x7cce8f(0x4e6)))return;_0x3b867d=!![],_0x4d72f6=![];const _0x445865=_0x533ce0[_0x7cce8f(0x4ae)]===_0x7cce8f(0xea1)?_0x533ce0[_0x7cce8f(0x63b)][0x0]:_0x533ce0;_0x475ef4=_0x445865[_0x7cce8f(0x63d)],_0x2b3832=_0x445865['clientY'],_0x2a1528[_0x7cce8f(0xf74)][_0x7cce8f(0x102e)]=_0x2a1528[_0x7cce8f(0x255)]+'px',_0x2a1528[_0x7cce8f(0xf74)][_0x7cce8f(0x102f)]=_0x2a1528[_0x7cce8f(0xc2e)]+'px',_0x2a1528[_0x7cce8f(0xf74)][_0x7cce8f(0x79c)]='',document['addEventListener'](_0x7cce8f(0x637),_0x4cc899),document[_0x7cce8f(0x339)]('mousemove',_0xed7111),document[_0x7cce8f(0x339)](_0x7cce8f(0xe38),_0x4cc899),document['addEventListener'](_0x7cce8f(0x242),_0xed7111,{'passive':![]});},_0xed7111=_0x117d31=>{const _0x435098=_0x299a4c;if(!_0x3b867d)return;const _0x1a9023=_0x117d31[_0x435098(0x4ae)]==='touchmove'?_0x117d31['touches'][0x0]:_0x117d31,_0x346fb0=_0x1a9023[_0x435098(0x63d)]-_0x475ef4,_0x198fb6=_0x1a9023[_0x435098(0x14fb)]-_0x2b3832;!_0x4d72f6&&(Math['abs'](_0x346fb0)>0x5||Math[_0x435098(0x7d6)](_0x198fb6)>0x5)&&(_0x4d72f6=!![]);_0x4d72f6&&_0x117d31[_0x435098(0x143a)]&&_0x117d31[_0x435098(0x38f)]();_0x4e4f20=_0x475ef4-_0x1a9023[_0x435098(0x63d)],_0x166f77=_0x2b3832-_0x1a9023[_0x435098(0x14fb)],_0x475ef4=_0x1a9023[_0x435098(0x63d)],_0x2b3832=_0x1a9023[_0x435098(0x14fb)];let _0xadac52=_0x2a1528[_0x435098(0x255)]-_0x166f77,_0x4a7654=_0x2a1528['offsetLeft']-_0x4e4f20;const _0xbca5b2=_0x16013e[_0x435098(0xcdc)]-_0x2a1528[_0x435098(0xa5e)]-0xa,_0x2941f1=_0x16013e[_0x435098(0xa00)]-_0x2a1528[_0x435098(0x5f7)]-0xa;_0xadac52=Math[_0x435098(0x604)](0xa,Math[_0x435098(0xb63)](_0xadac52,_0xbca5b2)),_0x4a7654=Math[_0x435098(0x604)](0xa,Math[_0x435098(0xb63)](_0x4a7654,_0x2941f1)),_0x2a1528[_0x435098(0xf74)][_0x435098(0x102e)]=_0xadac52+'px',_0x2a1528[_0x435098(0xf74)]['left']=_0x4a7654+'px';},_0x4cc899=()=>{const _0x6b8740=_0x299a4c;document['removeEventListener'](_0x6b8740(0x637),_0x4cc899),document[_0x6b8740(0x1558)](_0x6b8740(0x10a3),_0xed7111),document['removeEventListener'](_0x6b8740(0xe38),_0x4cc899),document[_0x6b8740(0x1558)](_0x6b8740(0x242),_0xed7111);if(!_0x3b867d)return;_0x3b867d=![],!_0x4d72f6&&_0x2a1528[_0x6b8740(0x4f6)]();};_0x4b6a87[_0x299a4c(0x339)](_0x299a4c(0xf08),_0x52a4b0),_0x4b6a87[_0x299a4c(0x339)](_0x299a4c(0xea1),_0x52a4b0,{'passive':![]});}function _0x3f05c6(){const _0x2c31a9=_0x3ce1fb,_0x130315=_0xcb0ccc[_0x16699d['activeChatId']];if(!_0x130315||!_0x130315[_0x2c31a9(0x1032)])return;document['getElementById'](_0x2c31a9(0x5bf))[_0x2c31a9(0xd54)]['add'](_0x2c31a9(0x12ce)),document[_0x2c31a9(0x948)](_0x2c31a9(0x12cb))['style'][_0x2c31a9(0x11fd)]=_0x2c31a9(0x6a4),_0x130315[_0x2c31a9(0x127d)]=!![];}function _0x6e80a5(){const _0x4bc8ad=_0x3ce1fb,_0x57f9fd=_0xcb0ccc[_0x16699d[_0x4bc8ad(0xf5a)]];if(!_0x57f9fd||!_0x57f9fd['isActive'])return;document[_0x4bc8ad(0x948)](_0x4bc8ad(0x12cb))[_0x4bc8ad(0xf74)][_0x4bc8ad(0x11fd)]=_0x4bc8ad(0x12fe),document[_0x4bc8ad(0x948)](_0x4bc8ad(0x5bf))[_0x4bc8ad(0xd54)][_0x4bc8ad(0xf89)](_0x4bc8ad(0x12ce)),_0x57f9fd[_0x4bc8ad(0x127d)]=![];}function _0x34e9ed(_0x2b08fa,_0xbfe9e1){let _0x35d54a;return function(..._0xe7dad5){const _0x198e2a=_0x6c9e,_0x5381c4=this;clearTimeout(_0x35d54a),_0x35d54a=setTimeout(()=>_0x2b08fa[_0x198e2a(0x1ba)](_0x5381c4,_0xe7dad5),_0xbfe9e1);};}function _0x2e30c6(_0x5ce8dd){const _0xf974a0=_0x3ce1fb,_0x1802d5=_0xcb0ccc[_0x5ce8dd];if(!_0x1802d5||!_0x1802d5[_0xf974a0(0x1032)])return'';const _0x49e3b3=_0x1802d5['title']||_0xf974a0(0x681);let _0x4463d9='',_0x2f6855='';if(_0x1802d5[_0xf974a0(0xc27)]&&_0x1802d5[_0xf974a0(0xc27)][_0xf974a0(0x2a8)]())_0x4463d9=_0x1802d5[_0xf974a0(0xc27)],_0x2f6855=_0xf974a0(0x309);else{if(_0x1802d5[_0xf974a0(0xd1f)][_0xf974a0(0xaf9)]>0x0){const _0x590295=_0x1802d5[_0xf974a0(0xa2e)]*_0x1802d5[_0xf974a0(0x106f)],_0x4d441e=_0x590295+_0x1802d5[_0xf974a0(0x106f)];_0x4463d9=_0x1802d5[_0xf974a0(0xd1f)][_0xf974a0(0x200)](_0x590295,_0x4d441e)[_0xf974a0(0x121a)]('\x0a')['substring'](0x0,0xc8),_0x2f6855='当前页内容摘要';}else _0x4463d9=_0xf974a0(0xd50),_0x2f6855='内容';}return'\x0a\x20\x20\x20\x20-\x20**书名**:\x20《'+_0x49e3b3+'》\x0a\x20\x20\x20\x20-\x20**'+_0x2f6855+_0xf974a0(0x1535)+_0x4463d9+'...\x22\x0a\x20\x20\x20\x20#一起读书模式\x20|\x20行为铁律\x0a\x20\x20\x20\x201.\x20\x20**角色定位**:\x20你【不是】书中的任何角色，你是【你自己】('+(_0x16699d[_0xf974a0(0x1474)][_0x5ce8dd]?.[_0xf974a0(0x628)]||'AI角色')+_0xf974a0(0x682);}function _0x1a1218(){const _0x4980ef=_0x3ce1fb,_0x806909=_0x16699d[_0x4980ef(0xf5a)];if(!_0x806909||!_0xcb0ccc[_0x806909])return;const _0x1beb35=_0xcb0ccc[_0x806909],_0x21a869=document['getElementById']('reading-content'),_0x5945f5=_0x21a869[_0x4980ef(0xced)],_0xb80375=_0x21a869[_0x4980ef(0xcdc)],_0x52243f=_0x5945f5+_0xb80375,_0x1b45ff=0xf*1.8,_0x436576=Math[_0x4980ef(0x15b6)](_0x5945f5/_0x1b45ff),_0x2bf307=Math['ceil'](_0x52243f/_0x1b45ff),_0x13758a=_0x1beb35[_0x4980ef(0xa2e)]*_0x1beb35[_0x4980ef(0x106f)]+_0x436576,_0x16edd3=_0x1beb35[_0x4980ef(0xa2e)]*_0x1beb35[_0x4980ef(0x106f)]+_0x2bf307;if(_0x13758a<0x0||_0x13758a>=_0x1beb35[_0x4980ef(0xd1f)][_0x4980ef(0xaf9)])return;const _0x1d4c02=_0x1beb35[_0x4980ef(0xd1f)][_0x4980ef(0x200)](Math[_0x4980ef(0x604)](0x0,_0x13758a),Math['min'](_0x1beb35[_0x4980ef(0xd1f)][_0x4980ef(0xaf9)],_0x16edd3))['join']('\x0a');_0x1beb35[_0x4980ef(0xc27)]=_0x1d4c02;}function _0x302fc8(){const _0x5b2fbd=_0x3ce1fb,_0x3087cb=document[_0x5b2fbd(0x948)](_0x5b2fbd(0x2f5));if(_0x3087cb){const _0x5df395=_0x3087cb[_0x5b2fbd(0x293)]();_0x5df395!==undefined&&_0x5df395[_0x5b2fbd(0x7e5)](_0x2149d3=>{const _0x297646=_0x5b2fbd;console[_0x297646(0x498)](_0x297646(0x878));})['catch'](_0x3c9b1b=>{const _0x28ae59=_0x5b2fbd;console[_0x28ae59(0x9c1)](_0x28ae59(0xd11),_0x3c9b1b);});}}function _0xb2ff26(){const _0x4ef2f3=_0x3ce1fb,_0x5ad023=document[_0x4ef2f3(0x948)](_0x4ef2f3(0x2f5));_0x5ad023&&!_0x5ad023['paused']&&(_0x5ad023[_0x4ef2f3(0xf8c)](),_0x5ad023['currentTime']=0x0,console['log'](_0x4ef2f3(0xa33)));}async function _0x446192(_0x54eba7){const _0x4862f2=_0x3ce1fb,_0xff80d0=decodeURIComponent(_0x54eba7[_0x4862f2(0x606)][_0x4862f2(0x9ea)]),_0x1e85cc=_0x54eba7[_0x4862f2(0x606)][_0x4862f2(0x633)],_0x25afd8=_0x54eba7[_0x4862f2(0xfeb)](_0x4862f2(0x2d7)),_0xe0a527=_0x54eba7[_0x4862f2(0xfeb)](_0x4862f2(0xb67)),_0x208d9f=document['getElementById'](_0x4862f2(0x139e));if(!_0x208d9f[_0x4862f2(0x106d)]&&_0x208d9f[_0x4862f2(0x606)][_0x4862f2(0x8b9)]===_0xff80d0&&_0x208d9f[_0x4862f2(0x606)][_0x4862f2(0xd36)]===_0x1e85cc){_0x208d9f[_0x4862f2(0xf8c)]();return;}_0x208d9f[_0x4862f2(0xf8c)](),document[_0x4862f2(0x1188)](_0x4862f2(0x2d7))['forEach'](_0x118496=>_0x118496[_0x4862f2(0x10cb)]='▶');const _0x298d0d='tts_'+_0x1e85cc+'_'+_0xff80d0;let _0x980b36=_0x16699d[_0x4862f2(0x1be)][_0x4862f2(0xe8c)](_0x298d0d);if(_0x980b36){console[_0x4862f2(0x498)](_0x4862f2(0xa09)),await _0x4ece04(_0x980b36[_0x4862f2(0x9a8)],_0x980b36[_0x4862f2(0x4ae)],_0xff80d0,_0x1e85cc,_0x54eba7);return;}console[_0x4862f2(0x498)](_0x4862f2(0xa8c));if(_0x25afd8)_0x25afd8[_0x4862f2(0xf74)]['display']=_0x4862f2(0x12fe);_0xe0a527[_0x4862f2(0xf74)][_0x4862f2(0x11fd)]=_0x4862f2(0x1273);const {minimaxGroupId:_0x5b039f,minimaxApiKey:_0x406766}=_0x16699d[_0x4862f2(0x79e)];if(!_0x5b039f||!_0x406766){await _0x104485(_0x4862f2(0xea9),_0x4862f2(0xf76)),_0xe0a527['style'][_0x4862f2(0x11fd)]=_0x4862f2(0x12fe);if(_0x25afd8)_0x25afd8[_0x4862f2(0xf74)][_0x4862f2(0x11fd)]='flex';return;}try{const _0x867497=await fetch('https://api.minimax.chat/v1/text_to_speech?GroupId='+_0x5b039f,{'method':_0x4862f2(0xdca),'headers':{'Authorization':_0x4862f2(0xb0e)+_0x406766,'Content-Type':_0x4862f2(0x479)},'body':JSON[_0x4862f2(0x526)]({'text':_0xff80d0,'voice_id':_0x1e85cc,'model':_0x16699d['apiConfig'][_0x4862f2(0x63f)]||_0x4862f2(0xd35),'speed':0x1,'vol':0x1,'pitch':0x0})});if(!_0x867497['ok']){let _0x5bbd16=_0x4862f2(0x2ed)+_0x867497[_0x4862f2(0x82c)];try{const _0x410856=await _0x867497[_0x4862f2(0x21d)]();_0x5bbd16=_0x410856['base_resp']?.[_0x4862f2(0x4dc)]||JSON[_0x4862f2(0x526)](_0x410856);}catch(_0x195a45){_0x5bbd16=await _0x867497[_0x4862f2(0x9ea)]();}throw new Error(_0x5bbd16);}const _0x479f31=await _0x867497[_0x4862f2(0x250)](),_0xa58cd0=URL['createObjectURL'](_0x479f31);await _0x4ece04(_0xa58cd0,_0x479f31[_0x4862f2(0x4ae)],_0xff80d0,_0x1e85cc,_0x54eba7);const _0x20a38d=new FileReader();_0x20a38d[_0x4862f2(0x55b)]=function(){const _0x2181f3=_0x4862f2;_0x16699d['ttsCache'][_0x2181f3(0x450)](_0x298d0d,{'url':_0x20a38d['result'],'type':_0x479f31[_0x2181f3(0x4ae)]}),console[_0x2181f3(0x498)](_0x2181f3(0x1052));},_0x20a38d['readAsDataURL'](_0x479f31);}catch(_0x23795b){console[_0x4862f2(0xc3e)]('Minimax\x20TTS\x20API\x20调用失败:',_0x23795b),await _0x104485(_0x4862f2(0x1f3),_0x4862f2(0x86a)+_0x23795b[_0x4862f2(0x74b)]);}finally{_0xe0a527['style'][_0x4862f2(0x11fd)]=_0x4862f2(0x12fe);if(_0x25afd8)_0x25afd8[_0x4862f2(0xf74)][_0x4862f2(0x11fd)]=_0x4862f2(0x6a4);}}function _0x4ece04(_0x47e8d4,_0x35042f,_0x4fd5a3,_0x11aa9c,_0x110d50){return new Promise((_0x412d6c,_0x2a9422)=>{const _0x29afa=_0x6c9e,_0x2d48c3=document[_0x29afa(0x948)](_0x29afa(0x139e));_0x2d48c3['src']=_0x47e8d4,_0x2d48c3['type']=_0x35042f,_0x2d48c3[_0x29afa(0x606)][_0x29afa(0x8b9)]=_0x4fd5a3,_0x2d48c3[_0x29afa(0x606)]['currentVoiceId']=_0x11aa9c;const _0x4a869e=_0x2d48c3[_0x29afa(0x293)]();_0x4a869e!==undefined&&_0x4a869e[_0x29afa(0x7e5)](()=>{const _0x11fbdf=_0x110d50['querySelector']('.voice-play-btn');if(_0x11fbdf)_0x11fbdf['textContent']='❚❚';_0x412d6c();})[_0x29afa(0x1061)](_0x22804f=>{console['error']('音频播放失败:',_0x22804f),_0x2a9422(_0x22804f);}),_0x2d48c3['onended']=()=>{const _0x4e8b9a=_0x29afa,_0x4b14cb=_0x110d50['querySelector'](_0x4e8b9a(0x2d7));if(_0x4b14cb)_0x4b14cb[_0x4e8b9a(0x10cb)]='▶';},_0x2d48c3[_0x29afa(0x14b9)]=()=>{const _0x707f18=_0x29afa,_0xd84184=_0x110d50[_0x707f18(0xfeb)]('.voice-play-btn');if(_0xd84184)_0xd84184[_0x707f18(0x10cb)]='▶';};});}function _0x4ca95e(_0x2d2356){const _0x3c7095=_0x3ce1fb,_0xa39b6e=_0x2d2356['closest'](_0x3c7095(0x10a6));if(!_0xa39b6e)return;const _0x2e65b5=_0xa39b6e[_0x3c7095(0xfeb)]('.voice-transcript'),_0xc36210=decodeURIComponent(_0x2d2356['dataset'][_0x3c7095(0x9ea)]);_0x2e65b5[_0x3c7095(0xf74)][_0x3c7095(0x11fd)]===_0x3c7095(0x1273)?_0x2e65b5[_0x3c7095(0xf74)][_0x3c7095(0x11fd)]=_0x3c7095(0x12fe):(_0x2e65b5[_0x3c7095(0x10cb)]=_0xc36210,_0x2e65b5[_0x3c7095(0xf74)]['display']=_0x3c7095(0x1273));}async function _0x33bd7e(){const _0x12601a=_0x3ce1fb;await _0x892e45(),document[_0x12601a(0x948)]('product-category-manager-modal')[_0x12601a(0xd54)]['add'](_0x12601a(0xfcb));}async function _0x892e45(){const _0x1c452e=_0x3ce1fb,_0x42743d=document[_0x1c452e(0x948)](_0x1c452e(0xc5e)),_0x21bf3a=await _0x6ed281['shoppingCategories'][_0x1c452e(0x443)]();_0x42743d[_0x1c452e(0xb6f)]='';if(_0x21bf3a[_0x1c452e(0xaf9)]===0x0){_0x42743d['innerHTML']='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>';return;}_0x21bf3a[_0x1c452e(0x427)](_0x2ca95a=>{const _0x615226=_0x1c452e,_0x3e9fd7=document[_0x615226(0x1497)](_0x615226(0x379));_0x3e9fd7[_0x615226(0x35b)]=_0x615226(0x1271),_0x3e9fd7[_0x615226(0xb6f)]=_0x615226(0x6a0)+_0x2ca95a[_0x615226(0x1467)]+_0x615226(0x1588)+_0x2ca95a['id']+_0x615226(0xcaf),_0x42743d['appendChild'](_0x3e9fd7);});}async function _0x2120b1(){const _0xb3b8c9=_0x3ce1fb,_0xa1ba4a=document['getElementById'](_0xb3b8c9(0xeb3)),_0x3c6dc8=_0xa1ba4a[_0xb3b8c9(0x5bc)][_0xb3b8c9(0x2a8)]();if(!_0x3c6dc8)return alert(_0xb3b8c9(0x12bd));const _0x16b074=await _0x6ed281['shoppingCategories'][_0xb3b8c9(0x1117)](_0xb3b8c9(0x1467))['equals'](_0x3c6dc8)['first']();if(_0x16b074)return alert('分类\x20\x22'+_0x3c6dc8+_0xb3b8c9(0x60e));await _0x6ed281[_0xb3b8c9(0x145f)]['add']({'name':_0x3c6dc8}),_0xa1ba4a['value']='',await _0x892e45();}async function _0x47d127(_0x63fc74){const _0x24dfea=_0x3ce1fb,_0x5bcbe2=await _0xa6b74a(_0x24dfea(0x8ed),_0x24dfea(0x2e8),{'confirmButtonClass':'btn-danger'});_0x5bcbe2&&(await _0x6ed281[_0x24dfea(0x145f)][_0x24dfea(0x869)](_0x63fc74),await _0x6ed281[_0x24dfea(0x151a)][_0x24dfea(0x1117)]('categoryId')[_0x24dfea(0xba9)](_0x63fc74)['modify']({'categoryId':null}),await _0x892e45());}function _0x3263df(_0x35001e={}){const _0x41ea67=_0x3ce1fb,_0x172026=document[_0x41ea67(0x948)](_0x41ea67(0x1576)),_0x3adb30=document['createElement']('div');return _0x3adb30[_0x41ea67(0x35b)]=_0x41ea67(0x58c),_0x3adb30[_0x41ea67(0xb6f)]=_0x41ea67(0x85b)+(_0x35001e[_0x41ea67(0x1467)]||'')+_0x41ea67(0x14e6)+(_0x35001e[_0x41ea67(0xa6a)]||'')+_0x41ea67(0xcbf)+(_0x35001e['imageUrl']||'https://i.postimg.cc/PqYp5T5M/image.png')+_0x41ea67(0x1584),_0x3adb30[_0x41ea67(0xfeb)](_0x41ea67(0x524))[_0x41ea67(0x339)](_0x41ea67(0x4f6),()=>_0x3adb30[_0x41ea67(0xf89)]()),_0x3adb30[_0x41ea67(0xfeb)](_0x41ea67(0x784))[_0x41ea67(0x339)](_0x41ea67(0x4f6),()=>{const _0x47b1db=_0x41ea67;_0x3adb30[_0x47b1db(0xfeb)](_0x47b1db(0x4c7))[_0x47b1db(0x4f6)]();}),_0x3adb30[_0x41ea67(0xfeb)]('.variation-image-input')[_0x41ea67(0x339)]('change',_0x259b20=>{const _0x33b9ce=_0x41ea67,_0x20bbcd=_0x259b20[_0x33b9ce(0xa50)][_0x33b9ce(0x10b0)][0x0];if(_0x20bbcd){const _0x4deb3d=new FileReader();_0x4deb3d[_0x33b9ce(0x33a)]=_0x38e846=>{const _0x4dc104=_0x33b9ce;_0x3adb30['querySelector'](_0x4dc104(0x270))[_0x4dc104(0x147d)]=_0x38e846[_0x4dc104(0xa50)][_0x4dc104(0x22a)];},_0x4deb3d[_0x33b9ce(0x5a5)](_0x20bbcd);}}),_0x172026['appendChild'](_0x3adb30),_0x3adb30;}async function _0x2695f2(_0x3e500f){const _0x2124d4=_0x3ce1fb,_0x5172d9=await _0x6ed281[_0x2124d4(0x151a)][_0x2124d4(0xe8c)](_0x3e500f);if(!_0x5172d9||!_0x5172d9[_0x2124d4(0x136a)]||_0x5172d9[_0x2124d4(0x136a)][_0x2124d4(0xaf9)]===0x0)return;const _0x555cf5=document['getElementById'](_0x2124d4(0x1012));document[_0x2124d4(0x948)](_0x2124d4(0x9f8))[_0x2124d4(0x147d)]=_0x5172d9['imageUrl'],document[_0x2124d4(0x948)](_0x2124d4(0x53f))[_0x2124d4(0x10cb)]=_0x5172d9[_0x2124d4(0x1467)];const _0x57bf0f=document[_0x2124d4(0x948)](_0x2124d4(0x1536));_0x57bf0f[_0x2124d4(0xb6f)]='',_0x5172d9['variations']['forEach']((_0x5a4af6,_0x6774e1)=>{const _0x4e5430=_0x2124d4,_0x2cf4fa=document[_0x4e5430(0x1497)]('input');_0x2cf4fa['type']=_0x4e5430(0xaaa),_0x2cf4fa['name']='variation-select',_0x2cf4fa['id']=_0x4e5430(0x109e)+_0x3e500f+'-'+_0x6774e1,_0x2cf4fa[_0x4e5430(0x5bc)]=_0x6774e1,_0x2cf4fa[_0x4e5430(0xf74)]['display']=_0x4e5430(0x12fe);if(_0x6774e1===0x0)_0x2cf4fa['checked']=!![];const _0x4ee655=document[_0x4e5430(0x1497)]('label');_0x4ee655[_0x4e5430(0x276)]='var-'+_0x3e500f+'-'+_0x6774e1,_0x4ee655[_0x4e5430(0x10cb)]=_0x5a4af6['name'],_0x4ee655[_0x4e5430(0xf74)][_0x4e5430(0x8e7)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x206px\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#ccc;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.2s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x57bf0f[_0x4e5430(0x6b6)](_0x2cf4fa),_0x57bf0f[_0x4e5430(0x6b6)](_0x4ee655);});const _0x1419a7=()=>{const _0x417e53=_0x2124d4,_0x427422=_0x57bf0f['querySelector'](_0x417e53(0xb1a));_0x57bf0f[_0x417e53(0x1188)](_0x417e53(0xe00))[_0x417e53(0x427)](_0x17a228=>{const _0x1e6732=_0x417e53;_0x17a228[_0x1e6732(0xf74)][_0x1e6732(0x9ab)]=_0x1e6732(0x1062),_0x17a228['style'][_0x1e6732(0xf1f)]='#333',_0x17a228[_0x1e6732(0xf74)][_0x1e6732(0xdb4)]=_0x1e6732(0xa85);});if(_0x427422){const _0x426a8c=_0x57bf0f['querySelector']('label[for=\x22'+_0x427422['id']+'\x22]');_0x426a8c[_0x417e53(0xf74)][_0x417e53(0x9ab)]=_0x417e53(0x3e5),_0x426a8c[_0x417e53(0xf74)]['color']=_0x417e53(0x3e5),_0x426a8c['style'][_0x417e53(0xdb4)]=_0x417e53(0x11ce);const _0x21dae1=_0x5172d9[_0x417e53(0x136a)][parseInt(_0x427422[_0x417e53(0x5bc)])];document['getElementById'](_0x417e53(0x376))[_0x417e53(0x10cb)]='¥'+_0x21dae1[_0x417e53(0xa6a)][_0x417e53(0xd69)](0x2),_0x21dae1['imageUrl']?document[_0x417e53(0x948)](_0x417e53(0x9f8))[_0x417e53(0x147d)]=_0x21dae1[_0x417e53(0x15b8)]:document['getElementById'](_0x417e53(0x9f8))['src']=_0x5172d9[_0x417e53(0x15b8)];}};_0x57bf0f[_0x2124d4(0x339)]('change',_0x1419a7),_0x1419a7(),document['getElementById'](_0x2124d4(0x122c))['textContent']='1';const _0x3b12f7=document[_0x2124d4(0x948)](_0x2124d4(0xe6f)),_0x3cf233=_0x3b12f7[_0x2124d4(0xfc0)](!![]);_0x3b12f7[_0x2124d4(0x1579)][_0x2124d4(0x868)](_0x3cf233,_0x3b12f7),_0x3cf233[_0x2124d4(0x339)](_0x2124d4(0x4f6),async()=>{const _0x13dea6=_0x2124d4,_0x1afd0d=_0x57bf0f[_0x13dea6(0xfeb)]('input[name=\x22variation-select\x22]:checked'),_0x5a0810=parseInt(document[_0x13dea6(0x948)](_0x13dea6(0x122c))[_0x13dea6(0x10cb)]);if(_0x1afd0d){const _0x4258dc=_0x5172d9['variations'][parseInt(_0x1afd0d[_0x13dea6(0x5bc)])];await _0x620cfb(_0x3e500f,_0x5a0810,_0x4258dc),_0x555cf5[_0x13dea6(0xd54)][_0x13dea6(0xf89)](_0x13dea6(0xfcb)),await _0x104485('成功',_0x13dea6(0x23f));}}),_0x555cf5['classList'][_0x2124d4(0xbd0)]('visible');}function _0x494d32(){const _0x258ce4=_0x3ce1fb,_0x242181=document[_0x258ce4(0x948)](_0x258ce4(0x967));document[_0x258ce4(0x948)](_0x258ce4(0x1483))[_0x258ce4(0x5bc)]=_0x16699d['globalSettings'][_0x258ce4(0x1246)]||0x3,document['getElementById']('shopping-product-count-input')[_0x258ce4(0x5bc)]=_0x16699d[_0x258ce4(0xf9c)][_0x258ce4(0x1092)]||0x8,_0x242181[_0x258ce4(0xd54)][_0x258ce4(0xbd0)](_0x258ce4(0xfcb));}async function _0x2435ae(){const _0x51e75e=_0x3ce1fb,_0x43aaf5=document[_0x51e75e(0x948)](_0x51e75e(0x1483)),_0x583df5=document[_0x51e75e(0x948)](_0x51e75e(0x14ec)),_0xcbfe37=parseInt(_0x43aaf5['value']),_0x506857=parseInt(_0x583df5['value']);if(isNaN(_0xcbfe37)||isNaN(_0x506857)||_0xcbfe37<0x1||_0x506857<0x1){alert(_0x51e75e(0x1380));return;}_0x16699d[_0x51e75e(0xf9c)][_0x51e75e(0x1246)]=_0xcbfe37,_0x16699d[_0x51e75e(0xf9c)][_0x51e75e(0x1092)]=_0x506857,await _0x6ed281[_0x51e75e(0xf9c)][_0x51e75e(0x90c)](_0x16699d['globalSettings']),document[_0x51e75e(0x948)]('shopping-settings-modal')[_0x51e75e(0xd54)]['remove'](_0x51e75e(0xfcb)),await _0x104485(_0x51e75e(0xd14),_0x51e75e(0xddf));}async function _0x3b77c9(){const _0x482160=_0x3ce1fb;if(!_0x16699d['activeChatId']){await _0x104485('操作失败',_0x482160(0xaae));return;}const _0x2ae089=_0x16699d[_0x482160(0x1474)][_0x16699d['activeChatId']],_0x3301ec=await _0xa6b74a('为“'+_0x2ae089['name']+'”生成商品？',_0x482160(0x10b5),{'confirmText':_0x482160(0xce2)});if(!_0x3301ec)return;await _0x104485('请稍候...',_0x482160(0x527)+_0x2ae089[_0x482160(0x1467)]+'”的特点生成专属商品...');const _0x1e6c1b=_0x16699d[_0x482160(0x79e)][_0x482160(0xde5)]&&_0x16699d[_0x482160(0x79e)][_0x482160(0x11bf)]&&_0x16699d[_0x482160(0x79e)][_0x482160(0x688)],{proxyUrl:_0x4fb451,apiKey:_0x51b0e6,model:_0x524a9f}=_0x1e6c1b?{'proxyUrl':_0x16699d[_0x482160(0x79e)][_0x482160(0xde5)],'apiKey':_0x16699d[_0x482160(0x79e)][_0x482160(0x11bf)],'model':_0x16699d[_0x482160(0x79e)][_0x482160(0x688)]}:_0x16699d[_0x482160(0x79e)];if(!_0x4fb451||!_0x51b0e6||!_0x524a9f){await _0x104485(_0x482160(0xd25),_0x482160(0x2e6));return;}const _0x4c3d53=_0x16699d['globalSettings'][_0x482160(0x1246)]||0x3,_0x43a16f=_0x16699d['globalSettings'][_0x482160(0x1092)]||0x8,_0x33eda0=await _0x6ed281[_0x482160(0x145f)][_0x482160(0x443)]();let _0x3fbe1a='';_0x33eda0[_0x482160(0xaf9)]>0x0&&(_0x3fbe1a=_0x482160(0x9c8)+_0x33eda0['map'](_0x411d4d=>'\x22'+_0x411d4d[_0x482160(0x1467)]+'\x22')['join'](',\x20')+']\x0a');const _0x109b73=_0x16699d[_0x482160(0x66e)][_0x482160(0xf4d)]||'我',_0x293be8=_0x2ae089[_0x482160(0x758)]&&_0x2ae089[_0x482160(0x758)][_0x482160(0xaf9)]>0x0?_0x2ae089[_0x482160(0x758)][_0x482160(0x8ff)](_0x33a7d0=>_0x482160(0x152b)+_0x31ced1(_0x33a7d0[_0x482160(0xb0a)])+')\x20'+_0x33a7d0[_0x482160(0xede)])[_0x482160(0x121a)]('\x0a'):'无',_0x1ae81b=_0x2ae089[_0x482160(0xb07)][_0x482160(0x200)](-0xa)['map'](_0x3b00a4=>(_0x3b00a4[_0x482160(0x1554)]===_0x482160(0xaeb)?_0x109b73:_0x2ae089[_0x482160(0x1467)])+':\x20'+String(_0x3b00a4[_0x482160(0xede)])[_0x482160(0xeca)](0x0,0x1e)+_0x482160(0x76d))[_0x482160(0x121a)]('\x0a');let _0x13a49b='';if(_0x2ae089[_0x482160(0x7fd)][_0x482160(0xeee)]&&_0x2ae089[_0x482160(0x7fd)][_0x482160(0xeee)][_0x482160(0xaf9)]>0x0){const _0xa4ef62=_0x2ae089['settings']['linkedWorldBookIds'][_0x482160(0x8ff)](_0x2254b4=>{const _0x5800de=_0x482160,_0x2d38a8=_0x16699d[_0x5800de(0x44c)][_0x5800de(0x1402)](_0x2f8737=>_0x2f8737['id']===_0x2254b4);if(!_0x2d38a8||!Array[_0x5800de(0x1524)](_0x2d38a8[_0x5800de(0xede)]))return'';const _0x235ba5=_0x2d38a8['content'][_0x5800de(0x1c0)](_0x20baf7=>_0x20baf7[_0x5800de(0x111f)]!==![])[_0x5800de(0x8ff)](_0x464f20=>'-\x20'+_0x464f20[_0x5800de(0xede)])[_0x5800de(0x121a)]('\x0a');return _0x235ba5?_0x5800de(0x1307)+_0x2d38a8[_0x5800de(0x1467)]+_0x5800de(0x8a4)+_0x235ba5:'';})[_0x482160(0x1c0)](Boolean)[_0x482160(0x121a)]('');_0xa4ef62&&(_0x13a49b='\x0a#\x20世界观设定\x20(必须参考)\x0a'+_0xa4ef62+'\x0a');}const _0xfe9567=_0x482160(0x146c)+_0x2ae089[_0x482160(0x1467)]+'”量身打造一个专属的商品列表。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色定制(最高优先级)】**:\x20你生成的所有商品和分类【必须】深度绑定角色的性格、记忆和最近的对话。它们应该是角色会真正感兴趣、购买或制作的东西。\x0a2.\x20\x20**创造性与合理性**:\x20商品和分类必须合理且多样化。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON对象前后添加任何多余的文字、解释或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22categories\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22分类名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22products\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22商品名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x2099.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是商品的详细描述，不少于50字...\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22variations\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式1\x22,\x20\x22price\x22:\x20108.80,\x20\x22image_prompt\x22:\x20\x22款式1的图片【英文】关键词...\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式2\x22,\x20\x22price\x22:\x20118.80,\x20\x22image_prompt\x22:\x20\x22款式2的图片【英文】关键词...\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20],\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22商品主图的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**categories**:\x20生成\x20'+_0x4c3d53+_0x482160(0x247)+_0x43a16f+_0x482160(0x315)+_0x2ae089[_0x482160(0x1467)]+'\x0a-\x20**角色人设**:\x20'+_0x2ae089[_0x482160(0x7fd)][_0x482160(0x14c1)]+_0x482160(0xe84)+_0x293be8+_0x482160(0x6be)+_0x13a49b+'\x0a'+_0x3fbe1a+_0x482160(0x15aa)+_0x1ae81b+_0x482160(0xc85)+_0x2ae089[_0x482160(0x1467)]+_0x482160(0x15c7);try{const _0x438322=[{'role':'user','content':_0x482160(0xde4)}];let _0x446932=_0x4fb451[_0x482160(0x1336)]('generativelanguage'),_0x57bd51=_0xe8c788(_0x524a9f,_0x51b0e6,_0xfe9567,_0x438322);const _0x3bc898=_0x446932?await fetch(_0x57bd51[_0x482160(0x9a8)],_0x57bd51[_0x482160(0x92a)]):await fetch(_0x4fb451+_0x482160(0x110e),{'method':_0x482160(0xdca),'headers':{'Content-Type':_0x482160(0x479),'Authorization':'Bearer\x20'+_0x51b0e6},'body':JSON['stringify']({'model':_0x524a9f,'messages':[{'role':_0x482160(0x11af),'content':_0xfe9567},..._0x438322],'temperature':_0x16699d[_0x482160(0xf9c)][_0x482160(0x382)]||0.9})});if(!_0x3bc898['ok'])throw new Error(_0x482160(0x69a)+_0x3bc898[_0x482160(0x13a2)]);const _0x25aaea=await _0x3bc898[_0x482160(0x21d)](),_0x3ff908=getGeminiResponseText(_0x25aaea),_0x11e810=_0x3ff908[_0x482160(0x9a3)](/({[\s\S]*})/);if(!_0x11e810)throw new Error(_0x482160(0xaaf));const _0x24ab11=JSON[_0x482160(0xde0)](_0x11e810[0x0]);if(!_0x24ab11[_0x482160(0xb39)]||!Array['isArray'](_0x24ab11[_0x482160(0xb39)]))throw new Error(_0x482160(0x875));await _0x6ed281['transaction']('rw',_0x6ed281[_0x482160(0x151a)],_0x6ed281['shoppingCategories'],async()=>{const _0x52a56f=_0x482160;for(const _0x2c292e of _0x24ab11[_0x52a56f(0xb39)]){let _0xc9d375;const _0xfaec6d=await _0x6ed281[_0x52a56f(0x145f)]['where']('name')[_0x52a56f(0xd9b)](_0x2c292e[_0x52a56f(0x1467)])[_0x52a56f(0x678)]();_0xfaec6d?_0xc9d375=_0xfaec6d['id']:_0xc9d375=await _0x6ed281[_0x52a56f(0x145f)][_0x52a56f(0xbd0)]({'name':_0x2c292e[_0x52a56f(0x1467)]});const _0x3f7723=_0x2c292e['products'][_0x52a56f(0x8ff)](_0x5a0abc=>{const _0x2fb9b7=_0x52a56f;return{'name':_0x5a0abc[_0x2fb9b7(0x1467)],'price':_0x5a0abc[_0x2fb9b7(0xa6a)]||0x0,'description':_0x5a0abc[_0x2fb9b7(0xe79)]||'','imageUrl':_0x2fb9b7(0xbfa)+encodeURIComponent(_0x5a0abc[_0x2fb9b7(0x5d9)]),'variations':(_0x5a0abc['variations']||[])[_0x2fb9b7(0x8ff)](_0x4d59a9=>({..._0x4d59a9,'imageUrl':'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x4d59a9[_0x2fb9b7(0x5d9)])})),'categoryId':_0xc9d375};});_0x3f7723[_0x52a56f(0xaf9)]>0x0&&await _0x6ed281[_0x52a56f(0x151a)][_0x52a56f(0x571)](_0x3f7723);}}),activeShoppingCategoryId=_0x482160(0xd49),await _0x42dc5f(),await _0x104485(_0x482160(0xf00),'为“'+_0x2ae089['name']+'”量身定制的商品已上架！');}catch(_0x2296d5){console[_0x482160(0xc3e)](_0x482160(0x274),_0x2296d5),await _0x104485(_0x482160(0x1164),_0x482160(0x105c)+_0x2296d5['message']);}}async function _0x10b377(_0x2127d7){const _0x16ce65=_0x3ce1fb,_0x3ce11c=document[_0x16ce65(0x948)](_0x2127d7);if(!_0x3ce11c)return;const _0x1a3dfb=await _0x9286bb('更换图片',[{'text':_0x16ce65(0x1a1),'value':'local'},{'text':_0x16ce65(0x500),'value':'url'}]);let _0x4c2164=null;if(_0x1a3dfb===_0x16ce65(0x1179))_0x4c2164=await _0x2c96d6();else _0x1a3dfb===_0x16ce65(0x9a8)&&(_0x4c2164=await _0x41b9fc(_0x16ce65(0x195),_0x16ce65(0x481),_0x3ce11c['src'],_0x16ce65(0x9a8)));if(_0x4c2164&&_0x4c2164[_0x16ce65(0x2a8)]()){const _0x3fc75d=_0x4c2164[_0x16ce65(0x2a8)]();_0x3ce11c[_0x16ce65(0x147d)]=_0x3fc75d,!_0x16699d[_0x16ce65(0xf9c)]['widgetData']&&(_0x16699d[_0x16ce65(0xf9c)][_0x16ce65(0x9aa)]={}),_0x16699d[_0x16ce65(0xf9c)][_0x16ce65(0x9aa)][_0x2127d7]=_0x3fc75d,await _0x6ed281[_0x16ce65(0xf9c)]['put'](_0x16699d[_0x16ce65(0xf9c)]),await _0x104485('成功',_0x16ce65(0xeeb));}}window[_0x3ce1fb(0x1041)]=_0x10b377;async function _0x208819(){const _0x4161f7=_0x3ce1fb;if(!window[_0x4161f7(0xe4c)]||typeof JSZip==='undefined'){await _0x104485('库加载失败',_0x4161f7(0x552));return;}await _0x104485(_0x4161f7(0x1ec),_0x4161f7(0xb1b));const _0xe5cc4b=streamSaver['createWriteStream'](_0x4161f7(0xc06)+new Date()[_0x4161f7(0x5ac)]()[_0x4161f7(0x46f)]('T')[0x0]+_0x4161f7(0x1361)),_0x4a6c7d=new JSZip(),_0x1a7480=0x5f*0x400*0x400;let _0xbd69b5=0x1,_0x325de1={},_0x365ecc=0x0;const _0x4611b2=new TextEncoder();try{const _0x4d536a=_0x6ed281[_0x4161f7(0x8fa)]['map'](_0x8d5db6=>_0x8d5db6[_0x4161f7(0x1467)]);for(const _0x129c81 of _0x4d536a){console[_0x4161f7(0x498)](_0x4161f7(0x1118)+_0x129c81+_0x4161f7(0x76d));const _0x48b248=await _0x6ed281['table'](_0x129c81)[_0x4161f7(0x443)]();if(_0x48b248[_0x4161f7(0xaf9)]===0x0)continue;const _0x5e7b4c=JSON[_0x4161f7(0x526)](_0x48b248),_0x334e04=_0x4611b2[_0x4161f7(0x1446)](_0x5e7b4c)[_0x4161f7(0xaf9)];if(_0x334e04>_0x1a7480){console[_0x4161f7(0x9c1)]('警告：表\x20\x22'+_0x129c81+_0x4161f7(0x1450)+(_0x334e04/0x400/0x400)[_0x4161f7(0xd69)](0x2)+_0x4161f7(0x3db));_0x365ecc>0x0&&(_0x4a6c7d['file'](_0x4161f7(0x152f)+_0xbd69b5++ +_0x4161f7(0x9ce),JSON[_0x4161f7(0x526)]({'version':0x4,'type':_0x4161f7(0x200),'data':_0x325de1})),_0x325de1={},_0x365ecc=0x0);_0x325de1[_0x129c81]=_0x48b248,_0x4a6c7d['file']('slice_'+_0xbd69b5++ +_0x4161f7(0x9ce),JSON['stringify']({'version':0x4,'type':'slice','data':_0x325de1})),_0x325de1={},_0x365ecc=0x0;continue;}_0x365ecc>0x0&&_0x365ecc+_0x334e04>_0x1a7480&&(console['log'](_0x4161f7(0x6fc)+_0xbd69b5+_0x4161f7(0xada)+(_0x365ecc/0x400/0x400)[_0x4161f7(0xd69)](0x2)+_0x4161f7(0xc79)),_0x4a6c7d[_0x4161f7(0x96f)](_0x4161f7(0x152f)+_0xbd69b5++ +'.json',JSON[_0x4161f7(0x526)]({'version':0x4,'type':_0x4161f7(0x200),'data':_0x325de1})),_0x325de1={},_0x365ecc=0x0),_0x325de1[_0x129c81]=_0x48b248,_0x365ecc+=_0x334e04;}_0x365ecc>0x0&&(console['log']('正在归档最后一个切片\x20'+_0xbd69b5+_0x4161f7(0x2ca)+(_0x365ecc/0x400/0x400)[_0x4161f7(0xd69)](0x2)+_0x4161f7(0xc80)),_0x4a6c7d[_0x4161f7(0x96f)]('slice_'+_0xbd69b5+_0x4161f7(0x9ce),JSON['stringify']({'version':0x4,'type':_0x4161f7(0x200),'data':_0x325de1})));console[_0x4161f7(0x498)]('所有切片已打包，开始流式下载ZIP...');const _0x5a4387=_0x4a6c7d['generateInternalStream']({'type':_0x4161f7(0x250),'streamFiles':!![]}),_0x1d20a2=new ReadableStream({'start'(_0x4075f5){const _0x3babc9=_0x4161f7;_0x5a4387['on'](_0x3babc9(0x92a),_0x22dbc9=>{_0x4075f5['enqueue'](_0x22dbc9);})['on'](_0x3babc9(0xef4),()=>{const _0x42fa8f=_0x3babc9;console[_0x42fa8f(0x498)]('ZIP\x20流生成完毕。'),_0x4075f5['close']();})['on'](_0x3babc9(0xc3e),_0x39f4bd=>{const _0x2b09b0=_0x3babc9;console[_0x2b09b0(0xc3e)](_0x2b09b0(0x7a3),_0x39f4bd),_0x4075f5['error'](_0x39f4bd);})['resume']();}});await _0x1d20a2[_0x4161f7(0x32f)](_0xe5cc4b),await _0x104485('导出已开始',_0x4161f7(0x1574));}catch(_0x23a879){console['error'](_0x4161f7(0xe83),_0x23a879),await _0x104485(_0x4161f7(0x10d5),_0x4161f7(0x12a7)+_0x23a879['message']);try{const _0x14da25=_0xe5cc4b[_0x4161f7(0x151e)]();_0x14da25[_0x4161f7(0x4f2)](_0x23a879);}catch(_0x10e68c){}}}async function _0x40d17b(){const _0x43f6a1=_0x3ce1fb;if(!window['streamSaver']){alert(_0x43f6a1(0xdee));return;}await _0x104485(_0x43f6a1(0x317),_0x43f6a1(0x4be));const _0xe8b95c=streamSaver[_0x43f6a1(0x915)](_0x43f6a1(0x13d1)+new Date()[_0x43f6a1(0x5ac)]()[_0x43f6a1(0x46f)]('T')[0x0]+_0x43f6a1(0x9ce)),_0x376c1f=_0xe8b95c[_0x43f6a1(0x151e)](),_0x4070a7=new TextEncoder();try{await _0x376c1f[_0x43f6a1(0xd13)](_0x4070a7[_0x43f6a1(0x1446)]('{\x0a\x22version\x22:\x203,\x0a\x22timestamp\x22:\x20'+Date[_0x43f6a1(0x1386)]()+',\x0a\x22data\x22:\x20{\x0a'));const _0x414cff=await _0x6ed281['tables'][_0x43f6a1(0x8ff)](_0x3894d5=>_0x3894d5[_0x43f6a1(0x1467)]);for(let _0xd44c7d=0x0;_0xd44c7d<_0x414cff['length'];_0xd44c7d++){const _0x27e61e=_0x414cff[_0xd44c7d],_0xd885dc=_0x6ed281[_0x43f6a1(0x437)](_0x27e61e);await _0x376c1f[_0x43f6a1(0xd13)](_0x4070a7[_0x43f6a1(0x1446)]('\x22'+_0x27e61e+_0x43f6a1(0xaf4)));let _0xa7e1fd=!![];await _0xd885dc[_0x43f6a1(0x13de)](_0x34ab53=>{const _0xc0bbe5=_0x43f6a1;!_0xa7e1fd&&_0x376c1f[_0xc0bbe5(0xd13)](_0x4070a7['encode'](',\x0a')),_0x376c1f[_0xc0bbe5(0xd13)](_0x4070a7[_0xc0bbe5(0x1446)](JSON[_0xc0bbe5(0x526)](_0x34ab53))),_0xa7e1fd=![];}),await _0x376c1f['write'](_0x4070a7['encode']('\x0a]')),_0xd44c7d<_0x414cff[_0x43f6a1(0xaf9)]-0x1&&await _0x376c1f['write'](_0x4070a7['encode'](',\x0a'));}await _0x376c1f[_0x43f6a1(0xd13)](_0x4070a7[_0x43f6a1(0x1446)](_0x43f6a1(0xc17)));}catch(_0x2e4a6f){console[_0x43f6a1(0xc3e)](_0x43f6a1(0x92d),_0x2e4a6f),await _0x104485(_0x43f6a1(0x10d5),_0x43f6a1(0x472)+_0x2e4a6f[_0x43f6a1(0x74b)]);}finally{await _0x376c1f[_0x43f6a1(0x15ca)]();}}async function _0x4df2e1(){const _0x2ae1a1=_0x3ce1fb;await _0x104485(_0x2ae1a1(0x317),_0x2ae1a1(0x275));try{const _0xde4802={'version':0x3,'timestamp':Date[_0x2ae1a1(0x1386)](),'data':{}},_0x1f8061=_0x6ed281[_0x2ae1a1(0x8fa)]['map'](_0x4dbad3=>_0x4dbad3[_0x2ae1a1(0x1467)]);for(const _0x4dcc58 of _0x1f8061){const _0x15c8f3=await _0x6ed281['table'](_0x4dcc58)[_0x2ae1a1(0x443)]();_0xde4802[_0x2ae1a1(0x92a)][_0x4dcc58]=_0x15c8f3,console[_0x2ae1a1(0x498)](_0x2ae1a1(0x4eb)+_0x4dcc58+',\x20记录数:\x20'+_0x15c8f3['length']);}const _0x41e535=new Blob([JSON['stringify'](_0xde4802,null,0x2)],{'type':_0x2ae1a1(0x479)}),_0x193a6c=URL[_0x2ae1a1(0x91d)](_0x41e535),_0x425b21=document[_0x2ae1a1(0x1497)]('a');_0x425b21[_0x2ae1a1(0x13a6)]=_0x193a6c,_0x425b21[_0x2ae1a1(0xf4c)]=_0x2ae1a1(0x12d6)+new Date()[_0x2ae1a1(0x5ac)]()[_0x2ae1a1(0x46f)]('T')[0x0]+_0x2ae1a1(0x9ce),_0x425b21['click'](),URL['revokeObjectURL'](_0x193a6c),await _0x104485('导出成功',_0x2ae1a1(0x10b6));}catch(_0xa52fa2){console[_0x2ae1a1(0xc3e)](_0x2ae1a1(0xdc2),_0xa52fa2),await _0x104485(_0x2ae1a1(0x10d5),_0x2ae1a1(0x1345)+_0xa52fa2['message']);}}function _0x88f8e2(){const _0x29b8e0=_0x3ce1fb,_0x55b819=Object[_0x29b8e0(0x1166)](_0x16699d[_0x29b8e0(0x1474)])[_0x29b8e0(0x6ab)]((_0x42e94c,_0x4b38c8)=>{const _0x3f685a=_0x29b8e0;if(_0x4b38c8['id']===_0x16699d[_0x3f685a(0xf5a)])return _0x42e94c;return _0x42e94c+(_0x4b38c8[_0x3f685a(0x1300)]||0x0);},0x0),_0xf69134=_0x5711af||0x0,_0xc00a6f=_0x55b819+_0xf69134,_0x543bd5=document[_0x29b8e0(0x948)](_0x29b8e0(0x2b5));if(!_0x543bd5)return;let _0x438c6b=_0x543bd5[_0x29b8e0(0xfeb)]('.unread-indicator');!_0x438c6b&&(_0x438c6b=document[_0x29b8e0(0x1497)](_0x29b8e0(0x65b)),_0x438c6b['className']=_0x29b8e0(0x109f),_0x543bd5[_0x29b8e0(0x6b6)](_0x438c6b));let _0x3edc1c=_0x543bd5['querySelector'](_0x29b8e0(0x267));_0x3edc1c&&_0x3edc1c['remove'](),_0xc00a6f>0x0?(_0x438c6b['textContent']=_0xc00a6f>0x63?_0x29b8e0(0x158d):_0xc00a6f,_0x438c6b['style'][_0x29b8e0(0x11fd)]=_0x29b8e0(0x1273),_0x438c6b['style'][_0x29b8e0(0xac2)]='20',_0x438c6b['style']['transform']=_0x29b8e0(0x6b7)):_0x438c6b[_0x29b8e0(0xf74)][_0x29b8e0(0x11fd)]=_0x29b8e0(0x12fe);}async function _0x2a3feb(_0x1c8e7e){const _0xfc754=_0x3ce1fb,_0x5c1395=_0x1c8e7e===_0xfc754(0x149b)?{'id':_0xfc754(0x149b),'name':_0xfc754(0x14cd)}:await _0x6ed281[_0xfc754(0x19c)][_0xfc754(0xe8c)](_0x1c8e7e);if(!_0x5c1395){console[_0xfc754(0xc3e)]('无法为不存在的分类打开绑定模态框:',_0x1c8e7e);return;}const _0x26959a=document['getElementById'](_0xfc754(0x12f1)),_0x37a545=document['getElementById']('sticker-binding-chat-list'),_0x21c533=_0x26959a[_0xfc754(0xfeb)]('.modal-header\x20span');_0x37a545['innerHTML']='',_0x21c533[_0xfc754(0x10cb)]=_0xfc754(0xcc9)+_0x5c1395[_0xfc754(0x1467)]+_0xfc754(0x12a5);const _0x42c362=Object[_0xfc754(0x1166)](_0x16699d[_0xfc754(0x1474)])[_0xfc754(0xe96)]((_0x930216,_0x15b771)=>_0x930216['name']['localeCompare'](_0x15b771[_0xfc754(0x1467)],_0xfc754(0x144f)));_0x42c362['forEach'](_0x2dc614=>{const _0x559736=_0xfc754,_0x4d4274=Array['isArray'](_0x2dc614['settings']?.[_0x559736(0xe50)])&&_0x2dc614[_0x559736(0x7fd)][_0x559736(0xe50)][_0x559736(0x1336)](_0x1c8e7e),_0x26633f=document[_0x559736(0x1497)](_0x559736(0x379));_0x26633f[_0x559736(0x35b)]=_0x559736(0x1437),_0x26633f[_0x559736(0xb6f)]=_0x559736(0x1073)+_0x2dc614['id']+'\x22\x20'+(_0x4d4274?_0x559736(0x210):'')+_0x559736(0x158c)+(_0x2dc614[_0x559736(0x1173)]?_0x2dc614[_0x559736(0x7fd)][_0x559736(0x1e7)]:_0x2dc614['settings'][_0x559736(0x156d)]||_0x202ba5)+_0x559736(0x1239)+_0x2dc614[_0x559736(0x1467)]+_0x559736(0x10df),_0x37a545[_0x559736(0x6b6)](_0x26633f);}),document[_0xfc754(0x948)](_0xfc754(0x589))['onclick']=()=>_0x11d3fd(_0x1c8e7e),document[_0xfc754(0x948)](_0xfc754(0x10d6))[_0xfc754(0xe8d)]=()=>_0x26959a[_0xfc754(0xd54)]['remove']('visible'),_0x26959a[_0xfc754(0xd54)][_0xfc754(0xbd0)](_0xfc754(0xfcb));}async function _0x11d3fd(_0x209c68){const _0xc884f9=_0x3ce1fb,_0x1ea931=new Set(Array[_0xc884f9(0x6e5)](document['querySelectorAll']('#sticker-binding-chat-list\x20.sticker-binding-checkbox:checked'))[_0xc884f9(0x8ff)](_0x37a66a=>_0x37a66a[_0xc884f9(0x606)][_0xc884f9(0x1029)])),_0x1030ee=[];for(const _0x30e66d in _0x16699d[_0xc884f9(0x1474)]){const _0x566d38=_0x16699d[_0xc884f9(0x1474)][_0x30e66d];!Array[_0xc884f9(0x1524)](_0x566d38[_0xc884f9(0x7fd)][_0xc884f9(0xe50)])&&(_0x566d38[_0xc884f9(0x7fd)]['stickerCategoryIds']=[]);const _0x225f97=_0x566d38[_0xc884f9(0x7fd)][_0xc884f9(0xe50)][_0xc884f9(0x1336)](_0x209c68),_0x2ae6a0=_0x1ea931[_0xc884f9(0xda1)](_0x30e66d);if(_0x225f97&&!_0x2ae6a0)_0x566d38[_0xc884f9(0x7fd)][_0xc884f9(0xe50)]=_0x566d38[_0xc884f9(0x7fd)][_0xc884f9(0xe50)]['filter'](_0x2720bb=>_0x2720bb!==_0x209c68),_0x1030ee[_0xc884f9(0x1001)](_0x566d38);else!_0x225f97&&_0x2ae6a0&&(_0x566d38[_0xc884f9(0x7fd)][_0xc884f9(0xe50)][_0xc884f9(0x1001)](_0x209c68),_0x1030ee[_0xc884f9(0x1001)](_0x566d38));}_0x1030ee[_0xc884f9(0xaf9)]>0x0&&(await _0x6ed281[_0xc884f9(0x1474)][_0xc884f9(0xad6)](_0x1030ee),await _0x104485(_0xc884f9(0xd14),_0xc884f9(0x2bd))),document[_0xc884f9(0x948)](_0xc884f9(0x12f1))[_0xc884f9(0xd54)]['remove'](_0xc884f9(0xfcb));}function _0x5e13e4(_0x42c75c){const _0x8beb=_0x3ce1fb;if(!_0x42c75c||!_0x42c75c[_0x8beb(0x7fd)][_0x8beb(0xe50)]||_0x42c75c[_0x8beb(0x7fd)]['stickerCategoryIds'][_0x8beb(0xaf9)]===0x0)return'';const _0x321e15=_0x42c75c[_0x8beb(0x7fd)][_0x8beb(0xe50)];let _0x4f0291=[];const _0x18ac2f=new Set();_0x321e15[_0x8beb(0x427)](_0x43dcfb=>{const _0x2851b5=_0x8beb;let _0x2c596e;_0x43dcfb===_0x2851b5(0x149b)?_0x2c596e=_0x16699d[_0x2851b5(0x14a2)]['filter'](_0x234604=>!_0x234604[_0x2851b5(0xd86)]):_0x2c596e=_0x16699d[_0x2851b5(0x14a2)][_0x2851b5(0x1c0)](_0x374110=>_0x374110[_0x2851b5(0xd86)]===_0x43dcfb),_0x2c596e[_0x2851b5(0x427)](_0x1b10c4=>{const _0x524542=_0x2851b5;!_0x18ac2f[_0x524542(0xda1)](_0x1b10c4[_0x524542(0x1467)])&&(_0x4f0291[_0x524542(0x1001)](_0x1b10c4),_0x18ac2f['add'](_0x1b10c4[_0x524542(0x1467)]));});});if(_0x4f0291[_0x8beb(0xaf9)]===0x0)return'';const _0x57ba14=_0x4f0291[_0x8beb(0x8ff)](_0x75f6ad=>'-\x20'+_0x75f6ad[_0x8beb(0x1467)])[_0x8beb(0x121a)]('\x0a');return _0x8beb(0x2c5)+_0x57ba14+'\x0a';}function _0x16ebe3(_0x3f6400){const _0x3fbf33=_0x3ce1fb;if(!_0x3f6400||!_0x3f6400[_0x3fbf33(0x1173)])return'';let _0x3408bd=_0x3fbf33(0x11ca),_0x4f5317=![];return _0x3f6400[_0x3fbf33(0x10a2)]['forEach'](_0x12fdf3=>{const _0x2ae081=_0x3fbf33;if(_0x12fdf3['id']===_0x2ae081(0xaeb))return;const _0xad1fe5=_0x16699d[_0x2ae081(0x1474)][_0x12fdf3['id']];if(_0xad1fe5&&_0xad1fe5[_0x2ae081(0x7fd)]['stickerCategoryIds']&&_0xad1fe5[_0x2ae081(0x7fd)][_0x2ae081(0xe50)][_0x2ae081(0xaf9)]>0x0){const _0x449a40=_0xad1fe5[_0x2ae081(0x7fd)][_0x2ae081(0xe50)];let _0x12a3e3=[];const _0x418eed=new Set();_0x449a40[_0x2ae081(0x427)](_0x278d29=>{const _0x548b37=_0x2ae081;let _0x5112e6;_0x278d29==='uncategorized'?_0x5112e6=_0x16699d[_0x548b37(0x14a2)][_0x548b37(0x1c0)](_0x5ace5a=>!_0x5ace5a[_0x548b37(0xd86)]):_0x5112e6=_0x16699d['userStickers'][_0x548b37(0x1c0)](_0x1b2f0a=>_0x1b2f0a[_0x548b37(0xd86)]===_0x278d29),_0x5112e6[_0x548b37(0x427)](_0x183f8b=>{const _0x17d6cc=_0x548b37;!_0x418eed[_0x17d6cc(0xda1)](_0x183f8b[_0x17d6cc(0x1467)])&&(_0x12a3e3[_0x17d6cc(0x1001)](_0x183f8b),_0x418eed[_0x17d6cc(0xbd0)](_0x183f8b[_0x17d6cc(0x1467)]));});}),_0x12a3e3['length']>0x0&&(_0x4f5317=!![],_0x3408bd+=_0x2ae081(0x1011)+_0x12fdf3[_0x2ae081(0x347)]+'\x20(本名:\x20'+_0x12fdf3[_0x2ae081(0x628)]+_0x2ae081(0x1122),_0x3408bd+=_0x12a3e3['map'](_0x5ebc99=>'-\x20'+_0x5ebc99[_0x2ae081(0x1467)])[_0x2ae081(0x121a)]('\x0a'));}}),_0x4f5317?_0x3408bd:'';}function _0x180f9c(_0x2ade48){const _0x158609=_0x3ce1fb;if(!_0x2ade48)return 0x0;return Math[_0x158609(0x1112)](_0x2ade48['length']/1.5);}async function _0x4553ee(){const _0x478f6d=_0x3ce1fb;if(!_0x16699d[_0x478f6d(0xf5a)])return 0x0;const _0x4f37cc=_0x16699d[_0x478f6d(0x1474)][_0x16699d[_0x478f6d(0xf5a)]];if(!_0x4f37cc)return 0x0;const _0x127404=parseInt(document[_0x478f6d(0x948)](_0x478f6d(0xa5c))[_0x478f6d(0x5bc)])||0xa,_0x58d075=parseInt(document[_0x478f6d(0x948)](_0x478f6d(0x88d))[_0x478f6d(0x5bc)])||0xa,_0x245593=document[_0x478f6d(0x948)](_0x478f6d(0x1fe))[_0x478f6d(0x210)],_0x128192=document[_0x478f6d(0x948)](_0x478f6d(0xb97))[_0x478f6d(0x5bc)],_0x943e7=document['getElementById'](_0x478f6d(0x71f))[_0x478f6d(0x5bc)];let _0x11d842='';const _0x4616fb=Array[_0x478f6d(0x6e5)](document[_0x478f6d(0x1188)](_0x478f6d(0x1181)))[_0x478f6d(0x8ff)](_0x34f8fd=>_0x34f8fd[_0x478f6d(0x5bc)][_0x478f6d(0x14e9)](_0x478f6d(0x5ab),''));if(_0x4616fb[_0x478f6d(0xaf9)]>0x0){const _0x4c083e=_0x4616fb[_0x478f6d(0x8ff)](_0x377a17=>{const _0x4b4dd5=_0x478f6d,_0xe97368=_0x16699d[_0x4b4dd5(0x44c)][_0x4b4dd5(0x1402)](_0x528739=>_0x528739['id']===_0x377a17);if(!_0xe97368||!Array[_0x4b4dd5(0x1524)](_0xe97368[_0x4b4dd5(0xede)]))return'';return _0xe97368['content'][_0x4b4dd5(0x1c0)](_0x1903c9=>_0x1903c9['enabled']!==![])[_0x4b4dd5(0x8ff)](_0x18c0cd=>_0x18c0cd['content'])[_0x4b4dd5(0x121a)]('\x0a');})[_0x478f6d(0x1c0)](Boolean)[_0x478f6d(0x121a)]('\x0a');_0x11d842+=_0x4c083e;}_0x4f37cc[_0x478f6d(0x758)]&&_0x4f37cc['longTermMemory'][_0x478f6d(0xaf9)]>0x0&&(_0x11d842+=_0x4f37cc[_0x478f6d(0x758)]['map'](_0x1891be=>_0x1891be[_0x478f6d(0xede)])['join']('\x0a'));const _0x4d8b7a=document[_0x478f6d(0x948)]('link-memory-toggle')['checked'];if(_0x4d8b7a){const _0x4a23cd=Array[_0x478f6d(0x6e5)](document[_0x478f6d(0x1188)](_0x478f6d(0x72a)))[_0x478f6d(0x8ff)](_0x1435fd=>_0x1435fd[_0x478f6d(0x5bc)]);for(const _0x190584 of _0x4a23cd){const _0x5a30e6=_0x16699d[_0x478f6d(0x1474)][_0x190584];_0x5a30e6&&_0x5a30e6[_0x478f6d(0xb07)]['length']>0x0&&(_0x11d842+=_0x5a30e6[_0x478f6d(0xb07)]['slice'](-_0x58d075)['map'](_0x32919d=>String(_0x32919d[_0x478f6d(0xede)]))[_0x478f6d(0x121a)]('\x0a'));}}_0x4f37cc[_0x478f6d(0x1173)]?_0x4f37cc[_0x478f6d(0x10a2)][_0x478f6d(0x427)](_0x5df065=>{const _0x5249ae=_0x478f6d;_0x11d842+=_0x5df065[_0x5249ae(0xbad)];}):_0x11d842+=_0x128192;_0x11d842+=_0x943e7,_0x11d842+=_0x5e13e4(_0x4f37cc);_0x4f37cc['isGroup']&&(_0x11d842+=_0x16ebe3(_0x4f37cc));if(!_0x4f37cc[_0x478f6d(0x1173)]&&_0x245593){const _0x110fa8=document[_0x478f6d(0x948)](_0x478f6d(0x1030))[_0x478f6d(0x5bc)];if(_0x110fa8){const _0x193b1d=_0x16699d[_0x478f6d(0xd44)][_0x478f6d(0x1402)](_0x3a17f7=>_0x3a17f7['id']===_0x110fa8);_0x193b1d&&(_0x11d842+=_0x193b1d['content'][_0x478f6d(0x1c0)](_0x5aa7b2=>_0x5aa7b2['enabled']!==![])[_0x478f6d(0x8ff)](_0x4ec689=>_0x4ec689[_0x478f6d(0xede)])[_0x478f6d(0x121a)]('\x0a'));}}const _0x4ece5d=_0x4f37cc[_0x478f6d(0xb07)][_0x478f6d(0x200)](-_0x127404);return _0x11d842+=_0x4ece5d['map'](_0x12a125=>{const _0x31534c=_0x478f6d;if(typeof _0x12a125[_0x31534c(0xede)]===_0x31534c(0x273))return _0x12a125[_0x31534c(0xede)];if(Array['isArray'](_0x12a125[_0x31534c(0xede)]))return _0x12a125[_0x31534c(0xede)][_0x31534c(0x8ff)](_0xf2c253=>_0xf2c253[_0x31534c(0x9ea)])[_0x31534c(0x121a)]('\x20');return'';})[_0x478f6d(0x121a)]('\x0a'),_0x180f9c(_0x11d842);}const _0x295a1f=_0x34e9ed(async()=>{const _0xf616e4=_0x3ce1fb,_0x1f9b90=document['getElementById'](_0xf616e4(0x4f3));if(!_0x1f9b90)return;_0x1f9b90['innerHTML']=_0xf616e4(0x15c1);try{const _0x529f6b=await _0x4553ee();_0x1f9b90[_0xf616e4(0xb6f)]=_0xf616e4(0x12e4)+_0x529f6b+_0xf616e4(0x833);}catch(_0x55a2ac){console['error'](_0xf616e4(0x7be),_0x55a2ac),_0x1f9b90[_0xf616e4(0xb6f)]=_0xf616e4(0x93b);}},0x12c);async function _0x20cf53(){const _0x2f9358=_0x3ce1fb,_0x3db04b=document[_0x2f9358(0x948)](_0x2f9358(0xe32));_0x3db04b[_0x2f9358(0xb6f)]='',_0x223e34=[],_0x9958a6=0x0,_0x112ac2=![];const _0x503895=[];try{const _0x2b45d6=await _0x6ed281[_0x2f9358(0x1474)][_0x2f9358(0x443)]();for(const _0x41bdb9 of _0x2b45d6){_0x41bdb9['history']&&_0x41bdb9['history'][_0x2f9358(0xaf9)]>0x0&&_0x41bdb9[_0x2f9358(0xb07)]['forEach'](_0x945fb9=>{const _0x13eecc=_0x2f9358;_0x945fb9[_0x13eecc(0x4ae)]===_0x13eecc(0x1141)&&_0x945fb9[_0x13eecc(0x15b8)]&&_0x503895[_0x13eecc(0x1001)]({'sourceType':_0x13eecc(0xdd2),'imageUrl':_0x945fb9[_0x13eecc(0x15b8)],'prompt':_0x945fb9[_0x13eecc(0xc4b)]||_0x945fb9[_0x13eecc(0xb54)]||_0x13eecc(0x390),'chatId':_0x41bdb9['id'],'msgTimestamp':_0x945fb9[_0x13eecc(0xb0a)]});});}}catch(_0x505cb1){console['error'](_0x2f9358(0x11d6),_0x505cb1);}try{const _0x1ff185=await _0x6ed281[_0x2f9358(0xed1)][_0x2f9358(0x443)]();_0x1ff185[_0x2f9358(0x427)](_0x2780a5=>{const _0x3d59ea=_0x2f9358;if(_0x2780a5[_0x3d59ea(0x4ae)]===_0x3d59ea(0x1141)){const _0x5ad26f=_0x2780a5[_0x3d59ea(0x159b)]||(_0x2780a5[_0x3d59ea(0x15b8)]?[_0x2780a5['imageUrl']]:[]),_0x3815ee=Array[_0x3d59ea(0x1524)](_0x2780a5[_0x3d59ea(0xc4b)])?_0x2780a5[_0x3d59ea(0xc4b)]:[_0x2780a5[_0x3d59ea(0xc4b)]||_0x3d59ea(0x390)];_0x5ad26f['forEach']((_0x3923dc,_0x5db13c)=>{const _0x220173=_0x3d59ea;_0x503895[_0x220173(0x1001)]({'sourceType':_0x220173(0x1119),'imageUrl':_0x3923dc,'prompt':_0x3815ee[_0x5db13c]||_0x3815ee[0x0],'postId':_0x2780a5['id'],'imageIndex':_0x5db13c});});}});}catch(_0x2caeb0){console[_0x2f9358(0xc3e)](_0x2f9358(0xbed),_0x2caeb0);}_0x223e34=_0x503895[_0x2f9358(0xe96)]((_0x889772,_0x3b2f3b)=>(_0x3b2f3b['msgTimestamp']||_0x3b2f3b['postId']||0x0)-(_0x889772[_0x2f9358(0x46b)]||_0x889772[_0x2f9358(0xba5)]||0x0)),_0x223e34[_0x2f9358(0xaf9)]===0x0?_0x3db04b[_0x2f9358(0xb6f)]=_0x2f9358(0x91b):_0x3b0a60(),document[_0x2f9358(0x948)](_0x2f9358(0x911))[_0x2f9358(0xd54)]['add']('visible');}function _0x3839af(_0x3a291a){const _0x9c4109=_0x3ce1fb,_0x58c79d=document[_0x9c4109(0x948)]('nai-gallery-grid');if(_0x3a291a[_0x9c4109(0xaf9)]===0x0&&_0x9958a6===0x0){_0x58c79d['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x22>画廊还是空的，快去生成一些图片吧！</p>';return;}const _0x4f0bcb=document['createDocumentFragment']();_0x3a291a[_0x9c4109(0x427)]((_0x3bb5e6,_0x2a3268)=>{const _0x183671=_0x9c4109,_0x2752b5=document['createElement'](_0x183671(0x379));_0x2752b5['className']=_0x183671(0xeec),_0x2752b5[_0x183671(0xb03)]=_0x3bb5e6[_0x183671(0xc4b)];const _0x49188f=_0x3bb5e6[_0x183671(0x1504)]+'_'+(_0x3bb5e6[_0x183671(0x1029)]||_0x3bb5e6[_0x183671(0xba5)])+'_'+(_0x3bb5e6[_0x183671(0x46b)]||_0x3bb5e6[_0x183671(0xc0c)]);_0x2752b5[_0x183671(0x606)][_0x183671(0x1212)]=_0x49188f,_0x2752b5['dataset'][_0x183671(0x15b8)]=_0x3bb5e6['imageUrl'],_0x2752b5[_0x183671(0x606)][_0x183671(0xc4b)]=_0x3bb5e6[_0x183671(0xc4b)],_0x2752b5[_0x183671(0xb6f)]=_0x183671(0x964)+_0x3bb5e6[_0x183671(0x15b8)]+_0x183671(0x94a)+_0x3bb5e6[_0x183671(0xc4b)]+_0x183671(0x10df),_0x4f0bcb[_0x183671(0x6b6)](_0x2752b5);}),_0x58c79d[_0x9c4109(0x6b6)](_0x4f0bcb);}async function _0x3b0a60(){const _0x453d19=_0x3ce1fb;if(_0x112ac2||_0x9958a6>=_0x223e34[_0x453d19(0xaf9)])return;_0x112ac2=!![];const _0xa46d51=document[_0x453d19(0x948)](_0x453d19(0xe32));_0x2176e3(_0xa46d51,_0x453d19(0x5eb)),setTimeout(()=>{const _0x1f1f9d=_0x453d19,_0x45cf17=_0x223e34[_0x1f1f9d(0x200)](_0x9958a6,_0x9958a6+_0x4b9043);_0x3c826e(_0xa46d51),_0x45cf17[_0x1f1f9d(0xaf9)]>0x0&&(_0x3839af(_0x45cf17),_0x9958a6+=_0x45cf17[_0x1f1f9d(0xaf9)]),_0x112ac2=![];},0x1f4);}function _0x465bdd(){const _0x3569ad=_0x3ce1fb;_0x471857=!_0x471857;const _0x10161f=document[_0x3569ad(0x948)](_0x3569ad(0xe32)),_0x2bac88=document[_0x3569ad(0x948)]('manage-nai-gallery-btn'),_0x314a1d=document[_0x3569ad(0x948)](_0x3569ad(0xa03)),_0x448651=document[_0x3569ad(0x948)]('select-all-nai-gallery-checkbox');_0x10161f[_0x3569ad(0xd54)][_0x3569ad(0x69d)](_0x3569ad(0x59d),_0x471857),_0x471857?(_0x2bac88[_0x3569ad(0x10cb)]='完成',_0x314a1d[_0x3569ad(0xf74)][_0x3569ad(0x11fd)]=_0x3569ad(0x6a4),_0x5b3f5a['clear'](),_0x448651[_0x3569ad(0x210)]=![],_0x6926b4()):(_0x2bac88[_0x3569ad(0x10cb)]='管理',_0x314a1d['style'][_0x3569ad(0x11fd)]=_0x3569ad(0x12fe),_0x10161f[_0x3569ad(0x1188)](_0x3569ad(0xf5b))['forEach'](_0x3bafa4=>_0x3bafa4[_0x3569ad(0xd54)][_0x3569ad(0xf89)](_0x3569ad(0xd56))));}function _0x6926b4(){const _0x4585f8=_0x3ce1fb,_0x2a1ef2=document[_0x4585f8(0x948)](_0x4585f8(0x408)),_0x34bfdb=document['getElementById'](_0x4585f8(0x12b0)),_0x477620=_0x5b3f5a['size'];if(_0x2a1ef2)_0x2a1ef2[_0x4585f8(0x10cb)]=_0x4585f8(0xf9b)+_0x477620+')';if(_0x34bfdb)_0x34bfdb[_0x4585f8(0x10cb)]=_0x4585f8(0x360)+_0x477620+')';}function _0x12e3da(_0x55a7a3){const _0x55c36e=_0x3ce1fb,_0x2cfdd4=_0x55a7a3[_0x55c36e(0xa50)][_0x55c36e(0x1090)](_0x55c36e(0xf69));if(!_0x2cfdd4)return;const _0x41d3b1=_0x2cfdd4['dataset'][_0x55c36e(0x1212)],_0x8f54bd=_0x2cfdd4[_0x55c36e(0x606)][_0x55c36e(0x15b8)],_0x15e8f4=_0x2cfdd4[_0x55c36e(0x606)][_0x55c36e(0xc4b)];if(_0x55a7a3[_0x55c36e(0xa50)][_0x55c36e(0x1090)](_0x55c36e(0x113e))){_0x55a7a3[_0x55c36e(0x221)](),_0x3f4077(_0x8f54bd,_0x15e8f4);return;}if(_0x55a7a3['target'][_0x55c36e(0x1090)](_0x55c36e(0xcce))){_0x55a7a3[_0x55c36e(0x221)](),_0x50b975(new Set([_0x41d3b1]));return;}if(_0x471857)_0x2cfdd4[_0x55c36e(0xd54)][_0x55c36e(0x69d)](_0x55c36e(0xd56)),_0x5b3f5a[_0x55c36e(0xda1)](_0x41d3b1)?_0x5b3f5a[_0x55c36e(0x869)](_0x41d3b1):_0x5b3f5a['add'](_0x41d3b1),_0x6926b4();else{const _0x455586=_0x55c36e(0x11b4),_0x619363='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x8f54bd+'\x22\x20style=\x22max-width:\x20100%;\x20border-radius:\x208px;\x20box-shadow:\x200\x204px\x2010px\x20rgba(0,0,0,0.1);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x104485(_0x455586,_0x619363);}}async function _0x4910d5(){const _0x1dcb7a=_0x3ce1fb,_0x25a919=_0x5b3f5a;if(_0x25a919[_0x1dcb7a(0x8ca)]===0x0){alert(_0x1dcb7a(0x1532));return;}if(typeof JSZip===_0x1dcb7a(0x490)||!window[_0x1dcb7a(0xe4c)]){await _0x104485(_0x1dcb7a(0x13dd),_0x1dcb7a(0x3bf));return;}await _0x104485(_0x1dcb7a(0x960),'正在准备\x20'+_0x25a919[_0x1dcb7a(0x8ca)]+_0x1dcb7a(0x8d3));const _0x160ff3=new JSZip();let _0x5f06d1=0x0;const _0x599176=[],_0x34cbe5=Array[_0x1dcb7a(0x6e5)](_0x25a919);_0x34cbe5['forEach']((_0x4c8a51,_0x1ba75e)=>{const _0x25d41d=_0x1dcb7a,_0x141422=document[_0x25d41d(0xfeb)](_0x25d41d(0x4f5)+_0x4c8a51+'\x22]');if(!_0x141422)return;const _0x1542ab=_0x141422[_0x25d41d(0x606)][_0x25d41d(0x15b8)],_0x2da047=_0x141422[_0x25d41d(0x606)][_0x25d41d(0xc4b)],_0x2e4eab=_0x31bd44(_0x2da047),_0x1bad8c=_0x2e4eab['replace'](/\.png$/,'_('+(_0x1ba75e+0x1)+_0x25d41d(0x1481)),_0x415768=((async()=>{const _0x5ceac4=_0x25d41d;try{let _0x37d3c2;if(_0x1542ab[_0x5ceac4(0x157f)](_0x5ceac4(0x1b3))){const _0x597c28=await fetch(_0x1542ab);_0x37d3c2=await _0x597c28[_0x5ceac4(0x250)]();}else{let _0x49db5f;try{_0x49db5f=await fetch(_0x1542ab,{'mode':_0x5ceac4(0x5d1)});if(!_0x49db5f['ok'])throw new Error(_0x5ceac4(0xe5e));}catch(_0x85970c){console[_0x5ceac4(0x9c1)](_0x5ceac4(0x1400),_0x85970c[_0x5ceac4(0x74b)]);const _0x2b849f=_0x186764();let _0x47b02e=_0x2b849f['cors_proxy']===_0x5ceac4(0x1310)?_0x2b849f[_0x5ceac4(0xbb4)]:_0x2b849f[_0x5ceac4(0x3ed)];if(!_0x47b02e||_0x47b02e==='')_0x47b02e=_0x5ceac4(0x1123);const _0x4509a3=_0x47b02e+encodeURIComponent(_0x1542ab);_0x49db5f=await fetch(_0x4509a3);}if(!_0x49db5f['ok'])throw new Error(_0x5ceac4(0x9a7)+_0x49db5f[_0x5ceac4(0x82c)]);_0x37d3c2=await _0x49db5f[_0x5ceac4(0x250)]();}_0x160ff3[_0x5ceac4(0x96f)](_0x1bad8c,_0x37d3c2,{'binary':!![]});}catch(_0x39cd7d){console['error'](_0x5ceac4(0x2df)+_0x1542ab,_0x39cd7d),_0x5f06d1++;}})());_0x599176[_0x25d41d(0x1001)](_0x415768);}),await Promise[_0x1dcb7a(0xd49)](_0x599176);if(_0x5f06d1===_0x25a919[_0x1dcb7a(0x8ca)]){await _0x104485(_0x1dcb7a(0x13dd),_0x1dcb7a(0x3fb));return;}await _0x104485(_0x1dcb7a(0x1453),'所有图片已准备就绪，正在流式压缩...\x20下载将自动开始。');try{const _0x5c2f59=streamSaver['createWriteStream'](_0x1dcb7a(0x12d5)+Date[_0x1dcb7a(0x1386)]()+_0x1dcb7a(0x1361)),_0x3d0faa=_0x160ff3[_0x1dcb7a(0xccb)]({'type':_0x1dcb7a(0x250),'streamFiles':!![]}),_0x48a693=new ReadableStream({'start'(_0x5db097){const _0x18781d=_0x1dcb7a;_0x3d0faa['on']('data',_0x1ec419=>{_0x5db097['enqueue'](_0x1ec419);})['on'](_0x18781d(0xef4),()=>{const _0x2da6dc=_0x18781d;console['log'](_0x2da6dc(0x7ac)),_0x5db097[_0x2da6dc(0x15ca)]();})['on'](_0x18781d(0xc3e),_0x398e4e=>{const _0x4ab0f0=_0x18781d;console[_0x4ab0f0(0xc3e)](_0x4ab0f0(0x7a3),_0x398e4e),_0x5db097['error'](_0x398e4e);})[_0x18781d(0x1023)]();}});await _0x48a693[_0x1dcb7a(0x32f)](_0x5c2f59),_0x5f06d1>0x0&&_0x104485(_0x1dcb7a(0x1296),_0x1dcb7a(0x1240)+(_0x25a919['size']-_0x5f06d1)+_0x1dcb7a(0x5da)+_0x5f06d1+_0x1dcb7a(0x1b2));}catch(_0xfc2584){console[_0x1dcb7a(0xc3e)]('流式下载ZIP失败:',_0xfc2584),await _0x104485('流式下载失败',_0x1dcb7a(0x89d)+_0xfc2584[_0x1dcb7a(0x74b)]);}}async function _0x50b975(_0x533e5a=null){const _0x13b389=_0x3ce1fb,_0x12a2bf=_0x533e5a||_0x5b3f5a;if(_0x12a2bf['size']===0x0)return;const _0xe5edac=await _0xa6b74a(_0x13b389(0x8ed),'确定要从【聊天记录和动态】中永久删除这\x20'+_0x12a2bf[_0x13b389(0x8ca)]+_0x13b389(0x3b5),{'confirmButtonClass':_0x13b389(0x5e8)});if(!_0xe5edac)return;await _0x104485(_0x13b389(0x960),'正在执行删除操作...');let _0x458e24=0x0;const _0x1e0db3=new Map(),_0xc4a6cd=new Set(),_0x304405=new Map(),_0x417b46=new Set();for(const _0x549a0c of _0x12a2bf){if(_0x549a0c[_0x13b389(0x157f)](_0x13b389(0x56e))){const _0x2fc9d2=_0x549a0c[_0x13b389(0x46f)]('_'),_0x22d5c1=parseInt(_0x2fc9d2[0x1]);!isNaN(_0x22d5c1)&&_0x417b46[_0x13b389(0xbd0)](_0x22d5c1);}}const _0x373a10=new Map();if(_0x417b46[_0x13b389(0x8ca)]>0x0){const _0x108431=await _0x6ed281['qzonePosts'][_0x13b389(0x1117)]('id')[_0x13b389(0x54e)](Array['from'](_0x417b46))['toArray']();_0x108431[_0x13b389(0x427)](_0x266757=>_0x373a10['set'](_0x266757['id'],_0x266757));}for(const _0x2f4738 of _0x12a2bf){const _0x378ae=_0x2f4738[_0x13b389(0x46f)]('_');if(_0x378ae['length']<0x3){console['warn'](_0x13b389(0xf9a),_0x2f4738);continue;}const _0x24b0b6=_0x378ae[0x0],_0x39ce4c=_0x378ae[_0x13b389(0x1147)](),_0x15bd13=_0x378ae[_0x13b389(0x200)](0x1)[_0x13b389(0x121a)]('_');if(_0x24b0b6===_0x13b389(0xdd2)){const _0x41bcae=_0x15bd13,_0x259845=parseInt(_0x39ce4c);if(!_0x1e0db3[_0x13b389(0xda1)](_0x41bcae)){const _0x22c3a5=await _0x6ed281[_0x13b389(0x1474)][_0x13b389(0xe8c)](_0x41bcae);if(_0x22c3a5)_0x1e0db3['set'](_0x41bcae,_0x22c3a5);else{console['warn'](_0x13b389(0x13da)+_0x41bcae+'，跳过...');continue;}}const _0x111323=_0x1e0db3['get'](_0x41bcae);if(_0x111323&&_0x111323['history']){const _0x116339=_0x111323[_0x13b389(0xb07)]['length'];_0x111323[_0x13b389(0xb07)]=_0x111323[_0x13b389(0xb07)][_0x13b389(0x1c0)](_0x1768e3=>_0x1768e3[_0x13b389(0xb0a)]!==_0x259845),_0x111323[_0x13b389(0xb07)][_0x13b389(0xaf9)]<_0x116339&&(_0x458e24++,_0x1e0db3[_0x13b389(0x450)](_0x41bcae,_0x111323));}}else{if(_0x24b0b6==='qzone'){const _0x54a047=parseInt(_0x15bd13),_0x472000=parseInt(_0x39ce4c),_0x41d5e9=_0x304405[_0x13b389(0xe8c)](_0x54a047)||_0x373a10[_0x13b389(0xe8c)](_0x54a047);if(!_0x41d5e9){console[_0x13b389(0x9c1)](_0x13b389(0x6ce)+_0x54a047+_0x13b389(0x1190));continue;}const _0x4c1acb=_0x41d5e9[_0x13b389(0x159b)]||(_0x41d5e9[_0x13b389(0x15b8)]?[_0x41d5e9[_0x13b389(0x15b8)]]:[]);if(_0x4c1acb[_0x13b389(0xaf9)]<=0x1)_0xc4a6cd[_0x13b389(0xbd0)](_0x54a047),_0x304405['has'](_0x54a047)&&_0x304405['delete'](_0x54a047);else{const _0x28b734=_0x4c1acb[_0x472000];_0x41d5e9[_0x13b389(0x159b)]=_0x41d5e9[_0x13b389(0x159b)][_0x13b389(0x1c0)](_0x5ac15f=>_0x5ac15f!==_0x28b734),_0x41d5e9[_0x13b389(0xc4b)]&&Array[_0x13b389(0x1524)](_0x41d5e9['prompt'])&&_0x41d5e9['prompt'][_0x472000]&&_0x41d5e9['prompt'][_0x13b389(0x36d)](_0x472000,0x1),_0x41d5e9[_0x13b389(0x15b8)]=_0x41d5e9[_0x13b389(0x159b)][0x0]||null,_0x304405[_0x13b389(0x450)](_0x54a047,_0x41d5e9);}_0x458e24++;}}}try{await _0x6ed281[_0x13b389(0x670)]('rw',_0x6ed281[_0x13b389(0x1474)],_0x6ed281[_0x13b389(0xed1)],async()=>{const _0x31212f=_0x13b389;_0x1e0db3['size']>0x0&&await _0x6ed281[_0x31212f(0x1474)][_0x31212f(0xad6)](Array[_0x31212f(0x6e5)](_0x1e0db3[_0x31212f(0x1166)]())),_0x304405[_0x31212f(0x8ca)]>0x0&&await _0x6ed281[_0x31212f(0xed1)]['bulkPut'](Array[_0x31212f(0x6e5)](_0x304405[_0x31212f(0x1166)]())),_0xc4a6cd[_0x31212f(0x8ca)]>0x0&&await _0x6ed281[_0x31212f(0xed1)][_0x31212f(0xd5d)](Array[_0x31212f(0x6e5)](_0xc4a6cd));}),_0x465bdd(),await _0x20cf53(),await _0x104485(_0x13b389(0x111a),_0x13b389(0x70d)+_0x458e24+_0x13b389(0x1ca)),document[_0x13b389(0x948)]('chat-interface-screen')[_0x13b389(0xd54)]['contains'](_0x13b389(0x115e))&&_0x455873(_0x16699d[_0x13b389(0xf5a)]),document[_0x13b389(0x948)](_0x13b389(0x442))[_0x13b389(0xd54)][_0x13b389(0x7a0)](_0x13b389(0x115e))&&_0x4d3afb();}catch(_0x32b417){console[_0x13b389(0xc3e)](_0x13b389(0x7dd),_0x32b417),await _0x104485('删除失败',_0x13b389(0x689)+_0x32b417['message']);}}function _0x31bd44(_0x1d0219){const _0x5056e9=_0x3ce1fb,_0x1c667c=_0x1d0219||_0x5056e9(0x13d7);let _0x275e34=_0x1c667c[_0x5056e9(0x14e9)](/[^a-zA-Z0-9\u4e00-\u9fa5\s]/g,'_')[_0x5056e9(0x14e9)](/\s+/g,'_')[_0x5056e9(0xeca)](0x0,0x1e);!_0x275e34&&(_0x275e34=_0x5056e9(0x13d7));const _0x5a8412=new Date()[_0x5056e9(0x5ac)]()['replace'](/[-:]/g,'')[_0x5056e9(0x14e9)]('T','_')[_0x5056e9(0x46f)]('.')[0x0];return _0x275e34+'_'+_0x5a8412+'.png';}async function _0x27ba40(){const _0x25f7e9=_0x3ce1fb;initLanguage();async function _0x3f6e62(_0x496081){const _0x55085d=_0x6c9e;if(!_0x496081)return;try{const _0x2ae1bb=await _0x496081[_0x55085d(0x9ea)](),_0x500738=JSON[_0x55085d(0xde0)](_0x2ae1bb);if(_0x500738[_0x55085d(0x4ae)]===_0x55085d(0xcd8))console[_0x55085d(0x498)](_0x55085d(0xfbc)),await _0x3bbdf3(_0x500738);else{if(_0x500738[_0x55085d(0x6ea)]&&typeof _0x500738[_0x55085d(0x6ea)]===_0x55085d(0xd43))console[_0x55085d(0x498)](_0x55085d(0x41a)),await _0x1e5ced(_0x500738,_0x496081[_0x55085d(0x1467)]);else throw new Error(_0x55085d(0x1290));}}catch(_0x2e3997){console[_0x55085d(0xc3e)](_0x55085d(0x264),_0x2e3997),await _0x104485(_0x55085d(0xd89),'文件解析或应用失败:\x20'+_0x2e3997[_0x55085d(0x74b)]);}}async function _0x1e5ced(_0x29bdda,_0x451ed6){const _0x3efdaa=_0x6c9e,_0x5e5041=_0x451ed6[_0x3efdaa(0x14e9)](/\.json$/i,''),_0x2d0f8f=await _0x41b9fc(_0x3efdaa(0x9af),_0x3efdaa(0x506),_0x5e5041);if(!_0x2d0f8f||!_0x2d0f8f['trim']()){alert(_0x3efdaa(0x14bf));return;}const _0x2195ce=Object[_0x3efdaa(0x1166)](_0x29bdda[_0x3efdaa(0x6ea)])[_0x3efdaa(0x8ff)](_0xda3432=>{const _0x130686=_0x3efdaa;return{'keys':_0xda3432[_0x130686(0x1212)]||[],'comment':_0xda3432[_0x130686(0x282)]||_0x130686(0xae0),'content':_0xda3432[_0x130686(0xede)]||'','enabled':!_0xda3432[_0x130686(0xb73)]};})[_0x3efdaa(0x1c0)](_0x18022b=>_0x18022b['content']);if(_0x2195ce[_0x3efdaa(0xaf9)]===0x0){alert('这个\x20Tavern\x20AI\x20世界书中没有找到任何有效的条目。');return;}const _0x4b301f={'id':_0x3efdaa(0x8e1)+Date['now'](),'name':_0x2d0f8f['trim'](),'content':_0x2195ce,'categoryId':null};await _0x6ed281['worldBooks']['add'](_0x4b301f),_0x16699d['worldBooks'][_0x3efdaa(0x1001)](_0x4b301f),await _0x1c33bd(),await _0x104485(_0x3efdaa(0x12ef),_0x3efdaa(0x281)+_0x2d0f8f+'》。');}async function _0x5add81(){const _0x95dca2=_0x6c9e;try{const _0x4484cf=await _0x6ed281[_0x95dca2(0x44c)][_0x95dca2(0x443)](),_0x4c2300=await _0x6ed281[_0x95dca2(0x81c)][_0x95dca2(0x443)]();if(_0x4484cf['length']===0x0&&_0x4c2300[_0x95dca2(0xaf9)]===0x0){alert(_0x95dca2(0x615));return;}const _0x50e84f={'type':'EPhoneWorldBookBackup','version':0x1,'timestamp':Date[_0x95dca2(0x1386)](),'books':_0x4484cf,'categories':_0x4c2300},_0x22f081=new Blob([JSON['stringify'](_0x50e84f,null,0x2)],{'type':_0x95dca2(0x479)}),_0x3adbc2=URL['createObjectURL'](_0x22f081),_0xf1ca9e=document[_0x95dca2(0x1497)]('a');_0xf1ca9e[_0x95dca2(0x13a6)]=_0x3adbc2,_0xf1ca9e[_0x95dca2(0xf4c)]=_0x95dca2(0x647)+new Date()[_0x95dca2(0x5ac)]()[_0x95dca2(0x46f)]('T')[0x0]+_0x95dca2(0x9ce),_0xf1ca9e['click'](),URL['revokeObjectURL'](_0x3adbc2),await _0x104485('导出成功',_0x95dca2(0xf86));}catch(_0x4aff78){console[_0x95dca2(0xc3e)]('导出世界书时出错:',_0x4aff78),await _0x104485(_0x95dca2(0x10d5),_0x95dca2(0x1345)+_0x4aff78[_0x95dca2(0x74b)]);}}async function _0x3bbdf3(_0x2a5a86){const _0x3784d0=_0x6c9e;try{if(_0x2a5a86[_0x3784d0(0x4ae)]!==_0x3784d0(0xcd8)||!_0x2a5a86['books'])throw new Error(_0x3784d0(0xa57));const _0x43c0e7=await _0xa6b74a(_0x3784d0(0xd59),_0x3784d0(0x641),{'confirmButtonClass':'btn-danger','confirmText':_0x3784d0(0x37f)});if(!_0x43c0e7)return;await _0x6ed281[_0x3784d0(0x670)]('rw',_0x6ed281[_0x3784d0(0x44c)],_0x6ed281['worldBookCategories'],async()=>{const _0x1c0b4a=_0x3784d0;await _0x6ed281['worldBooks'][_0x1c0b4a(0x99d)](),await _0x6ed281['worldBookCategories']['clear'](),Array[_0x1c0b4a(0x1524)](_0x2a5a86[_0x1c0b4a(0x1420)])&&await _0x6ed281[_0x1c0b4a(0x44c)][_0x1c0b4a(0xad6)](_0x2a5a86[_0x1c0b4a(0x1420)]),Array[_0x1c0b4a(0x1524)](_0x2a5a86[_0x1c0b4a(0xb39)])&&await _0x6ed281[_0x1c0b4a(0x81c)][_0x1c0b4a(0xad6)](_0x2a5a86[_0x1c0b4a(0xb39)]);}),_0x16699d[_0x3784d0(0x44c)]=await _0x6ed281[_0x3784d0(0x44c)][_0x3784d0(0x443)](),await _0x1c33bd(),await _0x104485(_0x3784d0(0x5c6),_0x3784d0(0xa35));}catch(_0x3677e8){console[_0x3784d0(0xc3e)](_0x3784d0(0x264),_0x3677e8),await _0x104485(_0x3784d0(0xd89),_0x3784d0(0xc4c)+_0x3677e8[_0x3784d0(0x74b)]);}}const _0x5c06e1=localStorage['getItem'](_0x25f7e9(0xabd));if(_0x5c06e1){const _0x3384f7=(Date['now']()-parseInt(_0x5c06e1))/(0x3e8*0x3c);_0x3384f7>0x5&&_0x109b74(_0x3384f7);}_0x96da1(),window[_0x25f7e9(0xd7c)]=_0x58c3b1,window[_0x25f7e9(0x981)]=_0x350b5d,window[_0x25f7e9(0x6d5)]=_0x5de7ac,window['openCharacterSelector']=_0x1b1457,window[_0x25f7e9(0x8a0)]=_0x3280d9,window[_0x25f7e9(0x3d4)]=_0x113b34,window['openCharWallet']=_0x33ba37,window[_0x25f7e9(0xc8d)]=_0x3ebb67,window[_0x25f7e9(0xc12)]=_0x3330d7;const _0x43ef93=document['createElement'](_0x25f7e9(0x379));_0x43ef93['id']='sticker-action-bar',_0x43ef93['innerHTML']=_0x25f7e9(0x15ae),document['getElementById'](_0x25f7e9(0x95a))[_0x25f7e9(0x6b6)](_0x43ef93);const _0x501abf=document[_0x25f7e9(0x1497)](_0x25f7e9(0xf74));_0x501abf['id']=_0x25f7e9(0x55a),document[_0x25f7e9(0x1441)][_0x25f7e9(0x6b6)](_0x501abf),_0x17a241[_0x25f7e9(0x1363)]=document[_0x25f7e9(0x948)](_0x25f7e9(0xa4d)),_0x17a241[_0x25f7e9(0xb9b)]=document[_0x25f7e9(0x948)](_0x25f7e9(0x502));const _0x4613af=localStorage['getItem'](_0x25f7e9(0x1304))||'light';_0x5afcab(_0x4613af);const _0x15f6c0=document[_0x25f7e9(0x1497)](_0x25f7e9(0xf74));_0x15f6c0['id']=_0x25f7e9(0x12f0),document[_0x25f7e9(0x1441)][_0x25f7e9(0x6b6)](_0x15f6c0);const _0x1cbe05=document[_0x25f7e9(0x1497)](_0x25f7e9(0xf74));_0x1cbe05['id']=_0x25f7e9(0x28e),document['head'][_0x25f7e9(0x6b6)](_0x1cbe05),_0x33b8de('','#chat-messages',_0x25f7e9(0x12f0)),_0x33b8de('',_0x25f7e9(0x2db),_0x25f7e9(0x28e)),window['openRenderingRulesScreen']=_0x350b5d,window[_0x25f7e9(0xd7c)]=_0x58c3b1,window[_0x25f7e9(0x9ad)]=_0x2d33eb,window[_0x25f7e9(0x102b)]=_0x587299,window[_0x25f7e9(0x6a2)]=_0xf9cd0e,window[_0x25f7e9(0x1151)]=_0x1c33bd,await _0x315636(),_0x162fdb(),_0xefda29(_0x16699d[_0x25f7e9(0xf9c)][_0x25f7e9(0x393)]),_0x228284(_0x16699d['globalSettings'][_0x25f7e9(0xdeb)]),await _0x4885eb(),_0x5e5902(_0x16699d[_0x25f7e9(0xf9c)]['globalCss']);const _0x368a36=parseInt(localStorage[_0x25f7e9(0x55f)](_0x25f7e9(0x8b4)))||0x0;_0x255639(_0x368a36);_0x16699d[_0x25f7e9(0xf9c)]&&_0x16699d[_0x25f7e9(0xf9c)][_0x25f7e9(0x672)]&&_0x495393(_0x16699d[_0x25f7e9(0xf9c)][_0x25f7e9(0x672)]);_0x485fad(),setInterval(_0x485fad,0x3e8*0x1e),_0x364bb1(),_0x25eeee(),_0x1c8fc4(),_0x442c65(),document[_0x25f7e9(0x948)](_0x25f7e9(0xf7f))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x1fb102=>{const _0x76b092=_0x25f7e9;_0x1fb102[_0x76b092(0xa50)]['classList'][_0x76b092(0x7a0)](_0x76b092(0x112f))&&_0x52f2b0(_0x1fb102[_0x76b092(0xa50)][_0x76b092(0x606)]['categoryId']);}),document[_0x25f7e9(0x948)](_0x25f7e9(0xd17))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>_0x1a0360(null)),document['getElementById'](_0x25f7e9(0x155f))[_0x25f7e9(0x339)]('click',()=>{const _0x6d1bb9=_0x25f7e9;document[_0x6d1bb9(0x948)]('rule-editor-modal')[_0x6d1bb9(0xd54)][_0x6d1bb9(0xf89)](_0x6d1bb9(0xfcb));}),document[_0x25f7e9(0x948)](_0x25f7e9(0xf8b))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x5641a1),document[_0x25f7e9(0x948)](_0x25f7e9(0x659))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x305f8d=_0x25f7e9;if(_0x16699d[_0x305f8d(0xf5a)]&&!_0x16699d['chats'][_0x16699d['activeChatId']][_0x305f8d(0x1173)]){const _0x279880=_0x16699d['chats'][_0x16699d[_0x305f8d(0xf5a)]];_0x528d61(_0x279880['id'],_0x279880[_0x305f8d(0x628)]);}});let _0x124768=null;function _0xb1f951(_0x29168f){const _0x3c5118=_0x25f7e9;_0x124768=_0x29168f;const _0x5fb370=_0x16699d[_0x3c5118(0x1474)][_0x16699d[_0x3c5118(0xf5a)]],_0x260622=_0x5fb370[_0x3c5118(0x1455)]['find'](_0x33ffcb=>_0x33ffcb['id']===_0x29168f);if(!_0x260622)return;const _0x49912f=document[_0x3c5118(0x948)](_0x3c5118(0x7f5));_0x49912f[_0x3c5118(0x10cb)]=_0x260622[_0x3c5118(0x13a9)]?_0x3c5118(0xc34):_0x3c5118(0xae2),document[_0x3c5118(0x948)](_0x3c5118(0xca1))[_0x3c5118(0xd54)][_0x3c5118(0xbd0)](_0x3c5118(0xfcb));}async function _0x236e62(){const _0x1a1e61=_0x25f7e9;if(!_0x124768)return;const _0x4010d7=_0x16699d[_0x1a1e61(0x1474)][_0x16699d['activeChatId']],_0x307a22=_0x4010d7[_0x1a1e61(0x1455)][_0x1a1e61(0x1402)](_0x1eb9bf=>_0x1eb9bf['id']===_0x124768);_0x307a22&&(_0x307a22[_0x1a1e61(0x13a9)]=!_0x307a22[_0x1a1e61(0x13a9)],await _0x6ed281[_0x1a1e61(0x1474)][_0x1a1e61(0x90c)](_0x4010d7),_0x3aa73c()),document['getElementById'](_0x1a1e61(0xca1))[_0x1a1e61(0xd54)][_0x1a1e61(0xf89)](_0x1a1e61(0xfcb));}async function _0x18904d(){const _0x19bd79=_0x25f7e9;if(!_0x124768)return;const _0x3490a6=await _0xa6b74a('确认删除','确定要删除这条公告吗？此操作不可恢复。',{'confirmButtonClass':_0x19bd79(0x5e8)});if(_0x3490a6){const _0x201142=_0x16699d[_0x19bd79(0x1474)][_0x16699d[_0x19bd79(0xf5a)]];_0x201142[_0x19bd79(0x1455)]=_0x201142[_0x19bd79(0x1455)][_0x19bd79(0x1c0)](_0x5dc834=>_0x5dc834['id']!==_0x124768),await _0x6ed281[_0x19bd79(0x1474)][_0x19bd79(0x90c)](_0x201142),_0x3aa73c();}document['getElementById']('announcement-actions-modal')[_0x19bd79(0xd54)][_0x19bd79(0xf89)](_0x19bd79(0xfcb));}document[_0x25f7e9(0x948)](_0x25f7e9(0xbc6))['addEventListener'](_0x25f7e9(0x4f6),_0x4d1f57),document[_0x25f7e9(0x948)](_0x25f7e9(0x7f9))[_0x25f7e9(0x339)]('click',_0x842e63=>{if(_0x842e63['target']===_0x56c4b0)_0x4d1f57();}),document[_0x25f7e9(0x948)](_0x25f7e9(0xf53))[_0x25f7e9(0x339)]('click',async()=>{const _0x48eb57=_0x25f7e9,_0x722ca1=await _0x9286bb(_0x48eb57(0x84b),[{'text':_0x48eb57(0x864),'value':'slice'},{'text':_0x48eb57(0x1505),'value':_0x48eb57(0xd47)},{'text':'传统导出\x20(兼容旧版或内存小的浏览器)','value':'blob'}]);if(_0x722ca1==='slice')_0x208819();else{if(_0x722ca1===_0x48eb57(0xd47))_0x40d17b();else _0x722ca1===_0x48eb57(0x250)&&_0x4df2e1();}}),document['getElementById'](_0x25f7e9(0x1283))[_0x25f7e9(0x339)]('click',_0x3ee3af),document[_0x25f7e9(0x948)]('offline-mode-toggle')[_0x25f7e9(0x339)](_0x25f7e9(0x145c),_0x4b32dc=>{const _0x4aab96=_0x25f7e9;document[_0x4aab96(0x948)](_0x4aab96(0x1244))[_0x4aab96(0xf74)][_0x4aab96(0x11fd)]=_0x4b32dc[_0x4aab96(0xa50)][_0x4aab96(0x210)]?_0x4aab96(0x1273):_0x4aab96(0x12fe);}),document['getElementById']('import-btn')['addEventListener']('click',()=>document[_0x25f7e9(0x948)](_0x25f7e9(0x12ba))[_0x25f7e9(0x4f6)]()),document[_0x25f7e9(0x948)](_0x25f7e9(0x676))[_0x25f7e9(0x339)]('change',_0x2a533a=>{const _0xe3d53c=_0x25f7e9;document[_0xe3d53c(0x948)](_0xe3d53c(0x49f))['style'][_0xe3d53c(0x11fd)]=_0x2a533a[_0xe3d53c(0xa50)][_0xe3d53c(0x210)]?_0xe3d53c(0x1273):'none';}),document[_0x25f7e9(0x948)]('import-data-input')[_0x25f7e9(0x339)]('change',_0x9c6690=>_0x47cdb3(_0x9c6690['target']['files'][0x0])),document[_0x25f7e9(0x948)](_0x25f7e9(0x7a1))['addEventListener'](_0x25f7e9(0x145c),_0x4482cf),document['getElementById'](_0x25f7e9(0x2b5))[_0x25f7e9(0x339)]('click',()=>{const _0x5e33c6=_0x25f7e9;_0x49a146={},_0x33b8de('',_0x5e33c6(0xb8c),_0x5e33c6(0x12f0)),_0x33b8de('',_0x5e33c6(0x2db),_0x5e33c6(0x28e)),_0x402014(),_0x16699d[_0x5e33c6(0xf5a)]=null,_0x58c3b1(_0x5e33c6(0x82a));}),document['getElementById'](_0x25f7e9(0xa05))[_0x25f7e9(0x339)]('click',async()=>{const _0x1d9df0=_0x25f7e9,_0xfa8812=await _0x9286bb(_0x1d9df0(0x6f4),[{'text':_0x1d9df0(0x13ea),'value':_0x1d9df0(0xef5)},{'text':_0x1d9df0(0x7a2),'value':_0x1d9df0(0x14a3)}]);if(_0xfa8812===_0x1d9df0(0xef5)){const _0x347b01=await _0x41b9fc(_0x1d9df0(0x15bc),'请输入你想为Ta设置的【备注名】(例如:\x20哥哥)');if(!_0x347b01||!_0x347b01[_0x1d9df0(0x2a8)]())return;const _0x836b8b=await _0x41b9fc(_0x1d9df0(0x279),'请输入Ta的【本名】(例如:\x20李星辰，这个名字将用于AI识别)');if(!_0x836b8b||!_0x836b8b['trim']())return;const _0x2e479c=_0x1d9df0(0x530)+Date[_0x1d9df0(0x1386)](),_0xf93eec={'id':_0x2e479c,'name':_0x347b01[_0x1d9df0(0x2a8)](),'originalName':_0x836b8b[_0x1d9df0(0x2a8)](),'isGroup':![],'isPinned':![],'unreadCount':0x0,'relationship':{'status':_0x1d9df0(0x1431),'blockedTimestamp':null,'applicationReason':''},'status':{'text':'在线','lastUpdate':Date[_0x1d9df0(0x1386)](),'isBusy':![]},'settings':{'aiPersona':'这是一个通过手动创建的角色。','myPersona':_0x1d9df0(0xdbd),'myNickname':'我','maxMemory':0xa,'aiAvatar':_0x202ba5,'myAvatar':_0x202ba5,'background':'','theme':'default','fontSize':0xd,'customCss':'','linkedWorldBookIds':[],'aiAvatarLibrary':[],'myAvatarLibrary':[],'enableBackgroundActivity':!![],'actionCooldownMinutes':0xf,'enableTimePerception':!![],'isOfflineMode':![],'offlineMinLength':0x64,'offlineMaxLength':0x12c,'offlinePresetId':null,'timeZone':_0x1d9df0(0xafa)},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[],'thoughtsHistory':[]};_0x16699d[_0x1d9df0(0x1474)][_0x2e479c]=_0xf93eec,await _0x6ed281[_0x1d9df0(0x1474)][_0x1d9df0(0x90c)](_0xf93eec),_0x2d33eb();}else _0xfa8812===_0x1d9df0(0x14a3)&&document[_0x1d9df0(0x948)](_0x1d9df0(0x7a1))[_0x1d9df0(0x4f6)]();}),document[_0x25f7e9(0x948)]('add-group-chat-btn')[_0x25f7e9(0x339)]('click',_0x242f37),document[_0x25f7e9(0x948)](_0x25f7e9(0x103f))[_0x25f7e9(0x339)]('click',()=>document[_0x25f7e9(0x948)](_0x25f7e9(0x1277))[_0x25f7e9(0xd54)][_0x25f7e9(0xf89)](_0x25f7e9(0xfcb))),document[_0x25f7e9(0x948)](_0x25f7e9(0xed7))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3ef53a),document[_0x25f7e9(0x948)]('listen-together-btn')['addEventListener']('click',_0x5de7ac),document[_0x25f7e9(0x948)]('music-exit-btn')['addEventListener'](_0x25f7e9(0x4f6),()=>_0x528b67(!![])),document[_0x25f7e9(0x948)](_0x25f7e9(0x515))['addEventListener'](_0x25f7e9(0x4f6),_0x3b9b37),document[_0x25f7e9(0x948)]('music-play-pause-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x169a5e),document[_0x25f7e9(0x948)]('music-next-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x58f0d),document[_0x25f7e9(0x948)](_0x25f7e9(0x556))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x540888),document[_0x25f7e9(0x948)](_0x25f7e9(0x707))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x479b9c),document[_0x25f7e9(0x948)](_0x25f7e9(0x687))['addEventListener'](_0x25f7e9(0x4f6),()=>{const _0x29dfbe=_0x25f7e9;_0x39f26c(),document[_0x29dfbe(0x948)](_0x29dfbe(0x11ac))['classList'][_0x29dfbe(0xbd0)](_0x29dfbe(0xfcb));}),document[_0x25f7e9(0x948)]('close-playlist-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>document[_0x25f7e9(0x948)](_0x25f7e9(0x11ac))['classList'][_0x25f7e9(0xf89)](_0x25f7e9(0xfcb))),document[_0x25f7e9(0x948)](_0x25f7e9(0x1f9))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x4da8cc),document[_0x25f7e9(0x948)]('add-song-local-btn')['addEventListener'](_0x25f7e9(0x4f6),()=>document[_0x25f7e9(0x948)](_0x25f7e9(0x495))[_0x25f7e9(0x4f6)]()),document[_0x25f7e9(0x948)]('local-song-upload-input')['addEventListener'](_0x25f7e9(0x145c),_0x5db7ff),document[_0x25f7e9(0x948)](_0x25f7e9(0xa06))['addEventListener'](_0x25f7e9(0x4f6),_0x4f5fc1=>{const _0x1879ed=_0x25f7e9,_0x586cf5=_0x4f5fc1[_0x1879ed(0xa50)],_0x5ecc8f=parseInt(_0x586cf5['dataset'][_0x1879ed(0xbb3)]);if(isNaN(_0x5ecc8f))return;if(_0x586cf5['classList'][_0x1879ed(0x7a0)]('album-art-btn'))_0x33da3b(_0x5ecc8f);else{if(_0x586cf5[_0x1879ed(0xd54)]['contains'](_0x1879ed(0x9f7)))_0x1866db(_0x5ecc8f);else{if(_0x586cf5['classList'][_0x1879ed(0x7a0)](_0x1879ed(0x11ea)))_0x2d0795(_0x5ecc8f);else _0x586cf5[_0x1879ed(0xd54)]['contains'](_0x1879ed(0x64a))&&_0x1062d6(_0x5ecc8f);}}}),_0x204b9a[_0x25f7e9(0x339)](_0x25f7e9(0x299),()=>{const _0x20a41e=_0x25f7e9;document[_0x20a41e(0x948)](_0x20a41e(0x97d))[_0x20a41e(0xd54)][_0x20a41e(0xf89)](_0x20a41e(0x7c9)),_0x58f0d();});const _0x1a6d3d=document[_0x25f7e9(0x948)]('chat-input');document[_0x25f7e9(0x948)](_0x25f7e9(0x145a))['addEventListener'](_0x25f7e9(0x4f6),()=>{const _0x19c1fe=_0x25f7e9;_0x302fc8();const _0x329a27=_0x1a6d3d[_0x19c1fe(0x5bc)]['trim']();if(!_0x329a27||!_0x16699d[_0x19c1fe(0xf5a)])return;const _0x2d11fa=_0x16699d[_0x19c1fe(0x1474)][_0x16699d[_0x19c1fe(0xf5a)]],_0xc00d91={'role':'user','content':_0x329a27,'timestamp':Date[_0x19c1fe(0x1386)]()};_0x1dd459&&(_0xc00d91[_0x19c1fe(0xe7f)]=_0x1dd459),_0x4b384e(_0xc00d91,_0x2d11fa),((async()=>{const _0xd8899b=_0x19c1fe;_0x2d11fa[_0xd8899b(0xb07)][_0xd8899b(0x1001)](_0xc00d91),await _0x6ed281['chats'][_0xd8899b(0x90c)](_0x2d11fa),_0x2d33eb();})()),_0x1a6d3d[_0x19c1fe(0x5bc)]='',_0x1a6d3d['style'][_0x19c1fe(0xf38)]=_0x19c1fe(0x1098),_0x1a6d3d[_0x19c1fe(0x348)](),_0x30b828();}),document['getElementById'](_0x25f7e9(0x75f))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x45c50a),_0x1a6d3d[_0x25f7e9(0x339)]('keypress',_0x162329=>{const _0x167147=_0x25f7e9;_0x162329[_0x167147(0x1212)]===_0x167147(0xc07)&&!_0x162329[_0x167147(0xb99)]&&(_0x162329[_0x167147(0x38f)](),document[_0x167147(0x948)](_0x167147(0x145a))[_0x167147(0x4f6)]());}),document[_0x25f7e9(0x948)](_0x25f7e9(0x146b))[_0x25f7e9(0x339)]('change',async _0x4b483e=>{const _0x11a4e2=_0x25f7e9,_0x14b2c1=_0x4b483e[_0x11a4e2(0xa50)][_0x11a4e2(0x10b0)][0x0];if(_0x14b2c1){const _0x10523e=await new Promise((_0x5409df,_0x5bf0e8)=>{const _0x4c6a60=_0x11a4e2,_0x31a0ec=new FileReader();_0x31a0ec[_0x4c6a60(0x33a)]=()=>_0x5409df(_0x31a0ec[_0x4c6a60(0x22a)]),_0x31a0ec[_0x4c6a60(0x12eb)]=()=>_0x5bf0e8(_0x31a0ec['error']),_0x31a0ec[_0x4c6a60(0x5a5)](_0x14b2c1);});_0x45df0e=_0x10523e,_0xf9cd0e();}}),document[_0x25f7e9(0x948)](_0x25f7e9(0x14fd))['addEventListener']('click',async()=>{const _0x1f0e5e=_0x25f7e9;_0x45df0e&&(_0x16699d[_0x1f0e5e(0xf9c)][_0x1f0e5e(0xb91)]=_0x45df0e),_0x16699d[_0x1f0e5e(0xf9c)][_0x1f0e5e(0x12fc)]=document[_0x1f0e5e(0x948)](_0x1f0e5e(0x72d))['value'][_0x1f0e5e(0x2a8)](),_0x16699d[_0x1f0e5e(0xf9c)][_0x1f0e5e(0x803)]=document[_0x1f0e5e(0x948)](_0x1f0e5e(0xd4d))[_0x1f0e5e(0x5bc)][_0x1f0e5e(0x2a8)](),_0x16699d[_0x1f0e5e(0xf9c)][_0x1f0e5e(0xc75)]=document[_0x1f0e5e(0x948)](_0x1f0e5e(0x879))[_0x1f0e5e(0x210)],_0x16699d[_0x1f0e5e(0xf9c)][_0x1f0e5e(0x393)]=document[_0x1f0e5e(0x948)](_0x1f0e5e(0xb6d))['checked'],_0x16699d[_0x1f0e5e(0xf9c)][_0x1f0e5e(0x2b7)]=document[_0x1f0e5e(0x948)](_0x1f0e5e(0x10bb))[_0x1f0e5e(0x210)],_0x16699d['globalSettings']['detachStatusBar']=document[_0x1f0e5e(0x948)](_0x1f0e5e(0x78c))['checked'],await _0x6ed281[_0x1f0e5e(0xf9c)][_0x1f0e5e(0x90c)](_0x16699d[_0x1f0e5e(0xf9c)]),_0x364bb1(),_0x471b5b(),_0x45df0e=null,_0x1c8fc4(),_0x25c96f(),_0x5e5902(_0x16699d[_0x1f0e5e(0xf9c)][_0x1f0e5e(0x12fc)]),_0x162fdb(),alert(_0x1f0e5e(0x46e)),_0x58c3b1(_0x1f0e5e(0x110d));});const _0x1913d2=document[_0x25f7e9(0x948)](_0x25f7e9(0x14d7));_0x1913d2[_0x25f7e9(0x339)](_0x25f7e9(0x1165),()=>{const {scrollTop:_0x9d1f9f,scrollHeight:_0x50b850,clientHeight:_0x1134db}=_0x1913d2;_0x50b850-_0x9d1f9f-_0x1134db<_0x1134db&&(!_0x34c5ec&&_0x2204e1());}),document[_0x25f7e9(0x948)](_0x25f7e9(0x1369))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x1837d3=_0x25f7e9;_0x16699d[_0x1837d3(0x79e)]['proxyUrl']=document[_0x1837d3(0x948)](_0x1837d3(0xba7))['value']['trim'](),_0x16699d[_0x1837d3(0x79e)][_0x1837d3(0xaa1)]=document[_0x1837d3(0x948)](_0x1837d3(0x4bc))['value']['trim'](),_0x16699d[_0x1837d3(0x79e)][_0x1837d3(0x531)]=document[_0x1837d3(0x948)](_0x1837d3(0xadc))['value'],_0x16699d[_0x1837d3(0x79e)]['minimaxGroupId']=document['getElementById']('minimax-group-id')['value'][_0x1837d3(0x2a8)](),_0x16699d[_0x1837d3(0x79e)]['minimaxApiKey']=document[_0x1837d3(0x948)](_0x1837d3(0x609))[_0x1837d3(0x5bc)]['trim'](),_0x16699d[_0x1837d3(0x79e)][_0x1837d3(0x63f)]=document['getElementById'](_0x1837d3(0x28c))[_0x1837d3(0x5bc)],_0x16699d[_0x1837d3(0x79e)][_0x1837d3(0xde5)]=document['getElementById'](_0x1837d3(0x5d4))[_0x1837d3(0x5bc)][_0x1837d3(0x2a8)](),_0x16699d['apiConfig']['secondaryApiKey']=document['getElementById'](_0x1837d3(0x733))['value']['trim'](),_0x16699d[_0x1837d3(0x79e)][_0x1837d3(0x688)]=document[_0x1837d3(0x948)]('secondary-model-select')[_0x1837d3(0x5bc)],await _0x6ed281[_0x1837d3(0x79e)][_0x1837d3(0x90c)](_0x16699d[_0x1837d3(0x79e)]);const _0x523b87=document[_0x1837d3(0x948)](_0x1837d3(0x3af)),_0x3dc486=document[_0x1837d3(0x948)](_0x1837d3(0x3e2)),_0x17b948=document[_0x1837d3(0x948)](_0x1837d3(0x5c1));_0x16699d['globalSettings']['enableBackgroundActivity']=_0x523b87[_0x1837d3(0x210)],_0x16699d['globalSettings']['backgroundActivityInterval']=parseInt(_0x3dc486[_0x1837d3(0x5bc)])||0x3c,_0x16699d['globalSettings'][_0x1837d3(0x4b1)]=parseFloat(_0x17b948[_0x1837d3(0x5bc)])||0x1,_0x16699d[_0x1837d3(0xf9c)][_0x1837d3(0xf46)]=document[_0x1837d3(0x948)](_0x1837d3(0x73b))[_0x1837d3(0x210)],_0x16699d[_0x1837d3(0xf9c)][_0x1837d3(0x59a)]=parseInt(document[_0x1837d3(0x948)](_0x1837d3(0xce9))[_0x1837d3(0x5bc)])||0x32,_0x16699d[_0x1837d3(0xf9c)][_0x1837d3(0xa58)]=parseInt(document[_0x1837d3(0x948)](_0x1837d3(0x149e))[_0x1837d3(0x5bc)])||0x1e,_0x16699d[_0x1837d3(0xf9c)]['apiTemperature']=parseFloat(document[_0x1837d3(0x948)](_0x1837d3(0x305))[_0x1837d3(0x5bc)]),await _0x6ed281[_0x1837d3(0xf9c)]['put'](_0x16699d[_0x1837d3(0xf9c)]),_0x541ad5();_0x16699d['globalSettings'][_0x1837d3(0x1028)]?(_0x356441(),console['log'](_0x1837d3(0x6ed)+_0x16699d[_0x1837d3(0xf9c)][_0x1837d3(0x996)]+'秒')):console[_0x1837d3(0x498)](_0x1837d3(0x10e2));const _0x4d23bb=document[_0x1837d3(0x948)]('novelai-switch')[_0x1837d3(0x210)],_0x226adc=document[_0x1837d3(0x948)](_0x1837d3(0xf36))[_0x1837d3(0x5bc)],_0x256412=document[_0x1837d3(0x948)](_0x1837d3(0x14ce))[_0x1837d3(0x5bc)][_0x1837d3(0x2a8)]();localStorage[_0x1837d3(0x59f)](_0x1837d3(0xe15),_0x4d23bb),localStorage[_0x1837d3(0x59f)](_0x1837d3(0xf36),_0x226adc),localStorage[_0x1837d3(0x59f)]('novelai-api-key',_0x256412),alert(_0x1837d3(0xcc4));});const _0x41db97=document[_0x25f7e9(0x948)](_0x25f7e9(0x4bc));_0x41db97[_0x25f7e9(0x339)](_0x25f7e9(0x348),_0x4da287=>{const _0xe13033=_0x25f7e9;_0x4da287[_0xe13033(0xa50)]['setAttribute'](_0xe13033(0x4ae),_0xe13033(0x9ea));}),_0x41db97[_0x25f7e9(0x339)](_0x25f7e9(0x5e7),_0x26c6f9=>{const _0x324da4=_0x25f7e9;_0x26c6f9[_0x324da4(0xa50)][_0x324da4(0x4e4)]('type','password');});async function _0x1a250a(_0x2c49aa,_0x1140dd,_0x537d21){const _0xd0d6c9=_0x25f7e9,_0x9bb557=document[_0xd0d6c9(0x948)](_0x2c49aa)[_0xd0d6c9(0x5bc)][_0xd0d6c9(0x2a8)](),_0x3b071a=document[_0xd0d6c9(0x948)](_0x1140dd)[_0xd0d6c9(0x5bc)][_0xd0d6c9(0x2a8)]();if(!_0x9bb557||!_0x3b071a)return alert(_0xd0d6c9(0x1230));try{let _0x4e3022=_0x9bb557===GEMINI_API_URL;const _0x9a70f6=await fetch(_0x4e3022?GEMINI_API_URL+_0xd0d6c9(0x951)+getRandomValue(_0x3b071a):_0x9bb557+_0xd0d6c9(0x732),_0x4e3022?undefined:{'headers':{'Authorization':'Bearer\x20'+_0x3b071a}});if(!_0x9a70f6['ok'])throw new Error(_0xd0d6c9(0x1b1));const _0x420b4e=await _0x9a70f6['json']();let _0x54fb1a=_0x4e3022?_0x420b4e[_0xd0d6c9(0x1126)][_0xd0d6c9(0x8ff)](_0x486b7d=>({'id':_0x486b7d['name'][_0xd0d6c9(0x46f)]('/')[0x1]||_0x486b7d['name']})):_0x420b4e[_0xd0d6c9(0x92a)];const _0x4cfe4=document[_0xd0d6c9(0x948)](_0x537d21);_0x4cfe4[_0xd0d6c9(0xb6f)]='';const _0x411bf1=_0x537d21==='model-select'?_0x16699d[_0xd0d6c9(0x79e)][_0xd0d6c9(0x531)]:_0x16699d[_0xd0d6c9(0x79e)]['secondaryModel'];_0x54fb1a[_0xd0d6c9(0x427)](_0x18ea1e=>{const _0x3825a5=_0xd0d6c9,_0x4c234c=document[_0x3825a5(0x1497)](_0x3825a5(0x152c));_0x4c234c['value']=_0x18ea1e['id'],_0x4c234c[_0x3825a5(0x10cb)]=_0x18ea1e['id'];if(_0x18ea1e['id']===_0x411bf1)_0x4c234c['selected']=!![];_0x4cfe4[_0x3825a5(0x6b6)](_0x4c234c);}),alert(_0xd0d6c9(0x2d5));}catch(_0x22f945){alert(_0xd0d6c9(0xbce)+_0x22f945[_0xd0d6c9(0x74b)]);}}document[_0x25f7e9(0x948)]('fetch-models-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x1eca54=_0x25f7e9;_0x1a250a(_0x1eca54(0xba7),'api-key',_0x1eca54(0xadc));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x987))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x3b9535=_0x25f7e9;_0x1a250a('secondary-proxy-url',_0x3b9535(0x733),_0x3b9535(0x11d9));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x14c2))['addEventListener']('click',async()=>{const _0x48e22f=_0x25f7e9,_0x12b553=await _0x41b9fc(_0x48e22f(0xd51),'请输入书名');if(_0x12b553&&_0x12b553[_0x48e22f(0x2a8)]()){const _0x265d03={'id':_0x48e22f(0x8e1)+Date['now'](),'name':_0x12b553[_0x48e22f(0x2a8)](),'content':''};await _0x6ed281[_0x48e22f(0x44c)][_0x48e22f(0xbd0)](_0x265d03),_0x16699d[_0x48e22f(0x44c)][_0x48e22f(0x1001)](_0x265d03),_0x1c33bd(),_0x1e77c3(_0x265d03['id']);}}),document[_0x25f7e9(0x948)]('save-world-book-btn')['addEventListener'](_0x25f7e9(0x4f6),async()=>{const _0x368f68=_0x25f7e9;if(!_0x1f1c25)return;const _0x1fd759=_0x16699d[_0x368f68(0x44c)][_0x368f68(0x1402)](_0x596b38=>_0x596b38['id']===_0x1f1c25);if(!_0x1fd759)return;const _0x6731ca=document[_0x368f68(0x948)]('world-book-name-input')[_0x368f68(0x5bc)][_0x368f68(0x2a8)]();if(!_0x6731ca){alert('书名不能为空！');return;}_0x1fd759[_0x368f68(0x1467)]=_0x6731ca;const _0x1b3924=document[_0x368f68(0x948)](_0x368f68(0x27f))['value'];_0x1fd759[_0x368f68(0xd86)]=_0x1b3924?parseInt(_0x1b3924):null;const _0x34cbfa=document[_0x368f68(0x948)](_0x368f68(0x122e)),_0x3384c3=_0x34cbfa[_0x368f68(0x1188)](_0x368f68(0x256)),_0x4712e7=[];_0x3384c3['forEach'](_0x5d0a3d=>{const _0x9ac544=_0x368f68,_0x11ab69=_0x5d0a3d[_0x9ac544(0xfeb)](_0x9ac544(0x371))[_0x9ac544(0x5bc)][_0x9ac544(0x2a8)](),_0xf2745b=_0x5d0a3d[_0x9ac544(0xfeb)]('.entry-content-textarea')[_0x9ac544(0x5bc)][_0x9ac544(0x2a8)](),_0x597126=_0x5d0a3d[_0x9ac544(0xfeb)](_0x9ac544(0x14bd))[_0x9ac544(0x210)];_0xf2745b&&_0x4712e7['push']({'comment':_0x5d0a3d['querySelector'](_0x9ac544(0xb71))['value']['trim'](),'keys':_0x11ab69?_0x11ab69['split'](',')['map'](_0xb19d1f=>_0xb19d1f['trim']())[_0x9ac544(0x1c0)](_0x49fde3=>_0x49fde3):[],'content':_0xf2745b,'enabled':_0x597126});}),_0x1fd759[_0x368f68(0xede)]=_0x4712e7,await _0x6ed281['worldBooks'][_0x368f68(0x90c)](_0x1fd759),document[_0x368f68(0x948)](_0x368f68(0x9fb))[_0x368f68(0x10cb)]=_0x6731ca,_0x1f1c25=null,_0x58c3b1(_0x368f68(0xf54)),await _0x1c33bd();}),document[_0x25f7e9(0x948)]('chat-messages')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async _0x57564a=>{const _0x423e9f=_0x25f7e9,_0x50a48e=_0x57564a['target'][_0x423e9f(0x1090)](_0x423e9f(0x364));if(_0x50a48e){_0x57564a[_0x423e9f(0x221)]();const _0x5ab47a=_0x57564a[_0x423e9f(0xa50)]['closest'](_0x423e9f(0x10a6));if(_0x5ab47a){const _0x6f3faf=parseInt(_0x5ab47a[_0x423e9f(0x606)][_0x423e9f(0xb0a)]);!isNaN(_0x6f3faf)&&await _0x3d83c9(_0x6f3faf,_0x50a48e);}return;}const _0x3dde14=_0x57564a[_0x423e9f(0xa50)]['closest'](_0x423e9f(0xf23));if(_0x3dde14){const _0x51ea60=_0x16699d['chats'][_0x16699d['activeChatId']];if(!_0x51ea60)return;_0x4ca95e(_0x3dde14);const _0x3f7831=_0x3dde14[_0x423e9f(0x1090)]('.message-bubble'),_0x471b44=_0x3f7831?_0x3f7831[_0x423e9f(0xfeb)](_0x423e9f(0x10f2)):null;if(_0x3dde14[_0x423e9f(0x606)]['voiceId']&&_0x471b44&&_0x471b44['style']['display']===_0x423e9f(0x1273)){if(_0x51ea60['isGroup']){console[_0x423e9f(0x498)](_0x423e9f(0x139d));return;}if(_0x51ea60['settings'][_0x423e9f(0x126c)]===![]){console[_0x423e9f(0x498)]('“'+_0x51ea60['name']+'”的TTS功能已关闭，已禁止发起TTS请求。');return;}_0x446192(_0x3dde14);}return;}const _0x41678d=_0x57564a[_0x423e9f(0xa50)]['closest']('.waimai-details-btn');if(_0x41678d){const _0x21a03b=_0x41678d[_0x423e9f(0x1090)]('.message-bubble');if(_0x21a03b){const _0x4d53b2=parseInt(_0x21a03b[_0x423e9f(0x606)][_0x423e9f(0xb0a)]);if(!isNaN(_0x4d53b2)){_0x3ceda9(_0x4d53b2);return;}}}const _0x24aded=_0x57564a['target']['closest'](_0x423e9f(0xc5a));if(_0x24aded){const _0x4633fa=_0x24aded[_0x423e9f(0x1090)](_0x423e9f(0x10a6));if(_0x4633fa){const _0x4b0e0f=parseInt(_0x4633fa[_0x423e9f(0x606)][_0x423e9f(0xb0a)]),_0x57286f=_0x24aded['dataset']['choice'];if(!isNaN(_0x4b0e0f)&&_0x57286f){await _0x1202c7(_0x4b0e0f,_0x57286f);return;}}}const _0x3b7900=_0x57564a['target']['closest']('.post-deleted-placeholder');if(_0x3b7900){const _0x5a8213=parseInt(_0x3b7900['dataset']['postId']);if(!isNaN(_0x5a8213)){const _0x275b52=await _0x6ed281[_0x423e9f(0xed1)][_0x423e9f(0xe8c)](_0x5a8213);if(_0x275b52){let _0x4e0fe4='';const _0x560952=_0x275b52[_0x423e9f(0x11b9)]==='user'?_0x16699d['qzoneSettings'][_0x423e9f(0xf4d)]:_0x16699d[_0x423e9f(0x1474)][_0x275b52[_0x423e9f(0x11b9)]]?.[_0x423e9f(0x1467)]||_0x423e9f(0x10ab);if(_0x275b52[_0x423e9f(0x4ae)]===_0x423e9f(0x2f6))_0x4e0fe4=_0x275b52[_0x423e9f(0xede)];else{_0x4e0fe4=_0x275b52[_0x423e9f(0x15bf)]||'';if(_0x275b52['imageUrl'])_0x4e0fe4+='\x0a[图片]';if(_0x275b52['hiddenContent'])_0x4e0fe4+=_0x423e9f(0x239)+_0x275b52[_0x423e9f(0x7d9)]+']';}_0x104485(_0x423e9f(0x578)+_0x560952+_0x423e9f(0x908),_0x4e0fe4[_0x423e9f(0x14e9)](/\n/g,_0x423e9f(0x1121)));}else _0x104485('提示',_0x423e9f(0xbd5));}return;}const _0x8aa333=_0x57564a[_0x423e9f(0xa50)][_0x423e9f(0x1090)]('.ai-generated-image');if(_0x8aa333){const _0x1dea77=_0x8aa333['dataset'][_0x423e9f(0xe79)];if(_0x1dea77)_0x104485(_0x423e9f(0x2fc),_0x1dea77);return;}const _0x1953f1=_0x57564a['target']['closest'](_0x423e9f(0xdd5));if(_0x1953f1&&_0x1953f1[_0x423e9f(0x606)]['originalTimestamp']){const _0x49ff56=parseInt(_0x1953f1[_0x423e9f(0x606)]['originalTimestamp']);!isNaN(_0x49ff56)&&_0x27dd05(_0x49ff56);}const _0x21f307=_0x57564a[_0x423e9f(0xa50)][_0x423e9f(0x1090)](_0x423e9f(0x434));if(_0x21f307){const _0x4e5588=_0x21f307[_0x423e9f(0x1090)](_0x423e9f(0x10a6));_0x4e5588&&_0x112773(parseInt(_0x4e5588['dataset'][_0x423e9f(0xb0a)]));}const _0x3d6392=_0x57564a[_0x423e9f(0xa50)][_0x423e9f(0x1090)](_0x423e9f(0x6b0));if(_0x3d6392){const _0x93d427=_0x3d6392['closest'](_0x423e9f(0x10a6));if(_0x93d427&&_0x93d427['dataset'][_0x423e9f(0xb0a)]){const _0x3fa248=parseInt(_0x93d427[_0x423e9f(0x606)][_0x423e9f(0xb0a)]);_0xf9f4c(_0x3fa248);}}const _0x4db5a3=_0x57564a[_0x423e9f(0xa50)][_0x423e9f(0x1090)](_0x423e9f(0x127b));if(_0x4db5a3){const _0x3be474=parseInt(_0x4db5a3[_0x423e9f(0x606)]['pollTimestamp']);if(isNaN(_0x3be474))return;const _0x6d65e0=_0x57564a[_0x423e9f(0xa50)]['closest'](_0x423e9f(0x1545));if(_0x6d65e0&&!_0x4db5a3['classList'][_0x423e9f(0x7a0)](_0x423e9f(0xd70))){_0x25e0cd(_0x3be474,_0x6d65e0['dataset'][_0x423e9f(0x152c)]);return;}const _0x531a62=_0x57564a[_0x423e9f(0xa50)][_0x423e9f(0x1090)](_0x423e9f(0x95d));if(_0x531a62){_0x4db5a3[_0x423e9f(0xd54)][_0x423e9f(0x7a0)](_0x423e9f(0xd70))?_0x382238(_0x3be474):_0x1467a3(_0x3be474);return;}_0x4db5a3[_0x423e9f(0xd54)][_0x423e9f(0x7a0)](_0x423e9f(0xd70))&&_0x382238(_0x3be474);}const _0x49ddaf=_0x57564a[_0x423e9f(0xa50)][_0x423e9f(0x1090)](_0x423e9f(0x7c6));if(_0x49ddaf){const _0x30713f=_0x16699d[_0x423e9f(0x1474)][_0x16699d[_0x423e9f(0xf5a)]],_0x1059c5=_0x49ddaf[_0x423e9f(0x1090)](_0x423e9f(0x7ba));if(_0x30713f&&_0x1059c5){const _0xcf1625=parseInt(_0x1059c5[_0x423e9f(0x606)][_0x423e9f(0xb0a)]),_0x118e11=_0x30713f[_0x423e9f(0xb07)][_0x423e9f(0x1402)](_0x40b629=>_0x40b629[_0x423e9f(0xb0a)]===_0xcf1625);if(_0x118e11&&_0x118e11['recalledData']){let _0x521fdd='';const _0x131718=_0x118e11[_0x423e9f(0x1083)];_0x131718[_0x423e9f(0x10e5)]===_0x423e9f(0x9ea)?_0x521fdd='原文:\x20\x22'+_0x131718[_0x423e9f(0x14de)]+'\x22':_0x521fdd=_0x423e9f(0xe0f)+_0x131718[_0x423e9f(0x10e5)]+_0x423e9f(0x75b),_0x104485(_0x423e9f(0x13ec),_0x521fdd);}}}const _0x284ce7=_0x57564a[_0x423e9f(0xa50)][_0x423e9f(0x1090)](_0x423e9f(0x783));if(_0x284ce7&&_0x284ce7[_0x423e9f(0x1090)](_0x423e9f(0x104d))){const _0x315b27=parseInt(_0x284ce7[_0x423e9f(0x606)][_0x423e9f(0xb0a)]);_0x4d5539(_0x315b27);}const _0x26b82f=_0x57564a[_0x423e9f(0xa50)]['closest'](_0x423e9f(0x10a6));if(_0x26b82f&&_0x26b82f['classList'][_0x423e9f(0x7a0)]('ai')&&_0x26b82f[_0x423e9f(0xd54)][_0x423e9f(0x7a0)](_0x423e9f(0xcf9))&&_0x26b82f[_0x423e9f(0x606)][_0x423e9f(0x82c)]===_0x423e9f(0x150c)){const _0x32e654=parseInt(_0x26b82f[_0x423e9f(0x606)][_0x423e9f(0xb0a)]);!isNaN(_0x32e654)&&_0x37a552(_0x32e654);}});const _0x960660=document['getElementById']('chat-settings-modal'),_0x2fc734=document[_0x25f7e9(0xfeb)](_0x25f7e9(0xf0c)),_0x2b0700=document[_0x25f7e9(0x948)](_0x25f7e9(0x52b));function _0x4db8bc(){const _0x86cf47=_0x25f7e9,_0x3daea9=_0x2b0700[_0x86cf47(0x1188)]('input:checked'),_0xeec8ec=document['querySelector']('.selected-options-text');if(_0x3daea9[_0x86cf47(0xaf9)]===0x0)_0xeec8ec['textContent']=_0x86cf47(0x5d5);else{if(_0x3daea9[_0x86cf47(0xaf9)]>0x2)_0xeec8ec[_0x86cf47(0x10cb)]='已选择\x20'+_0x3daea9[_0x86cf47(0xaf9)]+'\x20本世界书';else{const _0x1c9307=Array[_0x86cf47(0x6e5)](_0x3daea9)[_0x86cf47(0x8ff)](_0x1c6787=>{const _0x3ab92d=_0x86cf47;return _0x1c6787[_0x3ab92d(0x6c0)]['textContent'][_0x3ab92d(0x2a8)]();});_0xeec8ec['textContent']=_0x1c9307['join'](',\x20');}}}_0x2fc734[_0x25f7e9(0x339)]('click',_0x36db59=>{const _0x55ae8c=_0x25f7e9;_0x36db59[_0x55ae8c(0x221)](),_0x2b0700[_0x55ae8c(0xd54)][_0x55ae8c(0x69d)](_0x55ae8c(0xfcb)),_0x2fc734[_0x55ae8c(0xd54)]['toggle'](_0x55ae8c(0x1c7));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x52b))[_0x25f7e9(0x339)](_0x25f7e9(0x145c),_0x4db8bc),window[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x16eceb=>{const _0x5e0a8a=_0x25f7e9;!document['querySelector']('.custom-multiselect')[_0x5e0a8a(0x7a0)](_0x16eceb[_0x5e0a8a(0xa50)])&&(_0x2b0700[_0x5e0a8a(0xd54)][_0x5e0a8a(0xf89)](_0x5e0a8a(0xfcb)),_0x2fc734[_0x5e0a8a(0xd54)]['remove']('expanded'));}),document['getElementById']('chat-settings-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x370d7a=_0x25f7e9;_0x2f5477();if(!_0x16699d[_0x370d7a(0xf5a)])return;const _0x327090=_0x16699d['chats'][_0x16699d[_0x370d7a(0xf5a)]],_0x513133=_0x327090[_0x370d7a(0x1173)],_0x49c34e=document[_0x370d7a(0x948)](_0x370d7a(0x1378));!_0x513133&&_0x327090['settings']['alternateGreetings']&&_0x327090[_0x370d7a(0x7fd)]['alternateGreetings'][_0x370d7a(0xaf9)]>0x0?_0x49c34e[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]=_0x370d7a(0x1273):_0x49c34e[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]=_0x370d7a(0x12fe);document[_0x370d7a(0x948)]('chat-name-group')[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]=_0x370d7a(0x1273),document[_0x370d7a(0x948)]('my-persona-group')['style'][_0x370d7a(0x11fd)]=_0x370d7a(0x1273),document[_0x370d7a(0x948)](_0x370d7a(0xd6d))[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]='block',document['getElementById'](_0x370d7a(0x1413))[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]=_0x513133?_0x370d7a(0x1273):'none',document[_0x370d7a(0x948)](_0x370d7a(0x31f))['style'][_0x370d7a(0x11fd)]=_0x513133?'none':'block',document[_0x370d7a(0x948)](_0x370d7a(0x137d))['style'][_0x370d7a(0x11fd)]=_0x513133?_0x370d7a(0x1273):_0x370d7a(0x12fe),document[_0x370d7a(0x948)]('group-members-group')[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]=_0x513133?_0x370d7a(0x1273):_0x370d7a(0x12fe),document[_0x370d7a(0x948)](_0x370d7a(0xc82))[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]=_0x513133?'none':_0x370d7a(0x1273),document[_0x370d7a(0x948)](_0x370d7a(0xca6))[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]=_0x513133?'none':_0x370d7a(0x1273),document[_0x370d7a(0x948)](_0x370d7a(0xd85))[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]=_0x513133?'none':_0x370d7a(0x1273),document[_0x370d7a(0x948)](_0x370d7a(0x27d))[_0x370d7a(0xf74)]['display']=_0x513133?_0x370d7a(0x12fe):_0x370d7a(0x1273),document[_0x370d7a(0x948)]('ai-voice-id-group')[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]=_0x513133?_0x370d7a(0x12fe):_0x370d7a(0x1273),document[_0x370d7a(0x948)](_0x370d7a(0x3ef))[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]=_0x513133?_0x370d7a(0x12fe):'block',document[_0x370d7a(0x948)]('offline-mode-group')[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]=_0x513133?_0x370d7a(0x12fe):_0x370d7a(0x1273),document[_0x370d7a(0x948)](_0x370d7a(0x136b))[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]=_0x513133?_0x370d7a(0x12fe):_0x370d7a(0x1273),document[_0x370d7a(0x948)](_0x370d7a(0x327))[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]=_0x513133?_0x370d7a(0x1273):_0x370d7a(0x12fe),document[_0x370d7a(0x948)](_0x370d7a(0x6a3))[_0x370d7a(0x5bc)]=_0x327090[_0x370d7a(0x1467)],document[_0x370d7a(0x948)](_0x370d7a(0x71f))['value']=_0x327090['settings'][_0x370d7a(0x13b6)],document[_0x370d7a(0x948)](_0x370d7a(0x7ad))[_0x370d7a(0x147d)]=_0x327090['settings'][_0x370d7a(0xb09)]||(_0x513133?_0x5c1dc1:_0x202ba5),document[_0x370d7a(0x948)]('max-memory')[_0x370d7a(0x5bc)]=_0x327090[_0x370d7a(0x7fd)][_0x370d7a(0x78a)],document['getElementById'](_0x370d7a(0x88d))[_0x370d7a(0x5bc)]=_0x327090['settings']['linkedMemoryCount']||0xa;const _0x1ddbd4=document['getElementById']('bg-preview'),_0x57e25b=document[_0x370d7a(0x948)](_0x370d7a(0x12a4));_0x327090['settings'][_0x370d7a(0x7c2)]?(_0x1ddbd4[_0x370d7a(0x147d)]=_0x327090[_0x370d7a(0x7fd)][_0x370d7a(0x7c2)],_0x1ddbd4[_0x370d7a(0xf74)]['display']=_0x370d7a(0x1273),_0x57e25b[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]='inline-block'):(_0x1ddbd4['style'][_0x370d7a(0x11fd)]=_0x370d7a(0x12fe),_0x57e25b['style']['display']='none');document[_0x370d7a(0x948)](_0x370d7a(0xaca))[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]=_0x513133?_0x370d7a(0x12fe):'block',document[_0x370d7a(0x948)](_0x370d7a(0x126d))[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]=_0x513133?'none':_0x370d7a(0x1273),document[_0x370d7a(0x948)](_0x370d7a(0xf12))[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]=_0x513133?_0x370d7a(0x1273):_0x370d7a(0x12fe);const _0x4d9c37=document[_0x370d7a(0x948)](_0x370d7a(0x676)),_0x31c239=document[_0x370d7a(0x948)](_0x370d7a(0x49f));_0x4d9c37[_0x370d7a(0x210)]=_0x327090['settings'][_0x370d7a(0xae7)],_0x31c239['style'][_0x370d7a(0x11fd)]=_0x4d9c37[_0x370d7a(0x210)]?_0x370d7a(0x1273):_0x370d7a(0x12fe);const _0x126854=document[_0x370d7a(0x948)](_0x370d7a(0x1264)),_0x33a697=Intl[_0x370d7a(0xd88)](_0x370d7a(0x240));_0x126854[_0x370d7a(0xb6f)]='',_0x33a697[_0x370d7a(0x427)](_0x3e72f4=>{const _0x229ca9=_0x370d7a,_0x53f4f5=document[_0x229ca9(0x1497)](_0x229ca9(0x152c));_0x53f4f5[_0x229ca9(0x5bc)]=_0x3e72f4,_0x53f4f5[_0x229ca9(0x10cb)]=_0x3e72f4,_0x126854[_0x229ca9(0x6b6)](_0x53f4f5);}),_0x126854[_0x370d7a(0x5bc)]=_0x327090['settings'][_0x370d7a(0x240)]||_0x370d7a(0xafa);if(_0x513133)document[_0x370d7a(0x948)](_0x370d7a(0x134f))[_0x370d7a(0x210)]=_0x327090[_0x370d7a(0x7fd)][_0x370d7a(0x1028)],document[_0x370d7a(0x948)](_0x370d7a(0x13c4))[_0x370d7a(0x5bc)]=_0x327090[_0x370d7a(0x7fd)][_0x370d7a(0x1371)]||'',document[_0x370d7a(0x948)](_0x370d7a(0x1e8))['src']=_0x327090[_0x370d7a(0x7fd)]['groupAvatar']||_0x580bff,document[_0x370d7a(0x948)](_0x370d7a(0x11d7))[_0x370d7a(0x5bc)]=_0x327090[_0x370d7a(0x7fd)][_0x370d7a(0x63a)]||0xa,document['getElementById'](_0x370d7a(0x126d))['style']['display']=_0x370d7a(0x12fe),_0x395330(_0x327090[_0x370d7a(0x10a2)]);else{document[_0x370d7a(0x948)](_0x370d7a(0x126d))[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]=_0x370d7a(0x1273),document[_0x370d7a(0x948)](_0x370d7a(0xd26))[_0x370d7a(0x210)]=_0x327090[_0x370d7a(0x7fd)][_0x370d7a(0x1028)],document['getElementById'](_0x370d7a(0x1412))[_0x370d7a(0x210)]=_0x327090[_0x370d7a(0x7fd)][_0x370d7a(0x118c)];const _0x151629=document[_0x370d7a(0x948)]('offline-mode-toggle'),_0x14adaf=document['getElementById'](_0x370d7a(0x1244)),_0x52de4d=document[_0x370d7a(0x948)](_0x370d7a(0x974)),_0x9acdec=document[_0x370d7a(0x948)](_0x370d7a(0x65d));_0x151629['checked']=_0x327090['settings'][_0x370d7a(0x206)]||![],_0x14adaf[_0x370d7a(0xf74)][_0x370d7a(0x11fd)]=_0x151629[_0x370d7a(0x210)]?_0x370d7a(0x1273):_0x370d7a(0x12fe),_0x52de4d['value']=_0x327090[_0x370d7a(0x7fd)][_0x370d7a(0xbf5)]||0x64,_0x9acdec['value']=_0x327090[_0x370d7a(0x7fd)][_0x370d7a(0x1571)]||0x12c,await _0x2941ab(_0x327090),document[_0x370d7a(0x948)](_0x370d7a(0x1261))[_0x370d7a(0x5bc)]=_0x327090[_0x370d7a(0x628)],document['getElementById'](_0x370d7a(0x6c4))[_0x370d7a(0x5bc)]=_0x327090['settings'][_0x370d7a(0x1ad)]||'',document[_0x370d7a(0x948)](_0x370d7a(0x6a9))[_0x370d7a(0x210)]=_0x327090[_0x370d7a(0x7fd)][_0x370d7a(0x126c)]!==![],document[_0x370d7a(0x948)]('ai-persona')['value']=_0x327090[_0x370d7a(0x7fd)][_0x370d7a(0x14c1)],document[_0x370d7a(0x948)](_0x370d7a(0xea4))[_0x370d7a(0x147d)]=_0x327090['settings'][_0x370d7a(0x156d)]||_0x202ba5,document[_0x370d7a(0x948)](_0x370d7a(0x80b))[_0x370d7a(0x5bc)]=_0x327090[_0x370d7a(0x7fd)]['myNickname']||'我',document[_0x370d7a(0x948)](_0x370d7a(0xcec))[_0x370d7a(0x5bc)]=_0x327090['settings'][_0x370d7a(0x63a)]||0xa;const _0x5c3d90=document[_0x370d7a(0x948)]('assign-group-select');_0x5c3d90[_0x370d7a(0xb6f)]=_0x370d7a(0xabe);const _0x235d98=await _0x6ed281[_0x370d7a(0x1423)][_0x370d7a(0x443)]();_0x235d98[_0x370d7a(0x427)](_0x2a8b5a=>{const _0x18a29c=_0x370d7a,_0x1fa822=document[_0x18a29c(0x1497)]('option');_0x1fa822['value']=_0x2a8b5a['id'],_0x1fa822[_0x18a29c(0x10cb)]=_0x2a8b5a[_0x18a29c(0x1467)];if(_0x327090[_0x18a29c(0xaa9)]===_0x2a8b5a['id'])_0x1fa822['selected']=!![];_0x5c3d90[_0x18a29c(0x6b6)](_0x1fa822);});const _0x5434f1=_0x327090[_0x370d7a(0x7fd)][_0x370d7a(0x75e)]||{'vertical':_0x370d7a(0x102e),'horizontal':_0x370d7a(0x8f7),'offset':0xa};document[_0x370d7a(0x948)](_0x370d7a(0x67c))[_0x370d7a(0x5bc)]=_0x5434f1['vertical'],document[_0x370d7a(0x948)]('lyrics-horizontal-pos')['value']=_0x5434f1[_0x370d7a(0x1082)],document[_0x370d7a(0x948)](_0x370d7a(0xc40))['value']=_0x5434f1[_0x370d7a(0xdd9)];}const _0x2e7d6c=document['getElementById'](_0x370d7a(0x52b));_0x2e7d6c[_0x370d7a(0xb6f)]='';const [_0x379e06,_0x1eb619]=await Promise[_0x370d7a(0xd49)]([_0x6ed281[_0x370d7a(0x81c)][_0x370d7a(0x443)](),_0x6ed281[_0x370d7a(0x44c)][_0x370d7a(0x443)]()]),_0x2facb6=new Set(_0x327090[_0x370d7a(0x7fd)][_0x370d7a(0xeee)]||[]);if(_0x1eb619[_0x370d7a(0xaf9)]===0x0)_0x2e7d6c['innerHTML']=_0x370d7a(0x146e);else{_0x379e06[_0x370d7a(0x427)](_0x4f3938=>{const _0x5800b3=_0x370d7a,_0x2b568d=_0x1eb619['filter'](_0x5707e2=>_0x5707e2[_0x5800b3(0xd86)]===_0x4f3938['id']);if(_0x2b568d[_0x5800b3(0xaf9)]>0x0){const _0x2fb143=document['createElement']('h4');_0x2fb143[_0x5800b3(0x10cb)]=_0x4f3938[_0x5800b3(0x1467)],_0x2fb143[_0x5800b3(0xf74)][_0x5800b3(0x8e7)]='margin:\x2010px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;',_0x2e7d6c[_0x5800b3(0x6b6)](_0x2fb143),_0x2b568d[_0x5800b3(0x427)](_0x4e6c78=>{const _0x53e08d=_0x5800b3,_0x3b3380=_0x2facb6[_0x53e08d(0xda1)](_0x4e6c78['id']),_0x2d1b0a=document[_0x53e08d(0x1497)]('label');_0x2d1b0a['innerHTML']=_0x53e08d(0x13f4)+_0x4e6c78['id']+'\x22\x20'+(_0x3b3380?_0x53e08d(0x210):'')+'>\x20'+_0x4e6c78[_0x53e08d(0x1467)],_0x2e7d6c[_0x53e08d(0x6b6)](_0x2d1b0a);});}});const _0x7e9765=_0x1eb619[_0x370d7a(0x1c0)](_0x3208e5=>!_0x3208e5[_0x370d7a(0xd86)]);if(_0x7e9765[_0x370d7a(0xaf9)]>0x0){const _0x5da3c9=document[_0x370d7a(0x1497)]('h4');_0x5da3c9['textContent']=_0x370d7a(0x14cd),_0x5da3c9['style'][_0x370d7a(0x8e7)]='margin:\x2015px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;',_0x2e7d6c[_0x370d7a(0x6b6)](_0x5da3c9),_0x7e9765[_0x370d7a(0x427)](_0x13d8d7=>{const _0x4cab40=_0x370d7a,_0x70d6b5=_0x2facb6[_0x4cab40(0xda1)](_0x13d8d7['id']),_0x368bb8=document[_0x4cab40(0x1497)](_0x4cab40(0xe00));_0x368bb8[_0x4cab40(0xb6f)]=_0x4cab40(0x13f4)+_0x13d8d7['id']+'\x22\x20'+(_0x70d6b5?_0x4cab40(0x210):'')+'>\x20'+_0x13d8d7[_0x4cab40(0x1467)],_0x2e7d6c[_0x4cab40(0x6b6)](_0x368bb8);});}}_0x4db8bc();const _0x3a6062=document['getElementById'](_0x370d7a(0x1081)),_0x43606e=document['getElementById'](_0x370d7a(0x4fb)),_0x5e5d12=document[_0x370d7a(0x948)](_0x370d7a(0x5b8)),_0x52e1a7=_0x327090['settings'][_0x370d7a(0xbdd)]||[];_0x3a6062[_0x370d7a(0x210)]=_0x52e1a7[_0x370d7a(0xaf9)]>0x0,_0x43606e[_0x370d7a(0xf74)]['display']=_0x3a6062['checked']?_0x370d7a(0x1273):_0x370d7a(0x12fe),_0x5e5d12[_0x370d7a(0xb6f)]='',Object[_0x370d7a(0x1166)](_0x16699d[_0x370d7a(0x1474)])['forEach'](_0x299ca8=>{const _0x553ce9=_0x370d7a;if(_0x299ca8['id']===_0x327090['id'])return;const _0x174cdb=_0x52e1a7['includes'](_0x299ca8['id']),_0x53e06a=_0x299ca8[_0x553ce9(0x1173)]?_0x553ce9(0x7fe):_0x553ce9(0x15c2),_0x5bd5ca=document['createElement'](_0x553ce9(0xe00));_0x5bd5ca['innerHTML']=_0x553ce9(0xbf2)+_0x299ca8['id']+'\x22\x20'+(_0x174cdb?_0x553ce9(0x210):'')+'>\x20'+_0x53e06a+'\x20'+_0x299ca8[_0x553ce9(0x1467)],_0x5e5d12[_0x553ce9(0x6b6)](_0x5bd5ca);});function _0x23a7e9(){const _0x1c33f4=_0x370d7a,_0x1811e2=_0x5e5d12[_0x1c33f4(0x1188)](_0x1c33f4(0x1133)),_0x8de991=_0x43606e[_0x1c33f4(0xfeb)](_0x1c33f4(0x14f7));if(_0x1811e2['length']===0x0)_0x8de991[_0x1c33f4(0x10cb)]=_0x1c33f4(0x5d5);else _0x1811e2[_0x1c33f4(0xaf9)]>0x2?_0x8de991[_0x1c33f4(0x10cb)]=_0x1c33f4(0x100c)+_0x1811e2['length']+'\x20项':_0x8de991[_0x1c33f4(0x10cb)]=Array['from'](_0x1811e2)['map'](_0x1f37db=>_0x1f37db[_0x1c33f4(0x6c0)][_0x1c33f4(0x10cb)][_0x1c33f4(0x2a8)]())['join'](',\x20');}_0x23a7e9(),_0x3a6062['addEventListener'](_0x370d7a(0x145c),()=>{const _0x2c6cf2=_0x370d7a;_0x43606e[_0x2c6cf2(0xf74)][_0x2c6cf2(0x11fd)]=_0x3a6062['checked']?_0x2c6cf2(0x1273):_0x2c6cf2(0x12fe);});const _0x3c5cfa=_0x43606e['querySelector'](_0x370d7a(0x11a4)),_0x2b7aff=_0x3c5cfa[_0x370d7a(0xfc0)](!![]);_0x3c5cfa[_0x370d7a(0x1579)][_0x370d7a(0x868)](_0x2b7aff,_0x3c5cfa),_0x2b7aff[_0x370d7a(0x339)](_0x370d7a(0x4f6),_0x5464fd=>{const _0x2db51d=_0x370d7a;_0x5464fd[_0x2db51d(0x221)](),_0x5e5d12[_0x2db51d(0xd54)][_0x2db51d(0x69d)](_0x2db51d(0xfcb)),_0x2b7aff[_0x2db51d(0xd54)][_0x2db51d(0x69d)](_0x2db51d(0x1c7));}),_0x5e5d12[_0x370d7a(0x339)](_0x370d7a(0x145c),_0x23a7e9);const _0x3ba2ad=document[_0x370d7a(0xfeb)](_0x370d7a(0xc77)+(_0x327090['settings'][_0x370d7a(0x337)]||_0x370d7a(0xe46))+'\x22]');if(_0x3ba2ad)_0x3ba2ad['checked']=!![];const _0x13fe4f=document[_0x370d7a(0x948)](_0x370d7a(0x1d7));_0x13fe4f[_0x370d7a(0x5bc)]=_0x327090[_0x370d7a(0x7fd)][_0x370d7a(0x32c)]||0xd,document[_0x370d7a(0x948)](_0x370d7a(0xf82))['textContent']=_0x13fe4f[_0x370d7a(0x5bc)]+'px';const _0x470b8f=document['getElementById'](_0x370d7a(0xe01));_0x470b8f['value']=_0x327090['settings'][_0x370d7a(0x132b)]||'',_0x3cc02f(),document['getElementById'](_0x370d7a(0xecf))['checked']=_0x327090['settings'][_0x370d7a(0x151c)]||![],document[_0x370d7a(0x948)](_0x370d7a(0xf32))['value']=_0x327090['settings'][_0x370d7a(0x6dc)]||0x14,setTimeout(()=>{const _0x16da4d=_0x370d7a;_0x295a1f();const _0x48a138=['ai-persona',_0x16da4d(0x71f),'max-memory',_0x16da4d(0x88d),_0x16da4d(0xecf),_0x16da4d(0xf32),'offline-mode-toggle','offline-min-length-input',_0x16da4d(0x65d),_0x16da4d(0x1030)];_0x48a138[_0x16da4d(0x427)](_0x4fe95d=>{const _0x403c00=_0x16da4d,_0x19ce2c=document['getElementById'](_0x4fe95d);_0x19ce2c&&_0x19ce2c[_0x403c00(0x339)](_0x403c00(0xc48),_0x295a1f);}),document[_0x16da4d(0x948)](_0x16da4d(0x52b))['addEventListener'](_0x16da4d(0x145c),_0x295a1f),document['getElementById'](_0x16da4d(0x5b8))[_0x16da4d(0x339)](_0x16da4d(0x145c),_0x295a1f),document['getElementById']('link-memory-toggle')[_0x16da4d(0x339)](_0x16da4d(0x145c),_0x295a1f);},0x64),_0x58c3b1('chat-settings-screen');});function _0x395330(_0x157f3f){const _0x378a5c=_0x25f7e9,_0xf19d4b=document['getElementById']('group-members-settings');_0xf19d4b[_0x378a5c(0xb6f)]='',_0x157f3f['forEach'](_0x3dc848=>{const _0xf3a102=_0x378a5c,_0x33cb50=document[_0xf3a102(0x1497)](_0xf3a102(0x379));_0x33cb50[_0xf3a102(0x35b)]=_0xf3a102(0x7f3),_0x33cb50[_0xf3a102(0x606)]['memberId']=_0x3dc848['id'];const _0x2e59dd=_0x3dc848[_0xf3a102(0x63e)]||(_0x16699d[_0xf3a102(0x1474)][_0x3dc848['id']]?_0x16699d[_0xf3a102(0x1474)][_0x3dc848['id']][_0xf3a102(0x7fd)][_0xf3a102(0x156d)]:_0x3ca5ef);_0x33cb50[_0xf3a102(0xb6f)]=_0xf3a102(0x4ad)+_0x2e59dd+_0xf3a102(0x3f0)+_0x3dc848[_0xf3a102(0x347)]+_0xf3a102(0x1258)+_0x3dc848['groupNickname']+_0xf3a102(0xc7f),_0x33cb50[_0xf3a102(0x339)](_0xf3a102(0x4f6),()=>_0x126de1(_0x3dc848['id'])),_0xf19d4b[_0xf3a102(0x6b6)](_0x33cb50);});}document['getElementById'](_0x25f7e9(0xa3c))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x1a727b=_0x25f7e9;if(!_0x415cd3)return;const _0x2d75d2=_0x16699d['chats'][_0x16699d[_0x1a727b(0xf5a)]],_0xedab91=_0x2d75d2[_0x1a727b(0x10a2)][_0x1a727b(0x1402)](_0x2c9fee=>_0x2c9fee['id']===_0x415cd3);if(!_0xedab91)return;const _0x83fdbf=document['getElementById'](_0x1a727b(0xa95))[_0x1a727b(0x5bc)][_0x1a727b(0x2a8)]();if(!_0x83fdbf){alert(_0x1a727b(0xb4f));return;}_0xedab91[_0x1a727b(0x347)]=_0x83fdbf,_0xedab91[_0x1a727b(0xbad)]=document[_0x1a727b(0x948)](_0x1a727b(0xa1b))[_0x1a727b(0x5bc)];const _0x524ab2=document[_0x1a727b(0x948)]('member-avatar-preview')['src'];_0xedab91[_0x1a727b(0x63e)]=_0x524ab2;const _0x1340ce=_0x16699d[_0x1a727b(0x1474)][_0xedab91['id']];_0x1340ce&&(_0x1340ce[_0x1a727b(0x7fd)][_0x1a727b(0x156d)]=_0x524ab2,await _0x6ed281[_0x1a727b(0x1474)]['put'](_0x1340ce)),await _0x6ed281[_0x1a727b(0x1474)][_0x1a727b(0x90c)](_0x2d75d2),_0x395330(_0x2d75d2[_0x1a727b(0x10a2)]),document['getElementById'](_0x1a727b(0xf07))[_0x1a727b(0xd54)][_0x1a727b(0xf89)](_0x1a727b(0xfcb)),_0x415cd3=null;});function _0x126de1(_0x5333b7){const _0x1d9cbb=_0x25f7e9;_0x415cd3=_0x5333b7;const _0xd66561=_0x16699d[_0x1d9cbb(0x1474)][_0x16699d[_0x1d9cbb(0xf5a)]],_0x50ff17=_0xd66561['members'][_0x1d9cbb(0x1402)](_0x506ebe=>_0x506ebe['id']===_0x5333b7);if(!_0x50ff17)return;document[_0x1d9cbb(0x948)](_0x1d9cbb(0xa95))[_0x1d9cbb(0x5bc)]=_0x50ff17['groupNickname'],document[_0x1d9cbb(0x948)](_0x1d9cbb(0xa1b))[_0x1d9cbb(0x5bc)]=_0x50ff17[_0x1d9cbb(0xbad)];const _0x4a654a=_0x50ff17[_0x1d9cbb(0x63e)]||(_0x16699d[_0x1d9cbb(0x1474)][_0x50ff17['id']]?_0x16699d[_0x1d9cbb(0x1474)][_0x50ff17['id']][_0x1d9cbb(0x7fd)]['aiAvatar']:_0x3ca5ef);document[_0x1d9cbb(0x948)](_0x1d9cbb(0x746))[_0x1d9cbb(0x147d)]=_0x4a654a,document[_0x1d9cbb(0x948)](_0x1d9cbb(0xf07))[_0x1d9cbb(0xd54)][_0x1d9cbb(0xbd0)](_0x1d9cbb(0xfcb));}document['getElementById']('cancel-member-settings-btn')['addEventListener'](_0x25f7e9(0x4f6),()=>{const _0x574ee0=_0x25f7e9;document['getElementById'](_0x574ee0(0xf07))[_0x574ee0(0xd54)][_0x574ee0(0xf89)](_0x574ee0(0xfcb)),_0x415cd3=null;}),document[_0x25f7e9(0x948)](_0x25f7e9(0xa3c))['addEventListener'](_0x25f7e9(0x4f6),async()=>{const _0xdae79e=_0x25f7e9;if(!_0x415cd3)return;const _0x1ef1e1=_0x16699d[_0xdae79e(0x1474)][_0x16699d['activeChatId']],_0x4e1a3d=_0x1ef1e1[_0xdae79e(0x10a2)][_0xdae79e(0x1402)](_0x400eaa=>_0x400eaa['id']===_0x415cd3);if(!_0x4e1a3d)return;const _0x57dc65=document[_0xdae79e(0x948)](_0xdae79e(0xa95))[_0xdae79e(0x5bc)]['trim']();if(!_0x57dc65){alert(_0xdae79e(0xb4f));return;}_0x4e1a3d[_0xdae79e(0x347)]=_0x57dc65,_0x4e1a3d[_0xdae79e(0xbad)]=document['getElementById']('member-persona-input')[_0xdae79e(0x5bc)];const _0x3e5411=document[_0xdae79e(0x948)](_0xdae79e(0x746))[_0xdae79e(0x147d)];_0x4e1a3d[_0xdae79e(0x63e)]=_0x3e5411;const _0xc5547b=_0x16699d[_0xdae79e(0x1474)][_0x4e1a3d['id']];_0xc5547b&&(_0xc5547b['settings'][_0xdae79e(0x156d)]=_0x3e5411,await _0x6ed281['chats'][_0xdae79e(0x90c)](_0xc5547b)),await _0x6ed281[_0xdae79e(0x1474)]['put'](_0x1ef1e1),_0x395330(_0x1ef1e1[_0xdae79e(0x10a2)]),document[_0xdae79e(0x948)](_0xdae79e(0xf07))[_0xdae79e(0xd54)][_0xdae79e(0xf89)](_0xdae79e(0xfcb)),_0x415cd3=null;}),document[_0x25f7e9(0x948)](_0x25f7e9(0xdb2))[_0x25f7e9(0x339)]('click',()=>{const _0x248bfe=_0x25f7e9;document[_0x248bfe(0x948)](_0x248bfe(0xd4c))[_0x248bfe(0x210)]=!![];}),document['getElementById']('save-chat-settings-btn')[_0x25f7e9(0x339)]('click',async()=>{const _0x3eb14b=_0x25f7e9;if(!_0x16699d[_0x3eb14b(0xf5a)])return;const _0x326ee3=_0x16699d[_0x3eb14b(0x1474)][_0x16699d['activeChatId']],_0x402eb3=_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0x206)]||![],_0x4fe73b=document[_0x3eb14b(0x948)]('chat-name-input')['value'][_0x3eb14b(0x2a8)]();if(!_0x4fe73b)return alert(_0x3eb14b(0x496));if(!_0x326ee3[_0x3eb14b(0x1173)]&&_0x4fe73b!==_0x326ee3['name']){if(!_0x326ee3['nameHistory'])_0x326ee3['nameHistory']=[];if(!_0x326ee3[_0x3eb14b(0xace)]['includes'](_0x326ee3[_0x3eb14b(0x1467)]))_0x326ee3[_0x3eb14b(0xace)][_0x3eb14b(0x1001)](_0x326ee3[_0x3eb14b(0x1467)]);}_0x326ee3[_0x3eb14b(0x1467)]=_0x4fe73b;const _0x45ea6e=document['querySelector']('input[name=\x22theme-select\x22]:checked');_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0x337)]=_0x45ea6e?_0x45ea6e[_0x3eb14b(0x5bc)]:_0x3eb14b(0xe46),_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0x32c)]=parseInt(document[_0x3eb14b(0x948)]('font-size-slider')[_0x3eb14b(0x5bc)]),_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0x132b)]=document[_0x3eb14b(0x948)]('custom-css-input')[_0x3eb14b(0x5bc)][_0x3eb14b(0x2a8)](),_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0x13b6)]=document[_0x3eb14b(0x948)](_0x3eb14b(0x71f))[_0x3eb14b(0x5bc)],_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0xb09)]=document['getElementById'](_0x3eb14b(0x7ad))[_0x3eb14b(0x147d)],_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0x78a)]=parseInt(document[_0x3eb14b(0x948)](_0x3eb14b(0xa5c))[_0x3eb14b(0x5bc)])||0xa,_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0x12e2)]=parseInt(document['getElementById'](_0x3eb14b(0x88d))[_0x3eb14b(0x5bc)])||0xa;const _0x308225=document[_0x3eb14b(0x1188)]('#world-book-checkboxes-container\x20input[type=\x22checkbox\x22]:checked'),_0x78473=[];_0x308225[_0x3eb14b(0x427)](_0x1ecc6a=>{const _0x48f519=_0x3eb14b;_0x1ecc6a[_0x48f519(0x5bc)][_0x48f519(0x157f)](_0x48f519(0x5ab))&&_0x78473[_0x48f519(0x1001)](_0x1ecc6a[_0x48f519(0x5bc)]['replace'](_0x48f519(0x5ab),''));}),_0x326ee3['settings'][_0x3eb14b(0xeee)]=_0x78473;const _0x3987c5=document['getElementById'](_0x3eb14b(0x1081))[_0x3eb14b(0x210)];if(_0x3987c5){const _0x36781c=document[_0x3eb14b(0x1188)](_0x3eb14b(0x72a));_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0xbdd)]=Array[_0x3eb14b(0x6e5)](_0x36781c)[_0x3eb14b(0x8ff)](_0x5147f6=>_0x5147f6[_0x3eb14b(0x5bc)]);}else _0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0xbdd)]=[];_0x326ee3['settings'][_0x3eb14b(0x151c)]=document['getElementById'](_0x3eb14b(0xecf))[_0x3eb14b(0x210)],_0x326ee3['settings']['autoMemoryInterval']=parseInt(document[_0x3eb14b(0x948)](_0x3eb14b(0xf32))[_0x3eb14b(0x5bc)])||0x14,_0x326ee3['settings']['enableTimePerception']=document[_0x3eb14b(0x948)](_0x3eb14b(0x676))[_0x3eb14b(0x210)],_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0x240)]=document[_0x3eb14b(0x948)](_0x3eb14b(0x1264))[_0x3eb14b(0x5bc)];if(_0x326ee3[_0x3eb14b(0x1173)])_0x326ee3[_0x3eb14b(0x7fd)]['enableBackgroundActivity']=document['getElementById'](_0x3eb14b(0x134f))[_0x3eb14b(0x210)],_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0x1371)]=document[_0x3eb14b(0x948)](_0x3eb14b(0x13c4))[_0x3eb14b(0x5bc)][_0x3eb14b(0x2a8)](),_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0x1e7)]=document[_0x3eb14b(0x948)](_0x3eb14b(0x1e8))['src'],_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0x63a)]=parseInt(document[_0x3eb14b(0x948)](_0x3eb14b(0x11d7))[_0x3eb14b(0x5bc)])||0xa;else{_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0x1028)]=document[_0x3eb14b(0x948)](_0x3eb14b(0xd26))[_0x3eb14b(0x210)];const _0x245fe2=document[_0x3eb14b(0x948)](_0x3eb14b(0x1fe))[_0x3eb14b(0x210)];_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0x206)]=_0x245fe2;if(_0x402eb3===!![]&&_0x245fe2===![]){const _0x1f82c1={'role':_0x3eb14b(0x11af),'content':'[系统指令：模式已切换！你现在回到了线上聊天模式。你的回复【必须】严格遵守线上模式的JSON数组格式，例如\x20[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好\x22}]]','timestamp':Date[_0x3eb14b(0x1386)](),'isHidden':!![]};_0x326ee3['history']['push'](_0x1f82c1),console[_0x3eb14b(0x498)]('已成功注入“切换到线上模式”的系统指令。');}_0x326ee3['settings'][_0x3eb14b(0x118c)]=document[_0x3eb14b(0x948)]('inject-thought-toggle')['checked'],_0x326ee3['settings'][_0x3eb14b(0xbf5)]=parseInt(document[_0x3eb14b(0x948)](_0x3eb14b(0x974))['value'])||0x64,_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0x1571)]=parseInt(document['getElementById'](_0x3eb14b(0x65d))[_0x3eb14b(0x5bc)])||0x12c,_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0x1510)]=document[_0x3eb14b(0x948)]('offline-preset-select')[_0x3eb14b(0x5bc)]||null;const _0x354642=document['getElementById']('ai-original-name-input')[_0x3eb14b(0x5bc)][_0x3eb14b(0x2a8)]();if(!_0x354642)return alert(_0x3eb14b(0x1243));_0x326ee3[_0x3eb14b(0x628)]=_0x354642,_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0x14c1)]=document[_0x3eb14b(0x948)]('ai-persona')['value'],_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0x1ad)]=document[_0x3eb14b(0x948)]('ai-voice-id-input')[_0x3eb14b(0x5bc)][_0x3eb14b(0x2a8)](),_0x326ee3[_0x3eb14b(0x7fd)]['enableTts']=document['getElementById']('enable-tts-switch')['checked'],_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0x156d)]=document[_0x3eb14b(0x948)](_0x3eb14b(0xea4))[_0x3eb14b(0x147d)],_0x326ee3['settings']['myNickname']=document[_0x3eb14b(0x948)](_0x3eb14b(0x80b))[_0x3eb14b(0x5bc)][_0x3eb14b(0x2a8)]()||'我',_0x326ee3['settings'][_0x3eb14b(0x63a)]=parseInt(document[_0x3eb14b(0x948)](_0x3eb14b(0xcec))[_0x3eb14b(0x5bc)])||0xa,_0x326ee3[_0x3eb14b(0x7fd)]['lyricsPosition']={'vertical':document['getElementById'](_0x3eb14b(0x67c))[_0x3eb14b(0x5bc)],'horizontal':document['getElementById'](_0x3eb14b(0x2d6))['value'],'offset':parseInt(document[_0x3eb14b(0x948)]('lyrics-offset-input')['value'])||0xa};const _0x161769=document['getElementById'](_0x3eb14b(0x87c))['value'];_0x326ee3[_0x3eb14b(0xaa9)]=_0x161769?parseInt(_0x161769):null;}await _0x6ed281['chats']['put'](_0x326ee3),!_0x326ee3[_0x3eb14b(0x1173)]&&(await _0x386598(_0x326ee3),await _0x62bf8a(_0x326ee3)),_0x15852e(_0x326ee3),_0x33b8de(_0x326ee3[_0x3eb14b(0x7fd)][_0x3eb14b(0x132b)],_0x3eb14b(0xb8c),_0x3eb14b(0x12f0)),_0x58c3b1(_0x3eb14b(0x152e)),_0x455873(_0x16699d['activeChatId']),_0x2d33eb();}),document[_0x25f7e9(0x948)]('chat-settings-screen')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x1174a9=>{const _0x278a4d=_0x25f7e9;_0x1174a9['target'][_0x278a4d(0xd54)][_0x278a4d(0x7a0)](_0x278a4d(0x7a7))&&_0x481d03(_0x278a4d(0xdd2));}),document[_0x25f7e9(0x948)](_0x25f7e9(0xf07))[_0x25f7e9(0x339)]('click',_0x4c3463=>{const _0x262c5c=_0x25f7e9;_0x4c3463['target']['classList'][_0x262c5c(0x7a0)]('change-frame-btn')&&_0x481d03(_0x262c5c(0x13f7));});const _0x4bf98e=document[_0x25f7e9(0x948)]('avatar-frame-modal'),_0x19fb9a=document[_0x25f7e9(0x948)](_0x25f7e9(0x13d2)),_0x18c2cf=document['getElementById']('my-frame-tab'),_0x49c083=document[_0x25f7e9(0x948)](_0x25f7e9(0x1fc)),_0x36b8cb=document[_0x25f7e9(0x948)](_0x25f7e9(0xc13));document['getElementById'](_0x25f7e9(0x863))['addEventListener']('click',_0x1279d4),document[_0x25f7e9(0x948)]('cancel-frame-settings-btn')[_0x25f7e9(0x339)]('click',()=>{const _0xa67761=_0x25f7e9;_0x4bf98e[_0xa67761(0xd54)][_0xa67761(0xf89)]('visible'),_0x1dfe69=![];}),_0x19fb9a[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x581d6e=_0x25f7e9;_0x19fb9a[_0x581d6e(0xd54)][_0x581d6e(0xbd0)](_0x581d6e(0x115e)),_0x18c2cf['classList']['remove']('active'),_0x49c083['style'][_0x581d6e(0x11fd)]=_0x581d6e(0x1273),_0x36b8cb[_0x581d6e(0xf74)][_0x581d6e(0x11fd)]='none';}),_0x18c2cf[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x766d46=_0x25f7e9;_0x18c2cf[_0x766d46(0xd54)][_0x766d46(0xbd0)](_0x766d46(0x115e)),_0x19fb9a[_0x766d46(0xd54)]['remove'](_0x766d46(0x115e)),_0x36b8cb[_0x766d46(0xf74)]['display']='block',_0x49c083['style'][_0x766d46(0x11fd)]=_0x766d46(0x12fe);}),document[_0x25f7e9(0x948)](_0x25f7e9(0x25b))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x186d45=_0x25f7e9;if(!_0x16699d['activeChatId'])return;const _0xa78d1=_0x16699d['chats'][_0x16699d[_0x186d45(0xf5a)]],_0x36e898=await _0xa6b74a(_0x186d45(0x12cf),_0x186d45(0xee4),{'confirmButtonClass':'btn-danger'});_0x36e898&&(_0xa78d1[_0x186d45(0xb07)]=[],_0xa78d1[_0x186d45(0x790)]='...',_0xa78d1[_0x186d45(0x6f1)]=_0x186d45(0x76d),await _0x6ed281[_0x186d45(0x1474)][_0x186d45(0x90c)](_0xa78d1),_0x455873(_0x16699d[_0x186d45(0xf5a)]),_0x2d33eb(),_0x960660['classList']['remove'](_0x186d45(0xfcb)));});const _0x2b7351=(_0x2053e8,_0x54f207)=>{const _0x48a6d7=_0x25f7e9;document['getElementById'](_0x2053e8)[_0x48a6d7(0x339)](_0x48a6d7(0x145c),async _0x1aa7dd=>{const _0xf1b693=_0x48a6d7,_0x36286b=_0x1aa7dd[_0xf1b693(0xa50)][_0xf1b693(0x10b0)][0x0];if(_0x36286b){const _0x3a6642=await new Promise((_0x1d7bd8,_0x58d5a6)=>{const _0x25b1f3=_0xf1b693,_0x11655a=new FileReader();_0x11655a[_0x25b1f3(0x33a)]=()=>_0x1d7bd8(_0x11655a[_0x25b1f3(0x22a)]),_0x11655a[_0x25b1f3(0x12eb)]=()=>_0x58d5a6(_0x11655a[_0x25b1f3(0xc3e)]),_0x11655a['readAsDataURL'](_0x36286b);});_0x54f207(_0x3a6642),_0x1aa7dd[_0xf1b693(0xa50)][_0xf1b693(0x5bc)]=null;}});};_0x2b7351(_0x25f7e9(0x1551),_0x3289f9=>document[_0x25f7e9(0x948)]('ai-avatar-preview')['src']=_0x3289f9),_0x2b7351(_0x25f7e9(0xbbb),_0x34e48c=>document[_0x25f7e9(0x948)](_0x25f7e9(0x7ad))[_0x25f7e9(0x147d)]=_0x34e48c),_0x2b7351(_0x25f7e9(0x8d7),_0x19cd86=>document[_0x25f7e9(0x948)](_0x25f7e9(0x1e8))[_0x25f7e9(0x147d)]=_0x19cd86),_0x2b7351(_0x25f7e9(0xe52),_0x51a781=>document[_0x25f7e9(0x948)](_0x25f7e9(0x746))[_0x25f7e9(0x147d)]=_0x51a781),_0x2b7351(_0x25f7e9(0x1144),_0x410185=>{const _0x115503=_0x25f7e9;if(_0x16699d[_0x115503(0xf5a)]){_0x16699d['chats'][_0x16699d[_0x115503(0xf5a)]]['settings']['background']=_0x410185;const _0x438ff5=document[_0x115503(0x948)](_0x115503(0x817));_0x438ff5[_0x115503(0x147d)]=_0x410185,_0x438ff5[_0x115503(0xf74)][_0x115503(0x11fd)]=_0x115503(0x1273),document[_0x115503(0x948)](_0x115503(0x12a4))['style'][_0x115503(0x11fd)]=_0x115503(0x14e8);}}),_0x2b7351(_0x25f7e9(0x4bf),_0x8cb7be=>document[_0x25f7e9(0x948)](_0x25f7e9(0x14e3))[_0x25f7e9(0x147d)]=_0x8cb7be),document['getElementById'](_0x25f7e9(0x12a4))['addEventListener'](_0x25f7e9(0x4f6),()=>{const _0x2c873b=_0x25f7e9;if(_0x16699d[_0x2c873b(0xf5a)]){_0x16699d[_0x2c873b(0x1474)][_0x16699d['activeChatId']][_0x2c873b(0x7fd)][_0x2c873b(0x7c2)]='';const _0xc1bdb2=document['getElementById'](_0x2c873b(0x817));_0xc1bdb2['src']='',_0xc1bdb2[_0x2c873b(0xf74)][_0x2c873b(0x11fd)]=_0x2c873b(0x12fe),document[_0x2c873b(0x948)](_0x2c873b(0x12a4))[_0x2c873b(0xf74)][_0x2c873b(0x11fd)]=_0x2c873b(0x12fe);}});const _0x4a9ee4=document[_0x25f7e9(0x948)](_0x25f7e9(0x95a));document['getElementById'](_0x25f7e9(0xb94))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x3d2def=_0x25f7e9,_0x1ae4c9=_0x16699d['chats'][_0x16699d[_0x3d2def(0xf5a)]];_0x1ae4c9&&_0x1ae4c9[_0x3d2def(0x7fd)]['stickerCategoryId']?_0xf2c276=_0x1ae4c9[_0x3d2def(0x7fd)][_0x3d2def(0xd66)]:_0xf2c276=_0x3d2def(0xd49),_0x4f21d0(),_0x4a9ee4[_0x3d2def(0xd54)]['add'](_0x3d2def(0xfcb));}),document['getElementById']('close-sticker-panel-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>_0x4a9ee4[_0x25f7e9(0xd54)][_0x25f7e9(0xf89)](_0x25f7e9(0xfcb))),document[_0x25f7e9(0x948)](_0x25f7e9(0x9f5))['addEventListener'](_0x25f7e9(0x4f6),_0x335451),document[_0x25f7e9(0x948)](_0x25f7e9(0x42e))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>document[_0x25f7e9(0x948)]('sticker-upload-input')[_0x25f7e9(0x4f6)]()),document[_0x25f7e9(0x948)](_0x25f7e9(0x369))['addEventListener'](_0x25f7e9(0x145c),async _0x4b5acf=>{const _0x246ef2=_0x25f7e9,_0x434e59=_0x4b5acf[_0x246ef2(0xa50)][_0x246ef2(0x10b0)][0x0];if(!_0x434e59)return;const _0x20bd6f=new FileReader();_0x20bd6f[_0x246ef2(0x5a5)](_0x434e59),_0x20bd6f[_0x246ef2(0x33a)]=async()=>{const _0x2de7e6=_0x246ef2,_0x56af76=_0x20bd6f['result'],_0x444428=await _0x41b9fc(_0x2de7e6(0xe30),_0x2de7e6(0x35d));if(_0x444428&&_0x444428[_0x2de7e6(0x2a8)]()){const _0x1c1d85={'id':_0x2de7e6(0x906)+Date[_0x2de7e6(0x1386)](),'url':_0x56af76,'name':_0x444428[_0x2de7e6(0x2a8)](),'categoryId':_0xf2c276!==_0x2de7e6(0xd49)&&_0xf2c276!=='uncategorized'?_0xf2c276:null};await _0x6ed281[_0x2de7e6(0x14a2)][_0x2de7e6(0xbd0)](_0x1c1d85),_0x16699d['userStickers']['push'](_0x1c1d85),_0x4f21d0();}else{if(_0x444428!==null)alert(_0x2de7e6(0xe36));}},_0x4b5acf[_0x246ef2(0xa50)]['value']=null;}),document[_0x25f7e9(0x948)](_0x25f7e9(0x1203))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>document[_0x25f7e9(0x948)](_0x25f7e9(0x941))['click']()),document[_0x25f7e9(0x948)]('image-upload-input')[_0x25f7e9(0x339)]('change',async _0x4f6857=>{const _0xfadbc1=_0x25f7e9,_0x462332=_0x4f6857[_0xfadbc1(0xa50)][_0xfadbc1(0x10b0)][0x0];if(!_0x462332||!_0x16699d[_0xfadbc1(0xf5a)])return;const _0x3cafd3=new FileReader();_0x3cafd3[_0xfadbc1(0x33a)]=async _0x4d4f8b=>{const _0x1df902=_0xfadbc1,_0x2a0dc2=_0x4d4f8b[_0x1df902(0xa50)][_0x1df902(0x22a)],_0x4ff77c=_0x16699d['chats'][_0x16699d[_0x1df902(0xf5a)]],_0xd1dfe0={'role':'user','content':[{'type':_0x1df902(0x1b0),'image_url':{'url':_0x2a0dc2}}],'timestamp':Date['now']()};_0x4ff77c[_0x1df902(0xb07)]['push'](_0xd1dfe0),await _0x6ed281[_0x1df902(0x1474)][_0x1df902(0x90c)](_0x4ff77c),_0x4b384e(_0xd1dfe0,_0x4ff77c),_0x2d33eb();},_0x3cafd3[_0xfadbc1(0x5a5)](_0x462332),_0x4f6857['target'][_0xfadbc1(0x5bc)]=null;}),document[_0x25f7e9(0x948)]('voice-message-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x37a0a3=_0x25f7e9;if(!_0x16699d[_0x37a0a3(0xf5a)])return;const _0xa4a0c7=await _0x41b9fc('发送语音',_0x37a0a3(0x975));if(_0xa4a0c7&&_0xa4a0c7[_0x37a0a3(0x2a8)]()){const _0x7138de=_0x16699d['chats'][_0x16699d[_0x37a0a3(0xf5a)]],_0x2904a0={'role':_0x37a0a3(0xaeb),'type':'voice_message','content':_0xa4a0c7[_0x37a0a3(0x2a8)](),'timestamp':Date[_0x37a0a3(0x1386)]()};_0x7138de[_0x37a0a3(0xb07)]['push'](_0x2904a0),await _0x6ed281[_0x37a0a3(0x1474)][_0x37a0a3(0x90c)](_0x7138de),_0x4b384e(_0x2904a0,_0x7138de),_0x2d33eb();}}),document[_0x25f7e9(0x948)](_0x25f7e9(0x44a))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x43eaa0=_0x25f7e9;if(!_0x16699d[_0x43eaa0(0xf5a)])return;const _0x1c368d=await _0x41b9fc(_0x43eaa0(0x15cb),_0x43eaa0(0x13c2));if(_0x1c368d&&_0x1c368d[_0x43eaa0(0x2a8)]()){const _0x5c3b4d=_0x16699d[_0x43eaa0(0x1474)][_0x16699d[_0x43eaa0(0xf5a)]],_0x630ac7={'role':_0x43eaa0(0xaeb),'type':_0x43eaa0(0x368),'content':_0x1c368d[_0x43eaa0(0x2a8)](),'timestamp':Date[_0x43eaa0(0x1386)]()};_0x5c3b4d['history']['push'](_0x630ac7),await _0x6ed281[_0x43eaa0(0x1474)][_0x43eaa0(0x90c)](_0x5c3b4d),_0x4b384e(_0x630ac7,_0x5c3b4d),_0x2d33eb();}});const _0x184f53=document[_0x25f7e9(0x948)](_0x25f7e9(0x15a2));document[_0x25f7e9(0x948)](_0x25f7e9(0x42d))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x3f8fd8=_0x25f7e9;_0x184f53[_0x3f8fd8(0xd54)][_0x3f8fd8(0xbd0)](_0x3f8fd8(0xfcb));}),_0x184f53[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x21bd27=>{const _0xadd969=_0x25f7e9;_0x21bd27['target']===_0x184f53&&_0x184f53['classList'][_0xadd969(0xf89)](_0xadd969(0xfcb));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x1566))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x4d2565),document['getElementById'](_0x25f7e9(0x14a1))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x534559=_0x25f7e9;if(!_0x16699d[_0x534559(0xf5a)])return;const _0x4d9536=document[_0x534559(0x948)](_0x534559(0x2cf)),_0x42daf6=document[_0x534559(0x948)]('waimai-amount'),_0x468d98=_0x4d9536[_0x534559(0x5bc)][_0x534559(0x2a8)](),_0x3efd2b=parseFloat(_0x42daf6[_0x534559(0x5bc)]);if(!_0x468d98||isNaN(_0x3efd2b)||_0x3efd2b<=0x0){alert(_0x534559(0x14f0));return;}const _0x5ad0a7=_0x16699d[_0x534559(0x1474)][_0x16699d[_0x534559(0xf5a)]],_0xade8c2=Date[_0x534559(0x1386)](),_0x317e46=_0x5ad0a7['isGroup']?_0x5ad0a7[_0x534559(0x7fd)]['myNickname']||'我':'我',_0x35b1b5={'role':_0x534559(0xaeb),'senderName':_0x317e46,'type':_0x534559(0x29c),'productInfo':_0x468d98,'amount':_0x3efd2b,'status':_0x534559(0x150c),'countdownEndTime':_0xade8c2+0xf*0x3c*0x3e8,'timestamp':_0xade8c2};_0x5ad0a7[_0x534559(0xb07)][_0x534559(0x1001)](_0x35b1b5),await _0x6ed281[_0x534559(0x1474)]['put'](_0x5ad0a7),_0x4b384e(_0x35b1b5,_0x5ad0a7),_0x2d33eb(),_0x4d9536[_0x534559(0x5bc)]='',_0x42daf6[_0x534559(0x5bc)]='',_0x184f53[_0x534559(0xd54)][_0x534559(0xf89)]('visible');}),document['getElementById'](_0x25f7e9(0x13b0))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x1c1980),document[_0x25f7e9(0x948)](_0x25f7e9(0x5f9))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x174dbf),document[_0x25f7e9(0x948)]('add-persona-preset-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x596ccb),document[_0x25f7e9(0x948)](_0x25f7e9(0xb30))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0xf2394c),document[_0x25f7e9(0x948)](_0x25f7e9(0xca4))['addEventListener'](_0x25f7e9(0x4f6),_0x58ca34),document[_0x25f7e9(0x948)](_0x25f7e9(0x119e))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x264318),document[_0x25f7e9(0x948)](_0x25f7e9(0xed6))['addEventListener'](_0x25f7e9(0x4f6),_0x3827ed),document[_0x25f7e9(0x948)](_0x25f7e9(0xd5e))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3a6a96),document[_0x25f7e9(0x948)](_0x25f7e9(0xf7c))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x402014),document['getElementById'](_0x25f7e9(0x80f))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x4955f0=_0x25f7e9;if(_0x355e3f[_0x4955f0(0x8ca)]===0x0)return;const _0x15f5a2=await _0xa6b74a(_0x4955f0(0x1044),'确定要删除选中的\x20'+_0x355e3f[_0x4955f0(0x8ca)]+'\x20条消息吗？这会通知AI这些消息已被删除。',{'confirmButtonClass':_0x4955f0(0x5e8)});if(_0x15f5a2){const _0x1ec394=_0x16699d[_0x4955f0(0x1474)][_0x16699d[_0x4955f0(0xf5a)]];let _0x310f28=[];for(const _0x43666c of _0x355e3f){const _0x52b0c3=_0x1ec394['history'][_0x4955f0(0x1402)](_0x2f71ec=>_0x2f71ec[_0x4955f0(0xb0a)]===_0x43666c);_0x52b0c3&&_0x52b0c3['type']===_0x4955f0(0x1385)&&_0x310f28[_0x4955f0(0x1001)](_0x4955f0(0x3e8)+_0x52b0c3['question']+'”的投票(时间戳:\x20'+_0x52b0c3[_0x4955f0(0xb0a)]+')');}_0x1ec394[_0x4955f0(0xb07)]=_0x1ec394[_0x4955f0(0xb07)][_0x4955f0(0x1c0)](_0x5a8bf8=>!_0x355e3f[_0x4955f0(0xda1)](_0x5a8bf8[_0x4955f0(0xb0a)]));let _0x10318f=_0x4955f0(0xe82);_0x310f28[_0x4955f0(0xaf9)]>0x0&&(_0x10318f+='\x20其中包括以下投票：'+_0x310f28[_0x4955f0(0x121a)]('；')+'。');_0x10318f+=_0x4955f0(0x791);const _0x41a690={'role':_0x4955f0(0x11af),'content':_0x4955f0(0x995)+_0x10318f+']','timestamp':Date[_0x4955f0(0x1386)](),'isHidden':!![]};_0x1ec394[_0x4955f0(0xb07)][_0x4955f0(0x1001)](_0x41a690),await _0x6ed281['chats'][_0x4955f0(0x90c)](_0x1ec394),_0x455873(_0x16699d[_0x4955f0(0xf5a)]),_0x2d33eb();}}),document[_0x25f7e9(0x948)](_0x25f7e9(0x662))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x30ddbf=_0x25f7e9;if(_0x355e3f[_0x30ddbf(0x8ca)]===0x0)return;const _0x1cc377=await _0xa6b74a(_0x30ddbf(0xeb7),_0x30ddbf(0x1485)+_0x355e3f[_0x30ddbf(0x8ca)]+_0x30ddbf(0x1522),{'confirmButtonClass':'btn-danger','confirmText':_0x30ddbf(0x261)});if(_0x1cc377){const _0x4d39ba=_0x16699d[_0x30ddbf(0x1474)][_0x16699d[_0x30ddbf(0xf5a)]];_0x4d39ba['history']=_0x4d39ba[_0x30ddbf(0xb07)][_0x30ddbf(0x1c0)](_0x28c8d4=>!_0x355e3f[_0x30ddbf(0xda1)](_0x28c8d4[_0x30ddbf(0xb0a)])),await _0x6ed281[_0x30ddbf(0x1474)]['put'](_0x4d39ba),_0x455873(_0x16699d['activeChatId']),_0x2d33eb();}});const _0x42af9e=document[_0x25f7e9(0x948)](_0x25f7e9(0x1024));_0x42af9e['addEventListener']('input',()=>_0x495393(_0x42af9e[_0x25f7e9(0x5bc)]['trim'](),!![])),document[_0x25f7e9(0x948)](_0x25f7e9(0x3e0))[_0x25f7e9(0x339)]('click',async()=>{const _0x68f1a1=_0x25f7e9,_0x2f9a7f=_0x42af9e[_0x68f1a1(0x5bc)]['trim']();if(!_0x2f9a7f){alert(_0x68f1a1(0x392));return;}_0x495393(_0x2f9a7f,![]),_0x16699d[_0x68f1a1(0xf9c)]['fontUrl']=_0x2f9a7f,await _0x6ed281[_0x68f1a1(0xf9c)][_0x68f1a1(0x90c)](_0x16699d['globalSettings']),alert(_0x68f1a1(0x311));}),document['getElementById'](_0x25f7e9(0x3c1))[_0x25f7e9(0x339)]('click',_0x4202c1),document['querySelectorAll']('#chat-list-bottom-nav\x20.nav-item')['forEach'](_0x83b414=>{const _0x5c52f3=_0x25f7e9;_0x83b414['addEventListener']('click',()=>_0x779269(_0x83b414[_0x5c52f3(0x606)][_0x5c52f3(0x127e)]));}),document[_0x25f7e9(0x948)]('qzone-back-btn')[_0x25f7e9(0x339)]('click',()=>_0x779269('messages-view')),document['getElementById'](_0x25f7e9(0xab6))['addEventListener'](_0x25f7e9(0x4f6),async()=>{const _0x5903f2=_0x25f7e9,_0x3b8b74=await _0x41b9fc(_0x5903f2(0x1107),_0x5903f2(0x1039),_0x16699d['qzoneSettings'][_0x5903f2(0xf4d)]);_0x3b8b74&&_0x3b8b74[_0x5903f2(0x2a8)]()&&(_0x16699d['qzoneSettings'][_0x5903f2(0xf4d)]=_0x3b8b74['trim'](),await _0x5d0d99(),_0x33c3bf());}),document['getElementById']('qzone-avatar-container')[_0x25f7e9(0x339)]('click',()=>document[_0x25f7e9(0x948)](_0x25f7e9(0x5ca))['click']()),document[_0x25f7e9(0x948)]('qzone-banner-container')['addEventListener'](_0x25f7e9(0x4f6),()=>document[_0x25f7e9(0x948)](_0x25f7e9(0x10f6))[_0x25f7e9(0x4f6)]()),document[_0x25f7e9(0x948)](_0x25f7e9(0x5ca))[_0x25f7e9(0x339)]('change',async _0x43b0ec=>{const _0x3d8e1f=_0x25f7e9,_0x353526=_0x43b0ec['target'][_0x3d8e1f(0x10b0)][0x0];if(_0x353526){const _0x187e76=await new Promise(_0x2cfc23=>{const _0x5ddffe=_0x3d8e1f,_0x59fb39=new FileReader();_0x59fb39[_0x5ddffe(0x33a)]=()=>_0x2cfc23(_0x59fb39[_0x5ddffe(0x22a)]),_0x59fb39[_0x5ddffe(0x5a5)](_0x353526);});_0x16699d['qzoneSettings'][_0x3d8e1f(0x63e)]=_0x187e76,await _0x5d0d99(),_0x33c3bf();}_0x43b0ec[_0x3d8e1f(0xa50)]['value']=null;}),document[_0x25f7e9(0x948)](_0x25f7e9(0x10f6))[_0x25f7e9(0x339)](_0x25f7e9(0x145c),async _0x4d41cd=>{const _0x3be221=_0x25f7e9,_0x94ab5a=_0x4d41cd[_0x3be221(0xa50)]['files'][0x0];if(_0x94ab5a){const _0xfd2d65=await new Promise(_0x1d7873=>{const _0x5c72c6=_0x3be221,_0x357925=new FileReader();_0x357925['onload']=()=>_0x1d7873(_0x357925[_0x5c72c6(0x22a)]),_0x357925[_0x5c72c6(0x5a5)](_0x94ab5a);});_0x16699d['qzoneSettings']['banner']=_0xfd2d65,await _0x5d0d99(),_0x33c3bf();}_0x4d41cd[_0x3be221(0xa50)][_0x3be221(0x5bc)]=null;}),document[_0x25f7e9(0x948)](_0x25f7e9(0x1150))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0xa6c9ca=_0x25f7e9;_0xf5628b();const _0x54df13=document[_0xa6c9ca(0x948)]('create-post-modal');_0x54df13[_0xa6c9ca(0x606)][_0xa6c9ca(0x12e0)]=_0xa6c9ca(0x2f6),_0x54df13[_0xa6c9ca(0xfeb)](_0xa6c9ca(0xca5))[_0xa6c9ca(0xf74)]['display']=_0xa6c9ca(0x12fe),_0x54df13[_0xa6c9ca(0xfeb)](_0xa6c9ca(0x1084))[_0xa6c9ca(0xf74)][_0xa6c9ca(0x11fd)]=_0xa6c9ca(0x12fe),_0x54df13[_0xa6c9ca(0xfeb)](_0xa6c9ca(0xcb4))['style'][_0xa6c9ca(0x11fd)]=_0xa6c9ca(0x12fe),_0x54df13[_0xa6c9ca(0xfeb)](_0xa6c9ca(0xaf2))[_0xa6c9ca(0x440)]='分享新鲜事...';const _0x3b23dd=document['getElementById']('post-visibility-groups');_0x3b23dd['innerHTML']='';const _0x52161f=await _0x6ed281['qzoneGroups'][_0xa6c9ca(0x443)]();_0x52161f['length']>0x0?_0x52161f[_0xa6c9ca(0x427)](_0x4dca7f=>{const _0x431e9c=_0xa6c9ca,_0x5436f0=document['createElement']('label');_0x5436f0[_0x431e9c(0xf74)][_0x431e9c(0x11fd)]=_0x431e9c(0x1273),_0x5436f0[_0x431e9c(0xb6f)]=_0x431e9c(0x58b)+_0x4dca7f['id']+'\x22>\x20'+_0x4dca7f[_0x431e9c(0x1467)],_0x3b23dd[_0x431e9c(0x6b6)](_0x5436f0);}):_0x3b23dd['innerHTML']=_0xa6c9ca(0x3d2),_0x54df13[_0xa6c9ca(0xd54)][_0xa6c9ca(0xbd0)](_0xa6c9ca(0xfcb));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x1298))['addEventListener']('click',async()=>{const _0x1728f6=_0x25f7e9;_0xf5628b();const _0x3fcead=document[_0x1728f6(0x948)](_0x1728f6(0x1445));_0x3fcead[_0x1728f6(0x606)][_0x1728f6(0x12e0)]=_0x1728f6(0x12f6),_0x3fcead[_0x1728f6(0xfeb)](_0x1728f6(0xca5))[_0x1728f6(0xf74)][_0x1728f6(0x11fd)]='flex',_0x3fcead[_0x1728f6(0xfeb)](_0x1728f6(0x1084))[_0x1728f6(0xd54)][_0x1728f6(0xbd0)](_0x1728f6(0x115e)),_0x3fcead[_0x1728f6(0xfeb)](_0x1728f6(0xcb4))[_0x1728f6(0xd54)]['remove']('active'),_0x3fcead[_0x1728f6(0xfeb)](_0x1728f6(0xaf2))[_0x1728f6(0x440)]=_0x1728f6(0x86f);const _0x3a8063=document[_0x1728f6(0x948)](_0x1728f6(0x145e));_0x3a8063[_0x1728f6(0xb6f)]='';const _0x775a03=await _0x6ed281[_0x1728f6(0x1423)][_0x1728f6(0x443)]();_0x775a03['length']>0x0?_0x775a03[_0x1728f6(0x427)](_0x2d44ae=>{const _0xf2f00=_0x1728f6,_0xc33561=document[_0xf2f00(0x1497)]('label');_0xc33561['style'][_0xf2f00(0x11fd)]=_0xf2f00(0x1273),_0xc33561[_0xf2f00(0xb6f)]=_0xf2f00(0x58b)+_0x2d44ae['id']+_0xf2f00(0xc59)+_0x2d44ae['name'],_0x3a8063[_0xf2f00(0x6b6)](_0xc33561);}):_0x3a8063[_0x1728f6(0xb6f)]='<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>',_0x3fcead[_0x1728f6(0xd54)][_0x1728f6(0xbd0)](_0x1728f6(0xfcb));}),document[_0x25f7e9(0x948)]('open-album-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0xde79c0=_0x25f7e9;await _0xd3cc7a(),_0x58c3b1(_0xde79c0(0x1054));}),document['getElementById'](_0x25f7e9(0x4ef))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x450169=_0x25f7e9;_0x58c3b1('chat-list-screen'),_0x779269(_0x450169(0x442));}),document['getElementById'](_0x25f7e9(0x2a5))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x286954=_0x25f7e9;_0x16699d[_0x286954(0x3ad)]=null,_0x58c3b1(_0x286954(0x1054));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x9bf))[_0x25f7e9(0x339)]('click',()=>document[_0x25f7e9(0x948)](_0x25f7e9(0x131c))[_0x25f7e9(0x4f6)]()),document[_0x25f7e9(0x948)](_0x25f7e9(0x131c))['addEventListener'](_0x25f7e9(0x145c),async _0x18940f=>{const _0x4ed524=_0x25f7e9;if(!_0x16699d[_0x4ed524(0x3ad)])return;const _0x48215a=_0x18940f[_0x4ed524(0xa50)]['files'];if(!_0x48215a[_0x4ed524(0xaf9)])return;const _0x4ee754=await _0x6ed281[_0x4ed524(0x1a0)][_0x4ed524(0xe8c)](_0x16699d[_0x4ed524(0x3ad)]);for(const _0x44765e of _0x48215a){const _0x2fa58c=await new Promise(_0x20a1fd=>{const _0x3fca29=_0x4ed524,_0x974652=new FileReader();_0x974652[_0x3fca29(0x33a)]=()=>_0x20a1fd(_0x974652[_0x3fca29(0x22a)]),_0x974652[_0x3fca29(0x5a5)](_0x44765e);});await _0x6ed281[_0x4ed524(0x1100)][_0x4ed524(0xbd0)]({'albumId':_0x16699d[_0x4ed524(0x3ad)],'url':_0x2fa58c,'createdAt':Date[_0x4ed524(0x1386)]()});}const _0x336fe3=await _0x6ed281[_0x4ed524(0x1100)][_0x4ed524(0x1117)](_0x4ed524(0xe12))[_0x4ed524(0xba9)](_0x16699d['activeAlbumId'])[_0x4ed524(0x12db)](),_0x116f24={'photoCount':_0x336fe3};if(!_0x4ee754[_0x4ed524(0x478)]||_0x4ee754['coverUrl'][_0x4ed524(0x1336)](_0x4ed524(0x440))){const _0x53b9ce=await _0x6ed281[_0x4ed524(0x1100)]['where'](_0x4ed524(0xe12))[_0x4ed524(0xba9)](_0x16699d[_0x4ed524(0x3ad)])[_0x4ed524(0x678)]();if(_0x53b9ce)_0x116f24[_0x4ed524(0x3a6)]=_0x53b9ce[_0x4ed524(0x9a8)];}await _0x6ed281[_0x4ed524(0x1a0)]['update'](_0x16699d['activeAlbumId'],_0x116f24),await _0x4e4aa6(),await _0xd3cc7a(),_0x18940f[_0x4ed524(0xa50)][_0x4ed524(0x5bc)]=null,alert(_0x4ed524(0x966));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x199))[_0x25f7e9(0x339)]('click',async _0x5326ca=>{const _0x33f48e=_0x25f7e9,_0xf311b3=_0x5326ca[_0x33f48e(0xa50)][_0x33f48e(0x1090)](_0x33f48e(0x4a3)),_0x2ace9d=_0x5326ca[_0x33f48e(0xa50)]['closest']('.photo-thumb');if(_0xf311b3){_0x5326ca[_0x33f48e(0x221)]();const _0x404ff5=parseInt(_0xf311b3['dataset'][_0x33f48e(0xee0)]),_0x5c3d1d=await _0xa6b74a(_0x33f48e(0x1159),_0x33f48e(0x4ce),{'confirmButtonClass':_0x33f48e(0x5e8)});if(_0x5c3d1d){const _0x20cd63=await _0x6ed281[_0x33f48e(0x1100)][_0x33f48e(0xe8c)](_0x404ff5);if(!_0x20cd63)return;await _0x6ed281[_0x33f48e(0x1100)][_0x33f48e(0x869)](_0x404ff5);const _0x14bf72=await _0x6ed281[_0x33f48e(0x1a0)][_0x33f48e(0xe8c)](_0x16699d[_0x33f48e(0x3ad)]),_0x55a79f=(_0x14bf72[_0x33f48e(0x478)]||0x1)-0x1,_0x33a0f1={'photoCount':_0x55a79f};if(_0x14bf72[_0x33f48e(0x3a6)]===_0x20cd63[_0x33f48e(0x9a8)]){const _0xeb217d=await _0x6ed281[_0x33f48e(0x1100)]['where'](_0x33f48e(0xe12))[_0x33f48e(0xba9)](_0x16699d[_0x33f48e(0x3ad)])[_0x33f48e(0x678)]();_0x33a0f1[_0x33f48e(0x3a6)]=_0xeb217d?_0xeb217d[_0x33f48e(0x9a8)]:'https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png';}await _0x6ed281[_0x33f48e(0x1a0)][_0x33f48e(0xa0b)](_0x16699d['activeAlbumId'],_0x33a0f1),await _0x4e4aa6(),await _0xd3cc7a(),alert(_0x33f48e(0x1168));}}else _0x2ace9d&&_0x28e2e8(_0x2ace9d[_0x33f48e(0x147d)]);}),document[_0x25f7e9(0x948)]('photo-viewer-close-btn')['addEventListener'](_0x25f7e9(0x4f6),_0x4d3e67),document[_0x25f7e9(0x948)](_0x25f7e9(0x216))[_0x25f7e9(0x339)]('click',_0x29f363),document['getElementById'](_0x25f7e9(0x117e))['addEventListener']('click',_0x125656),document[_0x25f7e9(0x339)]('keydown',_0x7e3181=>{const _0x1a2bad=_0x25f7e9;if(!_0x302509['isOpen'])return;if(_0x7e3181[_0x1a2bad(0x1212)]==='ArrowRight')_0x29f363();else{if(_0x7e3181[_0x1a2bad(0x1212)]===_0x1a2bad(0x124e))_0x125656();else _0x7e3181[_0x1a2bad(0x1212)]===_0x1a2bad(0xb93)&&_0x4d3e67();}}),document[_0x25f7e9(0x948)]('create-album-btn-page')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x50ddb4=_0x25f7e9,_0x1e7bf2=await _0x41b9fc(_0x50ddb4(0x734),_0x50ddb4(0x95f));if(_0x1e7bf2&&_0x1e7bf2[_0x50ddb4(0x2a8)]()){const _0x11fa5f={'name':_0x1e7bf2[_0x50ddb4(0x2a8)](),'coverUrl':'https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','photoCount':0x0,'createdAt':Date[_0x50ddb4(0x1386)]()};await _0x6ed281[_0x50ddb4(0x1a0)][_0x50ddb4(0xbd0)](_0x11fa5f),await _0xd3cc7a(),alert(_0x50ddb4(0xd0d)+_0x1e7bf2+'\x22\x20创建成功！');}else _0x1e7bf2!==null&&alert('相册名称不能为空！');}),document['getElementById'](_0x25f7e9(0x7ee))[_0x25f7e9(0x339)]('click',()=>document[_0x25f7e9(0x948)](_0x25f7e9(0x1445))[_0x25f7e9(0xd54)][_0x25f7e9(0xf89)]('visible')),document['getElementById'](_0x25f7e9(0x96a))[_0x25f7e9(0x339)]('click',()=>document[_0x25f7e9(0x948)]('post-local-image-input')[_0x25f7e9(0x4f6)]()),document['getElementById'](_0x25f7e9(0xe93))[_0x25f7e9(0x339)]('change',_0x3580b7=>{const _0x3cd088=_0x25f7e9,_0x553763=_0x3580b7['target'][_0x3cd088(0x10b0)][0x0];if(_0x553763){const _0x2cbdbc=new FileReader();_0x2cbdbc['onload']=_0x8bddf4=>{const _0x1c23d3=_0x3cd088;document[_0x1c23d3(0x948)](_0x1c23d3(0xf63))[_0x1c23d3(0x147d)]=_0x8bddf4['target'][_0x1c23d3(0x22a)],document[_0x1c23d3(0x948)]('post-image-preview-container')[_0x1c23d3(0xd54)]['add'](_0x1c23d3(0xfcb)),document['getElementById'](_0x1c23d3(0x13c6))[_0x1c23d3(0xf74)][_0x1c23d3(0x11fd)]='block';},_0x2cbdbc[_0x3cd088(0x5a5)](_0x553763);}}),document['getElementById']('post-use-url-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x1e9089=_0x25f7e9,_0x287948=await _0x41b9fc(_0x1e9089(0x9c4),'请输入网络图片的链接','',_0x1e9089(0x9a8));_0x287948&&(document['getElementById']('post-image-preview')['src']=_0x287948,document[_0x1e9089(0x948)](_0x1e9089(0xae8))['classList'][_0x1e9089(0xbd0)]('visible'),document[_0x1e9089(0x948)](_0x1e9089(0x13c6))['style'][_0x1e9089(0x11fd)]='block');}),document[_0x25f7e9(0x948)](_0x25f7e9(0xf1d))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>_0xf5628b());const _0x1adff3=document[_0x25f7e9(0x948)](_0x25f7e9(0xf0a)),_0x468beb=document[_0x25f7e9(0x948)](_0x25f7e9(0x6c7)),_0x42cc6e=document[_0x25f7e9(0x948)](_0x25f7e9(0x15a3)),_0x199f5f=document[_0x25f7e9(0x948)](_0x25f7e9(0xe9e));_0x1adff3[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x72c5c9=_0x25f7e9;_0x1adff3[_0x72c5c9(0xd54)]['add'](_0x72c5c9(0x115e)),_0x468beb[_0x72c5c9(0xd54)][_0x72c5c9(0xf89)](_0x72c5c9(0x115e)),_0x42cc6e[_0x72c5c9(0xd54)][_0x72c5c9(0xbd0)](_0x72c5c9(0x115e)),_0x199f5f[_0x72c5c9(0xd54)][_0x72c5c9(0xf89)](_0x72c5c9(0x115e));}),_0x468beb['addEventListener'](_0x25f7e9(0x4f6),()=>{const _0xc93776=_0x25f7e9;_0x468beb['classList'][_0xc93776(0xbd0)](_0xc93776(0x115e)),_0x1adff3[_0xc93776(0xd54)][_0xc93776(0xf89)](_0xc93776(0x115e)),_0x199f5f[_0xc93776(0xd54)][_0xc93776(0xbd0)](_0xc93776(0x115e)),_0x42cc6e[_0xc93776(0xd54)][_0xc93776(0xf89)](_0xc93776(0x115e));}),document[_0x25f7e9(0x948)]('confirm-create-post-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x4ef589=_0x25f7e9,_0xf5ffb6=document['getElementById']('create-post-modal'),_0x57e400=_0xf5ffb6[_0x4ef589(0x606)][_0x4ef589(0x12e0)],_0x387a6f=document['querySelector'](_0x4ef589(0x114e))[_0x4ef589(0x5bc)];let _0x5f7443=null;_0x387a6f===_0x4ef589(0x4e7)&&(_0x5f7443=Array['from'](document[_0x4ef589(0x1188)]('input[name=\x22visibility_group\x22]:checked'))[_0x4ef589(0x8ff)](_0x5a05ab=>parseInt(_0x5a05ab[_0x4ef589(0x5bc)])));let _0x52dfb9={};const _0x24d318={'timestamp':Date[_0x4ef589(0x1386)](),'authorId':'user','visibleGroupIds':_0x5f7443};if(_0x57e400==='shuoshuo'){const _0x24774e=document[_0x4ef589(0x948)]('post-public-text')[_0x4ef589(0x5bc)][_0x4ef589(0x2a8)]();if(!_0x24774e){alert(_0x4ef589(0x6d9));return;}_0x52dfb9={..._0x24d318,'type':'shuoshuo','content':_0x24774e};}else{const _0x181697=document[_0x4ef589(0x948)](_0x4ef589(0xf21))[_0x4ef589(0x5bc)][_0x4ef589(0x2a8)](),_0x412ae2=document[_0x4ef589(0x948)](_0x4ef589(0x15a3))[_0x4ef589(0xd54)][_0x4ef589(0x7a0)](_0x4ef589(0x115e));if(_0x412ae2){const _0x58ad9e=document['getElementById'](_0x4ef589(0xf63))[_0x4ef589(0x147d)],_0x1b6700=document['getElementById']('post-image-description')[_0x4ef589(0x5bc)][_0x4ef589(0x2a8)]();if(!_0x58ad9e||!(_0x58ad9e[_0x4ef589(0x157f)]('http')||_0x58ad9e['startsWith'](_0x4ef589(0x1b3)))){alert('请先添加一张图片再发布动态哦！');return;}if(!_0x1b6700){alert('请为你的图片添加一个简单的描述（必填，给AI看的）！');return;}_0x52dfb9={..._0x24d318,'type':'image_post','publicText':_0x181697,'imageUrl':_0x58ad9e,'imageDescription':_0x1b6700};}else{const _0x11d6e0=document[_0x4ef589(0x948)](_0x4ef589(0x203))[_0x4ef589(0x5bc)]['trim']();if(!_0x11d6e0){alert('请输入文字图描述！');return;}_0x52dfb9={..._0x24d318,'type':_0x4ef589(0x1076),'publicText':_0x181697,'hiddenContent':_0x11d6e0};}}const _0x2f340c=await _0x6ed281[_0x4ef589(0xed1)]['add'](_0x52dfb9);let _0x2dd0a1=_0x52dfb9[_0x4ef589(0xede)]||_0x52dfb9[_0x4ef589(0x15bf)]||_0x52dfb9[_0x4ef589(0x1329)]||_0x52dfb9[_0x4ef589(0x7d9)]||_0x4ef589(0x89a);_0x2dd0a1=_0x2dd0a1['substring'](0x0,0x32)+(_0x2dd0a1[_0x4ef589(0xaf9)]>0x32?_0x4ef589(0x76d):'');for(const _0x16d8c2 in _0x16699d[_0x4ef589(0x1474)]){const _0x27c399=_0x16699d[_0x4ef589(0x1474)][_0x16d8c2];if(_0x27c399['isGroup'])continue;let _0x21d1a7=![];const _0x12ae24=_0x52dfb9[_0x4ef589(0xa48)];if(!_0x12ae24||_0x12ae24['length']===0x0)_0x21d1a7=!![];else _0x27c399[_0x4ef589(0xaa9)]&&_0x12ae24['includes'](_0x27c399['groupId'])&&(_0x21d1a7=!![]);if(_0x21d1a7){const _0xd4cab4={'role':_0x4ef589(0x11af),'content':'[系统提示：用户刚刚发布了一条动态(ID:\x20'+_0x2f340c+_0x4ef589(0x768)+_0x2dd0a1+'”。请你【结合自己的角色设定、世界观和你们的最近聊天内容】，对这条动态发表一条自然的评论。]','timestamp':Date['now'](),'isHidden':!![]};_0x27c399[_0x4ef589(0xb07)][_0x4ef589(0x1001)](_0xd4cab4),await _0x6ed281[_0x4ef589(0x1474)]['put'](_0x27c399);}}await _0x4d3afb(),_0xf5ffb6[_0x4ef589(0xd54)][_0x4ef589(0xf89)]('visible'),alert('动态发布成功！');});const _0x5e6b67=document['getElementById']('qzone-posts-list');let _0x32f5d4={'isDragging':![],'startX':0x0,'startY':0x0,'currentX':0x0,'activeContainer':null,'swipeDirection':null,'isClick':!![]};function _0x2535c9(_0x41c5d3=null){const _0x573adc=_0x25f7e9;document[_0x573adc(0x1188)]('.qzone-post-container')[_0x573adc(0x427)](_0x15abc7=>{const _0x2c3a21=_0x573adc;_0x15abc7!==_0x41c5d3&&_0x15abc7[_0x2c3a21(0xfeb)](_0x2c3a21(0x5f2))[_0x2c3a21(0xd54)][_0x2c3a21(0xf89)]('swiped');});}async function _0x52079a(_0x20aed5){const _0x1cf910=_0x25f7e9;_0x20aed5['stopPropagation']();const _0x5c31d5=_0x20aed5[_0x1cf910(0xa50)],_0x58bbfd=_0x5c31d5[_0x1cf910(0x1090)](_0x1cf910(0x2c3));if(_0x58bbfd){const _0x206e90=_0x58bbfd[_0x1cf910(0x1090)]('.qzone-post-container'),_0xd482fb=parseInt(_0x206e90['dataset'][_0x1cf910(0xba5)]),_0x4d21ac=parseInt(_0x58bbfd[_0x1cf910(0x606)][_0x1cf910(0x3fe)]);if(isNaN(_0xd482fb)||isNaN(_0x4d21ac))return;const _0x23dfe9=_0x22676c[_0x1cf910(0x1402)](_0x55e004=>_0x55e004['id']===_0xd482fb);if(!_0x23dfe9||!_0x23dfe9[_0x1cf910(0x4d6)]||!_0x23dfe9[_0x1cf910(0x4d6)][_0x4d21ac])return;const _0x5e1c3d=_0x23dfe9[_0x1cf910(0x4d6)][_0x4d21ac],_0x22b403=await _0xa6b74a(_0x1cf910(0x314),_0x1cf910(0x1587),{'confirmButtonClass':_0x1cf910(0x5e8)});if(_0x22b403){_0x23dfe9['comments'][_0x1cf910(0x36d)](_0x4d21ac,0x1),await _0x6ed281[_0x1cf910(0xed1)][_0x1cf910(0xa0b)](_0xd482fb,{'comments':_0x23dfe9[_0x1cf910(0x4d6)]});if(_0x5e1c3d&&_0x5e1c3d[_0x1cf910(0x9e3)]===_0x16699d[_0x1cf910(0x66e)][_0x1cf910(0xf4d)]){console[_0x1cf910(0x498)](_0x1cf910(0xc38));const _0xe696c8=new Set();_0x23dfe9[_0x1cf910(0x11b9)]!=='user'&&_0xe696c8['add'](_0x23dfe9[_0x1cf910(0x11b9)]);if(_0x5e1c3d[_0x1cf910(0xf05)]){const _0x25f2fe=Object[_0x1cf910(0x1166)](_0x16699d[_0x1cf910(0x1474)])[_0x1cf910(0x1402)](_0x2cd307=>_0x2cd307[_0x1cf910(0x628)]===_0x5e1c3d[_0x1cf910(0xf05)]);_0x25f2fe&&_0xe696c8['add'](_0x25f2fe['id']);}const _0x2cf001=(_0x23dfe9['publicText']||_0x23dfe9['content']||'')[_0x1cf910(0xeca)](0x0,0x1e),_0x393aab=_0x16699d['qzoneSettings']['nickname'];let _0x32e83c;const _0x27da88=_0x16699d[_0x1cf910(0x14a2)][_0x1cf910(0x1402)](_0x3c49d9=>_0x3c49d9[_0x1cf910(0x9a8)]===_0x5e1c3d[_0x1cf910(0x9ea)]);if(_0x27da88)_0x32e83c=_0x1cf910(0xac9)+_0x393aab+_0x1cf910(0x49a)+_0x2cf001+'”下，发送了一个表情评论，意思是：“'+_0x27da88[_0x1cf910(0x1467)]+'”。';else{if(_0x5e1c3d[_0x1cf910(0xf05)]){const _0xe60107=_0x18969a(_0x5e1c3d[_0x1cf910(0xf05)]);_0x32e83c=_0x1cf910(0xac9)+_0x393aab+_0x1cf910(0x49a)+_0x2cf001+'”下，回复了\x27'+_0xe60107+'\x27的评论，内容是：“'+_0x5e1c3d['text']+'”。';}else _0x32e83c='用户\x27'+_0x393aab+_0x1cf910(0xbcc)+_0x2cf001+_0x1cf910(0xf90)+_0x5e1c3d[_0x1cf910(0x9ea)]+'”。';}const _0xd8d3fb='[系统提示：'+_0x32e83c+'请你对此作出回应。]';for(const _0x319686 of _0xe696c8){const _0x2e3024=_0x16699d[_0x1cf910(0x1474)][_0x319686];if(_0x2e3024){const _0x42b146=_0x2e3024['history']['length'];_0x2e3024[_0x1cf910(0xb07)]=_0x2e3024[_0x1cf910(0xb07)][_0x1cf910(0x1c0)](_0x564c7a=>!(_0x564c7a[_0x1cf910(0x583)]&&_0x564c7a[_0x1cf910(0x1554)]===_0x1cf910(0x11af)&&_0x564c7a[_0x1cf910(0xede)]===_0xd8d3fb)),_0x2e3024[_0x1cf910(0xb07)][_0x1cf910(0xaf9)]<_0x42b146&&(console[_0x1cf910(0x498)](_0x1cf910(0xff0)+_0x2e3024['name']+_0x1cf910(0xcf6)),await _0x6ed281[_0x1cf910(0x1474)][_0x1cf910(0x90c)](_0x2e3024));}}}await _0x568043(_0xd482fb);}return;}const _0x18e311=_0x5c31d5[_0x1cf910(0x1090)](_0x1cf910(0x45f));if(_0x18e311){const _0x382674=_0x18e311['closest'](_0x1cf910(0x1439));if(!_0x382674)return;const _0x17b5c9=parseInt(_0x382674['dataset'][_0x1cf910(0xba5)]);_0x17a241[_0x1cf910(0x2c4)]&&_0x17a241[_0x1cf910(0x787)]===_0x17b5c9?_0x3a9f99():_0x5043f0(_0x17b5c9,_0x18e311);return;}const _0x5380b4=_0x5c31d5[_0x1cf910(0x1090)](_0x1cf910(0x8ba));if(_0x5380b4){const _0x2fab2b=parseInt(_0x5380b4[_0x1cf910(0x606)][_0x1cf910(0xba5)]),_0x2d0ffc=_0x5380b4[_0x1cf910(0x606)]['commenterOriginalName'],_0x4a7207=_0x5380b4[_0x1cf910(0x606)][_0x1cf910(0x83d)];if(!_0x2d0ffc||!_0x4a7207||_0x2d0ffc===_0x16699d['qzoneSettings']['nickname']){_0x16e9a0(_0x5380b4[_0x1cf910(0x1090)](_0x1cf910(0x1439)));return;}_0x4a0ce7={'postId':_0x2fab2b,'replyToName':_0x2d0ffc,'replyToDisplayName':_0x4a7207};const _0x47d038=_0x5380b4[_0x1cf910(0x1090)](_0x1cf910(0x1439)),_0x34225e=_0x47d038[_0x1cf910(0xfeb)](_0x1cf910(0x853));_0x34225e[_0x1cf910(0x440)]=_0x1cf910(0xbeb)+_0x4a7207+':',_0x34225e['focus']();return;}if(_0x5c31d5[_0x1cf910(0xd54)][_0x1cf910(0x7a0)](_0x1cf910(0xf0d))){const _0x55241f=_0x5c31d5[_0x1cf910(0x1090)]('.qzone-post-container');if(_0x55241f&&_0x55241f['dataset'][_0x1cf910(0xba5)])_0x5bb1bb(parseInt(_0x55241f[_0x1cf910(0x606)][_0x1cf910(0xba5)]));return;}if(_0x5c31d5[_0x1cf910(0x1440)]===_0x1cf910(0xf1a)&&_0x5c31d5['dataset'][_0x1cf910(0x14ea)]){_0x104485('图片内容',_0x5c31d5['dataset'][_0x1cf910(0x14ea)][_0x1cf910(0x14e9)](/<br>/g,'\x0a'));return;}const _0x17fbf2=_0x5c31d5[_0x1cf910(0x1090)](_0x1cf910(0x1439));if(!_0x17fbf2)return;const _0x3bc797=parseInt(_0x17fbf2[_0x1cf910(0x606)]['postId']);if(isNaN(_0x3bc797))return;if(_0x5c31d5[_0x1cf910(0x1090)](_0x1cf910(0x4e8))){const _0x1f52a5=await _0xa6b74a('删除动态',_0x1cf910(0x12ca),{'confirmButtonClass':_0x1cf910(0x5e8)});_0x1f52a5&&(_0x17fbf2[_0x1cf910(0xf74)][_0x1cf910(0xbc7)]='all\x200.3s\x20ease',_0x17fbf2[_0x1cf910(0xf74)][_0x1cf910(0x79c)]=_0x1cf910(0x6b7),_0x17fbf2[_0x1cf910(0xf74)][_0x1cf910(0x9a2)]='0',setTimeout(async()=>{const _0x41e5c1=_0x1cf910;await _0x6ed281['qzonePosts'][_0x41e5c1(0x869)](_0x3bc797);const _0x13d2ce=_0x41e5c1(0x782)+_0x3bc797+')';for(const _0xc882ba in _0x16699d[_0x41e5c1(0x1474)]){const _0x461d70=_0x16699d[_0x41e5c1(0x1474)][_0xc882ba],_0xf88bb8=_0x461d70[_0x41e5c1(0xb07)][_0x41e5c1(0xaf9)];_0x461d70[_0x41e5c1(0xb07)]=_0x461d70[_0x41e5c1(0xb07)][_0x41e5c1(0x1c0)](_0x226034=>!(_0x226034[_0x41e5c1(0x1554)]==='system'&&_0x226034[_0x41e5c1(0xede)]['includes'](_0x13d2ce)));if(_0x461d70[_0x41e5c1(0xb07)]['length']<_0xf88bb8)await _0x6ed281[_0x41e5c1(0x1474)][_0x41e5c1(0x90c)](_0x461d70);}await _0x4d3afb(),alert(_0x41e5c1(0x699));},0x12c));return;}const _0x345bcd=_0x5c31d5[_0x1cf910(0x1090)](_0x1cf910(0x9b6));if(_0x345bcd){if(_0x345bcd[_0x1cf910(0xd54)][_0x1cf910(0x7a0)]('repost')){_0x213f26(_0x3bc797);return;}if(_0x345bcd[_0x1cf910(0xd54)][_0x1cf910(0x7a0)](_0x1cf910(0xbb1))){const _0xa762=_0x22676c[_0x1cf910(0x1402)](_0x100798=>_0x100798['id']===_0x3bc797);if(!_0xa762)return;if(!_0xa762[_0x1cf910(0x494)])_0xa762[_0x1cf910(0x494)]=[];const _0x5c3734=_0x16699d[_0x1cf910(0x66e)][_0x1cf910(0xf4d)],_0x8b019a=_0xa762[_0x1cf910(0x494)][_0x1cf910(0x539)](_0x5c3734);_0x8b019a>-0x1?_0xa762[_0x1cf910(0x494)][_0x1cf910(0x36d)](_0x8b019a,0x1):(_0xa762[_0x1cf910(0x494)][_0x1cf910(0x1001)](_0x5c3734),_0x345bcd[_0x1cf910(0xd54)][_0x1cf910(0xbd0)](_0x1cf910(0x873)),_0x345bcd[_0x1cf910(0x339)]('animationend',()=>_0x345bcd[_0x1cf910(0xd54)][_0x1cf910(0xf89)]('animate-like'),{'once':!![]})),await _0x6ed281[_0x1cf910(0xed1)][_0x1cf910(0xa0b)](_0x3bc797,{'likes':_0xa762[_0x1cf910(0x494)]}),await _0x568043(_0x3bc797);}if(_0x345bcd[_0x1cf910(0xd54)][_0x1cf910(0x7a0)](_0x1cf910(0xeef))){const _0xa2a96d=await _0x6ed281[_0x1cf910(0x1dc)][_0x1cf910(0x1117)]({'type':_0x1cf910(0x65f),'content.id':_0x3bc797})[_0x1cf910(0x678)]();if(_0xa2a96d)await _0x6ed281[_0x1cf910(0x1dc)]['delete'](_0xa2a96d['id']),await _0x104485('提示',_0x1cf910(0x7b4));else{const _0x356419=await _0x6ed281[_0x1cf910(0xed1)][_0x1cf910(0xe8c)](_0x3bc797);_0x356419&&(await _0x6ed281[_0x1cf910(0x1dc)]['add']({'type':_0x1cf910(0x65f),'content':_0x356419,'timestamp':Date['now']()}),await _0x104485('提示','收藏成功！'));}await _0x568043(_0x3bc797);}return;}const _0x9c4eac=_0x5c31d5[_0x1cf910(0x1090)]('.comment-send-btn');if(_0x9c4eac){const _0x5942ec=_0x17fbf2['querySelector'](_0x1cf910(0x853)),_0x3329b6=_0x5942ec[_0x1cf910(0x5bc)][_0x1cf910(0x2a8)]();if(!_0x3329b6)return alert(_0x1cf910(0x1241));const _0x296e77=_0x22676c[_0x1cf910(0x1402)](_0x11839d=>_0x11839d['id']===_0x3bc797);if(!_0x296e77)return;if(!_0x296e77[_0x1cf910(0x4d6)])_0x296e77[_0x1cf910(0x4d6)]=[];const _0x5edc16={'commenterName':_0x16699d['qzoneSettings'][_0x1cf910(0xf4d)],'text':_0x3329b6,'timestamp':Date['now'](),'replyTo':_0x4a0ce7&&_0x4a0ce7[_0x1cf910(0xba5)]===_0x3bc797?_0x4a0ce7[_0x1cf910(0x7ff)]:null};_0x296e77[_0x1cf910(0x4d6)][_0x1cf910(0x1001)](_0x5edc16),await _0x6ed281[_0x1cf910(0xed1)][_0x1cf910(0xa0b)](_0x3bc797,{'comments':_0x296e77[_0x1cf910(0x4d6)]});let _0x24cfbd=(_0x296e77[_0x1cf910(0x15bf)]||_0x296e77['content']||'')[_0x1cf910(0xeca)](0x0,0x1e);const _0x4d2ce4=_0x16699d[_0x1cf910(0x66e)][_0x1cf910(0xf4d)],_0x1191f6=new Set();if(_0x296e77[_0x1cf910(0x11b9)]!==_0x1cf910(0xaeb))_0x1191f6[_0x1cf910(0xbd0)](_0x296e77[_0x1cf910(0x11b9)]);if(_0x5edc16['replyTo']&&_0x5edc16[_0x1cf910(0xf05)]!==_0x4d2ce4){const _0x49b9ff=Object['values'](_0x16699d[_0x1cf910(0x1474)])[_0x1cf910(0x1402)](_0x233a4a=>_0x233a4a['originalName']===_0x5edc16[_0x1cf910(0xf05)]);if(_0x49b9ff)_0x1191f6[_0x1cf910(0xbd0)](_0x49b9ff['id']);}for(const _0x491d94 of _0x1191f6){const _0x50abf4=_0x16699d[_0x1cf910(0x1474)][_0x491d94];if(_0x50abf4&&!_0x50abf4[_0x1cf910(0x1173)]){const _0xd8d627=_0x16699d[_0x1cf910(0x14a2)]['find'](_0x3ac49f=>_0x3ac49f[_0x1cf910(0x9a8)]===_0x3329b6);let _0x5f55cb=_0xd8d627?'用户\x27'+_0x4d2ce4+_0x1cf910(0x49a)+_0x24cfbd+_0x1cf910(0x10ec)+_0xd8d627['name']+'”。':_0x5edc16['replyTo']?'用户\x27'+_0x4d2ce4+'\x27刚刚在你的动态“'+_0x24cfbd+_0x1cf910(0xe78)+_0x4a0ce7[_0x1cf910(0xce1)]+_0x1cf910(0xfda)+_0x3329b6+'”。':'用户\x27'+_0x4d2ce4+_0x1cf910(0xbcc)+_0x24cfbd+'”，内容是：“'+_0x3329b6+'”。';const _0x2dbc97={'role':_0x1cf910(0x11af),'content':_0x1cf910(0x995)+_0x5f55cb+_0x1cf910(0x14d6),'timestamp':Date[_0x1cf910(0x1386)](),'isHidden':!![]};_0x50abf4['history'][_0x1cf910(0x1001)](_0x2dbc97),await _0x6ed281['chats']['put'](_0x50abf4);}}_0x5942ec[_0x1cf910(0x5bc)]='',_0x16e9a0(_0x17fbf2),await _0x568043(_0x3bc797);return;}}const _0x48dc73=_0x105a46=>{const _0x29d3c5=_0x25f7e9,_0x17cb1b=_0x105a46[_0x29d3c5(0xa50)];if(_0x17cb1b[_0x29d3c5(0x1090)](_0x29d3c5(0xcd1)))return;const _0x53a283=_0x105a46[_0x29d3c5(0xa50)][_0x29d3c5(0x1090)](_0x29d3c5(0x1439));if(!_0x53a283)return;_0x2535c9(_0x53a283),_0x32f5d4[_0x29d3c5(0x57b)]=_0x53a283,_0x32f5d4[_0x29d3c5(0x3f5)]=!![],_0x32f5d4[_0x29d3c5(0xa86)]=!![],_0x32f5d4[_0x29d3c5(0x1195)]=null,_0x32f5d4[_0x29d3c5(0xfb8)]=_0x105a46[_0x29d3c5(0x4ae)][_0x29d3c5(0x1336)](_0x29d3c5(0x1542))?_0x105a46[_0x29d3c5(0x1ed)]:_0x105a46[_0x29d3c5(0x63b)][0x0][_0x29d3c5(0x1ed)],_0x32f5d4[_0x29d3c5(0x11e7)]=_0x105a46[_0x29d3c5(0x4ae)][_0x29d3c5(0x1336)](_0x29d3c5(0x1542))?_0x105a46[_0x29d3c5(0x947)]:_0x105a46[_0x29d3c5(0x63b)][0x0][_0x29d3c5(0x947)],_0x32f5d4[_0x29d3c5(0x57b)][_0x29d3c5(0xfeb)]('.qzone-post-item')['style']['transition']='none',document['addEventListener']('mousemove',_0x1cef10),document[_0x29d3c5(0x339)]('mouseup',_0x4f6764),document[_0x29d3c5(0x339)]('touchmove',_0x1cef10,{'passive':![]}),document[_0x29d3c5(0x339)](_0x29d3c5(0xe38),_0x4f6764);},_0x1cef10=_0x45c6dc=>{const _0x56992a=_0x25f7e9;if(!_0x32f5d4[_0x56992a(0x3f5)]||!_0x32f5d4['activeContainer'])return;const _0x394dc1=_0x45c6dc[_0x56992a(0x4ae)][_0x56992a(0x1336)]('mouse')?_0x45c6dc['pageX']:_0x45c6dc[_0x56992a(0x63b)][0x0]['pageX'],_0x3eefba=_0x45c6dc[_0x56992a(0x4ae)][_0x56992a(0x1336)](_0x56992a(0x1542))?_0x45c6dc[_0x56992a(0x947)]:_0x45c6dc['touches'][0x0][_0x56992a(0x947)],_0x5f0684=_0x394dc1-_0x32f5d4['startX'],_0x253691=_0x3eefba-_0x32f5d4['startY'];_0x32f5d4['isClick']&&(Math['abs'](_0x5f0684)>0x5||Math[_0x56992a(0x7d6)](_0x253691)>0x5)&&(_0x32f5d4[_0x56992a(0xa86)]=![]);!_0x32f5d4[_0x56992a(0x1195)]&&(Math[_0x56992a(0x7d6)](_0x5f0684)>Math[_0x56992a(0x7d6)](_0x253691)?_0x32f5d4['swipeDirection']=_0x56992a(0x1082):_0x32f5d4[_0x56992a(0x1195)]='vertical');if(_0x32f5d4[_0x56992a(0x1195)]===_0x56992a(0x1082)){_0x45c6dc[_0x56992a(0x38f)](),_0x32f5d4[_0x56992a(0x2a2)]=_0x394dc1;let _0x5ebb0e=Math[_0x56992a(0xb63)](0x0,Math[_0x56992a(0x604)](-0x5a,_0x5f0684));_0x32f5d4[_0x56992a(0x57b)][_0x56992a(0xfeb)](_0x56992a(0x5f2))[_0x56992a(0xf74)]['transform']=_0x56992a(0x929)+_0x5ebb0e+'px)';}},_0x4f6764=_0x6b0699=>{const _0x4f5230=_0x25f7e9;document[_0x4f5230(0x1558)](_0x4f5230(0x10a3),_0x1cef10),document[_0x4f5230(0x1558)](_0x4f5230(0x637),_0x4f6764),document[_0x4f5230(0x1558)](_0x4f5230(0x242),_0x1cef10),document['removeEventListener'](_0x4f5230(0xe38),_0x4f6764);if(!_0x32f5d4[_0x4f5230(0x3f5)]||!_0x32f5d4[_0x4f5230(0x57b)])return;const _0x58b4ac=_0x32f5d4[_0x4f5230(0x57b)]['querySelector'](_0x4f5230(0x5f2));_0x58b4ac[_0x4f5230(0xf74)]['transition']=_0x4f5230(0x1488);if(_0x32f5d4['swipeDirection']==='horizontal'&&!_0x32f5d4[_0x4f5230(0xa86)]){const _0x5dfce4=_0x6b0699[_0x4f5230(0x4ae)][_0x4f5230(0x1336)]('touchend')?_0x6b0699[_0x4f5230(0x106a)][0x0][_0x4f5230(0x1ed)]:_0x6b0699[_0x4f5230(0x1ed)],_0x283277=_0x5dfce4-_0x32f5d4[_0x4f5230(0xfb8)];_0x283277<-0x28?_0x58b4ac['classList'][_0x4f5230(0xbd0)]('swiped'):_0x58b4ac['classList']['remove'](_0x4f5230(0x13d8));}_0x58b4ac[_0x4f5230(0xf74)][_0x4f5230(0x79c)]='',_0x32f5d4[_0x4f5230(0x3f5)]=![],_0x32f5d4[_0x4f5230(0x57b)]=null,_0x32f5d4[_0x4f5230(0x1195)]=null,_0x32f5d4[_0x4f5230(0xa86)]=!![];};_0x5e6b67[_0x25f7e9(0x339)]('click',_0x52079a),_0x5e6b67[_0x25f7e9(0x339)](_0x25f7e9(0xf08),_0x48dc73),_0x5e6b67['addEventListener']('touchstart',_0x48dc73,{'passive':!![]}),_0x5e6b67[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x522398=>{const _0xc7732b=_0x25f7e9;_0x522398[_0xc7732b(0xa50)]&&_0x522398[_0xc7732b(0xa50)]['id']===_0xc7732b(0x6b3)&&_0x4b7636();}),document[_0x25f7e9(0x948)](_0x25f7e9(0x29a))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x59d8b2=_0x25f7e9;_0x16699d[_0x59d8b2(0xf5a)]&&_0x224d5b(_0x16699d['activeChatId']);}),document['getElementById'](_0x25f7e9(0x759))[_0x25f7e9(0x339)]('change',_0x317a0e),document[_0x25f7e9(0x948)](_0x25f7e9(0x6f7))[_0x25f7e9(0x339)]('click',_0x5a3a77),document['getElementById'](_0x25f7e9(0x913))['addEventListener']('click',_0x5e8d5d),document[_0x25f7e9(0x948)](_0x25f7e9(0xdf0))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x1e380a=_0x25f7e9,_0x33ddf0=document[_0x1e380a(0x948)](_0x1e380a(0x122e));_0x33ddf0['querySelector']('p')&&(_0x33ddf0[_0x1e380a(0xb6f)]='');const _0x54b774=_0x1078f4();_0x33ddf0[_0x1e380a(0x6b6)](_0x54b774),_0x54b774[_0x1e380a(0xfeb)](_0x1e380a(0x2eb))['focus']();}),document['getElementById']('switch-greeting-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x127842),document[_0x25f7e9(0x948)]('thoughts-history-list')[_0x25f7e9(0x339)]('click',_0x523fca=>{const _0x885acc=_0x25f7e9;_0x523fca['target']&&_0x523fca[_0x885acc(0xa50)]['id']===_0x885acc(0xa14)&&_0xc4de1f();}),document['getElementById'](_0x25f7e9(0x27c))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x2a2a95),document[_0x25f7e9(0x948)]('history-back-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x12ca3c),document[_0x25f7e9(0x948)]('character-profile-modal')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x130b36=>{const _0x6171f0=_0x25f7e9;_0x130b36['target']['id']===_0x6171f0(0xe7e)&&_0x130b36['target'][_0x6171f0(0xd54)]['remove'](_0x6171f0(0xfcb));}),document['getElementById'](_0x25f7e9(0x34f))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x1c9d58),document['getElementById'](_0x25f7e9(0x1495))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3c930e),document[_0x25f7e9(0x948)](_0x25f7e9(0xb02))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>_0x779269(_0x25f7e9(0x14d7))),document[_0x25f7e9(0x948)]('favorites-back-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>_0x779269('messages-view'));const _0x5ed9ba=document[_0x25f7e9(0x948)]('favorites-search-input'),_0x44ceb4=document[_0x25f7e9(0x948)]('favorites-search-clear-btn');_0x5ed9ba['addEventListener'](_0x25f7e9(0xc48),()=>{const _0x36eed6=_0x25f7e9,_0x1e882d=_0x5ed9ba['value']['trim']()['toLowerCase']();_0x44ceb4[_0x36eed6(0xf74)][_0x36eed6(0x11fd)]=_0x1e882d?_0x36eed6(0x1273):_0x36eed6(0x12fe);if(!_0x1e882d){_0x2fa1b9(allFavoriteItems);return;}const _0x397dd8=allFavoriteItems[_0x36eed6(0x1c0)](_0x452431=>{const _0x5cdaef=_0x36eed6;let _0x2e061e='',_0x4fd2b3='';if(_0x452431[_0x5cdaef(0x4ae)]==='qzone_post'){const _0x385e96=_0x452431[_0x5cdaef(0xede)];_0x2e061e+=(_0x385e96[_0x5cdaef(0x15bf)]||'')+'\x20'+(_0x385e96[_0x5cdaef(0xede)]||'');if(_0x385e96[_0x5cdaef(0x11b9)]==='user')_0x4fd2b3=_0x16699d['qzoneSettings']['nickname'];else _0x16699d[_0x5cdaef(0x1474)][_0x385e96['authorId']]&&(_0x4fd2b3=_0x16699d['chats'][_0x385e96['authorId']]['name']);}else{if(_0x452431[_0x5cdaef(0x4ae)]==='chat_message'){const _0x13c3dd=_0x452431['content'];typeof _0x13c3dd[_0x5cdaef(0xede)]===_0x5cdaef(0x273)&&(_0x2e061e=_0x13c3dd[_0x5cdaef(0xede)]);const _0x3de5c0=_0x16699d[_0x5cdaef(0x1474)][_0x452431[_0x5cdaef(0x1029)]];_0x3de5c0&&(_0x13c3dd['role']===_0x5cdaef(0xaeb)?_0x4fd2b3=_0x3de5c0['isGroup']?_0x3de5c0[_0x5cdaef(0x7fd)]['myNickname']||'我':'我':_0x4fd2b3=_0x3de5c0['isGroup']?_0x13c3dd['senderName']:_0x3de5c0[_0x5cdaef(0x1467)]);}}return _0x2e061e[_0x5cdaef(0x1331)]()[_0x5cdaef(0x1336)](_0x1e882d)||_0x4fd2b3[_0x5cdaef(0x1331)]()[_0x5cdaef(0x1336)](_0x1e882d);});_0x2fa1b9(_0x397dd8);}),_0x44ceb4[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x3ba795=_0x25f7e9;_0x5ed9ba[_0x3ba795(0x5bc)]='',_0x44ceb4[_0x3ba795(0xf74)][_0x3ba795(0x11fd)]=_0x3ba795(0x12fe),_0x2fa1b9(allFavoriteItems),_0x5ed9ba['focus']();}),document['getElementById'](_0x25f7e9(0xdfc))[_0x25f7e9(0x339)]('click',async()=>{const _0x127813=_0x25f7e9;if(_0x355e3f[_0x127813(0x8ca)]===0x0)return;const _0x2e1c67=_0x16699d[_0x127813(0x1474)][_0x16699d[_0x127813(0xf5a)]];if(!_0x2e1c67)return;const _0x1e4abc=[],_0x594516=[..._0x355e3f];for(const _0x299366 of _0x594516){const _0x4e3dd6=await _0x6ed281[_0x127813(0x1dc)]['where'](_0x127813(0xeb8))['equals'](_0x299366)[_0x127813(0x678)]();if(!_0x4e3dd6){const _0x24306d=_0x2e1c67['history']['find'](_0x3cd3f3=>_0x3cd3f3[_0x127813(0xb0a)]===_0x299366);_0x24306d&&_0x1e4abc['push']({'type':'chat_message','content':_0x24306d,'chatId':_0x16699d['activeChatId'],'timestamp':Date[_0x127813(0x1386)](),'originalTimestamp':_0x24306d[_0x127813(0xb0a)]});}}_0x1e4abc[_0x127813(0xaf9)]>0x0?(await _0x6ed281[_0x127813(0x1dc)][_0x127813(0x571)](_0x1e4abc),allFavoriteItems=await _0x6ed281[_0x127813(0x1dc)]['orderBy'](_0x127813(0xb0a))['reverse']()[_0x127813(0x443)](),await _0x104485(_0x127813(0x550),'已成功收藏\x20'+_0x1e4abc[_0x127813(0xaf9)]+_0x127813(0x3b4))):await _0x104485('提示',_0x127813(0x656)),_0x402014();});const _0x3ca7e2=document[_0x25f7e9(0x948)](_0x25f7e9(0x415)),_0x1ae60f=document[_0x25f7e9(0x948)](_0x25f7e9(0x11e0)),_0x50cac1=document[_0x25f7e9(0x948)](_0x25f7e9(0x10fa)),_0x3f4763=document['getElementById'](_0x25f7e9(0x983)),_0x1ef9d0=document[_0x25f7e9(0x948)]('favorites-list');_0x3ca7e2[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x4994ff=_0x25f7e9;_0x53c21a=!_0x53c21a,_0x1ae60f[_0x4994ff(0xd54)]['toggle'](_0x4994ff(0x105f),_0x53c21a),_0x53c21a?(_0x3ca7e2['textContent']='完成',_0x50cac1['style'][_0x4994ff(0x11fd)]=_0x4994ff(0x1273),_0x3f4763[_0x4994ff(0xf74)][_0x4994ff(0x11fd)]='none',_0x1ef9d0['style'][_0x4994ff(0x1aa)]=_0x4994ff(0x894)):(_0x3ca7e2[_0x4994ff(0x10cb)]='编辑',_0x50cac1['style']['display']=_0x4994ff(0x12fe),_0x3f4763[_0x4994ff(0xf74)]['display']=_0x4994ff(0x6a4),_0x1ef9d0['style']['paddingBottom']='',_0x4c22f5[_0x4994ff(0x99d)](),document[_0x4994ff(0x1188)](_0x4994ff(0x653))[_0x4994ff(0x427)](_0x40fc71=>_0x40fc71[_0x4994ff(0xd54)]['remove'](_0x4994ff(0xd56))),document[_0x4994ff(0x948)](_0x4994ff(0x35a))['textContent']=_0x4994ff(0xde8));}),document[_0x25f7e9(0x948)]('favorites-list')['addEventListener'](_0x25f7e9(0x4f6),_0x257aa7=>{const _0x82976d=_0x25f7e9,_0x344c56=_0x257aa7[_0x82976d(0xa50)],_0x221291=_0x344c56[_0x82976d(0x1090)](_0x82976d(0xd80));if(_0x344c56['tagName']===_0x82976d(0xf1a)&&_0x344c56[_0x82976d(0x606)]['hiddenText']){const _0x376520=_0x344c56['dataset']['hiddenText'];_0x104485(_0x82976d(0xd98),_0x376520[_0x82976d(0x14e9)](/<br>/g,'\x0a'));return;}if(!_0x53c21a)return;if(!_0x221291)return;const _0x2fcf18=parseInt(_0x221291[_0x82976d(0x606)][_0x82976d(0x362)]);if(isNaN(_0x2fcf18))return;_0x4c22f5[_0x82976d(0xda1)](_0x2fcf18)?(_0x4c22f5[_0x82976d(0x869)](_0x2fcf18),_0x221291[_0x82976d(0xd54)]['remove'](_0x82976d(0xd56))):(_0x4c22f5[_0x82976d(0xbd0)](_0x2fcf18),_0x221291[_0x82976d(0xd54)]['add'](_0x82976d(0xd56))),document[_0x82976d(0x948)]('favorites-delete-selected-btn')[_0x82976d(0x10cb)]='删除\x20('+_0x4c22f5['size']+')';}),document[_0x25f7e9(0x948)](_0x25f7e9(0x35a))[_0x25f7e9(0x339)]('click',async()=>{const _0x53111f=_0x25f7e9;if(_0x4c22f5[_0x53111f(0x8ca)]===0x0)return;const _0x3fe648=await _0xa6b74a('确认删除',_0x53111f(0x665)+_0x4c22f5[_0x53111f(0x8ca)]+_0x53111f(0xd7a),{'confirmButtonClass':_0x53111f(0x5e8)});if(_0x3fe648){const _0x565755=[..._0x4c22f5];await _0x6ed281[_0x53111f(0x1dc)]['bulkDelete'](_0x565755),await _0x104485(_0x53111f(0x111a),_0x53111f(0x5cc)),allFavoriteItems=allFavoriteItems['filter'](_0x7f6918=>!_0x565755['includes'](_0x7f6918['id'])),_0x2fa1b9(allFavoriteItems),_0x3ca7e2[_0x53111f(0x4f6)]();}});_0x16699d[_0x25f7e9(0xf9c)][_0x25f7e9(0x1028)]&&(_0x356441(),console[_0x25f7e9(0x498)](_0x25f7e9(0xf64)));document[_0x25f7e9(0x1188)]('input[name=\x22theme-select\x22]')[_0x25f7e9(0x427)](_0x33eb05=>{const _0x4ed1a6=_0x25f7e9;_0x33eb05['addEventListener'](_0x4ed1a6(0x145c),_0x3cc02f);});const _0x36fbc5=document[_0x25f7e9(0x948)](_0x25f7e9(0x1d7));_0x36fbc5[_0x25f7e9(0x339)](_0x25f7e9(0xc48),()=>{const _0x234e1e=_0x25f7e9;document[_0x234e1e(0x948)]('font-size-value')[_0x234e1e(0x10cb)]=_0x36fbc5[_0x234e1e(0x5bc)]+'px',_0x3cc02f();});const _0x4c0682=document[_0x25f7e9(0x948)](_0x25f7e9(0xe01));_0x4c0682['addEventListener'](_0x25f7e9(0xc48),_0x3cc02f),document['getElementById'](_0x25f7e9(0xdb2))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x2de598=_0x25f7e9;document[_0x2de598(0x948)](_0x2de598(0xd4c))['checked']=!![],_0x3cc02f();}),document[_0x25f7e9(0x948)](_0x25f7e9(0x84a))[_0x25f7e9(0x339)]('click',()=>{const _0x1975ff=_0x25f7e9;document[_0x1975ff(0x948)](_0x1975ff(0xe01))[_0x1975ff(0x5bc)]='',_0x3cc02f();}),document[_0x25f7e9(0x948)]('lyrics-vertical-pos')[_0x25f7e9(0x339)](_0x25f7e9(0x145c),_0x3cc02f),document[_0x25f7e9(0x948)](_0x25f7e9(0x2d6))[_0x25f7e9(0x339)](_0x25f7e9(0x145c),_0x3cc02f),document[_0x25f7e9(0x948)](_0x25f7e9(0xc40))[_0x25f7e9(0x339)](_0x25f7e9(0xc48),_0x3cc02f),document[_0x25f7e9(0x1188)](_0x25f7e9(0x10ca))[_0x25f7e9(0x427)](_0x24304b=>{_0x24304b['addEventListener']('change',function(){const _0x3784eb=_0x6c9e,_0x42a32b=document[_0x3784eb(0x948)]('post-visibility-groups');this[_0x3784eb(0x5bc)]==='include'||this['value']===_0x3784eb(0xe0b)?_0x42a32b[_0x3784eb(0xf74)][_0x3784eb(0x11fd)]=_0x3784eb(0x1273):_0x42a32b[_0x3784eb(0xf74)][_0x3784eb(0x11fd)]=_0x3784eb(0x12fe);});}),document[_0x25f7e9(0x948)]('manage-groups-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x4f869a),document[_0x25f7e9(0x948)]('close-group-manager-btn')[_0x25f7e9(0x339)]('click',()=>{const _0x16b714=_0x25f7e9;document[_0x16b714(0x948)](_0x16b714(0xa08))[_0x16b714(0xd54)][_0x16b714(0xf89)](_0x16b714(0xfcb));const _0x15e3ee=document[_0x16b714(0x948)](_0x16b714(0x7b8));document[_0x16b714(0x948)]('chat-settings-modal')[_0x16b714(0xd54)][_0x16b714(0x7a0)](_0x16b714(0xfcb))&&_0x15e3ee[_0x16b714(0x4f6)]();}),document[_0x25f7e9(0x948)](_0x25f7e9(0x1534))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x459e38),document['getElementById'](_0x25f7e9(0xc1c))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x195314=>{const _0x50dd23=_0x25f7e9;if(_0x195314['target'][_0x50dd23(0xd54)][_0x50dd23(0x7a0)](_0x50dd23(0x529))){const _0x498343=parseInt(_0x195314['target'][_0x50dd23(0x606)]['id']);_0x105e8f(_0x498343);}}),document['getElementById']('cancel-message-action-btn')['addEventListener'](_0x25f7e9(0x4f6),_0x115ec8),document[_0x25f7e9(0x948)](_0x25f7e9(0xd8a))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x924e1e),document['getElementById'](_0x25f7e9(0xde2))['addEventListener'](_0x25f7e9(0x4f6),_0x151761),document[_0x25f7e9(0x948)](_0x25f7e9(0x4d0))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x1262b0),document[_0x25f7e9(0x948)](_0x25f7e9(0x15ab))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x4593f3=_0x441f4f;_0x115ec8(),_0x4593f3&&_0x24304d(_0x4593f3);}),document[_0x25f7e9(0x948)](_0x25f7e9(0x91c))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x19db1c=>{const _0x85241b=_0x25f7e9,_0x1ede87=_0x19db1c['target'][_0x85241b(0x1090)](_0x85241b(0x10a6));if(!_0x1ede87)return;if(_0x1ede87[_0x85241b(0xd54)]['contains']('ai')&&_0x1ede87[_0x85241b(0xd54)][_0x85241b(0x7a0)](_0x85241b(0xcf9))&&_0x1ede87[_0x85241b(0x606)]['status']===_0x85241b(0x150c)){const _0x79f219=parseInt(_0x1ede87['dataset']['timestamp']);!isNaN(_0x79f219)&&_0x37a552(_0x79f219);}}),document[_0x25f7e9(0x948)](_0x25f7e9(0x14a6))['addEventListener'](_0x25f7e9(0x4f6),()=>_0xfd429(_0x25f7e9(0x855))),document[_0x25f7e9(0x948)]('transfer-action-decline')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>_0xfd429(_0x25f7e9(0x777))),document[_0x25f7e9(0x948)](_0x25f7e9(0x955))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x52a80f),document[_0x25f7e9(0x948)](_0x25f7e9(0x69b))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x36b045),document[_0x25f7e9(0x948)]('copy-post-btn')['addEventListener'](_0x25f7e9(0x4f6),_0x3b4373),document[_0x25f7e9(0x948)](_0x25f7e9(0x9cf))[_0x25f7e9(0x339)]('click',_0x38b910),document['getElementById'](_0x25f7e9(0xb04))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x5d1c3c=_0x25f7e9;_0x58c3b1(_0x5d1c3c(0x82a));}),document[_0x25f7e9(0x948)]('contact-picker-list')['addEventListener'](_0x25f7e9(0x4f6),_0x45b6ae=>{const _0x3473f4=_0x25f7e9,_0x11aea7=_0x45b6ae[_0x3473f4(0xa50)]['closest'](_0x3473f4(0x229));if(!_0x11aea7)return;const _0x2d28dd=_0x11aea7[_0x3473f4(0x606)]['contactId'];_0x11aea7[_0x3473f4(0xd54)][_0x3473f4(0x69d)](_0x3473f4(0xd56)),_0x36d00c[_0x3473f4(0xda1)](_0x2d28dd)?_0x36d00c[_0x3473f4(0x869)](_0x2d28dd):_0x36d00c[_0x3473f4(0xbd0)](_0x2d28dd),_0x2a3936();}),document[_0x25f7e9(0x948)](_0x25f7e9(0x223))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{_0x37bf66();}),document[_0x25f7e9(0x948)](_0x25f7e9(0x11f7))['addEventListener'](_0x25f7e9(0x4f6),()=>{const _0x4ac0eb=_0x25f7e9;_0x58c3b1(_0x4ac0eb(0x152e)),document[_0x4ac0eb(0x948)](_0x4ac0eb(0x7b8))[_0x4ac0eb(0x4f6)]();}),document[_0x25f7e9(0x948)](_0x25f7e9(0xce0))[_0x25f7e9(0x339)]('click',_0x38c7e2=>{const _0x268d4a=_0x25f7e9;_0x38c7e2[_0x268d4a(0xa50)][_0x268d4a(0xd54)][_0x268d4a(0x7a0)](_0x268d4a(0x1490))&&_0x3d453d(_0x38c7e2[_0x268d4a(0xa50)]['dataset'][_0x268d4a(0x13bb)]);}),document[_0x25f7e9(0x948)]('add-existing-contact-btn')['addEventListener']('click',async()=>{const _0x368356=_0x25f7e9,_0x4193a2=document[_0x368356(0x948)](_0x368356(0x6bb)),_0x1ceac3=_0x4193a2[_0x368356(0xfc0)](!![]);_0x4193a2[_0x368356(0x1579)][_0x368356(0x868)](_0x1ceac3,_0x4193a2),_0x1ceac3[_0x368356(0x339)](_0x368356(0x4f6),_0x351c15),await _0xf5ec62();}),document['getElementById']('create-new-member-btn')['addEventListener'](_0x25f7e9(0x4f6),_0x470065),document[_0x25f7e9(0x948)](_0x25f7e9(0xb81))['addEventListener'](_0x25f7e9(0x4f6),_0x472fb7),document['getElementById'](_0x25f7e9(0x82e))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x472fb7),document[_0x25f7e9(0x948)](_0x25f7e9(0x3b3))['addEventListener'](_0x25f7e9(0x4f6),_0x2c3e36),document['getElementById']('cancel-call-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x463967=_0x25f7e9;_0x1c6d6b[_0x463967(0xab7)]=![],_0x58c3b1(_0x463967(0x152e));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x83c))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x43312d),document['getElementById'](_0x25f7e9(0x1184))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x525ac6=_0x25f7e9;_0x183e94();const _0x2c5630=_0x16699d[_0x525ac6(0x1474)][_0x1c6d6b['activeChatId']];if(!_0x2c5630)return;if(_0x1c6d6b[_0x525ac6(0x658)]){_0x1c6d6b[_0x525ac6(0xdd6)]=![];const _0x28f526={'role':_0x525ac6(0x11af),'content':_0x525ac6(0x9ef),'timestamp':Date[_0x525ac6(0x1386)](),'isHidden':!![]};_0x2c5630[_0x525ac6(0xb07)][_0x525ac6(0x1001)](_0x28f526),await _0x6ed281[_0x525ac6(0x1474)]['put'](_0x2c5630),await _0x45c50a();}else{const _0x19ffe1={'role':_0x525ac6(0xaeb),'content':_0x525ac6(0x2b2),'timestamp':Date[_0x525ac6(0x1386)]()};_0x2c5630[_0x525ac6(0xb07)]['push'](_0x19ffe1),await _0x6ed281[_0x525ac6(0x1474)][_0x525ac6(0x90c)](_0x2c5630),_0x58c3b1(_0x525ac6(0x152e)),_0x4b384e(_0x19ffe1,_0x2c5630),_0x45c50a();}_0x1c6d6b['isAwaitingResponse']=![];}),document['getElementById'](_0x25f7e9(0xc97))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x5e7b5d=_0x25f7e9;_0x183e94(),_0x1c6d6b[_0x5e7b5d(0x840)]='ai',_0x1c6d6b[_0x5e7b5d(0xdd6)]=!![],_0x1c6d6b['activeChatId']=_0x16699d[_0x5e7b5d(0xf5a)];if(_0x1c6d6b[_0x5e7b5d(0x658)]){const _0x1df7a5=_0x16699d[_0x5e7b5d(0x1474)][_0x1c6d6b[_0x5e7b5d(0xf5a)]],_0x54578d=_0x1df7a5['members'][_0x5e7b5d(0x1402)](_0x4172b2=>_0x4172b2[_0x5e7b5d(0x1467)]===_0x1c6d6b[_0x5e7b5d(0xcd5)]);_0x54578d?_0x1c6d6b['participants']=[_0x54578d]:_0x1c6d6b[_0x5e7b5d(0x112b)]=[];}_0x294d96();}),document[_0x25f7e9(0x948)](_0x25f7e9(0x862))[_0x25f7e9(0x339)]('click',async()=>{const _0x128cce=_0x25f7e9;if(!_0x1c6d6b[_0x128cce(0x1032)])return;const _0x520f69=document['querySelector'](_0x128cce(0x135f));_0x520f69&&_0x520f69[_0x128cce(0xd54)][_0x128cce(0xbd0)]('speaking');const _0x2242ab=await _0x41b9fc('你说',_0x128cce(0xf7a));_0x520f69&&_0x520f69[_0x128cce(0xd54)][_0x128cce(0xf89)](_0x128cce(0xac4)),_0x2242ab&&_0x2242ab['trim']()&&_0xc4d3ec(_0x2242ab['trim']());}),document[_0x25f7e9(0xfeb)]('.nav-item[data-view=\x22memories-view\x22]')['addEventListener'](_0x25f7e9(0x4f6),()=>{const _0x5ef2ed=_0x25f7e9;_0x53c21a&&document[_0x5ef2ed(0x948)](_0x5ef2ed(0x415))['click'](),_0x779269('memories-view'),_0x568e51();}),document[_0x25f7e9(0x948)](_0x25f7e9(0x1499))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>_0x779269('messages-view')),document[_0x25f7e9(0x948)](_0x25f7e9(0x6a5))[_0x25f7e9(0x339)]('click',async()=>{const _0x21f214=_0x25f7e9,_0x35a366=document[_0x21f214(0x948)](_0x21f214(0xd39))['value'][_0x21f214(0x2a8)](),_0x20ab6c=document[_0x21f214(0x948)](_0x21f214(0xe6a))[_0x21f214(0x5bc)];if(!_0x35a366||!_0x20ab6c){alert(_0x21f214(0xf55));return;}const _0x5bd64d=new Date(_0x20ab6c);if(isNaN(_0x5bd64d)||_0x5bd64d<=new Date()){alert('请输入一个有效的、未来的日期！');return;}const _0x4ce9e1={'authorId':_0x21f214(0xaeb),'description':_0x35a366,'timestamp':Date['now'](),'type':_0x21f214(0xa6b),'targetDate':_0x5bd64d['getTime']()};await _0x6ed281[_0x21f214(0x9cc)]['add'](_0x4ce9e1),document['getElementById'](_0x21f214(0x150e))[_0x21f214(0xd54)][_0x21f214(0xf89)](_0x21f214(0xfcb)),_0x568e51();}),document['getElementById'](_0x25f7e9(0x802))['addEventListener']('click',async()=>{const _0x5e9322=_0x25f7e9;if(!_0x16699d[_0x5e9322(0xf5a)]||_0x16699d[_0x5e9322(0x1474)][_0x16699d[_0x5e9322(0xf5a)]][_0x5e9322(0x1173)])return;const _0x4cef7f=_0x16699d[_0x5e9322(0x1474)][_0x16699d[_0x5e9322(0xf5a)]],_0x55f6d7=await _0xa6b74a(_0x5e9322(0x1321),_0x5e9322(0x74a)+_0x4cef7f['name']+_0x5e9322(0x674),{'confirmButtonClass':_0x5e9322(0x5e8)});if(_0x55f6d7){_0x4cef7f['relationship'][_0x5e9322(0x82c)]=_0x5e9322(0x1572),_0x4cef7f[_0x5e9322(0x1120)]['blockedTimestamp']=Date[_0x5e9322(0x1386)]();const _0x5dae66={'role':_0x5e9322(0x11af),'content':'[系统提示：你刚刚被用户拉黑了。在对方解除拉黑之前，你无法再主动发起对话，也无法回应。]','timestamp':Date['now']()+0x1,'isHidden':!![]};_0x4cef7f['history'][_0x5e9322(0x1001)](_0x5dae66),await _0x6ed281[_0x5e9322(0x1474)][_0x5e9322(0x90c)](_0x4cef7f),document[_0x5e9322(0x948)]('chat-settings-modal')[_0x5e9322(0xd54)][_0x5e9322(0xf89)](_0x5e9322(0xfcb)),_0x455873(_0x16699d[_0x5e9322(0xf5a)]),_0x2d33eb();}}),document[_0x25f7e9(0x948)](_0x25f7e9(0x122f))['addEventListener'](_0x25f7e9(0x4f6),async _0x39d3c3=>{const _0x27786d=_0x25f7e9,_0x2d8ba4=_0x16699d[_0x27786d(0x1474)][_0x16699d['activeChatId']];if(!_0x2d8ba4)return;if(_0x39d3c3['target']['id']===_0x27786d(0xcfe)){alert(_0x27786d(0x313)),await _0x530b7b(_0x2d8ba4['id']),_0x455873(_0x2d8ba4['id']);return;}if(_0x39d3c3[_0x27786d(0xa50)]['id']===_0x27786d(0x142a)){_0x2d8ba4[_0x27786d(0x1120)][_0x27786d(0x82c)]=_0x27786d(0x1431),_0x2d8ba4[_0x27786d(0x1120)][_0x27786d(0xbab)]=null;const _0x17ec93={'role':_0x27786d(0x11af),'content':_0x27786d(0x3ee),'timestamp':Date[_0x27786d(0x1386)](),'isHidden':!![]};_0x2d8ba4[_0x27786d(0xb07)]['push'](_0x17ec93),await _0x6ed281[_0x27786d(0x1474)]['put'](_0x2d8ba4),_0x455873(_0x2d8ba4['id']),_0x2d33eb(),_0x45c50a();}else{if(_0x39d3c3['target']['id']===_0x27786d(0x114d)){_0x2d8ba4[_0x27786d(0x1120)][_0x27786d(0x82c)]=_0x27786d(0x1431),_0x2d8ba4['relationship']['applicationReason']='';const _0xf9fd84={'role':_0x27786d(0x11af),'type':_0x27786d(0xb96),'content':_0x27786d(0xaab)+_0x2d8ba4[_0x27786d(0x1467)]+'”的好友请求','timestamp':Date[_0x27786d(0x1386)]()};_0x2d8ba4[_0x27786d(0xb07)][_0x27786d(0x1001)](_0xf9fd84);const _0x421acb={'role':'assistant','senderName':_0x2d8ba4[_0x27786d(0x1467)],'content':'太好了！我们又可以聊天啦！','timestamp':Date[_0x27786d(0x1386)]()+0x1};_0x2d8ba4[_0x27786d(0xb07)][_0x27786d(0x1001)](_0x421acb),await _0x6ed281[_0x27786d(0x1474)][_0x27786d(0x90c)](_0x2d8ba4),_0x455873(_0x2d8ba4['id']),_0x2d33eb();}else{if(_0x39d3c3[_0x27786d(0xa50)]['id']===_0x27786d(0x2f8))_0x2d8ba4[_0x27786d(0x1120)][_0x27786d(0x82c)]='blocked_by_user',_0x2d8ba4['relationship'][_0x27786d(0xbab)]=Date[_0x27786d(0x1386)](),_0x2d8ba4['relationship'][_0x27786d(0x60f)]='',await _0x6ed281['chats'][_0x27786d(0x90c)](_0x2d8ba4),_0x455873(_0x2d8ba4['id']);else{if(_0x39d3c3[_0x27786d(0xa50)]['id']===_0x27786d(0xcac)){const _0x429fdc=await _0x41b9fc(_0x27786d(0x137e),_0x27786d(0x2f0)+_0x2d8ba4[_0x27786d(0x1467)]+'”说的申请理由：',_0x27786d(0xf43));_0x429fdc!==null&&(_0x2d8ba4[_0x27786d(0x1120)][_0x27786d(0x82c)]=_0x27786d(0x21b),_0x2d8ba4['relationship'][_0x27786d(0x60f)]=_0x429fdc,await _0x6ed281['chats']['put'](_0x2d8ba4),_0x455873(_0x2d8ba4['id']),_0x2d33eb(),_0x45c50a());}}}}}),document[_0x25f7e9(0x948)]('transfer-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x2cd9d1),document[_0x25f7e9(0x948)](_0x25f7e9(0x8c2))['addEventListener'](_0x25f7e9(0x4f6),()=>{const _0x237a2f=_0x25f7e9;document[_0x237a2f(0x948)](_0x237a2f(0x8c1))[_0x237a2f(0xd54)][_0x237a2f(0xf89)](_0x237a2f(0xfcb));}),document['getElementById'](_0x25f7e9(0x876))[_0x25f7e9(0x339)]('click',_0x3762e2),document[_0x25f7e9(0x948)](_0x25f7e9(0xfc5))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x394166);const _0x197ac1=document[_0x25f7e9(0x948)]('rp-tab-group'),_0xa8e54c=document[_0x25f7e9(0x948)](_0x25f7e9(0xb2d)),_0x2a13f8=document[_0x25f7e9(0x948)](_0x25f7e9(0xd4a)),_0x239d95=document[_0x25f7e9(0x948)]('rp-content-direct');_0x197ac1['addEventListener']('click',()=>{const _0x2dd7d5=_0x25f7e9;_0x197ac1[_0x2dd7d5(0xd54)]['add'](_0x2dd7d5(0x115e)),_0xa8e54c[_0x2dd7d5(0xd54)]['remove'](_0x2dd7d5(0x115e)),_0x2a13f8['style'][_0x2dd7d5(0x11fd)]=_0x2dd7d5(0x1273),_0x239d95[_0x2dd7d5(0xf74)][_0x2dd7d5(0x11fd)]=_0x2dd7d5(0x12fe);}),_0xa8e54c[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x268ed5=_0x25f7e9;_0xa8e54c[_0x268ed5(0xd54)][_0x268ed5(0xbd0)](_0x268ed5(0x115e)),_0x197ac1[_0x268ed5(0xd54)][_0x268ed5(0xf89)]('active'),_0x239d95[_0x268ed5(0xf74)][_0x268ed5(0x11fd)]=_0x268ed5(0x1273),_0x2a13f8['style']['display']=_0x268ed5(0x12fe);}),document['getElementById']('rp-group-amount')[_0x25f7e9(0x339)](_0x25f7e9(0xc48),_0x3fb97a=>{const _0x192550=_0x25f7e9,_0x226026=parseFloat(_0x3fb97a[_0x192550(0xa50)][_0x192550(0x5bc)])||0x0;document['getElementById'](_0x192550(0x602))['textContent']='¥\x20'+_0x226026[_0x192550(0xd69)](0x2);}),document[_0x25f7e9(0x948)](_0x25f7e9(0x1138))['addEventListener'](_0x25f7e9(0xc48),_0x36cbb8=>{const _0x35232c=_0x25f7e9,_0x23cd19=parseFloat(_0x36cbb8[_0x35232c(0xa50)]['value'])||0x0;document[_0x35232c(0x948)](_0x35232c(0x5c7))[_0x35232c(0x10cb)]='¥\x20'+_0x23cd19['toFixed'](0x2);}),document[_0x25f7e9(0x948)](_0x25f7e9(0x91c))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x1ae7a9=>{const _0x551518=_0x25f7e9,_0x2fda83=_0x1ae7a9['target'][_0x551518(0x1090)](_0x551518(0x6b0));if(!_0x2fda83)return;const _0x35de7b=_0x2fda83[_0x551518(0x1090)](_0x551518(0x10a6));if(!_0x35de7b||!_0x35de7b[_0x551518(0x606)][_0x551518(0xb0a)])return;const _0x13aea4=parseInt(_0x35de7b['dataset']['timestamp']);_0xf9f4c(_0x13aea4);}),document[_0x25f7e9(0x948)](_0x25f7e9(0xd3e))[_0x25f7e9(0x339)]('click',_0x3fd256),document[_0x25f7e9(0x948)](_0x25f7e9(0xb05))['addEventListener'](_0x25f7e9(0x4f6),_0x1ffc42),document['getElementById'](_0x25f7e9(0x7b1))[_0x25f7e9(0x339)]('click',()=>{const _0x578696=_0x25f7e9;document['getElementById'](_0x578696(0x5e4))[_0x578696(0xd54)][_0x578696(0xf89)](_0x578696(0xfcb));}),document['getElementById'](_0x25f7e9(0xd16))['addEventListener']('click',_0x35435c),document['getElementById'](_0x25f7e9(0x91c))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x5118bd=>{const _0x4eca22=_0x25f7e9,_0x39592b=_0x5118bd['target']['closest'](_0x4eca22(0x127b));if(!_0x39592b)return;const _0x4660d5=parseInt(_0x39592b[_0x4eca22(0x606)][_0x4eca22(0x792)]);if(isNaN(_0x4660d5))return;const _0x3f81b7=_0x5118bd[_0x4eca22(0xa50)][_0x4eca22(0x1090)](_0x4eca22(0x1545));if(_0x3f81b7&&!_0x39592b['classList'][_0x4eca22(0x7a0)](_0x4eca22(0xd70))){_0x25e0cd(_0x4660d5,_0x3f81b7['dataset'][_0x4eca22(0x152c)]);return;}const _0x55f029=_0x5118bd[_0x4eca22(0xa50)][_0x4eca22(0x1090)](_0x4eca22(0x95d));if(_0x55f029){_0x39592b[_0x4eca22(0xd54)]['contains']('closed')?_0x382238(_0x4660d5):_0x1467a3(_0x4660d5);return;}_0x39592b[_0x4eca22(0xd54)][_0x4eca22(0x7a0)](_0x4eca22(0xd70))&&_0x382238(_0x4660d5);}),document[_0x25f7e9(0x948)](_0x25f7e9(0x901))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x379184),document[_0x25f7e9(0x948)](_0x25f7e9(0x300))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>_0x249969('ai')),document['getElementById']('add-group-avatar-batch-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>_0x249969(_0x25f7e9(0x1403))),document[_0x25f7e9(0x948)](_0x25f7e9(0xb9a))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3d79ed),document[_0x25f7e9(0x948)](_0x25f7e9(0x365))[_0x25f7e9(0x339)]('click',()=>{const _0x384be3=_0x25f7e9;document['getElementById'](_0x384be3(0xab9))[_0x384be3(0x4f6)]();}),document[_0x25f7e9(0x948)]('ai-avatar-upload-input')['addEventListener'](_0x25f7e9(0x145c),_0x129d4b),document['getElementById'](_0x25f7e9(0x5f8))['addEventListener'](_0x25f7e9(0x4f6),_0x4c0af4),document['getElementById'](_0x25f7e9(0x808))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x203418),document[_0x25f7e9(0x948)](_0x25f7e9(0xe28))['addEventListener'](_0x25f7e9(0x4f6),_0x253e37),document[_0x25f7e9(0x948)](_0x25f7e9(0x9ff))['addEventListener']('click',()=>{const _0x2a3fe5=_0x25f7e9;document[_0x2a3fe5(0x948)](_0x2a3fe5(0x132e))['click']();}),document['getElementById'](_0x25f7e9(0x132e))[_0x25f7e9(0x339)](_0x25f7e9(0x145c),_0x3e949d),document[_0x25f7e9(0x948)]('close-group-avatar-library-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x1005bc),document['getElementById'](_0x25f7e9(0x1091))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0xca6c2c=>{const _0x448d22=_0x25f7e9;if(_0xca6c2c[_0x448d22(0xa50)]['classList'][_0x448d22(0x7a0)](_0x448d22(0x5f0))){const _0x357cf4=_0xca6c2c[_0x448d22(0xa50)][_0x448d22(0x1090)]('.icon-setting-item'),_0x1b100c=_0x357cf4[_0x448d22(0x606)][_0x448d22(0xbf4)];_0x1b100c&&_0x12ab47(_0x1b100c,_0x448d22(0xd53),_0x357cf4);}}),document[_0x25f7e9(0x948)](_0x25f7e9(0x91c))['addEventListener']('click',_0x2f6336=>{const _0x561685=_0x25f7e9,_0x247a2b=_0x2f6336['target'][_0x561685(0x1090)](_0x561685(0x783));if(_0x247a2b){const _0x5bf1df=parseInt(_0x247a2b[_0x561685(0x606)][_0x561685(0xb0a)]);!isNaN(_0x5bf1df)&&_0x296ff9(_0x5bf1df);}}),document[_0x25f7e9(0x948)](_0x25f7e9(0x10d2))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{_0x58c3b1('chat-interface-screen');}),_0x17a241[_0x25f7e9(0x1363)][_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async _0x27f761=>{const _0x53d429=_0x25f7e9,_0x410daa=_0x27f761[_0x53d429(0xa50)]['closest'](_0x53d429(0xb34));if(_0x410daa&&_0x17a241[_0x53d429(0x787)]!==null){const _0x4b6ea2=_0x410daa['style'][_0x53d429(0x618)][_0x53d429(0x200)](0x5,-0x2),_0x220a7b=_0x16699d[_0x53d429(0x14a2)][_0x53d429(0x1402)](_0x567411=>_0x567411[_0x53d429(0x9a8)]===_0x4b6ea2);_0x220a7b?await _0x17dc21(_0x17a241[_0x53d429(0x787)],_0x220a7b):console['warn'](_0x53d429(0x1110),_0x4b6ea2);}}),document[_0x25f7e9(0x339)]('click',_0x1743a9=>{const _0x4b6c88=_0x25f7e9;_0x17a241[_0x4b6c88(0x2c4)]&&!_0x17a241[_0x4b6c88(0x1363)]['contains'](_0x1743a9[_0x4b6c88(0xa50)])&&!_0x1743a9[_0x4b6c88(0xa50)][_0x4b6c88(0x1090)]('.comment-sticker-btn')&&_0x3a9f99();}),document[_0x25f7e9(0x948)]('share-link-btn')['addEventListener'](_0x25f7e9(0x4f6),_0x73710c),document['getElementById']('cancel-share-link-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x2ecfd6=_0x25f7e9;document[_0x2ecfd6(0x948)](_0x2ecfd6(0xa69))['classList'][_0x2ecfd6(0xf89)](_0x2ecfd6(0xfcb));}),document[_0x25f7e9(0x948)](_0x25f7e9(0xa5f))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x58cca7),document['getElementById'](_0x25f7e9(0x3cf))[_0x25f7e9(0x339)](_0x25f7e9(0x145c),_0x189334),document['getElementById'](_0x25f7e9(0x78c))[_0x25f7e9(0x339)]('change',_0x16884e=>{const _0x1d904b=_0x25f7e9;_0x228284(_0x16884e[_0x1d904b(0xa50)]['checked']);}),document[_0x25f7e9(0x948)](_0x25f7e9(0xb6d))[_0x25f7e9(0x339)]('change',_0x1641b3=>{const _0x26c60f=_0x25f7e9;_0xefda29(_0x1641b3[_0x26c60f(0xa50)][_0x26c60f(0x210)]);}),document[_0x25f7e9(0x948)](_0x25f7e9(0x285))['addEventListener'](_0x25f7e9(0x4f6),_0x151777),document[_0x25f7e9(0x948)]('chat-list-title')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x6f2c03),document['getElementById'](_0x25f7e9(0x12f8))['addEventListener']('click',()=>{const _0xe6fcd0=_0x25f7e9;_0x58c3b1(_0xe6fcd0(0x82a));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x12d8))[_0x25f7e9(0x339)]('click',_0x3e01b3=>{const _0x36579a=_0x25f7e9,_0x3963d1=_0x3e01b3[_0x36579a(0xa50)][_0x36579a(0x1090)](_0x36579a(0x12b6));_0x3963d1&&_0x3963d1[_0x36579a(0x606)][_0x36579a(0x105b)]&&_0x4a0e51(parseInt(_0x3963d1[_0x36579a(0x606)][_0x36579a(0x105b)]));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x127f))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x5d1030=_0x25f7e9;document['getElementById']('call-transcript-modal')[_0x5d1030(0xd54)][_0x5d1030(0xf89)](_0x5d1030(0xfcb));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x2cd))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x34d4a0),document[_0x25f7e9(0x948)]('selection-share-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x5290a6=_0x25f7e9;_0x355e3f[_0x5290a6(0x8ca)]>0x0&&_0xa7d88b();}),document[_0x25f7e9(0x948)]('selection-screenshot-btn')[_0x25f7e9(0x339)]('click',_0x438313),document[_0x25f7e9(0x948)](_0x25f7e9(0xcda))['addEventListener'](_0x25f7e9(0x4f6),async()=>{const _0x512884=_0x25f7e9,_0x3f8268=_0x16699d[_0x512884(0x1474)][_0x16699d[_0x512884(0xf5a)]],_0x28b625=Array['from'](document[_0x512884(0x1188)]('.share-target-checkbox:checked'))[_0x512884(0x8ff)](_0x51eb6c=>_0x51eb6c['dataset']['chatId']);if(_0x28b625[_0x512884(0xaf9)]===0x0){alert(_0x512884(0xd5c));return;}const _0x1a9da7=[],_0x33d73b=[..._0x355e3f]['sort']((_0x4c1db0,_0x354e60)=>_0x4c1db0-_0x354e60);for(const _0x4c62da of _0x33d73b){const _0x430c62=_0x3f8268[_0x512884(0xb07)][_0x512884(0x1402)](_0x551ef7=>_0x551ef7[_0x512884(0xb0a)]===_0x4c62da);_0x430c62&&_0x1a9da7[_0x512884(0x1001)](_0x430c62);}const _0x4ff149={'role':_0x512884(0xaeb),'senderName':_0x3f8268[_0x512884(0x1173)]?_0x3f8268[_0x512884(0x7fd)]['myNickname']||'我':'我','type':_0x512884(0x1593),'timestamp':Date[_0x512884(0x1386)](),'payload':{'sourceChatName':_0x3f8268[_0x512884(0x1467)],'title':_0x512884(0x430)+_0x3f8268[_0x512884(0x1467)]+_0x512884(0x5db),'sharedHistory':_0x1a9da7}};for(const _0x200ec2 of _0x28b625){const _0x2c24bd=_0x16699d[_0x512884(0x1474)][_0x200ec2];_0x2c24bd&&(_0x2c24bd[_0x512884(0xb07)][_0x512884(0x1001)](_0x4ff149),await _0x6ed281[_0x512884(0x1474)]['put'](_0x2c24bd));}document[_0x512884(0x948)](_0x512884(0x8b7))[_0x512884(0xd54)]['remove'](_0x512884(0xfcb)),_0x402014(),await _0x104485(_0x512884(0x50b),_0x512884(0x1005)+_0x28b625[_0x512884(0xaf9)]+_0x512884(0xdce)),_0x2d33eb();}),document[_0x25f7e9(0x948)]('cancel-share-target-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x4134cd=_0x25f7e9;document[_0x4134cd(0x948)]('share-target-modal')['classList'][_0x4134cd(0xf89)](_0x4134cd(0xfcb));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x91c))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3d5faa=>{const _0xd87ff2=_0x25f7e9,_0x2cbbf2=_0x3d5faa[_0xd87ff2(0xa50)][_0xd87ff2(0x1090)](_0xd87ff2(0x148d));if(_0x2cbbf2&&_0x2cbbf2[_0xd87ff2(0x1090)](_0xd87ff2(0x104d))){const _0x36d489=parseInt(_0x2cbbf2[_0xd87ff2(0x606)][_0xd87ff2(0xb0a)]);_0x4d5539(_0x36d489);}}),document[_0x25f7e9(0x948)](_0x25f7e9(0x134b))[_0x25f7e9(0x339)]('click',()=>{const _0x568933=_0x25f7e9;document['getElementById'](_0x568933(0x13bd))['classList']['remove']('visible');});async function _0x4d5539(_0x221a9b){const _0xb8f05f=_0x25f7e9,_0x16dee6=_0x16699d[_0xb8f05f(0x1474)][_0x16699d[_0xb8f05f(0xf5a)]];if(!_0x16dee6)return;const _0x2f1e22=_0x16dee6['history']['find'](_0x45a3f8=>_0x45a3f8[_0xb8f05f(0xb0a)]===_0x221a9b);if(!_0x2f1e22){console[_0xb8f05f(0xc3e)](_0xb8f05f(0x1037),_0x221a9b),await _0x104485(_0xb8f05f(0x5d6),_0xb8f05f(0x823));return;}if(_0x2f1e22[_0xb8f05f(0x4ae)]==='share_link'){_0x296ff9(_0x221a9b);return;}if(_0x2f1e22[_0xb8f05f(0x4ae)]===_0xb8f05f(0x1593)){if(!_0x2f1e22[_0xb8f05f(0x9e8)]||!_0x2f1e22[_0xb8f05f(0x9e8)][_0xb8f05f(0xcc6)]){console[_0xb8f05f(0xc3e)](_0xb8f05f(0x737),_0x2f1e22),await _0x104485(_0xb8f05f(0x5d6),'分享的聊天记录已损坏。');return;}}else{console[_0xb8f05f(0xc3e)](_0xb8f05f(0x4ee),_0x2f1e22[_0xb8f05f(0x4ae)]),await _0x104485(_0xb8f05f(0x5d6),_0xb8f05f(0x10d7));return;}const _0x2397a9=document[_0xb8f05f(0x948)](_0xb8f05f(0x13bd)),_0x1ad362=document['getElementById'](_0xb8f05f(0xdef)),_0x4515fa=document[_0xb8f05f(0x948)](_0xb8f05f(0xfd5));_0x1ad362['textContent']=_0x2f1e22['payload']['title'],_0x4515fa[_0xb8f05f(0xb6f)]='';const _0x4777a0=document['createDocumentFragment'](),_0x21e391=Object[_0xb8f05f(0x1166)](_0x16699d['chats'])['find'](_0x48c896=>_0x48c896[_0xb8f05f(0x1467)]===_0x2f1e22[_0xb8f05f(0x9e8)][_0xb8f05f(0x346)])||_0x16dee6;for(const _0x27552d of _0x2f1e22[_0xb8f05f(0x9e8)]['sharedHistory']){const _0x1a4026=await _0x1f8f7b(_0x27552d,_0x21e391);_0x1a4026&&_0x4777a0[_0xb8f05f(0x6b6)](_0x1a4026);}_0x4515fa[_0xb8f05f(0x6b6)](_0x4777a0),_0x2397a9[_0xb8f05f(0xd54)][_0xb8f05f(0xbd0)](_0xb8f05f(0xfcb));}_0x204b9a[_0x25f7e9(0x339)](_0x25f7e9(0x958),_0x202d7c),_0x204b9a['addEventListener'](_0x25f7e9(0xf8c),()=>{const _0x52882d=_0x25f7e9;_0x49c6c5[_0x52882d(0x1032)]&&(_0x49c6c5[_0x52882d(0x3aa)]=![],phoneScreenForIsland[_0x52882d(0xd54)][_0x52882d(0xf89)](_0x52882d(0x811)),_0x409bf9());}),_0x204b9a['addEventListener'](_0x25f7e9(0x293),()=>{const _0x47802a=_0x25f7e9;_0x49c6c5[_0x47802a(0x1032)]&&(_0x49c6c5[_0x47802a(0x3aa)]=!![],_0x409bf9());}),document[_0x25f7e9(0x948)](_0x25f7e9(0xa06))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async _0x17432b=>{const _0x284309=_0x25f7e9,_0x1bb638=_0x17432b[_0x284309(0xa50)],_0x2b028c=_0x1bb638[_0x284309(0x1090)]('.album-art-btn');if(_0x2b028c){const _0x3c0f25=parseInt(_0x2b028c[_0x284309(0x606)][_0x284309(0xbb3)]);!isNaN(_0x3c0f25)&&await _0x33da3b(_0x3c0f25);return;}const _0x5ed2ff=_0x1bb638['closest'](_0x284309(0xaa4));if(_0x5ed2ff){const _0xb3823a=parseInt(_0x5ed2ff['dataset'][_0x284309(0xbb3)]);if(isNaN(_0xb3823a))return;await _0x1866db(_0xb3823a);return;}const _0xe50f7b=_0x1bb638[_0x284309(0x1090)](_0x284309(0xe5a));if(_0xe50f7b){const _0x5e083c=parseInt(_0xe50f7b[_0x284309(0x606)][_0x284309(0xbb3)]);if(isNaN(_0x5e083c))return;const _0x3ca699=_0x49c6c5[_0x284309(0x12c8)][_0x5e083c],_0xc0c82f=await _0xa6b74a(_0x284309(0xbf8),_0x284309(0x6c1)+_0x3ca699[_0x284309(0x1467)]+_0x284309(0xbda));_0xc0c82f&&_0x1062d6(_0x5e083c);return;}const _0x428f17=_0x1bb638[_0x284309(0x1090)]('.playlist-item-info');if(_0x428f17){const _0x1c4c5f=_0x428f17[_0x284309(0x1090)](_0x284309(0xdea)),_0x6e083f=Array['from'](_0x1c4c5f[_0x284309(0x6c0)][_0x284309(0x87a)])[_0x284309(0x539)](_0x1c4c5f);_0x6e083f>-0x1&&_0x583698(_0x6e083f);}}),document[_0x25f7e9(0xfeb)]('.progress-bar')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x482eb9=>{const _0x447dea=_0x25f7e9;if(!_0x204b9a[_0x447dea(0x7ce)])return;const _0x1d4bd2=_0x482eb9[_0x447dea(0x614)],_0x13c06b=_0x1d4bd2[_0x447dea(0xa00)],_0xbe986b=_0x482eb9[_0x447dea(0x14ba)];_0x204b9a[_0x447dea(0x624)]=_0xbe986b/_0x13c06b*_0x204b9a[_0x447dea(0x7ce)];}),document[_0x25f7e9(0x948)]('chat-messages')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x5d45d6=>{const _0xfcd5a2=_0x25f7e9,_0x393b97=_0x5d45d6[_0xfcd5a2(0xa50)][_0xfcd5a2(0x1090)](_0xfcd5a2(0x7c6));if(_0x393b97){const _0x2f41da=_0x16699d['chats'][_0x16699d[_0xfcd5a2(0xf5a)]],_0x29f61c=_0x393b97[_0xfcd5a2(0x1090)](_0xfcd5a2(0x7ba));if(_0x2f41da&&_0x29f61c){const _0x384061=parseInt(_0x29f61c['dataset'][_0xfcd5a2(0xb0a)]),_0x11750c=_0x2f41da[_0xfcd5a2(0xb07)]['find'](_0x1303f2=>_0x1303f2[_0xfcd5a2(0xb0a)]===_0x384061);if(_0x11750c&&_0x11750c['recalledData']){let _0x49b87b='';const _0x521efe=_0x11750c[_0xfcd5a2(0x1083)];switch(_0x521efe['originalType']){case _0xfcd5a2(0x9ea):_0x49b87b=_0xfcd5a2(0x1219)+_0x521efe[_0xfcd5a2(0x14de)]+'\x22';break;case _0xfcd5a2(0x368):case _0xfcd5a2(0x1281):case _0xfcd5a2(0x1076):_0x49b87b=_0xfcd5a2(0x156c)+_0x521efe['originalContent']+'\x22';break;case'voice_message':_0x49b87b='[语音]\x20内容:\x20\x22'+_0x521efe[_0xfcd5a2(0x14de)]+'\x22';break;case'sticker':_0x49b87b=_0xfcd5a2(0x11d3)+(_0x521efe[_0xfcd5a2(0xe76)]||'(无)')+_0xfcd5a2(0xfbd)+_0x521efe[_0xfcd5a2(0x14de)];break;case _0xfcd5a2(0x1514):_0x49b87b=_0xfcd5a2(0xaa0);break;default:_0x49b87b=_0xfcd5a2(0xe0f)+_0x521efe[_0xfcd5a2(0x10e5)]+_0xfcd5a2(0x4fe)+JSON[_0xfcd5a2(0x526)](_0x521efe[_0xfcd5a2(0x14de)]);break;}_0x104485('已撤回的消息',_0x49b87b);}}}}),document['getElementById'](_0x25f7e9(0x13cf))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3bacf0),document[_0x25f7e9(0x948)]('close-category-manager-btn')[_0x25f7e9(0x339)]('click',()=>{const _0x1de29e=_0x25f7e9;document[_0x1de29e(0x948)]('world-book-category-manager-modal')[_0x1de29e(0xd54)][_0x1de29e(0xf89)](_0x1de29e(0xfcb)),_0x1c33bd();}),document[_0x25f7e9(0x948)]('add-new-category-btn')['addEventListener'](_0x25f7e9(0x4f6),_0x198905),document[_0x25f7e9(0x948)](_0x25f7e9(0x805))['addEventListener']('click',_0x3f2c9c=>{const _0x1c10c8=_0x25f7e9;if(_0x3f2c9c[_0x1c10c8(0xa50)][_0x1c10c8(0xd54)][_0x1c10c8(0x7a0)](_0x1c10c8(0x529))){const _0x487cd2=parseInt(_0x3f2c9c['target'][_0x1c10c8(0x606)]['id']);_0x336c5c(_0x487cd2);}}),document[_0x25f7e9(0x948)](_0x25f7e9(0xb1f))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x46d94d),document[_0x25f7e9(0x948)](_0x25f7e9(0xdae))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x5b216b),document[_0x25f7e9(0x948)](_0x25f7e9(0xe3d))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x4099d1),document['getElementById'](_0x25f7e9(0xffe))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x30b828),document[_0x25f7e9(0x948)](_0x25f7e9(0xc5d))[_0x25f7e9(0x339)](_0x25f7e9(0xc48),_0x557ba8=>{const _0x457ecc=_0x25f7e9;if(!_0x557ba8['target'][_0x457ecc(0xa7b)](_0x457ecc(0x853)))return;const _0x55b0ed=_0x557ba8[_0x457ecc(0xa50)],_0x2e9848=_0x55b0ed[_0x457ecc(0x1090)](_0x457ecc(0x1439));if(!_0x2e9848)return;const _0xde56e2=_0x2e9848['querySelector']('.at-mention-popup'),_0x1d870a=_0x55b0ed['value'],_0x104b89=_0x1d870a[_0x457ecc(0x9a3)](/@([\p{L}\w]*)$/u);if(_0x104b89){const _0x119ee5=new Set(),_0x9aa216=_0x2e9848[_0x457ecc(0xfeb)](_0x457ecc(0xc58))?.[_0x457ecc(0x10cb)];if(_0x9aa216)_0x119ee5[_0x457ecc(0xbd0)](_0x9aa216);_0x2e9848['querySelectorAll'](_0x457ecc(0x713))[_0x457ecc(0x427)](_0x2770a4=>{const _0x5e18e5=_0x457ecc;_0x119ee5[_0x5e18e5(0xbd0)](_0x2770a4['textContent']['replace'](':',''));}),_0x119ee5[_0x457ecc(0x869)](_0x16699d['qzoneSettings']['nickname']),_0xde56e2['innerHTML']='';if(_0x119ee5[_0x457ecc(0x8ca)]>0x0){const _0x58e552=_0x104b89[0x1];_0x119ee5['forEach'](_0x38feb3=>{const _0x3d89c7=_0x457ecc;if(_0x38feb3[_0x3d89c7(0x1331)]()['includes'](_0x58e552['toLowerCase']())){const _0x48cad1=document[_0x3d89c7(0x1497)](_0x3d89c7(0x379));_0x48cad1[_0x3d89c7(0x35b)]=_0x3d89c7(0x1c5),_0x48cad1[_0x3d89c7(0x10cb)]=_0x38feb3,_0x48cad1[_0x3d89c7(0x339)](_0x3d89c7(0xf08),_0x1c89d4=>{const _0x5cb08b=_0x3d89c7;_0x1c89d4[_0x5cb08b(0x38f)]();const _0x161f48=_0x1d870a[_0x5cb08b(0xeca)](0x0,_0x104b89[_0x5cb08b(0xbb3)])+('@'+_0x38feb3+'\x20');_0x55b0ed['value']=_0x161f48,_0xde56e2[_0x5cb08b(0xf74)][_0x5cb08b(0x11fd)]=_0x5cb08b(0x12fe),_0x55b0ed[_0x5cb08b(0x348)]();}),_0xde56e2[_0x3d89c7(0x6b6)](_0x48cad1);}}),_0xde56e2[_0x457ecc(0xf74)][_0x457ecc(0x11fd)]=_0xde56e2[_0x457ecc(0x87a)][_0x457ecc(0xaf9)]>0x0?'block':'none';}else _0xde56e2[_0x457ecc(0xf74)][_0x457ecc(0x11fd)]=_0x457ecc(0x12fe);}else _0xde56e2['style']['display']=_0x457ecc(0x12fe);}),document[_0x25f7e9(0x948)](_0x25f7e9(0xc5d))[_0x25f7e9(0x339)]('focusout',_0x815976=>{const _0x4c8aee=_0x25f7e9;if(_0x815976[_0x4c8aee(0xa50)][_0x4c8aee(0xa7b)](_0x4c8aee(0x853))){const _0x4fc547=_0x815976[_0x4c8aee(0xa50)][_0x4c8aee(0x1090)](_0x4c8aee(0x1439));if(_0x4fc547){const _0x55c698=_0x4fc547[_0x4c8aee(0xfeb)](_0x4c8aee(0x597));_0x55c698&&setTimeout(()=>{const _0x2f5a73=_0x4c8aee;_0x55c698[_0x2f5a73(0xf74)][_0x2f5a73(0x11fd)]=_0x2f5a73(0x12fe);},0xc8);}}});const _0xb160c=document[_0x25f7e9(0x948)](_0x25f7e9(0x933)),_0x580124=document[_0x25f7e9(0x948)]('chat-at-mention-popup');_0xb160c[_0x25f7e9(0x339)](_0x25f7e9(0xc48),()=>{const _0x1fa11a=_0x25f7e9;if(!_0x16699d[_0x1fa11a(0xf5a)]||!_0x16699d[_0x1fa11a(0x1474)][_0x16699d[_0x1fa11a(0xf5a)]][_0x1fa11a(0x1173)]){_0x580124[_0x1fa11a(0xf74)][_0x1fa11a(0x11fd)]=_0x1fa11a(0x12fe);return;}const _0x29d95c=_0x16699d[_0x1fa11a(0x1474)][_0x16699d[_0x1fa11a(0xf5a)]],_0x2d0cc9=_0xb160c[_0x1fa11a(0x5bc)],_0x28aa7b=_0x2d0cc9[_0x1fa11a(0x9a3)](/@([\p{L}\w]*)$/u);if(_0x28aa7b){const _0x311f08=_0x29d95c[_0x1fa11a(0x7fd)][_0x1fa11a(0x1371)]||'我',_0x4e381b=_0x29d95c[_0x1fa11a(0x10a2)][_0x1fa11a(0x8ff)](_0x121c88=>_0x121c88['groupNickname'])[_0x1fa11a(0x1c0)](_0x106f5f=>_0x106f5f!==_0x311f08);_0x580124[_0x1fa11a(0xb6f)]='';if(_0x4e381b[_0x1fa11a(0xaf9)]>0x0){const _0x58a600=_0x28aa7b[0x1];_0x4e381b[_0x1fa11a(0x427)](_0x4b6312=>{const _0x57ac6b=_0x1fa11a;if(_0x4b6312[_0x57ac6b(0x1331)]()[_0x57ac6b(0x1336)](_0x58a600['toLowerCase']())){const _0x4f88e3=document[_0x57ac6b(0x1497)](_0x57ac6b(0x379));_0x4f88e3[_0x57ac6b(0x35b)]='at-mention-item',_0x4f88e3['textContent']=_0x4b6312,_0x4f88e3['addEventListener']('mousedown',_0x13c9a5=>{const _0xd9d090=_0x57ac6b;_0x13c9a5[_0xd9d090(0x38f)]();const _0x2df1ba=_0x2d0cc9[_0xd9d090(0xeca)](0x0,_0x28aa7b['index'])+('@'+_0x4b6312+'\x20');_0xb160c[_0xd9d090(0x5bc)]=_0x2df1ba,_0x580124[_0xd9d090(0xf74)][_0xd9d090(0x11fd)]='none',_0xb160c[_0xd9d090(0x348)]();}),_0x580124[_0x57ac6b(0x6b6)](_0x4f88e3);}}),_0x580124[_0x1fa11a(0xf74)][_0x1fa11a(0x11fd)]=_0x580124[_0x1fa11a(0x87a)][_0x1fa11a(0xaf9)]>0x0?_0x1fa11a(0x1273):'none';}else _0x580124[_0x1fa11a(0xf74)]['display']=_0x1fa11a(0x12fe);}else _0x580124[_0x1fa11a(0xf74)]['display']='none';}),_0xb160c[_0x25f7e9(0x339)](_0x25f7e9(0x5e7),()=>{setTimeout(()=>{const _0x4d8416=_0x6c9e;_0x580124['style'][_0x4d8416(0x11fd)]=_0x4d8416(0x12fe);},0xc8);}),document[_0x25f7e9(0x948)]('publish-to-announcement-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x5afa22),document[_0x25f7e9(0x948)](_0x25f7e9(0xd68))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3aa73c),document[_0x25f7e9(0x948)](_0x25f7e9(0x11ff))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x4e1627=_0x25f7e9;document[_0x4e1627(0x948)](_0x4e1627(0x252))[_0x4e1627(0xd54)][_0x4e1627(0xf89)](_0x4e1627(0xfcb));}),document[_0x25f7e9(0x948)]('announcement-board-content')[_0x25f7e9(0x339)]('click',_0x55644c=>{const _0x42c191=_0x25f7e9;if(_0x55644c[_0x42c191(0xa50)][_0x42c191(0xd54)]['contains'](_0x42c191(0x1a4))){const _0x27e8e2=_0x55644c['target']['dataset'][_0x42c191(0x2bb)];_0x27e8e2&&_0xb1f951(_0x27e8e2);}}),document['getElementById']('announcement-action-pin')['addEventListener'](_0x25f7e9(0x4f6),_0x236e62),document[_0x25f7e9(0x948)](_0x25f7e9(0xef0))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x18904d),document[_0x25f7e9(0x948)](_0x25f7e9(0xb28))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x35243a=_0x25f7e9;document[_0x35243a(0x948)](_0x35243a(0xca1))['classList']['remove'](_0x35243a(0xfcb));}),document[_0x25f7e9(0x948)]('reset-global-css-btn')[_0x25f7e9(0x339)]('click',()=>{const _0x39cbdf=_0x25f7e9;document[_0x39cbdf(0x948)](_0x39cbdf(0x72d))[_0x39cbdf(0x5bc)]='';}),document[_0x25f7e9(0x948)](_0x25f7e9(0xeda))['addEventListener'](_0x25f7e9(0x4f6),_0x410087),document[_0x25f7e9(0x948)]('memory-screen-back-btn')['addEventListener'](_0x25f7e9(0x4f6),()=>{_0x58c3b1('chat-interface-screen');}),document[_0x25f7e9(0x948)]('add-manual-memory-btn-header')['addEventListener']('click',_0x5ef211),document[_0x25f7e9(0x948)](_0x25f7e9(0x3e6))['addEventListener'](_0x25f7e9(0x4f6),_0x26b47c),document[_0x25f7e9(0x948)](_0x25f7e9(0x113b))['addEventListener'](_0x25f7e9(0x4f6),_0x3c982d=>{const _0x6a5450=_0x25f7e9,_0x584941=_0x3c982d[_0x6a5450(0xa50)][_0x6a5450(0x1090)]('.edit-memory-btn');if(_0x584941){_0x4e85a8(_0x584941[_0x6a5450(0x606)][_0x6a5450(0x11b9)],parseInt(_0x584941['dataset'][_0x6a5450(0x6b4)]));return;}const _0x30d18c=_0x3c982d[_0x6a5450(0xa50)][_0x6a5450(0x1090)](_0x6a5450(0x40a));if(_0x30d18c){_0x5a16d7(_0x30d18c['dataset'][_0x6a5450(0x11b9)],parseInt(_0x30d18c['dataset'][_0x6a5450(0x6b4)]));return;}}),document[_0x25f7e9(0x948)](_0x25f7e9(0x235))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x589570),document[_0x25f7e9(0x948)](_0x25f7e9(0xb7b))['addEventListener']('click',_0x5e94c0);const _0x5971aa=document['getElementById'](_0x25f7e9(0x14ef));_0x5971aa[_0x25f7e9(0x339)](_0x25f7e9(0x10a3),_0x2ee7d6),_0x5971aa['addEventListener'](_0x25f7e9(0x56d),()=>_0x580f3b(_0x16699d[_0x25f7e9(0xf5a)])),_0x5971aa[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x368f05),document[_0x25f7e9(0x948)](_0x25f7e9(0x151d))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x5cad37=_0x25f7e9;document['getElementById'](_0x5cad37(0xd39))[_0x5cad37(0x5bc)]='',document[_0x5cad37(0x948)](_0x5cad37(0xe6a))[_0x5cad37(0x5bc)]='',document[_0x5cad37(0x948)]('create-countdown-modal')[_0x5cad37(0xd54)][_0x5cad37(0xbd0)](_0x5cad37(0xfcb));}),document['getElementById']('cancel-create-countdown-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x50c406=_0x25f7e9;document[_0x50c406(0x948)](_0x50c406(0x150e))[_0x50c406(0xd54)]['remove'](_0x50c406(0xfcb));}),document['getElementById'](_0x25f7e9(0x1473))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x1b0dde),document[_0x25f7e9(0x948)](_0x25f7e9(0x94e))['addEventListener']('click',_0x21d09e),document[_0x25f7e9(0x948)](_0x25f7e9(0x630))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x2120e6),document[_0x25f7e9(0x948)](_0x25f7e9(0x1045))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x918396),document[_0x25f7e9(0x948)]('cancel-ai-response-editor-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x3699dd=_0x25f7e9;document[_0x3699dd(0x948)]('ai-response-editor-modal')['classList'][_0x3699dd(0xf89)](_0x3699dd(0xfcb));}),document['getElementById'](_0x25f7e9(0x1397))['addEventListener'](_0x25f7e9(0x4f6),_0x1ac2f1),document[_0x25f7e9(0x948)](_0x25f7e9(0x1253))[_0x25f7e9(0x339)]('click',()=>{const _0x448f57=_0x25f7e9,_0x5ddded=document['getElementById'](_0x448f57(0x286)),_0x9a9751=_0x1c2537(_0x448f57(0x1366));_0x5ddded[_0x448f57(0x6b6)](_0x9a9751),_0x9a9751[_0x448f57(0xfeb)](_0x448f57(0xc1e))[_0x448f57(0x348)]();}),document[_0x25f7e9(0x948)](_0x25f7e9(0xb18))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x15b15e),document[_0x25f7e9(0x948)](_0x25f7e9(0x497))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x51973c),document[_0x25f7e9(0x948)]('add-my-avatar-url-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x18db0e),document[_0x25f7e9(0x948)](_0x25f7e9(0xe22))['addEventListener']('click',()=>{const _0x349dc9=_0x25f7e9;document[_0x349dc9(0x948)](_0x349dc9(0x39c))[_0x349dc9(0x4f6)]();}),document[_0x25f7e9(0x948)]('my-avatar-upload-input')['addEventListener'](_0x25f7e9(0x145c),_0x380935),document['getElementById'](_0x25f7e9(0x986))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x3b8609=_0x25f7e9,_0x2fd5ea=_0x3b8609(0xa7d),_0x2591e3=await _0x41b9fc(_0x3b8609(0x47b),_0x2fd5ea,'',_0x3b8609(0xc1e));_0x2591e3&&_0x2591e3['trim']()&&await _0x5df969(_0x2591e3);}),document[_0x25f7e9(0x948)]('open-shopping-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x58a970),document[_0x25f7e9(0x948)]('shopping-back-btn')['addEventListener'](_0x25f7e9(0x4f6),()=>_0x58c3b1(_0x25f7e9(0x152e))),document[_0x25f7e9(0x948)]('go-to-cart-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x347ffc),document[_0x25f7e9(0x948)](_0x25f7e9(0x575))[_0x25f7e9(0x339)]('click',_0x58a970),document[_0x25f7e9(0x948)]('checkout-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x40c48b),document[_0x25f7e9(0x948)]('close-receipt-btn')[_0x25f7e9(0x339)]('click',()=>{const _0x2a5532=_0x25f7e9;document[_0x2a5532(0x948)](_0x2a5532(0xbf0))[_0x2a5532(0xd54)]['remove'](_0x2a5532(0xfcb));}),document[_0x25f7e9(0x948)]('manage-products-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x9ff432=_0x25f7e9;_0x351656=!_0x351656;const _0x38681c=document[_0x9ff432(0x948)](_0x9ff432(0x7cb)),_0x1f0124=document['getElementById'](_0x9ff432(0x40f)),_0x4c2f69=document[_0x9ff432(0x948)](_0x9ff432(0x89f));_0x38681c[_0x9ff432(0xf74)][_0x9ff432(0xf1f)]=_0x351656?_0x9ff432(0x3e5):_0x9ff432(0xc88),_0x351656?(_0x1f0124['style'][_0x9ff432(0x11fd)]=_0x9ff432(0x6a4),_0x4c2f69[_0x9ff432(0xf74)][_0x9ff432(0x1aa)]='80px'):(_0x1f0124[_0x9ff432(0xf74)][_0x9ff432(0x11fd)]=_0x9ff432(0x12fe),_0x4c2f69[_0x9ff432(0xf74)][_0x9ff432(0x1aa)]='',_0xbc5d8[_0x9ff432(0x99d)](),document[_0x9ff432(0x1188)](_0x9ff432(0x887))[_0x9ff432(0x427)](_0x9d87aa=>_0x9d87aa[_0x9ff432(0xd54)][_0x9ff432(0xf89)](_0x9ff432(0xd56))),document[_0x9ff432(0x948)]('delete-selected-products-btn')[_0x9ff432(0x10cb)]=_0x9ff432(0xde8),document[_0x9ff432(0x948)](_0x9ff432(0xc6b))[_0x9ff432(0x210)]=![]),_0x42dc5f(),_0x25b79b();}),document[_0x25f7e9(0x948)](_0x25f7e9(0xf2c))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x24e796=_0x25f7e9;_0x351656?_0x15f118(null):alert(_0x24e796(0x49c));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x89f))['addEventListener'](_0x25f7e9(0x4f6),async _0x458d81=>{const _0x546399=_0x25f7e9,_0x5154e7=_0x458d81[_0x546399(0xa50)]['closest'](_0x546399(0xae1));if(!_0x5154e7)return;const _0x374ca6=parseInt(_0x5154e7[_0x546399(0x606)]['id']);if(isNaN(_0x374ca6))return;if(_0x351656){if(_0x458d81[_0x546399(0xa50)][_0x546399(0xd54)][_0x546399(0x7a0)](_0x546399(0xf97))){_0x15f118(_0x374ca6);return;}if(_0x458d81[_0x546399(0xa50)]['classList'][_0x546399(0x7a0)](_0x546399(0x1444))){const _0x63e6c=await _0x6ed281[_0x546399(0x151a)]['get'](_0x374ca6);if(!_0x63e6c)return;const _0x47ac47=await _0xa6b74a(_0x546399(0xc6a),_0x546399(0xdf6)+_0x63e6c[_0x546399(0x1467)]+_0x546399(0x2dd),{'confirmButtonClass':_0x546399(0x5e8)});_0x47ac47&&(await _0x6ed281[_0x546399(0x151a)][_0x546399(0x869)](_0x374ca6),await _0x42dc5f(),alert(_0x546399(0xe21)));return;}_0x5154e7[_0x546399(0xd54)][_0x546399(0x69d)](_0x546399(0xd56));_0xbc5d8[_0x546399(0xda1)](_0x374ca6)?_0xbc5d8[_0x546399(0x869)](_0x374ca6):_0xbc5d8['add'](_0x374ca6);document[_0x546399(0x948)](_0x546399(0x1d3))[_0x546399(0x10cb)]=_0x546399(0xf9b)+_0xbc5d8['size']+')';return;}if(_0x458d81[_0x546399(0xa50)]['classList'][_0x546399(0x7a0)]('add-to-cart-btn')){const _0x30f822=await _0x6ed281[_0x546399(0x151a)][_0x546399(0xe8c)](_0x374ca6);_0x30f822['variations']&&_0x30f822[_0x546399(0x136a)][_0x546399(0xaf9)]>0x0?_0x2695f2(_0x374ca6):(await _0x620cfb(_0x374ca6),await _0x104485('成功','已成功加入购物车！'));return;}_0x5154e7['contains'](_0x458d81[_0x546399(0xa50)])&&console[_0x546399(0x498)](_0x546399(0xf29)+_0x374ca6);}),document[_0x25f7e9(0x948)](_0x25f7e9(0xe20))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x121a8d=>{const _0x242af0=_0x25f7e9,_0x16a506=_0x121a8d[_0x242af0(0xa50)];_0x16a506['classList'][_0x242af0(0x7a0)](_0x242af0(0xb2c))&&_0x1e21eb(parseInt(_0x16a506[_0x242af0(0x606)]['id']),-0x1),_0x16a506[_0x242af0(0xd54)]['contains'](_0x242af0(0x1323))&&_0x1e21eb(parseInt(_0x16a506[_0x242af0(0x606)]['id']),0x1),_0x16a506[_0x242af0(0xd54)][_0x242af0(0x7a0)](_0x242af0(0x567))&&_0x510ef1();}),document[_0x25f7e9(0x948)](_0x25f7e9(0x441))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0xc60a1a=_0x25f7e9;if(_0x4cb957[_0xc60a1a(0xaf9)]===0x0)return;const _0xdb599f=await _0xa6b74a(_0xc60a1a(0xea3),_0xc60a1a(0x573));_0xdb599f&&(_0x4cb957=[],_0x24f532(),_0xdc4d94());}),document[_0x25f7e9(0x948)](_0x25f7e9(0xe1e))[_0x25f7e9(0x339)](_0x25f7e9(0x145c),function(_0x5663fa){const _0x390ecf=_0x25f7e9;document[_0x390ecf(0x1188)](_0x390ecf(0x8b5))[_0x390ecf(0x427)](_0x52cc46=>{const _0xa49eb5=_0x390ecf;_0x52cc46[_0xa49eb5(0x210)]=_0x5663fa[_0xa49eb5(0xa50)]['checked'];}),_0x510ef1();}),document[_0x25f7e9(0x948)](_0x25f7e9(0xd61))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x3f215a=_0x25f7e9;document[_0x3f215a(0x948)](_0x3f215a(0xe35))[_0x3f215a(0xd54)][_0x3f215a(0xf89)](_0x3f215a(0xfcb));}),document[_0x25f7e9(0x948)]('save-product-btn')[_0x25f7e9(0x339)]('click',_0x598449),document[_0x25f7e9(0x948)](_0x25f7e9(0x444))[_0x25f7e9(0x339)](_0x25f7e9(0x145c),_0x407e71=>{const _0x307284=_0x25f7e9,_0xaa8aad=_0x407e71[_0x307284(0xa50)][_0x307284(0x10b0)][0x0];if(_0xaa8aad){const _0x3fe4fb=new FileReader();_0x3fe4fb[_0x307284(0x33a)]=_0x2f8bbc=>{const _0x31c0f2=_0x307284;document['getElementById'](_0x31c0f2(0xe67))[_0x31c0f2(0x147d)]=_0x2f8bbc['target']['result'];},_0x3fe4fb['readAsDataURL'](_0xaa8aad);}}),document[_0x25f7e9(0x948)](_0x25f7e9(0x91c))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3acd8c=>{const _0x46a8c1=_0x25f7e9,_0x45d7e2=_0x3acd8c[_0x46a8c1(0xa50)][_0x46a8c1(0x1090)](_0x46a8c1(0x434));if(_0x45d7e2){const _0x300fef=_0x45d7e2[_0x46a8c1(0x1090)](_0x46a8c1(0x10a6));_0x300fef&&_0x112773(parseInt(_0x300fef[_0x46a8c1(0x606)]['timestamp']));}}),document[_0x25f7e9(0x948)]('cancel-gift-recipient-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x2eed11=_0x25f7e9;document[_0x2eed11(0x948)]('gift-recipient-modal')[_0x2eed11(0xd54)]['remove'](_0x2eed11(0xfcb));}),document['getElementById'](_0x25f7e9(0x283))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x557a25=_0x25f7e9,_0x27547a=Array[_0x557a25(0x6e5)](document[_0x557a25(0x1188)](_0x557a25(0x884)))[_0x557a25(0x8ff)](_0x246ac0=>_0x246ac0[_0x557a25(0x606)][_0x557a25(0x100d)]);if(_0x27547a['length']===0x0){alert(_0x557a25(0x1520));return;}const _0x5d0d89=_0x4cb957['filter'](_0x2103c5=>document[_0x557a25(0xfeb)]('.cart-item-checkbox[data-id=\x22'+_0x2103c5[_0x557a25(0x136d)]+_0x557a25(0xac5)));await _0xf837b7(_0x5d0d89,_0x27547a),document[_0x557a25(0x948)](_0x557a25(0xa61))[_0x557a25(0xd54)]['remove'](_0x557a25(0xfcb));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x36a))['addEventListener'](_0x25f7e9(0x4f6),_0x2cdd77=>{const _0x213793=_0x25f7e9,_0x3457ba=_0x2cdd77['target'][_0x213793(0x1090)](_0x213793(0x229));_0x3457ba&&_0x3457ba[_0x213793(0xd54)][_0x213793(0x69d)](_0x213793(0xd56));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x6a7))[_0x25f7e9(0x339)](_0x25f7e9(0x145c),function(_0x11c9ea){const _0x58dfde=_0x25f7e9,_0x153073=_0x11c9ea[_0x58dfde(0xa50)][_0x58dfde(0x210)];document[_0x58dfde(0x1188)](_0x58dfde(0xfe1))[_0x58dfde(0x427)](_0x8a689d=>{const _0x2d5801=_0x58dfde;_0x8a689d['classList'][_0x2d5801(0x69d)]('selected',_0x153073);});}),document[_0x25f7e9(0x948)](_0x25f7e9(0x1377))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x57df0b),document[_0x25f7e9(0x948)](_0x25f7e9(0x41d))['addEventListener']('click',_0x2841d0),document[_0x25f7e9(0x948)]('propel-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x528181),document[_0x25f7e9(0x948)](_0x25f7e9(0x2d0))['addEventListener'](_0x25f7e9(0x4f6),()=>{const _0x1781ee=_0x25f7e9,_0x41bb9e=document[_0x1781ee(0x948)](_0x1781ee(0xcfd)),_0xeff774=document[_0x1781ee(0x948)](_0x1781ee(0xd4d))[_0x1781ee(0x5bc)]['trim']()||_0x4e01dd;_0x41bb9e[_0x1781ee(0x147d)]=_0xeff774,_0x41bb9e[_0x1781ee(0x293)]()[_0x1781ee(0x1061)](_0x47b02f=>alert(_0x1781ee(0x961)));}),document[_0x25f7e9(0x948)]('reset-sound-btn')[_0x25f7e9(0x339)]('click',()=>{const _0x292b46=_0x25f7e9;document[_0x292b46(0x948)](_0x292b46(0xd4d))[_0x292b46(0x5bc)]='',alert(_0x292b46(0x944));}),document['getElementById'](_0x25f7e9(0x110d))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x380047=>{const _0x5c376c=_0x25f7e9,_0x468997=_0x380047['target'];_0x468997[_0x5c376c(0xd54)][_0x5c376c(0x7a0)](_0x5c376c(0x9a9))&&_0x35aba6(_0x468997),_0x468997[_0x5c376c(0xd54)]['contains'](_0x5c376c(0x772))&&_0x5caf1b(_0x468997);}),document[_0x25f7e9(0x948)](_0x25f7e9(0xfec))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x56045c),document[_0x25f7e9(0x948)](_0x25f7e9(0x303))['addEventListener'](_0x25f7e9(0x4f6),()=>{const _0x3a591a=_0x25f7e9;document[_0x3a591a(0x948)](_0x3a591a(0x147f))[_0x3a591a(0xd54)]['remove'](_0x3a591a(0xfcb));}),document[_0x25f7e9(0x948)](_0x25f7e9(0xfec))['addEventListener'](_0x25f7e9(0x4f6),_0x56045c),document['getElementById'](_0x25f7e9(0x303))['addEventListener']('click',()=>{const _0xc5016f=_0x25f7e9;document[_0xc5016f(0x948)](_0xc5016f(0x147f))[_0xc5016f(0xd54)]['remove']('visible');}),document[_0x25f7e9(0x948)]('select-all-music-search')['addEventListener']('change',function(_0x25dc48){const _0x29af1a=_0x25f7e9;document['querySelectorAll'](_0x29af1a(0x9cd))[_0x29af1a(0x427)](_0x2451fb=>{const _0x5bfa26=_0x29af1a;_0x2451fb[_0x5bfa26(0x210)]=_0x25dc48[_0x5bfa26(0xa50)]['checked'];});}),document[_0x25f7e9(0x948)](_0x25f7e9(0x1468))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3667fe=>{const _0x45e00b=_0x25f7e9,_0x570639=_0x3667fe[_0x45e00b(0xa50)][_0x45e00b(0x1090)]('.search-result-item');if(_0x570639){const _0x566807=_0x570639[_0x45e00b(0xfeb)]('.music-search-checkbox');_0x566807&&(_0x3667fe['target']!==_0x566807&&(_0x566807[_0x45e00b(0x210)]=!_0x566807[_0x45e00b(0x210)]));}}),document[_0x25f7e9(0x948)](_0x25f7e9(0x1010))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x36ba02=_0x25f7e9,_0x195fe8=document[_0x36ba02(0x1188)]('.music-search-checkbox:checked');if(_0x195fe8['length']===0x0){alert(_0x36ba02(0x10c8));return;}document[_0x36ba02(0x948)]('music-search-results-modal')[_0x36ba02(0xd54)][_0x36ba02(0xf89)]('visible'),await _0x104485(_0x36ba02(0x960),_0x36ba02(0x122d)+_0x195fe8[_0x36ba02(0xaf9)]+_0x36ba02(0xe1b));const _0x14dd93=Array[_0x36ba02(0x6e5)](_0x195fe8)[_0x36ba02(0x8ff)](_0x38b7db=>JSON['parse'](_0x38b7db['closest'](_0x36ba02(0xd8b))['dataset']['songJson']));let _0x431817=0x0,_0x1cb2aa=[];const _0xf2d0a8=_0x14dd93[_0x36ba02(0x8ff)](_0x18285e=>_0x493749(_0x18285e)),_0x1028d5=await Promise[_0x36ba02(0xd49)](_0xf2d0a8);_0x1028d5[_0x36ba02(0x427)]((_0x1f8815,_0x131af0)=>{const _0x202eaf=_0x36ba02;_0x1f8815?(_0x49c6c5[_0x202eaf(0x12c8)]['push'](_0x1f8815),_0x431817++):_0x1cb2aa[_0x202eaf(0x1001)](_0x14dd93[_0x131af0]['name']);});_0x431817>0x0&&(await _0x26f02f(),_0x39f26c(),_0x49c6c5['currentIndex']===-0x1&&(_0x49c6c5[_0x36ba02(0x73a)]=_0x49c6c5['playlist'][_0x36ba02(0xaf9)]-_0x431817,_0x409bf9()));let _0x85d856=_0x36ba02(0xa66)+_0x431817+_0x36ba02(0x3ae);_0x1cb2aa['length']>0x0&&(_0x85d856+='\x0a\x0a'+_0x1cb2aa['length']+_0x36ba02(0xdb7)+_0x1cb2aa[_0x36ba02(0x121a)]('\x0a-\x20')),await _0x104485('操作结果',_0x85d856);}),document[_0x25f7e9(0x948)](_0x25f7e9(0x14f6))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x26255a=_0x25f7e9;document[_0x26255a(0x948)](_0x26255a(0x14f6))['classList'][_0x26255a(0x69d)](_0x26255a(0xed5));}),document[_0x25f7e9(0x948)](_0x25f7e9(0xfec))['addEventListener'](_0x25f7e9(0x4f6),_0x56045c),document[_0x25f7e9(0x948)](_0x25f7e9(0x303))['addEventListener'](_0x25f7e9(0x4f6),()=>{const _0x4bad0e=_0x25f7e9;document['getElementById'](_0x4bad0e(0x147f))[_0x4bad0e(0xd54)][_0x4bad0e(0xf89)]('visible');}),document[_0x25f7e9(0x948)](_0x25f7e9(0x1468))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3cf606=>{const _0x49d15c=_0x25f7e9,_0x1399fc=_0x3cf606[_0x49d15c(0xa50)][_0x49d15c(0x1090)](_0x49d15c(0xd8b));if(_0x1399fc&&_0x1399fc[_0x49d15c(0x606)]['songJson']){const _0x575ff5=JSON[_0x49d15c(0xde0)](_0x1399fc['dataset']['songJson']);handleSearchResultClick(_0x575ff5);}}),document[_0x25f7e9(0x948)]('cleanup-songs-btn')['addEventListener'](_0x25f7e9(0x4f6),_0x223de3),document[_0x25f7e9(0x948)](_0x25f7e9(0x8e3))['addEventListener'](_0x25f7e9(0x4f6),_0x18c8c1),document['getElementById']('toggle-fullscreen-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3c969e),document['getElementById'](_0x25f7e9(0xc10))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x5b0ea9),document[_0x25f7e9(0x948)](_0x25f7e9(0x879))[_0x25f7e9(0x339)]('change',()=>{const _0x474706=_0x25f7e9;_0x16699d[_0x474706(0xf9c)][_0x474706(0xc75)]=document['getElementById'](_0x474706(0x879))[_0x474706(0x210)],_0x162fdb();}),document[_0x25f7e9(0x948)](_0x25f7e9(0x254))[_0x25f7e9(0x339)]('click',_0xec3e62),document[_0x25f7e9(0x948)](_0x25f7e9(0x8ce))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x4d9eaf=_0x25f7e9;document[_0x4d9eaf(0x948)]('clear-posts-modal')['classList'][_0x4d9eaf(0xf89)]('visible');}),document['getElementById'](_0x25f7e9(0xf7e))[_0x25f7e9(0x339)]('click',_0x527a2e),document[_0x25f7e9(0x948)](_0x25f7e9(0xce3))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x4793ef=>{const _0x3f863b=_0x25f7e9,_0x10d3a5=_0x4793ef[_0x3f863b(0xa50)][_0x3f863b(0x1090)](_0x3f863b(0x973));_0x10d3a5&&_0x10d3a5['classList'][_0x3f863b(0x69d)](_0x3f863b(0xd56));}),document[_0x25f7e9(0x948)](_0x25f7e9(0xf94))[_0x25f7e9(0x339)](_0x25f7e9(0x145c),async _0x49193f=>{const _0x56d2e7=_0x25f7e9,_0x167625=_0x49193f[_0x56d2e7(0xa50)][_0x56d2e7(0x10b0)][0x0];if(_0x167625){const _0x570306=await new Promise(_0x1fa364=>{const _0x41d14b=_0x56d2e7,_0x4229b3=new FileReader();_0x4229b3[_0x41d14b(0x33a)]=()=>_0x1fa364(_0x4229b3[_0x41d14b(0x22a)]),_0x4229b3[_0x41d14b(0x5a5)](_0x167625);});_0x16699d[_0x56d2e7(0xf9c)][_0x56d2e7(0xa76)]=_0x570306,_0xf9cd0e();}_0x49193f['target']['value']=null;}),document[_0x25f7e9(0x948)](_0x25f7e9(0x112e))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x2eecf6=_0x25f7e9;_0x16699d['globalSettings'][_0x2eecf6(0xa76)]='',_0xf9cd0e();}),document[_0x25f7e9(0x948)](_0x25f7e9(0x14fd))[_0x25f7e9(0x339)]('click',async()=>{const _0x11ec90=_0x25f7e9;_0x45df0e&&(_0x16699d[_0x11ec90(0xf9c)][_0x11ec90(0xb91)]=_0x45df0e),_0x16699d[_0x11ec90(0xf9c)][_0x11ec90(0x12fc)]=document[_0x11ec90(0x948)](_0x11ec90(0x72d))[_0x11ec90(0x5bc)]['trim'](),_0x16699d[_0x11ec90(0xf9c)]['notificationSoundUrl']=document[_0x11ec90(0x948)](_0x11ec90(0xd4d))[_0x11ec90(0x5bc)]['trim'](),_0x16699d[_0x11ec90(0xf9c)][_0x11ec90(0xc75)]=document[_0x11ec90(0x948)](_0x11ec90(0x879))[_0x11ec90(0x210)],await _0x6ed281[_0x11ec90(0xf9c)][_0x11ec90(0x90c)](_0x16699d[_0x11ec90(0xf9c)]),_0x364bb1(),_0x45df0e=null,_0x1c8fc4(),_0x5e5902(_0x16699d['globalSettings'][_0x11ec90(0x12fc)]),_0x162fdb(),alert(_0x11ec90(0x46e)),_0x58c3b1('home-screen');}),document[_0x25f7e9(0x948)]('upload-global-bg-url-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x53c410=_0x25f7e9,_0x137b28=await _0x41b9fc(_0x53c410(0x815),_0x53c410(0x128a),'',_0x53c410(0x9a8));if(_0x137b28&&_0x137b28['trim']())_0x16699d[_0x53c410(0xf9c)]['globalChatBackground']=_0x137b28[_0x53c410(0x2a8)](),_0xf9cd0e();else _0x137b28!==null&&alert(_0x53c410(0x121f));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x140c))['addEventListener'](_0x25f7e9(0x4f6),async()=>{const _0x4350e2=_0x25f7e9,_0xcffb4d=await _0x41b9fc(_0x4350e2(0x35f),_0x4350e2(0x68b),'',_0x4350e2(0x9a8));if(_0xcffb4d&&_0xcffb4d[_0x4350e2(0x2a8)]())_0x45df0e=_0xcffb4d['trim'](),_0xf9cd0e();else _0xcffb4d!==null&&alert(_0x4350e2(0x121f));}),document[_0x25f7e9(0x948)]('upload-cphone-bg-url-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x118766=_0x25f7e9,_0x44f4e0=await _0x41b9fc(_0x118766(0x1193),'请输入CPhone的背景图片URL','',_0x118766(0x9a8));if(_0x44f4e0&&_0x44f4e0[_0x118766(0x2a8)]())_0x16699d[_0x118766(0xf9c)][_0x118766(0x378)]=_0x44f4e0[_0x118766(0x2a8)](),_0xf9cd0e();else _0x44f4e0!==null&&alert(_0x118766(0x121f));}),document[_0x25f7e9(0x948)]('remove-ephone-bg-btn')[_0x25f7e9(0x339)]('click',()=>{const _0x2a2357=_0x25f7e9;_0x45df0e=null,_0x16699d[_0x2a2357(0xf9c)]['wallpaper']='',_0xf9cd0e();}),document[_0x25f7e9(0x948)]('remove-cphone-bg-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x1d36af=_0x25f7e9;_0x16699d[_0x1d36af(0xf9c)][_0x1d36af(0x378)]='',_0xf9cd0e();}),document[_0x25f7e9(0x948)](_0x25f7e9(0x8ac))[_0x25f7e9(0x339)](_0x25f7e9(0x145c),_0x235414),document[_0x25f7e9(0x948)](_0x25f7e9(0x7e1))['addEventListener']('click',_0x1d5043),document[_0x25f7e9(0x948)](_0x25f7e9(0xfb3))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x307ff6),document[_0x25f7e9(0x948)](_0x25f7e9(0x5c8))['addEventListener'](_0x25f7e9(0x145c),_0x22f3c5),document[_0x25f7e9(0x948)]('save-font-preset-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x5da256),document[_0x25f7e9(0x948)](_0x25f7e9(0x1043))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x4e47d7),document[_0x25f7e9(0x948)]('theme-preset-select')[_0x25f7e9(0x339)](_0x25f7e9(0x145c),_0xf3720a),document[_0x25f7e9(0x948)](_0x25f7e9(0x117c))[_0x25f7e9(0x339)]('click',_0x8e630),document[_0x25f7e9(0x948)]('delete-theme-preset-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0xade358),document['getElementById'](_0x25f7e9(0x57a))['addEventListener']('click',_0x33f7fd),document[_0x25f7e9(0x948)](_0x25f7e9(0x53b))['addEventListener'](_0x25f7e9(0x4f6),()=>{const _0x1fef1b=_0x25f7e9;document[_0x1fef1b(0x948)](_0x1fef1b(0x39e))['classList'][_0x1fef1b(0xf89)]('visible'),_0x4f21d0();}),document[_0x25f7e9(0x948)](_0x25f7e9(0x1365))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3cc0d7),document[_0x25f7e9(0x948)](_0x25f7e9(0x40c))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3f282e=>{const _0x545a47=_0x25f7e9;if(_0x3f282e[_0x545a47(0xa50)]['classList']['contains'](_0x545a47(0x529))){const _0x111e8a=parseInt(_0x3f282e['target'][_0x545a47(0x606)]['id']);_0x321d5c(_0x111e8a);}}),document['getElementById']('sticker-category-tabs')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x1ab5aa=>{const _0x16c00b=_0x25f7e9;if(_0x1ab5aa['target']['classList'][_0x16c00b(0x7a0)](_0x16c00b(0x720))){const _0x146810=_0x1ab5aa['target']['dataset'][_0x16c00b(0xd86)],_0x4876d1=_0x146810!=='all'&&_0x146810!==_0x16c00b(0x149b)?parseInt(_0x146810):_0x146810;_0x1529fd(_0x4876d1);}}),document[_0x25f7e9(0x948)](_0x25f7e9(0xc16))[_0x25f7e9(0x339)]('change',_0xad4a9d),document['getElementById'](_0x25f7e9(0x13c7))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x44a219),document[_0x25f7e9(0x948)](_0x25f7e9(0x11fb))['addEventListener'](_0x25f7e9(0x4f6),()=>{const _0x4f2c18=_0x25f7e9;document[_0x4f2c18(0x948)](_0x4f2c18(0x6ff))[_0x4f2c18(0x4f6)]();}),document[_0x25f7e9(0x948)](_0x25f7e9(0x6ff))[_0x25f7e9(0x339)]('change',_0x462b08=>{const _0x57a564=_0x25f7e9,_0x1aed72=_0x462b08[_0x57a564(0xa50)][_0x57a564(0x10b0)][0x0];_0x1aed72&&_0x3037bb(_0x1aed72),_0x462b08[_0x57a564(0xa50)][_0x57a564(0x5bc)]=null;}),document[_0x25f7e9(0x948)](_0x25f7e9(0xedb))[_0x25f7e9(0x339)]('click',()=>_0x4ecbeb()),document[_0x25f7e9(0x948)]('add-char-diary-btn')['addEventListener'](_0x25f7e9(0x4f6),()=>openDiaryEditor()),document[_0x25f7e9(0x948)](_0x25f7e9(0xd9e))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x31fc37),document[_0x25f7e9(0x948)](_0x25f7e9(0x834))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x25e1dd),document[_0x25f7e9(0x948)](_0x25f7e9(0x671))['addEventListener']('click',_0x36184a),document[_0x25f7e9(0x948)]('copy-diary-content-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x38993c=_0x25f7e9,_0x216bde=document['getElementById'](_0x38993c(0x6cc))[_0x38993c(0x14b4)];_0x315e2f(_0x216bde,'日记内容已复制！');}),document[_0x25f7e9(0x948)](_0x25f7e9(0xaff))['addEventListener'](_0x25f7e9(0x4f6),()=>{const _0x915700=_0x25f7e9,_0x4e5810=document[_0x915700(0x948)](_0x915700(0x10fc))[_0x915700(0x5bc)];_0x315e2f(_0x4e5810,_0x915700(0x5a6));}),document['getElementById']('copy-article-content-btn')['addEventListener']('click',()=>{const _0x280d8d=_0x25f7e9,_0x43210b=document[_0x280d8d(0x948)]('char-article-content')['innerText'];_0x315e2f(_0x43210b,'文章内容已复制！');}),document[_0x25f7e9(0x948)](_0x25f7e9(0x13fc))['addEventListener'](_0x25f7e9(0x4f6),async()=>{const _0x175263=_0x25f7e9;_0x104485('正在执行...',_0x175263(0x13b3));try{await Promise['all']([_0x64d3ca(),_0x4ea465()]),console[_0x175263(0x498)](_0x175263(0xffd));}catch(_0xecf2ae){console['error'](_0x175263(0xfcc),_0xecf2ae),await _0x104485(_0x175263(0xb6c),_0x175263(0xc61)+_0xecf2ae[_0x175263(0x74b)]);}}),document['getElementById'](_0x25f7e9(0x4a9))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x41632e=>{const _0x1124fc=_0x25f7e9,_0x7faa9d=_0x41632e[_0x1124fc(0xa50)][_0x1124fc(0x1090)]('.chat-list-item');if(_0x7faa9d&&_0x7faa9d[_0x1124fc(0x606)][_0x1124fc(0x60c)]){const _0x46236f=parseInt(_0x7faa9d[_0x1124fc(0x606)]['conversationIndex']);!isNaN(_0x46236f)&&_0x16fb86(_0x46236f);}}),document[_0x25f7e9(0x948)](_0x25f7e9(0xa4e))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{_0x13f7b4('char-qq-screen');});const _0x233609=document[_0x25f7e9(0x948)]('char-conversation-messages'),_0x211e14=()=>{const _0x3a8a8a=_0x25f7e9;if(_0x52fc15!==_0x3a8a8a(0xf22))return;if(_0x233609['scrollTop']<0x1&&!_0x1085af){const _0x18835e=_0x16699d['chats'][_0x36911a]?.[_0x3a8a8a(0xb07)]['length']||0x0;_0x18835e>_0xfbc7f1&&_0x3e0183();}};_0x233609['addEventListener'](_0x25f7e9(0x1165),_0x211e14),document[_0x25f7e9(0x948)](_0x25f7e9(0x15ac))['addEventListener'](_0x25f7e9(0x4f6),()=>{alert('这是模拟对话，无法发送消息哦~');}),document['getElementById'](_0x25f7e9(0x13c0))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x4b1c94),document[_0x25f7e9(0x948)](_0x25f7e9(0xe7d))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3d7db3=>{const _0xd0318b=_0x25f7e9,_0x216c91=_0x3d7db3['target'][_0xd0318b(0x1090)]('.char-photo-item');if(_0x216c91&&_0x216c91['dataset'][_0xd0318b(0xe79)]){const _0x2284d3=_0x216c91[_0xd0318b(0x606)][_0xd0318b(0xe79)];_0x104485('照片详情',_0x2284d3[_0xd0318b(0x14e9)](/\n/g,_0xd0318b(0x1121)));}}),document['getElementById'](_0x25f7e9(0xa0e))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x101381),document[_0x25f7e9(0x948)](_0x25f7e9(0x159d))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3c4ea2),document['getElementById']('char-product-grid')['addEventListener']('click',_0x5de0c6=>{const _0x5b39e0=_0x25f7e9,_0x5d37d3=_0x5de0c6[_0x5b39e0(0xa50)][_0x5b39e0(0x1090)](_0x5b39e0(0xbf3));if(_0x5d37d3&&_0x5d37d3[_0x5b39e0(0x606)][_0x5b39e0(0xb5e)]){const _0x1620c8=_0x5d37d3[_0x5b39e0(0x606)]['reason'];_0x104485(_0x5b39e0(0xf41),_0x1620c8[_0x5b39e0(0x14e9)](/\n/g,'<br>'));}}),window[_0x25f7e9(0xfa9)]=_0x33ba37,document[_0x25f7e9(0x948)](_0x25f7e9(0x1176))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x4dbf02),document[_0x25f7e9(0x948)](_0x25f7e9(0x518))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>_0x13f7b4('char-memo-screen')),document[_0x25f7e9(0x948)](_0x25f7e9(0x1031))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x464948),document['getElementById']('add-char-diary-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0xa73dd1),document[_0x25f7e9(0x948)](_0x25f7e9(0xf68))['addEventListener']('click',()=>_0x13f7b4('char-diary-screen')),document[_0x25f7e9(0x948)](_0x25f7e9(0x1293))[_0x25f7e9(0x339)]('click',_0x110d0c),document[_0x25f7e9(0x948)](_0x25f7e9(0x359))[_0x25f7e9(0x339)]('click',_0x3a1a97),document[_0x25f7e9(0x948)](_0x25f7e9(0x14c3))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3b43fe),document[_0x25f7e9(0x948)](_0x25f7e9(0x1c9))['addEventListener'](_0x25f7e9(0x4f6),_0x41c8a1),document[_0x25f7e9(0x948)](_0x25f7e9(0x65e))[_0x25f7e9(0x339)]('click',_0x6ddfe0),document[_0x25f7e9(0x948)](_0x25f7e9(0x65e))[_0x25f7e9(0x339)]('click',_0x6ddfe0),document[_0x25f7e9(0x948)](_0x25f7e9(0xd5a))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>_0x58c3b1(_0x25f7e9(0x197))),document[_0x25f7e9(0x948)](_0x25f7e9(0x10f4))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x4a7663),document[_0x25f7e9(0x948)](_0x25f7e9(0x325))[_0x25f7e9(0x339)]('click',_0x1c230d),document[_0x25f7e9(0x948)](_0x25f7e9(0x483))[_0x25f7e9(0x339)](_0x25f7e9(0x145c),async _0x11920d=>{const _0x5e1ad3=_0x25f7e9,_0x2d050a=_0x11920d['target'][_0x5e1ad3(0x10b0)][0x0];if(_0x2d050a){const _0x39c32=await new Promise(_0x2b9b4b=>{const _0x2e52ec=_0x5e1ad3,_0x440c93=new FileReader();_0x440c93[_0x2e52ec(0x33a)]=()=>_0x2b9b4b(_0x440c93['result']),_0x440c93[_0x2e52ec(0x5a5)](_0x2d050a);});_0x16699d[_0x5e1ad3(0xf9c)][_0x5e1ad3(0x378)]=_0x39c32,_0xf9cd0e();}}),document[_0x25f7e9(0x948)]('cphone-icon-settings-grid')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x24c842=>{const _0x3a7375=_0x25f7e9;if(_0x24c842[_0x3a7375(0xa50)][_0x3a7375(0xd54)][_0x3a7375(0x7a0)](_0x3a7375(0x5f0))){const _0x9528ea=_0x24c842[_0x3a7375(0xa50)][_0x3a7375(0x1090)](_0x3a7375(0xe07)),_0x41aaa6=_0x9528ea['dataset'][_0x3a7375(0xbf4)];_0x41aaa6&&_0x12ab47(_0x41aaa6,'cphone',_0x9528ea);}}),document[_0x25f7e9(0x948)](_0x25f7e9(0x40b))['addEventListener']('click',()=>{const _0x1e5f1c=_0x25f7e9;document[_0x1e5f1c(0x948)]('import-appearance-input')[_0x1e5f1c(0x4f6)]();}),document['getElementById']('import-appearance-input')[_0x25f7e9(0x339)]('change',_0x4324a5=>{const _0x44c216=_0x25f7e9,_0x2e5088=_0x4324a5['target'][_0x44c216(0x10b0)][0x0];_0x2e5088&&_0x445703(_0x2e5088),_0x4324a5[_0x44c216(0xa50)][_0x44c216(0x5bc)]=null;}),document['addEventListener']('visibilitychange',()=>{const _0x27b664=_0x25f7e9;document['visibilityState']===_0x27b664(0xce8)&&(localStorage[_0x27b664(0x59f)](_0x27b664(0xabd),Date['now']()),console[_0x27b664(0x498)](_0x27b664(0xd77)));}),document[_0x25f7e9(0x948)](_0x25f7e9(0xbea))[_0x25f7e9(0x339)]('click',_0x5add81),document[_0x25f7e9(0x948)](_0x25f7e9(0x60d))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x3a88fa=_0x25f7e9;document[_0x3a88fa(0x948)]('import-world-book-input')[_0x3a88fa(0x4f6)]();}),document['getElementById']('import-world-book-input')[_0x25f7e9(0x339)](_0x25f7e9(0x145c),_0x31b85e=>{const _0x460039=_0x25f7e9,_0x1b12ee=_0x31b85e[_0x460039(0xa50)][_0x460039(0x10b0)][0x0];_0x1b12ee&&_0x3f6e62(_0x1b12ee),_0x31b85e[_0x460039(0xa50)][_0x460039(0x5bc)]=null;}),document[_0x25f7e9(0x948)](_0x25f7e9(0x73b))[_0x25f7e9(0x339)](_0x25f7e9(0x145c),async _0x263de4=>{const _0x12fdf2=_0x25f7e9,_0x221b9b=_0x263de4['target'][_0x12fdf2(0x210)];_0x16699d[_0x12fdf2(0xf9c)]['enableAiDrawing']=_0x221b9b,await _0x6ed281[_0x12fdf2(0xf9c)][_0x12fdf2(0x90c)](_0x16699d[_0x12fdf2(0xf9c)]);const _0x2b8b8d=document[_0x12fdf2(0xfeb)](_0x12fdf2(0xfce));if(_0x2b8b8d)switch(_0x2b8b8d['id']){case _0x12fdf2(0x152e):_0x455873(_0x16699d['activeChatId']);break;case _0x12fdf2(0x82a):if(document['getElementById'](_0x12fdf2(0x442))[_0x12fdf2(0xd54)][_0x12fdf2(0x7a0)](_0x12fdf2(0x115e)))_0x4d3afb();if(document[_0x12fdf2(0x948)](_0x12fdf2(0x11e0))['classList']['contains'](_0x12fdf2(0x115e)))_0x18facb();break;case _0x12fdf2(0x197):_0x34e951();break;case _0x12fdf2(0x118f):_0x3e9da6(_0x966e44);break;case _0x12fdf2(0x100f):const _0x59e9a9=document[_0x12fdf2(0xfeb)](_0x12fdf2(0xcbb));if(_0x59e9a9)switch(_0x59e9a9['id']){case'char-album-screen':_0xde9310();break;case _0x12fdf2(0x117a):_0x1d076f();break;case _0x12fdf2(0x623):const _0x1b8ae0=_0x16699d[_0x12fdf2(0x1474)][_0x36911a],_0x2db5f0=_0x1b8ae0[_0x12fdf2(0x866)]||[],_0x4f23c7=_0x2db5f0[_0x12fdf2(0xaf9)]>0x0?_0x2db5f0['length']-0x1:0x0;_0x53b0c2(_0x2db5f0[_0x4f23c7]);break;case'char-usage-screen':_0x7e279();break;case _0x12fdf2(0x6b1):_0x1dd517();break;case _0x12fdf2(0x9c3):const _0x2277b1=document[_0x12fdf2(0xfeb)](_0x12fdf2(0x88a))?.[_0x12fdf2(0x606)][_0x12fdf2(0x60c)]||0x0;_0x16fb86(parseInt(_0x2277b1));break;}break;}_0x104485('设置已应用','AI生图功能已'+(_0x221b9b?'开启':'关闭')+'。');}),document[_0x25f7e9(0x948)]('search-history-btn')[_0x25f7e9(0x339)]('click',_0x2c6d5b),document['getElementById'](_0x25f7e9(0x158a))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x3cbf54=_0x25f7e9;_0x58c3b1(_0x3cbf54(0x473));}),document['getElementById'](_0x25f7e9(0xe3e))['addEventListener'](_0x25f7e9(0x4f6),_0x48eef5),document[_0x25f7e9(0x948)](_0x25f7e9(0xb16))['addEventListener'](_0x25f7e9(0x4f6),_0x1b3af6),document[_0x25f7e9(0x948)](_0x25f7e9(0x6da))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x571513),document[_0x25f7e9(0x948)](_0x25f7e9(0xaa3))['addEventListener']('click',_0x72dc2a),document[_0x25f7e9(0xfeb)](_0x25f7e9(0x1460))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3371f2=>{const _0x4c8c82=_0x25f7e9;if(_0x3371f2[_0x4c8c82(0xa50)][_0x4c8c82(0xd54)][_0x4c8c82(0x7a0)](_0x4c8c82(0xd38))){const _0x44f6a8=parseInt(_0x3371f2['target'][_0x4c8c82(0x606)]['id']);!isNaN(_0x44f6a8)&&_0x282057(_0x44f6a8);}}),_0x31028e(),window[_0x25f7e9(0x14a8)]=_0x3a337d,document['getElementById'](_0x25f7e9(0x101b))[_0x25f7e9(0x339)]('click',async()=>{const _0x4c6c42=_0x25f7e9,_0x18335b=await _0x41b9fc(_0x4c6c42(0xd62),_0x4c6c42(0x1228));if(_0x18335b&&_0x18335b[_0x4c6c42(0x2a8)]()){const _0x4675e0={'id':'preset_'+Date[_0x4c6c42(0x1386)](),'name':_0x18335b[_0x4c6c42(0x2a8)](),'content':[]};await _0x6ed281[_0x4c6c42(0xd44)]['add'](_0x4675e0),await _0x153031(),_0x228a53(_0x4675e0['id']);}}),document[_0x25f7e9(0x948)](_0x25f7e9(0xa46))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3128e3),document[_0x25f7e9(0x948)](_0x25f7e9(0xec9))[_0x25f7e9(0x339)]('click',()=>{const _0x5f2b10=_0x25f7e9,_0x1c7216=document[_0x5f2b10(0x948)](_0x5f2b10(0x8cc));_0x1c7216[_0x5f2b10(0xfeb)]('p')&&(_0x1c7216[_0x5f2b10(0xb6f)]='');const _0x25adb1=_0x47c851();_0x1c7216['appendChild'](_0x25adb1),_0x25adb1[_0x5f2b10(0xfeb)](_0x5f2b10(0x2eb))[_0x5f2b10(0x348)]();}),document[_0x25f7e9(0x948)](_0x25f7e9(0x1198))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x4e34a4=_0x25f7e9;if(!_0x1ce6f0)return;const _0x49acaf=await _0x6ed281[_0x4e34a4(0xd44)][_0x4e34a4(0xe8c)](_0x1ce6f0);if(!_0x49acaf)return;const _0x59179d=document[_0x4e34a4(0x948)]('preset-name-input')[_0x4e34a4(0x5bc)][_0x4e34a4(0x2a8)]();if(!_0x59179d){alert(_0x4e34a4(0xd28));return;}_0x49acaf[_0x4e34a4(0x1467)]=_0x59179d,_0x49acaf[_0x4e34a4(0xd86)]=parseInt(document[_0x4e34a4(0x948)](_0x4e34a4(0x934))[_0x4e34a4(0x5bc)])||null;const _0x4a1042=document[_0x4e34a4(0x948)](_0x4e34a4(0x8cc)),_0xf95be8=_0x4a1042['querySelectorAll'](_0x4e34a4(0x256)),_0x335a84=[];_0xf95be8['forEach'](_0x43060a=>{const _0x309c6c=_0x4e34a4,_0x27364d=_0x43060a[_0x309c6c(0xfeb)](_0x309c6c(0x2eb))['value'][_0x309c6c(0x2a8)]();_0x27364d&&_0x335a84[_0x309c6c(0x1001)]({'comment':_0x43060a[_0x309c6c(0xfeb)](_0x309c6c(0xb71))[_0x309c6c(0x5bc)][_0x309c6c(0x2a8)](),'keys':(_0x43060a['querySelector'](_0x309c6c(0x371))[_0x309c6c(0x5bc)][_0x309c6c(0x2a8)]()||'')[_0x309c6c(0x46f)](',')[_0x309c6c(0x8ff)](_0x585d21=>_0x585d21[_0x309c6c(0x2a8)]())[_0x309c6c(0x1c0)](Boolean),'content':_0x27364d,'enabled':_0x43060a[_0x309c6c(0xfeb)]('.entry-enabled-switch')[_0x309c6c(0x210)]});}),_0x49acaf[_0x4e34a4(0xede)]=_0x335a84,await _0x6ed281[_0x4e34a4(0xd44)][_0x4e34a4(0x90c)](_0x49acaf),_0x1ce6f0=null,_0x58c3b1(_0x4e34a4(0xf87)),await _0x153031();}),document[_0x25f7e9(0x948)]('import-preset-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x1ba6c9=_0x25f7e9;document['getElementById'](_0x1ba6c9(0x15be))[_0x1ba6c9(0x4f6)]();}),document[_0x25f7e9(0x948)](_0x25f7e9(0x15be))['addEventListener'](_0x25f7e9(0x145c),_0x1a0f50),document['getElementById'](_0x25f7e9(0xe58))[_0x25f7e9(0x339)]('click',_0x4c2aa0),document['getElementById'](_0x25f7e9(0x4e9))['addEventListener'](_0x25f7e9(0x4f6),_0x3a657d),document[_0x25f7e9(0x948)](_0x25f7e9(0x14f8))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x5d3d5c=_0x25f7e9;document[_0x5d3d5c(0x948)]('data-clear-wizard-modal')[_0x5d3d5c(0xd54)][_0x5d3d5c(0xf89)]('visible');}),document['getElementById'](_0x25f7e9(0xc01))['addEventListener'](_0x25f7e9(0x4f6),_0x3d200f),document[_0x25f7e9(0x948)](_0x25f7e9(0x14db))[_0x25f7e9(0x339)]('click',_0x57e2c5),document[_0x25f7e9(0x948)]('cancel-clear-wizard-btn-step2')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x453136=_0x25f7e9;document['getElementById']('data-clear-wizard-modal')[_0x453136(0xd54)][_0x453136(0xf89)]('visible');}),document[_0x25f7e9(0x948)]('confirm-final-clear-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x2d867e),document['getElementById'](_0x25f7e9(0xd4e))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x309394=>{const _0x44ae4f=_0x25f7e9,_0x4761a5=_0x309394[_0x44ae4f(0xa50)][_0x44ae4f(0x1090)](_0x44ae4f(0x973));_0x4761a5&&(_0x309394['stopPropagation'](),_0x4761a5[_0x44ae4f(0xd54)][_0x44ae4f(0x69d)]('selected'));}),document['getElementById'](_0x25f7e9(0xd4e))[_0x25f7e9(0x339)]('change',_0x2f98c4=>{const _0x40a0c1=_0x25f7e9;if(_0x2f98c4[_0x40a0c1(0xa50)]['id']===_0x40a0c1(0x889)){const _0x693618=_0x2f98c4[_0x40a0c1(0xa50)][_0x40a0c1(0x210)];document[_0x40a0c1(0x1188)](_0x40a0c1(0xeae))['forEach'](_0x4cceac=>{const _0x266bb5=_0x40a0c1;_0x4cceac[_0x266bb5(0xd54)]['toggle']('selected',_0x693618);});}else{if(_0x2f98c4[_0x40a0c1(0xa50)]['id']===_0x40a0c1(0x4a7)){const _0x22e049=_0x2f98c4[_0x40a0c1(0xa50)][_0x40a0c1(0x210)];document[_0x40a0c1(0x1188)]('#data-clear-type-list\x20.clear-posts-item')[_0x40a0c1(0x427)](_0x42e5de=>{const _0x3ae996=_0x40a0c1;_0x42e5de['classList'][_0x3ae996(0x69d)]('selected',_0x22e049);});}}}),document[_0x25f7e9(0x948)](_0x25f7e9(0xa1e))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3be874),document[_0x25f7e9(0x948)](_0x25f7e9(0xde2))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x151761),document[_0x25f7e9(0x948)](_0x25f7e9(0xc42))[_0x25f7e9(0x339)]('click',_0x3a34a2),document[_0x25f7e9(0x948)](_0x25f7e9(0xbbe))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x58bd06=_0x25f7e9;_0x779269(_0x58bd06(0x14d7));}),document[_0x25f7e9(0x948)](_0x25f7e9(0xb55))['addEventListener']('click',()=>_0x3330d7(null)),document['getElementById'](_0x25f7e9(0x3b2))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0xdbc49f),document[_0x25f7e9(0x948)]('npc-editor-modal')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3dfc8f=>{const _0x39055b=_0x25f7e9;_0x3dfc8f[_0x39055b(0xa50)]['id']==='manage-npc-groups-btn'&&_0x410e84();}),document[_0x25f7e9(0x948)](_0x25f7e9(0x972))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x2176e6=_0x25f7e9;document['getElementById'](_0x2176e6(0x46a))['classList'][_0x2176e6(0xf89)]('visible'),document[_0x2176e6(0x948)](_0x2176e6(0x1457))[_0x2176e6(0xd54)][_0x2176e6(0x7a0)]('visible')&&_0x3330d7(editingNpcId);}),document[_0x25f7e9(0x948)](_0x25f7e9(0x82b))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x20f941),document[_0x25f7e9(0x948)](_0x25f7e9(0x697))['addEventListener'](_0x25f7e9(0x4f6),_0x5064a0=>{const _0x1ffbf4=_0x25f7e9;_0x5064a0[_0x1ffbf4(0xa50)]['classList'][_0x1ffbf4(0x7a0)]('delete-group-btn')&&_0x5ada21(parseInt(_0x5064a0[_0x1ffbf4(0xa50)]['dataset']['id']));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x56a))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x9e61ef=_0x25f7e9;document[_0x9e61ef(0x948)]('npc-editor-modal')[_0x9e61ef(0xd54)][_0x9e61ef(0xf89)](_0x9e61ef(0xfcb));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x10b7))[_0x25f7e9(0x339)](_0x25f7e9(0x145c),_0x253552=>{const _0x40db32=_0x25f7e9,_0x4458bd=_0x253552[_0x40db32(0xa50)]['files'][0x0];if(_0x4458bd){const _0x3417c5=new FileReader();_0x3417c5['onload']=_0x3d6c29=>{const _0x2e7ec6=_0x40db32;document[_0x2e7ec6(0x948)](_0x2e7ec6(0xa2a))[_0x2e7ec6(0x147d)]=_0x3d6c29[_0x2e7ec6(0xa50)][_0x2e7ec6(0x22a)];},_0x3417c5[_0x40db32(0x5a5)](_0x4458bd);}}),document['getElementById']('chat-lock-overlay')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x393acf=>{const _0x11ace1=_0x25f7e9;if(_0x393acf[_0x11ace1(0xa50)]['id']==='spectator-reroll-btn')_0x44f3d6();else _0x393acf[_0x11ace1(0xa50)]['id']===_0x11ace1(0xf78)&&_0x918396();}),_0x159366(document[_0x25f7e9(0x948)](_0x25f7e9(0x14f6)),()=>{const _0xb2e1f4=_0x25f7e9;_0x49c6c5['currentIndex']>-0x1&&_0x33da3b(_0x49c6c5[_0xb2e1f4(0x73a)]);}),document[_0x25f7e9(0x948)]('douban-settings-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x37e769),document[_0x25f7e9(0x948)](_0x25f7e9(0x147b))['addEventListener'](_0x25f7e9(0x4f6),_0x230ac1),document[_0x25f7e9(0x948)]('cancel-douban-settings-btn')['addEventListener'](_0x25f7e9(0x4f6),()=>{const _0x5d8d41=_0x25f7e9;document['getElementById'](_0x5d8d41(0xe88))[_0x5d8d41(0xd54)][_0x5d8d41(0xf89)](_0x5d8d41(0xfcb));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x11b5))[_0x25f7e9(0x339)](_0x25f7e9(0xc48),_0x145f39=>{const _0x3107be=_0x25f7e9,_0x5756d9=_0x145f39['target']['value']['toLowerCase'](),_0x100038=document[_0x3107be(0x948)](_0x3107be(0x1264));for(const _0x516a58 of _0x100038['options']){const _0x18b08f=_0x516a58[_0x3107be(0x10cb)][_0x3107be(0x1331)]();_0x18b08f[_0x3107be(0x1336)](_0x5756d9)?_0x516a58[_0x3107be(0xf74)]['display']='':_0x516a58[_0x3107be(0xf74)][_0x3107be(0x11fd)]=_0x3107be(0x12fe);}}),window[_0x25f7e9(0x29b)]=_0x414c82,document['getElementById']('werewolf-game-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>_0x414c82(_0x25f7e9(0x1403))),document[_0x25f7e9(0x948)]('cancel-werewolf-lobby-btn')[_0x25f7e9(0x339)]('click',()=>{const _0x81d2e8=_0x25f7e9;document[_0x81d2e8(0x948)]('werewolf-lobby-modal')[_0x81d2e8(0xd54)][_0x81d2e8(0xf89)]('visible');}),document['getElementById']('start-werewolf-game-btn')[_0x25f7e9(0x339)]('click',_0x2cb0d1),document[_0x25f7e9(0x948)](_0x25f7e9(0xbcb))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x465a2c=_0x25f7e9;document['getElementById'](_0x465a2c(0x85a))[_0x465a2c(0xd54)][_0x465a2c(0xf89)](_0x465a2c(0xfcb)),_0x85aa33();}),document[_0x25f7e9(0x948)](_0x25f7e9(0xdc0))[_0x25f7e9(0x339)]('click',async()=>{const _0x4c6ba4=_0x25f7e9,_0x7b15a3=await _0xa6b74a(_0x4c6ba4(0xc2c),_0x4c6ba4(0x114f),{'confirmButtonClass':_0x4c6ba4(0x5e8)});_0x7b15a3&&(_0x1b881d[_0x4c6ba4(0x1032)]=![],_0x58c3b1(_0x1b881d[_0x4c6ba4(0x1029)]?_0x4c6ba4(0x152e):_0x4c6ba4(0x110d)));}),document[_0x25f7e9(0x948)](_0x25f7e9(0xddc))[_0x25f7e9(0x339)]('click',()=>{const _0x1daa58=_0x25f7e9;document[_0x1daa58(0x948)]('werewolf-game-over-modal')['classList'][_0x1daa58(0xf89)](_0x1daa58(0xfcb)),_0x58c3b1(_0x1b881d[_0x1daa58(0x1029)]?_0x1daa58(0x82a):_0x1daa58(0x110d));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x471))[_0x25f7e9(0x339)]('click',()=>{const _0x53ff48=_0x25f7e9;document[_0x53ff48(0x948)](_0x53ff48(0x10a0))[_0x53ff48(0xd54)][_0x53ff48(0xf89)](_0x53ff48(0xfcb));}),document['getElementById']('cancel-werewolf-lobby-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x1e1c6f=_0x25f7e9;document[_0x1e1c6f(0x948)]('werewolf-lobby-modal')[_0x1e1c6f(0xd54)][_0x1e1c6f(0xf89)](_0x1e1c6f(0xfcb));}),document['getElementById'](_0x25f7e9(0x742))['addEventListener']('click',_0x50283e),document[_0x25f7e9(0x948)](_0x25f7e9(0xd6b))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x2581b7),document[_0x25f7e9(0x948)](_0x25f7e9(0xb2e))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x5eb999),document[_0x25f7e9(0x948)](_0x25f7e9(0x10bb))[_0x25f7e9(0x339)](_0x25f7e9(0x145c),_0x4949b2=>{const _0x5092c8=_0x25f7e9,_0x14a76a=_0x4949b2['target'][_0x5092c8(0x210)];_0x16699d['globalSettings'][_0x5092c8(0x2b7)]=_0x14a76a;const _0x15c94a=document['body'][_0x5092c8(0xd54)][_0x5092c8(0x7a0)](_0x5092c8(0x6fe));if(_0x49c6c5[_0x5092c8(0x1032)]&&!_0x15c94a){const _0xa3fa0e=document['getElementById'](_0x5092c8(0xa34)),_0xce818f=document[_0x5092c8(0x948)](_0x5092c8(0xecd));_0x14a76a?(_0xa3fa0e['classList'][_0x5092c8(0xf89)]('visible'),_0xce818f[_0x5092c8(0xd54)][_0x5092c8(0xbd0)](_0x5092c8(0x811))):(_0xce818f['classList']['remove']('dynamic-island-active'),_0x49c6c5['parsedLyrics']&&_0x49c6c5[_0x5092c8(0x68d)][_0x5092c8(0xaf9)]>0x0&&_0xa3fa0e[_0x5092c8(0xd54)][_0x5092c8(0xbd0)]('visible'));}}),document[_0x25f7e9(0x948)]('delete-world-books-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x4b81cd),document[_0x25f7e9(0x948)](_0x25f7e9(0x559))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x22b46e=_0x25f7e9;document[_0x22b46e(0x948)](_0x22b46e(0x698))[_0x22b46e(0xd54)][_0x22b46e(0xf89)]('visible');}),document[_0x25f7e9(0x948)](_0x25f7e9(0x3d9))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x16a3e3),document[_0x25f7e9(0x948)](_0x25f7e9(0x698))['addEventListener'](_0x25f7e9(0x4f6),_0x34d69a=>{const _0x3adf16=_0x25f7e9,_0x1ef7bc=_0x34d69a[_0x3adf16(0xa50)][_0x3adf16(0x1090)](_0x3adf16(0x973));_0x1ef7bc&&_0x1ef7bc['classList']['toggle'](_0x3adf16(0xd56));if(_0x34d69a['target']['id']===_0x3adf16(0xf9e)){const _0x51ab44=_0x34d69a[_0x3adf16(0xa50)][_0x3adf16(0x210)];document[_0x3adf16(0x1188)](_0x3adf16(0x796))[_0x3adf16(0x427)](_0x3ea409=>{const _0x51bbb2=_0x3adf16;_0x3ea409[_0x51bbb2(0xd54)]['toggle'](_0x51bbb2(0xd56),_0x51ab44);});}}),document[_0x25f7e9(0x948)](_0x25f7e9(0xfd7))[_0x25f7e9(0x339)](_0x25f7e9(0xc48),()=>{_0x4f21d0(![]);}),document['getElementById'](_0x25f7e9(0x11c8))[_0x25f7e9(0x339)]('click',_0x94db57=>{const _0x49d1e0=_0x25f7e9;if(_0x94db57[_0x49d1e0(0xa50)]['classList'][_0x49d1e0(0x7a0)](_0x49d1e0(0x720))){const _0x1ac20d=_0x94db57[_0x49d1e0(0xa50)][_0x49d1e0(0x606)][_0x49d1e0(0xd86)],_0x5922be=_0x1ac20d!==_0x49d1e0(0xd49)&&_0x1ac20d!=='uncategorized'?parseInt(_0x1ac20d):_0x1ac20d;document[_0x49d1e0(0x948)]('sticker-search-input')[_0x49d1e0(0x5bc)]='',_0x1529fd(_0x5922be);}});const _0x4d3ce9=document[_0x25f7e9(0x948)](_0x25f7e9(0x91c));_0x4d3ce9[_0x25f7e9(0x339)]('scroll',()=>{const _0x1f1504=_0x25f7e9;if(_0x4d3ce9[_0x1f1504(0xced)]<0x1&&!_0x3accf1){const _0x467fcc=_0x16699d['chats'][_0x16699d[_0x1f1504(0xf5a)]]?.[_0x1f1504(0xb07)][_0x1f1504(0xaf9)]||0x0;_0x467fcc>_0xf1800c&&_0xb02fa8();}});const _0x35d2dd=document['getElementById'](_0x25f7e9(0x11a0));_0x35d2dd[_0x25f7e9(0x339)]('scroll',()=>{const _0x58897d=_0x25f7e9,{scrollTop:_0x16ac12,scrollHeight:_0x537b20,clientHeight:_0x28e9ab}=_0x35d2dd;if(_0x537b20-_0x16ac12<=_0x28e9ab+0x32&&!_0x277943){const _0x1d6bd3=_0x16699d['chats'][_0x16699d[_0x58897d(0xf5a)]]?.[_0x58897d(0xd94)][_0x58897d(0xaf9)]||0x0;_0x1d6bd3>_0x21863c&&_0xc4de1f();}});const _0x159060=document[_0x25f7e9(0xfeb)]('#qzone-screen\x20.qzone-content');_0x159060['addEventListener'](_0x25f7e9(0x1165),()=>{const _0x1ffc39=_0x25f7e9,{scrollTop:_0x501401,scrollHeight:_0x4a681c,clientHeight:_0x15149f}=_0x159060;_0x4a681c-_0x501401<=_0x15149f+0x64&&!_0xe11400&&(_0x22676c[_0x1ffc39(0xaf9)]>_0x410e8d&&_0x4b7636());});const _0x89510d=document[_0x25f7e9(0x948)](_0x25f7e9(0xe32));_0x89510d[_0x25f7e9(0x339)](_0x25f7e9(0x1165),()=>{const _0x4475e4=_0x25f7e9,{scrollTop:_0x6ac1f0,scrollHeight:_0x14cadd,clientHeight:_0x1d97f6}=_0x89510d;_0x14cadd-_0x6ac1f0<=_0x1d97f6+0x64&&!_0x112ac2&&(_0x223e34[_0x4475e4(0xaf9)]>_0x9958a6&&_0x3b0a60());}),document[_0x25f7e9(0x948)]('read-together-btn')[_0x25f7e9(0x339)]('click',_0x348f3c);const _0x1e7219=document[_0x25f7e9(0x948)](_0x25f7e9(0x12cb));_0x1b9209(_0x1e7219,_0x1e7219),document[_0x25f7e9(0x948)](_0x25f7e9(0xe08))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0xedd965),document[_0x25f7e9(0x948)](_0x25f7e9(0xee1))['addEventListener'](_0x25f7e9(0x4f6),_0x12adf4),document[_0x25f7e9(0x948)](_0x25f7e9(0x422))['addEventListener'](_0x25f7e9(0x4f6),_0x2dd96b),document['getElementById'](_0x25f7e9(0x467))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3d0a8a),document[_0x25f7e9(0x948)](_0x25f7e9(0x1f8))[_0x25f7e9(0x339)](_0x25f7e9(0x145c),_0x55c727),document[_0x25f7e9(0x948)](_0x25f7e9(0x1003))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3f05c6),document[_0x25f7e9(0x948)](_0x25f7e9(0x12cb))['addEventListener'](_0x25f7e9(0x4f6),_0x6e80a5),_0x1b9209(document[_0x25f7e9(0x948)](_0x25f7e9(0x5bf)),document['querySelector'](_0x25f7e9(0x55d))),document[_0x25f7e9(0x948)](_0x25f7e9(0xee1))['addEventListener'](_0x25f7e9(0x4f6),_0x12adf4),document['getElementById']('close-reading-library-btn-header')[_0x25f7e9(0x339)]('click',()=>{const _0x8ea1d0=_0x25f7e9;document[_0x8ea1d0(0x948)](_0x8ea1d0(0xc55))[_0x8ea1d0(0xd54)][_0x8ea1d0(0xf89)](_0x8ea1d0(0xfcb));}),document[_0x25f7e9(0x948)](_0x25f7e9(0xdb3))['addEventListener'](_0x25f7e9(0x4f6),_0x3e882a),document['getElementById']('reading-library-list')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x1f46ab=>{const _0x5e61c6=_0x25f7e9,_0x2b47e8=_0x1f46ab['target'];if(_0x2b47e8['classList'][_0x5e61c6(0x7a0)](_0x5e61c6(0x1251))){const _0x1e5ffc=parseInt(_0x2b47e8[_0x5e61c6(0x606)][_0x5e61c6(0x1288)]);_0x49b961(_0x1e5ffc);}else{if(_0x2b47e8[_0x5e61c6(0xd54)][_0x5e61c6(0x7a0)](_0x5e61c6(0x529))){const _0x5dd391=parseInt(_0x2b47e8['dataset']['bookId']);_0x20d75a(_0x5dd391);}}}),document[_0x25f7e9(0x948)](_0x25f7e9(0x3a4))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0xb06b02),document['getElementById']('reading-library-search-input')[_0x25f7e9(0x339)](_0x25f7e9(0xc48),_0x1e96c6=>{const _0xfa918f=_0x25f7e9;_0x437121(_0x1e96c6[_0xfa918f(0xa50)][_0xfa918f(0x5bc)]);});const _0x2814b3=_0x34e9ed(_0x1a1218,0x12c);document[_0x25f7e9(0x948)](_0x25f7e9(0x1565))[_0x25f7e9(0x339)](_0x25f7e9(0x1165),_0x2814b3),document[_0x25f7e9(0x948)](_0x25f7e9(0x305))['addEventListener'](_0x25f7e9(0xc48),_0x81ea5e=>{const _0x3e934b=_0x25f7e9;document[_0x3e934b(0x948)](_0x3e934b(0x461))[_0x3e934b(0x10cb)]=_0x81ea5e[_0x3e934b(0xa50)][_0x3e934b(0x5bc)];});const _0x2064b9=document['getElementById'](_0x25f7e9(0x14d7));_0x2064b9['addEventListener'](_0x25f7e9(0x1165),()=>{const {scrollTop:_0x37dc3b,scrollHeight:_0x3f7273,clientHeight:_0x256b49}=_0x2064b9;_0x3f7273-_0x37dc3b<=_0x256b49+0x96&&!_0x34c5ec&&_0x2204e1();}),document[_0x25f7e9(0x948)](_0x25f7e9(0xcd2))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x33bd7e),document['getElementById'](_0x25f7e9(0x75d))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x537b39=_0x25f7e9;document[_0x537b39(0x948)](_0x537b39(0xf3c))[_0x537b39(0xd54)][_0x537b39(0xf89)](_0x537b39(0xfcb)),_0x15f118(_0x512b70);}),document[_0x25f7e9(0x948)](_0x25f7e9(0x1cc))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x2120b1),document[_0x25f7e9(0x948)](_0x25f7e9(0xc5e))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x425d49=>{const _0x225a8a=_0x25f7e9;_0x425d49[_0x225a8a(0xa50)][_0x225a8a(0xd54)][_0x225a8a(0x7a0)]('delete-group-btn')&&_0x47d127(parseInt(_0x425d49['target'][_0x225a8a(0x606)]['id']));}),document['getElementById']('add-product-variation-btn')[_0x25f7e9(0x339)]('click',()=>_0x3263df()),document[_0x25f7e9(0x948)]('cancel-variation-selection-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x4de369=_0x25f7e9;document[_0x4de369(0x948)](_0x4de369(0x1012))[_0x4de369(0xd54)][_0x4de369(0xf89)](_0x4de369(0xfcb));}),document[_0x25f7e9(0x948)](_0x25f7e9(0xc37))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x307b21=_0x25f7e9,_0x179a0e=document[_0x307b21(0x948)]('variation-quantity-display');let _0x20e3ea=parseInt(_0x179a0e[_0x307b21(0x10cb)]);if(_0x20e3ea>0x1)_0x179a0e[_0x307b21(0x10cb)]=_0x20e3ea-0x1;}),document[_0x25f7e9(0x948)](_0x25f7e9(0x15a4))[_0x25f7e9(0x339)]('click',()=>{const _0x26cfdd=_0x25f7e9,_0x274e5e=document[_0x26cfdd(0x948)](_0x26cfdd(0x122c));_0x274e5e['textContent']=parseInt(_0x274e5e[_0x26cfdd(0x10cb)])+0x1;}),document[_0x25f7e9(0x948)]('product-category-tabs')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x1df106=>{const _0xa69400=_0x25f7e9;if(_0x1df106[_0xa69400(0xa50)][_0xa69400(0xd54)][_0xa69400(0x7a0)]('product-category-tab')){const _0x350742=_0x1df106['target']['dataset'][_0xa69400(0xd86)]===_0xa69400(0xd49)?_0xa69400(0xd49):parseInt(_0x1df106[_0xa69400(0xa50)]['dataset'][_0xa69400(0xd86)]);_0x3e0471(_0x350742);}}),document['getElementById']('generate-shopping-items-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x3b77c9),document[_0x25f7e9(0x948)](_0x25f7e9(0xe39))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x494d32),document[_0x25f7e9(0x948)](_0x25f7e9(0xf66))[_0x25f7e9(0x339)]('click',_0x2435ae),document[_0x25f7e9(0x948)]('cancel-shopping-settings-btn')['addEventListener']('click',()=>{const _0xd8d6=_0x25f7e9;document['getElementById'](_0xd8d6(0x967))['classList']['remove'](_0xd8d6(0xfcb));}),document['getElementById'](_0x25f7e9(0xc6b))[_0x25f7e9(0x339)](_0x25f7e9(0x145c),_0x441148=>{const _0x4b6f68=_0x25f7e9,_0x52c10d=_0x441148['target'][_0x4b6f68(0x210)],_0x2eaec1=document[_0x4b6f68(0x1188)](_0x4b6f68(0xcbd));_0x2eaec1[_0x4b6f68(0x427)](_0x517ed7=>{const _0x1b11c5=_0x4b6f68,_0x341153=parseInt(_0x517ed7['dataset']['id']);_0x517ed7[_0x1b11c5(0xd54)]['toggle'](_0x1b11c5(0xd56),_0x52c10d),_0x52c10d?_0xbc5d8[_0x1b11c5(0xbd0)](_0x341153):_0xbc5d8[_0x1b11c5(0x869)](_0x341153);}),document['getElementById'](_0x4b6f68(0x1d3))[_0x4b6f68(0x10cb)]=_0x4b6f68(0xf9b)+_0xbc5d8[_0x4b6f68(0x8ca)]+')';}),document['getElementById'](_0x25f7e9(0x1d3))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),async()=>{const _0x2b39c0=_0x25f7e9;if(_0xbc5d8[_0x2b39c0(0x8ca)]===0x0){alert(_0x2b39c0(0x12d2));return;}const _0x75c359=await _0xa6b74a(_0x2b39c0(0x8ed),_0x2b39c0(0x3d5)+_0xbc5d8[_0x2b39c0(0x8ca)]+_0x2b39c0(0xdcd),{'confirmButtonClass':_0x2b39c0(0x5e8)});_0x75c359&&(await _0x6ed281[_0x2b39c0(0x151a)][_0x2b39c0(0xd5d)]([..._0xbc5d8]),document['getElementById'](_0x2b39c0(0x7cb))[_0x2b39c0(0x4f6)](),await _0x42dc5f(),await _0x104485('成功',_0x2b39c0(0x1db)));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x1458))[_0x25f7e9(0x339)](_0x25f7e9(0x145c),_0x52f19c),document['getElementById'](_0x25f7e9(0x7f8))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x5d47a0),document[_0x25f7e9(0x948)](_0x25f7e9(0x6d3))['addEventListener'](_0x25f7e9(0x4f6),_0x3845d2),document[_0x25f7e9(0x948)](_0x25f7e9(0x1093))[_0x25f7e9(0x339)](_0x25f7e9(0x145c),_0x36a709=>{const _0x389130=_0x25f7e9,_0x321d61=document[_0x389130(0x948)]('novelai-details');_0x321d61[_0x389130(0xf74)][_0x389130(0x11fd)]=_0x36a709[_0x389130(0xa50)][_0x389130(0x210)]?'block':_0x389130(0x12fe);}),document[_0x25f7e9(0x948)]('novelai-key-toggle')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),function(){const _0xa37e1c=_0x25f7e9,_0x1e150d=document[_0xa37e1c(0x948)]('novelai-api-key');_0x1e150d[_0xa37e1c(0x4ae)]==='password'?(_0x1e150d['type']='text',this[_0xa37e1c(0x10cb)]='😌'):(_0x1e150d[_0xa37e1c(0x4ae)]=_0xa37e1c(0x6f0),this[_0xa37e1c(0x10cb)]='🧐');}),document[_0x25f7e9(0x948)](_0x25f7e9(0x104b))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x50e675=_0x25f7e9;_0x27c43e(),document[_0x50e675(0x948)](_0x50e675(0xbfc))[_0x50e675(0xf74)][_0x50e675(0x11fd)]=_0x50e675(0x6a4);}),document[_0x25f7e9(0x948)](_0x25f7e9(0x8b0))['addEventListener']('change',_0x5421eb=>{const _0x3cbbdf=_0x25f7e9,_0x16f19b=document[_0x3cbbdf(0x948)](_0x3cbbdf(0xc24));_0x5421eb[_0x3cbbdf(0xa50)][_0x3cbbdf(0x5bc)]===_0x3cbbdf(0x1310)?_0x16f19b['style']['display']='block':_0x16f19b[_0x3cbbdf(0xf74)][_0x3cbbdf(0x11fd)]=_0x3cbbdf(0x12fe);}),document[_0x25f7e9(0x948)]('close-novelai-settings')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x2f56b6=_0x25f7e9;document[_0x2f56b6(0x948)](_0x2f56b6(0xbfc))['style'][_0x2f56b6(0x11fd)]='none';}),document[_0x25f7e9(0x948)](_0x25f7e9(0x11f1))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x5cf0b7=_0x25f7e9;_0x1e05b2(),document[_0x5cf0b7(0x948)](_0x5cf0b7(0xbfc))[_0x5cf0b7(0xf74)][_0x5cf0b7(0x11fd)]=_0x5cf0b7(0x12fe),alert(_0x5cf0b7(0x152a));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x380))[_0x25f7e9(0x339)]('click',()=>{const _0x2b7f36=_0x25f7e9;confirm(_0x2b7f36(0x14d2))&&_0x4da42b();}),document['getElementById']('novelai-test-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x2d71db=_0x25f7e9,_0x19ef81=document[_0x2d71db(0x948)](_0x2d71db(0x14ce))[_0x2d71db(0x5bc)][_0x2d71db(0x2a8)]();if(!_0x19ef81){alert(_0x2d71db(0x874));return;}document[_0x2d71db(0x948)]('novelai-test-modal')[_0x2d71db(0xf74)][_0x2d71db(0x11fd)]=_0x2d71db(0x6a4),document[_0x2d71db(0x948)]('nai-test-result')[_0x2d71db(0xf74)][_0x2d71db(0x11fd)]=_0x2d71db(0x12fe),document[_0x2d71db(0x948)](_0x2d71db(0x125e))[_0x2d71db(0xf74)][_0x2d71db(0x11fd)]=_0x2d71db(0x12fe);}),document[_0x25f7e9(0x948)](_0x25f7e9(0x11a7))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x9c9730=_0x25f7e9;document['getElementById'](_0x9c9730(0x664))['style'][_0x9c9730(0x11fd)]='none';}),document[_0x25f7e9(0x948)]('close-nai-test-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x4e159d=_0x25f7e9;document[_0x4e159d(0x948)](_0x4e159d(0x664))[_0x4e159d(0xf74)][_0x4e159d(0x11fd)]=_0x4e159d(0x12fe);}),document[_0x25f7e9(0x948)]('nai-generate-btn')['addEventListener']('click',async()=>{await _0x3d2fa3();}),document[_0x25f7e9(0x948)](_0x25f7e9(0x1279))['addEventListener'](_0x25f7e9(0x4f6),()=>{const _0x52e16d=_0x25f7e9,_0x4f2689=document['getElementById'](_0x52e16d(0x939)),_0xecce91=document[_0x52e16d(0x1497)]('a');_0xecce91[_0x52e16d(0x13a6)]=_0x4f2689[_0x52e16d(0x147d)],_0xecce91[_0x52e16d(0xf4c)]='novelai-generated-'+Date[_0x52e16d(0x1386)]()+_0x52e16d(0x1eb),_0xecce91[_0x52e16d(0x4f6)]();}),document[_0x25f7e9(0x948)](_0x25f7e9(0x544))[_0x25f7e9(0x339)]('click',()=>{const _0x5a6fa9=_0x25f7e9;if(!_0x16699d['activeChatId'])return;const _0x3f1b46=_0x16699d[_0x5a6fa9(0x1474)][_0x16699d[_0x5a6fa9(0xf5a)]],_0x1aacb8=_0x3f1b46[_0x5a6fa9(0x7fd)]['naiSettings']||{'promptSource':_0x5a6fa9(0x11af),'characterPositivePrompt':'','characterNegativePrompt':''};document[_0x5a6fa9(0x948)]('character-nai-positive')['value']=_0x1aacb8[_0x5a6fa9(0xee5)]||'',document['getElementById'](_0x5a6fa9(0xbb5))[_0x5a6fa9(0x5bc)]=_0x1aacb8[_0x5a6fa9(0x4c9)]||'',document[_0x5a6fa9(0x948)](_0x5a6fa9(0x950))['style'][_0x5a6fa9(0x11fd)]=_0x5a6fa9(0x6a4);}),document[_0x25f7e9(0x948)](_0x25f7e9(0x5a7))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0xe06821=_0x25f7e9;document['getElementById'](_0xe06821(0x950))['style']['display']=_0xe06821(0x12fe);}),document[_0x25f7e9(0x948)]('save-character-nai-prompts-btn')['addEventListener'](_0x25f7e9(0x4f6),async()=>{const _0x134d82=_0x25f7e9;if(!_0x16699d[_0x134d82(0xf5a)])return;const _0x1b5f5f=_0x16699d['chats'][_0x16699d[_0x134d82(0xf5a)]];!_0x1b5f5f[_0x134d82(0x7fd)][_0x134d82(0x1d4)]&&(_0x1b5f5f[_0x134d82(0x7fd)][_0x134d82(0x1d4)]={'promptSource':_0x134d82(0x11af)}),_0x1b5f5f[_0x134d82(0x7fd)][_0x134d82(0x1d4)][_0x134d82(0xee5)]=document[_0x134d82(0x948)](_0x134d82(0x145b))[_0x134d82(0x5bc)][_0x134d82(0x2a8)](),_0x1b5f5f['settings']['naiSettings']['characterNegativePrompt']=document[_0x134d82(0x948)](_0x134d82(0xbb5))[_0x134d82(0x5bc)]['trim'](),console[_0x134d82(0x498)](_0x134d82(0x7e0)),console['log']('\x20\x20\x20characterPositivePrompt:',_0x1b5f5f['settings'][_0x134d82(0x1d4)][_0x134d82(0xee5)]),console[_0x134d82(0x498)]('\x20\x20\x20characterNegativePrompt:',_0x1b5f5f[_0x134d82(0x7fd)][_0x134d82(0x1d4)][_0x134d82(0x4c9)]),console[_0x134d82(0x498)](_0x134d82(0x1050),_0x1b5f5f[_0x134d82(0x7fd)][_0x134d82(0x1d4)][_0x134d82(0xef3)]),await _0x6ed281['chats'][_0x134d82(0x90c)](_0x1b5f5f),document['getElementById'](_0x134d82(0x950))[_0x134d82(0xf74)][_0x134d82(0x11fd)]=_0x134d82(0x12fe),alert('角色专属NAI提示词已保存！');}),document['getElementById'](_0x25f7e9(0x11ae))[_0x25f7e9(0x339)]('click',()=>{const _0x41ae80=_0x25f7e9;confirm(_0x41ae80(0x1405))&&(document[_0x41ae80(0x948)]('character-nai-positive')[_0x41ae80(0x5bc)]='',document[_0x41ae80(0x948)](_0x41ae80(0xbb5))['value']='');}),document[_0x25f7e9(0x948)](_0x25f7e9(0x259))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>{const _0x2783a2=_0x25f7e9;if(!_0x16699d[_0x2783a2(0xf5a)])return;const _0x227d03=_0x16699d[_0x2783a2(0x1474)][_0x16699d[_0x2783a2(0xf5a)]],_0x35312f=_0x227d03[_0x2783a2(0x7fd)][_0x2783a2(0x1d4)]||{'promptSource':_0x2783a2(0x11af),'characterPositivePrompt':'','characterNegativePrompt':''};document[_0x2783a2(0x948)](_0x2783a2(0x145b))['value']=_0x35312f[_0x2783a2(0xee5)]||'',document[_0x2783a2(0x948)](_0x2783a2(0xbb5))[_0x2783a2(0x5bc)]=_0x35312f[_0x2783a2(0x4c9)]||'',document[_0x2783a2(0x948)](_0x2783a2(0x950))[_0x2783a2(0xf74)]['display']=_0x2783a2(0x6a4);}),document[_0x25f7e9(0x948)](_0x25f7e9(0xc3f))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x36abaf),document['getElementById'](_0x25f7e9(0x12c5))[_0x25f7e9(0x339)]('change',_0x177008),document['getElementById'](_0x25f7e9(0x695))[_0x25f7e9(0x339)]('click',_0x260255),document['getElementById']('delete-current-category-btn')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x4dd471),document[_0x25f7e9(0x948)]('char-wallet-back-btn')[_0x25f7e9(0x339)]('click',()=>{const _0x3116e7=_0x25f7e9;_0x13f7b4(_0x3116e7(0x117a));}),document[_0x25f7e9(0x948)]('sticker-binding-chat-list')[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0xfde019=>{const _0x22f50e=_0x25f7e9,_0x15b516=_0xfde019[_0x22f50e(0xa50)][_0x22f50e(0x1090)](_0x22f50e(0x229));if(_0x15b516){const _0x275b0b=_0x15b516[_0x22f50e(0xfeb)](_0x22f50e(0x13b8));_0x275b0b&&_0xfde019[_0x22f50e(0xa50)]!==_0x275b0b&&(_0x275b0b[_0x22f50e(0x210)]=!_0x275b0b['checked']);}});const _0x4e6482=document[_0x25f7e9(0x948)](_0x25f7e9(0x11c8));_0x159366(_0x4e6482,_0x1780bc=>{const _0x48bcad=_0x25f7e9,_0xf73ea3=_0x1780bc[_0x48bcad(0xa50)][_0x48bcad(0x1090)](_0x48bcad(0xff7));if(_0xf73ea3){_0x1780bc[_0x48bcad(0x38f)]();const _0x1f855c=_0xf73ea3['dataset'][_0x48bcad(0xd86)];if(_0x1f855c===_0x48bcad(0xd49)){_0x104485('提示',_0x48bcad(0xfb2));return;}const _0x2d96cb=_0x1f855c==='uncategorized'?_0x48bcad(0x149b):parseInt(_0x1f855c);_0x2a3feb(_0x2d96cb);}}),document[_0x25f7e9(0x948)](_0x25f7e9(0x6cf))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x20cf53),document[_0x25f7e9(0x948)]('close-nai-gallery-btn')['addEventListener'](_0x25f7e9(0x4f6),()=>{const _0x3aec7c=_0x25f7e9;document[_0x3aec7c(0x948)]('nai-gallery-panel')[_0x3aec7c(0xd54)]['remove'](_0x3aec7c(0xfcb));}),document[_0x25f7e9(0x948)](_0x25f7e9(0x98a))['addEventListener'](_0x25f7e9(0x4f6),_0x465bdd),document[_0x25f7e9(0x948)](_0x25f7e9(0xe32))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),_0x37d8fd=>{_0x12e3da(_0x37d8fd);}),document[_0x25f7e9(0x948)]('select-all-nai-gallery-checkbox')[_0x25f7e9(0x339)](_0x25f7e9(0x145c),_0x64f991=>{const _0xbf853d=_0x25f7e9,_0x11cf93=_0x64f991[_0xbf853d(0xa50)][_0xbf853d(0x210)];document[_0xbf853d(0x1188)]('#nai-gallery-grid\x20.nai-gallery-item')[_0xbf853d(0x427)](_0x3bd4a9=>{const _0x7a3739=_0xbf853d;_0x3bd4a9[_0x7a3739(0xd54)][_0x7a3739(0x69d)](_0x7a3739(0xd56),_0x11cf93);const _0x4b6391=_0x3bd4a9['dataset']['key'];_0x11cf93?_0x5b3f5a[_0x7a3739(0xbd0)](_0x4b6391):_0x5b3f5a['delete'](_0x4b6391);}),_0x6926b4();}),document[_0x25f7e9(0x948)](_0x25f7e9(0x12b0))[_0x25f7e9(0x339)](_0x25f7e9(0x4f6),()=>_0x4910d5()),document[_0x25f7e9(0x948)](_0x25f7e9(0x408))['addEventListener']('click',()=>_0x50b975()),_0x3ce973(),_0x58c3b1('home-screen');}_0x27ba40();});
